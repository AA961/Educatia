const bx=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerpolicy&&(i.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?i.credentials="include":s.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}};bx();function h_(t,e){const n=Object.create(null),r=t.split(",");for(let s=0;s<r.length;s++)n[r[s]]=!0;return e?s=>!!n[s.toLowerCase()]:s=>!!n[s]}const Ix="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",Ex=h_(Ix);function mS(t){return!!t||t===""}function d_(t){if(ee(t)){const e={};for(let n=0;n<t.length;n++){const r=t[n],s=yt(r)?Cx(r):d_(r);if(s)for(const i in s)e[i]=s[i]}return e}else{if(yt(t))return t;if(rt(t))return t}}const Tx=/;(?![^(]*\))/g,Sx=/:(.+)/;function Cx(t){const e={};return t.split(Tx).forEach(n=>{if(n){const r=n.split(Sx);r.length>1&&(e[r[0].trim()]=r[1].trim())}}),e}function f_(t){let e="";if(yt(t))e=t;else if(ee(t))for(let n=0;n<t.length;n++){const r=f_(t[n]);r&&(e+=r+" ")}else if(rt(t))for(const n in t)t[n]&&(e+=n+" ");return e.trim()}function Ax(t,e){if(t.length!==e.length)return!1;let n=!0;for(let r=0;n&&r<t.length;r++)n=ga(t[r],e[r]);return n}function ga(t,e){if(t===e)return!0;let n=Kw(t),r=Kw(e);if(n||r)return n&&r?t.getTime()===e.getTime():!1;if(n=ll(t),r=ll(e),n||r)return t===e;if(n=ee(t),r=ee(e),n||r)return n&&r?Ax(t,e):!1;if(n=rt(t),r=rt(e),n||r){if(!n||!r)return!1;const s=Object.keys(t).length,i=Object.keys(e).length;if(s!==i)return!1;for(const o in t){const a=t.hasOwnProperty(o),c=e.hasOwnProperty(o);if(a&&!c||!a&&c||!ga(t[o],e[o]))return!1}}return String(t)===String(e)}function kx(t,e){return t.findIndex(n=>ga(n,e))}const K9=t=>yt(t)?t:t==null?"":ee(t)||rt(t)&&(t.toString===vS||!le(t.toString))?JSON.stringify(t,_S,2):String(t),_S=(t,e)=>e&&e.__v_isRef?_S(t,e.value):ea(e)?{[`Map(${e.size})`]:[...e.entries()].reduce((n,[r,s])=>(n[`${r} =>`]=s,n),{})}:jd(e)?{[`Set(${e.size})`]:[...e.values()]}:rt(e)&&!ee(e)&&!wS(e)?String(e):e,Me={},Zo=[],or=()=>{},Rx=()=>!1,Nx=/^on[^a-z]/,qd=t=>Nx.test(t),p_=t=>t.startsWith("onUpdate:"),Gt=Object.assign,g_=(t,e)=>{const n=t.indexOf(e);n>-1&&t.splice(n,1)},Px=Object.prototype.hasOwnProperty,ve=(t,e)=>Px.call(t,e),ee=Array.isArray,ea=t=>cu(t)==="[object Map]",jd=t=>cu(t)==="[object Set]",Kw=t=>cu(t)==="[object Date]",le=t=>typeof t=="function",yt=t=>typeof t=="string",ll=t=>typeof t=="symbol",rt=t=>t!==null&&typeof t=="object",yS=t=>rt(t)&&le(t.then)&&le(t.catch),vS=Object.prototype.toString,cu=t=>vS.call(t),Dx=t=>cu(t).slice(8,-1),wS=t=>cu(t)==="[object Object]",m_=t=>yt(t)&&t!=="NaN"&&t[0]!=="-"&&""+parseInt(t,10)===t,vh=h_(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),Kd=t=>{const e=Object.create(null);return n=>e[n]||(e[n]=t(n))},xx=/-(\w)/g,Dr=Kd(t=>t.replace(xx,(e,n)=>n?n.toUpperCase():"")),Ox=/\B([A-Z])/g,Eo=Kd(t=>t.replace(Ox,"-$1").toLowerCase()),Hd=Kd(t=>t.charAt(0).toUpperCase()+t.slice(1)),Ap=Kd(t=>t?`on${Hd(t)}`:""),ul=(t,e)=>!Object.is(t,e),ta=(t,e)=>{for(let n=0;n<t.length;n++)t[n](e)},Mh=(t,e,n)=>{Object.defineProperty(t,e,{configurable:!0,enumerable:!1,value:n})},hl=t=>{const e=parseFloat(t);return isNaN(e)?t:e};let Hw;const Mx=()=>Hw||(Hw=typeof globalThis!="undefined"?globalThis:typeof self!="undefined"?self:typeof window!="undefined"?window:typeof global!="undefined"?global:{});let gr;class bS{constructor(e=!1){this.active=!0,this.effects=[],this.cleanups=[],!e&&gr&&(this.parent=gr,this.index=(gr.scopes||(gr.scopes=[])).push(this)-1)}run(e){if(this.active){const n=gr;try{return gr=this,e()}finally{gr=n}}}on(){gr=this}off(){gr=this.parent}stop(e){if(this.active){let n,r;for(n=0,r=this.effects.length;n<r;n++)this.effects[n].stop();for(n=0,r=this.cleanups.length;n<r;n++)this.cleanups[n]();if(this.scopes)for(n=0,r=this.scopes.length;n<r;n++)this.scopes[n].stop(!0);if(this.parent&&!e){const s=this.parent.scopes.pop();s&&s!==this&&(this.parent.scopes[this.index]=s,s.index=this.index)}this.active=!1}}}function IS(t){return new bS(t)}function Lx(t,e=gr){e&&e.active&&e.effects.push(t)}const __=t=>{const e=new Set(t);return e.w=0,e.n=0,e},ES=t=>(t.w&Gs)>0,TS=t=>(t.n&Gs)>0,Fx=({deps:t})=>{if(t.length)for(let e=0;e<t.length;e++)t[e].w|=Gs},Ux=t=>{const{deps:e}=t;if(e.length){let n=0;for(let r=0;r<e.length;r++){const s=e[r];ES(s)&&!TS(s)?s.delete(t):e[n++]=s,s.w&=~Gs,s.n&=~Gs}e.length=n}},Dg=new WeakMap;let Nc=0,Gs=1;const xg=30;let tr;const ji=Symbol(""),Og=Symbol("");class y_{constructor(e,n=null,r){this.fn=e,this.scheduler=n,this.active=!0,this.deps=[],this.parent=void 0,Lx(this,r)}run(){if(!this.active)return this.fn();let e=tr,n=Us;for(;e;){if(e===this)return;e=e.parent}try{return this.parent=tr,tr=this,Us=!0,Gs=1<<++Nc,Nc<=xg?Fx(this):Ww(this),this.fn()}finally{Nc<=xg&&Ux(this),Gs=1<<--Nc,tr=this.parent,Us=n,this.parent=void 0,this.deferStop&&this.stop()}}stop(){tr===this?this.deferStop=!0:this.active&&(Ww(this),this.onStop&&this.onStop(),this.active=!1)}}function Ww(t){const{deps:e}=t;if(e.length){for(let n=0;n<e.length;n++)e[n].delete(t);e.length=0}}let Us=!0;const SS=[];function Ba(){SS.push(Us),Us=!1}function qa(){const t=SS.pop();Us=t===void 0?!0:t}function Dn(t,e,n){if(Us&&tr){let r=Dg.get(t);r||Dg.set(t,r=new Map);let s=r.get(n);s||r.set(n,s=__()),CS(s)}}function CS(t,e){let n=!1;Nc<=xg?TS(t)||(t.n|=Gs,n=!ES(t)):n=!t.has(tr),n&&(t.add(tr),tr.deps.push(t))}function is(t,e,n,r,s,i){const o=Dg.get(t);if(!o)return;let a=[];if(e==="clear")a=[...o.values()];else if(n==="length"&&ee(t))o.forEach((c,l)=>{(l==="length"||l>=r)&&a.push(c)});else switch(n!==void 0&&a.push(o.get(n)),e){case"add":ee(t)?m_(n)&&a.push(o.get("length")):(a.push(o.get(ji)),ea(t)&&a.push(o.get(Og)));break;case"delete":ee(t)||(a.push(o.get(ji)),ea(t)&&a.push(o.get(Og)));break;case"set":ea(t)&&a.push(o.get(ji));break}if(a.length===1)a[0]&&Mg(a[0]);else{const c=[];for(const l of a)l&&c.push(...l);Mg(__(c))}}function Mg(t,e){const n=ee(t)?t:[...t];for(const r of n)r.computed&&Gw(r);for(const r of n)r.computed||Gw(r)}function Gw(t,e){(t!==tr||t.allowRecurse)&&(t.scheduler?t.scheduler():t.run())}const $x=h_("__proto__,__v_isRef,__isVue"),AS=new Set(Object.getOwnPropertyNames(Symbol).filter(t=>t!=="arguments"&&t!=="caller").map(t=>Symbol[t]).filter(ll)),Vx=v_(),Bx=v_(!1,!0),qx=v_(!0),zw=jx();function jx(){const t={};return["includes","indexOf","lastIndexOf"].forEach(e=>{t[e]=function(...n){const r=Se(this);for(let i=0,o=this.length;i<o;i++)Dn(r,"get",i+"");const s=r[e](...n);return s===-1||s===!1?r[e](...n.map(Se)):s}}),["push","pop","shift","unshift","splice"].forEach(e=>{t[e]=function(...n){Ba();const r=Se(this)[e].apply(this,n);return qa(),r}}),t}function v_(t=!1,e=!1){return function(r,s,i){if(s==="__v_isReactive")return!t;if(s==="__v_isReadonly")return t;if(s==="__v_isShallow")return e;if(s==="__v_raw"&&i===(t?e?iO:DS:e?PS:NS).get(r))return r;const o=ee(r);if(!t&&o&&ve(zw,s))return Reflect.get(zw,s,i);const a=Reflect.get(r,s,i);return(ll(s)?AS.has(s):$x(s))||(t||Dn(r,"get",s),e)?a:lt(a)?o&&m_(s)?a:a.value:rt(a)?t?xS(a):ja(a):a}}const Kx=kS(),Hx=kS(!0);function kS(t=!1){return function(n,r,s,i){let o=n[r];if(dl(o)&&lt(o)&&!lt(s))return!1;if(!t&&!dl(s)&&(Lg(s)||(s=Se(s),o=Se(o)),!ee(n)&&lt(o)&&!lt(s)))return o.value=s,!0;const a=ee(n)&&m_(r)?Number(r)<n.length:ve(n,r),c=Reflect.set(n,r,s,i);return n===Se(i)&&(a?ul(s,o)&&is(n,"set",r,s):is(n,"add",r,s)),c}}function Wx(t,e){const n=ve(t,e);t[e];const r=Reflect.deleteProperty(t,e);return r&&n&&is(t,"delete",e,void 0),r}function Gx(t,e){const n=Reflect.has(t,e);return(!ll(e)||!AS.has(e))&&Dn(t,"has",e),n}function zx(t){return Dn(t,"iterate",ee(t)?"length":ji),Reflect.ownKeys(t)}const RS={get:Vx,set:Kx,deleteProperty:Wx,has:Gx,ownKeys:zx},Qx={get:qx,set(t,e){return!0},deleteProperty(t,e){return!0}},Yx=Gt({},RS,{get:Bx,set:Hx}),w_=t=>t,Wd=t=>Reflect.getPrototypeOf(t);function Qu(t,e,n=!1,r=!1){t=t.__v_raw;const s=Se(t),i=Se(e);n||(e!==i&&Dn(s,"get",e),Dn(s,"get",i));const{has:o}=Wd(s),a=r?w_:n?E_:fl;if(o.call(s,e))return a(t.get(e));if(o.call(s,i))return a(t.get(i));t!==s&&t.get(e)}function Yu(t,e=!1){const n=this.__v_raw,r=Se(n),s=Se(t);return e||(t!==s&&Dn(r,"has",t),Dn(r,"has",s)),t===s?n.has(t):n.has(t)||n.has(s)}function Ju(t,e=!1){return t=t.__v_raw,!e&&Dn(Se(t),"iterate",ji),Reflect.get(t,"size",t)}function Qw(t){t=Se(t);const e=Se(this);return Wd(e).has.call(e,t)||(e.add(t),is(e,"add",t,t)),this}function Yw(t,e){e=Se(e);const n=Se(this),{has:r,get:s}=Wd(n);let i=r.call(n,t);i||(t=Se(t),i=r.call(n,t));const o=s.call(n,t);return n.set(t,e),i?ul(e,o)&&is(n,"set",t,e):is(n,"add",t,e),this}function Jw(t){const e=Se(this),{has:n,get:r}=Wd(e);let s=n.call(e,t);s||(t=Se(t),s=n.call(e,t)),r&&r.call(e,t);const i=e.delete(t);return s&&is(e,"delete",t,void 0),i}function Xw(){const t=Se(this),e=t.size!==0,n=t.clear();return e&&is(t,"clear",void 0,void 0),n}function Xu(t,e){return function(r,s){const i=this,o=i.__v_raw,a=Se(o),c=e?w_:t?E_:fl;return!t&&Dn(a,"iterate",ji),o.forEach((l,u)=>r.call(s,c(l),c(u),i))}}function Zu(t,e,n){return function(...r){const s=this.__v_raw,i=Se(s),o=ea(i),a=t==="entries"||t===Symbol.iterator&&o,c=t==="keys"&&o,l=s[t](...r),u=n?w_:e?E_:fl;return!e&&Dn(i,"iterate",c?Og:ji),{next(){const{value:h,done:d}=l.next();return d?{value:h,done:d}:{value:a?[u(h[0]),u(h[1])]:u(h),done:d}},[Symbol.iterator](){return this}}}}function vs(t){return function(...e){return t==="delete"?!1:this}}function Jx(){const t={get(i){return Qu(this,i)},get size(){return Ju(this)},has:Yu,add:Qw,set:Yw,delete:Jw,clear:Xw,forEach:Xu(!1,!1)},e={get(i){return Qu(this,i,!1,!0)},get size(){return Ju(this)},has:Yu,add:Qw,set:Yw,delete:Jw,clear:Xw,forEach:Xu(!1,!0)},n={get(i){return Qu(this,i,!0)},get size(){return Ju(this,!0)},has(i){return Yu.call(this,i,!0)},add:vs("add"),set:vs("set"),delete:vs("delete"),clear:vs("clear"),forEach:Xu(!0,!1)},r={get(i){return Qu(this,i,!0,!0)},get size(){return Ju(this,!0)},has(i){return Yu.call(this,i,!0)},add:vs("add"),set:vs("set"),delete:vs("delete"),clear:vs("clear"),forEach:Xu(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(i=>{t[i]=Zu(i,!1,!1),n[i]=Zu(i,!0,!1),e[i]=Zu(i,!1,!0),r[i]=Zu(i,!0,!0)}),[t,n,e,r]}const[Xx,Zx,eO,tO]=Jx();function b_(t,e){const n=e?t?tO:eO:t?Zx:Xx;return(r,s,i)=>s==="__v_isReactive"?!t:s==="__v_isReadonly"?t:s==="__v_raw"?r:Reflect.get(ve(n,s)&&s in r?n:r,s,i)}const nO={get:b_(!1,!1)},rO={get:b_(!1,!0)},sO={get:b_(!0,!1)},NS=new WeakMap,PS=new WeakMap,DS=new WeakMap,iO=new WeakMap;function oO(t){switch(t){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function aO(t){return t.__v_skip||!Object.isExtensible(t)?0:oO(Dx(t))}function ja(t){return dl(t)?t:I_(t,!1,RS,nO,NS)}function cO(t){return I_(t,!1,Yx,rO,PS)}function xS(t){return I_(t,!0,Qx,sO,DS)}function I_(t,e,n,r,s){if(!rt(t)||t.__v_raw&&!(e&&t.__v_isReactive))return t;const i=s.get(t);if(i)return i;const o=aO(t);if(o===0)return t;const a=new Proxy(t,o===2?r:n);return s.set(t,a),a}function $s(t){return dl(t)?$s(t.__v_raw):!!(t&&t.__v_isReactive)}function dl(t){return!!(t&&t.__v_isReadonly)}function Lg(t){return!!(t&&t.__v_isShallow)}function OS(t){return $s(t)||dl(t)}function Se(t){const e=t&&t.__v_raw;return e?Se(e):t}function ma(t){return Mh(t,"__v_skip",!0),t}const fl=t=>rt(t)?ja(t):t,E_=t=>rt(t)?xS(t):t;function MS(t){Us&&tr&&(t=Se(t),CS(t.dep||(t.dep=__())))}function LS(t,e){t=Se(t),t.dep&&Mg(t.dep)}function lt(t){return!!(t&&t.__v_isRef===!0)}function T_(t){return FS(t,!1)}function lO(t){return FS(t,!0)}function FS(t,e){return lt(t)?t:new uO(t,e)}class uO{constructor(e,n){this.__v_isShallow=n,this.dep=void 0,this.__v_isRef=!0,this._rawValue=n?e:Se(e),this._value=n?e:fl(e)}get value(){return MS(this),this._value}set value(e){e=this.__v_isShallow?e:Se(e),ul(e,this._rawValue)&&(this._rawValue=e,this._value=this.__v_isShallow?e:fl(e),LS(this))}}function Uc(t){return lt(t)?t.value:t}const hO={get:(t,e,n)=>Uc(Reflect.get(t,e,n)),set:(t,e,n,r)=>{const s=t[e];return lt(s)&&!lt(n)?(s.value=n,!0):Reflect.set(t,e,n,r)}};function US(t){return $s(t)?t:new Proxy(t,hO)}function dO(t){const e=ee(t)?new Array(t.length):{};for(const n in t)e[n]=pO(t,n);return e}class fO{constructor(e,n,r){this._object=e,this._key=n,this._defaultValue=r,this.__v_isRef=!0}get value(){const e=this._object[this._key];return e===void 0?this._defaultValue:e}set value(e){this._object[this._key]=e}}function pO(t,e,n){const r=t[e];return lt(r)?r:new fO(t,e,n)}class gO{constructor(e,n,r,s){this._setter=n,this.dep=void 0,this.__v_isRef=!0,this._dirty=!0,this.effect=new y_(e,()=>{this._dirty||(this._dirty=!0,LS(this))}),this.effect.computed=this,this.effect.active=this._cacheable=!s,this.__v_isReadonly=r}get value(){const e=Se(this);return MS(e),(e._dirty||!e._cacheable)&&(e._dirty=!1,e._value=e.effect.run()),e._value}set value(e){this._setter(e)}}function mO(t,e,n=!1){let r,s;const i=le(t);return i?(r=t,s=or):(r=t.get,s=t.set),new gO(r,s,i||!s,n)}function Vs(t,e,n,r){let s;try{s=r?t(...r):t()}catch(i){Gd(i,e,n)}return s}function Hn(t,e,n,r){if(le(t)){const i=Vs(t,e,n,r);return i&&yS(i)&&i.catch(o=>{Gd(o,e,n)}),i}const s=[];for(let i=0;i<t.length;i++)s.push(Hn(t[i],e,n,r));return s}function Gd(t,e,n,r=!0){const s=e?e.vnode:null;if(e){let i=e.parent;const o=e.proxy,a=n;for(;i;){const l=i.ec;if(l){for(let u=0;u<l.length;u++)if(l[u](t,o,a)===!1)return}i=i.parent}const c=e.appContext.config.errorHandler;if(c){Vs(c,null,10,[t,o,a]);return}}_O(t,n,s,r)}function _O(t,e,n,r=!0){console.error(t)}let Lh=!1,Fg=!1;const An=[];let Gr=0;const $c=[];let Pc=null,Wo=0;const Vc=[];let As=null,Go=0;const $S=Promise.resolve();let S_=null,Ug=null;function C_(t){const e=S_||$S;return t?e.then(this?t.bind(this):t):e}function yO(t){let e=Gr+1,n=An.length;for(;e<n;){const r=e+n>>>1;pl(An[r])<t?e=r+1:n=r}return e}function VS(t){(!An.length||!An.includes(t,Lh&&t.allowRecurse?Gr+1:Gr))&&t!==Ug&&(t.id==null?An.push(t):An.splice(yO(t.id),0,t),BS())}function BS(){!Lh&&!Fg&&(Fg=!0,S_=$S.then(KS))}function vO(t){const e=An.indexOf(t);e>Gr&&An.splice(e,1)}function qS(t,e,n,r){ee(t)?n.push(...t):(!e||!e.includes(t,t.allowRecurse?r+1:r))&&n.push(t),BS()}function wO(t){qS(t,Pc,$c,Wo)}function bO(t){qS(t,As,Vc,Go)}function zd(t,e=null){if($c.length){for(Ug=e,Pc=[...new Set($c)],$c.length=0,Wo=0;Wo<Pc.length;Wo++)Pc[Wo]();Pc=null,Wo=0,Ug=null,zd(t,e)}}function jS(t){if(zd(),Vc.length){const e=[...new Set(Vc)];if(Vc.length=0,As){As.push(...e);return}for(As=e,As.sort((n,r)=>pl(n)-pl(r)),Go=0;Go<As.length;Go++)As[Go]();As=null,Go=0}}const pl=t=>t.id==null?1/0:t.id;function KS(t){Fg=!1,Lh=!0,zd(t),An.sort((n,r)=>pl(n)-pl(r));const e=or;try{for(Gr=0;Gr<An.length;Gr++){const n=An[Gr];n&&n.active!==!1&&Vs(n,null,14)}}finally{Gr=0,An.length=0,jS(),Lh=!1,S_=null,(An.length||$c.length||Vc.length)&&KS(t)}}function IO(t,e,...n){if(t.isUnmounted)return;const r=t.vnode.props||Me;let s=n;const i=e.startsWith("update:"),o=i&&e.slice(7);if(o&&o in r){const u=`${o==="modelValue"?"model":o}Modifiers`,{number:h,trim:d}=r[u]||Me;d&&(s=n.map(f=>f.trim())),h&&(s=n.map(hl))}let a,c=r[a=Ap(e)]||r[a=Ap(Dr(e))];!c&&i&&(c=r[a=Ap(Eo(e))]),c&&Hn(c,t,6,s);const l=r[a+"Once"];if(l){if(!t.emitted)t.emitted={};else if(t.emitted[a])return;t.emitted[a]=!0,Hn(l,t,6,s)}}function HS(t,e,n=!1){const r=e.emitsCache,s=r.get(t);if(s!==void 0)return s;const i=t.emits;let o={},a=!1;if(!le(t)){const c=l=>{const u=HS(l,e,!0);u&&(a=!0,Gt(o,u))};!n&&e.mixins.length&&e.mixins.forEach(c),t.extends&&c(t.extends),t.mixins&&t.mixins.forEach(c)}return!i&&!a?(r.set(t,null),null):(ee(i)?i.forEach(c=>o[c]=null):Gt(o,i),r.set(t,o),o)}function Qd(t,e){return!t||!qd(e)?!1:(e=e.slice(2).replace(/Once$/,""),ve(t,e[0].toLowerCase()+e.slice(1))||ve(t,Eo(e))||ve(t,e))}let Vn=null,Yd=null;function Fh(t){const e=Vn;return Vn=t,Yd=t&&t.type.__scopeId||null,e}function A_(t){Yd=t}function k_(){Yd=null}function Zr(t,e=Vn,n){if(!e||t._n)return t;const r=(...s)=>{r._d&&lb(-1);const i=Fh(e),o=t(...s);return Fh(i),r._d&&lb(1),o};return r._n=!0,r._c=!0,r._d=!0,r}function kp(t){const{type:e,vnode:n,proxy:r,withProxy:s,props:i,propsOptions:[o],slots:a,attrs:c,emit:l,render:u,renderCache:h,data:d,setupState:f,ctx:p,inheritAttrs:_}=t;let y,T;const I=Fh(t);try{if(n.shapeFlag&4){const S=s||r;y=mr(u.call(S,S,h,i,f,d,p)),T=c}else{const S=e;y=mr(S.length>1?S(i,{attrs:c,slots:a,emit:l}):S(i,null)),T=e.props?c:EO(c)}}catch(S){qc.length=0,Gd(S,t,1),y=Qe(ar)}let E=y;if(T&&_!==!1){const S=Object.keys(T),{shapeFlag:$}=E;S.length&&$&7&&(o&&S.some(p_)&&(T=TO(T,o)),E=os(E,T))}return n.dirs&&(E=os(E),E.dirs=E.dirs?E.dirs.concat(n.dirs):n.dirs),n.transition&&(E.transition=n.transition),y=E,Fh(I),y}const EO=t=>{let e;for(const n in t)(n==="class"||n==="style"||qd(n))&&((e||(e={}))[n]=t[n]);return e},TO=(t,e)=>{const n={};for(const r in t)(!p_(r)||!(r.slice(9)in e))&&(n[r]=t[r]);return n};function SO(t,e,n){const{props:r,children:s,component:i}=t,{props:o,children:a,patchFlag:c}=e,l=i.emitsOptions;if(e.dirs||e.transition)return!0;if(n&&c>=0){if(c&1024)return!0;if(c&16)return r?Zw(r,o,l):!!o;if(c&8){const u=e.dynamicProps;for(let h=0;h<u.length;h++){const d=u[h];if(o[d]!==r[d]&&!Qd(l,d))return!0}}}else return(s||a)&&(!a||!a.$stable)?!0:r===o?!1:r?o?Zw(r,o,l):!0:!!o;return!1}function Zw(t,e,n){const r=Object.keys(e);if(r.length!==Object.keys(t).length)return!0;for(let s=0;s<r.length;s++){const i=r[s];if(e[i]!==t[i]&&!Qd(n,i))return!0}return!1}function CO({vnode:t,parent:e},n){for(;e&&e.subTree===t;)(t=e.vnode).el=n,e=e.parent}const WS=t=>t.__isSuspense;function AO(t,e){e&&e.pendingBranch?ee(t)?e.effects.push(...t):e.effects.push(t):bO(t)}function wh(t,e){if(At){let n=At.provides;const r=At.parent&&At.parent.provides;r===n&&(n=At.provides=Object.create(r)),n[t]=e}}function Cr(t,e,n=!1){const r=At||Vn;if(r){const s=r.parent==null?r.vnode.appContext&&r.vnode.appContext.provides:r.parent.provides;if(s&&t in s)return s[t];if(arguments.length>1)return n&&le(e)?e.call(r.proxy):e}}const eb={};function na(t,e,n){return GS(t,e,n)}function GS(t,e,{immediate:n,deep:r,flush:s,onTrack:i,onTrigger:o}=Me){const a=At;let c,l=!1,u=!1;if(lt(t)?(c=()=>t.value,l=Lg(t)):$s(t)?(c=()=>t,r=!0):ee(t)?(u=!0,l=t.some(T=>$s(T)||Lg(T)),c=()=>t.map(T=>{if(lt(T))return T.value;if($s(T))return Mi(T);if(le(T))return Vs(T,a,2)})):le(t)?e?c=()=>Vs(t,a,2):c=()=>{if(!(a&&a.isUnmounted))return h&&h(),Hn(t,a,3,[d])}:c=or,e&&r){const T=c;c=()=>Mi(T())}let h,d=T=>{h=y.onStop=()=>{Vs(T,a,4)}};if(ml)return d=or,e?n&&Hn(e,a,3,[c(),u?[]:void 0,d]):c(),or;let f=u?[]:eb;const p=()=>{if(!!y.active)if(e){const T=y.run();(r||l||(u?T.some((I,E)=>ul(I,f[E])):ul(T,f)))&&(h&&h(),Hn(e,a,3,[T,f===eb?void 0:f,d]),f=T)}else y.run()};p.allowRecurse=!!e;let _;s==="sync"?_=p:s==="post"?_=()=>$t(p,a&&a.suspense):_=()=>wO(p);const y=new y_(c,_);return e?n?p():f=y.run():s==="post"?$t(y.run.bind(y),a&&a.suspense):y.run(),()=>{y.stop(),a&&a.scope&&g_(a.scope.effects,y)}}function kO(t,e,n){const r=this.proxy,s=yt(t)?t.includes(".")?zS(r,t):()=>r[t]:t.bind(r,r);let i;le(e)?i=e:(i=e.handler,n=e);const o=At;ya(this);const a=GS(s,i.bind(r),n);return o?ya(o):Ki(),a}function zS(t,e){const n=e.split(".");return()=>{let r=t;for(let s=0;s<n.length&&r;s++)r=r[n[s]];return r}}function Mi(t,e){if(!rt(t)||t.__v_skip||(e=e||new Set,e.has(t)))return t;if(e.add(t),lt(t))Mi(t.value,e);else if(ee(t))for(let n=0;n<t.length;n++)Mi(t[n],e);else if(jd(t)||ea(t))t.forEach(n=>{Mi(n,e)});else if(wS(t))for(const n in t)Mi(t[n],e);return t}function RO(){const t={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return R_(()=>{t.isMounted=!0}),N_(()=>{t.isUnmounting=!0}),t}const Fn=[Function,Array],NO={name:"BaseTransition",props:{mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:Fn,onEnter:Fn,onAfterEnter:Fn,onEnterCancelled:Fn,onBeforeLeave:Fn,onLeave:Fn,onAfterLeave:Fn,onLeaveCancelled:Fn,onBeforeAppear:Fn,onAppear:Fn,onAfterAppear:Fn,onAppearCancelled:Fn},setup(t,{slots:e}){const n=ef(),r=RO();let s;return()=>{const i=e.default&&JS(e.default(),!0);if(!i||!i.length)return;let o=i[0];if(i.length>1){for(const _ of i)if(_.type!==ar){o=_;break}}const a=Se(t),{mode:c}=a;if(r.isLeaving)return Rp(o);const l=tb(o);if(!l)return Rp(o);const u=$g(l,a,r,n);Uh(l,u);const h=n.subTree,d=h&&tb(h);let f=!1;const{getTransitionKey:p}=l.type;if(p){const _=p();s===void 0?s=_:_!==s&&(s=_,f=!0)}if(d&&d.type!==ar&&(!ki(l,d)||f)){const _=$g(d,a,r,n);if(Uh(d,_),c==="out-in")return r.isLeaving=!0,_.afterLeave=()=>{r.isLeaving=!1,n.update()},Rp(o);c==="in-out"&&l.type!==ar&&(_.delayLeave=(y,T,I)=>{const E=YS(r,d);E[String(d.key)]=d,y._leaveCb=()=>{T(),y._leaveCb=void 0,delete u.delayedLeave},u.delayedLeave=I})}return o}}},QS=NO;function YS(t,e){const{leavingVNodes:n}=t;let r=n.get(e.type);return r||(r=Object.create(null),n.set(e.type,r)),r}function $g(t,e,n,r){const{appear:s,mode:i,persisted:o=!1,onBeforeEnter:a,onEnter:c,onAfterEnter:l,onEnterCancelled:u,onBeforeLeave:h,onLeave:d,onAfterLeave:f,onLeaveCancelled:p,onBeforeAppear:_,onAppear:y,onAfterAppear:T,onAppearCancelled:I}=e,E=String(t.key),S=YS(n,t),$=(F,ne)=>{F&&Hn(F,r,9,ne)},H=(F,ne)=>{const he=ne[1];$(F,ne),ee(F)?F.every(Ce=>Ce.length<=1)&&he():F.length<=1&&he()},K={mode:i,persisted:o,beforeEnter(F){let ne=a;if(!n.isMounted)if(s)ne=_||a;else return;F._leaveCb&&F._leaveCb(!0);const he=S[E];he&&ki(t,he)&&he.el._leaveCb&&he.el._leaveCb(),$(ne,[F])},enter(F){let ne=c,he=l,Ce=u;if(!n.isMounted)if(s)ne=y||c,he=T||l,Ce=I||u;else return;let z=!1;const Re=F._enterCb=Ze=>{z||(z=!0,Ze?$(Ce,[F]):$(he,[F]),K.delayedLeave&&K.delayedLeave(),F._enterCb=void 0)};ne?H(ne,[F,Re]):Re()},leave(F,ne){const he=String(t.key);if(F._enterCb&&F._enterCb(!0),n.isUnmounting)return ne();$(h,[F]);let Ce=!1;const z=F._leaveCb=Re=>{Ce||(Ce=!0,ne(),Re?$(p,[F]):$(f,[F]),F._leaveCb=void 0,S[he]===t&&delete S[he])};S[he]=t,d?H(d,[F,z]):z()},clone(F){return $g(F,e,n,r)}};return K}function Rp(t){if(Jd(t))return t=os(t),t.children=null,t}function tb(t){return Jd(t)?t.children?t.children[0]:void 0:t}function Uh(t,e){t.shapeFlag&6&&t.component?Uh(t.component.subTree,e):t.shapeFlag&128?(t.ssContent.transition=e.clone(t.ssContent),t.ssFallback.transition=e.clone(t.ssFallback)):t.transition=e}function JS(t,e=!1,n){let r=[],s=0;for(let i=0;i<t.length;i++){let o=t[i];const a=n==null?o.key:String(n)+String(o.key!=null?o.key:i);o.type===er?(o.patchFlag&128&&s++,r=r.concat(JS(o.children,e,a))):(e||o.type!==ar)&&r.push(a!=null?os(o,{key:a}):o)}if(s>1)for(let i=0;i<r.length;i++)r[i].patchFlag=-2;return r}function XS(t){return le(t)?{setup:t,name:t.name}:t}const Bc=t=>!!t.type.__asyncLoader,Jd=t=>t.type.__isKeepAlive,PO={name:"KeepAlive",__isKeepAlive:!0,props:{include:[String,RegExp,Array],exclude:[String,RegExp,Array],max:[String,Number]},setup(t,{slots:e}){const n=ef(),r=n.ctx;if(!r.renderer)return()=>{const I=e.default&&e.default();return I&&I.length===1?I[0]:I};const s=new Map,i=new Set;let o=null;const a=n.suspense,{renderer:{p:c,m:l,um:u,o:{createElement:h}}}=r,d=h("div");r.activate=(I,E,S,$,H)=>{const K=I.component;l(I,E,S,0,a),c(K.vnode,I,E,S,K,a,$,I.slotScopeIds,H),$t(()=>{K.isDeactivated=!1,K.a&&ta(K.a);const F=I.props&&I.props.onVnodeMounted;F&&Un(F,K.parent,I)},a)},r.deactivate=I=>{const E=I.component;l(I,d,null,1,a),$t(()=>{E.da&&ta(E.da);const S=I.props&&I.props.onVnodeUnmounted;S&&Un(S,E.parent,I),E.isDeactivated=!0},a)};function f(I){Np(I),u(I,n,a,!0)}function p(I){s.forEach((E,S)=>{const $=Hg(E.type);$&&(!I||!I($))&&_(S)})}function _(I){const E=s.get(I);!o||E.type!==o.type?f(E):o&&Np(o),s.delete(I),i.delete(I)}na(()=>[t.include,t.exclude],([I,E])=>{I&&p(S=>Dc(I,S)),E&&p(S=>!Dc(E,S))},{flush:"post",deep:!0});let y=null;const T=()=>{y!=null&&s.set(y,Pp(n.subTree))};return R_(T),e0(T),N_(()=>{s.forEach(I=>{const{subTree:E,suspense:S}=n,$=Pp(E);if(I.type===$.type){Np($);const H=$.component.da;H&&$t(H,S);return}f(I)})}),()=>{if(y=null,!e.default)return null;const I=e.default(),E=I[0];if(I.length>1)return o=null,I;if(!Bh(E)||!(E.shapeFlag&4)&&!(E.shapeFlag&128))return o=null,E;let S=Pp(E);const $=S.type,H=Hg(Bc(S)?S.type.__asyncResolved||{}:$),{include:K,exclude:F,max:ne}=t;if(K&&(!H||!Dc(K,H))||F&&H&&Dc(F,H))return o=S,E;const he=S.key==null?$:S.key,Ce=s.get(he);return S.el&&(S=os(S),E.shapeFlag&128&&(E.ssContent=S)),y=he,Ce?(S.el=Ce.el,S.component=Ce.component,S.transition&&Uh(S,S.transition),S.shapeFlag|=512,i.delete(he),i.add(he)):(i.add(he),ne&&i.size>parseInt(ne,10)&&_(i.values().next().value)),S.shapeFlag|=256,o=S,WS(E.type)?E:S}}},H9=PO;function Dc(t,e){return ee(t)?t.some(n=>Dc(n,e)):yt(t)?t.split(",").includes(e):t.test?t.test(e):!1}function DO(t,e){ZS(t,"a",e)}function xO(t,e){ZS(t,"da",e)}function ZS(t,e,n=At){const r=t.__wdc||(t.__wdc=()=>{let s=n;for(;s;){if(s.isDeactivated)return;s=s.parent}return t()});if(Xd(e,r,n),n){let s=n.parent;for(;s&&s.parent;)Jd(s.parent.vnode)&&OO(r,e,n,s),s=s.parent}}function OO(t,e,n,r){const s=Xd(e,t,r,!0);P_(()=>{g_(r[e],s)},n)}function Np(t){let e=t.shapeFlag;e&256&&(e-=256),e&512&&(e-=512),t.shapeFlag=e}function Pp(t){return t.shapeFlag&128?t.ssContent:t}function Xd(t,e,n=At,r=!1){if(n){const s=n[t]||(n[t]=[]),i=e.__weh||(e.__weh=(...o)=>{if(n.isUnmounted)return;Ba(),ya(n);const a=Hn(e,n,t,o);return Ki(),qa(),a});return r?s.unshift(i):s.push(i),i}}const ds=t=>(e,n=At)=>(!ml||t==="sp")&&Xd(t,e,n),MO=ds("bm"),R_=ds("m"),LO=ds("bu"),e0=ds("u"),N_=ds("bum"),P_=ds("um"),FO=ds("sp"),UO=ds("rtg"),$O=ds("rtc");function VO(t,e=At){Xd("ec",t,e)}function W9(t,e){const n=Vn;if(n===null)return t;const r=tf(n)||n.proxy,s=t.dirs||(t.dirs=[]);for(let i=0;i<e.length;i++){let[o,a,c,l=Me]=e[i];le(o)&&(o={mounted:o,updated:o}),o.deep&&Mi(a),s.push({dir:o,instance:r,value:a,oldValue:void 0,arg:c,modifiers:l})}return t}function _i(t,e,n,r){const s=t.dirs,i=e&&e.dirs;for(let o=0;o<s.length;o++){const a=s[o];i&&(a.oldValue=i[o].value);let c=a.dir[r];c&&(Ba(),Hn(c,n,8,[t.el,a,t,e]),qa())}}const t0="components";function Ns(t,e){return qO(t0,t,!0,e)||t}const BO=Symbol();function qO(t,e,n=!0,r=!1){const s=Vn||At;if(s){const i=s.type;if(t===t0){const a=Hg(i,!1);if(a&&(a===e||a===Dr(e)||a===Hd(Dr(e))))return i}const o=nb(s[t]||i[t],e)||nb(s.appContext[t],e);return!o&&r?i:o}}function nb(t,e){return t&&(t[e]||t[Dr(e)]||t[Hd(Dr(e))])}function G9(t,e,n,r){let s;const i=n&&n[r];if(ee(t)||yt(t)){s=new Array(t.length);for(let o=0,a=t.length;o<a;o++)s[o]=e(t[o],o,void 0,i&&i[o])}else if(typeof t=="number"){s=new Array(t);for(let o=0;o<t;o++)s[o]=e(o+1,o,void 0,i&&i[o])}else if(rt(t))if(t[Symbol.iterator])s=Array.from(t,(o,a)=>e(o,a,void 0,i&&i[a]));else{const o=Object.keys(t);s=new Array(o.length);for(let a=0,c=o.length;a<c;a++){const l=o[a];s[a]=e(t[l],l,a,i&&i[a])}}else s=[];return n&&(n[r]=s),s}const Vg=t=>t?f0(t)?tf(t)||t.proxy:Vg(t.parent):null,$h=Gt(Object.create(null),{$:t=>t,$el:t=>t.vnode.el,$data:t=>t.data,$props:t=>t.props,$attrs:t=>t.attrs,$slots:t=>t.slots,$refs:t=>t.refs,$parent:t=>Vg(t.parent),$root:t=>Vg(t.root),$emit:t=>t.emit,$options:t=>r0(t),$forceUpdate:t=>t.f||(t.f=()=>VS(t.update)),$nextTick:t=>t.n||(t.n=C_.bind(t.proxy)),$watch:t=>kO.bind(t)}),jO={get({_:t},e){const{ctx:n,setupState:r,data:s,props:i,accessCache:o,type:a,appContext:c}=t;let l;if(e[0]!=="$"){const f=o[e];if(f!==void 0)switch(f){case 1:return r[e];case 2:return s[e];case 4:return n[e];case 3:return i[e]}else{if(r!==Me&&ve(r,e))return o[e]=1,r[e];if(s!==Me&&ve(s,e))return o[e]=2,s[e];if((l=t.propsOptions[0])&&ve(l,e))return o[e]=3,i[e];if(n!==Me&&ve(n,e))return o[e]=4,n[e];Bg&&(o[e]=0)}}const u=$h[e];let h,d;if(u)return e==="$attrs"&&Dn(t,"get",e),u(t);if((h=a.__cssModules)&&(h=h[e]))return h;if(n!==Me&&ve(n,e))return o[e]=4,n[e];if(d=c.config.globalProperties,ve(d,e))return d[e]},set({_:t},e,n){const{data:r,setupState:s,ctx:i}=t;return s!==Me&&ve(s,e)?(s[e]=n,!0):r!==Me&&ve(r,e)?(r[e]=n,!0):ve(t.props,e)||e[0]==="$"&&e.slice(1)in t?!1:(i[e]=n,!0)},has({_:{data:t,setupState:e,accessCache:n,ctx:r,appContext:s,propsOptions:i}},o){let a;return!!n[o]||t!==Me&&ve(t,o)||e!==Me&&ve(e,o)||(a=i[0])&&ve(a,o)||ve(r,o)||ve($h,o)||ve(s.config.globalProperties,o)},defineProperty(t,e,n){return n.get!=null?t._.accessCache[e]=0:ve(n,"value")&&this.set(t,e,n.value,null),Reflect.defineProperty(t,e,n)}};let Bg=!0;function KO(t){const e=r0(t),n=t.proxy,r=t.ctx;Bg=!1,e.beforeCreate&&rb(e.beforeCreate,t,"bc");const{data:s,computed:i,methods:o,watch:a,provide:c,inject:l,created:u,beforeMount:h,mounted:d,beforeUpdate:f,updated:p,activated:_,deactivated:y,beforeDestroy:T,beforeUnmount:I,destroyed:E,unmounted:S,render:$,renderTracked:H,renderTriggered:K,errorCaptured:F,serverPrefetch:ne,expose:he,inheritAttrs:Ce,components:z,directives:Re,filters:Ze}=e;if(l&&HO(l,r,null,t.appContext.config.unwrapInjectedRef),o)for(const Ue in o){const Ne=o[Ue];le(Ne)&&(r[Ue]=Ne.bind(n))}if(s){const Ue=s.call(n,n);rt(Ue)&&(t.data=ja(Ue))}if(Bg=!0,i)for(const Ue in i){const Ne=i[Ue],Tn=le(Ne)?Ne.bind(n,n):le(Ne.get)?Ne.get.bind(n,n):or,Lo=!le(Ne)&&le(Ne.set)?Ne.set.bind(n):or,qr=nr({get:Tn,set:Lo});Object.defineProperty(r,Ue,{enumerable:!0,configurable:!0,get:()=>qr.value,set:fr=>qr.value=fr})}if(a)for(const Ue in a)n0(a[Ue],r,n,Ue);if(c){const Ue=le(c)?c.call(n):c;Reflect.ownKeys(Ue).forEach(Ne=>{wh(Ne,Ue[Ne])})}u&&rb(u,t,"c");function tt(Ue,Ne){ee(Ne)?Ne.forEach(Tn=>Ue(Tn.bind(n))):Ne&&Ue(Ne.bind(n))}if(tt(MO,h),tt(R_,d),tt(LO,f),tt(e0,p),tt(DO,_),tt(xO,y),tt(VO,F),tt($O,H),tt(UO,K),tt(N_,I),tt(P_,S),tt(FO,ne),ee(he))if(he.length){const Ue=t.exposed||(t.exposed={});he.forEach(Ne=>{Object.defineProperty(Ue,Ne,{get:()=>n[Ne],set:Tn=>n[Ne]=Tn})})}else t.exposed||(t.exposed={});$&&t.render===or&&(t.render=$),Ce!=null&&(t.inheritAttrs=Ce),z&&(t.components=z),Re&&(t.directives=Re)}function HO(t,e,n=or,r=!1){ee(t)&&(t=qg(t));for(const s in t){const i=t[s];let o;rt(i)?"default"in i?o=Cr(i.from||s,i.default,!0):o=Cr(i.from||s):o=Cr(i),lt(o)&&r?Object.defineProperty(e,s,{enumerable:!0,configurable:!0,get:()=>o.value,set:a=>o.value=a}):e[s]=o}}function rb(t,e,n){Hn(ee(t)?t.map(r=>r.bind(e.proxy)):t.bind(e.proxy),e,n)}function n0(t,e,n,r){const s=r.includes(".")?zS(n,r):()=>n[r];if(yt(t)){const i=e[t];le(i)&&na(s,i)}else if(le(t))na(s,t.bind(n));else if(rt(t))if(ee(t))t.forEach(i=>n0(i,e,n,r));else{const i=le(t.handler)?t.handler.bind(n):e[t.handler];le(i)&&na(s,i,t)}}function r0(t){const e=t.type,{mixins:n,extends:r}=e,{mixins:s,optionsCache:i,config:{optionMergeStrategies:o}}=t.appContext,a=i.get(e);let c;return a?c=a:!s.length&&!n&&!r?c=e:(c={},s.length&&s.forEach(l=>Vh(c,l,o,!0)),Vh(c,e,o)),i.set(e,c),c}function Vh(t,e,n,r=!1){const{mixins:s,extends:i}=e;i&&Vh(t,i,n,!0),s&&s.forEach(o=>Vh(t,o,n,!0));for(const o in e)if(!(r&&o==="expose")){const a=WO[o]||n&&n[o];t[o]=a?a(t[o],e[o]):e[o]}return t}const WO={data:sb,props:Ei,emits:Ei,methods:Ei,computed:Ei,beforeCreate:nn,created:nn,beforeMount:nn,mounted:nn,beforeUpdate:nn,updated:nn,beforeDestroy:nn,beforeUnmount:nn,destroyed:nn,unmounted:nn,activated:nn,deactivated:nn,errorCaptured:nn,serverPrefetch:nn,components:Ei,directives:Ei,watch:zO,provide:sb,inject:GO};function sb(t,e){return e?t?function(){return Gt(le(t)?t.call(this,this):t,le(e)?e.call(this,this):e)}:e:t}function GO(t,e){return Ei(qg(t),qg(e))}function qg(t){if(ee(t)){const e={};for(let n=0;n<t.length;n++)e[t[n]]=t[n];return e}return t}function nn(t,e){return t?[...new Set([].concat(t,e))]:e}function Ei(t,e){return t?Gt(Gt(Object.create(null),t),e):e}function zO(t,e){if(!t)return e;if(!e)return t;const n=Gt(Object.create(null),t);for(const r in e)n[r]=nn(t[r],e[r]);return n}function QO(t,e,n,r=!1){const s={},i={};Mh(i,Zd,1),t.propsDefaults=Object.create(null),s0(t,e,s,i);for(const o in t.propsOptions[0])o in s||(s[o]=void 0);n?t.props=r?s:cO(s):t.type.props?t.props=s:t.props=i,t.attrs=i}function YO(t,e,n,r){const{props:s,attrs:i,vnode:{patchFlag:o}}=t,a=Se(s),[c]=t.propsOptions;let l=!1;if((r||o>0)&&!(o&16)){if(o&8){const u=t.vnode.dynamicProps;for(let h=0;h<u.length;h++){let d=u[h];if(Qd(t.emitsOptions,d))continue;const f=e[d];if(c)if(ve(i,d))f!==i[d]&&(i[d]=f,l=!0);else{const p=Dr(d);s[p]=jg(c,a,p,f,t,!1)}else f!==i[d]&&(i[d]=f,l=!0)}}}else{s0(t,e,s,i)&&(l=!0);let u;for(const h in a)(!e||!ve(e,h)&&((u=Eo(h))===h||!ve(e,u)))&&(c?n&&(n[h]!==void 0||n[u]!==void 0)&&(s[h]=jg(c,a,h,void 0,t,!0)):delete s[h]);if(i!==a)for(const h in i)(!e||!ve(e,h)&&!0)&&(delete i[h],l=!0)}l&&is(t,"set","$attrs")}function s0(t,e,n,r){const[s,i]=t.propsOptions;let o=!1,a;if(e)for(let c in e){if(vh(c))continue;const l=e[c];let u;s&&ve(s,u=Dr(c))?!i||!i.includes(u)?n[u]=l:(a||(a={}))[u]=l:Qd(t.emitsOptions,c)||(!(c in r)||l!==r[c])&&(r[c]=l,o=!0)}if(i){const c=Se(n),l=a||Me;for(let u=0;u<i.length;u++){const h=i[u];n[h]=jg(s,c,h,l[h],t,!ve(l,h))}}return o}function jg(t,e,n,r,s,i){const o=t[n];if(o!=null){const a=ve(o,"default");if(a&&r===void 0){const c=o.default;if(o.type!==Function&&le(c)){const{propsDefaults:l}=s;n in l?r=l[n]:(ya(s),r=l[n]=c.call(null,e),Ki())}else r=c}o[0]&&(i&&!a?r=!1:o[1]&&(r===""||r===Eo(n))&&(r=!0))}return r}function i0(t,e,n=!1){const r=e.propsCache,s=r.get(t);if(s)return s;const i=t.props,o={},a=[];let c=!1;if(!le(t)){const u=h=>{c=!0;const[d,f]=i0(h,e,!0);Gt(o,d),f&&a.push(...f)};!n&&e.mixins.length&&e.mixins.forEach(u),t.extends&&u(t.extends),t.mixins&&t.mixins.forEach(u)}if(!i&&!c)return r.set(t,Zo),Zo;if(ee(i))for(let u=0;u<i.length;u++){const h=Dr(i[u]);ib(h)&&(o[h]=Me)}else if(i)for(const u in i){const h=Dr(u);if(ib(h)){const d=i[u],f=o[h]=ee(d)||le(d)?{type:d}:d;if(f){const p=cb(Boolean,f.type),_=cb(String,f.type);f[0]=p>-1,f[1]=_<0||p<_,(p>-1||ve(f,"default"))&&a.push(h)}}}const l=[o,a];return r.set(t,l),l}function ib(t){return t[0]!=="$"}function ob(t){const e=t&&t.toString().match(/^\s*function (\w+)/);return e?e[1]:t===null?"null":""}function ab(t,e){return ob(t)===ob(e)}function cb(t,e){return ee(e)?e.findIndex(n=>ab(n,t)):le(e)&&ab(e,t)?0:-1}const o0=t=>t[0]==="_"||t==="$stable",D_=t=>ee(t)?t.map(mr):[mr(t)],JO=(t,e,n)=>{if(e._n)return e;const r=Zr((...s)=>D_(e(...s)),n);return r._c=!1,r},a0=(t,e,n)=>{const r=t._ctx;for(const s in t){if(o0(s))continue;const i=t[s];if(le(i))e[s]=JO(s,i,r);else if(i!=null){const o=D_(i);e[s]=()=>o}}},c0=(t,e)=>{const n=D_(e);t.slots.default=()=>n},XO=(t,e)=>{if(t.vnode.shapeFlag&32){const n=e._;n?(t.slots=Se(e),Mh(e,"_",n)):a0(e,t.slots={})}else t.slots={},e&&c0(t,e);Mh(t.slots,Zd,1)},ZO=(t,e,n)=>{const{vnode:r,slots:s}=t;let i=!0,o=Me;if(r.shapeFlag&32){const a=e._;a?n&&a===1?i=!1:(Gt(s,e),!n&&a===1&&delete s._):(i=!e.$stable,a0(e,s)),o=e}else e&&(c0(t,e),o={default:1});if(i)for(const a in s)!o0(a)&&!(a in o)&&delete s[a]};function l0(){return{app:null,config:{isNativeTag:Rx,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let eM=0;function tM(t,e){return function(r,s=null){le(r)||(r=Object.assign({},r)),s!=null&&!rt(s)&&(s=null);const i=l0(),o=new Set;let a=!1;const c=i.app={_uid:eM++,_component:r,_props:s,_container:null,_context:i,_instance:null,version:vM,get config(){return i.config},set config(l){},use(l,...u){return o.has(l)||(l&&le(l.install)?(o.add(l),l.install(c,...u)):le(l)&&(o.add(l),l(c,...u))),c},mixin(l){return i.mixins.includes(l)||i.mixins.push(l),c},component(l,u){return u?(i.components[l]=u,c):i.components[l]},directive(l,u){return u?(i.directives[l]=u,c):i.directives[l]},mount(l,u,h){if(!a){const d=Qe(r,s);return d.appContext=i,u&&e?e(d,l):t(d,l,h),a=!0,c._container=l,l.__vue_app__=c,tf(d.component)||d.component.proxy}},unmount(){a&&(t(null,c._container),delete c._container.__vue_app__)},provide(l,u){return i.provides[l]=u,c}};return c}}function Kg(t,e,n,r,s=!1){if(ee(t)){t.forEach((d,f)=>Kg(d,e&&(ee(e)?e[f]:e),n,r,s));return}if(Bc(r)&&!s)return;const i=r.shapeFlag&4?tf(r.component)||r.component.proxy:r.el,o=s?null:i,{i:a,r:c}=t,l=e&&e.r,u=a.refs===Me?a.refs={}:a.refs,h=a.setupState;if(l!=null&&l!==c&&(yt(l)?(u[l]=null,ve(h,l)&&(h[l]=null)):lt(l)&&(l.value=null)),le(c))Vs(c,a,12,[o,u]);else{const d=yt(c),f=lt(c);if(d||f){const p=()=>{if(t.f){const _=d?u[c]:c.value;s?ee(_)&&g_(_,i):ee(_)?_.includes(i)||_.push(i):d?(u[c]=[i],ve(h,c)&&(h[c]=u[c])):(c.value=[i],t.k&&(u[t.k]=c.value))}else d?(u[c]=o,ve(h,c)&&(h[c]=o)):f&&(c.value=o,t.k&&(u[t.k]=o))};o?(p.id=-1,$t(p,n)):p()}}}const $t=AO;function nM(t){return rM(t)}function rM(t,e){const n=Mx();n.__VUE__=!0;const{insert:r,remove:s,patchProp:i,createElement:o,createText:a,createComment:c,setText:l,setElementText:u,parentNode:h,nextSibling:d,setScopeId:f=or,cloneNode:p,insertStaticContent:_}=t,y=(g,m,b,R=null,A=null,L=null,j=!1,M=null,V=!!m.dynamicChildren)=>{if(g===m)return;g&&!ki(g,m)&&(R=J(g),Ln(g,A,L,!0),g=null),m.patchFlag===-2&&(V=!1,m.dynamicChildren=null);const{type:D,ref:X,shapeFlag:Q}=m;switch(D){case x_:T(g,m,b,R);break;case ar:I(g,m,b,R);break;case bh:g==null&&E(m,b,R,j);break;case er:Re(g,m,b,R,A,L,j,M,V);break;default:Q&1?H(g,m,b,R,A,L,j,M,V):Q&6?Ze(g,m,b,R,A,L,j,M,V):(Q&64||Q&128)&&D.process(g,m,b,R,A,L,j,M,V,$e)}X!=null&&A&&Kg(X,g&&g.ref,L,m||g,!m)},T=(g,m,b,R)=>{if(g==null)r(m.el=a(m.children),b,R);else{const A=m.el=g.el;m.children!==g.children&&l(A,m.children)}},I=(g,m,b,R)=>{g==null?r(m.el=c(m.children||""),b,R):m.el=g.el},E=(g,m,b,R)=>{[g.el,g.anchor]=_(g.children,m,b,R,g.el,g.anchor)},S=({el:g,anchor:m},b,R)=>{let A;for(;g&&g!==m;)A=d(g),r(g,b,R),g=A;r(m,b,R)},$=({el:g,anchor:m})=>{let b;for(;g&&g!==m;)b=d(g),s(g),g=b;s(m)},H=(g,m,b,R,A,L,j,M,V)=>{j=j||m.type==="svg",g==null?K(m,b,R,A,L,j,M,V):he(g,m,A,L,j,M,V)},K=(g,m,b,R,A,L,j,M)=>{let V,D;const{type:X,props:Q,shapeFlag:Z,transition:ae,patchFlag:be,dirs:De}=g;if(g.el&&p!==void 0&&be===-1)V=g.el=p(g.el);else{if(V=g.el=o(g.type,L,Q&&Q.is,Q),Z&8?u(V,g.children):Z&16&&ne(g.children,V,null,R,A,L&&X!=="foreignObject",j,M),De&&_i(g,null,R,"created"),Q){for(const je in Q)je!=="value"&&!vh(je)&&i(V,je,null,Q[je],L,g.children,R,A,B);"value"in Q&&i(V,"value",null,Q.value),(D=Q.onVnodeBeforeMount)&&Un(D,R,g)}F(V,g,g.scopeId,j,R)}De&&_i(g,null,R,"beforeMount");const xe=(!A||A&&!A.pendingBranch)&&ae&&!ae.persisted;xe&&ae.beforeEnter(V),r(V,m,b),((D=Q&&Q.onVnodeMounted)||xe||De)&&$t(()=>{D&&Un(D,R,g),xe&&ae.enter(V),De&&_i(g,null,R,"mounted")},A)},F=(g,m,b,R,A)=>{if(b&&f(g,b),R)for(let L=0;L<R.length;L++)f(g,R[L]);if(A){let L=A.subTree;if(m===L){const j=A.vnode;F(g,j,j.scopeId,j.slotScopeIds,A.parent)}}},ne=(g,m,b,R,A,L,j,M,V=0)=>{for(let D=V;D<g.length;D++){const X=g[D]=M?ks(g[D]):mr(g[D]);y(null,X,m,b,R,A,L,j,M)}},he=(g,m,b,R,A,L,j)=>{const M=m.el=g.el;let{patchFlag:V,dynamicChildren:D,dirs:X}=m;V|=g.patchFlag&16;const Q=g.props||Me,Z=m.props||Me;let ae;b&&yi(b,!1),(ae=Z.onVnodeBeforeUpdate)&&Un(ae,b,m,g),X&&_i(m,g,b,"beforeUpdate"),b&&yi(b,!0);const be=A&&m.type!=="foreignObject";if(D?Ce(g.dynamicChildren,D,M,b,R,be,L):j||Tn(g,m,M,null,b,R,be,L,!1),V>0){if(V&16)z(M,m,Q,Z,b,R,A);else if(V&2&&Q.class!==Z.class&&i(M,"class",null,Z.class,A),V&4&&i(M,"style",Q.style,Z.style,A),V&8){const De=m.dynamicProps;for(let xe=0;xe<De.length;xe++){const je=De[xe],Jn=Q[je],Fo=Z[je];(Fo!==Jn||je==="value")&&i(M,je,Jn,Fo,A,g.children,b,R,B)}}V&1&&g.children!==m.children&&u(M,m.children)}else!j&&D==null&&z(M,m,Q,Z,b,R,A);((ae=Z.onVnodeUpdated)||X)&&$t(()=>{ae&&Un(ae,b,m,g),X&&_i(m,g,b,"updated")},R)},Ce=(g,m,b,R,A,L,j)=>{for(let M=0;M<m.length;M++){const V=g[M],D=m[M],X=V.el&&(V.type===er||!ki(V,D)||V.shapeFlag&70)?h(V.el):b;y(V,D,X,null,R,A,L,j,!0)}},z=(g,m,b,R,A,L,j)=>{if(b!==R){for(const M in R){if(vh(M))continue;const V=R[M],D=b[M];V!==D&&M!=="value"&&i(g,M,D,V,j,m.children,A,L,B)}if(b!==Me)for(const M in b)!vh(M)&&!(M in R)&&i(g,M,b[M],null,j,m.children,A,L,B);"value"in R&&i(g,"value",b.value,R.value)}},Re=(g,m,b,R,A,L,j,M,V)=>{const D=m.el=g?g.el:a(""),X=m.anchor=g?g.anchor:a("");let{patchFlag:Q,dynamicChildren:Z,slotScopeIds:ae}=m;ae&&(M=M?M.concat(ae):ae),g==null?(r(D,b,R),r(X,b,R),ne(m.children,b,X,A,L,j,M,V)):Q>0&&Q&64&&Z&&g.dynamicChildren?(Ce(g.dynamicChildren,Z,b,A,L,j,M),(m.key!=null||A&&m===A.subTree)&&u0(g,m,!0)):Tn(g,m,b,X,A,L,j,M,V)},Ze=(g,m,b,R,A,L,j,M,V)=>{m.slotScopeIds=M,g==null?m.shapeFlag&512?A.ctx.activate(m,b,R,j,V):et(m,b,R,A,L,j,V):tt(g,m,V)},et=(g,m,b,R,A,L,j)=>{const M=g.component=fM(g,R,A);if(Jd(g)&&(M.ctx.renderer=$e),pM(M),M.asyncDep){if(A&&A.registerDep(M,Ue),!g.el){const V=M.subTree=Qe(ar);I(null,V,m,b)}return}Ue(M,g,m,b,A,L,j)},tt=(g,m,b)=>{const R=m.component=g.component;if(SO(g,m,b))if(R.asyncDep&&!R.asyncResolved){Ne(R,m,b);return}else R.next=m,vO(R.update),R.update();else m.el=g.el,R.vnode=m},Ue=(g,m,b,R,A,L,j)=>{const M=()=>{if(g.isMounted){let{next:X,bu:Q,u:Z,parent:ae,vnode:be}=g,De=X,xe;yi(g,!1),X?(X.el=be.el,Ne(g,X,j)):X=be,Q&&ta(Q),(xe=X.props&&X.props.onVnodeBeforeUpdate)&&Un(xe,ae,X,be),yi(g,!0);const je=kp(g),Jn=g.subTree;g.subTree=je,y(Jn,je,h(Jn.el),J(Jn),g,A,L),X.el=je.el,De===null&&CO(g,je.el),Z&&$t(Z,A),(xe=X.props&&X.props.onVnodeUpdated)&&$t(()=>Un(xe,ae,X,be),A)}else{let X;const{el:Q,props:Z}=m,{bm:ae,m:be,parent:De}=g,xe=Bc(m);if(yi(g,!1),ae&&ta(ae),!xe&&(X=Z&&Z.onVnodeBeforeMount)&&Un(X,De,m),yi(g,!0),Q&&de){const je=()=>{g.subTree=kp(g),de(Q,g.subTree,g,A,null)};xe?m.type.__asyncLoader().then(()=>!g.isUnmounted&&je()):je()}else{const je=g.subTree=kp(g);y(null,je,b,R,g,A,L),m.el=je.el}if(be&&$t(be,A),!xe&&(X=Z&&Z.onVnodeMounted)){const je=m;$t(()=>Un(X,De,je),A)}(m.shapeFlag&256||De&&Bc(De.vnode)&&De.vnode.shapeFlag&256)&&g.a&&$t(g.a,A),g.isMounted=!0,m=b=R=null}},V=g.effect=new y_(M,()=>VS(D),g.scope),D=g.update=()=>V.run();D.id=g.uid,yi(g,!0),D()},Ne=(g,m,b)=>{m.component=g;const R=g.vnode.props;g.vnode=m,g.next=null,YO(g,m.props,R,b),ZO(g,m.children,b),Ba(),zd(void 0,g.update),qa()},Tn=(g,m,b,R,A,L,j,M,V=!1)=>{const D=g&&g.children,X=g?g.shapeFlag:0,Q=m.children,{patchFlag:Z,shapeFlag:ae}=m;if(Z>0){if(Z&128){qr(D,Q,b,R,A,L,j,M,V);return}else if(Z&256){Lo(D,Q,b,R,A,L,j,M,V);return}}ae&8?(X&16&&B(D,A,L),Q!==D&&u(b,Q)):X&16?ae&16?qr(D,Q,b,R,A,L,j,M,V):B(D,A,L,!0):(X&8&&u(b,""),ae&16&&ne(Q,b,R,A,L,j,M,V))},Lo=(g,m,b,R,A,L,j,M,V)=>{g=g||Zo,m=m||Zo;const D=g.length,X=m.length,Q=Math.min(D,X);let Z;for(Z=0;Z<Q;Z++){const ae=m[Z]=V?ks(m[Z]):mr(m[Z]);y(g[Z],ae,b,null,A,L,j,M,V)}D>X?B(g,A,L,!0,!1,Q):ne(m,b,R,A,L,j,M,V,Q)},qr=(g,m,b,R,A,L,j,M,V)=>{let D=0;const X=m.length;let Q=g.length-1,Z=X-1;for(;D<=Q&&D<=Z;){const ae=g[D],be=m[D]=V?ks(m[D]):mr(m[D]);if(ki(ae,be))y(ae,be,b,null,A,L,j,M,V);else break;D++}for(;D<=Q&&D<=Z;){const ae=g[Q],be=m[Z]=V?ks(m[Z]):mr(m[Z]);if(ki(ae,be))y(ae,be,b,null,A,L,j,M,V);else break;Q--,Z--}if(D>Q){if(D<=Z){const ae=Z+1,be=ae<X?m[ae].el:R;for(;D<=Z;)y(null,m[D]=V?ks(m[D]):mr(m[D]),b,be,A,L,j,M,V),D++}}else if(D>Z)for(;D<=Q;)Ln(g[D],A,L,!0),D++;else{const ae=D,be=D,De=new Map;for(D=be;D<=Z;D++){const Sn=m[D]=V?ks(m[D]):mr(m[D]);Sn.key!=null&&De.set(Sn.key,D)}let xe,je=0;const Jn=Z-be+1;let Fo=!1,Bw=0;const dc=new Array(Jn);for(D=0;D<Jn;D++)dc[D]=0;for(D=ae;D<=Q;D++){const Sn=g[D];if(je>=Jn){Ln(Sn,A,L,!0);continue}let pr;if(Sn.key!=null)pr=De.get(Sn.key);else for(xe=be;xe<=Z;xe++)if(dc[xe-be]===0&&ki(Sn,m[xe])){pr=xe;break}pr===void 0?Ln(Sn,A,L,!0):(dc[pr-be]=D+1,pr>=Bw?Bw=pr:Fo=!0,y(Sn,m[pr],b,null,A,L,j,M,V),je++)}const qw=Fo?sM(dc):Zo;for(xe=qw.length-1,D=Jn-1;D>=0;D--){const Sn=be+D,pr=m[Sn],jw=Sn+1<X?m[Sn+1].el:R;dc[D]===0?y(null,pr,b,jw,A,L,j,M,V):Fo&&(xe<0||D!==qw[xe]?fr(pr,b,jw,2):xe--)}}},fr=(g,m,b,R,A=null)=>{const{el:L,type:j,transition:M,children:V,shapeFlag:D}=g;if(D&6){fr(g.component.subTree,m,b,R);return}if(D&128){g.suspense.move(m,b,R);return}if(D&64){j.move(g,m,b,$e);return}if(j===er){r(L,m,b);for(let Q=0;Q<V.length;Q++)fr(V[Q],m,b,R);r(g.anchor,m,b);return}if(j===bh){S(g,m,b);return}if(R!==2&&D&1&&M)if(R===0)M.beforeEnter(L),r(L,m,b),$t(()=>M.enter(L),A);else{const{leave:Q,delayLeave:Z,afterLeave:ae}=M,be=()=>r(L,m,b),De=()=>{Q(L,()=>{be(),ae&&ae()})};Z?Z(L,be,De):De()}else r(L,m,b)},Ln=(g,m,b,R=!1,A=!1)=>{const{type:L,props:j,ref:M,children:V,dynamicChildren:D,shapeFlag:X,patchFlag:Q,dirs:Z}=g;if(M!=null&&Kg(M,null,b,g,!0),X&256){m.ctx.deactivate(g);return}const ae=X&1&&Z,be=!Bc(g);let De;if(be&&(De=j&&j.onVnodeBeforeUnmount)&&Un(De,m,g),X&6)Y(g.component,b,R);else{if(X&128){g.suspense.unmount(b,R);return}ae&&_i(g,null,m,"beforeUnmount"),X&64?g.type.remove(g,m,b,A,$e,R):D&&(L!==er||Q>0&&Q&64)?B(D,m,b,!1,!0):(L===er&&Q&384||!A&&X&16)&&B(V,m,b),R&&Cp(g)}(be&&(De=j&&j.onVnodeUnmounted)||ae)&&$t(()=>{De&&Un(De,m,g),ae&&_i(g,null,m,"unmounted")},b)},Cp=g=>{const{type:m,el:b,anchor:R,transition:A}=g;if(m===er){C(b,R);return}if(m===bh){$(g);return}const L=()=>{s(b),A&&!A.persisted&&A.afterLeave&&A.afterLeave()};if(g.shapeFlag&1&&A&&!A.persisted){const{leave:j,delayLeave:M}=A,V=()=>j(b,L);M?M(g.el,L,V):V()}else L()},C=(g,m)=>{let b;for(;g!==m;)b=d(g),s(g),g=b;s(m)},Y=(g,m,b)=>{const{bum:R,scope:A,update:L,subTree:j,um:M}=g;R&&ta(R),A.stop(),L&&(L.active=!1,Ln(j,g,m,b)),M&&$t(M,m),$t(()=>{g.isUnmounted=!0},m),m&&m.pendingBranch&&!m.isUnmounted&&g.asyncDep&&!g.asyncResolved&&g.suspenseId===m.pendingId&&(m.deps--,m.deps===0&&m.resolve())},B=(g,m,b,R=!1,A=!1,L=0)=>{for(let j=L;j<g.length;j++)Ln(g[j],m,b,R,A)},J=g=>g.shapeFlag&6?J(g.component.subTree):g.shapeFlag&128?g.suspense.next():d(g.anchor||g.el),Pe=(g,m,b)=>{g==null?m._vnode&&Ln(m._vnode,null,null,!0):y(m._vnode||null,g,m,null,null,null,b),jS(),m._vnode=g},$e={p:y,um:Ln,m:fr,r:Cp,mt:et,mc:ne,pc:Tn,pbc:Ce,n:J,o:t};let _e,de;return e&&([_e,de]=e($e)),{render:Pe,hydrate:_e,createApp:tM(Pe,_e)}}function yi({effect:t,update:e},n){t.allowRecurse=e.allowRecurse=n}function u0(t,e,n=!1){const r=t.children,s=e.children;if(ee(r)&&ee(s))for(let i=0;i<r.length;i++){const o=r[i];let a=s[i];a.shapeFlag&1&&!a.dynamicChildren&&((a.patchFlag<=0||a.patchFlag===32)&&(a=s[i]=ks(s[i]),a.el=o.el),n||u0(o,a))}}function sM(t){const e=t.slice(),n=[0];let r,s,i,o,a;const c=t.length;for(r=0;r<c;r++){const l=t[r];if(l!==0){if(s=n[n.length-1],t[s]<l){e[r]=s,n.push(r);continue}for(i=0,o=n.length-1;i<o;)a=i+o>>1,t[n[a]]<l?i=a+1:o=a;l<t[n[i]]&&(i>0&&(e[r]=n[i-1]),n[i]=r)}}for(i=n.length,o=n[i-1];i-- >0;)n[i]=o,o=e[o];return n}const iM=t=>t.__isTeleport,er=Symbol(void 0),x_=Symbol(void 0),ar=Symbol(void 0),bh=Symbol(void 0),qc=[];let rr=null;function Ir(t=!1){qc.push(rr=t?null:[])}function oM(){qc.pop(),rr=qc[qc.length-1]||null}let gl=1;function lb(t){gl+=t}function h0(t){return t.dynamicChildren=gl>0?rr||Zo:null,oM(),gl>0&&rr&&rr.push(t),t}function _a(t,e,n,r,s,i){return h0(Ke(t,e,n,r,s,i,!0))}function Ih(t,e,n,r,s){return h0(Qe(t,e,n,r,s,!0))}function Bh(t){return t?t.__v_isVNode===!0:!1}function ki(t,e){return t.type===e.type&&t.key===e.key}const Zd="__vInternal",d0=({key:t})=>t!=null?t:null,Eh=({ref:t,ref_key:e,ref_for:n})=>t!=null?yt(t)||lt(t)||le(t)?{i:Vn,r:t,k:e,f:!!n}:t:null;function Ke(t,e=null,n=null,r=0,s=null,i=t===er?0:1,o=!1,a=!1){const c={__v_isVNode:!0,__v_skip:!0,type:t,props:e,key:e&&d0(e),ref:e&&Eh(e),scopeId:Yd,slotScopeIds:null,children:n,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:i,patchFlag:r,dynamicProps:s,dynamicChildren:null,appContext:null};return a?(O_(c,n),i&128&&t.normalize(c)):n&&(c.shapeFlag|=yt(n)?8:16),gl>0&&!o&&rr&&(c.patchFlag>0||i&6)&&c.patchFlag!==32&&rr.push(c),c}const Qe=aM;function aM(t,e=null,n=null,r=0,s=null,i=!1){if((!t||t===BO)&&(t=ar),Bh(t)){const a=os(t,e,!0);return n&&O_(a,n),gl>0&&!i&&rr&&(a.shapeFlag&6?rr[rr.indexOf(t)]=a:rr.push(a)),a.patchFlag|=-2,a}if(yM(t)&&(t=t.__vccOpts),e){e=cM(e);let{class:a,style:c}=e;a&&!yt(a)&&(e.class=f_(a)),rt(c)&&(OS(c)&&!ee(c)&&(c=Gt({},c)),e.style=d_(c))}const o=yt(t)?1:WS(t)?128:iM(t)?64:rt(t)?4:le(t)?2:0;return Ke(t,e,n,r,s,o,i,!0)}function cM(t){return t?OS(t)||Zd in t?Gt({},t):t:null}function os(t,e,n=!1){const{props:r,ref:s,patchFlag:i,children:o}=t,a=e?uM(r||{},e):r;return{__v_isVNode:!0,__v_skip:!0,type:t.type,props:a,key:a&&d0(a),ref:e&&e.ref?n&&s?ee(s)?s.concat(Eh(e)):[s,Eh(e)]:Eh(e):s,scopeId:t.scopeId,slotScopeIds:t.slotScopeIds,children:o,target:t.target,targetAnchor:t.targetAnchor,staticCount:t.staticCount,shapeFlag:t.shapeFlag,patchFlag:e&&t.type!==er?i===-1?16:i|16:i,dynamicProps:t.dynamicProps,dynamicChildren:t.dynamicChildren,appContext:t.appContext,dirs:t.dirs,transition:t.transition,component:t.component,suspense:t.suspense,ssContent:t.ssContent&&os(t.ssContent),ssFallback:t.ssFallback&&os(t.ssFallback),el:t.el,anchor:t.anchor}}function ai(t=" ",e=0){return Qe(x_,null,t,e)}function lM(t,e){const n=Qe(bh,null,t);return n.staticCount=e,n}function jc(t="",e=!1){return e?(Ir(),Ih(ar,null,t)):Qe(ar,null,t)}function mr(t){return t==null||typeof t=="boolean"?Qe(ar):ee(t)?Qe(er,null,t.slice()):typeof t=="object"?ks(t):Qe(x_,null,String(t))}function ks(t){return t.el===null||t.memo?t:os(t)}function O_(t,e){let n=0;const{shapeFlag:r}=t;if(e==null)e=null;else if(ee(e))n=16;else if(typeof e=="object")if(r&65){const s=e.default;s&&(s._c&&(s._d=!1),O_(t,s()),s._c&&(s._d=!0));return}else{n=32;const s=e._;!s&&!(Zd in e)?e._ctx=Vn:s===3&&Vn&&(Vn.slots._===1?e._=1:(e._=2,t.patchFlag|=1024))}else le(e)?(e={default:e,_ctx:Vn},n=32):(e=String(e),r&64?(n=16,e=[ai(e)]):n=8);t.children=e,t.shapeFlag|=n}function uM(...t){const e={};for(let n=0;n<t.length;n++){const r=t[n];for(const s in r)if(s==="class")e.class!==r.class&&(e.class=f_([e.class,r.class]));else if(s==="style")e.style=d_([e.style,r.style]);else if(qd(s)){const i=e[s],o=r[s];o&&i!==o&&!(ee(i)&&i.includes(o))&&(e[s]=i?[].concat(i,o):o)}else s!==""&&(e[s]=r[s])}return e}function Un(t,e,n,r=null){Hn(t,e,7,[n,r])}const hM=l0();let dM=0;function fM(t,e,n){const r=t.type,s=(e?e.appContext:t.appContext)||hM,i={uid:dM++,vnode:t,type:r,parent:e,appContext:s,root:null,next:null,subTree:null,effect:null,update:null,scope:new bS(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:e?e.provides:Object.create(s.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:i0(r,s),emitsOptions:HS(r,s),emit:null,emitted:null,propsDefaults:Me,inheritAttrs:r.inheritAttrs,ctx:Me,data:Me,props:Me,attrs:Me,slots:Me,refs:Me,setupState:Me,setupContext:null,suspense:n,suspenseId:n?n.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return i.ctx={_:i},i.root=e?e.root:i,i.emit=IO.bind(null,i),t.ce&&t.ce(i),i}let At=null;const ef=()=>At||Vn,ya=t=>{At=t,t.scope.on()},Ki=()=>{At&&At.scope.off(),At=null};function f0(t){return t.vnode.shapeFlag&4}let ml=!1;function pM(t,e=!1){ml=e;const{props:n,children:r}=t.vnode,s=f0(t);QO(t,n,s,e),XO(t,r);const i=s?gM(t,e):void 0;return ml=!1,i}function gM(t,e){const n=t.type;t.accessCache=Object.create(null),t.proxy=ma(new Proxy(t.ctx,jO));const{setup:r}=n;if(r){const s=t.setupContext=r.length>1?_M(t):null;ya(t),Ba();const i=Vs(r,t,0,[t.props,s]);if(qa(),Ki(),yS(i)){if(i.then(Ki,Ki),e)return i.then(o=>{ub(t,o,e)}).catch(o=>{Gd(o,t,0)});t.asyncDep=i}else ub(t,i,e)}else p0(t,e)}function ub(t,e,n){le(e)?t.type.__ssrInlineRender?t.ssrRender=e:t.render=e:rt(e)&&(t.setupState=US(e)),p0(t,n)}let hb;function p0(t,e,n){const r=t.type;if(!t.render){if(!e&&hb&&!r.render){const s=r.template;if(s){const{isCustomElement:i,compilerOptions:o}=t.appContext.config,{delimiters:a,compilerOptions:c}=r,l=Gt(Gt({isCustomElement:i,delimiters:a},o),c);r.render=hb(s,l)}}t.render=r.render||or}ya(t),Ba(),KO(t),qa(),Ki()}function mM(t){return new Proxy(t.attrs,{get(e,n){return Dn(t,"get","$attrs"),e[n]}})}function _M(t){const e=r=>{t.exposed=r||{}};let n;return{get attrs(){return n||(n=mM(t))},slots:t.slots,emit:t.emit,expose:e}}function tf(t){if(t.exposed)return t.exposeProxy||(t.exposeProxy=new Proxy(US(ma(t.exposed)),{get(e,n){if(n in e)return e[n];if(n in $h)return $h[n](t)}}))}function Hg(t,e=!0){return le(t)?t.displayName||t.name:t.name||e&&t.__name}function yM(t){return le(t)&&"__vccOpts"in t}const nr=(t,e)=>mO(t,e,ml);function M_(t,e,n){const r=arguments.length;return r===2?rt(e)&&!ee(e)?Bh(e)?Qe(t,null,[e]):Qe(t,e):Qe(t,null,e):(r>3?n=Array.prototype.slice.call(arguments,2):r===3&&Bh(n)&&(n=[n]),Qe(t,e,n))}const vM="3.2.37",wM="http://www.w3.org/2000/svg",Ri=typeof document!="undefined"?document:null,db=Ri&&Ri.createElement("template"),bM={insert:(t,e,n)=>{e.insertBefore(t,n||null)},remove:t=>{const e=t.parentNode;e&&e.removeChild(t)},createElement:(t,e,n,r)=>{const s=e?Ri.createElementNS(wM,t):Ri.createElement(t,n?{is:n}:void 0);return t==="select"&&r&&r.multiple!=null&&s.setAttribute("multiple",r.multiple),s},createText:t=>Ri.createTextNode(t),createComment:t=>Ri.createComment(t),setText:(t,e)=>{t.nodeValue=e},setElementText:(t,e)=>{t.textContent=e},parentNode:t=>t.parentNode,nextSibling:t=>t.nextSibling,querySelector:t=>Ri.querySelector(t),setScopeId(t,e){t.setAttribute(e,"")},cloneNode(t){const e=t.cloneNode(!0);return"_value"in t&&(e._value=t._value),e},insertStaticContent(t,e,n,r,s,i){const o=n?n.previousSibling:e.lastChild;if(s&&(s===i||s.nextSibling))for(;e.insertBefore(s.cloneNode(!0),n),!(s===i||!(s=s.nextSibling)););else{db.innerHTML=r?`<svg>${t}</svg>`:t;const a=db.content;if(r){const c=a.firstChild;for(;c.firstChild;)a.appendChild(c.firstChild);a.removeChild(c)}e.insertBefore(a,n)}return[o?o.nextSibling:e.firstChild,n?n.previousSibling:e.lastChild]}};function IM(t,e,n){const r=t._vtc;r&&(e=(e?[e,...r]:[...r]).join(" ")),e==null?t.removeAttribute("class"):n?t.setAttribute("class",e):t.className=e}function EM(t,e,n){const r=t.style,s=yt(n);if(n&&!s){for(const i in n)Wg(r,i,n[i]);if(e&&!yt(e))for(const i in e)n[i]==null&&Wg(r,i,"")}else{const i=r.display;s?e!==n&&(r.cssText=n):e&&t.removeAttribute("style"),"_vod"in t&&(r.display=i)}}const fb=/\s*!important$/;function Wg(t,e,n){if(ee(n))n.forEach(r=>Wg(t,e,r));else if(n==null&&(n=""),e.startsWith("--"))t.setProperty(e,n);else{const r=TM(t,e);fb.test(n)?t.setProperty(Eo(r),n.replace(fb,""),"important"):t[r]=n}}const pb=["Webkit","Moz","ms"],Dp={};function TM(t,e){const n=Dp[e];if(n)return n;let r=Dr(e);if(r!=="filter"&&r in t)return Dp[e]=r;r=Hd(r);for(let s=0;s<pb.length;s++){const i=pb[s]+r;if(i in t)return Dp[e]=i}return e}const gb="http://www.w3.org/1999/xlink";function SM(t,e,n,r,s){if(r&&e.startsWith("xlink:"))n==null?t.removeAttributeNS(gb,e.slice(6,e.length)):t.setAttributeNS(gb,e,n);else{const i=Ex(e);n==null||i&&!mS(n)?t.removeAttribute(e):t.setAttribute(e,i?"":n)}}function CM(t,e,n,r,s,i,o){if(e==="innerHTML"||e==="textContent"){r&&o(r,s,i),t[e]=n==null?"":n;return}if(e==="value"&&t.tagName!=="PROGRESS"&&!t.tagName.includes("-")){t._value=n;const c=n==null?"":n;(t.value!==c||t.tagName==="OPTION")&&(t.value=c),n==null&&t.removeAttribute(e);return}let a=!1;if(n===""||n==null){const c=typeof t[e];c==="boolean"?n=mS(n):n==null&&c==="string"?(n="",a=!0):c==="number"&&(n=0,a=!0)}try{t[e]=n}catch{}a&&t.removeAttribute(e)}const[g0,AM]=(()=>{let t=Date.now,e=!1;if(typeof window!="undefined"){Date.now()>document.createEvent("Event").timeStamp&&(t=performance.now.bind(performance));const n=navigator.userAgent.match(/firefox\/(\d+)/i);e=!!(n&&Number(n[1])<=53)}return[t,e]})();let Gg=0;const kM=Promise.resolve(),RM=()=>{Gg=0},NM=()=>Gg||(kM.then(RM),Gg=g0());function Ps(t,e,n,r){t.addEventListener(e,n,r)}function PM(t,e,n,r){t.removeEventListener(e,n,r)}function DM(t,e,n,r,s=null){const i=t._vei||(t._vei={}),o=i[e];if(r&&o)o.value=r;else{const[a,c]=xM(e);if(r){const l=i[e]=OM(r,s);Ps(t,a,l,c)}else o&&(PM(t,a,o,c),i[e]=void 0)}}const mb=/(?:Once|Passive|Capture)$/;function xM(t){let e;if(mb.test(t)){e={};let n;for(;n=t.match(mb);)t=t.slice(0,t.length-n[0].length),e[n[0].toLowerCase()]=!0}return[Eo(t.slice(2)),e]}function OM(t,e){const n=r=>{const s=r.timeStamp||g0();(AM||s>=n.attached-1)&&Hn(MM(r,n.value),e,5,[r])};return n.value=t,n.attached=NM(),n}function MM(t,e){if(ee(e)){const n=t.stopImmediatePropagation;return t.stopImmediatePropagation=()=>{n.call(t),t._stopped=!0},e.map(r=>s=>!s._stopped&&r&&r(s))}else return e}const _b=/^on[a-z]/,LM=(t,e,n,r,s=!1,i,o,a,c)=>{e==="class"?IM(t,r,s):e==="style"?EM(t,n,r):qd(e)?p_(e)||DM(t,e,n,r,o):(e[0]==="."?(e=e.slice(1),!0):e[0]==="^"?(e=e.slice(1),!1):FM(t,e,r,s))?CM(t,e,r,i,o,a,c):(e==="true-value"?t._trueValue=r:e==="false-value"&&(t._falseValue=r),SM(t,e,r,s))};function FM(t,e,n,r){return r?!!(e==="innerHTML"||e==="textContent"||e in t&&_b.test(e)&&le(n)):e==="spellcheck"||e==="draggable"||e==="translate"||e==="form"||e==="list"&&t.tagName==="INPUT"||e==="type"&&t.tagName==="TEXTAREA"||_b.test(e)&&yt(n)?!1:e in t}const ws="transition",fc="animation",L_=(t,{slots:e})=>M_(QS,UM(t),e);L_.displayName="Transition";const m0={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String};L_.props=Gt({},QS.props,m0);const vi=(t,e=[])=>{ee(t)?t.forEach(n=>n(...e)):t&&t(...e)},yb=t=>t?ee(t)?t.some(e=>e.length>1):t.length>1:!1;function UM(t){const e={};for(const z in t)z in m0||(e[z]=t[z]);if(t.css===!1)return e;const{name:n="v",type:r,duration:s,enterFromClass:i=`${n}-enter-from`,enterActiveClass:o=`${n}-enter-active`,enterToClass:a=`${n}-enter-to`,appearFromClass:c=i,appearActiveClass:l=o,appearToClass:u=a,leaveFromClass:h=`${n}-leave-from`,leaveActiveClass:d=`${n}-leave-active`,leaveToClass:f=`${n}-leave-to`}=t,p=$M(s),_=p&&p[0],y=p&&p[1],{onBeforeEnter:T,onEnter:I,onEnterCancelled:E,onLeave:S,onLeaveCancelled:$,onBeforeAppear:H=T,onAppear:K=I,onAppearCancelled:F=E}=e,ne=(z,Re,Ze)=>{wi(z,Re?u:a),wi(z,Re?l:o),Ze&&Ze()},he=(z,Re)=>{z._isLeaving=!1,wi(z,h),wi(z,f),wi(z,d),Re&&Re()},Ce=z=>(Re,Ze)=>{const et=z?K:I,tt=()=>ne(Re,z,Ze);vi(et,[Re,tt]),vb(()=>{wi(Re,z?c:i),bs(Re,z?u:a),yb(et)||wb(Re,r,_,tt)})};return Gt(e,{onBeforeEnter(z){vi(T,[z]),bs(z,i),bs(z,o)},onBeforeAppear(z){vi(H,[z]),bs(z,c),bs(z,l)},onEnter:Ce(!1),onAppear:Ce(!0),onLeave(z,Re){z._isLeaving=!0;const Ze=()=>he(z,Re);bs(z,h),qM(),bs(z,d),vb(()=>{!z._isLeaving||(wi(z,h),bs(z,f),yb(S)||wb(z,r,y,Ze))}),vi(S,[z,Ze])},onEnterCancelled(z){ne(z,!1),vi(E,[z])},onAppearCancelled(z){ne(z,!0),vi(F,[z])},onLeaveCancelled(z){he(z),vi($,[z])}})}function $M(t){if(t==null)return null;if(rt(t))return[xp(t.enter),xp(t.leave)];{const e=xp(t);return[e,e]}}function xp(t){return hl(t)}function bs(t,e){e.split(/\s+/).forEach(n=>n&&t.classList.add(n)),(t._vtc||(t._vtc=new Set)).add(e)}function wi(t,e){e.split(/\s+/).forEach(r=>r&&t.classList.remove(r));const{_vtc:n}=t;n&&(n.delete(e),n.size||(t._vtc=void 0))}function vb(t){requestAnimationFrame(()=>{requestAnimationFrame(t)})}let VM=0;function wb(t,e,n,r){const s=t._endId=++VM,i=()=>{s===t._endId&&r()};if(n)return setTimeout(i,n);const{type:o,timeout:a,propCount:c}=BM(t,e);if(!o)return r();const l=o+"end";let u=0;const h=()=>{t.removeEventListener(l,d),i()},d=f=>{f.target===t&&++u>=c&&h()};setTimeout(()=>{u<c&&h()},a+1),t.addEventListener(l,d)}function BM(t,e){const n=window.getComputedStyle(t),r=p=>(n[p]||"").split(", "),s=r(ws+"Delay"),i=r(ws+"Duration"),o=bb(s,i),a=r(fc+"Delay"),c=r(fc+"Duration"),l=bb(a,c);let u=null,h=0,d=0;e===ws?o>0&&(u=ws,h=o,d=i.length):e===fc?l>0&&(u=fc,h=l,d=c.length):(h=Math.max(o,l),u=h>0?o>l?ws:fc:null,d=u?u===ws?i.length:c.length:0);const f=u===ws&&/\b(transform|all)(,|$)/.test(n[ws+"Property"]);return{type:u,timeout:h,propCount:d,hasTransform:f}}function bb(t,e){for(;t.length<e.length;)t=t.concat(t);return Math.max(...e.map((n,r)=>Ib(n)+Ib(t[r])))}function Ib(t){return Number(t.slice(0,-1).replace(",","."))*1e3}function qM(){return document.body.offsetHeight}const va=t=>{const e=t.props["onUpdate:modelValue"]||!1;return ee(e)?n=>ta(e,n):e};function jM(t){t.target.composing=!0}function Eb(t){const e=t.target;e.composing&&(e.composing=!1,e.dispatchEvent(new Event("input")))}const z9={created(t,{modifiers:{lazy:e,trim:n,number:r}},s){t._assign=va(s);const i=r||s.props&&s.props.type==="number";Ps(t,e?"change":"input",o=>{if(o.target.composing)return;let a=t.value;n&&(a=a.trim()),i&&(a=hl(a)),t._assign(a)}),n&&Ps(t,"change",()=>{t.value=t.value.trim()}),e||(Ps(t,"compositionstart",jM),Ps(t,"compositionend",Eb),Ps(t,"change",Eb))},mounted(t,{value:e}){t.value=e==null?"":e},beforeUpdate(t,{value:e,modifiers:{lazy:n,trim:r,number:s}},i){if(t._assign=va(i),t.composing||document.activeElement===t&&t.type!=="range"&&(n||r&&t.value.trim()===e||(s||t.type==="number")&&hl(t.value)===e))return;const o=e==null?"":e;t.value!==o&&(t.value=o)}},Q9={created(t,{value:e},n){t.checked=ga(e,n.props.value),t._assign=va(n),Ps(t,"change",()=>{t._assign(_l(t))})},beforeUpdate(t,{value:e,oldValue:n},r){t._assign=va(r),e!==n&&(t.checked=ga(e,r.props.value))}},Y9={deep:!0,created(t,{value:e,modifiers:{number:n}},r){const s=jd(e);Ps(t,"change",()=>{const i=Array.prototype.filter.call(t.options,o=>o.selected).map(o=>n?hl(_l(o)):_l(o));t._assign(t.multiple?s?new Set(i):i:i[0])}),t._assign=va(r)},mounted(t,{value:e}){Tb(t,e)},beforeUpdate(t,e,n){t._assign=va(n)},updated(t,{value:e}){Tb(t,e)}};function Tb(t,e){const n=t.multiple;if(!(n&&!ee(e)&&!jd(e))){for(let r=0,s=t.options.length;r<s;r++){const i=t.options[r],o=_l(i);if(n)ee(e)?i.selected=kx(e,o)>-1:i.selected=e.has(o);else if(ga(_l(i),e)){t.selectedIndex!==r&&(t.selectedIndex=r);return}}!n&&t.selectedIndex!==-1&&(t.selectedIndex=-1)}}function _l(t){return"_value"in t?t._value:t.value}const KM={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},J9=(t,e)=>n=>{if(!("key"in n))return;const r=Eo(n.key);if(e.some(s=>s===r||KM[s]===r))return t(n)},HM=Gt({patchProp:LM},bM);let Sb;function WM(){return Sb||(Sb=nM(HM))}const GM=(...t)=>{const e=WM().createApp(...t),{mount:n}=e;return e.mount=r=>{const s=zM(r);if(!s)return;const i=e._component;!le(i)&&!i.render&&!i.template&&(i.template=s.innerHTML),s.innerHTML="";const o=n(s,!1,s instanceof SVGElement);return s instanceof Element&&(s.removeAttribute("v-cloak"),s.setAttribute("data-v-app","")),o},e};function zM(t){return yt(t)?document.querySelector(t):t}const QM="modulepreload",Cb={},YM="/Educatia/",jr=function(e,n){return!n||n.length===0?e():Promise.all(n.map(r=>{if(r=`${YM}${r}`,r in Cb)return;Cb[r]=!0;const s=r.endsWith(".css"),i=s?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${r}"]${i}`))return;const o=document.createElement("link");if(o.rel=s?"stylesheet":QM,s||(o.as="script",o.crossOrigin=""),o.href=r,document.head.appendChild(o),s)return new Promise((a,c)=>{o.addEventListener("load",a),o.addEventListener("error",()=>c(new Error(`Unable to preload CSS for ${r}`)))})})).then(()=>e())};/*!
  * vue-router v4.0.13
  * (c) 2022 Eduardo San Martin Morote
  * @license MIT
  */const _0=typeof Symbol=="function"&&typeof Symbol.toStringTag=="symbol",Ka=t=>_0?Symbol(t):"_vr_"+t,JM=Ka("rvlm"),Ab=Ka("rvd"),nf=Ka("r"),y0=Ka("rl"),zg=Ka("rvl"),zo=typeof window!="undefined";function XM(t){return t.__esModule||_0&&t[Symbol.toStringTag]==="Module"}const Oe=Object.assign;function Op(t,e){const n={};for(const r in e){const s=e[r];n[r]=Array.isArray(s)?s.map(t):t(s)}return n}const Kc=()=>{},ZM=/\/$/,e1=t=>t.replace(ZM,"");function Mp(t,e,n="/"){let r,s={},i="",o="";const a=e.indexOf("?"),c=e.indexOf("#",a>-1?a:0);return a>-1&&(r=e.slice(0,a),i=e.slice(a+1,c>-1?c:e.length),s=t(i)),c>-1&&(r=r||e.slice(0,c),o=e.slice(c,e.length)),r=s1(r!=null?r:e,n),{fullPath:r+(i&&"?")+i+o,path:r,query:s,hash:o}}function t1(t,e){const n=e.query?t(e.query):"";return e.path+(n&&"?")+n+(e.hash||"")}function kb(t,e){return!e||!t.toLowerCase().startsWith(e.toLowerCase())?t:t.slice(e.length)||"/"}function n1(t,e,n){const r=e.matched.length-1,s=n.matched.length-1;return r>-1&&r===s&&wa(e.matched[r],n.matched[s])&&v0(e.params,n.params)&&t(e.query)===t(n.query)&&e.hash===n.hash}function wa(t,e){return(t.aliasOf||t)===(e.aliasOf||e)}function v0(t,e){if(Object.keys(t).length!==Object.keys(e).length)return!1;for(const n in t)if(!r1(t[n],e[n]))return!1;return!0}function r1(t,e){return Array.isArray(t)?Rb(t,e):Array.isArray(e)?Rb(e,t):t===e}function Rb(t,e){return Array.isArray(e)?t.length===e.length&&t.every((n,r)=>n===e[r]):t.length===1&&t[0]===e}function s1(t,e){if(t.startsWith("/"))return t;if(!t)return e;const n=e.split("/"),r=t.split("/");let s=n.length-1,i,o;for(i=0;i<r.length;i++)if(o=r[i],!(s===1||o==="."))if(o==="..")s--;else break;return n.slice(0,s).join("/")+"/"+r.slice(i-(i===r.length?1:0)).join("/")}var yl;(function(t){t.pop="pop",t.push="push"})(yl||(yl={}));var Hc;(function(t){t.back="back",t.forward="forward",t.unknown=""})(Hc||(Hc={}));function i1(t){if(!t)if(zo){const e=document.querySelector("base");t=e&&e.getAttribute("href")||"/",t=t.replace(/^\w+:\/\/[^\/]+/,"")}else t="/";return t[0]!=="/"&&t[0]!=="#"&&(t="/"+t),e1(t)}const o1=/^[^#]+#/;function a1(t,e){return t.replace(o1,"#")+e}function c1(t,e){const n=document.documentElement.getBoundingClientRect(),r=t.getBoundingClientRect();return{behavior:e.behavior,left:r.left-n.left-(e.left||0),top:r.top-n.top-(e.top||0)}}const rf=()=>({left:window.pageXOffset,top:window.pageYOffset});function l1(t){let e;if("el"in t){const n=t.el,r=typeof n=="string"&&n.startsWith("#"),s=typeof n=="string"?r?document.getElementById(n.slice(1)):document.querySelector(n):n;if(!s)return;e=c1(s,t)}else e=t;"scrollBehavior"in document.documentElement.style?window.scrollTo(e):window.scrollTo(e.left!=null?e.left:window.pageXOffset,e.top!=null?e.top:window.pageYOffset)}function Nb(t,e){return(history.state?history.state.position-e:-1)+t}const Qg=new Map;function u1(t,e){Qg.set(t,e)}function h1(t){const e=Qg.get(t);return Qg.delete(t),e}let d1=()=>location.protocol+"//"+location.host;function w0(t,e){const{pathname:n,search:r,hash:s}=e,i=t.indexOf("#");if(i>-1){let a=s.includes(t.slice(i))?t.slice(i).length:1,c=s.slice(a);return c[0]!=="/"&&(c="/"+c),kb(c,"")}return kb(n,t)+r+s}function f1(t,e,n,r){let s=[],i=[],o=null;const a=({state:d})=>{const f=w0(t,location),p=n.value,_=e.value;let y=0;if(d){if(n.value=f,e.value=d,o&&o===p){o=null;return}y=_?d.position-_.position:0}else r(f);s.forEach(T=>{T(n.value,p,{delta:y,type:yl.pop,direction:y?y>0?Hc.forward:Hc.back:Hc.unknown})})};function c(){o=n.value}function l(d){s.push(d);const f=()=>{const p=s.indexOf(d);p>-1&&s.splice(p,1)};return i.push(f),f}function u(){const{history:d}=window;!d.state||d.replaceState(Oe({},d.state,{scroll:rf()}),"")}function h(){for(const d of i)d();i=[],window.removeEventListener("popstate",a),window.removeEventListener("beforeunload",u)}return window.addEventListener("popstate",a),window.addEventListener("beforeunload",u),{pauseListeners:c,listen:l,destroy:h}}function Pb(t,e,n,r=!1,s=!1){return{back:t,current:e,forward:n,replaced:r,position:window.history.length,scroll:s?rf():null}}function p1(t){const{history:e,location:n}=window,r={value:w0(t,n)},s={value:e.state};s.value||i(r.value,{back:null,current:r.value,forward:null,position:e.length-1,replaced:!0,scroll:null},!0);function i(c,l,u){const h=t.indexOf("#"),d=h>-1?(n.host&&document.querySelector("base")?t:t.slice(h))+c:d1()+t+c;try{e[u?"replaceState":"pushState"](l,"",d),s.value=l}catch(f){console.error(f),n[u?"replace":"assign"](d)}}function o(c,l){const u=Oe({},e.state,Pb(s.value.back,c,s.value.forward,!0),l,{position:s.value.position});i(c,u,!0),r.value=c}function a(c,l){const u=Oe({},s.value,e.state,{forward:c,scroll:rf()});i(u.current,u,!0);const h=Oe({},Pb(r.value,c,null),{position:u.position+1},l);i(c,h,!1),r.value=c}return{location:r,state:s,push:a,replace:o}}function g1(t){t=i1(t);const e=p1(t),n=f1(t,e.state,e.location,e.replace);function r(i,o=!0){o||n.pauseListeners(),history.go(i)}const s=Oe({location:"",base:t,go:r,createHref:a1.bind(null,t)},e,n);return Object.defineProperty(s,"location",{enumerable:!0,get:()=>e.location.value}),Object.defineProperty(s,"state",{enumerable:!0,get:()=>e.state.value}),s}function m1(t){return t=location.host?t||location.pathname+location.search:"",t.includes("#")||(t+="#"),g1(t)}function _1(t){return typeof t=="string"||t&&typeof t=="object"}function b0(t){return typeof t=="string"||typeof t=="symbol"}const Is={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0},I0=Ka("nf");var Db;(function(t){t[t.aborted=4]="aborted",t[t.cancelled=8]="cancelled",t[t.duplicated=16]="duplicated"})(Db||(Db={}));function ba(t,e){return Oe(new Error,{type:t,[I0]:!0},e)}function Es(t,e){return t instanceof Error&&I0 in t&&(e==null||!!(t.type&e))}const xb="[^/]+?",y1={sensitive:!1,strict:!1,start:!0,end:!0},v1=/[.+*?^${}()[\]/\\]/g;function w1(t,e){const n=Oe({},y1,e),r=[];let s=n.start?"^":"";const i=[];for(const l of t){const u=l.length?[]:[90];n.strict&&!l.length&&(s+="/");for(let h=0;h<l.length;h++){const d=l[h];let f=40+(n.sensitive?.25:0);if(d.type===0)h||(s+="/"),s+=d.value.replace(v1,"\\$&"),f+=40;else if(d.type===1){const{value:p,repeatable:_,optional:y,regexp:T}=d;i.push({name:p,repeatable:_,optional:y});const I=T||xb;if(I!==xb){f+=10;try{new RegExp(`(${I})`)}catch(S){throw new Error(`Invalid custom RegExp for param "${p}" (${I}): `+S.message)}}let E=_?`((?:${I})(?:/(?:${I}))*)`:`(${I})`;h||(E=y&&l.length<2?`(?:/${E})`:"/"+E),y&&(E+="?"),s+=E,f+=20,y&&(f+=-8),_&&(f+=-20),I===".*"&&(f+=-50)}u.push(f)}r.push(u)}if(n.strict&&n.end){const l=r.length-1;r[l][r[l].length-1]+=.7000000000000001}n.strict||(s+="/?"),n.end?s+="$":n.strict&&(s+="(?:/|$)");const o=new RegExp(s,n.sensitive?"":"i");function a(l){const u=l.match(o),h={};if(!u)return null;for(let d=1;d<u.length;d++){const f=u[d]||"",p=i[d-1];h[p.name]=f&&p.repeatable?f.split("/"):f}return h}function c(l){let u="",h=!1;for(const d of t){(!h||!u.endsWith("/"))&&(u+="/"),h=!1;for(const f of d)if(f.type===0)u+=f.value;else if(f.type===1){const{value:p,repeatable:_,optional:y}=f,T=p in l?l[p]:"";if(Array.isArray(T)&&!_)throw new Error(`Provided param "${p}" is an array but it is not repeatable (* or + modifiers)`);const I=Array.isArray(T)?T.join("/"):T;if(!I)if(y)d.length<2&&(u.endsWith("/")?u=u.slice(0,-1):h=!0);else throw new Error(`Missing required param "${p}"`);u+=I}}return u}return{re:o,score:r,keys:i,parse:a,stringify:c}}function b1(t,e){let n=0;for(;n<t.length&&n<e.length;){const r=e[n]-t[n];if(r)return r;n++}return t.length<e.length?t.length===1&&t[0]===40+40?-1:1:t.length>e.length?e.length===1&&e[0]===40+40?1:-1:0}function I1(t,e){let n=0;const r=t.score,s=e.score;for(;n<r.length&&n<s.length;){const i=b1(r[n],s[n]);if(i)return i;n++}return s.length-r.length}const E1={type:0,value:""},T1=/[a-zA-Z0-9_]/;function S1(t){if(!t)return[[]];if(t==="/")return[[E1]];if(!t.startsWith("/"))throw new Error(`Invalid path "${t}"`);function e(f){throw new Error(`ERR (${n})/"${l}": ${f}`)}let n=0,r=n;const s=[];let i;function o(){i&&s.push(i),i=[]}let a=0,c,l="",u="";function h(){!l||(n===0?i.push({type:0,value:l}):n===1||n===2||n===3?(i.length>1&&(c==="*"||c==="+")&&e(`A repeatable param (${l}) must be alone in its segment. eg: '/:ids+.`),i.push({type:1,value:l,regexp:u,repeatable:c==="*"||c==="+",optional:c==="*"||c==="?"})):e("Invalid state to consume buffer"),l="")}function d(){l+=c}for(;a<t.length;){if(c=t[a++],c==="\\"&&n!==2){r=n,n=4;continue}switch(n){case 0:c==="/"?(l&&h(),o()):c===":"?(h(),n=1):d();break;case 4:d(),n=r;break;case 1:c==="("?n=2:T1.test(c)?d():(h(),n=0,c!=="*"&&c!=="?"&&c!=="+"&&a--);break;case 2:c===")"?u[u.length-1]=="\\"?u=u.slice(0,-1)+c:n=3:u+=c;break;case 3:h(),n=0,c!=="*"&&c!=="?"&&c!=="+"&&a--,u="";break;default:e("Unknown state");break}}return n===2&&e(`Unfinished custom RegExp for param "${l}"`),h(),o(),s}function C1(t,e,n){const r=w1(S1(t.path),n),s=Oe(r,{record:t,parent:e,children:[],alias:[]});return e&&!s.record.aliasOf==!e.record.aliasOf&&e.children.push(s),s}function A1(t,e){const n=[],r=new Map;e=Mb({strict:!1,end:!0,sensitive:!1},e);function s(u){return r.get(u)}function i(u,h,d){const f=!d,p=R1(u);p.aliasOf=d&&d.record;const _=Mb(e,u),y=[p];if("alias"in u){const E=typeof u.alias=="string"?[u.alias]:u.alias;for(const S of E)y.push(Oe({},p,{components:d?d.record.components:p.components,path:S,aliasOf:d?d.record:p}))}let T,I;for(const E of y){const{path:S}=E;if(h&&S[0]!=="/"){const $=h.record.path,H=$[$.length-1]==="/"?"":"/";E.path=h.record.path+(S&&H+S)}if(T=C1(E,h,_),d?d.alias.push(T):(I=I||T,I!==T&&I.alias.push(T),f&&u.name&&!Ob(T)&&o(u.name)),"children"in p){const $=p.children;for(let H=0;H<$.length;H++)i($[H],T,d&&d.children[H])}d=d||T,c(T)}return I?()=>{o(I)}:Kc}function o(u){if(b0(u)){const h=r.get(u);h&&(r.delete(u),n.splice(n.indexOf(h),1),h.children.forEach(o),h.alias.forEach(o))}else{const h=n.indexOf(u);h>-1&&(n.splice(h,1),u.record.name&&r.delete(u.record.name),u.children.forEach(o),u.alias.forEach(o))}}function a(){return n}function c(u){let h=0;for(;h<n.length&&I1(u,n[h])>=0&&(u.record.path!==n[h].record.path||!E0(u,n[h]));)h++;n.splice(h,0,u),u.record.name&&!Ob(u)&&r.set(u.record.name,u)}function l(u,h){let d,f={},p,_;if("name"in u&&u.name){if(d=r.get(u.name),!d)throw ba(1,{location:u});_=d.record.name,f=Oe(k1(h.params,d.keys.filter(I=>!I.optional).map(I=>I.name)),u.params),p=d.stringify(f)}else if("path"in u)p=u.path,d=n.find(I=>I.re.test(p)),d&&(f=d.parse(p),_=d.record.name);else{if(d=h.name?r.get(h.name):n.find(I=>I.re.test(h.path)),!d)throw ba(1,{location:u,currentLocation:h});_=d.record.name,f=Oe({},h.params,u.params),p=d.stringify(f)}const y=[];let T=d;for(;T;)y.unshift(T.record),T=T.parent;return{name:_,path:p,params:f,matched:y,meta:P1(y)}}return t.forEach(u=>i(u)),{addRoute:i,resolve:l,removeRoute:o,getRoutes:a,getRecordMatcher:s}}function k1(t,e){const n={};for(const r of e)r in t&&(n[r]=t[r]);return n}function R1(t){return{path:t.path,redirect:t.redirect,name:t.name,meta:t.meta||{},aliasOf:void 0,beforeEnter:t.beforeEnter,props:N1(t),children:t.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in t?t.components||{}:{default:t.component}}}function N1(t){const e={},n=t.props||!1;if("component"in t)e.default=n;else for(const r in t.components)e[r]=typeof n=="boolean"?n:n[r];return e}function Ob(t){for(;t;){if(t.record.aliasOf)return!0;t=t.parent}return!1}function P1(t){return t.reduce((e,n)=>Oe(e,n.meta),{})}function Mb(t,e){const n={};for(const r in t)n[r]=r in e?e[r]:t[r];return n}function E0(t,e){return e.children.some(n=>n===t||E0(t,n))}const T0=/#/g,D1=/&/g,x1=/\//g,O1=/=/g,M1=/\?/g,S0=/\+/g,L1=/%5B/g,F1=/%5D/g,C0=/%5E/g,U1=/%60/g,A0=/%7B/g,$1=/%7C/g,k0=/%7D/g,V1=/%20/g;function F_(t){return encodeURI(""+t).replace($1,"|").replace(L1,"[").replace(F1,"]")}function B1(t){return F_(t).replace(A0,"{").replace(k0,"}").replace(C0,"^")}function Yg(t){return F_(t).replace(S0,"%2B").replace(V1,"+").replace(T0,"%23").replace(D1,"%26").replace(U1,"`").replace(A0,"{").replace(k0,"}").replace(C0,"^")}function q1(t){return Yg(t).replace(O1,"%3D")}function j1(t){return F_(t).replace(T0,"%23").replace(M1,"%3F")}function K1(t){return t==null?"":j1(t).replace(x1,"%2F")}function qh(t){try{return decodeURIComponent(""+t)}catch{}return""+t}function H1(t){const e={};if(t===""||t==="?")return e;const r=(t[0]==="?"?t.slice(1):t).split("&");for(let s=0;s<r.length;++s){const i=r[s].replace(S0," "),o=i.indexOf("="),a=qh(o<0?i:i.slice(0,o)),c=o<0?null:qh(i.slice(o+1));if(a in e){let l=e[a];Array.isArray(l)||(l=e[a]=[l]),l.push(c)}else e[a]=c}return e}function Lb(t){let e="";for(let n in t){const r=t[n];if(n=q1(n),r==null){r!==void 0&&(e+=(e.length?"&":"")+n);continue}(Array.isArray(r)?r.map(i=>i&&Yg(i)):[r&&Yg(r)]).forEach(i=>{i!==void 0&&(e+=(e.length?"&":"")+n,i!=null&&(e+="="+i))})}return e}function W1(t){const e={};for(const n in t){const r=t[n];r!==void 0&&(e[n]=Array.isArray(r)?r.map(s=>s==null?null:""+s):r==null?r:""+r)}return e}function pc(){let t=[];function e(r){return t.push(r),()=>{const s=t.indexOf(r);s>-1&&t.splice(s,1)}}function n(){t=[]}return{add:e,list:()=>t,reset:n}}function Rs(t,e,n,r,s){const i=r&&(r.enterCallbacks[s]=r.enterCallbacks[s]||[]);return()=>new Promise((o,a)=>{const c=h=>{h===!1?a(ba(4,{from:n,to:e})):h instanceof Error?a(h):_1(h)?a(ba(2,{from:e,to:h})):(i&&r.enterCallbacks[s]===i&&typeof h=="function"&&i.push(h),o())},l=t.call(r&&r.instances[s],e,n,c);let u=Promise.resolve(l);t.length<3&&(u=u.then(c)),u.catch(h=>a(h))})}function Lp(t,e,n,r){const s=[];for(const i of t)for(const o in i.components){let a=i.components[o];if(!(e!=="beforeRouteEnter"&&!i.instances[o]))if(G1(a)){const l=(a.__vccOpts||a)[e];l&&s.push(Rs(l,n,r,i,o))}else{let c=a();s.push(()=>c.then(l=>{if(!l)return Promise.reject(new Error(`Couldn't resolve component "${o}" at "${i.path}"`));const u=XM(l)?l.default:l;i.components[o]=u;const d=(u.__vccOpts||u)[e];return d&&Rs(d,n,r,i,o)()}))}}return s}function G1(t){return typeof t=="object"||"displayName"in t||"props"in t||"__vccOpts"in t}function Fb(t){const e=Cr(nf),n=Cr(y0),r=nr(()=>e.resolve(Uc(t.to))),s=nr(()=>{const{matched:c}=r.value,{length:l}=c,u=c[l-1],h=n.matched;if(!u||!h.length)return-1;const d=h.findIndex(wa.bind(null,u));if(d>-1)return d;const f=Ub(c[l-2]);return l>1&&Ub(u)===f&&h[h.length-1].path!==f?h.findIndex(wa.bind(null,c[l-2])):d}),i=nr(()=>s.value>-1&&J1(n.params,r.value.params)),o=nr(()=>s.value>-1&&s.value===n.matched.length-1&&v0(n.params,r.value.params));function a(c={}){return Y1(c)?e[Uc(t.replace)?"replace":"push"](Uc(t.to)).catch(Kc):Promise.resolve()}return{route:r,href:nr(()=>r.value.href),isActive:i,isExactActive:o,navigate:a}}const z1=XS({name:"RouterLink",props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"}},useLink:Fb,setup(t,{slots:e}){const n=ja(Fb(t)),{options:r}=Cr(nf),s=nr(()=>({[$b(t.activeClass,r.linkActiveClass,"router-link-active")]:n.isActive,[$b(t.exactActiveClass,r.linkExactActiveClass,"router-link-exact-active")]:n.isExactActive}));return()=>{const i=e.default&&e.default(n);return t.custom?i:M_("a",{"aria-current":n.isExactActive?t.ariaCurrentValue:null,href:n.href,onClick:n.navigate,class:s.value},i)}}}),Q1=z1;function Y1(t){if(!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)&&!t.defaultPrevented&&!(t.button!==void 0&&t.button!==0)){if(t.currentTarget&&t.currentTarget.getAttribute){const e=t.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(e))return}return t.preventDefault&&t.preventDefault(),!0}}function J1(t,e){for(const n in e){const r=e[n],s=t[n];if(typeof r=="string"){if(r!==s)return!1}else if(!Array.isArray(s)||s.length!==r.length||r.some((i,o)=>i!==s[o]))return!1}return!0}function Ub(t){return t?t.aliasOf?t.aliasOf.path:t.path:""}const $b=(t,e,n)=>t!=null?t:e!=null?e:n,X1=XS({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},setup(t,{attrs:e,slots:n}){const r=Cr(zg),s=nr(()=>t.route||r.value),i=Cr(Ab,0),o=nr(()=>s.value.matched[i]);wh(Ab,i+1),wh(JM,o),wh(zg,s);const a=T_();return na(()=>[a.value,o.value,t.name],([c,l,u],[h,d,f])=>{l&&(l.instances[u]=c,d&&d!==l&&c&&c===h&&(l.leaveGuards.size||(l.leaveGuards=d.leaveGuards),l.updateGuards.size||(l.updateGuards=d.updateGuards))),c&&l&&(!d||!wa(l,d)||!h)&&(l.enterCallbacks[u]||[]).forEach(p=>p(c))},{flush:"post"}),()=>{const c=s.value,l=o.value,u=l&&l.components[t.name],h=t.name;if(!u)return Vb(n.default,{Component:u,route:c});const d=l.props[t.name],f=d?d===!0?c.params:typeof d=="function"?d(c):d:null,_=M_(u,Oe({},f,e,{onVnodeUnmounted:y=>{y.component.isUnmounted&&(l.instances[h]=null)},ref:a}));return Vb(n.default,{Component:_,route:c})||_}}});function Vb(t,e){if(!t)return null;const n=t(e);return n.length===1?n[0]:n}const Z1=X1;function eL(t){const e=A1(t.routes,t),n=t.parseQuery||H1,r=t.stringifyQuery||Lb,s=t.history,i=pc(),o=pc(),a=pc(),c=lO(Is);let l=Is;zo&&t.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const u=Op.bind(null,C=>""+C),h=Op.bind(null,K1),d=Op.bind(null,qh);function f(C,Y){let B,J;return b0(C)?(B=e.getRecordMatcher(C),J=Y):J=C,e.addRoute(J,B)}function p(C){const Y=e.getRecordMatcher(C);Y&&e.removeRoute(Y)}function _(){return e.getRoutes().map(C=>C.record)}function y(C){return!!e.getRecordMatcher(C)}function T(C,Y){if(Y=Oe({},Y||c.value),typeof C=="string"){const de=Mp(n,C,Y.path),g=e.resolve({path:de.path},Y),m=s.createHref(de.fullPath);return Oe(de,g,{params:d(g.params),hash:qh(de.hash),redirectedFrom:void 0,href:m})}let B;if("path"in C)B=Oe({},C,{path:Mp(n,C.path,Y.path).path});else{const de=Oe({},C.params);for(const g in de)de[g]==null&&delete de[g];B=Oe({},C,{params:h(C.params)}),Y.params=h(Y.params)}const J=e.resolve(B,Y),Pe=C.hash||"";J.params=u(d(J.params));const $e=t1(r,Oe({},C,{hash:B1(Pe),path:J.path})),_e=s.createHref($e);return Oe({fullPath:$e,hash:Pe,query:r===Lb?W1(C.query):C.query||{}},J,{redirectedFrom:void 0,href:_e})}function I(C){return typeof C=="string"?Mp(n,C,c.value.path):Oe({},C)}function E(C,Y){if(l!==C)return ba(8,{from:Y,to:C})}function S(C){return K(C)}function $(C){return S(Oe(I(C),{replace:!0}))}function H(C){const Y=C.matched[C.matched.length-1];if(Y&&Y.redirect){const{redirect:B}=Y;let J=typeof B=="function"?B(C):B;return typeof J=="string"&&(J=J.includes("?")||J.includes("#")?J=I(J):{path:J},J.params={}),Oe({query:C.query,hash:C.hash,params:C.params},J)}}function K(C,Y){const B=l=T(C),J=c.value,Pe=C.state,$e=C.force,_e=C.replace===!0,de=H(B);if(de)return K(Oe(I(de),{state:Pe,force:$e,replace:_e}),Y||B);const g=B;g.redirectedFrom=Y;let m;return!$e&&n1(r,J,B)&&(m=ba(16,{to:g,from:J}),Lo(J,J,!0,!1)),(m?Promise.resolve(m):ne(g,J)).catch(b=>Es(b)?Es(b,2)?b:Tn(b):Ue(b,g,J)).then(b=>{if(b){if(Es(b,2))return K(Oe(I(b.to),{state:Pe,force:$e,replace:_e}),Y||g)}else b=Ce(g,J,!0,_e,Pe);return he(g,J,b),b})}function F(C,Y){const B=E(C,Y);return B?Promise.reject(B):Promise.resolve()}function ne(C,Y){let B;const[J,Pe,$e]=tL(C,Y);B=Lp(J.reverse(),"beforeRouteLeave",C,Y);for(const de of J)de.leaveGuards.forEach(g=>{B.push(Rs(g,C,Y))});const _e=F.bind(null,C,Y);return B.push(_e),Uo(B).then(()=>{B=[];for(const de of i.list())B.push(Rs(de,C,Y));return B.push(_e),Uo(B)}).then(()=>{B=Lp(Pe,"beforeRouteUpdate",C,Y);for(const de of Pe)de.updateGuards.forEach(g=>{B.push(Rs(g,C,Y))});return B.push(_e),Uo(B)}).then(()=>{B=[];for(const de of C.matched)if(de.beforeEnter&&!Y.matched.includes(de))if(Array.isArray(de.beforeEnter))for(const g of de.beforeEnter)B.push(Rs(g,C,Y));else B.push(Rs(de.beforeEnter,C,Y));return B.push(_e),Uo(B)}).then(()=>(C.matched.forEach(de=>de.enterCallbacks={}),B=Lp($e,"beforeRouteEnter",C,Y),B.push(_e),Uo(B))).then(()=>{B=[];for(const de of o.list())B.push(Rs(de,C,Y));return B.push(_e),Uo(B)}).catch(de=>Es(de,8)?de:Promise.reject(de))}function he(C,Y,B){for(const J of a.list())J(C,Y,B)}function Ce(C,Y,B,J,Pe){const $e=E(C,Y);if($e)return $e;const _e=Y===Is,de=zo?history.state:{};B&&(J||_e?s.replace(C.fullPath,Oe({scroll:_e&&de&&de.scroll},Pe)):s.push(C.fullPath,Pe)),c.value=C,Lo(C,Y,B,_e),Tn()}let z;function Re(){z=s.listen((C,Y,B)=>{const J=T(C),Pe=H(J);if(Pe){K(Oe(Pe,{replace:!0}),J).catch(Kc);return}l=J;const $e=c.value;zo&&u1(Nb($e.fullPath,B.delta),rf()),ne(J,$e).catch(_e=>Es(_e,12)?_e:Es(_e,2)?(K(_e.to,J).then(de=>{Es(de,20)&&!B.delta&&B.type===yl.pop&&s.go(-1,!1)}).catch(Kc),Promise.reject()):(B.delta&&s.go(-B.delta,!1),Ue(_e,J,$e))).then(_e=>{_e=_e||Ce(J,$e,!1),_e&&(B.delta?s.go(-B.delta,!1):B.type===yl.pop&&Es(_e,20)&&s.go(-1,!1)),he(J,$e,_e)}).catch(Kc)})}let Ze=pc(),et=pc(),tt;function Ue(C,Y,B){Tn(C);const J=et.list();return J.length?J.forEach(Pe=>Pe(C,Y,B)):console.error(C),Promise.reject(C)}function Ne(){return tt&&c.value!==Is?Promise.resolve():new Promise((C,Y)=>{Ze.add([C,Y])})}function Tn(C){return tt||(tt=!C,Re(),Ze.list().forEach(([Y,B])=>C?B(C):Y()),Ze.reset()),C}function Lo(C,Y,B,J){const{scrollBehavior:Pe}=t;if(!zo||!Pe)return Promise.resolve();const $e=!B&&h1(Nb(C.fullPath,0))||(J||!B)&&history.state&&history.state.scroll||null;return C_().then(()=>Pe(C,Y,$e)).then(_e=>_e&&l1(_e)).catch(_e=>Ue(_e,C,Y))}const qr=C=>s.go(C);let fr;const Ln=new Set;return{currentRoute:c,addRoute:f,removeRoute:p,hasRoute:y,getRoutes:_,resolve:T,options:t,push:S,replace:$,go:qr,back:()=>qr(-1),forward:()=>qr(1),beforeEach:i.add,beforeResolve:o.add,afterEach:a.add,onError:et.add,isReady:Ne,install(C){const Y=this;C.component("RouterLink",Q1),C.component("RouterView",Z1),C.config.globalProperties.$router=Y,Object.defineProperty(C.config.globalProperties,"$route",{enumerable:!0,get:()=>Uc(c)}),zo&&!fr&&c.value===Is&&(fr=!0,S(s.location).catch(Pe=>{}));const B={};for(const Pe in Is)B[Pe]=nr(()=>c.value[Pe]);C.provide(nf,Y),C.provide(y0,ja(B)),C.provide(zg,c);const J=C.unmount;Ln.add(C),C.unmount=function(){Ln.delete(C),Ln.size<1&&(l=Is,z&&z(),c.value=Is,fr=!1,tt=!1),J()}}}}function Uo(t){return t.reduce((e,n)=>e.then(()=>n()),Promise.resolve())}function tL(t,e){const n=[],r=[],s=[],i=Math.max(e.matched.length,t.matched.length);for(let o=0;o<i;o++){const a=e.matched[o];a&&(t.matched.find(l=>wa(l,a))?r.push(a):n.push(a));const c=t.matched[o];c&&(e.matched.find(l=>wa(l,c))||s.push(c))}return[n,r,s]}function X9(){return Cr(nf)}const nL=[{name:"Home",component:()=>jr(()=>import("./Home.5834c26c.js"),["assets/Home.5834c26c.js","assets/Home.e677d491.css"]),path:"/"},{name:"Add",component:()=>jr(()=>import("./Add.6299aee9.js"),["assets/Add.6299aee9.js","assets/Add.734cd8a9.css","assets/level.19f89a9b.js","assets/types.7d33b1ee.js","assets/loader.3bfd9e0a.js","assets/loader.31e39e24.css"]),path:"/add"},{name:"Admin",component:()=>jr(()=>import("./admin.e686b357.js"),["assets/admin.e686b357.js","assets/admin.1da9aa51.css","assets/loader.3bfd9e0a.js","assets/loader.31e39e24.css"]),path:"/admin"},{name:"Univercities",component:()=>jr(()=>import("./Uni.8e72fb39.js"),["assets/Uni.8e72fb39.js","assets/Uni.c6309177.css","assets/loader.3bfd9e0a.js","assets/loader.31e39e24.css"]),path:"/Univercities"},{name:"details",component:()=>jr(()=>import("./details.336df1bb.js"),["assets/details.336df1bb.js","assets/details.14721ffb.css","assets/loader.3bfd9e0a.js","assets/loader.31e39e24.css"]),path:"/University/:name"},{name:"Dashboard",component:()=>jr(()=>import("./Dashboard.bfc24a79.js"),["assets/Dashboard.bfc24a79.js","assets/Dashboard.bc87434d.css","assets/loader.3bfd9e0a.js","assets/loader.31e39e24.css"]),path:"/admin/dashboard"},{name:"Edit",component:()=>jr(()=>import("./Edit.82e8c5c5.js"),["assets/Edit.82e8c5c5.js","assets/Edit.65fbaaa0.css","assets/loader.3bfd9e0a.js","assets/loader.31e39e24.css","assets/level.19f89a9b.js","assets/types.7d33b1ee.js"]),path:"/admin/dashboard/edit/:name"},{name:"Testing",component:()=>jr(()=>import("./teting.2f90d69a.js"),["assets/teting.2f90d69a.js","assets/types.7d33b1ee.js"]),path:"/Testing"},{name:"Footer",component:()=>jr(()=>Promise.resolve().then(function(){return L9}),void 0),path:"/footer"}],rL=eL({history:m1(),routes:nL});var lu=(t,e)=>{const n=t.__vccOpts||t;for(const[r,s]of e)n[r]=s;return n};const sL={},U_=t=>(A_("data-v-6f460565"),t=t(),k_(),t),iL={class:"container"},oL={class:"flex center between",id:"main-nav"},aL=U_(()=>Ke("div",{class:"flex center"},[Ke("div",{class:"logo"},[Ke("h1",null,"EDUCATIA")])],-1)),cL={class:"li"},lL=ai("Home"),uL=ai("Universities"),hL=U_(()=>Ke("a",{href:"#"},"Degrees",-1)),dL=U_(()=>Ke("div",{class:"nav-button"},[Ke("a",{href:"#contact-form"},[Ke("button",{class:"btn btn-primary"},"Conatact")])],-1));function fL(t,e,n,r,s,i){const o=Ns("router-link");return Ir(),_a("header",null,[Ke("div",iL,[Ke("nav",oL,[aL,Ke("div",cL,[Qe(o,{to:"/"},{default:Zr(()=>[lL]),_:1}),Qe(o,{to:"/Univercities"},{default:Zr(()=>[uL]),_:1}),hL]),dL])])])}var pL=lu(sL,[["render",fL],["__scopeId","data-v-6f460565"]]),gL="/Educatia/icons8-hamburger-64.png",mL="/Educatia/icons8-multiply-40.png";const _L={name:"mobileNav",data(){return{isNav:!1}}},R0=t=>(A_("data-v-0a0fcb10"),t=t(),k_(),t),yL={class:"wrapper"},vL={class:"icon"},wL={key:0,class:"main-nav",ref:"nav"},bL=R0(()=>Ke("img",{src:mL,alt:""},null,-1)),IL=[bL],EL={class:"links"},TL=ai("Home"),SL=ai("Universities"),CL=R0(()=>Ke("a",{href:"#"},"Degrees",-1));function AL(t,e,n,r,s,i){const o=Ns("router-link");return Ir(),_a("div",yL,[Ke("div",vL,[Ke("img",{ref:"ham",onClick:e[0]||(e[0]=a=>s.isNav=!0),src:gL,alt:""},null,512)]),Qe(L_,null,{default:Zr(()=>[s.isNav==!0?(Ir(),_a("div",wL,[Ke("div",{class:"cross",onClick:e[1]||(e[1]=a=>s.isNav=!1)},IL),Ke("div",EL,[Qe(o,{to:"/",onClick:e[2]||(e[2]=a=>s.isNav=!1)},{default:Zr(()=>[TL]),_:1}),Qe(o,{to:"/Univercities",onClick:e[3]||(e[3]=a=>s.isNav=!1)},{default:Zr(()=>[SL]),_:1}),CL])],512)):jc("",!0)]),_:1})])}var kL=lu(_L,[["render",AL],["__scopeId","data-v-0a0fcb10"]]);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const N0={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const O=function(t,e){if(!t)throw Ha(e)},Ha=function(t){return new Error("Firebase Database ("+N0.SDK_VERSION+") INTERNAL ASSERT FAILED: "+t)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const P0=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let s=t.charCodeAt(r);s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=s&63|128):(s&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=s&63|128):(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=s&63|128)}return e},RL=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const s=t[n++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=t[n++];e[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=t[n++],o=t[n++],a=t[n++],c=((s&7)<<18|(i&63)<<12|(o&63)<<6|a&63)-65536;e[r++]=String.fromCharCode(55296+(c>>10)),e[r++]=String.fromCharCode(56320+(c&1023))}else{const i=t[n++],o=t[n++];e[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|o&63)}}return e.join("")},sf={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<t.length;s+=3){const i=t[s],o=s+1<t.length,a=o?t[s+1]:0,c=s+2<t.length,l=c?t[s+2]:0,u=i>>2,h=(i&3)<<4|a>>4;let d=(a&15)<<2|l>>6,f=l&63;c||(f=64,o||(d=64)),r.push(n[u],n[h],n[d],n[f])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(P0(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):RL(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<t.length;){const i=n[t.charAt(s++)],a=s<t.length?n[t.charAt(s)]:0;++s;const l=s<t.length?n[t.charAt(s)]:64;++s;const h=s<t.length?n[t.charAt(s)]:64;if(++s,i==null||a==null||l==null||h==null)throw Error();const d=i<<2|a>>4;if(r.push(d),l!==64){const f=a<<4&240|l>>2;if(r.push(f),h!==64){const p=l<<6&192|h;r.push(p)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}},D0=function(t){const e=P0(t);return sf.encodeByteArray(e,!0)},jh=function(t){return D0(t).replace(/\./g,"")},Jg=function(t){try{return sf.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NL(t){return vl(void 0,t)}function vl(t,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:const n=e;return new Date(n.getTime());case Object:t===void 0&&(t={});break;case Array:t=[];break;default:return e}for(const n in e)!e.hasOwnProperty(n)||!PL(n)||(t[n]=vl(t[n],e[n]));return t}function PL(t){return t!=="__proto__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mt{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $_(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",s=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},t),a="";return[jh(JSON.stringify(n)),jh(JSON.stringify(o)),a].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function We(){return typeof navigator!="undefined"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function of(){return typeof window!="undefined"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(We())}function V_(){try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function DL(){return typeof self=="object"&&self.self===self}function uu(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function hu(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function xL(){return We().indexOf("Electron/")>=0}function B_(){const t=We();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function OL(){return We().indexOf("MSAppHost/")>=0}function x0(){return N0.NODE_ADMIN===!0}function ML(){return!V_()&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function In(){return typeof indexedDB=="object"}function du(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},s.onupgradeneeded=()=>{n=!1},s.onerror=()=>{var i;e(((i=s.error)===null||i===void 0?void 0:i.message)||"")}}catch(n){e(n)}})}function af(){return!(typeof navigator=="undefined"||!navigator.cookieEnabled)}function LL(){if(typeof self!="undefined")return self;if(typeof window!="undefined")return window;if(typeof global!="undefined")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FL="FirebaseError";class ut extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=FL,Object.setPrototypeOf(this,ut.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,pn.prototype.create)}}class pn{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},s=`${this.service}/${e}`,i=this.errors[e],o=i?UL(i,r):"Error",a=`${this.serviceName}: ${o} (${s}).`;return new ut(s,a,r)}}function UL(t,e){return t.replace($L,(n,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const $L=/\{\$([^}]+)}/g;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wl(t){return JSON.parse(t)}function _t(t){return JSON.stringify(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const q_=function(t){let e={},n={},r={},s="";try{const i=t.split(".");e=wl(Jg(i[0])||""),n=wl(Jg(i[1])||""),s=i[2],r=n.d||{},delete n.d}catch{}return{header:e,claims:n,data:r,signature:s}},VL=function(t){const e=q_(t).claims;return typeof e=="object"&&e.hasOwnProperty("iat")?e.iat:null},BL=function(t){const e=q_(t),n=e.claims;return!!n&&typeof n=="object"&&n.hasOwnProperty("iat")},qL=function(t){const e=q_(t).claims;return typeof e=="object"&&e.admin===!0};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xn(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function Yi(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]}function Kh(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Hh(t,e,n){const r={};for(const s in t)Object.prototype.hasOwnProperty.call(t,s)&&(r[s]=e.call(n,t[s],s,t));return r}function Xg(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const s of n){if(!r.includes(s))return!1;const i=t[s],o=e[s];if(Bb(i)&&Bb(o)){if(!Xg(i,o))return!1}else if(i!==o)return!1}for(const s of r)if(!n.includes(s))return!1;return!0}function Bb(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function To(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(s=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function Yo(t){const e={};return t.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[s,i]=r.split("=");e[decodeURIComponent(s)]=decodeURIComponent(i)}}),e}function xc(t){const e=t.indexOf("?");if(!e)return"";const n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jL{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=512/8,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(e,n){n||(n=0);const r=this.W_;if(typeof e=="string")for(let h=0;h<16;h++)r[h]=e.charCodeAt(n)<<24|e.charCodeAt(n+1)<<16|e.charCodeAt(n+2)<<8|e.charCodeAt(n+3),n+=4;else for(let h=0;h<16;h++)r[h]=e[n]<<24|e[n+1]<<16|e[n+2]<<8|e[n+3],n+=4;for(let h=16;h<80;h++){const d=r[h-3]^r[h-8]^r[h-14]^r[h-16];r[h]=(d<<1|d>>>31)&4294967295}let s=this.chain_[0],i=this.chain_[1],o=this.chain_[2],a=this.chain_[3],c=this.chain_[4],l,u;for(let h=0;h<80;h++){h<40?h<20?(l=a^i&(o^a),u=1518500249):(l=i^o^a,u=1859775393):h<60?(l=i&o|a&(i|o),u=2400959708):(l=i^o^a,u=3395469782);const d=(s<<5|s>>>27)+l+c+u+r[h]&4294967295;c=a,a=o,o=(i<<30|i>>>2)&4294967295,i=s,s=d}this.chain_[0]=this.chain_[0]+s&4294967295,this.chain_[1]=this.chain_[1]+i&4294967295,this.chain_[2]=this.chain_[2]+o&4294967295,this.chain_[3]=this.chain_[3]+a&4294967295,this.chain_[4]=this.chain_[4]+c&4294967295}update(e,n){if(e==null)return;n===void 0&&(n=e.length);const r=n-this.blockSize;let s=0;const i=this.buf_;let o=this.inbuf_;for(;s<n;){if(o===0)for(;s<=r;)this.compress_(e,s),s+=this.blockSize;if(typeof e=="string"){for(;s<n;)if(i[o]=e.charCodeAt(s),++o,++s,o===this.blockSize){this.compress_(i),o=0;break}}else for(;s<n;)if(i[o]=e[s],++o,++s,o===this.blockSize){this.compress_(i),o=0;break}}this.inbuf_=o,this.total_+=n}digest(){const e=[];let n=this.total_*8;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let s=this.blockSize-1;s>=56;s--)this.buf_[s]=n&255,n/=256;this.compress_(this.buf_);let r=0;for(let s=0;s<5;s++)for(let i=24;i>=0;i-=8)e[r]=this.chain_[s]>>i&255,++r;return e}}function O0(t,e){const n=new KL(t,e);return n.subscribe.bind(n)}class KL{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let s;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");HL(e,["next","error","complete"])?s=e:s={next:e,error:n,complete:r},s.next===void 0&&(s.next=Fp),s.error===void 0&&(s.error=Fp),s.complete===void 0&&(s.complete=Fp);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console!="undefined"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function HL(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function Fp(){}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const re=function(t,e,n,r){let s;if(r<e?s="at least "+e:r>n&&(s=n===0?"none":"no more than "+n),s){const i=t+" failed: Was called with "+r+(r===1?" argument.":" arguments.")+" Expects "+s+".";throw new Error(i)}};function bn(t,e){return`${t} failed: ${e} argument `}function Et(t,e,n,r){if(!(r&&!n)&&typeof n!="function")throw new Error(bn(t,e)+"must be a valid function.")}function qb(t,e,n,r){if(!(r&&!n)&&(typeof n!="object"||n===null))throw new Error(bn(t,e)+"must be a valid context object.")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WL=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let s=t.charCodeAt(r);if(s>=55296&&s<=56319){const i=s-55296;r++,O(r<t.length,"Surrogate pair missing trail surrogate.");const o=t.charCodeAt(r)-56320;s=65536+(i<<10)+o}s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=s&63|128):s<65536?(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=s&63|128):(e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=s&63|128)}return e},cf=function(t){let e=0;for(let n=0;n<t.length;n++){const r=t.charCodeAt(n);r<128?e++:r<2048?e+=2:r>=55296&&r<=56319?(e+=4,n++):e+=3}return e};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GL=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,t=>{const e=Math.random()*16|0;return(t==="x"?e:e&3|8).toString(16)})};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zL=1e3,QL=2,YL=4*60*60*1e3,JL=.5;function Wh(t,e=zL,n=QL){const r=e*Math.pow(n,t),s=Math.round(JL*r*(Math.random()-.5)*2);return Math.min(YL,r+s)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function N(t){return t&&t._delegate?t._delegate:t}class Ee{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ti="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M0{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new mt;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:n});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),s=(n=e==null?void 0:e.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(i){if(s)return null;throw i}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(ZL(e))try{this.getOrInitializeService({instanceIdentifier:Ti})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(n);try{const i=this.getOrInitializeService({instanceIdentifier:s});r.resolve(i)}catch{}}}}clearInstance(e=Ti){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Ti){return this.instances.has(e)}getOptions(e=Ti){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[i,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(i);r===a&&o.resolve(s)}return s}onInit(e,n){var r;const s=this.normalizeInstanceIdentifier(n),i=(r=this.onInitCallbacks.get(s))!==null&&r!==void 0?r:new Set;i.add(e),this.onInitCallbacks.set(s,i);const o=this.instances.get(s);return o&&e(o,s),()=>{i.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(!!r)for(const s of r)try{s(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:XL(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Ti){return this.component?this.component.multipleInstances?e:Ti:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function XL(t){return t===Ti?void 0:t}function ZL(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L0{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new M0(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const j_=[];var fe;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(fe||(fe={}));const F0={debug:fe.DEBUG,verbose:fe.VERBOSE,info:fe.INFO,warn:fe.WARN,error:fe.ERROR,silent:fe.SILENT},eF=fe.INFO,tF={[fe.DEBUG]:"log",[fe.VERBOSE]:"log",[fe.INFO]:"info",[fe.WARN]:"warn",[fe.ERROR]:"error"},nF=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),s=tF[e];if(s)console[s](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Vr{constructor(e){this.name=e,this._logLevel=eF,this._logHandler=nF,this._userLogHandler=null,j_.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in fe))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?F0[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,fe.DEBUG,...e),this._logHandler(this,fe.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,fe.VERBOSE,...e),this._logHandler(this,fe.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,fe.INFO,...e),this._logHandler(this,fe.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,fe.WARN,...e),this._logHandler(this,fe.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,fe.ERROR,...e),this._logHandler(this,fe.ERROR,...e)}}function rF(t){j_.forEach(e=>{e.setLogLevel(t)})}function sF(t,e){for(const n of j_){let r=null;e&&e.level&&(r=F0[e.level]),t===null?n.userLogHandler=null:n.userLogHandler=(s,i,...o)=>{const a=o.map(c=>{if(c==null)return null;if(typeof c=="string")return c;if(typeof c=="number"||typeof c=="boolean")return c.toString();if(c instanceof Error)return c.message;try{return JSON.stringify(c)}catch{return null}}).filter(c=>c).join(" ");i>=(r!=null?r:s.logLevel)&&t({level:fe[i].toLowerCase(),message:a,args:o,type:s.name})}}}const iF=(t,e)=>e.some(n=>t instanceof n);let jb,Kb;function oF(){return jb||(jb=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function aF(){return Kb||(Kb=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const U0=new WeakMap,Zg=new WeakMap,$0=new WeakMap,Up=new WeakMap,K_=new WeakMap;function cF(t){const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("success",i),t.removeEventListener("error",o)},i=()=>{n(es(t.result)),s()},o=()=>{r(t.error),s()};t.addEventListener("success",i),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&U0.set(n,t)}).catch(()=>{}),K_.set(e,t),e}function lF(t){if(Zg.has(t))return;const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",o),t.removeEventListener("abort",o)},i=()=>{n(),s()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",i),t.addEventListener("error",o),t.addEventListener("abort",o)});Zg.set(t,e)}let em={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return Zg.get(t);if(e==="objectStoreNames")return t.objectStoreNames||$0.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return es(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function uF(t){em=t(em)}function hF(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call($p(this),e,...n);return $0.set(r,e.sort?e.sort():[e]),es(r)}:aF().includes(t)?function(...e){return t.apply($p(this),e),es(U0.get(this))}:function(...e){return es(t.apply($p(this),e))}}function dF(t){return typeof t=="function"?hF(t):(t instanceof IDBTransaction&&lF(t),iF(t,oF())?new Proxy(t,em):t)}function es(t){if(t instanceof IDBRequest)return cF(t);if(Up.has(t))return Up.get(t);const e=dF(t);return e!==t&&(Up.set(t,e),K_.set(e,t)),e}const $p=t=>K_.get(t);function Wa(t,e,{blocked:n,upgrade:r,blocking:s,terminated:i}={}){const o=indexedDB.open(t,e),a=es(o);return r&&o.addEventListener("upgradeneeded",c=>{r(es(o.result),c.oldVersion,c.newVersion,es(o.transaction))}),n&&o.addEventListener("blocked",()=>n()),a.then(c=>{i&&c.addEventListener("close",()=>i()),s&&c.addEventListener("versionchange",()=>s())}).catch(()=>{}),a}function ra(t,{blocked:e}={}){const n=indexedDB.deleteDatabase(t);return e&&n.addEventListener("blocked",()=>e()),es(n).then(()=>{})}const fF=["get","getKey","getAll","getAllKeys","count"],pF=["put","add","delete","clear"],Vp=new Map;function Hb(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(Vp.get(e))return Vp.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,s=pF.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(s||fF.includes(n)))return;const i=async function(o,...a){const c=this.transaction(o,s?"readwrite":"readonly");let l=c.store;return r&&(l=l.index(a.shift())),(await Promise.all([l[n](...a),s&&c.done]))[0]};return Vp.set(e,i),i}uF(t=>({...t,get:(e,n,r)=>Hb(e,n)||t.get(e,n,r),has:(e,n)=>!!Hb(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gF{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(mF(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function mF(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const tm="@firebase/app",Wb="0.7.28";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const H_=new Vr("@firebase/app"),_F="@firebase/app-compat",yF="@firebase/analytics-compat",vF="@firebase/analytics",wF="@firebase/app-check-compat",bF="@firebase/app-check",IF="@firebase/auth",EF="@firebase/auth-compat",TF="@firebase/database",SF="@firebase/database-compat",CF="@firebase/functions",AF="@firebase/functions-compat",kF="@firebase/installations",RF="@firebase/installations-compat",NF="@firebase/messaging",PF="@firebase/messaging-compat",DF="@firebase/performance",xF="@firebase/performance-compat",OF="@firebase/remote-config",MF="@firebase/remote-config-compat",LF="@firebase/storage",FF="@firebase/storage-compat",UF="@firebase/firestore",$F="@firebase/firestore-compat",VF="firebase",BF="9.9.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ji="[DEFAULT]",qF={[tm]:"fire-core",[_F]:"fire-core-compat",[vF]:"fire-analytics",[yF]:"fire-analytics-compat",[bF]:"fire-app-check",[wF]:"fire-app-check-compat",[IF]:"fire-auth",[EF]:"fire-auth-compat",[TF]:"fire-rtdb",[SF]:"fire-rtdb-compat",[CF]:"fire-fn",[AF]:"fire-fn-compat",[kF]:"fire-iid",[RF]:"fire-iid-compat",[NF]:"fire-fcm",[PF]:"fire-fcm-compat",[DF]:"fire-perf",[xF]:"fire-perf-compat",[OF]:"fire-rc",[MF]:"fire-rc-compat",[LF]:"fire-gcs",[FF]:"fire-gcs-compat",[UF]:"fire-fst",[$F]:"fire-fst-compat","fire-js":"fire-js",[VF]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zs=new Map,bl=new Map;function Gh(t,e){try{t.container.addComponent(e)}catch(n){H_.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function V0(t,e){t.container.addOrOverwriteComponent(e)}function st(t){const e=t.name;if(bl.has(e))return H_.debug(`There were multiple attempts to register component ${e}.`),!1;bl.set(e,t);for(const n of zs.values())Gh(n,t);return!0}function So(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function jF(t,e,n=Ji){So(t,e).clearInstance(n)}function KF(){bl.clear()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HF={["no-app"]:"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()",["bad-app-name"]:"Illegal App name: '{$appName}",["duplicate-app"]:"Firebase App named '{$appName}' already exists with different options or config",["app-deleted"]:"Firebase App named '{$appName}' already deleted",["invalid-app-argument"]:"firebase.{$appName}() takes either no argument or a Firebase App instance.",["invalid-log-argument"]:"First argument to `onLog` must be null or a function.",["storage-open"]:"Error thrown when opening storage. Original error: {$originalErrorMessage}.",["storage-get"]:"Error thrown when reading from storage. Original error: {$originalErrorMessage}.",["storage-set"]:"Error thrown when writing to storage. Original error: {$originalErrorMessage}.",["storage-delete"]:"Error thrown when deleting from storage. Original error: {$originalErrorMessage}."},Qs=new pn("app","Firebase",HF);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WF{constructor(e,n,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Ee("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Qs.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Br=BF;function B0(t,e={}){typeof e!="object"&&(e={name:e});const n=Object.assign({name:Ji,automaticDataCollectionEnabled:!1},e),r=n.name;if(typeof r!="string"||!r)throw Qs.create("bad-app-name",{appName:String(r)});const s=zs.get(r);if(s){if(Xg(t,s.options)&&Xg(n,s.config))return s;throw Qs.create("duplicate-app",{appName:r})}const i=new L0(r);for(const a of bl.values())i.addComponent(a);const o=new WF(t,n,i);return zs.set(r,o),o}function q0(t=Ji){const e=zs.get(t);if(!e)throw Qs.create("no-app",{appName:t});return e}function GF(){return Array.from(zs.values())}async function j0(t){const e=t.name;zs.has(e)&&(zs.delete(e),await Promise.all(t.container.getProviders().map(n=>n.delete())),t.isDeleted=!0)}function Fe(t,e,n){var r;let s=(r=qF[t])!==null&&r!==void 0?r:t;n&&(s+=`-${n}`);const i=s.match(/\s|\//),o=e.match(/\s|\//);if(i||o){const a=[`Unable to register library "${s}" with version "${e}":`];i&&a.push(`library name "${s}" contains illegal characters (whitespace or "/")`),i&&o&&a.push("and"),o&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),H_.warn(a.join(" "));return}st(new Ee(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}function K0(t,e){if(t!==null&&typeof t!="function")throw Qs.create("invalid-log-argument");sF(t,e)}function H0(t){rF(t)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zF="firebase-heartbeat-database",QF=1,Il="firebase-heartbeat-store";let Bp=null;function W0(){return Bp||(Bp=Wa(zF,QF,{upgrade:(t,e)=>{switch(e){case 0:t.createObjectStore(Il)}}}).catch(t=>{throw Qs.create("storage-open",{originalErrorMessage:t.message})})),Bp}async function YF(t){var e;try{return(await W0()).transaction(Il).objectStore(Il).get(G0(t))}catch(n){throw Qs.create("storage-get",{originalErrorMessage:(e=n)===null||e===void 0?void 0:e.message})}}async function Gb(t,e){var n;try{const s=(await W0()).transaction(Il,"readwrite");return await s.objectStore(Il).put(e,G0(t)),s.done}catch(r){throw Qs.create("storage-set",{originalErrorMessage:(n=r)===null||n===void 0?void 0:n.message})}}function G0(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JF=1024,XF=30*24*60*60*1e3;class ZF{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new tU(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=zb();if(this._heartbeatsCache===null&&(this._heartbeatsCache=await this._heartbeatsCachePromise),!(this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(s=>s.date===r)))return this._heartbeatsCache.heartbeats.push({date:r,agent:n}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(s=>{const i=new Date(s.date).valueOf();return Date.now()-i<=XF}),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache===null||this._heartbeatsCache.heartbeats.length===0)return"";const e=zb(),{heartbeatsToSend:n,unsentEntries:r}=eU(this._heartbeatsCache.heartbeats),s=jh(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=e,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}}function zb(){return new Date().toISOString().substring(0,10)}function eU(t,e=JF){const n=[];let r=t.slice();for(const s of t){const i=n.find(o=>o.agent===s.agent);if(i){if(i.dates.push(s.date),Qb(n)>e){i.dates.pop();break}}else if(n.push({agent:s.agent,dates:[s.date]}),Qb(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class tU{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return In()?du().then(()=>!0).catch(()=>!1):!1}async read(){return await this._canUseIndexedDBPromise?await YF(this.app)||{heartbeats:[]}:{heartbeats:[]}}async overwrite(e){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return Gb(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return Gb(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function Qb(t){return jh(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nU(t){st(new Ee("platform-logger",e=>new gF(e),"PRIVATE")),st(new Ee("heartbeat",e=>new ZF(e),"PRIVATE")),Fe(tm,Wb,t),Fe(tm,Wb,"esm2017"),Fe("fire-js","")}nU("");var rU=Object.freeze(Object.defineProperty({__proto__:null,SDK_VERSION:Br,_DEFAULT_ENTRY_NAME:Ji,_addComponent:Gh,_addOrOverwriteComponent:V0,_apps:zs,_clearComponents:KF,_components:bl,_getProvider:So,_registerComponent:st,_removeServiceInstance:jF,deleteApp:j0,getApp:q0,getApps:GF,initializeApp:B0,onLog:K0,registerVersion:Fe,setLogLevel:H0,FirebaseError:ut},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sU{constructor(e,n){this._delegate=e,this.firebase=n,Gh(e,new Ee("app-compat",()=>this,"PUBLIC")),this.container=e.container}get automaticDataCollectionEnabled(){return this._delegate.automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this._delegate.automaticDataCollectionEnabled=e}get name(){return this._delegate.name}get options(){return this._delegate.options}delete(){return new Promise(e=>{this._delegate.checkDestroyed(),e()}).then(()=>(this.firebase.INTERNAL.removeApp(this.name),j0(this._delegate)))}_getService(e,n=Ji){var r;this._delegate.checkDestroyed();const s=this._delegate.container.getProvider(e);return!s.isInitialized()&&((r=s.getComponent())===null||r===void 0?void 0:r.instantiationMode)==="EXPLICIT"&&s.initialize(),s.getImmediate({identifier:n})}_removeServiceInstance(e,n=Ji){this._delegate.container.getProvider(e).clearInstance(n)}_addComponent(e){Gh(this._delegate,e)}_addOrOverwriteComponent(e){V0(this._delegate,e)}toJSON(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iU={["no-app"]:"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()",["invalid-app-argument"]:"firebase.{$appName}() takes either no argument or a Firebase App instance."},Yb=new pn("app-compat","Firebase",iU);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oU(t){const e={},n={__esModule:!0,initializeApp:i,app:s,registerVersion:Fe,setLogLevel:H0,onLog:K0,apps:null,SDK_VERSION:Br,INTERNAL:{registerComponent:a,removeApp:r,useAsService:c,modularAPIs:rU}};n.default=n,Object.defineProperty(n,"apps",{get:o});function r(l){delete e[l]}function s(l){if(l=l||Ji,!xn(e,l))throw Yb.create("no-app",{appName:l});return e[l]}s.App=t;function i(l,u={}){const h=B0(l,u);if(xn(e,h.name))return e[h.name];const d=new t(h,n);return e[h.name]=d,d}function o(){return Object.keys(e).map(l=>e[l])}function a(l){const u=l.name,h=u.replace("-compat","");if(st(l)&&l.type==="PUBLIC"){const d=(f=s())=>{if(typeof f[h]!="function")throw Yb.create("invalid-app-argument",{appName:u});return f[h]()};l.serviceProps!==void 0&&vl(d,l.serviceProps),n[h]=d,t.prototype[h]=function(...f){return this._getService.bind(this,u).apply(this,l.multipleInstances?f:[])}}return l.type==="PUBLIC"?n[h]:null}function c(l,u){return u==="serverAuth"?null:u}return n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function z0(){const t=oU(sU);t.INTERNAL=Object.assign(Object.assign({},t.INTERNAL),{createFirebaseNamespace:z0,extendNamespace:e,createSubscribe:O0,ErrorFactory:pn,deepExtend:vl});function e(n){vl(t,n)}return t}const aU=z0();/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jb=new Vr("@firebase/app-compat"),cU="@firebase/app-compat",lU="0.1.29";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uU(t){Fe(cU,lU,t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */if(DL()&&self.firebase!==void 0){Jb.warn(`
    Warning: Firebase is already defined in the global scope. Please make sure
    Firebase library is only loaded once.
  `);const t=self.firebase.SDK_VERSION;t&&t.indexOf("LITE")>=0&&Jb.warn(`
    Warning: You are trying to load Firebase while using Firebase Performance standalone script.
    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.
    `)}const ht=aU;uU();const Q0="@firebase/installations",W_="0.5.12";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Y0=1e4,J0=`w:${W_}`,X0="FIS_v2",hU="https://firebaseinstallations.googleapis.com/v1",dU=60*60*1e3,fU="installations",pU="Installations";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gU={["missing-app-config-values"]:'Missing App configuration value: "{$valueName}"',["not-registered"]:"Firebase Installation is not registered.",["installation-not-found"]:"Firebase Installation not found.",["request-failed"]:'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',["app-offline"]:"Could not process request. Application offline.",["delete-pending-registration"]:"Can't delete installation while there is a pending registration request."},Xi=new pn(fU,pU,gU);function Z0(t){return t instanceof ut&&t.code.includes("request-failed")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eC({projectId:t}){return`${hU}/projects/${t}/installations`}function tC(t){return{token:t.token,requestStatus:2,expiresIn:_U(t.expiresIn),creationTime:Date.now()}}async function nC(t,e){const r=(await e.json()).error;return Xi.create("request-failed",{requestName:t,serverCode:r.code,serverMessage:r.message,serverStatus:r.status})}function rC({apiKey:t}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t})}function mU(t,{refreshToken:e}){const n=rC(t);return n.append("Authorization",yU(e)),n}async function sC(t){const e=await t();return e.status>=500&&e.status<600?t():e}function _U(t){return Number(t.replace("s","000"))}function yU(t){return`${X0} ${t}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function vU({appConfig:t,heartbeatServiceProvider:e},{fid:n}){const r=eC(t),s=rC(t),i=e.getImmediate({optional:!0});if(i){const l=await i.getHeartbeatsHeader();l&&s.append("x-firebase-client",l)}const o={fid:n,authVersion:X0,appId:t.appId,sdkVersion:J0},a={method:"POST",headers:s,body:JSON.stringify(o)},c=await sC(()=>fetch(r,a));if(c.ok){const l=await c.json();return{fid:l.fid||n,registrationStatus:2,refreshToken:l.refreshToken,authToken:tC(l.authToken)}}else throw await nC("Create Installation",c)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iC(t){return new Promise(e=>{setTimeout(e,t)})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wU(t){return btoa(String.fromCharCode(...t)).replace(/\+/g,"-").replace(/\//g,"_")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bU=/^[cdef][\w-]{21}$/,nm="";function IU(){try{const t=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(t),t[0]=112+t[0]%16;const n=EU(t);return bU.test(n)?n:nm}catch{return nm}}function EU(t){return wU(t).substr(0,22)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lf(t){return`${t.appName}!${t.appId}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oC=new Map;function aC(t,e){const n=lf(t);cC(n,e),TU(n,e)}function cC(t,e){const n=oC.get(t);if(!!n)for(const r of n)r(e)}function TU(t,e){const n=SU();n&&n.postMessage({key:t,fid:e}),CU()}let Li=null;function SU(){return!Li&&"BroadcastChannel"in self&&(Li=new BroadcastChannel("[Firebase] FID Change"),Li.onmessage=t=>{cC(t.data.key,t.data.fid)}),Li}function CU(){oC.size===0&&Li&&(Li.close(),Li=null)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AU="firebase-installations-database",kU=1,Zi="firebase-installations-store";let qp=null;function G_(){return qp||(qp=Wa(AU,kU,{upgrade:(t,e)=>{switch(e){case 0:t.createObjectStore(Zi)}}})),qp}async function zh(t,e){const n=lf(t),s=(await G_()).transaction(Zi,"readwrite"),i=s.objectStore(Zi),o=await i.get(n);return await i.put(e,n),await s.done,(!o||o.fid!==e.fid)&&aC(t,e.fid),e}async function lC(t){const e=lf(t),r=(await G_()).transaction(Zi,"readwrite");await r.objectStore(Zi).delete(e),await r.done}async function uf(t,e){const n=lf(t),s=(await G_()).transaction(Zi,"readwrite"),i=s.objectStore(Zi),o=await i.get(n),a=e(o);return a===void 0?await i.delete(n):await i.put(a,n),await s.done,a&&(!o||o.fid!==a.fid)&&aC(t,a.fid),a}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function z_(t){let e;const n=await uf(t.appConfig,r=>{const s=RU(r),i=NU(t,s);return e=i.registrationPromise,i.installationEntry});return n.fid===nm?{installationEntry:await e}:{installationEntry:n,registrationPromise:e}}function RU(t){const e=t||{fid:IU(),registrationStatus:0};return uC(e)}function NU(t,e){if(e.registrationStatus===0){if(!navigator.onLine){const s=Promise.reject(Xi.create("app-offline"));return{installationEntry:e,registrationPromise:s}}const n={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},r=PU(t,n);return{installationEntry:n,registrationPromise:r}}else return e.registrationStatus===1?{installationEntry:e,registrationPromise:DU(t)}:{installationEntry:e}}async function PU(t,e){try{const n=await vU(t,e);return zh(t.appConfig,n)}catch(n){throw Z0(n)&&n.customData.serverCode===409?await lC(t.appConfig):await zh(t.appConfig,{fid:e.fid,registrationStatus:0}),n}}async function DU(t){let e=await Xb(t.appConfig);for(;e.registrationStatus===1;)await iC(100),e=await Xb(t.appConfig);if(e.registrationStatus===0){const{installationEntry:n,registrationPromise:r}=await z_(t);return r||n}return e}function Xb(t){return uf(t,e=>{if(!e)throw Xi.create("installation-not-found");return uC(e)})}function uC(t){return xU(t)?{fid:t.fid,registrationStatus:0}:t}function xU(t){return t.registrationStatus===1&&t.registrationTime+Y0<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function OU({appConfig:t,heartbeatServiceProvider:e},n){const r=MU(t,n),s=mU(t,n),i=e.getImmediate({optional:!0});if(i){const l=await i.getHeartbeatsHeader();l&&s.append("x-firebase-client",l)}const o={installation:{sdkVersion:J0,appId:t.appId}},a={method:"POST",headers:s,body:JSON.stringify(o)},c=await sC(()=>fetch(r,a));if(c.ok){const l=await c.json();return tC(l)}else throw await nC("Generate Auth Token",c)}function MU(t,{fid:e}){return`${eC(t)}/${e}/authTokens:generate`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Q_(t,e=!1){let n;const r=await uf(t.appConfig,i=>{if(!hC(i))throw Xi.create("not-registered");const o=i.authToken;if(!e&&UU(o))return i;if(o.requestStatus===1)return n=LU(t,e),i;{if(!navigator.onLine)throw Xi.create("app-offline");const a=VU(i);return n=FU(t,a),a}});return n?await n:r.authToken}async function LU(t,e){let n=await Zb(t.appConfig);for(;n.authToken.requestStatus===1;)await iC(100),n=await Zb(t.appConfig);const r=n.authToken;return r.requestStatus===0?Q_(t,e):r}function Zb(t){return uf(t,e=>{if(!hC(e))throw Xi.create("not-registered");const n=e.authToken;return BU(n)?Object.assign(Object.assign({},e),{authToken:{requestStatus:0}}):e})}async function FU(t,e){try{const n=await OU(t,e),r=Object.assign(Object.assign({},e),{authToken:n});return await zh(t.appConfig,r),n}catch(n){if(Z0(n)&&(n.customData.serverCode===401||n.customData.serverCode===404))await lC(t.appConfig);else{const r=Object.assign(Object.assign({},e),{authToken:{requestStatus:0}});await zh(t.appConfig,r)}throw n}}function hC(t){return t!==void 0&&t.registrationStatus===2}function UU(t){return t.requestStatus===2&&!$U(t)}function $U(t){const e=Date.now();return e<t.creationTime||t.creationTime+t.expiresIn<e+dU}function VU(t){const e={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},t),{authToken:e})}function BU(t){return t.requestStatus===1&&t.requestTime+Y0<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function qU(t){const e=t,{installationEntry:n,registrationPromise:r}=await z_(e);return r?r.catch(console.error):Q_(e).catch(console.error),n.fid}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function jU(t,e=!1){const n=t;return await KU(n),(await Q_(n,e)).token}async function KU(t){const{registrationPromise:e}=await z_(t);e&&await e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function HU(t){if(!t||!t.options)throw jp("App Configuration");if(!t.name)throw jp("App Name");const e=["projectId","apiKey","appId"];for(const n of e)if(!t.options[n])throw jp(n);return{appName:t.name,projectId:t.options.projectId,apiKey:t.options.apiKey,appId:t.options.appId}}function jp(t){return Xi.create("missing-app-config-values",{valueName:t})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dC="installations",WU="installations-internal",GU=t=>{const e=t.getProvider("app").getImmediate(),n=HU(e),r=So(e,"heartbeat");return{app:e,appConfig:n,heartbeatServiceProvider:r,_delete:()=>Promise.resolve()}},zU=t=>{const e=t.getProvider("app").getImmediate(),n=So(e,dC).getImmediate();return{getId:()=>qU(n),getToken:s=>jU(n,s)}};function QU(){st(new Ee(dC,GU,"PUBLIC")),st(new Ee(WU,zU,"PRIVATE"))}QU();Fe(Q0,W_);Fe(Q0,W_,"esm2017");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eI="analytics",YU="firebase_id",JU="origin",XU=60*1e3,ZU="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",fC="https://www.googletagmanager.com/gtag/js";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jt=new Vr("@firebase/analytics");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pC(t){return Promise.all(t.map(e=>e.catch(n=>n)))}function e$(t,e){const n=document.createElement("script");n.src=`${fC}?l=${t}&id=${e}`,n.async=!0,document.head.appendChild(n)}function t$(t){let e=[];return Array.isArray(window[t])?e=window[t]:window[t]=e,e}async function n$(t,e,n,r,s,i){const o=r[s];try{if(o)await e[o];else{const c=(await pC(n)).find(l=>l.measurementId===s);c&&await e[c.appId]}}catch(a){jt.error(a)}t("config",s,i)}async function r$(t,e,n,r,s){try{let i=[];if(s&&s.send_to){let o=s.send_to;Array.isArray(o)||(o=[o]);const a=await pC(n);for(const c of o){const l=a.find(h=>h.measurementId===c),u=l&&e[l.appId];if(u)i.push(u);else{i=[];break}}}i.length===0&&(i=Object.values(e)),await Promise.all(i),t("event",r,s||{})}catch(i){jt.error(i)}}function s$(t,e,n,r){async function s(i,o,a){try{i==="event"?await r$(t,e,n,o,a):i==="config"?await n$(t,e,n,r,o,a):i==="consent"?t("consent","update",a):t("set",o)}catch(c){jt.error(c)}}return s}function i$(t,e,n,r,s){let i=function(...o){window[r].push(arguments)};return window[s]&&typeof window[s]=="function"&&(i=window[s]),window[s]=s$(i,t,e,n),{gtagCore:i,wrappedGtag:window[s]}}function o$(){const t=window.document.getElementsByTagName("script");for(const e of Object.values(t))if(e.src&&e.src.includes(fC))return e;return null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const a$={["already-exists"]:"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.",["already-initialized"]:"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-intialized instance.",["already-initialized-settings"]:"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.",["interop-component-reg-failed"]:"Firebase Analytics Interop Component failed to instantiate: {$reason}",["invalid-analytics-context"]:"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}",["indexeddb-unavailable"]:"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}",["fetch-throttle"]:"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.",["config-fetch-failed"]:"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}",["no-api-key"]:'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',["no-app-id"]:'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.'},Wn=new pn("analytics","Analytics",a$);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const c$=30,l$=1e3;class u${constructor(e={},n=l$){this.throttleMetadata=e,this.intervalMillis=n}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,n){this.throttleMetadata[e]=n}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}}const gC=new u$;function h$(t){return new Headers({Accept:"application/json","x-goog-api-key":t})}async function d$(t){var e;const{appId:n,apiKey:r}=t,s={method:"GET",headers:h$(r)},i=ZU.replace("{app-id}",n),o=await fetch(i,s);if(o.status!==200&&o.status!==304){let a="";try{const c=await o.json();!((e=c.error)===null||e===void 0)&&e.message&&(a=c.error.message)}catch{}throw Wn.create("config-fetch-failed",{httpStatus:o.status,responseMessage:a})}return o.json()}async function f$(t,e=gC,n){const{appId:r,apiKey:s,measurementId:i}=t.options;if(!r)throw Wn.create("no-app-id");if(!s){if(i)return{measurementId:i,appId:r};throw Wn.create("no-api-key")}const o=e.getThrottleMetadata(r)||{backoffCount:0,throttleEndTimeMillis:Date.now()},a=new m$;return setTimeout(async()=>{a.abort()},n!==void 0?n:XU),mC({appId:r,apiKey:s,measurementId:i},o,a,e)}async function mC(t,{throttleEndTimeMillis:e,backoffCount:n},r,s=gC){var i,o;const{appId:a,measurementId:c}=t;try{await p$(r,e)}catch(l){if(c)return jt.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${c} provided in the "measurementId" field in the local Firebase config. [${(i=l)===null||i===void 0?void 0:i.message}]`),{appId:a,measurementId:c};throw l}try{const l=await d$(t);return s.deleteThrottleMetadata(a),l}catch(l){const u=l;if(!g$(u)){if(s.deleteThrottleMetadata(a),c)return jt.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${c} provided in the "measurementId" field in the local Firebase config. [${u==null?void 0:u.message}]`),{appId:a,measurementId:c};throw l}const h=Number((o=u==null?void 0:u.customData)===null||o===void 0?void 0:o.httpStatus)===503?Wh(n,s.intervalMillis,c$):Wh(n,s.intervalMillis),d={throttleEndTimeMillis:Date.now()+h,backoffCount:n+1};return s.setThrottleMetadata(a,d),jt.debug(`Calling attemptFetch again in ${h} millis`),mC(t,d,r,s)}}function p$(t,e){return new Promise((n,r)=>{const s=Math.max(e-Date.now(),0),i=setTimeout(n,s);t.addEventListener(()=>{clearTimeout(i),r(Wn.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}function g$(t){if(!(t instanceof ut)||!t.customData)return!1;const e=Number(t.customData.httpStatus);return e===429||e===500||e===503||e===504}class m${constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach(e=>e())}}async function _$(t,e,n,r,s){if(s&&s.global){t("event",n,r);return}else{const i=await e,o=Object.assign(Object.assign({},r),{send_to:i});t("event",n,o)}}async function y$(t,e,n,r){if(r&&r.global)return t("set",{screen_name:n}),Promise.resolve();{const s=await e;t("config",s,{update:!0,screen_name:n})}}async function v$(t,e,n,r){if(r&&r.global)return t("set",{user_id:n}),Promise.resolve();{const s=await e;t("config",s,{update:!0,user_id:n})}}async function w$(t,e,n,r){if(r&&r.global){const s={};for(const i of Object.keys(n))s[`user_properties.${i}`]=n[i];return t("set",s),Promise.resolve()}else{const s=await e;t("config",s,{update:!0,user_properties:n})}}async function b$(t,e){const n=await t;window[`ga-disable-${n}`]=!e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function I$(){var t;if(In())try{await du()}catch(e){return jt.warn(Wn.create("indexeddb-unavailable",{errorInfo:(t=e)===null||t===void 0?void 0:t.toString()}).message),!1}else return jt.warn(Wn.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;return!0}async function E$(t,e,n,r,s,i,o){var a;const c=f$(t);c.then(f=>{n[f.measurementId]=f.appId,t.options.measurementId&&f.measurementId!==t.options.measurementId&&jt.warn(`The measurement ID in the local Firebase config (${t.options.measurementId}) does not match the measurement ID fetched from the server (${f.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(f=>jt.error(f)),e.push(c);const l=I$().then(f=>{if(f)return r.getId()}),[u,h]=await Promise.all([c,l]);o$()||e$(i,u.measurementId),s("js",new Date);const d=(a=o==null?void 0:o.config)!==null&&a!==void 0?a:{};return d[JU]="firebase",d.update=!0,h!=null&&(d[YU]=h),s("config",u.measurementId,d),u.measurementId}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T${constructor(e){this.app=e}_delete(){return delete ts[this.app.options.appId],Promise.resolve()}}let ts={},tI=[];const nI={};let Th="dataLayer",_C="gtag",rI,fu,rm=!1;function S$(t){if(rm)throw Wn.create("already-initialized");t.dataLayerName&&(Th=t.dataLayerName),t.gtagName&&(_C=t.gtagName)}function C$(){const t=[];if(uu()&&t.push("This is a browser extension environment."),af()||t.push("Cookies are not available."),t.length>0){const e=t.map((r,s)=>`(${s+1}) ${r}`).join(" "),n=Wn.create("invalid-analytics-context",{errorInfo:e});jt.warn(n.message)}}function A$(t,e,n){C$();const r=t.options.appId;if(!r)throw Wn.create("no-app-id");if(!t.options.apiKey)if(t.options.measurementId)jt.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${t.options.measurementId} provided in the "measurementId" field in the local Firebase config.`);else throw Wn.create("no-api-key");if(ts[r]!=null)throw Wn.create("already-exists",{id:r});if(!rm){t$(Th);const{wrappedGtag:i,gtagCore:o}=i$(ts,tI,nI,Th,_C);fu=i,rI=o,rm=!0}return ts[r]=E$(t,tI,nI,e,rI,Th,n),new T$(t)}async function k$(){if(uu()||!af()||!In())return!1;try{return await du()}catch{return!1}}function R$(t,e,n){t=N(t),y$(fu,ts[t.app.options.appId],e,n).catch(r=>jt.error(r))}function N$(t,e,n){t=N(t),v$(fu,ts[t.app.options.appId],e,n).catch(r=>jt.error(r))}function P$(t,e,n){t=N(t),w$(fu,ts[t.app.options.appId],e,n).catch(r=>jt.error(r))}function D$(t,e){t=N(t),b$(ts[t.app.options.appId],e).catch(n=>jt.error(n))}function yC(t,e,n,r){t=N(t),_$(fu,ts[t.app.options.appId],e,n,r).catch(s=>jt.error(s))}const sI="@firebase/analytics",iI="0.8.0";function x$(){st(new Ee(eI,(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("installations-internal").getImmediate();return A$(r,s,n)},"PUBLIC")),st(new Ee("analytics-internal",t,"PRIVATE")),Fe(sI,iI),Fe(sI,iI,"esm2017");function t(e){try{const n=e.getProvider(eI).getImmediate();return{logEvent:(r,s,i)=>yC(n,r,s,i)}}catch(n){throw Wn.create("interop-component-reg-failed",{reason:n})}}}x$();const O$="@firebase/analytics-compat",M$="0.1.13";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vC{constructor(e,n){this.app=e,this._delegate=n}logEvent(e,n,r){yC(this._delegate,e,n,r)}setCurrentScreen(e,n){R$(this._delegate,e,n)}setUserId(e,n){N$(this._delegate,e,n)}setUserProperties(e,n){P$(this._delegate,e,n)}setAnalyticsCollectionEnabled(e){D$(this._delegate,e)}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var sm;(function(t){t.ADD_SHIPPING_INFO="add_shipping_info",t.ADD_PAYMENT_INFO="add_payment_info",t.ADD_TO_CART="add_to_cart",t.ADD_TO_WISHLIST="add_to_wishlist",t.BEGIN_CHECKOUT="begin_checkout",t.CHECKOUT_PROGRESS="checkout_progress",t.EXCEPTION="exception",t.GENERATE_LEAD="generate_lead",t.LOGIN="login",t.PAGE_VIEW="page_view",t.PURCHASE="purchase",t.REFUND="refund",t.REMOVE_FROM_CART="remove_from_cart",t.SCREEN_VIEW="screen_view",t.SEARCH="search",t.SELECT_CONTENT="select_content",t.SELECT_ITEM="select_item",t.SELECT_PROMOTION="select_promotion",t.SET_CHECKOUT_OPTION="set_checkout_option",t.SHARE="share",t.SIGN_UP="sign_up",t.TIMING_COMPLETE="timing_complete",t.VIEW_CART="view_cart",t.VIEW_ITEM="view_item",t.VIEW_ITEM_LIST="view_item_list",t.VIEW_PROMOTION="view_promotion",t.VIEW_SEARCH_RESULTS="view_search_results"})(sm||(sm={}));/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const L$=t=>{const e=t.getProvider("app-compat").getImmediate(),n=t.getProvider("analytics").getImmediate();return new vC(e,n)};function F$(){const t={Analytics:vC,settings:S$,isSupported:k$,EventName:sm};ht.INTERNAL.registerComponent(new Ee("analytics-compat",L$,"PUBLIC").setServiceProps(t).setMultipleInstances(!0))}F$();ht.registerVersion(O$,M$);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wC=new Map,U$={activated:!1,tokenObservers:[]},$$={initialized:!1,enabled:!1};function Pt(t){return wC.get(t)||U$}function ur(t,e){wC.set(t,e)}function hf(){return $$}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Y_="https://content-firebaseappcheck.googleapis.com/v1",V$="exchangeRecaptchaV3Token",B$="exchangeRecaptchaEnterpriseToken",q$="exchangeDebugToken",oI={OFFSET_DURATION:5*60*1e3,RETRIAL_MIN_WAIT:30*1e3,RETRIAL_MAX_WAIT:16*60*1e3},j$=24*60*60*1e3;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K${constructor(e,n,r,s,i){if(this.operation=e,this.retryPolicy=n,this.getWaitDuration=r,this.lowerBound=s,this.upperBound=i,this.pending=null,this.nextErrorWaitInterval=s,s>i)throw new Error("Proactive refresh lower bound greater than upper bound!")}start(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch(()=>{})}stop(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)}isRunning(){return!!this.pending}async process(e){this.stop();try{this.pending=new mt,await H$(this.getNextRun(e)),this.pending.resolve(),await this.pending.promise,this.pending=new mt,await this.operation(),this.pending.resolve(),await this.pending.promise,this.process(!0).catch(()=>{})}catch(n){this.retryPolicy(n)?this.process(!1).catch(()=>{}):this.stop()}}getNextRun(e){if(e)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();{const n=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),n}}}function H$(t){return new Promise(e=>{setTimeout(e,t)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const W$={["already-initialized"]:"You have already called initializeAppCheck() for FirebaseApp {$appName} with different options. To avoid this error, call initializeAppCheck() with the same options as when it was originally called. This will return the already initialized instance.",["use-before-activation"]:"App Check is being used before initializeAppCheck() is called for FirebaseApp {$appName}. Call initializeAppCheck() before instantiating other Firebase services.",["fetch-network-error"]:"Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.",["fetch-parse-error"]:"Fetch client could not parse response. Original error: {$originalErrorMessage}.",["fetch-status-error"]:"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.",["storage-open"]:"Error thrown when opening storage. Original error: {$originalErrorMessage}.",["storage-get"]:"Error thrown when reading from storage. Original error: {$originalErrorMessage}.",["storage-set"]:"Error thrown when writing to storage. Original error: {$originalErrorMessage}.",["recaptcha-error"]:"ReCAPTCHA error.",throttled:"Requests throttled due to {$httpStatus} error. Attempts allowed again after {$time}"},ln=new pn("appCheck","AppCheck",W$);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qh(t=!1){var e;return t?(e=self.grecaptcha)===null||e===void 0?void 0:e.enterprise:self.grecaptcha}function bC(t){if(!Pt(t).activated)throw ln.create("use-before-activation",{appName:t.name})}function J_(t){const e=Math.round(t/1e3),n=Math.floor(e/(3600*24)),r=Math.floor((e-n*3600*24)/3600),s=Math.floor((e-n*3600*24-r*3600)/60),i=e-n*3600*24-r*3600-s*60;let o="";return n&&(o+=eh(n)+"d:"),r&&(o+=eh(r)+"h:"),o+=eh(s)+"m:"+eh(i)+"s",o}function eh(t){return t===0?"00":t>=10?t.toString():"0"+t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function X_({url:t,body:e},n){var r,s;const i={"Content-Type":"application/json"},o=n.getImmediate({optional:!0});if(o){const f=await o.getHeartbeatsHeader();f&&(i["X-Firebase-Client"]=f)}const a={method:"POST",body:JSON.stringify(e),headers:i};let c;try{c=await fetch(t,a)}catch(f){throw ln.create("fetch-network-error",{originalErrorMessage:(r=f)===null||r===void 0?void 0:r.message})}if(c.status!==200)throw ln.create("fetch-status-error",{httpStatus:c.status});let l;try{l=await c.json()}catch(f){throw ln.create("fetch-parse-error",{originalErrorMessage:(s=f)===null||s===void 0?void 0:s.message})}const u=l.ttl.match(/^([\d.]+)(s)$/);if(!u||!u[2]||isNaN(Number(u[1])))throw ln.create("fetch-parse-error",{originalErrorMessage:`ttl field (timeToLive) is not in standard Protobuf Duration format: ${l.ttl}`});const h=Number(u[1])*1e3,d=Date.now();return{token:l.token,expireTimeMillis:d+h,issuedAtTimeMillis:d}}function G$(t,e){const{projectId:n,appId:r,apiKey:s}=t.options;return{url:`${Y_}/projects/${n}/apps/${r}:${V$}?key=${s}`,body:{recaptcha_v3_token:e}}}function z$(t,e){const{projectId:n,appId:r,apiKey:s}=t.options;return{url:`${Y_}/projects/${n}/apps/${r}:${B$}?key=${s}`,body:{recaptcha_enterprise_token:e}}}function Q$(t,e){const{projectId:n,appId:r,apiKey:s}=t.options;return{url:`${Y_}/projects/${n}/apps/${r}:${q$}?key=${s}`,body:{debug_token:e}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Y$="firebase-app-check-database",J$=1,El="firebase-app-check-store",IC="debug-token";let th=null;function EC(){return th||(th=new Promise((t,e)=>{var n;try{const r=indexedDB.open(Y$,J$);r.onsuccess=s=>{t(s.target.result)},r.onerror=s=>{var i;e(ln.create("storage-open",{originalErrorMessage:(i=s.target.error)===null||i===void 0?void 0:i.message}))},r.onupgradeneeded=s=>{const i=s.target.result;switch(s.oldVersion){case 0:i.createObjectStore(El,{keyPath:"compositeKey"})}}}catch(r){e(ln.create("storage-open",{originalErrorMessage:(n=r)===null||n===void 0?void 0:n.message}))}}),th)}function X$(t){return SC(CC(t))}function Z$(t,e){return TC(CC(t),e)}function eV(t){return TC(IC,t)}function tV(){return SC(IC)}async function TC(t,e){const r=(await EC()).transaction(El,"readwrite"),i=r.objectStore(El).put({compositeKey:t,value:e});return new Promise((o,a)=>{i.onsuccess=c=>{o()},r.onerror=c=>{var l;a(ln.create("storage-set",{originalErrorMessage:(l=c.target.error)===null||l===void 0?void 0:l.message}))}})}async function SC(t){const n=(await EC()).transaction(El,"readonly"),s=n.objectStore(El).get(t);return new Promise((i,o)=>{s.onsuccess=a=>{const c=a.target.result;i(c?c.value:void 0)},n.onerror=a=>{var c;o(ln.create("storage-get",{originalErrorMessage:(c=a.target.error)===null||c===void 0?void 0:c.message}))}})}function CC(t){return`${t.options.appId}-${t.name}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Tl=new Vr("@firebase/app-check");/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function nV(t){if(In()){let e;try{e=await X$(t)}catch(n){Tl.warn(`Failed to read token from IndexedDB. Error: ${n}`)}return e}}function aI(t,e){return In()?Z$(t,e).catch(n=>{Tl.warn(`Failed to write token to IndexedDB. Error: ${n}`)}):Promise.resolve()}async function rV(){let t;try{t=await tV()}catch{}if(t)return t;{const e=GL();return eV(e).catch(n=>Tl.warn(`Failed to persist debug token to IndexedDB. Error: ${n}`)),e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function AC(){return hf().enabled}async function kC(){const t=hf();if(t.enabled&&t.token)return t.token.promise;throw Error(`
            Can't get debug token in production mode.
        `)}function sV(){const t=LL(),e=hf();if(e.initialized=!0,typeof t.FIREBASE_APPCHECK_DEBUG_TOKEN!="string"&&t.FIREBASE_APPCHECK_DEBUG_TOKEN!==!0)return;e.enabled=!0;const n=new mt;e.token=n,typeof t.FIREBASE_APPCHECK_DEBUG_TOKEN=="string"?n.resolve(t.FIREBASE_APPCHECK_DEBUG_TOKEN):n.resolve(rV())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iV={error:"UNKNOWN_ERROR"};function oV(t){return sf.encodeString(JSON.stringify(t),!1)}async function Yh(t,e=!1){const n=t.app;bC(n);const r=Pt(n);let s=r.token,i;if(!s){const c=await r.cachedTokenPromise;c&&Jh(c)&&(s=c)}if(!e&&s&&Jh(s))return{token:s.token};let o=!1;if(AC()){r.exchangeTokenPromise||(r.exchangeTokenPromise=X_(Q$(n,await kC()),t.heartbeatServiceProvider).then(l=>(r.exchangeTokenPromise=void 0,l)),o=!0);const c=await r.exchangeTokenPromise;return await aI(n,c),ur(n,Object.assign(Object.assign({},r),{token:c})),{token:c.token}}try{r.exchangeTokenPromise||(r.exchangeTokenPromise=r.provider.getToken().then(c=>(r.exchangeTokenPromise=void 0,c)),o=!0),s=await r.exchangeTokenPromise}catch(c){c.code==="appCheck/throttled"?Tl.warn(c.message):Tl.error(c),i=c}let a;return s?(a={token:s.token},ur(n,Object.assign(Object.assign({},r),{token:s})),await aI(n,s)):a=cV(i),o&&RC(n,a),a}function Z_(t,e,n,r){const{app:s}=t,i=Pt(s),o={next:n,error:r,type:e};if(ur(s,Object.assign(Object.assign({},i),{tokenObservers:[...i.tokenObservers,o]})),i.token&&Jh(i.token)){const a=i.token;Promise.resolve().then(()=>{n({token:a.token}),cI(t)}).catch(()=>{})}i.cachedTokenPromise.then(()=>cI(t))}function ey(t,e){const n=Pt(t),r=n.tokenObservers.filter(s=>s.next!==e);r.length===0&&n.tokenRefresher&&n.tokenRefresher.isRunning()&&n.tokenRefresher.stop(),ur(t,Object.assign(Object.assign({},n),{tokenObservers:r}))}function cI(t){const{app:e}=t,n=Pt(e);let r=n.tokenRefresher;r||(r=aV(t),ur(e,Object.assign(Object.assign({},n),{tokenRefresher:r}))),!r.isRunning()&&n.isTokenAutoRefreshEnabled&&r.start()}function aV(t){const{app:e}=t;return new K$(async()=>{const n=Pt(e);let r;if(n.token?r=await Yh(t,!0):r=await Yh(t),r.error)throw r.error},()=>!0,()=>{const n=Pt(e);if(n.token){let r=n.token.issuedAtTimeMillis+(n.token.expireTimeMillis-n.token.issuedAtTimeMillis)*.5+3e5;const s=n.token.expireTimeMillis-5*60*1e3;return r=Math.min(r,s),Math.max(0,r-Date.now())}else return 0},oI.RETRIAL_MIN_WAIT,oI.RETRIAL_MAX_WAIT)}function RC(t,e){const n=Pt(t).tokenObservers;for(const r of n)try{r.type==="EXTERNAL"&&e.error!=null?r.error(e.error):r.next(e)}catch{}}function Jh(t){return t.expireTimeMillis-Date.now()>0}function cV(t){return{token:oV(iV),error:t}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lV{constructor(e,n){this.app=e,this.heartbeatServiceProvider=n}_delete(){const{tokenObservers:e}=Pt(this.app);for(const n of e)ey(this.app,n.next);return Promise.resolve()}}function uV(t,e){return new lV(t,e)}function hV(t){return{getToken:e=>Yh(t,e),addTokenListener:e=>Z_(t,"INTERNAL",e),removeTokenListener:e=>ey(t.app,e)}}const dV="@firebase/app-check",fV="0.5.11";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pV="https://www.google.com/recaptcha/api.js",gV="https://www.google.com/recaptcha/enterprise.js";function mV(t,e){const n=Pt(t),r=new mt;ur(t,Object.assign(Object.assign({},n),{reCAPTCHAState:{initialized:r}}));const s=NC(t),i=Qh(!1);return i?Xh(t,e,i,s,r):vV(()=>{const o=Qh(!1);if(!o)throw new Error("no recaptcha");Xh(t,e,o,s,r)}),r.promise}function _V(t,e){const n=Pt(t),r=new mt;ur(t,Object.assign(Object.assign({},n),{reCAPTCHAState:{initialized:r}}));const s=NC(t),i=Qh(!0);return i?Xh(t,e,i,s,r):wV(()=>{const o=Qh(!0);if(!o)throw new Error("no recaptcha");Xh(t,e,o,s,r)}),r.promise}function Xh(t,e,n,r,s){n.ready(()=>{yV(t,e,n,r),s.resolve(n)})}function NC(t){const e=`fire_app_check_${t.name}`,n=document.createElement("div");return n.id=e,n.style.display="none",document.body.appendChild(n),e}async function PC(t){bC(t);const n=await Pt(t).reCAPTCHAState.initialized.promise;return new Promise((r,s)=>{const i=Pt(t).reCAPTCHAState;n.ready(()=>{r(n.execute(i.widgetId,{action:"fire_app_check"}))})})}function yV(t,e,n,r){const s=n.render(r,{sitekey:e,size:"invisible"}),i=Pt(t);ur(t,Object.assign(Object.assign({},i),{reCAPTCHAState:Object.assign(Object.assign({},i.reCAPTCHAState),{widgetId:s})}))}function vV(t){const e=document.createElement("script");e.src=pV,e.onload=t,document.head.appendChild(e)}function wV(t){const e=document.createElement("script");e.src=gV,e.onload=t,document.head.appendChild(e)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sl{constructor(e){this._siteKey=e,this._throttleData=null}async getToken(){var e;xC(this._throttleData);const n=await PC(this._app).catch(s=>{throw ln.create("recaptcha-error")});let r;try{r=await X_(G$(this._app,n),this._heartbeatServiceProvider)}catch(s){throw s.code==="fetch-status-error"?(this._throttleData=DC(Number((e=s.customData)===null||e===void 0?void 0:e.httpStatus),this._throttleData),ln.create("throttled",{time:J_(this._throttleData.allowRequestsAfter-Date.now()),httpStatus:this._throttleData.httpStatus})):s}return this._throttleData=null,r}initialize(e){this._app=e,this._heartbeatServiceProvider=So(e,"heartbeat"),mV(e,this._siteKey).catch(()=>{})}isEqual(e){return e instanceof Sl?this._siteKey===e._siteKey:!1}}class df{constructor(e){this._siteKey=e,this._throttleData=null}async getToken(){var e;xC(this._throttleData);const n=await PC(this._app).catch(s=>{throw ln.create("recaptcha-error")});let r;try{r=await X_(z$(this._app,n),this._heartbeatServiceProvider)}catch(s){throw s.code==="fetch-status-error"?(this._throttleData=DC(Number((e=s.customData)===null||e===void 0?void 0:e.httpStatus),this._throttleData),ln.create("throttled",{time:J_(this._throttleData.allowRequestsAfter-Date.now()),httpStatus:this._throttleData.httpStatus})):s}return this._throttleData=null,r}initialize(e){this._app=e,this._heartbeatServiceProvider=So(e,"heartbeat"),_V(e,this._siteKey).catch(()=>{})}isEqual(e){return e instanceof df?this._siteKey===e._siteKey:!1}}class Cl{constructor(e){this._customProviderOptions=e}async getToken(){const e=await this._customProviderOptions.getToken(),n=VL(e.token),r=n!==null&&n<Date.now()&&n>0?n*1e3:Date.now();return Object.assign(Object.assign({},e),{issuedAtTimeMillis:r})}initialize(e){this._app=e}isEqual(e){return e instanceof Cl?this._customProviderOptions.getToken.toString()===e._customProviderOptions.getToken.toString():!1}}function DC(t,e){if(t===404||t===403)return{backoffCount:1,allowRequestsAfter:Date.now()+j$,httpStatus:t};{const n=e?e.backoffCount:0,r=Wh(n,1e3,2);return{backoffCount:n+1,allowRequestsAfter:Date.now()+r,httpStatus:t}}}function xC(t){if(t&&Date.now()-t.allowRequestsAfter<=0)throw ln.create("throttled",{time:J_(t.allowRequestsAfter-Date.now()),httpStatus:t.httpStatus})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bV(t=q0(),e){t=N(t);const n=So(t,"app-check");if(hf().initialized||sV(),AC()&&kC().then(s=>console.log(`App Check debug token: ${s}. You will need to add it to your app's App Check settings in the Firebase console for it to work.`)),n.isInitialized()){const s=n.getImmediate(),i=n.getOptions();if(i.isTokenAutoRefreshEnabled===e.isTokenAutoRefreshEnabled&&i.provider.isEqual(e.provider))return s;throw ln.create("already-initialized",{appName:t.name})}const r=n.initialize({options:e});return IV(t,e.provider,e.isTokenAutoRefreshEnabled),Pt(t).isTokenAutoRefreshEnabled&&Z_(r,"INTERNAL",()=>{}),r}function IV(t,e,n){const r=Pt(t),s=Object.assign(Object.assign({},r),{activated:!0});s.provider=e,s.cachedTokenPromise=nV(t).then(i=>(i&&Jh(i)&&(ur(t,Object.assign(Object.assign({},Pt(t)),{token:i})),RC(t,{token:i.token})),i)),s.isTokenAutoRefreshEnabled=n===void 0?t.automaticDataCollectionEnabled:n,ur(t,s),s.provider.initialize(t)}function EV(t,e){const n=t.app,r=Pt(n);r.tokenRefresher&&(e===!0?r.tokenRefresher.start():r.tokenRefresher.stop()),ur(n,Object.assign(Object.assign({},r),{isTokenAutoRefreshEnabled:e}))}async function TV(t,e){const n=await Yh(t,e);if(n.error)throw n.error;return{token:n.token}}function SV(t,e,n,r){let s=()=>{},i=()=>{};return e.next!=null?s=e.next.bind(e):s=e,e.error!=null?i=e.error.bind(e):n&&(i=n),Z_(t,"EXTERNAL",s,i),()=>ey(t.app,s)}const CV="app-check",lI="app-check-internal";function AV(){st(new Ee(CV,t=>{const e=t.getProvider("app").getImmediate(),n=t.getProvider("heartbeat");return uV(e,n)},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((t,e,n)=>{t.getProvider(lI).initialize()})),st(new Ee(lI,t=>{const e=t.getProvider("app-check").getImmediate();return hV(e)},"PUBLIC").setInstantiationMode("EXPLICIT")),Fe(dV,fV)}AV();const kV="@firebase/app-check-compat",RV="0.2.11";/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NV={["use-before-activation"]:"App Check is being used before activate() is called for FirebaseApp {$appName}. Call activate() before instantiating other Firebase services."},Kp=new pn("appCheck","AppCheck",NV);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PV{constructor(e){this.app=e}activate(e,n){let r;typeof e=="string"?r=new Sl(e):e instanceof df||e instanceof Sl||e instanceof Cl?r=e:r=new Cl({getToken:e.getToken}),this._delegate=bV(this.app,{provider:r,isTokenAutoRefreshEnabled:n})}setTokenAutoRefreshEnabled(e){if(!this._delegate)throw Kp.create("use-before-activation",{appName:this.app.name});EV(this._delegate,e)}getToken(e){if(!this._delegate)throw Kp.create("use-before-activation",{appName:this.app.name});return TV(this._delegate,e)}onTokenChanged(e,n,r){if(!this._delegate)throw Kp.create("use-before-activation",{appName:this.app.name});return SV(this._delegate,e,n)}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DV=t=>{const e=t.getProvider("app-compat").getImmediate();return new PV(e)};function xV(){ht.INTERNAL.registerComponent(new Ee("appCheck-compat",DV,"PUBLIC").setServiceProps({ReCaptchaEnterpriseProvider:df,ReCaptchaV3Provider:Sl,CustomProvider:Cl}))}xV();ht.registerVersion(kV,RV);function ty(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(t);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(t,r[s])&&(n[r[s]]=t[r[s]]);return n}const gc={FACEBOOK:"facebook.com",GITHUB:"github.com",GOOGLE:"google.com",PASSWORD:"password",PHONE:"phone",TWITTER:"twitter.com"},$o={EMAIL_SIGNIN:"EMAIL_SIGNIN",PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:"REVERT_SECOND_FACTOR_ADDITION",VERIFY_AND_CHANGE_EMAIL:"VERIFY_AND_CHANGE_EMAIL",VERIFY_EMAIL:"VERIFY_EMAIL"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function OV(){return{["admin-restricted-operation"]:"This operation is restricted to administrators only.",["argument-error"]:"",["app-not-authorized"]:"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.",["app-not-installed"]:"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.",["captcha-check-failed"]:"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.",["code-expired"]:"The SMS code has expired. Please re-send the verification code to try again.",["cordova-not-ready"]:"Cordova framework is not ready.",["cors-unsupported"]:"This browser is not supported.",["credential-already-in-use"]:"This credential is already associated with a different user account.",["custom-token-mismatch"]:"The custom token corresponds to a different audience.",["requires-recent-login"]:"This operation is sensitive and requires recent authentication. Log in again before retrying this request.",["dependent-sdk-initialized-before-auth"]:"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK.",["dynamic-link-not-activated"]:"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.",["email-change-needs-verification"]:"Multi-factor users must always have a verified email.",["email-already-in-use"]:"The email address is already in use by another account.",["emulator-config-failed"]:'Auth instance has already been used to make a network call. Auth can no longer be configured to use the emulator. Try calling "connectAuthEmulator()" sooner.',["expired-action-code"]:"The action code has expired.",["cancelled-popup-request"]:"This operation has been cancelled due to another conflicting popup being opened.",["internal-error"]:"An internal AuthError has occurred.",["invalid-app-credential"]:"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.",["invalid-app-id"]:"The mobile app identifier is not registed for the current project.",["invalid-user-token"]:"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.",["invalid-auth-event"]:"An internal AuthError has occurred.",["invalid-verification-code"]:"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure to use the verification code provided by the user.",["invalid-continue-uri"]:"The continue URL provided in the request is invalid.",["invalid-cordova-configuration"]:"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.",["invalid-custom-token"]:"The custom token format is incorrect. Please check the documentation.",["invalid-dynamic-link-domain"]:"The provided dynamic link domain is not configured or authorized for the current project.",["invalid-email"]:"The email address is badly formatted.",["invalid-emulator-scheme"]:"Emulator URL must start with a valid scheme (http:// or https://).",["invalid-api-key"]:"Your API key is invalid, please check you have copied it correctly.",["invalid-cert-hash"]:"The SHA-1 certificate hash provided is invalid.",["invalid-credential"]:"The supplied auth credential is malformed or has expired.",["invalid-message-payload"]:"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.",["invalid-multi-factor-session"]:"The request does not contain a valid proof of first factor successful sign-in.",["invalid-oauth-provider"]:"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.",["invalid-oauth-client-id"]:"The OAuth client ID provided is either invalid or does not match the specified API key.",["unauthorized-domain"]:"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.",["invalid-action-code"]:"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.",["wrong-password"]:"The password is invalid or the user does not have a password.",["invalid-persistence-type"]:"The specified persistence type is invalid. It can only be local, session or none.",["invalid-phone-number"]:"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].",["invalid-provider-id"]:"The specified provider ID is invalid.",["invalid-recipient-email"]:"The email corresponding to this action failed to send as the provided recipient email address is invalid.",["invalid-sender"]:"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.",["invalid-verification-id"]:"The verification ID used to create the phone auth credential is invalid.",["invalid-tenant-id"]:"The Auth instance's tenant ID is invalid.",["login-blocked"]:"Login blocked by user-provided method: {$originalMessage}",["missing-android-pkg-name"]:"An Android Package Name must be provided if the Android App is required to be installed.",["auth-domain-config-required"]:"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.",["missing-app-credential"]:"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.",["missing-verification-code"]:"The phone auth credential was created with an empty SMS verification code.",["missing-continue-uri"]:"A continue URL must be provided in the request.",["missing-iframe-start"]:"An internal AuthError has occurred.",["missing-ios-bundle-id"]:"An iOS Bundle ID must be provided if an App Store ID is provided.",["missing-or-invalid-nonce"]:"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.",["missing-multi-factor-info"]:"No second factor identifier is provided.",["missing-multi-factor-session"]:"The request is missing proof of first factor successful sign-in.",["missing-phone-number"]:"To send verification codes, provide a phone number for the recipient.",["missing-verification-id"]:"The phone auth credential was created with an empty verification ID.",["app-deleted"]:"This instance of FirebaseApp has been deleted.",["multi-factor-info-not-found"]:"The user does not have a second factor matching the identifier provided.",["multi-factor-auth-required"]:"Proof of ownership of a second factor is required to complete sign-in.",["account-exists-with-different-credential"]:"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.",["network-request-failed"]:"A network AuthError (such as timeout, interrupted connection or unreachable host) has occurred.",["no-auth-event"]:"An internal AuthError has occurred.",["no-such-provider"]:"User was not linked to an account with the given provider.",["null-user"]:"A null user object was provided as the argument for an operation which requires a non-null user object.",["operation-not-allowed"]:"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.",["operation-not-supported-in-this-environment"]:'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',["popup-blocked"]:"Unable to establish a connection with the popup. It may have been blocked by the browser.",["popup-closed-by-user"]:"The popup has been closed by the user before finalizing the operation.",["provider-already-linked"]:"User can only be linked to one identity for the given provider.",["quota-exceeded"]:"The project's quota for this operation has been exceeded.",["redirect-cancelled-by-user"]:"The redirect operation has been cancelled by the user before finalizing.",["redirect-operation-pending"]:"A redirect sign-in operation is already pending.",["rejected-credential"]:"The request contains malformed or mismatching credentials.",["second-factor-already-in-use"]:"The second factor is already enrolled on this account.",["maximum-second-factor-count-exceeded"]:"The maximum allowed number of second factors on a user has been exceeded.",["tenant-id-mismatch"]:"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.",["user-token-expired"]:"The user's credential is no longer valid. The user must sign in again.",["too-many-requests"]:"We have blocked all requests from this device due to unusual activity. Try again later.",["unauthorized-continue-uri"]:"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.",["unsupported-first-factor"]:"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.",["unsupported-persistence-type"]:"The current environment does not support the specified persistence type.",["unsupported-tenant-operation"]:"This operation is not supported in a multi-tenant context.",["unverified-email"]:"The operation requires a verified email.",["user-cancelled"]:"The user did not grant your application the permissions it requested.",["user-not-found"]:"There is no user record corresponding to this identifier. The user may have been deleted.",["user-disabled"]:"The user account has been disabled by an administrator.",["user-mismatch"]:"The supplied credentials do not correspond to the previously signed in user.",["user-signed-out"]:"",["weak-password"]:"The password must be 6 characters long or more.",["web-storage-unsupported"]:"This browser is not supported or 3rd party cookies and data may be disabled.",["already-initialized"]:"initializeAuth() has already been called with different options. To avoid this error, call initializeAuth() with the same options as when it was originally called, or call getAuth() to return the already initialized instance."}}function OC(){return{["dependent-sdk-initialized-before-auth"]:"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const MV=OV,LV=OC,MC=new pn("auth","Firebase",OC());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uI=new Vr("@firebase/auth");function Sh(t,...e){uI.logLevel<=fe.ERROR&&uI.error(`Auth (${Br}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zt(t,...e){throw ny(t,...e)}function Kt(t,...e){return ny(t,...e)}function LC(t,e,n){const r=Object.assign(Object.assign({},LV()),{[e]:n});return new pn("auth","Firebase",r).create(e,{appName:t.name})}function Ga(t,e,n){const r=n;if(!(e instanceof r))throw r.name!==e.constructor.name&&zt(t,"argument-error"),LC(t,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function ny(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return MC.create(t,...e)}function x(t,e,...n){if(!t)throw ny(e,...n)}function Er(t){const e="INTERNAL ASSERTION FAILED: "+t;throw Sh(e),new Error(e)}function hr(t,e){t||Er(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hI=new Map;function Rn(t){hr(t instanceof Function,"Expected a class definition");let e=hI.get(t);return e?(hr(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,hI.set(t,e),e)}function FV(t,e){const n=(e==null?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map(Rn);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Al(){var t;return typeof self!="undefined"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function ry(){return dI()==="http:"||dI()==="https:"}function dI(){var t;return typeof self!="undefined"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function UV(){return typeof navigator!="undefined"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(ry()||uu()||"connection"in navigator)?navigator.onLine:!0}function $V(){if(typeof navigator=="undefined")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pu{constructor(e,n){this.shortDelay=e,this.longDelay=n,hr(n>e,"Short delay should be less than long delay!"),this.isMobile=of()||hu()}get(){return UV()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sy(t,e){hr(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FC{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self!="undefined"&&"fetch"in self)return self.fetch;Er("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self!="undefined"&&"Headers"in self)return self.Headers;Er("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self!="undefined"&&"Response"in self)return self.Response;Er("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VV={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"internal-error",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BV=new pu(3e4,6e4);function wt(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function Mt(t,e,n,r,s={}){return UC(t,s,async()=>{let i={},o={};r&&(e==="GET"?o=r:i={body:JSON.stringify(r)});const a=To(Object.assign({key:t.config.apiKey},o)).slice(1),c=await t._getAdditionalHeaders();return c["Content-Type"]="application/json",t.languageCode&&(c["X-Firebase-Locale"]=t.languageCode),FC.fetch()($C(t,t.config.apiHost,n,a),Object.assign({method:e,headers:c,referrerPolicy:"no-referrer"},i))})}async function UC(t,e,n){t._canInitEmulator=!1;const r=Object.assign(Object.assign({},VV),e);try{const s=new qV(t),i=await Promise.race([n(),s.promise]);s.clearNetworkTimeout();const o=await i.json();if("needConfirmation"in o)throw Oc(t,"account-exists-with-different-credential",o);if(i.ok&&!("errorMessage"in o))return o;{const a=i.ok?o.errorMessage:o.error.message,[c,l]=a.split(" : ");if(c==="FEDERATED_USER_ID_ALREADY_LINKED")throw Oc(t,"credential-already-in-use",o);if(c==="EMAIL_EXISTS")throw Oc(t,"email-already-in-use",o);if(c==="USER_DISABLED")throw Oc(t,"user-disabled",o);const u=r[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(l)throw LC(t,u,l);zt(t,u)}}catch(s){if(s instanceof ut)throw s;zt(t,"network-request-failed")}}async function fs(t,e,n,r,s={}){const i=await Mt(t,e,n,r,s);return"mfaPendingCredential"in i&&zt(t,"multi-factor-auth-required",{_serverResponse:i}),i}function $C(t,e,n,r){const s=`${e}${n}?${r}`;return t.config.emulator?sy(t.config,s):`${t.config.apiScheme}://${s}`}class qV{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(Kt(this.auth,"network-request-failed")),BV.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function Oc(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const s=Kt(t,e,r);return s.customData._tokenResponse=n,s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function jV(t,e){return Mt(t,"POST","/v1/accounts:delete",e)}async function KV(t,e){return Mt(t,"POST","/v1/accounts:update",e)}async function HV(t,e){return Mt(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wc(t){if(!!t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function WV(t,e=!1){const n=N(t),r=await n.getIdToken(e),s=ff(r);x(s&&s.exp&&s.auth_time&&s.iat,n.auth,"internal-error");const i=typeof s.firebase=="object"?s.firebase:void 0,o=i==null?void 0:i.sign_in_provider;return{claims:s,token:r,authTime:Wc(Hp(s.auth_time)),issuedAtTime:Wc(Hp(s.iat)),expirationTime:Wc(Hp(s.exp)),signInProvider:o||null,signInSecondFactor:(i==null?void 0:i.sign_in_second_factor)||null}}function Hp(t){return Number(t)*1e3}function ff(t){var e;const[n,r,s]=t.split(".");if(n===void 0||r===void 0||s===void 0)return Sh("JWT malformed, contained fewer than 3 sections"),null;try{const i=Jg(r);return i?JSON.parse(i):(Sh("Failed to decode base64 JWT payload"),null)}catch(i){return Sh("Caught error parsing JWT payload as JSON",(e=i)===null||e===void 0?void 0:e.toString()),null}}function GV(t){const e=ff(t);return x(e,"internal-error"),x(typeof e.exp!="undefined","internal-error"),x(typeof e.iat!="undefined","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function as(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof ut&&zV(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function zV({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QV{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){!this.isRunning||(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var n;if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const s=((n=this.user.stsTokenManager.expirationTime)!==null&&n!==void 0?n:0)-Date.now()-3e5;return Math.max(0,s)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){var e;try{await this.user.getIdToken(!0)}catch(n){((e=n)===null||e===void 0?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VC{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=Wc(this.lastLoginAt),this.creationTime=Wc(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function kl(t){var e;const n=t.auth,r=await t.getIdToken(),s=await as(t,HV(n,{idToken:r}));x(s==null?void 0:s.users.length,n,"internal-error");const i=s.users[0];t._notifyReloadListener(i);const o=!((e=i.providerUserInfo)===null||e===void 0)&&e.length?XV(i.providerUserInfo):[],a=JV(t.providerData,o),c=t.isAnonymous,l=!(t.email&&i.passwordHash)&&!(a!=null&&a.length),u=c?l:!1,h={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:a,metadata:new VC(i.createdAt,i.lastLoginAt),isAnonymous:u};Object.assign(t,h)}async function YV(t){const e=N(t);await kl(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function JV(t,e){return[...t.filter(r=>!e.some(s=>s.providerId===r.providerId)),...e]}function XV(t){return t.map(e=>{var{providerId:n}=e,r=ty(e,["providerId"]);return{providerId:n,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ZV(t,e){const n=await UC(t,{},async()=>{const r=To({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:i}=t.config,o=$C(t,s,"/v1/token",`key=${i}`),a=await t._getAdditionalHeaders();return a["Content-Type"]="application/x-www-form-urlencoded",FC.fetch()(o,{method:"POST",headers:a,body:r})});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rl{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){x(e.idToken,"internal-error"),x(typeof e.idToken!="undefined","internal-error"),x(typeof e.refreshToken!="undefined","internal-error");const n="expiresIn"in e&&typeof e.expiresIn!="undefined"?Number(e.expiresIn):GV(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}async getToken(e,n=!1){return x(!this.accessToken||this.refreshToken,e,"user-token-expired"),!n&&this.accessToken&&!this.isExpired?this.accessToken:this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:s,expiresIn:i}=await ZV(e,n);this.updateTokensAndExpiration(r,s,Number(i))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:s,expirationTime:i}=n,o=new Rl;return r&&(x(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),s&&(x(typeof s=="string","internal-error",{appName:e}),o.accessToken=s),i&&(x(typeof i=="number","internal-error",{appName:e}),o.expirationTime=i),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Rl,this.toJSON())}_performRefresh(){return Er("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ts(t,e){x(typeof t=="string"||typeof t=="undefined","internal-error",{appName:e})}class Hi{constructor(e){var{uid:n,auth:r,stsTokenManager:s}=e,i=ty(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new QV(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=n,this.auth=r,this.stsTokenManager=s,this.accessToken=s.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new VC(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const n=await as(this,this.stsTokenManager.getToken(this.auth,e));return x(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return WV(this,e)}reload(){return YV(this)}_assign(e){this!==e&&(x(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>Object.assign({},n)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){return new Hi(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}))}_onReload(e){x(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await kl(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){const e=await this.getIdToken();return await as(this,jV(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){var r,s,i,o,a,c,l,u;const h=(r=n.displayName)!==null&&r!==void 0?r:void 0,d=(s=n.email)!==null&&s!==void 0?s:void 0,f=(i=n.phoneNumber)!==null&&i!==void 0?i:void 0,p=(o=n.photoURL)!==null&&o!==void 0?o:void 0,_=(a=n.tenantId)!==null&&a!==void 0?a:void 0,y=(c=n._redirectEventId)!==null&&c!==void 0?c:void 0,T=(l=n.createdAt)!==null&&l!==void 0?l:void 0,I=(u=n.lastLoginAt)!==null&&u!==void 0?u:void 0,{uid:E,emailVerified:S,isAnonymous:$,providerData:H,stsTokenManager:K}=n;x(E&&K,e,"internal-error");const F=Rl.fromJSON(this.name,K);x(typeof E=="string",e,"internal-error"),Ts(h,e.name),Ts(d,e.name),x(typeof S=="boolean",e,"internal-error"),x(typeof $=="boolean",e,"internal-error"),Ts(f,e.name),Ts(p,e.name),Ts(_,e.name),Ts(y,e.name),Ts(T,e.name),Ts(I,e.name);const ne=new Hi({uid:E,auth:e,email:d,emailVerified:S,displayName:h,isAnonymous:$,photoURL:p,phoneNumber:f,tenantId:_,stsTokenManager:F,createdAt:T,lastLoginAt:I});return H&&Array.isArray(H)&&(ne.providerData=H.map(he=>Object.assign({},he))),y&&(ne._redirectEventId=y),ne}static async _fromIdTokenResponse(e,n,r=!1){const s=new Rl;s.updateFromServerResponse(n);const i=new Hi({uid:n.localId,auth:e,stsTokenManager:s,isAnonymous:r});return await kl(i),i}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BC{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}BC.type="NONE";const Ia=BC;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wi(t,e,n){return`firebase:${t}:${e}:${n}`}class sa{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:s,name:i}=this.auth;this.fullUserKey=Wi(this.userKey,s.apiKey,i),this.fullPersistenceKey=Wi("persistence",s.apiKey,i),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?Hi._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new sa(Rn(Ia),e,r);const s=(await Promise.all(n.map(async l=>{if(await l._isAvailable())return l}))).filter(l=>l);let i=s[0]||Rn(Ia);const o=Wi(r,e.config.apiKey,e.name);let a=null;for(const l of n)try{const u=await l._get(o);if(u){const h=Hi._fromJSON(e,u);l!==i&&(a=h),i=l;break}}catch{}const c=s.filter(l=>l._shouldAllowMigration);return!i._shouldAllowMigration||!c.length?new sa(i,e,r):(i=c[0],a&&await i._set(o,a.toJSON()),await Promise.all(n.map(async l=>{if(l!==i)try{await l._remove(o)}catch{}})),new sa(i,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fI(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(KC(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(qC(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(HC(e))return"Blackberry";if(WC(e))return"Webos";if(iy(e))return"Safari";if((e.includes("chrome/")||jC(e))&&!e.includes("edge/"))return"Chrome";if(gu(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function qC(t=We()){return/firefox\//i.test(t)}function iy(t=We()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function jC(t=We()){return/crios\//i.test(t)}function KC(t=We()){return/iemobile/i.test(t)}function gu(t=We()){return/android/i.test(t)}function HC(t=We()){return/blackberry/i.test(t)}function WC(t=We()){return/webos/i.test(t)}function za(t=We()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function eB(t=We()){return/(iPad|iPhone|iPod).*OS 7_\d/i.test(t)||/(iPad|iPhone|iPod).*OS 8_\d/i.test(t)}function tB(t=We()){var e;return za(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function nB(){return B_()&&document.documentMode===10}function GC(t=We()){return za(t)||gu(t)||WC(t)||HC(t)||/windows phone/i.test(t)||KC(t)}function rB(){try{return!!(window&&window!==window.top)}catch{return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zC(t,e=[]){let n;switch(t){case"Browser":n=fI(We());break;case"Worker":n=`${fI(We())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${Br}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sB{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=i=>new Promise((o,a)=>{try{const c=e(i);o(c)}catch(c){a(c)}});r.onAbort=n,this.queue.push(r);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){var n;if(this.auth.currentUser===e)return;const r=[];try{for(const s of this.queue)await s(e),s.onAbort&&r.push(s.onAbort)}catch(s){r.reverse();for(const i of r)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:(n=s)===null||n===void 0?void 0:n.message})}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iB{constructor(e,n,r){this.app=e,this.heartbeatServiceProvider=n,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new pI(this),this.idTokenSubscription=new pI(this),this.beforeStateQueue=new sB(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=MC,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=r.sdkClientVersion}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=Rn(n)),this._initializationPromise=this.queue(async()=>{var r,s;if(!this._deleted&&(this.persistenceManager=await sa.create(this,e),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((s=this.currentUser)===null||s===void 0?void 0:s.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUser(e){var n;const r=await this.assertedPersistence.getCurrentUser();let s=r,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId,a=s==null?void 0:s._redirectEventId,c=await this.tryRedirectSignIn(e);(!o||o===a)&&(c==null?void 0:c.user)&&(s=c.user,i=!0)}if(!s)return this.directlySetCurrentUser(null);if(!s._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(s)}catch(o){s=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return s?this.reloadAndSetCurrentUserOrClear(s):this.directlySetCurrentUser(null)}return x(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===s._redirectEventId?this.directlySetCurrentUser(s):this.reloadAndSetCurrentUserOrClear(s)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){var n;try{await kl(e)}catch(r){if(((n=r)===null||n===void 0?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=$V()}async _delete(){this._deleted=!0}async updateCurrentUser(e){const n=e?N(e):null;return n&&x(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&x(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0)}setPersistence(e){return this.queue(async()=>{await this.assertedPersistence.setPersistence(Rn(e))})}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new pn("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&Rn(e)||this._popupRedirectResolver;x(n,this,"argument-error"),this.redirectPersistenceManager=await sa.create(this,[Rn(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,r;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)===null||n===void 0?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const r=(n=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&n!==void 0?n:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,s){if(this._deleted)return()=>{};const i=typeof n=="function"?n:n.next.bind(n),o=this._isInitialized?Promise.resolve():this._initializationPromise;return x(o,this,"internal-error"),o.then(()=>i(this.currentUser)),typeof n=="function"?e.addObserver(n,r,s):e.addObserver(n)}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&(this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh()),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return x(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=zC(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const n={["X-Client-Version"]:this.clientVersion};this.app.options.appId&&(n["X-Firebase-gmpid"]=this.app.options.appId);const r=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());return r&&(n["X-Firebase-Client"]=r),n}}function Dt(t){return N(t)}class pI{constructor(e){this.auth=e,this.observer=null,this.addObserver=O0(n=>this.observer=n)}get next(){return x(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}function oB(t,e,n){const r=Dt(t);x(r._canInitEmulator,r,"emulator-config-failed"),x(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const s=!!(n!=null&&n.disableWarnings),i=QC(e),{host:o,port:a}=aB(e),c=a===null?"":`:${a}`;r.config.emulator={url:`${i}//${o}${c}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:o,port:a,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:s})}),s||cB()}function QC(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function aB(t){const e=QC(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(r);if(s){const i=s[1];return{host:i,port:gI(r.substr(i.length+1))}}else{const[i,o]=r.split(":");return{host:i,port:gI(o)}}}function gI(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function cB(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console!="undefined"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window!="undefined"&&typeof document!="undefined"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qa{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return Er("not implemented")}_getIdTokenResponse(e){return Er("not implemented")}_linkToIdToken(e,n){return Er("not implemented")}_getReauthenticationResolver(e){return Er("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function YC(t,e){return Mt(t,"POST","/v1/accounts:resetPassword",wt(t,e))}async function JC(t,e){return Mt(t,"POST","/v1/accounts:update",e)}async function lB(t,e){return Mt(t,"POST","/v1/accounts:update",wt(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function uB(t,e){return fs(t,"POST","/v1/accounts:signInWithPassword",wt(t,e))}async function pf(t,e){return Mt(t,"POST","/v1/accounts:sendOobCode",wt(t,e))}async function hB(t,e){return pf(t,e)}async function dB(t,e){return pf(t,e)}async function fB(t,e){return pf(t,e)}async function pB(t,e){return pf(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function gB(t,e){return fs(t,"POST","/v1/accounts:signInWithEmailLink",wt(t,e))}async function mB(t,e){return fs(t,"POST","/v1/accounts:signInWithEmailLink",wt(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nl extends Qa{constructor(e,n,r,s=null){super("password",r),this._email=e,this._password=n,this._tenantId=s}static _fromEmailAndPassword(e,n){return new Nl(e,n,"password")}static _fromEmailAndCode(e,n,r=null){return new Nl(e,n,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;if((n==null?void 0:n.email)&&(n==null?void 0:n.password)){if(n.signInMethod==="password")return this._fromEmailAndPassword(n.email,n.password);if(n.signInMethod==="emailLink")return this._fromEmailAndCode(n.email,n.password,n.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":return uB(e,{returnSecureToken:!0,email:this._email,password:this._password});case"emailLink":return gB(e,{email:this._email,oobCode:this._password});default:zt(e,"internal-error")}}async _linkToIdToken(e,n){switch(this.signInMethod){case"password":return JC(e,{idToken:n,returnSecureToken:!0,email:this._email,password:this._password});case"emailLink":return mB(e,{idToken:n,email:this._email,oobCode:this._password});default:zt(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ns(t,e){return fs(t,"POST","/v1/accounts:signInWithIdp",wt(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _B="http://localhost";class xr extends Qa{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new xr(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):zt("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:s}=n,i=ty(n,["providerId","signInMethod"]);if(!r||!s)return null;const o=new xr(r,s);return o.idToken=i.idToken||void 0,o.accessToken=i.accessToken||void 0,o.secret=i.secret,o.nonce=i.nonce,o.pendingToken=i.pendingToken||null,o}_getIdTokenResponse(e){const n=this.buildRequest();return ns(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,ns(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,ns(e,n)}buildRequest(){const e={requestUri:_B,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=To(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function yB(t,e){return Mt(t,"POST","/v1/accounts:sendVerificationCode",wt(t,e))}async function vB(t,e){return fs(t,"POST","/v1/accounts:signInWithPhoneNumber",wt(t,e))}async function wB(t,e){const n=await fs(t,"POST","/v1/accounts:signInWithPhoneNumber",wt(t,e));if(n.temporaryProof)throw Oc(t,"account-exists-with-different-credential",n);return n}const bB={USER_NOT_FOUND:"user-not-found"};async function IB(t,e){const n=Object.assign(Object.assign({},e),{operation:"REAUTH"});return fs(t,"POST","/v1/accounts:signInWithPhoneNumber",wt(t,n),bB)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gi extends Qa{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,n){return new Gi({verificationId:e,verificationCode:n})}static _fromTokenResponse(e,n){return new Gi({phoneNumber:e,temporaryProof:n})}_getIdTokenResponse(e){return vB(e,this._makeVerificationRequest())}_linkToIdToken(e,n){return wB(e,Object.assign({idToken:n},this._makeVerificationRequest()))}_getReauthenticationResolver(e){return IB(e,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:e,phoneNumber:n,verificationId:r,verificationCode:s}=this.params;return e&&n?{temporaryProof:e,phoneNumber:n}:{sessionInfo:r,code:s}}toJSON(){const e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){typeof e=="string"&&(e=JSON.parse(e));const{verificationId:n,verificationCode:r,phoneNumber:s,temporaryProof:i}=e;return!r&&!n&&!s&&!i?null:new Gi({verificationId:n,verificationCode:r,phoneNumber:s,temporaryProof:i})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function EB(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function TB(t){const e=Yo(xc(t)).link,n=e?Yo(xc(e)).deep_link_id:null,r=Yo(xc(t)).deep_link_id;return(r?Yo(xc(r)).link:null)||r||n||e||t}class gf{constructor(e){var n,r,s,i,o,a;const c=Yo(xc(e)),l=(n=c.apiKey)!==null&&n!==void 0?n:null,u=(r=c.oobCode)!==null&&r!==void 0?r:null,h=EB((s=c.mode)!==null&&s!==void 0?s:null);x(l&&u&&h,"argument-error"),this.apiKey=l,this.operation=h,this.code=u,this.continueUrl=(i=c.continueUrl)!==null&&i!==void 0?i:null,this.languageCode=(o=c.languageCode)!==null&&o!==void 0?o:null,this.tenantId=(a=c.tenantId)!==null&&a!==void 0?a:null}static parseLink(e){const n=TB(e);try{return new gf(n)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ci{constructor(){this.providerId=ci.PROVIDER_ID}static credential(e,n){return Nl._fromEmailAndPassword(e,n)}static credentialWithLink(e,n){const r=gf.parseLink(n);return x(r,"argument-error"),Nl._fromEmailAndCode(e,r.code,r.tenantId)}}ci.PROVIDER_ID="password";ci.EMAIL_PASSWORD_SIGN_IN_METHOD="password";ci.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ps{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ya extends ps{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class ia extends Ya{static credentialFromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;return x("providerId"in n&&"signInMethod"in n,"argument-error"),xr._fromParams(n)}credential(e){return this._credential(Object.assign(Object.assign({},e),{nonce:e.rawNonce}))}_credential(e){return x(e.idToken||e.accessToken,"argument-error"),xr._fromParams(Object.assign(Object.assign({},e),{providerId:this.providerId,signInMethod:this.providerId}))}static credentialFromResult(e){return ia.oauthCredentialFromTaggedObject(e)}static credentialFromError(e){return ia.oauthCredentialFromTaggedObject(e.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r,oauthTokenSecret:s,pendingToken:i,nonce:o,providerId:a}=e;if(!r&&!s&&!n&&!i||!a)return null;try{return new ia(a)._credential({idToken:n,accessToken:r,nonce:o,pendingToken:i})}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _r extends Ya{constructor(){super("facebook.com")}static credential(e){return xr._fromParams({providerId:_r.PROVIDER_ID,signInMethod:_r.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return _r.credentialFromTaggedObject(e)}static credentialFromError(e){return _r.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return _r.credential(e.oauthAccessToken)}catch{return null}}}_r.FACEBOOK_SIGN_IN_METHOD="facebook.com";_r.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yr extends Ya{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return xr._fromParams({providerId:yr.PROVIDER_ID,signInMethod:yr.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return yr.credentialFromTaggedObject(e)}static credentialFromError(e){return yr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return yr.credential(n,r)}catch{return null}}}yr.GOOGLE_SIGN_IN_METHOD="google.com";yr.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vr extends Ya{constructor(){super("github.com")}static credential(e){return xr._fromParams({providerId:vr.PROVIDER_ID,signInMethod:vr.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return vr.credentialFromTaggedObject(e)}static credentialFromError(e){return vr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return vr.credential(e.oauthAccessToken)}catch{return null}}}vr.GITHUB_SIGN_IN_METHOD="github.com";vr.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SB="http://localhost";class Ea extends Qa{constructor(e,n){super(e,e),this.pendingToken=n}_getIdTokenResponse(e){const n=this.buildRequest();return ns(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,ns(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,ns(e,n)}toJSON(){return{signInMethod:this.signInMethod,providerId:this.providerId,pendingToken:this.pendingToken}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:s,pendingToken:i}=n;return!r||!s||!i||r!==s?null:new Ea(r,i)}static _create(e,n){return new Ea(e,n)}buildRequest(){return{requestUri:SB,returnSecureToken:!0,pendingToken:this.pendingToken}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CB="saml.";class Zh extends ps{constructor(e){x(e.startsWith(CB),"argument-error"),super(e)}static credentialFromResult(e){return Zh.samlCredentialFromTaggedObject(e)}static credentialFromError(e){return Zh.samlCredentialFromTaggedObject(e.customData||{})}static credentialFromJSON(e){const n=Ea.fromJSON(e);return x(n,"argument-error"),n}static samlCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{pendingToken:n,providerId:r}=e;if(!n||!r)return null;try{return Ea._create(r,n)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wr extends Ya{constructor(){super("twitter.com")}static credential(e,n){return xr._fromParams({providerId:wr.PROVIDER_ID,signInMethod:wr.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return wr.credentialFromTaggedObject(e)}static credentialFromError(e){return wr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return wr.credential(n,r)}catch{return null}}}wr.TWITTER_SIGN_IN_METHOD="twitter.com";wr.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function XC(t,e){return fs(t,"POST","/v1/accounts:signUp",wt(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gn{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,s=!1){const i=await Hi._fromIdTokenResponse(e,r,s),o=mI(r);return new Gn({user:i,providerId:o,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const s=mI(r);return new Gn({user:e,providerId:s,_tokenResponse:r,operationType:n})}}function mI(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function AB(t){var e;const n=Dt(t);if(await n._initializationPromise,!((e=n.currentUser)===null||e===void 0)&&e.isAnonymous)return new Gn({user:n.currentUser,providerId:null,operationType:"signIn"});const r=await XC(n,{returnSecureToken:!0}),s=await Gn._fromIdTokenResponse(n,"signIn",r,!0);return await n._updateCurrentUser(s.user),s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ed extends ut{constructor(e,n,r,s){var i;super(n.code,n.message),this.operationType=r,this.user=s,Object.setPrototypeOf(this,ed.prototype),this.customData={appName:e.name,tenantId:(i=e.tenantId)!==null&&i!==void 0?i:void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,s){return new ed(e,n,r,s)}}function ZC(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?ed._fromErrorAndOperation(t,i,e,r):i})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eA(t){return new Set(t.map(({providerId:e})=>e).filter(e=>!!e))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function kB(t,e){const n=N(t);await mf(!0,n,e);const{providerUserInfo:r}=await KV(n.auth,{idToken:await n.getIdToken(),deleteProvider:[e]}),s=eA(r||[]);return n.providerData=n.providerData.filter(i=>s.has(i.providerId)),s.has("phone")||(n.phoneNumber=null),await n.auth._persistUserIfCurrent(n),n}async function oy(t,e,n=!1){const r=await as(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return Gn._forOperation(t,"link",r)}async function mf(t,e,n){await kl(e);const r=eA(e.providerData),s=t===!1?"provider-already-linked":"no-such-provider";x(r.has(n)===t,e.auth,s)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function tA(t,e,n=!1){var r;const{auth:s}=t,i="reauthenticate";try{const o=await as(t,ZC(s,i,e,t),n);x(o.idToken,s,"internal-error");const a=ff(o.idToken);x(a,s,"internal-error");const{sub:c}=a;return x(t.uid===c,s,"user-mismatch"),Gn._forOperation(t,i,o)}catch(o){throw((r=o)===null||r===void 0?void 0:r.code)==="auth/user-not-found"&&zt(s,"user-mismatch"),o}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function nA(t,e,n=!1){const r="signIn",s=await ZC(t,r,e),i=await Gn._fromIdTokenResponse(t,r,s);return n||await t._updateCurrentUser(i.user),i}async function _f(t,e){return nA(Dt(t),e)}async function rA(t,e){const n=N(t);return await mf(!1,n,e.providerId),oy(n,e)}async function sA(t,e){return tA(N(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function RB(t,e){return fs(t,"POST","/v1/accounts:signInWithCustomToken",wt(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function NB(t,e){const n=Dt(t),r=await RB(n,{token:e,returnSecureToken:!0}),s=await Gn._fromIdTokenResponse(n,"signIn",r);return await n._updateCurrentUser(s.user),s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yf{constructor(e,n){this.factorId=e,this.uid=n.mfaEnrollmentId,this.enrollmentTime=new Date(n.enrolledAt).toUTCString(),this.displayName=n.displayName}static _fromServerResponse(e,n){return"phoneInfo"in n?ay._fromServerResponse(e,n):zt(e,"internal-error")}}class ay extends yf{constructor(e){super("phone",e),this.phoneNumber=e.phoneInfo}static _fromServerResponse(e,n){return new ay(n)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vf(t,e,n){var r;x(((r=n.url)===null||r===void 0?void 0:r.length)>0,t,"invalid-continue-uri"),x(typeof n.dynamicLinkDomain=="undefined"||n.dynamicLinkDomain.length>0,t,"invalid-dynamic-link-domain"),e.continueUrl=n.url,e.dynamicLinkDomain=n.dynamicLinkDomain,e.canHandleCodeInApp=n.handleCodeInApp,n.iOS&&(x(n.iOS.bundleId.length>0,t,"missing-ios-bundle-id"),e.iOSBundleId=n.iOS.bundleId),n.android&&(x(n.android.packageName.length>0,t,"missing-android-pkg-name"),e.androidInstallApp=n.android.installApp,e.androidMinimumVersionCode=n.android.minimumVersion,e.androidPackageName=n.android.packageName)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function PB(t,e,n){const r=N(t),s={requestType:"PASSWORD_RESET",email:e};n&&vf(r,s,n),await dB(r,s)}async function DB(t,e,n){await YC(N(t),{oobCode:e,newPassword:n})}async function xB(t,e){await lB(N(t),{oobCode:e})}async function iA(t,e){const n=N(t),r=await YC(n,{oobCode:e}),s=r.requestType;switch(x(s,n,"internal-error"),s){case"EMAIL_SIGNIN":break;case"VERIFY_AND_CHANGE_EMAIL":x(r.newEmail,n,"internal-error");break;case"REVERT_SECOND_FACTOR_ADDITION":x(r.mfaInfo,n,"internal-error");default:x(r.email,n,"internal-error")}let i=null;return r.mfaInfo&&(i=yf._fromServerResponse(Dt(n),r.mfaInfo)),{data:{email:(r.requestType==="VERIFY_AND_CHANGE_EMAIL"?r.newEmail:r.email)||null,previousEmail:(r.requestType==="VERIFY_AND_CHANGE_EMAIL"?r.email:r.newEmail)||null,multiFactorInfo:i},operation:s}}async function OB(t,e){const{data:n}=await iA(N(t),e);return n.email}async function MB(t,e,n){const r=Dt(t),s=await XC(r,{returnSecureToken:!0,email:e,password:n}),i=await Gn._fromIdTokenResponse(r,"signIn",s);return await r._updateCurrentUser(i.user),i}function LB(t,e,n){return _f(N(t),ci.credential(e,n))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function FB(t,e,n){const r=N(t),s={requestType:"EMAIL_SIGNIN",email:e};x(n.handleCodeInApp,r,"argument-error"),n&&vf(r,s,n),await fB(r,s)}function UB(t,e){const n=gf.parseLink(e);return(n==null?void 0:n.operation)==="EMAIL_SIGNIN"}async function $B(t,e,n){const r=N(t),s=ci.credentialWithLink(e,n||Al());return x(s._tenantId===(r.tenantId||null),r,"tenant-id-mismatch"),_f(r,s)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function VB(t,e){return Mt(t,"POST","/v1/accounts:createAuthUri",wt(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function BB(t,e){const n=ry()?Al():"http://localhost",r={identifier:e,continueUri:n},{signinMethods:s}=await VB(N(t),r);return s||[]}async function qB(t,e){const n=N(t),r=await t.getIdToken(),s={requestType:"VERIFY_EMAIL",idToken:r};e&&vf(n.auth,s,e);const{email:i}=await hB(n.auth,s);i!==t.email&&await t.reload()}async function jB(t,e,n){const r=N(t),s=await t.getIdToken(),i={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:s,newEmail:e};n&&vf(r.auth,i,n);const{email:o}=await pB(r.auth,i);o!==t.email&&await t.reload()}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function KB(t,e){return Mt(t,"POST","/v1/accounts:update",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function HB(t,{displayName:e,photoURL:n}){if(e===void 0&&n===void 0)return;const r=N(t),i={idToken:await r.getIdToken(),displayName:e,photoUrl:n,returnSecureToken:!0},o=await as(r,KB(r.auth,i));r.displayName=o.displayName||null,r.photoURL=o.photoUrl||null;const a=r.providerData.find(({providerId:c})=>c==="password");a&&(a.displayName=r.displayName,a.photoURL=r.photoURL),await r._updateTokensIfNecessary(o)}function WB(t,e){return oA(N(t),e,null)}function GB(t,e){return oA(N(t),null,e)}async function oA(t,e,n){const{auth:r}=t,i={idToken:await t.getIdToken(),returnSecureToken:!0};e&&(i.email=e),n&&(i.password=n);const o=await as(t,JC(r,i));await t._updateTokensIfNecessary(o,!0)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zB(t){var e,n;if(!t)return null;const{providerId:r}=t,s=t.rawUserInfo?JSON.parse(t.rawUserInfo):{},i=t.isNewUser||t.kind==="identitytoolkit#SignupNewUserResponse";if(!r&&(t==null?void 0:t.idToken)){const o=(n=(e=ff(t.idToken))===null||e===void 0?void 0:e.firebase)===null||n===void 0?void 0:n.sign_in_provider;if(o){const a=o!=="anonymous"&&o!=="custom"?o:null;return new oa(i,a)}}if(!r)return null;switch(r){case"facebook.com":return new QB(i,s);case"github.com":return new YB(i,s);case"google.com":return new JB(i,s);case"twitter.com":return new XB(i,s,t.screenName||null);case"custom":case"anonymous":return new oa(i,null);default:return new oa(i,r,s)}}class oa{constructor(e,n,r={}){this.isNewUser=e,this.providerId=n,this.profile=r}}class aA extends oa{constructor(e,n,r,s){super(e,n,r),this.username=s}}class QB extends oa{constructor(e,n){super(e,"facebook.com",n)}}class YB extends aA{constructor(e,n){super(e,"github.com",n,typeof(n==null?void 0:n.login)=="string"?n==null?void 0:n.login:null)}}class JB extends oa{constructor(e,n){super(e,"google.com",n)}}class XB extends aA{constructor(e,n,r){super(e,"twitter.com",n,r)}}function ZB(t){const{user:e,_tokenResponse:n}=t;return e.isAnonymous&&!n?{providerId:null,isNewUser:!1,profile:null}:zB(n)}class Fi{constructor(e,n){this.type=e,this.credential=n}static _fromIdtoken(e){return new Fi("enroll",e)}static _fromMfaPendingCredential(e){return new Fi("signin",e)}toJSON(){return{multiFactorSession:{[this.type==="enroll"?"idToken":"pendingCredential"]:this.credential}}}static fromJSON(e){var n,r;if(e!=null&&e.multiFactorSession){if(!((n=e.multiFactorSession)===null||n===void 0)&&n.pendingCredential)return Fi._fromMfaPendingCredential(e.multiFactorSession.pendingCredential);if(!((r=e.multiFactorSession)===null||r===void 0)&&r.idToken)return Fi._fromIdtoken(e.multiFactorSession.idToken)}return null}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cy{constructor(e,n,r){this.session=e,this.hints=n,this.signInResolver=r}static _fromError(e,n){const r=Dt(e),s=n.customData._serverResponse,i=(s.mfaInfo||[]).map(a=>yf._fromServerResponse(r,a));x(s.mfaPendingCredential,r,"internal-error");const o=Fi._fromMfaPendingCredential(s.mfaPendingCredential);return new cy(o,i,async a=>{const c=await a._process(r,o);delete s.mfaInfo,delete s.mfaPendingCredential;const l=Object.assign(Object.assign({},s),{idToken:c.idToken,refreshToken:c.refreshToken});switch(n.operationType){case"signIn":const u=await Gn._fromIdTokenResponse(r,n.operationType,l);return await r._updateCurrentUser(u.user),u;case"reauthenticate":return x(n.user,r,"internal-error"),Gn._forOperation(n.user,n.operationType,l);default:zt(r,"internal-error")}})}async resolveSignIn(e){const n=e;return this.signInResolver(n)}}function eq(t,e){var n;const r=N(t),s=e;return x(e.customData.operationType,r,"argument-error"),x((n=s.customData._serverResponse)===null||n===void 0?void 0:n.mfaPendingCredential,r,"argument-error"),cy._fromError(r,s)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tq(t,e){return Mt(t,"POST","/v2/accounts/mfaEnrollment:start",wt(t,e))}function nq(t,e){return Mt(t,"POST","/v2/accounts/mfaEnrollment:finalize",wt(t,e))}function rq(t,e){return Mt(t,"POST","/v2/accounts/mfaEnrollment:withdraw",wt(t,e))}class ly{constructor(e){this.user=e,this.enrolledFactors=[],e._onReload(n=>{n.mfaInfo&&(this.enrolledFactors=n.mfaInfo.map(r=>yf._fromServerResponse(e.auth,r)))})}static _fromUser(e){return new ly(e)}async getSession(){return Fi._fromIdtoken(await this.user.getIdToken())}async enroll(e,n){const r=e,s=await this.getSession(),i=await as(this.user,r._process(this.user.auth,s,n));return await this.user._updateTokensIfNecessary(i),this.user.reload()}async unenroll(e){var n;const r=typeof e=="string"?e:e.uid,s=await this.user.getIdToken(),i=await as(this.user,rq(this.user.auth,{idToken:s,mfaEnrollmentId:r}));this.enrolledFactors=this.enrolledFactors.filter(({uid:o})=>o!==r),await this.user._updateTokensIfNecessary(i);try{await this.user.reload()}catch(o){if(((n=o)===null||n===void 0?void 0:n.code)!=="auth/user-token-expired")throw o}}}const Wp=new WeakMap;function sq(t){const e=N(t);return Wp.has(e)||Wp.set(e,ly._fromUser(e)),Wp.get(e)}const td="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cA{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(td,"1"),this.storage.removeItem(td),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iq(){const t=We();return iy(t)||za(t)}const oq=1e3,aq=10;class lA extends cA{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=iq()&&rB(),this.fallbackToPolling=GC(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),s=this.localCache[n];r!==s&&e(n,s,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((o,a,c)=>{this.notifyListeners(o,c)});return}const r=e.key;if(n?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const o=this.storage.getItem(r);if(e.newValue!==o)e.newValue!==null?this.storage.setItem(r,e.newValue):this.storage.removeItem(r);else if(this.localCache[r]===e.newValue&&!n)return}const s=()=>{const o=this.storage.getItem(r);!n&&this.localCache[r]===o||this.notifyListeners(r,o)},i=this.storage.getItem(r);nB()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,aq):s()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},oq)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}lA.type="LOCAL";const uy=lA;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uA extends cA{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}uA.type="SESSION";const eo=uA;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cq(t){return Promise.all(t.map(async e=>{try{const n=await e;return{fulfilled:!0,value:n}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wf{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(s=>s.isListeningto(e));if(n)return n;const r=new wf(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:s,data:i}=n.data,o=this.handlersMap[s];if(!(o!=null&&o.size))return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:s});const a=Array.from(o).map(async l=>l(n.origin,i)),c=await cq(a);n.ports[0].postMessage({status:"done",eventId:r,eventType:s,response:c})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}wf.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mu(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lq{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const s=typeof MessageChannel!="undefined"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let i,o;return new Promise((a,c)=>{const l=mu("",20);s.port1.start();const u=setTimeout(()=>{c(new Error("unsupported_event"))},r);o={messageChannel:s,onMessage(h){const d=h;if(d.data.eventId===l)switch(d.data.status){case"ack":clearTimeout(u),i=setTimeout(()=>{c(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),a(d.data.response);break;default:clearTimeout(u),clearTimeout(i),c(new Error("invalid_response"));break}}},this.handlers.add(o),s.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:l,data:n},[s.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gt(){return window}function uq(t){gt().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hy(){return typeof gt().WorkerGlobalScope!="undefined"&&typeof gt().importScripts=="function"}async function hq(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function dq(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function fq(){return hy()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hA="firebaseLocalStorageDb",pq=1,nd="firebaseLocalStorage",dA="fbase_key";class _u{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function bf(t,e){return t.transaction([nd],e?"readwrite":"readonly").objectStore(nd)}function gq(){const t=indexedDB.deleteDatabase(hA);return new _u(t).toPromise()}function im(){const t=indexedDB.open(hA,pq);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(nd,{keyPath:dA})}catch(s){n(s)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains(nd)?e(r):(r.close(),await gq(),e(await im()))})})}async function _I(t,e,n){const r=bf(t,!0).put({[dA]:e,value:n});return new _u(r).toPromise()}async function mq(t,e){const n=bf(t,!1).get(e),r=await new _u(n).toPromise();return r===void 0?null:r.value}function yI(t,e){const n=bf(t,!0).delete(e);return new _u(n).toPromise()}const _q=800,yq=3;class fA{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await im(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>yq)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return hy()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=wf._getInstance(fq()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var e,n;if(this.activeServiceWorker=await hq(),!this.activeServiceWorker)return;this.sender=new lq(this.activeServiceWorker);const r=await this.sender._send("ping",{},800);!r||((e=r[0])===null||e===void 0?void 0:e.fulfilled)&&((n=r[0])===null||n===void 0?void 0:n.value.includes("keyChanged"))&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||dq()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await im();return await _I(e,td,"1"),await yI(e,td),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>_I(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>mq(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>yI(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const i=bf(s,!1).getAll();return new _u(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;for(const{fbase_key:s,value:i}of e)r.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(i)&&(this.notifyListeners(s,i),n.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!r.has(s)&&(this.notifyListeners(s,null),n.push(s));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),_q)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}fA.type="LOCAL";const Pl=fA;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vq(t,e){return Mt(t,"POST","/v2/accounts/mfaSignIn:start",wt(t,e))}function wq(t,e){return Mt(t,"POST","/v2/accounts/mfaSignIn:finalize",wt(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function bq(t){return(await Mt(t,"GET","/v1/recaptchaParams")).recaptchaSiteKey||""}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Iq(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}function pA(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=s=>{const i=Kt("internal-error");i.customData=s,n(i)},r.type="text/javascript",r.charset="UTF-8",Iq().appendChild(r)})}function gA(t){return`__${t}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Eq=500,Tq=6e4,nh=1e12;class Sq{constructor(e){this.auth=e,this.counter=nh,this._widgets=new Map}render(e,n){const r=this.counter;return this._widgets.set(r,new Cq(e,this.auth.name,n||{})),this.counter++,r}reset(e){var n;const r=e||nh;(n=this._widgets.get(r))===null||n===void 0||n.delete(),this._widgets.delete(r)}getResponse(e){var n;const r=e||nh;return((n=this._widgets.get(r))===null||n===void 0?void 0:n.getResponse())||""}async execute(e){var n;const r=e||nh;return(n=this._widgets.get(r))===null||n===void 0||n.execute(),""}}class Cq{constructor(e,n,r){this.params=r,this.timerId=null,this.deleted=!1,this.responseToken=null,this.clickHandler=()=>{this.execute()};const s=typeof e=="string"?document.getElementById(e):e;x(s,"argument-error",{appName:n}),this.container=s,this.isVisible=this.params.size!=="invisible",this.isVisible?this.execute():this.container.addEventListener("click",this.clickHandler)}getResponse(){return this.checkIfDeleted(),this.responseToken}delete(){this.checkIfDeleted(),this.deleted=!0,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.container.removeEventListener("click",this.clickHandler)}execute(){this.checkIfDeleted(),!this.timerId&&(this.timerId=window.setTimeout(()=>{this.responseToken=Aq(50);const{callback:e,"expired-callback":n}=this.params;if(e)try{e(this.responseToken)}catch{}this.timerId=window.setTimeout(()=>{if(this.timerId=null,this.responseToken=null,n)try{n()}catch{}this.isVisible&&this.execute()},Tq)},Eq))}checkIfDeleted(){if(this.deleted)throw new Error("reCAPTCHA mock was already deleted!")}}function Aq(t){const e=[],n="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let r=0;r<t;r++)e.push(n.charAt(Math.floor(Math.random()*n.length)));return e.join("")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gp=gA("rcb"),kq=new pu(3e4,6e4),Rq="https://www.google.com/recaptcha/api.js?";class Nq{constructor(){var e;this.hostLanguage="",this.counter=0,this.librarySeparatelyLoaded=!!(!((e=gt().grecaptcha)===null||e===void 0)&&e.render)}load(e,n=""){return x(Pq(n),e,"argument-error"),this.shouldResolveImmediately(n)?Promise.resolve(gt().grecaptcha):new Promise((r,s)=>{const i=gt().setTimeout(()=>{s(Kt(e,"network-request-failed"))},kq.get());gt()[Gp]=()=>{gt().clearTimeout(i),delete gt()[Gp];const a=gt().grecaptcha;if(!a){s(Kt(e,"internal-error"));return}const c=a.render;a.render=(l,u)=>{const h=c(l,u);return this.counter++,h},this.hostLanguage=n,r(a)};const o=`${Rq}?${To({onload:Gp,render:"explicit",hl:n})}`;pA(o).catch(()=>{clearTimeout(i),s(Kt(e,"internal-error"))})})}clearedOneInstance(){this.counter--}shouldResolveImmediately(e){var n;return!!(!((n=gt().grecaptcha)===null||n===void 0)&&n.render)&&(e===this.hostLanguage||this.counter>0||this.librarySeparatelyLoaded)}}function Pq(t){return t.length<=6&&/^\s*[a-zA-Z0-9\-]*\s*$/.test(t)}class Dq{async load(e){return new Sq(e)}clearedOneInstance(){}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mA="recaptcha",xq={theme:"light",type:"image"};class Oq{constructor(e,n=Object.assign({},xq),r){this.parameters=n,this.type=mA,this.destroyed=!1,this.widgetId=null,this.tokenChangeListeners=new Set,this.renderPromise=null,this.recaptcha=null,this.auth=Dt(r),this.isInvisible=this.parameters.size==="invisible",x(typeof document!="undefined",this.auth,"operation-not-supported-in-this-environment");const s=typeof e=="string"?document.getElementById(e):e;x(s,this.auth,"argument-error"),this.container=s,this.parameters.callback=this.makeTokenCallback(this.parameters.callback),this._recaptchaLoader=this.auth.settings.appVerificationDisabledForTesting?new Dq:new Nq,this.validateStartingState()}async verify(){this.assertNotDestroyed();const e=await this.render(),n=this.getAssertedRecaptcha(),r=n.getResponse(e);return r||new Promise(s=>{const i=o=>{!o||(this.tokenChangeListeners.delete(i),s(o))};this.tokenChangeListeners.add(i),this.isInvisible&&n.execute(e)})}render(){try{this.assertNotDestroyed()}catch(e){return Promise.reject(e)}return this.renderPromise?this.renderPromise:(this.renderPromise=this.makeRenderPromise().catch(e=>{throw this.renderPromise=null,e}),this.renderPromise)}_reset(){this.assertNotDestroyed(),this.widgetId!==null&&this.getAssertedRecaptcha().reset(this.widgetId)}clear(){this.assertNotDestroyed(),this.destroyed=!0,this._recaptchaLoader.clearedOneInstance(),this.isInvisible||this.container.childNodes.forEach(e=>{this.container.removeChild(e)})}validateStartingState(){x(!this.parameters.sitekey,this.auth,"argument-error"),x(this.isInvisible||!this.container.hasChildNodes(),this.auth,"argument-error"),x(typeof document!="undefined",this.auth,"operation-not-supported-in-this-environment")}makeTokenCallback(e){return n=>{if(this.tokenChangeListeners.forEach(r=>r(n)),typeof e=="function")e(n);else if(typeof e=="string"){const r=gt()[e];typeof r=="function"&&r(n)}}}assertNotDestroyed(){x(!this.destroyed,this.auth,"internal-error")}async makeRenderPromise(){if(await this.init(),!this.widgetId){let e=this.container;if(!this.isInvisible){const n=document.createElement("div");e.appendChild(n),e=n}this.widgetId=this.getAssertedRecaptcha().render(e,this.parameters)}return this.widgetId}async init(){x(ry()&&!hy(),this.auth,"internal-error"),await Mq(),this.recaptcha=await this._recaptchaLoader.load(this.auth,this.auth.languageCode||void 0);const e=await bq(this.auth);x(e,this.auth,"internal-error"),this.parameters.sitekey=e}getAssertedRecaptcha(){return x(this.recaptcha,this.auth,"internal-error"),this.recaptcha}}function Mq(){let t=null;return new Promise(e=>{if(document.readyState==="complete"){e();return}t=()=>e(),window.addEventListener("load",t)}).catch(e=>{throw t&&window.removeEventListener("load",t),e})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dy{constructor(e,n){this.verificationId=e,this.onConfirmation=n}confirm(e){const n=Gi._fromVerification(this.verificationId,e);return this.onConfirmation(n)}}async function Lq(t,e,n){const r=Dt(t),s=await If(r,e,N(n));return new dy(s,i=>_f(r,i))}async function Fq(t,e,n){const r=N(t);await mf(!1,r,"phone");const s=await If(r.auth,e,N(n));return new dy(s,i=>rA(r,i))}async function Uq(t,e,n){const r=N(t),s=await If(r.auth,e,N(n));return new dy(s,i=>sA(r,i))}async function If(t,e,n){var r;const s=await n.verify();try{x(typeof s=="string",t,"argument-error"),x(n.type===mA,t,"argument-error");let i;if(typeof e=="string"?i={phoneNumber:e}:i=e,"session"in i){const o=i.session;if("phoneNumber"in i)return x(o.type==="enroll",t,"internal-error"),(await tq(t,{idToken:o.credential,phoneEnrollmentInfo:{phoneNumber:i.phoneNumber,recaptchaToken:s}})).phoneSessionInfo.sessionInfo;{x(o.type==="signin",t,"internal-error");const a=((r=i.multiFactorHint)===null||r===void 0?void 0:r.uid)||i.multiFactorUid;return x(a,t,"missing-multi-factor-info"),(await vq(t,{mfaPendingCredential:o.credential,mfaEnrollmentId:a,phoneSignInInfo:{recaptchaToken:s}})).phoneResponseInfo.sessionInfo}}else{const{sessionInfo:o}=await yB(t,{phoneNumber:i.phoneNumber,recaptchaToken:s});return o}}finally{n._reset()}}async function $q(t,e){await oy(N(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cr{constructor(e){this.providerId=cr.PROVIDER_ID,this.auth=Dt(e)}verifyPhoneNumber(e,n){return If(this.auth,e,N(n))}static credential(e,n){return Gi._fromVerification(e,n)}static credentialFromResult(e){const n=e;return cr.credentialFromTaggedObject(n)}static credentialFromError(e){return cr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{phoneNumber:n,temporaryProof:r}=e;return n&&r?Gi._fromTokenResponse(n,r):null}}cr.PROVIDER_ID="phone";cr.PHONE_SIGN_IN_METHOD="phone";/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Co(t,e){return e?Rn(e):(x(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fy extends Qa{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return ns(e,this._buildIdpRequest())}_linkToIdToken(e,n){return ns(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return ns(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function Vq(t){return nA(t.auth,new fy(t),t.bypassAuthState)}function Bq(t){const{auth:e,user:n}=t;return x(n,e,"internal-error"),tA(n,new fy(t),t.bypassAuthState)}async function qq(t){const{auth:e,user:n}=t;return x(n,e,"internal-error"),oy(n,new fy(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _A{constructor(e,n,r,s,i=!1){this.auth=e,this.resolver=r,this.user=s,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:s,tenantId:i,error:o,type:a}=e;if(o){this.reject(o);return}const c={auth:this.auth,requestUri:n,sessionId:r,tenantId:i||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(c))}catch(l){this.reject(l)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return Vq;case"linkViaPopup":case"linkViaRedirect":return qq;case"reauthViaPopup":case"reauthViaRedirect":return Bq;default:zt(this.auth,"internal-error")}}resolve(e){hr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){hr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jq=new pu(2e3,1e4);async function Kq(t,e,n){const r=Dt(t);Ga(t,e,ps);const s=Co(r,n);return new Qr(r,"signInViaPopup",e,s).executeNotNull()}async function Hq(t,e,n){const r=N(t);Ga(r.auth,e,ps);const s=Co(r.auth,n);return new Qr(r.auth,"reauthViaPopup",e,s,r).executeNotNull()}async function Wq(t,e,n){const r=N(t);Ga(r.auth,e,ps);const s=Co(r.auth,n);return new Qr(r.auth,"linkViaPopup",e,s,r).executeNotNull()}class Qr extends _A{constructor(e,n,r,s,i){super(e,n,s,i),this.provider=r,this.authWindow=null,this.pollId=null,Qr.currentPopupAction&&Qr.currentPopupAction.cancel(),Qr.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return x(e,this.auth,"internal-error"),e}async onExecution(){hr(this.filter.length===1,"Popup operations only handle one event");const e=mu();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(Kt(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(Kt(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Qr.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,r;if(!((r=(n=this.authWindow)===null||n===void 0?void 0:n.window)===null||r===void 0)&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Kt(this.auth,"popup-closed-by-user"))},2e3);return}this.pollId=window.setTimeout(e,jq.get())};e()}}Qr.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gq="pendingRedirect",Gc=new Map;class zq extends _A{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=Gc.get(this.auth._key());if(!e){try{const r=await Qq(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}Gc.set(this.auth._key(),e)}return this.bypassAuthState||Gc.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function Qq(t,e){const n=vA(e),r=yA(t);if(!await r._isAvailable())return!1;const s=await r._get(n)==="true";return await r._remove(n),s}async function py(t,e){return yA(t)._set(vA(e),"true")}function Yq(){Gc.clear()}function gy(t,e){Gc.set(t._key(),e)}function yA(t){return Rn(t._redirectPersistence)}function vA(t){return Wi(Gq,t.config.apiKey,t.name)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Jq(t,e,n){return Xq(t,e,n)}async function Xq(t,e,n){const r=Dt(t);Ga(t,e,ps);const s=Co(r,n);return await py(s,r),s._openRedirect(r,e,"signInViaRedirect")}function Zq(t,e,n){return ej(t,e,n)}async function ej(t,e,n){const r=N(t);Ga(r.auth,e,ps);const s=Co(r.auth,n);await py(s,r.auth);const i=await wA(r);return s._openRedirect(r.auth,e,"reauthViaRedirect",i)}function tj(t,e,n){return nj(t,e,n)}async function nj(t,e,n){const r=N(t);Ga(r.auth,e,ps);const s=Co(r.auth,n);await mf(!1,r,e.providerId),await py(s,r.auth);const i=await wA(r);return s._openRedirect(r.auth,e,"linkViaRedirect",i)}async function rj(t,e){return await Dt(t)._initializationPromise,Ef(t,e,!1)}async function Ef(t,e,n=!1){const r=Dt(t),s=Co(r,e),o=await new zq(r,s,n).execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}async function wA(t){const e=mu(`${t.uid}:::`);return t._redirectEventId=e,await t.auth._setRedirectUser(t),await t.auth._persistUserIfCurrent(t),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sj=10*60*1e3;class bA{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!ij(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var r;if(e.error&&!IA(e)){const s=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";n.onError(Kt(this.auth,s))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=sj&&this.cachedEventUids.clear(),this.cachedEventUids.has(vI(e))}saveEventToCache(e){this.cachedEventUids.add(vI(e)),this.lastProcessedEventTime=Date.now()}}function vI(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function IA({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function ij(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return IA(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function EA(t,e={}){return Mt(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oj=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,aj=/^https?/;async function cj(t){if(t.config.emulator)return;const{authorizedDomains:e}=await EA(t);for(const n of e)try{if(lj(n))return}catch{}zt(t,"unauthorized-domain")}function lj(t){const e=Al(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&o.hostname===r}if(!aj.test(n))return!1;if(oj.test(t))return r===t;const s=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uj=new pu(3e4,6e4);function wI(){const t=gt().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function hj(t){return new Promise((e,n)=>{var r,s,i;function o(){wI(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{wI(),n(Kt(t,"network-request-failed"))},timeout:uj.get()})}if(!((s=(r=gt().gapi)===null||r===void 0?void 0:r.iframes)===null||s===void 0)&&s.Iframe)e(gapi.iframes.getContext());else if(!((i=gt().gapi)===null||i===void 0)&&i.load)o();else{const a=gA("iframefcb");return gt()[a]=()=>{gapi.load?o():n(Kt(t,"network-request-failed"))},pA(`https://apis.google.com/js/api.js?onload=${a}`).catch(c=>n(c))}}).catch(e=>{throw Ch=null,e})}let Ch=null;function dj(t){return Ch=Ch||hj(t),Ch}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fj=new pu(5e3,15e3),pj="__/auth/iframe",gj="emulator/auth/iframe",mj={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},_j=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function yj(t){const e=t.config;x(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?sy(e,gj):`https://${t.config.authDomain}/${pj}`,r={apiKey:e.apiKey,appName:t.name,v:Br},s=_j.get(t.config.apiHost);s&&(r.eid=s);const i=t._getFrameworks();return i.length&&(r.fw=i.join(",")),`${n}?${To(r).slice(1)}`}async function vj(t){const e=await dj(t),n=gt().gapi;return x(n,t,"internal-error"),e.open({where:document.body,url:yj(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:mj,dontclear:!0},r=>new Promise(async(s,i)=>{await r.restyle({setHideOnLeave:!1});const o=Kt(t,"network-request-failed"),a=gt().setTimeout(()=>{i(o)},fj.get());function c(){gt().clearTimeout(a),s(r)}r.ping(c).then(c,()=>{i(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wj={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},bj=500,Ij=600,Ej="_blank",Tj="http://localhost";class bI{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function Sj(t,e,n,r=bj,s=Ij){const i=Math.max((window.screen.availHeight-s)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let a="";const c=Object.assign(Object.assign({},wj),{width:r.toString(),height:s.toString(),top:i,left:o}),l=We().toLowerCase();n&&(a=jC(l)?Ej:n),qC(l)&&(e=e||Tj,c.scrollbars="yes");const u=Object.entries(c).reduce((d,[f,p])=>`${d}${f}=${p},`,"");if(tB(l)&&a!=="_self")return Cj(e||"",a),new bI(null);const h=window.open(e||"",a,u);x(h,t,"popup-blocked");try{h.focus()}catch{}return new bI(h)}function Cj(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Aj="__/auth/handler",kj="emulator/auth/handler";function om(t,e,n,r,s,i){x(t.config.authDomain,t,"auth-domain-config-required"),x(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:Br,eventId:s};if(e instanceof ps){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",Kh(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[c,l]of Object.entries(i||{}))o[c]=l}if(e instanceof Ya){const c=e.getScopes().filter(l=>l!=="");c.length>0&&(o.scopes=c.join(","))}t.tenantId&&(o.tid=t.tenantId);const a=o;for(const c of Object.keys(a))a[c]===void 0&&delete a[c];return`${Rj(t)}?${To(a).slice(1)}`}function Rj({config:t}){return t.emulator?sy(t,kj):`https://${t.authDomain}/${Aj}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zp="webStorageSupport";class Nj{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=eo,this._completeRedirectFn=Ef,this._overrideRedirectResult=gy}async _openPopup(e,n,r,s){var i;hr((i=this.eventManagers[e._key()])===null||i===void 0?void 0:i.manager,"_initialize() not called before _openPopup()");const o=om(e,n,r,Al(),s);return Sj(e,o,mu())}async _openRedirect(e,n,r,s){return await this._originValidation(e),uq(om(e,n,r,Al(),s)),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:s,promise:i}=this.eventManagers[n];return s?Promise.resolve(s):(hr(i,"If manager is not set, promise should be"),i)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await vj(e),r=new bA(e);return n.register("authEvent",s=>(x(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:r.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(zp,{type:zp},s=>{var i;const o=(i=s==null?void 0:s[0])===null||i===void 0?void 0:i[zp];o!==void 0&&n(!!o),zt(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=cj(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return GC()||iy()||za()}}const Pj=Nj;class Dj{constructor(e){this.factorId=e}_process(e,n,r){switch(n.type){case"enroll":return this._finalizeEnroll(e,n.credential,r);case"signin":return this._finalizeSignIn(e,n.credential);default:return Er("unexpected MultiFactorSessionType")}}}class my extends Dj{constructor(e){super("phone"),this.credential=e}static _fromCredential(e){return new my(e)}_finalizeEnroll(e,n,r){return nq(e,{idToken:n,displayName:r,phoneVerificationInfo:this.credential._makeVerificationRequest()})}_finalizeSignIn(e,n){return wq(e,{mfaPendingCredential:n,phoneVerificationInfo:this.credential._makeVerificationRequest()})}}class TA{constructor(){}static assertion(e){return my._fromCredential(e)}}TA.FACTOR_ID="phone";var II="@firebase/auth",EI="0.20.5";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xj{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{var s;e(((s=r)===null||s===void 0?void 0:s.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);!n||(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){x(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Oj(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";default:return}}function Mj(t){st(new Ee("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),{apiKey:i,authDomain:o}=r.options;return((a,c)=>{x(i&&!i.includes(":"),"invalid-api-key",{appName:a.name}),x(!(o!=null&&o.includes(":")),"argument-error",{appName:a.name});const l={apiKey:i,authDomain:o,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:zC(t)},u=new iB(a,c,l);return FV(u,n),u})(r,s)},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),st(new Ee("auth-internal",e=>{const n=Dt(e.getProvider("auth").getImmediate());return(r=>new xj(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),Fe(II,EI,Oj(t)),Fe(II,EI,"esm2017")}Mj("Browser");/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function to(){return window}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lj=2e3;async function Fj(t,e,n){var r;const{BuildInfo:s}=to();hr(e.sessionId,"AuthEvent did not contain a session ID");const i=await qj(e.sessionId),o={};return za()?o.ibi=s.packageName:gu()?o.apn=s.packageName:zt(t,"operation-not-supported-in-this-environment"),s.displayName&&(o.appDisplayName=s.displayName),o.sessionId=i,om(t,n,e.type,void 0,(r=e.eventId)!==null&&r!==void 0?r:void 0,o)}async function Uj(t){const{BuildInfo:e}=to(),n={};za()?n.iosBundleId=e.packageName:gu()?n.androidPackageName=e.packageName:zt(t,"operation-not-supported-in-this-environment"),await EA(t,n)}function $j(t){const{cordova:e}=to();return new Promise(n=>{e.plugins.browsertab.isAvailable(r=>{let s=null;r?e.plugins.browsertab.openUrl(t):s=e.InAppBrowser.open(t,eB()?"_blank":"_system","location=yes"),n(s)})})}async function Vj(t,e,n){const{cordova:r}=to();let s=()=>{};try{await new Promise((i,o)=>{let a=null;function c(){var h;i();const d=(h=r.plugins.browsertab)===null||h===void 0?void 0:h.close;typeof d=="function"&&d(),typeof(n==null?void 0:n.close)=="function"&&n.close()}function l(){a||(a=window.setTimeout(()=>{o(Kt(t,"redirect-cancelled-by-user"))},Lj))}function u(){(document==null?void 0:document.visibilityState)==="visible"&&l()}e.addPassiveListener(c),document.addEventListener("resume",l,!1),gu()&&document.addEventListener("visibilitychange",u,!1),s=()=>{e.removePassiveListener(c),document.removeEventListener("resume",l,!1),document.removeEventListener("visibilitychange",u,!1),a&&window.clearTimeout(a)}})}finally{s()}}function Bj(t){var e,n,r,s,i,o,a,c,l,u;const h=to();x(typeof((e=h==null?void 0:h.universalLinks)===null||e===void 0?void 0:e.subscribe)=="function",t,"invalid-cordova-configuration",{missingPlugin:"cordova-universal-links-plugin-fix"}),x(typeof((n=h==null?void 0:h.BuildInfo)===null||n===void 0?void 0:n.packageName)!="undefined",t,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-buildInfo"}),x(typeof((i=(s=(r=h==null?void 0:h.cordova)===null||r===void 0?void 0:r.plugins)===null||s===void 0?void 0:s.browsertab)===null||i===void 0?void 0:i.openUrl)=="function",t,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),x(typeof((c=(a=(o=h==null?void 0:h.cordova)===null||o===void 0?void 0:o.plugins)===null||a===void 0?void 0:a.browsertab)===null||c===void 0?void 0:c.isAvailable)=="function",t,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),x(typeof((u=(l=h==null?void 0:h.cordova)===null||l===void 0?void 0:l.InAppBrowser)===null||u===void 0?void 0:u.open)=="function",t,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-inappbrowser"})}async function qj(t){const e=jj(t),n=await crypto.subtle.digest("SHA-256",e);return Array.from(new Uint8Array(n)).map(s=>s.toString(16).padStart(2,"0")).join("")}function jj(t){if(hr(/[0-9a-zA-Z]+/.test(t),"Can only convert alpha-numeric strings"),typeof TextEncoder!="undefined")return new TextEncoder().encode(t);const e=new ArrayBuffer(t.length),n=new Uint8Array(e);for(let r=0;r<t.length;r++)n[r]=t.charCodeAt(r);return n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kj=20;class Hj extends bA{constructor(){super(...arguments),this.passiveListeners=new Set,this.initPromise=new Promise(e=>{this.resolveInialized=e})}addPassiveListener(e){this.passiveListeners.add(e)}removePassiveListener(e){this.passiveListeners.delete(e)}resetRedirect(){this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1}onEvent(e){return this.resolveInialized(),this.passiveListeners.forEach(n=>n(e)),super.onEvent(e)}async initialized(){await this.initPromise}}function Wj(t,e,n=null){return{type:e,eventId:n,urlResponse:null,sessionId:Qj(),postBody:null,tenantId:t.tenantId,error:Kt(t,"no-auth-event")}}function Gj(t,e){return am()._set(cm(t),e)}async function TI(t){const e=await am()._get(cm(t));return e&&await am()._remove(cm(t)),e}function zj(t,e){var n,r;const s=Jj(e);if(s.includes("/__/auth/callback")){const i=Ah(s),o=i.firebaseError?Yj(decodeURIComponent(i.firebaseError)):null,a=(r=(n=o==null?void 0:o.code)===null||n===void 0?void 0:n.split("auth/"))===null||r===void 0?void 0:r[1],c=a?Kt(a):null;return c?{type:t.type,eventId:t.eventId,tenantId:t.tenantId,error:c,urlResponse:null,sessionId:null,postBody:null}:{type:t.type,eventId:t.eventId,tenantId:t.tenantId,sessionId:t.sessionId,urlResponse:s,postBody:null}}return null}function Qj(){const t=[],e="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let n=0;n<Kj;n++){const r=Math.floor(Math.random()*e.length);t.push(e.charAt(r))}return t.join("")}function am(){return Rn(uy)}function cm(t){return Wi("authEvent",t.config.apiKey,t.name)}function Yj(t){try{return JSON.parse(t)}catch{return null}}function Jj(t){const e=Ah(t),n=e.link?decodeURIComponent(e.link):void 0,r=Ah(n).link,s=e.deep_link_id?decodeURIComponent(e.deep_link_id):void 0;return Ah(s).link||s||r||n||t}function Ah(t){if(!(t!=null&&t.includes("?")))return{};const[e,...n]=t.split("?");return Yo(n.join("?"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xj=500;class Zj{constructor(){this._redirectPersistence=eo,this._shouldInitProactively=!0,this.eventManagers=new Map,this.originValidationPromises={},this._completeRedirectFn=Ef,this._overrideRedirectResult=gy}async _initialize(e){const n=e._key();let r=this.eventManagers.get(n);return r||(r=new Hj(e),this.eventManagers.set(n,r),this.attachCallbackListeners(e,r)),r}_openPopup(e){zt(e,"operation-not-supported-in-this-environment")}async _openRedirect(e,n,r,s){Bj(e);const i=await this._initialize(e);await i.initialized(),i.resetRedirect(),Yq(),await this._originValidation(e);const o=Wj(e,r,s);await Gj(e,o);const a=await Fj(e,o,n),c=await $j(a);return Vj(e,i,c)}_isIframeWebStorageSupported(e,n){throw new Error("Method not implemented.")}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=Uj(e)),this.originValidationPromises[n]}attachCallbackListeners(e,n){const{universalLinks:r,handleOpenURL:s,BuildInfo:i}=to(),o=setTimeout(async()=>{await TI(e),n.onEvent(SI())},Xj),a=async u=>{clearTimeout(o);const h=await TI(e);let d=null;h&&(u==null?void 0:u.url)&&(d=zj(h,u.url)),n.onEvent(d||SI())};typeof r!="undefined"&&typeof r.subscribe=="function"&&r.subscribe(null,a);const c=s,l=`${i.packageName.toLowerCase()}://`;to().handleOpenURL=async u=>{if(u.toLowerCase().startsWith(l)&&a({url:u}),typeof c=="function")try{c(u)}catch(h){console.error(h)}}}}const eK=Zj;function SI(){return{type:"unknown",eventId:null,sessionId:null,urlResponse:null,postBody:null,tenantId:null,error:Kt("no-auth-event")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tK(t,e){Dt(t)._logFramework(e)}var nK="@firebase/auth-compat",rK="0.2.18";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sK=1e3;function zc(){var t;return((t=self==null?void 0:self.location)===null||t===void 0?void 0:t.protocol)||null}function iK(){return zc()==="http:"||zc()==="https:"}function SA(t=We()){return!!((zc()==="file:"||zc()==="ionic:"||zc()==="capacitor:")&&t.toLowerCase().match(/iphone|ipad|ipod|android/))}function oK(){return hu()||V_()}function aK(){return B_()&&(document==null?void 0:document.documentMode)===11}function cK(t=We()){return/Edge\/\d+/.test(t)}function lK(t=We()){return aK()||cK(t)}function CA(){try{const t=self.localStorage,e=mu();if(t)return t.setItem(e,"1"),t.removeItem(e),lK()?In():!0}catch{return _y()&&In()}return!1}function _y(){return typeof global!="undefined"&&"WorkerGlobalScope"in global&&"importScripts"in global}function Qp(){return(iK()||uu()||SA())&&!oK()&&CA()&&!_y()}function AA(){return SA()&&typeof document!="undefined"}async function uK(){return AA()?new Promise(t=>{const e=setTimeout(()=>{t(!1)},sK);document.addEventListener("deviceready",()=>{clearTimeout(e),t(!0)})}):!1}function hK(){return typeof window!="undefined"?window:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cn={LOCAL:"local",NONE:"none",SESSION:"session"},mc=x,kA="persistence";function dK(t,e){if(mc(Object.values(Cn).includes(e),t,"invalid-persistence-type"),hu()){mc(e!==Cn.SESSION,t,"unsupported-persistence-type");return}if(V_()){mc(e===Cn.NONE,t,"unsupported-persistence-type");return}if(_y()){mc(e===Cn.NONE||e===Cn.LOCAL&&In(),t,"unsupported-persistence-type");return}mc(e===Cn.NONE||CA(),t,"unsupported-persistence-type")}async function lm(t){await t._initializationPromise;const e=RA(),n=Wi(kA,t.config.apiKey,t.name);e&&e.setItem(n,t._getPersistence())}function fK(t,e){const n=RA();if(!n)return[];const r=Wi(kA,t,e);switch(n.getItem(r)){case Cn.NONE:return[Ia];case Cn.LOCAL:return[Pl,eo];case Cn.SESSION:return[eo];default:return[]}}function RA(){var t;try{return((t=hK())===null||t===void 0?void 0:t.sessionStorage)||null}catch{return null}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pK=x;class Os{constructor(){this.browserResolver=Rn(Pj),this.cordovaResolver=Rn(eK),this.underlyingResolver=null,this._redirectPersistence=eo,this._completeRedirectFn=Ef,this._overrideRedirectResult=gy}async _initialize(e){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._initialize(e)}async _openPopup(e,n,r,s){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._openPopup(e,n,r,s)}async _openRedirect(e,n,r,s){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._openRedirect(e,n,r,s)}_isIframeWebStorageSupported(e,n){this.assertedUnderlyingResolver._isIframeWebStorageSupported(e,n)}_originValidation(e){return this.assertedUnderlyingResolver._originValidation(e)}get _shouldInitProactively(){return AA()||this.browserResolver._shouldInitProactively}get assertedUnderlyingResolver(){return pK(this.underlyingResolver,"internal-error"),this.underlyingResolver}async selectUnderlyingResolver(){if(this.underlyingResolver)return;const e=await uK();this.underlyingResolver=e?this.cordovaResolver:this.browserResolver}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NA(t){return t.unwrap()}function gK(t){return t.wrapped()}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mK(t){return PA(t)}function _K(t,e){var n,r;const s=(n=e.customData)===null||n===void 0?void 0:n._tokenResponse;if(((r=e)===null||r===void 0?void 0:r.code)==="auth/multi-factor-auth-required"){const i=e;i.resolver=new yK(t,eq(t,e))}else if(s){const i=PA(e),o=e;i&&(o.credential=i,o.tenantId=s.tenantId||void 0,o.email=s.email||void 0,o.phoneNumber=s.phoneNumber||void 0)}}function PA(t){const{_tokenResponse:e}=t instanceof ut?t.customData:t;if(!e)return null;if(!(t instanceof ut)&&"temporaryProof"in e&&"phoneNumber"in e)return cr.credentialFromResult(t);const n=e.providerId;if(!n||n===gc.PASSWORD)return null;let r;switch(n){case gc.GOOGLE:r=yr;break;case gc.FACEBOOK:r=_r;break;case gc.GITHUB:r=vr;break;case gc.TWITTER:r=wr;break;default:const{oauthIdToken:s,oauthAccessToken:i,oauthTokenSecret:o,pendingToken:a,nonce:c}=e;return!i&&!o&&!s&&!a?null:a?n.startsWith("saml.")?Ea._create(n,a):xr._fromParams({providerId:n,signInMethod:n,pendingToken:a,idToken:s,accessToken:i}):new ia(n).credential({idToken:s,accessToken:i,rawNonce:c})}return t instanceof ut?r.credentialFromError(t):r.credentialFromResult(t)}function gn(t,e){return e.catch(n=>{throw n instanceof ut&&_K(t,n),n}).then(n=>{const r=n.operationType,s=n.user;return{operationType:r,credential:mK(n),additionalUserInfo:ZB(n),user:Yr.getOrCreate(s)}})}async function um(t,e){const n=await e;return{verificationId:n.verificationId,confirm:r=>gn(t,n.confirm(r))}}class yK{constructor(e,n){this.resolver=n,this.auth=gK(e)}get session(){return this.resolver.session}get hints(){return this.resolver.hints}resolveSignIn(e){return gn(NA(this.auth),this.resolver.resolveSignIn(e))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yr{constructor(e){this._delegate=e,this.multiFactor=sq(e)}static getOrCreate(e){return Yr.USER_MAP.has(e)||Yr.USER_MAP.set(e,new Yr(e)),Yr.USER_MAP.get(e)}delete(){return this._delegate.delete()}reload(){return this._delegate.reload()}toJSON(){return this._delegate.toJSON()}getIdTokenResult(e){return this._delegate.getIdTokenResult(e)}getIdToken(e){return this._delegate.getIdToken(e)}linkAndRetrieveDataWithCredential(e){return this.linkWithCredential(e)}async linkWithCredential(e){return gn(this.auth,rA(this._delegate,e))}async linkWithPhoneNumber(e,n){return um(this.auth,Fq(this._delegate,e,n))}async linkWithPopup(e){return gn(this.auth,Wq(this._delegate,e,Os))}async linkWithRedirect(e){return await lm(Dt(this.auth)),tj(this._delegate,e,Os)}reauthenticateAndRetrieveDataWithCredential(e){return this.reauthenticateWithCredential(e)}async reauthenticateWithCredential(e){return gn(this.auth,sA(this._delegate,e))}reauthenticateWithPhoneNumber(e,n){return um(this.auth,Uq(this._delegate,e,n))}reauthenticateWithPopup(e){return gn(this.auth,Hq(this._delegate,e,Os))}async reauthenticateWithRedirect(e){return await lm(Dt(this.auth)),Zq(this._delegate,e,Os)}sendEmailVerification(e){return qB(this._delegate,e)}async unlink(e){return await kB(this._delegate,e),this}updateEmail(e){return WB(this._delegate,e)}updatePassword(e){return GB(this._delegate,e)}updatePhoneNumber(e){return $q(this._delegate,e)}updateProfile(e){return HB(this._delegate,e)}verifyBeforeUpdateEmail(e,n){return jB(this._delegate,e,n)}get emailVerified(){return this._delegate.emailVerified}get isAnonymous(){return this._delegate.isAnonymous}get metadata(){return this._delegate.metadata}get phoneNumber(){return this._delegate.phoneNumber}get providerData(){return this._delegate.providerData}get refreshToken(){return this._delegate.refreshToken}get tenantId(){return this._delegate.tenantId}get displayName(){return this._delegate.displayName}get email(){return this._delegate.email}get photoURL(){return this._delegate.photoURL}get providerId(){return this._delegate.providerId}get uid(){return this._delegate.uid}get auth(){return this._delegate.auth}}Yr.USER_MAP=new WeakMap;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _c=x;class hm{constructor(e,n){if(this.app=e,n.isInitialized()){this._delegate=n.getImmediate(),this.linkUnderlyingAuth();return}const{apiKey:r}=e.options;_c(r,"invalid-api-key",{appName:e.name}),_c(r,"invalid-api-key",{appName:e.name});const s=typeof window!="undefined"?Os:void 0;this._delegate=n.initialize({options:{persistence:vK(r,e.name),popupRedirectResolver:s}}),this._delegate._updateErrorMap(MV),this.linkUnderlyingAuth()}get emulatorConfig(){return this._delegate.emulatorConfig}get currentUser(){return this._delegate.currentUser?Yr.getOrCreate(this._delegate.currentUser):null}get languageCode(){return this._delegate.languageCode}set languageCode(e){this._delegate.languageCode=e}get settings(){return this._delegate.settings}get tenantId(){return this._delegate.tenantId}set tenantId(e){this._delegate.tenantId=e}useDeviceLanguage(){this._delegate.useDeviceLanguage()}signOut(){return this._delegate.signOut()}useEmulator(e,n){oB(this._delegate,e,n)}applyActionCode(e){return xB(this._delegate,e)}checkActionCode(e){return iA(this._delegate,e)}confirmPasswordReset(e,n){return DB(this._delegate,e,n)}async createUserWithEmailAndPassword(e,n){return gn(this._delegate,MB(this._delegate,e,n))}fetchProvidersForEmail(e){return this.fetchSignInMethodsForEmail(e)}fetchSignInMethodsForEmail(e){return BB(this._delegate,e)}isSignInWithEmailLink(e){return UB(this._delegate,e)}async getRedirectResult(){_c(Qp(),this._delegate,"operation-not-supported-in-this-environment");const e=await rj(this._delegate,Os);return e?gn(this._delegate,Promise.resolve(e)):{credential:null,user:null}}addFrameworkForLogging(e){tK(this._delegate,e)}onAuthStateChanged(e,n,r){const{next:s,error:i,complete:o}=CI(e,n,r);return this._delegate.onAuthStateChanged(s,i,o)}onIdTokenChanged(e,n,r){const{next:s,error:i,complete:o}=CI(e,n,r);return this._delegate.onIdTokenChanged(s,i,o)}sendSignInLinkToEmail(e,n){return FB(this._delegate,e,n)}sendPasswordResetEmail(e,n){return PB(this._delegate,e,n||void 0)}async setPersistence(e){dK(this._delegate,e);let n;switch(e){case Cn.SESSION:n=eo;break;case Cn.LOCAL:n=await Rn(Pl)._isAvailable()?Pl:uy;break;case Cn.NONE:n=Ia;break;default:return zt("argument-error",{appName:this._delegate.name})}return this._delegate.setPersistence(n)}signInAndRetrieveDataWithCredential(e){return this.signInWithCredential(e)}signInAnonymously(){return gn(this._delegate,AB(this._delegate))}signInWithCredential(e){return gn(this._delegate,_f(this._delegate,e))}signInWithCustomToken(e){return gn(this._delegate,NB(this._delegate,e))}signInWithEmailAndPassword(e,n){return gn(this._delegate,LB(this._delegate,e,n))}signInWithEmailLink(e,n){return gn(this._delegate,$B(this._delegate,e,n))}signInWithPhoneNumber(e,n){return um(this._delegate,Lq(this._delegate,e,n))}async signInWithPopup(e){return _c(Qp(),this._delegate,"operation-not-supported-in-this-environment"),gn(this._delegate,Kq(this._delegate,e,Os))}async signInWithRedirect(e){return _c(Qp(),this._delegate,"operation-not-supported-in-this-environment"),await lm(this._delegate),Jq(this._delegate,e,Os)}updateCurrentUser(e){return this._delegate.updateCurrentUser(e)}verifyPasswordResetCode(e){return OB(this._delegate,e)}unwrap(){return this._delegate}_delete(){return this._delegate._delete()}linkUnderlyingAuth(){this._delegate.wrapped=()=>this}}hm.Persistence=Cn;function CI(t,e,n){let r=t;typeof t!="function"&&({next:r,error:e,complete:n}=t);const s=r;return{next:o=>s(o&&Yr.getOrCreate(o)),error:e,complete:n}}function vK(t,e){const n=fK(t,e);if(typeof self!="undefined"&&!n.includes(Pl)&&n.push(Pl),typeof window!="undefined")for(const r of[uy,eo])n.includes(r)||n.push(r);return n.includes(Ia)||n.push(Ia),n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yy{constructor(){this.providerId="phone",this._delegate=new cr(NA(ht.auth()))}static credential(e,n){return cr.credential(e,n)}verifyPhoneNumber(e,n){return this._delegate.verifyPhoneNumber(e,n)}unwrap(){return this._delegate}}yy.PHONE_SIGN_IN_METHOD=cr.PHONE_SIGN_IN_METHOD;yy.PROVIDER_ID=cr.PROVIDER_ID;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wK=x;class bK{constructor(e,n,r=ht.app()){var s;wK((s=r.options)===null||s===void 0?void 0:s.apiKey,"invalid-api-key",{appName:r.name}),this._delegate=new Oq(e,n,r.auth()),this.type=this._delegate.type}clear(){this._delegate.clear()}render(){return this._delegate.render()}verify(){return this._delegate.verify()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IK="auth-compat";function EK(t){t.INTERNAL.registerComponent(new Ee(IK,e=>{const n=e.getProvider("app-compat").getImmediate(),r=e.getProvider("auth");return new hm(n,r)},"PUBLIC").setServiceProps({ActionCodeInfo:{Operation:{EMAIL_SIGNIN:$o.EMAIL_SIGNIN,PASSWORD_RESET:$o.PASSWORD_RESET,RECOVER_EMAIL:$o.RECOVER_EMAIL,REVERT_SECOND_FACTOR_ADDITION:$o.REVERT_SECOND_FACTOR_ADDITION,VERIFY_AND_CHANGE_EMAIL:$o.VERIFY_AND_CHANGE_EMAIL,VERIFY_EMAIL:$o.VERIFY_EMAIL}},EmailAuthProvider:ci,FacebookAuthProvider:_r,GithubAuthProvider:vr,GoogleAuthProvider:yr,OAuthProvider:ia,SAMLAuthProvider:Zh,PhoneAuthProvider:yy,PhoneMultiFactorGenerator:TA,RecaptchaVerifier:bK,TwitterAuthProvider:wr,Auth:hm,AuthCredential:Qa,Error:ut}).setInstantiationMode("LAZY").setMultipleInstances(!1)),t.registerVersion(nK,rK)}EK(ht);const AI="@firebase/database",kI="0.13.3";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let DA="";function xA(t){DA=t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TK{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,n){n==null?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),_t(n))}get(e){const n=this.domStorage_.getItem(this.prefixedName_(e));return n==null?null:wl(n)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SK{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,n){n==null?delete this.cache_[e]:this.cache_[e]=n}get(e){return xn(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OA=function(t){try{if(typeof window!="undefined"&&typeof window[t]!="undefined"){const e=window[t];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new TK(e)}}catch{}return new SK},Ui=OA("localStorage"),dm=OA("sessionStorage");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aa=new Vr("@firebase/database"),MA=function(){let t=1;return function(){return t++}}(),LA=function(t){const e=WL(t),n=new jL;n.update(e);const r=n.digest();return sf.encodeByteArray(r)},yu=function(...t){let e="";for(let n=0;n<t.length;n++){const r=t[n];Array.isArray(r)||r&&typeof r=="object"&&typeof r.length=="number"?e+=yu.apply(null,r):typeof r=="object"?e+=_t(r):e+=r,e+=" "}return e};let zi=null,RI=!0;const FA=function(t,e){O(!e||t===!0||t===!1,"Can't turn on custom loggers persistently."),t===!0?(aa.logLevel=fe.VERBOSE,zi=aa.log.bind(aa),e&&dm.set("logging_enabled",!0)):typeof t=="function"?zi=t:(zi=null,dm.remove("logging_enabled"))},Ct=function(...t){if(RI===!0&&(RI=!1,zi===null&&dm.get("logging_enabled")===!0&&FA(!0)),zi){const e=yu.apply(null,t);zi(e)}},vu=function(t){return function(...e){Ct(t,...e)}},fm=function(...t){const e="FIREBASE INTERNAL ERROR: "+yu(...t);aa.error(e)},Or=function(...t){const e=`FIREBASE FATAL ERROR: ${yu(...t)}`;throw aa.error(e),new Error(e)},Xt=function(...t){const e="FIREBASE WARNING: "+yu(...t);aa.warn(e)},CK=function(){typeof window!="undefined"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&Xt("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},Tf=function(t){return typeof t=="number"&&(t!==t||t===Number.POSITIVE_INFINITY||t===Number.NEGATIVE_INFINITY)},AK=function(t){if(document.readyState==="complete")t();else{let e=!1;const n=function(){if(!document.body){setTimeout(n,Math.floor(10));return}e||(e=!0,t())};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&n()}),window.attachEvent("onload",n))}},cs="[MIN_NAME]",Mr="[MAX_NAME]",Ao=function(t,e){if(t===e)return 0;if(t===cs||e===Mr)return-1;if(e===cs||t===Mr)return 1;{const n=rd(t),r=rd(e);return n!==null?r!==null?n-r===0?t.length-e.length:n-r:-1:r!==null?1:t<e?-1:1}},kK=function(t,e){return t===e?0:t<e?-1:1},yc=function(t,e){if(e&&t in e)return e[t];throw new Error("Missing required key ("+t+") in object: "+_t(e))},vy=function(t){if(typeof t!="object"||t===null)return _t(t);const e=[];for(const r in t)e.push(r);e.sort();let n="{";for(let r=0;r<e.length;r++)r!==0&&(n+=","),n+=_t(e[r]),n+=":",n+=vy(t[e[r]]);return n+="}",n},UA=function(t,e){const n=t.length;if(n<=e)return[t];const r=[];for(let s=0;s<n;s+=e)s+e>n?r.push(t.substring(s,n)):r.push(t.substring(s,s+e));return r};function xt(t,e){for(const n in t)t.hasOwnProperty(n)&&e(n,t[n])}const $A=function(t){O(!Tf(t),"Invalid JSON number");const e=11,n=52,r=(1<<e-1)-1;let s,i,o,a,c;t===0?(i=0,o=0,s=1/t===-1/0?1:0):(s=t<0,t=Math.abs(t),t>=Math.pow(2,1-r)?(a=Math.min(Math.floor(Math.log(t)/Math.LN2),r),i=a+r,o=Math.round(t*Math.pow(2,n-a)-Math.pow(2,n))):(i=0,o=Math.round(t/Math.pow(2,1-r-n))));const l=[];for(c=n;c;c-=1)l.push(o%2?1:0),o=Math.floor(o/2);for(c=e;c;c-=1)l.push(i%2?1:0),i=Math.floor(i/2);l.push(s?1:0),l.reverse();const u=l.join("");let h="";for(c=0;c<64;c+=8){let d=parseInt(u.substr(c,8),2).toString(16);d.length===1&&(d="0"+d),h=h+d}return h.toLowerCase()},RK=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},NK=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};function PK(t,e){let n="Unknown Error";t==="too_big"?n="The data requested exceeds the maximum size that can be accessed with a single request.":t==="permission_denied"?n="Client doesn't have permission to access the desired data.":t==="unavailable"&&(n="The service is unavailable");const r=new Error(t+" at "+e._path.toString()+": "+n);return r.code=t.toUpperCase(),r}const DK=new RegExp("^-?(0*)\\d{1,10}$"),VA=-2147483648,wy=2147483647,rd=function(t){if(DK.test(t)){const e=Number(t);if(e>=VA&&e<=wy)return e}return null},Ja=function(t){try{t()}catch(e){setTimeout(()=>{const n=e.stack||"";throw Xt("Exception was thrown by user callback.",n),e},Math.floor(0))}},xK=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},Qc=function(t,e){const n=setTimeout(t,e);return typeof n=="object"&&n.unref&&n.unref(),n};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OK{constructor(e,n){this.appName_=e,this.appCheckProvider=n,this.appCheck=n==null?void 0:n.getImmediate({optional:!0}),this.appCheck||n==null||n.get().then(r=>this.appCheck=r)}getToken(e){return this.appCheck?this.appCheck.getToken(e):new Promise((n,r)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(n,r):n(null)},0)})}addTokenChangeListener(e){var n;(n=this.appCheckProvider)===null||n===void 0||n.get().then(r=>r.addTokenListener(e))}notifyForInvalidToken(){Xt(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MK{constructor(e,n,r){this.appName_=e,this.firebaseOptions_=n,this.authProvider_=r,this.auth_=null,this.auth_=r.getImmediate({optional:!0}),this.auth_||r.onInit(s=>this.auth_=s)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(n=>n&&n.code==="auth/token-not-initialized"?(Ct("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(n)):new Promise((n,r)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(n,r):n(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(n=>n.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(n=>n.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',Xt(e)}}class ca{constructor(e){this.accessToken=e}getToken(e){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(e){e(this.accessToken)}removeTokenChangeListener(e){}notifyForInvalidToken(){}}ca.OWNER="owner";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const by="5",BA="v",qA="s",jA="r",KA="f",HA=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,WA="ls",GA="p",pm="ac",zA="websocket",QA="long_polling";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YA{constructor(e,n,r,s,i=!1,o="",a=!1){this.secure=n,this.namespace=r,this.webSocketOnly=s,this.nodeAdmin=i,this.persistenceKey=o,this.includeNamespaceInQueryParams=a,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=Ui.get("host:"+e)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&Ui.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){const e=this.secure?"https://":"http://",n=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${n}`}}function LK(t){return t.host!==t.internalHost||t.isCustomHost()||t.includeNamespaceInQueryParams}function JA(t,e,n){O(typeof e=="string","typeof type must == string"),O(typeof n=="object","typeof params must == object");let r;if(e===zA)r=(t.secure?"wss://":"ws://")+t.internalHost+"/.ws?";else if(e===QA)r=(t.secure?"https://":"http://")+t.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+e);LK(t)&&(n.ns=t.namespace);const s=[];return xt(n,(i,o)=>{s.push(i+"="+o)}),r+s.join("&")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FK{constructor(){this.counters_={}}incrementCounter(e,n=1){xn(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=n}get(){return NL(this.counters_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yp={},Jp={};function Iy(t){const e=t.toString();return Yp[e]||(Yp[e]=new FK),Yp[e]}function UK(t,e){const n=t.toString();return Jp[n]||(Jp[n]=e()),Jp[n]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $K{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,n){this.closeAfterResponse=e,this.onClose=n,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,n){for(this.pendingResponses[e]=n;this.pendingResponses[this.currentResponseNum];){const r=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let s=0;s<r.length;++s)r[s]&&Ja(()=>{this.onMessage_(r[s])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NI="start",VK="close",BK="pLPCommand",qK="pRTLPCB",XA="id",ZA="pw",ek="ser",jK="cb",KK="seg",HK="ts",WK="d",GK="dframe",tk=1870,nk=30,zK=tk-nk,QK=25e3,YK=3e4;class Ms{constructor(e,n,r,s,i,o,a){this.connId=e,this.repoInfo=n,this.applicationId=r,this.appCheckToken=s,this.authToken=i,this.transportSessionId=o,this.lastSessionId=a,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=vu(e),this.stats_=Iy(n),this.urlFn=c=>(this.appCheckToken&&(c[pm]=this.appCheckToken),JA(n,QA,c))}open(e,n){this.curSegmentNum=0,this.onDisconnect_=n,this.myPacketOrderer=new $K(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(YK)),AK(()=>{if(this.isClosed_)return;this.scriptTagHolder=new Ey((...i)=>{const[o,a,c,l,u]=i;if(this.incrementIncomingBytes_(i),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,o===NI)this.id=a,this.password=c;else if(o===VK)a?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(a,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+o)},(...i)=>{const[o,a]=i;this.incrementIncomingBytes_(i),this.myPacketOrderer.handleResponse(o,a)},()=>{this.onClosed_()},this.urlFn);const r={};r[NI]="t",r[ek]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(r[jK]=this.scriptTagHolder.uniqueCallbackIdentifier),r[BA]=by,this.transportSessionId&&(r[qA]=this.transportSessionId),this.lastSessionId&&(r[WA]=this.lastSessionId),this.applicationId&&(r[GA]=this.applicationId),this.appCheckToken&&(r[pm]=this.appCheckToken),typeof location!="undefined"&&location.hostname&&HA.test(location.hostname)&&(r[jA]=KA);const s=this.urlFn(r);this.log_("Connecting via long-poll to "+s),this.scriptTagHolder.addTag(s,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){Ms.forceAllow_=!0}static forceDisallow(){Ms.forceDisallow_=!0}static isAvailable(){return Ms.forceAllow_?!0:!Ms.forceDisallow_&&typeof document!="undefined"&&document.createElement!=null&&!RK()&&!NK()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){const n=_t(e);this.bytesSent+=n.length,this.stats_.incrementCounter("bytes_sent",n.length);const r=D0(n),s=UA(r,zK);for(let i=0;i<s.length;i++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,s.length,s[i]),this.curSegmentNum++}addDisconnectPingFrame(e,n){this.myDisconnFrame=document.createElement("iframe");const r={};r[GK]="t",r[XA]=e,r[ZA]=n,this.myDisconnFrame.src=this.urlFn(r),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){const n=_t(e).length;this.bytesReceived+=n,this.stats_.incrementCounter("bytes_received",n)}}class Ey{constructor(e,n,r,s){this.onDisconnect=r,this.urlFn=s,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0;{this.uniqueCallbackIdentifier=MA(),window[BK+this.uniqueCallbackIdentifier]=e,window[qK+this.uniqueCallbackIdentifier]=n,this.myIFrame=Ey.createIFrame_();let i="";if(this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"){const a=document.domain;i='<script>document.domain="'+a+'";<\/script>'}const o="<html><body>"+i+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(o),this.myIFrame.doc.close()}catch(a){Ct("frame writing exception"),a.stack&&Ct(a.stack),Ct(a)}}}static createIFrame_(){const e=document.createElement("iframe");if(e.style.display="none",document.body){document.body.appendChild(e);try{e.contentWindow.document||Ct("No IE domain setting required")}catch{const r=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+r+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.innerHTML="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));const e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,n){for(this.myID=e,this.myPW=n,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const e={};e[XA]=this.myID,e[ZA]=this.myPW,e[ek]=this.currentSerial;let n=this.urlFn(e),r="",s=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+nk+r.length<=tk;){const o=this.pendingSegs.shift();r=r+"&"+KK+s+"="+o.seg+"&"+HK+s+"="+o.ts+"&"+WK+s+"="+o.d,s++}return n=n+r,this.addLongPollTag_(n,this.currentSerial),!0}else return!1}enqueueSegment(e,n,r){this.pendingSegs.push({seg:e,ts:n,d:r}),this.alive&&this.newRequest_()}addLongPollTag_(e,n){this.outstandingRequests.add(n);const r=()=>{this.outstandingRequests.delete(n),this.newRequest_()},s=setTimeout(r,Math.floor(QK)),i=()=>{clearTimeout(s),r()};this.addTag(e,i)}addTag(e,n){setTimeout(()=>{try{if(!this.sendNewPolls)return;const r=this.myIFrame.doc.createElement("script");r.type="text/javascript",r.async=!0,r.src=e,r.onload=r.onreadystatechange=function(){const s=r.readyState;(!s||s==="loaded"||s==="complete")&&(r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),n())},r.onerror=()=>{Ct("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(r)}catch{}},Math.floor(1))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JK=16384,XK=45e3;let sd=null;typeof MozWebSocket!="undefined"?sd=MozWebSocket:typeof WebSocket!="undefined"&&(sd=WebSocket);class $n{constructor(e,n,r,s,i,o,a){this.connId=e,this.applicationId=r,this.appCheckToken=s,this.authToken=i,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=vu(this.connId),this.stats_=Iy(n),this.connURL=$n.connectionURL_(n,o,a,s,r),this.nodeAdmin=n.nodeAdmin}static connectionURL_(e,n,r,s,i){const o={};return o[BA]=by,typeof location!="undefined"&&location.hostname&&HA.test(location.hostname)&&(o[jA]=KA),n&&(o[qA]=n),r&&(o[WA]=r),s&&(o[pm]=s),i&&(o[GA]=i),JA(e,zA,o)}open(e,n){this.onDisconnect=n,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,Ui.set("previous_websocket_failure",!0);try{let r;x0(),this.mySock=new sd(this.connURL,[],r)}catch(r){this.log_("Error instantiating WebSocket.");const s=r.message||r.data;s&&this.log_(s),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=r=>{this.handleIncomingFrame(r)},this.mySock.onerror=r=>{this.log_("WebSocket error.  Closing connection.");const s=r.message||r.data;s&&this.log_(s),this.onClosed_()}}start(){}static forceDisallow(){$n.forceDisallow_=!0}static isAvailable(){let e=!1;if(typeof navigator!="undefined"&&navigator.userAgent){const n=/Android ([0-9]{0,}\.[0-9]{0,})/,r=navigator.userAgent.match(n);r&&r.length>1&&parseFloat(r[1])<4.4&&(e=!0)}return!e&&sd!==null&&!$n.forceDisallow_}static previouslyFailed(){return Ui.isInMemoryStorage||Ui.get("previous_websocket_failure")===!0}markConnectionHealthy(){Ui.remove("previous_websocket_failure")}appendFrame_(e){if(this.frames.push(e),this.frames.length===this.totalFrames){const n=this.frames.join("");this.frames=null;const r=wl(n);this.onMessage(r)}}handleNewFrameCount_(e){this.totalFrames=e,this.frames=[]}extractFrameCount_(e){if(O(this.frames===null,"We already have a frame buffer"),e.length<=6){const n=Number(e);if(!isNaN(n))return this.handleNewFrameCount_(n),null}return this.handleNewFrameCount_(1),e}handleIncomingFrame(e){if(this.mySock===null)return;const n=e.data;if(this.bytesReceived+=n.length,this.stats_.incrementCounter("bytes_received",n.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(n);else{const r=this.extractFrameCount_(n);r!==null&&this.appendFrame_(r)}}send(e){this.resetKeepAlive();const n=_t(e);this.bytesSent+=n.length,this.stats_.incrementCounter("bytes_sent",n.length);const r=UA(n,JK);r.length>1&&this.sendString_(String(r.length));for(let s=0;s<r.length;s++)this.sendString_(r[s])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(XK))}sendString_(e){try{this.mySock.send(e)}catch(n){this.log_("Exception thrown from WebSocket.send():",n.message||n.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}$n.responsesRequiredToBeHealthy=2;$n.healthyTimeout=3e4;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ta{constructor(e){this.initTransports_(e)}static get ALL_TRANSPORTS(){return[Ms,$n]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(e){const n=$n&&$n.isAvailable();let r=n&&!$n.previouslyFailed();if(e.webSocketOnly&&(n||Xt("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),r=!0),r)this.transports_=[$n];else{const s=this.transports_=[];for(const i of Ta.ALL_TRANSPORTS)i&&i.isAvailable()&&s.push(i);Ta.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}Ta.globalTransportInitialized_=!1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZK=6e4,eH=5e3,tH=10*1024,nH=100*1024,Xp="t",PI="d",rH="s",DI="r",sH="e",xI="o",OI="a",MI="n",LI="p",iH="h";class oH{constructor(e,n,r,s,i,o,a,c,l,u){this.id=e,this.repoInfo_=n,this.applicationId_=r,this.appCheckToken_=s,this.authToken_=i,this.onMessage_=o,this.onReady_=a,this.onDisconnect_=c,this.onKill_=l,this.lastSessionId=u,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=vu("c:"+this.id+":"),this.transportManager_=new Ta(n),this.log_("Connection created"),this.start_()}start_(){const e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const n=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(n,r)},Math.floor(0));const s=e.healthyTimeout||0;s>0&&(this.healthyTimeout_=Qc(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>nH?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>tH?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(s)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return n=>{e===this.conn_?this.onConnectionLost_(n):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return n=>{this.state_!==2&&(e===this.rx_?this.onPrimaryMessageReceived_(n):e===this.secondaryConn_?this.onSecondaryMessageReceived_(n):this.log_("message on old connection"))}}sendRequest(e){const n={t:"d",d:e};this.sendData_(n)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if(Xp in e){const n=e[Xp];n===OI?this.upgradeIfSecondaryHealthy_():n===DI?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):n===xI&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){const n=yc("t",e),r=yc("d",e);if(n==="c")this.onSecondaryControl_(r);else if(n==="d")this.pendingDataMessages.push(r);else throw new Error("Unknown protocol layer: "+n)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:LI,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:OI,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:MI,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){const n=yc("t",e),r=yc("d",e);n==="c"?this.onControl_(r):n==="d"&&this.onDataMessage_(r)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){const n=yc(Xp,e);if(PI in e){const r=e[PI];if(n===iH)this.onHandshake_(r);else if(n===MI){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let s=0;s<this.pendingDataMessages.length;++s)this.onDataMessage_(this.pendingDataMessages[s]);this.pendingDataMessages=[],this.tryCleanupConnection()}else n===rH?this.onConnectionShutdown_(r):n===DI?this.onReset_(r):n===sH?fm("Server Error: "+r):n===xI?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):fm("Unknown control packet command: "+n)}}onHandshake_(e){const n=e.ts,r=e.v,s=e.h;this.sessionId=e.s,this.repoInfo_.host=s,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,n),by!==r&&Xt("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const n=this.connReceiver_(this.secondaryConn_),r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(n,r),Qc(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(ZK))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,n){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(n,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):Qc(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(eH))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:LI,d:{}}}))}onSecondaryConnectionLost_(){const e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,!e&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(Ui.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(e)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rk{put(e,n,r,s){}merge(e,n,r,s){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,n,r){}onDisconnectMerge(e,n,r){}onDisconnectCancel(e,n){}reportStats(e){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sk{constructor(e){this.allowedEvents_=e,this.listeners_={},O(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...n){if(Array.isArray(this.listeners_[e])){const r=[...this.listeners_[e]];for(let s=0;s<r.length;s++)r[s].callback.apply(r[s].context,n)}}on(e,n,r){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:n,context:r});const s=this.getInitialEvent(e);s&&n.apply(r,s)}off(e,n,r){this.validateEventType_(e);const s=this.listeners_[e]||[];for(let i=0;i<s.length;i++)if(s[i].callback===n&&(!r||r===s[i].context)){s.splice(i,1);return}}validateEventType_(e){O(this.allowedEvents_.find(n=>n===e),"Unknown event: "+e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class id extends sk{constructor(){super(["online"]),this.online_=!0,typeof window!="undefined"&&typeof window.addEventListener!="undefined"&&!of()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}static getInstance(){return new id}getInitialEvent(e){return O(e==="online","Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FI=32,UI=768;class Ae{constructor(e,n){if(n===void 0){this.pieces_=e.split("/");let r=0;for(let s=0;s<this.pieces_.length;s++)this.pieces_[s].length>0&&(this.pieces_[r]=this.pieces_[s],r++);this.pieces_.length=r,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=n}toString(){let e="";for(let n=this.pieceNum_;n<this.pieces_.length;n++)this.pieces_[n]!==""&&(e+="/"+this.pieces_[n]);return e||"/"}}function Te(){return new Ae("")}function pe(t){return t.pieceNum_>=t.pieces_.length?null:t.pieces_[t.pieceNum_]}function Ys(t){return t.pieces_.length-t.pieceNum_}function Le(t){let e=t.pieceNum_;return e<t.pieces_.length&&e++,new Ae(t.pieces_,e)}function Ty(t){return t.pieceNum_<t.pieces_.length?t.pieces_[t.pieces_.length-1]:null}function aH(t){let e="";for(let n=t.pieceNum_;n<t.pieces_.length;n++)t.pieces_[n]!==""&&(e+="/"+encodeURIComponent(String(t.pieces_[n])));return e||"/"}function Dl(t,e=0){return t.pieces_.slice(t.pieceNum_+e)}function ik(t){if(t.pieceNum_>=t.pieces_.length)return null;const e=[];for(let n=t.pieceNum_;n<t.pieces_.length-1;n++)e.push(t.pieces_[n]);return new Ae(e,0)}function ze(t,e){const n=[];for(let r=t.pieceNum_;r<t.pieces_.length;r++)n.push(t.pieces_[r]);if(e instanceof Ae)for(let r=e.pieceNum_;r<e.pieces_.length;r++)n.push(e.pieces_[r]);else{const r=e.split("/");for(let s=0;s<r.length;s++)r[s].length>0&&n.push(r[s])}return new Ae(n,0)}function ge(t){return t.pieceNum_>=t.pieces_.length}function un(t,e){const n=pe(t),r=pe(e);if(n===null)return e;if(n===r)return un(Le(t),Le(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+t+")")}function cH(t,e){const n=Dl(t,0),r=Dl(e,0);for(let s=0;s<n.length&&s<r.length;s++){const i=Ao(n[s],r[s]);if(i!==0)return i}return n.length===r.length?0:n.length<r.length?-1:1}function Sy(t,e){if(Ys(t)!==Ys(e))return!1;for(let n=t.pieceNum_,r=e.pieceNum_;n<=t.pieces_.length;n++,r++)if(t.pieces_[n]!==e.pieces_[r])return!1;return!0}function Bn(t,e){let n=t.pieceNum_,r=e.pieceNum_;if(Ys(t)>Ys(e))return!1;for(;n<t.pieces_.length;){if(t.pieces_[n]!==e.pieces_[r])return!1;++n,++r}return!0}class lH{constructor(e,n){this.errorPrefix_=n,this.parts_=Dl(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let r=0;r<this.parts_.length;r++)this.byteLength_+=cf(this.parts_[r]);ok(this)}}function uH(t,e){t.parts_.length>0&&(t.byteLength_+=1),t.parts_.push(e),t.byteLength_+=cf(e),ok(t)}function hH(t){const e=t.parts_.pop();t.byteLength_-=cf(e),t.parts_.length>0&&(t.byteLength_-=1)}function ok(t){if(t.byteLength_>UI)throw new Error(t.errorPrefix_+"has a key path longer than "+UI+" bytes ("+t.byteLength_+").");if(t.parts_.length>FI)throw new Error(t.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+FI+") or object contains a cycle "+Si(t))}function Si(t){return t.parts_.length===0?"":"in property '"+t.parts_.join(".")+"'"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cy extends sk{constructor(){super(["visible"]);let e,n;typeof document!="undefined"&&typeof document.addEventListener!="undefined"&&(typeof document.hidden!="undefined"?(n="visibilitychange",e="hidden"):typeof document.mozHidden!="undefined"?(n="mozvisibilitychange",e="mozHidden"):typeof document.msHidden!="undefined"?(n="msvisibilitychange",e="msHidden"):typeof document.webkitHidden!="undefined"&&(n="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,n&&document.addEventListener(n,()=>{const r=!document[e];r!==this.visible_&&(this.visible_=r,this.trigger("visible",r))},!1)}static getInstance(){return new Cy}getInitialEvent(e){return O(e==="visible","Unknown event type: "+e),[this.visible_]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vc=1e3,dH=60*5*1e3,$I=30*1e3,fH=1.3,pH=3e4,gH="server_kill",VI=3;class rs extends rk{constructor(e,n,r,s,i,o,a,c){if(super(),this.repoInfo_=e,this.applicationId_=n,this.onDataUpdate_=r,this.onConnectStatus_=s,this.onServerInfoUpdate_=i,this.authTokenProvider_=o,this.appCheckTokenProvider_=a,this.authOverride_=c,this.id=rs.nextPersistentConnectionId_++,this.log_=vu("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=vc,this.maxReconnectDelay_=dH,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,c&&!x0())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");Cy.getInstance().on("visible",this.onVisible_,this),e.host.indexOf("fblocal")===-1&&id.getInstance().on("online",this.onOnline_,this)}sendRequest(e,n,r){const s=++this.requestNumber_,i={r:s,a:e,b:n};this.log_(_t(i)),O(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(i),r&&(this.requestCBHash_[s]=r)}get(e){this.initConnection_();const n=new mt,r={p:e._path.toString(),q:e._queryObject},s={action:"g",request:r,onComplete:o=>{const a=o.d;o.s==="ok"?n.resolve(a):n.reject(a)}};this.outstandingGets_.push(s),this.outstandingGetCount_++;const i=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(i),n.promise}listen(e,n,r,s){this.initConnection_();const i=e._queryIdentifier,o=e._path.toString();this.log_("Listen called for "+o+" "+i),this.listens.has(o)||this.listens.set(o,new Map),O(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"listen() called for non-default but complete query"),O(!this.listens.get(o).has(i),"listen() called twice for same path/queryId.");const a={onComplete:s,hashFn:n,query:e,tag:r};this.listens.get(o).set(i,a),this.connected_&&this.sendListen_(a)}sendGet_(e){const n=this.outstandingGets_[e];this.sendRequest("g",n.request,r=>{delete this.outstandingGets_[e],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),n.onComplete&&n.onComplete(r)})}sendListen_(e){const n=e.query,r=n._path.toString(),s=n._queryIdentifier;this.log_("Listen on "+r+" for "+s);const i={p:r},o="q";e.tag&&(i.q=n._queryObject,i.t=e.tag),i.h=e.hashFn(),this.sendRequest(o,i,a=>{const c=a.d,l=a.s;rs.warnOnListenWarnings_(c,n),(this.listens.get(r)&&this.listens.get(r).get(s))===e&&(this.log_("listen response",a),l!=="ok"&&this.removeListen_(r,s),e.onComplete&&e.onComplete(l,c))})}static warnOnListenWarnings_(e,n){if(e&&typeof e=="object"&&xn(e,"w")){const r=Yi(e,"w");if(Array.isArray(r)&&~r.indexOf("no_index")){const s='".indexOn": "'+n._queryParams.getIndex().toString()+'"',i=n._path.toString();Xt(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${s} at ${i} to your security rules for better performance.`)}}}refreshAuthToken(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(e)}reduceReconnectDelayIfAdminCredential_(e){(e&&e.length===40||qL(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=$I)}refreshAppCheckToken(e){this.appCheckToken_=e,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){const e=this.authToken_,n=BL(e)?"auth":"gauth",r={cred:e};this.authOverride_===null?r.noauth=!0:typeof this.authOverride_=="object"&&(r.authvar=this.authOverride_),this.sendRequest(n,r,s=>{const i=s.s,o=s.d||"error";this.authToken_===e&&(i==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(i,o))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},e=>{const n=e.s,r=e.d||"error";n==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(n,r)})}unlisten(e,n){const r=e._path.toString(),s=e._queryIdentifier;this.log_("Unlisten called for "+r+" "+s),O(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(r,s)&&this.connected_&&this.sendUnlisten_(r,s,e._queryObject,n)}sendUnlisten_(e,n,r,s){this.log_("Unlisten on "+e+" for "+n);const i={p:e},o="n";s&&(i.q=r,i.t=s),this.sendRequest(o,i)}onDisconnectPut(e,n,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",e,n,r):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:n,onComplete:r})}onDisconnectMerge(e,n,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",e,n,r):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:n,onComplete:r})}onDisconnectCancel(e,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",e,null,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:n})}sendOnDisconnect_(e,n,r,s){const i={p:n,d:r};this.log_("onDisconnect "+e,i),this.sendRequest(e,i,o=>{s&&setTimeout(()=>{s(o.s,o.d)},Math.floor(0))})}put(e,n,r,s){this.putInternal("p",e,n,r,s)}merge(e,n,r,s){this.putInternal("m",e,n,r,s)}putInternal(e,n,r,s,i){this.initConnection_();const o={p:n,d:r};i!==void 0&&(o.h=i),this.outstandingPuts_.push({action:e,request:o,onComplete:s}),this.outstandingPutCount_++;const a=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(a):this.log_("Buffering put: "+n)}sendPut_(e){const n=this.outstandingPuts_[e].action,r=this.outstandingPuts_[e].request,s=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(n,r,i=>{this.log_(n+" response",i),delete this.outstandingPuts_[e],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),s&&s(i.s,i.d)})}reportStats(e){if(this.connected_){const n={c:e};this.log_("reportStats",n),this.sendRequest("s",n,r=>{if(r.s!=="ok"){const i=r.d;this.log_("reportStats","Error sending stats: "+i)}})}}onDataMessage_(e){if("r"in e){this.log_("from server: "+_t(e));const n=e.r,r=this.requestCBHash_[n];r&&(delete this.requestCBHash_[n],r(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}}onDataPush_(e,n){this.log_("handleServerMessage",e,n),e==="d"?this.onDataUpdate_(n.p,n.d,!1,n.t):e==="m"?this.onDataUpdate_(n.p,n.d,!0,n.t):e==="c"?this.onListenRevoked_(n.p,n.q):e==="ac"?this.onAuthRevoked_(n.s,n.d):e==="apc"?this.onAppCheckRevoked_(n.s,n.d):e==="sd"?this.onSecurityDebugPacket_(n):fm("Unrecognized action received from server: "+_t(e)+`
Are you using the latest client?`)}onReady_(e,n){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(e),this.lastSessionId=n,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(e){O(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(e))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=vc,this.realtime_||this.scheduleConnect_(0)),this.visible_=e}onOnline_(e){e?(this.log_("Browser went online."),this.reconnectDelay_=vc,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>pH&&(this.reconnectDelay_=vc),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());const e=new Date().getTime()-this.lastConnectionAttemptTime_;let n=Math.max(0,this.reconnectDelay_-e);n=Math.random()*n,this.log_("Trying to reconnect in "+n+"ms"),this.scheduleConnect_(n),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*fH)}this.onConnectStatus_(!1)}async establishConnection_(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;const e=this.onDataMessage_.bind(this),n=this.onReady_.bind(this),r=this.onRealtimeDisconnect_.bind(this),s=this.id+":"+rs.nextConnectionId_++,i=this.lastSessionId;let o=!1,a=null;const c=function(){a?a.close():(o=!0,r())},l=function(h){O(a,"sendRequest call when we're not connected not allowed."),a.sendRequest(h)};this.realtime_={close:c,sendRequest:l};const u=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{const[h,d]=await Promise.all([this.authTokenProvider_.getToken(u),this.appCheckTokenProvider_.getToken(u)]);o?Ct("getToken() completed but was canceled"):(Ct("getToken() completed. Creating connection."),this.authToken_=h&&h.accessToken,this.appCheckToken_=d&&d.token,a=new oH(s,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,e,n,r,f=>{Xt(f+" ("+this.repoInfo_.toString()+")"),this.interrupt(gH)},i))}catch(h){this.log_("Failed to get token: "+h),o||(this.repoInfo_.nodeAdmin&&Xt(h),c())}}}interrupt(e){Ct("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(e){Ct("Resuming connection for reason: "+e),delete this.interruptReasons_[e],Kh(this.interruptReasons_)&&(this.reconnectDelay_=vc,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(e){const n=e-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:n})}cancelSentTransactions_(){for(let e=0;e<this.outstandingPuts_.length;e++){const n=this.outstandingPuts_[e];n&&"h"in n.request&&n.queued&&(n.onComplete&&n.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(e,n){let r;n?r=n.map(i=>vy(i)).join("$"):r="default";const s=this.removeListen_(e,r);s&&s.onComplete&&s.onComplete("permission_denied")}removeListen_(e,n){const r=new Ae(e).toString();let s;if(this.listens.has(r)){const i=this.listens.get(r);s=i.get(n),i.delete(n),i.size===0&&this.listens.delete(r)}else s=void 0;return s}onAuthRevoked_(e,n){Ct("Auth token revoked: "+e+"/"+n),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(e==="invalid_token"||e==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=VI&&(this.reconnectDelay_=$I,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(e,n){Ct("App check token revoked: "+e+"/"+n),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(e==="invalid_token"||e==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=VI&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const e of this.listens.values())for(const n of e.values())this.sendListen_(n);for(let e=0;e<this.outstandingPuts_.length;e++)this.outstandingPuts_[e]&&this.sendPut_(e);for(;this.onDisconnectRequestQueue_.length;){const e=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(e.action,e.pathString,e.data,e.onComplete)}for(let e=0;e<this.outstandingGets_.length;e++)this.outstandingGets_[e]&&this.sendGet_(e)}sendConnectStats_(){const e={};let n="js";e["sdk."+n+"."+DA.replace(/\./g,"-")]=1,of()?e["framework.cordova"]=1:hu()&&(e["framework.reactnative"]=1),this.reportStats(e)}shouldReconnect_(){const e=id.getInstance().currentlyOnline();return Kh(this.interruptReasons_)&&e}}rs.nextPersistentConnectionId_=0;rs.nextConnectionId_=0;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class me{constructor(e,n){this.name=e,this.node=n}static Wrap(e,n){return new me(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sf{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,n){const r=new me(cs,e),s=new me(cs,n);return this.compare(r,s)!==0}minPost(){return me.MIN}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let rh;class ak extends Sf{static get __EMPTY_NODE(){return rh}static set __EMPTY_NODE(e){rh=e}compare(e,n){return Ao(e.name,n.name)}isDefinedOn(e){throw Ha("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,n){return!1}minPost(){return me.MIN}maxPost(){return new me(Mr,rh)}makePost(e,n){return O(typeof e=="string","KeyIndex indexValue must always be a string."),new me(e,rh)}toString(){return".key"}}const Ar=new ak;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sh{constructor(e,n,r,s,i=null){this.isReverse_=s,this.resultGenerator_=i,this.nodeStack_=[];let o=1;for(;!e.isEmpty();)if(e=e,o=n?r(e.key,n):1,s&&(o*=-1),o<0)this.isReverse_?e=e.left:e=e.right;else if(o===0){this.nodeStack_.push(e);break}else this.nodeStack_.push(e),this.isReverse_?e=e.right:e=e.left}getNext(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_.pop(),n;if(this.resultGenerator_?n=this.resultGenerator_(e.key,e.value):n={key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return n}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;const e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}}class Tt{constructor(e,n,r,s,i){this.key=e,this.value=n,this.color=r!=null?r:Tt.RED,this.left=s!=null?s:yn.EMPTY_NODE,this.right=i!=null?i:yn.EMPTY_NODE}copy(e,n,r,s,i){return new Tt(e!=null?e:this.key,n!=null?n:this.value,r!=null?r:this.color,s!=null?s:this.left,i!=null?i:this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let s=this;const i=r(e,s.key);return i<0?s=s.copy(null,null,null,s.left.insert(e,n,r),null):i===0?s=s.copy(null,n,null,null,null):s=s.copy(null,null,null,null,s.right.insert(e,n,r)),s.fixUp_()}removeMin_(){if(this.left.isEmpty())return yn.EMPTY_NODE;let e=this;return!e.left.isRed_()&&!e.left.left.isRed_()&&(e=e.moveRedLeft_()),e=e.copy(null,null,null,e.left.removeMin_(),null),e.fixUp_()}remove(e,n){let r,s;if(r=this,n(e,r.key)<0)!r.left.isEmpty()&&!r.left.isRed_()&&!r.left.left.isRed_()&&(r=r.moveRedLeft_()),r=r.copy(null,null,null,r.left.remove(e,n),null);else{if(r.left.isRed_()&&(r=r.rotateRight_()),!r.right.isEmpty()&&!r.right.isRed_()&&!r.right.left.isRed_()&&(r=r.moveRedRight_()),n(e,r.key)===0){if(r.right.isEmpty())return yn.EMPTY_NODE;s=r.right.min_(),r=r.copy(s.key,s.value,null,null,r.right.removeMin_())}r=r.copy(null,null,null,null,r.right.remove(e,n))}return r.fixUp_()}isRed_(){return this.color}fixUp_(){let e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e}moveRedLeft_(){let e=this.colorFlip_();return e.right.left.isRed_()&&(e=e.copy(null,null,null,null,e.right.rotateRight_()),e=e.rotateLeft_(),e=e.colorFlip_()),e}moveRedRight_(){let e=this.colorFlip_();return e.left.left.isRed_()&&(e=e.rotateRight_(),e=e.colorFlip_()),e}rotateLeft_(){const e=this.copy(null,null,Tt.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight_(){const e=this.copy(null,null,Tt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip_(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth_(){const e=this.check_();return Math.pow(2,e)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)}}Tt.RED=!0;Tt.BLACK=!1;class mH{copy(e,n,r,s,i){return this}insert(e,n,r){return new Tt(e,n,null)}remove(e,n){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}}class yn{constructor(e,n=yn.EMPTY_NODE){this.comparator_=e,this.root_=n}insert(e,n){return new yn(this.comparator_,this.root_.insert(e,n,this.comparator_).copy(null,null,Tt.BLACK,null,null))}remove(e){return new yn(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,Tt.BLACK,null,null))}get(e){let n,r=this.root_;for(;!r.isEmpty();){if(n=this.comparator_(e,r.key),n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}getPredecessorKey(e){let n,r=this.root_,s=null;for(;!r.isEmpty();)if(n=this.comparator_(e,r.key),n===0){if(r.left.isEmpty())return s?s.key:null;for(r=r.left;!r.right.isEmpty();)r=r.right;return r.key}else n<0?r=r.left:n>0&&(s=r,r=r.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new sh(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,n){return new sh(this.root_,e,this.comparator_,!1,n)}getReverseIteratorFrom(e,n){return new sh(this.root_,e,this.comparator_,!0,n)}getReverseIterator(e){return new sh(this.root_,null,this.comparator_,!0,e)}}yn.EMPTY_NODE=new mH;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _H(t,e){return Ao(t.name,e.name)}function Ay(t,e){return Ao(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let gm;function yH(t){gm=t}const ck=function(t){return typeof t=="number"?"number:"+$A(t):"string:"+t},lk=function(t){if(t.isLeafNode()){const e=t.val();O(typeof e=="string"||typeof e=="number"||typeof e=="object"&&xn(e,".sv"),"Priority must be a string or number.")}else O(t===gm||t.isEmpty(),"priority of unexpected type.");O(t===gm||t.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let BI;class bt{constructor(e,n=bt.__childrenNodeConstructor.EMPTY_NODE){this.value_=e,this.priorityNode_=n,this.lazyHash_=null,O(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),lk(this.priorityNode_)}static set __childrenNodeConstructor(e){BI=e}static get __childrenNodeConstructor(){return BI}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(e){return new bt(this.value_,e)}getImmediateChild(e){return e===".priority"?this.priorityNode_:bt.__childrenNodeConstructor.EMPTY_NODE}getChild(e){return ge(e)?this:pe(e)===".priority"?this.priorityNode_:bt.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(e,n){return null}updateImmediateChild(e,n){return e===".priority"?this.updatePriority(n):n.isEmpty()&&e!==".priority"?this:bt.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,n).updatePriority(this.priorityNode_)}updateChild(e,n){const r=pe(e);return r===null?n:n.isEmpty()&&r!==".priority"?this:(O(r!==".priority"||Ys(e)===1,".priority must be the last token in a path"),this.updateImmediateChild(r,bt.__childrenNodeConstructor.EMPTY_NODE.updateChild(Le(e),n)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(e,n){return!1}val(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let e="";this.priorityNode_.isEmpty()||(e+="priority:"+ck(this.priorityNode_.val())+":");const n=typeof this.value_;e+=n+":",n==="number"?e+=$A(this.value_):e+=this.value_,this.lazyHash_=LA(e)}return this.lazyHash_}getValue(){return this.value_}compareTo(e){return e===bt.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof bt.__childrenNodeConstructor?-1:(O(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))}compareToLeafNode_(e){const n=typeof e.value_,r=typeof this.value_,s=bt.VALUE_TYPE_ORDER.indexOf(n),i=bt.VALUE_TYPE_ORDER.indexOf(r);return O(s>=0,"Unknown leaf type: "+n),O(i>=0,"Unknown leaf type: "+r),s===i?r==="object"?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:i-s}withIndex(){return this}isIndexed(){return!0}equals(e){if(e===this)return!0;if(e.isLeafNode()){const n=e;return this.value_===n.value_&&this.priorityNode_.equals(n.priorityNode_)}else return!1}}bt.VALUE_TYPE_ORDER=["object","boolean","number","string"];/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let uk,hk;function vH(t){uk=t}function wH(t){hk=t}class bH extends Sf{compare(e,n){const r=e.node.getPriority(),s=n.node.getPriority(),i=r.compareTo(s);return i===0?Ao(e.name,n.name):i}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,n){return!e.getPriority().equals(n.getPriority())}minPost(){return me.MIN}maxPost(){return new me(Mr,new bt("[PRIORITY-POST]",hk))}makePost(e,n){const r=uk(e);return new me(n,new bt("[PRIORITY-POST]",r))}toString(){return".priority"}}const qe=new bH;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IH=Math.log(2);class EH{constructor(e){const n=i=>parseInt(Math.log(i)/IH,10),r=i=>parseInt(Array(i+1).join("1"),2);this.count=n(e+1),this.current_=this.count-1;const s=r(this.count);this.bits_=e+1&s}nextBitIsOne(){const e=!(this.bits_&1<<this.current_);return this.current_--,e}}const od=function(t,e,n,r){t.sort(e);const s=function(c,l){const u=l-c;let h,d;if(u===0)return null;if(u===1)return h=t[c],d=n?n(h):h,new Tt(d,h.node,Tt.BLACK,null,null);{const f=parseInt(u/2,10)+c,p=s(c,f),_=s(f+1,l);return h=t[f],d=n?n(h):h,new Tt(d,h.node,Tt.BLACK,p,_)}},i=function(c){let l=null,u=null,h=t.length;const d=function(p,_){const y=h-p,T=h;h-=p;const I=s(y+1,T),E=t[y],S=n?n(E):E;f(new Tt(S,E.node,_,null,I))},f=function(p){l?(l.left=p,l=p):(u=p,l=p)};for(let p=0;p<c.count;++p){const _=c.nextBitIsOne(),y=Math.pow(2,c.count-(p+1));_?d(y,Tt.BLACK):(d(y,Tt.BLACK),d(y,Tt.RED))}return u},o=new EH(t.length),a=i(o);return new yn(r||e,a)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Zp;const Vo={};class Jr{constructor(e,n){this.indexes_=e,this.indexSet_=n}static get Default(){return O(Vo&&qe,"ChildrenNode.ts has not been loaded"),Zp=Zp||new Jr({".priority":Vo},{".priority":qe}),Zp}get(e){const n=Yi(this.indexes_,e);if(!n)throw new Error("No index defined for "+e);return n instanceof yn?n:null}hasIndex(e){return xn(this.indexSet_,e.toString())}addIndex(e,n){O(e!==Ar,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const r=[];let s=!1;const i=n.getIterator(me.Wrap);let o=i.getNext();for(;o;)s=s||e.isDefinedOn(o.node),r.push(o),o=i.getNext();let a;s?a=od(r,e.getCompare()):a=Vo;const c=e.toString(),l=Object.assign({},this.indexSet_);l[c]=e;const u=Object.assign({},this.indexes_);return u[c]=a,new Jr(u,l)}addToIndexes(e,n){const r=Hh(this.indexes_,(s,i)=>{const o=Yi(this.indexSet_,i);if(O(o,"Missing index implementation for "+i),s===Vo)if(o.isDefinedOn(e.node)){const a=[],c=n.getIterator(me.Wrap);let l=c.getNext();for(;l;)l.name!==e.name&&a.push(l),l=c.getNext();return a.push(e),od(a,o.getCompare())}else return Vo;else{const a=n.get(e.name);let c=s;return a&&(c=c.remove(new me(e.name,a))),c.insert(e,e.node)}});return new Jr(r,this.indexSet_)}removeFromIndexes(e,n){const r=Hh(this.indexes_,s=>{if(s===Vo)return s;{const i=n.get(e.name);return i?s.remove(new me(e.name,i)):s}});return new Jr(r,this.indexSet_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let wc;class te{constructor(e,n,r){this.children_=e,this.priorityNode_=n,this.indexMap_=r,this.lazyHash_=null,this.priorityNode_&&lk(this.priorityNode_),this.children_.isEmpty()&&O(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return wc||(wc=new te(new yn(Ay),null,Jr.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||wc}updatePriority(e){return this.children_.isEmpty()?this:new te(this.children_,e,this.indexMap_)}getImmediateChild(e){if(e===".priority")return this.getPriority();{const n=this.children_.get(e);return n===null?wc:n}}getChild(e){const n=pe(e);return n===null?this:this.getImmediateChild(n).getChild(Le(e))}hasChild(e){return this.children_.get(e)!==null}updateImmediateChild(e,n){if(O(n,"We should always be passing snapshot nodes"),e===".priority")return this.updatePriority(n);{const r=new me(e,n);let s,i;n.isEmpty()?(s=this.children_.remove(e),i=this.indexMap_.removeFromIndexes(r,this.children_)):(s=this.children_.insert(e,n),i=this.indexMap_.addToIndexes(r,this.children_));const o=s.isEmpty()?wc:this.priorityNode_;return new te(s,o,i)}}updateChild(e,n){const r=pe(e);if(r===null)return n;{O(pe(e)!==".priority"||Ys(e)===1,".priority must be the last token in a path");const s=this.getImmediateChild(r).updateChild(Le(e),n);return this.updateImmediateChild(r,s)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(e){if(this.isEmpty())return null;const n={};let r=0,s=0,i=!0;if(this.forEachChild(qe,(o,a)=>{n[o]=a.val(e),r++,i&&te.INTEGER_REGEXP_.test(o)?s=Math.max(s,Number(o)):i=!1}),!e&&i&&s<2*r){const o=[];for(const a in n)o[a]=n[a];return o}else return e&&!this.getPriority().isEmpty()&&(n[".priority"]=this.getPriority().val()),n}hash(){if(this.lazyHash_===null){let e="";this.getPriority().isEmpty()||(e+="priority:"+ck(this.getPriority().val())+":"),this.forEachChild(qe,(n,r)=>{const s=r.hash();s!==""&&(e+=":"+n+":"+s)}),this.lazyHash_=e===""?"":LA(e)}return this.lazyHash_}getPredecessorChildName(e,n,r){const s=this.resolveIndex_(r);if(s){const i=s.getPredecessorKey(new me(e,n));return i?i.name:null}else return this.children_.getPredecessorKey(e)}getFirstChildName(e){const n=this.resolveIndex_(e);if(n){const r=n.minKey();return r&&r.name}else return this.children_.minKey()}getFirstChild(e){const n=this.getFirstChildName(e);return n?new me(n,this.children_.get(n)):null}getLastChildName(e){const n=this.resolveIndex_(e);if(n){const r=n.maxKey();return r&&r.name}else return this.children_.maxKey()}getLastChild(e){const n=this.getLastChildName(e);return n?new me(n,this.children_.get(n)):null}forEachChild(e,n){const r=this.resolveIndex_(e);return r?r.inorderTraversal(s=>n(s.name,s.node)):this.children_.inorderTraversal(n)}getIterator(e){return this.getIteratorFrom(e.minPost(),e)}getIteratorFrom(e,n){const r=this.resolveIndex_(n);if(r)return r.getIteratorFrom(e,s=>s);{const s=this.children_.getIteratorFrom(e.name,me.Wrap);let i=s.peek();for(;i!=null&&n.compare(i,e)<0;)s.getNext(),i=s.peek();return s}}getReverseIterator(e){return this.getReverseIteratorFrom(e.maxPost(),e)}getReverseIteratorFrom(e,n){const r=this.resolveIndex_(n);if(r)return r.getReverseIteratorFrom(e,s=>s);{const s=this.children_.getReverseIteratorFrom(e.name,me.Wrap);let i=s.peek();for(;i!=null&&n.compare(i,e)>0;)s.getNext(),i=s.peek();return s}}compareTo(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===wu?-1:0}withIndex(e){if(e===Ar||this.indexMap_.hasIndex(e))return this;{const n=this.indexMap_.addIndex(e,this.children_);return new te(this.children_,this.priorityNode_,n)}}isIndexed(e){return e===Ar||this.indexMap_.hasIndex(e)}equals(e){if(e===this)return!0;if(e.isLeafNode())return!1;{const n=e;if(this.getPriority().equals(n.getPriority()))if(this.children_.count()===n.children_.count()){const r=this.getIterator(qe),s=n.getIterator(qe);let i=r.getNext(),o=s.getNext();for(;i&&o;){if(i.name!==o.name||!i.node.equals(o.node))return!1;i=r.getNext(),o=s.getNext()}return i===null&&o===null}else return!1;else return!1}}resolveIndex_(e){return e===Ar?null:this.indexMap_.get(e.toString())}}te.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;class TH extends te{constructor(){super(new yn(Ay),te.EMPTY_NODE,Jr.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return te.EMPTY_NODE}isEmpty(){return!1}}const wu=new TH;Object.defineProperties(me,{MIN:{value:new me(cs,te.EMPTY_NODE)},MAX:{value:new me(Mr,wu)}});ak.__EMPTY_NODE=te.EMPTY_NODE;bt.__childrenNodeConstructor=te;yH(wu);wH(wu);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SH=!0;function Je(t,e=null){if(t===null)return te.EMPTY_NODE;if(typeof t=="object"&&".priority"in t&&(e=t[".priority"]),O(e===null||typeof e=="string"||typeof e=="number"||typeof e=="object"&&".sv"in e,"Invalid priority type found: "+typeof e),typeof t=="object"&&".value"in t&&t[".value"]!==null&&(t=t[".value"]),typeof t!="object"||".sv"in t){const n=t;return new bt(n,Je(e))}if(!(t instanceof Array)&&SH){const n=[];let r=!1;if(xt(t,(o,a)=>{if(o.substring(0,1)!=="."){const c=Je(a);c.isEmpty()||(r=r||!c.getPriority().isEmpty(),n.push(new me(o,c)))}}),n.length===0)return te.EMPTY_NODE;const i=od(n,_H,o=>o.name,Ay);if(r){const o=od(n,qe.getCompare());return new te(i,Je(e),new Jr({".priority":o},{".priority":qe}))}else return new te(i,Je(e),Jr.Default)}else{let n=te.EMPTY_NODE;return xt(t,(r,s)=>{if(xn(t,r)&&r.substring(0,1)!=="."){const i=Je(s);(i.isLeafNode()||!i.isEmpty())&&(n=n.updateImmediateChild(r,i))}}),n.updatePriority(Je(e))}}vH(Je);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ky extends Sf{constructor(e){super(),this.indexPath_=e,O(!ge(e)&&pe(e)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,n){const r=this.extractChild(e.node),s=this.extractChild(n.node),i=r.compareTo(s);return i===0?Ao(e.name,n.name):i}makePost(e,n){const r=Je(e),s=te.EMPTY_NODE.updateChild(this.indexPath_,r);return new me(n,s)}maxPost(){const e=te.EMPTY_NODE.updateChild(this.indexPath_,wu);return new me(Mr,e)}toString(){return Dl(this.indexPath_,0).join("/")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CH extends Sf{compare(e,n){const r=e.node.compareTo(n.node);return r===0?Ao(e.name,n.name):r}isDefinedOn(e){return!0}indexedValueChanged(e,n){return!e.equals(n)}minPost(){return me.MIN}maxPost(){return me.MAX}makePost(e,n){const r=Je(e);return new me(n,r)}toString(){return".value"}}const Ry=new CH;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sa="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",mm="-",dk="z",fk=786,AH=function(){let t=0;const e=[];return function(n){const r=n===t;t=n;let s;const i=new Array(8);for(s=7;s>=0;s--)i[s]=Sa.charAt(n%64),n=Math.floor(n/64);O(n===0,"Cannot push at time == 0");let o=i.join("");if(r){for(s=11;s>=0&&e[s]===63;s--)e[s]=0;e[s]++}else for(s=0;s<12;s++)e[s]=Math.floor(Math.random()*64);for(s=0;s<12;s++)o+=Sa.charAt(e[s]);return O(o.length===20,"nextPushId: Length should be 20."),o}}(),qI=function(t){if(t===""+wy)return mm;const e=rd(t);if(e!=null)return""+(e+1);const n=new Array(t.length);for(let o=0;o<n.length;o++)n[o]=t.charAt(o);if(n.length<fk)return n.push(mm),n.join("");let r=n.length-1;for(;r>=0&&n[r]===dk;)r--;if(r===-1)return Mr;const s=n[r],i=Sa.charAt(Sa.indexOf(s)+1);return n[r]=i,n.slice(0,r+1).join("")},jI=function(t){if(t===""+VA)return cs;const e=rd(t);if(e!=null)return""+(e-1);const n=new Array(t.length);for(let r=0;r<n.length;r++)n[r]=t.charAt(r);return n[n.length-1]===mm?n.length===1?""+wy:(delete n[n.length-1],n.join("")):(n[n.length-1]=Sa.charAt(Sa.indexOf(n[n.length-1])-1),n.join("")+dk.repeat(fk-n.length))};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pk(t){return{type:"value",snapshotNode:t}}function Ca(t,e){return{type:"child_added",snapshotNode:e,childName:t}}function xl(t,e){return{type:"child_removed",snapshotNode:e,childName:t}}function Ol(t,e,n){return{type:"child_changed",snapshotNode:e,childName:t,oldSnap:n}}function kH(t,e){return{type:"child_moved",snapshotNode:e,childName:t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ny{constructor(e){this.index_=e}updateChild(e,n,r,s,i,o){O(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");const a=e.getImmediateChild(n);return a.getChild(s).equals(r.getChild(s))&&a.isEmpty()===r.isEmpty()||(o!=null&&(r.isEmpty()?e.hasChild(n)?o.trackChildChange(xl(n,a)):O(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):a.isEmpty()?o.trackChildChange(Ca(n,r)):o.trackChildChange(Ol(n,r,a))),e.isLeafNode()&&r.isEmpty())?e:e.updateImmediateChild(n,r).withIndex(this.index_)}updateFullNode(e,n,r){return r!=null&&(e.isLeafNode()||e.forEachChild(qe,(s,i)=>{n.hasChild(s)||r.trackChildChange(xl(s,i))}),n.isLeafNode()||n.forEachChild(qe,(s,i)=>{if(e.hasChild(s)){const o=e.getImmediateChild(s);o.equals(i)||r.trackChildChange(Ol(s,i,o))}else r.trackChildChange(Ca(s,i))})),n.withIndex(this.index_)}updatePriority(e,n){return e.isEmpty()?te.EMPTY_NODE:e.updatePriority(n)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ml{constructor(e){this.indexedFilter_=new Ny(e.getIndex()),this.index_=e.getIndex(),this.startPost_=Ml.getStartPost_(e),this.endPost_=Ml.getEndPost_(e)}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){return this.index_.compare(this.getStartPost(),e)<=0&&this.index_.compare(e,this.getEndPost())<=0}updateChild(e,n,r,s,i,o){return this.matches(new me(n,r))||(r=te.EMPTY_NODE),this.indexedFilter_.updateChild(e,n,r,s,i,o)}updateFullNode(e,n,r){n.isLeafNode()&&(n=te.EMPTY_NODE);let s=n.withIndex(this.index_);s=s.updatePriority(te.EMPTY_NODE);const i=this;return n.forEachChild(qe,(o,a)=>{i.matches(new me(o,a))||(s=s.updateImmediateChild(o,te.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,s,r)}updatePriority(e,n){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){const n=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),n)}else return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){const n=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),n)}else return e.getIndex().maxPost()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RH{constructor(e){this.rangedFilter_=new Ml(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft()}updateChild(e,n,r,s,i,o){return this.rangedFilter_.matches(new me(n,r))||(r=te.EMPTY_NODE),e.getImmediateChild(n).equals(r)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,n,r,s,i,o):this.fullLimitUpdateChild_(e,n,r,i,o)}updateFullNode(e,n,r){let s;if(n.isLeafNode()||n.isEmpty())s=te.EMPTY_NODE.withIndex(this.index_);else if(this.limit_*2<n.numChildren()&&n.isIndexed(this.index_)){s=te.EMPTY_NODE.withIndex(this.index_);let i;this.reverse_?i=n.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):i=n.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let o=0;for(;i.hasNext()&&o<this.limit_;){const a=i.getNext();let c;if(this.reverse_?c=this.index_.compare(this.rangedFilter_.getStartPost(),a)<=0:c=this.index_.compare(a,this.rangedFilter_.getEndPost())<=0,c)s=s.updateImmediateChild(a.name,a.node),o++;else break}}else{s=n.withIndex(this.index_),s=s.updatePriority(te.EMPTY_NODE);let i,o,a,c;if(this.reverse_){c=s.getReverseIterator(this.index_),i=this.rangedFilter_.getEndPost(),o=this.rangedFilter_.getStartPost();const h=this.index_.getCompare();a=(d,f)=>h(f,d)}else c=s.getIterator(this.index_),i=this.rangedFilter_.getStartPost(),o=this.rangedFilter_.getEndPost(),a=this.index_.getCompare();let l=0,u=!1;for(;c.hasNext();){const h=c.getNext();!u&&a(i,h)<=0&&(u=!0),u&&l<this.limit_&&a(h,o)<=0?l++:s=s.updateImmediateChild(h.name,te.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,s,r)}updatePriority(e,n){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,n,r,s,i){let o;if(this.reverse_){const h=this.index_.getCompare();o=(d,f)=>h(f,d)}else o=this.index_.getCompare();const a=e;O(a.numChildren()===this.limit_,"");const c=new me(n,r),l=this.reverse_?a.getFirstChild(this.index_):a.getLastChild(this.index_),u=this.rangedFilter_.matches(c);if(a.hasChild(n)){const h=a.getImmediateChild(n);let d=s.getChildAfterChild(this.index_,l,this.reverse_);for(;d!=null&&(d.name===n||a.hasChild(d.name));)d=s.getChildAfterChild(this.index_,d,this.reverse_);const f=d==null?1:o(d,c);if(u&&!r.isEmpty()&&f>=0)return i!=null&&i.trackChildChange(Ol(n,r,h)),a.updateImmediateChild(n,r);{i!=null&&i.trackChildChange(xl(n,h));const _=a.updateImmediateChild(n,te.EMPTY_NODE);return d!=null&&this.rangedFilter_.matches(d)?(i!=null&&i.trackChildChange(Ca(d.name,d.node)),_.updateImmediateChild(d.name,d.node)):_}}else return r.isEmpty()?e:u&&o(l,c)>=0?(i!=null&&(i.trackChildChange(xl(l.name,l.node)),i.trackChildChange(Ca(n,r))),a.updateImmediateChild(n,r).updateImmediateChild(l.name,te.EMPTY_NODE)):e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cf{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=qe}hasStart(){return this.startSet_}hasStartAfter(){return this.startAfterSet_}hasEndBefore(){return this.endBeforeSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return O(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return O(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:cs}hasEnd(){return this.endSet_}getIndexEndValue(){return O(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return O(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:Mr}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return O(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===qe}copy(){const e=new Cf;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}}function NH(t){return t.loadsAllData()?new Ny(t.getIndex()):t.hasLimit()?new RH(t):new Ml(t)}function PH(t,e){const n=t.copy();return n.limitSet_=!0,n.limit_=e,n.viewFrom_="l",n}function DH(t,e){const n=t.copy();return n.limitSet_=!0,n.limit_=e,n.viewFrom_="r",n}function _m(t,e,n){const r=t.copy();return r.startSet_=!0,e===void 0&&(e=null),r.indexStartValue_=e,n!=null?(r.startNameSet_=!0,r.indexStartName_=n):(r.startNameSet_=!1,r.indexStartName_=""),r}function xH(t,e,n){let r;if(t.index_===Ar)typeof e=="string"&&(e=qI(e)),r=_m(t,e,n);else{let s;n==null?s=Mr:s=qI(n),r=_m(t,e,s)}return r.startAfterSet_=!0,r}function ym(t,e,n){const r=t.copy();return r.endSet_=!0,e===void 0&&(e=null),r.indexEndValue_=e,n!==void 0?(r.endNameSet_=!0,r.indexEndName_=n):(r.endNameSet_=!1,r.indexEndName_=""),r}function OH(t,e,n){let r,s;return t.index_===Ar?(typeof e=="string"&&(e=jI(e)),s=ym(t,e,n)):(n==null?r=cs:r=jI(n),s=ym(t,e,r)),s.endBeforeSet_=!0,s}function Af(t,e){const n=t.copy();return n.index_=e,n}function KI(t){const e={};if(t.isDefault())return e;let n;return t.index_===qe?n="$priority":t.index_===Ry?n="$value":t.index_===Ar?n="$key":(O(t.index_ instanceof ky,"Unrecognized index type!"),n=t.index_.toString()),e.orderBy=_t(n),t.startSet_&&(e.startAt=_t(t.indexStartValue_),t.startNameSet_&&(e.startAt+=","+_t(t.indexStartName_))),t.endSet_&&(e.endAt=_t(t.indexEndValue_),t.endNameSet_&&(e.endAt+=","+_t(t.indexEndName_))),t.limitSet_&&(t.isViewFromLeft()?e.limitToFirst=t.limit_:e.limitToLast=t.limit_),e}function HI(t){const e={};if(t.startSet_&&(e.sp=t.indexStartValue_,t.startNameSet_&&(e.sn=t.indexStartName_)),t.endSet_&&(e.ep=t.indexEndValue_,t.endNameSet_&&(e.en=t.indexEndName_)),t.limitSet_){e.l=t.limit_;let n=t.viewFrom_;n===""&&(t.isViewFromLeft()?n="l":n="r"),e.vf=n}return t.index_!==qe&&(e.i=t.index_.toString()),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ad extends rk{constructor(e,n,r,s){super(),this.repoInfo_=e,this.onDataUpdate_=n,this.authTokenProvider_=r,this.appCheckTokenProvider_=s,this.log_=vu("p:rest:"),this.listens_={}}reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,n){return n!==void 0?"tag$"+n:(O(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}listen(e,n,r,s){const i=e._path.toString();this.log_("Listen called for "+i+" "+e._queryIdentifier);const o=ad.getListenId_(e,r),a={};this.listens_[o]=a;const c=KI(e._queryParams);this.restRequest_(i+".json",c,(l,u)=>{let h=u;if(l===404&&(h=null,l=null),l===null&&this.onDataUpdate_(i,h,!1,r),Yi(this.listens_,o)===a){let d;l?l===401?d="permission_denied":d="rest_error:"+l:d="ok",s(d,null)}})}unlisten(e,n){const r=ad.getListenId_(e,n);delete this.listens_[r]}get(e){const n=KI(e._queryParams),r=e._path.toString(),s=new mt;return this.restRequest_(r+".json",n,(i,o)=>{let a=o;i===404&&(a=null,i=null),i===null?(this.onDataUpdate_(r,a,!1,null),s.resolve(a)):s.reject(new Error(a))}),s.promise}refreshAuthToken(e){}restRequest_(e,n={},r){return n.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([s,i])=>{s&&s.accessToken&&(n.auth=s.accessToken),i&&i.token&&(n.ac=i.token);const o=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+To(n);this.log_("Sending REST request for "+o);const a=new XMLHttpRequest;a.onreadystatechange=()=>{if(r&&a.readyState===4){this.log_("REST Response for "+o+" received. status:",a.status,"response:",a.responseText);let c=null;if(a.status>=200&&a.status<300){try{c=wl(a.responseText)}catch{Xt("Failed to parse JSON response for "+o+": "+a.responseText)}r(null,c)}else a.status!==401&&a.status!==404&&Xt("Got unsuccessful REST response for "+o+" Status: "+a.status),r(a.status);r=null}},a.open("GET",o,!0),a.send()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MH{constructor(){this.rootNode_=te.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,n){this.rootNode_=this.rootNode_.updateChild(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cd(){return{value:null,children:new Map}}function Xa(t,e,n){if(ge(e))t.value=n,t.children.clear();else if(t.value!==null)t.value=t.value.updateChild(e,n);else{const r=pe(e);t.children.has(r)||t.children.set(r,cd());const s=t.children.get(r);e=Le(e),Xa(s,e,n)}}function vm(t,e){if(ge(e))return t.value=null,t.children.clear(),!0;if(t.value!==null){if(t.value.isLeafNode())return!1;{const n=t.value;return t.value=null,n.forEachChild(qe,(r,s)=>{Xa(t,new Ae(r),s)}),vm(t,e)}}else if(t.children.size>0){const n=pe(e);return e=Le(e),t.children.has(n)&&vm(t.children.get(n),e)&&t.children.delete(n),t.children.size===0}else return!0}function wm(t,e,n){t.value!==null?n(e,t.value):LH(t,(r,s)=>{const i=new Ae(e.toString()+"/"+r);wm(s,i,n)})}function LH(t,e){t.children.forEach((n,r)=>{e(r,n)})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FH{constructor(e){this.collection_=e,this.last_=null}get(){const e=this.collection_.get(),n=Object.assign({},e);return this.last_&&xt(this.last_,(r,s)=>{n[r]=n[r]-s}),this.last_=e,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WI=10*1e3,UH=30*1e3,$H=5*60*1e3;class VH{constructor(e,n){this.server_=n,this.statsToReport_={},this.statsListener_=new FH(e);const r=WI+(UH-WI)*Math.random();Qc(this.reportStats_.bind(this),Math.floor(r))}reportStats_(){const e=this.statsListener_.get(),n={};let r=!1;xt(e,(s,i)=>{i>0&&xn(this.statsToReport_,s)&&(n[s]=i,r=!0)}),r&&this.server_.reportStats(n),Qc(this.reportStats_.bind(this),Math.floor(Math.random()*2*$H))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var sr;(function(t){t[t.OVERWRITE=0]="OVERWRITE",t[t.MERGE=1]="MERGE",t[t.ACK_USER_WRITE=2]="ACK_USER_WRITE",t[t.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"})(sr||(sr={}));function Py(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function Dy(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function xy(t){return{fromUser:!1,fromServer:!0,queryId:t,tagged:!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ld{constructor(e,n,r){this.path=e,this.affectedTree=n,this.revert=r,this.type=sr.ACK_USER_WRITE,this.source=Py()}operationForChild(e){if(ge(this.path)){if(this.affectedTree.value!=null)return O(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const n=this.affectedTree.subtree(new Ae(e));return new ld(Te(),n,this.revert)}}else return O(pe(this.path)===e,"operationForChild called for unrelated child."),new ld(Le(this.path),this.affectedTree,this.revert)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ll{constructor(e,n){this.source=e,this.path=n,this.type=sr.LISTEN_COMPLETE}operationForChild(e){return ge(this.path)?new Ll(this.source,Te()):new Ll(this.source,Le(this.path))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class no{constructor(e,n,r){this.source=e,this.path=n,this.snap=r,this.type=sr.OVERWRITE}operationForChild(e){return ge(this.path)?new no(this.source,Te(),this.snap.getImmediateChild(e)):new no(this.source,Le(this.path),this.snap)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Aa{constructor(e,n,r){this.source=e,this.path=n,this.children=r,this.type=sr.MERGE}operationForChild(e){if(ge(this.path)){const n=this.children.subtree(new Ae(e));return n.isEmpty()?null:n.value?new no(this.source,Te(),n.value):new Aa(this.source,Te(),n)}else return O(pe(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new Aa(this.source,Le(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Js{constructor(e,n,r){this.node_=e,this.fullyInitialized_=n,this.filtered_=r}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(ge(e))return this.isFullyInitialized()&&!this.filtered_;const n=pe(e);return this.isCompleteForChild(n)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BH{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}}function qH(t,e,n,r){const s=[],i=[];return e.forEach(o=>{o.type==="child_changed"&&t.index_.indexedValueChanged(o.oldSnap,o.snapshotNode)&&i.push(kH(o.childName,o.snapshotNode))}),bc(t,s,"child_removed",e,r,n),bc(t,s,"child_added",e,r,n),bc(t,s,"child_moved",i,r,n),bc(t,s,"child_changed",e,r,n),bc(t,s,"value",e,r,n),s}function bc(t,e,n,r,s,i){const o=r.filter(a=>a.type===n);o.sort((a,c)=>KH(t,a,c)),o.forEach(a=>{const c=jH(t,a,i);s.forEach(l=>{l.respondsTo(a.type)&&e.push(l.createEvent(c,t.query_))})})}function jH(t,e,n){return e.type==="value"||e.type==="child_removed"||(e.prevName=n.getPredecessorChildName(e.childName,e.snapshotNode,t.index_)),e}function KH(t,e,n){if(e.childName==null||n.childName==null)throw Ha("Should only compare child_ events.");const r=new me(e.childName,e.snapshotNode),s=new me(n.childName,n.snapshotNode);return t.index_.compare(r,s)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kf(t,e){return{eventCache:t,serverCache:e}}function Yc(t,e,n,r){return kf(new Js(e,n,r),t.serverCache)}function gk(t,e,n,r){return kf(t.eventCache,new Js(e,n,r))}function ud(t){return t.eventCache.isFullyInitialized()?t.eventCache.getNode():null}function ro(t){return t.serverCache.isFullyInitialized()?t.serverCache.getNode():null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let eg;const HH=()=>(eg||(eg=new yn(kK)),eg);class Ve{constructor(e,n=HH()){this.value=e,this.children=n}static fromObject(e){let n=new Ve(null);return xt(e,(r,s)=>{n=n.set(new Ae(r),s)}),n}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,n){if(this.value!=null&&n(this.value))return{path:Te(),value:this.value};if(ge(e))return null;{const r=pe(e),s=this.children.get(r);if(s!==null){const i=s.findRootMostMatchingPathAndValue(Le(e),n);return i!=null?{path:ze(new Ae(r),i.path),value:i.value}:null}else return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(ge(e))return this;{const n=pe(e),r=this.children.get(n);return r!==null?r.subtree(Le(e)):new Ve(null)}}set(e,n){if(ge(e))return new Ve(n,this.children);{const r=pe(e),i=(this.children.get(r)||new Ve(null)).set(Le(e),n),o=this.children.insert(r,i);return new Ve(this.value,o)}}remove(e){if(ge(e))return this.children.isEmpty()?new Ve(null):new Ve(null,this.children);{const n=pe(e),r=this.children.get(n);if(r){const s=r.remove(Le(e));let i;return s.isEmpty()?i=this.children.remove(n):i=this.children.insert(n,s),this.value===null&&i.isEmpty()?new Ve(null):new Ve(this.value,i)}else return this}}get(e){if(ge(e))return this.value;{const n=pe(e),r=this.children.get(n);return r?r.get(Le(e)):null}}setTree(e,n){if(ge(e))return n;{const r=pe(e),i=(this.children.get(r)||new Ve(null)).setTree(Le(e),n);let o;return i.isEmpty()?o=this.children.remove(r):o=this.children.insert(r,i),new Ve(this.value,o)}}fold(e){return this.fold_(Te(),e)}fold_(e,n){const r={};return this.children.inorderTraversal((s,i)=>{r[s]=i.fold_(ze(e,s),n)}),n(e,this.value,r)}findOnPath(e,n){return this.findOnPath_(e,Te(),n)}findOnPath_(e,n,r){const s=this.value?r(n,this.value):!1;if(s)return s;if(ge(e))return null;{const i=pe(e),o=this.children.get(i);return o?o.findOnPath_(Le(e),ze(n,i),r):null}}foreachOnPath(e,n){return this.foreachOnPath_(e,Te(),n)}foreachOnPath_(e,n,r){if(ge(e))return this;{this.value&&r(n,this.value);const s=pe(e),i=this.children.get(s);return i?i.foreachOnPath_(Le(e),ze(n,s),r):new Ve(null)}}foreach(e){this.foreach_(Te(),e)}foreach_(e,n){this.children.inorderTraversal((r,s)=>{s.foreach_(ze(e,r),n)}),this.value&&n(e,this.value)}foreachChild(e){this.children.inorderTraversal((n,r)=>{r.value&&e(n,r.value)})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lr{constructor(e){this.writeTree_=e}static empty(){return new lr(new Ve(null))}}function Jc(t,e,n){if(ge(e))return new lr(new Ve(n));{const r=t.writeTree_.findRootMostValueAndPath(e);if(r!=null){const s=r.path;let i=r.value;const o=un(s,e);return i=i.updateChild(o,n),new lr(t.writeTree_.set(s,i))}else{const s=new Ve(n),i=t.writeTree_.setTree(e,s);return new lr(i)}}}function bm(t,e,n){let r=t;return xt(n,(s,i)=>{r=Jc(r,ze(e,s),i)}),r}function GI(t,e){if(ge(e))return lr.empty();{const n=t.writeTree_.setTree(e,new Ve(null));return new lr(n)}}function Im(t,e){return ko(t,e)!=null}function ko(t,e){const n=t.writeTree_.findRootMostValueAndPath(e);return n!=null?t.writeTree_.get(n.path).getChild(un(n.path,e)):null}function zI(t){const e=[],n=t.writeTree_.value;return n!=null?n.isLeafNode()||n.forEachChild(qe,(r,s)=>{e.push(new me(r,s))}):t.writeTree_.children.inorderTraversal((r,s)=>{s.value!=null&&e.push(new me(r,s.value))}),e}function Bs(t,e){if(ge(e))return t;{const n=ko(t,e);return n!=null?new lr(new Ve(n)):new lr(t.writeTree_.subtree(e))}}function Em(t){return t.writeTree_.isEmpty()}function ka(t,e){return mk(Te(),t.writeTree_,e)}function mk(t,e,n){if(e.value!=null)return n.updateChild(t,e.value);{let r=null;return e.children.inorderTraversal((s,i)=>{s===".priority"?(O(i.value!==null,"Priority writes must always be leaf nodes"),r=i.value):n=mk(ze(t,s),i,n)}),!n.getChild(t).isEmpty()&&r!==null&&(n=n.updateChild(ze(t,".priority"),r)),n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rf(t,e){return wk(e,t)}function WH(t,e,n,r,s){O(r>t.lastWriteId,"Stacking an older write on top of newer ones"),s===void 0&&(s=!0),t.allWrites.push({path:e,snap:n,writeId:r,visible:s}),s&&(t.visibleWrites=Jc(t.visibleWrites,e,n)),t.lastWriteId=r}function GH(t,e,n,r){O(r>t.lastWriteId,"Stacking an older merge on top of newer ones"),t.allWrites.push({path:e,children:n,writeId:r,visible:!0}),t.visibleWrites=bm(t.visibleWrites,e,n),t.lastWriteId=r}function zH(t,e){for(let n=0;n<t.allWrites.length;n++){const r=t.allWrites[n];if(r.writeId===e)return r}return null}function QH(t,e){const n=t.allWrites.findIndex(a=>a.writeId===e);O(n>=0,"removeWrite called with nonexistent writeId.");const r=t.allWrites[n];t.allWrites.splice(n,1);let s=r.visible,i=!1,o=t.allWrites.length-1;for(;s&&o>=0;){const a=t.allWrites[o];a.visible&&(o>=n&&YH(a,r.path)?s=!1:Bn(r.path,a.path)&&(i=!0)),o--}if(s){if(i)return JH(t),!0;if(r.snap)t.visibleWrites=GI(t.visibleWrites,r.path);else{const a=r.children;xt(a,c=>{t.visibleWrites=GI(t.visibleWrites,ze(r.path,c))})}return!0}else return!1}function YH(t,e){if(t.snap)return Bn(t.path,e);for(const n in t.children)if(t.children.hasOwnProperty(n)&&Bn(ze(t.path,n),e))return!0;return!1}function JH(t){t.visibleWrites=_k(t.allWrites,XH,Te()),t.allWrites.length>0?t.lastWriteId=t.allWrites[t.allWrites.length-1].writeId:t.lastWriteId=-1}function XH(t){return t.visible}function _k(t,e,n){let r=lr.empty();for(let s=0;s<t.length;++s){const i=t[s];if(e(i)){const o=i.path;let a;if(i.snap)Bn(n,o)?(a=un(n,o),r=Jc(r,a,i.snap)):Bn(o,n)&&(a=un(o,n),r=Jc(r,Te(),i.snap.getChild(a)));else if(i.children){if(Bn(n,o))a=un(n,o),r=bm(r,a,i.children);else if(Bn(o,n))if(a=un(o,n),ge(a))r=bm(r,Te(),i.children);else{const c=Yi(i.children,pe(a));if(c){const l=c.getChild(Le(a));r=Jc(r,Te(),l)}}}else throw Ha("WriteRecord should have .snap or .children")}}return r}function yk(t,e,n,r,s){if(!r&&!s){const i=ko(t.visibleWrites,e);if(i!=null)return i;{const o=Bs(t.visibleWrites,e);if(Em(o))return n;if(n==null&&!Im(o,Te()))return null;{const a=n||te.EMPTY_NODE;return ka(o,a)}}}else{const i=Bs(t.visibleWrites,e);if(!s&&Em(i))return n;if(!s&&n==null&&!Im(i,Te()))return null;{const o=function(l){return(l.visible||s)&&(!r||!~r.indexOf(l.writeId))&&(Bn(l.path,e)||Bn(e,l.path))},a=_k(t.allWrites,o,e),c=n||te.EMPTY_NODE;return ka(a,c)}}}function ZH(t,e,n){let r=te.EMPTY_NODE;const s=ko(t.visibleWrites,e);if(s)return s.isLeafNode()||s.forEachChild(qe,(i,o)=>{r=r.updateImmediateChild(i,o)}),r;if(n){const i=Bs(t.visibleWrites,e);return n.forEachChild(qe,(o,a)=>{const c=ka(Bs(i,new Ae(o)),a);r=r.updateImmediateChild(o,c)}),zI(i).forEach(o=>{r=r.updateImmediateChild(o.name,o.node)}),r}else{const i=Bs(t.visibleWrites,e);return zI(i).forEach(o=>{r=r.updateImmediateChild(o.name,o.node)}),r}}function eW(t,e,n,r,s){O(r||s,"Either existingEventSnap or existingServerSnap must exist");const i=ze(e,n);if(Im(t.visibleWrites,i))return null;{const o=Bs(t.visibleWrites,i);return Em(o)?s.getChild(n):ka(o,s.getChild(n))}}function tW(t,e,n,r){const s=ze(e,n),i=ko(t.visibleWrites,s);if(i!=null)return i;if(r.isCompleteForChild(n)){const o=Bs(t.visibleWrites,s);return ka(o,r.getNode().getImmediateChild(n))}else return null}function nW(t,e){return ko(t.visibleWrites,e)}function rW(t,e,n,r,s,i,o){let a;const c=Bs(t.visibleWrites,e),l=ko(c,Te());if(l!=null)a=l;else if(n!=null)a=ka(c,n);else return[];if(a=a.withIndex(o),!a.isEmpty()&&!a.isLeafNode()){const u=[],h=o.getCompare(),d=i?a.getReverseIteratorFrom(r,o):a.getIteratorFrom(r,o);let f=d.getNext();for(;f&&u.length<s;)h(f,r)!==0&&u.push(f),f=d.getNext();return u}else return[]}function sW(){return{visibleWrites:lr.empty(),allWrites:[],lastWriteId:-1}}function hd(t,e,n,r){return yk(t.writeTree,t.treePath,e,n,r)}function Oy(t,e){return ZH(t.writeTree,t.treePath,e)}function QI(t,e,n,r){return eW(t.writeTree,t.treePath,e,n,r)}function dd(t,e){return nW(t.writeTree,ze(t.treePath,e))}function iW(t,e,n,r,s,i){return rW(t.writeTree,t.treePath,e,n,r,s,i)}function My(t,e,n){return tW(t.writeTree,t.treePath,e,n)}function vk(t,e){return wk(ze(t.treePath,e),t.writeTree)}function wk(t,e){return{treePath:t,writeTree:e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oW{constructor(){this.changeMap=new Map}trackChildChange(e){const n=e.type,r=e.childName;O(n==="child_added"||n==="child_changed"||n==="child_removed","Only child changes supported for tracking"),O(r!==".priority","Only non-priority child changes can be tracked.");const s=this.changeMap.get(r);if(s){const i=s.type;if(n==="child_added"&&i==="child_removed")this.changeMap.set(r,Ol(r,e.snapshotNode,s.snapshotNode));else if(n==="child_removed"&&i==="child_added")this.changeMap.delete(r);else if(n==="child_removed"&&i==="child_changed")this.changeMap.set(r,xl(r,s.oldSnap));else if(n==="child_changed"&&i==="child_added")this.changeMap.set(r,Ca(r,e.snapshotNode));else if(n==="child_changed"&&i==="child_changed")this.changeMap.set(r,Ol(r,e.snapshotNode,s.oldSnap));else throw Ha("Illegal combination of changes: "+e+" occurred after "+s)}else this.changeMap.set(r,e)}getChanges(){return Array.from(this.changeMap.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aW{getCompleteChild(e){return null}getChildAfterChild(e,n,r){return null}}const bk=new aW;class Ly{constructor(e,n,r=null){this.writes_=e,this.viewCache_=n,this.optCompleteServerCache_=r}getCompleteChild(e){const n=this.viewCache_.eventCache;if(n.isCompleteForChild(e))return n.getNode().getImmediateChild(e);{const r=this.optCompleteServerCache_!=null?new Js(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return My(this.writes_,e,r)}}getChildAfterChild(e,n,r){const s=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:ro(this.viewCache_),i=iW(this.writes_,s,n,1,r,e);return i.length===0?null:i[0]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cW(t){return{filter:t}}function lW(t,e){O(e.eventCache.getNode().isIndexed(t.filter.getIndex()),"Event snap not indexed"),O(e.serverCache.getNode().isIndexed(t.filter.getIndex()),"Server snap not indexed")}function uW(t,e,n,r,s){const i=new oW;let o,a;if(n.type===sr.OVERWRITE){const l=n;l.source.fromUser?o=Tm(t,e,l.path,l.snap,r,s,i):(O(l.source.fromServer,"Unknown source."),a=l.source.tagged||e.serverCache.isFiltered()&&!ge(l.path),o=fd(t,e,l.path,l.snap,r,s,a,i))}else if(n.type===sr.MERGE){const l=n;l.source.fromUser?o=dW(t,e,l.path,l.children,r,s,i):(O(l.source.fromServer,"Unknown source."),a=l.source.tagged||e.serverCache.isFiltered(),o=Sm(t,e,l.path,l.children,r,s,a,i))}else if(n.type===sr.ACK_USER_WRITE){const l=n;l.revert?o=gW(t,e,l.path,r,s,i):o=fW(t,e,l.path,l.affectedTree,r,s,i)}else if(n.type===sr.LISTEN_COMPLETE)o=pW(t,e,n.path,r,i);else throw Ha("Unknown operation type: "+n.type);const c=i.getChanges();return hW(e,o,c),{viewCache:o,changes:c}}function hW(t,e,n){const r=e.eventCache;if(r.isFullyInitialized()){const s=r.getNode().isLeafNode()||r.getNode().isEmpty(),i=ud(t);(n.length>0||!t.eventCache.isFullyInitialized()||s&&!r.getNode().equals(i)||!r.getNode().getPriority().equals(i.getPriority()))&&n.push(pk(ud(e)))}}function Ik(t,e,n,r,s,i){const o=e.eventCache;if(dd(r,n)!=null)return e;{let a,c;if(ge(n))if(O(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){const l=ro(e),u=l instanceof te?l:te.EMPTY_NODE,h=Oy(r,u);a=t.filter.updateFullNode(e.eventCache.getNode(),h,i)}else{const l=hd(r,ro(e));a=t.filter.updateFullNode(e.eventCache.getNode(),l,i)}else{const l=pe(n);if(l===".priority"){O(Ys(n)===1,"Can't have a priority with additional path components");const u=o.getNode();c=e.serverCache.getNode();const h=QI(r,n,u,c);h!=null?a=t.filter.updatePriority(u,h):a=o.getNode()}else{const u=Le(n);let h;if(o.isCompleteForChild(l)){c=e.serverCache.getNode();const d=QI(r,n,o.getNode(),c);d!=null?h=o.getNode().getImmediateChild(l).updateChild(u,d):h=o.getNode().getImmediateChild(l)}else h=My(r,l,e.serverCache);h!=null?a=t.filter.updateChild(o.getNode(),l,h,u,s,i):a=o.getNode()}}return Yc(e,a,o.isFullyInitialized()||ge(n),t.filter.filtersNodes())}}function fd(t,e,n,r,s,i,o,a){const c=e.serverCache;let l;const u=o?t.filter:t.filter.getIndexedFilter();if(ge(n))l=u.updateFullNode(c.getNode(),r,null);else if(u.filtersNodes()&&!c.isFiltered()){const f=c.getNode().updateChild(n,r);l=u.updateFullNode(c.getNode(),f,null)}else{const f=pe(n);if(!c.isCompleteForPath(n)&&Ys(n)>1)return e;const p=Le(n),y=c.getNode().getImmediateChild(f).updateChild(p,r);f===".priority"?l=u.updatePriority(c.getNode(),y):l=u.updateChild(c.getNode(),f,y,p,bk,null)}const h=gk(e,l,c.isFullyInitialized()||ge(n),u.filtersNodes()),d=new Ly(s,h,i);return Ik(t,h,n,s,d,a)}function Tm(t,e,n,r,s,i,o){const a=e.eventCache;let c,l;const u=new Ly(s,e,i);if(ge(n))l=t.filter.updateFullNode(e.eventCache.getNode(),r,o),c=Yc(e,l,!0,t.filter.filtersNodes());else{const h=pe(n);if(h===".priority")l=t.filter.updatePriority(e.eventCache.getNode(),r),c=Yc(e,l,a.isFullyInitialized(),a.isFiltered());else{const d=Le(n),f=a.getNode().getImmediateChild(h);let p;if(ge(d))p=r;else{const _=u.getCompleteChild(h);_!=null?Ty(d)===".priority"&&_.getChild(ik(d)).isEmpty()?p=_:p=_.updateChild(d,r):p=te.EMPTY_NODE}if(f.equals(p))c=e;else{const _=t.filter.updateChild(a.getNode(),h,p,d,u,o);c=Yc(e,_,a.isFullyInitialized(),t.filter.filtersNodes())}}}return c}function YI(t,e){return t.eventCache.isCompleteForChild(e)}function dW(t,e,n,r,s,i,o){let a=e;return r.foreach((c,l)=>{const u=ze(n,c);YI(e,pe(u))&&(a=Tm(t,a,u,l,s,i,o))}),r.foreach((c,l)=>{const u=ze(n,c);YI(e,pe(u))||(a=Tm(t,a,u,l,s,i,o))}),a}function JI(t,e,n){return n.foreach((r,s)=>{e=e.updateChild(r,s)}),e}function Sm(t,e,n,r,s,i,o,a){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let c=e,l;ge(n)?l=r:l=new Ve(null).setTree(n,r);const u=e.serverCache.getNode();return l.children.inorderTraversal((h,d)=>{if(u.hasChild(h)){const f=e.serverCache.getNode().getImmediateChild(h),p=JI(t,f,d);c=fd(t,c,new Ae(h),p,s,i,o,a)}}),l.children.inorderTraversal((h,d)=>{const f=!e.serverCache.isCompleteForChild(h)&&d.value===void 0;if(!u.hasChild(h)&&!f){const p=e.serverCache.getNode().getImmediateChild(h),_=JI(t,p,d);c=fd(t,c,new Ae(h),_,s,i,o,a)}}),c}function fW(t,e,n,r,s,i,o){if(dd(s,n)!=null)return e;const a=e.serverCache.isFiltered(),c=e.serverCache;if(r.value!=null){if(ge(n)&&c.isFullyInitialized()||c.isCompleteForPath(n))return fd(t,e,n,c.getNode().getChild(n),s,i,a,o);if(ge(n)){let l=new Ve(null);return c.getNode().forEachChild(Ar,(u,h)=>{l=l.set(new Ae(u),h)}),Sm(t,e,n,l,s,i,a,o)}else return e}else{let l=new Ve(null);return r.foreach((u,h)=>{const d=ze(n,u);c.isCompleteForPath(d)&&(l=l.set(u,c.getNode().getChild(d)))}),Sm(t,e,n,l,s,i,a,o)}}function pW(t,e,n,r,s){const i=e.serverCache,o=gk(e,i.getNode(),i.isFullyInitialized()||ge(n),i.isFiltered());return Ik(t,o,n,r,bk,s)}function gW(t,e,n,r,s,i){let o;if(dd(r,n)!=null)return e;{const a=new Ly(r,e,s),c=e.eventCache.getNode();let l;if(ge(n)||pe(n)===".priority"){let u;if(e.serverCache.isFullyInitialized())u=hd(r,ro(e));else{const h=e.serverCache.getNode();O(h instanceof te,"serverChildren would be complete if leaf node"),u=Oy(r,h)}u=u,l=t.filter.updateFullNode(c,u,i)}else{const u=pe(n);let h=My(r,u,e.serverCache);h==null&&e.serverCache.isCompleteForChild(u)&&(h=c.getImmediateChild(u)),h!=null?l=t.filter.updateChild(c,u,h,Le(n),a,i):e.eventCache.getNode().hasChild(u)?l=t.filter.updateChild(c,u,te.EMPTY_NODE,Le(n),a,i):l=c,l.isEmpty()&&e.serverCache.isFullyInitialized()&&(o=hd(r,ro(e)),o.isLeafNode()&&(l=t.filter.updateFullNode(l,o,i)))}return o=e.serverCache.isFullyInitialized()||dd(r,Te())!=null,Yc(e,l,o,t.filter.filtersNodes())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mW{constructor(e,n){this.query_=e,this.eventRegistrations_=[];const r=this.query_._queryParams,s=new Ny(r.getIndex()),i=NH(r);this.processor_=cW(i);const o=n.serverCache,a=n.eventCache,c=s.updateFullNode(te.EMPTY_NODE,o.getNode(),null),l=i.updateFullNode(te.EMPTY_NODE,a.getNode(),null),u=new Js(c,o.isFullyInitialized(),s.filtersNodes()),h=new Js(l,a.isFullyInitialized(),i.filtersNodes());this.viewCache_=kf(h,u),this.eventGenerator_=new BH(this.query_)}get query(){return this.query_}}function _W(t){return t.viewCache_.serverCache.getNode()}function yW(t){return ud(t.viewCache_)}function vW(t,e){const n=ro(t.viewCache_);return n&&(t.query._queryParams.loadsAllData()||!ge(e)&&!n.getImmediateChild(pe(e)).isEmpty())?n.getChild(e):null}function XI(t){return t.eventRegistrations_.length===0}function wW(t,e){t.eventRegistrations_.push(e)}function ZI(t,e,n){const r=[];if(n){O(e==null,"A cancel should cancel all event registrations.");const s=t.query._path;t.eventRegistrations_.forEach(i=>{const o=i.createCancelEvent(n,s);o&&r.push(o)})}if(e){let s=[];for(let i=0;i<t.eventRegistrations_.length;++i){const o=t.eventRegistrations_[i];if(!o.matches(e))s.push(o);else if(e.hasAnyCallback()){s=s.concat(t.eventRegistrations_.slice(i+1));break}}t.eventRegistrations_=s}else t.eventRegistrations_=[];return r}function eE(t,e,n,r){e.type===sr.MERGE&&e.source.queryId!==null&&(O(ro(t.viewCache_),"We should always have a full cache before handling merges"),O(ud(t.viewCache_),"Missing event cache, even though we have a server cache"));const s=t.viewCache_,i=uW(t.processor_,s,e,n,r);return lW(t.processor_,i.viewCache),O(i.viewCache.serverCache.isFullyInitialized()||!s.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),t.viewCache_=i.viewCache,Ek(t,i.changes,i.viewCache.eventCache.getNode(),null)}function bW(t,e){const n=t.viewCache_.eventCache,r=[];return n.getNode().isLeafNode()||n.getNode().forEachChild(qe,(i,o)=>{r.push(Ca(i,o))}),n.isFullyInitialized()&&r.push(pk(n.getNode())),Ek(t,r,n.getNode(),e)}function Ek(t,e,n,r){const s=r?[r]:t.eventRegistrations_;return qH(t.eventGenerator_,e,n,s)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let pd;class Tk{constructor(){this.views=new Map}}function IW(t){O(!pd,"__referenceConstructor has already been defined"),pd=t}function EW(){return O(pd,"Reference.ts has not been loaded"),pd}function TW(t){return t.views.size===0}function Fy(t,e,n,r){const s=e.source.queryId;if(s!==null){const i=t.views.get(s);return O(i!=null,"SyncTree gave us an op for an invalid query."),eE(i,e,n,r)}else{let i=[];for(const o of t.views.values())i=i.concat(eE(o,e,n,r));return i}}function Uy(t,e,n,r,s){const i=e._queryIdentifier,o=t.views.get(i);if(!o){let a=hd(n,s?r:null),c=!1;a?c=!0:r instanceof te?(a=Oy(n,r),c=!1):(a=te.EMPTY_NODE,c=!1);const l=kf(new Js(a,c,!1),new Js(r,s,!1));return new mW(e,l)}return o}function SW(t,e,n,r,s,i){const o=Uy(t,e,r,s,i);return t.views.has(e._queryIdentifier)||t.views.set(e._queryIdentifier,o),wW(o,n),bW(o,n)}function CW(t,e,n,r){const s=e._queryIdentifier,i=[];let o=[];const a=Xs(t);if(s==="default")for(const[c,l]of t.views.entries())o=o.concat(ZI(l,n,r)),XI(l)&&(t.views.delete(c),l.query._queryParams.loadsAllData()||i.push(l.query));else{const c=t.views.get(s);c&&(o=o.concat(ZI(c,n,r)),XI(c)&&(t.views.delete(s),c.query._queryParams.loadsAllData()||i.push(c.query)))}return a&&!Xs(t)&&i.push(new(EW())(e._repo,e._path)),{removed:i,events:o}}function Sk(t){const e=[];for(const n of t.views.values())n.query._queryParams.loadsAllData()||e.push(n);return e}function qs(t,e){let n=null;for(const r of t.views.values())n=n||vW(r,e);return n}function Ck(t,e){if(e._queryParams.loadsAllData())return Nf(t);{const r=e._queryIdentifier;return t.views.get(r)}}function Ak(t,e){return Ck(t,e)!=null}function Xs(t){return Nf(t)!=null}function Nf(t){for(const e of t.views.values())if(e.query._queryParams.loadsAllData())return e;return null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let gd;function AW(t){O(!gd,"__referenceConstructor has already been defined"),gd=t}function kW(){return O(gd,"Reference.ts has not been loaded"),gd}let RW=1;class tE{constructor(e){this.listenProvider_=e,this.syncPointTree_=new Ve(null),this.pendingWriteTree_=sW(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function $y(t,e,n,r,s){return WH(t.pendingWriteTree_,e,n,r,s),s?Za(t,new no(Py(),e,n)):[]}function NW(t,e,n,r){GH(t.pendingWriteTree_,e,n,r);const s=Ve.fromObject(n);return Za(t,new Aa(Py(),e,s))}function Ls(t,e,n=!1){const r=zH(t.pendingWriteTree_,e);if(QH(t.pendingWriteTree_,e)){let i=new Ve(null);return r.snap!=null?i=i.set(Te(),!0):xt(r.children,o=>{i=i.set(new Ae(o),!0)}),Za(t,new ld(r.path,i,n))}else return[]}function bu(t,e,n){return Za(t,new no(Dy(),e,n))}function PW(t,e,n){const r=Ve.fromObject(n);return Za(t,new Aa(Dy(),e,r))}function DW(t,e){return Za(t,new Ll(Dy(),e))}function xW(t,e,n){const r=Vy(t,n);if(r){const s=By(r),i=s.path,o=s.queryId,a=un(i,e),c=new Ll(xy(o),a);return qy(t,i,c)}else return[]}function md(t,e,n,r){const s=e._path,i=t.syncPointTree_.get(s);let o=[];if(i&&(e._queryIdentifier==="default"||Ak(i,e))){const a=CW(i,e,n,r);TW(i)&&(t.syncPointTree_=t.syncPointTree_.remove(s));const c=a.removed;o=a.events;const l=c.findIndex(h=>h._queryParams.loadsAllData())!==-1,u=t.syncPointTree_.findOnPath(s,(h,d)=>Xs(d));if(l&&!u){const h=t.syncPointTree_.subtree(s);if(!h.isEmpty()){const d=FW(h);for(let f=0;f<d.length;++f){const p=d[f],_=p.query,y=Dk(t,p);t.listenProvider_.startListening(Xc(_),Fl(t,_),y.hashFn,y.onComplete)}}}!u&&c.length>0&&!r&&(l?t.listenProvider_.stopListening(Xc(e),null):c.forEach(h=>{const d=t.queryToTagMap.get(Df(h));t.listenProvider_.stopListening(Xc(h),d)})),UW(t,c)}return o}function OW(t,e){const{syncPoint:n,serverCache:r,writesCache:s,serverCacheComplete:i}=Rk(e,t),o=Uy(n,e,s,r,i);return n.views.has(e._queryIdentifier)||n.views.set(e._queryIdentifier,o),e._queryParams.loadsAllData()?null:Fl(t,e)}function kk(t,e,n,r){const s=Vy(t,r);if(s!=null){const i=By(s),o=i.path,a=i.queryId,c=un(o,e),l=new no(xy(a),c,n);return qy(t,o,l)}else return[]}function MW(t,e,n,r){const s=Vy(t,r);if(s){const i=By(s),o=i.path,a=i.queryId,c=un(o,e),l=Ve.fromObject(n),u=new Aa(xy(a),c,l);return qy(t,o,u)}else return[]}function Rk(t,e){const n=t._path;let r=null,s=!1;e.syncPointTree_.foreachOnPath(n,(l,u)=>{const h=un(l,n);r=r||qs(u,h),s=s||Xs(u)});let i=e.syncPointTree_.get(n);i?(s=s||Xs(i),r=r||qs(i,Te())):(i=new Tk,e.syncPointTree_=e.syncPointTree_.set(n,i));let o;r!=null?o=!0:(o=!1,r=te.EMPTY_NODE,e.syncPointTree_.subtree(n).foreachChild((u,h)=>{const d=qs(h,Te());d&&(r=r.updateImmediateChild(u,d))}));const a=Ak(i,t);if(!a&&!t._queryParams.loadsAllData()){const l=Df(t);O(!e.queryToTagMap.has(l),"View does not exist, but we have a tag");const u=$W();e.queryToTagMap.set(l,u),e.tagToQueryMap.set(u,l)}const c=Rf(e.pendingWriteTree_,n);return{syncPoint:i,writesCache:c,serverCache:r,serverCacheComplete:o,foundAncestorDefaultView:s,viewAlreadyExists:a}}function nE(t,e,n){const{syncPoint:r,serverCache:s,writesCache:i,serverCacheComplete:o,viewAlreadyExists:a,foundAncestorDefaultView:c}=Rk(e,t);let l=SW(r,e,n,i,s,o);if(!a&&!c){const u=Ck(r,e);l=l.concat(VW(t,e,u))}return l}function Pf(t,e,n){const s=t.pendingWriteTree_,i=t.syncPointTree_.findOnPath(e,(o,a)=>{const c=un(o,e),l=qs(a,c);if(l)return l});return yk(s,e,i,n,!0)}function LW(t,e){const n=e._path;let r=null;t.syncPointTree_.foreachOnPath(n,(l,u)=>{const h=un(l,n);r=r||qs(u,h)});let s=t.syncPointTree_.get(n);s?r=r||qs(s,Te()):(s=new Tk,t.syncPointTree_=t.syncPointTree_.set(n,s));const i=r!=null,o=i?new Js(r,!0,!1):null,a=Rf(t.pendingWriteTree_,e._path),c=Uy(s,e,a,i?o.getNode():te.EMPTY_NODE,i);return yW(c)}function Za(t,e){return Nk(e,t.syncPointTree_,null,Rf(t.pendingWriteTree_,Te()))}function Nk(t,e,n,r){if(ge(t.path))return Pk(t,e,n,r);{const s=e.get(Te());n==null&&s!=null&&(n=qs(s,Te()));let i=[];const o=pe(t.path),a=t.operationForChild(o),c=e.children.get(o);if(c&&a){const l=n?n.getImmediateChild(o):null,u=vk(r,o);i=i.concat(Nk(a,c,l,u))}return s&&(i=i.concat(Fy(s,t,r,n))),i}}function Pk(t,e,n,r){const s=e.get(Te());n==null&&s!=null&&(n=qs(s,Te()));let i=[];return e.children.inorderTraversal((o,a)=>{const c=n?n.getImmediateChild(o):null,l=vk(r,o),u=t.operationForChild(o);u&&(i=i.concat(Pk(u,a,c,l)))}),s&&(i=i.concat(Fy(s,t,r,n))),i}function Dk(t,e){const n=e.query,r=Fl(t,n);return{hashFn:()=>(_W(e)||te.EMPTY_NODE).hash(),onComplete:s=>{if(s==="ok")return r?xW(t,n._path,r):DW(t,n._path);{const i=PK(s,n);return md(t,n,null,i)}}}}function Fl(t,e){const n=Df(e);return t.queryToTagMap.get(n)}function Df(t){return t._path.toString()+"$"+t._queryIdentifier}function Vy(t,e){return t.tagToQueryMap.get(e)}function By(t){const e=t.indexOf("$");return O(e!==-1&&e<t.length-1,"Bad queryKey."),{queryId:t.substr(e+1),path:new Ae(t.substr(0,e))}}function qy(t,e,n){const r=t.syncPointTree_.get(e);O(r,"Missing sync point for query tag that we're tracking");const s=Rf(t.pendingWriteTree_,e);return Fy(r,n,s,null)}function FW(t){return t.fold((e,n,r)=>{if(n&&Xs(n))return[Nf(n)];{let s=[];return n&&(s=Sk(n)),xt(r,(i,o)=>{s=s.concat(o)}),s}})}function Xc(t){return t._queryParams.loadsAllData()&&!t._queryParams.isDefault()?new(kW())(t._repo,t._path):t}function UW(t,e){for(let n=0;n<e.length;++n){const r=e[n];if(!r._queryParams.loadsAllData()){const s=Df(r),i=t.queryToTagMap.get(s);t.queryToTagMap.delete(s),t.tagToQueryMap.delete(i)}}}function $W(){return RW++}function VW(t,e,n){const r=e._path,s=Fl(t,e),i=Dk(t,n),o=t.listenProvider_.startListening(Xc(e),s,i.hashFn,i.onComplete),a=t.syncPointTree_.subtree(r);if(s)O(!Xs(a.value),"If we're adding a query, it shouldn't be shadowed");else{const c=a.fold((l,u,h)=>{if(!ge(l)&&u&&Xs(u))return[Nf(u).query];{let d=[];return u&&(d=d.concat(Sk(u).map(f=>f.query))),xt(h,(f,p)=>{d=d.concat(p)}),d}});for(let l=0;l<c.length;++l){const u=c[l];t.listenProvider_.stopListening(Xc(u),Fl(t,u))}}return o}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jy{constructor(e){this.node_=e}getImmediateChild(e){const n=this.node_.getImmediateChild(e);return new jy(n)}node(){return this.node_}}class Ky{constructor(e,n){this.syncTree_=e,this.path_=n}getImmediateChild(e){const n=ze(this.path_,e);return new Ky(this.syncTree_,n)}node(){return Pf(this.syncTree_,this.path_)}}const BW=function(t){return t=t||{},t.timestamp=t.timestamp||new Date().getTime(),t},rE=function(t,e,n){if(!t||typeof t!="object")return t;if(O(".sv"in t,"Unexpected leaf node or priority contents"),typeof t[".sv"]=="string")return qW(t[".sv"],e,n);if(typeof t[".sv"]=="object")return jW(t[".sv"],e);O(!1,"Unexpected server value: "+JSON.stringify(t,null,2))},qW=function(t,e,n){switch(t){case"timestamp":return n.timestamp;default:O(!1,"Unexpected server value: "+t)}},jW=function(t,e,n){t.hasOwnProperty("increment")||O(!1,"Unexpected server value: "+JSON.stringify(t,null,2));const r=t.increment;typeof r!="number"&&O(!1,"Unexpected increment value: "+r);const s=e.node();if(O(s!==null&&typeof s!="undefined","Expected ChildrenNode.EMPTY_NODE for nulls"),!s.isLeafNode())return r;const o=s.getValue();return typeof o!="number"?r:o+r},xk=function(t,e,n,r){return Wy(e,new Ky(n,t),r)},Hy=function(t,e,n){return Wy(t,new jy(e),n)};function Wy(t,e,n){const r=t.getPriority().val(),s=rE(r,e.getImmediateChild(".priority"),n);let i;if(t.isLeafNode()){const o=t,a=rE(o.getValue(),e,n);return a!==o.getValue()||s!==o.getPriority().val()?new bt(a,Je(s)):t}else{const o=t;return i=o,s!==o.getPriority().val()&&(i=i.updatePriority(new bt(s))),o.forEachChild(qe,(a,c)=>{const l=Wy(c,e.getImmediateChild(a),n);l!==c&&(i=i.updateImmediateChild(a,l))}),i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gy{constructor(e="",n=null,r={children:{},childCount:0}){this.name=e,this.parent=n,this.node=r}}function xf(t,e){let n=e instanceof Ae?e:new Ae(e),r=t,s=pe(n);for(;s!==null;){const i=Yi(r.node.children,s)||{children:{},childCount:0};r=new Gy(s,r,i),n=Le(n),s=pe(n)}return r}function Ro(t){return t.node.value}function zy(t,e){t.node.value=e,Cm(t)}function Ok(t){return t.node.childCount>0}function KW(t){return Ro(t)===void 0&&!Ok(t)}function Of(t,e){xt(t.node.children,(n,r)=>{e(new Gy(n,t,r))})}function Mk(t,e,n,r){n&&!r&&e(t),Of(t,s=>{Mk(s,e,!0,r)}),n&&r&&e(t)}function HW(t,e,n){let r=n?t:t.parent;for(;r!==null;){if(e(r))return!0;r=r.parent}return!1}function Iu(t){return new Ae(t.parent===null?t.name:Iu(t.parent)+"/"+t.name)}function Cm(t){t.parent!==null&&WW(t.parent,t.name,t)}function WW(t,e,n){const r=KW(n),s=xn(t.node.children,e);r&&s?(delete t.node.children[e],t.node.childCount--,Cm(t)):!r&&!s&&(t.node.children[e]=n.node,t.node.childCount++,Cm(t))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GW=/[\[\].#$\/\u0000-\u001F\u007F]/,zW=/[\[\].#$\u0000-\u001F\u007F]/,tg=10*1024*1024,Mf=function(t){return typeof t=="string"&&t.length!==0&&!GW.test(t)},Lk=function(t){return typeof t=="string"&&t.length!==0&&!zW.test(t)},QW=function(t){return t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),Lk(t)},Ul=function(t){return t===null||typeof t=="string"||typeof t=="number"&&!Tf(t)||t&&typeof t=="object"&&xn(t,".sv")},Lr=function(t,e,n,r){r&&e===void 0||Eu(bn(t,"value"),e,n)},Eu=function(t,e,n){const r=n instanceof Ae?new lH(n,t):n;if(e===void 0)throw new Error(t+"contains undefined "+Si(r));if(typeof e=="function")throw new Error(t+"contains a function "+Si(r)+" with contents = "+e.toString());if(Tf(e))throw new Error(t+"contains "+e.toString()+" "+Si(r));if(typeof e=="string"&&e.length>tg/3&&cf(e)>tg)throw new Error(t+"contains a string greater than "+tg+" utf8 bytes "+Si(r)+" ('"+e.substring(0,50)+"...')");if(e&&typeof e=="object"){let s=!1,i=!1;if(xt(e,(o,a)=>{if(o===".value")s=!0;else if(o!==".priority"&&o!==".sv"&&(i=!0,!Mf(o)))throw new Error(t+" contains an invalid key ("+o+") "+Si(r)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);uH(r,o),Eu(t,a,r),hH(r)}),s&&i)throw new Error(t+' contains ".value" child '+Si(r)+" in addition to actual children.")}},YW=function(t,e){let n,r;for(n=0;n<e.length;n++){r=e[n];const i=Dl(r);for(let o=0;o<i.length;o++)if(!(i[o]===".priority"&&o===i.length-1)){if(!Mf(i[o]))throw new Error(t+"contains an invalid key ("+i[o]+") in path "+r.toString()+`. Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`)}}e.sort(cH);let s=null;for(n=0;n<e.length;n++){if(r=e[n],s!==null&&Bn(s,r))throw new Error(t+"contains a path "+s.toString()+" that is ancestor of another path "+r.toString());s=r}},Fk=function(t,e,n,r){if(r&&e===void 0)return;const s=bn(t,"values");if(!(e&&typeof e=="object")||Array.isArray(e))throw new Error(s+" must be an object containing the children to replace.");const i=[];xt(e,(o,a)=>{const c=new Ae(o);if(Eu(s,a,ze(n,c)),Ty(c)===".priority"&&!Ul(a))throw new Error(s+"contains an invalid value for '"+c.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");i.push(c)}),YW(s,i)},Qy=function(t,e,n){if(!(n&&e===void 0)){if(Tf(e))throw new Error(bn(t,"priority")+"is "+e.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!Ul(e))throw new Error(bn(t,"priority")+"must be a valid Firebase priority (a string, finite number, server value, or null).")}},Tu=function(t,e,n,r){if(!(r&&n===void 0)&&!Mf(n))throw new Error(bn(t,e)+'was an invalid key = "'+n+`".  Firebase keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]").`)},$l=function(t,e,n,r){if(!(r&&n===void 0)&&!Lk(n))throw new Error(bn(t,e)+'was an invalid path = "'+n+`". Paths must be non-empty strings and can't contain ".", "#", "$", "[", or "]"`)},JW=function(t,e,n,r){n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),$l(t,e,n,r)},qn=function(t,e){if(pe(e)===".info")throw new Error(t+" failed = Can't modify data under /.info/")},Uk=function(t,e){const n=e.path.toString();if(typeof e.repoInfo.host!="string"||e.repoInfo.host.length===0||!Mf(e.repoInfo.namespace)&&e.repoInfo.host.split(":")[0]!=="localhost"||n.length!==0&&!QW(n))throw new Error(bn(t,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XW{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function Lf(t,e){let n=null;for(let r=0;r<e.length;r++){const s=e[r],i=s.getPath();n!==null&&!Sy(i,n.path)&&(t.eventLists_.push(n),n=null),n===null&&(n={events:[],path:i}),n.events.push(s)}n&&t.eventLists_.push(n)}function $k(t,e,n){Lf(t,n),Vk(t,r=>Sy(r,e))}function zn(t,e,n){Lf(t,n),Vk(t,r=>Bn(r,e)||Bn(e,r))}function Vk(t,e){t.recursionDepth_++;let n=!0;for(let r=0;r<t.eventLists_.length;r++){const s=t.eventLists_[r];if(s){const i=s.path;e(i)?(ZW(t.eventLists_[r]),t.eventLists_[r]=null):n=!1}}n&&(t.eventLists_=[]),t.recursionDepth_--}function ZW(t){for(let e=0;e<t.events.length;e++){const n=t.events[e];if(n!==null){t.events[e]=null;const r=n.getEventRunner();zi&&Ct("event: "+n.toString()),Ja(r)}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bk="repo_interrupt",eG=25;class tG{constructor(e,n,r,s){this.repoInfo_=e,this.forceRestClient_=n,this.authTokenProvider_=r,this.appCheckProvider_=s,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new XW,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=cd(),this.transactionQueueTree_=new Gy,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function nG(t,e,n){if(t.stats_=Iy(t.repoInfo_),t.forceRestClient_||xK())t.server_=new ad(t.repoInfo_,(r,s,i,o)=>{sE(t,r,s,i,o)},t.authTokenProvider_,t.appCheckProvider_),setTimeout(()=>iE(t,!0),0);else{if(typeof n!="undefined"&&n!==null){if(typeof n!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{_t(n)}catch(r){throw new Error("Invalid authOverride provided: "+r)}}t.persistentConnection_=new rs(t.repoInfo_,e,(r,s,i,o)=>{sE(t,r,s,i,o)},r=>{iE(t,r)},r=>{rG(t,r)},t.authTokenProvider_,t.appCheckProvider_,n),t.server_=t.persistentConnection_}t.authTokenProvider_.addTokenChangeListener(r=>{t.server_.refreshAuthToken(r)}),t.appCheckProvider_.addTokenChangeListener(r=>{t.server_.refreshAppCheckToken(r.token)}),t.statsReporter_=UK(t.repoInfo_,()=>new VH(t.stats_,t.server_)),t.infoData_=new MH,t.infoSyncTree_=new tE({startListening:(r,s,i,o)=>{let a=[];const c=t.infoData_.getNode(r._path);return c.isEmpty()||(a=bu(t.infoSyncTree_,r._path,c),setTimeout(()=>{o("ok")},0)),a},stopListening:()=>{}}),Yy(t,"connected",!1),t.serverSyncTree_=new tE({startListening:(r,s,i,o)=>(t.server_.listen(r,i,s,(a,c)=>{const l=o(a,c);zn(t.eventQueue_,r._path,l)}),[]),stopListening:(r,s)=>{t.server_.unlisten(r,s)}})}function qk(t){const n=t.infoData_.getNode(new Ae(".info/serverTimeOffset")).val()||0;return new Date().getTime()+n}function Su(t){return BW({timestamp:qk(t)})}function sE(t,e,n,r,s){t.dataUpdateCount++;const i=new Ae(e);n=t.interceptServerDataCallback_?t.interceptServerDataCallback_(e,n):n;let o=[];if(s)if(r){const c=Hh(n,l=>Je(l));o=MW(t.serverSyncTree_,i,c,s)}else{const c=Je(n);o=kk(t.serverSyncTree_,i,c,s)}else if(r){const c=Hh(n,l=>Je(l));o=PW(t.serverSyncTree_,i,c)}else{const c=Je(n);o=bu(t.serverSyncTree_,i,c)}let a=i;o.length>0&&(a=Ra(t,i)),zn(t.eventQueue_,a,o)}function iE(t,e){Yy(t,"connected",e),e===!1&&oG(t)}function rG(t,e){xt(e,(n,r)=>{Yy(t,n,r)})}function Yy(t,e,n){const r=new Ae("/.info/"+e),s=Je(n);t.infoData_.updateSnapshot(r,s);const i=bu(t.infoSyncTree_,r,s);zn(t.eventQueue_,r,i)}function Ff(t){return t.nextWriteId_++}function sG(t,e){const n=LW(t.serverSyncTree_,e);return n!=null?Promise.resolve(n):t.server_.get(e).then(r=>{const s=Je(r).withIndex(e._queryParams.getIndex());if(e._queryParams.loadsAllData())bu(t.serverSyncTree_,e._path,s);else{const o=OW(t.serverSyncTree_,e);kk(t.serverSyncTree_,e._path,s,o)}return md(t.serverSyncTree_,e,null).length>0&&so(t,"unexpected cancel events in repoGetValue"),s},r=>(so(t,"get for query "+_t(e)+" failed: "+r),Promise.reject(new Error(r))))}function Jy(t,e,n,r,s){so(t,"set",{path:e.toString(),value:n,priority:r});const i=Su(t),o=Je(n,r),a=Pf(t.serverSyncTree_,e),c=Hy(o,a,i),l=Ff(t),u=$y(t.serverSyncTree_,e,c,l,!0);Lf(t.eventQueue_,u),t.server_.put(e.toString(),o.val(!0),(d,f)=>{const p=d==="ok";p||Xt("set at "+e+" failed: "+d);const _=Ls(t.serverSyncTree_,l,!p);zn(t.eventQueue_,e,_),Zs(t,s,d,f)});const h=Zy(t,e);Ra(t,h),zn(t.eventQueue_,h,[])}function iG(t,e,n,r){so(t,"update",{path:e.toString(),value:n});let s=!0;const i=Su(t),o={};if(xt(n,(a,c)=>{s=!1,o[a]=xk(ze(e,a),Je(c),t.serverSyncTree_,i)}),s)Ct("update() called with empty data.  Don't do anything."),Zs(t,r,"ok",void 0);else{const a=Ff(t),c=NW(t.serverSyncTree_,e,o,a);Lf(t.eventQueue_,c),t.server_.merge(e.toString(),n,(l,u)=>{const h=l==="ok";h||Xt("update at "+e+" failed: "+l);const d=Ls(t.serverSyncTree_,a,!h),f=d.length>0?Ra(t,e):e;zn(t.eventQueue_,f,d),Zs(t,r,l,u)}),xt(n,l=>{const u=Zy(t,ze(e,l));Ra(t,u)}),zn(t.eventQueue_,e,[])}}function oG(t){so(t,"onDisconnectEvents");const e=Su(t),n=cd();wm(t.onDisconnect_,Te(),(s,i)=>{const o=xk(s,i,t.serverSyncTree_,e);Xa(n,s,o)});let r=[];wm(n,Te(),(s,i)=>{r=r.concat(bu(t.serverSyncTree_,s,i));const o=Zy(t,s);Ra(t,o)}),t.onDisconnect_=cd(),zn(t.eventQueue_,Te(),r)}function aG(t,e,n){t.server_.onDisconnectCancel(e.toString(),(r,s)=>{r==="ok"&&vm(t.onDisconnect_,e),Zs(t,n,r,s)})}function oE(t,e,n,r){const s=Je(n);t.server_.onDisconnectPut(e.toString(),s.val(!0),(i,o)=>{i==="ok"&&Xa(t.onDisconnect_,e,s),Zs(t,r,i,o)})}function cG(t,e,n,r,s){const i=Je(n,r);t.server_.onDisconnectPut(e.toString(),i.val(!0),(o,a)=>{o==="ok"&&Xa(t.onDisconnect_,e,i),Zs(t,s,o,a)})}function lG(t,e,n,r){if(Kh(n)){Ct("onDisconnect().update() called with empty data.  Don't do anything."),Zs(t,r,"ok",void 0);return}t.server_.onDisconnectMerge(e.toString(),n,(s,i)=>{s==="ok"&&xt(n,(o,a)=>{const c=Je(a);Xa(t.onDisconnect_,ze(e,o),c)}),Zs(t,r,s,i)})}function uG(t,e,n){let r;pe(e._path)===".info"?r=nE(t.infoSyncTree_,e,n):r=nE(t.serverSyncTree_,e,n),$k(t.eventQueue_,e._path,r)}function Am(t,e,n){let r;pe(e._path)===".info"?r=md(t.infoSyncTree_,e,n):r=md(t.serverSyncTree_,e,n),$k(t.eventQueue_,e._path,r)}function jk(t){t.persistentConnection_&&t.persistentConnection_.interrupt(Bk)}function hG(t){t.persistentConnection_&&t.persistentConnection_.resume(Bk)}function so(t,...e){let n="";t.persistentConnection_&&(n=t.persistentConnection_.id+":"),Ct(n,...e)}function Zs(t,e,n,r){e&&Ja(()=>{if(n==="ok")e(null);else{const s=(n||"error").toUpperCase();let i=s;r&&(i+=": "+r);const o=new Error(i);o.code=s,e(o)}})}function dG(t,e,n,r,s,i){so(t,"transaction on "+e);const o={path:e,update:n,onComplete:r,status:null,order:MA(),applyLocally:i,retryCount:0,unwatcher:s,abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},a=Xy(t,e,void 0);o.currentInputSnapshot=a;const c=o.update(a.val());if(c===void 0)o.unwatcher(),o.currentOutputSnapshotRaw=null,o.currentOutputSnapshotResolved=null,o.onComplete&&o.onComplete(null,!1,o.currentInputSnapshot);else{Eu("transaction failed: Data returned ",c,o.path),o.status=0;const l=xf(t.transactionQueueTree_,e),u=Ro(l)||[];u.push(o),zy(l,u);let h;typeof c=="object"&&c!==null&&xn(c,".priority")?(h=Yi(c,".priority"),O(Ul(h),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.")):h=(Pf(t.serverSyncTree_,e)||te.EMPTY_NODE).getPriority().val();const d=Su(t),f=Je(c,h),p=Hy(f,a,d);o.currentOutputSnapshotRaw=f,o.currentOutputSnapshotResolved=p,o.currentWriteId=Ff(t);const _=$y(t.serverSyncTree_,e,p,o.currentWriteId,o.applyLocally);zn(t.eventQueue_,e,_),Uf(t,t.transactionQueueTree_)}}function Xy(t,e,n){return Pf(t.serverSyncTree_,e,n)||te.EMPTY_NODE}function Uf(t,e=t.transactionQueueTree_){if(e||$f(t,e),Ro(e)){const n=Hk(t,e);O(n.length>0,"Sending zero length transaction queue"),n.every(s=>s.status===0)&&fG(t,Iu(e),n)}else Ok(e)&&Of(e,n=>{Uf(t,n)})}function fG(t,e,n){const r=n.map(l=>l.currentWriteId),s=Xy(t,e,r);let i=s;const o=s.hash();for(let l=0;l<n.length;l++){const u=n[l];O(u.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),u.status=1,u.retryCount++;const h=un(e,u.path);i=i.updateChild(h,u.currentOutputSnapshotRaw)}const a=i.val(!0),c=e;t.server_.put(c.toString(),a,l=>{so(t,"transaction put response",{path:c.toString(),status:l});let u=[];if(l==="ok"){const h=[];for(let d=0;d<n.length;d++)n[d].status=2,u=u.concat(Ls(t.serverSyncTree_,n[d].currentWriteId)),n[d].onComplete&&h.push(()=>n[d].onComplete(null,!0,n[d].currentOutputSnapshotResolved)),n[d].unwatcher();$f(t,xf(t.transactionQueueTree_,e)),Uf(t,t.transactionQueueTree_),zn(t.eventQueue_,e,u);for(let d=0;d<h.length;d++)Ja(h[d])}else{if(l==="datastale")for(let h=0;h<n.length;h++)n[h].status===3?n[h].status=4:n[h].status=0;else{Xt("transaction at "+c.toString()+" failed: "+l);for(let h=0;h<n.length;h++)n[h].status=4,n[h].abortReason=l}Ra(t,e)}},o)}function Ra(t,e){const n=Kk(t,e),r=Iu(n),s=Hk(t,n);return pG(t,s,r),r}function pG(t,e,n){if(e.length===0)return;const r=[];let s=[];const o=e.filter(a=>a.status===0).map(a=>a.currentWriteId);for(let a=0;a<e.length;a++){const c=e[a],l=un(n,c.path);let u=!1,h;if(O(l!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),c.status===4)u=!0,h=c.abortReason,s=s.concat(Ls(t.serverSyncTree_,c.currentWriteId,!0));else if(c.status===0)if(c.retryCount>=eG)u=!0,h="maxretry",s=s.concat(Ls(t.serverSyncTree_,c.currentWriteId,!0));else{const d=Xy(t,c.path,o);c.currentInputSnapshot=d;const f=e[a].update(d.val());if(f!==void 0){Eu("transaction failed: Data returned ",f,c.path);let p=Je(f);typeof f=="object"&&f!=null&&xn(f,".priority")||(p=p.updatePriority(d.getPriority()));const y=c.currentWriteId,T=Su(t),I=Hy(p,d,T);c.currentOutputSnapshotRaw=p,c.currentOutputSnapshotResolved=I,c.currentWriteId=Ff(t),o.splice(o.indexOf(y),1),s=s.concat($y(t.serverSyncTree_,c.path,I,c.currentWriteId,c.applyLocally)),s=s.concat(Ls(t.serverSyncTree_,y,!0))}else u=!0,h="nodata",s=s.concat(Ls(t.serverSyncTree_,c.currentWriteId,!0))}zn(t.eventQueue_,n,s),s=[],u&&(e[a].status=2,function(d){setTimeout(d,Math.floor(0))}(e[a].unwatcher),e[a].onComplete&&(h==="nodata"?r.push(()=>e[a].onComplete(null,!1,e[a].currentInputSnapshot)):r.push(()=>e[a].onComplete(new Error(h),!1,null))))}$f(t,t.transactionQueueTree_);for(let a=0;a<r.length;a++)Ja(r[a]);Uf(t,t.transactionQueueTree_)}function Kk(t,e){let n,r=t.transactionQueueTree_;for(n=pe(e);n!==null&&Ro(r)===void 0;)r=xf(r,n),e=Le(e),n=pe(e);return r}function Hk(t,e){const n=[];return Wk(t,e,n),n.sort((r,s)=>r.order-s.order),n}function Wk(t,e,n){const r=Ro(e);if(r)for(let s=0;s<r.length;s++)n.push(r[s]);Of(e,s=>{Wk(t,s,n)})}function $f(t,e){const n=Ro(e);if(n){let r=0;for(let s=0;s<n.length;s++)n[s].status!==2&&(n[r]=n[s],r++);n.length=r,zy(e,n.length>0?n:void 0)}Of(e,r=>{$f(t,r)})}function Zy(t,e){const n=Iu(Kk(t,e)),r=xf(t.transactionQueueTree_,e);return HW(r,s=>{ng(t,s)}),ng(t,r),Mk(r,s=>{ng(t,s)}),n}function ng(t,e){const n=Ro(e);if(n){const r=[];let s=[],i=-1;for(let o=0;o<n.length;o++)n[o].status===3||(n[o].status===1?(O(i===o-1,"All SENT items should be at beginning of queue."),i=o,n[o].status=3,n[o].abortReason="set"):(O(n[o].status===0,"Unexpected transaction status in abort"),n[o].unwatcher(),s=s.concat(Ls(t.serverSyncTree_,n[o].currentWriteId,!0)),n[o].onComplete&&r.push(n[o].onComplete.bind(null,new Error("set"),!1,null))));i===-1?zy(e,void 0):n.length=i+1,zn(t.eventQueue_,Iu(e),s);for(let o=0;o<r.length;o++)Ja(r[o])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gG(t){let e="";const n=t.split("/");for(let r=0;r<n.length;r++)if(n[r].length>0){let s=n[r];try{s=decodeURIComponent(s.replace(/\+/g," "))}catch{}e+="/"+s}return e}function mG(t){const e={};t.charAt(0)==="?"&&(t=t.substring(1));for(const n of t.split("&")){if(n.length===0)continue;const r=n.split("=");r.length===2?e[decodeURIComponent(r[0])]=decodeURIComponent(r[1]):Xt(`Invalid query segment '${n}' in query '${t}'`)}return e}const km=function(t,e){const n=_G(t),r=n.namespace;n.domain==="firebase.com"&&Or(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!r||r==="undefined")&&n.domain!=="localhost"&&Or("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||CK();const s=n.scheme==="ws"||n.scheme==="wss";return{repoInfo:new YA(n.host,n.secure,r,s,e,"",r!==n.subdomain),path:new Ae(n.pathString)}},_G=function(t){let e="",n="",r="",s="",i="",o=!0,a="https",c=443;if(typeof t=="string"){let l=t.indexOf("//");l>=0&&(a=t.substring(0,l-1),t=t.substring(l+2));let u=t.indexOf("/");u===-1&&(u=t.length);let h=t.indexOf("?");h===-1&&(h=t.length),e=t.substring(0,Math.min(u,h)),u<h&&(s=gG(t.substring(u,h)));const d=mG(t.substring(Math.min(t.length,h)));l=e.indexOf(":"),l>=0?(o=a==="https"||a==="wss",c=parseInt(e.substring(l+1),10)):l=e.length;const f=e.slice(0,l);if(f.toLowerCase()==="localhost")n="localhost";else if(f.split(".").length<=2)n=f;else{const p=e.indexOf(".");r=e.substring(0,p).toLowerCase(),n=e.substring(p+1),i=r}"ns"in d&&(i=d.ns)}return{host:e,port:c,domain:n,subdomain:r,secure:o,scheme:a,pathString:s,namespace:i}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gk{constructor(e,n,r,s){this.eventType=e,this.eventRegistration=n,this.snapshot=r,this.prevName=s}getPath(){const e=this.snapshot.ref;return this.eventType==="value"?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+_t(this.snapshot.exportVal())}}class zk{constructor(e,n,r){this.eventRegistration=e,this.error=n,this.path=r}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qk{constructor(e,n){this.snapshotCallback=e,this.cancelCallback=n}onValue(e,n){this.snapshotCallback.call(null,e,n)}onCancel(e){return O(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||this.snapshotCallback.userCallback!==void 0&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yG{constructor(e,n){this._repo=e,this._path=n}cancel(){const e=new mt;return aG(this._repo,this._path,e.wrapCallback(()=>{})),e.promise}remove(){qn("OnDisconnect.remove",this._path);const e=new mt;return oE(this._repo,this._path,null,e.wrapCallback(()=>{})),e.promise}set(e){qn("OnDisconnect.set",this._path),Lr("OnDisconnect.set",e,this._path,!1);const n=new mt;return oE(this._repo,this._path,e,n.wrapCallback(()=>{})),n.promise}setWithPriority(e,n){qn("OnDisconnect.setWithPriority",this._path),Lr("OnDisconnect.setWithPriority",e,this._path,!1),Qy("OnDisconnect.setWithPriority",n,!1);const r=new mt;return cG(this._repo,this._path,e,n,r.wrapCallback(()=>{})),r.promise}update(e){qn("OnDisconnect.update",this._path),Fk("OnDisconnect.update",e,this._path,!1);const n=new mt;return lG(this._repo,this._path,e,n.wrapCallback(()=>{})),n.promise}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class En{constructor(e,n,r,s){this._repo=e,this._path=n,this._queryParams=r,this._orderByCalled=s}get key(){return ge(this._path)?null:Ty(this._path)}get ref(){return new Yn(this._repo,this._path)}get _queryIdentifier(){const e=HI(this._queryParams),n=vy(e);return n==="{}"?"default":n}get _queryObject(){return HI(this._queryParams)}isEqual(e){if(e=N(e),!(e instanceof En))return!1;const n=this._repo===e._repo,r=Sy(this._path,e._path),s=this._queryIdentifier===e._queryIdentifier;return n&&r&&s}toJSON(){return this.toString()}toString(){return this._repo.toString()+aH(this._path)}}function Vf(t,e){if(t._orderByCalled===!0)throw new Error(e+": You can't combine multiple orderBy calls.")}function li(t){let e=null,n=null;if(t.hasStart()&&(e=t.getIndexStartValue()),t.hasEnd()&&(n=t.getIndexEndValue()),t.getIndex()===Ar){const r="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",s="Query: When ordering by key, the argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() must be a string.";if(t.hasStart()){if(t.getIndexStartName()!==cs)throw new Error(r);if(typeof e!="string")throw new Error(s)}if(t.hasEnd()){if(t.getIndexEndName()!==Mr)throw new Error(r);if(typeof n!="string")throw new Error(s)}}else if(t.getIndex()===qe){if(e!=null&&!Ul(e)||n!=null&&!Ul(n))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), startAfter() endAt(), endBefore(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if(O(t.getIndex()instanceof ky||t.getIndex()===Ry,"unknown index type."),e!=null&&typeof e=="object"||n!=null&&typeof n=="object")throw new Error("Query: First argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() cannot be an object.")}function Bf(t){if(t.hasStart()&&t.hasEnd()&&t.hasLimit()&&!t.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), startAfter(), endAt(), endBefore(), and limit(). Use limitToFirst() or limitToLast() instead.")}class Yn extends En{constructor(e,n){super(e,n,new Cf,!1)}get parent(){const e=ik(this._path);return e===null?null:new Yn(this._repo,e)}get root(){let e=this;for(;e.parent!==null;)e=e.parent;return e}}class io{constructor(e,n,r){this._node=e,this.ref=n,this._index=r}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){const n=new Ae(e),r=oo(this.ref,e);return new io(this._node.getChild(n),r,qe)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return this._node.isLeafNode()?!1:!!this._node.forEachChild(this._index,(r,s)=>e(new io(s,oo(this.ref,r),qe)))}hasChild(e){const n=new Ae(e);return!this._node.getChild(n).isEmpty()}hasChildren(){return this._node.isLeafNode()?!1:!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}}function Yk(t,e){return t=N(t),t._checkNotDeleted("ref"),e!==void 0?oo(t._root,e):t._root}function aE(t,e){t=N(t),t._checkNotDeleted("refFromURL");const n=km(e,t._repo.repoInfo_.nodeAdmin);Uk("refFromURL",n);const r=n.repoInfo;return!t._repo.repoInfo_.isCustomHost()&&r.host!==t._repo.repoInfo_.host&&Or("refFromURL: Host name does not match the current database: (found "+r.host+" but expected "+t._repo.repoInfo_.host+")"),Yk(t,n.path.toString())}function oo(t,e){return t=N(t),pe(t._path)===null?JW("child","path",e,!1):$l("child","path",e,!1),new Yn(t._repo,ze(t._path,e))}function vG(t,e){t=N(t),qn("push",t._path),Lr("push",e,t._path,!0);const n=qk(t._repo),r=AH(n),s=oo(t,r),i=oo(t,r);let o;return e!=null?o=ev(i,e).then(()=>i):o=Promise.resolve(i),s.then=o.then.bind(o),s.catch=o.then.bind(o,void 0),s}function wG(t){return qn("remove",t._path),ev(t,null)}function ev(t,e){t=N(t),qn("set",t._path),Lr("set",e,t._path,!1);const n=new mt;return Jy(t._repo,t._path,e,null,n.wrapCallback(()=>{})),n.promise}function bG(t,e){t=N(t),qn("setPriority",t._path),Qy("setPriority",e,!1);const n=new mt;return Jy(t._repo,ze(t._path,".priority"),e,null,n.wrapCallback(()=>{})),n.promise}function IG(t,e,n){if(qn("setWithPriority",t._path),Lr("setWithPriority",e,t._path,!1),Qy("setWithPriority",n,!1),t.key===".length"||t.key===".keys")throw"setWithPriority failed: "+t.key+" is a read-only object.";const r=new mt;return Jy(t._repo,t._path,e,n,r.wrapCallback(()=>{})),r.promise}function EG(t,e){Fk("update",e,t._path,!1);const n=new mt;return iG(t._repo,t._path,e,n.wrapCallback(()=>{})),n.promise}function TG(t){return t=N(t),sG(t._repo,t).then(e=>new io(e,new Yn(t._repo,t._path),t._queryParams.getIndex()))}class qf{constructor(e){this.callbackContext=e}respondsTo(e){return e==="value"}createEvent(e,n){const r=n._queryParams.getIndex();return new Gk("value",this,new io(e.snapshotNode,new Yn(n._repo,n._path),r))}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,n){return this.callbackContext.hasCancelCallback?new zk(this,e,n):null}matches(e){return e instanceof qf?!e.callbackContext||!this.callbackContext?!0:e.callbackContext.matches(this.callbackContext):!1}hasAnyCallback(){return this.callbackContext!==null}}class jf{constructor(e,n){this.eventType=e,this.callbackContext=n}respondsTo(e){let n=e==="children_added"?"child_added":e;return n=n==="children_removed"?"child_removed":n,this.eventType===n}createCancelEvent(e,n){return this.callbackContext.hasCancelCallback?new zk(this,e,n):null}createEvent(e,n){O(e.childName!=null,"Child events should have a childName.");const r=oo(new Yn(n._repo,n._path),e.childName),s=n._queryParams.getIndex();return new Gk(e.type,this,new io(e.snapshotNode,r,s),e.prevName)}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,e.prevName)}matches(e){return e instanceof jf?this.eventType===e.eventType&&(!this.callbackContext||!e.callbackContext||this.callbackContext.matches(e.callbackContext)):!1}hasAnyCallback(){return!!this.callbackContext}}function Cu(t,e,n,r,s){let i;if(typeof r=="object"&&(i=void 0,s=r),typeof r=="function"&&(i=r),s&&s.onlyOnce){const c=n,l=(u,h)=>{Am(t._repo,t,a),c(u,h)};l.userCallback=n.userCallback,l.context=n.context,n=l}const o=new Qk(n,i||void 0),a=e==="value"?new qf(o):new jf(e,o);return uG(t._repo,t,a),()=>Am(t._repo,t,a)}function Rm(t,e,n,r){return Cu(t,"value",e,n,r)}function cE(t,e,n,r){return Cu(t,"child_added",e,n,r)}function lE(t,e,n,r){return Cu(t,"child_changed",e,n,r)}function uE(t,e,n,r){return Cu(t,"child_moved",e,n,r)}function hE(t,e,n,r){return Cu(t,"child_removed",e,n,r)}function dE(t,e,n){let r=null;const s=n?new Qk(n):null;e==="value"?r=new qf(s):e&&(r=new jf(e,s)),Am(t._repo,t,r)}class dr{}class Jk extends dr{constructor(e,n){super(),this._value=e,this._key=n}_apply(e){Lr("endAt",this._value,e._path,!0);const n=ym(e._queryParams,this._value,this._key);if(Bf(n),li(n),e._queryParams.hasEnd())throw new Error("endAt: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new En(e._repo,e._path,n,e._orderByCalled)}}function SG(t,e){return Tu("endAt","key",e,!0),new Jk(t,e)}class CG extends dr{constructor(e,n){super(),this._value=e,this._key=n}_apply(e){Lr("endBefore",this._value,e._path,!1);const n=OH(e._queryParams,this._value,this._key);if(Bf(n),li(n),e._queryParams.hasEnd())throw new Error("endBefore: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new En(e._repo,e._path,n,e._orderByCalled)}}function AG(t,e){return Tu("endBefore","key",e,!0),new CG(t,e)}class Xk extends dr{constructor(e,n){super(),this._value=e,this._key=n}_apply(e){Lr("startAt",this._value,e._path,!0);const n=_m(e._queryParams,this._value,this._key);if(Bf(n),li(n),e._queryParams.hasStart())throw new Error("startAt: Starting point was already set (by another call to startAt, startBefore or equalTo).");return new En(e._repo,e._path,n,e._orderByCalled)}}function kG(t=null,e){return Tu("startAt","key",e,!0),new Xk(t,e)}class RG extends dr{constructor(e,n){super(),this._value=e,this._key=n}_apply(e){Lr("startAfter",this._value,e._path,!1);const n=xH(e._queryParams,this._value,this._key);if(Bf(n),li(n),e._queryParams.hasStart())throw new Error("startAfter: Starting point was already set (by another call to startAt, startAfter, or equalTo).");return new En(e._repo,e._path,n,e._orderByCalled)}}function NG(t,e){return Tu("startAfter","key",e,!0),new RG(t,e)}class PG extends dr{constructor(e){super(),this._limit=e}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToFirst: Limit was already set (by another call to limitToFirst or limitToLast).");return new En(e._repo,e._path,PH(e._queryParams,this._limit),e._orderByCalled)}}function DG(t){if(typeof t!="number"||Math.floor(t)!==t||t<=0)throw new Error("limitToFirst: First argument must be a positive integer.");return new PG(t)}class xG extends dr{constructor(e){super(),this._limit=e}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToLast: Limit was already set (by another call to limitToFirst or limitToLast).");return new En(e._repo,e._path,DH(e._queryParams,this._limit),e._orderByCalled)}}function OG(t){if(typeof t!="number"||Math.floor(t)!==t||t<=0)throw new Error("limitToLast: First argument must be a positive integer.");return new xG(t)}class MG extends dr{constructor(e){super(),this._path=e}_apply(e){Vf(e,"orderByChild");const n=new Ae(this._path);if(ge(n))throw new Error("orderByChild: cannot pass in empty path. Use orderByValue() instead.");const r=new ky(n),s=Af(e._queryParams,r);return li(s),new En(e._repo,e._path,s,!0)}}function LG(t){if(t==="$key")throw new Error('orderByChild: "$key" is invalid.  Use orderByKey() instead.');if(t==="$priority")throw new Error('orderByChild: "$priority" is invalid.  Use orderByPriority() instead.');if(t==="$value")throw new Error('orderByChild: "$value" is invalid.  Use orderByValue() instead.');return $l("orderByChild","path",t,!1),new MG(t)}class FG extends dr{_apply(e){Vf(e,"orderByKey");const n=Af(e._queryParams,Ar);return li(n),new En(e._repo,e._path,n,!0)}}function UG(){return new FG}class $G extends dr{_apply(e){Vf(e,"orderByPriority");const n=Af(e._queryParams,qe);return li(n),new En(e._repo,e._path,n,!0)}}function VG(){return new $G}class BG extends dr{_apply(e){Vf(e,"orderByValue");const n=Af(e._queryParams,Ry);return li(n),new En(e._repo,e._path,n,!0)}}function qG(){return new BG}class jG extends dr{constructor(e,n){super(),this._value=e,this._key=n}_apply(e){if(Lr("equalTo",this._value,e._path,!1),e._queryParams.hasStart())throw new Error("equalTo: Starting point was already set (by another call to startAt/startAfter or equalTo).");if(e._queryParams.hasEnd())throw new Error("equalTo: Ending point was already set (by another call to endAt/endBefore or equalTo).");return new Jk(this._value,this._key)._apply(new Xk(this._value,this._key)._apply(e))}}function KG(t,e){return Tu("equalTo","key",e,!0),new jG(t,e)}function Xn(t,...e){let n=N(t);for(const r of e)n=r._apply(n);return n}IW(Yn);AW(Yn);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HG="FIREBASE_DATABASE_EMULATOR_HOST",Nm={};let WG=!1;function GG(t,e,n,r){t.repoInfo_=new YA(`${e}:${n}`,!1,t.repoInfo_.namespace,t.repoInfo_.webSocketOnly,t.repoInfo_.nodeAdmin,t.repoInfo_.persistenceKey,t.repoInfo_.includeNamespaceInQueryParams),r&&(t.authTokenProvider_=r)}function Zk(t,e,n,r,s){let i=r||t.options.databaseURL;i===void 0&&(t.options.projectId||Or("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),Ct("Using default host for project ",t.options.projectId),i=`${t.options.projectId}-default-rtdb.firebaseio.com`);let o=km(i,s),a=o.repoInfo,c,l;typeof process!="undefined"&&process.env&&(l=process.env[HG]),l?(c=!0,i=`http://${l}?ns=${a.namespace}`,o=km(i,s),a=o.repoInfo):c=!o.repoInfo.secure;const u=s&&c?new ca(ca.OWNER):new MK(t.name,t.options,e);Uk("Invalid Firebase Database URL",o),ge(o.path)||Or("Database URL must point to the root of a Firebase Database (not including a child path).");const h=QG(a,t,u,new OK(t.name,n));return new YG(h,t)}function zG(t,e){const n=Nm[e];(!n||n[t.key]!==t)&&Or(`Database ${e}(${t.repoInfo_}) has already been deleted.`),jk(t),delete n[t.key]}function QG(t,e,n,r){let s=Nm[e.name];s||(s={},Nm[e.name]=s);let i=s[t.toURLString()];return i&&Or("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),i=new tG(t,WG,n,r),s[t.toURLString()]=i,i}class YG{constructor(e,n){this._repoInternal=e,this.app=n,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(nG(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new Yn(this._repo,Te())),this._rootInternal}_delete(){return this._rootInternal!==null&&(zG(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){this._rootInternal===null&&Or("Cannot call "+e+" on a deleted database.")}}function eR(){Ta.IS_TRANSPORT_INITIALIZED&&Xt("Transport has already been initialized. Please call this function before calling ref or setting up a listener")}function JG(){eR(),Ms.forceDisallow()}function XG(){eR(),$n.forceDisallow(),Ms.forceAllow()}function ZG(t,e,n,r={}){t=N(t),t._checkNotDeleted("useEmulator"),t._instanceStarted&&Or("Cannot call useEmulator() after instance has already been initialized.");const s=t._repoInternal;let i;if(s.repoInfo_.nodeAdmin)r.mockUserToken&&Or('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),i=new ca(ca.OWNER);else if(r.mockUserToken){const o=typeof r.mockUserToken=="string"?r.mockUserToken:$_(r.mockUserToken,t.app.options.projectId);i=new ca(o)}GG(s,e,n,i)}function ez(t){t=N(t),t._checkNotDeleted("goOffline"),jk(t._repo)}function tz(t){t=N(t),t._checkNotDeleted("goOnline"),hG(t._repo)}function nz(t,e){FA(t,e)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rz(t){xA(Br),st(new Ee("database",(e,{instanceIdentifier:n})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("auth-internal"),i=e.getProvider("app-check-internal");return Zk(r,s,i,n)},"PUBLIC").setMultipleInstances(!0)),Fe(AI,kI,t),Fe(AI,kI,"esm2017")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sz={".sv":"timestamp"};function iz(){return sz}function oz(t){return{".sv":{increment:t}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class az{constructor(e,n){this.committed=e,this.snapshot=n}toJSON(){return{committed:this.committed,snapshot:this.snapshot.toJSON()}}}function cz(t,e,n){var r;if(t=N(t),qn("Reference.transaction",t._path),t.key===".length"||t.key===".keys")throw"Reference.transaction failed: "+t.key+" is a read-only object.";const s=(r=n==null?void 0:n.applyLocally)!==null&&r!==void 0?r:!0,i=new mt,o=(c,l,u)=>{let h=null;c?i.reject(c):(h=new io(u,new Yn(t._repo,t._path),qe),i.resolve(new az(l,h)))},a=Rm(t,()=>{});return dG(t._repo,t._path,e,o,a,s),i.promise}rs.prototype.simpleListen=function(t,e){this.sendRequest("q",{p:t},e)};rs.prototype.echo=function(t,e){this.sendRequest("echo",{d:t},e)};rz();const lz="@firebase/database-compat",uz="0.2.3";/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hz=new Vr("@firebase/database-compat"),tR=function(t){const e="FIREBASE WARNING: "+t;hz.warn(e)};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dz=function(t,e,n,r){if(!(r&&n===void 0)&&typeof n!="boolean")throw new Error(bn(t,e)+"must be a boolean.")},fz=function(t,e,n){if(!(n&&e===void 0))switch(e){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:throw new Error(bn(t,"eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pz{constructor(e){this._delegate=e}cancel(e){re("OnDisconnect.cancel",0,1,arguments.length),Et("OnDisconnect.cancel","onComplete",e,!0);const n=this._delegate.cancel();return e&&n.then(()=>e(null),r=>e(r)),n}remove(e){re("OnDisconnect.remove",0,1,arguments.length),Et("OnDisconnect.remove","onComplete",e,!0);const n=this._delegate.remove();return e&&n.then(()=>e(null),r=>e(r)),n}set(e,n){re("OnDisconnect.set",1,2,arguments.length),Et("OnDisconnect.set","onComplete",n,!0);const r=this._delegate.set(e);return n&&r.then(()=>n(null),s=>n(s)),r}setWithPriority(e,n,r){re("OnDisconnect.setWithPriority",2,3,arguments.length),Et("OnDisconnect.setWithPriority","onComplete",r,!0);const s=this._delegate.setWithPriority(e,n);return r&&s.then(()=>r(null),i=>r(i)),s}update(e,n){if(re("OnDisconnect.update",1,2,arguments.length),Array.isArray(e)){const s={};for(let i=0;i<e.length;++i)s[""+i]=e[i];e=s,tR("Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}Et("OnDisconnect.update","onComplete",n,!0);const r=this._delegate.update(e);return n&&r.then(()=>n(null),s=>n(s)),r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gz{constructor(e,n){this.committed=e,this.snapshot=n}toJSON(){return re("TransactionResult.toJSON",0,1,arguments.length),{committed:this.committed,snapshot:this.snapshot.toJSON()}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class js{constructor(e,n){this._database=e,this._delegate=n}val(){return re("DataSnapshot.val",0,0,arguments.length),this._delegate.val()}exportVal(){return re("DataSnapshot.exportVal",0,0,arguments.length),this._delegate.exportVal()}toJSON(){return re("DataSnapshot.toJSON",0,1,arguments.length),this._delegate.toJSON()}exists(){return re("DataSnapshot.exists",0,0,arguments.length),this._delegate.exists()}child(e){return re("DataSnapshot.child",0,1,arguments.length),e=String(e),$l("DataSnapshot.child","path",e,!1),new js(this._database,this._delegate.child(e))}hasChild(e){return re("DataSnapshot.hasChild",1,1,arguments.length),$l("DataSnapshot.hasChild","path",e,!1),this._delegate.hasChild(e)}getPriority(){return re("DataSnapshot.getPriority",0,0,arguments.length),this._delegate.priority}forEach(e){return re("DataSnapshot.forEach",1,1,arguments.length),Et("DataSnapshot.forEach","action",e,!1),this._delegate.forEach(n=>e(new js(this._database,n)))}hasChildren(){return re("DataSnapshot.hasChildren",0,0,arguments.length),this._delegate.hasChildren()}get key(){return this._delegate.key}numChildren(){return re("DataSnapshot.numChildren",0,0,arguments.length),this._delegate.size}getRef(){return re("DataSnapshot.ref",0,0,arguments.length),new kn(this._database,this._delegate.ref)}get ref(){return this.getRef()}}class Ut{constructor(e,n){this.database=e,this._delegate=n}on(e,n,r,s){var i;re("Query.on",2,4,arguments.length),Et("Query.on","callback",n,!1);const o=Ut.getCancelAndContextArgs_("Query.on",r,s),a=(l,u)=>{n.call(o.context,new js(this.database,l),u)};a.userCallback=n,a.context=o.context;const c=(i=o.cancel)===null||i===void 0?void 0:i.bind(o.context);switch(e){case"value":return Rm(this._delegate,a,c),n;case"child_added":return cE(this._delegate,a,c),n;case"child_removed":return hE(this._delegate,a,c),n;case"child_changed":return lE(this._delegate,a,c),n;case"child_moved":return uE(this._delegate,a,c),n;default:throw new Error(bn("Query.on","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}}off(e,n,r){if(re("Query.off",0,3,arguments.length),fz("Query.off",e,!0),Et("Query.off","callback",n,!0),qb("Query.off","context",r,!0),n){const s=()=>{};s.userCallback=n,s.context=r,dE(this._delegate,e,s)}else dE(this._delegate,e)}get(){return TG(this._delegate).then(e=>new js(this.database,e))}once(e,n,r,s){re("Query.once",1,4,arguments.length),Et("Query.once","callback",n,!0);const i=Ut.getCancelAndContextArgs_("Query.once",r,s),o=new mt,a=(l,u)=>{const h=new js(this.database,l);n&&n.call(i.context,h,u),o.resolve(h)};a.userCallback=n,a.context=i.context;const c=l=>{i.cancel&&i.cancel.call(i.context,l),o.reject(l)};switch(e){case"value":Rm(this._delegate,a,c,{onlyOnce:!0});break;case"child_added":cE(this._delegate,a,c,{onlyOnce:!0});break;case"child_removed":hE(this._delegate,a,c,{onlyOnce:!0});break;case"child_changed":lE(this._delegate,a,c,{onlyOnce:!0});break;case"child_moved":uE(this._delegate,a,c,{onlyOnce:!0});break;default:throw new Error(bn("Query.once","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}return o.promise}limitToFirst(e){return re("Query.limitToFirst",1,1,arguments.length),new Ut(this.database,Xn(this._delegate,DG(e)))}limitToLast(e){return re("Query.limitToLast",1,1,arguments.length),new Ut(this.database,Xn(this._delegate,OG(e)))}orderByChild(e){return re("Query.orderByChild",1,1,arguments.length),new Ut(this.database,Xn(this._delegate,LG(e)))}orderByKey(){return re("Query.orderByKey",0,0,arguments.length),new Ut(this.database,Xn(this._delegate,UG()))}orderByPriority(){return re("Query.orderByPriority",0,0,arguments.length),new Ut(this.database,Xn(this._delegate,VG()))}orderByValue(){return re("Query.orderByValue",0,0,arguments.length),new Ut(this.database,Xn(this._delegate,qG()))}startAt(e=null,n){return re("Query.startAt",0,2,arguments.length),new Ut(this.database,Xn(this._delegate,kG(e,n)))}startAfter(e=null,n){return re("Query.startAfter",0,2,arguments.length),new Ut(this.database,Xn(this._delegate,NG(e,n)))}endAt(e=null,n){return re("Query.endAt",0,2,arguments.length),new Ut(this.database,Xn(this._delegate,SG(e,n)))}endBefore(e=null,n){return re("Query.endBefore",0,2,arguments.length),new Ut(this.database,Xn(this._delegate,AG(e,n)))}equalTo(e,n){return re("Query.equalTo",1,2,arguments.length),new Ut(this.database,Xn(this._delegate,KG(e,n)))}toString(){return re("Query.toString",0,0,arguments.length),this._delegate.toString()}toJSON(){return re("Query.toJSON",0,1,arguments.length),this._delegate.toJSON()}isEqual(e){if(re("Query.isEqual",1,1,arguments.length),!(e instanceof Ut)){const n="Query.isEqual failed: First argument must be an instance of firebase.database.Query.";throw new Error(n)}return this._delegate.isEqual(e._delegate)}static getCancelAndContextArgs_(e,n,r){const s={cancel:void 0,context:void 0};if(n&&r)s.cancel=n,Et(e,"cancel",s.cancel,!0),s.context=r,qb(e,"context",s.context,!0);else if(n)if(typeof n=="object"&&n!==null)s.context=n;else if(typeof n=="function")s.cancel=n;else throw new Error(bn(e,"cancelOrContext")+" must either be a cancel callback or a context object.");return s}get ref(){return new kn(this.database,new Yn(this._delegate._repo,this._delegate._path))}}class kn extends Ut{constructor(e,n){super(e,new En(n._repo,n._path,new Cf,!1)),this.database=e,this._delegate=n}getKey(){return re("Reference.key",0,0,arguments.length),this._delegate.key}child(e){return re("Reference.child",1,1,arguments.length),typeof e=="number"&&(e=String(e)),new kn(this.database,oo(this._delegate,e))}getParent(){re("Reference.parent",0,0,arguments.length);const e=this._delegate.parent;return e?new kn(this.database,e):null}getRoot(){return re("Reference.root",0,0,arguments.length),new kn(this.database,this._delegate.root)}set(e,n){re("Reference.set",1,2,arguments.length),Et("Reference.set","onComplete",n,!0);const r=ev(this._delegate,e);return n&&r.then(()=>n(null),s=>n(s)),r}update(e,n){if(re("Reference.update",1,2,arguments.length),Array.isArray(e)){const s={};for(let i=0;i<e.length;++i)s[""+i]=e[i];e=s,tR("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}qn("Reference.update",this._delegate._path),Et("Reference.update","onComplete",n,!0);const r=EG(this._delegate,e);return n&&r.then(()=>n(null),s=>n(s)),r}setWithPriority(e,n,r){re("Reference.setWithPriority",2,3,arguments.length),Et("Reference.setWithPriority","onComplete",r,!0);const s=IG(this._delegate,e,n);return r&&s.then(()=>r(null),i=>r(i)),s}remove(e){re("Reference.remove",0,1,arguments.length),Et("Reference.remove","onComplete",e,!0);const n=wG(this._delegate);return e&&n.then(()=>e(null),r=>e(r)),n}transaction(e,n,r){re("Reference.transaction",1,3,arguments.length),Et("Reference.transaction","transactionUpdate",e,!1),Et("Reference.transaction","onComplete",n,!0),dz("Reference.transaction","applyLocally",r,!0);const s=cz(this._delegate,e,{applyLocally:r}).then(i=>new gz(i.committed,new js(this.database,i.snapshot)));return n&&s.then(i=>n(null,i.committed,i.snapshot),i=>n(i,!1,null)),s}setPriority(e,n){re("Reference.setPriority",1,2,arguments.length),Et("Reference.setPriority","onComplete",n,!0);const r=bG(this._delegate,e);return n&&r.then(()=>n(null),s=>n(s)),r}push(e,n){re("Reference.push",0,2,arguments.length),Et("Reference.push","onComplete",n,!0);const r=vG(this._delegate,e),s=r.then(o=>new kn(this.database,o));n&&s.then(()=>n(null),o=>n(o));const i=new kn(this.database,r);return i.then=s.then.bind(s),i.catch=s.catch.bind(s,void 0),i}onDisconnect(){return qn("Reference.onDisconnect",this._delegate._path),new pz(new yG(this._delegate._repo,this._delegate._path))}get key(){return this.getKey()}get parent(){return this.getParent()}get root(){return this.getRoot()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vl{constructor(e,n){this._delegate=e,this.app=n,this.INTERNAL={delete:()=>this._delegate._delete(),forceWebSockets:JG,forceLongPolling:XG}}useEmulator(e,n,r={}){ZG(this._delegate,e,n,r)}ref(e){if(re("database.ref",0,1,arguments.length),e instanceof kn){const n=aE(this._delegate,e.toString());return new kn(this,n)}else{const n=Yk(this._delegate,e);return new kn(this,n)}}refFromURL(e){re("database.refFromURL",1,1,arguments.length);const r=aE(this._delegate,e);return new kn(this,r)}goOffline(){return re("database.goOffline",0,0,arguments.length),ez(this._delegate)}goOnline(){return re("database.goOnline",0,0,arguments.length),tz(this._delegate)}}Vl.ServerValue={TIMESTAMP:iz(),increment:t=>oz(t)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mz({app:t,url:e,version:n,customAuthImpl:r,namespace:s,nodeAdmin:i=!1}){xA(n);const o=new M0("auth-internal",new L0("database-standalone"));return o.setComponent(new Ee("auth-internal",()=>r,"PRIVATE")),{instance:new Vl(Zk(t,o,void 0,e,i),t),namespace:s}}var _z=Object.freeze({__proto__:null,initStandalone:mz});/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yz=Vl.ServerValue;function vz(t){t.INTERNAL.registerComponent(new Ee("database-compat",(e,{instanceIdentifier:n})=>{const r=e.getProvider("app-compat").getImmediate(),s=e.getProvider("database").getImmediate({identifier:n});return new Vl(s,r)},"PUBLIC").setServiceProps({Reference:kn,Query:Ut,Database:Vl,DataSnapshot:js,enableLogging:nz,INTERNAL:_z,ServerValue:yz}).setMultipleInstances(!0)),t.registerVersion(lz,uz)}vz(ht);var wz=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{},W,tv=tv||{},oe=wz||self;function _d(){}function Pm(t){var e=typeof t;return e=e!="object"?e:t?Array.isArray(t)?"array":e:"null",e=="array"||e=="object"&&typeof t.length=="number"}function Au(t){var e=typeof t;return e=="object"&&t!=null||e=="function"}function bz(t){return Object.prototype.hasOwnProperty.call(t,rg)&&t[rg]||(t[rg]=++Iz)}var rg="closure_uid_"+(1e9*Math.random()>>>0),Iz=0;function Ez(t,e,n){return t.call.apply(t.bind,arguments)}function Tz(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var s=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(s,r),t.apply(e,s)}}return function(){return t.apply(e,arguments)}}function Ht(t,e,n){return Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?Ht=Ez:Ht=Tz,Ht.apply(null,arguments)}function ih(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var r=n.slice();return r.push.apply(r,arguments),t.apply(this,r)}}function Qt(t,e){function n(){}n.prototype=e.prototype,t.Z=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.Vb=function(r,s,i){for(var o=Array(arguments.length-2),a=2;a<arguments.length;a++)o[a-2]=arguments[a];return e.prototype[s].apply(r,o)}}function ui(){this.s=this.s,this.o=this.o}var Sz=0;ui.prototype.s=!1;ui.prototype.na=function(){!this.s&&(this.s=!0,this.M(),Sz!=0)&&bz(this)};ui.prototype.M=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const nR=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if(typeof t=="string")return typeof e!="string"||e.length!=1?-1:t.indexOf(e,0);for(let n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},rR=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){const r=t.length,s=typeof t=="string"?t.split(""):t;for(let i=0;i<r;i++)i in s&&e.call(n,s[i],i,t)};function Cz(t){e:{var e=_2;const n=t.length,r=typeof t=="string"?t.split(""):t;for(let s=0;s<n;s++)if(s in r&&e.call(void 0,r[s],s,t)){e=s;break e}e=-1}return 0>e?null:typeof t=="string"?t.charAt(e):t[e]}function fE(t){return Array.prototype.concat.apply([],arguments)}function nv(t){const e=t.length;if(0<e){const n=Array(e);for(let r=0;r<e;r++)n[r]=t[r];return n}return[]}function yd(t){return/^[\s\xa0]*$/.test(t)}var pE=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function an(t,e){return t.indexOf(e)!=-1}function sg(t,e){return t<e?-1:t>e?1:0}var cn;e:{var gE=oe.navigator;if(gE){var mE=gE.userAgent;if(mE){cn=mE;break e}}cn=""}function rv(t,e,n){for(const r in t)e.call(n,t[r],r,t)}function sR(t){const e={};for(const n in t)e[n]=t[n];return e}var _E="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function iR(t,e){let n,r;for(let s=1;s<arguments.length;s++){r=arguments[s];for(n in r)t[n]=r[n];for(let i=0;i<_E.length;i++)n=_E[i],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function sv(t){return sv[" "](t),t}sv[" "]=_d;function Az(t){var e=Nz;return Object.prototype.hasOwnProperty.call(e,9)?e[9]:e[9]=t(9)}var kz=an(cn,"Opera"),Na=an(cn,"Trident")||an(cn,"MSIE"),oR=an(cn,"Edge"),Dm=oR||Na,aR=an(cn,"Gecko")&&!(an(cn.toLowerCase(),"webkit")&&!an(cn,"Edge"))&&!(an(cn,"Trident")||an(cn,"MSIE"))&&!an(cn,"Edge"),Rz=an(cn.toLowerCase(),"webkit")&&!an(cn,"Edge");function cR(){var t=oe.document;return t?t.documentMode:void 0}var vd;e:{var ig="",og=function(){var t=cn;if(aR)return/rv:([^\);]+)(\)|;)/.exec(t);if(oR)return/Edge\/([\d\.]+)/.exec(t);if(Na)return/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(t);if(Rz)return/WebKit\/(\S+)/.exec(t);if(kz)return/(?:Version)[ \/]?(\S+)/.exec(t)}();if(og&&(ig=og?og[1]:""),Na){var ag=cR();if(ag!=null&&ag>parseFloat(ig)){vd=String(ag);break e}}vd=ig}var Nz={};function Pz(){return Az(function(){let t=0;const e=pE(String(vd)).split("."),n=pE("9").split("."),r=Math.max(e.length,n.length);for(let o=0;t==0&&o<r;o++){var s=e[o]||"",i=n[o]||"";do{if(s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],i=/(\d*)(\D*)(.*)/.exec(i)||["","","",""],s[0].length==0&&i[0].length==0)break;t=sg(s[1].length==0?0:parseInt(s[1],10),i[1].length==0?0:parseInt(i[1],10))||sg(s[2].length==0,i[2].length==0)||sg(s[2],i[2]),s=s[3],i=i[3]}while(t==0)}return 0<=t})}var xm;if(oe.document&&Na){var yE=cR();xm=yE||parseInt(vd,10)||void 0}else xm=void 0;var Dz=xm,xz=function(){if(!oe.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{oe.addEventListener("test",_d,e),oe.removeEventListener("test",_d,e)}catch{}return t}();function Zt(t,e){this.type=t,this.g=this.target=e,this.defaultPrevented=!1}Zt.prototype.h=function(){this.defaultPrevented=!0};function Bl(t,e){if(Zt.call(this,t?t.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.g=e,e=t.relatedTarget){if(aR){e:{try{sv(e.nodeName);var s=!0;break e}catch{}s=!1}s||(e=null)}}else n=="mouseover"?e=t.fromElement:n=="mouseout"&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=r.clientX!==void 0?r.clientX:r.pageX,this.clientY=r.clientY!==void 0?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=t.clientX!==void 0?t.clientX:t.pageX,this.clientY=t.clientY!==void 0?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType=typeof t.pointerType=="string"?t.pointerType:Oz[t.pointerType]||"",this.state=t.state,this.i=t,t.defaultPrevented&&Bl.Z.h.call(this)}}Qt(Bl,Zt);var Oz={2:"touch",3:"pen",4:"mouse"};Bl.prototype.h=function(){Bl.Z.h.call(this);var t=this.i;t.preventDefault?t.preventDefault():t.returnValue=!1};var ku="closure_listenable_"+(1e6*Math.random()|0),Mz=0;function Lz(t,e,n,r,s){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ia=s,this.key=++Mz,this.ca=this.fa=!1}function Kf(t){t.ca=!0,t.listener=null,t.proxy=null,t.src=null,t.ia=null}function Hf(t){this.src=t,this.g={},this.h=0}Hf.prototype.add=function(t,e,n,r,s){var i=t.toString();t=this.g[i],t||(t=this.g[i]=[],this.h++);var o=Mm(t,e,r,s);return-1<o?(e=t[o],n||(e.fa=!1)):(e=new Lz(e,this.src,i,!!r,s),e.fa=n,t.push(e)),e};function Om(t,e){var n=e.type;if(n in t.g){var r=t.g[n],s=nR(r,e),i;(i=0<=s)&&Array.prototype.splice.call(r,s,1),i&&(Kf(e),t.g[n].length==0&&(delete t.g[n],t.h--))}}function Mm(t,e,n,r){for(var s=0;s<t.length;++s){var i=t[s];if(!i.ca&&i.listener==e&&i.capture==!!n&&i.ia==r)return s}return-1}var iv="closure_lm_"+(1e6*Math.random()|0),cg={};function lR(t,e,n,r,s){if(r&&r.once)return hR(t,e,n,r,s);if(Array.isArray(e)){for(var i=0;i<e.length;i++)lR(t,e[i],n,r,s);return null}return n=cv(n),t&&t[ku]?t.N(e,n,Au(r)?!!r.capture:!!r,s):uR(t,e,n,!1,r,s)}function uR(t,e,n,r,s,i){if(!e)throw Error("Invalid event type");var o=Au(s)?!!s.capture:!!s,a=av(t);if(a||(t[iv]=a=new Hf(t)),n=a.add(e,n,r,o,i),n.proxy)return n;if(r=Fz(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)xz||(s=o),s===void 0&&(s=!1),t.addEventListener(e.toString(),r,s);else if(t.attachEvent)t.attachEvent(fR(e.toString()),r);else if(t.addListener&&t.removeListener)t.addListener(r);else throw Error("addEventListener and attachEvent are unavailable.");return n}function Fz(){function t(n){return e.call(t.src,t.listener,n)}var e=Uz;return t}function hR(t,e,n,r,s){if(Array.isArray(e)){for(var i=0;i<e.length;i++)hR(t,e[i],n,r,s);return null}return n=cv(n),t&&t[ku]?t.O(e,n,Au(r)?!!r.capture:!!r,s):uR(t,e,n,!0,r,s)}function dR(t,e,n,r,s){if(Array.isArray(e))for(var i=0;i<e.length;i++)dR(t,e[i],n,r,s);else r=Au(r)?!!r.capture:!!r,n=cv(n),t&&t[ku]?(t=t.i,e=String(e).toString(),e in t.g&&(i=t.g[e],n=Mm(i,n,r,s),-1<n&&(Kf(i[n]),Array.prototype.splice.call(i,n,1),i.length==0&&(delete t.g[e],t.h--)))):t&&(t=av(t))&&(e=t.g[e.toString()],t=-1,e&&(t=Mm(e,n,r,s)),(n=-1<t?e[t]:null)&&ov(n))}function ov(t){if(typeof t!="number"&&t&&!t.ca){var e=t.src;if(e&&e[ku])Om(e.i,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(fR(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=av(e))?(Om(n,t),n.h==0&&(n.src=null,e[iv]=null)):Kf(t)}}}function fR(t){return t in cg?cg[t]:cg[t]="on"+t}function Uz(t,e){if(t.ca)t=!0;else{e=new Bl(e,this);var n=t.listener,r=t.ia||t.src;t.fa&&ov(t),t=n.call(r,e)}return t}function av(t){return t=t[iv],t instanceof Hf?t:null}var lg="__closure_events_fn_"+(1e9*Math.random()>>>0);function cv(t){return typeof t=="function"?t:(t[lg]||(t[lg]=function(e){return t.handleEvent(e)}),t[lg])}function Ot(){ui.call(this),this.i=new Hf(this),this.P=this,this.I=null}Qt(Ot,ui);Ot.prototype[ku]=!0;Ot.prototype.removeEventListener=function(t,e,n,r){dR(this,t,e,n,r)};function Wt(t,e){var n,r=t.I;if(r)for(n=[];r;r=r.I)n.push(r);if(t=t.P,r=e.type||e,typeof e=="string")e=new Zt(e,t);else if(e instanceof Zt)e.target=e.target||t;else{var s=e;e=new Zt(r,t),iR(e,s)}if(s=!0,n)for(var i=n.length-1;0<=i;i--){var o=e.g=n[i];s=oh(o,r,!0,e)&&s}if(o=e.g=t,s=oh(o,r,!0,e)&&s,s=oh(o,r,!1,e)&&s,n)for(i=0;i<n.length;i++)o=e.g=n[i],s=oh(o,r,!1,e)&&s}Ot.prototype.M=function(){if(Ot.Z.M.call(this),this.i){var t=this.i,e;for(e in t.g){for(var n=t.g[e],r=0;r<n.length;r++)Kf(n[r]);delete t.g[e],t.h--}}this.I=null};Ot.prototype.N=function(t,e,n,r){return this.i.add(String(t),e,!1,n,r)};Ot.prototype.O=function(t,e,n,r){return this.i.add(String(t),e,!0,n,r)};function oh(t,e,n,r){if(e=t.i.g[String(e)],!e)return!0;e=e.concat();for(var s=!0,i=0;i<e.length;++i){var o=e[i];if(o&&!o.ca&&o.capture==n){var a=o.listener,c=o.ia||o.src;o.fa&&Om(t.i,o),s=a.call(c,r)!==!1&&s}}return s&&!r.defaultPrevented}var lv=oe.JSON.stringify;function $z(){var t=gR;let e=null;return t.g&&(e=t.g,t.g=t.g.next,t.g||(t.h=null),e.next=null),e}class Vz{constructor(){this.h=this.g=null}add(e,n){const r=pR.get();r.set(e,n),this.h?this.h.next=r:this.g=r,this.h=r}}var pR=new class{constructor(t,e){this.i=t,this.j=e,this.h=0,this.g=null}get(){let t;return 0<this.h?(this.h--,t=this.g,this.g=t.next,t.next=null):t=this.i(),t}}(()=>new Bz,t=>t.reset());class Bz{constructor(){this.next=this.g=this.h=null}set(e,n){this.h=e,this.g=n,this.next=null}reset(){this.next=this.g=this.h=null}}function qz(t){oe.setTimeout(()=>{throw t},0)}function uv(t,e){Lm||jz(),Fm||(Lm(),Fm=!0),gR.add(t,e)}var Lm;function jz(){var t=oe.Promise.resolve(void 0);Lm=function(){t.then(Kz)}}var Fm=!1,gR=new Vz;function Kz(){for(var t;t=$z();){try{t.h.call(t.g)}catch(n){qz(n)}var e=pR;e.j(t),100>e.h&&(e.h++,t.next=e.g,e.g=t)}Fm=!1}function Wf(t,e){Ot.call(this),this.h=t||1,this.g=e||oe,this.j=Ht(this.kb,this),this.l=Date.now()}Qt(Wf,Ot);W=Wf.prototype;W.da=!1;W.S=null;W.kb=function(){if(this.da){var t=Date.now()-this.l;0<t&&t<.8*this.h?this.S=this.g.setTimeout(this.j,this.h-t):(this.S&&(this.g.clearTimeout(this.S),this.S=null),Wt(this,"tick"),this.da&&(hv(this),this.start()))}};W.start=function(){this.da=!0,this.S||(this.S=this.g.setTimeout(this.j,this.h),this.l=Date.now())};function hv(t){t.da=!1,t.S&&(t.g.clearTimeout(t.S),t.S=null)}W.M=function(){Wf.Z.M.call(this),hv(this),delete this.g};function dv(t,e,n){if(typeof t=="function")n&&(t=Ht(t,n));else if(t&&typeof t.handleEvent=="function")t=Ht(t.handleEvent,t);else throw Error("Invalid listener argument");return 2147483647<Number(e)?-1:oe.setTimeout(t,e||0)}function mR(t){t.g=dv(()=>{t.g=null,t.i&&(t.i=!1,mR(t))},t.j);const e=t.h;t.h=null,t.m.apply(null,e)}class Hz extends ui{constructor(e,n){super(),this.m=e,this.j=n,this.h=null,this.i=!1,this.g=null}l(e){this.h=arguments,this.g?this.i=!0:mR(this)}M(){super.M(),this.g&&(oe.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function ql(t){ui.call(this),this.h=t,this.g={}}Qt(ql,ui);var vE=[];function _R(t,e,n,r){Array.isArray(n)||(n&&(vE[0]=n.toString()),n=vE);for(var s=0;s<n.length;s++){var i=lR(e,n[s],r||t.handleEvent,!1,t.h||t);if(!i)break;t.g[i.key]=i}}function yR(t){rv(t.g,function(e,n){this.g.hasOwnProperty(n)&&ov(e)},t),t.g={}}ql.prototype.M=function(){ql.Z.M.call(this),yR(this)};ql.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};function Gf(){this.g=!0}Gf.prototype.Aa=function(){this.g=!1};function Wz(t,e,n,r,s,i){t.info(function(){if(t.g)if(i)for(var o="",a=i.split("&"),c=0;c<a.length;c++){var l=a[c].split("=");if(1<l.length){var u=l[0];l=l[1];var h=u.split("_");o=2<=h.length&&h[1]=="type"?o+(u+"="+l+"&"):o+(u+"=redacted&")}}else o=null;else o=i;return"XMLHTTP REQ ("+r+") [attempt "+s+"]: "+e+`
`+n+`
`+o})}function Gz(t,e,n,r,s,i,o){t.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+s+"]: "+e+`
`+n+`
`+i+" "+o})}function Jo(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+Qz(t,n)+(r?" "+r:"")})}function zz(t,e){t.info(function(){return"TIMEOUT: "+e})}Gf.prototype.info=function(){};function Qz(t,e){if(!t.g)return e;if(!e)return null;try{var n=JSON.parse(e);if(n){for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(2>r.length)){var s=r[1];if(Array.isArray(s)&&!(1>s.length)){var i=s[0];if(i!="noop"&&i!="stop"&&i!="close")for(var o=1;o<s.length;o++)s[o]=""}}}}return lv(n)}catch{return e}}var No={},wE=null;function zf(){return wE=wE||new Ot}No.Ma="serverreachability";function vR(t){Zt.call(this,No.Ma,t)}Qt(vR,Zt);function jl(t){const e=zf();Wt(e,new vR(e))}No.STAT_EVENT="statevent";function wR(t,e){Zt.call(this,No.STAT_EVENT,t),this.stat=e}Qt(wR,Zt);function hn(t){const e=zf();Wt(e,new wR(e,t))}No.Na="timingevent";function bR(t,e){Zt.call(this,No.Na,t),this.size=e}Qt(bR,Zt);function Ru(t,e){if(typeof t!="function")throw Error("Fn must not be null and must be a function");return oe.setTimeout(function(){t()},e)}var Qf={NO_ERROR:0,lb:1,yb:2,xb:3,sb:4,wb:5,zb:6,Ja:7,TIMEOUT:8,Cb:9},IR={qb:"complete",Mb:"success",Ka:"error",Ja:"abort",Eb:"ready",Fb:"readystatechange",TIMEOUT:"timeout",Ab:"incrementaldata",Db:"progress",tb:"downloadprogress",Ub:"uploadprogress"};function fv(){}fv.prototype.h=null;function bE(t){return t.h||(t.h=t.i())}function ER(){}var Nu={OPEN:"a",pb:"b",Ka:"c",Bb:"d"};function pv(){Zt.call(this,"d")}Qt(pv,Zt);function gv(){Zt.call(this,"c")}Qt(gv,Zt);var Um;function Yf(){}Qt(Yf,fv);Yf.prototype.g=function(){return new XMLHttpRequest};Yf.prototype.i=function(){return{}};Um=new Yf;function Pu(t,e,n,r){this.l=t,this.j=e,this.m=n,this.X=r||1,this.V=new ql(this),this.P=Yz,t=Dm?125:void 0,this.W=new Wf(t),this.H=null,this.i=!1,this.s=this.A=this.v=this.K=this.F=this.Y=this.B=null,this.D=[],this.g=null,this.C=0,this.o=this.u=null,this.N=-1,this.I=!1,this.O=0,this.L=null,this.aa=this.J=this.$=this.U=!1,this.h=new TR}function TR(){this.i=null,this.g="",this.h=!1}var Yz=45e3,$m={},wd={};W=Pu.prototype;W.setTimeout=function(t){this.P=t};function Vm(t,e,n){t.K=1,t.v=Xf(ls(e)),t.s=n,t.U=!0,SR(t,null)}function SR(t,e){t.F=Date.now(),Du(t),t.A=ls(t.v);var n=t.A,r=t.X;Array.isArray(r)||(r=[String(r)]),DR(n.h,"t",r),t.C=0,n=t.l.H,t.h=new TR,t.g=XR(t.l,n?e:null,!t.s),0<t.O&&(t.L=new Hz(Ht(t.Ia,t,t.g),t.O)),_R(t.V,t.g,"readystatechange",t.gb),e=t.H?sR(t.H):{},t.s?(t.u||(t.u="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.g.ea(t.A,t.u,t.s,e)):(t.u="GET",t.g.ea(t.A,t.u,null,e)),jl(),Wz(t.j,t.u,t.A,t.m,t.X,t.s)}W.gb=function(t){t=t.target;const e=this.L;e&&Xr(t)==3?e.l():this.Ia(t)};W.Ia=function(t){try{if(t==this.g)e:{const u=Xr(this.g);var e=this.g.Da();const h=this.g.ba();if(!(3>u)&&(u!=3||Dm||this.g&&(this.h.h||this.g.ga()||SE(this.g)))){this.I||u!=4||e==7||(e==8||0>=h?jl(3):jl(2)),Jf(this);var n=this.g.ba();this.N=n;t:if(CR(this)){var r=SE(this.g);t="";var s=r.length,i=Xr(this.g)==4;if(!this.h.i){if(typeof TextDecoder=="undefined"){$i(this),Zc(this);var o="";break t}this.h.i=new oe.TextDecoder}for(e=0;e<s;e++)this.h.h=!0,t+=this.h.i.decode(r[e],{stream:i&&e==s-1});r.splice(0,s),this.h.g+=t,this.C=0,o=this.h.g}else o=this.g.ga();if(this.i=n==200,Gz(this.j,this.u,this.A,this.m,this.X,u,n),this.i){if(this.$&&!this.J){t:{if(this.g){var a,c=this.g;if((a=c.g?c.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!yd(a)){var l=a;break t}}l=null}if(n=l)Jo(this.j,this.m,n,"Initial handshake response via X-HTTP-Initial-Response"),this.J=!0,Bm(this,n);else{this.i=!1,this.o=3,hn(12),$i(this),Zc(this);break e}}this.U?(AR(this,u,o),Dm&&this.i&&u==3&&(_R(this.V,this.W,"tick",this.fb),this.W.start())):(Jo(this.j,this.m,o,null),Bm(this,o)),u==4&&$i(this),this.i&&!this.I&&(u==4?zR(this.l,this):(this.i=!1,Du(this)))}else n==400&&0<o.indexOf("Unknown SID")?(this.o=3,hn(12)):(this.o=0,hn(13)),$i(this),Zc(this)}}}catch{}finally{}};function CR(t){return t.g?t.u=="GET"&&t.K!=2&&t.l.Ba:!1}function AR(t,e,n){let r=!0,s;for(;!t.I&&t.C<n.length;)if(s=Jz(t,n),s==wd){e==4&&(t.o=4,hn(14),r=!1),Jo(t.j,t.m,null,"[Incomplete Response]");break}else if(s==$m){t.o=4,hn(15),Jo(t.j,t.m,n,"[Invalid Chunk]"),r=!1;break}else Jo(t.j,t.m,s,null),Bm(t,s);CR(t)&&s!=wd&&s!=$m&&(t.h.g="",t.C=0),e!=4||n.length!=0||t.h.h||(t.o=1,hn(16),r=!1),t.i=t.i&&r,r?0<n.length&&!t.aa&&(t.aa=!0,e=t.l,e.g==t&&e.$&&!e.L&&(e.h.info("Great, no buffering proxy detected. Bytes received: "+n.length),Tv(e),e.L=!0,hn(11))):(Jo(t.j,t.m,n,"[Invalid Chunked Response]"),$i(t),Zc(t))}W.fb=function(){if(this.g){var t=Xr(this.g),e=this.g.ga();this.C<e.length&&(Jf(this),AR(this,t,e),this.i&&t!=4&&Du(this))}};function Jz(t,e){var n=t.C,r=e.indexOf(`
`,n);return r==-1?wd:(n=Number(e.substring(n,r)),isNaN(n)?$m:(r+=1,r+n>e.length?wd:(e=e.substr(r,n),t.C=r+n,e)))}W.cancel=function(){this.I=!0,$i(this)};function Du(t){t.Y=Date.now()+t.P,kR(t,t.P)}function kR(t,e){if(t.B!=null)throw Error("WatchDog timer not null");t.B=Ru(Ht(t.eb,t),e)}function Jf(t){t.B&&(oe.clearTimeout(t.B),t.B=null)}W.eb=function(){this.B=null;const t=Date.now();0<=t-this.Y?(zz(this.j,this.A),this.K!=2&&(jl(),hn(17)),$i(this),this.o=2,Zc(this)):kR(this,this.Y-t)};function Zc(t){t.l.G==0||t.I||zR(t.l,t)}function $i(t){Jf(t);var e=t.L;e&&typeof e.na=="function"&&e.na(),t.L=null,hv(t.W),yR(t.V),t.g&&(e=t.g,t.g=null,e.abort(),e.na())}function Bm(t,e){try{var n=t.l;if(n.G!=0&&(n.g==t||qm(n.i,t))){if(n.I=t.N,!t.J&&qm(n.i,t)&&n.G==3){try{var r=n.Ca.g.parse(e)}catch{r=null}if(Array.isArray(r)&&r.length==3){var s=r;if(s[0]==0){e:if(!n.u){if(n.g)if(n.g.F+3e3<t.F)Td(n),tp(n);else break e;Ev(n),hn(18)}}else n.ta=s[1],0<n.ta-n.U&&37500>s[2]&&n.N&&n.A==0&&!n.v&&(n.v=Ru(Ht(n.ab,n),6e3));if(1>=MR(n.i)&&n.ka){try{n.ka()}catch{}n.ka=void 0}}else Vi(n,11)}else if((t.J||n.g==t)&&Td(n),!yd(e))for(s=n.Ca.g.parse(e),e=0;e<s.length;e++){let l=s[e];if(n.U=l[0],l=l[1],n.G==2)if(l[0]=="c"){n.J=l[1],n.la=l[2];const u=l[3];u!=null&&(n.ma=u,n.h.info("VER="+n.ma));const h=l[4];h!=null&&(n.za=h,n.h.info("SVER="+n.za));const d=l[5];d!=null&&typeof d=="number"&&0<d&&(r=1.5*d,n.K=r,n.h.info("backChannelRequestTimeoutMs_="+r)),r=n;const f=t.g;if(f){const p=f.g?f.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(p){var i=r.i;!i.g&&(an(p,"spdy")||an(p,"quic")||an(p,"h2"))&&(i.j=i.l,i.g=new Set,i.h&&(yv(i,i.h),i.h=null))}if(r.D){const _=f.g?f.g.getResponseHeader("X-HTTP-Session-Id"):null;_&&(r.sa=_,Ge(r.F,r.D,_))}}n.G=3,n.j&&n.j.xa(),n.$&&(n.O=Date.now()-t.F,n.h.info("Handshake RTT: "+n.O+"ms")),r=n;var o=t;if(r.oa=JR(r,r.H?r.la:null,r.W),o.J){LR(r.i,o);var a=o,c=r.K;c&&a.setTimeout(c),a.B&&(Jf(a),Du(a)),r.g=o}else WR(r);0<n.l.length&&np(n)}else l[0]!="stop"&&l[0]!="close"||Vi(n,7);else n.G==3&&(l[0]=="stop"||l[0]=="close"?l[0]=="stop"?Vi(n,7):Iv(n):l[0]!="noop"&&n.j&&n.j.wa(l),n.A=0)}}jl(4)}catch{}}function Xz(t){if(t.R&&typeof t.R=="function")return t.R();if(typeof t=="string")return t.split("");if(Pm(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}e=[],n=0;for(r in t)e[n++]=t[r];return e}function mv(t,e){if(t.forEach&&typeof t.forEach=="function")t.forEach(e,void 0);else if(Pm(t)||typeof t=="string")rR(t,e,void 0);else{if(t.T&&typeof t.T=="function")var n=t.T();else if(t.R&&typeof t.R=="function")n=void 0;else if(Pm(t)||typeof t=="string"){n=[];for(var r=t.length,s=0;s<r;s++)n.push(s)}else for(s in n=[],r=0,t)n[r++]=s;r=Xz(t),s=r.length;for(var i=0;i<s;i++)e.call(void 0,r[i],n&&n[i],t)}}function ec(t,e){this.h={},this.g=[],this.i=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof ec)for(n=t.T(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}W=ec.prototype;W.R=function(){_v(this);for(var t=[],e=0;e<this.g.length;e++)t.push(this.h[this.g[e]]);return t};W.T=function(){return _v(this),this.g.concat()};function _v(t){if(t.i!=t.g.length){for(var e=0,n=0;e<t.g.length;){var r=t.g[e];ao(t.h,r)&&(t.g[n++]=r),e++}t.g.length=n}if(t.i!=t.g.length){var s={};for(n=e=0;e<t.g.length;)r=t.g[e],ao(s,r)||(t.g[n++]=r,s[r]=1),e++;t.g.length=n}}W.get=function(t,e){return ao(this.h,t)?this.h[t]:e};W.set=function(t,e){ao(this.h,t)||(this.i++,this.g.push(t)),this.h[t]=e};W.forEach=function(t,e){for(var n=this.T(),r=0;r<n.length;r++){var s=n[r],i=this.get(s);t.call(e,i,s,this)}};function ao(t,e){return Object.prototype.hasOwnProperty.call(t,e)}var RR=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Zz(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),s=null;if(0<=r){var i=t[n].substring(0,r);s=t[n].substring(r+1)}else i=t[n];e(i,s?decodeURIComponent(s.replace(/\+/g," ")):"")}}}function co(t,e){if(this.i=this.s=this.j="",this.m=null,this.o=this.l="",this.g=!1,t instanceof co){this.g=e!==void 0?e:t.g,bd(this,t.j),this.s=t.s,Id(this,t.i),Ed(this,t.m),this.l=t.l,e=t.h;var n=new Kl;n.i=e.i,e.g&&(n.g=new ec(e.g),n.h=e.h),IE(this,n),this.o=t.o}else t&&(n=String(t).match(RR))?(this.g=!!e,bd(this,n[1]||"",!0),this.s=el(n[2]||""),Id(this,n[3]||"",!0),Ed(this,n[4]),this.l=el(n[5]||"",!0),IE(this,n[6]||"",!0),this.o=el(n[7]||"")):(this.g=!!e,this.h=new Kl(null,this.g))}co.prototype.toString=function(){var t=[],e=this.j;e&&t.push(Mc(e,EE,!0),":");var n=this.i;return(n||e=="file")&&(t.push("//"),(e=this.s)&&t.push(Mc(e,EE,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),n=this.m,n!=null&&t.push(":",String(n))),(n=this.l)&&(this.i&&n.charAt(0)!="/"&&t.push("/"),t.push(Mc(n,n.charAt(0)=="/"?s2:r2,!0))),(n=this.h.toString())&&t.push("?",n),(n=this.o)&&t.push("#",Mc(n,o2)),t.join("")};function ls(t){return new co(t)}function bd(t,e,n){t.j=n?el(e,!0):e,t.j&&(t.j=t.j.replace(/:$/,""))}function Id(t,e,n){t.i=n?el(e,!0):e}function Ed(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.m=e}else t.m=null}function IE(t,e,n){e instanceof Kl?(t.h=e,a2(t.h,t.g)):(n||(e=Mc(e,i2)),t.h=new Kl(e,t.g))}function Ge(t,e,n){t.h.set(e,n)}function Xf(t){return Ge(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),t}function e2(t){return t instanceof co?ls(t):new co(t,void 0)}function t2(t,e,n,r){var s=new co(null,void 0);return t&&bd(s,t),e&&Id(s,e),n&&Ed(s,n),r&&(s.l=r),s}function el(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function Mc(t,e,n){return typeof t=="string"?(t=encodeURI(t).replace(e,n2),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function n2(t){return t=t.charCodeAt(0),"%"+(t>>4&15).toString(16)+(t&15).toString(16)}var EE=/[#\/\?@]/g,r2=/[#\?:]/g,s2=/[#\?]/g,i2=/[#\?@]/g,o2=/#/g;function Kl(t,e){this.h=this.g=null,this.i=t||null,this.j=!!e}function hi(t){t.g||(t.g=new ec,t.h=0,t.i&&Zz(t.i,function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)}))}W=Kl.prototype;W.add=function(t,e){hi(this),this.i=null,t=tc(this,t);var n=this.g.get(t);return n||this.g.set(t,n=[]),n.push(e),this.h+=1,this};function NR(t,e){hi(t),e=tc(t,e),ao(t.g.h,e)&&(t.i=null,t.h-=t.g.get(e).length,t=t.g,ao(t.h,e)&&(delete t.h[e],t.i--,t.g.length>2*t.i&&_v(t)))}function PR(t,e){return hi(t),e=tc(t,e),ao(t.g.h,e)}W.forEach=function(t,e){hi(this),this.g.forEach(function(n,r){rR(n,function(s){t.call(e,s,r,this)},this)},this)};W.T=function(){hi(this);for(var t=this.g.R(),e=this.g.T(),n=[],r=0;r<e.length;r++)for(var s=t[r],i=0;i<s.length;i++)n.push(e[r]);return n};W.R=function(t){hi(this);var e=[];if(typeof t=="string")PR(this,t)&&(e=fE(e,this.g.get(tc(this,t))));else{t=this.g.R();for(var n=0;n<t.length;n++)e=fE(e,t[n])}return e};W.set=function(t,e){return hi(this),this.i=null,t=tc(this,t),PR(this,t)&&(this.h-=this.g.get(t).length),this.g.set(t,[e]),this.h+=1,this};W.get=function(t,e){return t?(t=this.R(t),0<t.length?String(t[0]):e):e};function DR(t,e,n){NR(t,e),0<n.length&&(t.i=null,t.g.set(tc(t,e),nv(n)),t.h+=n.length)}W.toString=function(){if(this.i)return this.i;if(!this.g)return"";for(var t=[],e=this.g.T(),n=0;n<e.length;n++){var r=e[n],s=encodeURIComponent(String(r));r=this.R(r);for(var i=0;i<r.length;i++){var o=s;r[i]!==""&&(o+="="+encodeURIComponent(String(r[i]))),t.push(o)}}return this.i=t.join("&")};function tc(t,e){return e=String(e),t.j&&(e=e.toLowerCase()),e}function a2(t,e){e&&!t.j&&(hi(t),t.i=null,t.g.forEach(function(n,r){var s=r.toLowerCase();r!=s&&(NR(this,r),DR(this,s,n))},t)),t.j=e}var c2=class{constructor(t,e){this.h=t,this.g=e}};function xR(t){this.l=t||l2,oe.PerformanceNavigationTiming?(t=oe.performance.getEntriesByType("navigation"),t=0<t.length&&(t[0].nextHopProtocol=="hq"||t[0].nextHopProtocol=="h2")):t=!!(oe.g&&oe.g.Ea&&oe.g.Ea()&&oe.g.Ea().Zb),this.j=t?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var l2=10;function OR(t){return t.h?!0:t.g?t.g.size>=t.j:!1}function MR(t){return t.h?1:t.g?t.g.size:0}function qm(t,e){return t.h?t.h==e:t.g?t.g.has(e):!1}function yv(t,e){t.g?t.g.add(e):t.h=e}function LR(t,e){t.h&&t.h==e?t.h=null:t.g&&t.g.has(e)&&t.g.delete(e)}xR.prototype.cancel=function(){if(this.i=FR(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const t of this.g.values())t.cancel();this.g.clear()}};function FR(t){if(t.h!=null)return t.i.concat(t.h.D);if(t.g!=null&&t.g.size!==0){let e=t.i;for(const n of t.g.values())e=e.concat(n.D);return e}return nv(t.i)}function vv(){}vv.prototype.stringify=function(t){return oe.JSON.stringify(t,void 0)};vv.prototype.parse=function(t){return oe.JSON.parse(t,void 0)};function u2(){this.g=new vv}function h2(t,e,n){const r=n||"";try{mv(t,function(s,i){let o=s;Au(s)&&(o=lv(s)),e.push(r+i+"="+encodeURIComponent(o))})}catch(s){throw e.push(r+"type="+encodeURIComponent("_badmap")),s}}function d2(t,e){const n=new Gf;if(oe.Image){const r=new Image;r.onload=ih(ah,n,r,"TestLoadImage: loaded",!0,e),r.onerror=ih(ah,n,r,"TestLoadImage: error",!1,e),r.onabort=ih(ah,n,r,"TestLoadImage: abort",!1,e),r.ontimeout=ih(ah,n,r,"TestLoadImage: timeout",!1,e),oe.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=t}else e(!1)}function ah(t,e,n,r,s){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,s(r)}catch{}}function xu(t){this.l=t.$b||null,this.j=t.ib||!1}Qt(xu,fv);xu.prototype.g=function(){return new Zf(this.l,this.j)};xu.prototype.i=function(t){return function(){return t}}({});function Zf(t,e){Ot.call(this),this.D=t,this.u=e,this.m=void 0,this.readyState=wv,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}Qt(Zf,Ot);var wv=0;W=Zf.prototype;W.open=function(t,e){if(this.readyState!=wv)throw this.abort(),Error("Error reopening a connection");this.C=t,this.B=e,this.readyState=1,Hl(this)};W.send=function(t){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};t&&(e.body=t),(this.D||oe).fetch(new Request(this.B,e)).then(this.Va.bind(this),this.ha.bind(this))};W.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted."),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Ou(this)),this.readyState=wv};W.Va=function(t){if(this.g&&(this.l=t,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=t.headers,this.readyState=2,Hl(this)),this.g&&(this.readyState=3,Hl(this),this.g)))if(this.responseType==="arraybuffer")t.arrayBuffer().then(this.Ta.bind(this),this.ha.bind(this));else if(typeof oe.ReadableStream!="undefined"&&"body"in t){if(this.j=t.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;UR(this)}else t.text().then(this.Ua.bind(this),this.ha.bind(this))};function UR(t){t.j.read().then(t.Sa.bind(t)).catch(t.ha.bind(t))}W.Sa=function(t){if(this.g){if(this.u&&t.value)this.response.push(t.value);else if(!this.u){var e=t.value?t.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!t.done}))&&(this.response=this.responseText+=e)}t.done?Ou(this):Hl(this),this.readyState==3&&UR(this)}};W.Ua=function(t){this.g&&(this.response=this.responseText=t,Ou(this))};W.Ta=function(t){this.g&&(this.response=t,Ou(this))};W.ha=function(){this.g&&Ou(this)};function Ou(t){t.readyState=4,t.l=null,t.j=null,t.A=null,Hl(t)}W.setRequestHeader=function(t,e){this.v.append(t,e)};W.getResponseHeader=function(t){return this.h&&this.h.get(t.toLowerCase())||""};W.getAllResponseHeaders=function(){if(!this.h)return"";const t=[],e=this.h.entries();for(var n=e.next();!n.done;)n=n.value,t.push(n[0]+": "+n[1]),n=e.next();return t.join(`\r
`)};function Hl(t){t.onreadystatechange&&t.onreadystatechange.call(t)}Object.defineProperty(Zf.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(t){this.m=t?"include":"same-origin"}});var f2=oe.JSON.parse;function pt(t){Ot.call(this),this.headers=new ec,this.u=t||null,this.h=!1,this.C=this.g=null,this.H="",this.m=0,this.j="",this.l=this.F=this.v=this.D=!1,this.B=0,this.A=null,this.J=$R,this.K=this.L=!1}Qt(pt,Ot);var $R="",p2=/^https?$/i,g2=["POST","PUT"];W=pt.prototype;W.ea=function(t,e,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.H+"; newUri="+t);e=e?e.toUpperCase():"GET",this.H=t,this.j="",this.m=0,this.D=!1,this.h=!0,this.g=this.u?this.u.g():Um.g(),this.C=this.u?bE(this.u):bE(Um),this.g.onreadystatechange=Ht(this.Fa,this);try{this.F=!0,this.g.open(e,String(t),!0),this.F=!1}catch(i){TE(this,i);return}t=n||"";const s=new ec(this.headers);r&&mv(r,function(i,o){s.set(o,i)}),r=Cz(s.T()),n=oe.FormData&&t instanceof oe.FormData,!(0<=nR(g2,e))||r||n||s.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),s.forEach(function(i,o){this.g.setRequestHeader(o,i)},this),this.J&&(this.g.responseType=this.J),"withCredentials"in this.g&&this.g.withCredentials!==this.L&&(this.g.withCredentials=this.L);try{qR(this),0<this.B&&((this.K=m2(this.g))?(this.g.timeout=this.B,this.g.ontimeout=Ht(this.pa,this)):this.A=dv(this.pa,this.B,this)),this.v=!0,this.g.send(t),this.v=!1}catch(i){TE(this,i)}};function m2(t){return Na&&Pz()&&typeof t.timeout=="number"&&t.ontimeout!==void 0}function _2(t){return t.toLowerCase()=="content-type"}W.pa=function(){typeof tv!="undefined"&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,Wt(this,"timeout"),this.abort(8))};function TE(t,e){t.h=!1,t.g&&(t.l=!0,t.g.abort(),t.l=!1),t.j=e,t.m=5,VR(t),ep(t)}function VR(t){t.D||(t.D=!0,Wt(t,"complete"),Wt(t,"error"))}W.abort=function(t){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=t||7,Wt(this,"complete"),Wt(this,"abort"),ep(this))};W.M=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),ep(this,!0)),pt.Z.M.call(this)};W.Fa=function(){this.s||(this.F||this.v||this.l?BR(this):this.cb())};W.cb=function(){BR(this)};function BR(t){if(t.h&&typeof tv!="undefined"&&(!t.C[1]||Xr(t)!=4||t.ba()!=2)){if(t.v&&Xr(t)==4)dv(t.Fa,0,t);else if(Wt(t,"readystatechange"),Xr(t)==4){t.h=!1;try{const a=t.ba();e:switch(a){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break e;default:e=!1}var n;if(!(n=e)){var r;if(r=a===0){var s=String(t.H).match(RR)[1]||null;if(!s&&oe.self&&oe.self.location){var i=oe.self.location.protocol;s=i.substr(0,i.length-1)}r=!p2.test(s?s.toLowerCase():"")}n=r}if(n)Wt(t,"complete"),Wt(t,"success");else{t.m=6;try{var o=2<Xr(t)?t.g.statusText:""}catch{o=""}t.j=o+" ["+t.ba()+"]",VR(t)}}finally{ep(t)}}}}function ep(t,e){if(t.g){qR(t);const n=t.g,r=t.C[0]?_d:null;t.g=null,t.C=null,e||Wt(t,"ready");try{n.onreadystatechange=r}catch{}}}function qR(t){t.g&&t.K&&(t.g.ontimeout=null),t.A&&(oe.clearTimeout(t.A),t.A=null)}function Xr(t){return t.g?t.g.readyState:0}W.ba=function(){try{return 2<Xr(this)?this.g.status:-1}catch{return-1}};W.ga=function(){try{return this.g?this.g.responseText:""}catch{return""}};W.Qa=function(t){if(this.g){var e=this.g.responseText;return t&&e.indexOf(t)==0&&(e=e.substring(t.length)),f2(e)}};function SE(t){try{if(!t.g)return null;if("response"in t.g)return t.g.response;switch(t.J){case $R:case"text":return t.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in t.g)return t.g.mozResponseArrayBuffer}return null}catch{return null}}W.Da=function(){return this.m};W.La=function(){return typeof this.j=="string"?this.j:String(this.j)};function y2(t){let e="";return rv(t,function(n,r){e+=r,e+=":",e+=n,e+=`\r
`}),e}function bv(t,e,n){e:{for(r in n){var r=!1;break e}r=!0}r||(n=y2(n),typeof t=="string"?n!=null&&encodeURIComponent(String(n)):Ge(t,e,n))}function Ic(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function jR(t){this.za=0,this.l=[],this.h=new Gf,this.la=this.oa=this.F=this.W=this.g=this.sa=this.D=this.aa=this.o=this.P=this.s=null,this.Za=this.V=0,this.Xa=Ic("failFast",!1,t),this.N=this.v=this.u=this.m=this.j=null,this.X=!0,this.I=this.ta=this.U=-1,this.Y=this.A=this.C=0,this.Pa=Ic("baseRetryDelayMs",5e3,t),this.$a=Ic("retryDelaySeedMs",1e4,t),this.Ya=Ic("forwardChannelMaxRetries",2,t),this.ra=Ic("forwardChannelRequestTimeoutMs",2e4,t),this.qa=t&&t.xmlHttpFactory||void 0,this.Ba=t&&t.Yb||!1,this.K=void 0,this.H=t&&t.supportsCrossDomainXhr||!1,this.J="",this.i=new xR(t&&t.concurrentRequestLimit),this.Ca=new u2,this.ja=t&&t.fastHandshake||!1,this.Ra=t&&t.Wb||!1,t&&t.Aa&&this.h.Aa(),t&&t.forceLongPolling&&(this.X=!1),this.$=!this.ja&&this.X&&t&&t.detectBufferingProxy||!1,this.ka=void 0,this.O=0,this.L=!1,this.B=null,this.Wa=!t||t.Xb!==!1}W=jR.prototype;W.ma=8;W.G=1;function Iv(t){if(KR(t),t.G==3){var e=t.V++,n=ls(t.F);Ge(n,"SID",t.J),Ge(n,"RID",e),Ge(n,"TYPE","terminate"),Mu(t,n),e=new Pu(t,t.h,e,void 0),e.K=2,e.v=Xf(ls(n)),n=!1,oe.navigator&&oe.navigator.sendBeacon&&(n=oe.navigator.sendBeacon(e.v.toString(),"")),!n&&oe.Image&&(new Image().src=e.v,n=!0),n||(e.g=XR(e.l,null),e.g.ea(e.v)),e.F=Date.now(),Du(e)}YR(t)}W.hb=function(t){try{this.h.info("Origin Trials invoked: "+t)}catch{}};function tp(t){t.g&&(Tv(t),t.g.cancel(),t.g=null)}function KR(t){tp(t),t.u&&(oe.clearTimeout(t.u),t.u=null),Td(t),t.i.cancel(),t.m&&(typeof t.m=="number"&&oe.clearTimeout(t.m),t.m=null)}function ug(t,e){t.l.push(new c2(t.Za++,e)),t.G==3&&np(t)}function np(t){OR(t.i)||t.m||(t.m=!0,uv(t.Ha,t),t.C=0)}function v2(t,e){return MR(t.i)>=t.i.j-(t.m?1:0)?!1:t.m?(t.l=e.D.concat(t.l),!0):t.G==1||t.G==2||t.C>=(t.Xa?0:t.Ya)?!1:(t.m=Ru(Ht(t.Ha,t,e),QR(t,t.C)),t.C++,!0)}W.Ha=function(t){if(this.m)if(this.m=null,this.G==1){if(!t){this.V=Math.floor(1e5*Math.random()),t=this.V++;const s=new Pu(this,this.h,t,void 0);let i=this.s;if(this.P&&(i?(i=sR(i),iR(i,this.P)):i=this.P),this.o===null&&(s.H=i),this.ja)e:{for(var e=0,n=0;n<this.l.length;n++){t:{var r=this.l[n];if("__data__"in r.g&&(r=r.g.__data__,typeof r=="string")){r=r.length;break t}r=void 0}if(r===void 0)break;if(e+=r,4096<e){e=n;break e}if(e===4096||n===this.l.length-1){e=n+1;break e}}e=1e3}else e=1e3;e=HR(this,s,e),n=ls(this.F),Ge(n,"RID",t),Ge(n,"CVER",22),this.D&&Ge(n,"X-HTTP-Session-Id",this.D),Mu(this,n),this.o&&i&&bv(n,this.o,i),yv(this.i,s),this.Ra&&Ge(n,"TYPE","init"),this.ja?(Ge(n,"$req",e),Ge(n,"SID","null"),s.$=!0,Vm(s,n,null)):Vm(s,n,e),this.G=2}}else this.G==3&&(t?CE(this,t):this.l.length==0||OR(this.i)||CE(this))};function CE(t,e){var n;e?n=e.m:n=t.V++;const r=ls(t.F);Ge(r,"SID",t.J),Ge(r,"RID",n),Ge(r,"AID",t.U),Mu(t,r),t.o&&t.s&&bv(r,t.o,t.s),n=new Pu(t,t.h,n,t.C+1),t.o===null&&(n.H=t.s),e&&(t.l=e.D.concat(t.l)),e=HR(t,n,1e3),n.setTimeout(Math.round(.5*t.ra)+Math.round(.5*t.ra*Math.random())),yv(t.i,n),Vm(n,r,e)}function Mu(t,e){t.j&&mv({},function(n,r){Ge(e,r,n)})}function HR(t,e,n){n=Math.min(t.l.length,n);var r=t.j?Ht(t.j.Oa,t.j,t):null;e:{var s=t.l;let i=-1;for(;;){const o=["count="+n];i==-1?0<n?(i=s[0].h,o.push("ofs="+i)):i=0:o.push("ofs="+i);let a=!0;for(let c=0;c<n;c++){let l=s[c].h;const u=s[c].g;if(l-=i,0>l)i=Math.max(0,s[c].h-100),a=!1;else try{h2(u,o,"req"+l+"_")}catch{r&&r(u)}}if(a){r=o.join("&");break e}}}return t=t.l.splice(0,n),e.D=t,r}function WR(t){t.g||t.u||(t.Y=1,uv(t.Ga,t),t.A=0)}function Ev(t){return t.g||t.u||3<=t.A?!1:(t.Y++,t.u=Ru(Ht(t.Ga,t),QR(t,t.A)),t.A++,!0)}W.Ga=function(){if(this.u=null,GR(this),this.$&&!(this.L||this.g==null||0>=this.O)){var t=2*this.O;this.h.info("BP detection timer enabled: "+t),this.B=Ru(Ht(this.bb,this),t)}};W.bb=function(){this.B&&(this.B=null,this.h.info("BP detection timeout reached."),this.h.info("Buffering proxy detected and switch to long-polling!"),this.N=!1,this.L=!0,hn(10),tp(this),GR(this))};function Tv(t){t.B!=null&&(oe.clearTimeout(t.B),t.B=null)}function GR(t){t.g=new Pu(t,t.h,"rpc",t.Y),t.o===null&&(t.g.H=t.s),t.g.O=0;var e=ls(t.oa);Ge(e,"RID","rpc"),Ge(e,"SID",t.J),Ge(e,"CI",t.N?"0":"1"),Ge(e,"AID",t.U),Mu(t,e),Ge(e,"TYPE","xmlhttp"),t.o&&t.s&&bv(e,t.o,t.s),t.K&&t.g.setTimeout(t.K);var n=t.g;t=t.la,n.K=1,n.v=Xf(ls(e)),n.s=null,n.U=!0,SR(n,t)}W.ab=function(){this.v!=null&&(this.v=null,tp(this),Ev(this),hn(19))};function Td(t){t.v!=null&&(oe.clearTimeout(t.v),t.v=null)}function zR(t,e){var n=null;if(t.g==e){Td(t),Tv(t),t.g=null;var r=2}else if(qm(t.i,e))n=e.D,LR(t.i,e),r=1;else return;if(t.I=e.N,t.G!=0){if(e.i)if(r==1){n=e.s?e.s.length:0,e=Date.now()-e.F;var s=t.C;r=zf(),Wt(r,new bR(r,n)),np(t)}else WR(t);else if(s=e.o,s==3||s==0&&0<t.I||!(r==1&&v2(t,e)||r==2&&Ev(t)))switch(n&&0<n.length&&(e=t.i,e.i=e.i.concat(n)),s){case 1:Vi(t,5);break;case 4:Vi(t,10);break;case 3:Vi(t,6);break;default:Vi(t,2)}}}function QR(t,e){let n=t.Pa+Math.floor(Math.random()*t.$a);return t.j||(n*=2),n*e}function Vi(t,e){if(t.h.info("Error code "+e),e==2){var n=null;t.j&&(n=null);var r=Ht(t.jb,t);n||(n=new co("//www.google.com/images/cleardot.gif"),oe.location&&oe.location.protocol=="http"||bd(n,"https"),Xf(n)),d2(n.toString(),r)}else hn(2);t.G=0,t.j&&t.j.va(e),YR(t),KR(t)}W.jb=function(t){t?(this.h.info("Successfully pinged google.com"),hn(2)):(this.h.info("Failed to ping google.com"),hn(1))};function YR(t){t.G=0,t.I=-1,t.j&&((FR(t.i).length!=0||t.l.length!=0)&&(t.i.i.length=0,nv(t.l),t.l.length=0),t.j.ua())}function JR(t,e,n){let r=e2(n);if(r.i!="")e&&Id(r,e+"."+r.i),Ed(r,r.m);else{const s=oe.location;r=t2(s.protocol,e?e+"."+s.hostname:s.hostname,+s.port,n)}return t.aa&&rv(t.aa,function(s,i){Ge(r,i,s)}),e=t.D,n=t.sa,e&&n&&Ge(r,e,n),Ge(r,"VER",t.ma),Mu(t,r),r}function XR(t,e,n){if(e&&!t.H)throw Error("Can't create secondary domain capable XhrIo object.");return e=n&&t.Ba&&!t.qa?new pt(new xu({ib:!0})):new pt(t.qa),e.L=t.H,e}function ZR(){}W=ZR.prototype;W.xa=function(){};W.wa=function(){};W.va=function(){};W.ua=function(){};W.Oa=function(){};function Sd(){if(Na&&!(10<=Number(Dz)))throw Error("Environmental error: no available transport.")}Sd.prototype.g=function(t,e){return new On(t,e)};function On(t,e){Ot.call(this),this.g=new jR(e),this.l=t,this.h=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.g.s=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.ya&&(t?t["X-WebChannel-Client-Profile"]=e.ya:t={"X-WebChannel-Client-Profile":e.ya}),this.g.P=t,(t=e&&e.httpHeadersOverwriteParam)&&!yd(t)&&(this.g.o=t),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!yd(e)&&(this.g.D=e,t=this.h,t!==null&&e in t&&(t=this.h,e in t&&delete t[e])),this.j=new nc(this)}Qt(On,Ot);On.prototype.m=function(){this.g.j=this.j,this.A&&(this.g.H=!0);var t=this.g,e=this.l,n=this.h||void 0;t.Wa&&(t.h.info("Origin Trials enabled."),uv(Ht(t.hb,t,e))),hn(0),t.W=e,t.aa=n||{},t.N=t.X,t.F=JR(t,null,t.W),np(t)};On.prototype.close=function(){Iv(this.g)};On.prototype.u=function(t){if(typeof t=="string"){var e={};e.__data__=t,ug(this.g,e)}else this.v?(e={},e.__data__=lv(t),ug(this.g,e)):ug(this.g,t)};On.prototype.M=function(){this.g.j=null,delete this.j,Iv(this.g),delete this.g,On.Z.M.call(this)};function eN(t){pv.call(this);var e=t.__sm__;if(e){e:{for(const n in e){t=n;break e}t=void 0}(this.i=t)&&(t=this.i,e=e!==null&&t in e?e[t]:void 0),this.data=e}else this.data=t}Qt(eN,pv);function tN(){gv.call(this),this.status=1}Qt(tN,gv);function nc(t){this.g=t}Qt(nc,ZR);nc.prototype.xa=function(){Wt(this.g,"a")};nc.prototype.wa=function(t){Wt(this.g,new eN(t))};nc.prototype.va=function(t){Wt(this.g,new tN)};nc.prototype.ua=function(){Wt(this.g,"b")};Sd.prototype.createWebChannel=Sd.prototype.g;On.prototype.send=On.prototype.u;On.prototype.open=On.prototype.m;On.prototype.close=On.prototype.close;Qf.NO_ERROR=0;Qf.TIMEOUT=8;Qf.HTTP_ERROR=6;IR.COMPLETE="complete";ER.EventType=Nu;Nu.OPEN="a";Nu.CLOSE="b";Nu.ERROR="c";Nu.MESSAGE="d";Ot.prototype.listen=Ot.prototype.N;pt.prototype.listenOnce=pt.prototype.O;pt.prototype.getLastError=pt.prototype.La;pt.prototype.getLastErrorCode=pt.prototype.Da;pt.prototype.getStatus=pt.prototype.ba;pt.prototype.getResponseJson=pt.prototype.Qa;pt.prototype.getResponseText=pt.prototype.ga;pt.prototype.send=pt.prototype.ea;var w2=function(){return new Sd},b2=function(){return zf()},hg=Qf,I2=IR,E2=No,AE={rb:0,ub:1,vb:2,Ob:3,Tb:4,Qb:5,Rb:6,Pb:7,Nb:8,Sb:9,PROXY:10,NOPROXY:11,Lb:12,Hb:13,Ib:14,Gb:15,Jb:16,Kb:17,nb:18,mb:19,ob:20},T2=xu,ch=ER,S2=pt;const kE="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class St{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}St.UNAUTHENTICATED=new St(null),St.GOOGLE_CREDENTIALS=new St("google-credentials-uid"),St.FIRST_PARTY=new St("first-party-uid"),St.MOCK_USER=new St("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let rc="9.9.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ei=new Vr("@firebase/firestore");function jm(){return ei.logLevel}function C2(t){ei.setLogLevel(t)}function P(t,...e){if(ei.logLevel<=fe.DEBUG){const n=e.map(Sv);ei.debug(`Firestore (${rc}): ${t}`,...n)}}function ft(t,...e){if(ei.logLevel<=fe.ERROR){const n=e.map(Sv);ei.error(`Firestore (${rc}): ${t}`,...n)}}function Wl(t,...e){if(ei.logLevel<=fe.WARN){const n=e.map(Sv);ei.warn(`Firestore (${rc}): ${t}`,...n)}}function Sv(t){if(typeof t=="string")return t;try{return e=t,JSON.stringify(e)}catch{return t}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/var e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function G(t="Unexpected state"){const e=`FIRESTORE (${rc}) INTERNAL ASSERTION FAILED: `+t;throw ft(e),new Error(e)}function ie(t,e){t||G()}function A2(t,e){t||G()}function q(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const w={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class k extends ut{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kt{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nN{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class k2{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(St.UNAUTHENTICATED))}shutdown(){}}class R2{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class N2{constructor(e){this.t=e,this.currentUser=St.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){let r=this.i;const s=c=>this.i!==r?(r=this.i,n(c)):Promise.resolve();let i=new kt;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new kt,e.enqueueRetryable(()=>s(this.currentUser))};const o=()=>{const c=i;e.enqueueRetryable(async()=>{await c.promise,await s(this.currentUser)})},a=c=>{P("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.auth.addAuthTokenListener(this.o),o()};this.t.onInit(c=>a(c)),setTimeout(()=>{if(!this.auth){const c=this.t.getImmediate({optional:!0});c?a(c):(P("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new kt)}},0),o()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(P("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(ie(typeof r.accessToken=="string"),new nN(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const e=this.auth&&this.auth.getUid();return ie(e===null||typeof e=="string"),new St(e)}}class P2{constructor(e,n,r){this.type="FirstParty",this.user=St.FIRST_PARTY,this.headers=new Map,this.headers.set("X-Goog-AuthUser",n);const s=e.auth.getAuthHeaderValueForFirstParty([]);s&&this.headers.set("Authorization",s),r&&this.headers.set("X-Goog-Iam-Authorization-Token",r)}}class D2{constructor(e,n,r){this.h=e,this.l=n,this.m=r}getToken(){return Promise.resolve(new P2(this.h,this.l,this.m))}start(e,n){e.enqueueRetryable(()=>n(St.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class x2{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class O2{constructor(e){this.g=e,this.forceRefresh=!1,this.appCheck=null,this.p=null}start(e,n){const r=i=>{i.error!=null&&P("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const o=i.token!==this.p;return this.p=i.token,P("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>r(i))};const s=i=>{P("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.appCheck.addTokenListener(this.o)};this.g.onInit(i=>s(i)),setTimeout(()=>{if(!this.appCheck){const i=this.g.getImmediate({optional:!0});i?s(i):P("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(ie(typeof n.token=="string"),this.p=n.token,new x2(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function M2(t){const e=typeof self!="undefined"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rN{static I(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=Math.floor(256/e.length)*e.length;let r="";for(;r.length<20;){const s=M2(40);for(let i=0;i<s.length;++i)r.length<20&&s[i]<n&&(r+=e.charAt(s[i]%e.length))}return r}}function ce(t,e){return t<e?-1:t>e?1:0}function Pa(t,e,n){return t.length===e.length&&t.every((r,s)=>n(r,e[s]))}function sN(t){return t+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ye{constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new k(w.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new k(w.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<-62135596800)throw new k(w.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new k(w.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return Ye.fromMillis(Date.now())}static fromDate(e){return Ye.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*n));return new Ye(n,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?ce(this.nanoseconds,e.nanoseconds):ce(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class se{constructor(e){this.timestamp=e}static fromTimestamp(e){return new se(e)}static min(){return new se(new Ye(0,0))}static max(){return new se(new Ye(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gl{constructor(e,n,r){n===void 0?n=0:n>e.length&&G(),r===void 0?r=e.length-n:r>e.length-n&&G(),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return Gl.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof Gl?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let s=0;s<r;s++){const i=e.get(s),o=n.get(s);if(i<o)return-1;if(i>o)return 1}return e.length<n.length?-1:e.length>n.length?1:0}}class we extends Gl{construct(e,n,r){return new we(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new k(w.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(s=>s.length>0))}return new we(n)}static emptyPath(){return new we([])}}const L2=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class ct extends Gl{construct(e,n,r){return new ct(e,n,r)}static isValidIdentifier(e){return L2.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),ct.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new ct(["__name__"])}static fromServerFormat(e){const n=[];let r="",s=0;const i=()=>{if(r.length===0)throw new k(w.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let o=!1;for(;s<e.length;){const a=e[s];if(a==="\\"){if(s+1===e.length)throw new k(w.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const c=e[s+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new k(w.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=c,s+=2}else a==="`"?(o=!o,s++):a!=="."||o?(r+=a,s++):(i(),s++)}if(i(),o)throw new k(w.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new ct(n)}static emptyPath(){return new ct([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U{constructor(e){this.path=e}static fromPath(e){return new U(we.fromString(e))}static fromName(e){return new U(we.fromString(e).popFirst(5))}static empty(){return new U(we.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&we.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return we.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new U(new we(e.slice()))}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iN{constructor(e,n,r,s){this.indexId=e,this.collectionGroup=n,this.fields=r,this.indexState=s}}function Km(t){return t.fields.find(e=>e.kind===2)}function Ci(t){return t.fields.filter(e=>e.kind!==2)}iN.UNKNOWN_ID=-1;class F2{constructor(e,n){this.fieldPath=e,this.kind=n}}class Cd{constructor(e,n){this.sequenceNumber=e,this.offset=n}static empty(){return new Cd(0,Mn.min())}}function oN(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,s=se.fromTimestamp(r===1e9?new Ye(n+1,0):new Ye(n,r));return new Mn(s,U.empty(),e)}function aN(t){return new Mn(t.readTime,t.key,-1)}class Mn{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new Mn(se.min(),U.empty(),-1)}static max(){return new Mn(se.max(),U.empty(),-1)}}function Cv(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=U.comparator(t.documentKey,e.documentKey),n!==0?n:ce(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cN="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class lN{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function di(t){if(t.code!==w.FAILED_PRECONDITION||t.message!==cN)throw t;P("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class v{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&G(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new v((r,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(r,s)},this.catchCallback=i=>{this.wrapFailure(n,i).next(r,s)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof v?n:v.resolve(n)}catch(n){return v.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):v.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):v.reject(n)}static resolve(e){return new v((n,r)=>{n(e)})}static reject(e){return new v((n,r)=>{r(e)})}static waitFor(e){return new v((n,r)=>{let s=0,i=0,o=!1;e.forEach(a=>{++s,a.next(()=>{++i,o&&i===s&&n()},c=>r(c))}),o=!0,i===s&&n()})}static or(e){let n=v.resolve(!1);for(const r of e)n=n.next(s=>s?v.resolve(s):r());return n}static forEach(e,n){const r=[];return e.forEach((s,i)=>{r.push(n.call(this,s,i))}),this.waitFor(r)}static mapArray(e,n){return new v((r,s)=>{const i=e.length,o=new Array(i);let a=0;for(let c=0;c<i;c++){const l=c;n(e[l]).next(u=>{o[l]=u,++a,a===i&&r(o)},u=>s(u))}})}static doWhile(e,n){return new v((r,s)=>{const i=()=>{e()===!0?n().next(()=>{i()},s):r()};i()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rp{constructor(e,n){this.action=e,this.transaction=n,this.aborted=!1,this.T=new kt,this.transaction.oncomplete=()=>{this.T.resolve()},this.transaction.onabort=()=>{n.error?this.T.reject(new tl(e,n.error)):this.T.resolve()},this.transaction.onerror=r=>{const s=Av(r.target.error);this.T.reject(new tl(e,s))}}static open(e,n,r,s){try{return new rp(n,e.transaction(s,r))}catch(i){throw new tl(n,i)}}get A(){return this.T.promise}abort(e){e&&this.T.reject(e),this.aborted||(P("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}R(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const n=this.transaction.objectStore(e);return new $2(n)}}class ir{constructor(e,n,r){this.name=e,this.version=n,this.P=r,ir.v(We())===12.2&&ft("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return P("SimpleDb","Removing database:",e),Ni(window.indexedDB.deleteDatabase(e)).toPromise()}static V(){if(!In())return!1;if(ir.S())return!0;const e=We(),n=ir.v(e),r=0<n&&n<10,s=ir.D(e),i=0<s&&s<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||i)}static S(){var e;return typeof process!="undefined"&&((e=process.env)===null||e===void 0?void 0:e.C)==="YES"}static N(e,n){return e.store(n)}static v(e){const n=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=n?n[1].split("_").slice(0,2).join("."):"-1";return Number(r)}static D(e){const n=e.match(/Android ([\d.]+)/i),r=n?n[1].split(".").slice(0,2).join("."):"-1";return Number(r)}async k(e){return this.db||(P("SimpleDb","Opening database:",this.name),this.db=await new Promise((n,r)=>{const s=indexedDB.open(this.name,this.version);s.onsuccess=i=>{const o=i.target.result;n(o)},s.onblocked=()=>{r(new tl(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},s.onerror=i=>{const o=i.target.error;o.name==="VersionError"?r(new k(w.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?r(new k(w.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):r(new tl(e,o))},s.onupgradeneeded=i=>{P("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',i.oldVersion);const o=i.target.result;this.P.O(o,s.transaction,i.oldVersion,this.version).next(()=>{P("SimpleDb","Database upgrade to version "+this.version+" complete")})}})),this.M&&(this.db.onversionchange=n=>this.M(n)),this.db}F(e){this.M=e,this.db&&(this.db.onversionchange=n=>e(n))}async runTransaction(e,n,r,s){const i=n==="readonly";let o=0;for(;;){++o;try{this.db=await this.k(e);const a=rp.open(this.db,e,i?"readonly":"readwrite",r),c=s(a).next(l=>(a.R(),l)).catch(l=>(a.abort(l),v.reject(l))).toPromise();return c.catch(()=>{}),await a.A,c}catch(a){const c=a,l=c.name!=="FirebaseError"&&o<3;if(P("SimpleDb","Transaction failed with error:",c.message,"Retrying:",l),this.close(),!l)return Promise.reject(c)}}}close(){this.db&&this.db.close(),this.db=void 0}}class U2{constructor(e){this.$=e,this.B=!1,this.L=null}get isDone(){return this.B}get U(){return this.L}set cursor(e){this.$=e}done(){this.B=!0}q(e){this.L=e}delete(){return Ni(this.$.delete())}}class tl extends k{constructor(e,n){super(w.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${n}`),this.name="IndexedDbTransactionError"}}function fi(t){return t.name==="IndexedDbTransactionError"}class $2{constructor(e){this.store=e}put(e,n){let r;return n!==void 0?(P("SimpleDb","PUT",this.store.name,e,n),r=this.store.put(n,e)):(P("SimpleDb","PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),Ni(r)}add(e){return P("SimpleDb","ADD",this.store.name,e,e),Ni(this.store.add(e))}get(e){return Ni(this.store.get(e)).next(n=>(n===void 0&&(n=null),P("SimpleDb","GET",this.store.name,e,n),n))}delete(e){return P("SimpleDb","DELETE",this.store.name,e),Ni(this.store.delete(e))}count(){return P("SimpleDb","COUNT",this.store.name),Ni(this.store.count())}K(e,n){const r=this.options(e,n);if(r.index||typeof this.store.getAll!="function"){const s=this.cursor(r),i=[];return this.G(s,(o,a)=>{i.push(a)}).next(()=>i)}{const s=this.store.getAll(r.range);return new v((i,o)=>{s.onerror=a=>{o(a.target.error)},s.onsuccess=a=>{i(a.target.result)}})}}j(e,n){const r=this.store.getAll(e,n===null?void 0:n);return new v((s,i)=>{r.onerror=o=>{i(o.target.error)},r.onsuccess=o=>{s(o.target.result)}})}W(e,n){P("SimpleDb","DELETE ALL",this.store.name);const r=this.options(e,n);r.H=!1;const s=this.cursor(r);return this.G(s,(i,o,a)=>a.delete())}J(e,n){let r;n?r=e:(r={},n=e);const s=this.cursor(r);return this.G(s,n)}Y(e){const n=this.cursor({});return new v((r,s)=>{n.onerror=i=>{const o=Av(i.target.error);s(o)},n.onsuccess=i=>{const o=i.target.result;o?e(o.primaryKey,o.value).next(a=>{a?o.continue():r()}):r()}})}G(e,n){const r=[];return new v((s,i)=>{e.onerror=o=>{i(o.target.error)},e.onsuccess=o=>{const a=o.target.result;if(!a)return void s();const c=new U2(a),l=n(a.primaryKey,a.value,c);if(l instanceof v){const u=l.catch(h=>(c.done(),v.reject(h)));r.push(u)}c.isDone?s():c.U===null?a.continue():a.continue(c.U)}}).next(()=>v.waitFor(r))}options(e,n){let r;return e!==void 0&&(typeof e=="string"?r=e:n=e),{index:r,range:n}}cursor(e){let n="next";if(e.reverse&&(n="prev"),e.index){const r=this.store.index(e.index);return e.H?r.openKeyCursor(e.range,n):r.openCursor(e.range,n)}return this.store.openCursor(e.range,n)}}function Ni(t){return new v((e,n)=>{t.onsuccess=r=>{const s=r.target.result;e(s)},t.onerror=r=>{const s=Av(r.target.error);n(s)}})}let RE=!1;function Av(t){const e=ir.v(We());if(e>=12.2&&e<13){const n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){const r=new k("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${n}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return RE||(RE=!0,setTimeout(()=>{throw r},0)),r}}return t}class V2{constructor(e,n){this.asyncQueue=e,this.X=n,this.task=null}start(){}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}Z(e){P("IndexBackiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{P("IndexBackiller",`Documents written: ${await this.X.tt()}`)}catch(n){fi(n)?P("IndexBackiller","Ignoring IndexedDB error during index backfill: ",n):await di(n)}await this.Z(1)})}}class B2{constructor(e,n){this.localStore=e,this.persistence=n}async tt(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",n=>this.et(n,e))}et(e,n){const r=new Set;let s=n,i=!0;return v.doWhile(()=>i===!0&&s>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(o!==null&&!r.has(o))return P("IndexBackiller",`Processing collection: ${o}`),this.nt(e,o,s).next(a=>{s-=a,r.add(o)});i=!1})).next(()=>n-s)}nt(e,n,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,n).next(s=>this.localStore.localDocuments.getNextDocuments(e,n,s,r).next(i=>{const o=i.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this.st(s,i)).next(a=>(P("IndexBackiller",`Updating offset: ${a}`),this.localStore.indexManager.updateCollectionGroup(e,n,a))).next(()=>o.size)}))}st(e,n){let r=e;return n.changes.forEach((s,i)=>{const o=aN(i);Cv(o,r)>0&&(r=o)}),new Mn(r.readTime,r.documentKey,Math.max(n.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vn{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.it(r),this.rt=r=>n.writeSequenceNumber(r))}it(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.rt&&this.rt(e),e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NE(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Po(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function uN(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */vn.ot=-1;class it{constructor(e,n){this.comparator=e,this.root=n||Vt.EMPTY}insert(e,n){return new it(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,Vt.BLACK,null,null))}remove(e){return new it(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Vt.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(e,r.key);if(s===0)return n+r.left.size;s<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new lh(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new lh(this.root,e,this.comparator,!1)}getReverseIterator(){return new lh(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new lh(this.root,e,this.comparator,!0)}}class lh{constructor(e,n,r,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=n?r(e.key,n):1,n&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Vt{constructor(e,n,r,s,i){this.key=e,this.value=n,this.color=r!=null?r:Vt.RED,this.left=s!=null?s:Vt.EMPTY,this.right=i!=null?i:Vt.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,s,i){return new Vt(e!=null?e:this.key,n!=null?n:this.value,r!=null?r:this.color,s!=null?s:this.left,i!=null?i:this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let s=this;const i=r(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,n,r),null):i===0?s.copy(null,n,null,null,null):s.copy(null,null,null,null,s.right.insert(e,n,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return Vt.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,s=this;if(n(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,n),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),n(e,s.key)===0){if(s.right.isEmpty())return Vt.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,n))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Vt.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Vt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw G();const e=this.left.check();if(e!==this.right.check())throw G();return e+(this.isRed()?0:1)}}Vt.EMPTY=null,Vt.RED=!0,Vt.BLACK=!1;Vt.EMPTY=new class{constructor(){this.size=0}get key(){throw G()}get value(){throw G()}get color(){throw G()}get left(){throw G()}get right(){throw G()}copy(t,e,n,r,s){return this}insert(t,e,n){return new Vt(t,e)}remove(t,e){return this}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ke{constructor(e){this.comparator=e,this.data=new it(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,e[1])>=0)return;n(s.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new PE(this.data.getIterator())}getIteratorFrom(e){return new PE(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof ke)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new ke(this.comparator);return n.data=e,n}}class PE{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function Bo(t){return t.hasNext()?t.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pn{constructor(e){this.fields=e,e.sort(ct.comparator)}static empty(){return new Pn([])}unionWith(e){let n=new ke(ct.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new Pn(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return Pa(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function q2(){return typeof atob!="undefined"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vt{constructor(e){this.binaryString=e}static fromBase64String(e){const n=atob(e);return new vt(n)}static fromUint8Array(e){const n=function(r){let s="";for(let i=0;i<r.length;++i)s+=String.fromCharCode(r[i]);return s}(e);return new vt(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return e=this.binaryString,btoa(e);var e}toUint8Array(){return function(e){const n=new Uint8Array(e.length);for(let r=0;r<e.length;r++)n[r]=e.charCodeAt(r);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return ce(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}vt.EMPTY_BYTE_STRING=new vt("");const j2=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function ti(t){if(ie(!!t),typeof t=="string"){let e=0;const n=j2.exec(t);if(ie(!!n),n[1]){let s=n[1];s=(s+"000000000").substr(0,9),e=Number(s)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:nt(t.seconds),nanos:nt(t.nanos)}}function nt(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function lo(t){return typeof t=="string"?vt.fromBase64String(t):vt.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kv(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="server_timestamp"}function hN(t){const e=t.mapValue.fields.__previous_value__;return kv(e)?hN(e):e}function zl(t){const e=ti(t.mapValue.fields.__local_write_time__.timestampValue);return new Ye(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K2{constructor(e,n,r,s,i,o,a,c){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=s,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.useFetchStreams=c}}class us{constructor(e,n){this.projectId=e,this.database=n||"(default)"}static empty(){return new us("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof us&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lu(t){return t==null}function Ql(t){return t===0&&1/t==-1/0}function dN(t){return typeof t=="number"&&Number.isInteger(t)&&!Ql(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fs={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},kh={nullValue:"NULL_VALUE"};function uo(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?kv(t)?4:fN(t)?9007199254740991:10:G()}function Fr(t,e){if(t===e)return!0;const n=uo(t);if(n!==uo(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return zl(t).isEqual(zl(e));case 3:return function(r,s){if(typeof r.timestampValue=="string"&&typeof s.timestampValue=="string"&&r.timestampValue.length===s.timestampValue.length)return r.timestampValue===s.timestampValue;const i=ti(r.timestampValue),o=ti(s.timestampValue);return i.seconds===o.seconds&&i.nanos===o.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(r,s){return lo(r.bytesValue).isEqual(lo(s.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(r,s){return nt(r.geoPointValue.latitude)===nt(s.geoPointValue.latitude)&&nt(r.geoPointValue.longitude)===nt(s.geoPointValue.longitude)}(t,e);case 2:return function(r,s){if("integerValue"in r&&"integerValue"in s)return nt(r.integerValue)===nt(s.integerValue);if("doubleValue"in r&&"doubleValue"in s){const i=nt(r.doubleValue),o=nt(s.doubleValue);return i===o?Ql(i)===Ql(o):isNaN(i)&&isNaN(o)}return!1}(t,e);case 9:return Pa(t.arrayValue.values||[],e.arrayValue.values||[],Fr);case 10:return function(r,s){const i=r.mapValue.fields||{},o=s.mapValue.fields||{};if(NE(i)!==NE(o))return!1;for(const a in i)if(i.hasOwnProperty(a)&&(o[a]===void 0||!Fr(i[a],o[a])))return!1;return!0}(t,e);default:return G()}}function Yl(t,e){return(t.values||[]).find(n=>Fr(n,e))!==void 0}function ni(t,e){if(t===e)return 0;const n=uo(t),r=uo(e);if(n!==r)return ce(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return ce(t.booleanValue,e.booleanValue);case 2:return function(s,i){const o=nt(s.integerValue||s.doubleValue),a=nt(i.integerValue||i.doubleValue);return o<a?-1:o>a?1:o===a?0:isNaN(o)?isNaN(a)?0:-1:1}(t,e);case 3:return DE(t.timestampValue,e.timestampValue);case 4:return DE(zl(t),zl(e));case 5:return ce(t.stringValue,e.stringValue);case 6:return function(s,i){const o=lo(s),a=lo(i);return o.compareTo(a)}(t.bytesValue,e.bytesValue);case 7:return function(s,i){const o=s.split("/"),a=i.split("/");for(let c=0;c<o.length&&c<a.length;c++){const l=ce(o[c],a[c]);if(l!==0)return l}return ce(o.length,a.length)}(t.referenceValue,e.referenceValue);case 8:return function(s,i){const o=ce(nt(s.latitude),nt(i.latitude));return o!==0?o:ce(nt(s.longitude),nt(i.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(s,i){const o=s.values||[],a=i.values||[];for(let c=0;c<o.length&&c<a.length;++c){const l=ni(o[c],a[c]);if(l)return l}return ce(o.length,a.length)}(t.arrayValue,e.arrayValue);case 10:return function(s,i){if(s===Fs.mapValue&&i===Fs.mapValue)return 0;if(s===Fs.mapValue)return 1;if(i===Fs.mapValue)return-1;const o=s.fields||{},a=Object.keys(o),c=i.fields||{},l=Object.keys(c);a.sort(),l.sort();for(let u=0;u<a.length&&u<l.length;++u){const h=ce(a[u],l[u]);if(h!==0)return h;const d=ni(o[a[u]],c[l[u]]);if(d!==0)return d}return ce(a.length,l.length)}(t.mapValue,e.mapValue);default:throw G()}}function DE(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return ce(t,e);const n=ti(t),r=ti(e),s=ce(n.seconds,r.seconds);return s!==0?s:ce(n.nanos,r.nanos)}function la(t){return Hm(t)}function Hm(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(r){const s=ti(r);return`time(${s.seconds},${s.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?lo(t.bytesValue).toBase64():"referenceValue"in t?(n=t.referenceValue,U.fromName(n).toString()):"geoPointValue"in t?`geo(${(e=t.geoPointValue).latitude},${e.longitude})`:"arrayValue"in t?function(r){let s="[",i=!0;for(const o of r.values||[])i?i=!1:s+=",",s+=Hm(o);return s+"]"}(t.arrayValue):"mapValue"in t?function(r){const s=Object.keys(r.fields||{}).sort();let i="{",o=!0;for(const a of s)o?o=!1:i+=",",i+=`${a}:${Hm(r.fields[a])}`;return i+"}"}(t.mapValue):G();var e,n}function ho(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function Wm(t){return!!t&&"integerValue"in t}function Jl(t){return!!t&&"arrayValue"in t}function xE(t){return!!t&&"nullValue"in t}function OE(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Rh(t){return!!t&&"mapValue"in t}function nl(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return Po(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=nl(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=nl(t.arrayValue.values[n]);return e}return Object.assign({},t)}function fN(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}function H2(t){return"nullValue"in t?kh:"booleanValue"in t?{booleanValue:!1}:"integerValue"in t||"doubleValue"in t?{doubleValue:NaN}:"timestampValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in t?{stringValue:""}:"bytesValue"in t?{bytesValue:""}:"referenceValue"in t?ho(us.empty(),U.empty()):"geoPointValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in t?{arrayValue:{}}:"mapValue"in t?{mapValue:{}}:G()}function W2(t){return"nullValue"in t?{booleanValue:!1}:"booleanValue"in t?{doubleValue:NaN}:"integerValue"in t||"doubleValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in t?{stringValue:""}:"stringValue"in t?{bytesValue:""}:"bytesValue"in t?ho(us.empty(),U.empty()):"referenceValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in t?{arrayValue:{}}:"arrayValue"in t?{mapValue:{}}:"mapValue"in t?Fs:G()}function ME(t,e){const n=ni(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?-1:!t.inclusive&&e.inclusive?1:0}function LE(t,e){const n=ni(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?1:!t.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bt{constructor(e){this.value=e}static empty(){return new Bt({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!Rh(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=nl(n)}setAll(e){let n=ct.emptyPath(),r={},s=[];e.forEach((o,a)=>{if(!n.isImmediateParentOf(a)){const c=this.getFieldsMap(n);this.applyChanges(c,r,s),r={},s=[],n=a.popLast()}o?r[a.lastSegment()]=nl(o):s.push(a.lastSegment())});const i=this.getFieldsMap(n);this.applyChanges(i,r,s)}delete(e){const n=this.field(e.popLast());Rh(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return Fr(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let s=n.mapValue.fields[e.get(r)];Rh(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=s),n=s}return n.mapValue.fields}applyChanges(e,n,r){Po(n,(s,i)=>e[s]=i);for(const s of r)delete e[s]}clone(){return new Bt(nl(this.value))}}function pN(t){const e=[];return Po(t.fields,(n,r)=>{const s=new ct([n]);if(Rh(r)){const i=pN(r.mapValue).fields;if(i.length===0)e.push(s);else for(const o of i)e.push(s.child(o))}else e.push(s)}),new Pn(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Be{constructor(e,n,r,s,i,o){this.key=e,this.documentType=n,this.version=r,this.readTime=s,this.data=i,this.documentState=o}static newInvalidDocument(e){return new Be(e,0,se.min(),se.min(),Bt.empty(),0)}static newFoundDocument(e,n,r){return new Be(e,1,n,se.min(),r,0)}static newNoDocument(e,n){return new Be(e,2,n,se.min(),Bt.empty(),0)}static newUnknownDocument(e,n){return new Be(e,3,n,se.min(),Bt.empty(),2)}convertToFoundDocument(e,n){return this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Bt.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Bt.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=se.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Be&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Be(this.key,this.documentType,this.version,this.readTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G2{constructor(e,n=null,r=[],s=[],i=null,o=null,a=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=s,this.limit=i,this.startAt=o,this.endAt=a,this.ut=null}}function FE(t,e=null,n=[],r=[],s=null,i=null,o=null){return new G2(t,e,n,r,s,i,o)}function fo(t){const e=q(t);if(e.ut===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>{return(s=r).field.canonicalString()+s.op.toString()+la(s.value);var s}).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(s){return s.field.canonicalString()+s.dir}(r)).join(","),Lu(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>la(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>la(r)).join(",")),e.ut=n}return e.ut}function z2(t){let e=t.path.canonicalString();return t.collectionGroup!==null&&(e+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(e+=`, filters: [${t.filters.map(n=>{return`${(r=n).field.canonicalString()} ${r.op} ${la(r.value)}`;var r}).join(", ")}]`),Lu(t.limit)||(e+=", limit: "+t.limit),t.orderBy.length>0&&(e+=`, orderBy: [${t.orderBy.map(n=>function(r){return`${r.field.canonicalString()} (${r.dir})`}(n)).join(", ")}]`),t.startAt&&(e+=", startAt: ",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map(n=>la(n)).join(",")),t.endAt&&(e+=", endAt: ",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map(n=>la(n)).join(",")),`Target(${e})`}function Fu(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let s=0;s<t.orderBy.length;s++)if(!n4(t.orderBy[s],e.orderBy[s]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let s=0;s<t.filters.length;s++)if(n=t.filters[s],r=e.filters[s],n.op!==r.op||!n.field.isEqual(r.field)||!Fr(n.value,r.value))return!1;var n,r;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!BE(t.startAt,e.startAt)&&BE(t.endAt,e.endAt)}function Ad(t){return U.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}function kd(t,e){return t.filters.filter(n=>n instanceof qt&&n.field.isEqual(e))}function UE(t,e,n){let r=kh,s=!0;for(const i of kd(t,e)){let o=kh,a=!0;switch(i.op){case"<":case"<=":o=H2(i.value);break;case"==":case"in":case">=":o=i.value;break;case">":o=i.value,a=!1;break;case"!=":case"not-in":o=kh}ME({value:r,inclusive:s},{value:o,inclusive:a})<0&&(r=o,s=a)}if(n!==null){for(let i=0;i<t.orderBy.length;++i)if(t.orderBy[i].field.isEqual(e)){const o=n.position[i];ME({value:r,inclusive:s},{value:o,inclusive:n.inclusive})<0&&(r=o,s=n.inclusive);break}}return{value:r,inclusive:s}}function $E(t,e,n){let r=Fs,s=!0;for(const i of kd(t,e)){let o=Fs,a=!0;switch(i.op){case">=":case">":o=W2(i.value),a=!1;break;case"==":case"in":case"<=":o=i.value;break;case"<":o=i.value,a=!1;break;case"!=":case"not-in":o=Fs}LE({value:r,inclusive:s},{value:o,inclusive:a})>0&&(r=o,s=a)}if(n!==null){for(let i=0;i<t.orderBy.length;++i)if(t.orderBy[i].field.isEqual(e)){const o=n.position[i];LE({value:r,inclusive:s},{value:o,inclusive:n.inclusive})>0&&(r=o,s=n.inclusive);break}}return{value:r,inclusive:s}}class qt extends class{}{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.ct(e,n,r):new Q2(e,n,r):n==="array-contains"?new X2(e,r):n==="in"?new Z2(e,r):n==="not-in"?new e4(e,r):n==="array-contains-any"?new t4(e,r):new qt(e,n,r)}static ct(e,n,r){return n==="in"?new Y2(e,r):new J2(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&this.at(ni(n,this.value)):n!==null&&uo(this.value)===uo(n)&&this.at(ni(n,this.value))}at(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return G()}}ht(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}}class Q2 extends qt{constructor(e,n,r){super(e,n,r),this.key=U.fromName(r.referenceValue)}matches(e){const n=U.comparator(e.key,this.key);return this.at(n)}}class Y2 extends qt{constructor(e,n){super(e,"in",n),this.keys=gN("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class J2 extends qt{constructor(e,n){super(e,"not-in",n),this.keys=gN("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function gN(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(r=>U.fromName(r.referenceValue))}class X2 extends qt{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return Jl(n)&&Yl(n.arrayValue,this.value)}}class Z2 extends qt{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&Yl(this.value.arrayValue,n)}}class e4 extends qt{constructor(e,n){super(e,"not-in",n)}matches(e){if(Yl(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&!Yl(this.value.arrayValue,n)}}class t4 extends qt{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!Jl(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>Yl(this.value.arrayValue,r))}}class ri{constructor(e,n){this.position=e,this.inclusive=n}}class ua{constructor(e,n="asc"){this.field=e,this.dir=n}}function n4(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}function VE(t,e,n){let r=0;for(let s=0;s<t.position.length;s++){const i=e[s],o=t.position[s];if(i.field.isKeyField()?r=U.comparator(U.fromName(o.referenceValue),n.key):r=ni(o,n.data.field(i.field)),i.dir==="desc"&&(r*=-1),r!==0)break}return r}function BE(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!Fr(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gs{constructor(e,n=null,r=[],s=[],i=null,o="F",a=null,c=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=s,this.limit=i,this.limitType=o,this.startAt=a,this.endAt=c,this.lt=null,this.ft=null,this.startAt,this.endAt}}function mN(t,e,n,r,s,i,o,a){return new gs(t,e,n,r,s,i,o,a)}function sc(t){return new gs(t)}function r4(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function Rv(t){return t.explicitOrderBy.length>0?t.explicitOrderBy[0].field:null}function Nv(t){for(const e of t.filters)if(e.ht())return e.field;return null}function Pv(t){return t.collectionGroup!==null}function Da(t){const e=q(t);if(e.lt===null){e.lt=[];const n=Nv(e),r=Rv(e);if(n!==null&&r===null)n.isKeyField()||e.lt.push(new ua(n)),e.lt.push(new ua(ct.keyField(),"asc"));else{let s=!1;for(const i of e.explicitOrderBy)e.lt.push(i),i.field.isKeyField()&&(s=!0);if(!s){const i=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";e.lt.push(new ua(ct.keyField(),i))}}}return e.lt}function Qn(t){const e=q(t);if(!e.ft)if(e.limitType==="F")e.ft=FE(e.path,e.collectionGroup,Da(e),e.filters,e.limit,e.startAt,e.endAt);else{const n=[];for(const i of Da(e)){const o=i.dir==="desc"?"asc":"desc";n.push(new ua(i.field,o))}const r=e.endAt?new ri(e.endAt.position,e.endAt.inclusive):null,s=e.startAt?new ri(e.startAt.position,e.startAt.inclusive):null;e.ft=FE(e.path,e.collectionGroup,n,e.filters,e.limit,r,s)}return e.ft}function _N(t,e,n){return new gs(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Uu(t,e){return Fu(Qn(t),Qn(e))&&t.limitType===e.limitType}function yN(t){return`${fo(Qn(t))}|lt:${t.limitType}`}function Gm(t){return`Query(target=${z2(Qn(t))}; limitType=${t.limitType})`}function Dv(t,e){return e.isFoundDocument()&&function(n,r){const s=r.key.path;return n.collectionGroup!==null?r.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(s):U.isDocumentKey(n.path)?n.path.isEqual(s):n.path.isImmediateParentOf(s)}(t,e)&&function(n,r){for(const s of n.explicitOrderBy)if(!s.field.isKeyField()&&r.data.field(s.field)===null)return!1;return!0}(t,e)&&function(n,r){for(const s of n.filters)if(!s.matches(r))return!1;return!0}(t,e)&&function(n,r){return!(n.startAt&&!function(s,i,o){const a=VE(s,i,o);return s.inclusive?a<=0:a<0}(n.startAt,Da(n),r)||n.endAt&&!function(s,i,o){const a=VE(s,i,o);return s.inclusive?a>=0:a>0}(n.endAt,Da(n),r))}(t,e)}function vN(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function wN(t){return(e,n)=>{let r=!1;for(const s of Da(t)){const i=s4(s,e,n);if(i!==0)return i;r=r||s.field.isKeyField()}return 0}}function s4(t,e,n){const r=t.field.isKeyField()?U.comparator(e.key,n.key):function(s,i,o){const a=i.data.field(s),c=o.data.field(s);return a!==null&&c!==null?ni(a,c):G()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return G()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bN(t,e){if(t.dt){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Ql(e)?"-0":e}}function IN(t){return{integerValue:""+t}}function EN(t,e){return dN(e)?IN(e):bN(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sp{constructor(){this._=void 0}}function i4(t,e,n){return t instanceof xa?function(r,s){const i={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:r.seconds,nanos:r.nanoseconds}}}};return s&&(i.fields.__previous_value__=s),{mapValue:i}}(n,e):t instanceof po?SN(t,e):t instanceof go?CN(t,e):function(r,s){const i=TN(r,s),o=qE(i)+qE(r._t);return Wm(i)&&Wm(r._t)?IN(o):bN(r.wt,o)}(t,e)}function o4(t,e,n){return t instanceof po?SN(t,e):t instanceof go?CN(t,e):n}function TN(t,e){return t instanceof Oa?Wm(n=e)||function(r){return!!r&&"doubleValue"in r}(n)?e:{integerValue:0}:null;var n}class xa extends sp{}class po extends sp{constructor(e){super(),this.elements=e}}function SN(t,e){const n=AN(e);for(const r of t.elements)n.some(s=>Fr(s,r))||n.push(r);return{arrayValue:{values:n}}}class go extends sp{constructor(e){super(),this.elements=e}}function CN(t,e){let n=AN(e);for(const r of t.elements)n=n.filter(s=>!Fr(s,r));return{arrayValue:{values:n}}}class Oa extends sp{constructor(e,n){super(),this.wt=e,this._t=n}}function qE(t){return nt(t.integerValue||t.doubleValue)}function AN(t){return Jl(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $u{constructor(e,n){this.field=e,this.transform=n}}function a4(t,e){return t.field.isEqual(e.field)&&function(n,r){return n instanceof po&&r instanceof po||n instanceof go&&r instanceof go?Pa(n.elements,r.elements,Fr):n instanceof Oa&&r instanceof Oa?Fr(n._t,r._t):n instanceof xa&&r instanceof xa}(t.transform,e.transform)}class c4{constructor(e,n){this.version=e,this.transformResults=n}}class Xe{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new Xe}static exists(e){return new Xe(void 0,e)}static updateTime(e){return new Xe(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Nh(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class ip{}function kN(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new oc(t.key,Xe.none()):new ic(t.key,t.data,Xe.none());{const n=t.data,r=Bt.empty();let s=new ke(ct.comparator);for(let i of e.fields)if(!s.has(i)){let o=n.field(i);o===null&&i.length>1&&(i=i.popLast(),o=n.field(i)),o===null?r.delete(i):r.set(i,o),s=s.add(i)}return new ms(t.key,r,new Pn(s.toArray()),Xe.none())}}function l4(t,e,n){t instanceof ic?function(r,s,i){const o=r.value.clone(),a=KE(r.fieldTransforms,s,i.transformResults);o.setAll(a),s.convertToFoundDocument(i.version,o).setHasCommittedMutations()}(t,e,n):t instanceof ms?function(r,s,i){if(!Nh(r.precondition,s))return void s.convertToUnknownDocument(i.version);const o=KE(r.fieldTransforms,s,i.transformResults),a=s.data;a.setAll(RN(r)),a.setAll(o),s.convertToFoundDocument(i.version,a).setHasCommittedMutations()}(t,e,n):function(r,s,i){s.convertToNoDocument(i.version).setHasCommittedMutations()}(0,e,n)}function rl(t,e,n,r){return t instanceof ic?function(s,i,o,a){if(!Nh(s.precondition,i))return o;const c=s.value.clone(),l=HE(s.fieldTransforms,a,i);return c.setAll(l),i.convertToFoundDocument(i.version,c).setHasLocalMutations(),null}(t,e,n,r):t instanceof ms?function(s,i,o,a){if(!Nh(s.precondition,i))return o;const c=HE(s.fieldTransforms,a,i),l=i.data;return l.setAll(RN(s)),l.setAll(c),i.convertToFoundDocument(i.version,l).setHasLocalMutations(),o===null?null:o.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(u=>u.field))}(t,e,n,r):function(s,i,o){return Nh(s.precondition,i)?(i.convertToNoDocument(i.version).setHasLocalMutations(),null):o}(t,e,n)}function u4(t,e){let n=null;for(const r of t.fieldTransforms){const s=e.data.field(r.field),i=TN(r.transform,s||null);i!=null&&(n===null&&(n=Bt.empty()),n.set(r.field,i))}return n||null}function jE(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(n,r){return n===void 0&&r===void 0||!(!n||!r)&&Pa(n,r,(s,i)=>a4(s,i))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class ic extends ip{constructor(e,n,r,s=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class ms extends ip{constructor(e,n,r,s,i=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function RN(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function KE(t,e,n){const r=new Map;ie(t.length===n.length);for(let s=0;s<n.length;s++){const i=t[s],o=i.transform,a=e.data.field(i.field);r.set(i.field,o4(o,a,n[s]))}return r}function HE(t,e,n){const r=new Map;for(const s of t){const i=s.transform,o=n.data.field(s.field);r.set(s.field,i4(i,o,e))}return r}class oc extends ip{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class xv extends ip{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h4{constructor(e){this.count=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var dt,ye;function NN(t){switch(t){default:return G();case w.CANCELLED:case w.UNKNOWN:case w.DEADLINE_EXCEEDED:case w.RESOURCE_EXHAUSTED:case w.INTERNAL:case w.UNAVAILABLE:case w.UNAUTHENTICATED:return!1;case w.INVALID_ARGUMENT:case w.NOT_FOUND:case w.ALREADY_EXISTS:case w.PERMISSION_DENIED:case w.FAILED_PRECONDITION:case w.ABORTED:case w.OUT_OF_RANGE:case w.UNIMPLEMENTED:case w.DATA_LOSS:return!0}}function PN(t){if(t===void 0)return ft("GRPC error has no .code"),w.UNKNOWN;switch(t){case dt.OK:return w.OK;case dt.CANCELLED:return w.CANCELLED;case dt.UNKNOWN:return w.UNKNOWN;case dt.DEADLINE_EXCEEDED:return w.DEADLINE_EXCEEDED;case dt.RESOURCE_EXHAUSTED:return w.RESOURCE_EXHAUSTED;case dt.INTERNAL:return w.INTERNAL;case dt.UNAVAILABLE:return w.UNAVAILABLE;case dt.UNAUTHENTICATED:return w.UNAUTHENTICATED;case dt.INVALID_ARGUMENT:return w.INVALID_ARGUMENT;case dt.NOT_FOUND:return w.NOT_FOUND;case dt.ALREADY_EXISTS:return w.ALREADY_EXISTS;case dt.PERMISSION_DENIED:return w.PERMISSION_DENIED;case dt.FAILED_PRECONDITION:return w.FAILED_PRECONDITION;case dt.ABORTED:return w.ABORTED;case dt.OUT_OF_RANGE:return w.OUT_OF_RANGE;case dt.UNIMPLEMENTED:return w.UNIMPLEMENTED;case dt.DATA_LOSS:return w.DATA_LOSS;default:return G()}}(ye=dt||(dt={}))[ye.OK=0]="OK",ye[ye.CANCELLED=1]="CANCELLED",ye[ye.UNKNOWN=2]="UNKNOWN",ye[ye.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",ye[ye.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",ye[ye.NOT_FOUND=5]="NOT_FOUND",ye[ye.ALREADY_EXISTS=6]="ALREADY_EXISTS",ye[ye.PERMISSION_DENIED=7]="PERMISSION_DENIED",ye[ye.UNAUTHENTICATED=16]="UNAUTHENTICATED",ye[ye.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",ye[ye.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",ye[ye.ABORTED=10]="ABORTED",ye[ye.OUT_OF_RANGE=11]="OUT_OF_RANGE",ye[ye.UNIMPLEMENTED=12]="UNIMPLEMENTED",ye[ye.INTERNAL=13]="INTERNAL",ye[ye.UNAVAILABLE=14]="UNAVAILABLE",ye[ye.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pi{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[s,i]of r)if(this.equalsFn(s,e))return i}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),s=this.inner[r];if(s===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,n]);s.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return r.length===1?delete this.inner[n]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(e){Po(this.inner,(n,r)=>{for(const[s,i]of r)e(s,i)})}isEmpty(){return uN(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const d4=new it(U.comparator);function wn(){return d4}const DN=new it(U.comparator);function Lc(...t){let e=DN;for(const n of t)e=e.insert(n.key,n);return e}function xN(t){let e=DN;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function Tr(){return sl()}function ON(){return sl()}function sl(){return new pi(t=>t.toString(),(t,e)=>t.isEqual(e))}const f4=new it(U.comparator),p4=new ke(U.comparator);function ue(...t){let e=p4;for(const n of t)e=e.add(n);return e}const g4=new ke(ce);function op(){return g4}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vu{constructor(e,n,r,s,i){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,n){const r=new Map;return r.set(e,Bu.createSynthesizedTargetChangeForCurrentChange(e,n)),new Vu(se.min(),r,op(),wn(),ue())}}class Bu{constructor(e,n,r,s,i){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,n){return new Bu(vt.EMPTY_BYTE_STRING,n,ue(),ue(),ue())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ph{constructor(e,n,r,s){this.gt=e,this.removedTargetIds=n,this.key=r,this.yt=s}}class MN{constructor(e,n){this.targetId=e,this.It=n}}class LN{constructor(e,n,r=vt.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=s}}class WE{constructor(){this.Tt=0,this.Et=zE(),this.At=vt.EMPTY_BYTE_STRING,this.Rt=!1,this.bt=!0}get current(){return this.Rt}get resumeToken(){return this.At}get Pt(){return this.Tt!==0}get vt(){return this.bt}Vt(e){e.approximateByteSize()>0&&(this.bt=!0,this.At=e)}St(){let e=ue(),n=ue(),r=ue();return this.Et.forEach((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:n=n.add(s);break;case 1:r=r.add(s);break;default:G()}}),new Bu(this.At,this.Rt,e,n,r)}Dt(){this.bt=!1,this.Et=zE()}Ct(e,n){this.bt=!0,this.Et=this.Et.insert(e,n)}xt(e){this.bt=!0,this.Et=this.Et.remove(e)}Nt(){this.Tt+=1}kt(){this.Tt-=1}Ot(){this.bt=!0,this.Rt=!0}}class m4{constructor(e){this.Mt=e,this.Ft=new Map,this.$t=wn(),this.Bt=GE(),this.Lt=new ke(ce)}Ut(e){for(const n of e.gt)e.yt&&e.yt.isFoundDocument()?this.qt(n,e.yt):this.Kt(n,e.key,e.yt);for(const n of e.removedTargetIds)this.Kt(n,e.key,e.yt)}Gt(e){this.forEachTarget(e,n=>{const r=this.Qt(n);switch(e.state){case 0:this.jt(n)&&r.Vt(e.resumeToken);break;case 1:r.kt(),r.Pt||r.Dt(),r.Vt(e.resumeToken);break;case 2:r.kt(),r.Pt||this.removeTarget(n);break;case 3:this.jt(n)&&(r.Ot(),r.Vt(e.resumeToken));break;case 4:this.jt(n)&&(this.Wt(n),r.Vt(e.resumeToken));break;default:G()}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.Ft.forEach((r,s)=>{this.jt(s)&&n(s)})}zt(e){const n=e.targetId,r=e.It.count,s=this.Ht(n);if(s){const i=s.target;if(Ad(i))if(r===0){const o=new U(i.path);this.Kt(n,o,Be.newNoDocument(o,se.min()))}else ie(r===1);else this.Jt(n)!==r&&(this.Wt(n),this.Lt=this.Lt.add(n))}}Yt(e){const n=new Map;this.Ft.forEach((i,o)=>{const a=this.Ht(o);if(a){if(i.current&&Ad(a.target)){const c=new U(a.target.path);this.$t.get(c)!==null||this.Xt(o,c)||this.Kt(o,c,Be.newNoDocument(c,e))}i.vt&&(n.set(o,i.St()),i.Dt())}});let r=ue();this.Bt.forEach((i,o)=>{let a=!0;o.forEachWhile(c=>{const l=this.Ht(c);return!l||l.purpose===2||(a=!1,!1)}),a&&(r=r.add(i))}),this.$t.forEach((i,o)=>o.setReadTime(e));const s=new Vu(e,n,this.Lt,this.$t,r);return this.$t=wn(),this.Bt=GE(),this.Lt=new ke(ce),s}qt(e,n){if(!this.jt(e))return;const r=this.Xt(e,n.key)?2:0;this.Qt(e).Ct(n.key,r),this.$t=this.$t.insert(n.key,n),this.Bt=this.Bt.insert(n.key,this.Zt(n.key).add(e))}Kt(e,n,r){if(!this.jt(e))return;const s=this.Qt(e);this.Xt(e,n)?s.Ct(n,1):s.xt(n),this.Bt=this.Bt.insert(n,this.Zt(n).delete(e)),r&&(this.$t=this.$t.insert(n,r))}removeTarget(e){this.Ft.delete(e)}Jt(e){const n=this.Qt(e).St();return this.Mt.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}Nt(e){this.Qt(e).Nt()}Qt(e){let n=this.Ft.get(e);return n||(n=new WE,this.Ft.set(e,n)),n}Zt(e){let n=this.Bt.get(e);return n||(n=new ke(ce),this.Bt=this.Bt.insert(e,n)),n}jt(e){const n=this.Ht(e)!==null;return n||P("WatchChangeAggregator","Detected inactive target",e),n}Ht(e){const n=this.Ft.get(e);return n&&n.Pt?null:this.Mt.te(e)}Wt(e){this.Ft.set(e,new WE),this.Mt.getRemoteKeysForTarget(e).forEach(n=>{this.Kt(e,n,null)})}Xt(e,n){return this.Mt.getRemoteKeysForTarget(e).has(n)}}function GE(){return new it(U.comparator)}function zE(){return new it(U.comparator)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _4=(()=>({asc:"ASCENDING",desc:"DESCENDING"}))(),y4=(()=>({"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"}))();class v4{constructor(e,n){this.databaseId=e,this.dt=n}}function Xl(t,e){return t.dt?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function FN(t,e){return t.dt?e.toBase64():e.toUint8Array()}function w4(t,e){return Xl(t,e.toTimestamp())}function Rt(t){return ie(!!t),se.fromTimestamp(function(e){const n=ti(e);return new Ye(n.seconds,n.nanos)}(t))}function Ov(t,e){return function(n){return new we(["projects",n.projectId,"databases",n.database])}(t).child("documents").child(e).canonicalString()}function UN(t){const e=we.fromString(t);return ie(WN(e)),e}function Zl(t,e){return Ov(t.databaseId,e.path)}function kr(t,e){const n=UN(e);if(n.get(1)!==t.databaseId.projectId)throw new k(w.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new k(w.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new U(VN(n))}function zm(t,e){return Ov(t.databaseId,e)}function $N(t){const e=UN(t);return e.length===4?we.emptyPath():VN(e)}function eu(t){return new we(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function VN(t){return ie(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function QE(t,e,n){return{name:Zl(t,e),fields:n.value.mapValue.fields}}function BN(t,e,n){const r=kr(t,e.name),s=Rt(e.updateTime),i=new Bt({mapValue:{fields:e.fields}}),o=Be.newFoundDocument(r,s,i);return n&&o.setHasCommittedMutations(),n?o.setHasCommittedMutations():o}function b4(t,e){return"found"in e?function(n,r){ie(!!r.found),r.found.name,r.found.updateTime;const s=kr(n,r.found.name),i=Rt(r.found.updateTime),o=new Bt({mapValue:{fields:r.found.fields}});return Be.newFoundDocument(s,i,o)}(t,e):"missing"in e?function(n,r){ie(!!r.missing),ie(!!r.readTime);const s=kr(n,r.missing),i=Rt(r.readTime);return Be.newNoDocument(s,i)}(t,e):G()}function I4(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(c){return c==="NO_CHANGE"?0:c==="ADD"?1:c==="REMOVE"?2:c==="CURRENT"?3:c==="RESET"?4:G()}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=function(c,l){return c.dt?(ie(l===void 0||typeof l=="string"),vt.fromBase64String(l||"")):(ie(l===void 0||l instanceof Uint8Array),vt.fromUint8Array(l||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(c){const l=c.code===void 0?w.UNKNOWN:PN(c.code);return new k(l,c.message||"")}(o);n=new LN(r,s,i,a||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const s=kr(t,r.document.name),i=Rt(r.document.updateTime),o=new Bt({mapValue:{fields:r.document.fields}}),a=Be.newFoundDocument(s,i,o),c=r.targetIds||[],l=r.removedTargetIds||[];n=new Ph(c,l,a.key,a)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const s=kr(t,r.document),i=r.readTime?Rt(r.readTime):se.min(),o=Be.newNoDocument(s,i),a=r.removedTargetIds||[];n=new Ph([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const s=kr(t,r.document),i=r.removedTargetIds||[];n=new Ph([],i,s,null)}else{if(!("filter"in e))return G();{e.filter;const r=e.filter;r.targetId;const s=r.count||0,i=new h4(s),o=r.targetId;n=new MN(o,i)}}return n}function tu(t,e){let n;if(e instanceof ic)n={update:QE(t,e.key,e.value)};else if(e instanceof oc)n={delete:Zl(t,e.key)};else if(e instanceof ms)n={update:QE(t,e.key,e.data),updateMask:R4(e.fieldMask)};else{if(!(e instanceof xv))return G();n={verify:Zl(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(s,i){const o=i.transform;if(o instanceof xa)return{fieldPath:i.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(o instanceof po)return{fieldPath:i.field.canonicalString(),appendMissingElements:{values:o.elements}};if(o instanceof go)return{fieldPath:i.field.canonicalString(),removeAllFromArray:{values:o.elements}};if(o instanceof Oa)return{fieldPath:i.field.canonicalString(),increment:o._t};throw G()}(0,r))),e.precondition.isNone||(n.currentDocument=function(r,s){return s.updateTime!==void 0?{updateTime:w4(r,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:G()}(t,e.precondition)),n}function Qm(t,e){const n=e.currentDocument?function(s){return s.updateTime!==void 0?Xe.updateTime(Rt(s.updateTime)):s.exists!==void 0?Xe.exists(s.exists):Xe.none()}(e.currentDocument):Xe.none(),r=e.updateTransforms?e.updateTransforms.map(s=>function(i,o){let a=null;if("setToServerValue"in o)ie(o.setToServerValue==="REQUEST_TIME"),a=new xa;else if("appendMissingElements"in o){const l=o.appendMissingElements.values||[];a=new po(l)}else if("removeAllFromArray"in o){const l=o.removeAllFromArray.values||[];a=new go(l)}else"increment"in o?a=new Oa(i,o.increment):G();const c=ct.fromServerFormat(o.fieldPath);return new $u(c,a)}(t,s)):[];if(e.update){e.update.name;const s=kr(t,e.update.name),i=new Bt({mapValue:{fields:e.update.fields}});if(e.updateMask){const o=function(a){const c=a.fieldPaths||[];return new Pn(c.map(l=>ct.fromServerFormat(l)))}(e.updateMask);return new ms(s,i,o,n,r)}return new ic(s,i,n,r)}if(e.delete){const s=kr(t,e.delete);return new oc(s,n)}if(e.verify){const s=kr(t,e.verify);return new xv(s,n)}return G()}function E4(t,e){return t&&t.length>0?(ie(e!==void 0),t.map(n=>function(r,s){let i=r.updateTime?Rt(r.updateTime):Rt(s);return i.isEqual(se.min())&&(i=Rt(s)),new c4(i,r.transformResults||[])}(n,e))):[]}function qN(t,e){return{documents:[zm(t,e.path)]}}function jN(t,e){const n={structuredQuery:{}},r=e.path;e.collectionGroup!==null?(n.parent=zm(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=zm(t,r.popLast()),n.structuredQuery.from=[{collectionId:r.lastSegment()}]);const s=function(c){if(c.length===0)return;const l=c.map(u=>function(h){if(h.op==="=="){if(OE(h.value))return{unaryFilter:{field:qo(h.field),op:"IS_NAN"}};if(xE(h.value))return{unaryFilter:{field:qo(h.field),op:"IS_NULL"}}}else if(h.op==="!="){if(OE(h.value))return{unaryFilter:{field:qo(h.field),op:"IS_NOT_NAN"}};if(xE(h.value))return{unaryFilter:{field:qo(h.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:qo(h.field),op:C4(h.op),value:h.value}}}(u));return l.length===1?l[0]:{compositeFilter:{op:"AND",filters:l}}}(e.filters);s&&(n.structuredQuery.where=s);const i=function(c){if(c.length!==0)return c.map(l=>function(u){return{field:qo(u.field),direction:S4(u.dir)}}(l))}(e.orderBy);i&&(n.structuredQuery.orderBy=i);const o=function(c,l){return c.dt||Lu(l)?l:{value:l}}(t,e.limit);var a;return o!==null&&(n.structuredQuery.limit=o),e.startAt&&(n.structuredQuery.startAt={before:(a=e.startAt).inclusive,values:a.position}),e.endAt&&(n.structuredQuery.endAt=function(c){return{before:!c.inclusive,values:c.position}}(e.endAt)),n}function KN(t){let e=$N(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let s=null;if(r>0){ie(r===1);const u=n.from[0];u.allDescendants?s=u.collectionId:e=e.child(u.collectionId)}let i=[];n.where&&(i=HN(n.where));let o=[];n.orderBy&&(o=n.orderBy.map(u=>function(h){return new ua(Xo(h.field),function(d){switch(d){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(h.direction))}(u)));let a=null;n.limit&&(a=function(u){let h;return h=typeof u=="object"?u.value:u,Lu(h)?null:h}(n.limit));let c=null;n.startAt&&(c=function(u){const h=!!u.before,d=u.values||[];return new ri(d,h)}(n.startAt));let l=null;return n.endAt&&(l=function(u){const h=!u.before,d=u.values||[];return new ri(d,h)}(n.endAt)),mN(e,s,o,i,a,"F",c,l)}function T4(t,e){const n=function(r,s){switch(s){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return G()}}(0,e.purpose);return n==null?null:{"goog-listen-tags":n}}function HN(t){return t?t.unaryFilter!==void 0?[k4(t)]:t.fieldFilter!==void 0?[A4(t)]:t.compositeFilter!==void 0?t.compositeFilter.filters.map(e=>HN(e)).reduce((e,n)=>e.concat(n)):G():[]}function S4(t){return _4[t]}function C4(t){return y4[t]}function qo(t){return{fieldPath:t.canonicalString()}}function Xo(t){return ct.fromServerFormat(t.fieldPath)}function A4(t){return qt.create(Xo(t.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return G()}}(t.fieldFilter.op),t.fieldFilter.value)}function k4(t){switch(t.unaryFilter.op){case"IS_NAN":const e=Xo(t.unaryFilter.field);return qt.create(e,"==",{doubleValue:NaN});case"IS_NULL":const n=Xo(t.unaryFilter.field);return qt.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const r=Xo(t.unaryFilter.field);return qt.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const s=Xo(t.unaryFilter.field);return qt.create(s,"!=",{nullValue:"NULL_VALUE"});default:return G()}}function R4(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function WN(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dn(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=YE(e)),e=N4(t.get(n),e);return YE(e)}function N4(t,e){let n=e;const r=t.length;for(let s=0;s<r;s++){const i=t.charAt(s);switch(i){case"\0":n+="";break;case"":n+="";break;default:n+=i}}return n}function YE(t){return t+""}function Sr(t){const e=t.length;if(ie(e>=2),e===2)return ie(t.charAt(0)===""&&t.charAt(1)===""),we.emptyPath();const n=e-2,r=[];let s="";for(let i=0;i<e;){const o=t.indexOf("",i);switch((o<0||o>n)&&G(),t.charAt(o+1)){case"":const a=t.substring(i,o);let c;s.length===0?c=a:(s+=a,c=s,s=""),r.push(c);break;case"":s+=t.substring(i,o),s+="\0";break;case"":s+=t.substring(i,o+1);break;default:G()}i=o+2}return new we(r)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JE=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dh(t,e){return[t,dn(e)]}function GN(t,e,n){return[t,dn(e),n]}const P4={},D4=["prefixPath","collectionGroup","readTime","documentId"],x4=["prefixPath","collectionGroup","documentId"],O4=["collectionGroup","readTime","prefixPath","documentId"],M4=["canonicalId","targetId"],L4=["targetId","path"],F4=["path","targetId"],U4=["collectionId","parent"],$4=["indexId","uid"],V4=["uid","sequenceNumber"],B4=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],q4=["indexId","uid","orderedDocumentKey"],j4=["userId","collectionPath","documentId"],K4=["userId","collectionPath","largestBatchId"],H4=["userId","collectionGroup","largestBatchId"],zN=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],W4=[...zN,"documentOverlays"],QN=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],YN=QN,G4=[...YN,"indexConfiguration","indexState","indexEntries"];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ym extends lN{constructor(e,n){super(),this.ee=e,this.currentSequenceNumber=n}}function Lt(t,e){const n=q(t);return ir.N(n.ee,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mv{constructor(e,n,r,s){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&l4(i,e,r[s])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=rl(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=rl(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=ON();return this.mutations.forEach(s=>{const i=e.get(s.key),o=i.overlayedDocument;let a=this.applyToLocalView(o,i.mutatedFields);a=n.has(s.key)?null:a;const c=kN(o,a);c!==null&&r.set(s.key,c),o.isValidDocument()||o.convertToNoDocument(se.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),ue())}isEqual(e){return this.batchId===e.batchId&&Pa(this.mutations,e.mutations,(n,r)=>jE(n,r))&&Pa(this.baseMutations,e.baseMutations,(n,r)=>jE(n,r))}}class Lv{constructor(e,n,r,s){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=s}static from(e,n,r){ie(e.mutations.length===r.length);let s=f4;const i=e.mutations;for(let o=0;o<i.length;o++)s=s.insert(i[o].key,r[o].version);return new Lv(e,n,r,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fv{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ks{constructor(e,n,r,s,i=se.min(),o=se.min(),a=vt.EMPTY_BYTE_STRING){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a}withSequenceNumber(e){return new Ks(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)}withResumeToken(e,n){return new Ks(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e)}withLastLimboFreeSnapshotVersion(e){return new Ks(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JN{constructor(e){this.ne=e}}function z4(t,e){let n;if(e.document)n=BN(t.ne,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=U.fromSegments(e.noDocument.path),s=_o(e.noDocument.readTime);n=Be.newNoDocument(r,s),e.hasCommittedMutations&&n.setHasCommittedMutations()}else{if(!e.unknownDocument)return G();{const r=U.fromSegments(e.unknownDocument.path),s=_o(e.unknownDocument.version);n=Be.newUnknownDocument(r,s)}}return e.readTime&&n.setReadTime(function(r){const s=new Ye(r[0],r[1]);return se.fromTimestamp(s)}(e.readTime)),n}function XE(t,e){const n=e.key,r={prefixPath:n.getCollectionPath().popLast().toArray(),collectionGroup:n.collectionGroup,documentId:n.path.lastSegment(),readTime:Rd(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=function(s,i){return{name:Zl(s,i.key),fields:i.data.value.mapValue.fields,updateTime:Xl(s,i.version.toTimestamp())}}(t.ne,e);else if(e.isNoDocument())r.noDocument={path:n.path.toArray(),readTime:mo(e.version)};else{if(!e.isUnknownDocument())return G();r.unknownDocument={path:n.path.toArray(),version:mo(e.version)}}return r}function Rd(t){const e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function mo(t){const e=t.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function _o(t){const e=new Ye(t.seconds,t.nanoseconds);return se.fromTimestamp(e)}function Pi(t,e){const n=(e.baseMutations||[]).map(i=>Qm(t.ne,i));for(let i=0;i<e.mutations.length-1;++i){const o=e.mutations[i];if(i+1<e.mutations.length&&e.mutations[i+1].transform!==void 0){const a=e.mutations[i+1];o.updateTransforms=a.transform.fieldTransforms,e.mutations.splice(i+1,1),++i}}const r=e.mutations.map(i=>Qm(t.ne,i)),s=Ye.fromMillis(e.localWriteTimeMs);return new Mv(e.batchId,s,n,r)}function Fc(t){const e=_o(t.readTime),n=t.lastLimboFreeSnapshotVersion!==void 0?_o(t.lastLimboFreeSnapshotVersion):se.min();let r;var s;return t.query.documents!==void 0?(ie((s=t.query).documents.length===1),r=Qn(sc($N(s.documents[0])))):r=function(i){return Qn(KN(i))}(t.query),new Ks(r,t.targetId,0,t.lastListenSequenceNumber,e,n,vt.fromBase64String(t.resumeToken))}function XN(t,e){const n=mo(e.snapshotVersion),r=mo(e.lastLimboFreeSnapshotVersion);let s;s=Ad(e.target)?qN(t.ne,e.target):jN(t.ne,e.target);const i=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:fo(e.target),readTime:n,resumeToken:i,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:s}}function Uv(t){const e=KN({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?_N(e,e.limit,"L"):e}function dg(t,e){return new Fv(e.largestBatchId,Qm(t.ne,e.overlayMutation))}function ZE(t,e){const n=e.path.lastSegment();return[t,dn(e.path.popLast()),n]}function eT(t,e,n,r){return{indexId:t,uid:e.uid||"",sequenceNumber:n,readTime:mo(r.readTime),documentKey:dn(r.documentKey.path),largestBatchId:r.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q4{getBundleMetadata(e,n){return tT(e).get(n).next(r=>{if(r)return{id:(s=r).bundleId,createTime:_o(s.createTime),version:s.version};var s})}saveBundleMetadata(e,n){return tT(e).put({bundleId:(r=n).id,createTime:mo(Rt(r.createTime)),version:r.version});var r}getNamedQuery(e,n){return nT(e).get(n).next(r=>{if(r)return{name:(s=r).name,query:Uv(s.bundledQuery),readTime:_o(s.readTime)};var s})}saveNamedQuery(e,n){return nT(e).put(function(r){return{name:r.name,readTime:mo(Rt(r.readTime)),bundledQuery:r.bundledQuery}}(n))}}function tT(t){return Lt(t,"bundles")}function nT(t){return Lt(t,"namedQueries")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ap{constructor(e,n){this.wt=e,this.userId=n}static se(e,n){const r=n.uid||"";return new ap(e,r)}getOverlay(e,n){return Ec(e).get(ZE(this.userId,n)).next(r=>r?dg(this.wt,r):null)}getOverlays(e,n){const r=Tr();return v.forEach(n,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,n,r){const s=[];return r.forEach((i,o)=>{const a=new Fv(n,o);s.push(this.ie(e,a))}),v.waitFor(s)}removeOverlaysForBatchId(e,n,r){const s=new Set;n.forEach(o=>s.add(dn(o.getCollectionPath())));const i=[];return s.forEach(o=>{const a=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,r+1],!1,!0);i.push(Ec(e).W("collectionPathOverlayIndex",a))}),v.waitFor(i)}getOverlaysForCollection(e,n,r){const s=Tr(),i=dn(n),o=IDBKeyRange.bound([this.userId,i,r],[this.userId,i,Number.POSITIVE_INFINITY],!0);return Ec(e).K("collectionPathOverlayIndex",o).next(a=>{for(const c of a){const l=dg(this.wt,c);s.set(l.getKey(),l)}return s})}getOverlaysForCollectionGroup(e,n,r,s){const i=Tr();let o;const a=IDBKeyRange.bound([this.userId,n,r],[this.userId,n,Number.POSITIVE_INFINITY],!0);return Ec(e).J({index:"collectionGroupOverlayIndex",range:a},(c,l,u)=>{const h=dg(this.wt,l);i.size()<s||h.largestBatchId===o?(i.set(h.getKey(),h),o=h.largestBatchId):u.done()}).next(()=>i)}ie(e,n){return Ec(e).put(function(r,s,i){const[o,a,c]=ZE(s,i.mutation.key);return{userId:s,collectionPath:a,documentId:c,collectionGroup:i.mutation.key.getCollectionGroup(),largestBatchId:i.largestBatchId,overlayMutation:tu(r.ne,i.mutation)}}(this.wt,this.userId,n))}}function Ec(t){return Lt(t,"documentOverlays")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Di{constructor(){}re(e,n){this.oe(e,n),n.ue()}oe(e,n){if("nullValue"in e)this.ce(n,5);else if("booleanValue"in e)this.ce(n,10),n.ae(e.booleanValue?1:0);else if("integerValue"in e)this.ce(n,15),n.ae(nt(e.integerValue));else if("doubleValue"in e){const r=nt(e.doubleValue);isNaN(r)?this.ce(n,13):(this.ce(n,15),Ql(r)?n.ae(0):n.ae(r))}else if("timestampValue"in e){const r=e.timestampValue;this.ce(n,20),typeof r=="string"?n.he(r):(n.he(`${r.seconds||""}`),n.ae(r.nanos||0))}else if("stringValue"in e)this.le(e.stringValue,n),this.fe(n);else if("bytesValue"in e)this.ce(n,30),n.de(lo(e.bytesValue)),this.fe(n);else if("referenceValue"in e)this._e(e.referenceValue,n);else if("geoPointValue"in e){const r=e.geoPointValue;this.ce(n,45),n.ae(r.latitude||0),n.ae(r.longitude||0)}else"mapValue"in e?fN(e)?this.ce(n,Number.MAX_SAFE_INTEGER):(this.we(e.mapValue,n),this.fe(n)):"arrayValue"in e?(this.me(e.arrayValue,n),this.fe(n)):G()}le(e,n){this.ce(n,25),this.ge(e,n)}ge(e,n){n.he(e)}we(e,n){const r=e.fields||{};this.ce(n,55);for(const s of Object.keys(r))this.le(s,n),this.oe(r[s],n)}me(e,n){const r=e.values||[];this.ce(n,50);for(const s of r)this.oe(s,n)}_e(e,n){this.ce(n,37),U.fromName(e).path.forEach(r=>{this.ce(n,60),this.ge(r,n)})}ce(e,n){e.ae(n)}fe(e){e.ae(2)}}Di.ye=new Di;function Y4(t){if(t===0)return 8;let e=0;return t>>4==0&&(e+=4,t<<=4),t>>6==0&&(e+=2,t<<=2),t>>7==0&&(e+=1),e}function rT(t){const e=64-function(n){let r=0;for(let s=0;s<8;++s){const i=Y4(255&n[s]);if(r+=i,i!==8)break}return r}(t);return Math.ceil(e/8)}class J4{constructor(){this.buffer=new Uint8Array(1024),this.position=0}pe(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.Ie(r.value),r=n.next();this.Te()}Ee(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.Ae(r.value),r=n.next();this.Re()}be(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.Ie(r);else if(r<2048)this.Ie(960|r>>>6),this.Ie(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Ie(480|r>>>12),this.Ie(128|63&r>>>6),this.Ie(128|63&r);else{const s=n.codePointAt(0);this.Ie(240|s>>>18),this.Ie(128|63&s>>>12),this.Ie(128|63&s>>>6),this.Ie(128|63&s)}}this.Te()}Pe(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.Ae(r);else if(r<2048)this.Ae(960|r>>>6),this.Ae(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Ae(480|r>>>12),this.Ae(128|63&r>>>6),this.Ae(128|63&r);else{const s=n.codePointAt(0);this.Ae(240|s>>>18),this.Ae(128|63&s>>>12),this.Ae(128|63&s>>>6),this.Ae(128|63&s)}}this.Re()}ve(e){const n=this.Ve(e),r=rT(n);this.Se(1+r),this.buffer[this.position++]=255&r;for(let s=n.length-r;s<n.length;++s)this.buffer[this.position++]=255&n[s]}De(e){const n=this.Ve(e),r=rT(n);this.Se(1+r),this.buffer[this.position++]=~(255&r);for(let s=n.length-r;s<n.length;++s)this.buffer[this.position++]=~(255&n[s])}Ce(){this.xe(255),this.xe(255)}Ne(){this.ke(255),this.ke(255)}reset(){this.position=0}seed(e){this.Se(e.length),this.buffer.set(e,this.position),this.position+=e.length}Oe(){return this.buffer.slice(0,this.position)}Ve(e){const n=function(s){const i=new DataView(new ArrayBuffer(8));return i.setFloat64(0,s,!1),new Uint8Array(i.buffer)}(e),r=(128&n[0])!=0;n[0]^=r?255:128;for(let s=1;s<n.length;++s)n[s]^=r?255:0;return n}Ie(e){const n=255&e;n===0?(this.xe(0),this.xe(255)):n===255?(this.xe(255),this.xe(0)):this.xe(n)}Ae(e){const n=255&e;n===0?(this.ke(0),this.ke(255)):n===255?(this.ke(255),this.ke(0)):this.ke(e)}Te(){this.xe(0),this.xe(1)}Re(){this.ke(0),this.ke(1)}xe(e){this.Se(1),this.buffer[this.position++]=e}ke(e){this.Se(1),this.buffer[this.position++]=~e}Se(e){const n=e+this.position;if(n<=this.buffer.length)return;let r=2*this.buffer.length;r<n&&(r=n);const s=new Uint8Array(r);s.set(this.buffer),this.buffer=s}}class X4{constructor(e){this.Me=e}de(e){this.Me.pe(e)}he(e){this.Me.be(e)}ae(e){this.Me.ve(e)}ue(){this.Me.Ce()}}class Z4{constructor(e){this.Me=e}de(e){this.Me.Ee(e)}he(e){this.Me.Pe(e)}ae(e){this.Me.De(e)}ue(){this.Me.Ne()}}class Tc{constructor(){this.Me=new J4,this.Fe=new X4(this.Me),this.$e=new Z4(this.Me)}seed(e){this.Me.seed(e)}Be(e){return e===0?this.Fe:this.$e}Oe(){return this.Me.Oe()}reset(){this.Me.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xi{constructor(e,n,r,s){this.indexId=e,this.documentKey=n,this.arrayValue=r,this.directionalValue=s}Le(){const e=this.directionalValue.length,n=e===0||this.directionalValue[e-1]===255?e+1:e,r=new Uint8Array(n);return r.set(this.directionalValue,0),n!==e?r.set([0],this.directionalValue.length):++r[r.length-1],new xi(this.indexId,this.documentKey,this.arrayValue,r)}}function bi(t,e){let n=t.indexId-e.indexId;return n!==0?n:(n=sT(t.arrayValue,e.arrayValue),n!==0?n:(n=sT(t.directionalValue,e.directionalValue),n!==0?n:U.comparator(t.documentKey,e.documentKey)))}function sT(t,e){for(let n=0;n<t.length&&n<e.length;++n){const r=t[n]-e[n];if(r!==0)return r}return t.length-e.length}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e6{constructor(e){this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.Ue=e.orderBy,this.qe=[];for(const n of e.filters){const r=n;r.ht()?this.Ke=r:this.qe.push(r)}}Ge(e){const n=Km(e);if(n!==void 0&&!this.Qe(n))return!1;const r=Ci(e);let s=0,i=0;for(;s<r.length&&this.Qe(r[s]);++s);if(s===r.length)return!0;if(this.Ke!==void 0){const o=r[s];if(!this.je(this.Ke,o)||!this.We(this.Ue[i++],o))return!1;++s}for(;s<r.length;++s){const o=r[s];if(i>=this.Ue.length||!this.We(this.Ue[i++],o))return!1}return!0}Qe(e){for(const n of this.qe)if(this.je(n,e))return!0;return!1}je(e,n){if(e===void 0||!e.field.isEqual(n.fieldPath))return!1;const r=e.op==="array-contains"||e.op==="array-contains-any";return n.kind===2===r}We(e,n){return!!e.field.isEqual(n.fieldPath)&&(n.kind===0&&e.dir==="asc"||n.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class t6{constructor(){this.ze=new $v}addToCollectionParentIndex(e,n){return this.ze.add(n),v.resolve()}getCollectionParents(e,n){return v.resolve(this.ze.getEntries(n))}addFieldIndex(e,n){return v.resolve()}deleteFieldIndex(e,n){return v.resolve()}getDocumentsMatchingTarget(e,n){return v.resolve(null)}getIndexType(e,n){return v.resolve(0)}getFieldIndexes(e,n){return v.resolve([])}getNextCollectionGroupToUpdate(e){return v.resolve(null)}getMinOffset(e,n){return v.resolve(Mn.min())}getMinOffsetFromCollectionGroup(e,n){return v.resolve(Mn.min())}updateCollectionGroup(e,n,r){return v.resolve()}updateIndexEntries(e,n){return v.resolve()}}class $v{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n]||new ke(we.comparator),i=!s.has(r);return this.index[n]=s.add(r),i}has(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n];return s&&s.has(r)}getEntries(e){return(this.index[e]||new ke(we.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uh=new Uint8Array(0);class n6{constructor(e,n){this.user=e,this.databaseId=n,this.He=new $v,this.Je=new pi(r=>fo(r),(r,s)=>Fu(r,s)),this.uid=e.uid||""}addToCollectionParentIndex(e,n){if(!this.He.has(n)){const r=n.lastSegment(),s=n.popLast();e.addOnCommittedListener(()=>{this.He.add(n)});const i={collectionId:r,parent:dn(s)};return iT(e).put(i)}return v.resolve()}getCollectionParents(e,n){const r=[],s=IDBKeyRange.bound([n,""],[sN(n),""],!1,!0);return iT(e).K(s).next(i=>{for(const o of i){if(o.collectionId!==n)break;r.push(Sr(o.parent))}return r})}addFieldIndex(e,n){const r=hh(e),s=function(o){return{indexId:o.indexId,collectionGroup:o.collectionGroup,fields:o.fields.map(a=>[a.fieldPath.canonicalString(),a.kind])}}(n);delete s.indexId;const i=r.add(s);if(n.indexState){const o=Cc(e);return i.next(a=>{o.put(eT(a,this.user,n.indexState.sequenceNumber,n.indexState.offset))})}return i.next()}deleteFieldIndex(e,n){const r=hh(e),s=Cc(e),i=Sc(e);return r.delete(n.indexId).next(()=>s.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0))).next(()=>i.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0)))}getDocumentsMatchingTarget(e,n){const r=Sc(e);let s=!0;const i=new Map;return v.forEach(this.Ye(n),o=>this.Xe(e,o).next(a=>{s&&(s=!!a),i.set(o,a)})).next(()=>{if(s){let o=ue();const a=[];return v.forEach(i,(c,l)=>{var u;P("IndexedDbIndexManager",`Using index ${u=c,`id=${u.indexId}|cg=${u.collectionGroup}|f=${u.fields.map(E=>`${E.fieldPath}:${E.kind}`).join(",")}`} to execute ${fo(n)}`);const h=function(E,S){const $=Km(S);if($===void 0)return null;for(const H of kd(E,$.fieldPath))switch(H.op){case"array-contains-any":return H.value.arrayValue.values||[];case"array-contains":return[H.value]}return null}(l,c),d=function(E,S){const $=new Map;for(const H of Ci(S))for(const K of kd(E,H.fieldPath))switch(K.op){case"==":case"in":$.set(H.fieldPath.canonicalString(),K.value);break;case"not-in":case"!=":return $.set(H.fieldPath.canonicalString(),K.value),Array.from($.values())}return null}(l,c),f=function(E,S){const $=[];let H=!0;for(const K of Ci(S)){const F=K.kind===0?UE(E,K.fieldPath,E.startAt):$E(E,K.fieldPath,E.startAt);$.push(F.value),H&&(H=F.inclusive)}return new ri($,H)}(l,c),p=function(E,S){const $=[];let H=!0;for(const K of Ci(S)){const F=K.kind===0?$E(E,K.fieldPath,E.endAt):UE(E,K.fieldPath,E.endAt);$.push(F.value),H&&(H=F.inclusive)}return new ri($,H)}(l,c),_=this.Ze(c,l,f),y=this.Ze(c,l,p),T=this.tn(c,l,d),I=this.en(c.indexId,h,_,f.inclusive,y,p.inclusive,T);return v.forEach(I,E=>r.j(E,n.limit).next(S=>{S.forEach($=>{const H=U.fromSegments($.documentKey);o.has(H)||(o=o.add(H),a.push(H))})}))}).next(()=>a)}return v.resolve(null)})}Ye(e){let n=this.Je.get(e);return n||(n=[e],this.Je.set(e,n),n)}en(e,n,r,s,i,o,a){const c=(n!=null?n.length:1)*Math.max(r.length,i.length),l=c/(n!=null?n.length:1),u=[];for(let h=0;h<c;++h){const d=n?this.nn(n[h/l]):uh,f=this.sn(e,d,r[h%l],s),p=this.rn(e,d,i[h%l],o),_=a.map(y=>this.sn(e,d,y,!0));u.push(...this.createRange(f,p,_))}return u}sn(e,n,r,s){const i=new xi(e,U.empty(),n,r);return s?i:i.Le()}rn(e,n,r,s){const i=new xi(e,U.empty(),n,r);return s?i.Le():i}Xe(e,n){const r=new e6(n),s=n.collectionGroup!=null?n.collectionGroup:n.path.lastSegment();return this.getFieldIndexes(e,s).next(i=>{let o=null;for(const a of i)r.Ge(a)&&(!o||a.fields.length>o.fields.length)&&(o=a);return o})}getIndexType(e,n){let r=2;return v.forEach(this.Ye(n),s=>this.Xe(e,s).next(i=>{i?r!==0&&i.fields.length<function(o){let a=new ke(ct.comparator),c=!1;for(const l of o.filters){const u=l;u.field.isKeyField()||(u.op==="array-contains"||u.op==="array-contains-any"?c=!0:a=a.add(u.field))}for(const l of o.orderBy)l.field.isKeyField()||(a=a.add(l.field));return a.size+(c?1:0)}(s)&&(r=1):r=0})).next(()=>r)}on(e,n){const r=new Tc;for(const s of Ci(e)){const i=n.data.field(s.fieldPath);if(i==null)return null;const o=r.Be(s.kind);Di.ye.re(i,o)}return r.Oe()}nn(e){const n=new Tc;return Di.ye.re(e,n.Be(0)),n.Oe()}un(e,n){const r=new Tc;return Di.ye.re(ho(this.databaseId,n),r.Be(function(s){const i=Ci(s);return i.length===0?0:i[i.length-1].kind}(e))),r.Oe()}tn(e,n,r){if(r===null)return[];let s=[];s.push(new Tc);let i=0;for(const o of Ci(e)){const a=r[i++];for(const c of s)if(this.cn(n,o.fieldPath)&&Jl(a))s=this.an(s,o,a);else{const l=c.Be(o.kind);Di.ye.re(a,l)}}return this.hn(s)}Ze(e,n,r){return this.tn(e,n,r.position)}hn(e){const n=[];for(let r=0;r<e.length;++r)n[r]=e[r].Oe();return n}an(e,n,r){const s=[...e],i=[];for(const o of r.arrayValue.values||[])for(const a of s){const c=new Tc;c.seed(a.Oe()),Di.ye.re(o,c.Be(n.kind)),i.push(c)}return i}cn(e,n){return!!e.filters.find(r=>r instanceof qt&&r.field.isEqual(n)&&(r.op==="in"||r.op==="not-in"))}getFieldIndexes(e,n){const r=hh(e),s=Cc(e);return(n?r.K("collectionGroupIndex",IDBKeyRange.bound(n,n)):r.K()).next(i=>{const o=[];return v.forEach(i,a=>s.get([a.indexId,this.uid]).next(c=>{o.push(function(l,u){const h=u?new Cd(u.sequenceNumber,new Mn(_o(u.readTime),new U(Sr(u.documentKey)),u.largestBatchId)):Cd.empty(),d=l.fields.map(([f,p])=>new F2(ct.fromServerFormat(f),p));return new iN(l.indexId,l.collectionGroup,d,h)}(a,c))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(n=>n.length===0?null:(n.sort((r,s)=>{const i=r.indexState.sequenceNumber-s.indexState.sequenceNumber;return i!==0?i:ce(r.collectionGroup,s.collectionGroup)}),n[0].collectionGroup))}updateCollectionGroup(e,n,r){const s=hh(e),i=Cc(e);return this.ln(e).next(o=>s.K("collectionGroupIndex",IDBKeyRange.bound(n,n)).next(a=>v.forEach(a,c=>i.put(eT(c.indexId,this.user,o,r)))))}updateIndexEntries(e,n){const r=new Map;return v.forEach(n,(s,i)=>{const o=r.get(s.collectionGroup);return(o?v.resolve(o):this.getFieldIndexes(e,s.collectionGroup)).next(a=>(r.set(s.collectionGroup,a),v.forEach(a,c=>this.fn(e,s,c).next(l=>{const u=this.dn(i,c);return l.isEqual(u)?v.resolve():this._n(e,i,c,l,u)}))))})}wn(e,n,r,s){return Sc(e).put({indexId:s.indexId,uid:this.uid,arrayValue:s.arrayValue,directionalValue:s.directionalValue,orderedDocumentKey:this.un(r,n.key),documentKey:n.key.path.toArray()})}mn(e,n,r,s){return Sc(e).delete([s.indexId,this.uid,s.arrayValue,s.directionalValue,this.un(r,n.key),n.key.path.toArray()])}fn(e,n,r){const s=Sc(e);let i=new ke(bi);return s.J({index:"documentKeyIndex",range:IDBKeyRange.only([r.indexId,this.uid,this.un(r,n)])},(o,a)=>{i=i.add(new xi(r.indexId,n,a.arrayValue,a.directionalValue))}).next(()=>i)}dn(e,n){let r=new ke(bi);const s=this.on(n,e);if(s==null)return r;const i=Km(n);if(i!=null){const o=e.data.field(i.fieldPath);if(Jl(o))for(const a of o.arrayValue.values||[])r=r.add(new xi(n.indexId,e.key,this.nn(a),s))}else r=r.add(new xi(n.indexId,e.key,uh,s));return r}_n(e,n,r,s,i){P("IndexedDbIndexManager","Updating index entries for document '%s'",n.key);const o=[];return function(a,c,l,u,h){const d=a.getIterator(),f=c.getIterator();let p=Bo(d),_=Bo(f);for(;p||_;){let y=!1,T=!1;if(p&&_){const I=l(p,_);I<0?T=!0:I>0&&(y=!0)}else p!=null?T=!0:y=!0;y?(u(_),_=Bo(f)):T?(h(p),p=Bo(d)):(p=Bo(d),_=Bo(f))}}(s,i,bi,a=>{o.push(this.wn(e,n,r,a))},a=>{o.push(this.mn(e,n,r,a))}),v.waitFor(o)}ln(e){let n=1;return Cc(e).J({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,s,i)=>{i.done(),n=s.sequenceNumber+1}).next(()=>n)}createRange(e,n,r){r=r.sort((o,a)=>bi(o,a)).filter((o,a,c)=>!a||bi(o,c[a-1])!==0);const s=[];s.push(e);for(const o of r){const a=bi(o,e),c=bi(o,n);if(a===0)s[0]=e.Le();else if(a>0&&c<0)s.push(o),s.push(o.Le());else if(c>0)break}s.push(n);const i=[];for(let o=0;o<s.length;o+=2)i.push(IDBKeyRange.bound([s[o].indexId,this.uid,s[o].arrayValue,s[o].directionalValue,uh,[]],[s[o+1].indexId,this.uid,s[o+1].arrayValue,s[o+1].directionalValue,uh,[]]));return i}getMinOffsetFromCollectionGroup(e,n){return this.getFieldIndexes(e,n).next(oT)}getMinOffset(e,n){return v.mapArray(this.Ye(n),r=>this.Xe(e,r).next(s=>s||G())).next(oT)}}function iT(t){return Lt(t,"collectionParents")}function Sc(t){return Lt(t,"indexEntries")}function hh(t){return Lt(t,"indexConfiguration")}function Cc(t){return Lt(t,"indexState")}function oT(t){ie(t.length!==0);let e=t[0].indexState.offset,n=e.largestBatchId;for(let r=1;r<t.length;r++){const s=t[r].indexState.offset;Cv(s,e)<0&&(e=s),n<s.largestBatchId&&(n=s.largestBatchId)}return new Mn(e.readTime,e.documentKey,n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aT={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class mn{constructor(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new mn(e,mn.DEFAULT_COLLECTION_PERCENTILE,mn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ZN(t,e,n){const r=t.store("mutations"),s=t.store("documentMutations"),i=[],o=IDBKeyRange.only(n.batchId);let a=0;const c=r.J({range:o},(u,h,d)=>(a++,d.delete()));i.push(c.next(()=>{ie(a===1)}));const l=[];for(const u of n.mutations){const h=GN(e,u.key.path,n.batchId);i.push(s.delete(h)),l.push(u.key)}return v.waitFor(i).next(()=>l)}function Nd(t){if(!t)return 0;let e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw G();e=t.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */mn.DEFAULT_COLLECTION_PERCENTILE=10,mn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,mn.DEFAULT=new mn(41943040,mn.DEFAULT_COLLECTION_PERCENTILE,mn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),mn.DISABLED=new mn(-1,0,0);class cp{constructor(e,n,r,s){this.userId=e,this.wt=n,this.indexManager=r,this.referenceDelegate=s,this.gn={}}static se(e,n,r,s){ie(e.uid!=="");const i=e.isAuthenticated()?e.uid:"";return new cp(i,n,r,s)}checkEmpty(e){let n=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Ss(e).J({index:"userMutationsIndex",range:r},(s,i,o)=>{n=!1,o.done()}).next(()=>n)}addMutationBatch(e,n,r,s){const i=Qo(e),o=Ss(e);return o.add({}).next(a=>{ie(typeof a=="number");const c=new Mv(a,n,r,s),l=function(d,f,p){const _=p.baseMutations.map(T=>tu(d.ne,T)),y=p.mutations.map(T=>tu(d.ne,T));return{userId:f,batchId:p.batchId,localWriteTimeMs:p.localWriteTime.toMillis(),baseMutations:_,mutations:y}}(this.wt,this.userId,c),u=[];let h=new ke((d,f)=>ce(d.canonicalString(),f.canonicalString()));for(const d of s){const f=GN(this.userId,d.key.path,a);h=h.add(d.key.path.popLast()),u.push(o.put(l)),u.push(i.put(f,P4))}return h.forEach(d=>{u.push(this.indexManager.addToCollectionParentIndex(e,d))}),e.addOnCommittedListener(()=>{this.gn[a]=c.keys()}),v.waitFor(u).next(()=>c)})}lookupMutationBatch(e,n){return Ss(e).get(n).next(r=>r?(ie(r.userId===this.userId),Pi(this.wt,r)):null)}yn(e,n){return this.gn[n]?v.resolve(this.gn[n]):this.lookupMutationBatch(e,n).next(r=>{if(r){const s=r.keys();return this.gn[n]=s,s}return null})}getNextMutationBatchAfterBatchId(e,n){const r=n+1,s=IDBKeyRange.lowerBound([this.userId,r]);let i=null;return Ss(e).J({index:"userMutationsIndex",range:s},(o,a,c)=>{a.userId===this.userId&&(ie(a.batchId>=r),i=Pi(this.wt,a)),c.done()}).next(()=>i)}getHighestUnacknowledgedBatchId(e){const n=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=-1;return Ss(e).J({index:"userMutationsIndex",range:n,reverse:!0},(s,i,o)=>{r=i.batchId,o.done()}).next(()=>r)}getAllMutationBatches(e){const n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Ss(e).K("userMutationsIndex",n).next(r=>r.map(s=>Pi(this.wt,s)))}getAllMutationBatchesAffectingDocumentKey(e,n){const r=Dh(this.userId,n.path),s=IDBKeyRange.lowerBound(r),i=[];return Qo(e).J({range:s},(o,a,c)=>{const[l,u,h]=o,d=Sr(u);if(l===this.userId&&n.path.isEqual(d))return Ss(e).get(h).next(f=>{if(!f)throw G();ie(f.userId===this.userId),i.push(Pi(this.wt,f))});c.done()}).next(()=>i)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new ke(ce);const s=[];return n.forEach(i=>{const o=Dh(this.userId,i.path),a=IDBKeyRange.lowerBound(o),c=Qo(e).J({range:a},(l,u,h)=>{const[d,f,p]=l,_=Sr(f);d===this.userId&&i.path.isEqual(_)?r=r.add(p):h.done()});s.push(c)}),v.waitFor(s).next(()=>this.pn(e,r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,s=r.length+1,i=Dh(this.userId,r),o=IDBKeyRange.lowerBound(i);let a=new ke(ce);return Qo(e).J({range:o},(c,l,u)=>{const[h,d,f]=c,p=Sr(d);h===this.userId&&r.isPrefixOf(p)?p.length===s&&(a=a.add(f)):u.done()}).next(()=>this.pn(e,a))}pn(e,n){const r=[],s=[];return n.forEach(i=>{s.push(Ss(e).get(i).next(o=>{if(o===null)throw G();ie(o.userId===this.userId),r.push(Pi(this.wt,o))}))}),v.waitFor(s).next(()=>r)}removeMutationBatch(e,n){return ZN(e.ee,this.userId,n).next(r=>(e.addOnCommittedListener(()=>{this.In(n.batchId)}),v.forEach(r,s=>this.referenceDelegate.markPotentiallyOrphaned(e,s))))}In(e){delete this.gn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(n=>{if(!n)return v.resolve();const r=IDBKeyRange.lowerBound([this.userId]),s=[];return Qo(e).J({range:r},(i,o,a)=>{if(i[0]===this.userId){const c=Sr(i[1]);s.push(c)}else a.done()}).next(()=>{ie(s.length===0)})})}containsKey(e,n){return eP(e,this.userId,n)}Tn(e){return tP(e).get(this.userId).next(n=>n||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}}function eP(t,e,n){const r=Dh(e,n.path),s=r[1],i=IDBKeyRange.lowerBound(r);let o=!1;return Qo(t).J({range:i,H:!0},(a,c,l)=>{const[u,h,d]=a;u===e&&h===s&&(o=!0),l.done()}).next(()=>o)}function Ss(t){return Lt(t,"mutations")}function Qo(t){return Lt(t,"documentMutations")}function tP(t){return Lt(t,"mutationQueues")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yo{constructor(e){this.En=e}next(){return this.En+=2,this.En}static An(){return new yo(0)}static Rn(){return new yo(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class r6{constructor(e,n){this.referenceDelegate=e,this.wt=n}allocateTargetId(e){return this.bn(e).next(n=>{const r=new yo(n.highestTargetId);return n.highestTargetId=r.next(),this.Pn(e,n).next(()=>n.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.bn(e).next(n=>se.fromTimestamp(new Ye(n.lastRemoteSnapshotVersion.seconds,n.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.bn(e).next(n=>n.highestListenSequenceNumber)}setTargetsMetadata(e,n,r){return this.bn(e).next(s=>(s.highestListenSequenceNumber=n,r&&(s.lastRemoteSnapshotVersion=r.toTimestamp()),n>s.highestListenSequenceNumber&&(s.highestListenSequenceNumber=n),this.Pn(e,s)))}addTargetData(e,n){return this.vn(e,n).next(()=>this.bn(e).next(r=>(r.targetCount+=1,this.Vn(n,r),this.Pn(e,r))))}updateTargetData(e,n){return this.vn(e,n)}removeTargetData(e,n){return this.removeMatchingKeysForTargetId(e,n.targetId).next(()=>jo(e).delete(n.targetId)).next(()=>this.bn(e)).next(r=>(ie(r.targetCount>0),r.targetCount-=1,this.Pn(e,r)))}removeTargets(e,n,r){let s=0;const i=[];return jo(e).J((o,a)=>{const c=Fc(a);c.sequenceNumber<=n&&r.get(c.targetId)===null&&(s++,i.push(this.removeTargetData(e,c)))}).next(()=>v.waitFor(i)).next(()=>s)}forEachTarget(e,n){return jo(e).J((r,s)=>{const i=Fc(s);n(i)})}bn(e){return cT(e).get("targetGlobalKey").next(n=>(ie(n!==null),n))}Pn(e,n){return cT(e).put("targetGlobalKey",n)}vn(e,n){return jo(e).put(XN(this.wt,n))}Vn(e,n){let r=!1;return e.targetId>n.highestTargetId&&(n.highestTargetId=e.targetId,r=!0),e.sequenceNumber>n.highestListenSequenceNumber&&(n.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.bn(e).next(n=>n.targetCount)}getTargetData(e,n){const r=fo(n),s=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let i=null;return jo(e).J({range:s,index:"queryTargetsIndex"},(o,a,c)=>{const l=Fc(a);Fu(n,l.target)&&(i=l,c.done())}).next(()=>i)}addMatchingKeys(e,n,r){const s=[],i=Ds(e);return n.forEach(o=>{const a=dn(o.path);s.push(i.put({targetId:r,path:a})),s.push(this.referenceDelegate.addReference(e,r,o))}),v.waitFor(s)}removeMatchingKeys(e,n,r){const s=Ds(e);return v.forEach(n,i=>{const o=dn(i.path);return v.waitFor([s.delete([r,o]),this.referenceDelegate.removeReference(e,r,i)])})}removeMatchingKeysForTargetId(e,n){const r=Ds(e),s=IDBKeyRange.bound([n],[n+1],!1,!0);return r.delete(s)}getMatchingKeysForTargetId(e,n){const r=IDBKeyRange.bound([n],[n+1],!1,!0),s=Ds(e);let i=ue();return s.J({range:r,H:!0},(o,a,c)=>{const l=Sr(o[1]),u=new U(l);i=i.add(u)}).next(()=>i)}containsKey(e,n){const r=dn(n.path),s=IDBKeyRange.bound([r],[sN(r)],!1,!0);let i=0;return Ds(e).J({index:"documentTargetsIndex",H:!0,range:s},([o,a],c,l)=>{o!==0&&(i++,l.done())}).next(()=>i>0)}te(e,n){return jo(e).get(n).next(r=>r?Fc(r):null)}}function jo(t){return Lt(t,"targets")}function cT(t){return Lt(t,"targetGlobal")}function Ds(t){return Lt(t,"targetDocuments")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lT([t,e],[n,r]){const s=ce(t,n);return s===0?ce(e,r):s}class s6{constructor(e){this.Sn=e,this.buffer=new ke(lT),this.Dn=0}Cn(){return++this.Dn}xn(e){const n=[e,this.Cn()];if(this.buffer.size<this.Sn)this.buffer=this.buffer.add(n);else{const r=this.buffer.last();lT(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}}class i6{constructor(e,n,r){this.garbageCollector=e,this.asyncQueue=n,this.localStore=r,this.Nn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.kn(6e4)}stop(){this.Nn&&(this.Nn.cancel(),this.Nn=null)}get started(){return this.Nn!==null}kn(e){P("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.Nn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Nn=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){fi(n)?P("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",n):await di(n)}await this.kn(3e5)})}}class o6{constructor(e,n){this.On=e,this.params=n}calculateTargetCount(e,n){return this.On.Mn(e).next(r=>Math.floor(n/100*r))}nthSequenceNumber(e,n){if(n===0)return v.resolve(vn.ot);const r=new s6(n);return this.On.forEachTarget(e,s=>r.xn(s.sequenceNumber)).next(()=>this.On.Fn(e,s=>r.xn(s))).next(()=>r.maxValue)}removeTargets(e,n,r){return this.On.removeTargets(e,n,r)}removeOrphanedDocuments(e,n){return this.On.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(P("LruGarbageCollector","Garbage collection skipped; disabled"),v.resolve(aT)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(P("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),aT):this.$n(e,n))}getCacheSize(e){return this.On.getCacheSize(e)}$n(e,n){let r,s,i,o,a,c,l;const u=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(h=>(h>this.params.maximumSequenceNumbersToCollect?(P("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${h}`),s=this.params.maximumSequenceNumbersToCollect):s=h,o=Date.now(),this.nthSequenceNumber(e,s))).next(h=>(r=h,a=Date.now(),this.removeTargets(e,r,n))).next(h=>(i=h,c=Date.now(),this.removeOrphanedDocuments(e,r))).next(h=>(l=Date.now(),jm()<=fe.DEBUG&&P("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-u}ms
	Determined least recently used ${s} in `+(a-o)+`ms
	Removed ${i} targets in `+(c-a)+`ms
	Removed ${h} documents in `+(l-c)+`ms
Total Duration: ${l-u}ms`),v.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:i,documentsRemoved:h})))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class a6{constructor(e,n){this.db=e,this.garbageCollector=function(r,s){return new o6(r,s)}(this,n)}Mn(e){const n=this.Bn(e);return this.db.getTargetCache().getTargetCount(e).next(r=>n.next(s=>r+s))}Bn(e){let n=0;return this.Fn(e,r=>{n++}).next(()=>n)}forEachTarget(e,n){return this.db.getTargetCache().forEachTarget(e,n)}Fn(e,n){return this.Ln(e,(r,s)=>n(s))}addReference(e,n,r){return dh(e,r)}removeReference(e,n,r){return dh(e,r)}removeTargets(e,n,r){return this.db.getTargetCache().removeTargets(e,n,r)}markPotentiallyOrphaned(e,n){return dh(e,n)}Un(e,n){return function(r,s){let i=!1;return tP(r).Y(o=>eP(r,o,s).next(a=>(a&&(i=!0),v.resolve(!a)))).next(()=>i)}(e,n)}removeOrphanedDocuments(e,n){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),s=[];let i=0;return this.Ln(e,(o,a)=>{if(a<=n){const c=this.Un(e,o).next(l=>{if(!l)return i++,r.getEntry(e,o).next(()=>(r.removeEntry(o,se.min()),Ds(e).delete([0,dn(o.path)])))});s.push(c)}}).next(()=>v.waitFor(s)).next(()=>r.apply(e)).next(()=>i)}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,n){return dh(e,n)}Ln(e,n){const r=Ds(e);let s,i=vn.ot;return r.J({index:"documentTargetsIndex"},([o,a],{path:c,sequenceNumber:l})=>{o===0?(i!==vn.ot&&n(new U(Sr(s)),i),i=l,s=c):i=vn.ot}).next(()=>{i!==vn.ot&&n(new U(Sr(s)),i)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function dh(t,e){return Ds(t).put(function(n,r){return{targetId:0,path:dn(n.path),sequenceNumber:r}}(e,t.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nP{constructor(){this.changes=new pi(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,Be.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?v.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c6{constructor(e){this.wt=e}setIndexManager(e){this.indexManager=e}addEntry(e,n,r){return Ii(e).put(r)}removeEntry(e,n,r){return Ii(e).delete(function(s,i){const o=s.path.toArray();return[o.slice(0,o.length-2),o[o.length-2],Rd(i),o[o.length-1]]}(n,r))}updateMetadata(e,n){return this.getMetadata(e).next(r=>(r.byteSize+=n,this.qn(e,r)))}getEntry(e,n){let r=Be.newInvalidDocument(n);return Ii(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(Ac(n))},(s,i)=>{r=this.Kn(n,i)}).next(()=>r)}Gn(e,n){let r={size:0,document:Be.newInvalidDocument(n)};return Ii(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(Ac(n))},(s,i)=>{r={document:this.Kn(n,i),size:Nd(i)}}).next(()=>r)}getEntries(e,n){let r=wn();return this.Qn(e,n,(s,i)=>{const o=this.Kn(s,i);r=r.insert(s,o)}).next(()=>r)}jn(e,n){let r=wn(),s=new it(U.comparator);return this.Qn(e,n,(i,o)=>{const a=this.Kn(i,o);r=r.insert(i,a),s=s.insert(i,Nd(o))}).next(()=>({documents:r,Wn:s}))}Qn(e,n,r){if(n.isEmpty())return v.resolve();let s=new ke(dT);n.forEach(c=>s=s.add(c));const i=IDBKeyRange.bound(Ac(s.first()),Ac(s.last())),o=s.getIterator();let a=o.getNext();return Ii(e).J({index:"documentKeyIndex",range:i},(c,l,u)=>{const h=U.fromSegments([...l.prefixPath,l.collectionGroup,l.documentId]);for(;a&&dT(a,h)<0;)r(a,null),a=o.getNext();a&&a.isEqual(h)&&(r(a,l),a=o.hasNext()?o.getNext():null),a?u.q(Ac(a)):u.done()}).next(()=>{for(;a;)r(a,null),a=o.hasNext()?o.getNext():null})}getAllFromCollection(e,n,r){const s=[n.popLast().toArray(),n.lastSegment(),Rd(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],i=[n.popLast().toArray(),n.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Ii(e).K(IDBKeyRange.bound(s,i,!0)).next(o=>{let a=wn();for(const c of o){const l=this.Kn(U.fromSegments(c.prefixPath.concat(c.collectionGroup,c.documentId)),c);a=a.insert(l.key,l)}return a})}getAllFromCollectionGroup(e,n,r,s){let i=wn();const o=hT(n,r),a=hT(n,Mn.max());return Ii(e).J({index:"collectionGroupIndex",range:IDBKeyRange.bound(o,a,!0)},(c,l,u)=>{const h=this.Kn(U.fromSegments(l.prefixPath.concat(l.collectionGroup,l.documentId)),l);i=i.insert(h.key,h),i.size===s&&u.done()}).next(()=>i)}newChangeBuffer(e){return new l6(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(n=>n.byteSize)}getMetadata(e){return uT(e).get("remoteDocumentGlobalKey").next(n=>(ie(!!n),n))}qn(e,n){return uT(e).put("remoteDocumentGlobalKey",n)}Kn(e,n){if(n){const r=z4(this.wt,n);if(!(r.isNoDocument()&&r.version.isEqual(se.min())))return r}return Be.newInvalidDocument(e)}}function rP(t){return new c6(t)}class l6 extends nP{constructor(e,n){super(),this.zn=e,this.trackRemovals=n,this.Hn=new pi(r=>r.toString(),(r,s)=>r.isEqual(s))}applyChanges(e){const n=[];let r=0,s=new ke((i,o)=>ce(i.canonicalString(),o.canonicalString()));return this.changes.forEach((i,o)=>{const a=this.Hn.get(i);if(n.push(this.zn.removeEntry(e,i,a.readTime)),o.isValidDocument()){const c=XE(this.zn.wt,o);s=s.add(i.path.popLast()),r+=Nd(c)-a.size,n.push(this.zn.addEntry(e,i,c))}else if(r-=a.size,this.trackRemovals){const c=XE(this.zn.wt,o.convertToNoDocument(se.min()));n.push(this.zn.addEntry(e,i,c))}}),s.forEach(i=>{n.push(this.zn.indexManager.addToCollectionParentIndex(e,i))}),n.push(this.zn.updateMetadata(e,r)),v.waitFor(n)}getFromCache(e,n){return this.zn.Gn(e,n).next(r=>(this.Hn.set(n,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,n){return this.zn.jn(e,n).next(({documents:r,Wn:s})=>(s.forEach((i,o)=>{this.Hn.set(i,{size:o,readTime:r.get(i).readTime})}),r))}}function uT(t){return Lt(t,"remoteDocumentGlobal")}function Ii(t){return Lt(t,"remoteDocumentsV14")}function Ac(t){const e=t.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function hT(t,e){const n=e.documentKey.path.toArray();return[t,Rd(e.readTime),n.slice(0,n.length-2),n.length>0?n[n.length-1]:""]}function dT(t,e){const n=t.path.toArray(),r=e.path.toArray();let s=0;for(let i=0;i<n.length-2&&i<r.length-2;++i)if(s=ce(n[i],r[i]),s)return s;return s=ce(n.length,r.length),s||(s=ce(n[n.length-2],r[r.length-2]),s||ce(n[n.length-1],r[r.length-1]))}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u6{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sP{constructor(e,n,r,s){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=s}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(s=>(r=s,this.getBaseDocument(e,n,r))).next(s=>(r!==null&&rl(r.mutation,s,Pn.empty(),Ye.now()),s))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,ue()).next(()=>r))}getLocalViewOfDocuments(e,n,r=ue()){const s=Tr();return this.populateOverlays(e,s,n).next(()=>this.computeViews(e,n,s,r).next(i=>{let o=Lc();return i.forEach((a,c)=>{o=o.insert(a,c.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){const r=Tr();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,ue()))}populateOverlays(e,n,r){const s=[];return r.forEach(i=>{n.has(i)||s.push(i)}),this.documentOverlayCache.getOverlays(e,s).next(i=>{i.forEach((o,a)=>{n.set(o,a)})})}computeViews(e,n,r,s){let i=wn();const o=sl(),a=sl();return n.forEach((c,l)=>{const u=r.get(l.key);s.has(l.key)&&(u===void 0||u.mutation instanceof ms)?i=i.insert(l.key,l):u!==void 0&&(o.set(l.key,u.mutation.getFieldMask()),rl(u.mutation,l,u.mutation.getFieldMask(),Ye.now()))}),this.recalculateAndSaveOverlays(e,i).next(c=>(c.forEach((l,u)=>o.set(l,u)),n.forEach((l,u)=>{var h;return a.set(l,new u6(u,(h=o.get(l))!==null&&h!==void 0?h:null))}),a))}recalculateAndSaveOverlays(e,n){const r=sl();let s=new it((o,a)=>o-a),i=ue();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(const a of o)a.keys().forEach(c=>{const l=n.get(c);if(l===null)return;let u=r.get(c)||Pn.empty();u=a.applyToLocalView(l,u),r.set(c,u);const h=(s.get(a.batchId)||ue()).add(c);s=s.insert(a.batchId,h)})}).next(()=>{const o=[],a=s.getReverseIterator();for(;a.hasNext();){const c=a.getNext(),l=c.key,u=c.value,h=ON();u.forEach(d=>{if(!i.has(d)){const f=kN(n.get(d),r.get(d));f!==null&&h.set(d,f),i=i.add(d)}}),o.push(this.documentOverlayCache.saveOverlays(e,l,h))}return v.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r){return function(s){return U.isDocumentKey(s.path)&&s.collectionGroup===null&&s.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):Pv(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r):this.getDocumentsMatchingCollectionQuery(e,n,r)}getNextDocuments(e,n,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,s).next(i=>{const o=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,s-i.size):v.resolve(Tr());let a=-1,c=i;return o.next(l=>v.forEach(l,(u,h)=>(a<h.largestBatchId&&(a=h.largestBatchId),i.get(u)?v.resolve():this.getBaseDocument(e,u,h).next(d=>{c=c.insert(u,d)}))).next(()=>this.populateOverlays(e,l,i)).next(()=>this.computeViews(e,c,l,ue())).next(u=>({batchId:a,changes:xN(u)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new U(n)).next(r=>{let s=Lc();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s})}getDocumentsMatchingCollectionGroupQuery(e,n,r){const s=n.collectionGroup;let i=Lc();return this.indexManager.getCollectionParents(e,s).next(o=>v.forEach(o,a=>{const c=function(l,u){return new gs(u,null,l.explicitOrderBy.slice(),l.filters.slice(),l.limit,l.limitType,l.startAt,l.endAt)}(n,a.child(s));return this.getDocumentsMatchingCollectionQuery(e,c,r).next(l=>{l.forEach((u,h)=>{i=i.insert(u,h)})})}).next(()=>i))}getDocumentsMatchingCollectionQuery(e,n,r){let s;return this.remoteDocumentCache.getAllFromCollection(e,n.path,r).next(i=>(s=i,this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId))).next(i=>{i.forEach((a,c)=>{const l=c.getKey();s.get(l)===null&&(s=s.insert(l,Be.newInvalidDocument(l)))});let o=Lc();return s.forEach((a,c)=>{const l=i.get(a);l!==void 0&&rl(l.mutation,c,Pn.empty(),Ye.now()),Dv(n,c)&&(o=o.insert(a,c))}),o})}getBaseDocument(e,n,r){return r===null||r.mutation.type===1?this.remoteDocumentCache.getEntry(e,n):v.resolve(Be.newInvalidDocument(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h6{constructor(e){this.wt=e,this.Jn=new Map,this.Yn=new Map}getBundleMetadata(e,n){return v.resolve(this.Jn.get(n))}saveBundleMetadata(e,n){var r;return this.Jn.set(n.id,{id:(r=n).id,version:r.version,createTime:Rt(r.createTime)}),v.resolve()}getNamedQuery(e,n){return v.resolve(this.Yn.get(n))}saveNamedQuery(e,n){return this.Yn.set(n.name,function(r){return{name:r.name,query:Uv(r.bundledQuery),readTime:Rt(r.readTime)}}(n)),v.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d6{constructor(){this.overlays=new it(U.comparator),this.Xn=new Map}getOverlay(e,n){return v.resolve(this.overlays.get(n))}getOverlays(e,n){const r=Tr();return v.forEach(n,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((s,i)=>{this.ie(e,n,i)}),v.resolve()}removeOverlaysForBatchId(e,n,r){const s=this.Xn.get(r);return s!==void 0&&(s.forEach(i=>this.overlays=this.overlays.remove(i)),this.Xn.delete(r)),v.resolve()}getOverlaysForCollection(e,n,r){const s=Tr(),i=n.length+1,o=new U(n.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const c=a.getNext().value,l=c.getKey();if(!n.isPrefixOf(l.path))break;l.path.length===i&&c.largestBatchId>r&&s.set(c.getKey(),c)}return v.resolve(s)}getOverlaysForCollectionGroup(e,n,r,s){let i=new it((l,u)=>l-u);const o=this.overlays.getIterator();for(;o.hasNext();){const l=o.getNext().value;if(l.getKey().getCollectionGroup()===n&&l.largestBatchId>r){let u=i.get(l.largestBatchId);u===null&&(u=Tr(),i=i.insert(l.largestBatchId,u)),u.set(l.getKey(),l)}}const a=Tr(),c=i.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((l,u)=>a.set(l,u)),!(a.size()>=s)););return v.resolve(a)}ie(e,n,r){const s=this.overlays.get(r.key);if(s!==null){const o=this.Xn.get(s.largestBatchId).delete(r.key);this.Xn.set(s.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new Fv(n,r));let i=this.Xn.get(n);i===void 0&&(i=ue(),this.Xn.set(n,i)),this.Xn.set(n,i.add(r.key))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vv{constructor(){this.Zn=new ke(It.ts),this.es=new ke(It.ns)}isEmpty(){return this.Zn.isEmpty()}addReference(e,n){const r=new It(e,n);this.Zn=this.Zn.add(r),this.es=this.es.add(r)}ss(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.rs(new It(e,n))}os(e,n){e.forEach(r=>this.removeReference(r,n))}us(e){const n=new U(new we([])),r=new It(n,e),s=new It(n,e+1),i=[];return this.es.forEachInRange([r,s],o=>{this.rs(o),i.push(o.key)}),i}cs(){this.Zn.forEach(e=>this.rs(e))}rs(e){this.Zn=this.Zn.delete(e),this.es=this.es.delete(e)}hs(e){const n=new U(new we([])),r=new It(n,e),s=new It(n,e+1);let i=ue();return this.es.forEachInRange([r,s],o=>{i=i.add(o.key)}),i}containsKey(e){const n=new It(e,0),r=this.Zn.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class It{constructor(e,n){this.key=e,this.ls=n}static ts(e,n){return U.comparator(e.key,n.key)||ce(e.ls,n.ls)}static ns(e,n){return ce(e.ls,n.ls)||U.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class f6{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.fs=1,this.ds=new ke(It.ts)}checkEmpty(e){return v.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,s){const i=this.fs;this.fs++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new Mv(i,n,r,s);this.mutationQueue.push(o);for(const a of s)this.ds=this.ds.add(new It(a.key,i)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return v.resolve(o)}lookupMutationBatch(e,n){return v.resolve(this._s(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,s=this.ws(r),i=s<0?0:s;return v.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return v.resolve(this.mutationQueue.length===0?-1:this.fs-1)}getAllMutationBatches(e){return v.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new It(n,0),s=new It(n,Number.POSITIVE_INFINITY),i=[];return this.ds.forEachInRange([r,s],o=>{const a=this._s(o.ls);i.push(a)}),v.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new ke(ce);return n.forEach(s=>{const i=new It(s,0),o=new It(s,Number.POSITIVE_INFINITY);this.ds.forEachInRange([i,o],a=>{r=r.add(a.ls)})}),v.resolve(this.gs(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,s=r.length+1;let i=r;U.isDocumentKey(i)||(i=i.child(""));const o=new It(new U(i),0);let a=new ke(ce);return this.ds.forEachWhile(c=>{const l=c.key.path;return!!r.isPrefixOf(l)&&(l.length===s&&(a=a.add(c.ls)),!0)},o),v.resolve(this.gs(a))}gs(e){const n=[];return e.forEach(r=>{const s=this._s(r);s!==null&&n.push(s)}),n}removeMutationBatch(e,n){ie(this.ys(n.batchId,"removed")===0),this.mutationQueue.shift();let r=this.ds;return v.forEach(n.mutations,s=>{const i=new It(s.key,n.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.ds=r})}In(e){}containsKey(e,n){const r=new It(n,0),s=this.ds.firstAfterOrEqual(r);return v.resolve(n.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,v.resolve()}ys(e,n){return this.ws(e)}ws(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}_s(e){const n=this.ws(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p6{constructor(e){this.ps=e,this.docs=new it(U.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,s=this.docs.get(r),i=s?s.size:0,o=this.ps(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return v.resolve(r?r.document.mutableCopy():Be.newInvalidDocument(n))}getEntries(e,n){let r=wn();return n.forEach(s=>{const i=this.docs.get(s);r=r.insert(s,i?i.document.mutableCopy():Be.newInvalidDocument(s))}),v.resolve(r)}getAllFromCollection(e,n,r){let s=wn();const i=new U(n.child("")),o=this.docs.getIteratorFrom(i);for(;o.hasNext();){const{key:a,value:{document:c}}=o.getNext();if(!n.isPrefixOf(a.path))break;a.path.length>n.length+1||Cv(aN(c),r)<=0||(s=s.insert(c.key,c.mutableCopy()))}return v.resolve(s)}getAllFromCollectionGroup(e,n,r,s){G()}Is(e,n){return v.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new g6(this)}getSize(e){return v.resolve(this.size)}}class g6 extends nP{constructor(e){super(),this.zn=e}applyChanges(e){const n=[];return this.changes.forEach((r,s)=>{s.isValidDocument()?n.push(this.zn.addEntry(e,s)):this.zn.removeEntry(r)}),v.waitFor(n)}getFromCache(e,n){return this.zn.getEntry(e,n)}getAllFromCache(e,n){return this.zn.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class m6{constructor(e){this.persistence=e,this.Ts=new pi(n=>fo(n),Fu),this.lastRemoteSnapshotVersion=se.min(),this.highestTargetId=0,this.Es=0,this.As=new Vv,this.targetCount=0,this.Rs=yo.An()}forEachTarget(e,n){return this.Ts.forEach((r,s)=>n(s)),v.resolve()}getLastRemoteSnapshotVersion(e){return v.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return v.resolve(this.Es)}allocateTargetId(e){return this.highestTargetId=this.Rs.next(),v.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.Es&&(this.Es=n),v.resolve()}vn(e){this.Ts.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.Rs=new yo(n),this.highestTargetId=n),e.sequenceNumber>this.Es&&(this.Es=e.sequenceNumber)}addTargetData(e,n){return this.vn(n),this.targetCount+=1,v.resolve()}updateTargetData(e,n){return this.vn(n),v.resolve()}removeTargetData(e,n){return this.Ts.delete(n.target),this.As.us(n.targetId),this.targetCount-=1,v.resolve()}removeTargets(e,n,r){let s=0;const i=[];return this.Ts.forEach((o,a)=>{a.sequenceNumber<=n&&r.get(a.targetId)===null&&(this.Ts.delete(o),i.push(this.removeMatchingKeysForTargetId(e,a.targetId)),s++)}),v.waitFor(i).next(()=>s)}getTargetCount(e){return v.resolve(this.targetCount)}getTargetData(e,n){const r=this.Ts.get(n)||null;return v.resolve(r)}addMatchingKeys(e,n,r){return this.As.ss(n,r),v.resolve()}removeMatchingKeys(e,n,r){this.As.os(n,r);const s=this.persistence.referenceDelegate,i=[];return s&&n.forEach(o=>{i.push(s.markPotentiallyOrphaned(e,o))}),v.waitFor(i)}removeMatchingKeysForTargetId(e,n){return this.As.us(n),v.resolve()}getMatchingKeysForTargetId(e,n){const r=this.As.hs(n);return v.resolve(r)}containsKey(e,n){return v.resolve(this.As.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iP{constructor(e,n){this.bs={},this.overlays={},this.Ps=new vn(0),this.vs=!1,this.vs=!0,this.referenceDelegate=e(this),this.Vs=new m6(this),this.indexManager=new t6,this.remoteDocumentCache=function(r){return new p6(r)}(r=>this.referenceDelegate.Ss(r)),this.wt=new JN(n),this.Ds=new h6(this.wt)}start(){return Promise.resolve()}shutdown(){return this.vs=!1,Promise.resolve()}get started(){return this.vs}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new d6,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.bs[e.toKey()];return r||(r=new f6(n,this.referenceDelegate),this.bs[e.toKey()]=r),r}getTargetCache(){return this.Vs}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ds}runTransaction(e,n,r){P("MemoryPersistence","Starting transaction:",e);const s=new _6(this.Ps.next());return this.referenceDelegate.Cs(),r(s).next(i=>this.referenceDelegate.xs(s).next(()=>i)).toPromise().then(i=>(s.raiseOnCommittedEvent(),i))}Ns(e,n){return v.or(Object.values(this.bs).map(r=>()=>r.containsKey(e,n)))}}class _6 extends lN{constructor(e){super(),this.currentSequenceNumber=e}}class lp{constructor(e){this.persistence=e,this.ks=new Vv,this.Os=null}static Ms(e){return new lp(e)}get Fs(){if(this.Os)return this.Os;throw G()}addReference(e,n,r){return this.ks.addReference(r,n),this.Fs.delete(r.toString()),v.resolve()}removeReference(e,n,r){return this.ks.removeReference(r,n),this.Fs.add(r.toString()),v.resolve()}markPotentiallyOrphaned(e,n){return this.Fs.add(n.toString()),v.resolve()}removeTarget(e,n){this.ks.us(n.targetId).forEach(s=>this.Fs.add(s.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(s=>{s.forEach(i=>this.Fs.add(i.toString()))}).next(()=>r.removeTargetData(e,n))}Cs(){this.Os=new Set}xs(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return v.forEach(this.Fs,r=>{const s=U.fromPath(r);return this.$s(e,s).next(i=>{i||n.removeEntry(s,se.min())})}).next(()=>(this.Os=null,n.apply(e)))}updateLimboDocument(e,n){return this.$s(e,n).next(r=>{r?this.Fs.delete(n.toString()):this.Fs.add(n.toString())})}Ss(e){return 0}$s(e,n){return v.or([()=>v.resolve(this.ks.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Ns(e,n)])}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y6{constructor(e){this.wt=e}O(e,n,r,s){const i=new rp("createOrUpgrade",n);r<1&&s>=1&&(function(a){a.createObjectStore("owner")}(e),function(a){a.createObjectStore("mutationQueues",{keyPath:"userId"}),a.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",JE,{unique:!0}),a.createObjectStore("documentMutations")}(e),fT(e),function(a){a.createObjectStore("remoteDocuments")}(e));let o=v.resolve();return r<3&&s>=3&&(r!==0&&(function(a){a.deleteObjectStore("targetDocuments"),a.deleteObjectStore("targets"),a.deleteObjectStore("targetGlobal")}(e),fT(e)),o=o.next(()=>function(a){const c=a.store("targetGlobal"),l={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:se.min().toTimestamp(),targetCount:0};return c.put("targetGlobalKey",l)}(i))),r<4&&s>=4&&(r!==0&&(o=o.next(()=>function(a,c){return c.store("mutations").K().next(l=>{a.deleteObjectStore("mutations"),a.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",JE,{unique:!0});const u=c.store("mutations"),h=l.map(d=>u.put(d));return v.waitFor(h)})}(e,i))),o=o.next(()=>{(function(a){a.createObjectStore("clientMetadata",{keyPath:"clientId"})})(e)})),r<5&&s>=5&&(o=o.next(()=>this.Bs(i))),r<6&&s>=6&&(o=o.next(()=>(function(a){a.createObjectStore("remoteDocumentGlobal")}(e),this.Ls(i)))),r<7&&s>=7&&(o=o.next(()=>this.Us(i))),r<8&&s>=8&&(o=o.next(()=>this.qs(e,i))),r<9&&s>=9&&(o=o.next(()=>{(function(a){a.objectStoreNames.contains("remoteDocumentChanges")&&a.deleteObjectStore("remoteDocumentChanges")})(e)})),r<10&&s>=10&&(o=o.next(()=>this.Ks(i))),r<11&&s>=11&&(o=o.next(()=>{(function(a){a.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(a){a.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),r<12&&s>=12&&(o=o.next(()=>{(function(a){const c=a.createObjectStore("documentOverlays",{keyPath:j4});c.createIndex("collectionPathOverlayIndex",K4,{unique:!1}),c.createIndex("collectionGroupOverlayIndex",H4,{unique:!1})})(e)})),r<13&&s>=13&&(o=o.next(()=>function(a){const c=a.createObjectStore("remoteDocumentsV14",{keyPath:D4});c.createIndex("documentKeyIndex",x4),c.createIndex("collectionGroupIndex",O4)}(e)).next(()=>this.Gs(e,i)).next(()=>e.deleteObjectStore("remoteDocuments"))),r<14&&s>=14&&(o=o.next(()=>this.Qs(e,i))),r<15&&s>=15&&(o=o.next(()=>function(a){a.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),a.createObjectStore("indexState",{keyPath:$4}).createIndex("sequenceNumberIndex",V4,{unique:!1}),a.createObjectStore("indexEntries",{keyPath:B4}).createIndex("documentKeyIndex",q4,{unique:!1})}(e))),o}Ls(e){let n=0;return e.store("remoteDocuments").J((r,s)=>{n+=Nd(s)}).next(()=>{const r={byteSize:n};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",r)})}Bs(e){const n=e.store("mutationQueues"),r=e.store("mutations");return n.K().next(s=>v.forEach(s,i=>{const o=IDBKeyRange.bound([i.userId,-1],[i.userId,i.lastAcknowledgedBatchId]);return r.K("userMutationsIndex",o).next(a=>v.forEach(a,c=>{ie(c.userId===i.userId);const l=Pi(this.wt,c);return ZN(e,i.userId,l).next(()=>{})}))}))}Us(e){const n=e.store("targetDocuments"),r=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(s=>{const i=[];return r.J((o,a)=>{const c=new we(o),l=function(u){return[0,dn(u)]}(c);i.push(n.get(l).next(u=>u?v.resolve():(h=>n.put({targetId:0,path:dn(h),sequenceNumber:s.highestListenSequenceNumber}))(c)))}).next(()=>v.waitFor(i))})}qs(e,n){e.createObjectStore("collectionParents",{keyPath:U4});const r=n.store("collectionParents"),s=new $v,i=o=>{if(s.add(o)){const a=o.lastSegment(),c=o.popLast();return r.put({collectionId:a,parent:dn(c)})}};return n.store("remoteDocuments").J({H:!0},(o,a)=>{const c=new we(o);return i(c.popLast())}).next(()=>n.store("documentMutations").J({H:!0},([o,a,c],l)=>{const u=Sr(a);return i(u.popLast())}))}Ks(e){const n=e.store("targets");return n.J((r,s)=>{const i=Fc(s),o=XN(this.wt,i);return n.put(o)})}Gs(e,n){const r=n.store("remoteDocuments"),s=[];return r.J((i,o)=>{const a=n.store("remoteDocumentsV14"),c=(l=o,l.document?new U(we.fromString(l.document.name).popFirst(5)):l.noDocument?U.fromSegments(l.noDocument.path):l.unknownDocument?U.fromSegments(l.unknownDocument.path):G()).path.toArray();var l;/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const u={prefixPath:c.slice(0,c.length-2),collectionGroup:c[c.length-2],documentId:c[c.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};s.push(a.put(u))}).next(()=>v.waitFor(s))}Qs(e,n){const r=n.store("mutations"),s=rP(this.wt),i=new iP(lp.Ms,this.wt.ne);return r.K().next(o=>{const a=new Map;return o.forEach(c=>{var l;let u=(l=a.get(c.userId))!==null&&l!==void 0?l:ue();Pi(this.wt,c).keys().forEach(h=>u=u.add(h)),a.set(c.userId,u)}),v.forEach(a,(c,l)=>{const u=new St(l),h=ap.se(this.wt,u),d=i.getIndexManager(u),f=cp.se(u,this.wt,d,i.referenceDelegate);return new sP(s,f,h,d).recalculateAndSaveOverlaysForDocumentKeys(new Ym(n,vn.ot),c).next()})})}}function fT(t){t.createObjectStore("targetDocuments",{keyPath:L4}).createIndex("documentTargetsIndex",F4,{unique:!0}),t.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",M4,{unique:!0}),t.createObjectStore("targetGlobal")}const fg="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class Bv{constructor(e,n,r,s,i,o,a,c,l,u,h=14){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.js=i,this.window=o,this.document=a,this.Ws=l,this.zs=u,this.Hs=h,this.Ps=null,this.vs=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Js=null,this.inForeground=!1,this.Ys=null,this.Xs=null,this.Zs=Number.NEGATIVE_INFINITY,this.ti=d=>Promise.resolve(),!Bv.V())throw new k(w.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new a6(this,s),this.ei=n+"main",this.wt=new JN(c),this.ni=new ir(this.ei,this.Hs,new y6(this.wt)),this.Vs=new r6(this.referenceDelegate,this.wt),this.remoteDocumentCache=rP(this.wt),this.Ds=new Q4,this.window&&this.window.localStorage?this.si=this.window.localStorage:(this.si=null,u===!1&&ft("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.ii().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new k(w.FAILED_PRECONDITION,fg);return this.ri(),this.oi(),this.ui(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Vs.getHighestSequenceNumber(e))}).then(e=>{this.Ps=new vn(e,this.Ws)}).then(()=>{this.vs=!0}).catch(e=>(this.ni&&this.ni.close(),Promise.reject(e)))}ci(e){return this.ti=async n=>{if(this.started)return e(n)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.ni.F(async n=>{n.newVersion===null&&await e()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.js.enqueueAndForget(async()=>{this.started&&await this.ii()}))}ii(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>fh(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.ai(e).next(n=>{n||(this.isPrimary=!1,this.js.enqueueRetryable(()=>this.ti(!1)))})}).next(()=>this.hi(e)).next(n=>this.isPrimary&&!n?this.li(e).next(()=>!1):!!n&&this.fi(e).next(()=>!0))).catch(e=>{if(fi(e))return P("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return P("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.js.enqueueRetryable(()=>this.ti(e)),this.isPrimary=e})}ai(e){return kc(e).get("owner").next(n=>v.resolve(this.di(n)))}_i(e){return fh(e).delete(this.clientId)}async wi(){if(this.isPrimary&&!this.mi(this.Zs,18e5)){this.Zs=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",n=>{const r=Lt(n,"clientMetadata");return r.K().next(s=>{const i=this.gi(s,18e5),o=s.filter(a=>i.indexOf(a)===-1);return v.forEach(o,a=>r.delete(a.clientId)).next(()=>o)})}).catch(()=>[]);if(this.si)for(const n of e)this.si.removeItem(this.yi(n.clientId))}}ui(){this.Xs=this.js.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.ii().then(()=>this.wi()).then(()=>this.ui()))}di(e){return!!e&&e.ownerId===this.clientId}hi(e){return this.zs?v.resolve(!0):kc(e).get("owner").next(n=>{if(n!==null&&this.mi(n.leaseTimestampMs,5e3)&&!this.pi(n.ownerId)){if(this.di(n)&&this.networkEnabled)return!0;if(!this.di(n)){if(!n.allowTabSynchronization)throw new k(w.FAILED_PRECONDITION,fg);return!1}}return!(!this.networkEnabled||!this.inForeground)||fh(e).K().next(r=>this.gi(r,5e3).find(s=>{if(this.clientId!==s.clientId){const i=!this.networkEnabled&&s.networkEnabled,o=!this.inForeground&&s.inForeground,a=this.networkEnabled===s.networkEnabled;if(i||o&&a)return!0}return!1})===void 0)}).next(n=>(this.isPrimary!==n&&P("IndexedDbPersistence",`Client ${n?"is":"is not"} eligible for a primary lease.`),n))}async shutdown(){this.vs=!1,this.Ii(),this.Xs&&(this.Xs.cancel(),this.Xs=null),this.Ti(),this.Ei(),await this.ni.runTransaction("shutdown","readwrite",["owner","clientMetadata"],e=>{const n=new Ym(e,vn.ot);return this.li(n).next(()=>this._i(n))}),this.ni.close(),this.Ai()}gi(e,n){return e.filter(r=>this.mi(r.updateTimeMs,n)&&!this.pi(r.clientId))}Ri(){return this.runTransaction("getActiveClients","readonly",e=>fh(e).K().next(n=>this.gi(n,18e5).map(r=>r.clientId)))}get started(){return this.vs}getMutationQueue(e,n){return cp.se(e,this.wt,n,this.referenceDelegate)}getTargetCache(){return this.Vs}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new n6(e,this.wt.ne.databaseId)}getDocumentOverlayCache(e){return ap.se(this.wt,e)}getBundleCache(){return this.Ds}runTransaction(e,n,r){P("IndexedDbPersistence","Starting transaction:",e);const s=n==="readonly"?"readonly":"readwrite",i=(o=this.Hs)===15?G4:o===14?YN:o===13?QN:o===12?W4:o===11?zN:void G();var o;let a;return this.ni.runTransaction(e,s,i,c=>(a=new Ym(c,this.Ps?this.Ps.next():vn.ot),n==="readwrite-primary"?this.ai(a).next(l=>!!l||this.hi(a)).next(l=>{if(!l)throw ft(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.js.enqueueRetryable(()=>this.ti(!1)),new k(w.FAILED_PRECONDITION,cN);return r(a)}).next(l=>this.fi(a).next(()=>l)):this.bi(a).next(()=>r(a)))).then(c=>(a.raiseOnCommittedEvent(),c))}bi(e){return kc(e).get("owner").next(n=>{if(n!==null&&this.mi(n.leaseTimestampMs,5e3)&&!this.pi(n.ownerId)&&!this.di(n)&&!(this.zs||this.allowTabSynchronization&&n.allowTabSynchronization))throw new k(w.FAILED_PRECONDITION,fg)})}fi(e){const n={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return kc(e).put("owner",n)}static V(){return ir.V()}li(e){const n=kc(e);return n.get("owner").next(r=>this.di(r)?(P("IndexedDbPersistence","Releasing primary lease."),n.delete("owner")):v.resolve())}mi(e,n){const r=Date.now();return!(e<r-n)&&(!(e>r)||(ft(`Detected an update time that is in the future: ${e} > ${r}`),!1))}ri(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Ys=()=>{this.js.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.ii()))},this.document.addEventListener("visibilitychange",this.Ys),this.inForeground=this.document.visibilityState==="visible")}Ti(){this.Ys&&(this.document.removeEventListener("visibilitychange",this.Ys),this.Ys=null)}oi(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.Js=()=>{this.Ii(),ML()&&navigator.appVersion.match(/Version\/1[45]/)&&this.js.enterRestrictedMode(!0),this.js.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Js))}Ei(){this.Js&&(this.window.removeEventListener("pagehide",this.Js),this.Js=null)}pi(e){var n;try{const r=((n=this.si)===null||n===void 0?void 0:n.getItem(this.yi(e)))!==null;return P("IndexedDbPersistence",`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return ft("IndexedDbPersistence","Failed to get zombied client id.",r),!1}}Ii(){if(this.si)try{this.si.setItem(this.yi(this.clientId),String(Date.now()))}catch(e){ft("Failed to set zombie client id.",e)}}Ai(){if(this.si)try{this.si.removeItem(this.yi(this.clientId))}catch{}}yi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function kc(t){return Lt(t,"owner")}function fh(t){return Lt(t,"clientMetadata")}function qv(t,e){let n=t.projectId;return t.isDefaultDatabase||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jv{constructor(e,n,r,s){this.targetId=e,this.fromCache=n,this.Pi=r,this.vi=s}static Vi(e,n){let r=ue(),s=ue();for(const i of n.docChanges)switch(i.type){case 0:r=r.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new jv(e,n.fromCache,r,s)}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oP{constructor(){this.Si=!1}initialize(e,n){this.Di=e,this.indexManager=n,this.Si=!0}getDocumentsMatchingQuery(e,n,r,s){return this.Ci(e,n).next(i=>i||this.xi(e,n,s,r)).next(i=>i||this.Ni(e,n))}Ci(e,n){return v.resolve(null)}xi(e,n,r,s){return r4(n)||s.isEqual(se.min())?this.Ni(e,n):this.Di.getDocuments(e,r).next(i=>{const o=this.ki(n,i);return this.Oi(n,o,r,s)?this.Ni(e,n):(jm()<=fe.DEBUG&&P("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),Gm(n)),this.Mi(e,o,n,oN(s,-1)))})}ki(e,n){let r=new ke(wN(e));return n.forEach((s,i)=>{Dv(e,i)&&(r=r.add(i))}),r}Oi(e,n,r,s){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const i=e.limitType==="F"?n.last():n.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}Ni(e,n){return jm()<=fe.DEBUG&&P("QueryEngine","Using full collection scan to execute query:",Gm(n)),this.Di.getDocumentsMatchingQuery(e,n,Mn.min())}Mi(e,n,r,s){return this.Di.getDocumentsMatchingQuery(e,r,s).next(i=>(n.forEach(o=>{i=i.insert(o.key,o)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class v6{constructor(e,n,r,s){this.persistence=e,this.Fi=n,this.wt=s,this.$i=new it(ce),this.Bi=new pi(i=>fo(i),Fu),this.Li=new Map,this.Ui=e.getRemoteDocumentCache(),this.Vs=e.getTargetCache(),this.Ds=e.getBundleCache(),this.qi(r)}qi(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new sP(this.Ui,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ui.setIndexManager(this.indexManager),this.Fi.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.$i))}}function aP(t,e,n,r){return new v6(t,e,n,r)}async function cP(t,e){const n=q(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let s;return n.mutationQueue.getAllMutationBatches(r).next(i=>(s=i,n.qi(e),n.mutationQueue.getAllMutationBatches(r))).next(i=>{const o=[],a=[];let c=ue();for(const l of s){o.push(l.batchId);for(const u of l.mutations)c=c.add(u.key)}for(const l of i){a.push(l.batchId);for(const u of l.mutations)c=c.add(u.key)}return n.localDocuments.getDocuments(r,c).next(l=>({Ki:l,removedBatchIds:o,addedBatchIds:a}))})})}function w6(t,e){const n=q(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const s=e.batch.keys(),i=n.Ui.newChangeBuffer({trackRemovals:!0});return function(o,a,c,l){const u=c.batch,h=u.keys();let d=v.resolve();return h.forEach(f=>{d=d.next(()=>l.getEntry(a,f)).next(p=>{const _=c.docVersions.get(f);ie(_!==null),p.version.compareTo(_)<0&&(u.applyToRemoteDocument(p,c),p.isValidDocument()&&(p.setReadTime(c.commitVersion),l.addEntry(p)))})}),d.next(()=>o.mutationQueue.removeMutationBatch(a,u))}(n,r,e,i).next(()=>i.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,s,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(o){let a=ue();for(let c=0;c<o.mutationResults.length;++c)o.mutationResults[c].transformResults.length>0&&(a=a.add(o.batch.mutations[c].key));return a}(e))).next(()=>n.localDocuments.getDocuments(r,s))})}function lP(t){const e=q(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Vs.getLastRemoteSnapshotVersion(n))}function b6(t,e){const n=q(t),r=e.snapshotVersion;let s=n.$i;return n.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const o=n.Ui.newChangeBuffer({trackRemovals:!0});s=n.$i;const a=[];e.targetChanges.forEach((u,h)=>{const d=s.get(h);if(!d)return;a.push(n.Vs.removeMatchingKeys(i,u.removedDocuments,h).next(()=>n.Vs.addMatchingKeys(i,u.addedDocuments,h)));let f=d.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.has(h)?f=f.withResumeToken(vt.EMPTY_BYTE_STRING,se.min()).withLastLimboFreeSnapshotVersion(se.min()):u.resumeToken.approximateByteSize()>0&&(f=f.withResumeToken(u.resumeToken,r)),s=s.insert(h,f),function(p,_,y){return p.resumeToken.approximateByteSize()===0||_.snapshotVersion.toMicroseconds()-p.snapshotVersion.toMicroseconds()>=3e8?!0:y.addedDocuments.size+y.modifiedDocuments.size+y.removedDocuments.size>0}(d,f,u)&&a.push(n.Vs.updateTargetData(i,f))});let c=wn(),l=ue();if(e.documentUpdates.forEach(u=>{e.resolvedLimboDocuments.has(u)&&a.push(n.persistence.referenceDelegate.updateLimboDocument(i,u))}),a.push(uP(i,o,e.documentUpdates).next(u=>{c=u.Gi,l=u.Qi})),!r.isEqual(se.min())){const u=n.Vs.getLastRemoteSnapshotVersion(i).next(h=>n.Vs.setTargetsMetadata(i,i.currentSequenceNumber,r));a.push(u)}return v.waitFor(a).next(()=>o.apply(i)).next(()=>n.localDocuments.getLocalViewOfDocuments(i,c,l)).next(()=>c)}).then(i=>(n.$i=s,i))}function uP(t,e,n){let r=ue(),s=ue();return n.forEach(i=>r=r.add(i)),e.getEntries(t,r).next(i=>{let o=wn();return n.forEach((a,c)=>{const l=i.get(a);c.isFoundDocument()!==l.isFoundDocument()&&(s=s.add(a)),c.isNoDocument()&&c.version.isEqual(se.min())?(e.removeEntry(a,c.readTime),o=o.insert(a,c)):!l.isValidDocument()||c.version.compareTo(l.version)>0||c.version.compareTo(l.version)===0&&l.hasPendingWrites?(e.addEntry(c),o=o.insert(a,c)):P("LocalStore","Ignoring outdated watch update for ",a,". Current version:",l.version," Watch version:",c.version)}),{Gi:o,Qi:s}})}function I6(t,e){const n=q(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function Ma(t,e){const n=q(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let s;return n.Vs.getTargetData(r,e).next(i=>i?(s=i,v.resolve(s)):n.Vs.allocateTargetId(r).next(o=>(s=new Ks(e,o,0,r.currentSequenceNumber),n.Vs.addTargetData(r,s).next(()=>s))))}).then(r=>{const s=n.$i.get(r.targetId);return(s===null||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(n.$i=n.$i.insert(r.targetId,r),n.Bi.set(e,r.targetId)),r})}async function La(t,e,n){const r=q(t),s=r.$i.get(e),i=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",i,o=>r.persistence.referenceDelegate.removeTarget(o,s))}catch(o){if(!fi(o))throw o;P("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}r.$i=r.$i.remove(e),r.Bi.delete(s.target)}function Pd(t,e,n){const r=q(t);let s=se.min(),i=ue();return r.persistence.runTransaction("Execute query","readonly",o=>function(a,c,l){const u=q(a),h=u.Bi.get(l);return h!==void 0?v.resolve(u.$i.get(h)):u.Vs.getTargetData(c,l)}(r,o,Qn(e)).next(a=>{if(a)return s=a.lastLimboFreeSnapshotVersion,r.Vs.getMatchingKeysForTargetId(o,a.targetId).next(c=>{i=c})}).next(()=>r.Fi.getDocumentsMatchingQuery(o,e,n?s:se.min(),n?i:ue())).next(a=>(fP(r,vN(e),a),{documents:a,ji:i})))}function hP(t,e){const n=q(t),r=q(n.Vs),s=n.$i.get(e);return s?Promise.resolve(s.target):n.persistence.runTransaction("Get target data","readonly",i=>r.te(i,e).next(o=>o?o.target:null))}function dP(t,e){const n=q(t),r=n.Li.get(e)||se.min();return n.persistence.runTransaction("Get new document changes","readonly",s=>n.Ui.getAllFromCollectionGroup(s,e,oN(r,-1),Number.MAX_SAFE_INTEGER)).then(s=>(fP(n,e,s),s))}function fP(t,e,n){let r=se.min();n.forEach((s,i)=>{i.readTime.compareTo(r)>0&&(r=i.readTime)}),t.Li.set(e,r)}async function E6(t,e,n,r){const s=q(t);let i=ue(),o=wn();for(const l of n){const u=e.Wi(l.metadata.name);l.document&&(i=i.add(u));const h=e.zi(l);h.setReadTime(e.Hi(l.metadata.readTime)),o=o.insert(u,h)}const a=s.Ui.newChangeBuffer({trackRemovals:!0}),c=await Ma(s,function(l){return Qn(sc(we.fromString(`__bundle__/docs/${l}`)))}(r));return s.persistence.runTransaction("Apply bundle documents","readwrite",l=>uP(l,a,o).next(u=>(a.apply(l),u)).next(u=>s.Vs.removeMatchingKeysForTargetId(l,c.targetId).next(()=>s.Vs.addMatchingKeys(l,i,c.targetId)).next(()=>s.localDocuments.getLocalViewOfDocuments(l,u.Gi,u.Qi)).next(()=>u.Gi)))}async function T6(t,e,n=ue()){const r=await Ma(t,Qn(Uv(e.bundledQuery))),s=q(t);return s.persistence.runTransaction("Save named query","readwrite",i=>{const o=Rt(e.readTime);if(r.snapshotVersion.compareTo(o)>=0)return s.Ds.saveNamedQuery(i,e);const a=r.withResumeToken(vt.EMPTY_BYTE_STRING,o);return s.$i=s.$i.insert(a.targetId,a),s.Vs.updateTargetData(i,a).next(()=>s.Vs.removeMatchingKeysForTargetId(i,r.targetId)).next(()=>s.Vs.addMatchingKeys(i,n,r.targetId)).next(()=>s.Ds.saveNamedQuery(i,e))})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pT(t,e){return`firestore_clients_${t}_${e}`}function gT(t,e,n){let r=`firestore_mutations_${t}_${n}`;return e.isAuthenticated()&&(r+=`_${e.uid}`),r}function pg(t,e){return`firestore_targets_${t}_${e}`}class Dd{constructor(e,n,r,s){this.user=e,this.batchId=n,this.state=r,this.error=s}static Ji(e,n,r){const s=JSON.parse(r);let i,o=typeof s=="object"&&["pending","acknowledged","rejected"].indexOf(s.state)!==-1&&(s.error===void 0||typeof s.error=="object");return o&&s.error&&(o=typeof s.error.message=="string"&&typeof s.error.code=="string",o&&(i=new k(s.error.code,s.error.message))),o?new Dd(e,n,s.state,i):(ft("SharedClientState",`Failed to parse mutation state for ID '${n}': ${r}`),null)}Yi(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class il{constructor(e,n,r){this.targetId=e,this.state=n,this.error=r}static Ji(e,n){const r=JSON.parse(n);let s,i=typeof r=="object"&&["not-current","current","rejected"].indexOf(r.state)!==-1&&(r.error===void 0||typeof r.error=="object");return i&&r.error&&(i=typeof r.error.message=="string"&&typeof r.error.code=="string",i&&(s=new k(r.error.code,r.error.message))),i?new il(e,r.state,s):(ft("SharedClientState",`Failed to parse target state for ID '${e}': ${n}`),null)}Yi(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class xd{constructor(e,n){this.clientId=e,this.activeTargetIds=n}static Ji(e,n){const r=JSON.parse(n);let s=typeof r=="object"&&r.activeTargetIds instanceof Array,i=op();for(let o=0;s&&o<r.activeTargetIds.length;++o)s=dN(r.activeTargetIds[o]),i=i.add(r.activeTargetIds[o]);return s?new xd(e,i):(ft("SharedClientState",`Failed to parse client data for instance '${e}': ${n}`),null)}}class Kv{constructor(e,n){this.clientId=e,this.onlineState=n}static Ji(e){const n=JSON.parse(e);return typeof n=="object"&&["Unknown","Online","Offline"].indexOf(n.onlineState)!==-1&&typeof n.clientId=="string"?new Kv(n.clientId,n.onlineState):(ft("SharedClientState",`Failed to parse online state: ${e}`),null)}}class Jm{constructor(){this.activeTargetIds=op()}Xi(e){this.activeTargetIds=this.activeTargetIds.add(e)}Zi(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Yi(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class gg{constructor(e,n,r,s,i){this.window=e,this.js=n,this.persistenceKey=r,this.tr=s,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.er=this.nr.bind(this),this.sr=new it(ce),this.started=!1,this.ir=[];const o=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.rr=pT(this.persistenceKey,this.tr),this.ur=function(a){return`firestore_sequence_number_${a}`}(this.persistenceKey),this.sr=this.sr.insert(this.tr,new Jm),this.cr=new RegExp(`^firestore_clients_${o}_([^_]*)$`),this.ar=new RegExp(`^firestore_mutations_${o}_(\\d+)(?:_(.*))?$`),this.hr=new RegExp(`^firestore_targets_${o}_(\\d+)$`),this.lr=function(a){return`firestore_online_state_${a}`}(this.persistenceKey),this.dr=function(a){return`firestore_bundle_loaded_v2_${a}`}(this.persistenceKey),this.window.addEventListener("storage",this.er)}static V(e){return!(!e||!e.localStorage)}async start(){const e=await this.syncEngine.Ri();for(const r of e){if(r===this.tr)continue;const s=this.getItem(pT(this.persistenceKey,r));if(s){const i=xd.Ji(r,s);i&&(this.sr=this.sr.insert(i.clientId,i))}}this._r();const n=this.storage.getItem(this.lr);if(n){const r=this.wr(n);r&&this.mr(r)}for(const r of this.ir)this.nr(r);this.ir=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0}writeSequenceNumber(e){this.setItem(this.ur,JSON.stringify(e))}getAllActiveQueryTargets(){return this.gr(this.sr)}isActiveQueryTarget(e){let n=!1;return this.sr.forEach((r,s)=>{s.activeTargetIds.has(e)&&(n=!0)}),n}addPendingMutation(e){this.yr(e,"pending")}updateMutationState(e,n,r){this.yr(e,n,r),this.pr(e)}addLocalQueryTarget(e){let n="not-current";if(this.isActiveQueryTarget(e)){const r=this.storage.getItem(pg(this.persistenceKey,e));if(r){const s=il.Ji(e,r);s&&(n=s.state)}}return this.Ir.Xi(e),this._r(),n}removeLocalQueryTarget(e){this.Ir.Zi(e),this._r()}isLocalQueryTarget(e){return this.Ir.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(pg(this.persistenceKey,e))}updateQueryState(e,n,r){this.Tr(e,n,r)}handleUserChange(e,n,r){n.forEach(s=>{this.pr(s)}),this.currentUser=e,r.forEach(s=>{this.addPendingMutation(s)})}setOnlineState(e){this.Er(e)}notifyBundleLoaded(e){this.Ar(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.er),this.removeItem(this.rr),this.started=!1)}getItem(e){const n=this.storage.getItem(e);return P("SharedClientState","READ",e,n),n}setItem(e,n){P("SharedClientState","SET",e,n),this.storage.setItem(e,n)}removeItem(e){P("SharedClientState","REMOVE",e),this.storage.removeItem(e)}nr(e){const n=e;if(n.storageArea===this.storage){if(P("SharedClientState","EVENT",n.key,n.newValue),n.key===this.rr)return void ft("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.js.enqueueRetryable(async()=>{if(this.started){if(n.key!==null){if(this.cr.test(n.key)){if(n.newValue==null){const r=this.Rr(n.key);return this.br(r,null)}{const r=this.Pr(n.key,n.newValue);if(r)return this.br(r.clientId,r)}}else if(this.ar.test(n.key)){if(n.newValue!==null){const r=this.vr(n.key,n.newValue);if(r)return this.Vr(r)}}else if(this.hr.test(n.key)){if(n.newValue!==null){const r=this.Sr(n.key,n.newValue);if(r)return this.Dr(r)}}else if(n.key===this.lr){if(n.newValue!==null){const r=this.wr(n.newValue);if(r)return this.mr(r)}}else if(n.key===this.ur){const r=function(s){let i=vn.ot;if(s!=null)try{const o=JSON.parse(s);ie(typeof o=="number"),i=o}catch(o){ft("SharedClientState","Failed to read sequence number from WebStorage",o)}return i}(n.newValue);r!==vn.ot&&this.sequenceNumberHandler(r)}else if(n.key===this.dr){const r=this.Cr(n.newValue);await Promise.all(r.map(s=>this.syncEngine.Nr(s)))}}}else this.ir.push(n)})}}get Ir(){return this.sr.get(this.tr)}_r(){this.setItem(this.rr,this.Ir.Yi())}yr(e,n,r){const s=new Dd(this.currentUser,e,n,r),i=gT(this.persistenceKey,this.currentUser,e);this.setItem(i,s.Yi())}pr(e){const n=gT(this.persistenceKey,this.currentUser,e);this.removeItem(n)}Er(e){const n={clientId:this.tr,onlineState:e};this.storage.setItem(this.lr,JSON.stringify(n))}Tr(e,n,r){const s=pg(this.persistenceKey,e),i=new il(e,n,r);this.setItem(s,i.Yi())}Ar(e){const n=JSON.stringify(Array.from(e));this.setItem(this.dr,n)}Rr(e){const n=this.cr.exec(e);return n?n[1]:null}Pr(e,n){const r=this.Rr(e);return xd.Ji(r,n)}vr(e,n){const r=this.ar.exec(e),s=Number(r[1]),i=r[2]!==void 0?r[2]:null;return Dd.Ji(new St(i),s,n)}Sr(e,n){const r=this.hr.exec(e),s=Number(r[1]);return il.Ji(s,n)}wr(e){return Kv.Ji(e)}Cr(e){return JSON.parse(e)}async Vr(e){if(e.user.uid===this.currentUser.uid)return this.syncEngine.kr(e.batchId,e.state,e.error);P("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)}Dr(e){return this.syncEngine.Or(e.targetId,e.state,e.error)}br(e,n){const r=n?this.sr.insert(e,n):this.sr.remove(e),s=this.gr(this.sr),i=this.gr(r),o=[],a=[];return i.forEach(c=>{s.has(c)||o.push(c)}),s.forEach(c=>{i.has(c)||a.push(c)}),this.syncEngine.Mr(o,a).then(()=>{this.sr=r})}mr(e){this.sr.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}gr(e){let n=op();return e.forEach((r,s)=>{n=n.unionWith(s.activeTargetIds)}),n}}class pP{constructor(){this.Fr=new Jm,this.$r={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e){return this.Fr.Xi(e),this.$r[e]||"not-current"}updateQueryState(e,n,r){this.$r[e]=n}removeLocalQueryTarget(e){this.Fr.Zi(e)}isLocalQueryTarget(e){return this.Fr.activeTargetIds.has(e)}clearQueryState(e){delete this.$r[e]}getAllActiveQueryTargets(){return this.Fr.activeTargetIds}isActiveQueryTarget(e){return this.Fr.activeTargetIds.has(e)}start(){return this.Fr=new Jm,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S6{Br(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mT{constructor(){this.Lr=()=>this.Ur(),this.qr=()=>this.Kr(),this.Gr=[],this.Qr()}Br(e){this.Gr.push(e)}shutdown(){window.removeEventListener("online",this.Lr),window.removeEventListener("offline",this.qr)}Qr(){window.addEventListener("online",this.Lr),window.addEventListener("offline",this.qr)}Ur(){P("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.Gr)e(0)}Kr(){P("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.Gr)e(1)}static V(){return typeof window!="undefined"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const C6={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A6{constructor(e){this.jr=e.jr,this.Wr=e.Wr}zr(e){this.Hr=e}Jr(e){this.Yr=e}onMessage(e){this.Xr=e}close(){this.Wr()}send(e){this.jr(e)}Zr(){this.Hr()}eo(e){this.Yr(e)}no(e){this.Xr(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k6 extends class{constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const n=e.ssl?"https":"http";this.so=n+"://"+e.host,this.io="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}ro(e,n,r,s,i){const o=this.oo(e,n);P("RestConnection","Sending: ",o,r);const a={};return this.uo(a,s,i),this.co(e,o,a,r).then(c=>(P("RestConnection","Received: ",c),c),c=>{throw Wl("RestConnection",`${e} failed with error: `,c,"url: ",o,"request:",r),c})}ao(e,n,r,s,i,o){return this.ro(e,n,r,s,i)}uo(e,n,r){e["X-Goog-Api-Client"]="gl-js/ fire/"+rc,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((s,i)=>e[i]=s),r&&r.headers.forEach((s,i)=>e[i]=s)}oo(e,n){const r=C6[e];return`${this.so}/v1/${n}:${r}`}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams}co(e,n,r,s){return new Promise((i,o)=>{const a=new S2;a.listenOnce(I2.COMPLETE,()=>{try{switch(a.getLastErrorCode()){case hg.NO_ERROR:const l=a.getResponseJson();P("Connection","XHR received:",JSON.stringify(l)),i(l);break;case hg.TIMEOUT:P("Connection",'RPC "'+e+'" timed out'),o(new k(w.DEADLINE_EXCEEDED,"Request time out"));break;case hg.HTTP_ERROR:const u=a.getStatus();if(P("Connection",'RPC "'+e+'" failed with status:',u,"response text:",a.getResponseText()),u>0){const h=a.getResponseJson().error;if(h&&h.status&&h.message){const d=function(f){const p=f.toLowerCase().replace(/_/g,"-");return Object.values(w).indexOf(p)>=0?p:w.UNKNOWN}(h.status);o(new k(d,h.message))}else o(new k(w.UNKNOWN,"Server responded with status "+a.getStatus()))}else o(new k(w.UNAVAILABLE,"Connection failed."));break;default:G()}}finally{P("Connection",'RPC "'+e+'" completed.')}});const c=JSON.stringify(s);a.send(n,"POST",c,r,15)})}ho(e,n,r){const s=[this.so,"/","google.firestore.v1.Firestore","/",e,"/channel"],i=w2(),o=b2(),a={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.useFetchStreams&&(a.xmlHttpFactory=new T2({})),this.uo(a.initMessageHeaders,n,r),of()||hu()||xL()||B_()||OL()||uu()||(a.httpHeadersOverwriteParam="$httpHeaders");const c=s.join("");P("Connection","Creating WebChannel: "+c,a);const l=i.createWebChannel(c,a);let u=!1,h=!1;const d=new A6({jr:p=>{h?P("Connection","Not sending because WebChannel is closed:",p):(u||(P("Connection","Opening WebChannel transport."),l.open(),u=!0),P("Connection","WebChannel sending:",p),l.send(p))},Wr:()=>l.close()}),f=(p,_,y)=>{p.listen(_,T=>{try{y(T)}catch(I){setTimeout(()=>{throw I},0)}})};return f(l,ch.EventType.OPEN,()=>{h||P("Connection","WebChannel transport opened.")}),f(l,ch.EventType.CLOSE,()=>{h||(h=!0,P("Connection","WebChannel transport closed"),d.eo())}),f(l,ch.EventType.ERROR,p=>{h||(h=!0,Wl("Connection","WebChannel transport errored:",p),d.eo(new k(w.UNAVAILABLE,"The operation could not be completed")))}),f(l,ch.EventType.MESSAGE,p=>{var _;if(!h){const y=p.data[0];ie(!!y);const T=y,I=T.error||((_=T[0])===null||_===void 0?void 0:_.error);if(I){P("Connection","WebChannel received error:",I);const E=I.status;let S=function(H){const K=dt[H];if(K!==void 0)return PN(K)}(E),$=I.message;S===void 0&&(S=w.INTERNAL,$="Unknown error status: "+E+" with message "+I.message),h=!0,d.eo(new k(S,$)),l.close()}else P("Connection","WebChannel received:",y),d.no(y)}}),f(o,E2.STAT_EVENT,p=>{p.stat===AE.PROXY?P("Connection","Detected buffering proxy"):p.stat===AE.NOPROXY&&P("Connection","Detected no buffering proxy")}),setTimeout(()=>{d.Zr()},0),d}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gP(){return typeof window!="undefined"?window:null}function xh(){return typeof document!="undefined"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qu(t){return new v4(t,!0)}class Hv{constructor(e,n,r=1e3,s=1.5,i=6e4){this.js=e,this.timerId=n,this.lo=r,this.fo=s,this._o=i,this.wo=0,this.mo=null,this.yo=Date.now(),this.reset()}reset(){this.wo=0}po(){this.wo=this._o}Io(e){this.cancel();const n=Math.floor(this.wo+this.To()),r=Math.max(0,Date.now()-this.yo),s=Math.max(0,n-r);s>0&&P("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.wo} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.mo=this.js.enqueueAfterDelay(this.timerId,s,()=>(this.yo=Date.now(),e())),this.wo*=this.fo,this.wo<this.lo&&(this.wo=this.lo),this.wo>this._o&&(this.wo=this._o)}Eo(){this.mo!==null&&(this.mo.skipDelay(),this.mo=null)}cancel(){this.mo!==null&&(this.mo.cancel(),this.mo=null)}To(){return(Math.random()-.5)*this.wo}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mP{constructor(e,n,r,s,i,o,a,c){this.js=e,this.Ao=r,this.Ro=s,this.bo=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=c,this.state=0,this.Po=0,this.vo=null,this.Vo=null,this.stream=null,this.So=new Hv(e,n)}Do(){return this.state===1||this.state===5||this.Co()}Co(){return this.state===2||this.state===3}start(){this.state!==4?this.auth():this.xo()}async stop(){this.Do()&&await this.close(0)}No(){this.state=0,this.So.reset()}ko(){this.Co()&&this.vo===null&&(this.vo=this.js.enqueueAfterDelay(this.Ao,6e4,()=>this.Oo()))}Mo(e){this.Fo(),this.stream.send(e)}async Oo(){if(this.Co())return this.close(0)}Fo(){this.vo&&(this.vo.cancel(),this.vo=null)}$o(){this.Vo&&(this.Vo.cancel(),this.Vo=null)}async close(e,n){this.Fo(),this.$o(),this.So.cancel(),this.Po++,e!==4?this.So.reset():n&&n.code===w.RESOURCE_EXHAUSTED?(ft(n.toString()),ft("Using maximum backoff delay to prevent overloading the backend."),this.So.po()):n&&n.code===w.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.Bo(),this.stream.close(),this.stream=null),this.state=e,await this.listener.Jr(n)}Bo(){}auth(){this.state=1;const e=this.Lo(this.Po),n=this.Po;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,s])=>{this.Po===n&&this.Uo(r,s)},r=>{e(()=>{const s=new k(w.UNKNOWN,"Fetching auth token failed: "+r.message);return this.qo(s)})})}Uo(e,n){const r=this.Lo(this.Po);this.stream=this.Ko(e,n),this.stream.zr(()=>{r(()=>(this.state=2,this.Vo=this.js.enqueueAfterDelay(this.Ro,1e4,()=>(this.Co()&&(this.state=3),Promise.resolve())),this.listener.zr()))}),this.stream.Jr(s=>{r(()=>this.qo(s))}),this.stream.onMessage(s=>{r(()=>this.onMessage(s))})}xo(){this.state=5,this.So.Io(async()=>{this.state=0,this.start()})}qo(e){return P("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}Lo(e){return n=>{this.js.enqueueAndForget(()=>this.Po===e?n():(P("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class R6 extends mP{constructor(e,n,r,s,i,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,s,o),this.wt=i}Ko(e,n){return this.bo.ho("Listen",e,n)}onMessage(e){this.So.reset();const n=I4(this.wt,e),r=function(s){if(!("targetChange"in s))return se.min();const i=s.targetChange;return i.targetIds&&i.targetIds.length?se.min():i.readTime?Rt(i.readTime):se.min()}(e);return this.listener.Go(n,r)}Qo(e){const n={};n.database=eu(this.wt),n.addTarget=function(s,i){let o;const a=i.target;return o=Ad(a)?{documents:qN(s,a)}:{query:jN(s,a)},o.targetId=i.targetId,i.resumeToken.approximateByteSize()>0?o.resumeToken=FN(s,i.resumeToken):i.snapshotVersion.compareTo(se.min())>0&&(o.readTime=Xl(s,i.snapshotVersion.toTimestamp())),o}(this.wt,e);const r=T4(this.wt,e);r&&(n.labels=r),this.Mo(n)}jo(e){const n={};n.database=eu(this.wt),n.removeTarget=e,this.Mo(n)}}class N6 extends mP{constructor(e,n,r,s,i,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,s,o),this.wt=i,this.Wo=!1}get zo(){return this.Wo}start(){this.Wo=!1,this.lastStreamToken=void 0,super.start()}Bo(){this.Wo&&this.Ho([])}Ko(e,n){return this.bo.ho("Write",e,n)}onMessage(e){if(ie(!!e.streamToken),this.lastStreamToken=e.streamToken,this.Wo){this.So.reset();const n=E4(e.writeResults,e.commitTime),r=Rt(e.commitTime);return this.listener.Jo(r,n)}return ie(!e.writeResults||e.writeResults.length===0),this.Wo=!0,this.listener.Yo()}Xo(){const e={};e.database=eu(this.wt),this.Mo(e)}Ho(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>tu(this.wt,r))};this.Mo(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P6 extends class{}{constructor(e,n,r,s){super(),this.authCredentials=e,this.appCheckCredentials=n,this.bo=r,this.wt=s,this.Zo=!1}tu(){if(this.Zo)throw new k(w.FAILED_PRECONDITION,"The client has already been terminated.")}ro(e,n,r){return this.tu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,i])=>this.bo.ro(e,n,r,s,i)).catch(s=>{throw s.name==="FirebaseError"?(s.code===w.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new k(w.UNKNOWN,s.toString())})}ao(e,n,r,s){return this.tu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.bo.ao(e,n,r,i,o,s)).catch(i=>{throw i.name==="FirebaseError"?(i.code===w.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new k(w.UNKNOWN,i.toString())})}terminate(){this.Zo=!0}}class D6{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.eu=0,this.nu=null,this.su=!0}iu(){this.eu===0&&(this.ru("Unknown"),this.nu=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.nu=null,this.ou("Backend didn't respond within 10 seconds."),this.ru("Offline"),Promise.resolve())))}uu(e){this.state==="Online"?this.ru("Unknown"):(this.eu++,this.eu>=1&&(this.cu(),this.ou(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ru("Offline")))}set(e){this.cu(),this.eu=0,e==="Online"&&(this.su=!1),this.ru(e)}ru(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}ou(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.su?(ft(n),this.su=!1):P("OnlineStateTracker",n)}cu(){this.nu!==null&&(this.nu.cancel(),this.nu=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x6{constructor(e,n,r,s,i){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.au=[],this.hu=new Map,this.lu=new Set,this.fu=[],this.du=i,this.du.Br(o=>{r.enqueueAndForget(async()=>{gi(this)&&(P("RemoteStore","Restarting streams for network reachability change."),await async function(a){const c=q(a);c.lu.add(4),await ac(c),c._u.set("Unknown"),c.lu.delete(4),await ju(c)}(this))})}),this._u=new D6(r,s)}}async function ju(t){if(gi(t))for(const e of t.fu)await e(!0)}async function ac(t){for(const e of t.fu)await e(!1)}function up(t,e){const n=q(t);n.hu.has(e.targetId)||(n.hu.set(e.targetId,e),zv(n)?Gv(n):lc(n).Co()&&Wv(n,e))}function nu(t,e){const n=q(t),r=lc(n);n.hu.delete(e),r.Co()&&_P(n,e),n.hu.size===0&&(r.Co()?r.ko():gi(n)&&n._u.set("Unknown"))}function Wv(t,e){t.wu.Nt(e.targetId),lc(t).Qo(e)}function _P(t,e){t.wu.Nt(e),lc(t).jo(e)}function Gv(t){t.wu=new m4({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),te:e=>t.hu.get(e)||null}),lc(t).start(),t._u.iu()}function zv(t){return gi(t)&&!lc(t).Do()&&t.hu.size>0}function gi(t){return q(t).lu.size===0}function yP(t){t.wu=void 0}async function O6(t){t.hu.forEach((e,n)=>{Wv(t,e)})}async function M6(t,e){yP(t),zv(t)?(t._u.uu(e),Gv(t)):t._u.set("Unknown")}async function L6(t,e,n){if(t._u.set("Online"),e instanceof LN&&e.state===2&&e.cause)try{await async function(r,s){const i=s.cause;for(const o of s.targetIds)r.hu.has(o)&&(await r.remoteSyncer.rejectListen(o,i),r.hu.delete(o),r.wu.removeTarget(o))}(t,e)}catch(r){P("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),await Od(t,r)}else if(e instanceof Ph?t.wu.Ut(e):e instanceof MN?t.wu.zt(e):t.wu.Gt(e),!n.isEqual(se.min()))try{const r=await lP(t.localStore);n.compareTo(r)>=0&&await function(s,i){const o=s.wu.Yt(i);return o.targetChanges.forEach((a,c)=>{if(a.resumeToken.approximateByteSize()>0){const l=s.hu.get(c);l&&s.hu.set(c,l.withResumeToken(a.resumeToken,i))}}),o.targetMismatches.forEach(a=>{const c=s.hu.get(a);if(!c)return;s.hu.set(a,c.withResumeToken(vt.EMPTY_BYTE_STRING,c.snapshotVersion)),_P(s,a);const l=new Ks(c.target,a,1,c.sequenceNumber);Wv(s,l)}),s.remoteSyncer.applyRemoteEvent(o)}(t,n)}catch(r){P("RemoteStore","Failed to raise snapshot:",r),await Od(t,r)}}async function Od(t,e,n){if(!fi(e))throw e;t.lu.add(1),await ac(t),t._u.set("Offline"),n||(n=()=>lP(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{P("RemoteStore","Retrying IndexedDB access"),await n(),t.lu.delete(1),await ju(t)})}function vP(t,e){return e().catch(n=>Od(t,n,e))}async function cc(t){const e=q(t),n=si(e);let r=e.au.length>0?e.au[e.au.length-1].batchId:-1;for(;F6(e);)try{const s=await I6(e.localStore,r);if(s===null){e.au.length===0&&n.ko();break}r=s.batchId,U6(e,s)}catch(s){await Od(e,s)}wP(e)&&bP(e)}function F6(t){return gi(t)&&t.au.length<10}function U6(t,e){t.au.push(e);const n=si(t);n.Co()&&n.zo&&n.Ho(e.mutations)}function wP(t){return gi(t)&&!si(t).Do()&&t.au.length>0}function bP(t){si(t).start()}async function $6(t){si(t).Xo()}async function V6(t){const e=si(t);for(const n of t.au)e.Ho(n.mutations)}async function B6(t,e,n){const r=t.au.shift(),s=Lv.from(r,e,n);await vP(t,()=>t.remoteSyncer.applySuccessfulWrite(s)),await cc(t)}async function q6(t,e){e&&si(t).zo&&await async function(n,r){if(s=r.code,NN(s)&&s!==w.ABORTED){const i=n.au.shift();si(n).No(),await vP(n,()=>n.remoteSyncer.rejectFailedWrite(i.batchId,r)),await cc(n)}var s}(t,e),wP(t)&&bP(t)}async function _T(t,e){const n=q(t);n.asyncQueue.verifyOperationInProgress(),P("RemoteStore","RemoteStore received new credentials");const r=gi(n);n.lu.add(3),await ac(n),r&&n._u.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.lu.delete(3),await ju(n)}async function Xm(t,e){const n=q(t);e?(n.lu.delete(2),await ju(n)):e||(n.lu.add(2),await ac(n),n._u.set("Unknown"))}function lc(t){return t.mu||(t.mu=function(e,n,r){const s=q(e);return s.tu(),new R6(n,s.bo,s.authCredentials,s.appCheckCredentials,s.wt,r)}(t.datastore,t.asyncQueue,{zr:O6.bind(null,t),Jr:M6.bind(null,t),Go:L6.bind(null,t)}),t.fu.push(async e=>{e?(t.mu.No(),zv(t)?Gv(t):t._u.set("Unknown")):(await t.mu.stop(),yP(t))})),t.mu}function si(t){return t.gu||(t.gu=function(e,n,r){const s=q(e);return s.tu(),new N6(n,s.bo,s.authCredentials,s.appCheckCredentials,s.wt,r)}(t.datastore,t.asyncQueue,{zr:$6.bind(null,t),Jr:q6.bind(null,t),Yo:V6.bind(null,t),Jo:B6.bind(null,t)}),t.fu.push(async e=>{e?(t.gu.No(),await cc(t)):(await t.gu.stop(),t.au.length>0&&(P("RemoteStore",`Stopping write stream with ${t.au.length} pending writes`),t.au=[]))})),t.gu}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qv{constructor(e,n,r,s,i){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=s,this.removalCallback=i,this.deferred=new kt,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}static createAndSchedule(e,n,r,s,i){const o=Date.now()+r,a=new Qv(e,n,o,s,i);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new k(w.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function uc(t,e){if(ft("AsyncQueue",`${e}: ${t}`),fi(t))return new k(w.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ha{constructor(e){this.comparator=e?(n,r)=>e(n,r)||U.comparator(n.key,r.key):(n,r)=>U.comparator(n.key,r.key),this.keyedMap=Lc(),this.sortedSet=new it(this.comparator)}static emptySet(e){return new ha(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof ha)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new ha;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yT{constructor(){this.yu=new it(U.comparator)}track(e){const n=e.doc.key,r=this.yu.get(n);r?e.type!==0&&r.type===3?this.yu=this.yu.insert(n,e):e.type===3&&r.type!==1?this.yu=this.yu.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.yu=this.yu.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.yu=this.yu.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.yu=this.yu.remove(n):e.type===1&&r.type===2?this.yu=this.yu.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.yu=this.yu.insert(n,{type:2,doc:e.doc}):G():this.yu=this.yu.insert(n,e)}pu(){const e=[];return this.yu.inorderTraversal((n,r)=>{e.push(r)}),e}}class Fa{constructor(e,n,r,s,i,o,a,c){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=c}static fromInitialDocuments(e,n,r,s){const i=[];return n.forEach(o=>{i.push({type:0,doc:o})}),new Fa(e,n,ha.emptySet(n),i,r,s,!0,!1)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Uu(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let s=0;s<n.length;s++)if(n[s].type!==r[s].type||!n[s].doc.isEqual(r[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j6{constructor(){this.Iu=void 0,this.listeners=[]}}class K6{constructor(){this.queries=new pi(e=>yN(e),Uu),this.onlineState="Unknown",this.Tu=new Set}}async function Yv(t,e){const n=q(t),r=e.query;let s=!1,i=n.queries.get(r);if(i||(s=!0,i=new j6),s)try{i.Iu=await n.onListen(r)}catch(o){const a=uc(o,`Initialization of query '${Gm(e.query)}' failed`);return void e.onError(a)}n.queries.set(r,i),i.listeners.push(e),e.Eu(n.onlineState),i.Iu&&e.Au(i.Iu)&&Xv(n)}async function Jv(t,e){const n=q(t),r=e.query;let s=!1;const i=n.queries.get(r);if(i){const o=i.listeners.indexOf(e);o>=0&&(i.listeners.splice(o,1),s=i.listeners.length===0)}if(s)return n.queries.delete(r),n.onUnlisten(r)}function H6(t,e){const n=q(t);let r=!1;for(const s of e){const i=s.query,o=n.queries.get(i);if(o){for(const a of o.listeners)a.Au(s)&&(r=!0);o.Iu=s}}r&&Xv(n)}function W6(t,e,n){const r=q(t),s=r.queries.get(e);if(s)for(const i of s.listeners)i.onError(n);r.queries.delete(e)}function Xv(t){t.Tu.forEach(e=>{e.next()})}class Zv{constructor(e,n,r){this.query=e,this.Ru=n,this.bu=!1,this.Pu=null,this.onlineState="Unknown",this.options=r||{}}Au(e){if(!this.options.includeMetadataChanges){const r=[];for(const s of e.docChanges)s.type!==3&&r.push(s);e=new Fa(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0)}let n=!1;return this.bu?this.vu(e)&&(this.Ru.next(e),n=!0):this.Vu(e,this.onlineState)&&(this.Su(e),n=!0),this.Pu=e,n}onError(e){this.Ru.error(e)}Eu(e){this.onlineState=e;let n=!1;return this.Pu&&!this.bu&&this.Vu(this.Pu,e)&&(this.Su(this.Pu),n=!0),n}Vu(e,n){if(!e.fromCache)return!0;const r=n!=="Offline";return(!this.options.Du||!r)&&(!e.docs.isEmpty()||n==="Offline")}vu(e){if(e.docChanges.length>0)return!0;const n=this.Pu&&this.Pu.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}Su(e){e=Fa.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache),this.bu=!0,this.Ru.next(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G6{constructor(e,n){this.payload=e,this.byteLength=n}Cu(){return"metadata"in this.payload}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vT{constructor(e){this.wt=e}Wi(e){return kr(this.wt,e)}zi(e){return e.metadata.exists?BN(this.wt,e.document,!1):Be.newNoDocument(this.Wi(e.metadata.name),this.Hi(e.metadata.readTime))}Hi(e){return Rt(e)}}class z6{constructor(e,n,r){this.xu=e,this.localStore=n,this.wt=r,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=IP(e)}Nu(e){this.progress.bytesLoaded+=e.byteLength;let n=this.progress.documentsLoaded;if(e.payload.namedQuery)this.queries.push(e.payload.namedQuery);else if(e.payload.documentMetadata){this.documents.push({metadata:e.payload.documentMetadata}),e.payload.documentMetadata.exists||++n;const r=we.fromString(e.payload.documentMetadata.name);this.collectionGroups.add(r.get(r.length-2))}else e.payload.document&&(this.documents[this.documents.length-1].document=e.payload.document,++n);return n!==this.progress.documentsLoaded?(this.progress.documentsLoaded=n,Object.assign({},this.progress)):null}ku(e){const n=new Map,r=new vT(this.wt);for(const s of e)if(s.metadata.queries){const i=r.Wi(s.metadata.name);for(const o of s.metadata.queries){const a=(n.get(o)||ue()).add(i);n.set(o,a)}}return n}async complete(){const e=await E6(this.localStore,new vT(this.wt),this.documents,this.xu.id),n=this.ku(this.documents);for(const r of this.queries)await T6(this.localStore,r,n.get(r.name));return this.progress.taskState="Success",{progress:this.progress,Ou:this.collectionGroups,Mu:e}}}function IP(t){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:t.totalDocuments,totalBytes:t.totalBytes}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EP{constructor(e){this.key=e}}class TP{constructor(e){this.key=e}}class SP{constructor(e,n){this.query=e,this.Fu=n,this.$u=null,this.current=!1,this.Bu=ue(),this.mutatedKeys=ue(),this.Lu=wN(e),this.Uu=new ha(this.Lu)}get qu(){return this.Fu}Ku(e,n){const r=n?n.Gu:new yT,s=n?n.Uu:this.Uu;let i=n?n.mutatedKeys:this.mutatedKeys,o=s,a=!1;const c=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,l=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((u,h)=>{const d=s.get(u),f=Dv(this.query,h)?h:null,p=!!d&&this.mutatedKeys.has(d.key),_=!!f&&(f.hasLocalMutations||this.mutatedKeys.has(f.key)&&f.hasCommittedMutations);let y=!1;d&&f?d.data.isEqual(f.data)?p!==_&&(r.track({type:3,doc:f}),y=!0):this.Qu(d,f)||(r.track({type:2,doc:f}),y=!0,(c&&this.Lu(f,c)>0||l&&this.Lu(f,l)<0)&&(a=!0)):!d&&f?(r.track({type:0,doc:f}),y=!0):d&&!f&&(r.track({type:1,doc:d}),y=!0,(c||l)&&(a=!0)),y&&(f?(o=o.add(f),i=_?i.add(u):i.delete(u)):(o=o.delete(u),i=i.delete(u)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const u=this.query.limitType==="F"?o.last():o.first();o=o.delete(u.key),i=i.delete(u.key),r.track({type:1,doc:u})}return{Uu:o,Gu:r,Oi:a,mutatedKeys:i}}Qu(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r){const s=this.Uu;this.Uu=e.Uu,this.mutatedKeys=e.mutatedKeys;const i=e.Gu.pu();i.sort((l,u)=>function(h,d){const f=p=>{switch(p){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return G()}};return f(h)-f(d)}(l.type,u.type)||this.Lu(l.doc,u.doc)),this.ju(r);const o=n?this.Wu():[],a=this.Bu.size===0&&this.current?1:0,c=a!==this.$u;return this.$u=a,i.length!==0||c?{snapshot:new Fa(this.query,e.Uu,s,i,e.mutatedKeys,a===0,c,!1),zu:o}:{zu:o}}Eu(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Uu:this.Uu,Gu:new yT,mutatedKeys:this.mutatedKeys,Oi:!1},!1)):{zu:[]}}Hu(e){return!this.Fu.has(e)&&!!this.Uu.has(e)&&!this.Uu.get(e).hasLocalMutations}ju(e){e&&(e.addedDocuments.forEach(n=>this.Fu=this.Fu.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Fu=this.Fu.delete(n)),this.current=e.current)}Wu(){if(!this.current)return[];const e=this.Bu;this.Bu=ue(),this.Uu.forEach(r=>{this.Hu(r.key)&&(this.Bu=this.Bu.add(r.key))});const n=[];return e.forEach(r=>{this.Bu.has(r)||n.push(new TP(r))}),this.Bu.forEach(r=>{e.has(r)||n.push(new EP(r))}),n}Ju(e){this.Fu=e.ji,this.Bu=ue();const n=this.Ku(e.documents);return this.applyChanges(n,!0)}Yu(){return Fa.fromInitialDocuments(this.query,this.Uu,this.mutatedKeys,this.$u===0)}}class Q6{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class Y6{constructor(e){this.key=e,this.Xu=!1}}class J6{constructor(e,n,r,s,i,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.Zu={},this.tc=new pi(a=>yN(a),Uu),this.ec=new Map,this.nc=new Set,this.sc=new it(U.comparator),this.ic=new Map,this.rc=new Vv,this.oc={},this.uc=new Map,this.cc=yo.Rn(),this.onlineState="Unknown",this.ac=void 0}get isPrimaryClient(){return this.ac===!0}}async function X6(t,e){const n=sw(t);let r,s;const i=n.tc.get(e);if(i)r=i.targetId,n.sharedClientState.addLocalQueryTarget(r),s=i.view.Yu();else{const o=await Ma(n.localStore,Qn(e));n.isPrimaryClient&&up(n.remoteStore,o);const a=n.sharedClientState.addLocalQueryTarget(o.targetId);r=o.targetId,s=await ew(n,e,r,a==="current")}return s}async function ew(t,e,n,r){t.hc=(u,h,d)=>async function(f,p,_,y){let T=p.view.Ku(_);T.Oi&&(T=await Pd(f.localStore,p.query,!1).then(({documents:S})=>p.view.Ku(S,T)));const I=y&&y.targetChanges.get(p.targetId),E=p.view.applyChanges(T,f.isPrimaryClient,I);return Zm(f,p.targetId,E.zu),E.snapshot}(t,u,h,d);const s=await Pd(t.localStore,e,!0),i=new SP(e,s.ji),o=i.Ku(s.documents),a=Bu.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline"),c=i.applyChanges(o,t.isPrimaryClient,a);Zm(t,n,c.zu);const l=new Q6(e,n,i);return t.tc.set(e,l),t.ec.has(n)?t.ec.get(n).push(e):t.ec.set(n,[e]),c.snapshot}async function Z6(t,e){const n=q(t),r=n.tc.get(e),s=n.ec.get(r.targetId);if(s.length>1)return n.ec.set(r.targetId,s.filter(i=>!Uu(i,e))),void n.tc.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(r.targetId),n.sharedClientState.isActiveQueryTarget(r.targetId)||await La(n.localStore,r.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(r.targetId),nu(n.remoteStore,r.targetId),Ua(n,r.targetId)}).catch(di)):(Ua(n,r.targetId),await La(n.localStore,r.targetId,!0))}async function eQ(t,e,n){const r=iw(t);try{const s=await function(i,o){const a=q(i),c=Ye.now(),l=o.reduce((d,f)=>d.add(f.key),ue());let u,h;return a.persistence.runTransaction("Locally write mutations","readwrite",d=>{let f=wn(),p=ue();return a.Ui.getEntries(d,l).next(_=>{f=_,f.forEach((y,T)=>{T.isValidDocument()||(p=p.add(y))})}).next(()=>a.localDocuments.getOverlayedDocuments(d,f)).next(_=>{u=_;const y=[];for(const T of o){const I=u4(T,u.get(T.key).overlayedDocument);I!=null&&y.push(new ms(T.key,I,pN(I.value.mapValue),Xe.exists(!0)))}return a.mutationQueue.addMutationBatch(d,c,y,o)}).next(_=>{h=_;const y=_.applyToLocalDocumentSet(u,p);return a.documentOverlayCache.saveOverlays(d,_.batchId,y)})}).then(()=>({batchId:h.batchId,changes:xN(u)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(s.batchId),function(i,o,a){let c=i.oc[i.currentUser.toKey()];c||(c=new it(ce)),c=c.insert(o,a),i.oc[i.currentUser.toKey()]=c}(r,s.batchId,n),await _s(r,s.changes),await cc(r.remoteStore)}catch(s){const i=uc(s,"Failed to persist write");n.reject(i)}}async function CP(t,e){const n=q(t);try{const r=await b6(n.localStore,e);e.targetChanges.forEach((s,i)=>{const o=n.ic.get(i);o&&(ie(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1),s.addedDocuments.size>0?o.Xu=!0:s.modifiedDocuments.size>0?ie(o.Xu):s.removedDocuments.size>0&&(ie(o.Xu),o.Xu=!1))}),await _s(n,r,e)}catch(r){await di(r)}}function wT(t,e,n){const r=q(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const s=[];r.tc.forEach((i,o)=>{const a=o.view.Eu(e);a.snapshot&&s.push(a.snapshot)}),function(i,o){const a=q(i);a.onlineState=o;let c=!1;a.queries.forEach((l,u)=>{for(const h of u.listeners)h.Eu(o)&&(c=!0)}),c&&Xv(a)}(r.eventManager,e),s.length&&r.Zu.Go(s),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function tQ(t,e,n){const r=q(t);r.sharedClientState.updateQueryState(e,"rejected",n);const s=r.ic.get(e),i=s&&s.key;if(i){let o=new it(U.comparator);o=o.insert(i,Be.newNoDocument(i,se.min()));const a=ue().add(i),c=new Vu(se.min(),new Map,new ke(ce),o,a);await CP(r,c),r.sc=r.sc.remove(i),r.ic.delete(e),rw(r)}else await La(r.localStore,e,!1).then(()=>Ua(r,e,n)).catch(di)}async function nQ(t,e){const n=q(t),r=e.batch.batchId;try{const s=await w6(n.localStore,e);nw(n,r,null),tw(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await _s(n,s)}catch(s){await di(s)}}async function rQ(t,e,n){const r=q(t);try{const s=await function(i,o){const a=q(i);return a.persistence.runTransaction("Reject batch","readwrite-primary",c=>{let l;return a.mutationQueue.lookupMutationBatch(c,o).next(u=>(ie(u!==null),l=u.keys(),a.mutationQueue.removeMutationBatch(c,u))).next(()=>a.mutationQueue.performConsistencyCheck(c)).next(()=>a.documentOverlayCache.removeOverlaysForBatchId(c,l,o)).next(()=>a.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(c,l)).next(()=>a.localDocuments.getDocuments(c,l))})}(r.localStore,e);nw(r,e,n),tw(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await _s(r,s)}catch(s){await di(s)}}async function sQ(t,e){const n=q(t);gi(n.remoteStore)||P("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{const r=await function(i){const o=q(i);return o.persistence.runTransaction("Get highest unacknowledged batch id","readonly",a=>o.mutationQueue.getHighestUnacknowledgedBatchId(a))}(n.localStore);if(r===-1)return void e.resolve();const s=n.uc.get(r)||[];s.push(e),n.uc.set(r,s)}catch(r){const s=uc(r,"Initialization of waitForPendingWrites() operation failed");e.reject(s)}}function tw(t,e){(t.uc.get(e)||[]).forEach(n=>{n.resolve()}),t.uc.delete(e)}function nw(t,e,n){const r=q(t);let s=r.oc[r.currentUser.toKey()];if(s){const i=s.get(e);i&&(n?i.reject(n):i.resolve(),s=s.remove(e)),r.oc[r.currentUser.toKey()]=s}}function Ua(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.ec.get(e))t.tc.delete(r),n&&t.Zu.lc(r,n);t.ec.delete(e),t.isPrimaryClient&&t.rc.us(e).forEach(r=>{t.rc.containsKey(r)||AP(t,r)})}function AP(t,e){t.nc.delete(e.path.canonicalString());const n=t.sc.get(e);n!==null&&(nu(t.remoteStore,n),t.sc=t.sc.remove(e),t.ic.delete(n),rw(t))}function Zm(t,e,n){for(const r of n)r instanceof EP?(t.rc.addReference(r.key,e),iQ(t,r)):r instanceof TP?(P("SyncEngine","Document no longer in limbo: "+r.key),t.rc.removeReference(r.key,e),t.rc.containsKey(r.key)||AP(t,r.key)):G()}function iQ(t,e){const n=e.key,r=n.path.canonicalString();t.sc.get(n)||t.nc.has(r)||(P("SyncEngine","New document in limbo: "+n),t.nc.add(r),rw(t))}function rw(t){for(;t.nc.size>0&&t.sc.size<t.maxConcurrentLimboResolutions;){const e=t.nc.values().next().value;t.nc.delete(e);const n=new U(we.fromString(e)),r=t.cc.next();t.ic.set(r,new Y6(n)),t.sc=t.sc.insert(n,r),up(t.remoteStore,new Ks(Qn(sc(n.path)),r,2,vn.ot))}}async function _s(t,e,n){const r=q(t),s=[],i=[],o=[];r.tc.isEmpty()||(r.tc.forEach((a,c)=>{o.push(r.hc(c,e,n).then(l=>{if(l){r.isPrimaryClient&&r.sharedClientState.updateQueryState(c.targetId,l.fromCache?"not-current":"current"),s.push(l);const u=jv.Vi(c.targetId,l);i.push(u)}}))}),await Promise.all(o),r.Zu.Go(s),await async function(a,c){const l=q(a);try{await l.persistence.runTransaction("notifyLocalViewChanges","readwrite",u=>v.forEach(c,h=>v.forEach(h.Pi,d=>l.persistence.referenceDelegate.addReference(u,h.targetId,d)).next(()=>v.forEach(h.vi,d=>l.persistence.referenceDelegate.removeReference(u,h.targetId,d)))))}catch(u){if(!fi(u))throw u;P("LocalStore","Failed to update sequence numbers: "+u)}for(const u of c){const h=u.targetId;if(!u.fromCache){const d=l.$i.get(h),f=d.snapshotVersion,p=d.withLastLimboFreeSnapshotVersion(f);l.$i=l.$i.insert(h,p)}}}(r.localStore,i))}async function oQ(t,e){const n=q(t);if(!n.currentUser.isEqual(e)){P("SyncEngine","User change. New user:",e.toKey());const r=await cP(n.localStore,e);n.currentUser=e,function(s,i){s.uc.forEach(o=>{o.forEach(a=>{a.reject(new k(w.CANCELLED,i))})}),s.uc.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await _s(n,r.Ki)}}function aQ(t,e){const n=q(t),r=n.ic.get(e);if(r&&r.Xu)return ue().add(r.key);{let s=ue();const i=n.ec.get(e);if(!i)return s;for(const o of i){const a=n.tc.get(o);s=s.unionWith(a.view.qu)}return s}}async function cQ(t,e){const n=q(t),r=await Pd(n.localStore,e.query,!0),s=e.view.Ju(r);return n.isPrimaryClient&&Zm(n,e.targetId,s.zu),s}async function lQ(t,e){const n=q(t);return dP(n.localStore,e).then(r=>_s(n,r))}async function uQ(t,e,n,r){const s=q(t),i=await function(o,a){const c=q(o),l=q(c.mutationQueue);return c.persistence.runTransaction("Lookup mutation documents","readonly",u=>l.yn(u,a).next(h=>h?c.localDocuments.getDocuments(u,h):v.resolve(null)))}(s.localStore,e);i!==null?(n==="pending"?await cc(s.remoteStore):n==="acknowledged"||n==="rejected"?(nw(s,e,r||null),tw(s,e),function(o,a){q(q(o).mutationQueue).In(a)}(s.localStore,e)):G(),await _s(s,i)):P("SyncEngine","Cannot apply mutation batch with id: "+e)}async function hQ(t,e){const n=q(t);if(sw(n),iw(n),e===!0&&n.ac!==!0){const r=n.sharedClientState.getAllActiveQueryTargets(),s=await bT(n,r.toArray());n.ac=!0,await Xm(n.remoteStore,!0);for(const i of s)up(n.remoteStore,i)}else if(e===!1&&n.ac!==!1){const r=[];let s=Promise.resolve();n.ec.forEach((i,o)=>{n.sharedClientState.isLocalQueryTarget(o)?r.push(o):s=s.then(()=>(Ua(n,o),La(n.localStore,o,!0))),nu(n.remoteStore,o)}),await s,await bT(n,r),function(i){const o=q(i);o.ic.forEach((a,c)=>{nu(o.remoteStore,c)}),o.rc.cs(),o.ic=new Map,o.sc=new it(U.comparator)}(n),n.ac=!1,await Xm(n.remoteStore,!1)}}async function bT(t,e,n){const r=q(t),s=[],i=[];for(const o of e){let a;const c=r.ec.get(o);if(c&&c.length!==0){a=await Ma(r.localStore,Qn(c[0]));for(const l of c){const u=r.tc.get(l),h=await cQ(r,u);h.snapshot&&i.push(h.snapshot)}}else{const l=await hP(r.localStore,o);a=await Ma(r.localStore,l),await ew(r,kP(l),o,!1)}s.push(a)}return r.Zu.Go(i),s}function kP(t){return mN(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function dQ(t){const e=q(t);return q(q(e.localStore).persistence).Ri()}async function fQ(t,e,n,r){const s=q(t);if(s.ac)return void P("SyncEngine","Ignoring unexpected query state notification.");const i=s.ec.get(e);if(i&&i.length>0)switch(n){case"current":case"not-current":{const o=await dP(s.localStore,vN(i[0])),a=Vu.createSynthesizedRemoteEventForCurrentChange(e,n==="current");await _s(s,o,a);break}case"rejected":await La(s.localStore,e,!0),Ua(s,e,r);break;default:G()}}async function pQ(t,e,n){const r=sw(t);if(r.ac){for(const s of e){if(r.ec.has(s)){P("SyncEngine","Adding an already active target "+s);continue}const i=await hP(r.localStore,s),o=await Ma(r.localStore,i);await ew(r,kP(i),o.targetId,!1),up(r.remoteStore,o)}for(const s of n)r.ec.has(s)&&await La(r.localStore,s,!1).then(()=>{nu(r.remoteStore,s),Ua(r,s)}).catch(di)}}function sw(t){const e=q(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=CP.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=aQ.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=tQ.bind(null,e),e.Zu.Go=H6.bind(null,e.eventManager),e.Zu.lc=W6.bind(null,e.eventManager),e}function iw(t){const e=q(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=nQ.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=rQ.bind(null,e),e}function gQ(t,e,n){const r=q(t);(async function(s,i,o){try{const a=await i.getMetadata();if(await function(h,d){const f=q(h),p=Rt(d.createTime);return f.persistence.runTransaction("hasNewerBundle","readonly",_=>f.Ds.getBundleMetadata(_,d.id)).then(_=>!!_&&_.createTime.compareTo(p)>=0)}(s.localStore,a))return await i.close(),o._completeWith(function(h){return{taskState:"Success",documentsLoaded:h.totalDocuments,bytesLoaded:h.totalBytes,totalDocuments:h.totalDocuments,totalBytes:h.totalBytes}}(a)),Promise.resolve(new Set);o._updateProgress(IP(a));const c=new z6(a,s.localStore,i.wt);let l=await i.fc();for(;l;){const h=await c.Nu(l);h&&o._updateProgress(h),l=await i.fc()}const u=await c.complete();return await _s(s,u.Mu,void 0),await function(h,d){const f=q(h);return f.persistence.runTransaction("Save bundle","readwrite",p=>f.Ds.saveBundleMetadata(p,d))}(s.localStore,a),o._completeWith(u.progress),Promise.resolve(u.Ou)}catch(a){return Wl("SyncEngine",`Loading bundle failed with ${a}`),o._failWith(a),Promise.resolve(new Set)}})(r,e,n).then(s=>{r.sharedClientState.notifyBundleLoaded(s)})}class RP{constructor(){this.synchronizeTabs=!1}async initialize(e){this.wt=qu(e.databaseInfo.databaseId),this.sharedClientState=this.dc(e),this.persistence=this._c(e),await this.persistence.start(),this.localStore=this.wc(e),this.gcScheduler=this.mc(e,this.localStore),this.indexBackfillerScheduler=this.gc(e,this.localStore)}mc(e,n){return null}gc(e,n){return null}wc(e){return aP(this.persistence,new oP,e.initialUser,this.wt)}_c(e){return new iP(lp.Ms,this.wt)}dc(e){return new pP}async terminate(){this.gcScheduler&&this.gcScheduler.stop(),await this.sharedClientState.shutdown(),await this.persistence.shutdown()}}class NP extends RP{constructor(e,n,r){super(),this.yc=e,this.cacheSizeBytes=n,this.forceOwnership=r,this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.yc.initialize(this,e),await iw(this.yc.syncEngine),await cc(this.yc.remoteStore),await this.persistence.ci(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}wc(e){return aP(this.persistence,new oP,e.initialUser,this.wt)}mc(e,n){const r=this.persistence.referenceDelegate.garbageCollector;return new i6(r,e.asyncQueue,n)}gc(e,n){const r=new B2(n,this.persistence);return new V2(e.asyncQueue,r)}_c(e){const n=qv(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?mn.withCacheSize(this.cacheSizeBytes):mn.DEFAULT;return new Bv(this.synchronizeTabs,n,e.clientId,r,e.asyncQueue,gP(),xh(),this.wt,this.sharedClientState,!!this.forceOwnership)}dc(e){return new pP}}class mQ extends NP{constructor(e,n){super(e,n,!1),this.yc=e,this.cacheSizeBytes=n,this.synchronizeTabs=!0}async initialize(e){await super.initialize(e);const n=this.yc.syncEngine;this.sharedClientState instanceof gg&&(this.sharedClientState.syncEngine={kr:uQ.bind(null,n),Or:fQ.bind(null,n),Mr:pQ.bind(null,n),Ri:dQ.bind(null,n),Nr:lQ.bind(null,n)},await this.sharedClientState.start()),await this.persistence.ci(async r=>{await hQ(this.yc.syncEngine,r),this.gcScheduler&&(r&&!this.gcScheduler.started?this.gcScheduler.start():r||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(r&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():r||this.indexBackfillerScheduler.stop())})}dc(e){const n=gP();if(!gg.V(n))throw new k(w.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const r=qv(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new gg(n,e.asyncQueue,r,e.clientId,e.initialUser)}}class ow{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>wT(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=oQ.bind(null,this.syncEngine),await Xm(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return new K6}createDatastore(e){const n=qu(e.databaseInfo.databaseId),r=(s=e.databaseInfo,new k6(s));var s;return function(i,o,a,c){return new P6(i,o,a,c)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return n=this.localStore,r=this.datastore,s=e.asyncQueue,i=a=>wT(this.syncEngine,a,0),o=mT.V()?new mT:new S6,new x6(n,r,s,i,o);var n,r,s,i,o}createSyncEngine(e,n){return function(r,s,i,o,a,c,l){const u=new J6(r,s,i,o,a,c);return l&&(u.ac=!0),u}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}terminate(){return async function(e){const n=q(e);P("RemoteStore","RemoteStore shutting down."),n.lu.add(5),await ac(n),n.du.shutdown(),n._u.set("Unknown")}(this.remoteStore)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function IT(t,e=10240){let n=0;return{async read(){if(n<t.byteLength){const r={value:t.slice(n,n+e),done:!1};return n+=e,r}return{done:!0}},async cancel(){},releaseLock(){},closed:Promise.reject("unimplemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hp{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Ic(this.observer.next,e)}error(e){this.observer.error?this.Ic(this.observer.error,e):console.error("Uncaught Error in snapshot listener:",e)}Tc(){this.muted=!0}Ic(e,n){this.muted||setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _Q{constructor(e,n){this.Ec=e,this.wt=n,this.metadata=new kt,this.buffer=new Uint8Array,this.Ac=new TextDecoder("utf-8"),this.Rc().then(r=>{r&&r.Cu()?this.metadata.resolve(r.payload.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(r==null?void 0:r.payload)}`))},r=>this.metadata.reject(r))}close(){return this.Ec.cancel()}async getMetadata(){return this.metadata.promise}async fc(){return await this.getMetadata(),this.Rc()}async Rc(){const e=await this.bc();if(e===null)return null;const n=this.Ac.decode(e),r=Number(n);isNaN(r)&&this.Pc(`length string (${n}) is not valid number`);const s=await this.vc(r);return new G6(JSON.parse(s),e.length+r)}Vc(){return this.buffer.findIndex(e=>e==="{".charCodeAt(0))}async bc(){for(;this.Vc()<0&&!await this.Sc(););if(this.buffer.length===0)return null;const e=this.Vc();e<0&&this.Pc("Reached the end of bundle when a length string is expected.");const n=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),n}async vc(e){for(;this.buffer.length<e;)await this.Sc()&&this.Pc("Reached the end of bundle when more is expected.");const n=this.Ac.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),n}Pc(e){throw this.Ec.cancel(),new Error(`Invalid bundle format: ${e}`)}async Sc(){const e=await this.Ec.read();if(!e.done){const n=new Uint8Array(this.buffer.length+e.value.length);n.set(this.buffer),n.set(e.value,this.buffer.length),this.buffer=n}return e.done}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yQ{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastWriteError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw new k(w.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");const n=await async function(r,s){const i=q(r),o=eu(i.wt)+"/documents",a={documents:s.map(h=>Zl(i.wt,h))},c=await i.ao("BatchGetDocuments",o,a,s.length),l=new Map;c.forEach(h=>{const d=b4(i.wt,h);l.set(d.key.toString(),d)});const u=[];return s.forEach(h=>{const d=l.get(h.toString());ie(!!d),u.push(d)}),u}(this.datastore,e);return n.forEach(r=>this.recordVersion(r)),n}set(e,n){this.write(n.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,n){try{this.write(n.toMutation(e,this.preconditionForUpdate(e)))}catch(r){this.lastWriteError=r}this.writtenDocs.add(e.toString())}delete(e){this.write(new oc(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastWriteError)throw this.lastWriteError;const e=this.readVersions;this.mutations.forEach(n=>{e.delete(n.key.toString())}),e.forEach((n,r)=>{const s=U.fromPath(r);this.mutations.push(new xv(s,this.precondition(s)))}),await async function(n,r){const s=q(n),i=eu(s.wt)+"/documents",o={writes:r.map(a=>tu(s.wt,a))};await s.ro("Commit",i,o)}(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let n;if(e.isFoundDocument())n=e.version;else{if(!e.isNoDocument())throw G();n=se.min()}const r=this.readVersions.get(e.key.toString());if(r){if(!n.isEqual(r))throw new k(w.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),n)}precondition(e){const n=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&n?Xe.updateTime(n):Xe.none()}preconditionForUpdate(e){const n=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&n){if(n.isEqual(se.min()))throw new k(w.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Xe.updateTime(n)}return Xe.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vQ{constructor(e,n,r,s,i){this.asyncQueue=e,this.datastore=n,this.options=r,this.updateFunction=s,this.deferred=i,this.Dc=r.maxAttempts,this.So=new Hv(this.asyncQueue,"transaction_retry")}run(){this.Dc-=1,this.Cc()}Cc(){this.So.Io(async()=>{const e=new yQ(this.datastore),n=this.xc(e);n&&n.then(r=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(r)}).catch(s=>{this.Nc(s)}))}).catch(r=>{this.Nc(r)})})}xc(e){try{const n=this.updateFunction(e);return!Lu(n)&&n.catch&&n.then?n:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(n){return this.deferred.reject(n),null}}Nc(e){this.Dc>0&&this.kc(e)?(this.Dc-=1,this.asyncQueue.enqueueAndForget(()=>(this.Cc(),Promise.resolve()))):this.deferred.reject(e)}kc(e){if(e.name==="FirebaseError"){const n=e.code;return n==="aborted"||n==="failed-precondition"||!NN(n)}return!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wQ{constructor(e,n,r,s){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=s,this.user=St.UNAUTHENTICATED,this.clientId=rN.I(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(r,async i=>{P("FirestoreClient","Received user=",i.uid),await this.authCredentialListener(i),this.user=i}),this.appCheckCredentials.start(r,i=>(P("FirestoreClient","Received new app check token=",i),this.appCheckCredentialListener(i,this.user)))}async getConfiguration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new k(w.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();const e=new kt;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this.onlineComponents&&await this.onlineComponents.terminate(),this.offlineComponents&&await this.offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=uc(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function PP(t,e){t.asyncQueue.verifyOperationInProgress(),P("FirestoreClient","Initializing OfflineComponentProvider");const n=await t.getConfiguration();await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async s=>{r.isEqual(s)||(await cP(e.localStore,s),r=s)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t.offlineComponents=e}async function DP(t,e){t.asyncQueue.verifyOperationInProgress();const n=await aw(t);P("FirestoreClient","Initializing OnlineComponentProvider");const r=await t.getConfiguration();await e.initialize(n,r),t.setCredentialChangeListener(s=>_T(e.remoteStore,s)),t.setAppCheckTokenChangeListener((s,i)=>_T(e.remoteStore,i)),t.onlineComponents=e}async function aw(t){return t.offlineComponents||(P("FirestoreClient","Using default OfflineComponentProvider"),await PP(t,new RP)),t.offlineComponents}async function dp(t){return t.onlineComponents||(P("FirestoreClient","Using default OnlineComponentProvider"),await DP(t,new ow)),t.onlineComponents}function xP(t){return aw(t).then(e=>e.persistence)}function cw(t){return aw(t).then(e=>e.localStore)}function OP(t){return dp(t).then(e=>e.remoteStore)}function lw(t){return dp(t).then(e=>e.syncEngine)}async function $a(t){const e=await dp(t),n=e.eventManager;return n.onListen=X6.bind(null,e.syncEngine),n.onUnlisten=Z6.bind(null,e.syncEngine),n}function bQ(t){return t.asyncQueue.enqueue(async()=>{const e=await xP(t),n=await OP(t);return e.setNetworkEnabled(!0),function(r){const s=q(r);return s.lu.delete(0),ju(s)}(n)})}function IQ(t){return t.asyncQueue.enqueue(async()=>{const e=await xP(t),n=await OP(t);return e.setNetworkEnabled(!1),async function(r){const s=q(r);s.lu.add(0),await ac(s),s._u.set("Offline")}(n)})}function EQ(t,e){const n=new kt;return t.asyncQueue.enqueueAndForget(async()=>async function(r,s,i){try{const o=await function(a,c){const l=q(a);return l.persistence.runTransaction("read document","readonly",u=>l.localDocuments.getDocument(u,c))}(r,s);o.isFoundDocument()?i.resolve(o):o.isNoDocument()?i.resolve(null):i.reject(new k(w.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(o){const a=uc(o,`Failed to get document '${s} from cache`);i.reject(a)}}(await cw(t),e,n)),n.promise}function MP(t,e,n={}){const r=new kt;return t.asyncQueue.enqueueAndForget(async()=>function(s,i,o,a,c){const l=new hp({next:h=>{i.enqueueAndForget(()=>Jv(s,u));const d=h.docs.has(o);!d&&h.fromCache?c.reject(new k(w.UNAVAILABLE,"Failed to get document because the client is offline.")):d&&h.fromCache&&a&&a.source==="server"?c.reject(new k(w.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):c.resolve(h)},error:h=>c.reject(h)}),u=new Zv(sc(o.path),l,{includeMetadataChanges:!0,Du:!0});return Yv(s,u)}(await $a(t),t.asyncQueue,e,n,r)),r.promise}function TQ(t,e){const n=new kt;return t.asyncQueue.enqueueAndForget(async()=>async function(r,s,i){try{const o=await Pd(r,s,!0),a=new SP(s,o.ji),c=a.Ku(o.documents),l=a.applyChanges(c,!1);i.resolve(l.snapshot)}catch(o){const a=uc(o,`Failed to execute query '${s} against cache`);i.reject(a)}}(await cw(t),e,n)),n.promise}function LP(t,e,n={}){const r=new kt;return t.asyncQueue.enqueueAndForget(async()=>function(s,i,o,a,c){const l=new hp({next:h=>{i.enqueueAndForget(()=>Jv(s,u)),h.fromCache&&a.source==="server"?c.reject(new k(w.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):c.resolve(h)},error:h=>c.reject(h)}),u=new Zv(o,l,{includeMetadataChanges:!0,Du:!0});return Yv(s,u)}(await $a(t),t.asyncQueue,e,n,r)),r.promise}function SQ(t,e){const n=new hp(e);return t.asyncQueue.enqueueAndForget(async()=>function(r,s){q(r).Tu.add(s),s.next()}(await $a(t),n)),()=>{n.Tc(),t.asyncQueue.enqueueAndForget(async()=>function(r,s){q(r).Tu.delete(s)}(await $a(t),n))}}function CQ(t,e,n){const r=new kt;return t.asyncQueue.enqueueAndForget(async()=>{const s=await function(i){return dp(i).then(o=>o.datastore)}(t);new vQ(t.asyncQueue,s,n,e,r).run()}),r.promise}function AQ(t,e,n,r){const s=function(i,o){let a;return a=typeof i=="string"?new TextEncoder().encode(i):i,function(c,l){return new _Q(c,l)}(function(c,l){if(c instanceof Uint8Array)return IT(c,l);if(c instanceof ArrayBuffer)return IT(new Uint8Array(c),l);if(c instanceof ReadableStream)return c.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(a),o)}(n,qu(e));t.asyncQueue.enqueueAndForget(async()=>{gQ(await lw(t),s,r)})}function kQ(t,e){return t.asyncQueue.enqueue(async()=>function(n,r){const s=q(n);return s.persistence.runTransaction("Get named query","readonly",i=>s.Ds.getNamedQuery(i,r))}(await cw(t),e))}const ET=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uw(t,e,n){if(!n)throw new k(w.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function FP(t,e,n,r){if(e===!0&&r===!0)throw new k(w.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function TT(t){if(!U.isDocumentKey(t))throw new k(w.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function ST(t){if(U.isDocumentKey(t))throw new k(w.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function fp(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(n){return n.constructor?n.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":G()}function Ie(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new k(w.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=fp(t);throw new k(w.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}function UP(t,e){if(e<=0)throw new k(w.INVALID_ARGUMENT,`Function ${t}() requires a positive number, but it was: ${e}.`)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CT{constructor(e){var n;if(e.host===void 0){if(e.ssl!==void 0)throw new k(w.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(n=e.ssl)===null||n===void 0||n;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new k(w.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.useFetchStreams=!!e.useFetchStreams,FP("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling)}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ku{constructor(e,n,r){this._authCredentials=n,this._appCheckCredentials=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new CT({}),this._settingsFrozen=!1,e instanceof us?this._databaseId=e:(this._app=e,this._databaseId=function(s){if(!Object.prototype.hasOwnProperty.apply(s.options,["projectId"]))throw new k(w.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new us(s.options.projectId)}(e))}get app(){if(!this._app)throw new k(w.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!==void 0}_setSettings(e){if(this._settingsFrozen)throw new k(w.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new CT(e),e.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new k2;switch(n.type){case"gapi":const r=n.client;return ie(!(typeof r!="object"||r===null||!r.auth||!r.auth.getAuthHeaderValueForFirstParty)),new D2(r,n.sessionIndex||"0",n.iamToken||null);case"provider":return n.client;default:throw new k(w.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const n=ET.get(e);n&&(P("ComponentProvider","Removing Datastore"),ET.delete(e),n.terminate())}(this),Promise.resolve()}}function RQ(t,e,n,r={}){var s;const i=(t=Ie(t,Ku))._getSettings();if(i.host!=="firestore.googleapis.com"&&i.host!==e&&Wl("Host has been set in both settings() and useEmulator(), emulator host will be used"),t._setSettings(Object.assign(Object.assign({},i),{host:`${e}:${n}`,ssl:!1})),r.mockUserToken){let o,a;if(typeof r.mockUserToken=="string")o=r.mockUserToken,a=St.MOCK_USER;else{o=$_(r.mockUserToken,(s=t._app)===null||s===void 0?void 0:s.options.projectId);const c=r.mockUserToken.sub||r.mockUserToken.user_id;if(!c)throw new k(w.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");a=new St(c)}t._authCredentials=new R2(new nN(o,a))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class He{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Rr(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new He(this.firestore,e,this._key)}}class en{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new en(this.firestore,e,this._query)}}class Rr extends en{constructor(e,n,r){super(e,n,sc(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new He(this.firestore,null,new U(e))}withConverter(e){return new Rr(this.firestore,e,this._path)}}function $P(t,e,...n){if(t=N(t),uw("collection","path",e),t instanceof Ku){const r=we.fromString(e,...n);return ST(r),new Rr(t,null,r)}{if(!(t instanceof He||t instanceof Rr))throw new k(w.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(we.fromString(e,...n));return ST(r),new Rr(t.firestore,null,r)}}function NQ(t,e){if(t=Ie(t,Ku),uw("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new k(w.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new en(t,null,function(n){return new gs(we.emptyPath(),n)}(e))}function Md(t,e,...n){if(t=N(t),arguments.length===1&&(e=rN.I()),uw("doc","path",e),t instanceof Ku){const r=we.fromString(e,...n);return TT(r),new He(t,null,new U(r))}{if(!(t instanceof He||t instanceof Rr))throw new k(w.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(we.fromString(e,...n));return TT(r),new He(t.firestore,t instanceof Rr?t.converter:null,new U(r))}}function VP(t,e){return t=N(t),e=N(e),(t instanceof He||t instanceof Rr)&&(e instanceof He||e instanceof Rr)&&t.firestore===e.firestore&&t.path===e.path&&t.converter===e.converter}function BP(t,e){return t=N(t),e=N(e),t instanceof en&&e instanceof en&&t.firestore===e.firestore&&Uu(t._query,e._query)&&t.converter===e.converter}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PQ{constructor(){this.Oc=Promise.resolve(),this.Mc=[],this.Fc=!1,this.$c=[],this.Bc=null,this.Lc=!1,this.Uc=!1,this.qc=[],this.So=new Hv(this,"async_queue_retry"),this.Kc=()=>{const n=xh();n&&P("AsyncQueue","Visibility state changed to "+n.visibilityState),this.So.Eo()};const e=xh();e&&typeof e.addEventListener=="function"&&e.addEventListener("visibilitychange",this.Kc)}get isShuttingDown(){return this.Fc}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.Gc(),this.Qc(e)}enterRestrictedMode(e){if(!this.Fc){this.Fc=!0,this.Uc=e||!1;const n=xh();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.Kc)}}enqueue(e){if(this.Gc(),this.Fc)return new Promise(()=>{});const n=new kt;return this.Qc(()=>this.Fc&&this.Uc?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Mc.push(e),this.jc()))}async jc(){if(this.Mc.length!==0){try{await this.Mc[0](),this.Mc.shift(),this.So.reset()}catch(e){if(!fi(e))throw e;P("AsyncQueue","Operation failed with retryable error: "+e)}this.Mc.length>0&&this.So.Io(()=>this.jc())}}Qc(e){const n=this.Oc.then(()=>(this.Lc=!0,e().catch(r=>{this.Bc=r,this.Lc=!1;const s=function(i){let o=i.message||"";return i.stack&&(o=i.stack.includes(i.message)?i.stack:i.message+`
`+i.stack),o}(r);throw ft("INTERNAL UNHANDLED ERROR: ",s),r}).then(r=>(this.Lc=!1,r))));return this.Oc=n,n}enqueueAfterDelay(e,n,r){this.Gc(),this.qc.indexOf(e)>-1&&(n=0);const s=Qv.createAndSchedule(this,e,n,r,i=>this.Wc(i));return this.$c.push(s),s}Gc(){this.Bc&&G()}verifyOperationInProgress(){}async zc(){let e;do e=this.Oc,await e;while(e!==this.Oc)}Hc(e){for(const n of this.$c)if(n.timerId===e)return!0;return!1}Jc(e){return this.zc().then(()=>{this.$c.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.$c)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.zc()})}Yc(e){this.qc.push(e)}Wc(e){const n=this.$c.indexOf(e);this.$c.splice(n,1)}}function e_(t){return function(e,n){if(typeof e!="object"||e===null)return!1;const r=e;for(const s of n)if(s in r&&typeof r[s]=="function")return!0;return!1}(t,["next","error","complete"])}class DQ{constructor(){this._progressObserver={},this._taskCompletionResolver=new kt,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,n,r){this._progressObserver={next:e,error:n,complete:r}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,n){return this._taskCompletionResolver.promise.then(e,n)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xQ=-1;class ot extends Ku{constructor(e,n,r){super(e,n,r),this.type="firestore",this._queue=new PQ,this._persistenceKey="name"in e?e.name:"[DEFAULT]"}_terminate(){return this._firestoreClient||qP(this),this._firestoreClient.terminate()}}function Ft(t){return t._firestoreClient||qP(t),t._firestoreClient.verifyNotTerminated(),t._firestoreClient}function qP(t){var e;const n=t._freezeSettings(),r=function(s,i,o,a){return new K2(s,i,o,a.host,a.ssl,a.experimentalForceLongPolling,a.experimentalAutoDetectLongPolling,a.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,n);t._firestoreClient=new wQ(t._authCredentials,t._appCheckCredentials,t._queue,r)}function OQ(t,e){KP(t=Ie(t,ot));const n=Ft(t),r=t._freezeSettings(),s=new ow;return jP(n,s,new NP(s,r.cacheSizeBytes,e==null?void 0:e.forceOwnership))}function MQ(t){KP(t=Ie(t,ot));const e=Ft(t),n=t._freezeSettings(),r=new ow;return jP(e,r,new mQ(r,n.cacheSizeBytes))}function jP(t,e,n){const r=new kt;return t.asyncQueue.enqueue(async()=>{try{await PP(t,n),await DP(t,e),r.resolve()}catch(s){const i=s;if(!function(o){return o.name==="FirebaseError"?o.code===w.FAILED_PRECONDITION||o.code===w.UNIMPLEMENTED:typeof DOMException!="undefined"&&o instanceof DOMException?o.code===22||o.code===20||o.code===11:!0}(i))throw i;console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+i),r.reject(i)}}).then(()=>r.promise)}function LQ(t){if(t._initialized&&!t._terminated)throw new k(w.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");const e=new kt;return t._queue.enqueueAndForgetEvenWhileRestricted(async()=>{try{await async function(n){if(!ir.V())return Promise.resolve();const r=n+"main";await ir.delete(r)}(qv(t._databaseId,t._persistenceKey)),e.resolve()}catch(n){e.reject(n)}}),e.promise}function FQ(t){return function(e){const n=new kt;return e.asyncQueue.enqueueAndForget(async()=>sQ(await lw(e),n)),n.promise}(Ft(t=Ie(t,ot)))}function UQ(t){return bQ(Ft(t=Ie(t,ot)))}function $Q(t){return IQ(Ft(t=Ie(t,ot)))}function VQ(t,e){const n=Ft(t=Ie(t,ot)),r=new DQ;return AQ(n,t._databaseId,e,r),r}function BQ(t,e){return kQ(Ft(t=Ie(t,ot)),e).then(n=>n?new en(t,null,n.query):null)}function KP(t){if(t._initialized||t._terminated)throw new k(w.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ii{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new k(w.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new ct(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ur{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Ur(vt.fromBase64String(e))}catch(n){throw new k(w.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new Ur(vt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Do{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pp{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new k(w.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new k(w.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return ce(this._lat,e._lat)||ce(this._long,e._long)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qQ=/^__.*__$/;class jQ{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new ms(e,this.data,this.fieldMask,n,this.fieldTransforms):new ic(e,this.data,n,this.fieldTransforms)}}class HP{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new ms(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function WP(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw G()}}class gp{constructor(e,n,r,s,i,o){this.settings=e,this.databaseId=n,this.wt=r,this.ignoreUndefinedProperties=s,i===void 0&&this.Xc(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Zc(){return this.settings.Zc}ta(e){return new gp(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.wt,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}ea(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),s=this.ta({path:r,na:!1});return s.sa(e),s}ia(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),s=this.ta({path:r,na:!1});return s.Xc(),s}ra(e){return this.ta({path:void 0,na:!0})}oa(e){return Ld(e,this.settings.methodName,this.settings.ua||!1,this.path,this.settings.ca)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}Xc(){if(this.path)for(let e=0;e<this.path.length;e++)this.sa(this.path.get(e))}sa(e){if(e.length===0)throw this.oa("Document fields must not be empty");if(WP(this.Zc)&&qQ.test(e))throw this.oa('Document fields cannot begin and end with "__"')}}class KQ{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.wt=r||qu(e)}aa(e,n,r,s=!1){return new gp({Zc:e,methodName:n,ca:r,path:ct.emptyPath(),na:!1,ua:s},this.databaseId,this.wt,this.ignoreUndefinedProperties)}}function xo(t){const e=t._freezeSettings(),n=qu(t._databaseId);return new KQ(t._databaseId,!!e.ignoreUndefinedProperties,n)}function mp(t,e,n,r,s,i={}){const o=t.aa(i.merge||i.mergeFields?2:0,e,n,s);pw("Data must be an object, but it was:",o,r);const a=QP(r,o);let c,l;if(i.merge)c=new Pn(o.fieldMask),l=o.fieldTransforms;else if(i.mergeFields){const u=[];for(const h of i.mergeFields){const d=t_(e,h,n);if(!o.contains(d))throw new k(w.INVALID_ARGUMENT,`Field '${d}' is specified in your field mask but missing from your input data.`);JP(u,d)||u.push(d)}c=new Pn(u),l=o.fieldTransforms.filter(h=>c.covers(h.field))}else c=null,l=o.fieldTransforms;return new jQ(new Bt(a),c,l)}class Hu extends Do{_toFieldTransform(e){if(e.Zc!==2)throw e.Zc===1?e.oa(`${this._methodName}() can only appear at the top level of your update data`):e.oa(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Hu}}function GP(t,e,n){return new gp({Zc:3,ca:e.settings.ca,methodName:t._methodName,na:n},e.databaseId,e.wt,e.ignoreUndefinedProperties)}class hw extends Do{_toFieldTransform(e){return new $u(e.path,new xa)}isEqual(e){return e instanceof hw}}class HQ extends Do{constructor(e,n){super(e),this.ha=n}_toFieldTransform(e){const n=GP(this,e,!0),r=this.ha.map(i=>Oo(i,n)),s=new po(r);return new $u(e.path,s)}isEqual(e){return this===e}}class WQ extends Do{constructor(e,n){super(e),this.ha=n}_toFieldTransform(e){const n=GP(this,e,!0),r=this.ha.map(i=>Oo(i,n)),s=new go(r);return new $u(e.path,s)}isEqual(e){return this===e}}class GQ extends Do{constructor(e,n){super(e),this.la=n}_toFieldTransform(e){const n=new Oa(e.wt,EN(e.wt,this.la));return new $u(e.path,n)}isEqual(e){return this===e}}function dw(t,e,n,r){const s=t.aa(1,e,n);pw("Data must be an object, but it was:",s,r);const i=[],o=Bt.empty();Po(r,(c,l)=>{const u=gw(e,c,n);l=N(l);const h=s.ia(u);if(l instanceof Hu)i.push(u);else{const d=Oo(l,h);d!=null&&(i.push(u),o.set(u,d))}});const a=new Pn(i);return new HP(o,a,s.fieldTransforms)}function fw(t,e,n,r,s,i){const o=t.aa(1,e,n),a=[t_(e,r,n)],c=[s];if(i.length%2!=0)throw new k(w.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let d=0;d<i.length;d+=2)a.push(t_(e,i[d])),c.push(i[d+1]);const l=[],u=Bt.empty();for(let d=a.length-1;d>=0;--d)if(!JP(l,a[d])){const f=a[d];let p=c[d];p=N(p);const _=o.ia(f);if(p instanceof Hu)l.push(f);else{const y=Oo(p,_);y!=null&&(l.push(f),u.set(f,y))}}const h=new Pn(l);return new HP(u,h,o.fieldTransforms)}function zP(t,e,n,r=!1){return Oo(n,t.aa(r?4:3,e))}function Oo(t,e){if(YP(t=N(t)))return pw("Unsupported field value:",e,t),QP(t,e);if(t instanceof Do)return function(n,r){if(!WP(r.Zc))throw r.oa(`${n._methodName}() can only be used with update() and set()`);if(!r.path)throw r.oa(`${n._methodName}() is not currently supported inside arrays`);const s=n._toFieldTransform(r);s&&r.fieldTransforms.push(s)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.na&&e.Zc!==4)throw e.oa("Nested arrays are not supported");return function(n,r){const s=[];let i=0;for(const o of n){let a=Oo(o,r.ra(i));a==null&&(a={nullValue:"NULL_VALUE"}),s.push(a),i++}return{arrayValue:{values:s}}}(t,e)}return function(n,r){if((n=N(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return EN(r.wt,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const s=Ye.fromDate(n);return{timestampValue:Xl(r.wt,s)}}if(n instanceof Ye){const s=new Ye(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:Xl(r.wt,s)}}if(n instanceof pp)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof Ur)return{bytesValue:FN(r.wt,n._byteString)};if(n instanceof He){const s=r.databaseId,i=n.firestore._databaseId;if(!i.isEqual(s))throw r.oa(`Document reference is for database ${i.projectId}/${i.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:Ov(n.firestore._databaseId||r.databaseId,n._key.path)}}throw r.oa(`Unsupported field value: ${fp(n)}`)}(t,e)}function QP(t,e){const n={};return uN(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Po(t,(r,s)=>{const i=Oo(s,e.ea(r));i!=null&&(n[r]=i)}),{mapValue:{fields:n}}}function YP(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof Ye||t instanceof pp||t instanceof Ur||t instanceof He||t instanceof Do)}function pw(t,e,n){if(!YP(n)||!function(r){return typeof r=="object"&&r!==null&&(Object.getPrototypeOf(r)===Object.prototype||Object.getPrototypeOf(r)===null)}(n)){const r=fp(n);throw r==="an object"?e.oa(t+" a custom object"):e.oa(t+" "+r)}}function t_(t,e,n){if((e=N(e))instanceof ii)return e._internalPath;if(typeof e=="string")return gw(t,e);throw Ld("Field path arguments must be of type string or ",t,!1,void 0,n)}const zQ=new RegExp("[~\\*/\\[\\]]");function gw(t,e,n){if(e.search(zQ)>=0)throw Ld(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new ii(...e.split("."))._internalPath}catch{throw Ld(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function Ld(t,e,n,r,s){const i=r&&!r.isEmpty(),o=s!==void 0;let a=`Function ${e}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(i||o)&&(c+=" (found",i&&(c+=` in field ${r}`),o&&(c+=` in document ${s}`),c+=")"),new k(w.INVALID_ARGUMENT,a+t+c)}function JP(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ru{constructor(e,n,r,s,i){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new He(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new QQ(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(_p("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class QQ extends ru{data(){return super.data()}}function _p(t,e){return typeof e=="string"?gw(t,e):e instanceof ii?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bi{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class hs extends ru{constructor(e,n,r,s,i,o){super(e,n,r,s,o),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new ol(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(_p("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}}class ol extends hs{data(e={}){return super.data(e)}}class oi{constructor(e,n,r,s){this._firestore=e,this._userDataWriter=n,this._snapshot=s,this.metadata=new Bi(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new ol(this._firestore,this._userDataWriter,r.key,r,new Bi(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new k(w.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(r,s){if(r._snapshot.oldDocs.isEmpty()){let i=0;return r._snapshot.docChanges.map(o=>({type:"added",doc:new ol(r._firestore,r._userDataWriter,o.doc.key,o.doc,new Bi(r._snapshot.mutatedKeys.has(o.doc.key),r._snapshot.fromCache),r.query.converter),oldIndex:-1,newIndex:i++}))}{let i=r._snapshot.oldDocs;return r._snapshot.docChanges.filter(o=>s||o.type!==3).map(o=>{const a=new ol(r._firestore,r._userDataWriter,o.doc.key,o.doc,new Bi(r._snapshot.mutatedKeys.has(o.doc.key),r._snapshot.fromCache),r.query.converter);let c=-1,l=-1;return o.type!==0&&(c=i.indexOf(o.doc.key),i=i.delete(o.doc.key)),o.type!==1&&(i=i.add(o.doc),l=i.indexOf(o.doc.key)),{type:YQ(o.type),doc:a,oldIndex:c,newIndex:l}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}}function YQ(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return G()}}function XP(t,e){return t instanceof hs&&e instanceof hs?t._firestore===e._firestore&&t._key.isEqual(e._key)&&(t._document===null?e._document===null:t._document.isEqual(e._document))&&t._converter===e._converter:t instanceof oi&&e instanceof oi&&t._firestore===e._firestore&&BP(t.query,e.query)&&t.metadata.isEqual(e.metadata)&&t._snapshot.isEqual(e._snapshot)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ZP(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new k(w.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Wu{}function Cs(t,...e){for(const n of e)t=n._apply(t);return t}class JQ extends Wu{constructor(e,n,r){super(),this.fa=e,this.da=n,this._a=r,this.type="where"}_apply(e){const n=xo(e.firestore),r=function(s,i,o,a,c,l,u){let h;if(c.isKeyField()){if(l==="array-contains"||l==="array-contains-any")throw new k(w.INVALID_ARGUMENT,`Invalid Query. You can't perform '${l}' queries on documentId().`);if(l==="in"||l==="not-in"){kT(u,l);const f=[];for(const p of u)f.push(AT(a,s,p));h={arrayValue:{values:f}}}else h=AT(a,s,u)}else l!=="in"&&l!=="not-in"&&l!=="array-contains-any"||kT(u,l),h=zP(o,i,u,l==="in"||l==="not-in");const d=qt.create(c,l,h);return function(f,p){if(p.ht()){const y=Nv(f);if(y!==null&&!y.isEqual(p.field))throw new k(w.INVALID_ARGUMENT,`Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '${y.toString()}' and '${p.field.toString()}'`);const T=Rv(f);T!==null&&sD(f,p.field,T)}const _=function(y,T){for(const I of y.filters)if(T.indexOf(I.op)>=0)return I.op;return null}(f,function(y){switch(y){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}(p.op));if(_!==null)throw _===p.op?new k(w.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${p.op.toString()}' filter.`):new k(w.INVALID_ARGUMENT,`Invalid query. You cannot use '${p.op.toString()}' filters with '${_.toString()}' filters.`)}(s,d),d}(e._query,"where",n,e.firestore._databaseId,this.fa,this.da,this._a);return new en(e.firestore,e.converter,function(s,i){const o=s.filters.concat([i]);return new gs(s.path,s.collectionGroup,s.explicitOrderBy.slice(),o,s.limit,s.limitType,s.startAt,s.endAt)}(e._query,r))}}function XQ(t,e,n){const r=e,s=_p("where",t);return new JQ(s,r,n)}class ZQ extends Wu{constructor(e,n){super(),this.fa=e,this.wa=n,this.type="orderBy"}_apply(e){const n=function(r,s,i){if(r.startAt!==null)throw new k(w.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(r.endAt!==null)throw new k(w.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");const o=new ua(s,i);return function(a,c){if(Rv(a)===null){const l=Nv(a);l!==null&&sD(a,l,c.field)}}(r,o),o}(e._query,this.fa,this.wa);return new en(e.firestore,e.converter,function(r,s){const i=r.explicitOrderBy.concat([s]);return new gs(r.path,r.collectionGroup,i,r.filters.slice(),r.limit,r.limitType,r.startAt,r.endAt)}(e._query,n))}}function e3(t,e="asc"){const n=e,r=_p("orderBy",t);return new ZQ(r,n)}class eD extends Wu{constructor(e,n,r){super(),this.type=e,this.ma=n,this.ga=r}_apply(e){return new en(e.firestore,e.converter,_N(e._query,this.ma,this.ga))}}function t3(t){return UP("limit",t),new eD("limit",t,"F")}function n3(t){return UP("limitToLast",t),new eD("limitToLast",t,"L")}class tD extends Wu{constructor(e,n,r){super(),this.type=e,this.ya=n,this.pa=r}_apply(e){const n=rD(e,this.type,this.ya,this.pa);return new en(e.firestore,e.converter,function(r,s){return new gs(r.path,r.collectionGroup,r.explicitOrderBy.slice(),r.filters.slice(),r.limit,r.limitType,s,r.endAt)}(e._query,n))}}function r3(...t){return new tD("startAt",t,!0)}function s3(...t){return new tD("startAfter",t,!1)}class nD extends Wu{constructor(e,n,r){super(),this.type=e,this.ya=n,this.pa=r}_apply(e){const n=rD(e,this.type,this.ya,this.pa);return new en(e.firestore,e.converter,function(r,s){return new gs(r.path,r.collectionGroup,r.explicitOrderBy.slice(),r.filters.slice(),r.limit,r.limitType,r.startAt,s)}(e._query,n))}}function i3(...t){return new nD("endBefore",t,!1)}function o3(...t){return new nD("endAt",t,!0)}function rD(t,e,n,r){if(n[0]=N(n[0]),n[0]instanceof ru)return function(s,i,o,a,c){if(!a)throw new k(w.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${o}().`);const l=[];for(const u of Da(s))if(u.field.isKeyField())l.push(ho(i,a.key));else{const h=a.data.field(u.field);if(kv(h))throw new k(w.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+u.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(h===null){const d=u.field.canonicalString();throw new k(w.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${d}' (used as the orderBy) does not exist.`)}l.push(h)}return new ri(l,c)}(t._query,t.firestore._databaseId,e,n[0]._document,r);{const s=xo(t.firestore);return function(i,o,a,c,l,u){const h=i.explicitOrderBy;if(l.length>h.length)throw new k(w.INVALID_ARGUMENT,`Too many arguments provided to ${c}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const d=[];for(let f=0;f<l.length;f++){const p=l[f];if(h[f].field.isKeyField()){if(typeof p!="string")throw new k(w.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${c}(), but got a ${typeof p}`);if(!Pv(i)&&p.indexOf("/")!==-1)throw new k(w.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${c}() must be a plain document ID, but '${p}' contains a slash.`);const _=i.path.child(we.fromString(p));if(!U.isDocumentKey(_))throw new k(w.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${c}() must result in a valid document path, but '${_}' is not because it contains an odd number of segments.`);const y=new U(_);d.push(ho(o,y))}else{const _=zP(a,c,p);d.push(_)}}return new ri(d,u)}(t._query,t.firestore._databaseId,s,e,n,r)}}function AT(t,e,n){if(typeof(n=N(n))=="string"){if(n==="")throw new k(w.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Pv(e)&&n.indexOf("/")!==-1)throw new k(w.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(we.fromString(n));if(!U.isDocumentKey(r))throw new k(w.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return ho(t,new U(r))}if(n instanceof He)return ho(t,n._key);throw new k(w.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${fp(n)}.`)}function kT(t,e){if(!Array.isArray(t)||t.length===0)throw new k(w.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`);if(t.length>10)throw new k(w.INVALID_ARGUMENT,`Invalid Query. '${e.toString()}' filters support a maximum of 10 elements in the value array.`)}function sD(t,e,n){if(!n.isEqual(e))throw new k(w.INVALID_ARGUMENT,`Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '${e.toString()}' and so you must also use '${e.toString()}' as your first argument to orderBy(), but your first orderBy() is on field '${n.toString()}' instead.`)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const a3={maxAttempts:5};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mw{convertValue(e,n="none"){switch(uo(e)){case 0:return null;case 1:return e.booleanValue;case 2:return nt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(lo(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 10:return this.convertObject(e.mapValue,n);default:throw G()}}convertObject(e,n){const r={};return Po(e.fields,(s,i)=>{r[s]=this.convertValue(i,n)}),r}convertGeoPoint(e){return new pp(nt(e.latitude),nt(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=hN(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(zl(e));default:return null}}convertTimestamp(e){const n=ti(e);return new Ye(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=we.fromString(e);ie(WN(r));const s=new us(r.get(1),r.get(3)),i=new U(r.popFirst(5));return s.isEqual(n)||ft(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yp(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}class c3 extends mw{constructor(e){super(),this.firestore=e}convertBytes(e){return new Ur(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new He(this.firestore,null,n)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l3{constructor(e,n){this._firestore=e,this._commitHandler=n,this._mutations=[],this._committed=!1,this._dataReader=xo(e)}set(e,n,r){this._verifyNotCommitted();const s=xs(e,this._firestore),i=yp(s.converter,n,r),o=mp(this._dataReader,"WriteBatch.set",s._key,i,s.converter!==null,r);return this._mutations.push(o.toMutation(s._key,Xe.none())),this}update(e,n,r,...s){this._verifyNotCommitted();const i=xs(e,this._firestore);let o;return o=typeof(n=N(n))=="string"||n instanceof ii?fw(this._dataReader,"WriteBatch.update",i._key,n,r,s):dw(this._dataReader,"WriteBatch.update",i._key,n),this._mutations.push(o.toMutation(i._key,Xe.exists(!0))),this}delete(e){this._verifyNotCommitted();const n=xs(e,this._firestore);return this._mutations=this._mutations.concat(new oc(n._key,Xe.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new k(w.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function xs(t,e){if((t=N(t)).firestore!==e)throw new k(w.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function u3(t){t=Ie(t,He);const e=Ie(t.firestore,ot);return MP(Ft(e),t._key).then(n=>_w(e,t,n))}class Mo extends mw{constructor(e){super(),this.firestore=e}convertBytes(e){return new Ur(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new He(this.firestore,null,n)}}function h3(t){t=Ie(t,He);const e=Ie(t.firestore,ot),n=Ft(e),r=new Mo(e);return EQ(n,t._key).then(s=>new hs(e,r,t._key,s,new Bi(s!==null&&s.hasLocalMutations,!0),t.converter))}function d3(t){t=Ie(t,He);const e=Ie(t.firestore,ot);return MP(Ft(e),t._key,{source:"server"}).then(n=>_w(e,t,n))}function f3(t){t=Ie(t,en);const e=Ie(t.firestore,ot),n=Ft(e),r=new Mo(e);return ZP(t._query),LP(n,t._query).then(s=>new oi(e,r,t,s))}function p3(t){t=Ie(t,en);const e=Ie(t.firestore,ot),n=Ft(e),r=new Mo(e);return TQ(n,t._query).then(s=>new oi(e,r,t,s))}function g3(t){t=Ie(t,en);const e=Ie(t.firestore,ot),n=Ft(e),r=new Mo(e);return LP(n,t._query,{source:"server"}).then(s=>new oi(e,r,t,s))}function RT(t,e,n){t=Ie(t,He);const r=Ie(t.firestore,ot),s=yp(t.converter,e,n);return Gu(r,[mp(xo(r),"setDoc",t._key,s,t.converter!==null,n).toMutation(t._key,Xe.none())])}function NT(t,e,n,...r){t=Ie(t,He);const s=Ie(t.firestore,ot),i=xo(s);let o;return o=typeof(e=N(e))=="string"||e instanceof ii?fw(i,"updateDoc",t._key,e,n,r):dw(i,"updateDoc",t._key,e),Gu(s,[o.toMutation(t._key,Xe.exists(!0))])}function m3(t){return Gu(Ie(t.firestore,ot),[new oc(t._key,Xe.none())])}function _3(t,e){const n=Ie(t.firestore,ot),r=Md(t),s=yp(t.converter,e);return Gu(n,[mp(xo(t.firestore),"addDoc",r._key,s,t.converter!==null,{}).toMutation(r._key,Xe.exists(!1))]).then(()=>r)}function iD(t,...e){var n,r,s;t=N(t);let i={includeMetadataChanges:!1},o=0;typeof e[o]!="object"||e_(e[o])||(i=e[o],o++);const a={includeMetadataChanges:i.includeMetadataChanges};if(e_(e[o])){const h=e[o];e[o]=(n=h.next)===null||n===void 0?void 0:n.bind(h),e[o+1]=(r=h.error)===null||r===void 0?void 0:r.bind(h),e[o+2]=(s=h.complete)===null||s===void 0?void 0:s.bind(h)}let c,l,u;if(t instanceof He)l=Ie(t.firestore,ot),u=sc(t._key.path),c={next:h=>{e[o]&&e[o](_w(l,t,h))},error:e[o+1],complete:e[o+2]};else{const h=Ie(t,en);l=Ie(h.firestore,ot),u=h._query;const d=new Mo(l);c={next:f=>{e[o]&&e[o](new oi(l,d,h,f))},error:e[o+1],complete:e[o+2]},ZP(t._query)}return function(h,d,f,p){const _=new hp(p),y=new Zv(d,_,f);return h.asyncQueue.enqueueAndForget(async()=>Yv(await $a(h),y)),()=>{_.Tc(),h.asyncQueue.enqueueAndForget(async()=>Jv(await $a(h),y))}}(Ft(l),u,a,c)}function y3(t,e){return SQ(Ft(t=Ie(t,ot)),e_(e)?e:{next:e})}function Gu(t,e){return function(n,r){const s=new kt;return n.asyncQueue.enqueueAndForget(async()=>eQ(await lw(n),r,s)),s.promise}(Ft(t),e)}function _w(t,e,n){const r=n.docs.get(e._key),s=new Mo(t);return new hs(t,s,e._key,r,new Bi(n.hasPendingWrites,n.fromCache),e.converter)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class v3 extends class{constructor(e,n){this._firestore=e,this._transaction=n,this._dataReader=xo(e)}get(e){const n=xs(e,this._firestore),r=new c3(this._firestore);return this._transaction.lookup([n._key]).then(s=>{if(!s||s.length!==1)return G();const i=s[0];if(i.isFoundDocument())return new ru(this._firestore,r,i.key,i,n.converter);if(i.isNoDocument())return new ru(this._firestore,r,n._key,null,n.converter);throw G()})}set(e,n,r){const s=xs(e,this._firestore),i=yp(s.converter,n,r),o=mp(this._dataReader,"Transaction.set",s._key,i,s.converter!==null,r);return this._transaction.set(s._key,o),this}update(e,n,r,...s){const i=xs(e,this._firestore);let o;return o=typeof(n=N(n))=="string"||n instanceof ii?fw(this._dataReader,"Transaction.update",i._key,n,r,s):dw(this._dataReader,"Transaction.update",i._key,n),this._transaction.update(i._key,o),this}delete(e){const n=xs(e,this._firestore);return this._transaction.delete(n._key),this}}{constructor(e,n){super(e,n),this._firestore=e}get(e){const n=xs(e,this._firestore),r=new Mo(this._firestore);return super.get(e).then(s=>new hs(this._firestore,r,n._key,s._document,new Bi(!1,!1),n.converter))}}function w3(t,e,n){t=Ie(t,ot);const r=Object.assign(Object.assign({},a3),n);return function(s){if(s.maxAttempts<1)throw new k(w.INVALID_ARGUMENT,"Max attempts must be at least 1")}(r),CQ(Ft(t),s=>e(new v3(t,s)),r)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function b3(){return new Hu("deleteField")}function I3(){return new hw("serverTimestamp")}function E3(...t){return new HQ("arrayUnion",t)}function T3(...t){return new WQ("arrayRemove",t)}function S3(t){return new GQ("increment",t)}(function(t,e=!0){(function(n){rc=n})(Br),st(new Ee("firestore",(n,{options:r})=>{const s=n.getProvider("app").getImmediate(),i=new ot(s,new N2(n.getProvider("auth-internal")),new O2(n.getProvider("app-check-internal")));return r=Object.assign({useFetchStreams:e},r),i._setSettings(r),i},"PUBLIC")),Fe(kE,"3.4.12",t),Fe(kE,"3.4.12","esm2017")})();const C3="@firebase/firestore-compat",A3="0.1.21";/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yw(t,e){if(e===void 0)return{merge:!1};if(e.mergeFields!==void 0&&e.merge!==void 0)throw new k("invalid-argument",`Invalid options passed to function ${t}(): You cannot specify both "merge" and "mergeFields".`);return e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PT(){if(typeof Uint8Array=="undefined")throw new k("unimplemented","Uint8Arrays are not available in this environment.")}function DT(){if(!q2())throw new k("unimplemented","Blobs are unavailable in Firestore in this environment.")}class su{constructor(e){this._delegate=e}static fromBase64String(e){return DT(),new su(Ur.fromBase64String(e))}static fromUint8Array(e){return PT(),new su(Ur.fromUint8Array(e))}toBase64(){return DT(),this._delegate.toBase64()}toUint8Array(){return PT(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function n_(t){return k3(t,["next","error","complete"])}function k3(t,e){if(typeof t!="object"||t===null)return!1;const n=t;for(const r of e)if(r in n&&typeof n[r]=="function")return!0;return!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R3{enableIndexedDbPersistence(e,n){return OQ(e._delegate,{forceOwnership:n})}enableMultiTabIndexedDbPersistence(e){return MQ(e._delegate)}clearIndexedDbPersistence(e){return LQ(e._delegate)}}class oD{constructor(e,n,r){this._delegate=n,this._persistenceProvider=r,this.INTERNAL={delete:()=>this.terminate()},e instanceof us||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){const n=this._delegate._getSettings();!e.merge&&n.host!==e.host&&Wl("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&(e=Object.assign(Object.assign({},n),e),delete e.merge),this._delegate._setSettings(e)}useEmulator(e,n,r={}){RQ(this._delegate,e,n,r)}enableNetwork(){return UQ(this._delegate)}disableNetwork(){return $Q(this._delegate)}enablePersistence(e){let n=!1,r=!1;return e&&(n=!!e.synchronizeTabs,r=!!e.experimentalForceOwningTab,FP("synchronizeTabs",n,"experimentalForceOwningTab",r)),n?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,r)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return FQ(this._delegate)}onSnapshotsInSync(e){return y3(this._delegate,e)}get app(){if(!this._appCompat)throw new k("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new Va(this,$P(this._delegate,e))}catch(n){throw sn(n,"collection()","Firestore.collection()")}}doc(e){try{return new jn(this,Md(this._delegate,e))}catch(n){throw sn(n,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new rn(this,NQ(this._delegate,e))}catch(n){throw sn(n,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return w3(this._delegate,n=>e(new aD(this,n)))}batch(){return Ft(this._delegate),new cD(new l3(this._delegate,e=>Gu(this._delegate,e)))}loadBundle(e){return VQ(this._delegate,e)}namedQuery(e){return BQ(this._delegate,e).then(n=>n?new rn(this,n):null)}}class vp extends mw{constructor(e){super(),this.firestore=e}convertBytes(e){return new su(new Ur(e))}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return jn.forKey(n,this.firestore,null)}}function N3(t){C2(t)}class aD{constructor(e,n){this._firestore=e,this._delegate=n,this._userDataWriter=new vp(e)}get(e){const n=qi(e);return this._delegate.get(n).then(r=>new iu(this._firestore,new hs(this._firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,n.converter)))}set(e,n,r){const s=qi(e);return r?(yw("Transaction.set",r),this._delegate.set(s,n,r)):this._delegate.set(s,n),this}update(e,n,r,...s){const i=qi(e);return arguments.length===2?this._delegate.update(i,n):this._delegate.update(i,n,r,...s),this}delete(e){const n=qi(e);return this._delegate.delete(n),this}}class cD{constructor(e){this._delegate=e}set(e,n,r){const s=qi(e);return r?(yw("WriteBatch.set",r),this._delegate.set(s,n,r)):this._delegate.set(s,n),this}update(e,n,r,...s){const i=qi(e);return arguments.length===2?this._delegate.update(i,n):this._delegate.update(i,n,r,...s),this}delete(e){const n=qi(e);return this._delegate.delete(n),this}commit(){return this._delegate.commit()}}class vo{constructor(e,n,r){this._firestore=e,this._userDataWriter=n,this._delegate=r}fromFirestore(e,n){const r=new ol(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new ou(this._firestore,r),n!=null?n:{})}toFirestore(e,n){return n?this._delegate.toFirestore(e,n):this._delegate.toFirestore(e)}static getInstance(e,n){const r=vo.INSTANCES;let s=r.get(e);s||(s=new WeakMap,r.set(e,s));let i=s.get(n);return i||(i=new vo(e,new vp(e),n),s.set(n,i)),i}}vo.INSTANCES=new WeakMap;class jn{constructor(e,n){this.firestore=e,this._delegate=n,this._userDataWriter=new vp(e)}static forPath(e,n,r){if(e.length%2!==0)throw new k("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new jn(n,new He(n._delegate,r,new U(e)))}static forKey(e,n,r){return new jn(n,new He(n._delegate,r,e))}get id(){return this._delegate.id}get parent(){return new Va(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new Va(this.firestore,$P(this._delegate,e))}catch(n){throw sn(n,"collection()","DocumentReference.collection()")}}isEqual(e){return e=N(e),e instanceof He?VP(this._delegate,e):!1}set(e,n){n=yw("DocumentReference.set",n);try{return n?RT(this._delegate,e,n):RT(this._delegate,e)}catch(r){throw sn(r,"setDoc()","DocumentReference.set()")}}update(e,n,...r){try{return arguments.length===1?NT(this._delegate,e):NT(this._delegate,e,n,...r)}catch(s){throw sn(s,"updateDoc()","DocumentReference.update()")}}delete(){return m3(this._delegate)}onSnapshot(...e){const n=lD(e),r=uD(e,s=>new iu(this.firestore,new hs(this.firestore._delegate,this._userDataWriter,s._key,s._document,s.metadata,this._delegate.converter)));return iD(this._delegate,n,r)}get(e){let n;return(e==null?void 0:e.source)==="cache"?n=h3(this._delegate):(e==null?void 0:e.source)==="server"?n=d3(this._delegate):n=u3(this._delegate),n.then(r=>new iu(this.firestore,new hs(this.firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,this._delegate.converter)))}withConverter(e){return new jn(this.firestore,e?this._delegate.withConverter(vo.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}function sn(t,e,n){return t.message=t.message.replace(e,n),t}function lD(t){for(const e of t)if(typeof e=="object"&&!n_(e))return e;return{}}function uD(t,e){var n,r;let s;return n_(t[0])?s=t[0]:n_(t[1])?s=t[1]:typeof t[0]=="function"?s={next:t[0],error:t[1],complete:t[2]}:s={next:t[1],error:t[2],complete:t[3]},{next:i=>{s.next&&s.next(e(i))},error:(n=s.error)===null||n===void 0?void 0:n.bind(s),complete:(r=s.complete)===null||r===void 0?void 0:r.bind(s)}}class iu{constructor(e,n){this._firestore=e,this._delegate=n}get ref(){return new jn(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,n){return this._delegate.get(e,n)}isEqual(e){return XP(this._delegate,e._delegate)}}class ou extends iu{data(e){const n=this._delegate.data(e);return A2(n!==void 0),n}}class rn{constructor(e,n){this.firestore=e,this._delegate=n,this._userDataWriter=new vp(e)}where(e,n,r){try{return new rn(this.firestore,Cs(this._delegate,XQ(e,n,r)))}catch(s){throw sn(s,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,n){try{return new rn(this.firestore,Cs(this._delegate,e3(e,n)))}catch(r){throw sn(r,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new rn(this.firestore,Cs(this._delegate,t3(e)))}catch(n){throw sn(n,"limit()","Query.limit()")}}limitToLast(e){try{return new rn(this.firestore,Cs(this._delegate,n3(e)))}catch(n){throw sn(n,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new rn(this.firestore,Cs(this._delegate,r3(...e)))}catch(n){throw sn(n,"startAt()","Query.startAt()")}}startAfter(...e){try{return new rn(this.firestore,Cs(this._delegate,s3(...e)))}catch(n){throw sn(n,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new rn(this.firestore,Cs(this._delegate,i3(...e)))}catch(n){throw sn(n,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new rn(this.firestore,Cs(this._delegate,o3(...e)))}catch(n){throw sn(n,"endAt()","Query.endAt()")}}isEqual(e){return BP(this._delegate,e._delegate)}get(e){let n;return(e==null?void 0:e.source)==="cache"?n=p3(this._delegate):(e==null?void 0:e.source)==="server"?n=g3(this._delegate):n=f3(this._delegate),n.then(r=>new r_(this.firestore,new oi(this.firestore._delegate,this._userDataWriter,this._delegate,r._snapshot)))}onSnapshot(...e){const n=lD(e),r=uD(e,s=>new r_(this.firestore,new oi(this.firestore._delegate,this._userDataWriter,this._delegate,s._snapshot)));return iD(this._delegate,n,r)}withConverter(e){return new rn(this.firestore,e?this._delegate.withConverter(vo.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}class P3{constructor(e,n){this._firestore=e,this._delegate=n}get type(){return this._delegate.type}get doc(){return new ou(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}}class r_{constructor(e,n){this._firestore=e,this._delegate=n}get query(){return new rn(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(e=>new ou(this._firestore,e))}docChanges(e){return this._delegate.docChanges(e).map(n=>new P3(this._firestore,n))}forEach(e,n){this._delegate.forEach(r=>{e.call(n,new ou(this._firestore,r))})}isEqual(e){return XP(this._delegate,e._delegate)}}class Va extends rn{constructor(e,n){super(e,n),this.firestore=e,this._delegate=n}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){const e=this._delegate.parent;return e?new jn(this.firestore,e):null}doc(e){try{return e===void 0?new jn(this.firestore,Md(this._delegate)):new jn(this.firestore,Md(this._delegate,e))}catch(n){throw sn(n,"doc()","CollectionReference.doc()")}}add(e){return _3(this._delegate,e).then(n=>new jn(this.firestore,n))}isEqual(e){return VP(this._delegate,e._delegate)}withConverter(e){return new Va(this.firestore,e?this._delegate.withConverter(vo.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}function qi(t){return Ie(t,He)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vw{constructor(...e){this._delegate=new ii(...e)}static documentId(){return new vw(ct.keyField().canonicalString())}isEqual(e){return e=N(e),e instanceof ii?this._delegate._internalPath.isEqual(e._internalPath):!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oi{constructor(e){this._delegate=e}static serverTimestamp(){const e=I3();return e._methodName="FieldValue.serverTimestamp",new Oi(e)}static delete(){const e=b3();return e._methodName="FieldValue.delete",new Oi(e)}static arrayUnion(...e){const n=E3(...e);return n._methodName="FieldValue.arrayUnion",new Oi(n)}static arrayRemove(...e){const n=T3(...e);return n._methodName="FieldValue.arrayRemove",new Oi(n)}static increment(e){const n=S3(e);return n._methodName="FieldValue.increment",new Oi(n)}isEqual(e){return this._delegate.isEqual(e._delegate)}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const D3={Firestore:oD,GeoPoint:pp,Timestamp:Ye,Blob:su,Transaction:aD,WriteBatch:cD,DocumentReference:jn,DocumentSnapshot:iu,Query:rn,QueryDocumentSnapshot:ou,QuerySnapshot:r_,CollectionReference:Va,FieldPath:vw,FieldValue:Oi,setLogLevel:N3,CACHE_SIZE_UNLIMITED:xQ};function x3(t,e){t.INTERNAL.registerComponent(new Ee("firestore-compat",n=>{const r=n.getProvider("app-compat").getImmediate(),s=n.getProvider("firestore").getImmediate();return e(r,s)},"PUBLIC").setServiceProps(Object.assign({},D3)))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function O3(t){x3(t,(e,n)=>new oD(e,n,new R3)),t.registerVersion(C3,A3)}O3(ht);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const M3="type.googleapis.com/google.protobuf.Int64Value",L3="type.googleapis.com/google.protobuf.UInt64Value";function hD(t,e){const n={};for(const r in t)t.hasOwnProperty(r)&&(n[r]=e(t[r]));return n}function s_(t){if(t==null)return null;if(t instanceof Number&&(t=t.valueOf()),typeof t=="number"&&isFinite(t)||t===!0||t===!1||Object.prototype.toString.call(t)==="[object String]")return t;if(t instanceof Date)return t.toISOString();if(Array.isArray(t))return t.map(e=>s_(e));if(typeof t=="function"||typeof t=="object")return hD(t,e=>s_(e));throw new Error("Data cannot be encoded in JSON: "+t)}function Fd(t){if(t==null)return t;if(t["@type"])switch(t["@type"]){case M3:case L3:{const e=Number(t.value);if(isNaN(e))throw new Error("Data cannot be decoded from JSON: "+t);return e}default:throw new Error("Data cannot be decoded from JSON: "+t)}return Array.isArray(t)?t.map(e=>Fd(e)):typeof t=="function"||typeof t=="object"?hD(t,e=>Fd(e)):t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dD="functions";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xT={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class da extends ut{constructor(e,n,r){super(`${dD}/${e}`,n||""),this.details=r}}function F3(t){if(t>=200&&t<300)return"ok";switch(t){case 0:return"internal";case 400:return"invalid-argument";case 401:return"unauthenticated";case 403:return"permission-denied";case 404:return"not-found";case 409:return"aborted";case 429:return"resource-exhausted";case 499:return"cancelled";case 500:return"internal";case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline-exceeded"}return"unknown"}function U3(t,e){let n=F3(t),r=n,s;try{const i=e&&e.error;if(i){const o=i.status;if(typeof o=="string"){if(!xT[o])return new da("internal","internal");n=xT[o],r=o}const a=i.message;typeof a=="string"&&(r=a),s=i.details,s!==void 0&&(s=Fd(s))}}catch{}return n==="ok"?null:new da(n,r,s)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $3{constructor(e,n,r){this.auth=null,this.messaging=null,this.appCheck=null,this.auth=e.getImmediate({optional:!0}),this.messaging=n.getImmediate({optional:!0}),this.auth||e.get().then(s=>this.auth=s,()=>{}),this.messaging||n.get().then(s=>this.messaging=s,()=>{}),this.appCheck||r.get().then(s=>this.appCheck=s,()=>{})}async getAuthToken(){if(!!this.auth)try{const e=await this.auth.getToken();return e==null?void 0:e.accessToken}catch{return}}async getMessagingToken(){if(!(!this.messaging||!("Notification"in self)||Notification.permission!=="granted"))try{return await this.messaging.getToken()}catch{return}}async getAppCheckToken(){if(this.appCheck){const e=await this.appCheck.getToken();return e.error?null:e.token}return null}async getContext(){const e=await this.getAuthToken(),n=await this.getMessagingToken(),r=await this.getAppCheckToken();return{authToken:e,messagingToken:n,appCheckToken:r}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OT="us-central1";function V3(t){let e=null;return{promise:new Promise((n,r)=>{e=setTimeout(()=>{r(new da("deadline-exceeded","deadline-exceeded"))},t)}),cancel:()=>{e&&clearTimeout(e)}}}class B3{constructor(e,n,r,s,i=OT,o){this.app=e,this.fetchImpl=o,this.emulatorOrigin=null,this.contextProvider=new $3(n,r,s),this.cancelAllRequests=new Promise(a=>{this.deleteService=()=>Promise.resolve(a())});try{const a=new URL(i);this.customDomain=a.origin,this.region=OT}catch{this.customDomain=null,this.region=i}}_delete(){return this.deleteService()}_url(e){const n=this.app.options.projectId;return this.emulatorOrigin!==null?`${this.emulatorOrigin}/${n}/${this.region}/${e}`:this.customDomain!==null?`${this.customDomain}/${e}`:`https://${this.region}-${n}.cloudfunctions.net/${e}`}}function q3(t,e,n){t.emulatorOrigin=`http://${e}:${n}`}function j3(t,e,n){return r=>W3(t,e,r,n||{})}function K3(t,e,n){return r=>fD(t,e,r,n||{})}async function H3(t,e,n,r){n["Content-Type"]="application/json";let s;try{s=await r(t,{method:"POST",body:JSON.stringify(e),headers:n})}catch{return{status:0,json:null}}let i=null;try{i=await s.json()}catch{}return{status:s.status,json:i}}function W3(t,e,n,r){const s=t._url(e);return fD(t,s,n,r)}async function fD(t,e,n,r){n=s_(n);const s={data:n},i={},o=await t.contextProvider.getContext();o.authToken&&(i.Authorization="Bearer "+o.authToken),o.messagingToken&&(i["Firebase-Instance-ID-Token"]=o.messagingToken),o.appCheckToken!==null&&(i["X-Firebase-AppCheck"]=o.appCheckToken);const a=r.timeout||7e4,c=V3(a),l=await Promise.race([H3(e,s,i,t.fetchImpl),c.promise,t.cancelAllRequests]);if(c.cancel(),!l)throw new da("cancelled","Firebase Functions instance was deleted.");const u=U3(l.status,l.json);if(u)throw u;if(!l.json)throw new da("internal","Response is not valid JSON object.");let h=l.json.data;if(typeof h=="undefined"&&(h=l.json.result),typeof h=="undefined")throw new da("internal","Response is missing data field.");return{data:Fd(h)}}const MT="@firebase/functions",LT="0.8.4";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const G3="auth-internal",z3="app-check-internal",Q3="messaging-internal";function Y3(t,e){const n=(r,{instanceIdentifier:s})=>{const i=r.getProvider("app").getImmediate(),o=r.getProvider(G3),a=r.getProvider(Q3),c=r.getProvider(z3);return new B3(i,o,a,c,s,t)};st(new Ee(dD,n,"PUBLIC").setMultipleInstances(!0)),Fe(MT,LT,e),Fe(MT,LT,"esm2017")}function FT(t,e,n){q3(N(t),e,n)}function J3(t,e,n){return j3(N(t),e,n)}function X3(t,e,n){return K3(N(t),e,n)}Y3(fetch.bind(self));const Z3="@firebase/functions-compat",eY="0.2.4";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pD{constructor(e,n){this.app=e,this._delegate=n,this._region=this._delegate.region,this._customDomain=this._delegate.customDomain}httpsCallable(e,n){return J3(this._delegate,e,n)}httpsCallableFromURL(e,n){return X3(this._delegate,e,n)}useFunctionsEmulator(e){const n=e.match("[a-zA-Z]+://([a-zA-Z0-9.-]+)(?::([0-9]+))?");if(n==null)throw new ut("functions","No origin provided to useFunctionsEmulator()");if(n[2]==null)throw new ut("functions","Port missing in origin provided to useFunctionsEmulator()");return FT(this._delegate,n[1],Number(n[2]))}useEmulator(e,n){return FT(this._delegate,e,n)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tY="us-central1",nY=(t,{instanceIdentifier:e})=>{const n=t.getProvider("app-compat").getImmediate(),r=t.getProvider("functions").getImmediate({identifier:e!=null?e:tY});return new pD(n,r)};function rY(){const t={Functions:pD};ht.INTERNAL.registerComponent(new Ee("functions-compat",nY,"PUBLIC").setServiceProps(t).setMultipleInstances(!0))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */rY();ht.registerVersion(Z3,eY);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sY="/firebase-messaging-sw.js",iY="/firebase-cloud-messaging-push-scope",gD="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",oY="https://fcmregistrations.googleapis.com/v1",mD="google.c.a.c_id",aY="google.c.a.c_l",cY="google.c.a.ts",lY="google.c.a.e";var UT;(function(t){t[t.DATA_MESSAGE=1]="DATA_MESSAGE",t[t.DISPLAY_NOTIFICATION=3]="DISPLAY_NOTIFICATION"})(UT||(UT={}));/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License"); you may not use this file except
 * in compliance with the License. You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software distributed under the License
 * is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express
 * or implied. See the License for the specific language governing permissions and limitations under
 * the License.
 */var au;(function(t){t.PUSH_RECEIVED="push-received",t.NOTIFICATION_CLICKED="notification-clicked"})(au||(au={}));/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kr(t){const e=new Uint8Array(t);return btoa(String.fromCharCode(...e)).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function uY(t){const e="=".repeat((4-t.length%4)%4),n=(t+e).replace(/\-/g,"+").replace(/_/g,"/"),r=atob(n),s=new Uint8Array(r.length);for(let i=0;i<r.length;++i)s[i]=r.charCodeAt(i);return s}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mg="fcm_token_details_db",hY=5,$T="fcm_token_object_Store";async function dY(t){if("databases"in indexedDB&&!(await indexedDB.databases()).map(i=>i.name).includes(mg))return null;let e=null;return(await Wa(mg,hY,{upgrade:async(r,s,i,o)=>{var a;if(s<2||!r.objectStoreNames.contains($T))return;const c=o.objectStore($T),l=await c.index("fcmSenderId").get(t);if(await c.clear(),!!l){if(s===2){const u=l;if(!u.auth||!u.p256dh||!u.endpoint)return;e={token:u.fcmToken,createTime:(a=u.createTime)!==null&&a!==void 0?a:Date.now(),subscriptionOptions:{auth:u.auth,p256dh:u.p256dh,endpoint:u.endpoint,swScope:u.swScope,vapidKey:typeof u.vapidKey=="string"?u.vapidKey:Kr(u.vapidKey)}}}else if(s===3){const u=l;e={token:u.fcmToken,createTime:u.createTime,subscriptionOptions:{auth:Kr(u.auth),p256dh:Kr(u.p256dh),endpoint:u.endpoint,swScope:u.swScope,vapidKey:Kr(u.vapidKey)}}}else if(s===4){const u=l;e={token:u.fcmToken,createTime:u.createTime,subscriptionOptions:{auth:Kr(u.auth),p256dh:Kr(u.p256dh),endpoint:u.endpoint,swScope:u.swScope,vapidKey:Kr(u.vapidKey)}}}}}})).close(),await ra(mg),await ra("fcm_vapid_details_db"),await ra("undefined"),fY(e)?e:null}function fY(t){if(!t||!t.subscriptionOptions)return!1;const{subscriptionOptions:e}=t;return typeof t.createTime=="number"&&t.createTime>0&&typeof t.token=="string"&&t.token.length>0&&typeof e.auth=="string"&&e.auth.length>0&&typeof e.p256dh=="string"&&e.p256dh.length>0&&typeof e.endpoint=="string"&&e.endpoint.length>0&&typeof e.swScope=="string"&&e.swScope.length>0&&typeof e.vapidKey=="string"&&e.vapidKey.length>0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pY="firebase-messaging-database",gY=1,wo="firebase-messaging-store";let _g=null;function ww(){return _g||(_g=Wa(pY,gY,{upgrade:(t,e)=>{switch(e){case 0:t.createObjectStore(wo)}}})),_g}async function _D(t){const e=Iw(t),r=await(await ww()).transaction(wo).objectStore(wo).get(e);if(r)return r;{const s=await dY(t.appConfig.senderId);if(s)return await bw(t,s),s}}async function bw(t,e){const n=Iw(t),s=(await ww()).transaction(wo,"readwrite");return await s.objectStore(wo).put(e,n),await s.done,e}async function mY(t){const e=Iw(t),r=(await ww()).transaction(wo,"readwrite");await r.objectStore(wo).delete(e),await r.done}function Iw({appConfig:t}){return t.appId}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _Y={["missing-app-config-values"]:'Missing App configuration value: "{$valueName}"',["only-available-in-window"]:"This method is available in a Window context.",["only-available-in-sw"]:"This method is available in a service worker context.",["permission-default"]:"The notification permission was not granted and dismissed instead.",["permission-blocked"]:"The notification permission was not granted and blocked instead.",["unsupported-browser"]:"This browser doesn't support the API's required to use the Firebase SDK.",["indexed-db-unsupported"]:"This browser doesn't support indexedDb.open() (ex. Safari iFrame, Firefox Private Browsing, etc)",["failed-service-worker-registration"]:"We are unable to register the default service worker. {$browserErrorMessage}",["token-subscribe-failed"]:"A problem occurred while subscribing the user to FCM: {$errorInfo}",["token-subscribe-no-token"]:"FCM returned no token when subscribing the user to push.",["token-unsubscribe-failed"]:"A problem occurred while unsubscribing the user from FCM: {$errorInfo}",["token-update-failed"]:"A problem occurred while updating the user from FCM: {$errorInfo}",["token-update-no-token"]:"FCM returned no token when updating the user to push.",["use-sw-after-get-token"]:"The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.",["invalid-sw-registration"]:"The input to useServiceWorker() must be a ServiceWorkerRegistration.",["invalid-bg-handler"]:"The input to setBackgroundMessageHandler() must be a function.",["invalid-vapid-key"]:"The public VAPID key must be a string.",["use-vapid-key-after-get-token"]:"The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used."},fn=new pn("messaging","Messaging",_Y);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function yY(t,e){var n;const r=await Tw(t),s=vD(e),i={method:"POST",headers:r,body:JSON.stringify(s)};let o;try{o=await(await fetch(Ew(t.appConfig),i)).json()}catch(a){throw fn.create("token-subscribe-failed",{errorInfo:(n=a)===null||n===void 0?void 0:n.toString()})}if(o.error){const a=o.error.message;throw fn.create("token-subscribe-failed",{errorInfo:a})}if(!o.token)throw fn.create("token-subscribe-no-token");return o.token}async function vY(t,e){var n;const r=await Tw(t),s=vD(e.subscriptionOptions),i={method:"PATCH",headers:r,body:JSON.stringify(s)};let o;try{o=await(await fetch(`${Ew(t.appConfig)}/${e.token}`,i)).json()}catch(a){throw fn.create("token-update-failed",{errorInfo:(n=a)===null||n===void 0?void 0:n.toString()})}if(o.error){const a=o.error.message;throw fn.create("token-update-failed",{errorInfo:a})}if(!o.token)throw fn.create("token-update-no-token");return o.token}async function yD(t,e){var n;const r=await Tw(t),s={method:"DELETE",headers:r};try{const o=await(await fetch(`${Ew(t.appConfig)}/${e}`,s)).json();if(o.error){const a=o.error.message;throw fn.create("token-unsubscribe-failed",{errorInfo:a})}}catch(i){throw fn.create("token-unsubscribe-failed",{errorInfo:(n=i)===null||n===void 0?void 0:n.toString()})}}function Ew({projectId:t}){return`${oY}/projects/${t}/registrations`}async function Tw({appConfig:t,installations:e}){const n=await e.getToken();return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t.apiKey,"x-goog-firebase-installations-auth":`FIS ${n}`})}function vD({p256dh:t,auth:e,endpoint:n,vapidKey:r}){const s={web:{endpoint:n,auth:e,p256dh:t}};return r!==gD&&(s.web.applicationPubKey=r),s}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wY=7*24*60*60*1e3;async function bY(t){const e=await EY(t.swRegistration,t.vapidKey),n={vapidKey:t.vapidKey,swScope:t.swRegistration.scope,endpoint:e.endpoint,auth:Kr(e.getKey("auth")),p256dh:Kr(e.getKey("p256dh"))},r=await _D(t.firebaseDependencies);if(r){if(TY(r.subscriptionOptions,n))return Date.now()>=r.createTime+wY?IY(t,{token:r.token,createTime:Date.now(),subscriptionOptions:n}):r.token;try{await yD(t.firebaseDependencies,r.token)}catch(s){console.warn(s)}return VT(t.firebaseDependencies,n)}else return VT(t.firebaseDependencies,n)}async function wD(t){const e=await _D(t.firebaseDependencies);e&&(await yD(t.firebaseDependencies,e.token),await mY(t.firebaseDependencies));const n=await t.swRegistration.pushManager.getSubscription();return n?n.unsubscribe():!0}async function IY(t,e){try{const n=await vY(t.firebaseDependencies,e),r=Object.assign(Object.assign({},e),{token:n,createTime:Date.now()});return await bw(t.firebaseDependencies,r),n}catch(n){throw await wD(t),n}}async function VT(t,e){const r={token:await yY(t,e),createTime:Date.now(),subscriptionOptions:e};return await bw(t,r),r.token}async function EY(t,e){const n=await t.pushManager.getSubscription();return n||t.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:uY(e)})}function TY(t,e){const n=e.vapidKey===t.vapidKey,r=e.endpoint===t.endpoint,s=e.auth===t.auth,i=e.p256dh===t.p256dh;return n&&r&&s&&i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function BT(t){const e={from:t.from,collapseKey:t.collapse_key,messageId:t.fcmMessageId};return SY(e,t),CY(e,t),AY(e,t),e}function SY(t,e){if(!e.notification)return;t.notification={};const n=e.notification.title;n&&(t.notification.title=n);const r=e.notification.body;r&&(t.notification.body=r);const s=e.notification.image;s&&(t.notification.image=s)}function CY(t,e){!e.data||(t.data=e.data)}function AY(t,e){var n,r,s,i,o;if(!e.fcmOptions&&!(!((n=e.notification)===null||n===void 0)&&n.click_action))return;t.fcmOptions={};const a=(s=(r=e.fcmOptions)===null||r===void 0?void 0:r.link)!==null&&s!==void 0?s:(i=e.notification)===null||i===void 0?void 0:i.click_action;a&&(t.fcmOptions.link=a);const c=(o=e.fcmOptions)===null||o===void 0?void 0:o.analytics_label;c&&(t.fcmOptions.analyticsLabel=c)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kY(t){return typeof t=="object"&&!!t&&mD in t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */bD("hts/frbslgigp.ogepscmv/ieo/eaylg","tp:/ieaeogn-agolai.o/1frlglgc/o");bD("AzSCbw63g1R0nCw85jG8","Iaya3yLKwmgvh7cF0q4");function bD(t,e){const n=[];for(let r=0;r<t.length;r++)n.push(t.charAt(r)),r<e.length&&n.push(e.charAt(r));return n.join("")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function RY(t){if(!t||!t.options)throw yg("App Configuration Object");if(!t.name)throw yg("App Name");const e=["projectId","apiKey","appId","messagingSenderId"],{options:n}=t;for(const r of e)if(!n[r])throw yg(r);return{appName:t.name,projectId:n.projectId,apiKey:n.apiKey,appId:n.appId,senderId:n.messagingSenderId}}function yg(t){return fn.create("missing-app-config-values",{valueName:t})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NY{constructor(e,n,r){this.deliveryMetricsExportedToBigQueryEnabled=!1,this.onBackgroundMessageHandler=null,this.onMessageHandler=null,this.logEvents=[],this.isLogServiceStarted=!1;const s=RY(e);this.firebaseDependencies={app:e,appConfig:s,installations:n,analyticsProvider:r}}_delete(){return Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ID(t){var e;try{t.swRegistration=await navigator.serviceWorker.register(sY,{scope:iY}),t.swRegistration.update().catch(()=>{})}catch(n){throw fn.create("failed-service-worker-registration",{browserErrorMessage:(e=n)===null||e===void 0?void 0:e.message})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function PY(t,e){if(!e&&!t.swRegistration&&await ID(t),!(!e&&!!t.swRegistration)){if(!(e instanceof ServiceWorkerRegistration))throw fn.create("invalid-sw-registration");t.swRegistration=e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function DY(t,e){e?t.vapidKey=e:t.vapidKey||(t.vapidKey=gD)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ED(t,e){if(!navigator)throw fn.create("only-available-in-window");if(Notification.permission==="default"&&await Notification.requestPermission(),Notification.permission!=="granted")throw fn.create("permission-blocked");return await DY(t,e==null?void 0:e.vapidKey),await PY(t,e==null?void 0:e.serviceWorkerRegistration),bY(t)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function xY(t,e,n){const r=OY(e);(await t.firebaseDependencies.analyticsProvider.get()).logEvent(r,{message_id:n[mD],message_name:n[aY],message_time:n[cY],message_device_time:Math.floor(Date.now()/1e3)})}function OY(t){switch(t){case au.NOTIFICATION_CLICKED:return"notification_open";case au.PUSH_RECEIVED:return"notification_foreground";default:throw new Error}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function MY(t,e){const n=e.data;if(!n.isFirebaseMessaging)return;t.onMessageHandler&&n.messageType===au.PUSH_RECEIVED&&(typeof t.onMessageHandler=="function"?t.onMessageHandler(BT(n)):t.onMessageHandler.next(BT(n)));const r=n.data;kY(r)&&r[lY]==="1"&&await xY(t,n.messageType,r)}const qT="@firebase/messaging",jT="0.9.16";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LY=t=>{const e=new NY(t.getProvider("app").getImmediate(),t.getProvider("installations-internal").getImmediate(),t.getProvider("analytics-internal"));return navigator.serviceWorker.addEventListener("message",n=>MY(e,n)),e},FY=t=>{const e=t.getProvider("messaging").getImmediate();return{getToken:r=>ED(e,r)}};function UY(){st(new Ee("messaging",LY,"PUBLIC")),st(new Ee("messaging-internal",FY,"PRIVATE")),Fe(qT,jT),Fe(qT,jT,"esm2017")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function $Y(t){if(!navigator)throw fn.create("only-available-in-window");return t.swRegistration||await ID(t),wD(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VY(t,e){if(!navigator)throw fn.create("only-available-in-window");return t.onMessageHandler=e,()=>{t.onMessageHandler=null}}async function BY(t,e){return t=N(t),ED(t,e)}function qY(t){return t=N(t),$Y(t)}function jY(t,e){return t=N(t),VY(t,e)}UY();/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TD="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",KY="https://fcmregistrations.googleapis.com/v1",SD="FCM_MSG",HY="google.c.a.c_id",WY=3,GY=1;var Ud;(function(t){t[t.DATA_MESSAGE=1]="DATA_MESSAGE",t[t.DISPLAY_NOTIFICATION=3]="DISPLAY_NOTIFICATION"})(Ud||(Ud={}));/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License"); you may not use this file except
 * in compliance with the License. You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software distributed under the License
 * is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express
 * or implied. See the License for the specific language governing permissions and limitations under
 * the License.
 */var $d;(function(t){t.PUSH_RECEIVED="push-received",t.NOTIFICATION_CLICKED="notification-clicked"})($d||($d={}));/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hr(t){const e=new Uint8Array(t);return btoa(String.fromCharCode(...e)).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function zY(t){const e="=".repeat((4-t.length%4)%4),n=(t+e).replace(/\-/g,"+").replace(/_/g,"/"),r=atob(n),s=new Uint8Array(r.length);for(let i=0;i<r.length;++i)s[i]=r.charCodeAt(i);return s}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vg="fcm_token_details_db",QY=5,KT="fcm_token_object_Store";async function YY(t){if("databases"in indexedDB&&!(await indexedDB.databases()).map(i=>i.name).includes(vg))return null;let e=null;return(await Wa(vg,QY,{upgrade:async(r,s,i,o)=>{var a;if(s<2||!r.objectStoreNames.contains(KT))return;const c=o.objectStore(KT),l=await c.index("fcmSenderId").get(t);if(await c.clear(),!!l){if(s===2){const u=l;if(!u.auth||!u.p256dh||!u.endpoint)return;e={token:u.fcmToken,createTime:(a=u.createTime)!==null&&a!==void 0?a:Date.now(),subscriptionOptions:{auth:u.auth,p256dh:u.p256dh,endpoint:u.endpoint,swScope:u.swScope,vapidKey:typeof u.vapidKey=="string"?u.vapidKey:Hr(u.vapidKey)}}}else if(s===3){const u=l;e={token:u.fcmToken,createTime:u.createTime,subscriptionOptions:{auth:Hr(u.auth),p256dh:Hr(u.p256dh),endpoint:u.endpoint,swScope:u.swScope,vapidKey:Hr(u.vapidKey)}}}else if(s===4){const u=l;e={token:u.fcmToken,createTime:u.createTime,subscriptionOptions:{auth:Hr(u.auth),p256dh:Hr(u.p256dh),endpoint:u.endpoint,swScope:u.swScope,vapidKey:Hr(u.vapidKey)}}}}}})).close(),await ra(vg),await ra("fcm_vapid_details_db"),await ra("undefined"),JY(e)?e:null}function JY(t){if(!t||!t.subscriptionOptions)return!1;const{subscriptionOptions:e}=t;return typeof t.createTime=="number"&&t.createTime>0&&typeof t.token=="string"&&t.token.length>0&&typeof e.auth=="string"&&e.auth.length>0&&typeof e.p256dh=="string"&&e.p256dh.length>0&&typeof e.endpoint=="string"&&e.endpoint.length>0&&typeof e.swScope=="string"&&e.swScope.length>0&&typeof e.vapidKey=="string"&&e.vapidKey.length>0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XY="firebase-messaging-database",ZY=1,bo="firebase-messaging-store";let wg=null;function Sw(){return wg||(wg=Wa(XY,ZY,{upgrade:(t,e)=>{switch(e){case 0:t.createObjectStore(bo)}}})),wg}async function Cw(t){const e=kw(t),r=await(await Sw()).transaction(bo).objectStore(bo).get(e);if(r)return r;{const s=await YY(t.appConfig.senderId);if(s)return await Aw(t,s),s}}async function Aw(t,e){const n=kw(t),s=(await Sw()).transaction(bo,"readwrite");return await s.objectStore(bo).put(e,n),await s.done,e}async function e5(t){const e=kw(t),r=(await Sw()).transaction(bo,"readwrite");await r.objectStore(bo).delete(e),await r.done}function kw({appConfig:t}){return t.appId}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const t5={["missing-app-config-values"]:'Missing App configuration value: "{$valueName}"',["only-available-in-window"]:"This method is available in a Window context.",["only-available-in-sw"]:"This method is available in a service worker context.",["permission-default"]:"The notification permission was not granted and dismissed instead.",["permission-blocked"]:"The notification permission was not granted and blocked instead.",["unsupported-browser"]:"This browser doesn't support the API's required to use the Firebase SDK.",["indexed-db-unsupported"]:"This browser doesn't support indexedDb.open() (ex. Safari iFrame, Firefox Private Browsing, etc)",["failed-service-worker-registration"]:"We are unable to register the default service worker. {$browserErrorMessage}",["token-subscribe-failed"]:"A problem occurred while subscribing the user to FCM: {$errorInfo}",["token-subscribe-no-token"]:"FCM returned no token when subscribing the user to push.",["token-unsubscribe-failed"]:"A problem occurred while unsubscribing the user from FCM: {$errorInfo}",["token-update-failed"]:"A problem occurred while updating the user from FCM: {$errorInfo}",["token-update-no-token"]:"FCM returned no token when updating the user to push.",["use-sw-after-get-token"]:"The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.",["invalid-sw-registration"]:"The input to useServiceWorker() must be a ServiceWorkerRegistration.",["invalid-bg-handler"]:"The input to setBackgroundMessageHandler() must be a function.",["invalid-vapid-key"]:"The public VAPID key must be a string.",["use-vapid-key-after-get-token"]:"The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used."},Nr=new pn("messaging","Messaging",t5);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function n5(t,e){var n;const r=await Nw(t),s=AD(e),i={method:"POST",headers:r,body:JSON.stringify(s)};let o;try{o=await(await fetch(Rw(t.appConfig),i)).json()}catch(a){throw Nr.create("token-subscribe-failed",{errorInfo:(n=a)===null||n===void 0?void 0:n.toString()})}if(o.error){const a=o.error.message;throw Nr.create("token-subscribe-failed",{errorInfo:a})}if(!o.token)throw Nr.create("token-subscribe-no-token");return o.token}async function r5(t,e){var n;const r=await Nw(t),s=AD(e.subscriptionOptions),i={method:"PATCH",headers:r,body:JSON.stringify(s)};let o;try{o=await(await fetch(`${Rw(t.appConfig)}/${e.token}`,i)).json()}catch(a){throw Nr.create("token-update-failed",{errorInfo:(n=a)===null||n===void 0?void 0:n.toString()})}if(o.error){const a=o.error.message;throw Nr.create("token-update-failed",{errorInfo:a})}if(!o.token)throw Nr.create("token-update-no-token");return o.token}async function CD(t,e){var n;const r=await Nw(t),s={method:"DELETE",headers:r};try{const o=await(await fetch(`${Rw(t.appConfig)}/${e}`,s)).json();if(o.error){const a=o.error.message;throw Nr.create("token-unsubscribe-failed",{errorInfo:a})}}catch(i){throw Nr.create("token-unsubscribe-failed",{errorInfo:(n=i)===null||n===void 0?void 0:n.toString()})}}function Rw({projectId:t}){return`${KY}/projects/${t}/registrations`}async function Nw({appConfig:t,installations:e}){const n=await e.getToken();return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t.apiKey,"x-goog-firebase-installations-auth":`FIS ${n}`})}function AD({p256dh:t,auth:e,endpoint:n,vapidKey:r}){const s={web:{endpoint:n,auth:e,p256dh:t}};return r!==TD&&(s.web.applicationPubKey=r),s}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const s5=7*24*60*60*1e3;async function i5(t){const e=await a5(t.swRegistration,t.vapidKey),n={vapidKey:t.vapidKey,swScope:t.swRegistration.scope,endpoint:e.endpoint,auth:Hr(e.getKey("auth")),p256dh:Hr(e.getKey("p256dh"))},r=await Cw(t.firebaseDependencies);if(r){if(c5(r.subscriptionOptions,n))return Date.now()>=r.createTime+s5?o5(t,{token:r.token,createTime:Date.now(),subscriptionOptions:n}):r.token;try{await CD(t.firebaseDependencies,r.token)}catch(s){console.warn(s)}return HT(t.firebaseDependencies,n)}else return HT(t.firebaseDependencies,n)}async function i_(t){const e=await Cw(t.firebaseDependencies);e&&(await CD(t.firebaseDependencies,e.token),await e5(t.firebaseDependencies));const n=await t.swRegistration.pushManager.getSubscription();return n?n.unsubscribe():!0}async function o5(t,e){try{const n=await r5(t.firebaseDependencies,e),r=Object.assign(Object.assign({},e),{token:n,createTime:Date.now()});return await Aw(t.firebaseDependencies,r),n}catch(n){throw await i_(t),n}}async function HT(t,e){const r={token:await n5(t,e),createTime:Date.now(),subscriptionOptions:e};return await Aw(t,r),r.token}async function a5(t,e){const n=await t.pushManager.getSubscription();return n||t.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:zY(e)})}function c5(t,e){const n=e.vapidKey===t.vapidKey,r=e.endpoint===t.endpoint,s=e.auth===t.auth,i=e.p256dh===t.p256dh;return n&&r&&s&&i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function l5(t){const e={from:t.from,collapseKey:t.collapse_key,messageId:t.fcmMessageId};return u5(e,t),h5(e,t),d5(e,t),e}function u5(t,e){if(!e.notification)return;t.notification={};const n=e.notification.title;n&&(t.notification.title=n);const r=e.notification.body;r&&(t.notification.body=r);const s=e.notification.image;s&&(t.notification.image=s)}function h5(t,e){!e.data||(t.data=e.data)}function d5(t,e){var n,r,s,i,o;if(!e.fcmOptions&&!(!((n=e.notification)===null||n===void 0)&&n.click_action))return;t.fcmOptions={};const a=(s=(r=e.fcmOptions)===null||r===void 0?void 0:r.link)!==null&&s!==void 0?s:(i=e.notification)===null||i===void 0?void 0:i.click_action;a&&(t.fcmOptions.link=a);const c=(o=e.fcmOptions)===null||o===void 0?void 0:o.analytics_label;c&&(t.fcmOptions.analyticsLabel=c)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function f5(t){return typeof t=="object"&&!!t&&HY in t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function p5(t){return new Promise(e=>{setTimeout(e,t)})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */kD("hts/frbslgigp.ogepscmv/ieo/eaylg","tp:/ieaeogn-agolai.o/1frlglgc/o");kD("AzSCbw63g1R0nCw85jG8","Iaya3yLKwmgvh7cF0q4");async function g5(t,e){const n=m5(e,await t.firebaseDependencies.installations.getId());_5(t,n)}function m5(t,e){var n,r;const s={};return t.from&&(s.project_number=t.from),t.fcmMessageId&&(s.message_id=t.fcmMessageId),s.instance_id=e,t.notification?s.message_type=Ud.DISPLAY_NOTIFICATION.toString():s.message_type=Ud.DATA_MESSAGE.toString(),s.sdk_platform=WY.toString(),s.package_name=self.origin.replace(/(^\w+:|^)\/\//,""),t.collapse_key&&(s.collapse_key=t.collapse_key),s.event=GY.toString(),!((n=t.fcmOptions)===null||n===void 0)&&n.analytics_label&&(s.analytics_label=(r=t.fcmOptions)===null||r===void 0?void 0:r.analytics_label),s}function _5(t,e){const n={};n.event_time_ms=Math.floor(Date.now()).toString(),n.source_extension_json_proto3=JSON.stringify(e),t.logEvents.push(n)}function kD(t,e){const n=[];for(let r=0;r<t.length;r++)n.push(t.charAt(r)),r<e.length&&n.push(e.charAt(r));return n.join("")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function y5(t,e){var n,r;const{newSubscription:s}=t;if(!s){await i_(e);return}const i=await Cw(e.firebaseDependencies);await i_(e),e.vapidKey=(r=(n=i==null?void 0:i.subscriptionOptions)===null||n===void 0?void 0:n.vapidKey)!==null&&r!==void 0?r:TD,await i5(e)}async function v5(t,e){const n=I5(t);if(!n)return;e.deliveryMetricsExportedToBigQueryEnabled&&await g5(e,n);const r=await RD();if(T5(r))return S5(r,n);if(n.notification&&await C5(b5(n)),!!e&&e.onBackgroundMessageHandler){const s=l5(n);typeof e.onBackgroundMessageHandler=="function"?await e.onBackgroundMessageHandler(s):e.onBackgroundMessageHandler.next(s)}}async function w5(t){var e,n;const r=(n=(e=t.notification)===null||e===void 0?void 0:e.data)===null||n===void 0?void 0:n[SD];if(r){if(t.action)return}else return;t.stopImmediatePropagation(),t.notification.close();const s=A5(r);if(!s)return;const i=new URL(s,self.location.href),o=new URL(self.location.origin);if(i.host!==o.host)return;let a=await E5(i);if(a?a=await a.focus():(a=await self.clients.openWindow(s),await p5(3e3)),!!a)return r.messageType=$d.NOTIFICATION_CLICKED,r.isFirebaseMessaging=!0,a.postMessage(r)}function b5(t){const e=Object.assign({},t.notification);return e.data={[SD]:t},e}function I5({data:t}){if(!t)return null;try{return t.json()}catch{return null}}async function E5(t){const e=await RD();for(const n of e){const r=new URL(n.url,self.location.href);if(t.host===r.host)return n}return null}function T5(t){return t.some(e=>e.visibilityState==="visible"&&!e.url.startsWith("chrome-extension://"))}function S5(t,e){e.isFirebaseMessaging=!0,e.messageType=$d.PUSH_RECEIVED;for(const n of t)n.postMessage(e)}function RD(){return self.clients.matchAll({type:"window",includeUncontrolled:!0})}function C5(t){var e;const{actions:n}=t,{maxActions:r}=Notification;return n&&r&&n.length>r&&console.warn(`This browser only supports ${r} actions. The remaining actions will not be displayed.`),self.registration.showNotification((e=t.title)!==null&&e!==void 0?e:"",t)}function A5(t){var e,n,r;const s=(n=(e=t.fcmOptions)===null||e===void 0?void 0:e.link)!==null&&n!==void 0?n:(r=t.notification)===null||r===void 0?void 0:r.click_action;return s||(f5(t.data)?self.location.origin:null)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function k5(t){if(!t||!t.options)throw bg("App Configuration Object");if(!t.name)throw bg("App Name");const e=["projectId","apiKey","appId","messagingSenderId"],{options:n}=t;for(const r of e)if(!n[r])throw bg(r);return{appName:t.name,projectId:n.projectId,apiKey:n.apiKey,appId:n.appId,senderId:n.messagingSenderId}}function bg(t){return Nr.create("missing-app-config-values",{valueName:t})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R5{constructor(e,n,r){this.deliveryMetricsExportedToBigQueryEnabled=!1,this.onBackgroundMessageHandler=null,this.onMessageHandler=null,this.logEvents=[],this.isLogServiceStarted=!1;const s=k5(e);this.firebaseDependencies={app:e,appConfig:s,installations:n,analyticsProvider:r}}_delete(){return Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const N5=t=>{const e=new R5(t.getProvider("app").getImmediate(),t.getProvider("installations-internal").getImmediate(),t.getProvider("analytics-internal"));return self.addEventListener("push",n=>{n.waitUntil(v5(n,e))}),self.addEventListener("pushsubscriptionchange",n=>{n.waitUntil(y5(n,e))}),self.addEventListener("notificationclick",n=>{n.waitUntil(w5(n))}),e};function P5(){st(new Ee("messaging-sw",N5,"PUBLIC"))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function D5(t,e){if(self.document!==void 0)throw Nr.create("only-available-in-sw");return t.onBackgroundMessageHandler=e,()=>{t.onBackgroundMessageHandler=null}}function x5(t,e){return t=N(t),D5(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */P5();const O5="@firebase/messaging-compat",M5="0.1.16";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function L5(){return self&&"ServiceWorkerGlobalScope"in self?U5():F5()}function F5(){return typeof window!="undefined"&&In()&&af()&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")}function U5(){return In()&&"PushManager"in self&&"Notification"in self&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")}class WT{constructor(e,n){this.app=e,this._delegate=n,this.app=e,this._delegate=n}async getToken(e){return BY(this._delegate,e)}async deleteToken(){return qY(this._delegate)}onMessage(e){return jY(this._delegate,e)}onBackgroundMessage(e){return x5(this._delegate,e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $5=t=>self&&"ServiceWorkerGlobalScope"in self?new WT(t.getProvider("app-compat").getImmediate(),t.getProvider("messaging-sw").getImmediate()):new WT(t.getProvider("app-compat").getImmediate(),t.getProvider("messaging").getImmediate()),V5={isSupported:L5};function B5(){ht.INTERNAL.registerComponent(new Ee("messaging-compat",$5,"PUBLIC").setServiceProps(V5))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */B5();ht.registerVersion(O5,M5);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ND="firebasestorage.googleapis.com",PD="storageBucket",q5=2*60*1e3,j5=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class at extends ut{constructor(e,n){super(Ig(e),`Firebase Storage: ${n} (${Ig(e)})`),this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,at.prototype)}_codeEquals(e){return Ig(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}function Ig(t){return"storage/"+t}function Pw(){const t="An unknown error occurred, please check the error payload for server response.";return new at("unknown",t)}function K5(t){return new at("object-not-found","Object '"+t+"' does not exist.")}function H5(t){return new at("quota-exceeded","Quota for bucket '"+t+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function W5(){const t="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new at("unauthenticated",t)}function G5(){return new at("unauthorized-app","This app does not have permission to access Firebase Storage on this project.")}function z5(t){return new at("unauthorized","User does not have permission to access '"+t+"'.")}function Q5(){return new at("retry-limit-exceeded","Max retry time for operation exceeded, please try again.")}function DD(){return new at("canceled","User canceled the upload/download.")}function Y5(t){return new at("invalid-url","Invalid URL '"+t+"'.")}function J5(t){return new at("invalid-default-bucket","Invalid default bucket '"+t+"'.")}function X5(){return new at("no-default-bucket","No default bucket found. Did you set the '"+PD+"' property when initializing the app?")}function xD(){return new at("cannot-slice-blob","Cannot slice blob for upload. Please retry the upload.")}function Z5(){return new at("server-file-wrong-size","Server recorded incorrect upload file size, please retry the upload.")}function eJ(){return new at("no-download-url","The given file does not have any download URLs.")}function fa(t){return new at("invalid-argument",t)}function OD(){return new at("app-deleted","The Firebase app was deleted.")}function MD(t){return new at("invalid-root-operation","The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function al(t,e){return new at("invalid-format","String does not match format '"+t+"': "+e)}function Rc(t){throw new at("internal-error","Internal error: "+t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jt{constructor(e,n){this.bucket=e,this.path_=n}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,n){let r;try{r=Jt.makeFromUrl(e,n)}catch{return new Jt(e,"")}if(r.path==="")return r;throw J5(e)}static makeFromUrl(e,n){let r=null;const s="([A-Za-z0-9.\\-_]+)";function i(S){S.path.charAt(S.path.length-1)==="/"&&(S.path_=S.path_.slice(0,-1))}const o="(/(.*))?$",a=new RegExp("^gs://"+s+o,"i"),c={bucket:1,path:3};function l(S){S.path_=decodeURIComponent(S.path)}const u="v[A-Za-z0-9_]+",h=n.replace(/[.]/g,"\\."),d="(/([^?#]*).*)?$",f=new RegExp(`^https?://${h}/${u}/b/${s}/o${d}`,"i"),p={bucket:1,path:3},_=n===ND?"(?:storage.googleapis.com|storage.cloud.google.com)":n,y="([^?#]*)",T=new RegExp(`^https?://${_}/${s}/${y}`,"i"),E=[{regex:a,indices:c,postModify:i},{regex:f,indices:p,postModify:l},{regex:T,indices:{bucket:1,path:2},postModify:l}];for(let S=0;S<E.length;S++){const $=E[S],H=$.regex.exec(e);if(H){const K=H[$.indices.bucket];let F=H[$.indices.path];F||(F=""),r=new Jt(K,F),$.postModify(r);break}}if(r==null)throw Y5(e);return r}}class tJ{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nJ(t,e,n){let r=1,s=null,i=null,o=!1,a=0;function c(){return a===2}let l=!1;function u(...y){l||(l=!0,e.apply(null,y))}function h(y){s=setTimeout(()=>{s=null,t(f,c())},y)}function d(){i&&clearTimeout(i)}function f(y,...T){if(l){d();return}if(y){d(),u.call(null,y,...T);return}if(c()||o){d(),u.call(null,y,...T);return}r<64&&(r*=2);let E;a===1?(a=2,E=0):E=(r+Math.random())*1e3,h(E)}let p=!1;function _(y){p||(p=!0,d(),!l&&(s!==null?(y||(a=2),clearTimeout(s),h(0)):y||(a=1)))}return h(0),i=setTimeout(()=>{o=!0,_(!0)},n),_}function rJ(t){t(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sJ(t){return t!==void 0}function iJ(t){return typeof t=="function"}function oJ(t){return typeof t=="object"&&!Array.isArray(t)}function wp(t){return typeof t=="string"||t instanceof String}function GT(t){return Dw()&&t instanceof Blob}function Dw(){return typeof Blob!="undefined"}function o_(t,e,n,r){if(r<e)throw fa(`Invalid value for '${t}'. Expected ${e} or greater.`);if(r>n)throw fa(`Invalid value for '${t}'. Expected ${n} or less.`)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mi(t,e,n){let r=e;return n==null&&(r=`https://${e}`),`${n}://${r}/v0${t}`}function LD(t){const e=encodeURIComponent;let n="?";for(const r in t)if(t.hasOwnProperty(r)){const s=e(r)+"="+e(t[r]);n=n+s+"&"}return n=n.slice(0,-1),n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Qi;(function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"})(Qi||(Qi={}));/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aJ{constructor(e,n,r,s,i,o,a,c,l,u,h){this.url_=e,this.method_=n,this.headers_=r,this.body_=s,this.successCodes_=i,this.additionalRetryCodes_=o,this.callback_=a,this.errorCallback_=c,this.timeout_=l,this.progressCallback_=u,this.connectionFactory_=h,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((d,f)=>{this.resolve_=d,this.reject_=f,this.start_()})}start_(){const e=(r,s)=>{if(s){r(!1,new ph(!1,null,!0));return}const i=this.connectionFactory_();this.pendingConnection_=i;const o=a=>{const c=a.loaded,l=a.lengthComputable?a.total:-1;this.progressCallback_!==null&&this.progressCallback_(c,l)};this.progressCallback_!==null&&i.addUploadProgressListener(o),i.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&i.removeUploadProgressListener(o),this.pendingConnection_=null;const a=i.getErrorCode()===Qi.NO_ERROR,c=i.getStatus();if(!a||this.isRetryStatusCode_(c)){const u=i.getErrorCode()===Qi.ABORT;r(!1,new ph(!1,null,u));return}const l=this.successCodes_.indexOf(c)!==-1;r(!0,new ph(l,i))})},n=(r,s)=>{const i=this.resolve_,o=this.reject_,a=s.connection;if(s.wasSuccessCode)try{const c=this.callback_(a,a.getResponse());sJ(c)?i(c):i()}catch(c){o(c)}else if(a!==null){const c=Pw();c.serverResponse=a.getErrorText(),this.errorCallback_?o(this.errorCallback_(a,c)):o(c)}else if(s.canceled){const c=this.appDelete_?OD():DD();o(c)}else{const c=Q5();o(c)}};this.canceled_?n(!1,new ph(!1,null,!0)):this.backoffId_=nJ(e,n,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&rJ(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}isRetryStatusCode_(e){const n=e>=500&&e<600,s=[408,429].indexOf(e)!==-1,i=this.additionalRetryCodes_.indexOf(e)!==-1;return n||s||i}}class ph{constructor(e,n,r){this.wasSuccessCode=e,this.connection=n,this.canceled=!!r}}function cJ(t,e){e!==null&&e.length>0&&(t.Authorization="Firebase "+e)}function lJ(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(e!=null?e:"AppManager")}function uJ(t,e){e&&(t["X-Firebase-GMPID"]=e)}function hJ(t,e){e!==null&&(t["X-Firebase-AppCheck"]=e)}function dJ(t,e,n,r,s,i){const o=LD(t.urlParams),a=t.url+o,c=Object.assign({},t.headers);return uJ(c,e),cJ(c,n),lJ(c,i),hJ(c,r),new aJ(a,t.method,c,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,s)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fJ(){return typeof BlobBuilder!="undefined"?BlobBuilder:typeof WebKitBlobBuilder!="undefined"?WebKitBlobBuilder:void 0}function pJ(...t){const e=fJ();if(e!==void 0){const n=new e;for(let r=0;r<t.length;r++)n.append(t[r]);return n.getBlob()}else{if(Dw())return new Blob(t);throw new at("unsupported-environment","This browser doesn't seem to support creating Blobs")}}function gJ(t,e,n){return t.webkitSlice?t.webkitSlice(e,n):t.mozSlice?t.mozSlice(e,n):t.slice?t.slice(e,n):null}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mJ(t){return atob(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kn={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class Eg{constructor(e,n){this.data=e,this.contentType=n||null}}function FD(t,e){switch(t){case Kn.RAW:return new Eg(UD(e));case Kn.BASE64:case Kn.BASE64URL:return new Eg($D(t,e));case Kn.DATA_URL:return new Eg(yJ(e),vJ(e))}throw Pw()}function UD(t){const e=[];for(let n=0;n<t.length;n++){let r=t.charCodeAt(n);if(r<=127)e.push(r);else if(r<=2047)e.push(192|r>>6,128|r&63);else if((r&64512)===55296)if(!(n<t.length-1&&(t.charCodeAt(n+1)&64512)===56320))e.push(239,191,189);else{const i=r,o=t.charCodeAt(++n);r=65536|(i&1023)<<10|o&1023,e.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|r&63)}else(r&64512)===56320?e.push(239,191,189):e.push(224|r>>12,128|r>>6&63,128|r&63)}return new Uint8Array(e)}function _J(t){let e;try{e=decodeURIComponent(t)}catch{throw al(Kn.DATA_URL,"Malformed data URL.")}return UD(e)}function $D(t,e){switch(t){case Kn.BASE64:{const s=e.indexOf("-")!==-1,i=e.indexOf("_")!==-1;if(s||i)throw al(t,"Invalid character '"+(s?"-":"_")+"' found: is it base64url encoded?");break}case Kn.BASE64URL:{const s=e.indexOf("+")!==-1,i=e.indexOf("/")!==-1;if(s||i)throw al(t,"Invalid character '"+(s?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let n;try{n=mJ(e)}catch{throw al(t,"Invalid character found")}const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}class VD{constructor(e){this.base64=!1,this.contentType=null;const n=e.match(/^data:([^,]+)?,/);if(n===null)throw al(Kn.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const r=n[1]||null;r!=null&&(this.base64=wJ(r,";base64"),this.contentType=this.base64?r.substring(0,r.length-7):r),this.rest=e.substring(e.indexOf(",")+1)}}function yJ(t){const e=new VD(t);return e.base64?$D(Kn.BASE64,e.rest):_J(e.rest)}function vJ(t){return new VD(t).contentType}function wJ(t,e){return t.length>=e.length?t.substring(t.length-e.length)===e:!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zr{constructor(e,n){let r=0,s="";GT(e)?(this.data_=e,r=e.size,s=e.type):e instanceof ArrayBuffer?(n?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),r=this.data_.length):e instanceof Uint8Array&&(n?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),r=e.length),this.size_=r,this.type_=s}size(){return this.size_}type(){return this.type_}slice(e,n){if(GT(this.data_)){const r=this.data_,s=gJ(r,e,n);return s===null?null:new zr(s)}else{const r=new Uint8Array(this.data_.buffer,e,n-e);return new zr(r,!0)}}static getBlob(...e){if(Dw()){const n=e.map(r=>r instanceof zr?r.data_:r);return new zr(pJ.apply(null,n))}else{const n=e.map(o=>wp(o)?FD(Kn.RAW,o).data:o.data_);let r=0;n.forEach(o=>{r+=o.byteLength});const s=new Uint8Array(r);let i=0;return n.forEach(o=>{for(let a=0;a<o.length;a++)s[i++]=o[a]}),new zr(s,!0)}}uploadData(){return this.data_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xw(t){let e;try{e=JSON.parse(t)}catch{return null}return oJ(e)?e:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bJ(t){if(t.length===0)return null;const e=t.lastIndexOf("/");return e===-1?"":t.slice(0,e)}function IJ(t,e){const n=e.split("/").filter(r=>r.length>0).join("/");return t.length===0?n:t+"/"+n}function BD(t){const e=t.lastIndexOf("/",t.length-2);return e===-1?t:t.slice(e+1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function EJ(t,e){return e}class tn{constructor(e,n,r,s){this.server=e,this.local=n||e,this.writable=!!r,this.xform=s||EJ}}let gh=null;function TJ(t){return!wp(t)||t.length<2?t:BD(t)}function bp(){if(gh)return gh;const t=[];t.push(new tn("bucket")),t.push(new tn("generation")),t.push(new tn("metageneration")),t.push(new tn("name","fullPath",!0));function e(i,o){return TJ(o)}const n=new tn("name");n.xform=e,t.push(n);function r(i,o){return o!==void 0?Number(o):o}const s=new tn("size");return s.xform=r,t.push(s),t.push(new tn("timeCreated")),t.push(new tn("updated")),t.push(new tn("md5Hash",null,!0)),t.push(new tn("cacheControl",null,!0)),t.push(new tn("contentDisposition",null,!0)),t.push(new tn("contentEncoding",null,!0)),t.push(new tn("contentLanguage",null,!0)),t.push(new tn("contentType",null,!0)),t.push(new tn("metadata","customMetadata",!0)),gh=t,gh}function SJ(t,e){function n(){const r=t.bucket,s=t.fullPath,i=new Jt(r,s);return e._makeStorageReference(i)}Object.defineProperty(t,"ref",{get:n})}function CJ(t,e,n){const r={};r.type="file";const s=n.length;for(let i=0;i<s;i++){const o=n[i];r[o.local]=o.xform(r,e[o.server])}return SJ(r,t),r}function qD(t,e,n){const r=xw(e);return r===null?null:CJ(t,r,n)}function AJ(t,e,n,r){const s=xw(e);if(s===null||!wp(s.downloadTokens))return null;const i=s.downloadTokens;if(i.length===0)return null;const o=encodeURIComponent;return i.split(",").map(l=>{const u=t.bucket,h=t.fullPath,d="/b/"+o(u)+"/o/"+o(h),f=mi(d,n,r),p=LD({alt:"media",token:l});return f+p})[0]}function Ow(t,e){const n={},r=e.length;for(let s=0;s<r;s++){const i=e[s];i.writable&&(n[i.server]=t[i.local])}return JSON.stringify(n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zT="prefixes",QT="items";function kJ(t,e,n){const r={prefixes:[],items:[],nextPageToken:n.nextPageToken};if(n[zT])for(const s of n[zT]){const i=s.replace(/\/$/,""),o=t._makeStorageReference(new Jt(e,i));r.prefixes.push(o)}if(n[QT])for(const s of n[QT]){const i=t._makeStorageReference(new Jt(e,s.name));r.items.push(i)}return r}function RJ(t,e,n){const r=xw(n);return r===null?null:kJ(t,e,r)}class ys{constructor(e,n,r,s){this.url=e,this.method=n,this.handler=r,this.timeout=s,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pr(t){if(!t)throw Pw()}function Ip(t,e){function n(r,s){const i=qD(t,s,e);return Pr(i!==null),i}return n}function NJ(t,e){function n(r,s){const i=RJ(t,e,s);return Pr(i!==null),i}return n}function PJ(t,e){function n(r,s){const i=qD(t,s,e);return Pr(i!==null),AJ(i,s,t.host,t._protocol)}return n}function hc(t){function e(n,r){let s;return n.getStatus()===401?n.getErrorText().includes("Firebase App Check token is invalid")?s=G5():s=W5():n.getStatus()===402?s=H5(t.bucket):n.getStatus()===403?s=z5(t.path):s=r,s.serverResponse=r.serverResponse,s}return e}function Ep(t){const e=hc(t);function n(r,s){let i=e(r,s);return r.getStatus()===404&&(i=K5(t.path)),i.serverResponse=s.serverResponse,i}return n}function jD(t,e,n){const r=e.fullServerUrl(),s=mi(r,t.host,t._protocol),i="GET",o=t.maxOperationRetryTime,a=new ys(s,i,Ip(t,n),o);return a.errorHandler=Ep(e),a}function DJ(t,e,n,r,s){const i={};e.isRoot?i.prefix="":i.prefix=e.path+"/",n&&n.length>0&&(i.delimiter=n),r&&(i.pageToken=r),s&&(i.maxResults=s);const o=e.bucketOnlyServerUrl(),a=mi(o,t.host,t._protocol),c="GET",l=t.maxOperationRetryTime,u=new ys(a,c,NJ(t,e.bucket),l);return u.urlParams=i,u.errorHandler=hc(e),u}function xJ(t,e,n){const r=e.fullServerUrl(),s=mi(r,t.host,t._protocol),i="GET",o=t.maxOperationRetryTime,a=new ys(s,i,PJ(t,n),o);return a.errorHandler=Ep(e),a}function OJ(t,e,n,r){const s=e.fullServerUrl(),i=mi(s,t.host,t._protocol),o="PATCH",a=Ow(n,r),c={"Content-Type":"application/json; charset=utf-8"},l=t.maxOperationRetryTime,u=new ys(i,o,Ip(t,r),l);return u.headers=c,u.body=a,u.errorHandler=Ep(e),u}function MJ(t,e){const n=e.fullServerUrl(),r=mi(n,t.host,t._protocol),s="DELETE",i=t.maxOperationRetryTime;function o(c,l){}const a=new ys(r,s,o,i);return a.successCodes=[200,204],a.errorHandler=Ep(e),a}function LJ(t,e){return t&&t.contentType||e&&e.type()||"application/octet-stream"}function KD(t,e,n){const r=Object.assign({},n);return r.fullPath=t.path,r.size=e.size(),r.contentType||(r.contentType=LJ(null,e)),r}function FJ(t,e,n,r,s){const i=e.bucketOnlyServerUrl(),o={"X-Goog-Upload-Protocol":"multipart"};function a(){let E="";for(let S=0;S<2;S++)E=E+Math.random().toString().slice(2);return E}const c=a();o["Content-Type"]="multipart/related; boundary="+c;const l=KD(e,r,s),u=Ow(l,n),h="--"+c+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+u+`\r
--`+c+`\r
Content-Type: `+l.contentType+`\r
\r
`,d=`\r
--`+c+"--",f=zr.getBlob(h,r,d);if(f===null)throw xD();const p={name:l.fullPath},_=mi(i,t.host,t._protocol),y="POST",T=t.maxUploadRetryTime,I=new ys(_,y,Ip(t,n),T);return I.urlParams=p,I.headers=o,I.body=f.uploadData(),I.errorHandler=hc(e),I}class Vd{constructor(e,n,r,s){this.current=e,this.total=n,this.finalized=!!r,this.metadata=s||null}}function Mw(t,e){let n=null;try{n=t.getResponseHeader("X-Goog-Upload-Status")}catch{Pr(!1)}return Pr(!!n&&(e||["active"]).indexOf(n)!==-1),n}function UJ(t,e,n,r,s){const i=e.bucketOnlyServerUrl(),o=KD(e,r,s),a={name:o.fullPath},c=mi(i,t.host,t._protocol),l="POST",u={"X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${r.size()}`,"X-Goog-Upload-Header-Content-Type":o.contentType,"Content-Type":"application/json; charset=utf-8"},h=Ow(o,n),d=t.maxUploadRetryTime;function f(_){Mw(_);let y;try{y=_.getResponseHeader("X-Goog-Upload-URL")}catch{Pr(!1)}return Pr(wp(y)),y}const p=new ys(c,l,f,d);return p.urlParams=a,p.headers=u,p.body=h,p.errorHandler=hc(e),p}function $J(t,e,n,r){const s={"X-Goog-Upload-Command":"query"};function i(l){const u=Mw(l,["active","final"]);let h=null;try{h=l.getResponseHeader("X-Goog-Upload-Size-Received")}catch{Pr(!1)}h||Pr(!1);const d=Number(h);return Pr(!isNaN(d)),new Vd(d,r.size(),u==="final")}const o="POST",a=t.maxUploadRetryTime,c=new ys(n,o,i,a);return c.headers=s,c.errorHandler=hc(e),c}const YT=256*1024;function VJ(t,e,n,r,s,i,o,a){const c=new Vd(0,0);if(o?(c.current=o.current,c.total=o.total):(c.current=0,c.total=r.size()),r.size()!==c.total)throw Z5();const l=c.total-c.current;let u=l;s>0&&(u=Math.min(u,s));const h=c.current,d=h+u,p={"X-Goog-Upload-Command":u===l?"upload, finalize":"upload","X-Goog-Upload-Offset":`${c.current}`},_=r.slice(h,d);if(_===null)throw xD();function y(S,$){const H=Mw(S,["active","final"]),K=c.current+u,F=r.size();let ne;return H==="final"?ne=Ip(e,i)(S,$):ne=null,new Vd(K,F,H==="final",ne)}const T="POST",I=e.maxUploadRetryTime,E=new ys(n,T,y,I);return E.headers=p,E.body=_.uploadData(),E.progressCallback=a||null,E.errorHandler=hc(t),E}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BJ={STATE_CHANGED:"state_changed"},on={RUNNING:"running",PAUSED:"paused",SUCCESS:"success",CANCELED:"canceled",ERROR:"error"};function Tg(t){switch(t){case"running":case"pausing":case"canceling":return on.RUNNING;case"paused":return on.PAUSED;case"success":return on.SUCCESS;case"canceled":return on.CANCELED;case"error":return on.ERROR;default:return on.ERROR}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qJ{constructor(e,n,r){if(iJ(e)||n!=null||r!=null)this.next=e,this.error=n!=null?n:void 0,this.complete=r!=null?r:void 0;else{const i=e;this.next=i.next,this.error=i.error,this.complete=i.complete}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ko(t){return(...e)=>{Promise.resolve().then(()=>t(...e))}}class jJ{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=Qi.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=Qi.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=Qi.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,n,r,s){if(this.sent_)throw Rc("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(n,e,!0),s!==void 0)for(const i in s)s.hasOwnProperty(i)&&this.xhr_.setRequestHeader(i,s[i].toString());return r!==void 0?this.xhr_.send(r):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw Rc("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw Rc("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw Rc("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw Rc("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class KJ extends jJ{initXhr(){this.xhr_.responseType="text"}}function br(){return new KJ}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HD{constructor(e,n,r=null){this._transferred=0,this._needToFetchStatus=!1,this._needToFetchMetadata=!1,this._observers=[],this._error=void 0,this._uploadUrl=void 0,this._request=void 0,this._chunkMultiplier=1,this._resolve=void 0,this._reject=void 0,this._ref=e,this._blob=n,this._metadata=r,this._mappings=bp(),this._resumable=this._shouldDoResumable(this._blob),this._state="running",this._errorHandler=s=>{this._request=void 0,this._chunkMultiplier=1,s._codeEquals("canceled")?(this._needToFetchStatus=!0,this.completeTransitions_()):(this._error=s,this._transition("error"))},this._metadataErrorHandler=s=>{this._request=void 0,s._codeEquals("canceled")?this.completeTransitions_():(this._error=s,this._transition("error"))},this._promise=new Promise((s,i)=>{this._resolve=s,this._reject=i,this._start()}),this._promise.then(null,()=>{})}_makeProgressCallback(){const e=this._transferred;return n=>this._updateProgress(e+n)}_shouldDoResumable(e){return e.size()>256*1024}_start(){this._state==="running"&&this._request===void 0&&(this._resumable?this._uploadUrl===void 0?this._createResumable():this._needToFetchStatus?this._fetchStatus():this._needToFetchMetadata?this._fetchMetadata():this._continueUpload():this._oneShotUpload())}_resolveToken(e){Promise.all([this._ref.storage._getAuthToken(),this._ref.storage._getAppCheckToken()]).then(([n,r])=>{switch(this._state){case"running":e(n,r);break;case"canceling":this._transition("canceled");break;case"pausing":this._transition("paused");break}})}_createResumable(){this._resolveToken((e,n)=>{const r=UJ(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),s=this._ref.storage._makeRequest(r,br,e,n);this._request=s,s.getPromise().then(i=>{this._request=void 0,this._uploadUrl=i,this._needToFetchStatus=!1,this.completeTransitions_()},this._errorHandler)})}_fetchStatus(){const e=this._uploadUrl;this._resolveToken((n,r)=>{const s=$J(this._ref.storage,this._ref._location,e,this._blob),i=this._ref.storage._makeRequest(s,br,n,r);this._request=i,i.getPromise().then(o=>{o=o,this._request=void 0,this._updateProgress(o.current),this._needToFetchStatus=!1,o.finalized&&(this._needToFetchMetadata=!0),this.completeTransitions_()},this._errorHandler)})}_continueUpload(){const e=YT*this._chunkMultiplier,n=new Vd(this._transferred,this._blob.size()),r=this._uploadUrl;this._resolveToken((s,i)=>{let o;try{o=VJ(this._ref._location,this._ref.storage,r,this._blob,e,this._mappings,n,this._makeProgressCallback())}catch(c){this._error=c,this._transition("error");return}const a=this._ref.storage._makeRequest(o,br,s,i);this._request=a,a.getPromise().then(c=>{this._increaseMultiplier(),this._request=void 0,this._updateProgress(c.current),c.finalized?(this._metadata=c.metadata,this._transition("success")):this.completeTransitions_()},this._errorHandler)})}_increaseMultiplier(){YT*this._chunkMultiplier<32*1024*1024&&(this._chunkMultiplier*=2)}_fetchMetadata(){this._resolveToken((e,n)=>{const r=jD(this._ref.storage,this._ref._location,this._mappings),s=this._ref.storage._makeRequest(r,br,e,n);this._request=s,s.getPromise().then(i=>{this._request=void 0,this._metadata=i,this._transition("success")},this._metadataErrorHandler)})}_oneShotUpload(){this._resolveToken((e,n)=>{const r=FJ(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),s=this._ref.storage._makeRequest(r,br,e,n);this._request=s,s.getPromise().then(i=>{this._request=void 0,this._metadata=i,this._updateProgress(this._blob.size()),this._transition("success")},this._errorHandler)})}_updateProgress(e){const n=this._transferred;this._transferred=e,this._transferred!==n&&this._notifyObservers()}_transition(e){if(this._state!==e)switch(e){case"canceling":this._state=e,this._request!==void 0&&this._request.cancel();break;case"pausing":this._state=e,this._request!==void 0&&this._request.cancel();break;case"running":const n=this._state==="paused";this._state=e,n&&(this._notifyObservers(),this._start());break;case"paused":this._state=e,this._notifyObservers();break;case"canceled":this._error=DD(),this._state=e,this._notifyObservers();break;case"error":this._state=e,this._notifyObservers();break;case"success":this._state=e,this._notifyObservers();break}}completeTransitions_(){switch(this._state){case"pausing":this._transition("paused");break;case"canceling":this._transition("canceled");break;case"running":this._start();break}}get snapshot(){const e=Tg(this._state);return{bytesTransferred:this._transferred,totalBytes:this._blob.size(),state:e,metadata:this._metadata,task:this,ref:this._ref}}on(e,n,r,s){const i=new qJ(n||void 0,r||void 0,s||void 0);return this._addObserver(i),()=>{this._removeObserver(i)}}then(e,n){return this._promise.then(e,n)}catch(e){return this.then(null,e)}_addObserver(e){this._observers.push(e),this._notifyObserver(e)}_removeObserver(e){const n=this._observers.indexOf(e);n!==-1&&this._observers.splice(n,1)}_notifyObservers(){this._finishPromise(),this._observers.slice().forEach(n=>{this._notifyObserver(n)})}_finishPromise(){if(this._resolve!==void 0){let e=!0;switch(Tg(this._state)){case on.SUCCESS:Ko(this._resolve.bind(null,this.snapshot))();break;case on.CANCELED:case on.ERROR:const n=this._reject;Ko(n.bind(null,this._error))();break;default:e=!1;break}e&&(this._resolve=void 0,this._reject=void 0)}}_notifyObserver(e){switch(Tg(this._state)){case on.RUNNING:case on.PAUSED:e.next&&Ko(e.next.bind(e,this.snapshot))();break;case on.SUCCESS:e.complete&&Ko(e.complete.bind(e))();break;case on.CANCELED:case on.ERROR:e.error&&Ko(e.error.bind(e,this._error))();break;default:e.error&&Ko(e.error.bind(e,this._error))()}}resume(){const e=this._state==="paused"||this._state==="pausing";return e&&this._transition("running"),e}pause(){const e=this._state==="running";return e&&this._transition("pausing"),e}cancel(){const e=this._state==="running"||this._state==="pausing";return e&&this._transition("canceling"),e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Io{constructor(e,n){this._service=e,n instanceof Jt?this._location=n:this._location=Jt.makeFromUrl(n,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,n){return new Io(e,n)}get root(){const e=new Jt(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return BD(this._location.path)}get storage(){return this._service}get parent(){const e=bJ(this._location.path);if(e===null)return null;const n=new Jt(this._location.bucket,e);return new Io(this._service,n)}_throwIfRoot(e){if(this._location.path==="")throw MD(e)}}function HJ(t,e,n){return t._throwIfRoot("uploadBytesResumable"),new HD(t,new zr(e),n)}function WJ(t){const e={prefixes:[],items:[]};return WD(t,e).then(()=>e)}async function WD(t,e,n){const s=await GD(t,{pageToken:n});e.prefixes.push(...s.prefixes),e.items.push(...s.items),s.nextPageToken!=null&&await WD(t,e,s.nextPageToken)}function GD(t,e){e!=null&&typeof e.maxResults=="number"&&o_("options.maxResults",1,1e3,e.maxResults);const n=e||{},r=DJ(t.storage,t._location,"/",n.pageToken,n.maxResults);return t.storage.makeRequestWithTokens(r,br)}function GJ(t){t._throwIfRoot("getMetadata");const e=jD(t.storage,t._location,bp());return t.storage.makeRequestWithTokens(e,br)}function zJ(t,e){t._throwIfRoot("updateMetadata");const n=OJ(t.storage,t._location,e,bp());return t.storage.makeRequestWithTokens(n,br)}function QJ(t){t._throwIfRoot("getDownloadURL");const e=xJ(t.storage,t._location,bp());return t.storage.makeRequestWithTokens(e,br).then(n=>{if(n===null)throw eJ();return n})}function YJ(t){t._throwIfRoot("deleteObject");const e=MJ(t.storage,t._location);return t.storage.makeRequestWithTokens(e,br)}function zD(t,e){const n=IJ(t._location.path,e),r=new Jt(t._location.bucket,n);return new Io(t.storage,r)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function JJ(t){return/^[A-Za-z]+:\/\//.test(t)}function XJ(t,e){return new Io(t,e)}function QD(t,e){if(t instanceof Lw){const n=t;if(n._bucket==null)throw X5();const r=new Io(n,n._bucket);return e!=null?QD(r,e):r}else return e!==void 0?zD(t,e):t}function ZJ(t,e){if(e&&JJ(e)){if(t instanceof Lw)return XJ(t,e);throw fa("To use ref(service, url), the first argument must be a Storage instance.")}else return QD(t,e)}function JT(t,e){const n=e==null?void 0:e[PD];return n==null?null:Jt.makeFromBucketSpec(n,t)}function eX(t,e,n,r={}){t.host=`${e}:${n}`,t._protocol="http";const{mockUserToken:s}=r;s&&(t._overrideAuthToken=typeof s=="string"?s:$_(s,t.app.options.projectId))}class Lw{constructor(e,n,r,s,i){this.app=e,this._authProvider=n,this._appCheckProvider=r,this._url=s,this._firebaseVersion=i,this._bucket=null,this._host=ND,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=q5,this._maxUploadRetryTime=j5,this._requests=new Set,s!=null?this._bucket=Jt.makeFromBucketSpec(s,this._host):this._bucket=JT(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=Jt.makeFromBucketSpec(this._url,e):this._bucket=JT(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){o_("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){o_("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const n=await e.getToken();if(n!==null)return n.accessToken}return null}async _getAppCheckToken(){const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Io(this,e)}_makeRequest(e,n,r,s){if(this._deleted)return new tJ(OD());{const i=dJ(e,this._appId,r,s,n,this._firebaseVersion);return this._requests.add(i),i.getPromise().then(()=>this._requests.delete(i),()=>this._requests.delete(i)),i}}async makeRequestWithTokens(e,n){const[r,s]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,n,r,s).getPromise()}}const XT="@firebase/storage",ZT="0.9.9";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tX="storage";function nX(t,e,n){return t=N(t),HJ(t,e,n)}function rX(t){return t=N(t),GJ(t)}function sX(t,e){return t=N(t),zJ(t,e)}function iX(t,e){return t=N(t),GD(t,e)}function oX(t){return t=N(t),WJ(t)}function aX(t){return t=N(t),QJ(t)}function cX(t){return t=N(t),YJ(t)}function eS(t,e){return t=N(t),ZJ(t,e)}function lX(t,e){return zD(t,e)}function uX(t,e,n,r={}){eX(t,e,n,r)}function hX(t,{instanceIdentifier:e}){const n=t.getProvider("app").getImmediate(),r=t.getProvider("auth-internal"),s=t.getProvider("app-check-internal");return new Lw(n,r,s,e,Br)}function dX(){st(new Ee(tX,hX,"PUBLIC").setMultipleInstances(!0)),Fe(XT,ZT,""),Fe(XT,ZT,"esm2017")}dX();/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mh{constructor(e,n,r){this._delegate=e,this.task=n,this.ref=r}get bytesTransferred(){return this._delegate.bytesTransferred}get metadata(){return this._delegate.metadata}get state(){return this._delegate.state}get totalBytes(){return this._delegate.totalBytes}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tS{constructor(e,n){this._delegate=e,this._ref=n,this.cancel=this._delegate.cancel.bind(this._delegate),this.catch=this._delegate.catch.bind(this._delegate),this.pause=this._delegate.pause.bind(this._delegate),this.resume=this._delegate.resume.bind(this._delegate)}get snapshot(){return new mh(this._delegate.snapshot,this,this._ref)}then(e,n){return this._delegate.then(r=>{if(e)return e(new mh(r,this,this._ref))},n)}on(e,n,r,s){let i;return n&&(typeof n=="function"?i=o=>n(new mh(o,this,this._ref)):i={next:n.next?o=>n.next(new mh(o,this,this._ref)):void 0,complete:n.complete||void 0,error:n.error||void 0}),this._delegate.on(e,i,r||void 0,s||void 0)}}class nS{constructor(e,n){this._delegate=e,this._service=n}get prefixes(){return this._delegate.prefixes.map(e=>new ss(e,this._service))}get items(){return this._delegate.items.map(e=>new ss(e,this._service))}get nextPageToken(){return this._delegate.nextPageToken||null}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *  http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ss{constructor(e,n){this._delegate=e,this.storage=n}get name(){return this._delegate.name}get bucket(){return this._delegate.bucket}get fullPath(){return this._delegate.fullPath}toString(){return this._delegate.toString()}child(e){const n=lX(this._delegate,e);return new ss(n,this.storage)}get root(){return new ss(this._delegate.root,this.storage)}get parent(){const e=this._delegate.parent;return e==null?null:new ss(e,this.storage)}put(e,n){return this._throwIfRoot("put"),new tS(nX(this._delegate,e,n),this)}putString(e,n=Kn.RAW,r){this._throwIfRoot("putString");const s=FD(n,e),i=Object.assign({},r);return i.contentType==null&&s.contentType!=null&&(i.contentType=s.contentType),new tS(new HD(this._delegate,new zr(s.data,!0),i),this)}listAll(){return oX(this._delegate).then(e=>new nS(e,this.storage))}list(e){return iX(this._delegate,e||void 0).then(n=>new nS(n,this.storage))}getMetadata(){return rX(this._delegate)}updateMetadata(e){return sX(this._delegate,e)}getDownloadURL(){return aX(this._delegate)}delete(){return this._throwIfRoot("delete"),cX(this._delegate)}_throwIfRoot(e){if(this._delegate._location.path==="")throw MD(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YD{constructor(e,n){this.app=e,this._delegate=n}get maxOperationRetryTime(){return this._delegate.maxOperationRetryTime}get maxUploadRetryTime(){return this._delegate.maxUploadRetryTime}ref(e){if(rS(e))throw fa("ref() expected a child path but got a URL, use refFromURL instead.");return new ss(eS(this._delegate,e),this)}refFromURL(e){if(!rS(e))throw fa("refFromURL() expected a full URL but got a child path, use ref() instead.");try{Jt.makeFromUrl(e,this._delegate.host)}catch{throw fa("refFromUrl() expected a valid full URL but got an invalid one.")}return new ss(eS(this._delegate,e),this)}setMaxUploadRetryTime(e){this._delegate.maxUploadRetryTime=e}setMaxOperationRetryTime(e){this._delegate.maxOperationRetryTime=e}useEmulator(e,n,r={}){uX(this._delegate,e,n,r)}}function rS(t){return/^[A-Za-z]+:\/\//.test(t)}const fX="@firebase/storage-compat",pX="0.1.17";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gX="storage-compat";function mX(t,{instanceIdentifier:e}){const n=t.getProvider("app-compat").getImmediate(),r=t.getProvider("storage").getImmediate({identifier:e});return new YD(n,r)}function _X(t){const e={TaskState:on,TaskEvent:BJ,StringFormat:Kn,Storage:YD,Reference:ss};t.INTERNAL.registerComponent(new Ee(gX,mX,"PUBLIC").setServiceProps(e).setMultipleInstances(!0)),t.registerVersion(fX,pX)}_X(ht);const sS="@firebase/performance",a_="0.5.12";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JD=a_,yX="FB-PERF-TRACE-START",vX="FB-PERF-TRACE-STOP",c_="FB-PERF-TRACE-MEASURE",XD="_wt_",ZD="_fp",ex="_fcp",tx="_fid",nx="@firebase/performance/config",rx="@firebase/performance/configexpire",wX="performance",sx="Performance";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bX={["trace started"]:"Trace {$traceName} was started before.",["trace stopped"]:"Trace {$traceName} is not running.",["nonpositive trace startTime"]:"Trace {$traceName} startTime should be positive.",["nonpositive trace duration"]:"Trace {$traceName} duration should be positive.",["no window"]:"Window is not available.",["no app id"]:"App id is not available.",["no project id"]:"Project id is not available.",["no api key"]:"Api key is not available.",["invalid cc log"]:"Attempted to queue invalid cc event",["FB not default"]:"Performance can only start when Firebase app instance is the default one.",["RC response not ok"]:"RC response is not ok",["invalid attribute name"]:"Attribute name {$attributeName} is invalid.",["invalid attribute value"]:"Attribute value {$attributeValue} is invalid.",["invalid custom metric name"]:"Custom metric name {$customMetricName} is invalid",["invalid String merger input"]:"Input for String merger is invalid, contact support team to resolve.",["already initialized"]:"initializePerformance() has already been called with different options. To avoid this error, call initializePerformance() with the same options as when it was originally called, or call getPerformance() to return the already initialized instance."},Yt=new pn(wX,sx,bX);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $r=new Vr(sx);$r.logLevel=fe.INFO;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Sg,ix;class Nt{constructor(e){if(this.window=e,!e)throw Yt.create("no window");this.performance=e.performance,this.PerformanceObserver=e.PerformanceObserver,this.windowLocation=e.location,this.navigator=e.navigator,this.document=e.document,this.navigator&&this.navigator.cookieEnabled&&(this.localStorage=e.localStorage),e.perfMetrics&&e.perfMetrics.onFirstInputDelay&&(this.onFirstInputDelay=e.perfMetrics.onFirstInputDelay)}getUrl(){return this.windowLocation.href.split("?")[0]}mark(e){!this.performance||!this.performance.mark||this.performance.mark(e)}measure(e,n,r){!this.performance||!this.performance.measure||this.performance.measure(e,n,r)}getEntriesByType(e){return!this.performance||!this.performance.getEntriesByType?[]:this.performance.getEntriesByType(e)}getEntriesByName(e){return!this.performance||!this.performance.getEntriesByName?[]:this.performance.getEntriesByName(e)}getTimeOrigin(){return this.performance&&(this.performance.timeOrigin||this.performance.timing.navigationStart)}requiredApisAvailable(){return!fetch||!Promise||!af()?($r.info("Firebase Performance cannot start if browser does not support fetch and Promise or cookie is disabled."),!1):In()?!0:($r.info("IndexedDB is not supported by current browswer"),!1)}setupObserver(e,n){if(!this.PerformanceObserver)return;new this.PerformanceObserver(s=>{for(const i of s.getEntries())n(i)}).observe({entryTypes:[e]})}static getInstance(){return Sg===void 0&&(Sg=new Nt(ix)),Sg}}function IX(t){ix=t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ox;function EX(t){const e=t.getId();return e.then(n=>{ox=n}),e}function Fw(){return ox}function TX(t){const e=t.getToken();return e.then(n=>{}),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iS(t,e){const n=t.length-e.length;if(n<0||n>1)throw Yt.create("invalid String merger input");const r=[];for(let s=0;s<t.length;s++)r.push(t.charAt(s)),e.length>s&&r.push(e.charAt(s));return r.join("")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Cg;class Nn{constructor(){this.instrumentationEnabled=!0,this.dataCollectionEnabled=!0,this.loggingEnabled=!1,this.tracesSamplingRate=1,this.networkRequestsSamplingRate=1,this.logEndPointUrl="https://firebaselogging.googleapis.com/v0cc/log?format=json_proto",this.flTransportEndpointUrl=iS("hts/frbslgigp.ogepscmv/ieo/eaylg","tp:/ieaeogn-agolai.o/1frlglgc/o"),this.transportKey=iS("AzSC8r6ReiGqFMyfvgow","Iayx0u-XT3vksVM-pIV"),this.logSource=462,this.logTraceAfterSampling=!1,this.logNetworkAfterSampling=!1,this.configTimeToLive=12}getFlTransportFullUrl(){return this.flTransportEndpointUrl.concat("?key=",this.transportKey)}static getInstance(){return Cg===void 0&&(Cg=new Nn),Cg}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var pa;(function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.VISIBLE=1]="VISIBLE",t[t.HIDDEN=2]="HIDDEN"})(pa||(pa={}));const SX=["firebase_","google_","ga_"],CX=new RegExp("^[a-zA-Z]\\w*$"),AX=40,kX=100;function RX(){const t=Nt.getInstance().navigator;return"serviceWorker"in t?t.serviceWorker.controller?2:3:1}function ax(){switch(Nt.getInstance().document.visibilityState){case"visible":return pa.VISIBLE;case"hidden":return pa.HIDDEN;default:return pa.UNKNOWN}}function NX(){const e=Nt.getInstance().navigator.connection;switch(e&&e.effectiveType){case"slow-2g":return 1;case"2g":return 2;case"3g":return 3;case"4g":return 4;default:return 0}}function PX(t){return t.length===0||t.length>AX?!1:!SX.some(n=>t.startsWith(n))&&!!t.match(CX)}function DX(t){return t.length!==0&&t.length<=kX}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cx(t){var e;const n=(e=t.options)===null||e===void 0?void 0:e.appId;if(!n)throw Yt.create("no app id");return n}function xX(t){var e;const n=(e=t.options)===null||e===void 0?void 0:e.projectId;if(!n)throw Yt.create("no project id");return n}function OX(t){var e;const n=(e=t.options)===null||e===void 0?void 0:e.apiKey;if(!n)throw Yt.create("no api key");return n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MX="0.0.1",Zn={loggingEnabled:!0},LX="FIREBASE_INSTALLATIONS_AUTH";function FX(t,e){const n=UX();return n?(oS(n),Promise.resolve()):BX(t,e).then(oS).then(r=>$X(r),()=>{})}function UX(){const t=Nt.getInstance().localStorage;if(!t)return;const e=t.getItem(rx);if(!e||!qX(e))return;const n=t.getItem(nx);if(!!n)try{return JSON.parse(n)}catch{return}}function $X(t){const e=Nt.getInstance().localStorage;!t||!e||(e.setItem(nx,JSON.stringify(t)),e.setItem(rx,String(Date.now()+Nn.getInstance().configTimeToLive*60*60*1e3)))}const VX="Could not fetch config, will use default configs";function BX(t,e){return TX(t.installations).then(n=>{const r=xX(t.app),s=OX(t.app),i=`https://firebaseremoteconfig.googleapis.com/v1/projects/${r}/namespaces/fireperf:fetch?key=${s}`,o=new Request(i,{method:"POST",headers:{Authorization:`${LX} ${n}`},body:JSON.stringify({app_instance_id:e,app_instance_id_token:n,app_id:cx(t.app),app_version:JD,sdk_version:MX})});return fetch(o).then(a=>{if(a.ok)return a.json();throw Yt.create("RC response not ok")})}).catch(()=>{$r.info(VX)})}function oS(t){if(!t)return t;const e=Nn.getInstance(),n=t.entries||{};return n.fpr_enabled!==void 0?e.loggingEnabled=String(n.fpr_enabled)==="true":e.loggingEnabled=Zn.loggingEnabled,n.fpr_log_source?e.logSource=Number(n.fpr_log_source):Zn.logSource&&(e.logSource=Zn.logSource),n.fpr_log_endpoint_url?e.logEndPointUrl=n.fpr_log_endpoint_url:Zn.logEndPointUrl&&(e.logEndPointUrl=Zn.logEndPointUrl),n.fpr_log_transport_key?e.transportKey=n.fpr_log_transport_key:Zn.transportKey&&(e.transportKey=Zn.transportKey),n.fpr_vc_network_request_sampling_rate!==void 0?e.networkRequestsSamplingRate=Number(n.fpr_vc_network_request_sampling_rate):Zn.networkRequestsSamplingRate!==void 0&&(e.networkRequestsSamplingRate=Zn.networkRequestsSamplingRate),n.fpr_vc_trace_sampling_rate!==void 0?e.tracesSamplingRate=Number(n.fpr_vc_trace_sampling_rate):Zn.tracesSamplingRate!==void 0&&(e.tracesSamplingRate=Zn.tracesSamplingRate),e.logTraceAfterSampling=aS(e.tracesSamplingRate),e.logNetworkAfterSampling=aS(e.networkRequestsSamplingRate),t}function qX(t){return Number(t)>Date.now()}function aS(t){return Math.random()<=t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Uw=1,Ag;function lx(t){return Uw=2,Ag=Ag||KX(t),Ag}function jX(){return Uw===3}function KX(t){return HX().then(()=>EX(t.installations)).then(e=>FX(t,e)).then(()=>cS(),()=>cS())}function HX(){const t=Nt.getInstance().document;return new Promise(e=>{if(t&&t.readyState!=="complete"){const n=()=>{t.readyState==="complete"&&(t.removeEventListener("readystatechange",n),e())};t.addEventListener("readystatechange",n)}else e()})}function cS(){Uw=3}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $w=10*1e3,WX=5.5*1e3,ux=3,GX=1e3;let Bd=ux,Hs=[],lS=!1;function zX(){lS||(Tp(WX),lS=!0)}function Tp(t){setTimeout(()=>{if(Bd!==0){if(!Hs.length)return Tp($w);QX()}},t)}function QX(){const t=Hs.splice(0,GX),e=t.map(r=>({source_extension_json_proto3:r.message,event_time_ms:String(r.eventTime)})),n={request_time_ms:String(Date.now()),client_info:{client_type:1,js_client_info:{}},log_source:Nn.getInstance().logSource,log_event:e};YX(n,t).catch(()=>{Hs=[...t,...Hs],Bd--,$r.info(`Tries left: ${Bd}.`),Tp($w)})}function YX(t,e){return JX(t).then(n=>(n.ok||$r.info("Call to Firebase backend failed."),n.json())).then(n=>{const r=Number(n.nextRequestWaitMillis);let s=$w;isNaN(r)||(s=Math.max(r,s));const i=n.logResponseDetails;Array.isArray(i)&&i.length>0&&i[0].responseAction==="RETRY_REQUEST_LATER"&&(Hs=[...e,...Hs],$r.info("Retry transport request later.")),Bd=ux,Tp(s)})}function JX(t){const e=Nn.getInstance().getFlTransportFullUrl();return fetch(e,{method:"POST",body:JSON.stringify(t)})}function XX(t){if(!t.eventTime||!t.message)throw Yt.create("invalid cc log");Hs=[...Hs,t]}function ZX(t){return(...e)=>{const n=t(...e);XX({message:n,eventTime:Date.now()})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let kg;function hx(t,e){kg||(kg=ZX(t8)),kg(t,e)}function _h(t){const e=Nn.getInstance();!e.instrumentationEnabled&&t.isAuto||!e.dataCollectionEnabled&&!t.isAuto||!Nt.getInstance().requiredApisAvailable()||t.isAuto&&ax()!==pa.VISIBLE||(jX()?Rg(t):lx(t.performanceController).then(()=>Rg(t),()=>Rg(t)))}function Rg(t){if(!Fw())return;const e=Nn.getInstance();!e.loggingEnabled||!e.logTraceAfterSampling||setTimeout(()=>hx(t,1),0)}function e8(t){const e=Nn.getInstance();if(!e.instrumentationEnabled)return;const n=t.url,r=e.logEndPointUrl.split("?")[0],s=e.flTransportEndpointUrl.split("?")[0];n===r||n===s||!e.loggingEnabled||!e.logNetworkAfterSampling||setTimeout(()=>hx(t,0),0)}function t8(t,e){return e===0?n8(t):r8(t)}function n8(t){const e={url:t.url,http_method:t.httpMethod||0,http_response_code:200,response_payload_bytes:t.responsePayloadBytes,client_start_time_us:t.startTimeUs,time_to_response_initiated_us:t.timeToResponseInitiatedUs,time_to_response_completed_us:t.timeToResponseCompletedUs},n={application_info:dx(t.performanceController.app),network_request_metric:e};return JSON.stringify(n)}function r8(t){const e={name:t.name,is_auto:t.isAuto,client_start_time_us:t.startTimeUs,duration_us:t.durationUs};Object.keys(t.counters).length!==0&&(e.counters=t.counters);const n=t.getAttributes();Object.keys(n).length!==0&&(e.custom_attributes=n);const r={application_info:dx(t.performanceController.app),trace_metric:e};return JSON.stringify(r)}function dx(t){return{google_app_id:cx(t),app_instance_id:Fw(),web_app_info:{sdk_version:JD,page_url:Nt.getInstance().getUrl(),service_worker_status:RX(),visibility_state:ax(),effective_connection_type:NX()},application_process_state:0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const s8=100,i8="_",o8=[ZD,ex,tx];function a8(t,e){return t.length===0||t.length>s8?!1:e&&e.startsWith(XD)&&o8.indexOf(t)>-1||!t.startsWith(i8)}function c8(t){const e=Math.floor(t);return e<t&&$r.info(`Metric value should be an Integer, setting the value as : ${e}.`),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ws{constructor(e,n,r=!1,s){this.performanceController=e,this.name=n,this.isAuto=r,this.state=1,this.customAttributes={},this.counters={},this.api=Nt.getInstance(),this.randomId=Math.floor(Math.random()*1e6),this.isAuto||(this.traceStartMark=`${yX}-${this.randomId}-${this.name}`,this.traceStopMark=`${vX}-${this.randomId}-${this.name}`,this.traceMeasure=s||`${c_}-${this.randomId}-${this.name}`,s&&this.calculateTraceMetrics())}start(){if(this.state!==1)throw Yt.create("trace started",{traceName:this.name});this.api.mark(this.traceStartMark),this.state=2}stop(){if(this.state!==2)throw Yt.create("trace stopped",{traceName:this.name});this.state=3,this.api.mark(this.traceStopMark),this.api.measure(this.traceMeasure,this.traceStartMark,this.traceStopMark),this.calculateTraceMetrics(),_h(this)}record(e,n,r){if(e<=0)throw Yt.create("nonpositive trace startTime",{traceName:this.name});if(n<=0)throw Yt.create("nonpositive trace duration",{traceName:this.name});if(this.durationUs=Math.floor(n*1e3),this.startTimeUs=Math.floor(e*1e3),r&&r.attributes&&(this.customAttributes=Object.assign({},r.attributes)),r&&r.metrics)for(const s of Object.keys(r.metrics))isNaN(Number(r.metrics[s]))||(this.counters[s]=Math.floor(Number(r.metrics[s])));_h(this)}incrementMetric(e,n=1){this.counters[e]===void 0?this.putMetric(e,n):this.putMetric(e,this.counters[e]+n)}putMetric(e,n){if(a8(e,this.name))this.counters[e]=c8(n!=null?n:0);else throw Yt.create("invalid custom metric name",{customMetricName:e})}getMetric(e){return this.counters[e]||0}putAttribute(e,n){const r=PX(e),s=DX(n);if(r&&s){this.customAttributes[e]=n;return}if(!r)throw Yt.create("invalid attribute name",{attributeName:e});if(!s)throw Yt.create("invalid attribute value",{attributeValue:n})}getAttribute(e){return this.customAttributes[e]}removeAttribute(e){this.customAttributes[e]!==void 0&&delete this.customAttributes[e]}getAttributes(){return Object.assign({},this.customAttributes)}setStartTime(e){this.startTimeUs=e}setDuration(e){this.durationUs=e}calculateTraceMetrics(){const e=this.api.getEntriesByName(this.traceMeasure),n=e&&e[0];n&&(this.durationUs=Math.floor(n.duration*1e3),this.startTimeUs=Math.floor((n.startTime+this.api.getTimeOrigin())*1e3))}static createOobTrace(e,n,r,s){const i=Nt.getInstance().getUrl();if(!i)return;const o=new Ws(e,XD+i,!0),a=Math.floor(Nt.getInstance().getTimeOrigin()*1e3);o.setStartTime(a),n&&n[0]&&(o.setDuration(Math.floor(n[0].duration*1e3)),o.putMetric("domInteractive",Math.floor(n[0].domInteractive*1e3)),o.putMetric("domContentLoadedEventEnd",Math.floor(n[0].domContentLoadedEventEnd*1e3)),o.putMetric("loadEventEnd",Math.floor(n[0].loadEventEnd*1e3)));const c="first-paint",l="first-contentful-paint";if(r){const u=r.find(d=>d.name===c);u&&u.startTime&&o.putMetric(ZD,Math.floor(u.startTime*1e3));const h=r.find(d=>d.name===l);h&&h.startTime&&o.putMetric(ex,Math.floor(h.startTime*1e3)),s&&o.putMetric(tx,Math.floor(s*1e3))}_h(o)}static createUserTimingTrace(e,n){const r=new Ws(e,n,!1,n);_h(r)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uS(t,e){const n=e;if(!n||n.responseStart===void 0)return;const r=Nt.getInstance().getTimeOrigin(),s=Math.floor((n.startTime+r)*1e3),i=n.responseStart?Math.floor((n.responseStart-n.startTime)*1e3):void 0,o=Math.floor((n.responseEnd-n.startTime)*1e3),a=n.name&&n.name.split("?")[0],c={performanceController:t,url:a,responsePayloadBytes:n.transferSize,startTimeUs:s,timeToResponseInitiatedUs:i,timeToResponseCompletedUs:o};e8(c)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const l8=5e3;function hS(t){!Fw()||(setTimeout(()=>h8(t),0),setTimeout(()=>u8(t),0),setTimeout(()=>d8(t),0))}function u8(t){const e=Nt.getInstance(),n=e.getEntriesByType("resource");for(const r of n)uS(t,r);e.setupObserver("resource",r=>uS(t,r))}function h8(t){const e=Nt.getInstance(),n=e.getEntriesByType("navigation"),r=e.getEntriesByType("paint");if(e.onFirstInputDelay){let s=setTimeout(()=>{Ws.createOobTrace(t,n,r),s=void 0},l8);e.onFirstInputDelay(i=>{s&&(clearTimeout(s),Ws.createOobTrace(t,n,r,i))})}else Ws.createOobTrace(t,n,r)}function d8(t){const e=Nt.getInstance(),n=e.getEntriesByType("measure");for(const r of n)dS(t,r);e.setupObserver("measure",r=>dS(t,r))}function dS(t,e){const n=e.name;n.substring(0,c_.length)!==c_&&Ws.createUserTimingTrace(t,n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class f8{constructor(e,n){this.app=e,this.installations=n,this.initialized=!1}_init(e){this.initialized||((e==null?void 0:e.dataCollectionEnabled)!==void 0&&(this.dataCollectionEnabled=e.dataCollectionEnabled),(e==null?void 0:e.instrumentationEnabled)!==void 0&&(this.instrumentationEnabled=e.instrumentationEnabled),Nt.getInstance().requiredApisAvailable()?du().then(n=>{n&&(zX(),lx(this).then(()=>hS(this),()=>hS(this)),this.initialized=!0)}).catch(n=>{$r.info(`Environment doesn't support IndexedDB: ${n}`)}):$r.info('Firebase Performance cannot start if the browser does not support "Fetch" and "Promise", or cookies are disabled.'))}set instrumentationEnabled(e){Nn.getInstance().instrumentationEnabled=e}get instrumentationEnabled(){return Nn.getInstance().instrumentationEnabled}set dataCollectionEnabled(e){Nn.getInstance().dataCollectionEnabled=e}get dataCollectionEnabled(){return Nn.getInstance().dataCollectionEnabled}}const p8="[DEFAULT]";function g8(t,e){return t=N(t),new Ws(t,e)}const m8=(t,{options:e})=>{const n=t.getProvider("app").getImmediate(),r=t.getProvider("installations-internal").getImmediate();if(n.name!==p8)throw Yt.create("FB not default");if(typeof window=="undefined")throw Yt.create("no window");IX(window);const s=new f8(n,r);return s._init(e),s};function _8(){st(new Ee("performance",m8,"PUBLIC")),Fe(sS,a_),Fe(sS,a_,"esm2017")}_8();/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y8{constructor(e,n){this.app=e,this._delegate=n}get instrumentationEnabled(){return this._delegate.instrumentationEnabled}set instrumentationEnabled(e){this._delegate.instrumentationEnabled=e}get dataCollectionEnabled(){return this._delegate.dataCollectionEnabled}set dataCollectionEnabled(e){this._delegate.dataCollectionEnabled=e}trace(e){return g8(this._delegate,e)}}const v8="@firebase/performance-compat",w8="0.1.12";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function b8(t){t.INTERNAL.registerComponent(new Ee("performance-compat",I8,"PUBLIC")),t.registerVersion(v8,w8)}function I8(t){const e=t.getProvider("app-compat").getImmediate(),n=t.getProvider("performance").getImmediate();return new y8(e,n)}b8(ht);const Ng="@firebase/remote-config",fS="0.3.11";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class E8{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const T8="remote-config";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const S8={["registration-window"]:"Undefined window object. This SDK only supports usage in a browser environment.",["registration-project-id"]:"Undefined project identifier. Check Firebase app initialization.",["registration-api-key"]:"Undefined API key. Check Firebase app initialization.",["registration-app-id"]:"Undefined app identifier. Check Firebase app initialization.",["storage-open"]:"Error thrown when opening storage. Original error: {$originalErrorMessage}.",["storage-get"]:"Error thrown when reading from storage. Original error: {$originalErrorMessage}.",["storage-set"]:"Error thrown when writing to storage. Original error: {$originalErrorMessage}.",["storage-delete"]:"Error thrown when deleting from storage. Original error: {$originalErrorMessage}.",["fetch-client-network"]:"Fetch client failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.",["fetch-timeout"]:'The config fetch request timed out.  Configure timeout using "fetchTimeoutMillis" SDK setting.',["fetch-throttle"]:'The config fetch request timed out while in an exponential backoff state. Configure timeout using "fetchTimeoutMillis" SDK setting. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.',["fetch-client-parse"]:"Fetch client could not parse response. Original error: {$originalErrorMessage}.",["fetch-status"]:"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.",["indexed-db-unavailable"]:"Indexed DB is not supported by current browser"},_n=new pn("remoteconfig","Remote Config",S8);function C8(t,e){return t instanceof ut&&t.code.indexOf(e)!==-1}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const A8=!1,k8="",pS=0,R8=["1","true","t","yes","y","on"];class Pg{constructor(e,n=k8){this._source=e,this._value=n}asString(){return this._value}asBoolean(){return this._source==="static"?A8:R8.indexOf(this._value.toLowerCase())>=0}asNumber(){if(this._source==="static")return pS;let e=Number(this._value);return isNaN(e)&&(e=pS),e}getSource(){return this._source}}async function fx(t){const e=N(t),[n,r]=await Promise.all([e._storage.getLastSuccessfulFetchResponse(),e._storage.getActiveConfigEtag()]);return!n||!n.config||!n.eTag||n.eTag===r?!1:(await Promise.all([e._storageCache.setActiveConfig(n.config),e._storage.setActiveConfigEtag(n.eTag)]),!0)}function px(t){const e=N(t);return e._initializePromise||(e._initializePromise=e._storageCache.loadFromStorage().then(()=>{e._isInitializationComplete=!0})),e._initializePromise}async function gx(t){const e=N(t),n=new E8;setTimeout(async()=>{n.abort()},e.settings.fetchTimeoutMillis);try{await e._client.fetch({cacheMaxAgeMillis:e.settings.minimumFetchIntervalMillis,signal:n}),await e._storageCache.setLastFetchStatus("success")}catch(r){const s=C8(r,"fetch-throttle")?"throttle":"failure";throw await e._storageCache.setLastFetchStatus(s),r}}function N8(t){const e=N(t);return M8(e._storageCache.getActiveConfig(),e.defaultConfig).reduce((n,r)=>(n[r]=zu(t,r),n),{})}function P8(t,e){return zu(N(t),e).asBoolean()}function D8(t,e){return zu(N(t),e).asNumber()}function x8(t,e){return zu(N(t),e).asString()}function zu(t,e){const n=N(t);n._isInitializationComplete||n._logger.debug(`A value was requested for key "${e}" before SDK initialization completed. Await on ensureInitialized if the intent was to get a previously activated value.`);const r=n._storageCache.getActiveConfig();return r&&r[e]!==void 0?new Pg("remote",r[e]):n.defaultConfig&&n.defaultConfig[e]!==void 0?new Pg("default",String(n.defaultConfig[e])):(n._logger.debug(`Returning static value for key "${e}". Define a default or remote value if this is unintentional.`),new Pg("static"))}function O8(t,e){const n=N(t);switch(e){case"debug":n._logger.logLevel=fe.DEBUG;break;case"silent":n._logger.logLevel=fe.SILENT;break;default:n._logger.logLevel=fe.ERROR}}function M8(t={},e={}){return Object.keys(Object.assign(Object.assign({},t),e))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L8{constructor(e,n,r,s){this.client=e,this.storage=n,this.storageCache=r,this.logger=s}isCachedDataFresh(e,n){if(!n)return this.logger.debug("Config fetch cache check. Cache unpopulated."),!1;const r=Date.now()-n,s=r<=e;return this.logger.debug(`Config fetch cache check. Cache age millis: ${r}. Cache max age millis (minimumFetchIntervalMillis setting): ${e}. Is cache hit: ${s}.`),s}async fetch(e){const[n,r]=await Promise.all([this.storage.getLastSuccessfulFetchTimestampMillis(),this.storage.getLastSuccessfulFetchResponse()]);if(r&&this.isCachedDataFresh(e.cacheMaxAgeMillis,n))return r;e.eTag=r&&r.eTag;const s=await this.client.fetch(e),i=[this.storageCache.setLastSuccessfulFetchTimestampMillis(Date.now())];return s.status===200&&i.push(this.storage.setLastSuccessfulFetchResponse(s)),await Promise.all(i),s}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function F8(t=navigator){return t.languages&&t.languages[0]||t.language}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U8{constructor(e,n,r,s,i,o){this.firebaseInstallations=e,this.sdkVersion=n,this.namespace=r,this.projectId=s,this.apiKey=i,this.appId=o}async fetch(e){var n,r,s;const[i,o]=await Promise.all([this.firebaseInstallations.getId(),this.firebaseInstallations.getToken()]),c=`${window.FIREBASE_REMOTE_CONFIG_URL_BASE||"https://firebaseremoteconfig.googleapis.com"}/v1/projects/${this.projectId}/namespaces/${this.namespace}:fetch?key=${this.apiKey}`,l={"Content-Type":"application/json","Content-Encoding":"gzip","If-None-Match":e.eTag||"*"},u={sdk_version:this.sdkVersion,app_instance_id:i,app_instance_id_token:o,app_id:this.appId,language_code:F8()},h={method:"POST",headers:l,body:JSON.stringify(u)},d=fetch(c,h),f=new Promise((E,S)=>{e.signal.addEventListener(()=>{const $=new Error("The operation was aborted.");$.name="AbortError",S($)})});let p;try{await Promise.race([d,f]),p=await d}catch(E){let S="fetch-client-network";throw((n=E)===null||n===void 0?void 0:n.name)==="AbortError"&&(S="fetch-timeout"),_n.create(S,{originalErrorMessage:(r=E)===null||r===void 0?void 0:r.message})}let _=p.status;const y=p.headers.get("ETag")||void 0;let T,I;if(p.status===200){let E;try{E=await p.json()}catch(S){throw _n.create("fetch-client-parse",{originalErrorMessage:(s=S)===null||s===void 0?void 0:s.message})}T=E.entries,I=E.state}if(I==="INSTANCE_STATE_UNSPECIFIED"?_=500:I==="NO_CHANGE"?_=304:(I==="NO_TEMPLATE"||I==="EMPTY_CONFIG")&&(T={}),_!==304&&_!==200)throw _n.create("fetch-status",{httpStatus:_});return{status:_,eTag:y,config:T}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $8(t,e){return new Promise((n,r)=>{const s=Math.max(e-Date.now(),0),i=setTimeout(n,s);t.addEventListener(()=>{clearTimeout(i),r(_n.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}function V8(t){if(!(t instanceof ut)||!t.customData)return!1;const e=Number(t.customData.httpStatus);return e===429||e===500||e===503||e===504}class B8{constructor(e,n){this.client=e,this.storage=n}async fetch(e){const n=await this.storage.getThrottleMetadata()||{backoffCount:0,throttleEndTimeMillis:Date.now()};return this.attemptFetch(e,n)}async attemptFetch(e,{throttleEndTimeMillis:n,backoffCount:r}){await $8(e.signal,n);try{const s=await this.client.fetch(e);return await this.storage.deleteThrottleMetadata(),s}catch(s){if(!V8(s))throw s;const i={throttleEndTimeMillis:Date.now()+Wh(r),backoffCount:r+1};return await this.storage.setThrottleMetadata(i),this.attemptFetch(e,i)}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const q8=60*1e3,j8=12*60*60*1e3;class K8{constructor(e,n,r,s,i){this.app=e,this._client=n,this._storageCache=r,this._storage=s,this._logger=i,this._isInitializationComplete=!1,this.settings={fetchTimeoutMillis:q8,minimumFetchIntervalMillis:j8},this.defaultConfig={}}get fetchTimeMillis(){return this._storageCache.getLastSuccessfulFetchTimestampMillis()||-1}get lastFetchStatus(){return this._storageCache.getLastFetchStatus()||"no-fetch-yet"}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Oh(t,e){var n;const r=t.target.error||void 0;return _n.create(e,{originalErrorMessage:r&&((n=r)===null||n===void 0?void 0:n.message)})}const Ai="app_namespace_store",H8="firebase_remote_config",W8=1;function G8(){return new Promise((t,e)=>{var n;try{const r=indexedDB.open(H8,W8);r.onerror=s=>{e(Oh(s,"storage-open"))},r.onsuccess=s=>{t(s.target.result)},r.onupgradeneeded=s=>{const i=s.target.result;switch(s.oldVersion){case 0:i.createObjectStore(Ai,{keyPath:"compositeKey"})}}}catch(r){e(_n.create("storage-open",{originalErrorMessage:(n=r)===null||n===void 0?void 0:n.message}))}})}class z8{constructor(e,n,r,s=G8()){this.appId=e,this.appName=n,this.namespace=r,this.openDbPromise=s}getLastFetchStatus(){return this.get("last_fetch_status")}setLastFetchStatus(e){return this.set("last_fetch_status",e)}getLastSuccessfulFetchTimestampMillis(){return this.get("last_successful_fetch_timestamp_millis")}setLastSuccessfulFetchTimestampMillis(e){return this.set("last_successful_fetch_timestamp_millis",e)}getLastSuccessfulFetchResponse(){return this.get("last_successful_fetch_response")}setLastSuccessfulFetchResponse(e){return this.set("last_successful_fetch_response",e)}getActiveConfig(){return this.get("active_config")}setActiveConfig(e){return this.set("active_config",e)}getActiveConfigEtag(){return this.get("active_config_etag")}setActiveConfigEtag(e){return this.set("active_config_etag",e)}getThrottleMetadata(){return this.get("throttle_metadata")}setThrottleMetadata(e){return this.set("throttle_metadata",e)}deleteThrottleMetadata(){return this.delete("throttle_metadata")}async get(e){const n=await this.openDbPromise;return new Promise((r,s)=>{var i;const a=n.transaction([Ai],"readonly").objectStore(Ai),c=this.createCompositeKey(e);try{const l=a.get(c);l.onerror=u=>{s(Oh(u,"storage-get"))},l.onsuccess=u=>{const h=u.target.result;r(h?h.value:void 0)}}catch(l){s(_n.create("storage-get",{originalErrorMessage:(i=l)===null||i===void 0?void 0:i.message}))}})}async set(e,n){const r=await this.openDbPromise;return new Promise((s,i)=>{var o;const c=r.transaction([Ai],"readwrite").objectStore(Ai),l=this.createCompositeKey(e);try{const u=c.put({compositeKey:l,value:n});u.onerror=h=>{i(Oh(h,"storage-set"))},u.onsuccess=()=>{s()}}catch(u){i(_n.create("storage-set",{originalErrorMessage:(o=u)===null||o===void 0?void 0:o.message}))}})}async delete(e){const n=await this.openDbPromise;return new Promise((r,s)=>{var i;const a=n.transaction([Ai],"readwrite").objectStore(Ai),c=this.createCompositeKey(e);try{const l=a.delete(c);l.onerror=u=>{s(Oh(u,"storage-delete"))},l.onsuccess=()=>{r()}}catch(l){s(_n.create("storage-delete",{originalErrorMessage:(i=l)===null||i===void 0?void 0:i.message}))}})}createCompositeKey(e){return[this.appId,this.appName,this.namespace,e].join()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q8{constructor(e){this.storage=e}getLastFetchStatus(){return this.lastFetchStatus}getLastSuccessfulFetchTimestampMillis(){return this.lastSuccessfulFetchTimestampMillis}getActiveConfig(){return this.activeConfig}async loadFromStorage(){const e=this.storage.getLastFetchStatus(),n=this.storage.getLastSuccessfulFetchTimestampMillis(),r=this.storage.getActiveConfig(),s=await e;s&&(this.lastFetchStatus=s);const i=await n;i&&(this.lastSuccessfulFetchTimestampMillis=i);const o=await r;o&&(this.activeConfig=o)}setLastFetchStatus(e){return this.lastFetchStatus=e,this.storage.setLastFetchStatus(e)}setLastSuccessfulFetchTimestampMillis(e){return this.lastSuccessfulFetchTimestampMillis=e,this.storage.setLastSuccessfulFetchTimestampMillis(e)}setActiveConfig(e){return this.activeConfig=e,this.storage.setActiveConfig(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Y8(){st(new Ee(T8,t,"PUBLIC").setMultipleInstances(!0)),Fe(Ng,fS),Fe(Ng,fS,"esm2017");function t(e,{instanceIdentifier:n}){const r=e.getProvider("app").getImmediate(),s=e.getProvider("installations-internal").getImmediate();if(typeof window=="undefined")throw _n.create("registration-window");if(!In())throw _n.create("indexed-db-unavailable");const{projectId:i,apiKey:o,appId:a}=r.options;if(!i)throw _n.create("registration-project-id");if(!o)throw _n.create("registration-api-key");if(!a)throw _n.create("registration-app-id");n=n||"firebase";const c=new z8(a,r.name,n),l=new Q8(c),u=new Vr(Ng);u.logLevel=fe.ERROR;const h=new U8(s,Br,n,i,o,a),d=new B8(h,c),f=new L8(d,c,l,u),p=new K8(r,f,l,c,u);return px(p),p}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function J8(t){return t=N(t),await gx(t),fx(t)}async function X8(){if(!In())return!1;try{return await du()}catch{return!1}}Y8();/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z8{constructor(e,n){this.app=e,this._delegate=n}get defaultConfig(){return this._delegate.defaultConfig}set defaultConfig(e){this._delegate.defaultConfig=e}get fetchTimeMillis(){return this._delegate.fetchTimeMillis}get lastFetchStatus(){return this._delegate.lastFetchStatus}get settings(){return this._delegate.settings}set settings(e){this._delegate.settings=e}activate(){return fx(this._delegate)}ensureInitialized(){return px(this._delegate)}fetch(){return gx(this._delegate)}fetchAndActivate(){return J8(this._delegate)}getAll(){return N8(this._delegate)}getBoolean(e){return P8(this._delegate,e)}getNumber(e){return D8(this._delegate,e)}getString(e){return x8(this._delegate,e)}getValue(e){return zu(this._delegate,e)}setLogLevel(e){O8(this._delegate,e)}}const e9="@firebase/remote-config-compat",t9="0.1.12";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function n9(t){t.INTERNAL.registerComponent(new Ee("remoteConfig-compat",r9,"PUBLIC").setMultipleInstances(!0).setServiceProps({isSupported:X8})),t.registerVersion(e9,t9)}function r9(t,{instanceIdentifier:e}){const n=t.getProvider("app-compat").getImmediate(),r=t.getProvider("remote-config").getImmediate({identifier:e});return new Z8(n,r)}n9(ht);var s9="firebase",i9="9.9.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ht.registerVersion(s9,i9,"app-compat");var o9="firebase",a9="9.9.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */console.warn(`
It looks like you're using the development build of the Firebase JS SDK.
When deploying Firebase apps to production, it is advisable to only import
the individual SDK components you intend to use.

For the module builds, these are available in the following manner
(replace <PACKAGE> with the name of a component - i.e. auth, database, etc):

CommonJS Modules:
const firebase = require('firebase/app');
require('firebase/<PACKAGE>');

ES Modules:
import firebase from 'firebase/app';
import 'firebase/<PACKAGE>';

Typescript:
import firebase from 'firebase/app';
import 'firebase/<PACKAGE>';
`);ht.registerVersion(o9,a9,"compat");var c9=!1;/*!
  * pinia v2.0.16
  * (c) 2022 Eduardo San Martin Morote
  * @license MIT
  */let mx;const Sp=t=>mx=t,_x=Symbol();function l_(t){return t&&typeof t=="object"&&Object.prototype.toString.call(t)==="[object Object]"&&typeof t.toJSON!="function"}var cl;(function(t){t.direct="direct",t.patchObject="patch object",t.patchFunction="patch function"})(cl||(cl={}));function l9(){const t=IS(!0),e=t.run(()=>T_({}));let n=[],r=[];const s=ma({install(i){Sp(s),s._a=i,i.provide(_x,s),i.config.globalProperties.$pinia=s,r.forEach(o=>n.push(o)),r=[]},use(i){return!this._a&&!c9?r.push(i):n.push(i),this},_p:n,_a:null,_e:t,_s:new Map,state:e});return s}const yx=()=>{};function gS(t,e,n,r=yx){t.push(e);const s=()=>{const i=t.indexOf(e);i>-1&&(t.splice(i,1),r())};return!n&&ef()&&P_(s),s}function Ho(t,...e){t.slice().forEach(n=>{n(...e)})}function u_(t,e){for(const n in e){if(!e.hasOwnProperty(n))continue;const r=e[n],s=t[n];l_(s)&&l_(r)&&t.hasOwnProperty(n)&&!lt(r)&&!$s(r)?t[n]=u_(s,r):t[n]=r}return t}const u9=Symbol();function h9(t){return!l_(t)||!t.hasOwnProperty(u9)}const{assign:Wr}=Object;function d9(t){return!!(lt(t)&&t.effect)}function f9(t,e,n,r){const{state:s,actions:i,getters:o}=e,a=n.state.value[t];let c;function l(){a||(n.state.value[t]=s?s():{});const u=dO(n.state.value[t]);return Wr(u,i,Object.keys(o||{}).reduce((h,d)=>(h[d]=ma(nr(()=>{Sp(n);const f=n._s.get(t);return o[d].call(f,f)})),h),{}))}return c=vx(t,l,e,n,r,!0),c.$reset=function(){const h=s?s():{};this.$patch(d=>{Wr(d,h)})},c}function vx(t,e,n={},r,s,i){let o;const a=Wr({actions:{}},n),c={deep:!0};let l,u,h=ma([]),d=ma([]),f;const p=r.state.value[t];!i&&!p&&(r.state.value[t]={}),T_({});let _;function y(K){let F;l=u=!1,typeof K=="function"?(K(r.state.value[t]),F={type:cl.patchFunction,storeId:t,events:f}):(u_(r.state.value[t],K),F={type:cl.patchObject,payload:K,storeId:t,events:f});const ne=_=Symbol();C_().then(()=>{_===ne&&(l=!0)}),u=!0,Ho(h,F,r.state.value[t])}const T=yx;function I(){o.stop(),h=[],d=[],r._s.delete(t)}function E(K,F){return function(){Sp(r);const ne=Array.from(arguments),he=[],Ce=[];function z(et){he.push(et)}function Re(et){Ce.push(et)}Ho(d,{args:ne,name:K,store:$,after:z,onError:Re});let Ze;try{Ze=F.apply(this&&this.$id===t?this:$,ne)}catch(et){throw Ho(Ce,et),et}return Ze instanceof Promise?Ze.then(et=>(Ho(he,et),et)).catch(et=>(Ho(Ce,et),Promise.reject(et))):(Ho(he,Ze),Ze)}}const S={_p:r,$id:t,$onAction:gS.bind(null,d),$patch:y,$reset:T,$subscribe(K,F={}){const ne=gS(h,K,F.detached,()=>he()),he=o.run(()=>na(()=>r.state.value[t],Ce=>{(F.flush==="sync"?u:l)&&K({storeId:t,type:cl.direct,events:f},Ce)},Wr({},c,F)));return ne},$dispose:I},$=ja(Wr({},S));r._s.set(t,$);const H=r._e.run(()=>(o=IS(),o.run(()=>e())));for(const K in H){const F=H[K];if(lt(F)&&!d9(F)||$s(F))i||(p&&h9(F)&&(lt(F)?F.value=p[K]:u_(F,p[K])),r.state.value[t][K]=F);else if(typeof F=="function"){const ne=E(K,F);H[K]=ne,a.actions[K]=F}}return Wr($,H),Wr(Se($),H),Object.defineProperty($,"$state",{get:()=>r.state.value[t],set:K=>{y(F=>{Wr(F,K)})}}),r._p.forEach(K=>{Wr($,o.run(()=>K({store:$,app:r._a,pinia:r,options:a})))}),p&&i&&n.hydrate&&n.hydrate($.$state,p),l=!0,u=!0,$}function p9(t,e,n){let r,s;const i=typeof e=="function";typeof t=="string"?(r=t,s=i?n:e):(s=t,r=t.id);function o(a,c){const l=ef();return a=a||l&&Cr(_x),a&&Sp(a),a=mx,a._s.has(r)||(i?vx(r,e,s,a):f9(r,s,a)),a._s.get(r)}return o.$id=r,o}const yh=p9({id:"university",state:()=>({univercities:[],loading:!1}),actions:{getData(){this.loading=!0,this.removeAll(this.univercities,this.univercities.length),ht.firestore().collection("Univercities").orderBy("name").get().then(e=>{e.forEach(n=>{const r=n.data();this.univercities.push(r),this.loading=!1})})},removeAll(t,e){t.splice(0,e),this.univercities=t}}});const g9={name:"ticker",data(){return{tickerData:[{headlines:"Admission open in Comsatas",link:"https://comstas.com"},{headlines:"Today Entry Test in BZU",link:"https://bzu.com"}],ticker:!0}},methods:{isTicker(){this.$route.name=="details"?this.ticker=!1:this.ticker=!0}}},m9=t=>(A_("data-v-3bcc35ae"),t=t(),k_(),t),_9={key:0},y9={class:"ticker-wrapper"},v9=m9(()=>Ke("div",{class:"big-heading"},"News",-1)),w9={class:"text-update"},b9=ai("Today Is the Last Date of Admission In Government College University Faisalabad "),I9=ai("Today Is Entry Test In Comstats University Islamabad"),E9=ai("Admission Open In Ripah Internation University");function T9(t,e,n,r,s,i){const o=Ns("router-link");return s.ticker?(Ir(),_a("section",_9,[Ke("div",y9,[v9,Ke("div",w9,[Ke("ul",null,[Ke("li",null,[Qe(o,{to:{name:"details",params:{name:"Government-College-University-Faisalabad"}}},{default:Zr(()=>[b9]),_:1})]),Ke("li",null,[Qe(o,{to:{name:"details",params:{name:"COMSATS-University-Islamabad"}}},{default:Zr(()=>[I9]),_:1})]),Ke("li",null,[Qe(o,{to:{name:"details",params:{name:"Riphah-International-University"}}},{default:Zr(()=>[E9]),_:1})])])])])])):jc("",!0)}var S9=lu(g9,[["render",T9],["__scopeId","data-v-3bcc35ae"]]),C9="/Educatia/footer-social/fb.svg",A9="/Educatia/footer-social/vk.svg",k9="/Educatia/footer-social/twitter.svg",R9="/Educatia/footer-social/git.svg",N9="/Educatia/footer-social/yt.svg",P9="/Educatia/footer-social/instaa.svg";const D9={name:"Footer"},x9=lM('<h1 data-v-5c7cdad4>EDUCATIA</h1><div class="footer-social" data-v-5c7cdad4><a href="https://facebook.com/Dar.Ahmed0" target="_blank" data-v-5c7cdad4><img src="'+C9+'" alt="Facebook" data-v-5c7cdad4></a><a href="https://vk.com/id548454513" target="_blank" data-v-5c7cdad4><img src="'+A9+'" alt="VK" data-v-5c7cdad4></a><a href="https://twitter.com/AmmarAhmed961" target="_blank" data-v-5c7cdad4><img src="'+k9+'" alt="Twitter" data-v-5c7cdad4></a><a href="https://github.com/AA961" target="_blank" data-v-5c7cdad4><img src="'+R9+'" alt="Github" data-v-5c7cdad4></a><a href="https://www.youtube.com/channel/UCKZnPw6nQ9iag2uqB7vg-Yw" target="_blank" data-v-5c7cdad4><img src="'+N9+'" alt="Youtube" data-v-5c7cdad4></a><a href="https://Instagram.com/aa961019" target="_blank" data-v-5c7cdad4><img src="'+P9+'" alt="Youtube" data-v-5c7cdad4></a></div><div class="copyright" data-v-5c7cdad4> Copyright 2022 \xA9 Educatia.Com . All Right <br data-v-5c7cdad4> Reserved. </div>',3),O9=[x9];function M9(t,e,n,r,s,i){return Ir(),_a("footer",null,O9)}var wx=lu(D9,[["render",M9],["__scopeId","data-v-5c7cdad4"]]),L9=Object.freeze(Object.defineProperty({__proto__:null,default:wx},Symbol.toStringTag,{value:"Module"}));const F9={components:{NavVue:pL,tickerVue:S9,mobileNav:kL,footerVue:wx},data(){return{mainNav:!0,ticker:!0}},methods:{removeAll(){const t=yh();t.removeAll(t.univercities,t.univercities.length),console.log(t.univercities)},getDataFromBase(){const t=yh();t.univercities.length<1&&(this.removeAll(),t.getData())},checkingScreenSize(){window.innerWidth<760?this.mainNav=!1:this.mainNav=!0}},beforeMount(){this.checkingScreenSize()},mounted(){window.addEventListener("resize",()=>{this.checkingScreenSize()}),yh().getData()},created(){const t=yh(),e=setInterval(this.getDataFromBase,7e3);t.univercities.length>1&&clearInterval(e)}};function U9(t,e,n,r,s,i){const o=Ns("tickerVue"),a=Ns("NavVue"),c=Ns("mobileNav"),l=Ns("router-view"),u=Ns("footerVue");return Ir(),_a(er,null,[s.ticker?(Ir(),Ih(o,{key:0})):jc("",!0),s.mainNav?(Ir(),Ih(a,{key:1})):jc("",!0),s.mainNav?jc("",!0):(Ir(),Ih(c,{key:2})),Qe(l),Qe(u)],64)}var $9=lu(F9,[["render",U9]]),V9="firebase",B9="9.9.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ht.registerVersion(V9,B9,"app-compat");const q9={apiKey:"AIzaSyD2b62AFYQbjcAHQKD_sndun59ZC72lb8E",authDomain:"educatia-170f3.firebaseapp.com",projectId:"educatia-170f3",storageBucket:"educatia-170f3.appspot.com",messagingSenderId:"111445876419",appId:"1:111445876419:web:8c6ca1e04409a7ddf6cc76",measurementId:"G-5KM7Z5KJ8R"};ht.initializeApp(q9);const Vw=GM($9),j9=l9();Vw.use(j9);Vw.use(rL);Vw.mount("#app");export{er as F,H9 as K,L_ as T,lu as _,k_ as a,Ke as b,_a as c,Y9 as d,Qe as e,jc as f,Ih as g,G9 as h,Zr as i,ai as j,lM as k,ht as l,X9 as m,Q9 as n,Ir as o,A_ as p,J9 as q,Ns as r,K9 as t,yh as u,z9 as v,W9 as w};
