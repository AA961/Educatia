const lx=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function n(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerpolicy&&(i.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?i.credentials="include":r.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(r){if(r.ep)return;r.ep=!0;const i=n(r);fetch(r.href,i)}};lx();function e_(t,e){const n=Object.create(null),s=t.split(",");for(let r=0;r<s.length;r++)n[s[r]]=!0;return e?r=>!!n[r.toLowerCase()]:r=>!!n[r]}const ux="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",hx=e_(ux);function nS(t){return!!t||t===""}function t_(t){if(ee(t)){const e={};for(let n=0;n<t.length;n++){const s=t[n],r=kt(s)?px(s):t_(s);if(r)for(const i in r)e[i]=r[i]}return e}else{if(kt(t))return t;if(tt(t))return t}}const dx=/;(?![^(]*\))/g,fx=/:(.+)/;function px(t){const e={};return t.split(dx).forEach(n=>{if(n){const s=n.split(fx);s.length>1&&(e[s[0].trim()]=s[1].trim())}}),e}function n_(t){let e="";if(kt(t))e=t;else if(ee(t))for(let n=0;n<t.length;n++){const s=n_(t[n]);s&&(e+=s+" ")}else if(tt(t))for(const n in t)t[n]&&(e+=n+" ");return e.trim()}function gx(t,e){if(t.length!==e.length)return!1;let n=!0;for(let s=0;n&&s<t.length;s++)n=la(t[s],e[s]);return n}function la(t,e){if(t===e)return!0;let n=Nw(t),s=Nw(e);if(n||s)return n&&s?t.getTime()===e.getTime():!1;if(n=el(t),s=el(e),n||s)return t===e;if(n=ee(t),s=ee(e),n||s)return n&&s?gx(t,e):!1;if(n=tt(t),s=tt(e),n||s){if(!n||!s)return!1;const r=Object.keys(t).length,i=Object.keys(e).length;if(r!==i)return!1;for(const o in t){const a=t.hasOwnProperty(o),c=e.hasOwnProperty(o);if(a&&!c||!a&&c||!la(t[o],e[o]))return!1}}return String(t)===String(e)}function mx(t,e){return t.findIndex(n=>la(n,e))}const t9=t=>kt(t)?t:t==null?"":ee(t)||tt(t)&&(t.toString===iS||!le(t.toString))?JSON.stringify(t,sS,2):String(t),sS=(t,e)=>e&&e.__v_isRef?sS(t,e.value):Yo(e)?{[`Map(${e.size})`]:[...e.entries()].reduce((n,[s,r])=>(n[`${s} =>`]=r,n),{})}:Dd(e)?{[`Set(${e.size})`]:[...e.values()]}:tt(e)&&!ee(e)&&!oS(e)?String(e):e,Oe={},Qo=[],is=()=>{},_x=()=>!1,yx=/^on[^a-z]/,Pd=t=>yx.test(t),s_=t=>t.startsWith("onUpdate:"),Wt=Object.assign,r_=(t,e)=>{const n=t.indexOf(e);n>-1&&t.splice(n,1)},vx=Object.prototype.hasOwnProperty,ve=(t,e)=>vx.call(t,e),ee=Array.isArray,Yo=t=>Zl(t)==="[object Map]",Dd=t=>Zl(t)==="[object Set]",Nw=t=>Zl(t)==="[object Date]",le=t=>typeof t=="function",kt=t=>typeof t=="string",el=t=>typeof t=="symbol",tt=t=>t!==null&&typeof t=="object",rS=t=>tt(t)&&le(t.then)&&le(t.catch),iS=Object.prototype.toString,Zl=t=>iS.call(t),wx=t=>Zl(t).slice(8,-1),oS=t=>Zl(t)==="[object Object]",i_=t=>kt(t)&&t!=="NaN"&&t[0]!=="-"&&""+parseInt(t,10)===t,ch=e_(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),xd=t=>{const e=Object.create(null);return n=>e[n]||(e[n]=t(n))},bx=/-(\w)/g,Ds=xd(t=>t.replace(bx,(e,n)=>n?n.toUpperCase():"")),Ix=/\B([A-Z])/g,vo=xd(t=>t.replace(Ix,"-$1").toLowerCase()),Od=xd(t=>t.charAt(0).toUpperCase()+t.slice(1)),gp=xd(t=>t?`on${Od(t)}`:""),tl=(t,e)=>!Object.is(t,e),lh=(t,e)=>{for(let n=0;n<t.length;n++)t[n](e)},Sh=(t,e,n)=>{Object.defineProperty(t,e,{configurable:!0,enumerable:!1,value:n})},nl=t=>{const e=parseFloat(t);return isNaN(e)?t:e};let Pw;const Ex=()=>Pw||(Pw=typeof globalThis!="undefined"?globalThis:typeof self!="undefined"?self:typeof window!="undefined"?window:typeof global!="undefined"?global:{});let ms;class aS{constructor(e=!1){this.active=!0,this.effects=[],this.cleanups=[],!e&&ms&&(this.parent=ms,this.index=(ms.scopes||(ms.scopes=[])).push(this)-1)}run(e){if(this.active){const n=ms;try{return ms=this,e()}finally{ms=n}}}on(){ms=this}off(){ms=this.parent}stop(e){if(this.active){let n,s;for(n=0,s=this.effects.length;n<s;n++)this.effects[n].stop();for(n=0,s=this.cleanups.length;n<s;n++)this.cleanups[n]();if(this.scopes)for(n=0,s=this.scopes.length;n<s;n++)this.scopes[n].stop(!0);if(this.parent&&!e){const r=this.parent.scopes.pop();r&&r!==this&&(this.parent.scopes[this.index]=r,r.index=this.index)}this.active=!1}}}function cS(t){return new aS(t)}function Tx(t,e=ms){e&&e.active&&e.effects.push(t)}const o_=t=>{const e=new Set(t);return e.w=0,e.n=0,e},lS=t=>(t.w&jr)>0,uS=t=>(t.n&jr)>0,Sx=({deps:t})=>{if(t.length)for(let e=0;e<t.length;e++)t[e].w|=jr},Cx=t=>{const{deps:e}=t;if(e.length){let n=0;for(let s=0;s<e.length;s++){const r=e[s];lS(r)&&!uS(r)?r.delete(t):e[n++]=r,r.w&=~jr,r.n&=~jr}e.length=n}},yg=new WeakMap;let Ec=0,jr=1;const vg=30;let es;const $i=Symbol(""),wg=Symbol("");class a_{constructor(e,n=null,s){this.fn=e,this.scheduler=n,this.active=!0,this.deps=[],this.parent=void 0,Tx(this,s)}run(){if(!this.active)return this.fn();let e=es,n=Or;for(;e;){if(e===this)return;e=e.parent}try{return this.parent=es,es=this,Or=!0,jr=1<<++Ec,Ec<=vg?Sx(this):Dw(this),this.fn()}finally{Ec<=vg&&Cx(this),jr=1<<--Ec,es=this.parent,Or=n,this.parent=void 0,this.deferStop&&this.stop()}}stop(){es===this?this.deferStop=!0:this.active&&(Dw(this),this.onStop&&this.onStop(),this.active=!1)}}function Dw(t){const{deps:e}=t;if(e.length){for(let n=0;n<e.length;n++)e[n].delete(t);e.length=0}}let Or=!0;const hS=[];function Oa(){hS.push(Or),Or=!1}function Ma(){const t=hS.pop();Or=t===void 0?!0:t}function Pn(t,e,n){if(Or&&es){let s=yg.get(t);s||yg.set(t,s=new Map);let r=s.get(n);r||s.set(n,r=o_()),dS(r)}}function dS(t,e){let n=!1;Ec<=vg?uS(t)||(t.n|=jr,n=!lS(t)):n=!t.has(es),n&&(t.add(es),es.deps.push(t))}function sr(t,e,n,s,r,i){const o=yg.get(t);if(!o)return;let a=[];if(e==="clear")a=[...o.values()];else if(n==="length"&&ee(t))o.forEach((c,l)=>{(l==="length"||l>=s)&&a.push(c)});else switch(n!==void 0&&a.push(o.get(n)),e){case"add":ee(t)?i_(n)&&a.push(o.get("length")):(a.push(o.get($i)),Yo(t)&&a.push(o.get(wg)));break;case"delete":ee(t)||(a.push(o.get($i)),Yo(t)&&a.push(o.get(wg)));break;case"set":Yo(t)&&a.push(o.get($i));break}if(a.length===1)a[0]&&bg(a[0]);else{const c=[];for(const l of a)l&&c.push(...l);bg(o_(c))}}function bg(t,e){const n=ee(t)?t:[...t];for(const s of n)s.computed&&xw(s);for(const s of n)s.computed||xw(s)}function xw(t,e){(t!==es||t.allowRecurse)&&(t.scheduler?t.scheduler():t.run())}const Ax=e_("__proto__,__v_isRef,__isVue"),fS=new Set(Object.getOwnPropertyNames(Symbol).filter(t=>t!=="arguments"&&t!=="caller").map(t=>Symbol[t]).filter(el)),kx=c_(),Rx=c_(!1,!0),Nx=c_(!0),Ow=Px();function Px(){const t={};return["includes","indexOf","lastIndexOf"].forEach(e=>{t[e]=function(...n){const s=Se(this);for(let i=0,o=this.length;i<o;i++)Pn(s,"get",i+"");const r=s[e](...n);return r===-1||r===!1?s[e](...n.map(Se)):r}}),["push","pop","shift","unshift","splice"].forEach(e=>{t[e]=function(...n){Oa();const s=Se(this)[e].apply(this,n);return Ma(),s}}),t}function c_(t=!1,e=!1){return function(s,r,i){if(r==="__v_isReactive")return!t;if(r==="__v_isReadonly")return t;if(r==="__v_isShallow")return e;if(r==="__v_raw"&&i===(t?e?Gx:yS:e?_S:mS).get(s))return s;const o=ee(s);if(!t&&o&&ve(Ow,r))return Reflect.get(Ow,r,i);const a=Reflect.get(s,r,i);return(el(r)?fS.has(r):Ax(r))||(t||Pn(s,"get",r),e)?a:at(a)?o&&i_(r)?a:a.value:tt(a)?t?vS(a):La(a):a}}const Dx=pS(),xx=pS(!0);function pS(t=!1){return function(n,s,r,i){let o=n[s];if(sl(o)&&at(o)&&!at(r))return!1;if(!t&&!sl(r)&&(Ig(r)||(r=Se(r),o=Se(o)),!ee(n)&&at(o)&&!at(r)))return o.value=r,!0;const a=ee(n)&&i_(s)?Number(s)<n.length:ve(n,s),c=Reflect.set(n,s,r,i);return n===Se(i)&&(a?tl(r,o)&&sr(n,"set",s,r):sr(n,"add",s,r)),c}}function Ox(t,e){const n=ve(t,e);t[e];const s=Reflect.deleteProperty(t,e);return s&&n&&sr(t,"delete",e,void 0),s}function Mx(t,e){const n=Reflect.has(t,e);return(!el(e)||!fS.has(e))&&Pn(t,"has",e),n}function Lx(t){return Pn(t,"iterate",ee(t)?"length":$i),Reflect.ownKeys(t)}const gS={get:kx,set:Dx,deleteProperty:Ox,has:Mx,ownKeys:Lx},Fx={get:Nx,set(t,e){return!0},deleteProperty(t,e){return!0}},Ux=Wt({},gS,{get:Rx,set:xx}),l_=t=>t,Md=t=>Reflect.getPrototypeOf(t);function $u(t,e,n=!1,s=!1){t=t.__v_raw;const r=Se(t),i=Se(e);n||(e!==i&&Pn(r,"get",e),Pn(r,"get",i));const{has:o}=Md(r),a=s?l_:n?d_:rl;if(o.call(r,e))return a(t.get(e));if(o.call(r,i))return a(t.get(i));t!==r&&t.get(e)}function Vu(t,e=!1){const n=this.__v_raw,s=Se(n),r=Se(t);return e||(t!==r&&Pn(s,"has",t),Pn(s,"has",r)),t===r?n.has(t):n.has(t)||n.has(r)}function Bu(t,e=!1){return t=t.__v_raw,!e&&Pn(Se(t),"iterate",$i),Reflect.get(t,"size",t)}function Mw(t){t=Se(t);const e=Se(this);return Md(e).has.call(e,t)||(e.add(t),sr(e,"add",t,t)),this}function Lw(t,e){e=Se(e);const n=Se(this),{has:s,get:r}=Md(n);let i=s.call(n,t);i||(t=Se(t),i=s.call(n,t));const o=r.call(n,t);return n.set(t,e),i?tl(e,o)&&sr(n,"set",t,e):sr(n,"add",t,e),this}function Fw(t){const e=Se(this),{has:n,get:s}=Md(e);let r=n.call(e,t);r||(t=Se(t),r=n.call(e,t)),s&&s.call(e,t);const i=e.delete(t);return r&&sr(e,"delete",t,void 0),i}function Uw(){const t=Se(this),e=t.size!==0,n=t.clear();return e&&sr(t,"clear",void 0,void 0),n}function qu(t,e){return function(s,r){const i=this,o=i.__v_raw,a=Se(o),c=e?l_:t?d_:rl;return!t&&Pn(a,"iterate",$i),o.forEach((l,u)=>s.call(r,c(l),c(u),i))}}function ju(t,e,n){return function(...s){const r=this.__v_raw,i=Se(r),o=Yo(i),a=t==="entries"||t===Symbol.iterator&&o,c=t==="keys"&&o,l=r[t](...s),u=n?l_:e?d_:rl;return!e&&Pn(i,"iterate",c?wg:$i),{next(){const{value:h,done:d}=l.next();return d?{value:h,done:d}:{value:a?[u(h[0]),u(h[1])]:u(h),done:d}},[Symbol.iterator](){return this}}}}function mr(t){return function(...e){return t==="delete"?!1:this}}function $x(){const t={get(i){return $u(this,i)},get size(){return Bu(this)},has:Vu,add:Mw,set:Lw,delete:Fw,clear:Uw,forEach:qu(!1,!1)},e={get(i){return $u(this,i,!1,!0)},get size(){return Bu(this)},has:Vu,add:Mw,set:Lw,delete:Fw,clear:Uw,forEach:qu(!1,!0)},n={get(i){return $u(this,i,!0)},get size(){return Bu(this,!0)},has(i){return Vu.call(this,i,!0)},add:mr("add"),set:mr("set"),delete:mr("delete"),clear:mr("clear"),forEach:qu(!0,!1)},s={get(i){return $u(this,i,!0,!0)},get size(){return Bu(this,!0)},has(i){return Vu.call(this,i,!0)},add:mr("add"),set:mr("set"),delete:mr("delete"),clear:mr("clear"),forEach:qu(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(i=>{t[i]=ju(i,!1,!1),n[i]=ju(i,!0,!1),e[i]=ju(i,!1,!0),s[i]=ju(i,!0,!0)}),[t,n,e,s]}const[Vx,Bx,qx,jx]=$x();function u_(t,e){const n=e?t?jx:qx:t?Bx:Vx;return(s,r,i)=>r==="__v_isReactive"?!t:r==="__v_isReadonly"?t:r==="__v_raw"?s:Reflect.get(ve(n,r)&&r in s?n:s,r,i)}const Kx={get:u_(!1,!1)},Wx={get:u_(!1,!0)},Hx={get:u_(!0,!1)},mS=new WeakMap,_S=new WeakMap,yS=new WeakMap,Gx=new WeakMap;function zx(t){switch(t){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function Qx(t){return t.__v_skip||!Object.isExtensible(t)?0:zx(wx(t))}function La(t){return sl(t)?t:h_(t,!1,gS,Kx,mS)}function Yx(t){return h_(t,!1,Ux,Wx,_S)}function vS(t){return h_(t,!0,Fx,Hx,yS)}function h_(t,e,n,s,r){if(!tt(t)||t.__v_raw&&!(e&&t.__v_isReactive))return t;const i=r.get(t);if(i)return i;const o=Qx(t);if(o===0)return t;const a=new Proxy(t,o===2?s:n);return r.set(t,a),a}function Mr(t){return sl(t)?Mr(t.__v_raw):!!(t&&t.__v_isReactive)}function sl(t){return!!(t&&t.__v_isReadonly)}function Ig(t){return!!(t&&t.__v_isShallow)}function wS(t){return Mr(t)||sl(t)}function Se(t){const e=t&&t.__v_raw;return e?Se(e):t}function ua(t){return Sh(t,"__v_skip",!0),t}const rl=t=>tt(t)?La(t):t,d_=t=>tt(t)?vS(t):t;function bS(t){Or&&es&&(t=Se(t),dS(t.dep||(t.dep=o_())))}function IS(t,e){t=Se(t),t.dep&&bg(t.dep)}function at(t){return!!(t&&t.__v_isRef===!0)}function f_(t){return ES(t,!1)}function Jx(t){return ES(t,!0)}function ES(t,e){return at(t)?t:new Xx(t,e)}class Xx{constructor(e,n){this.__v_isShallow=n,this.dep=void 0,this.__v_isRef=!0,this._rawValue=n?e:Se(e),this._value=n?e:rl(e)}get value(){return bS(this),this._value}set value(e){e=this.__v_isShallow?e:Se(e),tl(e,this._rawValue)&&(this._rawValue=e,this._value=this.__v_isShallow?e:rl(e),IS(this))}}function Nc(t){return at(t)?t.value:t}const Zx={get:(t,e,n)=>Nc(Reflect.get(t,e,n)),set:(t,e,n,s)=>{const r=t[e];return at(r)&&!at(n)?(r.value=n,!0):Reflect.set(t,e,n,s)}};function TS(t){return Mr(t)?t:new Proxy(t,Zx)}function eO(t){const e=ee(t)?new Array(t.length):{};for(const n in t)e[n]=nO(t,n);return e}class tO{constructor(e,n,s){this._object=e,this._key=n,this._defaultValue=s,this.__v_isRef=!0}get value(){const e=this._object[this._key];return e===void 0?this._defaultValue:e}set value(e){this._object[this._key]=e}}function nO(t,e,n){const s=t[e];return at(s)?s:new tO(t,e,n)}class sO{constructor(e,n,s,r){this._setter=n,this.dep=void 0,this.__v_isRef=!0,this._dirty=!0,this.effect=new a_(e,()=>{this._dirty||(this._dirty=!0,IS(this))}),this.effect.computed=this,this.effect.active=this._cacheable=!r,this.__v_isReadonly=s}get value(){const e=Se(this);return bS(e),(e._dirty||!e._cacheable)&&(e._dirty=!1,e._value=e.effect.run()),e._value}set value(e){this._setter(e)}}function rO(t,e,n=!1){let s,r;const i=le(t);return i?(s=t,r=is):(s=t.get,r=t.set),new sO(s,r,i||!r,n)}function Lr(t,e,n,s){let r;try{r=s?t(...s):t()}catch(i){Ld(i,e,n)}return r}function jn(t,e,n,s){if(le(t)){const i=Lr(t,e,n,s);return i&&rS(i)&&i.catch(o=>{Ld(o,e,n)}),i}const r=[];for(let i=0;i<t.length;i++)r.push(jn(t[i],e,n,s));return r}function Ld(t,e,n,s=!0){const r=e?e.vnode:null;if(e){let i=e.parent;const o=e.proxy,a=n;for(;i;){const l=i.ec;if(l){for(let u=0;u<l.length;u++)if(l[u](t,o,a)===!1)return}i=i.parent}const c=e.appContext.config.errorHandler;if(c){Lr(c,null,10,[t,o,a]);return}}iO(t,n,r,s)}function iO(t,e,n,s=!0){console.error(t)}let Ch=!1,Eg=!1;const Cn=[];let Hs=0;const Pc=[];let Tc=null,qo=0;const Dc=[];let Tr=null,jo=0;const SS=Promise.resolve();let p_=null,Tg=null;function g_(t){const e=p_||SS;return t?e.then(this?t.bind(this):t):e}function oO(t){let e=Hs+1,n=Cn.length;for(;e<n;){const s=e+n>>>1;il(Cn[s])<t?e=s+1:n=s}return e}function CS(t){(!Cn.length||!Cn.includes(t,Ch&&t.allowRecurse?Hs+1:Hs))&&t!==Tg&&(t.id==null?Cn.push(t):Cn.splice(oO(t.id),0,t),AS())}function AS(){!Ch&&!Eg&&(Eg=!0,p_=SS.then(NS))}function aO(t){const e=Cn.indexOf(t);e>Hs&&Cn.splice(e,1)}function kS(t,e,n,s){ee(t)?n.push(...t):(!e||!e.includes(t,t.allowRecurse?s+1:s))&&n.push(t),AS()}function cO(t){kS(t,Tc,Pc,qo)}function lO(t){kS(t,Tr,Dc,jo)}function Fd(t,e=null){if(Pc.length){for(Tg=e,Tc=[...new Set(Pc)],Pc.length=0,qo=0;qo<Tc.length;qo++)Tc[qo]();Tc=null,qo=0,Tg=null,Fd(t,e)}}function RS(t){if(Fd(),Dc.length){const e=[...new Set(Dc)];if(Dc.length=0,Tr){Tr.push(...e);return}for(Tr=e,Tr.sort((n,s)=>il(n)-il(s)),jo=0;jo<Tr.length;jo++)Tr[jo]();Tr=null,jo=0}}const il=t=>t.id==null?1/0:t.id;function NS(t){Eg=!1,Ch=!0,Fd(t),Cn.sort((n,s)=>il(n)-il(s));const e=is;try{for(Hs=0;Hs<Cn.length;Hs++){const n=Cn[Hs];n&&n.active!==!1&&Lr(n,null,14)}}finally{Hs=0,Cn.length=0,RS(),Ch=!1,p_=null,(Cn.length||Pc.length||Dc.length)&&NS(t)}}function uO(t,e,...n){if(t.isUnmounted)return;const s=t.vnode.props||Oe;let r=n;const i=e.startsWith("update:"),o=i&&e.slice(7);if(o&&o in s){const u=`${o==="modelValue"?"model":o}Modifiers`,{number:h,trim:d}=s[u]||Oe;d&&(r=n.map(f=>f.trim())),h&&(r=n.map(nl))}let a,c=s[a=gp(e)]||s[a=gp(Ds(e))];!c&&i&&(c=s[a=gp(vo(e))]),c&&jn(c,t,6,r);const l=s[a+"Once"];if(l){if(!t.emitted)t.emitted={};else if(t.emitted[a])return;t.emitted[a]=!0,jn(l,t,6,r)}}function PS(t,e,n=!1){const s=e.emitsCache,r=s.get(t);if(r!==void 0)return r;const i=t.emits;let o={},a=!1;if(!le(t)){const c=l=>{const u=PS(l,e,!0);u&&(a=!0,Wt(o,u))};!n&&e.mixins.length&&e.mixins.forEach(c),t.extends&&c(t.extends),t.mixins&&t.mixins.forEach(c)}return!i&&!a?(s.set(t,null),null):(ee(i)?i.forEach(c=>o[c]=null):Wt(o,i),s.set(t,o),o)}function Ud(t,e){return!t||!Pd(e)?!1:(e=e.slice(2).replace(/Once$/,""),ve(t,e[0].toLowerCase()+e.slice(1))||ve(t,vo(e))||ve(t,e))}let Un=null,$d=null;function Ah(t){const e=Un;return Un=t,$d=t&&t.type.__scopeId||null,e}function hO(t){$d=t}function dO(){$d=null}function Sg(t,e=Un,n){if(!e||t._n)return t;const s=(...r)=>{s._d&&Qw(-1);const i=Ah(e),o=t(...r);return Ah(i),s._d&&Qw(1),o};return s._n=!0,s._c=!0,s._d=!0,s}function mp(t){const{type:e,vnode:n,proxy:s,withProxy:r,props:i,propsOptions:[o],slots:a,attrs:c,emit:l,render:u,renderCache:h,data:d,setupState:f,ctx:p,inheritAttrs:_}=t;let y,I;const N=Ah(t);try{if(n.shapeFlag&4){const M=r||s;y=_s(u.call(M,M,h,i,f,d,p)),I=c}else{const M=e;y=_s(M.length>1?M(i,{attrs:c,slots:a,emit:l}):M(i,null)),I=e.props?c:fO(c)}}catch(M){Oc.length=0,Ld(M,t,1),y=$t(os)}let k=y;if(I&&_!==!1){const M=Object.keys(I),{shapeFlag:j}=k;M.length&&j&7&&(o&&M.some(s_)&&(I=pO(I,o)),k=Kr(k,I))}return n.dirs&&(k=Kr(k),k.dirs=k.dirs?k.dirs.concat(n.dirs):n.dirs),n.transition&&(k.transition=n.transition),y=k,Ah(N),y}const fO=t=>{let e;for(const n in t)(n==="class"||n==="style"||Pd(n))&&((e||(e={}))[n]=t[n]);return e},pO=(t,e)=>{const n={};for(const s in t)(!s_(s)||!(s.slice(9)in e))&&(n[s]=t[s]);return n};function gO(t,e,n){const{props:s,children:r,component:i}=t,{props:o,children:a,patchFlag:c}=e,l=i.emitsOptions;if(e.dirs||e.transition)return!0;if(n&&c>=0){if(c&1024)return!0;if(c&16)return s?$w(s,o,l):!!o;if(c&8){const u=e.dynamicProps;for(let h=0;h<u.length;h++){const d=u[h];if(o[d]!==s[d]&&!Ud(l,d))return!0}}}else return(r||a)&&(!a||!a.$stable)?!0:s===o?!1:s?o?$w(s,o,l):!0:!!o;return!1}function $w(t,e,n){const s=Object.keys(e);if(s.length!==Object.keys(t).length)return!0;for(let r=0;r<s.length;r++){const i=s[r];if(e[i]!==t[i]&&!Ud(n,i))return!0}return!1}function mO({vnode:t,parent:e},n){for(;e&&e.subTree===t;)(t=e.vnode).el=n,e=e.parent}const _O=t=>t.__isSuspense;function yO(t,e){e&&e.pendingBranch?ee(t)?e.effects.push(...t):e.effects.push(t):lO(t)}function uh(t,e){if(Tt){let n=Tt.provides;const s=Tt.parent&&Tt.parent.provides;s===n&&(n=Tt.provides=Object.create(s)),n[t]=e}}function Cs(t,e,n=!1){const s=Tt||Un;if(s){const r=s.parent==null?s.vnode.appContext&&s.vnode.appContext.provides:s.parent.provides;if(r&&t in r)return r[t];if(arguments.length>1)return n&&le(e)?e.call(s.proxy):e}}const Vw={};function xc(t,e,n){return DS(t,e,n)}function DS(t,e,{immediate:n,deep:s,flush:r,onTrack:i,onTrigger:o}=Oe){const a=Tt;let c,l=!1,u=!1;if(at(t)?(c=()=>t.value,l=Ig(t)):Mr(t)?(c=()=>t,s=!0):ee(t)?(u=!0,l=t.some(I=>Mr(I)||Ig(I)),c=()=>t.map(I=>{if(at(I))return I.value;if(Mr(I))return Pi(I);if(le(I))return Lr(I,a,2)})):le(t)?e?c=()=>Lr(t,a,2):c=()=>{if(!(a&&a.isUnmounted))return h&&h(),jn(t,a,3,[d])}:c=is,e&&s){const I=c;c=()=>Pi(I())}let h,d=I=>{h=y.onStop=()=>{Lr(I,a,4)}};if(al)return d=is,e?n&&jn(e,a,3,[c(),u?[]:void 0,d]):c(),is;let f=u?[]:Vw;const p=()=>{if(!!y.active)if(e){const I=y.run();(s||l||(u?I.some((N,k)=>tl(N,f[k])):tl(I,f)))&&(h&&h(),jn(e,a,3,[I,f===Vw?void 0:f,d]),f=I)}else y.run()};p.allowRecurse=!!e;let _;r==="sync"?_=p:r==="post"?_=()=>fn(p,a&&a.suspense):_=()=>cO(p);const y=new a_(c,_);return e?n?p():f=y.run():r==="post"?fn(y.run.bind(y),a&&a.suspense):y.run(),()=>{y.stop(),a&&a.scope&&r_(a.scope.effects,y)}}function vO(t,e,n){const s=this.proxy,r=kt(t)?t.includes(".")?xS(s,t):()=>s[t]:t.bind(s,s);let i;le(e)?i=e:(i=e.handler,n=e);const o=Tt;ha(this);const a=DS(r,i.bind(s),n);return o?ha(o):Vi(),a}function xS(t,e){const n=e.split(".");return()=>{let s=t;for(let r=0;r<n.length&&s;r++)s=s[n[r]];return s}}function Pi(t,e){if(!tt(t)||t.__v_skip||(e=e||new Set,e.has(t)))return t;if(e.add(t),at(t))Pi(t.value,e);else if(ee(t))for(let n=0;n<t.length;n++)Pi(t[n],e);else if(Dd(t)||Yo(t))t.forEach(n=>{Pi(n,e)});else if(oS(t))for(const n in t)Pi(t[n],e);return t}function wO(){const t={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return $S(()=>{t.isMounted=!0}),VS(()=>{t.isUnmounting=!0}),t}const Ln=[Function,Array],bO={name:"BaseTransition",props:{mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:Ln,onEnter:Ln,onAfterEnter:Ln,onEnterCancelled:Ln,onBeforeLeave:Ln,onLeave:Ln,onAfterLeave:Ln,onLeaveCancelled:Ln,onBeforeAppear:Ln,onAppear:Ln,onAfterAppear:Ln,onAppearCancelled:Ln},setup(t,{slots:e}){const n=b_(),s=wO();let r;return()=>{const i=e.default&&LS(e.default(),!0);if(!i||!i.length)return;let o=i[0];if(i.length>1){for(const _ of i)if(_.type!==os){o=_;break}}const a=Se(t),{mode:c}=a;if(s.isLeaving)return _p(o);const l=Bw(o);if(!l)return _p(o);const u=Cg(l,a,s,n);Ag(l,u);const h=n.subTree,d=h&&Bw(h);let f=!1;const{getTransitionKey:p}=l.type;if(p){const _=p();r===void 0?r=_:_!==r&&(r=_,f=!0)}if(d&&d.type!==os&&(!Ti(l,d)||f)){const _=Cg(d,a,s,n);if(Ag(d,_),c==="out-in")return s.isLeaving=!0,_.afterLeave=()=>{s.isLeaving=!1,n.update()},_p(o);c==="in-out"&&l.type!==os&&(_.delayLeave=(y,I,N)=>{const k=MS(s,d);k[String(d.key)]=d,y._leaveCb=()=>{I(),y._leaveCb=void 0,delete u.delayedLeave},u.delayedLeave=N})}return o}}},OS=bO;function MS(t,e){const{leavingVNodes:n}=t;let s=n.get(e.type);return s||(s=Object.create(null),n.set(e.type,s)),s}function Cg(t,e,n,s){const{appear:r,mode:i,persisted:o=!1,onBeforeEnter:a,onEnter:c,onAfterEnter:l,onEnterCancelled:u,onBeforeLeave:h,onLeave:d,onAfterLeave:f,onLeaveCancelled:p,onBeforeAppear:_,onAppear:y,onAfterAppear:I,onAppearCancelled:N}=e,k=String(t.key),M=MS(n,t),j=(V,ie)=>{V&&jn(V,s,9,ie)},Y=(V,ie)=>{const _e=ie[1];j(V,ie),ee(V)?V.every(Fe=>Fe.length<=1)&&_e():V.length<=1&&_e()},z={mode:i,persisted:o,beforeEnter(V){let ie=a;if(!n.isMounted)if(r)ie=_||a;else return;V._leaveCb&&V._leaveCb(!0);const _e=M[k];_e&&Ti(t,_e)&&_e.el._leaveCb&&_e.el._leaveCb(),j(ie,[V])},enter(V){let ie=c,_e=l,Fe=u;if(!n.isMounted)if(r)ie=y||c,_e=I||l,Fe=N||u;else return;let H=!1;const ke=V._enterCb=Je=>{H||(H=!0,Je?j(Fe,[V]):j(_e,[V]),z.delayedLeave&&z.delayedLeave(),V._enterCb=void 0)};ie?Y(ie,[V,ke]):ke()},leave(V,ie){const _e=String(t.key);if(V._enterCb&&V._enterCb(!0),n.isUnmounting)return ie();j(h,[V]);let Fe=!1;const H=V._leaveCb=ke=>{Fe||(Fe=!0,ie(),ke?j(p,[V]):j(f,[V]),V._leaveCb=void 0,M[_e]===t&&delete M[_e])};M[_e]=t,d?Y(d,[V,H]):H()},clone(V){return Cg(V,e,n,s)}};return z}function _p(t){if(Vd(t))return t=Kr(t),t.children=null,t}function Bw(t){return Vd(t)?t.children?t.children[0]:void 0:t}function Ag(t,e){t.shapeFlag&6&&t.component?Ag(t.component.subTree,e):t.shapeFlag&128?(t.ssContent.transition=e.clone(t.ssContent),t.ssFallback.transition=e.clone(t.ssFallback)):t.transition=e}function LS(t,e=!1,n){let s=[],r=0;for(let i=0;i<t.length;i++){let o=t[i];const a=n==null?o.key:String(n)+String(o.key!=null?o.key:i);o.type===Zn?(o.patchFlag&128&&r++,s=s.concat(LS(o.children,e,a))):(e||o.type!==os)&&s.push(a!=null?Kr(o,{key:a}):o)}if(r>1)for(let i=0;i<s.length;i++)s[i].patchFlag=-2;return s}function FS(t){return le(t)?{setup:t,name:t.name}:t}const hh=t=>!!t.type.__asyncLoader,Vd=t=>t.type.__isKeepAlive;function IO(t,e){US(t,"a",e)}function EO(t,e){US(t,"da",e)}function US(t,e,n=Tt){const s=t.__wdc||(t.__wdc=()=>{let r=n;for(;r;){if(r.isDeactivated)return;r=r.parent}return t()});if(Bd(e,s,n),n){let r=n.parent;for(;r&&r.parent;)Vd(r.parent.vnode)&&TO(s,e,n,r),r=r.parent}}function TO(t,e,n,s){const r=Bd(e,t,s,!0);m_(()=>{r_(s[e],r)},n)}function Bd(t,e,n=Tt,s=!1){if(n){const r=n[t]||(n[t]=[]),i=e.__weh||(e.__weh=(...o)=>{if(n.isUnmounted)return;Oa(),ha(n);const a=jn(e,n,t,o);return Vi(),Ma(),a});return s?r.unshift(i):r.push(i),i}}const lr=t=>(e,n=Tt)=>(!al||t==="sp")&&Bd(t,e,n),SO=lr("bm"),$S=lr("m"),CO=lr("bu"),AO=lr("u"),VS=lr("bum"),m_=lr("um"),kO=lr("sp"),RO=lr("rtg"),NO=lr("rtc");function PO(t,e=Tt){Bd("ec",t,e)}function n9(t,e){const n=Un;if(n===null)return t;const s=jd(n)||n.proxy,r=t.dirs||(t.dirs=[]);for(let i=0;i<e.length;i++){let[o,a,c,l=Oe]=e[i];le(o)&&(o={mounted:o,updated:o}),o.deep&&Pi(a),r.push({dir:o,instance:s,value:a,oldValue:void 0,arg:c,modifiers:l})}return t}function fi(t,e,n,s){const r=t.dirs,i=e&&e.dirs;for(let o=0;o<r.length;o++){const a=r[o];i&&(a.oldValue=i[o].value);let c=a.dir[s];c&&(Oa(),jn(c,n,8,[t.el,a,t,e]),Ma())}}const BS="components";function kg(t,e){return xO(BS,t,!0,e)||t}const DO=Symbol();function xO(t,e,n=!0,s=!1){const r=Un||Tt;if(r){const i=r.type;if(t===BS){const a=lM(i,!1);if(a&&(a===e||a===Ds(e)||a===Od(Ds(e))))return i}const o=qw(r[t]||i[t],e)||qw(r.appContext[t],e);return!o&&s?i:o}}function qw(t,e){return t&&(t[e]||t[Ds(e)]||t[Od(Ds(e))])}function s9(t,e,n,s){let r;const i=n&&n[s];if(ee(t)||kt(t)){r=new Array(t.length);for(let o=0,a=t.length;o<a;o++)r[o]=e(t[o],o,void 0,i&&i[o])}else if(typeof t=="number"){r=new Array(t);for(let o=0;o<t;o++)r[o]=e(o+1,o,void 0,i&&i[o])}else if(tt(t))if(t[Symbol.iterator])r=Array.from(t,(o,a)=>e(o,a,void 0,i&&i[a]));else{const o=Object.keys(t);r=new Array(o.length);for(let a=0,c=o.length;a<c;a++){const l=o[a];r[a]=e(t[l],l,a,i&&i[a])}}else r=[];return n&&(n[s]=r),r}const Rg=t=>t?tC(t)?jd(t)||t.proxy:Rg(t.parent):null,kh=Wt(Object.create(null),{$:t=>t,$el:t=>t.vnode.el,$data:t=>t.data,$props:t=>t.props,$attrs:t=>t.attrs,$slots:t=>t.slots,$refs:t=>t.refs,$parent:t=>Rg(t.parent),$root:t=>Rg(t.root),$emit:t=>t.emit,$options:t=>jS(t),$forceUpdate:t=>t.f||(t.f=()=>CS(t.update)),$nextTick:t=>t.n||(t.n=g_.bind(t.proxy)),$watch:t=>vO.bind(t)}),OO={get({_:t},e){const{ctx:n,setupState:s,data:r,props:i,accessCache:o,type:a,appContext:c}=t;let l;if(e[0]!=="$"){const f=o[e];if(f!==void 0)switch(f){case 1:return s[e];case 2:return r[e];case 4:return n[e];case 3:return i[e]}else{if(s!==Oe&&ve(s,e))return o[e]=1,s[e];if(r!==Oe&&ve(r,e))return o[e]=2,r[e];if((l=t.propsOptions[0])&&ve(l,e))return o[e]=3,i[e];if(n!==Oe&&ve(n,e))return o[e]=4,n[e];Ng&&(o[e]=0)}}const u=kh[e];let h,d;if(u)return e==="$attrs"&&Pn(t,"get",e),u(t);if((h=a.__cssModules)&&(h=h[e]))return h;if(n!==Oe&&ve(n,e))return o[e]=4,n[e];if(d=c.config.globalProperties,ve(d,e))return d[e]},set({_:t},e,n){const{data:s,setupState:r,ctx:i}=t;return r!==Oe&&ve(r,e)?(r[e]=n,!0):s!==Oe&&ve(s,e)?(s[e]=n,!0):ve(t.props,e)||e[0]==="$"&&e.slice(1)in t?!1:(i[e]=n,!0)},has({_:{data:t,setupState:e,accessCache:n,ctx:s,appContext:r,propsOptions:i}},o){let a;return!!n[o]||t!==Oe&&ve(t,o)||e!==Oe&&ve(e,o)||(a=i[0])&&ve(a,o)||ve(s,o)||ve(kh,o)||ve(r.config.globalProperties,o)},defineProperty(t,e,n){return n.get!=null?t._.accessCache[e]=0:ve(n,"value")&&this.set(t,e,n.value,null),Reflect.defineProperty(t,e,n)}};let Ng=!0;function MO(t){const e=jS(t),n=t.proxy,s=t.ctx;Ng=!1,e.beforeCreate&&jw(e.beforeCreate,t,"bc");const{data:r,computed:i,methods:o,watch:a,provide:c,inject:l,created:u,beforeMount:h,mounted:d,beforeUpdate:f,updated:p,activated:_,deactivated:y,beforeDestroy:I,beforeUnmount:N,destroyed:k,unmounted:M,render:j,renderTracked:Y,renderTriggered:z,errorCaptured:V,serverPrefetch:ie,expose:_e,inheritAttrs:Fe,components:H,directives:ke,filters:Je}=e;if(l&&LO(l,s,null,t.appContext.config.unwrapInjectedRef),o)for(const Ue in o){const Re=o[Ue];le(Re)&&(s[Ue]=Re.bind(n))}if(r){const Ue=r.call(n,n);tt(Ue)&&(t.data=La(Ue))}if(Ng=!0,i)for(const Ue in i){const Re=i[Ue],En=le(Re)?Re.bind(n,n):le(Re.get)?Re.get.bind(n,n):is,Do=!le(Re)&&le(Re.set)?Re.set.bind(n):is,qs=ts({get:En,set:Do});Object.defineProperty(s,Ue,{enumerable:!0,configurable:!0,get:()=>qs.value,set:ds=>qs.value=ds})}if(a)for(const Ue in a)qS(a[Ue],s,n,Ue);if(c){const Ue=le(c)?c.call(n):c;Reflect.ownKeys(Ue).forEach(Re=>{uh(Re,Ue[Re])})}u&&jw(u,t,"c");function Ze(Ue,Re){ee(Re)?Re.forEach(En=>Ue(En.bind(n))):Re&&Ue(Re.bind(n))}if(Ze(SO,h),Ze($S,d),Ze(CO,f),Ze(AO,p),Ze(IO,_),Ze(EO,y),Ze(PO,V),Ze(NO,Y),Ze(RO,z),Ze(VS,N),Ze(m_,M),Ze(kO,ie),ee(_e))if(_e.length){const Ue=t.exposed||(t.exposed={});_e.forEach(Re=>{Object.defineProperty(Ue,Re,{get:()=>n[Re],set:En=>n[Re]=En})})}else t.exposed||(t.exposed={});j&&t.render===is&&(t.render=j),Fe!=null&&(t.inheritAttrs=Fe),H&&(t.components=H),ke&&(t.directives=ke)}function LO(t,e,n=is,s=!1){ee(t)&&(t=Pg(t));for(const r in t){const i=t[r];let o;tt(i)?"default"in i?o=Cs(i.from||r,i.default,!0):o=Cs(i.from||r):o=Cs(i),at(o)&&s?Object.defineProperty(e,r,{enumerable:!0,configurable:!0,get:()=>o.value,set:a=>o.value=a}):e[r]=o}}function jw(t,e,n){jn(ee(t)?t.map(s=>s.bind(e.proxy)):t.bind(e.proxy),e,n)}function qS(t,e,n,s){const r=s.includes(".")?xS(n,s):()=>n[s];if(kt(t)){const i=e[t];le(i)&&xc(r,i)}else if(le(t))xc(r,t.bind(n));else if(tt(t))if(ee(t))t.forEach(i=>qS(i,e,n,s));else{const i=le(t.handler)?t.handler.bind(n):e[t.handler];le(i)&&xc(r,i,t)}}function jS(t){const e=t.type,{mixins:n,extends:s}=e,{mixins:r,optionsCache:i,config:{optionMergeStrategies:o}}=t.appContext,a=i.get(e);let c;return a?c=a:!r.length&&!n&&!s?c=e:(c={},r.length&&r.forEach(l=>Rh(c,l,o,!0)),Rh(c,e,o)),i.set(e,c),c}function Rh(t,e,n,s=!1){const{mixins:r,extends:i}=e;i&&Rh(t,i,n,!0),r&&r.forEach(o=>Rh(t,o,n,!0));for(const o in e)if(!(s&&o==="expose")){const a=FO[o]||n&&n[o];t[o]=a?a(t[o],e[o]):e[o]}return t}const FO={data:Kw,props:vi,emits:vi,methods:vi,computed:vi,beforeCreate:en,created:en,beforeMount:en,mounted:en,beforeUpdate:en,updated:en,beforeDestroy:en,beforeUnmount:en,destroyed:en,unmounted:en,activated:en,deactivated:en,errorCaptured:en,serverPrefetch:en,components:vi,directives:vi,watch:$O,provide:Kw,inject:UO};function Kw(t,e){return e?t?function(){return Wt(le(t)?t.call(this,this):t,le(e)?e.call(this,this):e)}:e:t}function UO(t,e){return vi(Pg(t),Pg(e))}function Pg(t){if(ee(t)){const e={};for(let n=0;n<t.length;n++)e[t[n]]=t[n];return e}return t}function en(t,e){return t?[...new Set([].concat(t,e))]:e}function vi(t,e){return t?Wt(Wt(Object.create(null),t),e):e}function $O(t,e){if(!t)return e;if(!e)return t;const n=Wt(Object.create(null),t);for(const s in e)n[s]=en(t[s],e[s]);return n}function VO(t,e,n,s=!1){const r={},i={};Sh(i,qd,1),t.propsDefaults=Object.create(null),KS(t,e,r,i);for(const o in t.propsOptions[0])o in r||(r[o]=void 0);n?t.props=s?r:Yx(r):t.type.props?t.props=r:t.props=i,t.attrs=i}function BO(t,e,n,s){const{props:r,attrs:i,vnode:{patchFlag:o}}=t,a=Se(r),[c]=t.propsOptions;let l=!1;if((s||o>0)&&!(o&16)){if(o&8){const u=t.vnode.dynamicProps;for(let h=0;h<u.length;h++){let d=u[h];if(Ud(t.emitsOptions,d))continue;const f=e[d];if(c)if(ve(i,d))f!==i[d]&&(i[d]=f,l=!0);else{const p=Ds(d);r[p]=Dg(c,a,p,f,t,!1)}else f!==i[d]&&(i[d]=f,l=!0)}}}else{KS(t,e,r,i)&&(l=!0);let u;for(const h in a)(!e||!ve(e,h)&&((u=vo(h))===h||!ve(e,u)))&&(c?n&&(n[h]!==void 0||n[u]!==void 0)&&(r[h]=Dg(c,a,h,void 0,t,!0)):delete r[h]);if(i!==a)for(const h in i)(!e||!ve(e,h)&&!0)&&(delete i[h],l=!0)}l&&sr(t,"set","$attrs")}function KS(t,e,n,s){const[r,i]=t.propsOptions;let o=!1,a;if(e)for(let c in e){if(ch(c))continue;const l=e[c];let u;r&&ve(r,u=Ds(c))?!i||!i.includes(u)?n[u]=l:(a||(a={}))[u]=l:Ud(t.emitsOptions,c)||(!(c in s)||l!==s[c])&&(s[c]=l,o=!0)}if(i){const c=Se(n),l=a||Oe;for(let u=0;u<i.length;u++){const h=i[u];n[h]=Dg(r,c,h,l[h],t,!ve(l,h))}}return o}function Dg(t,e,n,s,r,i){const o=t[n];if(o!=null){const a=ve(o,"default");if(a&&s===void 0){const c=o.default;if(o.type!==Function&&le(c)){const{propsDefaults:l}=r;n in l?s=l[n]:(ha(r),s=l[n]=c.call(null,e),Vi())}else s=c}o[0]&&(i&&!a?s=!1:o[1]&&(s===""||s===vo(n))&&(s=!0))}return s}function WS(t,e,n=!1){const s=e.propsCache,r=s.get(t);if(r)return r;const i=t.props,o={},a=[];let c=!1;if(!le(t)){const u=h=>{c=!0;const[d,f]=WS(h,e,!0);Wt(o,d),f&&a.push(...f)};!n&&e.mixins.length&&e.mixins.forEach(u),t.extends&&u(t.extends),t.mixins&&t.mixins.forEach(u)}if(!i&&!c)return s.set(t,Qo),Qo;if(ee(i))for(let u=0;u<i.length;u++){const h=Ds(i[u]);Ww(h)&&(o[h]=Oe)}else if(i)for(const u in i){const h=Ds(u);if(Ww(h)){const d=i[u],f=o[h]=ee(d)||le(d)?{type:d}:d;if(f){const p=zw(Boolean,f.type),_=zw(String,f.type);f[0]=p>-1,f[1]=_<0||p<_,(p>-1||ve(f,"default"))&&a.push(h)}}}const l=[o,a];return s.set(t,l),l}function Ww(t){return t[0]!=="$"}function Hw(t){const e=t&&t.toString().match(/^\s*function (\w+)/);return e?e[1]:t===null?"null":""}function Gw(t,e){return Hw(t)===Hw(e)}function zw(t,e){return ee(e)?e.findIndex(n=>Gw(n,t)):le(e)&&Gw(e,t)?0:-1}const HS=t=>t[0]==="_"||t==="$stable",__=t=>ee(t)?t.map(_s):[_s(t)],qO=(t,e,n)=>{if(e._n)return e;const s=Sg((...r)=>__(e(...r)),n);return s._c=!1,s},GS=(t,e,n)=>{const s=t._ctx;for(const r in t){if(HS(r))continue;const i=t[r];if(le(i))e[r]=qO(r,i,s);else if(i!=null){const o=__(i);e[r]=()=>o}}},zS=(t,e)=>{const n=__(e);t.slots.default=()=>n},jO=(t,e)=>{if(t.vnode.shapeFlag&32){const n=e._;n?(t.slots=Se(e),Sh(e,"_",n)):GS(e,t.slots={})}else t.slots={},e&&zS(t,e);Sh(t.slots,qd,1)},KO=(t,e,n)=>{const{vnode:s,slots:r}=t;let i=!0,o=Oe;if(s.shapeFlag&32){const a=e._;a?n&&a===1?i=!1:(Wt(r,e),!n&&a===1&&delete r._):(i=!e.$stable,GS(e,r)),o=e}else e&&(zS(t,e),o={default:1});if(i)for(const a in r)!HS(a)&&!(a in o)&&delete r[a]};function QS(){return{app:null,config:{isNativeTag:_x,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let WO=0;function HO(t,e){return function(s,r=null){le(s)||(s=Object.assign({},s)),r!=null&&!tt(r)&&(r=null);const i=QS(),o=new Set;let a=!1;const c=i.app={_uid:WO++,_component:s,_props:r,_container:null,_context:i,_instance:null,version:hM,get config(){return i.config},set config(l){},use(l,...u){return o.has(l)||(l&&le(l.install)?(o.add(l),l.install(c,...u)):le(l)&&(o.add(l),l(c,...u))),c},mixin(l){return i.mixins.includes(l)||i.mixins.push(l),c},component(l,u){return u?(i.components[l]=u,c):i.components[l]},directive(l,u){return u?(i.directives[l]=u,c):i.directives[l]},mount(l,u,h){if(!a){const d=$t(s,r);return d.appContext=i,u&&e?e(d,l):t(d,l,h),a=!0,c._container=l,l.__vue_app__=c,jd(d.component)||d.component.proxy}},unmount(){a&&(t(null,c._container),delete c._container.__vue_app__)},provide(l,u){return i.provides[l]=u,c}};return c}}function xg(t,e,n,s,r=!1){if(ee(t)){t.forEach((d,f)=>xg(d,e&&(ee(e)?e[f]:e),n,s,r));return}if(hh(s)&&!r)return;const i=s.shapeFlag&4?jd(s.component)||s.component.proxy:s.el,o=r?null:i,{i:a,r:c}=t,l=e&&e.r,u=a.refs===Oe?a.refs={}:a.refs,h=a.setupState;if(l!=null&&l!==c&&(kt(l)?(u[l]=null,ve(h,l)&&(h[l]=null)):at(l)&&(l.value=null)),le(c))Lr(c,a,12,[o,u]);else{const d=kt(c),f=at(c);if(d||f){const p=()=>{if(t.f){const _=d?u[c]:c.value;r?ee(_)&&r_(_,i):ee(_)?_.includes(i)||_.push(i):d?(u[c]=[i],ve(h,c)&&(h[c]=u[c])):(c.value=[i],t.k&&(u[t.k]=c.value))}else d?(u[c]=o,ve(h,c)&&(h[c]=o)):f&&(c.value=o,t.k&&(u[t.k]=o))};o?(p.id=-1,fn(p,n)):p()}}}const fn=yO;function GO(t){return zO(t)}function zO(t,e){const n=Ex();n.__VUE__=!0;const{insert:s,remove:r,patchProp:i,createElement:o,createText:a,createComment:c,setText:l,setElementText:u,parentNode:h,nextSibling:d,setScopeId:f=is,cloneNode:p,insertStaticContent:_}=t,y=(g,m,b,C=null,T=null,L=null,q=!1,O=null,U=!!m.dynamicChildren)=>{if(g===m)return;g&&!Ti(g,m)&&(C=J(g),Mn(g,T,L,!0),g=null),m.patchFlag===-2&&(U=!1,m.dynamicChildren=null);const{type:P,ref:X,shapeFlag:G}=m;switch(P){case y_:I(g,m,b,C);break;case os:N(g,m,b,C);break;case dh:g==null&&k(m,b,C,q);break;case Zn:ke(g,m,b,C,T,L,q,O,U);break;default:G&1?Y(g,m,b,C,T,L,q,O,U):G&6?Je(g,m,b,C,T,L,q,O,U):(G&64||G&128)&&P.process(g,m,b,C,T,L,q,O,U,$e)}X!=null&&T&&xg(X,g&&g.ref,L,m||g,!m)},I=(g,m,b,C)=>{if(g==null)s(m.el=a(m.children),b,C);else{const T=m.el=g.el;m.children!==g.children&&l(T,m.children)}},N=(g,m,b,C)=>{g==null?s(m.el=c(m.children||""),b,C):m.el=g.el},k=(g,m,b,C)=>{[g.el,g.anchor]=_(g.children,m,b,C,g.el,g.anchor)},M=({el:g,anchor:m},b,C)=>{let T;for(;g&&g!==m;)T=d(g),s(g,b,C),g=T;s(m,b,C)},j=({el:g,anchor:m})=>{let b;for(;g&&g!==m;)b=d(g),r(g),g=b;r(m)},Y=(g,m,b,C,T,L,q,O,U)=>{q=q||m.type==="svg",g==null?z(m,b,C,T,L,q,O,U):_e(g,m,T,L,q,O,U)},z=(g,m,b,C,T,L,q,O)=>{let U,P;const{type:X,props:G,shapeFlag:Z,transition:ae,patchFlag:be,dirs:Pe}=g;if(g.el&&p!==void 0&&be===-1)U=g.el=p(g.el);else{if(U=g.el=o(g.type,L,G&&G.is,G),Z&8?u(U,g.children):Z&16&&ie(g.children,U,null,C,T,L&&X!=="foreignObject",q,O),Pe&&fi(g,null,C,"created"),G){for(const je in G)je!=="value"&&!ch(je)&&i(U,je,null,G[je],L,g.children,C,T,$);"value"in G&&i(U,"value",null,G.value),(P=G.onVnodeBeforeMount)&&ps(P,C,g)}V(U,g,g.scopeId,q,C)}Pe&&fi(g,null,C,"beforeMount");const De=(!T||T&&!T.pendingBranch)&&ae&&!ae.persisted;De&&ae.beforeEnter(U),s(U,m,b),((P=G&&G.onVnodeMounted)||De||Pe)&&fn(()=>{P&&ps(P,C,g),De&&ae.enter(U),Pe&&fi(g,null,C,"mounted")},T)},V=(g,m,b,C,T)=>{if(b&&f(g,b),C)for(let L=0;L<C.length;L++)f(g,C[L]);if(T){let L=T.subTree;if(m===L){const q=T.vnode;V(g,q,q.scopeId,q.slotScopeIds,T.parent)}}},ie=(g,m,b,C,T,L,q,O,U=0)=>{for(let P=U;P<g.length;P++){const X=g[P]=O?Sr(g[P]):_s(g[P]);y(null,X,m,b,C,T,L,q,O)}},_e=(g,m,b,C,T,L,q)=>{const O=m.el=g.el;let{patchFlag:U,dynamicChildren:P,dirs:X}=m;U|=g.patchFlag&16;const G=g.props||Oe,Z=m.props||Oe;let ae;b&&pi(b,!1),(ae=Z.onVnodeBeforeUpdate)&&ps(ae,b,m,g),X&&fi(m,g,b,"beforeUpdate"),b&&pi(b,!0);const be=T&&m.type!=="foreignObject";if(P?Fe(g.dynamicChildren,P,O,b,C,be,L):q||En(g,m,O,null,b,C,be,L,!1),U>0){if(U&16)H(O,m,G,Z,b,C,T);else if(U&2&&G.class!==Z.class&&i(O,"class",null,Z.class,T),U&4&&i(O,"style",G.style,Z.style,T),U&8){const Pe=m.dynamicProps;for(let De=0;De<Pe.length;De++){const je=Pe[De],Yn=G[je],xo=Z[je];(xo!==Yn||je==="value")&&i(O,je,Yn,xo,T,g.children,b,C,$)}}U&1&&g.children!==m.children&&u(O,m.children)}else!q&&P==null&&H(O,m,G,Z,b,C,T);((ae=Z.onVnodeUpdated)||X)&&fn(()=>{ae&&ps(ae,b,m,g),X&&fi(m,g,b,"updated")},C)},Fe=(g,m,b,C,T,L,q)=>{for(let O=0;O<m.length;O++){const U=g[O],P=m[O],X=U.el&&(U.type===Zn||!Ti(U,P)||U.shapeFlag&70)?h(U.el):b;y(U,P,X,null,C,T,L,q,!0)}},H=(g,m,b,C,T,L,q)=>{if(b!==C){for(const O in C){if(ch(O))continue;const U=C[O],P=b[O];U!==P&&O!=="value"&&i(g,O,P,U,q,m.children,T,L,$)}if(b!==Oe)for(const O in b)!ch(O)&&!(O in C)&&i(g,O,b[O],null,q,m.children,T,L,$);"value"in C&&i(g,"value",b.value,C.value)}},ke=(g,m,b,C,T,L,q,O,U)=>{const P=m.el=g?g.el:a(""),X=m.anchor=g?g.anchor:a("");let{patchFlag:G,dynamicChildren:Z,slotScopeIds:ae}=m;ae&&(O=O?O.concat(ae):ae),g==null?(s(P,b,C),s(X,b,C),ie(m.children,b,X,T,L,q,O,U)):G>0&&G&64&&Z&&g.dynamicChildren?(Fe(g.dynamicChildren,Z,b,T,L,q,O),(m.key!=null||T&&m===T.subTree)&&YS(g,m,!0)):En(g,m,b,X,T,L,q,O,U)},Je=(g,m,b,C,T,L,q,O,U)=>{m.slotScopeIds=O,g==null?m.shapeFlag&512?T.ctx.activate(m,b,C,q,U):Xe(m,b,C,T,L,q,U):Ze(g,m,U)},Xe=(g,m,b,C,T,L,q)=>{const O=g.component=rM(g,C,T);if(Vd(g)&&(O.ctx.renderer=$e),iM(O),O.asyncDep){if(T&&T.registerDep(O,Ue),!g.el){const U=O.subTree=$t(os);N(null,U,m,b)}return}Ue(O,g,m,b,T,L,q)},Ze=(g,m,b)=>{const C=m.component=g.component;if(gO(g,m,b))if(C.asyncDep&&!C.asyncResolved){Re(C,m,b);return}else C.next=m,aO(C.update),C.update();else m.el=g.el,C.vnode=m},Ue=(g,m,b,C,T,L,q)=>{const O=()=>{if(g.isMounted){let{next:X,bu:G,u:Z,parent:ae,vnode:be}=g,Pe=X,De;pi(g,!1),X?(X.el=be.el,Re(g,X,q)):X=be,G&&lh(G),(De=X.props&&X.props.onVnodeBeforeUpdate)&&ps(De,ae,X,be),pi(g,!0);const je=mp(g),Yn=g.subTree;g.subTree=je,y(Yn,je,h(Yn.el),J(Yn),g,T,L),X.el=je.el,Pe===null&&mO(g,je.el),Z&&fn(Z,T),(De=X.props&&X.props.onVnodeUpdated)&&fn(()=>ps(De,ae,X,be),T)}else{let X;const{el:G,props:Z}=m,{bm:ae,m:be,parent:Pe}=g,De=hh(m);if(pi(g,!1),ae&&lh(ae),!De&&(X=Z&&Z.onVnodeBeforeMount)&&ps(X,Pe,m),pi(g,!0),G&&he){const je=()=>{g.subTree=mp(g),he(G,g.subTree,g,T,null)};De?m.type.__asyncLoader().then(()=>!g.isUnmounted&&je()):je()}else{const je=g.subTree=mp(g);y(null,je,b,C,g,T,L),m.el=je.el}if(be&&fn(be,T),!De&&(X=Z&&Z.onVnodeMounted)){const je=m;fn(()=>ps(X,Pe,je),T)}(m.shapeFlag&256||Pe&&hh(Pe.vnode)&&Pe.vnode.shapeFlag&256)&&g.a&&fn(g.a,T),g.isMounted=!0,m=b=C=null}},U=g.effect=new a_(O,()=>CS(P),g.scope),P=g.update=()=>U.run();P.id=g.uid,pi(g,!0),P()},Re=(g,m,b)=>{m.component=g;const C=g.vnode.props;g.vnode=m,g.next=null,BO(g,m.props,C,b),KO(g,m.children,b),Oa(),Fd(void 0,g.update),Ma()},En=(g,m,b,C,T,L,q,O,U=!1)=>{const P=g&&g.children,X=g?g.shapeFlag:0,G=m.children,{patchFlag:Z,shapeFlag:ae}=m;if(Z>0){if(Z&128){qs(P,G,b,C,T,L,q,O,U);return}else if(Z&256){Do(P,G,b,C,T,L,q,O,U);return}}ae&8?(X&16&&$(P,T,L),G!==P&&u(b,G)):X&16?ae&16?qs(P,G,b,C,T,L,q,O,U):$(P,T,L,!0):(X&8&&u(b,""),ae&16&&ie(G,b,C,T,L,q,O,U))},Do=(g,m,b,C,T,L,q,O,U)=>{g=g||Qo,m=m||Qo;const P=g.length,X=m.length,G=Math.min(P,X);let Z;for(Z=0;Z<G;Z++){const ae=m[Z]=U?Sr(m[Z]):_s(m[Z]);y(g[Z],ae,b,null,T,L,q,O,U)}P>X?$(g,T,L,!0,!1,G):ie(m,b,C,T,L,q,O,U,G)},qs=(g,m,b,C,T,L,q,O,U)=>{let P=0;const X=m.length;let G=g.length-1,Z=X-1;for(;P<=G&&P<=Z;){const ae=g[P],be=m[P]=U?Sr(m[P]):_s(m[P]);if(Ti(ae,be))y(ae,be,b,null,T,L,q,O,U);else break;P++}for(;P<=G&&P<=Z;){const ae=g[G],be=m[Z]=U?Sr(m[Z]):_s(m[Z]);if(Ti(ae,be))y(ae,be,b,null,T,L,q,O,U);else break;G--,Z--}if(P>G){if(P<=Z){const ae=Z+1,be=ae<X?m[ae].el:C;for(;P<=Z;)y(null,m[P]=U?Sr(m[P]):_s(m[P]),b,be,T,L,q,O,U),P++}}else if(P>Z)for(;P<=G;)Mn(g[P],T,L,!0),P++;else{const ae=P,be=P,Pe=new Map;for(P=be;P<=Z;P++){const Tn=m[P]=U?Sr(m[P]):_s(m[P]);Tn.key!=null&&Pe.set(Tn.key,P)}let De,je=0;const Yn=Z-be+1;let xo=!1,Aw=0;const ic=new Array(Yn);for(P=0;P<Yn;P++)ic[P]=0;for(P=ae;P<=G;P++){const Tn=g[P];if(je>=Yn){Mn(Tn,T,L,!0);continue}let fs;if(Tn.key!=null)fs=Pe.get(Tn.key);else for(De=be;De<=Z;De++)if(ic[De-be]===0&&Ti(Tn,m[De])){fs=De;break}fs===void 0?Mn(Tn,T,L,!0):(ic[fs-be]=P+1,fs>=Aw?Aw=fs:xo=!0,y(Tn,m[fs],b,null,T,L,q,O,U),je++)}const kw=xo?QO(ic):Qo;for(De=kw.length-1,P=Yn-1;P>=0;P--){const Tn=be+P,fs=m[Tn],Rw=Tn+1<X?m[Tn+1].el:C;ic[P]===0?y(null,fs,b,Rw,T,L,q,O,U):xo&&(De<0||P!==kw[De]?ds(fs,b,Rw,2):De--)}}},ds=(g,m,b,C,T=null)=>{const{el:L,type:q,transition:O,children:U,shapeFlag:P}=g;if(P&6){ds(g.component.subTree,m,b,C);return}if(P&128){g.suspense.move(m,b,C);return}if(P&64){q.move(g,m,b,$e);return}if(q===Zn){s(L,m,b);for(let G=0;G<U.length;G++)ds(U[G],m,b,C);s(g.anchor,m,b);return}if(q===dh){M(g,m,b);return}if(C!==2&&P&1&&O)if(C===0)O.beforeEnter(L),s(L,m,b),fn(()=>O.enter(L),T);else{const{leave:G,delayLeave:Z,afterLeave:ae}=O,be=()=>s(L,m,b),Pe=()=>{G(L,()=>{be(),ae&&ae()})};Z?Z(L,be,Pe):Pe()}else s(L,m,b)},Mn=(g,m,b,C=!1,T=!1)=>{const{type:L,props:q,ref:O,children:U,dynamicChildren:P,shapeFlag:X,patchFlag:G,dirs:Z}=g;if(O!=null&&xg(O,null,b,g,!0),X&256){m.ctx.deactivate(g);return}const ae=X&1&&Z,be=!hh(g);let Pe;if(be&&(Pe=q&&q.onVnodeBeforeUnmount)&&ps(Pe,m,g),X&6)Q(g.component,b,C);else{if(X&128){g.suspense.unmount(b,C);return}ae&&fi(g,null,m,"beforeUnmount"),X&64?g.type.remove(g,m,b,T,$e,C):P&&(L!==Zn||G>0&&G&64)?$(P,m,b,!1,!0):(L===Zn&&G&384||!T&&X&16)&&$(U,m,b),C&&pp(g)}(be&&(Pe=q&&q.onVnodeUnmounted)||ae)&&fn(()=>{Pe&&ps(Pe,m,g),ae&&fi(g,null,m,"unmounted")},b)},pp=g=>{const{type:m,el:b,anchor:C,transition:T}=g;if(m===Zn){E(b,C);return}if(m===dh){j(g);return}const L=()=>{r(b),T&&!T.persisted&&T.afterLeave&&T.afterLeave()};if(g.shapeFlag&1&&T&&!T.persisted){const{leave:q,delayLeave:O}=T,U=()=>q(b,L);O?O(g.el,L,U):U()}else L()},E=(g,m)=>{let b;for(;g!==m;)b=d(g),r(g),g=b;r(m)},Q=(g,m,b)=>{const{bum:C,scope:T,update:L,subTree:q,um:O}=g;C&&lh(C),T.stop(),L&&(L.active=!1,Mn(q,g,m,b)),O&&fn(O,m),fn(()=>{g.isUnmounted=!0},m),m&&m.pendingBranch&&!m.isUnmounted&&g.asyncDep&&!g.asyncResolved&&g.suspenseId===m.pendingId&&(m.deps--,m.deps===0&&m.resolve())},$=(g,m,b,C=!1,T=!1,L=0)=>{for(let q=L;q<g.length;q++)Mn(g[q],m,b,C,T)},J=g=>g.shapeFlag&6?J(g.component.subTree):g.shapeFlag&128?g.suspense.next():d(g.anchor||g.el),Ne=(g,m,b)=>{g==null?m._vnode&&Mn(m._vnode,null,null,!0):y(m._vnode||null,g,m,null,null,null,b),RS(),m._vnode=g},$e={p:y,um:Mn,m:ds,r:pp,mt:Xe,mc:ie,pc:En,pbc:Fe,n:J,o:t};let me,he;return e&&([me,he]=e($e)),{render:Ne,hydrate:me,createApp:HO(Ne,me)}}function pi({effect:t,update:e},n){t.allowRecurse=e.allowRecurse=n}function YS(t,e,n=!1){const s=t.children,r=e.children;if(ee(s)&&ee(r))for(let i=0;i<s.length;i++){const o=s[i];let a=r[i];a.shapeFlag&1&&!a.dynamicChildren&&((a.patchFlag<=0||a.patchFlag===32)&&(a=r[i]=Sr(r[i]),a.el=o.el),n||YS(o,a))}}function QO(t){const e=t.slice(),n=[0];let s,r,i,o,a;const c=t.length;for(s=0;s<c;s++){const l=t[s];if(l!==0){if(r=n[n.length-1],t[r]<l){e[s]=r,n.push(s);continue}for(i=0,o=n.length-1;i<o;)a=i+o>>1,t[n[a]]<l?i=a+1:o=a;l<t[n[i]]&&(i>0&&(e[s]=n[i-1]),n[i]=s)}}for(i=n.length,o=n[i-1];i-- >0;)n[i]=o,o=e[o];return n}const YO=t=>t.__isTeleport,Zn=Symbol(void 0),y_=Symbol(void 0),os=Symbol(void 0),dh=Symbol(void 0),Oc=[];let ns=null;function Nh(t=!1){Oc.push(ns=t?null:[])}function JO(){Oc.pop(),ns=Oc[Oc.length-1]||null}let ol=1;function Qw(t){ol+=t}function JS(t){return t.dynamicChildren=ol>0?ns||Qo:null,JO(),ol>0&&ns&&ns.push(t),t}function XS(t,e,n,s,r,i){return JS(Kn(t,e,n,s,r,i,!0))}function ZS(t,e,n,s,r){return JS($t(t,e,n,s,r,!0))}function Og(t){return t?t.__v_isVNode===!0:!1}function Ti(t,e){return t.type===e.type&&t.key===e.key}const qd="__vInternal",eC=({key:t})=>t!=null?t:null,fh=({ref:t,ref_key:e,ref_for:n})=>t!=null?kt(t)||at(t)||le(t)?{i:Un,r:t,k:e,f:!!n}:t:null;function Kn(t,e=null,n=null,s=0,r=null,i=t===Zn?0:1,o=!1,a=!1){const c={__v_isVNode:!0,__v_skip:!0,type:t,props:e,key:e&&eC(e),ref:e&&fh(e),scopeId:$d,slotScopeIds:null,children:n,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:i,patchFlag:s,dynamicProps:r,dynamicChildren:null,appContext:null};return a?(w_(c,n),i&128&&t.normalize(c)):n&&(c.shapeFlag|=kt(n)?8:16),ol>0&&!o&&ns&&(c.patchFlag>0||i&6)&&c.patchFlag!==32&&ns.push(c),c}const $t=XO;function XO(t,e=null,n=null,s=0,r=null,i=!1){if((!t||t===DO)&&(t=os),Og(t)){const a=Kr(t,e,!0);return n&&w_(a,n),ol>0&&!i&&ns&&(a.shapeFlag&6?ns[ns.indexOf(t)]=a:ns.push(a)),a.patchFlag|=-2,a}if(uM(t)&&(t=t.__vccOpts),e){e=ZO(e);let{class:a,style:c}=e;a&&!kt(a)&&(e.class=n_(a)),tt(c)&&(wS(c)&&!ee(c)&&(c=Wt({},c)),e.style=t_(c))}const o=kt(t)?1:_O(t)?128:YO(t)?64:tt(t)?4:le(t)?2:0;return Kn(t,e,n,s,r,o,i,!0)}function ZO(t){return t?wS(t)||qd in t?Wt({},t):t:null}function Kr(t,e,n=!1){const{props:s,ref:r,patchFlag:i,children:o}=t,a=e?tM(s||{},e):s;return{__v_isVNode:!0,__v_skip:!0,type:t.type,props:a,key:a&&eC(a),ref:e&&e.ref?n&&r?ee(r)?r.concat(fh(e)):[r,fh(e)]:fh(e):r,scopeId:t.scopeId,slotScopeIds:t.slotScopeIds,children:o,target:t.target,targetAnchor:t.targetAnchor,staticCount:t.staticCount,shapeFlag:t.shapeFlag,patchFlag:e&&t.type!==Zn?i===-1?16:i|16:i,dynamicProps:t.dynamicProps,dynamicChildren:t.dynamicChildren,appContext:t.appContext,dirs:t.dirs,transition:t.transition,component:t.component,suspense:t.suspense,ssContent:t.ssContent&&Kr(t.ssContent),ssFallback:t.ssFallback&&Kr(t.ssFallback),el:t.el,anchor:t.anchor}}function v_(t=" ",e=0){return $t(y_,null,t,e)}function r9(t,e){const n=$t(dh,null,t);return n.staticCount=e,n}function eM(t="",e=!1){return e?(Nh(),ZS(os,null,t)):$t(os,null,t)}function _s(t){return t==null||typeof t=="boolean"?$t(os):ee(t)?$t(Zn,null,t.slice()):typeof t=="object"?Sr(t):$t(y_,null,String(t))}function Sr(t){return t.el===null||t.memo?t:Kr(t)}function w_(t,e){let n=0;const{shapeFlag:s}=t;if(e==null)e=null;else if(ee(e))n=16;else if(typeof e=="object")if(s&65){const r=e.default;r&&(r._c&&(r._d=!1),w_(t,r()),r._c&&(r._d=!0));return}else{n=32;const r=e._;!r&&!(qd in e)?e._ctx=Un:r===3&&Un&&(Un.slots._===1?e._=1:(e._=2,t.patchFlag|=1024))}else le(e)?(e={default:e,_ctx:Un},n=32):(e=String(e),s&64?(n=16,e=[v_(e)]):n=8);t.children=e,t.shapeFlag|=n}function tM(...t){const e={};for(let n=0;n<t.length;n++){const s=t[n];for(const r in s)if(r==="class")e.class!==s.class&&(e.class=n_([e.class,s.class]));else if(r==="style")e.style=t_([e.style,s.style]);else if(Pd(r)){const i=e[r],o=s[r];o&&i!==o&&!(ee(i)&&i.includes(o))&&(e[r]=i?[].concat(i,o):o)}else r!==""&&(e[r]=s[r])}return e}function ps(t,e,n,s=null){jn(t,e,7,[n,s])}const nM=QS();let sM=0;function rM(t,e,n){const s=t.type,r=(e?e.appContext:t.appContext)||nM,i={uid:sM++,vnode:t,type:s,parent:e,appContext:r,root:null,next:null,subTree:null,effect:null,update:null,scope:new aS(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:e?e.provides:Object.create(r.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:WS(s,r),emitsOptions:PS(s,r),emit:null,emitted:null,propsDefaults:Oe,inheritAttrs:s.inheritAttrs,ctx:Oe,data:Oe,props:Oe,attrs:Oe,slots:Oe,refs:Oe,setupState:Oe,setupContext:null,suspense:n,suspenseId:n?n.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return i.ctx={_:i},i.root=e?e.root:i,i.emit=uO.bind(null,i),t.ce&&t.ce(i),i}let Tt=null;const b_=()=>Tt||Un,ha=t=>{Tt=t,t.scope.on()},Vi=()=>{Tt&&Tt.scope.off(),Tt=null};function tC(t){return t.vnode.shapeFlag&4}let al=!1;function iM(t,e=!1){al=e;const{props:n,children:s}=t.vnode,r=tC(t);VO(t,n,r,e),jO(t,s);const i=r?oM(t,e):void 0;return al=!1,i}function oM(t,e){const n=t.type;t.accessCache=Object.create(null),t.proxy=ua(new Proxy(t.ctx,OO));const{setup:s}=n;if(s){const r=t.setupContext=s.length>1?cM(t):null;ha(t),Oa();const i=Lr(s,t,0,[t.props,r]);if(Ma(),Vi(),rS(i)){if(i.then(Vi,Vi),e)return i.then(o=>{Yw(t,o,e)}).catch(o=>{Ld(o,t,0)});t.asyncDep=i}else Yw(t,i,e)}else nC(t,e)}function Yw(t,e,n){le(e)?t.type.__ssrInlineRender?t.ssrRender=e:t.render=e:tt(e)&&(t.setupState=TS(e)),nC(t,n)}let Jw;function nC(t,e,n){const s=t.type;if(!t.render){if(!e&&Jw&&!s.render){const r=s.template;if(r){const{isCustomElement:i,compilerOptions:o}=t.appContext.config,{delimiters:a,compilerOptions:c}=s,l=Wt(Wt({isCustomElement:i,delimiters:a},o),c);s.render=Jw(r,l)}}t.render=s.render||is}ha(t),Oa(),MO(t),Ma(),Vi()}function aM(t){return new Proxy(t.attrs,{get(e,n){return Pn(t,"get","$attrs"),e[n]}})}function cM(t){const e=s=>{t.exposed=s||{}};let n;return{get attrs(){return n||(n=aM(t))},slots:t.slots,emit:t.emit,expose:e}}function jd(t){if(t.exposed)return t.exposeProxy||(t.exposeProxy=new Proxy(TS(ua(t.exposed)),{get(e,n){if(n in e)return e[n];if(n in kh)return kh[n](t)}}))}function lM(t,e=!0){return le(t)?t.displayName||t.name:t.name||e&&t.__name}function uM(t){return le(t)&&"__vccOpts"in t}const ts=(t,e)=>rO(t,e,al);function I_(t,e,n){const s=arguments.length;return s===2?tt(e)&&!ee(e)?Og(e)?$t(t,null,[e]):$t(t,e):$t(t,null,e):(s>3?n=Array.prototype.slice.call(arguments,2):s===3&&Og(n)&&(n=[n]),$t(t,e,n))}const hM="3.2.37",dM="http://www.w3.org/2000/svg",Si=typeof document!="undefined"?document:null,Xw=Si&&Si.createElement("template"),fM={insert:(t,e,n)=>{e.insertBefore(t,n||null)},remove:t=>{const e=t.parentNode;e&&e.removeChild(t)},createElement:(t,e,n,s)=>{const r=e?Si.createElementNS(dM,t):Si.createElement(t,n?{is:n}:void 0);return t==="select"&&s&&s.multiple!=null&&r.setAttribute("multiple",s.multiple),r},createText:t=>Si.createTextNode(t),createComment:t=>Si.createComment(t),setText:(t,e)=>{t.nodeValue=e},setElementText:(t,e)=>{t.textContent=e},parentNode:t=>t.parentNode,nextSibling:t=>t.nextSibling,querySelector:t=>Si.querySelector(t),setScopeId(t,e){t.setAttribute(e,"")},cloneNode(t){const e=t.cloneNode(!0);return"_value"in t&&(e._value=t._value),e},insertStaticContent(t,e,n,s,r,i){const o=n?n.previousSibling:e.lastChild;if(r&&(r===i||r.nextSibling))for(;e.insertBefore(r.cloneNode(!0),n),!(r===i||!(r=r.nextSibling)););else{Xw.innerHTML=s?`<svg>${t}</svg>`:t;const a=Xw.content;if(s){const c=a.firstChild;for(;c.firstChild;)a.appendChild(c.firstChild);a.removeChild(c)}e.insertBefore(a,n)}return[o?o.nextSibling:e.firstChild,n?n.previousSibling:e.lastChild]}};function pM(t,e,n){const s=t._vtc;s&&(e=(e?[e,...s]:[...s]).join(" ")),e==null?t.removeAttribute("class"):n?t.setAttribute("class",e):t.className=e}function gM(t,e,n){const s=t.style,r=kt(n);if(n&&!r){for(const i in n)Mg(s,i,n[i]);if(e&&!kt(e))for(const i in e)n[i]==null&&Mg(s,i,"")}else{const i=s.display;r?e!==n&&(s.cssText=n):e&&t.removeAttribute("style"),"_vod"in t&&(s.display=i)}}const Zw=/\s*!important$/;function Mg(t,e,n){if(ee(n))n.forEach(s=>Mg(t,e,s));else if(n==null&&(n=""),e.startsWith("--"))t.setProperty(e,n);else{const s=mM(t,e);Zw.test(n)?t.setProperty(vo(s),n.replace(Zw,""),"important"):t[s]=n}}const eb=["Webkit","Moz","ms"],yp={};function mM(t,e){const n=yp[e];if(n)return n;let s=Ds(e);if(s!=="filter"&&s in t)return yp[e]=s;s=Od(s);for(let r=0;r<eb.length;r++){const i=eb[r]+s;if(i in t)return yp[e]=i}return e}const tb="http://www.w3.org/1999/xlink";function _M(t,e,n,s,r){if(s&&e.startsWith("xlink:"))n==null?t.removeAttributeNS(tb,e.slice(6,e.length)):t.setAttributeNS(tb,e,n);else{const i=hx(e);n==null||i&&!nS(n)?t.removeAttribute(e):t.setAttribute(e,i?"":n)}}function yM(t,e,n,s,r,i,o){if(e==="innerHTML"||e==="textContent"){s&&o(s,r,i),t[e]=n==null?"":n;return}if(e==="value"&&t.tagName!=="PROGRESS"&&!t.tagName.includes("-")){t._value=n;const c=n==null?"":n;(t.value!==c||t.tagName==="OPTION")&&(t.value=c),n==null&&t.removeAttribute(e);return}let a=!1;if(n===""||n==null){const c=typeof t[e];c==="boolean"?n=nS(n):n==null&&c==="string"?(n="",a=!0):c==="number"&&(n=0,a=!0)}try{t[e]=n}catch{}a&&t.removeAttribute(e)}const[sC,vM]=(()=>{let t=Date.now,e=!1;if(typeof window!="undefined"){Date.now()>document.createEvent("Event").timeStamp&&(t=performance.now.bind(performance));const n=navigator.userAgent.match(/firefox\/(\d+)/i);e=!!(n&&Number(n[1])<=53)}return[t,e]})();let Lg=0;const wM=Promise.resolve(),bM=()=>{Lg=0},IM=()=>Lg||(wM.then(bM),Lg=sC());function Ar(t,e,n,s){t.addEventListener(e,n,s)}function EM(t,e,n,s){t.removeEventListener(e,n,s)}function TM(t,e,n,s,r=null){const i=t._vei||(t._vei={}),o=i[e];if(s&&o)o.value=s;else{const[a,c]=SM(e);if(s){const l=i[e]=CM(s,r);Ar(t,a,l,c)}else o&&(EM(t,a,o,c),i[e]=void 0)}}const nb=/(?:Once|Passive|Capture)$/;function SM(t){let e;if(nb.test(t)){e={};let n;for(;n=t.match(nb);)t=t.slice(0,t.length-n[0].length),e[n[0].toLowerCase()]=!0}return[vo(t.slice(2)),e]}function CM(t,e){const n=s=>{const r=s.timeStamp||sC();(vM||r>=n.attached-1)&&jn(AM(s,n.value),e,5,[s])};return n.value=t,n.attached=IM(),n}function AM(t,e){if(ee(e)){const n=t.stopImmediatePropagation;return t.stopImmediatePropagation=()=>{n.call(t),t._stopped=!0},e.map(s=>r=>!r._stopped&&s&&s(r))}else return e}const sb=/^on[a-z]/,kM=(t,e,n,s,r=!1,i,o,a,c)=>{e==="class"?pM(t,s,r):e==="style"?gM(t,n,s):Pd(e)?s_(e)||TM(t,e,n,s,o):(e[0]==="."?(e=e.slice(1),!0):e[0]==="^"?(e=e.slice(1),!1):RM(t,e,s,r))?yM(t,e,s,i,o,a,c):(e==="true-value"?t._trueValue=s:e==="false-value"&&(t._falseValue=s),_M(t,e,s,r))};function RM(t,e,n,s){return s?!!(e==="innerHTML"||e==="textContent"||e in t&&sb.test(e)&&le(n)):e==="spellcheck"||e==="draggable"||e==="translate"||e==="form"||e==="list"&&t.tagName==="INPUT"||e==="type"&&t.tagName==="TEXTAREA"||sb.test(e)&&kt(n)?!1:e in t}const _r="transition",oc="animation",rC=(t,{slots:e})=>I_(OS,NM(t),e);rC.displayName="Transition";const iC={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String};rC.props=Wt({},OS.props,iC);const gi=(t,e=[])=>{ee(t)?t.forEach(n=>n(...e)):t&&t(...e)},rb=t=>t?ee(t)?t.some(e=>e.length>1):t.length>1:!1;function NM(t){const e={};for(const H in t)H in iC||(e[H]=t[H]);if(t.css===!1)return e;const{name:n="v",type:s,duration:r,enterFromClass:i=`${n}-enter-from`,enterActiveClass:o=`${n}-enter-active`,enterToClass:a=`${n}-enter-to`,appearFromClass:c=i,appearActiveClass:l=o,appearToClass:u=a,leaveFromClass:h=`${n}-leave-from`,leaveActiveClass:d=`${n}-leave-active`,leaveToClass:f=`${n}-leave-to`}=t,p=PM(r),_=p&&p[0],y=p&&p[1],{onBeforeEnter:I,onEnter:N,onEnterCancelled:k,onLeave:M,onLeaveCancelled:j,onBeforeAppear:Y=I,onAppear:z=N,onAppearCancelled:V=k}=e,ie=(H,ke,Je)=>{mi(H,ke?u:a),mi(H,ke?l:o),Je&&Je()},_e=(H,ke)=>{H._isLeaving=!1,mi(H,h),mi(H,f),mi(H,d),ke&&ke()},Fe=H=>(ke,Je)=>{const Xe=H?z:N,Ze=()=>ie(ke,H,Je);gi(Xe,[ke,Ze]),ib(()=>{mi(ke,H?c:i),yr(ke,H?u:a),rb(Xe)||ob(ke,s,_,Ze)})};return Wt(e,{onBeforeEnter(H){gi(I,[H]),yr(H,i),yr(H,o)},onBeforeAppear(H){gi(Y,[H]),yr(H,c),yr(H,l)},onEnter:Fe(!1),onAppear:Fe(!0),onLeave(H,ke){H._isLeaving=!0;const Je=()=>_e(H,ke);yr(H,h),OM(),yr(H,d),ib(()=>{!H._isLeaving||(mi(H,h),yr(H,f),rb(M)||ob(H,s,y,Je))}),gi(M,[H,Je])},onEnterCancelled(H){ie(H,!1),gi(k,[H])},onAppearCancelled(H){ie(H,!0),gi(V,[H])},onLeaveCancelled(H){_e(H),gi(j,[H])}})}function PM(t){if(t==null)return null;if(tt(t))return[vp(t.enter),vp(t.leave)];{const e=vp(t);return[e,e]}}function vp(t){return nl(t)}function yr(t,e){e.split(/\s+/).forEach(n=>n&&t.classList.add(n)),(t._vtc||(t._vtc=new Set)).add(e)}function mi(t,e){e.split(/\s+/).forEach(s=>s&&t.classList.remove(s));const{_vtc:n}=t;n&&(n.delete(e),n.size||(t._vtc=void 0))}function ib(t){requestAnimationFrame(()=>{requestAnimationFrame(t)})}let DM=0;function ob(t,e,n,s){const r=t._endId=++DM,i=()=>{r===t._endId&&s()};if(n)return setTimeout(i,n);const{type:o,timeout:a,propCount:c}=xM(t,e);if(!o)return s();const l=o+"end";let u=0;const h=()=>{t.removeEventListener(l,d),i()},d=f=>{f.target===t&&++u>=c&&h()};setTimeout(()=>{u<c&&h()},a+1),t.addEventListener(l,d)}function xM(t,e){const n=window.getComputedStyle(t),s=p=>(n[p]||"").split(", "),r=s(_r+"Delay"),i=s(_r+"Duration"),o=ab(r,i),a=s(oc+"Delay"),c=s(oc+"Duration"),l=ab(a,c);let u=null,h=0,d=0;e===_r?o>0&&(u=_r,h=o,d=i.length):e===oc?l>0&&(u=oc,h=l,d=c.length):(h=Math.max(o,l),u=h>0?o>l?_r:oc:null,d=u?u===_r?i.length:c.length:0);const f=u===_r&&/\b(transform|all)(,|$)/.test(n[_r+"Property"]);return{type:u,timeout:h,propCount:d,hasTransform:f}}function ab(t,e){for(;t.length<e.length;)t=t.concat(t);return Math.max(...e.map((n,s)=>cb(n)+cb(t[s])))}function cb(t){return Number(t.slice(0,-1).replace(",","."))*1e3}function OM(){return document.body.offsetHeight}const da=t=>{const e=t.props["onUpdate:modelValue"]||!1;return ee(e)?n=>lh(e,n):e};function MM(t){t.target.composing=!0}function lb(t){const e=t.target;e.composing&&(e.composing=!1,e.dispatchEvent(new Event("input")))}const i9={created(t,{modifiers:{lazy:e,trim:n,number:s}},r){t._assign=da(r);const i=s||r.props&&r.props.type==="number";Ar(t,e?"change":"input",o=>{if(o.target.composing)return;let a=t.value;n&&(a=a.trim()),i&&(a=nl(a)),t._assign(a)}),n&&Ar(t,"change",()=>{t.value=t.value.trim()}),e||(Ar(t,"compositionstart",MM),Ar(t,"compositionend",lb),Ar(t,"change",lb))},mounted(t,{value:e}){t.value=e==null?"":e},beforeUpdate(t,{value:e,modifiers:{lazy:n,trim:s,number:r}},i){if(t._assign=da(i),t.composing||document.activeElement===t&&t.type!=="range"&&(n||s&&t.value.trim()===e||(r||t.type==="number")&&nl(t.value)===e))return;const o=e==null?"":e;t.value!==o&&(t.value=o)}},o9={created(t,{value:e},n){t.checked=la(e,n.props.value),t._assign=da(n),Ar(t,"change",()=>{t._assign(cl(t))})},beforeUpdate(t,{value:e,oldValue:n},s){t._assign=da(s),e!==n&&(t.checked=la(e,s.props.value))}},a9={deep:!0,created(t,{value:e,modifiers:{number:n}},s){const r=Dd(e);Ar(t,"change",()=>{const i=Array.prototype.filter.call(t.options,o=>o.selected).map(o=>n?nl(cl(o)):cl(o));t._assign(t.multiple?r?new Set(i):i:i[0])}),t._assign=da(s)},mounted(t,{value:e}){ub(t,e)},beforeUpdate(t,e,n){t._assign=da(n)},updated(t,{value:e}){ub(t,e)}};function ub(t,e){const n=t.multiple;if(!(n&&!ee(e)&&!Dd(e))){for(let s=0,r=t.options.length;s<r;s++){const i=t.options[s],o=cl(i);if(n)ee(e)?i.selected=mx(e,o)>-1:i.selected=e.has(o);else if(la(cl(i),e)){t.selectedIndex!==s&&(t.selectedIndex=s);return}}!n&&t.selectedIndex!==-1&&(t.selectedIndex=-1)}}function cl(t){return"_value"in t?t._value:t.value}const LM={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},c9=(t,e)=>n=>{if(!("key"in n))return;const s=vo(n.key);if(e.some(r=>r===s||LM[r]===s))return t(n)},FM=Wt({patchProp:kM},fM);let hb;function UM(){return hb||(hb=GO(FM))}const $M=(...t)=>{const e=UM().createApp(...t),{mount:n}=e;return e.mount=s=>{const r=VM(s);if(!r)return;const i=e._component;!le(i)&&!i.render&&!i.template&&(i.template=r.innerHTML),r.innerHTML="";const o=n(r,!1,r instanceof SVGElement);return r instanceof Element&&(r.removeAttribute("v-cloak"),r.setAttribute("data-v-app","")),o},e};function VM(t){return kt(t)?document.querySelector(t):t}const BM="modulepreload",db={},qM="/Educatia/",gs=function(e,n){return!n||n.length===0?e():Promise.all(n.map(s=>{if(s=`${qM}${s}`,s in db)return;db[s]=!0;const r=s.endsWith(".css"),i=r?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${s}"]${i}`))return;const o=document.createElement("link");if(o.rel=r?"stylesheet":BM,r||(o.as="script",o.crossOrigin=""),o.href=s,document.head.appendChild(o),r)return new Promise((a,c)=>{o.addEventListener("load",a),o.addEventListener("error",()=>c(new Error(`Unable to preload CSS for ${s}`)))})})).then(()=>e())};/*!
  * vue-router v4.0.13
  * (c) 2022 Eduardo San Martin Morote
  * @license MIT
  */const oC=typeof Symbol=="function"&&typeof Symbol.toStringTag=="symbol",Fa=t=>oC?Symbol(t):"_vr_"+t,jM=Fa("rvlm"),fb=Fa("rvd"),Kd=Fa("r"),aC=Fa("rl"),Fg=Fa("rvl"),Ko=typeof window!="undefined";function KM(t){return t.__esModule||oC&&t[Symbol.toStringTag]==="Module"}const xe=Object.assign;function wp(t,e){const n={};for(const s in e){const r=e[s];n[s]=Array.isArray(r)?r.map(t):t(r)}return n}const Mc=()=>{},WM=/\/$/,HM=t=>t.replace(WM,"");function bp(t,e,n="/"){let s,r={},i="",o="";const a=e.indexOf("?"),c=e.indexOf("#",a>-1?a:0);return a>-1&&(s=e.slice(0,a),i=e.slice(a+1,c>-1?c:e.length),r=t(i)),c>-1&&(s=s||e.slice(0,c),o=e.slice(c,e.length)),s=YM(s!=null?s:e,n),{fullPath:s+(i&&"?")+i+o,path:s,query:r,hash:o}}function GM(t,e){const n=e.query?t(e.query):"";return e.path+(n&&"?")+n+(e.hash||"")}function pb(t,e){return!e||!t.toLowerCase().startsWith(e.toLowerCase())?t:t.slice(e.length)||"/"}function zM(t,e,n){const s=e.matched.length-1,r=n.matched.length-1;return s>-1&&s===r&&fa(e.matched[s],n.matched[r])&&cC(e.params,n.params)&&t(e.query)===t(n.query)&&e.hash===n.hash}function fa(t,e){return(t.aliasOf||t)===(e.aliasOf||e)}function cC(t,e){if(Object.keys(t).length!==Object.keys(e).length)return!1;for(const n in t)if(!QM(t[n],e[n]))return!1;return!0}function QM(t,e){return Array.isArray(t)?gb(t,e):Array.isArray(e)?gb(e,t):t===e}function gb(t,e){return Array.isArray(e)?t.length===e.length&&t.every((n,s)=>n===e[s]):t.length===1&&t[0]===e}function YM(t,e){if(t.startsWith("/"))return t;if(!t)return e;const n=e.split("/"),s=t.split("/");let r=n.length-1,i,o;for(i=0;i<s.length;i++)if(o=s[i],!(r===1||o==="."))if(o==="..")r--;else break;return n.slice(0,r).join("/")+"/"+s.slice(i-(i===s.length?1:0)).join("/")}var ll;(function(t){t.pop="pop",t.push="push"})(ll||(ll={}));var Lc;(function(t){t.back="back",t.forward="forward",t.unknown=""})(Lc||(Lc={}));function JM(t){if(!t)if(Ko){const e=document.querySelector("base");t=e&&e.getAttribute("href")||"/",t=t.replace(/^\w+:\/\/[^\/]+/,"")}else t="/";return t[0]!=="/"&&t[0]!=="#"&&(t="/"+t),HM(t)}const XM=/^[^#]+#/;function ZM(t,e){return t.replace(XM,"#")+e}function e1(t,e){const n=document.documentElement.getBoundingClientRect(),s=t.getBoundingClientRect();return{behavior:e.behavior,left:s.left-n.left-(e.left||0),top:s.top-n.top-(e.top||0)}}const Wd=()=>({left:window.pageXOffset,top:window.pageYOffset});function t1(t){let e;if("el"in t){const n=t.el,s=typeof n=="string"&&n.startsWith("#"),r=typeof n=="string"?s?document.getElementById(n.slice(1)):document.querySelector(n):n;if(!r)return;e=e1(r,t)}else e=t;"scrollBehavior"in document.documentElement.style?window.scrollTo(e):window.scrollTo(e.left!=null?e.left:window.pageXOffset,e.top!=null?e.top:window.pageYOffset)}function mb(t,e){return(history.state?history.state.position-e:-1)+t}const Ug=new Map;function n1(t,e){Ug.set(t,e)}function s1(t){const e=Ug.get(t);return Ug.delete(t),e}let r1=()=>location.protocol+"//"+location.host;function lC(t,e){const{pathname:n,search:s,hash:r}=e,i=t.indexOf("#");if(i>-1){let a=r.includes(t.slice(i))?t.slice(i).length:1,c=r.slice(a);return c[0]!=="/"&&(c="/"+c),pb(c,"")}return pb(n,t)+s+r}function i1(t,e,n,s){let r=[],i=[],o=null;const a=({state:d})=>{const f=lC(t,location),p=n.value,_=e.value;let y=0;if(d){if(n.value=f,e.value=d,o&&o===p){o=null;return}y=_?d.position-_.position:0}else s(f);r.forEach(I=>{I(n.value,p,{delta:y,type:ll.pop,direction:y?y>0?Lc.forward:Lc.back:Lc.unknown})})};function c(){o=n.value}function l(d){r.push(d);const f=()=>{const p=r.indexOf(d);p>-1&&r.splice(p,1)};return i.push(f),f}function u(){const{history:d}=window;!d.state||d.replaceState(xe({},d.state,{scroll:Wd()}),"")}function h(){for(const d of i)d();i=[],window.removeEventListener("popstate",a),window.removeEventListener("beforeunload",u)}return window.addEventListener("popstate",a),window.addEventListener("beforeunload",u),{pauseListeners:c,listen:l,destroy:h}}function _b(t,e,n,s=!1,r=!1){return{back:t,current:e,forward:n,replaced:s,position:window.history.length,scroll:r?Wd():null}}function o1(t){const{history:e,location:n}=window,s={value:lC(t,n)},r={value:e.state};r.value||i(s.value,{back:null,current:s.value,forward:null,position:e.length-1,replaced:!0,scroll:null},!0);function i(c,l,u){const h=t.indexOf("#"),d=h>-1?(n.host&&document.querySelector("base")?t:t.slice(h))+c:r1()+t+c;try{e[u?"replaceState":"pushState"](l,"",d),r.value=l}catch(f){console.error(f),n[u?"replace":"assign"](d)}}function o(c,l){const u=xe({},e.state,_b(r.value.back,c,r.value.forward,!0),l,{position:r.value.position});i(c,u,!0),s.value=c}function a(c,l){const u=xe({},r.value,e.state,{forward:c,scroll:Wd()});i(u.current,u,!0);const h=xe({},_b(s.value,c,null),{position:u.position+1},l);i(c,h,!1),s.value=c}return{location:s,state:r,push:a,replace:o}}function a1(t){t=JM(t);const e=o1(t),n=i1(t,e.state,e.location,e.replace);function s(i,o=!0){o||n.pauseListeners(),history.go(i)}const r=xe({location:"",base:t,go:s,createHref:ZM.bind(null,t)},e,n);return Object.defineProperty(r,"location",{enumerable:!0,get:()=>e.location.value}),Object.defineProperty(r,"state",{enumerable:!0,get:()=>e.state.value}),r}function c1(t){return t=location.host?t||location.pathname+location.search:"",t.includes("#")||(t+="#"),a1(t)}function l1(t){return typeof t=="string"||t&&typeof t=="object"}function uC(t){return typeof t=="string"||typeof t=="symbol"}const vr={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0},hC=Fa("nf");var yb;(function(t){t[t.aborted=4]="aborted",t[t.cancelled=8]="cancelled",t[t.duplicated=16]="duplicated"})(yb||(yb={}));function pa(t,e){return xe(new Error,{type:t,[hC]:!0},e)}function wr(t,e){return t instanceof Error&&hC in t&&(e==null||!!(t.type&e))}const vb="[^/]+?",u1={sensitive:!1,strict:!1,start:!0,end:!0},h1=/[.+*?^${}()[\]/\\]/g;function d1(t,e){const n=xe({},u1,e),s=[];let r=n.start?"^":"";const i=[];for(const l of t){const u=l.length?[]:[90];n.strict&&!l.length&&(r+="/");for(let h=0;h<l.length;h++){const d=l[h];let f=40+(n.sensitive?.25:0);if(d.type===0)h||(r+="/"),r+=d.value.replace(h1,"\\$&"),f+=40;else if(d.type===1){const{value:p,repeatable:_,optional:y,regexp:I}=d;i.push({name:p,repeatable:_,optional:y});const N=I||vb;if(N!==vb){f+=10;try{new RegExp(`(${N})`)}catch(M){throw new Error(`Invalid custom RegExp for param "${p}" (${N}): `+M.message)}}let k=_?`((?:${N})(?:/(?:${N}))*)`:`(${N})`;h||(k=y&&l.length<2?`(?:/${k})`:"/"+k),y&&(k+="?"),r+=k,f+=20,y&&(f+=-8),_&&(f+=-20),N===".*"&&(f+=-50)}u.push(f)}s.push(u)}if(n.strict&&n.end){const l=s.length-1;s[l][s[l].length-1]+=.7000000000000001}n.strict||(r+="/?"),n.end?r+="$":n.strict&&(r+="(?:/|$)");const o=new RegExp(r,n.sensitive?"":"i");function a(l){const u=l.match(o),h={};if(!u)return null;for(let d=1;d<u.length;d++){const f=u[d]||"",p=i[d-1];h[p.name]=f&&p.repeatable?f.split("/"):f}return h}function c(l){let u="",h=!1;for(const d of t){(!h||!u.endsWith("/"))&&(u+="/"),h=!1;for(const f of d)if(f.type===0)u+=f.value;else if(f.type===1){const{value:p,repeatable:_,optional:y}=f,I=p in l?l[p]:"";if(Array.isArray(I)&&!_)throw new Error(`Provided param "${p}" is an array but it is not repeatable (* or + modifiers)`);const N=Array.isArray(I)?I.join("/"):I;if(!N)if(y)d.length<2&&(u.endsWith("/")?u=u.slice(0,-1):h=!0);else throw new Error(`Missing required param "${p}"`);u+=N}}return u}return{re:o,score:s,keys:i,parse:a,stringify:c}}function f1(t,e){let n=0;for(;n<t.length&&n<e.length;){const s=e[n]-t[n];if(s)return s;n++}return t.length<e.length?t.length===1&&t[0]===40+40?-1:1:t.length>e.length?e.length===1&&e[0]===40+40?1:-1:0}function p1(t,e){let n=0;const s=t.score,r=e.score;for(;n<s.length&&n<r.length;){const i=f1(s[n],r[n]);if(i)return i;n++}return r.length-s.length}const g1={type:0,value:""},m1=/[a-zA-Z0-9_]/;function _1(t){if(!t)return[[]];if(t==="/")return[[g1]];if(!t.startsWith("/"))throw new Error(`Invalid path "${t}"`);function e(f){throw new Error(`ERR (${n})/"${l}": ${f}`)}let n=0,s=n;const r=[];let i;function o(){i&&r.push(i),i=[]}let a=0,c,l="",u="";function h(){!l||(n===0?i.push({type:0,value:l}):n===1||n===2||n===3?(i.length>1&&(c==="*"||c==="+")&&e(`A repeatable param (${l}) must be alone in its segment. eg: '/:ids+.`),i.push({type:1,value:l,regexp:u,repeatable:c==="*"||c==="+",optional:c==="*"||c==="?"})):e("Invalid state to consume buffer"),l="")}function d(){l+=c}for(;a<t.length;){if(c=t[a++],c==="\\"&&n!==2){s=n,n=4;continue}switch(n){case 0:c==="/"?(l&&h(),o()):c===":"?(h(),n=1):d();break;case 4:d(),n=s;break;case 1:c==="("?n=2:m1.test(c)?d():(h(),n=0,c!=="*"&&c!=="?"&&c!=="+"&&a--);break;case 2:c===")"?u[u.length-1]=="\\"?u=u.slice(0,-1)+c:n=3:u+=c;break;case 3:h(),n=0,c!=="*"&&c!=="?"&&c!=="+"&&a--,u="";break;default:e("Unknown state");break}}return n===2&&e(`Unfinished custom RegExp for param "${l}"`),h(),o(),r}function y1(t,e,n){const s=d1(_1(t.path),n),r=xe(s,{record:t,parent:e,children:[],alias:[]});return e&&!r.record.aliasOf==!e.record.aliasOf&&e.children.push(r),r}function v1(t,e){const n=[],s=new Map;e=bb({strict:!1,end:!0,sensitive:!1},e);function r(u){return s.get(u)}function i(u,h,d){const f=!d,p=b1(u);p.aliasOf=d&&d.record;const _=bb(e,u),y=[p];if("alias"in u){const k=typeof u.alias=="string"?[u.alias]:u.alias;for(const M of k)y.push(xe({},p,{components:d?d.record.components:p.components,path:M,aliasOf:d?d.record:p}))}let I,N;for(const k of y){const{path:M}=k;if(h&&M[0]!=="/"){const j=h.record.path,Y=j[j.length-1]==="/"?"":"/";k.path=h.record.path+(M&&Y+M)}if(I=y1(k,h,_),d?d.alias.push(I):(N=N||I,N!==I&&N.alias.push(I),f&&u.name&&!wb(I)&&o(u.name)),"children"in p){const j=p.children;for(let Y=0;Y<j.length;Y++)i(j[Y],I,d&&d.children[Y])}d=d||I,c(I)}return N?()=>{o(N)}:Mc}function o(u){if(uC(u)){const h=s.get(u);h&&(s.delete(u),n.splice(n.indexOf(h),1),h.children.forEach(o),h.alias.forEach(o))}else{const h=n.indexOf(u);h>-1&&(n.splice(h,1),u.record.name&&s.delete(u.record.name),u.children.forEach(o),u.alias.forEach(o))}}function a(){return n}function c(u){let h=0;for(;h<n.length&&p1(u,n[h])>=0&&(u.record.path!==n[h].record.path||!dC(u,n[h]));)h++;n.splice(h,0,u),u.record.name&&!wb(u)&&s.set(u.record.name,u)}function l(u,h){let d,f={},p,_;if("name"in u&&u.name){if(d=s.get(u.name),!d)throw pa(1,{location:u});_=d.record.name,f=xe(w1(h.params,d.keys.filter(N=>!N.optional).map(N=>N.name)),u.params),p=d.stringify(f)}else if("path"in u)p=u.path,d=n.find(N=>N.re.test(p)),d&&(f=d.parse(p),_=d.record.name);else{if(d=h.name?s.get(h.name):n.find(N=>N.re.test(h.path)),!d)throw pa(1,{location:u,currentLocation:h});_=d.record.name,f=xe({},h.params,u.params),p=d.stringify(f)}const y=[];let I=d;for(;I;)y.unshift(I.record),I=I.parent;return{name:_,path:p,params:f,matched:y,meta:E1(y)}}return t.forEach(u=>i(u)),{addRoute:i,resolve:l,removeRoute:o,getRoutes:a,getRecordMatcher:r}}function w1(t,e){const n={};for(const s of e)s in t&&(n[s]=t[s]);return n}function b1(t){return{path:t.path,redirect:t.redirect,name:t.name,meta:t.meta||{},aliasOf:void 0,beforeEnter:t.beforeEnter,props:I1(t),children:t.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in t?t.components||{}:{default:t.component}}}function I1(t){const e={},n=t.props||!1;if("component"in t)e.default=n;else for(const s in t.components)e[s]=typeof n=="boolean"?n:n[s];return e}function wb(t){for(;t;){if(t.record.aliasOf)return!0;t=t.parent}return!1}function E1(t){return t.reduce((e,n)=>xe(e,n.meta),{})}function bb(t,e){const n={};for(const s in t)n[s]=s in e?e[s]:t[s];return n}function dC(t,e){return e.children.some(n=>n===t||dC(t,n))}const fC=/#/g,T1=/&/g,S1=/\//g,C1=/=/g,A1=/\?/g,pC=/\+/g,k1=/%5B/g,R1=/%5D/g,gC=/%5E/g,N1=/%60/g,mC=/%7B/g,P1=/%7C/g,_C=/%7D/g,D1=/%20/g;function E_(t){return encodeURI(""+t).replace(P1,"|").replace(k1,"[").replace(R1,"]")}function x1(t){return E_(t).replace(mC,"{").replace(_C,"}").replace(gC,"^")}function $g(t){return E_(t).replace(pC,"%2B").replace(D1,"+").replace(fC,"%23").replace(T1,"%26").replace(N1,"`").replace(mC,"{").replace(_C,"}").replace(gC,"^")}function O1(t){return $g(t).replace(C1,"%3D")}function M1(t){return E_(t).replace(fC,"%23").replace(A1,"%3F")}function L1(t){return t==null?"":M1(t).replace(S1,"%2F")}function Ph(t){try{return decodeURIComponent(""+t)}catch{}return""+t}function F1(t){const e={};if(t===""||t==="?")return e;const s=(t[0]==="?"?t.slice(1):t).split("&");for(let r=0;r<s.length;++r){const i=s[r].replace(pC," "),o=i.indexOf("="),a=Ph(o<0?i:i.slice(0,o)),c=o<0?null:Ph(i.slice(o+1));if(a in e){let l=e[a];Array.isArray(l)||(l=e[a]=[l]),l.push(c)}else e[a]=c}return e}function Ib(t){let e="";for(let n in t){const s=t[n];if(n=O1(n),s==null){s!==void 0&&(e+=(e.length?"&":"")+n);continue}(Array.isArray(s)?s.map(i=>i&&$g(i)):[s&&$g(s)]).forEach(i=>{i!==void 0&&(e+=(e.length?"&":"")+n,i!=null&&(e+="="+i))})}return e}function U1(t){const e={};for(const n in t){const s=t[n];s!==void 0&&(e[n]=Array.isArray(s)?s.map(r=>r==null?null:""+r):s==null?s:""+s)}return e}function ac(){let t=[];function e(s){return t.push(s),()=>{const r=t.indexOf(s);r>-1&&t.splice(r,1)}}function n(){t=[]}return{add:e,list:()=>t,reset:n}}function Cr(t,e,n,s,r){const i=s&&(s.enterCallbacks[r]=s.enterCallbacks[r]||[]);return()=>new Promise((o,a)=>{const c=h=>{h===!1?a(pa(4,{from:n,to:e})):h instanceof Error?a(h):l1(h)?a(pa(2,{from:e,to:h})):(i&&s.enterCallbacks[r]===i&&typeof h=="function"&&i.push(h),o())},l=t.call(s&&s.instances[r],e,n,c);let u=Promise.resolve(l);t.length<3&&(u=u.then(c)),u.catch(h=>a(h))})}function Ip(t,e,n,s){const r=[];for(const i of t)for(const o in i.components){let a=i.components[o];if(!(e!=="beforeRouteEnter"&&!i.instances[o]))if($1(a)){const l=(a.__vccOpts||a)[e];l&&r.push(Cr(l,n,s,i,o))}else{let c=a();r.push(()=>c.then(l=>{if(!l)return Promise.reject(new Error(`Couldn't resolve component "${o}" at "${i.path}"`));const u=KM(l)?l.default:l;i.components[o]=u;const d=(u.__vccOpts||u)[e];return d&&Cr(d,n,s,i,o)()}))}}return r}function $1(t){return typeof t=="object"||"displayName"in t||"props"in t||"__vccOpts"in t}function Eb(t){const e=Cs(Kd),n=Cs(aC),s=ts(()=>e.resolve(Nc(t.to))),r=ts(()=>{const{matched:c}=s.value,{length:l}=c,u=c[l-1],h=n.matched;if(!u||!h.length)return-1;const d=h.findIndex(fa.bind(null,u));if(d>-1)return d;const f=Tb(c[l-2]);return l>1&&Tb(u)===f&&h[h.length-1].path!==f?h.findIndex(fa.bind(null,c[l-2])):d}),i=ts(()=>r.value>-1&&j1(n.params,s.value.params)),o=ts(()=>r.value>-1&&r.value===n.matched.length-1&&cC(n.params,s.value.params));function a(c={}){return q1(c)?e[Nc(t.replace)?"replace":"push"](Nc(t.to)).catch(Mc):Promise.resolve()}return{route:s,href:ts(()=>s.value.href),isActive:i,isExactActive:o,navigate:a}}const V1=FS({name:"RouterLink",props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"}},useLink:Eb,setup(t,{slots:e}){const n=La(Eb(t)),{options:s}=Cs(Kd),r=ts(()=>({[Sb(t.activeClass,s.linkActiveClass,"router-link-active")]:n.isActive,[Sb(t.exactActiveClass,s.linkExactActiveClass,"router-link-exact-active")]:n.isExactActive}));return()=>{const i=e.default&&e.default(n);return t.custom?i:I_("a",{"aria-current":n.isExactActive?t.ariaCurrentValue:null,href:n.href,onClick:n.navigate,class:r.value},i)}}}),B1=V1;function q1(t){if(!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)&&!t.defaultPrevented&&!(t.button!==void 0&&t.button!==0)){if(t.currentTarget&&t.currentTarget.getAttribute){const e=t.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(e))return}return t.preventDefault&&t.preventDefault(),!0}}function j1(t,e){for(const n in e){const s=e[n],r=t[n];if(typeof s=="string"){if(s!==r)return!1}else if(!Array.isArray(r)||r.length!==s.length||s.some((i,o)=>i!==r[o]))return!1}return!0}function Tb(t){return t?t.aliasOf?t.aliasOf.path:t.path:""}const Sb=(t,e,n)=>t!=null?t:e!=null?e:n,K1=FS({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},setup(t,{attrs:e,slots:n}){const s=Cs(Fg),r=ts(()=>t.route||s.value),i=Cs(fb,0),o=ts(()=>r.value.matched[i]);uh(fb,i+1),uh(jM,o),uh(Fg,r);const a=f_();return xc(()=>[a.value,o.value,t.name],([c,l,u],[h,d,f])=>{l&&(l.instances[u]=c,d&&d!==l&&c&&c===h&&(l.leaveGuards.size||(l.leaveGuards=d.leaveGuards),l.updateGuards.size||(l.updateGuards=d.updateGuards))),c&&l&&(!d||!fa(l,d)||!h)&&(l.enterCallbacks[u]||[]).forEach(p=>p(c))},{flush:"post"}),()=>{const c=r.value,l=o.value,u=l&&l.components[t.name],h=t.name;if(!u)return Cb(n.default,{Component:u,route:c});const d=l.props[t.name],f=d?d===!0?c.params:typeof d=="function"?d(c):d:null,_=I_(u,xe({},f,e,{onVnodeUnmounted:y=>{y.component.isUnmounted&&(l.instances[h]=null)},ref:a}));return Cb(n.default,{Component:_,route:c})||_}}});function Cb(t,e){if(!t)return null;const n=t(e);return n.length===1?n[0]:n}const W1=K1;function H1(t){const e=v1(t.routes,t),n=t.parseQuery||F1,s=t.stringifyQuery||Ib,r=t.history,i=ac(),o=ac(),a=ac(),c=Jx(vr);let l=vr;Ko&&t.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const u=wp.bind(null,E=>""+E),h=wp.bind(null,L1),d=wp.bind(null,Ph);function f(E,Q){let $,J;return uC(E)?($=e.getRecordMatcher(E),J=Q):J=E,e.addRoute(J,$)}function p(E){const Q=e.getRecordMatcher(E);Q&&e.removeRoute(Q)}function _(){return e.getRoutes().map(E=>E.record)}function y(E){return!!e.getRecordMatcher(E)}function I(E,Q){if(Q=xe({},Q||c.value),typeof E=="string"){const he=bp(n,E,Q.path),g=e.resolve({path:he.path},Q),m=r.createHref(he.fullPath);return xe(he,g,{params:d(g.params),hash:Ph(he.hash),redirectedFrom:void 0,href:m})}let $;if("path"in E)$=xe({},E,{path:bp(n,E.path,Q.path).path});else{const he=xe({},E.params);for(const g in he)he[g]==null&&delete he[g];$=xe({},E,{params:h(E.params)}),Q.params=h(Q.params)}const J=e.resolve($,Q),Ne=E.hash||"";J.params=u(d(J.params));const $e=GM(s,xe({},E,{hash:x1(Ne),path:J.path})),me=r.createHref($e);return xe({fullPath:$e,hash:Ne,query:s===Ib?U1(E.query):E.query||{}},J,{redirectedFrom:void 0,href:me})}function N(E){return typeof E=="string"?bp(n,E,c.value.path):xe({},E)}function k(E,Q){if(l!==E)return pa(8,{from:Q,to:E})}function M(E){return z(E)}function j(E){return M(xe(N(E),{replace:!0}))}function Y(E){const Q=E.matched[E.matched.length-1];if(Q&&Q.redirect){const{redirect:$}=Q;let J=typeof $=="function"?$(E):$;return typeof J=="string"&&(J=J.includes("?")||J.includes("#")?J=N(J):{path:J},J.params={}),xe({query:E.query,hash:E.hash,params:E.params},J)}}function z(E,Q){const $=l=I(E),J=c.value,Ne=E.state,$e=E.force,me=E.replace===!0,he=Y($);if(he)return z(xe(N(he),{state:Ne,force:$e,replace:me}),Q||$);const g=$;g.redirectedFrom=Q;let m;return!$e&&zM(s,J,$)&&(m=pa(16,{to:g,from:J}),Do(J,J,!0,!1)),(m?Promise.resolve(m):ie(g,J)).catch(b=>wr(b)?wr(b,2)?b:En(b):Ue(b,g,J)).then(b=>{if(b){if(wr(b,2))return z(xe(N(b.to),{state:Ne,force:$e,replace:me}),Q||g)}else b=Fe(g,J,!0,me,Ne);return _e(g,J,b),b})}function V(E,Q){const $=k(E,Q);return $?Promise.reject($):Promise.resolve()}function ie(E,Q){let $;const[J,Ne,$e]=G1(E,Q);$=Ip(J.reverse(),"beforeRouteLeave",E,Q);for(const he of J)he.leaveGuards.forEach(g=>{$.push(Cr(g,E,Q))});const me=V.bind(null,E,Q);return $.push(me),Oo($).then(()=>{$=[];for(const he of i.list())$.push(Cr(he,E,Q));return $.push(me),Oo($)}).then(()=>{$=Ip(Ne,"beforeRouteUpdate",E,Q);for(const he of Ne)he.updateGuards.forEach(g=>{$.push(Cr(g,E,Q))});return $.push(me),Oo($)}).then(()=>{$=[];for(const he of E.matched)if(he.beforeEnter&&!Q.matched.includes(he))if(Array.isArray(he.beforeEnter))for(const g of he.beforeEnter)$.push(Cr(g,E,Q));else $.push(Cr(he.beforeEnter,E,Q));return $.push(me),Oo($)}).then(()=>(E.matched.forEach(he=>he.enterCallbacks={}),$=Ip($e,"beforeRouteEnter",E,Q),$.push(me),Oo($))).then(()=>{$=[];for(const he of o.list())$.push(Cr(he,E,Q));return $.push(me),Oo($)}).catch(he=>wr(he,8)?he:Promise.reject(he))}function _e(E,Q,$){for(const J of a.list())J(E,Q,$)}function Fe(E,Q,$,J,Ne){const $e=k(E,Q);if($e)return $e;const me=Q===vr,he=Ko?history.state:{};$&&(J||me?r.replace(E.fullPath,xe({scroll:me&&he&&he.scroll},Ne)):r.push(E.fullPath,Ne)),c.value=E,Do(E,Q,$,me),En()}let H;function ke(){H=r.listen((E,Q,$)=>{const J=I(E),Ne=Y(J);if(Ne){z(xe(Ne,{replace:!0}),J).catch(Mc);return}l=J;const $e=c.value;Ko&&n1(mb($e.fullPath,$.delta),Wd()),ie(J,$e).catch(me=>wr(me,12)?me:wr(me,2)?(z(me.to,J).then(he=>{wr(he,20)&&!$.delta&&$.type===ll.pop&&r.go(-1,!1)}).catch(Mc),Promise.reject()):($.delta&&r.go(-$.delta,!1),Ue(me,J,$e))).then(me=>{me=me||Fe(J,$e,!1),me&&($.delta?r.go(-$.delta,!1):$.type===ll.pop&&wr(me,20)&&r.go(-1,!1)),_e(J,$e,me)}).catch(Mc)})}let Je=ac(),Xe=ac(),Ze;function Ue(E,Q,$){En(E);const J=Xe.list();return J.length?J.forEach(Ne=>Ne(E,Q,$)):console.error(E),Promise.reject(E)}function Re(){return Ze&&c.value!==vr?Promise.resolve():new Promise((E,Q)=>{Je.add([E,Q])})}function En(E){return Ze||(Ze=!E,ke(),Je.list().forEach(([Q,$])=>E?$(E):Q()),Je.reset()),E}function Do(E,Q,$,J){const{scrollBehavior:Ne}=t;if(!Ko||!Ne)return Promise.resolve();const $e=!$&&s1(mb(E.fullPath,0))||(J||!$)&&history.state&&history.state.scroll||null;return g_().then(()=>Ne(E,Q,$e)).then(me=>me&&t1(me)).catch(me=>Ue(me,E,Q))}const qs=E=>r.go(E);let ds;const Mn=new Set;return{currentRoute:c,addRoute:f,removeRoute:p,hasRoute:y,getRoutes:_,resolve:I,options:t,push:M,replace:j,go:qs,back:()=>qs(-1),forward:()=>qs(1),beforeEach:i.add,beforeResolve:o.add,afterEach:a.add,onError:Xe.add,isReady:Re,install(E){const Q=this;E.component("RouterLink",B1),E.component("RouterView",W1),E.config.globalProperties.$router=Q,Object.defineProperty(E.config.globalProperties,"$route",{enumerable:!0,get:()=>Nc(c)}),Ko&&!ds&&c.value===vr&&(ds=!0,M(r.location).catch(Ne=>{}));const $={};for(const Ne in vr)$[Ne]=ts(()=>c.value[Ne]);E.provide(Kd,Q),E.provide(aC,La($)),E.provide(Fg,c);const J=E.unmount;Mn.add(E),E.unmount=function(){Mn.delete(E),Mn.size<1&&(l=vr,H&&H(),c.value=vr,ds=!1,Ze=!1),J()}}}}function Oo(t){return t.reduce((e,n)=>e.then(()=>n()),Promise.resolve())}function G1(t,e){const n=[],s=[],r=[],i=Math.max(e.matched.length,t.matched.length);for(let o=0;o<i;o++){const a=e.matched[o];a&&(t.matched.find(l=>fa(l,a))?s.push(a):n.push(a));const c=t.matched[o];c&&(e.matched.find(l=>fa(l,c))||r.push(c))}return[n,s,r]}function l9(){return Cs(Kd)}const z1=[{name:"Home",component:()=>gs(()=>import("./Home.7bd0b74b.js"),["assets/Home.7bd0b74b.js","assets/Home.f371d1e7.css","assets/loader.55fdc696.js","assets/loader.3b2bd4b3.css"]),path:"/"},{name:"Add",component:()=>gs(()=>import("./Add.894e13a4.js"),["assets/Add.894e13a4.js","assets/Add.eeef4092.css","assets/level.19f89a9b.js","assets/types.7d33b1ee.js","assets/loader.55fdc696.js","assets/loader.3b2bd4b3.css"]),path:"/add"},{name:"Admin",component:()=>gs(()=>import("./admin.a3cf82e9.js"),["assets/admin.a3cf82e9.js","assets/admin.1da9aa51.css","assets/loader.55fdc696.js","assets/loader.3b2bd4b3.css"]),path:"/admin"},{name:"Univercities",component:()=>gs(()=>import("./Uni.93c93008.js"),["assets/Uni.93c93008.js","assets/Uni.ff0c6bdd.css","assets/loader.55fdc696.js","assets/loader.3b2bd4b3.css"]),path:"/Univercities"},{name:"loader",component:()=>gs(()=>import("./loader.55fdc696.js"),["assets/loader.55fdc696.js","assets/loader.3b2bd4b3.css"]),path:"/loader"},{name:"details",component:()=>gs(()=>import("./details.21b21df5.js"),["assets/details.21b21df5.js","assets/details.511e542e.css","assets/loader.55fdc696.js","assets/loader.3b2bd4b3.css"]),path:"/University/:name"},{name:"mobileNav",component:()=>gs(()=>import("./mobileNav.587be0fe.js"),["assets/mobileNav.587be0fe.js","assets/mobileNav.7521cf29.css"]),path:"/nav"},{name:"Dashboard",component:()=>gs(()=>import("./Dashboard.382e52b4.js"),["assets/Dashboard.382e52b4.js","assets/Dashboard.bc87434d.css","assets/loader.55fdc696.js","assets/loader.3b2bd4b3.css"]),path:"/admin/dashboard"},{name:"Edit",component:()=>gs(()=>import("./Edit.2629f1d2.js"),["assets/Edit.2629f1d2.js","assets/Edit.15555826.css","assets/loader.55fdc696.js","assets/loader.3b2bd4b3.css","assets/level.19f89a9b.js","assets/types.7d33b1ee.js"]),path:"/admin/dashboard/edit/:name"},{name:"Testing",component:()=>gs(()=>import("./teting.121f75c8.js"),["assets/teting.121f75c8.js","assets/types.7d33b1ee.js"]),path:"/Testing"}],Q1=H1({history:c1(),routes:z1});var yC=(t,e)=>{const n=t.__vccOpts||t;for(const[s,r]of e)n[s]=r;return n};const Y1={},T_=t=>(hO("data-v-a551ee56"),t=t(),dO(),t),J1={class:"container"},X1={class:"flex center between",id:"main-nav"},Z1=T_(()=>Kn("div",{class:"flex center"},[Kn("div",{class:"logo"},[Kn("h1",null,"EDUCATIA")])],-1)),eL={class:"li"},tL=v_("Home"),nL=v_("Universities"),sL=T_(()=>Kn("a",{href:"#"},"Degrees",-1)),rL=T_(()=>Kn("div",{class:"nav-button"},[Kn("a",{href:"#contact-form"},[Kn("button",{class:"btn btn-primary"},"Conatact")])],-1));function iL(t,e,n,s,r,i){const o=kg("router-link");return Nh(),XS("header",null,[Kn("div",J1,[Kn("nav",X1,[Z1,Kn("div",eL,[$t(o,{to:"/"},{default:Sg(()=>[tL]),_:1}),$t(o,{to:"/Univercities"},{default:Sg(()=>[nL]),_:1}),sL]),rL])])])}var oL=yC(Y1,[["render",iL],["__scopeId","data-v-a551ee56"]]);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vC={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const x=function(t,e){if(!t)throw Ua(e)},Ua=function(t){return new Error("Firebase Database ("+vC.SDK_VERSION+") INTERNAL ASSERT FAILED: "+t)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wC=function(t){const e=[];let n=0;for(let s=0;s<t.length;s++){let r=t.charCodeAt(s);r<128?e[n++]=r:r<2048?(e[n++]=r>>6|192,e[n++]=r&63|128):(r&64512)===55296&&s+1<t.length&&(t.charCodeAt(s+1)&64512)===56320?(r=65536+((r&1023)<<10)+(t.charCodeAt(++s)&1023),e[n++]=r>>18|240,e[n++]=r>>12&63|128,e[n++]=r>>6&63|128,e[n++]=r&63|128):(e[n++]=r>>12|224,e[n++]=r>>6&63|128,e[n++]=r&63|128)}return e},aL=function(t){const e=[];let n=0,s=0;for(;n<t.length;){const r=t[n++];if(r<128)e[s++]=String.fromCharCode(r);else if(r>191&&r<224){const i=t[n++];e[s++]=String.fromCharCode((r&31)<<6|i&63)}else if(r>239&&r<365){const i=t[n++],o=t[n++],a=t[n++],c=((r&7)<<18|(i&63)<<12|(o&63)<<6|a&63)-65536;e[s++]=String.fromCharCode(55296+(c>>10)),e[s++]=String.fromCharCode(56320+(c&1023))}else{const i=t[n++],o=t[n++];e[s++]=String.fromCharCode((r&15)<<12|(i&63)<<6|o&63)}}return e.join("")},Hd={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,s=[];for(let r=0;r<t.length;r+=3){const i=t[r],o=r+1<t.length,a=o?t[r+1]:0,c=r+2<t.length,l=c?t[r+2]:0,u=i>>2,h=(i&3)<<4|a>>4;let d=(a&15)<<2|l>>6,f=l&63;c||(f=64,o||(d=64)),s.push(n[u],n[h],n[d],n[f])}return s.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(wC(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):aL(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,s=[];for(let r=0;r<t.length;){const i=n[t.charAt(r++)],a=r<t.length?n[t.charAt(r)]:0;++r;const l=r<t.length?n[t.charAt(r)]:64;++r;const h=r<t.length?n[t.charAt(r)]:64;if(++r,i==null||a==null||l==null||h==null)throw Error();const d=i<<2|a>>4;if(s.push(d),l!==64){const f=a<<4&240|l>>2;if(s.push(f),h!==64){const p=l<<6&192|h;s.push(p)}}}return s},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}},bC=function(t){const e=wC(t);return Hd.encodeByteArray(e,!0)},Dh=function(t){return bC(t).replace(/\./g,"")},Vg=function(t){try{return Hd.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cL(t){return ul(void 0,t)}function ul(t,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:const n=e;return new Date(n.getTime());case Object:t===void 0&&(t={});break;case Array:t=[];break;default:return e}for(const n in e)!e.hasOwnProperty(n)||!lL(n)||(t[n]=ul(t[n],e[n]));return t}function lL(t){return t!=="__proto__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pt{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,s)=>{n?this.reject(n):this.resolve(s),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,s))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function S_(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},s=e||"demo-project",r=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${s}`,aud:s,iat:r,exp:r+3600,auth_time:r,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},t),a="";return[Dh(JSON.stringify(n)),Dh(JSON.stringify(o)),a].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function We(){return typeof navigator!="undefined"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function Gd(){return typeof window!="undefined"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(We())}function C_(){try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function uL(){return typeof self=="object"&&self.self===self}function eu(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function tu(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function hL(){return We().indexOf("Electron/")>=0}function A_(){const t=We();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function dL(){return We().indexOf("MSAppHost/")>=0}function IC(){return vC.NODE_ADMIN===!0}function fL(){return!C_()&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function bn(){return typeof indexedDB=="object"}function nu(){return new Promise((t,e)=>{try{let n=!0;const s="validate-browser-context-for-indexeddb-analytics-module",r=self.indexedDB.open(s);r.onsuccess=()=>{r.result.close(),n||self.indexedDB.deleteDatabase(s),t(!0)},r.onupgradeneeded=()=>{n=!1},r.onerror=()=>{var i;e(((i=r.error)===null||i===void 0?void 0:i.message)||"")}}catch(n){e(n)}})}function zd(){return!(typeof navigator=="undefined"||!navigator.cookieEnabled)}function pL(){if(typeof self!="undefined")return self;if(typeof window!="undefined")return window;if(typeof global!="undefined")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gL="FirebaseError";class ct extends Error{constructor(e,n,s){super(n),this.code=e,this.customData=s,this.name=gL,Object.setPrototypeOf(this,ct.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,dn.prototype.create)}}class dn{constructor(e,n,s){this.service=e,this.serviceName=n,this.errors=s}create(e,...n){const s=n[0]||{},r=`${this.service}/${e}`,i=this.errors[e],o=i?mL(i,s):"Error",a=`${this.serviceName}: ${o} (${r}).`;return new ct(r,a,s)}}function mL(t,e){return t.replace(_L,(n,s)=>{const r=e[s];return r!=null?String(r):`<${s}?>`})}const _L=/\{\$([^}]+)}/g;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hl(t){return JSON.parse(t)}function gt(t){return JSON.stringify(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const k_=function(t){let e={},n={},s={},r="";try{const i=t.split(".");e=hl(Vg(i[0])||""),n=hl(Vg(i[1])||""),r=i[2],s=n.d||{},delete n.d}catch{}return{header:e,claims:n,data:s,signature:r}},yL=function(t){const e=k_(t).claims;return typeof e=="object"&&e.hasOwnProperty("iat")?e.iat:null},vL=function(t){const e=k_(t),n=e.claims;return!!n&&typeof n=="object"&&n.hasOwnProperty("iat")},wL=function(t){const e=k_(t).claims;return typeof e=="object"&&e.admin===!0};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dn(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function Hi(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]}function xh(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Oh(t,e,n){const s={};for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&(s[r]=e.call(n,t[r],r,t));return s}function Bg(t,e){if(t===e)return!0;const n=Object.keys(t),s=Object.keys(e);for(const r of n){if(!s.includes(r))return!1;const i=t[r],o=e[r];if(Ab(i)&&Ab(o)){if(!Bg(i,o))return!1}else if(i!==o)return!1}for(const r of s)if(!n.includes(r))return!1;return!0}function Ab(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wo(t){const e=[];for(const[n,s]of Object.entries(t))Array.isArray(s)?s.forEach(r=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(r))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(s));return e.length?"&"+e.join("&"):""}function Ho(t){const e={};return t.replace(/^\?/,"").split("&").forEach(s=>{if(s){const[r,i]=s.split("=");e[decodeURIComponent(r)]=decodeURIComponent(i)}}),e}function Sc(t){const e=t.indexOf("?");if(!e)return"";const n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bL{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=512/8,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(e,n){n||(n=0);const s=this.W_;if(typeof e=="string")for(let h=0;h<16;h++)s[h]=e.charCodeAt(n)<<24|e.charCodeAt(n+1)<<16|e.charCodeAt(n+2)<<8|e.charCodeAt(n+3),n+=4;else for(let h=0;h<16;h++)s[h]=e[n]<<24|e[n+1]<<16|e[n+2]<<8|e[n+3],n+=4;for(let h=16;h<80;h++){const d=s[h-3]^s[h-8]^s[h-14]^s[h-16];s[h]=(d<<1|d>>>31)&4294967295}let r=this.chain_[0],i=this.chain_[1],o=this.chain_[2],a=this.chain_[3],c=this.chain_[4],l,u;for(let h=0;h<80;h++){h<40?h<20?(l=a^i&(o^a),u=1518500249):(l=i^o^a,u=1859775393):h<60?(l=i&o|a&(i|o),u=2400959708):(l=i^o^a,u=3395469782);const d=(r<<5|r>>>27)+l+c+u+s[h]&4294967295;c=a,a=o,o=(i<<30|i>>>2)&4294967295,i=r,r=d}this.chain_[0]=this.chain_[0]+r&4294967295,this.chain_[1]=this.chain_[1]+i&4294967295,this.chain_[2]=this.chain_[2]+o&4294967295,this.chain_[3]=this.chain_[3]+a&4294967295,this.chain_[4]=this.chain_[4]+c&4294967295}update(e,n){if(e==null)return;n===void 0&&(n=e.length);const s=n-this.blockSize;let r=0;const i=this.buf_;let o=this.inbuf_;for(;r<n;){if(o===0)for(;r<=s;)this.compress_(e,r),r+=this.blockSize;if(typeof e=="string"){for(;r<n;)if(i[o]=e.charCodeAt(r),++o,++r,o===this.blockSize){this.compress_(i),o=0;break}}else for(;r<n;)if(i[o]=e[r],++o,++r,o===this.blockSize){this.compress_(i),o=0;break}}this.inbuf_=o,this.total_+=n}digest(){const e=[];let n=this.total_*8;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let r=this.blockSize-1;r>=56;r--)this.buf_[r]=n&255,n/=256;this.compress_(this.buf_);let s=0;for(let r=0;r<5;r++)for(let i=24;i>=0;i-=8)e[s]=this.chain_[r]>>i&255,++s;return e}}function EC(t,e){const n=new IL(t,e);return n.subscribe.bind(n)}class IL{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(s=>{this.error(s)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,s){let r;if(e===void 0&&n===void 0&&s===void 0)throw new Error("Missing Observer.");EL(e,["next","error","complete"])?r=e:r={next:e,error:n,complete:s},r.next===void 0&&(r.next=Ep),r.error===void 0&&(r.error=Ep),r.complete===void 0&&(r.complete=Ep);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch{}}),this.observers.push(r),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(s){typeof console!="undefined"&&console.error&&console.error(s)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function EL(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function Ep(){}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ne=function(t,e,n,s){let r;if(s<e?r="at least "+e:s>n&&(r=n===0?"none":"no more than "+n),r){const i=t+" failed: Was called with "+s+(s===1?" argument.":" arguments.")+" Expects "+r+".";throw new Error(i)}};function wn(t,e){return`${t} failed: ${e} argument `}function wt(t,e,n,s){if(!(s&&!n)&&typeof n!="function")throw new Error(wn(t,e)+"must be a valid function.")}function kb(t,e,n,s){if(!(s&&!n)&&(typeof n!="object"||n===null))throw new Error(wn(t,e)+"must be a valid context object.")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TL=function(t){const e=[];let n=0;for(let s=0;s<t.length;s++){let r=t.charCodeAt(s);if(r>=55296&&r<=56319){const i=r-55296;s++,x(s<t.length,"Surrogate pair missing trail surrogate.");const o=t.charCodeAt(s)-56320;r=65536+(i<<10)+o}r<128?e[n++]=r:r<2048?(e[n++]=r>>6|192,e[n++]=r&63|128):r<65536?(e[n++]=r>>12|224,e[n++]=r>>6&63|128,e[n++]=r&63|128):(e[n++]=r>>18|240,e[n++]=r>>12&63|128,e[n++]=r>>6&63|128,e[n++]=r&63|128)}return e},Qd=function(t){let e=0;for(let n=0;n<t.length;n++){const s=t.charCodeAt(n);s<128?e++:s<2048?e+=2:s>=55296&&s<=56319?(e+=4,n++):e+=3}return e};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SL=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,t=>{const e=Math.random()*16|0;return(t==="x"?e:e&3|8).toString(16)})};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CL=1e3,AL=2,kL=4*60*60*1e3,RL=.5;function Mh(t,e=CL,n=AL){const s=e*Math.pow(n,t),r=Math.round(RL*s*(Math.random()-.5)*2);return Math.min(kL,s+r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function A(t){return t&&t._delegate?t._delegate:t}class Ee{constructor(e,n,s){this.name=e,this.instanceFactory=n,this.type=s,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wi="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TC{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const s=new pt;if(this.instancesDeferred.set(n,s),this.isInitialized(n)||this.shouldAutoInitialize())try{const r=this.getOrInitializeService({instanceIdentifier:n});r&&s.resolve(r)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;const s=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),r=(n=e==null?void 0:e.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(s)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:s})}catch(i){if(r)return null;throw i}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(PL(e))try{this.getOrInitializeService({instanceIdentifier:wi})}catch{}for(const[n,s]of this.instancesDeferred.entries()){const r=this.normalizeInstanceIdentifier(n);try{const i=this.getOrInitializeService({instanceIdentifier:r});s.resolve(i)}catch{}}}}clearInstance(e=wi){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=wi){return this.instances.has(e)}getOptions(e=wi){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,s=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(s))throw Error(`${this.name}(${s}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const r=this.getOrInitializeService({instanceIdentifier:s,options:n});for(const[i,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(i);s===a&&o.resolve(r)}return r}onInit(e,n){var s;const r=this.normalizeInstanceIdentifier(n),i=(s=this.onInitCallbacks.get(r))!==null&&s!==void 0?s:new Set;i.add(e),this.onInitCallbacks.set(r,i);const o=this.instances.get(r);return o&&e(o,r),()=>{i.delete(e)}}invokeOnInitCallbacks(e,n){const s=this.onInitCallbacks.get(n);if(!!s)for(const r of s)try{r(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let s=this.instances.get(e);if(!s&&this.component&&(s=this.component.instanceFactory(this.container,{instanceIdentifier:NL(e),options:n}),this.instances.set(e,s),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(s,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,s)}catch{}return s||null}normalizeInstanceIdentifier(e=wi){return this.component?this.component.multipleInstances?e:wi:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function NL(t){return t===wi?void 0:t}function PL(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SC{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new TC(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const R_=[];var de;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(de||(de={}));const CC={debug:de.DEBUG,verbose:de.VERBOSE,info:de.INFO,warn:de.WARN,error:de.ERROR,silent:de.SILENT},DL=de.INFO,xL={[de.DEBUG]:"log",[de.VERBOSE]:"log",[de.INFO]:"info",[de.WARN]:"warn",[de.ERROR]:"error"},OL=(t,e,...n)=>{if(e<t.logLevel)return;const s=new Date().toISOString(),r=xL[e];if(r)console[r](`[${s}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Vs{constructor(e){this.name=e,this._logLevel=DL,this._logHandler=OL,this._userLogHandler=null,R_.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in de))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?CC[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,de.DEBUG,...e),this._logHandler(this,de.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,de.VERBOSE,...e),this._logHandler(this,de.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,de.INFO,...e),this._logHandler(this,de.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,de.WARN,...e),this._logHandler(this,de.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,de.ERROR,...e),this._logHandler(this,de.ERROR,...e)}}function ML(t){R_.forEach(e=>{e.setLogLevel(t)})}function LL(t,e){for(const n of R_){let s=null;e&&e.level&&(s=CC[e.level]),t===null?n.userLogHandler=null:n.userLogHandler=(r,i,...o)=>{const a=o.map(c=>{if(c==null)return null;if(typeof c=="string")return c;if(typeof c=="number"||typeof c=="boolean")return c.toString();if(c instanceof Error)return c.message;try{return JSON.stringify(c)}catch{return null}}).filter(c=>c).join(" ");i>=(s!=null?s:r.logLevel)&&t({level:de[i].toLowerCase(),message:a,args:o,type:r.name})}}}const FL=(t,e)=>e.some(n=>t instanceof n);let Rb,Nb;function UL(){return Rb||(Rb=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function $L(){return Nb||(Nb=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const AC=new WeakMap,qg=new WeakMap,kC=new WeakMap,Tp=new WeakMap,N_=new WeakMap;function VL(t){const e=new Promise((n,s)=>{const r=()=>{t.removeEventListener("success",i),t.removeEventListener("error",o)},i=()=>{n(Xs(t.result)),r()},o=()=>{s(t.error),r()};t.addEventListener("success",i),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&AC.set(n,t)}).catch(()=>{}),N_.set(e,t),e}function BL(t){if(qg.has(t))return;const e=new Promise((n,s)=>{const r=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",o),t.removeEventListener("abort",o)},i=()=>{n(),r()},o=()=>{s(t.error||new DOMException("AbortError","AbortError")),r()};t.addEventListener("complete",i),t.addEventListener("error",o),t.addEventListener("abort",o)});qg.set(t,e)}let jg={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return qg.get(t);if(e==="objectStoreNames")return t.objectStoreNames||kC.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Xs(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function qL(t){jg=t(jg)}function jL(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const s=t.call(Sp(this),e,...n);return kC.set(s,e.sort?e.sort():[e]),Xs(s)}:$L().includes(t)?function(...e){return t.apply(Sp(this),e),Xs(AC.get(this))}:function(...e){return Xs(t.apply(Sp(this),e))}}function KL(t){return typeof t=="function"?jL(t):(t instanceof IDBTransaction&&BL(t),FL(t,UL())?new Proxy(t,jg):t)}function Xs(t){if(t instanceof IDBRequest)return VL(t);if(Tp.has(t))return Tp.get(t);const e=KL(t);return e!==t&&(Tp.set(t,e),N_.set(e,t)),e}const Sp=t=>N_.get(t);function $a(t,e,{blocked:n,upgrade:s,blocking:r,terminated:i}={}){const o=indexedDB.open(t,e),a=Xs(o);return s&&o.addEventListener("upgradeneeded",c=>{s(Xs(o.result),c.oldVersion,c.newVersion,Xs(o.transaction))}),n&&o.addEventListener("blocked",()=>n()),a.then(c=>{i&&c.addEventListener("close",()=>i()),r&&c.addEventListener("versionchange",()=>r())}).catch(()=>{}),a}function Jo(t,{blocked:e}={}){const n=indexedDB.deleteDatabase(t);return e&&n.addEventListener("blocked",()=>e()),Xs(n).then(()=>{})}const WL=["get","getKey","getAll","getAllKeys","count"],HL=["put","add","delete","clear"],Cp=new Map;function Pb(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(Cp.get(e))return Cp.get(e);const n=e.replace(/FromIndex$/,""),s=e!==n,r=HL.includes(n);if(!(n in(s?IDBIndex:IDBObjectStore).prototype)||!(r||WL.includes(n)))return;const i=async function(o,...a){const c=this.transaction(o,r?"readwrite":"readonly");let l=c.store;return s&&(l=l.index(a.shift())),(await Promise.all([l[n](...a),r&&c.done]))[0]};return Cp.set(e,i),i}qL(t=>({...t,get:(e,n,s)=>Pb(e,n)||t.get(e,n,s),has:(e,n)=>!!Pb(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GL{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(zL(n)){const s=n.getImmediate();return`${s.library}/${s.version}`}else return null}).filter(n=>n).join(" ")}}function zL(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Kg="@firebase/app",Db="0.7.28";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const P_=new Vs("@firebase/app"),QL="@firebase/app-compat",YL="@firebase/analytics-compat",JL="@firebase/analytics",XL="@firebase/app-check-compat",ZL="@firebase/app-check",eF="@firebase/auth",tF="@firebase/auth-compat",nF="@firebase/database",sF="@firebase/database-compat",rF="@firebase/functions",iF="@firebase/functions-compat",oF="@firebase/installations",aF="@firebase/installations-compat",cF="@firebase/messaging",lF="@firebase/messaging-compat",uF="@firebase/performance",hF="@firebase/performance-compat",dF="@firebase/remote-config",fF="@firebase/remote-config-compat",pF="@firebase/storage",gF="@firebase/storage-compat",mF="@firebase/firestore",_F="@firebase/firestore-compat",yF="firebase",vF="9.9.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gi="[DEFAULT]",wF={[Kg]:"fire-core",[QL]:"fire-core-compat",[JL]:"fire-analytics",[YL]:"fire-analytics-compat",[ZL]:"fire-app-check",[XL]:"fire-app-check-compat",[eF]:"fire-auth",[tF]:"fire-auth-compat",[nF]:"fire-rtdb",[sF]:"fire-rtdb-compat",[rF]:"fire-fn",[iF]:"fire-fn-compat",[oF]:"fire-iid",[aF]:"fire-iid-compat",[cF]:"fire-fcm",[lF]:"fire-fcm-compat",[uF]:"fire-perf",[hF]:"fire-perf-compat",[dF]:"fire-rc",[fF]:"fire-rc-compat",[pF]:"fire-gcs",[gF]:"fire-gcs-compat",[mF]:"fire-fst",[_F]:"fire-fst-compat","fire-js":"fire-js",[yF]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wr=new Map,dl=new Map;function Lh(t,e){try{t.container.addComponent(e)}catch(n){P_.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function RC(t,e){t.container.addOrOverwriteComponent(e)}function nt(t){const e=t.name;if(dl.has(e))return P_.debug(`There were multiple attempts to register component ${e}.`),!1;dl.set(e,t);for(const n of Wr.values())Lh(n,t);return!0}function bo(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function bF(t,e,n=Gi){bo(t,e).clearInstance(n)}function IF(){dl.clear()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const EF={["no-app"]:"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()",["bad-app-name"]:"Illegal App name: '{$appName}",["duplicate-app"]:"Firebase App named '{$appName}' already exists with different options or config",["app-deleted"]:"Firebase App named '{$appName}' already deleted",["invalid-app-argument"]:"firebase.{$appName}() takes either no argument or a Firebase App instance.",["invalid-log-argument"]:"First argument to `onLog` must be null or a function.",["storage-open"]:"Error thrown when opening storage. Original error: {$originalErrorMessage}.",["storage-get"]:"Error thrown when reading from storage. Original error: {$originalErrorMessage}.",["storage-set"]:"Error thrown when writing to storage. Original error: {$originalErrorMessage}.",["storage-delete"]:"Error thrown when deleting from storage. Original error: {$originalErrorMessage}."},Hr=new dn("app","Firebase",EF);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TF{constructor(e,n,s){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=s,this.container.addComponent(new Ee("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Hr.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bs=vF;function NC(t,e={}){typeof e!="object"&&(e={name:e});const n=Object.assign({name:Gi,automaticDataCollectionEnabled:!1},e),s=n.name;if(typeof s!="string"||!s)throw Hr.create("bad-app-name",{appName:String(s)});const r=Wr.get(s);if(r){if(Bg(t,r.options)&&Bg(n,r.config))return r;throw Hr.create("duplicate-app",{appName:s})}const i=new SC(s);for(const a of dl.values())i.addComponent(a);const o=new TF(t,n,i);return Wr.set(s,o),o}function PC(t=Gi){const e=Wr.get(t);if(!e)throw Hr.create("no-app",{appName:t});return e}function SF(){return Array.from(Wr.values())}async function DC(t){const e=t.name;Wr.has(e)&&(Wr.delete(e),await Promise.all(t.container.getProviders().map(n=>n.delete())),t.isDeleted=!0)}function Le(t,e,n){var s;let r=(s=wF[t])!==null&&s!==void 0?s:t;n&&(r+=`-${n}`);const i=r.match(/\s|\//),o=e.match(/\s|\//);if(i||o){const a=[`Unable to register library "${r}" with version "${e}":`];i&&a.push(`library name "${r}" contains illegal characters (whitespace or "/")`),i&&o&&a.push("and"),o&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),P_.warn(a.join(" "));return}nt(new Ee(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}function xC(t,e){if(t!==null&&typeof t!="function")throw Hr.create("invalid-log-argument");LL(t,e)}function OC(t){ML(t)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CF="firebase-heartbeat-database",AF=1,fl="firebase-heartbeat-store";let Ap=null;function MC(){return Ap||(Ap=$a(CF,AF,{upgrade:(t,e)=>{switch(e){case 0:t.createObjectStore(fl)}}}).catch(t=>{throw Hr.create("storage-open",{originalErrorMessage:t.message})})),Ap}async function kF(t){var e;try{return(await MC()).transaction(fl).objectStore(fl).get(LC(t))}catch(n){throw Hr.create("storage-get",{originalErrorMessage:(e=n)===null||e===void 0?void 0:e.message})}}async function xb(t,e){var n;try{const r=(await MC()).transaction(fl,"readwrite");return await r.objectStore(fl).put(e,LC(t)),r.done}catch(s){throw Hr.create("storage-set",{originalErrorMessage:(n=s)===null||n===void 0?void 0:n.message})}}function LC(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RF=1024,NF=30*24*60*60*1e3;class PF{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new xF(n),this._heartbeatsCachePromise=this._storage.read().then(s=>(this._heartbeatsCache=s,s))}async triggerHeartbeat(){const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=Ob();if(this._heartbeatsCache===null&&(this._heartbeatsCache=await this._heartbeatsCachePromise),!(this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(r=>r.date===s)))return this._heartbeatsCache.heartbeats.push({date:s,agent:n}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(r=>{const i=new Date(r.date).valueOf();return Date.now()-i<=NF}),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache===null||this._heartbeatsCache.heartbeats.length===0)return"";const e=Ob(),{heartbeatsToSend:n,unsentEntries:s}=DF(this._heartbeatsCache.heartbeats),r=Dh(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=e,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),r}}function Ob(){return new Date().toISOString().substring(0,10)}function DF(t,e=RF){const n=[];let s=t.slice();for(const r of t){const i=n.find(o=>o.agent===r.agent);if(i){if(i.dates.push(r.date),Mb(n)>e){i.dates.pop();break}}else if(n.push({agent:r.agent,dates:[r.date]}),Mb(n)>e){n.pop();break}s=s.slice(1)}return{heartbeatsToSend:n,unsentEntries:s}}class xF{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return bn()?nu().then(()=>!0).catch(()=>!1):!1}async read(){return await this._canUseIndexedDBPromise?await kF(this.app)||{heartbeats:[]}:{heartbeats:[]}}async overwrite(e){var n;if(await this._canUseIndexedDBPromise){const r=await this.read();return xb(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var n;if(await this._canUseIndexedDBPromise){const r=await this.read();return xb(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function Mb(t){return Dh(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function OF(t){nt(new Ee("platform-logger",e=>new GL(e),"PRIVATE")),nt(new Ee("heartbeat",e=>new PF(e),"PRIVATE")),Le(Kg,Db,t),Le(Kg,Db,"esm2017"),Le("fire-js","")}OF("");var MF=Object.freeze(Object.defineProperty({__proto__:null,SDK_VERSION:Bs,_DEFAULT_ENTRY_NAME:Gi,_addComponent:Lh,_addOrOverwriteComponent:RC,_apps:Wr,_clearComponents:IF,_components:dl,_getProvider:bo,_registerComponent:nt,_removeServiceInstance:bF,deleteApp:DC,getApp:PC,getApps:SF,initializeApp:NC,onLog:xC,registerVersion:Le,setLogLevel:OC,FirebaseError:ct},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LF{constructor(e,n){this._delegate=e,this.firebase=n,Lh(e,new Ee("app-compat",()=>this,"PUBLIC")),this.container=e.container}get automaticDataCollectionEnabled(){return this._delegate.automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this._delegate.automaticDataCollectionEnabled=e}get name(){return this._delegate.name}get options(){return this._delegate.options}delete(){return new Promise(e=>{this._delegate.checkDestroyed(),e()}).then(()=>(this.firebase.INTERNAL.removeApp(this.name),DC(this._delegate)))}_getService(e,n=Gi){var s;this._delegate.checkDestroyed();const r=this._delegate.container.getProvider(e);return!r.isInitialized()&&((s=r.getComponent())===null||s===void 0?void 0:s.instantiationMode)==="EXPLICIT"&&r.initialize(),r.getImmediate({identifier:n})}_removeServiceInstance(e,n=Gi){this._delegate.container.getProvider(e).clearInstance(n)}_addComponent(e){Lh(this._delegate,e)}_addOrOverwriteComponent(e){RC(this._delegate,e)}toJSON(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FF={["no-app"]:"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()",["invalid-app-argument"]:"firebase.{$appName}() takes either no argument or a Firebase App instance."},Lb=new dn("app-compat","Firebase",FF);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function UF(t){const e={},n={__esModule:!0,initializeApp:i,app:r,registerVersion:Le,setLogLevel:OC,onLog:xC,apps:null,SDK_VERSION:Bs,INTERNAL:{registerComponent:a,removeApp:s,useAsService:c,modularAPIs:MF}};n.default=n,Object.defineProperty(n,"apps",{get:o});function s(l){delete e[l]}function r(l){if(l=l||Gi,!Dn(e,l))throw Lb.create("no-app",{appName:l});return e[l]}r.App=t;function i(l,u={}){const h=NC(l,u);if(Dn(e,h.name))return e[h.name];const d=new t(h,n);return e[h.name]=d,d}function o(){return Object.keys(e).map(l=>e[l])}function a(l){const u=l.name,h=u.replace("-compat","");if(nt(l)&&l.type==="PUBLIC"){const d=(f=r())=>{if(typeof f[h]!="function")throw Lb.create("invalid-app-argument",{appName:u});return f[h]()};l.serviceProps!==void 0&&ul(d,l.serviceProps),n[h]=d,t.prototype[h]=function(...f){return this._getService.bind(this,u).apply(this,l.multipleInstances?f:[])}}return l.type==="PUBLIC"?n[h]:null}function c(l,u){return u==="serverAuth"?null:u}return n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function FC(){const t=UF(LF);t.INTERNAL=Object.assign(Object.assign({},t.INTERNAL),{createFirebaseNamespace:FC,extendNamespace:e,createSubscribe:EC,ErrorFactory:dn,deepExtend:ul});function e(n){ul(t,n)}return t}const $F=FC();/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fb=new Vs("@firebase/app-compat"),VF="@firebase/app-compat",BF="0.1.29";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qF(t){Le(VF,BF,t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */if(uL()&&self.firebase!==void 0){Fb.warn(`
    Warning: Firebase is already defined in the global scope. Please make sure
    Firebase library is only loaded once.
  `);const t=self.firebase.SDK_VERSION;t&&t.indexOf("LITE")>=0&&Fb.warn(`
    Warning: You are trying to load Firebase while using Firebase Performance standalone script.
    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.
    `)}const lt=$F;qF();const UC="@firebase/installations",D_="0.5.12";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $C=1e4,VC=`w:${D_}`,BC="FIS_v2",jF="https://firebaseinstallations.googleapis.com/v1",KF=60*60*1e3,WF="installations",HF="Installations";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GF={["missing-app-config-values"]:'Missing App configuration value: "{$valueName}"',["not-registered"]:"Firebase Installation is not registered.",["installation-not-found"]:"Firebase Installation not found.",["request-failed"]:'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',["app-offline"]:"Could not process request. Application offline.",["delete-pending-registration"]:"Can't delete installation while there is a pending registration request."},zi=new dn(WF,HF,GF);function qC(t){return t instanceof ct&&t.code.includes("request-failed")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jC({projectId:t}){return`${jF}/projects/${t}/installations`}function KC(t){return{token:t.token,requestStatus:2,expiresIn:QF(t.expiresIn),creationTime:Date.now()}}async function WC(t,e){const s=(await e.json()).error;return zi.create("request-failed",{requestName:t,serverCode:s.code,serverMessage:s.message,serverStatus:s.status})}function HC({apiKey:t}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t})}function zF(t,{refreshToken:e}){const n=HC(t);return n.append("Authorization",YF(e)),n}async function GC(t){const e=await t();return e.status>=500&&e.status<600?t():e}function QF(t){return Number(t.replace("s","000"))}function YF(t){return`${BC} ${t}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function JF({appConfig:t,heartbeatServiceProvider:e},{fid:n}){const s=jC(t),r=HC(t),i=e.getImmediate({optional:!0});if(i){const l=await i.getHeartbeatsHeader();l&&r.append("x-firebase-client",l)}const o={fid:n,authVersion:BC,appId:t.appId,sdkVersion:VC},a={method:"POST",headers:r,body:JSON.stringify(o)},c=await GC(()=>fetch(s,a));if(c.ok){const l=await c.json();return{fid:l.fid||n,registrationStatus:2,refreshToken:l.refreshToken,authToken:KC(l.authToken)}}else throw await WC("Create Installation",c)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zC(t){return new Promise(e=>{setTimeout(e,t)})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function XF(t){return btoa(String.fromCharCode(...t)).replace(/\+/g,"-").replace(/\//g,"_")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZF=/^[cdef][\w-]{21}$/,Wg="";function eU(){try{const t=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(t),t[0]=112+t[0]%16;const n=tU(t);return ZF.test(n)?n:Wg}catch{return Wg}}function tU(t){return XF(t).substr(0,22)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yd(t){return`${t.appName}!${t.appId}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QC=new Map;function YC(t,e){const n=Yd(t);JC(n,e),nU(n,e)}function JC(t,e){const n=QC.get(t);if(!!n)for(const s of n)s(e)}function nU(t,e){const n=sU();n&&n.postMessage({key:t,fid:e}),rU()}let Di=null;function sU(){return!Di&&"BroadcastChannel"in self&&(Di=new BroadcastChannel("[Firebase] FID Change"),Di.onmessage=t=>{JC(t.data.key,t.data.fid)}),Di}function rU(){QC.size===0&&Di&&(Di.close(),Di=null)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iU="firebase-installations-database",oU=1,Qi="firebase-installations-store";let kp=null;function x_(){return kp||(kp=$a(iU,oU,{upgrade:(t,e)=>{switch(e){case 0:t.createObjectStore(Qi)}}})),kp}async function Fh(t,e){const n=Yd(t),r=(await x_()).transaction(Qi,"readwrite"),i=r.objectStore(Qi),o=await i.get(n);return await i.put(e,n),await r.done,(!o||o.fid!==e.fid)&&YC(t,e.fid),e}async function XC(t){const e=Yd(t),s=(await x_()).transaction(Qi,"readwrite");await s.objectStore(Qi).delete(e),await s.done}async function Jd(t,e){const n=Yd(t),r=(await x_()).transaction(Qi,"readwrite"),i=r.objectStore(Qi),o=await i.get(n),a=e(o);return a===void 0?await i.delete(n):await i.put(a,n),await r.done,a&&(!o||o.fid!==a.fid)&&YC(t,a.fid),a}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function O_(t){let e;const n=await Jd(t.appConfig,s=>{const r=aU(s),i=cU(t,r);return e=i.registrationPromise,i.installationEntry});return n.fid===Wg?{installationEntry:await e}:{installationEntry:n,registrationPromise:e}}function aU(t){const e=t||{fid:eU(),registrationStatus:0};return ZC(e)}function cU(t,e){if(e.registrationStatus===0){if(!navigator.onLine){const r=Promise.reject(zi.create("app-offline"));return{installationEntry:e,registrationPromise:r}}const n={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},s=lU(t,n);return{installationEntry:n,registrationPromise:s}}else return e.registrationStatus===1?{installationEntry:e,registrationPromise:uU(t)}:{installationEntry:e}}async function lU(t,e){try{const n=await JF(t,e);return Fh(t.appConfig,n)}catch(n){throw qC(n)&&n.customData.serverCode===409?await XC(t.appConfig):await Fh(t.appConfig,{fid:e.fid,registrationStatus:0}),n}}async function uU(t){let e=await Ub(t.appConfig);for(;e.registrationStatus===1;)await zC(100),e=await Ub(t.appConfig);if(e.registrationStatus===0){const{installationEntry:n,registrationPromise:s}=await O_(t);return s||n}return e}function Ub(t){return Jd(t,e=>{if(!e)throw zi.create("installation-not-found");return ZC(e)})}function ZC(t){return hU(t)?{fid:t.fid,registrationStatus:0}:t}function hU(t){return t.registrationStatus===1&&t.registrationTime+$C<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function dU({appConfig:t,heartbeatServiceProvider:e},n){const s=fU(t,n),r=zF(t,n),i=e.getImmediate({optional:!0});if(i){const l=await i.getHeartbeatsHeader();l&&r.append("x-firebase-client",l)}const o={installation:{sdkVersion:VC,appId:t.appId}},a={method:"POST",headers:r,body:JSON.stringify(o)},c=await GC(()=>fetch(s,a));if(c.ok){const l=await c.json();return KC(l)}else throw await WC("Generate Auth Token",c)}function fU(t,{fid:e}){return`${jC(t)}/${e}/authTokens:generate`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function M_(t,e=!1){let n;const s=await Jd(t.appConfig,i=>{if(!e0(i))throw zi.create("not-registered");const o=i.authToken;if(!e&&mU(o))return i;if(o.requestStatus===1)return n=pU(t,e),i;{if(!navigator.onLine)throw zi.create("app-offline");const a=yU(i);return n=gU(t,a),a}});return n?await n:s.authToken}async function pU(t,e){let n=await $b(t.appConfig);for(;n.authToken.requestStatus===1;)await zC(100),n=await $b(t.appConfig);const s=n.authToken;return s.requestStatus===0?M_(t,e):s}function $b(t){return Jd(t,e=>{if(!e0(e))throw zi.create("not-registered");const n=e.authToken;return vU(n)?Object.assign(Object.assign({},e),{authToken:{requestStatus:0}}):e})}async function gU(t,e){try{const n=await dU(t,e),s=Object.assign(Object.assign({},e),{authToken:n});return await Fh(t.appConfig,s),n}catch(n){if(qC(n)&&(n.customData.serverCode===401||n.customData.serverCode===404))await XC(t.appConfig);else{const s=Object.assign(Object.assign({},e),{authToken:{requestStatus:0}});await Fh(t.appConfig,s)}throw n}}function e0(t){return t!==void 0&&t.registrationStatus===2}function mU(t){return t.requestStatus===2&&!_U(t)}function _U(t){const e=Date.now();return e<t.creationTime||t.creationTime+t.expiresIn<e+KF}function yU(t){const e={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},t),{authToken:e})}function vU(t){return t.requestStatus===1&&t.requestTime+$C<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function wU(t){const e=t,{installationEntry:n,registrationPromise:s}=await O_(e);return s?s.catch(console.error):M_(e).catch(console.error),n.fid}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function bU(t,e=!1){const n=t;return await IU(n),(await M_(n,e)).token}async function IU(t){const{registrationPromise:e}=await O_(t);e&&await e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function EU(t){if(!t||!t.options)throw Rp("App Configuration");if(!t.name)throw Rp("App Name");const e=["projectId","apiKey","appId"];for(const n of e)if(!t.options[n])throw Rp(n);return{appName:t.name,projectId:t.options.projectId,apiKey:t.options.apiKey,appId:t.options.appId}}function Rp(t){return zi.create("missing-app-config-values",{valueName:t})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const t0="installations",TU="installations-internal",SU=t=>{const e=t.getProvider("app").getImmediate(),n=EU(e),s=bo(e,"heartbeat");return{app:e,appConfig:n,heartbeatServiceProvider:s,_delete:()=>Promise.resolve()}},CU=t=>{const e=t.getProvider("app").getImmediate(),n=bo(e,t0).getImmediate();return{getId:()=>wU(n),getToken:r=>bU(n,r)}};function AU(){nt(new Ee(t0,SU,"PUBLIC")),nt(new Ee(TU,CU,"PRIVATE"))}AU();Le(UC,D_);Le(UC,D_,"esm2017");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vb="analytics",kU="firebase_id",RU="origin",NU=60*1e3,PU="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",n0="https://www.googletagmanager.com/gtag/js";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bt=new Vs("@firebase/analytics");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function s0(t){return Promise.all(t.map(e=>e.catch(n=>n)))}function DU(t,e){const n=document.createElement("script");n.src=`${n0}?l=${t}&id=${e}`,n.async=!0,document.head.appendChild(n)}function xU(t){let e=[];return Array.isArray(window[t])?e=window[t]:window[t]=e,e}async function OU(t,e,n,s,r,i){const o=s[r];try{if(o)await e[o];else{const c=(await s0(n)).find(l=>l.measurementId===r);c&&await e[c.appId]}}catch(a){Bt.error(a)}t("config",r,i)}async function MU(t,e,n,s,r){try{let i=[];if(r&&r.send_to){let o=r.send_to;Array.isArray(o)||(o=[o]);const a=await s0(n);for(const c of o){const l=a.find(h=>h.measurementId===c),u=l&&e[l.appId];if(u)i.push(u);else{i=[];break}}}i.length===0&&(i=Object.values(e)),await Promise.all(i),t("event",s,r||{})}catch(i){Bt.error(i)}}function LU(t,e,n,s){async function r(i,o,a){try{i==="event"?await MU(t,e,n,o,a):i==="config"?await OU(t,e,n,s,o,a):i==="consent"?t("consent","update",a):t("set",o)}catch(c){Bt.error(c)}}return r}function FU(t,e,n,s,r){let i=function(...o){window[s].push(arguments)};return window[r]&&typeof window[r]=="function"&&(i=window[r]),window[r]=LU(i,t,e,n),{gtagCore:i,wrappedGtag:window[r]}}function UU(){const t=window.document.getElementsByTagName("script");for(const e of Object.values(t))if(e.src&&e.src.includes(n0))return e;return null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $U={["already-exists"]:"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.",["already-initialized"]:"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-intialized instance.",["already-initialized-settings"]:"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.",["interop-component-reg-failed"]:"Firebase Analytics Interop Component failed to instantiate: {$reason}",["invalid-analytics-context"]:"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}",["indexeddb-unavailable"]:"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}",["fetch-throttle"]:"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.",["config-fetch-failed"]:"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}",["no-api-key"]:'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',["no-app-id"]:'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.'},Wn=new dn("analytics","Analytics",$U);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VU=30,BU=1e3;class qU{constructor(e={},n=BU){this.throttleMetadata=e,this.intervalMillis=n}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,n){this.throttleMetadata[e]=n}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}}const r0=new qU;function jU(t){return new Headers({Accept:"application/json","x-goog-api-key":t})}async function KU(t){var e;const{appId:n,apiKey:s}=t,r={method:"GET",headers:jU(s)},i=PU.replace("{app-id}",n),o=await fetch(i,r);if(o.status!==200&&o.status!==304){let a="";try{const c=await o.json();!((e=c.error)===null||e===void 0)&&e.message&&(a=c.error.message)}catch{}throw Wn.create("config-fetch-failed",{httpStatus:o.status,responseMessage:a})}return o.json()}async function WU(t,e=r0,n){const{appId:s,apiKey:r,measurementId:i}=t.options;if(!s)throw Wn.create("no-app-id");if(!r){if(i)return{measurementId:i,appId:s};throw Wn.create("no-api-key")}const o=e.getThrottleMetadata(s)||{backoffCount:0,throttleEndTimeMillis:Date.now()},a=new zU;return setTimeout(async()=>{a.abort()},n!==void 0?n:NU),i0({appId:s,apiKey:r,measurementId:i},o,a,e)}async function i0(t,{throttleEndTimeMillis:e,backoffCount:n},s,r=r0){var i,o;const{appId:a,measurementId:c}=t;try{await HU(s,e)}catch(l){if(c)return Bt.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${c} provided in the "measurementId" field in the local Firebase config. [${(i=l)===null||i===void 0?void 0:i.message}]`),{appId:a,measurementId:c};throw l}try{const l=await KU(t);return r.deleteThrottleMetadata(a),l}catch(l){const u=l;if(!GU(u)){if(r.deleteThrottleMetadata(a),c)return Bt.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${c} provided in the "measurementId" field in the local Firebase config. [${u==null?void 0:u.message}]`),{appId:a,measurementId:c};throw l}const h=Number((o=u==null?void 0:u.customData)===null||o===void 0?void 0:o.httpStatus)===503?Mh(n,r.intervalMillis,VU):Mh(n,r.intervalMillis),d={throttleEndTimeMillis:Date.now()+h,backoffCount:n+1};return r.setThrottleMetadata(a,d),Bt.debug(`Calling attemptFetch again in ${h} millis`),i0(t,d,s,r)}}function HU(t,e){return new Promise((n,s)=>{const r=Math.max(e-Date.now(),0),i=setTimeout(n,r);t.addEventListener(()=>{clearTimeout(i),s(Wn.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}function GU(t){if(!(t instanceof ct)||!t.customData)return!1;const e=Number(t.customData.httpStatus);return e===429||e===500||e===503||e===504}class zU{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach(e=>e())}}async function QU(t,e,n,s,r){if(r&&r.global){t("event",n,s);return}else{const i=await e,o=Object.assign(Object.assign({},s),{send_to:i});t("event",n,o)}}async function YU(t,e,n,s){if(s&&s.global)return t("set",{screen_name:n}),Promise.resolve();{const r=await e;t("config",r,{update:!0,screen_name:n})}}async function JU(t,e,n,s){if(s&&s.global)return t("set",{user_id:n}),Promise.resolve();{const r=await e;t("config",r,{update:!0,user_id:n})}}async function XU(t,e,n,s){if(s&&s.global){const r={};for(const i of Object.keys(n))r[`user_properties.${i}`]=n[i];return t("set",r),Promise.resolve()}else{const r=await e;t("config",r,{update:!0,user_properties:n})}}async function ZU(t,e){const n=await t;window[`ga-disable-${n}`]=!e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function e$(){var t;if(bn())try{await nu()}catch(e){return Bt.warn(Wn.create("indexeddb-unavailable",{errorInfo:(t=e)===null||t===void 0?void 0:t.toString()}).message),!1}else return Bt.warn(Wn.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;return!0}async function t$(t,e,n,s,r,i,o){var a;const c=WU(t);c.then(f=>{n[f.measurementId]=f.appId,t.options.measurementId&&f.measurementId!==t.options.measurementId&&Bt.warn(`The measurement ID in the local Firebase config (${t.options.measurementId}) does not match the measurement ID fetched from the server (${f.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(f=>Bt.error(f)),e.push(c);const l=e$().then(f=>{if(f)return s.getId()}),[u,h]=await Promise.all([c,l]);UU()||DU(i,u.measurementId),r("js",new Date);const d=(a=o==null?void 0:o.config)!==null&&a!==void 0?a:{};return d[RU]="firebase",d.update=!0,h!=null&&(d[kU]=h),r("config",u.measurementId,d),u.measurementId}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class n${constructor(e){this.app=e}_delete(){return delete Zs[this.app.options.appId],Promise.resolve()}}let Zs={},Bb=[];const qb={};let ph="dataLayer",o0="gtag",jb,su,Hg=!1;function s$(t){if(Hg)throw Wn.create("already-initialized");t.dataLayerName&&(ph=t.dataLayerName),t.gtagName&&(o0=t.gtagName)}function r$(){const t=[];if(eu()&&t.push("This is a browser extension environment."),zd()||t.push("Cookies are not available."),t.length>0){const e=t.map((s,r)=>`(${r+1}) ${s}`).join(" "),n=Wn.create("invalid-analytics-context",{errorInfo:e});Bt.warn(n.message)}}function i$(t,e,n){r$();const s=t.options.appId;if(!s)throw Wn.create("no-app-id");if(!t.options.apiKey)if(t.options.measurementId)Bt.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${t.options.measurementId} provided in the "measurementId" field in the local Firebase config.`);else throw Wn.create("no-api-key");if(Zs[s]!=null)throw Wn.create("already-exists",{id:s});if(!Hg){xU(ph);const{wrappedGtag:i,gtagCore:o}=FU(Zs,Bb,qb,ph,o0);su=i,jb=o,Hg=!0}return Zs[s]=t$(t,Bb,qb,e,jb,ph,n),new n$(t)}async function o$(){if(eu()||!zd()||!bn())return!1;try{return await nu()}catch{return!1}}function a$(t,e,n){t=A(t),YU(su,Zs[t.app.options.appId],e,n).catch(s=>Bt.error(s))}function c$(t,e,n){t=A(t),JU(su,Zs[t.app.options.appId],e,n).catch(s=>Bt.error(s))}function l$(t,e,n){t=A(t),XU(su,Zs[t.app.options.appId],e,n).catch(s=>Bt.error(s))}function u$(t,e){t=A(t),ZU(Zs[t.app.options.appId],e).catch(n=>Bt.error(n))}function a0(t,e,n,s){t=A(t),QU(su,Zs[t.app.options.appId],e,n,s).catch(r=>Bt.error(r))}const Kb="@firebase/analytics",Wb="0.8.0";function h$(){nt(new Ee(Vb,(e,{options:n})=>{const s=e.getProvider("app").getImmediate(),r=e.getProvider("installations-internal").getImmediate();return i$(s,r,n)},"PUBLIC")),nt(new Ee("analytics-internal",t,"PRIVATE")),Le(Kb,Wb),Le(Kb,Wb,"esm2017");function t(e){try{const n=e.getProvider(Vb).getImmediate();return{logEvent:(s,r,i)=>a0(n,s,r,i)}}catch(n){throw Wn.create("interop-component-reg-failed",{reason:n})}}}h$();const d$="@firebase/analytics-compat",f$="0.1.13";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c0{constructor(e,n){this.app=e,this._delegate=n}logEvent(e,n,s){a0(this._delegate,e,n,s)}setCurrentScreen(e,n){a$(this._delegate,e,n)}setUserId(e,n){c$(this._delegate,e,n)}setUserProperties(e,n){l$(this._delegate,e,n)}setAnalyticsCollectionEnabled(e){u$(this._delegate,e)}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Gg;(function(t){t.ADD_SHIPPING_INFO="add_shipping_info",t.ADD_PAYMENT_INFO="add_payment_info",t.ADD_TO_CART="add_to_cart",t.ADD_TO_WISHLIST="add_to_wishlist",t.BEGIN_CHECKOUT="begin_checkout",t.CHECKOUT_PROGRESS="checkout_progress",t.EXCEPTION="exception",t.GENERATE_LEAD="generate_lead",t.LOGIN="login",t.PAGE_VIEW="page_view",t.PURCHASE="purchase",t.REFUND="refund",t.REMOVE_FROM_CART="remove_from_cart",t.SCREEN_VIEW="screen_view",t.SEARCH="search",t.SELECT_CONTENT="select_content",t.SELECT_ITEM="select_item",t.SELECT_PROMOTION="select_promotion",t.SET_CHECKOUT_OPTION="set_checkout_option",t.SHARE="share",t.SIGN_UP="sign_up",t.TIMING_COMPLETE="timing_complete",t.VIEW_CART="view_cart",t.VIEW_ITEM="view_item",t.VIEW_ITEM_LIST="view_item_list",t.VIEW_PROMOTION="view_promotion",t.VIEW_SEARCH_RESULTS="view_search_results"})(Gg||(Gg={}));/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const p$=t=>{const e=t.getProvider("app-compat").getImmediate(),n=t.getProvider("analytics").getImmediate();return new c0(e,n)};function g$(){const t={Analytics:c0,settings:s$,isSupported:o$,EventName:Gg};lt.INTERNAL.registerComponent(new Ee("analytics-compat",p$,"PUBLIC").setServiceProps(t).setMultipleInstances(!0))}g$();lt.registerVersion(d$,f$);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const l0=new Map,m$={activated:!1,tokenObservers:[]},_$={initialized:!1,enabled:!1};function Rt(t){return l0.get(t)||m$}function ls(t,e){l0.set(t,e)}function Xd(){return _$}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const L_="https://content-firebaseappcheck.googleapis.com/v1",y$="exchangeRecaptchaV3Token",v$="exchangeRecaptchaEnterpriseToken",w$="exchangeDebugToken",Hb={OFFSET_DURATION:5*60*1e3,RETRIAL_MIN_WAIT:30*1e3,RETRIAL_MAX_WAIT:16*60*1e3},b$=24*60*60*1e3;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class I${constructor(e,n,s,r,i){if(this.operation=e,this.retryPolicy=n,this.getWaitDuration=s,this.lowerBound=r,this.upperBound=i,this.pending=null,this.nextErrorWaitInterval=r,r>i)throw new Error("Proactive refresh lower bound greater than upper bound!")}start(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch(()=>{})}stop(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)}isRunning(){return!!this.pending}async process(e){this.stop();try{this.pending=new pt,await E$(this.getNextRun(e)),this.pending.resolve(),await this.pending.promise,this.pending=new pt,await this.operation(),this.pending.resolve(),await this.pending.promise,this.process(!0).catch(()=>{})}catch(n){this.retryPolicy(n)?this.process(!1).catch(()=>{}):this.stop()}}getNextRun(e){if(e)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();{const n=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),n}}}function E$(t){return new Promise(e=>{setTimeout(e,t)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const T$={["already-initialized"]:"You have already called initializeAppCheck() for FirebaseApp {$appName} with different options. To avoid this error, call initializeAppCheck() with the same options as when it was originally called. This will return the already initialized instance.",["use-before-activation"]:"App Check is being used before initializeAppCheck() is called for FirebaseApp {$appName}. Call initializeAppCheck() before instantiating other Firebase services.",["fetch-network-error"]:"Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.",["fetch-parse-error"]:"Fetch client could not parse response. Original error: {$originalErrorMessage}.",["fetch-status-error"]:"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.",["storage-open"]:"Error thrown when opening storage. Original error: {$originalErrorMessage}.",["storage-get"]:"Error thrown when reading from storage. Original error: {$originalErrorMessage}.",["storage-set"]:"Error thrown when writing to storage. Original error: {$originalErrorMessage}.",["recaptcha-error"]:"ReCAPTCHA error.",throttled:"Requests throttled due to {$httpStatus} error. Attempts allowed again after {$time}"},an=new dn("appCheck","AppCheck",T$);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Uh(t=!1){var e;return t?(e=self.grecaptcha)===null||e===void 0?void 0:e.enterprise:self.grecaptcha}function u0(t){if(!Rt(t).activated)throw an.create("use-before-activation",{appName:t.name})}function F_(t){const e=Math.round(t/1e3),n=Math.floor(e/(3600*24)),s=Math.floor((e-n*3600*24)/3600),r=Math.floor((e-n*3600*24-s*3600)/60),i=e-n*3600*24-s*3600-r*60;let o="";return n&&(o+=Ku(n)+"d:"),s&&(o+=Ku(s)+"h:"),o+=Ku(r)+"m:"+Ku(i)+"s",o}function Ku(t){return t===0?"00":t>=10?t.toString():"0"+t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function U_({url:t,body:e},n){var s,r;const i={"Content-Type":"application/json"},o=n.getImmediate({optional:!0});if(o){const f=await o.getHeartbeatsHeader();f&&(i["X-Firebase-Client"]=f)}const a={method:"POST",body:JSON.stringify(e),headers:i};let c;try{c=await fetch(t,a)}catch(f){throw an.create("fetch-network-error",{originalErrorMessage:(s=f)===null||s===void 0?void 0:s.message})}if(c.status!==200)throw an.create("fetch-status-error",{httpStatus:c.status});let l;try{l=await c.json()}catch(f){throw an.create("fetch-parse-error",{originalErrorMessage:(r=f)===null||r===void 0?void 0:r.message})}const u=l.ttl.match(/^([\d.]+)(s)$/);if(!u||!u[2]||isNaN(Number(u[1])))throw an.create("fetch-parse-error",{originalErrorMessage:`ttl field (timeToLive) is not in standard Protobuf Duration format: ${l.ttl}`});const h=Number(u[1])*1e3,d=Date.now();return{token:l.token,expireTimeMillis:d+h,issuedAtTimeMillis:d}}function S$(t,e){const{projectId:n,appId:s,apiKey:r}=t.options;return{url:`${L_}/projects/${n}/apps/${s}:${y$}?key=${r}`,body:{recaptcha_v3_token:e}}}function C$(t,e){const{projectId:n,appId:s,apiKey:r}=t.options;return{url:`${L_}/projects/${n}/apps/${s}:${v$}?key=${r}`,body:{recaptcha_enterprise_token:e}}}function A$(t,e){const{projectId:n,appId:s,apiKey:r}=t.options;return{url:`${L_}/projects/${n}/apps/${s}:${w$}?key=${r}`,body:{debug_token:e}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const k$="firebase-app-check-database",R$=1,pl="firebase-app-check-store",h0="debug-token";let Wu=null;function d0(){return Wu||(Wu=new Promise((t,e)=>{var n;try{const s=indexedDB.open(k$,R$);s.onsuccess=r=>{t(r.target.result)},s.onerror=r=>{var i;e(an.create("storage-open",{originalErrorMessage:(i=r.target.error)===null||i===void 0?void 0:i.message}))},s.onupgradeneeded=r=>{const i=r.target.result;switch(r.oldVersion){case 0:i.createObjectStore(pl,{keyPath:"compositeKey"})}}}catch(s){e(an.create("storage-open",{originalErrorMessage:(n=s)===null||n===void 0?void 0:n.message}))}}),Wu)}function N$(t){return p0(g0(t))}function P$(t,e){return f0(g0(t),e)}function D$(t){return f0(h0,t)}function x$(){return p0(h0)}async function f0(t,e){const s=(await d0()).transaction(pl,"readwrite"),i=s.objectStore(pl).put({compositeKey:t,value:e});return new Promise((o,a)=>{i.onsuccess=c=>{o()},s.onerror=c=>{var l;a(an.create("storage-set",{originalErrorMessage:(l=c.target.error)===null||l===void 0?void 0:l.message}))}})}async function p0(t){const n=(await d0()).transaction(pl,"readonly"),r=n.objectStore(pl).get(t);return new Promise((i,o)=>{r.onsuccess=a=>{const c=a.target.result;i(c?c.value:void 0)},n.onerror=a=>{var c;o(an.create("storage-get",{originalErrorMessage:(c=a.target.error)===null||c===void 0?void 0:c.message}))}})}function g0(t){return`${t.options.appId}-${t.name}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gl=new Vs("@firebase/app-check");/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function O$(t){if(bn()){let e;try{e=await N$(t)}catch(n){gl.warn(`Failed to read token from IndexedDB. Error: ${n}`)}return e}}function Gb(t,e){return bn()?P$(t,e).catch(n=>{gl.warn(`Failed to write token to IndexedDB. Error: ${n}`)}):Promise.resolve()}async function M$(){let t;try{t=await x$()}catch{}if(t)return t;{const e=SL();return D$(e).catch(n=>gl.warn(`Failed to persist debug token to IndexedDB. Error: ${n}`)),e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function m0(){return Xd().enabled}async function _0(){const t=Xd();if(t.enabled&&t.token)return t.token.promise;throw Error(`
            Can't get debug token in production mode.
        `)}function L$(){const t=pL(),e=Xd();if(e.initialized=!0,typeof t.FIREBASE_APPCHECK_DEBUG_TOKEN!="string"&&t.FIREBASE_APPCHECK_DEBUG_TOKEN!==!0)return;e.enabled=!0;const n=new pt;e.token=n,typeof t.FIREBASE_APPCHECK_DEBUG_TOKEN=="string"?n.resolve(t.FIREBASE_APPCHECK_DEBUG_TOKEN):n.resolve(M$())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const F$={error:"UNKNOWN_ERROR"};function U$(t){return Hd.encodeString(JSON.stringify(t),!1)}async function $h(t,e=!1){const n=t.app;u0(n);const s=Rt(n);let r=s.token,i;if(!r){const c=await s.cachedTokenPromise;c&&Vh(c)&&(r=c)}if(!e&&r&&Vh(r))return{token:r.token};let o=!1;if(m0()){s.exchangeTokenPromise||(s.exchangeTokenPromise=U_(A$(n,await _0()),t.heartbeatServiceProvider).then(l=>(s.exchangeTokenPromise=void 0,l)),o=!0);const c=await s.exchangeTokenPromise;return await Gb(n,c),ls(n,Object.assign(Object.assign({},s),{token:c})),{token:c.token}}try{s.exchangeTokenPromise||(s.exchangeTokenPromise=s.provider.getToken().then(c=>(s.exchangeTokenPromise=void 0,c)),o=!0),r=await s.exchangeTokenPromise}catch(c){c.code==="appCheck/throttled"?gl.warn(c.message):gl.error(c),i=c}let a;return r?(a={token:r.token},ls(n,Object.assign(Object.assign({},s),{token:r})),await Gb(n,r)):a=V$(i),o&&y0(n,a),a}function $_(t,e,n,s){const{app:r}=t,i=Rt(r),o={next:n,error:s,type:e};if(ls(r,Object.assign(Object.assign({},i),{tokenObservers:[...i.tokenObservers,o]})),i.token&&Vh(i.token)){const a=i.token;Promise.resolve().then(()=>{n({token:a.token}),zb(t)}).catch(()=>{})}i.cachedTokenPromise.then(()=>zb(t))}function V_(t,e){const n=Rt(t),s=n.tokenObservers.filter(r=>r.next!==e);s.length===0&&n.tokenRefresher&&n.tokenRefresher.isRunning()&&n.tokenRefresher.stop(),ls(t,Object.assign(Object.assign({},n),{tokenObservers:s}))}function zb(t){const{app:e}=t,n=Rt(e);let s=n.tokenRefresher;s||(s=$$(t),ls(e,Object.assign(Object.assign({},n),{tokenRefresher:s}))),!s.isRunning()&&n.isTokenAutoRefreshEnabled&&s.start()}function $$(t){const{app:e}=t;return new I$(async()=>{const n=Rt(e);let s;if(n.token?s=await $h(t,!0):s=await $h(t),s.error)throw s.error},()=>!0,()=>{const n=Rt(e);if(n.token){let s=n.token.issuedAtTimeMillis+(n.token.expireTimeMillis-n.token.issuedAtTimeMillis)*.5+3e5;const r=n.token.expireTimeMillis-5*60*1e3;return s=Math.min(s,r),Math.max(0,s-Date.now())}else return 0},Hb.RETRIAL_MIN_WAIT,Hb.RETRIAL_MAX_WAIT)}function y0(t,e){const n=Rt(t).tokenObservers;for(const s of n)try{s.type==="EXTERNAL"&&e.error!=null?s.error(e.error):s.next(e)}catch{}}function Vh(t){return t.expireTimeMillis-Date.now()>0}function V$(t){return{token:U$(F$),error:t}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class B${constructor(e,n){this.app=e,this.heartbeatServiceProvider=n}_delete(){const{tokenObservers:e}=Rt(this.app);for(const n of e)V_(this.app,n.next);return Promise.resolve()}}function q$(t,e){return new B$(t,e)}function j$(t){return{getToken:e=>$h(t,e),addTokenListener:e=>$_(t,"INTERNAL",e),removeTokenListener:e=>V_(t.app,e)}}const K$="@firebase/app-check",W$="0.5.11";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const H$="https://www.google.com/recaptcha/api.js",G$="https://www.google.com/recaptcha/enterprise.js";function z$(t,e){const n=Rt(t),s=new pt;ls(t,Object.assign(Object.assign({},n),{reCAPTCHAState:{initialized:s}}));const r=v0(t),i=Uh(!1);return i?Bh(t,e,i,r,s):J$(()=>{const o=Uh(!1);if(!o)throw new Error("no recaptcha");Bh(t,e,o,r,s)}),s.promise}function Q$(t,e){const n=Rt(t),s=new pt;ls(t,Object.assign(Object.assign({},n),{reCAPTCHAState:{initialized:s}}));const r=v0(t),i=Uh(!0);return i?Bh(t,e,i,r,s):X$(()=>{const o=Uh(!0);if(!o)throw new Error("no recaptcha");Bh(t,e,o,r,s)}),s.promise}function Bh(t,e,n,s,r){n.ready(()=>{Y$(t,e,n,s),r.resolve(n)})}function v0(t){const e=`fire_app_check_${t.name}`,n=document.createElement("div");return n.id=e,n.style.display="none",document.body.appendChild(n),e}async function w0(t){u0(t);const n=await Rt(t).reCAPTCHAState.initialized.promise;return new Promise((s,r)=>{const i=Rt(t).reCAPTCHAState;n.ready(()=>{s(n.execute(i.widgetId,{action:"fire_app_check"}))})})}function Y$(t,e,n,s){const r=n.render(s,{sitekey:e,size:"invisible"}),i=Rt(t);ls(t,Object.assign(Object.assign({},i),{reCAPTCHAState:Object.assign(Object.assign({},i.reCAPTCHAState),{widgetId:r})}))}function J$(t){const e=document.createElement("script");e.src=H$,e.onload=t,document.head.appendChild(e)}function X$(t){const e=document.createElement("script");e.src=G$,e.onload=t,document.head.appendChild(e)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ml{constructor(e){this._siteKey=e,this._throttleData=null}async getToken(){var e;I0(this._throttleData);const n=await w0(this._app).catch(r=>{throw an.create("recaptcha-error")});let s;try{s=await U_(S$(this._app,n),this._heartbeatServiceProvider)}catch(r){throw r.code==="fetch-status-error"?(this._throttleData=b0(Number((e=r.customData)===null||e===void 0?void 0:e.httpStatus),this._throttleData),an.create("throttled",{time:F_(this._throttleData.allowRequestsAfter-Date.now()),httpStatus:this._throttleData.httpStatus})):r}return this._throttleData=null,s}initialize(e){this._app=e,this._heartbeatServiceProvider=bo(e,"heartbeat"),z$(e,this._siteKey).catch(()=>{})}isEqual(e){return e instanceof ml?this._siteKey===e._siteKey:!1}}class Zd{constructor(e){this._siteKey=e,this._throttleData=null}async getToken(){var e;I0(this._throttleData);const n=await w0(this._app).catch(r=>{throw an.create("recaptcha-error")});let s;try{s=await U_(C$(this._app,n),this._heartbeatServiceProvider)}catch(r){throw r.code==="fetch-status-error"?(this._throttleData=b0(Number((e=r.customData)===null||e===void 0?void 0:e.httpStatus),this._throttleData),an.create("throttled",{time:F_(this._throttleData.allowRequestsAfter-Date.now()),httpStatus:this._throttleData.httpStatus})):r}return this._throttleData=null,s}initialize(e){this._app=e,this._heartbeatServiceProvider=bo(e,"heartbeat"),Q$(e,this._siteKey).catch(()=>{})}isEqual(e){return e instanceof Zd?this._siteKey===e._siteKey:!1}}class _l{constructor(e){this._customProviderOptions=e}async getToken(){const e=await this._customProviderOptions.getToken(),n=yL(e.token),s=n!==null&&n<Date.now()&&n>0?n*1e3:Date.now();return Object.assign(Object.assign({},e),{issuedAtTimeMillis:s})}initialize(e){this._app=e}isEqual(e){return e instanceof _l?this._customProviderOptions.getToken.toString()===e._customProviderOptions.getToken.toString():!1}}function b0(t,e){if(t===404||t===403)return{backoffCount:1,allowRequestsAfter:Date.now()+b$,httpStatus:t};{const n=e?e.backoffCount:0,s=Mh(n,1e3,2);return{backoffCount:n+1,allowRequestsAfter:Date.now()+s,httpStatus:t}}}function I0(t){if(t&&Date.now()-t.allowRequestsAfter<=0)throw an.create("throttled",{time:F_(t.allowRequestsAfter-Date.now()),httpStatus:t.httpStatus})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Z$(t=PC(),e){t=A(t);const n=bo(t,"app-check");if(Xd().initialized||L$(),m0()&&_0().then(r=>console.log(`App Check debug token: ${r}. You will need to add it to your app's App Check settings in the Firebase console for it to work.`)),n.isInitialized()){const r=n.getImmediate(),i=n.getOptions();if(i.isTokenAutoRefreshEnabled===e.isTokenAutoRefreshEnabled&&i.provider.isEqual(e.provider))return r;throw an.create("already-initialized",{appName:t.name})}const s=n.initialize({options:e});return eV(t,e.provider,e.isTokenAutoRefreshEnabled),Rt(t).isTokenAutoRefreshEnabled&&$_(s,"INTERNAL",()=>{}),s}function eV(t,e,n){const s=Rt(t),r=Object.assign(Object.assign({},s),{activated:!0});r.provider=e,r.cachedTokenPromise=O$(t).then(i=>(i&&Vh(i)&&(ls(t,Object.assign(Object.assign({},Rt(t)),{token:i})),y0(t,{token:i.token})),i)),r.isTokenAutoRefreshEnabled=n===void 0?t.automaticDataCollectionEnabled:n,ls(t,r),r.provider.initialize(t)}function tV(t,e){const n=t.app,s=Rt(n);s.tokenRefresher&&(e===!0?s.tokenRefresher.start():s.tokenRefresher.stop()),ls(n,Object.assign(Object.assign({},s),{isTokenAutoRefreshEnabled:e}))}async function nV(t,e){const n=await $h(t,e);if(n.error)throw n.error;return{token:n.token}}function sV(t,e,n,s){let r=()=>{},i=()=>{};return e.next!=null?r=e.next.bind(e):r=e,e.error!=null?i=e.error.bind(e):n&&(i=n),$_(t,"EXTERNAL",r,i),()=>V_(t.app,r)}const rV="app-check",Qb="app-check-internal";function iV(){nt(new Ee(rV,t=>{const e=t.getProvider("app").getImmediate(),n=t.getProvider("heartbeat");return q$(e,n)},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((t,e,n)=>{t.getProvider(Qb).initialize()})),nt(new Ee(Qb,t=>{const e=t.getProvider("app-check").getImmediate();return j$(e)},"PUBLIC").setInstantiationMode("EXPLICIT")),Le(K$,W$)}iV();const oV="@firebase/app-check-compat",aV="0.2.11";/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cV={["use-before-activation"]:"App Check is being used before activate() is called for FirebaseApp {$appName}. Call activate() before instantiating other Firebase services."},Np=new dn("appCheck","AppCheck",cV);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lV{constructor(e){this.app=e}activate(e,n){let s;typeof e=="string"?s=new ml(e):e instanceof Zd||e instanceof ml||e instanceof _l?s=e:s=new _l({getToken:e.getToken}),this._delegate=Z$(this.app,{provider:s,isTokenAutoRefreshEnabled:n})}setTokenAutoRefreshEnabled(e){if(!this._delegate)throw Np.create("use-before-activation",{appName:this.app.name});tV(this._delegate,e)}getToken(e){if(!this._delegate)throw Np.create("use-before-activation",{appName:this.app.name});return nV(this._delegate,e)}onTokenChanged(e,n,s){if(!this._delegate)throw Np.create("use-before-activation",{appName:this.app.name});return sV(this._delegate,e,n)}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uV=t=>{const e=t.getProvider("app-compat").getImmediate();return new lV(e)};function hV(){lt.INTERNAL.registerComponent(new Ee("appCheck-compat",uV,"PUBLIC").setServiceProps({ReCaptchaEnterpriseProvider:Zd,ReCaptchaV3Provider:ml,CustomProvider:_l}))}hV();lt.registerVersion(oV,aV);function B_(t,e){var n={};for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&e.indexOf(s)<0&&(n[s]=t[s]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,s=Object.getOwnPropertySymbols(t);r<s.length;r++)e.indexOf(s[r])<0&&Object.prototype.propertyIsEnumerable.call(t,s[r])&&(n[s[r]]=t[s[r]]);return n}const cc={FACEBOOK:"facebook.com",GITHUB:"github.com",GOOGLE:"google.com",PASSWORD:"password",PHONE:"phone",TWITTER:"twitter.com"},Mo={EMAIL_SIGNIN:"EMAIL_SIGNIN",PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:"REVERT_SECOND_FACTOR_ADDITION",VERIFY_AND_CHANGE_EMAIL:"VERIFY_AND_CHANGE_EMAIL",VERIFY_EMAIL:"VERIFY_EMAIL"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dV(){return{["admin-restricted-operation"]:"This operation is restricted to administrators only.",["argument-error"]:"",["app-not-authorized"]:"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.",["app-not-installed"]:"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.",["captcha-check-failed"]:"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.",["code-expired"]:"The SMS code has expired. Please re-send the verification code to try again.",["cordova-not-ready"]:"Cordova framework is not ready.",["cors-unsupported"]:"This browser is not supported.",["credential-already-in-use"]:"This credential is already associated with a different user account.",["custom-token-mismatch"]:"The custom token corresponds to a different audience.",["requires-recent-login"]:"This operation is sensitive and requires recent authentication. Log in again before retrying this request.",["dependent-sdk-initialized-before-auth"]:"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK.",["dynamic-link-not-activated"]:"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.",["email-change-needs-verification"]:"Multi-factor users must always have a verified email.",["email-already-in-use"]:"The email address is already in use by another account.",["emulator-config-failed"]:'Auth instance has already been used to make a network call. Auth can no longer be configured to use the emulator. Try calling "connectAuthEmulator()" sooner.',["expired-action-code"]:"The action code has expired.",["cancelled-popup-request"]:"This operation has been cancelled due to another conflicting popup being opened.",["internal-error"]:"An internal AuthError has occurred.",["invalid-app-credential"]:"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.",["invalid-app-id"]:"The mobile app identifier is not registed for the current project.",["invalid-user-token"]:"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.",["invalid-auth-event"]:"An internal AuthError has occurred.",["invalid-verification-code"]:"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure to use the verification code provided by the user.",["invalid-continue-uri"]:"The continue URL provided in the request is invalid.",["invalid-cordova-configuration"]:"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.",["invalid-custom-token"]:"The custom token format is incorrect. Please check the documentation.",["invalid-dynamic-link-domain"]:"The provided dynamic link domain is not configured or authorized for the current project.",["invalid-email"]:"The email address is badly formatted.",["invalid-emulator-scheme"]:"Emulator URL must start with a valid scheme (http:// or https://).",["invalid-api-key"]:"Your API key is invalid, please check you have copied it correctly.",["invalid-cert-hash"]:"The SHA-1 certificate hash provided is invalid.",["invalid-credential"]:"The supplied auth credential is malformed or has expired.",["invalid-message-payload"]:"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.",["invalid-multi-factor-session"]:"The request does not contain a valid proof of first factor successful sign-in.",["invalid-oauth-provider"]:"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.",["invalid-oauth-client-id"]:"The OAuth client ID provided is either invalid or does not match the specified API key.",["unauthorized-domain"]:"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.",["invalid-action-code"]:"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.",["wrong-password"]:"The password is invalid or the user does not have a password.",["invalid-persistence-type"]:"The specified persistence type is invalid. It can only be local, session or none.",["invalid-phone-number"]:"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].",["invalid-provider-id"]:"The specified provider ID is invalid.",["invalid-recipient-email"]:"The email corresponding to this action failed to send as the provided recipient email address is invalid.",["invalid-sender"]:"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.",["invalid-verification-id"]:"The verification ID used to create the phone auth credential is invalid.",["invalid-tenant-id"]:"The Auth instance's tenant ID is invalid.",["login-blocked"]:"Login blocked by user-provided method: {$originalMessage}",["missing-android-pkg-name"]:"An Android Package Name must be provided if the Android App is required to be installed.",["auth-domain-config-required"]:"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.",["missing-app-credential"]:"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.",["missing-verification-code"]:"The phone auth credential was created with an empty SMS verification code.",["missing-continue-uri"]:"A continue URL must be provided in the request.",["missing-iframe-start"]:"An internal AuthError has occurred.",["missing-ios-bundle-id"]:"An iOS Bundle ID must be provided if an App Store ID is provided.",["missing-or-invalid-nonce"]:"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.",["missing-multi-factor-info"]:"No second factor identifier is provided.",["missing-multi-factor-session"]:"The request is missing proof of first factor successful sign-in.",["missing-phone-number"]:"To send verification codes, provide a phone number for the recipient.",["missing-verification-id"]:"The phone auth credential was created with an empty verification ID.",["app-deleted"]:"This instance of FirebaseApp has been deleted.",["multi-factor-info-not-found"]:"The user does not have a second factor matching the identifier provided.",["multi-factor-auth-required"]:"Proof of ownership of a second factor is required to complete sign-in.",["account-exists-with-different-credential"]:"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.",["network-request-failed"]:"A network AuthError (such as timeout, interrupted connection or unreachable host) has occurred.",["no-auth-event"]:"An internal AuthError has occurred.",["no-such-provider"]:"User was not linked to an account with the given provider.",["null-user"]:"A null user object was provided as the argument for an operation which requires a non-null user object.",["operation-not-allowed"]:"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.",["operation-not-supported-in-this-environment"]:'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',["popup-blocked"]:"Unable to establish a connection with the popup. It may have been blocked by the browser.",["popup-closed-by-user"]:"The popup has been closed by the user before finalizing the operation.",["provider-already-linked"]:"User can only be linked to one identity for the given provider.",["quota-exceeded"]:"The project's quota for this operation has been exceeded.",["redirect-cancelled-by-user"]:"The redirect operation has been cancelled by the user before finalizing.",["redirect-operation-pending"]:"A redirect sign-in operation is already pending.",["rejected-credential"]:"The request contains malformed or mismatching credentials.",["second-factor-already-in-use"]:"The second factor is already enrolled on this account.",["maximum-second-factor-count-exceeded"]:"The maximum allowed number of second factors on a user has been exceeded.",["tenant-id-mismatch"]:"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.",["user-token-expired"]:"The user's credential is no longer valid. The user must sign in again.",["too-many-requests"]:"We have blocked all requests from this device due to unusual activity. Try again later.",["unauthorized-continue-uri"]:"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.",["unsupported-first-factor"]:"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.",["unsupported-persistence-type"]:"The current environment does not support the specified persistence type.",["unsupported-tenant-operation"]:"This operation is not supported in a multi-tenant context.",["unverified-email"]:"The operation requires a verified email.",["user-cancelled"]:"The user did not grant your application the permissions it requested.",["user-not-found"]:"There is no user record corresponding to this identifier. The user may have been deleted.",["user-disabled"]:"The user account has been disabled by an administrator.",["user-mismatch"]:"The supplied credentials do not correspond to the previously signed in user.",["user-signed-out"]:"",["weak-password"]:"The password must be 6 characters long or more.",["web-storage-unsupported"]:"This browser is not supported or 3rd party cookies and data may be disabled.",["already-initialized"]:"initializeAuth() has already been called with different options. To avoid this error, call initializeAuth() with the same options as when it was originally called, or call getAuth() to return the already initialized instance."}}function E0(){return{["dependent-sdk-initialized-before-auth"]:"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const fV=dV,pV=E0,T0=new dn("auth","Firebase",E0());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yb=new Vs("@firebase/auth");function gh(t,...e){Yb.logLevel<=de.ERROR&&Yb.error(`Auth (${Bs}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ht(t,...e){throw q_(t,...e)}function qt(t,...e){return q_(t,...e)}function S0(t,e,n){const s=Object.assign(Object.assign({},pV()),{[e]:n});return new dn("auth","Firebase",s).create(e,{appName:t.name})}function Va(t,e,n){const s=n;if(!(e instanceof s))throw s.name!==e.constructor.name&&Ht(t,"argument-error"),S0(t,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function q_(t,...e){if(typeof t!="string"){const n=e[0],s=[...e.slice(1)];return s[0]&&(s[0].appName=t.name),t._errorFactory.create(n,...s)}return T0.create(t,...e)}function D(t,e,...n){if(!t)throw q_(e,...n)}function Es(t){const e="INTERNAL ASSERTION FAILED: "+t;throw gh(e),new Error(e)}function us(t,e){t||Es(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jb=new Map;function kn(t){us(t instanceof Function,"Expected a class definition");let e=Jb.get(t);return e?(us(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,Jb.set(t,e),e)}function gV(t,e){const n=(e==null?void 0:e.persistence)||[],s=(Array.isArray(n)?n:[n]).map(kn);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(s,e==null?void 0:e.popupRedirectResolver)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yl(){var t;return typeof self!="undefined"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function j_(){return Xb()==="http:"||Xb()==="https:"}function Xb(){var t;return typeof self!="undefined"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mV(){return typeof navigator!="undefined"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(j_()||eu()||"connection"in navigator)?navigator.onLine:!0}function _V(){if(typeof navigator=="undefined")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ru{constructor(e,n){this.shortDelay=e,this.longDelay=n,us(n>e,"Short delay should be less than long delay!"),this.isMobile=Gd()||tu()}get(){return mV()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function K_(t,e){us(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C0{static initialize(e,n,s){this.fetchImpl=e,n&&(this.headersImpl=n),s&&(this.responseImpl=s)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self!="undefined"&&"fetch"in self)return self.fetch;Es("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self!="undefined"&&"Headers"in self)return self.Headers;Es("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self!="undefined"&&"Response"in self)return self.Response;Es("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yV={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"internal-error",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vV=new ru(3e4,6e4);function _t(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function xt(t,e,n,s,r={}){return A0(t,r,async()=>{let i={},o={};s&&(e==="GET"?o=s:i={body:JSON.stringify(s)});const a=wo(Object.assign({key:t.config.apiKey},o)).slice(1),c=await t._getAdditionalHeaders();return c["Content-Type"]="application/json",t.languageCode&&(c["X-Firebase-Locale"]=t.languageCode),C0.fetch()(k0(t,t.config.apiHost,n,a),Object.assign({method:e,headers:c,referrerPolicy:"no-referrer"},i))})}async function A0(t,e,n){t._canInitEmulator=!1;const s=Object.assign(Object.assign({},yV),e);try{const r=new wV(t),i=await Promise.race([n(),r.promise]);r.clearNetworkTimeout();const o=await i.json();if("needConfirmation"in o)throw Cc(t,"account-exists-with-different-credential",o);if(i.ok&&!("errorMessage"in o))return o;{const a=i.ok?o.errorMessage:o.error.message,[c,l]=a.split(" : ");if(c==="FEDERATED_USER_ID_ALREADY_LINKED")throw Cc(t,"credential-already-in-use",o);if(c==="EMAIL_EXISTS")throw Cc(t,"email-already-in-use",o);if(c==="USER_DISABLED")throw Cc(t,"user-disabled",o);const u=s[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(l)throw S0(t,u,l);Ht(t,u)}}catch(r){if(r instanceof ct)throw r;Ht(t,"network-request-failed")}}async function ur(t,e,n,s,r={}){const i=await xt(t,e,n,s,r);return"mfaPendingCredential"in i&&Ht(t,"multi-factor-auth-required",{_serverResponse:i}),i}function k0(t,e,n,s){const r=`${e}${n}?${s}`;return t.config.emulator?K_(t.config,r):`${t.config.apiScheme}://${r}`}class wV{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,s)=>{this.timer=setTimeout(()=>s(qt(this.auth,"network-request-failed")),vV.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function Cc(t,e,n){const s={appName:t.name};n.email&&(s.email=n.email),n.phoneNumber&&(s.phoneNumber=n.phoneNumber);const r=qt(t,e,s);return r.customData._tokenResponse=n,r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function bV(t,e){return xt(t,"POST","/v1/accounts:delete",e)}async function IV(t,e){return xt(t,"POST","/v1/accounts:update",e)}async function EV(t,e){return xt(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fc(t){if(!!t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function TV(t,e=!1){const n=A(t),s=await n.getIdToken(e),r=ef(s);D(r&&r.exp&&r.auth_time&&r.iat,n.auth,"internal-error");const i=typeof r.firebase=="object"?r.firebase:void 0,o=i==null?void 0:i.sign_in_provider;return{claims:r,token:s,authTime:Fc(Pp(r.auth_time)),issuedAtTime:Fc(Pp(r.iat)),expirationTime:Fc(Pp(r.exp)),signInProvider:o||null,signInSecondFactor:(i==null?void 0:i.sign_in_second_factor)||null}}function Pp(t){return Number(t)*1e3}function ef(t){var e;const[n,s,r]=t.split(".");if(n===void 0||s===void 0||r===void 0)return gh("JWT malformed, contained fewer than 3 sections"),null;try{const i=Vg(s);return i?JSON.parse(i):(gh("Failed to decode base64 JWT payload"),null)}catch(i){return gh("Caught error parsing JWT payload as JSON",(e=i)===null||e===void 0?void 0:e.toString()),null}}function SV(t){const e=ef(t);return D(e,"internal-error"),D(typeof e.exp!="undefined","internal-error"),D(typeof e.iat!="undefined","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function rr(t,e,n=!1){if(n)return e;try{return await e}catch(s){throw s instanceof ct&&CV(s)&&t.auth.currentUser===t&&await t.auth.signOut(),s}}function CV({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AV{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){!this.isRunning||(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var n;if(e){const s=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),s}else{this.errorBackoff=3e4;const r=((n=this.user.stsTokenManager.expirationTime)!==null&&n!==void 0?n:0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){var e;try{await this.user.getIdToken(!0)}catch(n){((e=n)===null||e===void 0?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R0{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=Fc(this.lastLoginAt),this.creationTime=Fc(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function vl(t){var e;const n=t.auth,s=await t.getIdToken(),r=await rr(t,EV(n,{idToken:s}));D(r==null?void 0:r.users.length,n,"internal-error");const i=r.users[0];t._notifyReloadListener(i);const o=!((e=i.providerUserInfo)===null||e===void 0)&&e.length?NV(i.providerUserInfo):[],a=RV(t.providerData,o),c=t.isAnonymous,l=!(t.email&&i.passwordHash)&&!(a!=null&&a.length),u=c?l:!1,h={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:a,metadata:new R0(i.createdAt,i.lastLoginAt),isAnonymous:u};Object.assign(t,h)}async function kV(t){const e=A(t);await vl(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function RV(t,e){return[...t.filter(s=>!e.some(r=>r.providerId===s.providerId)),...e]}function NV(t){return t.map(e=>{var{providerId:n}=e,s=B_(e,["providerId"]);return{providerId:n,uid:s.rawId||"",displayName:s.displayName||null,email:s.email||null,phoneNumber:s.phoneNumber||null,photoURL:s.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function PV(t,e){const n=await A0(t,{},async()=>{const s=wo({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:r,apiKey:i}=t.config,o=k0(t,r,"/v1/token",`key=${i}`),a=await t._getAdditionalHeaders();return a["Content-Type"]="application/x-www-form-urlencoded",C0.fetch()(o,{method:"POST",headers:a,body:s})});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wl{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){D(e.idToken,"internal-error"),D(typeof e.idToken!="undefined","internal-error"),D(typeof e.refreshToken!="undefined","internal-error");const n="expiresIn"in e&&typeof e.expiresIn!="undefined"?Number(e.expiresIn):SV(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}async getToken(e,n=!1){return D(!this.accessToken||this.refreshToken,e,"user-token-expired"),!n&&this.accessToken&&!this.isExpired?this.accessToken:this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:s,refreshToken:r,expiresIn:i}=await PV(e,n);this.updateTokensAndExpiration(s,r,Number(i))}updateTokensAndExpiration(e,n,s){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+s*1e3}static fromJSON(e,n){const{refreshToken:s,accessToken:r,expirationTime:i}=n,o=new wl;return s&&(D(typeof s=="string","internal-error",{appName:e}),o.refreshToken=s),r&&(D(typeof r=="string","internal-error",{appName:e}),o.accessToken=r),i&&(D(typeof i=="number","internal-error",{appName:e}),o.expirationTime=i),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new wl,this.toJSON())}_performRefresh(){return Es("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function br(t,e){D(typeof t=="string"||typeof t=="undefined","internal-error",{appName:e})}class Bi{constructor(e){var{uid:n,auth:s,stsTokenManager:r}=e,i=B_(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new AV(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=n,this.auth=s,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new R0(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const n=await rr(this,this.stsTokenManager.getToken(this.auth,e));return D(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return TV(this,e)}reload(){return kV(this)}_assign(e){this!==e&&(D(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>Object.assign({},n)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){return new Bi(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}))}_onReload(e){D(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let s=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),s=!0),n&&await vl(this),await this.auth._persistUserIfCurrent(this),s&&this.auth._notifyListenersIfCurrent(this)}async delete(){const e=await this.getIdToken();return await rr(this,bV(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){var s,r,i,o,a,c,l,u;const h=(s=n.displayName)!==null&&s!==void 0?s:void 0,d=(r=n.email)!==null&&r!==void 0?r:void 0,f=(i=n.phoneNumber)!==null&&i!==void 0?i:void 0,p=(o=n.photoURL)!==null&&o!==void 0?o:void 0,_=(a=n.tenantId)!==null&&a!==void 0?a:void 0,y=(c=n._redirectEventId)!==null&&c!==void 0?c:void 0,I=(l=n.createdAt)!==null&&l!==void 0?l:void 0,N=(u=n.lastLoginAt)!==null&&u!==void 0?u:void 0,{uid:k,emailVerified:M,isAnonymous:j,providerData:Y,stsTokenManager:z}=n;D(k&&z,e,"internal-error");const V=wl.fromJSON(this.name,z);D(typeof k=="string",e,"internal-error"),br(h,e.name),br(d,e.name),D(typeof M=="boolean",e,"internal-error"),D(typeof j=="boolean",e,"internal-error"),br(f,e.name),br(p,e.name),br(_,e.name),br(y,e.name),br(I,e.name),br(N,e.name);const ie=new Bi({uid:k,auth:e,email:d,emailVerified:M,displayName:h,isAnonymous:j,photoURL:p,phoneNumber:f,tenantId:_,stsTokenManager:V,createdAt:I,lastLoginAt:N});return Y&&Array.isArray(Y)&&(ie.providerData=Y.map(_e=>Object.assign({},_e))),y&&(ie._redirectEventId=y),ie}static async _fromIdTokenResponse(e,n,s=!1){const r=new wl;r.updateFromServerResponse(n);const i=new Bi({uid:n.localId,auth:e,stsTokenManager:r,isAnonymous:s});return await vl(i),i}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N0{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}N0.type="NONE";const ga=N0;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qi(t,e,n){return`firebase:${t}:${e}:${n}`}class Xo{constructor(e,n,s){this.persistence=e,this.auth=n,this.userKey=s;const{config:r,name:i}=this.auth;this.fullUserKey=qi(this.userKey,r.apiKey,i),this.fullPersistenceKey=qi("persistence",r.apiKey,i),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?Bi._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,s="authUser"){if(!n.length)return new Xo(kn(ga),e,s);const r=(await Promise.all(n.map(async l=>{if(await l._isAvailable())return l}))).filter(l=>l);let i=r[0]||kn(ga);const o=qi(s,e.config.apiKey,e.name);let a=null;for(const l of n)try{const u=await l._get(o);if(u){const h=Bi._fromJSON(e,u);l!==i&&(a=h),i=l;break}}catch{}const c=r.filter(l=>l._shouldAllowMigration);return!i._shouldAllowMigration||!c.length?new Xo(i,e,s):(i=c[0],a&&await i._set(o,a.toJSON()),await Promise.all(n.map(async l=>{if(l!==i)try{await l._remove(o)}catch{}})),new Xo(i,e,s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zb(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(x0(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(P0(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(O0(e))return"Blackberry";if(M0(e))return"Webos";if(W_(e))return"Safari";if((e.includes("chrome/")||D0(e))&&!e.includes("edge/"))return"Chrome";if(iu(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,s=t.match(n);if((s==null?void 0:s.length)===2)return s[1]}return"Other"}function P0(t=We()){return/firefox\//i.test(t)}function W_(t=We()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function D0(t=We()){return/crios\//i.test(t)}function x0(t=We()){return/iemobile/i.test(t)}function iu(t=We()){return/android/i.test(t)}function O0(t=We()){return/blackberry/i.test(t)}function M0(t=We()){return/webos/i.test(t)}function Ba(t=We()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function DV(t=We()){return/(iPad|iPhone|iPod).*OS 7_\d/i.test(t)||/(iPad|iPhone|iPod).*OS 8_\d/i.test(t)}function xV(t=We()){var e;return Ba(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function OV(){return A_()&&document.documentMode===10}function L0(t=We()){return Ba(t)||iu(t)||M0(t)||O0(t)||/windows phone/i.test(t)||x0(t)}function MV(){try{return!!(window&&window!==window.top)}catch{return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function F0(t,e=[]){let n;switch(t){case"Browser":n=Zb(We());break;case"Worker":n=`${Zb(We())}-${t}`;break;default:n=t}const s=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${Bs}/${s}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LV{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const s=i=>new Promise((o,a)=>{try{const c=e(i);o(c)}catch(c){a(c)}});s.onAbort=n,this.queue.push(s);const r=this.queue.length-1;return()=>{this.queue[r]=()=>Promise.resolve()}}async runMiddleware(e){var n;if(this.auth.currentUser===e)return;const s=[];try{for(const r of this.queue)await r(e),r.onAbort&&s.push(r.onAbort)}catch(r){s.reverse();for(const i of s)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:(n=r)===null||n===void 0?void 0:n.message})}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FV{constructor(e,n,s){this.app=e,this.heartbeatServiceProvider=n,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new eI(this),this.idTokenSubscription=new eI(this),this.beforeStateQueue=new LV(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=T0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=kn(n)),this._initializationPromise=this.queue(async()=>{var s,r;if(!this._deleted&&(this.persistenceManager=await Xo.create(this,e),!this._deleted)){if(!((s=this._popupRedirectResolver)===null||s===void 0)&&s._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((r=this.currentUser)===null||r===void 0?void 0:r.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUser(e){var n;const s=await this.assertedPersistence.getCurrentUser();let r=s,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId,a=r==null?void 0:r._redirectEventId,c=await this.tryRedirectSignIn(e);(!o||o===a)&&(c==null?void 0:c.user)&&(r=c.user,i=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(r)}catch(o){r=s,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return D(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){var n;try{await vl(e)}catch(s){if(((n=s)===null||n===void 0?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=_V()}async _delete(){this._deleted=!0}async updateCurrentUser(e){const n=e?A(e):null;return n&&D(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&D(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0)}setPersistence(e){return this.queue(async()=>{await this.assertedPersistence.setPersistence(kn(e))})}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new dn("auth","Firebase",e())}onAuthStateChanged(e,n,s){return this.registerStateListener(this.authStateSubscription,e,n,s)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,s){return this.registerStateListener(this.idTokenSubscription,e,n,s)}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,n){const s=await this.getOrInitRedirectPersistenceManager(n);return e===null?s.removeCurrentUser():s.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&kn(e)||this._popupRedirectResolver;D(n,this,"argument-error"),this.redirectPersistenceManager=await Xo.create(this,[kn(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,s;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)===null||n===void 0?void 0:n._redirectEventId)===e?this._currentUser:((s=this.redirectUser)===null||s===void 0?void 0:s._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const s=(n=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&n!==void 0?n:null;this.lastNotifiedUid!==s&&(this.lastNotifiedUid=s,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,s,r){if(this._deleted)return()=>{};const i=typeof n=="function"?n:n.next.bind(n),o=this._isInitialized?Promise.resolve():this._initializationPromise;return D(o,this,"internal-error"),o.then(()=>i(this.currentUser)),typeof n=="function"?e.addObserver(n,s,r):e.addObserver(n)}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&(this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh()),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return D(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=F0(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const n={["X-Client-Version"]:this.clientVersion};this.app.options.appId&&(n["X-Firebase-gmpid"]=this.app.options.appId);const s=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());return s&&(n["X-Firebase-Client"]=s),n}}function Nt(t){return A(t)}class eI{constructor(e){this.auth=e,this.observer=null,this.addObserver=EC(n=>this.observer=n)}get next(){return D(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}function UV(t,e,n){const s=Nt(t);D(s._canInitEmulator,s,"emulator-config-failed"),D(/^https?:\/\//.test(e),s,"invalid-emulator-scheme");const r=!!(n!=null&&n.disableWarnings),i=U0(e),{host:o,port:a}=$V(e),c=a===null?"":`:${a}`;s.config.emulator={url:`${i}//${o}${c}/`},s.settings.appVerificationDisabledForTesting=!0,s.emulatorConfig=Object.freeze({host:o,port:a,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:r})}),r||VV()}function U0(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function $V(t){const e=U0(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const s=n[2].split("@").pop()||"",r=/^(\[[^\]]+\])(:|$)/.exec(s);if(r){const i=r[1];return{host:i,port:tI(s.substr(i.length+1))}}else{const[i,o]=s.split(":");return{host:i,port:tI(o)}}}function tI(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function VV(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console!="undefined"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window!="undefined"&&typeof document!="undefined"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qa{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return Es("not implemented")}_getIdTokenResponse(e){return Es("not implemented")}_linkToIdToken(e,n){return Es("not implemented")}_getReauthenticationResolver(e){return Es("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function $0(t,e){return xt(t,"POST","/v1/accounts:resetPassword",_t(t,e))}async function V0(t,e){return xt(t,"POST","/v1/accounts:update",e)}async function BV(t,e){return xt(t,"POST","/v1/accounts:update",_t(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function qV(t,e){return ur(t,"POST","/v1/accounts:signInWithPassword",_t(t,e))}async function tf(t,e){return xt(t,"POST","/v1/accounts:sendOobCode",_t(t,e))}async function jV(t,e){return tf(t,e)}async function KV(t,e){return tf(t,e)}async function WV(t,e){return tf(t,e)}async function HV(t,e){return tf(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function GV(t,e){return ur(t,"POST","/v1/accounts:signInWithEmailLink",_t(t,e))}async function zV(t,e){return ur(t,"POST","/v1/accounts:signInWithEmailLink",_t(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bl extends qa{constructor(e,n,s,r=null){super("password",s),this._email=e,this._password=n,this._tenantId=r}static _fromEmailAndPassword(e,n){return new bl(e,n,"password")}static _fromEmailAndCode(e,n,s=null){return new bl(e,n,"emailLink",s)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;if((n==null?void 0:n.email)&&(n==null?void 0:n.password)){if(n.signInMethod==="password")return this._fromEmailAndPassword(n.email,n.password);if(n.signInMethod==="emailLink")return this._fromEmailAndCode(n.email,n.password,n.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":return qV(e,{returnSecureToken:!0,email:this._email,password:this._password});case"emailLink":return GV(e,{email:this._email,oobCode:this._password});default:Ht(e,"internal-error")}}async _linkToIdToken(e,n){switch(this.signInMethod){case"password":return V0(e,{idToken:n,returnSecureToken:!0,email:this._email,password:this._password});case"emailLink":return zV(e,{idToken:n,email:this._email,oobCode:this._password});default:Ht(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function er(t,e){return ur(t,"POST","/v1/accounts:signInWithIdp",_t(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QV="http://localhost";class xs extends qa{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new xs(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):Ht("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:s,signInMethod:r}=n,i=B_(n,["providerId","signInMethod"]);if(!s||!r)return null;const o=new xs(s,r);return o.idToken=i.idToken||void 0,o.accessToken=i.accessToken||void 0,o.secret=i.secret,o.nonce=i.nonce,o.pendingToken=i.pendingToken||null,o}_getIdTokenResponse(e){const n=this.buildRequest();return er(e,n)}_linkToIdToken(e,n){const s=this.buildRequest();return s.idToken=n,er(e,s)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,er(e,n)}buildRequest(){const e={requestUri:QV,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=wo(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function YV(t,e){return xt(t,"POST","/v1/accounts:sendVerificationCode",_t(t,e))}async function JV(t,e){return ur(t,"POST","/v1/accounts:signInWithPhoneNumber",_t(t,e))}async function XV(t,e){const n=await ur(t,"POST","/v1/accounts:signInWithPhoneNumber",_t(t,e));if(n.temporaryProof)throw Cc(t,"account-exists-with-different-credential",n);return n}const ZV={USER_NOT_FOUND:"user-not-found"};async function eB(t,e){const n=Object.assign(Object.assign({},e),{operation:"REAUTH"});return ur(t,"POST","/v1/accounts:signInWithPhoneNumber",_t(t,n),ZV)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ji extends qa{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,n){return new ji({verificationId:e,verificationCode:n})}static _fromTokenResponse(e,n){return new ji({phoneNumber:e,temporaryProof:n})}_getIdTokenResponse(e){return JV(e,this._makeVerificationRequest())}_linkToIdToken(e,n){return XV(e,Object.assign({idToken:n},this._makeVerificationRequest()))}_getReauthenticationResolver(e){return eB(e,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:e,phoneNumber:n,verificationId:s,verificationCode:r}=this.params;return e&&n?{temporaryProof:e,phoneNumber:n}:{sessionInfo:s,code:r}}toJSON(){const e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){typeof e=="string"&&(e=JSON.parse(e));const{verificationId:n,verificationCode:s,phoneNumber:r,temporaryProof:i}=e;return!s&&!n&&!r&&!i?null:new ji({verificationId:n,verificationCode:s,phoneNumber:r,temporaryProof:i})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tB(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function nB(t){const e=Ho(Sc(t)).link,n=e?Ho(Sc(e)).deep_link_id:null,s=Ho(Sc(t)).deep_link_id;return(s?Ho(Sc(s)).link:null)||s||n||e||t}class nf{constructor(e){var n,s,r,i,o,a;const c=Ho(Sc(e)),l=(n=c.apiKey)!==null&&n!==void 0?n:null,u=(s=c.oobCode)!==null&&s!==void 0?s:null,h=tB((r=c.mode)!==null&&r!==void 0?r:null);D(l&&u&&h,"argument-error"),this.apiKey=l,this.operation=h,this.code=u,this.continueUrl=(i=c.continueUrl)!==null&&i!==void 0?i:null,this.languageCode=(o=c.languageCode)!==null&&o!==void 0?o:null,this.tenantId=(a=c.tenantId)!==null&&a!==void 0?a:null}static parseLink(e){const n=nB(e);try{return new nf(n)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ri{constructor(){this.providerId=ri.PROVIDER_ID}static credential(e,n){return bl._fromEmailAndPassword(e,n)}static credentialWithLink(e,n){const s=nf.parseLink(n);return D(s,"argument-error"),bl._fromEmailAndCode(e,s.code,s.tenantId)}}ri.PROVIDER_ID="password";ri.EMAIL_PASSWORD_SIGN_IN_METHOD="password";ri.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hr{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ja extends hr{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class Zo extends ja{static credentialFromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;return D("providerId"in n&&"signInMethod"in n,"argument-error"),xs._fromParams(n)}credential(e){return this._credential(Object.assign(Object.assign({},e),{nonce:e.rawNonce}))}_credential(e){return D(e.idToken||e.accessToken,"argument-error"),xs._fromParams(Object.assign(Object.assign({},e),{providerId:this.providerId,signInMethod:this.providerId}))}static credentialFromResult(e){return Zo.oauthCredentialFromTaggedObject(e)}static credentialFromError(e){return Zo.oauthCredentialFromTaggedObject(e.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:s,oauthTokenSecret:r,pendingToken:i,nonce:o,providerId:a}=e;if(!s&&!r&&!n&&!i||!a)return null;try{return new Zo(a)._credential({idToken:n,accessToken:s,nonce:o,pendingToken:i})}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ys extends ja{constructor(){super("facebook.com")}static credential(e){return xs._fromParams({providerId:ys.PROVIDER_ID,signInMethod:ys.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return ys.credentialFromTaggedObject(e)}static credentialFromError(e){return ys.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return ys.credential(e.oauthAccessToken)}catch{return null}}}ys.FACEBOOK_SIGN_IN_METHOD="facebook.com";ys.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vs extends ja{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return xs._fromParams({providerId:vs.PROVIDER_ID,signInMethod:vs.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return vs.credentialFromTaggedObject(e)}static credentialFromError(e){return vs.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:s}=e;if(!n&&!s)return null;try{return vs.credential(n,s)}catch{return null}}}vs.GOOGLE_SIGN_IN_METHOD="google.com";vs.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ws extends ja{constructor(){super("github.com")}static credential(e){return xs._fromParams({providerId:ws.PROVIDER_ID,signInMethod:ws.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return ws.credentialFromTaggedObject(e)}static credentialFromError(e){return ws.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return ws.credential(e.oauthAccessToken)}catch{return null}}}ws.GITHUB_SIGN_IN_METHOD="github.com";ws.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sB="http://localhost";class ma extends qa{constructor(e,n){super(e,e),this.pendingToken=n}_getIdTokenResponse(e){const n=this.buildRequest();return er(e,n)}_linkToIdToken(e,n){const s=this.buildRequest();return s.idToken=n,er(e,s)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,er(e,n)}toJSON(){return{signInMethod:this.signInMethod,providerId:this.providerId,pendingToken:this.pendingToken}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:s,signInMethod:r,pendingToken:i}=n;return!s||!r||!i||s!==r?null:new ma(s,i)}static _create(e,n){return new ma(e,n)}buildRequest(){return{requestUri:sB,returnSecureToken:!0,pendingToken:this.pendingToken}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rB="saml.";class qh extends hr{constructor(e){D(e.startsWith(rB),"argument-error"),super(e)}static credentialFromResult(e){return qh.samlCredentialFromTaggedObject(e)}static credentialFromError(e){return qh.samlCredentialFromTaggedObject(e.customData||{})}static credentialFromJSON(e){const n=ma.fromJSON(e);return D(n,"argument-error"),n}static samlCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{pendingToken:n,providerId:s}=e;if(!n||!s)return null;try{return ma._create(s,n)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bs extends ja{constructor(){super("twitter.com")}static credential(e,n){return xs._fromParams({providerId:bs.PROVIDER_ID,signInMethod:bs.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return bs.credentialFromTaggedObject(e)}static credentialFromError(e){return bs.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:s}=e;if(!n||!s)return null;try{return bs.credential(n,s)}catch{return null}}}bs.TWITTER_SIGN_IN_METHOD="twitter.com";bs.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function B0(t,e){return ur(t,"POST","/v1/accounts:signUp",_t(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hn{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,s,r=!1){const i=await Bi._fromIdTokenResponse(e,s,r),o=nI(s);return new Hn({user:i,providerId:o,_tokenResponse:s,operationType:n})}static async _forOperation(e,n,s){await e._updateTokensIfNecessary(s,!0);const r=nI(s);return new Hn({user:e,providerId:r,_tokenResponse:s,operationType:n})}}function nI(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function iB(t){var e;const n=Nt(t);if(await n._initializationPromise,!((e=n.currentUser)===null||e===void 0)&&e.isAnonymous)return new Hn({user:n.currentUser,providerId:null,operationType:"signIn"});const s=await B0(n,{returnSecureToken:!0}),r=await Hn._fromIdTokenResponse(n,"signIn",s,!0);return await n._updateCurrentUser(r.user),r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jh extends ct{constructor(e,n,s,r){var i;super(n.code,n.message),this.operationType=s,this.user=r,Object.setPrototypeOf(this,jh.prototype),this.customData={appName:e.name,tenantId:(i=e.tenantId)!==null&&i!==void 0?i:void 0,_serverResponse:n.customData._serverResponse,operationType:s}}static _fromErrorAndOperation(e,n,s,r){return new jh(e,n,s,r)}}function q0(t,e,n,s){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?jh._fromErrorAndOperation(t,i,e,s):i})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function j0(t){return new Set(t.map(({providerId:e})=>e).filter(e=>!!e))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function oB(t,e){const n=A(t);await sf(!0,n,e);const{providerUserInfo:s}=await IV(n.auth,{idToken:await n.getIdToken(),deleteProvider:[e]}),r=j0(s||[]);return n.providerData=n.providerData.filter(i=>r.has(i.providerId)),r.has("phone")||(n.phoneNumber=null),await n.auth._persistUserIfCurrent(n),n}async function H_(t,e,n=!1){const s=await rr(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return Hn._forOperation(t,"link",s)}async function sf(t,e,n){await vl(e);const s=j0(e.providerData),r=t===!1?"provider-already-linked":"no-such-provider";D(s.has(n)===t,e.auth,r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function K0(t,e,n=!1){var s;const{auth:r}=t,i="reauthenticate";try{const o=await rr(t,q0(r,i,e,t),n);D(o.idToken,r,"internal-error");const a=ef(o.idToken);D(a,r,"internal-error");const{sub:c}=a;return D(t.uid===c,r,"user-mismatch"),Hn._forOperation(t,i,o)}catch(o){throw((s=o)===null||s===void 0?void 0:s.code)==="auth/user-not-found"&&Ht(r,"user-mismatch"),o}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function W0(t,e,n=!1){const s="signIn",r=await q0(t,s,e),i=await Hn._fromIdTokenResponse(t,s,r);return n||await t._updateCurrentUser(i.user),i}async function rf(t,e){return W0(Nt(t),e)}async function H0(t,e){const n=A(t);return await sf(!1,n,e.providerId),H_(n,e)}async function G0(t,e){return K0(A(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function aB(t,e){return ur(t,"POST","/v1/accounts:signInWithCustomToken",_t(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function cB(t,e){const n=Nt(t),s=await aB(n,{token:e,returnSecureToken:!0}),r=await Hn._fromIdTokenResponse(n,"signIn",s);return await n._updateCurrentUser(r.user),r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class of{constructor(e,n){this.factorId=e,this.uid=n.mfaEnrollmentId,this.enrollmentTime=new Date(n.enrolledAt).toUTCString(),this.displayName=n.displayName}static _fromServerResponse(e,n){return"phoneInfo"in n?G_._fromServerResponse(e,n):Ht(e,"internal-error")}}class G_ extends of{constructor(e){super("phone",e),this.phoneNumber=e.phoneInfo}static _fromServerResponse(e,n){return new G_(n)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function af(t,e,n){var s;D(((s=n.url)===null||s===void 0?void 0:s.length)>0,t,"invalid-continue-uri"),D(typeof n.dynamicLinkDomain=="undefined"||n.dynamicLinkDomain.length>0,t,"invalid-dynamic-link-domain"),e.continueUrl=n.url,e.dynamicLinkDomain=n.dynamicLinkDomain,e.canHandleCodeInApp=n.handleCodeInApp,n.iOS&&(D(n.iOS.bundleId.length>0,t,"missing-ios-bundle-id"),e.iOSBundleId=n.iOS.bundleId),n.android&&(D(n.android.packageName.length>0,t,"missing-android-pkg-name"),e.androidInstallApp=n.android.installApp,e.androidMinimumVersionCode=n.android.minimumVersion,e.androidPackageName=n.android.packageName)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function lB(t,e,n){const s=A(t),r={requestType:"PASSWORD_RESET",email:e};n&&af(s,r,n),await KV(s,r)}async function uB(t,e,n){await $0(A(t),{oobCode:e,newPassword:n})}async function hB(t,e){await BV(A(t),{oobCode:e})}async function z0(t,e){const n=A(t),s=await $0(n,{oobCode:e}),r=s.requestType;switch(D(r,n,"internal-error"),r){case"EMAIL_SIGNIN":break;case"VERIFY_AND_CHANGE_EMAIL":D(s.newEmail,n,"internal-error");break;case"REVERT_SECOND_FACTOR_ADDITION":D(s.mfaInfo,n,"internal-error");default:D(s.email,n,"internal-error")}let i=null;return s.mfaInfo&&(i=of._fromServerResponse(Nt(n),s.mfaInfo)),{data:{email:(s.requestType==="VERIFY_AND_CHANGE_EMAIL"?s.newEmail:s.email)||null,previousEmail:(s.requestType==="VERIFY_AND_CHANGE_EMAIL"?s.email:s.newEmail)||null,multiFactorInfo:i},operation:r}}async function dB(t,e){const{data:n}=await z0(A(t),e);return n.email}async function fB(t,e,n){const s=Nt(t),r=await B0(s,{returnSecureToken:!0,email:e,password:n}),i=await Hn._fromIdTokenResponse(s,"signIn",r);return await s._updateCurrentUser(i.user),i}function pB(t,e,n){return rf(A(t),ri.credential(e,n))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function gB(t,e,n){const s=A(t),r={requestType:"EMAIL_SIGNIN",email:e};D(n.handleCodeInApp,s,"argument-error"),n&&af(s,r,n),await WV(s,r)}function mB(t,e){const n=nf.parseLink(e);return(n==null?void 0:n.operation)==="EMAIL_SIGNIN"}async function _B(t,e,n){const s=A(t),r=ri.credentialWithLink(e,n||yl());return D(r._tenantId===(s.tenantId||null),s,"tenant-id-mismatch"),rf(s,r)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function yB(t,e){return xt(t,"POST","/v1/accounts:createAuthUri",_t(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function vB(t,e){const n=j_()?yl():"http://localhost",s={identifier:e,continueUri:n},{signinMethods:r}=await yB(A(t),s);return r||[]}async function wB(t,e){const n=A(t),s=await t.getIdToken(),r={requestType:"VERIFY_EMAIL",idToken:s};e&&af(n.auth,r,e);const{email:i}=await jV(n.auth,r);i!==t.email&&await t.reload()}async function bB(t,e,n){const s=A(t),r=await t.getIdToken(),i={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:r,newEmail:e};n&&af(s.auth,i,n);const{email:o}=await HV(s.auth,i);o!==t.email&&await t.reload()}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function IB(t,e){return xt(t,"POST","/v1/accounts:update",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function EB(t,{displayName:e,photoURL:n}){if(e===void 0&&n===void 0)return;const s=A(t),i={idToken:await s.getIdToken(),displayName:e,photoUrl:n,returnSecureToken:!0},o=await rr(s,IB(s.auth,i));s.displayName=o.displayName||null,s.photoURL=o.photoUrl||null;const a=s.providerData.find(({providerId:c})=>c==="password");a&&(a.displayName=s.displayName,a.photoURL=s.photoURL),await s._updateTokensIfNecessary(o)}function TB(t,e){return Q0(A(t),e,null)}function SB(t,e){return Q0(A(t),null,e)}async function Q0(t,e,n){const{auth:s}=t,i={idToken:await t.getIdToken(),returnSecureToken:!0};e&&(i.email=e),n&&(i.password=n);const o=await rr(t,V0(s,i));await t._updateTokensIfNecessary(o,!0)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function CB(t){var e,n;if(!t)return null;const{providerId:s}=t,r=t.rawUserInfo?JSON.parse(t.rawUserInfo):{},i=t.isNewUser||t.kind==="identitytoolkit#SignupNewUserResponse";if(!s&&(t==null?void 0:t.idToken)){const o=(n=(e=ef(t.idToken))===null||e===void 0?void 0:e.firebase)===null||n===void 0?void 0:n.sign_in_provider;if(o){const a=o!=="anonymous"&&o!=="custom"?o:null;return new ea(i,a)}}if(!s)return null;switch(s){case"facebook.com":return new AB(i,r);case"github.com":return new kB(i,r);case"google.com":return new RB(i,r);case"twitter.com":return new NB(i,r,t.screenName||null);case"custom":case"anonymous":return new ea(i,null);default:return new ea(i,s,r)}}class ea{constructor(e,n,s={}){this.isNewUser=e,this.providerId=n,this.profile=s}}class Y0 extends ea{constructor(e,n,s,r){super(e,n,s),this.username=r}}class AB extends ea{constructor(e,n){super(e,"facebook.com",n)}}class kB extends Y0{constructor(e,n){super(e,"github.com",n,typeof(n==null?void 0:n.login)=="string"?n==null?void 0:n.login:null)}}class RB extends ea{constructor(e,n){super(e,"google.com",n)}}class NB extends Y0{constructor(e,n,s){super(e,"twitter.com",n,s)}}function PB(t){const{user:e,_tokenResponse:n}=t;return e.isAnonymous&&!n?{providerId:null,isNewUser:!1,profile:null}:CB(n)}class xi{constructor(e,n){this.type=e,this.credential=n}static _fromIdtoken(e){return new xi("enroll",e)}static _fromMfaPendingCredential(e){return new xi("signin",e)}toJSON(){return{multiFactorSession:{[this.type==="enroll"?"idToken":"pendingCredential"]:this.credential}}}static fromJSON(e){var n,s;if(e!=null&&e.multiFactorSession){if(!((n=e.multiFactorSession)===null||n===void 0)&&n.pendingCredential)return xi._fromMfaPendingCredential(e.multiFactorSession.pendingCredential);if(!((s=e.multiFactorSession)===null||s===void 0)&&s.idToken)return xi._fromIdtoken(e.multiFactorSession.idToken)}return null}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z_{constructor(e,n,s){this.session=e,this.hints=n,this.signInResolver=s}static _fromError(e,n){const s=Nt(e),r=n.customData._serverResponse,i=(r.mfaInfo||[]).map(a=>of._fromServerResponse(s,a));D(r.mfaPendingCredential,s,"internal-error");const o=xi._fromMfaPendingCredential(r.mfaPendingCredential);return new z_(o,i,async a=>{const c=await a._process(s,o);delete r.mfaInfo,delete r.mfaPendingCredential;const l=Object.assign(Object.assign({},r),{idToken:c.idToken,refreshToken:c.refreshToken});switch(n.operationType){case"signIn":const u=await Hn._fromIdTokenResponse(s,n.operationType,l);return await s._updateCurrentUser(u.user),u;case"reauthenticate":return D(n.user,s,"internal-error"),Hn._forOperation(n.user,n.operationType,l);default:Ht(s,"internal-error")}})}async resolveSignIn(e){const n=e;return this.signInResolver(n)}}function DB(t,e){var n;const s=A(t),r=e;return D(e.customData.operationType,s,"argument-error"),D((n=r.customData._serverResponse)===null||n===void 0?void 0:n.mfaPendingCredential,s,"argument-error"),z_._fromError(s,r)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xB(t,e){return xt(t,"POST","/v2/accounts/mfaEnrollment:start",_t(t,e))}function OB(t,e){return xt(t,"POST","/v2/accounts/mfaEnrollment:finalize",_t(t,e))}function MB(t,e){return xt(t,"POST","/v2/accounts/mfaEnrollment:withdraw",_t(t,e))}class Q_{constructor(e){this.user=e,this.enrolledFactors=[],e._onReload(n=>{n.mfaInfo&&(this.enrolledFactors=n.mfaInfo.map(s=>of._fromServerResponse(e.auth,s)))})}static _fromUser(e){return new Q_(e)}async getSession(){return xi._fromIdtoken(await this.user.getIdToken())}async enroll(e,n){const s=e,r=await this.getSession(),i=await rr(this.user,s._process(this.user.auth,r,n));return await this.user._updateTokensIfNecessary(i),this.user.reload()}async unenroll(e){var n;const s=typeof e=="string"?e:e.uid,r=await this.user.getIdToken(),i=await rr(this.user,MB(this.user.auth,{idToken:r,mfaEnrollmentId:s}));this.enrolledFactors=this.enrolledFactors.filter(({uid:o})=>o!==s),await this.user._updateTokensIfNecessary(i);try{await this.user.reload()}catch(o){if(((n=o)===null||n===void 0?void 0:n.code)!=="auth/user-token-expired")throw o}}}const Dp=new WeakMap;function LB(t){const e=A(t);return Dp.has(e)||Dp.set(e,Q_._fromUser(e)),Dp.get(e)}const Kh="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J0{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(Kh,"1"),this.storage.removeItem(Kh),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function FB(){const t=We();return W_(t)||Ba(t)}const UB=1e3,$B=10;class X0 extends J0{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=FB()&&MV(),this.fallbackToPolling=L0(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const s=this.storage.getItem(n),r=this.localCache[n];s!==r&&e(n,r,s)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((o,a,c)=>{this.notifyListeners(o,c)});return}const s=e.key;if(n?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const o=this.storage.getItem(s);if(e.newValue!==o)e.newValue!==null?this.storage.setItem(s,e.newValue):this.storage.removeItem(s);else if(this.localCache[s]===e.newValue&&!n)return}const r=()=>{const o=this.storage.getItem(s);!n&&this.localCache[s]===o||this.notifyListeners(s,o)},i=this.storage.getItem(s);OV()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(r,$B):r()}notifyListeners(e,n){this.localCache[e]=n;const s=this.listeners[e];if(s)for(const r of Array.from(s))r(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,s)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:s}),!0)})},UB)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}X0.type="LOCAL";const Y_=X0;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z0 extends J0{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}Z0.type="SESSION";const Yi=Z0;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VB(t){return Promise.all(t.map(async e=>{try{const n=await e;return{fulfilled:!0,value:n}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cf{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(r=>r.isListeningto(e));if(n)return n;const s=new cf(e);return this.receivers.push(s),s}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:s,eventType:r,data:i}=n.data,o=this.handlersMap[r];if(!(o!=null&&o.size))return;n.ports[0].postMessage({status:"ack",eventId:s,eventType:r});const a=Array.from(o).map(async l=>l(n.origin,i)),c=await VB(a);n.ports[0].postMessage({status:"done",eventId:s,eventType:r,response:c})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}cf.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ou(t="",e=10){let n="";for(let s=0;s<e;s++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BB{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,s=50){const r=typeof MessageChannel!="undefined"?new MessageChannel:null;if(!r)throw new Error("connection_unavailable");let i,o;return new Promise((a,c)=>{const l=ou("",20);r.port1.start();const u=setTimeout(()=>{c(new Error("unsupported_event"))},s);o={messageChannel:r,onMessage(h){const d=h;if(d.data.eventId===l)switch(d.data.status){case"ack":clearTimeout(u),i=setTimeout(()=>{c(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),a(d.data.response);break;default:clearTimeout(u),clearTimeout(i),c(new Error("invalid_response"));break}}},this.handlers.add(o),r.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:l,data:n},[r.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ft(){return window}function qB(t){ft().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function J_(){return typeof ft().WorkerGlobalScope!="undefined"&&typeof ft().importScripts=="function"}async function jB(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function KB(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function WB(){return J_()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eA="firebaseLocalStorageDb",HB=1,Wh="firebaseLocalStorage",tA="fbase_key";class au{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function lf(t,e){return t.transaction([Wh],e?"readwrite":"readonly").objectStore(Wh)}function GB(){const t=indexedDB.deleteDatabase(eA);return new au(t).toPromise()}function zg(){const t=indexedDB.open(eA,HB);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const s=t.result;try{s.createObjectStore(Wh,{keyPath:tA})}catch(r){n(r)}}),t.addEventListener("success",async()=>{const s=t.result;s.objectStoreNames.contains(Wh)?e(s):(s.close(),await GB(),e(await zg()))})})}async function sI(t,e,n){const s=lf(t,!0).put({[tA]:e,value:n});return new au(s).toPromise()}async function zB(t,e){const n=lf(t,!1).get(e),s=await new au(n).toPromise();return s===void 0?null:s.value}function rI(t,e){const n=lf(t,!0).delete(e);return new au(n).toPromise()}const QB=800,YB=3;class nA{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await zg(),this.db)}async _withRetries(e){let n=0;for(;;)try{const s=await this._openDb();return await e(s)}catch(s){if(n++>YB)throw s;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return J_()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=cf._getInstance(WB()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var e,n;if(this.activeServiceWorker=await jB(),!this.activeServiceWorker)return;this.sender=new BB(this.activeServiceWorker);const s=await this.sender._send("ping",{},800);!s||((e=s[0])===null||e===void 0?void 0:e.fulfilled)&&((n=s[0])===null||n===void 0?void 0:n.value.includes("keyChanged"))&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||KB()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await zg();return await sI(e,Kh,"1"),await rI(e,Kh),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(s=>sI(s,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(s=>zB(s,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>rI(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(r=>{const i=lf(r,!1).getAll();return new au(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],s=new Set;for(const{fbase_key:r,value:i}of e)s.add(r),JSON.stringify(this.localCache[r])!==JSON.stringify(i)&&(this.notifyListeners(r,i),n.push(r));for(const r of Object.keys(this.localCache))this.localCache[r]&&!s.has(r)&&(this.notifyListeners(r,null),n.push(r));return n}notifyListeners(e,n){this.localCache[e]=n;const s=this.listeners[e];if(s)for(const r of Array.from(s))r(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),QB)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}nA.type="LOCAL";const Il=nA;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function JB(t,e){return xt(t,"POST","/v2/accounts/mfaSignIn:start",_t(t,e))}function XB(t,e){return xt(t,"POST","/v2/accounts/mfaSignIn:finalize",_t(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ZB(t){return(await xt(t,"GET","/v1/recaptchaParams")).recaptchaSiteKey||""}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eq(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}function sA(t){return new Promise((e,n)=>{const s=document.createElement("script");s.setAttribute("src",t),s.onload=e,s.onerror=r=>{const i=qt("internal-error");i.customData=r,n(i)},s.type="text/javascript",s.charset="UTF-8",eq().appendChild(s)})}function rA(t){return`__${t}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tq=500,nq=6e4,Hu=1e12;class sq{constructor(e){this.auth=e,this.counter=Hu,this._widgets=new Map}render(e,n){const s=this.counter;return this._widgets.set(s,new rq(e,this.auth.name,n||{})),this.counter++,s}reset(e){var n;const s=e||Hu;(n=this._widgets.get(s))===null||n===void 0||n.delete(),this._widgets.delete(s)}getResponse(e){var n;const s=e||Hu;return((n=this._widgets.get(s))===null||n===void 0?void 0:n.getResponse())||""}async execute(e){var n;const s=e||Hu;return(n=this._widgets.get(s))===null||n===void 0||n.execute(),""}}class rq{constructor(e,n,s){this.params=s,this.timerId=null,this.deleted=!1,this.responseToken=null,this.clickHandler=()=>{this.execute()};const r=typeof e=="string"?document.getElementById(e):e;D(r,"argument-error",{appName:n}),this.container=r,this.isVisible=this.params.size!=="invisible",this.isVisible?this.execute():this.container.addEventListener("click",this.clickHandler)}getResponse(){return this.checkIfDeleted(),this.responseToken}delete(){this.checkIfDeleted(),this.deleted=!0,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.container.removeEventListener("click",this.clickHandler)}execute(){this.checkIfDeleted(),!this.timerId&&(this.timerId=window.setTimeout(()=>{this.responseToken=iq(50);const{callback:e,"expired-callback":n}=this.params;if(e)try{e(this.responseToken)}catch{}this.timerId=window.setTimeout(()=>{if(this.timerId=null,this.responseToken=null,n)try{n()}catch{}this.isVisible&&this.execute()},nq)},tq))}checkIfDeleted(){if(this.deleted)throw new Error("reCAPTCHA mock was already deleted!")}}function iq(t){const e=[],n="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let s=0;s<t;s++)e.push(n.charAt(Math.floor(Math.random()*n.length)));return e.join("")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xp=rA("rcb"),oq=new ru(3e4,6e4),aq="https://www.google.com/recaptcha/api.js?";class cq{constructor(){var e;this.hostLanguage="",this.counter=0,this.librarySeparatelyLoaded=!!(!((e=ft().grecaptcha)===null||e===void 0)&&e.render)}load(e,n=""){return D(lq(n),e,"argument-error"),this.shouldResolveImmediately(n)?Promise.resolve(ft().grecaptcha):new Promise((s,r)=>{const i=ft().setTimeout(()=>{r(qt(e,"network-request-failed"))},oq.get());ft()[xp]=()=>{ft().clearTimeout(i),delete ft()[xp];const a=ft().grecaptcha;if(!a){r(qt(e,"internal-error"));return}const c=a.render;a.render=(l,u)=>{const h=c(l,u);return this.counter++,h},this.hostLanguage=n,s(a)};const o=`${aq}?${wo({onload:xp,render:"explicit",hl:n})}`;sA(o).catch(()=>{clearTimeout(i),r(qt(e,"internal-error"))})})}clearedOneInstance(){this.counter--}shouldResolveImmediately(e){var n;return!!(!((n=ft().grecaptcha)===null||n===void 0)&&n.render)&&(e===this.hostLanguage||this.counter>0||this.librarySeparatelyLoaded)}}function lq(t){return t.length<=6&&/^\s*[a-zA-Z0-9\-]*\s*$/.test(t)}class uq{async load(e){return new sq(e)}clearedOneInstance(){}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iA="recaptcha",hq={theme:"light",type:"image"};class dq{constructor(e,n=Object.assign({},hq),s){this.parameters=n,this.type=iA,this.destroyed=!1,this.widgetId=null,this.tokenChangeListeners=new Set,this.renderPromise=null,this.recaptcha=null,this.auth=Nt(s),this.isInvisible=this.parameters.size==="invisible",D(typeof document!="undefined",this.auth,"operation-not-supported-in-this-environment");const r=typeof e=="string"?document.getElementById(e):e;D(r,this.auth,"argument-error"),this.container=r,this.parameters.callback=this.makeTokenCallback(this.parameters.callback),this._recaptchaLoader=this.auth.settings.appVerificationDisabledForTesting?new uq:new cq,this.validateStartingState()}async verify(){this.assertNotDestroyed();const e=await this.render(),n=this.getAssertedRecaptcha(),s=n.getResponse(e);return s||new Promise(r=>{const i=o=>{!o||(this.tokenChangeListeners.delete(i),r(o))};this.tokenChangeListeners.add(i),this.isInvisible&&n.execute(e)})}render(){try{this.assertNotDestroyed()}catch(e){return Promise.reject(e)}return this.renderPromise?this.renderPromise:(this.renderPromise=this.makeRenderPromise().catch(e=>{throw this.renderPromise=null,e}),this.renderPromise)}_reset(){this.assertNotDestroyed(),this.widgetId!==null&&this.getAssertedRecaptcha().reset(this.widgetId)}clear(){this.assertNotDestroyed(),this.destroyed=!0,this._recaptchaLoader.clearedOneInstance(),this.isInvisible||this.container.childNodes.forEach(e=>{this.container.removeChild(e)})}validateStartingState(){D(!this.parameters.sitekey,this.auth,"argument-error"),D(this.isInvisible||!this.container.hasChildNodes(),this.auth,"argument-error"),D(typeof document!="undefined",this.auth,"operation-not-supported-in-this-environment")}makeTokenCallback(e){return n=>{if(this.tokenChangeListeners.forEach(s=>s(n)),typeof e=="function")e(n);else if(typeof e=="string"){const s=ft()[e];typeof s=="function"&&s(n)}}}assertNotDestroyed(){D(!this.destroyed,this.auth,"internal-error")}async makeRenderPromise(){if(await this.init(),!this.widgetId){let e=this.container;if(!this.isInvisible){const n=document.createElement("div");e.appendChild(n),e=n}this.widgetId=this.getAssertedRecaptcha().render(e,this.parameters)}return this.widgetId}async init(){D(j_()&&!J_(),this.auth,"internal-error"),await fq(),this.recaptcha=await this._recaptchaLoader.load(this.auth,this.auth.languageCode||void 0);const e=await ZB(this.auth);D(e,this.auth,"internal-error"),this.parameters.sitekey=e}getAssertedRecaptcha(){return D(this.recaptcha,this.auth,"internal-error"),this.recaptcha}}function fq(){let t=null;return new Promise(e=>{if(document.readyState==="complete"){e();return}t=()=>e(),window.addEventListener("load",t)}).catch(e=>{throw t&&window.removeEventListener("load",t),e})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X_{constructor(e,n){this.verificationId=e,this.onConfirmation=n}confirm(e){const n=ji._fromVerification(this.verificationId,e);return this.onConfirmation(n)}}async function pq(t,e,n){const s=Nt(t),r=await uf(s,e,A(n));return new X_(r,i=>rf(s,i))}async function gq(t,e,n){const s=A(t);await sf(!1,s,"phone");const r=await uf(s.auth,e,A(n));return new X_(r,i=>H0(s,i))}async function mq(t,e,n){const s=A(t),r=await uf(s.auth,e,A(n));return new X_(r,i=>G0(s,i))}async function uf(t,e,n){var s;const r=await n.verify();try{D(typeof r=="string",t,"argument-error"),D(n.type===iA,t,"argument-error");let i;if(typeof e=="string"?i={phoneNumber:e}:i=e,"session"in i){const o=i.session;if("phoneNumber"in i)return D(o.type==="enroll",t,"internal-error"),(await xB(t,{idToken:o.credential,phoneEnrollmentInfo:{phoneNumber:i.phoneNumber,recaptchaToken:r}})).phoneSessionInfo.sessionInfo;{D(o.type==="signin",t,"internal-error");const a=((s=i.multiFactorHint)===null||s===void 0?void 0:s.uid)||i.multiFactorUid;return D(a,t,"missing-multi-factor-info"),(await JB(t,{mfaPendingCredential:o.credential,mfaEnrollmentId:a,phoneSignInInfo:{recaptchaToken:r}})).phoneResponseInfo.sessionInfo}}else{const{sessionInfo:o}=await YV(t,{phoneNumber:i.phoneNumber,recaptchaToken:r});return o}}finally{n._reset()}}async function _q(t,e){await H_(A(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class as{constructor(e){this.providerId=as.PROVIDER_ID,this.auth=Nt(e)}verifyPhoneNumber(e,n){return uf(this.auth,e,A(n))}static credential(e,n){return ji._fromVerification(e,n)}static credentialFromResult(e){const n=e;return as.credentialFromTaggedObject(n)}static credentialFromError(e){return as.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{phoneNumber:n,temporaryProof:s}=e;return n&&s?ji._fromTokenResponse(n,s):null}}as.PROVIDER_ID="phone";as.PHONE_SIGN_IN_METHOD="phone";/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Io(t,e){return e?kn(e):(D(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z_ extends qa{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return er(e,this._buildIdpRequest())}_linkToIdToken(e,n){return er(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return er(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function yq(t){return W0(t.auth,new Z_(t),t.bypassAuthState)}function vq(t){const{auth:e,user:n}=t;return D(n,e,"internal-error"),K0(n,new Z_(t),t.bypassAuthState)}async function wq(t){const{auth:e,user:n}=t;return D(n,e,"internal-error"),H_(n,new Z_(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oA{constructor(e,n,s,r,i=!1){this.auth=e,this.resolver=s,this.user=r,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(s){this.reject(s)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:s,postBody:r,tenantId:i,error:o,type:a}=e;if(o){this.reject(o);return}const c={auth:this.auth,requestUri:n,sessionId:s,tenantId:i||void 0,postBody:r||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(c))}catch(l){this.reject(l)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return yq;case"linkViaPopup":case"linkViaRedirect":return wq;case"reauthViaPopup":case"reauthViaRedirect":return vq;default:Ht(this.auth,"internal-error")}}resolve(e){us(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){us(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bq=new ru(2e3,1e4);async function Iq(t,e,n){const s=Nt(t);Va(t,e,hr);const r=Io(s,n);return new zs(s,"signInViaPopup",e,r).executeNotNull()}async function Eq(t,e,n){const s=A(t);Va(s.auth,e,hr);const r=Io(s.auth,n);return new zs(s.auth,"reauthViaPopup",e,r,s).executeNotNull()}async function Tq(t,e,n){const s=A(t);Va(s.auth,e,hr);const r=Io(s.auth,n);return new zs(s.auth,"linkViaPopup",e,r,s).executeNotNull()}class zs extends oA{constructor(e,n,s,r,i){super(e,n,r,i),this.provider=s,this.authWindow=null,this.pollId=null,zs.currentPopupAction&&zs.currentPopupAction.cancel(),zs.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return D(e,this.auth,"internal-error"),e}async onExecution(){us(this.filter.length===1,"Popup operations only handle one event");const e=ou();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(qt(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(qt(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,zs.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,s;if(!((s=(n=this.authWindow)===null||n===void 0?void 0:n.window)===null||s===void 0)&&s.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(qt(this.auth,"popup-closed-by-user"))},2e3);return}this.pollId=window.setTimeout(e,bq.get())};e()}}zs.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sq="pendingRedirect",Uc=new Map;class Cq extends oA{constructor(e,n,s=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,s),this.eventId=null}async execute(){let e=Uc.get(this.auth._key());if(!e){try{const s=await Aq(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(s)}catch(n){e=()=>Promise.reject(n)}Uc.set(this.auth._key(),e)}return this.bypassAuthState||Uc.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function Aq(t,e){const n=cA(e),s=aA(t);if(!await s._isAvailable())return!1;const r=await s._get(n)==="true";return await s._remove(n),r}async function ey(t,e){return aA(t)._set(cA(e),"true")}function kq(){Uc.clear()}function ty(t,e){Uc.set(t._key(),e)}function aA(t){return kn(t._redirectPersistence)}function cA(t){return qi(Sq,t.config.apiKey,t.name)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rq(t,e,n){return Nq(t,e,n)}async function Nq(t,e,n){const s=Nt(t);Va(t,e,hr);const r=Io(s,n);return await ey(r,s),r._openRedirect(s,e,"signInViaRedirect")}function Pq(t,e,n){return Dq(t,e,n)}async function Dq(t,e,n){const s=A(t);Va(s.auth,e,hr);const r=Io(s.auth,n);await ey(r,s.auth);const i=await lA(s);return r._openRedirect(s.auth,e,"reauthViaRedirect",i)}function xq(t,e,n){return Oq(t,e,n)}async function Oq(t,e,n){const s=A(t);Va(s.auth,e,hr);const r=Io(s.auth,n);await sf(!1,s,e.providerId),await ey(r,s.auth);const i=await lA(s);return r._openRedirect(s.auth,e,"linkViaRedirect",i)}async function Mq(t,e){return await Nt(t)._initializationPromise,hf(t,e,!1)}async function hf(t,e,n=!1){const s=Nt(t),r=Io(s,e),o=await new Cq(s,r,n).execute();return o&&!n&&(delete o.user._redirectEventId,await s._persistUserIfCurrent(o.user),await s._setRedirectUser(null,e)),o}async function lA(t){const e=ou(`${t.uid}:::`);return t._redirectEventId=e,await t.auth._setRedirectUser(t),await t.auth._persistUserIfCurrent(t),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lq=10*60*1e3;class uA{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(s=>{this.isEventForConsumer(e,s)&&(n=!0,this.sendToConsumer(e,s),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!Fq(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var s;if(e.error&&!hA(e)){const r=((s=e.error.code)===null||s===void 0?void 0:s.split("auth/")[1])||"internal-error";n.onError(qt(this.auth,r))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const s=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&s}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=Lq&&this.cachedEventUids.clear(),this.cachedEventUids.has(iI(e))}saveEventToCache(e){this.cachedEventUids.add(iI(e)),this.lastProcessedEventTime=Date.now()}}function iI(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function hA({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function Fq(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return hA(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function dA(t,e={}){return xt(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Uq=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,$q=/^https?/;async function Vq(t){if(t.config.emulator)return;const{authorizedDomains:e}=await dA(t);for(const n of e)try{if(Bq(n))return}catch{}Ht(t,"unauthorized-domain")}function Bq(t){const e=yl(),{protocol:n,hostname:s}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&s===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&o.hostname===s}if(!$q.test(n))return!1;if(Uq.test(t))return s===t;const r=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+r+"|"+r+")$","i").test(s)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qq=new ru(3e4,6e4);function oI(){const t=ft().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function jq(t){return new Promise((e,n)=>{var s,r,i;function o(){oI(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{oI(),n(qt(t,"network-request-failed"))},timeout:qq.get()})}if(!((r=(s=ft().gapi)===null||s===void 0?void 0:s.iframes)===null||r===void 0)&&r.Iframe)e(gapi.iframes.getContext());else if(!((i=ft().gapi)===null||i===void 0)&&i.load)o();else{const a=rA("iframefcb");return ft()[a]=()=>{gapi.load?o():n(qt(t,"network-request-failed"))},sA(`https://apis.google.com/js/api.js?onload=${a}`).catch(c=>n(c))}}).catch(e=>{throw mh=null,e})}let mh=null;function Kq(t){return mh=mh||jq(t),mh}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wq=new ru(5e3,15e3),Hq="__/auth/iframe",Gq="emulator/auth/iframe",zq={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},Qq=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function Yq(t){const e=t.config;D(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?K_(e,Gq):`https://${t.config.authDomain}/${Hq}`,s={apiKey:e.apiKey,appName:t.name,v:Bs},r=Qq.get(t.config.apiHost);r&&(s.eid=r);const i=t._getFrameworks();return i.length&&(s.fw=i.join(",")),`${n}?${wo(s).slice(1)}`}async function Jq(t){const e=await Kq(t),n=ft().gapi;return D(n,t,"internal-error"),e.open({where:document.body,url:Yq(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:zq,dontclear:!0},s=>new Promise(async(r,i)=>{await s.restyle({setHideOnLeave:!1});const o=qt(t,"network-request-failed"),a=ft().setTimeout(()=>{i(o)},Wq.get());function c(){ft().clearTimeout(a),r(s)}s.ping(c).then(c,()=>{i(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xq={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},Zq=500,ej=600,tj="_blank",nj="http://localhost";class aI{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function sj(t,e,n,s=Zq,r=ej){const i=Math.max((window.screen.availHeight-r)/2,0).toString(),o=Math.max((window.screen.availWidth-s)/2,0).toString();let a="";const c=Object.assign(Object.assign({},Xq),{width:s.toString(),height:r.toString(),top:i,left:o}),l=We().toLowerCase();n&&(a=D0(l)?tj:n),P0(l)&&(e=e||nj,c.scrollbars="yes");const u=Object.entries(c).reduce((d,[f,p])=>`${d}${f}=${p},`,"");if(xV(l)&&a!=="_self")return rj(e||"",a),new aI(null);const h=window.open(e||"",a,u);D(h,t,"popup-blocked");try{h.focus()}catch{}return new aI(h)}function rj(t,e){const n=document.createElement("a");n.href=t,n.target=e;const s=document.createEvent("MouseEvent");s.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(s)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ij="__/auth/handler",oj="emulator/auth/handler";function Qg(t,e,n,s,r,i){D(t.config.authDomain,t,"auth-domain-config-required"),D(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:s,v:Bs,eventId:r};if(e instanceof hr){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",xh(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[c,l]of Object.entries(i||{}))o[c]=l}if(e instanceof ja){const c=e.getScopes().filter(l=>l!=="");c.length>0&&(o.scopes=c.join(","))}t.tenantId&&(o.tid=t.tenantId);const a=o;for(const c of Object.keys(a))a[c]===void 0&&delete a[c];return`${aj(t)}?${wo(a).slice(1)}`}function aj({config:t}){return t.emulator?K_(t,oj):`https://${t.authDomain}/${ij}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Op="webStorageSupport";class cj{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Yi,this._completeRedirectFn=hf,this._overrideRedirectResult=ty}async _openPopup(e,n,s,r){var i;us((i=this.eventManagers[e._key()])===null||i===void 0?void 0:i.manager,"_initialize() not called before _openPopup()");const o=Qg(e,n,s,yl(),r);return sj(e,o,ou())}async _openRedirect(e,n,s,r){return await this._originValidation(e),qB(Qg(e,n,s,yl(),r)),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:r,promise:i}=this.eventManagers[n];return r?Promise.resolve(r):(us(i,"If manager is not set, promise should be"),i)}const s=this.initAndGetManager(e);return this.eventManagers[n]={promise:s},s.catch(()=>{delete this.eventManagers[n]}),s}async initAndGetManager(e){const n=await Jq(e),s=new uA(e);return n.register("authEvent",r=>(D(r==null?void 0:r.authEvent,e,"invalid-auth-event"),{status:s.onEvent(r.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:s},this.iframes[e._key()]=n,s}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(Op,{type:Op},r=>{var i;const o=(i=r==null?void 0:r[0])===null||i===void 0?void 0:i[Op];o!==void 0&&n(!!o),Ht(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=Vq(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return L0()||W_()||Ba()}}const lj=cj;class uj{constructor(e){this.factorId=e}_process(e,n,s){switch(n.type){case"enroll":return this._finalizeEnroll(e,n.credential,s);case"signin":return this._finalizeSignIn(e,n.credential);default:return Es("unexpected MultiFactorSessionType")}}}class ny extends uj{constructor(e){super("phone"),this.credential=e}static _fromCredential(e){return new ny(e)}_finalizeEnroll(e,n,s){return OB(e,{idToken:n,displayName:s,phoneVerificationInfo:this.credential._makeVerificationRequest()})}_finalizeSignIn(e,n){return XB(e,{mfaPendingCredential:n,phoneVerificationInfo:this.credential._makeVerificationRequest()})}}class fA{constructor(){}static assertion(e){return ny._fromCredential(e)}}fA.FACTOR_ID="phone";var cI="@firebase/auth",lI="0.20.5";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hj{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(s=>{var r;e(((r=s)===null||r===void 0?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);!n||(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){D(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dj(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";default:return}}function fj(t){nt(new Ee("auth",(e,{options:n})=>{const s=e.getProvider("app").getImmediate(),r=e.getProvider("heartbeat"),{apiKey:i,authDomain:o}=s.options;return((a,c)=>{D(i&&!i.includes(":"),"invalid-api-key",{appName:a.name}),D(!(o!=null&&o.includes(":")),"argument-error",{appName:a.name});const l={apiKey:i,authDomain:o,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:F0(t)},u=new FV(a,c,l);return gV(u,n),u})(s,r)},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,s)=>{e.getProvider("auth-internal").initialize()})),nt(new Ee("auth-internal",e=>{const n=Nt(e.getProvider("auth").getImmediate());return(s=>new hj(s))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),Le(cI,lI,dj(t)),Le(cI,lI,"esm2017")}fj("Browser");/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ji(){return window}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pj=2e3;async function gj(t,e,n){var s;const{BuildInfo:r}=Ji();us(e.sessionId,"AuthEvent did not contain a session ID");const i=await wj(e.sessionId),o={};return Ba()?o.ibi=r.packageName:iu()?o.apn=r.packageName:Ht(t,"operation-not-supported-in-this-environment"),r.displayName&&(o.appDisplayName=r.displayName),o.sessionId=i,Qg(t,n,e.type,void 0,(s=e.eventId)!==null&&s!==void 0?s:void 0,o)}async function mj(t){const{BuildInfo:e}=Ji(),n={};Ba()?n.iosBundleId=e.packageName:iu()?n.androidPackageName=e.packageName:Ht(t,"operation-not-supported-in-this-environment"),await dA(t,n)}function _j(t){const{cordova:e}=Ji();return new Promise(n=>{e.plugins.browsertab.isAvailable(s=>{let r=null;s?e.plugins.browsertab.openUrl(t):r=e.InAppBrowser.open(t,DV()?"_blank":"_system","location=yes"),n(r)})})}async function yj(t,e,n){const{cordova:s}=Ji();let r=()=>{};try{await new Promise((i,o)=>{let a=null;function c(){var h;i();const d=(h=s.plugins.browsertab)===null||h===void 0?void 0:h.close;typeof d=="function"&&d(),typeof(n==null?void 0:n.close)=="function"&&n.close()}function l(){a||(a=window.setTimeout(()=>{o(qt(t,"redirect-cancelled-by-user"))},pj))}function u(){(document==null?void 0:document.visibilityState)==="visible"&&l()}e.addPassiveListener(c),document.addEventListener("resume",l,!1),iu()&&document.addEventListener("visibilitychange",u,!1),r=()=>{e.removePassiveListener(c),document.removeEventListener("resume",l,!1),document.removeEventListener("visibilitychange",u,!1),a&&window.clearTimeout(a)}})}finally{r()}}function vj(t){var e,n,s,r,i,o,a,c,l,u;const h=Ji();D(typeof((e=h==null?void 0:h.universalLinks)===null||e===void 0?void 0:e.subscribe)=="function",t,"invalid-cordova-configuration",{missingPlugin:"cordova-universal-links-plugin-fix"}),D(typeof((n=h==null?void 0:h.BuildInfo)===null||n===void 0?void 0:n.packageName)!="undefined",t,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-buildInfo"}),D(typeof((i=(r=(s=h==null?void 0:h.cordova)===null||s===void 0?void 0:s.plugins)===null||r===void 0?void 0:r.browsertab)===null||i===void 0?void 0:i.openUrl)=="function",t,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),D(typeof((c=(a=(o=h==null?void 0:h.cordova)===null||o===void 0?void 0:o.plugins)===null||a===void 0?void 0:a.browsertab)===null||c===void 0?void 0:c.isAvailable)=="function",t,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),D(typeof((u=(l=h==null?void 0:h.cordova)===null||l===void 0?void 0:l.InAppBrowser)===null||u===void 0?void 0:u.open)=="function",t,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-inappbrowser"})}async function wj(t){const e=bj(t),n=await crypto.subtle.digest("SHA-256",e);return Array.from(new Uint8Array(n)).map(r=>r.toString(16).padStart(2,"0")).join("")}function bj(t){if(us(/[0-9a-zA-Z]+/.test(t),"Can only convert alpha-numeric strings"),typeof TextEncoder!="undefined")return new TextEncoder().encode(t);const e=new ArrayBuffer(t.length),n=new Uint8Array(e);for(let s=0;s<t.length;s++)n[s]=t.charCodeAt(s);return n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ij=20;class Ej extends uA{constructor(){super(...arguments),this.passiveListeners=new Set,this.initPromise=new Promise(e=>{this.resolveInialized=e})}addPassiveListener(e){this.passiveListeners.add(e)}removePassiveListener(e){this.passiveListeners.delete(e)}resetRedirect(){this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1}onEvent(e){return this.resolveInialized(),this.passiveListeners.forEach(n=>n(e)),super.onEvent(e)}async initialized(){await this.initPromise}}function Tj(t,e,n=null){return{type:e,eventId:n,urlResponse:null,sessionId:Aj(),postBody:null,tenantId:t.tenantId,error:qt(t,"no-auth-event")}}function Sj(t,e){return Yg()._set(Jg(t),e)}async function uI(t){const e=await Yg()._get(Jg(t));return e&&await Yg()._remove(Jg(t)),e}function Cj(t,e){var n,s;const r=Rj(e);if(r.includes("/__/auth/callback")){const i=_h(r),o=i.firebaseError?kj(decodeURIComponent(i.firebaseError)):null,a=(s=(n=o==null?void 0:o.code)===null||n===void 0?void 0:n.split("auth/"))===null||s===void 0?void 0:s[1],c=a?qt(a):null;return c?{type:t.type,eventId:t.eventId,tenantId:t.tenantId,error:c,urlResponse:null,sessionId:null,postBody:null}:{type:t.type,eventId:t.eventId,tenantId:t.tenantId,sessionId:t.sessionId,urlResponse:r,postBody:null}}return null}function Aj(){const t=[],e="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let n=0;n<Ij;n++){const s=Math.floor(Math.random()*e.length);t.push(e.charAt(s))}return t.join("")}function Yg(){return kn(Y_)}function Jg(t){return qi("authEvent",t.config.apiKey,t.name)}function kj(t){try{return JSON.parse(t)}catch{return null}}function Rj(t){const e=_h(t),n=e.link?decodeURIComponent(e.link):void 0,s=_h(n).link,r=e.deep_link_id?decodeURIComponent(e.deep_link_id):void 0;return _h(r).link||r||s||n||t}function _h(t){if(!(t!=null&&t.includes("?")))return{};const[e,...n]=t.split("?");return Ho(n.join("?"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nj=500;class Pj{constructor(){this._redirectPersistence=Yi,this._shouldInitProactively=!0,this.eventManagers=new Map,this.originValidationPromises={},this._completeRedirectFn=hf,this._overrideRedirectResult=ty}async _initialize(e){const n=e._key();let s=this.eventManagers.get(n);return s||(s=new Ej(e),this.eventManagers.set(n,s),this.attachCallbackListeners(e,s)),s}_openPopup(e){Ht(e,"operation-not-supported-in-this-environment")}async _openRedirect(e,n,s,r){vj(e);const i=await this._initialize(e);await i.initialized(),i.resetRedirect(),kq(),await this._originValidation(e);const o=Tj(e,s,r);await Sj(e,o);const a=await gj(e,o,n),c=await _j(a);return yj(e,i,c)}_isIframeWebStorageSupported(e,n){throw new Error("Method not implemented.")}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=mj(e)),this.originValidationPromises[n]}attachCallbackListeners(e,n){const{universalLinks:s,handleOpenURL:r,BuildInfo:i}=Ji(),o=setTimeout(async()=>{await uI(e),n.onEvent(hI())},Nj),a=async u=>{clearTimeout(o);const h=await uI(e);let d=null;h&&(u==null?void 0:u.url)&&(d=Cj(h,u.url)),n.onEvent(d||hI())};typeof s!="undefined"&&typeof s.subscribe=="function"&&s.subscribe(null,a);const c=r,l=`${i.packageName.toLowerCase()}://`;Ji().handleOpenURL=async u=>{if(u.toLowerCase().startsWith(l)&&a({url:u}),typeof c=="function")try{c(u)}catch(h){console.error(h)}}}}const Dj=Pj;function hI(){return{type:"unknown",eventId:null,sessionId:null,urlResponse:null,postBody:null,tenantId:null,error:qt("no-auth-event")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xj(t,e){Nt(t)._logFramework(e)}var Oj="@firebase/auth-compat",Mj="0.2.18";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lj=1e3;function $c(){var t;return((t=self==null?void 0:self.location)===null||t===void 0?void 0:t.protocol)||null}function Fj(){return $c()==="http:"||$c()==="https:"}function pA(t=We()){return!!(($c()==="file:"||$c()==="ionic:"||$c()==="capacitor:")&&t.toLowerCase().match(/iphone|ipad|ipod|android/))}function Uj(){return tu()||C_()}function $j(){return A_()&&(document==null?void 0:document.documentMode)===11}function Vj(t=We()){return/Edge\/\d+/.test(t)}function Bj(t=We()){return $j()||Vj(t)}function gA(){try{const t=self.localStorage,e=ou();if(t)return t.setItem(e,"1"),t.removeItem(e),Bj()?bn():!0}catch{return sy()&&bn()}return!1}function sy(){return typeof global!="undefined"&&"WorkerGlobalScope"in global&&"importScripts"in global}function Mp(){return(Fj()||eu()||pA())&&!Uj()&&gA()&&!sy()}function mA(){return pA()&&typeof document!="undefined"}async function qj(){return mA()?new Promise(t=>{const e=setTimeout(()=>{t(!1)},Lj);document.addEventListener("deviceready",()=>{clearTimeout(e),t(!0)})}):!1}function jj(){return typeof window!="undefined"?window:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sn={LOCAL:"local",NONE:"none",SESSION:"session"},lc=D,_A="persistence";function Kj(t,e){if(lc(Object.values(Sn).includes(e),t,"invalid-persistence-type"),tu()){lc(e!==Sn.SESSION,t,"unsupported-persistence-type");return}if(C_()){lc(e===Sn.NONE,t,"unsupported-persistence-type");return}if(sy()){lc(e===Sn.NONE||e===Sn.LOCAL&&bn(),t,"unsupported-persistence-type");return}lc(e===Sn.NONE||gA(),t,"unsupported-persistence-type")}async function Xg(t){await t._initializationPromise;const e=yA(),n=qi(_A,t.config.apiKey,t.name);e&&e.setItem(n,t._getPersistence())}function Wj(t,e){const n=yA();if(!n)return[];const s=qi(_A,t,e);switch(n.getItem(s)){case Sn.NONE:return[ga];case Sn.LOCAL:return[Il,Yi];case Sn.SESSION:return[Yi];default:return[]}}function yA(){var t;try{return((t=jj())===null||t===void 0?void 0:t.sessionStorage)||null}catch{return null}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hj=D;class Nr{constructor(){this.browserResolver=kn(lj),this.cordovaResolver=kn(Dj),this.underlyingResolver=null,this._redirectPersistence=Yi,this._completeRedirectFn=hf,this._overrideRedirectResult=ty}async _initialize(e){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._initialize(e)}async _openPopup(e,n,s,r){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._openPopup(e,n,s,r)}async _openRedirect(e,n,s,r){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._openRedirect(e,n,s,r)}_isIframeWebStorageSupported(e,n){this.assertedUnderlyingResolver._isIframeWebStorageSupported(e,n)}_originValidation(e){return this.assertedUnderlyingResolver._originValidation(e)}get _shouldInitProactively(){return mA()||this.browserResolver._shouldInitProactively}get assertedUnderlyingResolver(){return Hj(this.underlyingResolver,"internal-error"),this.underlyingResolver}async selectUnderlyingResolver(){if(this.underlyingResolver)return;const e=await qj();this.underlyingResolver=e?this.cordovaResolver:this.browserResolver}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vA(t){return t.unwrap()}function Gj(t){return t.wrapped()}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zj(t){return wA(t)}function Qj(t,e){var n,s;const r=(n=e.customData)===null||n===void 0?void 0:n._tokenResponse;if(((s=e)===null||s===void 0?void 0:s.code)==="auth/multi-factor-auth-required"){const i=e;i.resolver=new Yj(t,DB(t,e))}else if(r){const i=wA(e),o=e;i&&(o.credential=i,o.tenantId=r.tenantId||void 0,o.email=r.email||void 0,o.phoneNumber=r.phoneNumber||void 0)}}function wA(t){const{_tokenResponse:e}=t instanceof ct?t.customData:t;if(!e)return null;if(!(t instanceof ct)&&"temporaryProof"in e&&"phoneNumber"in e)return as.credentialFromResult(t);const n=e.providerId;if(!n||n===cc.PASSWORD)return null;let s;switch(n){case cc.GOOGLE:s=vs;break;case cc.FACEBOOK:s=ys;break;case cc.GITHUB:s=ws;break;case cc.TWITTER:s=bs;break;default:const{oauthIdToken:r,oauthAccessToken:i,oauthTokenSecret:o,pendingToken:a,nonce:c}=e;return!i&&!o&&!r&&!a?null:a?n.startsWith("saml.")?ma._create(n,a):xs._fromParams({providerId:n,signInMethod:n,pendingToken:a,idToken:r,accessToken:i}):new Zo(n).credential({idToken:r,accessToken:i,rawNonce:c})}return t instanceof ct?s.credentialFromError(t):s.credentialFromResult(t)}function pn(t,e){return e.catch(n=>{throw n instanceof ct&&Qj(t,n),n}).then(n=>{const s=n.operationType,r=n.user;return{operationType:s,credential:zj(n),additionalUserInfo:PB(n),user:Qs.getOrCreate(r)}})}async function Zg(t,e){const n=await e;return{verificationId:n.verificationId,confirm:s=>pn(t,n.confirm(s))}}class Yj{constructor(e,n){this.resolver=n,this.auth=Gj(e)}get session(){return this.resolver.session}get hints(){return this.resolver.hints}resolveSignIn(e){return pn(vA(this.auth),this.resolver.resolveSignIn(e))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qs{constructor(e){this._delegate=e,this.multiFactor=LB(e)}static getOrCreate(e){return Qs.USER_MAP.has(e)||Qs.USER_MAP.set(e,new Qs(e)),Qs.USER_MAP.get(e)}delete(){return this._delegate.delete()}reload(){return this._delegate.reload()}toJSON(){return this._delegate.toJSON()}getIdTokenResult(e){return this._delegate.getIdTokenResult(e)}getIdToken(e){return this._delegate.getIdToken(e)}linkAndRetrieveDataWithCredential(e){return this.linkWithCredential(e)}async linkWithCredential(e){return pn(this.auth,H0(this._delegate,e))}async linkWithPhoneNumber(e,n){return Zg(this.auth,gq(this._delegate,e,n))}async linkWithPopup(e){return pn(this.auth,Tq(this._delegate,e,Nr))}async linkWithRedirect(e){return await Xg(Nt(this.auth)),xq(this._delegate,e,Nr)}reauthenticateAndRetrieveDataWithCredential(e){return this.reauthenticateWithCredential(e)}async reauthenticateWithCredential(e){return pn(this.auth,G0(this._delegate,e))}reauthenticateWithPhoneNumber(e,n){return Zg(this.auth,mq(this._delegate,e,n))}reauthenticateWithPopup(e){return pn(this.auth,Eq(this._delegate,e,Nr))}async reauthenticateWithRedirect(e){return await Xg(Nt(this.auth)),Pq(this._delegate,e,Nr)}sendEmailVerification(e){return wB(this._delegate,e)}async unlink(e){return await oB(this._delegate,e),this}updateEmail(e){return TB(this._delegate,e)}updatePassword(e){return SB(this._delegate,e)}updatePhoneNumber(e){return _q(this._delegate,e)}updateProfile(e){return EB(this._delegate,e)}verifyBeforeUpdateEmail(e,n){return bB(this._delegate,e,n)}get emailVerified(){return this._delegate.emailVerified}get isAnonymous(){return this._delegate.isAnonymous}get metadata(){return this._delegate.metadata}get phoneNumber(){return this._delegate.phoneNumber}get providerData(){return this._delegate.providerData}get refreshToken(){return this._delegate.refreshToken}get tenantId(){return this._delegate.tenantId}get displayName(){return this._delegate.displayName}get email(){return this._delegate.email}get photoURL(){return this._delegate.photoURL}get providerId(){return this._delegate.providerId}get uid(){return this._delegate.uid}get auth(){return this._delegate.auth}}Qs.USER_MAP=new WeakMap;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uc=D;class em{constructor(e,n){if(this.app=e,n.isInitialized()){this._delegate=n.getImmediate(),this.linkUnderlyingAuth();return}const{apiKey:s}=e.options;uc(s,"invalid-api-key",{appName:e.name}),uc(s,"invalid-api-key",{appName:e.name});const r=typeof window!="undefined"?Nr:void 0;this._delegate=n.initialize({options:{persistence:Jj(s,e.name),popupRedirectResolver:r}}),this._delegate._updateErrorMap(fV),this.linkUnderlyingAuth()}get emulatorConfig(){return this._delegate.emulatorConfig}get currentUser(){return this._delegate.currentUser?Qs.getOrCreate(this._delegate.currentUser):null}get languageCode(){return this._delegate.languageCode}set languageCode(e){this._delegate.languageCode=e}get settings(){return this._delegate.settings}get tenantId(){return this._delegate.tenantId}set tenantId(e){this._delegate.tenantId=e}useDeviceLanguage(){this._delegate.useDeviceLanguage()}signOut(){return this._delegate.signOut()}useEmulator(e,n){UV(this._delegate,e,n)}applyActionCode(e){return hB(this._delegate,e)}checkActionCode(e){return z0(this._delegate,e)}confirmPasswordReset(e,n){return uB(this._delegate,e,n)}async createUserWithEmailAndPassword(e,n){return pn(this._delegate,fB(this._delegate,e,n))}fetchProvidersForEmail(e){return this.fetchSignInMethodsForEmail(e)}fetchSignInMethodsForEmail(e){return vB(this._delegate,e)}isSignInWithEmailLink(e){return mB(this._delegate,e)}async getRedirectResult(){uc(Mp(),this._delegate,"operation-not-supported-in-this-environment");const e=await Mq(this._delegate,Nr);return e?pn(this._delegate,Promise.resolve(e)):{credential:null,user:null}}addFrameworkForLogging(e){xj(this._delegate,e)}onAuthStateChanged(e,n,s){const{next:r,error:i,complete:o}=dI(e,n,s);return this._delegate.onAuthStateChanged(r,i,o)}onIdTokenChanged(e,n,s){const{next:r,error:i,complete:o}=dI(e,n,s);return this._delegate.onIdTokenChanged(r,i,o)}sendSignInLinkToEmail(e,n){return gB(this._delegate,e,n)}sendPasswordResetEmail(e,n){return lB(this._delegate,e,n||void 0)}async setPersistence(e){Kj(this._delegate,e);let n;switch(e){case Sn.SESSION:n=Yi;break;case Sn.LOCAL:n=await kn(Il)._isAvailable()?Il:Y_;break;case Sn.NONE:n=ga;break;default:return Ht("argument-error",{appName:this._delegate.name})}return this._delegate.setPersistence(n)}signInAndRetrieveDataWithCredential(e){return this.signInWithCredential(e)}signInAnonymously(){return pn(this._delegate,iB(this._delegate))}signInWithCredential(e){return pn(this._delegate,rf(this._delegate,e))}signInWithCustomToken(e){return pn(this._delegate,cB(this._delegate,e))}signInWithEmailAndPassword(e,n){return pn(this._delegate,pB(this._delegate,e,n))}signInWithEmailLink(e,n){return pn(this._delegate,_B(this._delegate,e,n))}signInWithPhoneNumber(e,n){return Zg(this._delegate,pq(this._delegate,e,n))}async signInWithPopup(e){return uc(Mp(),this._delegate,"operation-not-supported-in-this-environment"),pn(this._delegate,Iq(this._delegate,e,Nr))}async signInWithRedirect(e){return uc(Mp(),this._delegate,"operation-not-supported-in-this-environment"),await Xg(this._delegate),Rq(this._delegate,e,Nr)}updateCurrentUser(e){return this._delegate.updateCurrentUser(e)}verifyPasswordResetCode(e){return dB(this._delegate,e)}unwrap(){return this._delegate}_delete(){return this._delegate._delete()}linkUnderlyingAuth(){this._delegate.wrapped=()=>this}}em.Persistence=Sn;function dI(t,e,n){let s=t;typeof t!="function"&&({next:s,error:e,complete:n}=t);const r=s;return{next:o=>r(o&&Qs.getOrCreate(o)),error:e,complete:n}}function Jj(t,e){const n=Wj(t,e);if(typeof self!="undefined"&&!n.includes(Il)&&n.push(Il),typeof window!="undefined")for(const s of[Y_,Yi])n.includes(s)||n.push(s);return n.includes(ga)||n.push(ga),n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ry{constructor(){this.providerId="phone",this._delegate=new as(vA(lt.auth()))}static credential(e,n){return as.credential(e,n)}verifyPhoneNumber(e,n){return this._delegate.verifyPhoneNumber(e,n)}unwrap(){return this._delegate}}ry.PHONE_SIGN_IN_METHOD=as.PHONE_SIGN_IN_METHOD;ry.PROVIDER_ID=as.PROVIDER_ID;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xj=D;class Zj{constructor(e,n,s=lt.app()){var r;Xj((r=s.options)===null||r===void 0?void 0:r.apiKey,"invalid-api-key",{appName:s.name}),this._delegate=new dq(e,n,s.auth()),this.type=this._delegate.type}clear(){this._delegate.clear()}render(){return this._delegate.render()}verify(){return this._delegate.verify()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eK="auth-compat";function tK(t){t.INTERNAL.registerComponent(new Ee(eK,e=>{const n=e.getProvider("app-compat").getImmediate(),s=e.getProvider("auth");return new em(n,s)},"PUBLIC").setServiceProps({ActionCodeInfo:{Operation:{EMAIL_SIGNIN:Mo.EMAIL_SIGNIN,PASSWORD_RESET:Mo.PASSWORD_RESET,RECOVER_EMAIL:Mo.RECOVER_EMAIL,REVERT_SECOND_FACTOR_ADDITION:Mo.REVERT_SECOND_FACTOR_ADDITION,VERIFY_AND_CHANGE_EMAIL:Mo.VERIFY_AND_CHANGE_EMAIL,VERIFY_EMAIL:Mo.VERIFY_EMAIL}},EmailAuthProvider:ri,FacebookAuthProvider:ys,GithubAuthProvider:ws,GoogleAuthProvider:vs,OAuthProvider:Zo,SAMLAuthProvider:qh,PhoneAuthProvider:ry,PhoneMultiFactorGenerator:fA,RecaptchaVerifier:Zj,TwitterAuthProvider:bs,Auth:em,AuthCredential:qa,Error:ct}).setInstantiationMode("LAZY").setMultipleInstances(!1)),t.registerVersion(Oj,Mj)}tK(lt);const fI="@firebase/database",pI="0.13.3";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let bA="";function IA(t){bA=t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nK{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,n){n==null?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),gt(n))}get(e){const n=this.domStorage_.getItem(this.prefixedName_(e));return n==null?null:hl(n)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sK{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,n){n==null?delete this.cache_[e]:this.cache_[e]=n}get(e){return Dn(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const EA=function(t){try{if(typeof window!="undefined"&&typeof window[t]!="undefined"){const e=window[t];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new nK(e)}}catch{}return new sK},Oi=EA("localStorage"),tm=EA("sessionStorage");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ta=new Vs("@firebase/database"),TA=function(){let t=1;return function(){return t++}}(),SA=function(t){const e=TL(t),n=new bL;n.update(e);const s=n.digest();return Hd.encodeByteArray(s)},cu=function(...t){let e="";for(let n=0;n<t.length;n++){const s=t[n];Array.isArray(s)||s&&typeof s=="object"&&typeof s.length=="number"?e+=cu.apply(null,s):typeof s=="object"?e+=gt(s):e+=s,e+=" "}return e};let Ki=null,gI=!0;const CA=function(t,e){x(!e||t===!0||t===!1,"Can't turn on custom loggers persistently."),t===!0?(ta.logLevel=de.VERBOSE,Ki=ta.log.bind(ta),e&&tm.set("logging_enabled",!0)):typeof t=="function"?Ki=t:(Ki=null,tm.remove("logging_enabled"))},Et=function(...t){if(gI===!0&&(gI=!1,Ki===null&&tm.get("logging_enabled")===!0&&CA(!0)),Ki){const e=cu.apply(null,t);Ki(e)}},lu=function(t){return function(...e){Et(t,...e)}},nm=function(...t){const e="FIREBASE INTERNAL ERROR: "+cu(...t);ta.error(e)},Os=function(...t){const e=`FIREBASE FATAL ERROR: ${cu(...t)}`;throw ta.error(e),new Error(e)},Yt=function(...t){const e="FIREBASE WARNING: "+cu(...t);ta.warn(e)},rK=function(){typeof window!="undefined"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&Yt("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},df=function(t){return typeof t=="number"&&(t!==t||t===Number.POSITIVE_INFINITY||t===Number.NEGATIVE_INFINITY)},iK=function(t){if(document.readyState==="complete")t();else{let e=!1;const n=function(){if(!document.body){setTimeout(n,Math.floor(10));return}e||(e=!0,t())};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&n()}),window.attachEvent("onload",n))}},ir="[MIN_NAME]",Ms="[MAX_NAME]",Eo=function(t,e){if(t===e)return 0;if(t===ir||e===Ms)return-1;if(e===ir||t===Ms)return 1;{const n=Hh(t),s=Hh(e);return n!==null?s!==null?n-s===0?t.length-e.length:n-s:-1:s!==null?1:t<e?-1:1}},oK=function(t,e){return t===e?0:t<e?-1:1},hc=function(t,e){if(e&&t in e)return e[t];throw new Error("Missing required key ("+t+") in object: "+gt(e))},iy=function(t){if(typeof t!="object"||t===null)return gt(t);const e=[];for(const s in t)e.push(s);e.sort();let n="{";for(let s=0;s<e.length;s++)s!==0&&(n+=","),n+=gt(e[s]),n+=":",n+=iy(t[e[s]]);return n+="}",n},AA=function(t,e){const n=t.length;if(n<=e)return[t];const s=[];for(let r=0;r<n;r+=e)r+e>n?s.push(t.substring(r,n)):s.push(t.substring(r,r+e));return s};function Pt(t,e){for(const n in t)t.hasOwnProperty(n)&&e(n,t[n])}const kA=function(t){x(!df(t),"Invalid JSON number");const e=11,n=52,s=(1<<e-1)-1;let r,i,o,a,c;t===0?(i=0,o=0,r=1/t===-1/0?1:0):(r=t<0,t=Math.abs(t),t>=Math.pow(2,1-s)?(a=Math.min(Math.floor(Math.log(t)/Math.LN2),s),i=a+s,o=Math.round(t*Math.pow(2,n-a)-Math.pow(2,n))):(i=0,o=Math.round(t/Math.pow(2,1-s-n))));const l=[];for(c=n;c;c-=1)l.push(o%2?1:0),o=Math.floor(o/2);for(c=e;c;c-=1)l.push(i%2?1:0),i=Math.floor(i/2);l.push(r?1:0),l.reverse();const u=l.join("");let h="";for(c=0;c<64;c+=8){let d=parseInt(u.substr(c,8),2).toString(16);d.length===1&&(d="0"+d),h=h+d}return h.toLowerCase()},aK=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},cK=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};function lK(t,e){let n="Unknown Error";t==="too_big"?n="The data requested exceeds the maximum size that can be accessed with a single request.":t==="permission_denied"?n="Client doesn't have permission to access the desired data.":t==="unavailable"&&(n="The service is unavailable");const s=new Error(t+" at "+e._path.toString()+": "+n);return s.code=t.toUpperCase(),s}const uK=new RegExp("^-?(0*)\\d{1,10}$"),RA=-2147483648,oy=2147483647,Hh=function(t){if(uK.test(t)){const e=Number(t);if(e>=RA&&e<=oy)return e}return null},Ka=function(t){try{t()}catch(e){setTimeout(()=>{const n=e.stack||"";throw Yt("Exception was thrown by user callback.",n),e},Math.floor(0))}},hK=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},Vc=function(t,e){const n=setTimeout(t,e);return typeof n=="object"&&n.unref&&n.unref(),n};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dK{constructor(e,n){this.appName_=e,this.appCheckProvider=n,this.appCheck=n==null?void 0:n.getImmediate({optional:!0}),this.appCheck||n==null||n.get().then(s=>this.appCheck=s)}getToken(e){return this.appCheck?this.appCheck.getToken(e):new Promise((n,s)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(n,s):n(null)},0)})}addTokenChangeListener(e){var n;(n=this.appCheckProvider)===null||n===void 0||n.get().then(s=>s.addTokenListener(e))}notifyForInvalidToken(){Yt(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fK{constructor(e,n,s){this.appName_=e,this.firebaseOptions_=n,this.authProvider_=s,this.auth_=null,this.auth_=s.getImmediate({optional:!0}),this.auth_||s.onInit(r=>this.auth_=r)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(n=>n&&n.code==="auth/token-not-initialized"?(Et("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(n)):new Promise((n,s)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(n,s):n(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(n=>n.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(n=>n.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',Yt(e)}}class na{constructor(e){this.accessToken=e}getToken(e){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(e){e(this.accessToken)}removeTokenChangeListener(e){}notifyForInvalidToken(){}}na.OWNER="owner";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ay="5",NA="v",PA="s",DA="r",xA="f",OA=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,MA="ls",LA="p",sm="ac",FA="websocket",UA="long_polling";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $A{constructor(e,n,s,r,i=!1,o="",a=!1){this.secure=n,this.namespace=s,this.webSocketOnly=r,this.nodeAdmin=i,this.persistenceKey=o,this.includeNamespaceInQueryParams=a,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=Oi.get("host:"+e)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&Oi.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){const e=this.secure?"https://":"http://",n=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${n}`}}function pK(t){return t.host!==t.internalHost||t.isCustomHost()||t.includeNamespaceInQueryParams}function VA(t,e,n){x(typeof e=="string","typeof type must == string"),x(typeof n=="object","typeof params must == object");let s;if(e===FA)s=(t.secure?"wss://":"ws://")+t.internalHost+"/.ws?";else if(e===UA)s=(t.secure?"https://":"http://")+t.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+e);pK(t)&&(n.ns=t.namespace);const r=[];return Pt(n,(i,o)=>{r.push(i+"="+o)}),s+r.join("&")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gK{constructor(){this.counters_={}}incrementCounter(e,n=1){Dn(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=n}get(){return cL(this.counters_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lp={},Fp={};function cy(t){const e=t.toString();return Lp[e]||(Lp[e]=new gK),Lp[e]}function mK(t,e){const n=t.toString();return Fp[n]||(Fp[n]=e()),Fp[n]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _K{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,n){this.closeAfterResponse=e,this.onClose=n,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,n){for(this.pendingResponses[e]=n;this.pendingResponses[this.currentResponseNum];){const s=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let r=0;r<s.length;++r)s[r]&&Ka(()=>{this.onMessage_(s[r])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mI="start",yK="close",vK="pLPCommand",wK="pRTLPCB",BA="id",qA="pw",jA="ser",bK="cb",IK="seg",EK="ts",TK="d",SK="dframe",KA=1870,WA=30,CK=KA-WA,AK=25e3,kK=3e4;class Pr{constructor(e,n,s,r,i,o,a){this.connId=e,this.repoInfo=n,this.applicationId=s,this.appCheckToken=r,this.authToken=i,this.transportSessionId=o,this.lastSessionId=a,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=lu(e),this.stats_=cy(n),this.urlFn=c=>(this.appCheckToken&&(c[sm]=this.appCheckToken),VA(n,UA,c))}open(e,n){this.curSegmentNum=0,this.onDisconnect_=n,this.myPacketOrderer=new _K(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(kK)),iK(()=>{if(this.isClosed_)return;this.scriptTagHolder=new ly((...i)=>{const[o,a,c,l,u]=i;if(this.incrementIncomingBytes_(i),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,o===mI)this.id=a,this.password=c;else if(o===yK)a?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(a,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+o)},(...i)=>{const[o,a]=i;this.incrementIncomingBytes_(i),this.myPacketOrderer.handleResponse(o,a)},()=>{this.onClosed_()},this.urlFn);const s={};s[mI]="t",s[jA]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(s[bK]=this.scriptTagHolder.uniqueCallbackIdentifier),s[NA]=ay,this.transportSessionId&&(s[PA]=this.transportSessionId),this.lastSessionId&&(s[MA]=this.lastSessionId),this.applicationId&&(s[LA]=this.applicationId),this.appCheckToken&&(s[sm]=this.appCheckToken),typeof location!="undefined"&&location.hostname&&OA.test(location.hostname)&&(s[DA]=xA);const r=this.urlFn(s);this.log_("Connecting via long-poll to "+r),this.scriptTagHolder.addTag(r,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){Pr.forceAllow_=!0}static forceDisallow(){Pr.forceDisallow_=!0}static isAvailable(){return Pr.forceAllow_?!0:!Pr.forceDisallow_&&typeof document!="undefined"&&document.createElement!=null&&!aK()&&!cK()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){const n=gt(e);this.bytesSent+=n.length,this.stats_.incrementCounter("bytes_sent",n.length);const s=bC(n),r=AA(s,CK);for(let i=0;i<r.length;i++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,r.length,r[i]),this.curSegmentNum++}addDisconnectPingFrame(e,n){this.myDisconnFrame=document.createElement("iframe");const s={};s[SK]="t",s[BA]=e,s[qA]=n,this.myDisconnFrame.src=this.urlFn(s),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){const n=gt(e).length;this.bytesReceived+=n,this.stats_.incrementCounter("bytes_received",n)}}class ly{constructor(e,n,s,r){this.onDisconnect=s,this.urlFn=r,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0;{this.uniqueCallbackIdentifier=TA(),window[vK+this.uniqueCallbackIdentifier]=e,window[wK+this.uniqueCallbackIdentifier]=n,this.myIFrame=ly.createIFrame_();let i="";if(this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"){const a=document.domain;i='<script>document.domain="'+a+'";<\/script>'}const o="<html><body>"+i+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(o),this.myIFrame.doc.close()}catch(a){Et("frame writing exception"),a.stack&&Et(a.stack),Et(a)}}}static createIFrame_(){const e=document.createElement("iframe");if(e.style.display="none",document.body){document.body.appendChild(e);try{e.contentWindow.document||Et("No IE domain setting required")}catch{const s=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+s+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.innerHTML="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));const e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,n){for(this.myID=e,this.myPW=n,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const e={};e[BA]=this.myID,e[qA]=this.myPW,e[jA]=this.currentSerial;let n=this.urlFn(e),s="",r=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+WA+s.length<=KA;){const o=this.pendingSegs.shift();s=s+"&"+IK+r+"="+o.seg+"&"+EK+r+"="+o.ts+"&"+TK+r+"="+o.d,r++}return n=n+s,this.addLongPollTag_(n,this.currentSerial),!0}else return!1}enqueueSegment(e,n,s){this.pendingSegs.push({seg:e,ts:n,d:s}),this.alive&&this.newRequest_()}addLongPollTag_(e,n){this.outstandingRequests.add(n);const s=()=>{this.outstandingRequests.delete(n),this.newRequest_()},r=setTimeout(s,Math.floor(AK)),i=()=>{clearTimeout(r),s()};this.addTag(e,i)}addTag(e,n){setTimeout(()=>{try{if(!this.sendNewPolls)return;const s=this.myIFrame.doc.createElement("script");s.type="text/javascript",s.async=!0,s.src=e,s.onload=s.onreadystatechange=function(){const r=s.readyState;(!r||r==="loaded"||r==="complete")&&(s.onload=s.onreadystatechange=null,s.parentNode&&s.parentNode.removeChild(s),n())},s.onerror=()=>{Et("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(s)}catch{}},Math.floor(1))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RK=16384,NK=45e3;let Gh=null;typeof MozWebSocket!="undefined"?Gh=MozWebSocket:typeof WebSocket!="undefined"&&(Gh=WebSocket);class Fn{constructor(e,n,s,r,i,o,a){this.connId=e,this.applicationId=s,this.appCheckToken=r,this.authToken=i,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=lu(this.connId),this.stats_=cy(n),this.connURL=Fn.connectionURL_(n,o,a,r,s),this.nodeAdmin=n.nodeAdmin}static connectionURL_(e,n,s,r,i){const o={};return o[NA]=ay,typeof location!="undefined"&&location.hostname&&OA.test(location.hostname)&&(o[DA]=xA),n&&(o[PA]=n),s&&(o[MA]=s),r&&(o[sm]=r),i&&(o[LA]=i),VA(e,FA,o)}open(e,n){this.onDisconnect=n,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,Oi.set("previous_websocket_failure",!0);try{let s;IC(),this.mySock=new Gh(this.connURL,[],s)}catch(s){this.log_("Error instantiating WebSocket.");const r=s.message||s.data;r&&this.log_(r),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=s=>{this.handleIncomingFrame(s)},this.mySock.onerror=s=>{this.log_("WebSocket error.  Closing connection.");const r=s.message||s.data;r&&this.log_(r),this.onClosed_()}}start(){}static forceDisallow(){Fn.forceDisallow_=!0}static isAvailable(){let e=!1;if(typeof navigator!="undefined"&&navigator.userAgent){const n=/Android ([0-9]{0,}\.[0-9]{0,})/,s=navigator.userAgent.match(n);s&&s.length>1&&parseFloat(s[1])<4.4&&(e=!0)}return!e&&Gh!==null&&!Fn.forceDisallow_}static previouslyFailed(){return Oi.isInMemoryStorage||Oi.get("previous_websocket_failure")===!0}markConnectionHealthy(){Oi.remove("previous_websocket_failure")}appendFrame_(e){if(this.frames.push(e),this.frames.length===this.totalFrames){const n=this.frames.join("");this.frames=null;const s=hl(n);this.onMessage(s)}}handleNewFrameCount_(e){this.totalFrames=e,this.frames=[]}extractFrameCount_(e){if(x(this.frames===null,"We already have a frame buffer"),e.length<=6){const n=Number(e);if(!isNaN(n))return this.handleNewFrameCount_(n),null}return this.handleNewFrameCount_(1),e}handleIncomingFrame(e){if(this.mySock===null)return;const n=e.data;if(this.bytesReceived+=n.length,this.stats_.incrementCounter("bytes_received",n.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(n);else{const s=this.extractFrameCount_(n);s!==null&&this.appendFrame_(s)}}send(e){this.resetKeepAlive();const n=gt(e);this.bytesSent+=n.length,this.stats_.incrementCounter("bytes_sent",n.length);const s=AA(n,RK);s.length>1&&this.sendString_(String(s.length));for(let r=0;r<s.length;r++)this.sendString_(s[r])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(NK))}sendString_(e){try{this.mySock.send(e)}catch(n){this.log_("Exception thrown from WebSocket.send():",n.message||n.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}Fn.responsesRequiredToBeHealthy=2;Fn.healthyTimeout=3e4;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _a{constructor(e){this.initTransports_(e)}static get ALL_TRANSPORTS(){return[Pr,Fn]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(e){const n=Fn&&Fn.isAvailable();let s=n&&!Fn.previouslyFailed();if(e.webSocketOnly&&(n||Yt("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),s=!0),s)this.transports_=[Fn];else{const r=this.transports_=[];for(const i of _a.ALL_TRANSPORTS)i&&i.isAvailable()&&r.push(i);_a.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}_a.globalTransportInitialized_=!1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PK=6e4,DK=5e3,xK=10*1024,OK=100*1024,Up="t",_I="d",MK="s",yI="r",LK="e",vI="o",wI="a",bI="n",II="p",FK="h";class UK{constructor(e,n,s,r,i,o,a,c,l,u){this.id=e,this.repoInfo_=n,this.applicationId_=s,this.appCheckToken_=r,this.authToken_=i,this.onMessage_=o,this.onReady_=a,this.onDisconnect_=c,this.onKill_=l,this.lastSessionId=u,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=lu("c:"+this.id+":"),this.transportManager_=new _a(n),this.log_("Connection created"),this.start_()}start_(){const e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const n=this.connReceiver_(this.conn_),s=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(n,s)},Math.floor(0));const r=e.healthyTimeout||0;r>0&&(this.healthyTimeout_=Vc(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>OK?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>xK?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(r)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return n=>{e===this.conn_?this.onConnectionLost_(n):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return n=>{this.state_!==2&&(e===this.rx_?this.onPrimaryMessageReceived_(n):e===this.secondaryConn_?this.onSecondaryMessageReceived_(n):this.log_("message on old connection"))}}sendRequest(e){const n={t:"d",d:e};this.sendData_(n)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if(Up in e){const n=e[Up];n===wI?this.upgradeIfSecondaryHealthy_():n===yI?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):n===vI&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){const n=hc("t",e),s=hc("d",e);if(n==="c")this.onSecondaryControl_(s);else if(n==="d")this.pendingDataMessages.push(s);else throw new Error("Unknown protocol layer: "+n)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:II,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:wI,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:bI,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){const n=hc("t",e),s=hc("d",e);n==="c"?this.onControl_(s):n==="d"&&this.onDataMessage_(s)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){const n=hc(Up,e);if(_I in e){const s=e[_I];if(n===FK)this.onHandshake_(s);else if(n===bI){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let r=0;r<this.pendingDataMessages.length;++r)this.onDataMessage_(this.pendingDataMessages[r]);this.pendingDataMessages=[],this.tryCleanupConnection()}else n===MK?this.onConnectionShutdown_(s):n===yI?this.onReset_(s):n===LK?nm("Server Error: "+s):n===vI?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):nm("Unknown control packet command: "+n)}}onHandshake_(e){const n=e.ts,s=e.v,r=e.h;this.sessionId=e.s,this.repoInfo_.host=r,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,n),ay!==s&&Yt("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const n=this.connReceiver_(this.secondaryConn_),s=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(n,s),Vc(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(PK))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,n){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(n,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):Vc(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(DK))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:II,d:{}}}))}onSecondaryConnectionLost_(){const e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,!e&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(Oi.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(e)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HA{put(e,n,s,r){}merge(e,n,s,r){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,n,s){}onDisconnectMerge(e,n,s){}onDisconnectCancel(e,n){}reportStats(e){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GA{constructor(e){this.allowedEvents_=e,this.listeners_={},x(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...n){if(Array.isArray(this.listeners_[e])){const s=[...this.listeners_[e]];for(let r=0;r<s.length;r++)s[r].callback.apply(s[r].context,n)}}on(e,n,s){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:n,context:s});const r=this.getInitialEvent(e);r&&n.apply(s,r)}off(e,n,s){this.validateEventType_(e);const r=this.listeners_[e]||[];for(let i=0;i<r.length;i++)if(r[i].callback===n&&(!s||s===r[i].context)){r.splice(i,1);return}}validateEventType_(e){x(this.allowedEvents_.find(n=>n===e),"Unknown event: "+e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zh extends GA{constructor(){super(["online"]),this.online_=!0,typeof window!="undefined"&&typeof window.addEventListener!="undefined"&&!Gd()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}static getInstance(){return new zh}getInitialEvent(e){return x(e==="online","Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const EI=32,TI=768;class Ce{constructor(e,n){if(n===void 0){this.pieces_=e.split("/");let s=0;for(let r=0;r<this.pieces_.length;r++)this.pieces_[r].length>0&&(this.pieces_[s]=this.pieces_[r],s++);this.pieces_.length=s,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=n}toString(){let e="";for(let n=this.pieceNum_;n<this.pieces_.length;n++)this.pieces_[n]!==""&&(e+="/"+this.pieces_[n]);return e||"/"}}function Te(){return new Ce("")}function fe(t){return t.pieceNum_>=t.pieces_.length?null:t.pieces_[t.pieceNum_]}function Gr(t){return t.pieces_.length-t.pieceNum_}function Me(t){let e=t.pieceNum_;return e<t.pieces_.length&&e++,new Ce(t.pieces_,e)}function uy(t){return t.pieceNum_<t.pieces_.length?t.pieces_[t.pieces_.length-1]:null}function $K(t){let e="";for(let n=t.pieceNum_;n<t.pieces_.length;n++)t.pieces_[n]!==""&&(e+="/"+encodeURIComponent(String(t.pieces_[n])));return e||"/"}function El(t,e=0){return t.pieces_.slice(t.pieceNum_+e)}function zA(t){if(t.pieceNum_>=t.pieces_.length)return null;const e=[];for(let n=t.pieceNum_;n<t.pieces_.length-1;n++)e.push(t.pieces_[n]);return new Ce(e,0)}function Ge(t,e){const n=[];for(let s=t.pieceNum_;s<t.pieces_.length;s++)n.push(t.pieces_[s]);if(e instanceof Ce)for(let s=e.pieceNum_;s<e.pieces_.length;s++)n.push(e.pieces_[s]);else{const s=e.split("/");for(let r=0;r<s.length;r++)s[r].length>0&&n.push(s[r])}return new Ce(n,0)}function pe(t){return t.pieceNum_>=t.pieces_.length}function cn(t,e){const n=fe(t),s=fe(e);if(n===null)return e;if(n===s)return cn(Me(t),Me(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+t+")")}function VK(t,e){const n=El(t,0),s=El(e,0);for(let r=0;r<n.length&&r<s.length;r++){const i=Eo(n[r],s[r]);if(i!==0)return i}return n.length===s.length?0:n.length<s.length?-1:1}function hy(t,e){if(Gr(t)!==Gr(e))return!1;for(let n=t.pieceNum_,s=e.pieceNum_;n<=t.pieces_.length;n++,s++)if(t.pieces_[n]!==e.pieces_[s])return!1;return!0}function $n(t,e){let n=t.pieceNum_,s=e.pieceNum_;if(Gr(t)>Gr(e))return!1;for(;n<t.pieces_.length;){if(t.pieces_[n]!==e.pieces_[s])return!1;++n,++s}return!0}class BK{constructor(e,n){this.errorPrefix_=n,this.parts_=El(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let s=0;s<this.parts_.length;s++)this.byteLength_+=Qd(this.parts_[s]);QA(this)}}function qK(t,e){t.parts_.length>0&&(t.byteLength_+=1),t.parts_.push(e),t.byteLength_+=Qd(e),QA(t)}function jK(t){const e=t.parts_.pop();t.byteLength_-=Qd(e),t.parts_.length>0&&(t.byteLength_-=1)}function QA(t){if(t.byteLength_>TI)throw new Error(t.errorPrefix_+"has a key path longer than "+TI+" bytes ("+t.byteLength_+").");if(t.parts_.length>EI)throw new Error(t.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+EI+") or object contains a cycle "+bi(t))}function bi(t){return t.parts_.length===0?"":"in property '"+t.parts_.join(".")+"'"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dy extends GA{constructor(){super(["visible"]);let e,n;typeof document!="undefined"&&typeof document.addEventListener!="undefined"&&(typeof document.hidden!="undefined"?(n="visibilitychange",e="hidden"):typeof document.mozHidden!="undefined"?(n="mozvisibilitychange",e="mozHidden"):typeof document.msHidden!="undefined"?(n="msvisibilitychange",e="msHidden"):typeof document.webkitHidden!="undefined"&&(n="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,n&&document.addEventListener(n,()=>{const s=!document[e];s!==this.visible_&&(this.visible_=s,this.trigger("visible",s))},!1)}static getInstance(){return new dy}getInitialEvent(e){return x(e==="visible","Unknown event type: "+e),[this.visible_]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dc=1e3,KK=60*5*1e3,SI=30*1e3,WK=1.3,HK=3e4,GK="server_kill",CI=3;class tr extends HA{constructor(e,n,s,r,i,o,a,c){if(super(),this.repoInfo_=e,this.applicationId_=n,this.onDataUpdate_=s,this.onConnectStatus_=r,this.onServerInfoUpdate_=i,this.authTokenProvider_=o,this.appCheckTokenProvider_=a,this.authOverride_=c,this.id=tr.nextPersistentConnectionId_++,this.log_=lu("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=dc,this.maxReconnectDelay_=KK,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,c&&!IC())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");dy.getInstance().on("visible",this.onVisible_,this),e.host.indexOf("fblocal")===-1&&zh.getInstance().on("online",this.onOnline_,this)}sendRequest(e,n,s){const r=++this.requestNumber_,i={r,a:e,b:n};this.log_(gt(i)),x(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(i),s&&(this.requestCBHash_[r]=s)}get(e){this.initConnection_();const n=new pt,s={p:e._path.toString(),q:e._queryObject},r={action:"g",request:s,onComplete:o=>{const a=o.d;o.s==="ok"?n.resolve(a):n.reject(a)}};this.outstandingGets_.push(r),this.outstandingGetCount_++;const i=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(i),n.promise}listen(e,n,s,r){this.initConnection_();const i=e._queryIdentifier,o=e._path.toString();this.log_("Listen called for "+o+" "+i),this.listens.has(o)||this.listens.set(o,new Map),x(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"listen() called for non-default but complete query"),x(!this.listens.get(o).has(i),"listen() called twice for same path/queryId.");const a={onComplete:r,hashFn:n,query:e,tag:s};this.listens.get(o).set(i,a),this.connected_&&this.sendListen_(a)}sendGet_(e){const n=this.outstandingGets_[e];this.sendRequest("g",n.request,s=>{delete this.outstandingGets_[e],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),n.onComplete&&n.onComplete(s)})}sendListen_(e){const n=e.query,s=n._path.toString(),r=n._queryIdentifier;this.log_("Listen on "+s+" for "+r);const i={p:s},o="q";e.tag&&(i.q=n._queryObject,i.t=e.tag),i.h=e.hashFn(),this.sendRequest(o,i,a=>{const c=a.d,l=a.s;tr.warnOnListenWarnings_(c,n),(this.listens.get(s)&&this.listens.get(s).get(r))===e&&(this.log_("listen response",a),l!=="ok"&&this.removeListen_(s,r),e.onComplete&&e.onComplete(l,c))})}static warnOnListenWarnings_(e,n){if(e&&typeof e=="object"&&Dn(e,"w")){const s=Hi(e,"w");if(Array.isArray(s)&&~s.indexOf("no_index")){const r='".indexOn": "'+n._queryParams.getIndex().toString()+'"',i=n._path.toString();Yt(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${r} at ${i} to your security rules for better performance.`)}}}refreshAuthToken(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(e)}reduceReconnectDelayIfAdminCredential_(e){(e&&e.length===40||wL(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=SI)}refreshAppCheckToken(e){this.appCheckToken_=e,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){const e=this.authToken_,n=vL(e)?"auth":"gauth",s={cred:e};this.authOverride_===null?s.noauth=!0:typeof this.authOverride_=="object"&&(s.authvar=this.authOverride_),this.sendRequest(n,s,r=>{const i=r.s,o=r.d||"error";this.authToken_===e&&(i==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(i,o))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},e=>{const n=e.s,s=e.d||"error";n==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(n,s)})}unlisten(e,n){const s=e._path.toString(),r=e._queryIdentifier;this.log_("Unlisten called for "+s+" "+r),x(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(s,r)&&this.connected_&&this.sendUnlisten_(s,r,e._queryObject,n)}sendUnlisten_(e,n,s,r){this.log_("Unlisten on "+e+" for "+n);const i={p:e},o="n";r&&(i.q=s,i.t=r),this.sendRequest(o,i)}onDisconnectPut(e,n,s){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",e,n,s):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:n,onComplete:s})}onDisconnectMerge(e,n,s){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",e,n,s):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:n,onComplete:s})}onDisconnectCancel(e,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",e,null,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:n})}sendOnDisconnect_(e,n,s,r){const i={p:n,d:s};this.log_("onDisconnect "+e,i),this.sendRequest(e,i,o=>{r&&setTimeout(()=>{r(o.s,o.d)},Math.floor(0))})}put(e,n,s,r){this.putInternal("p",e,n,s,r)}merge(e,n,s,r){this.putInternal("m",e,n,s,r)}putInternal(e,n,s,r,i){this.initConnection_();const o={p:n,d:s};i!==void 0&&(o.h=i),this.outstandingPuts_.push({action:e,request:o,onComplete:r}),this.outstandingPutCount_++;const a=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(a):this.log_("Buffering put: "+n)}sendPut_(e){const n=this.outstandingPuts_[e].action,s=this.outstandingPuts_[e].request,r=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(n,s,i=>{this.log_(n+" response",i),delete this.outstandingPuts_[e],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),r&&r(i.s,i.d)})}reportStats(e){if(this.connected_){const n={c:e};this.log_("reportStats",n),this.sendRequest("s",n,s=>{if(s.s!=="ok"){const i=s.d;this.log_("reportStats","Error sending stats: "+i)}})}}onDataMessage_(e){if("r"in e){this.log_("from server: "+gt(e));const n=e.r,s=this.requestCBHash_[n];s&&(delete this.requestCBHash_[n],s(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}}onDataPush_(e,n){this.log_("handleServerMessage",e,n),e==="d"?this.onDataUpdate_(n.p,n.d,!1,n.t):e==="m"?this.onDataUpdate_(n.p,n.d,!0,n.t):e==="c"?this.onListenRevoked_(n.p,n.q):e==="ac"?this.onAuthRevoked_(n.s,n.d):e==="apc"?this.onAppCheckRevoked_(n.s,n.d):e==="sd"?this.onSecurityDebugPacket_(n):nm("Unrecognized action received from server: "+gt(e)+`
Are you using the latest client?`)}onReady_(e,n){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(e),this.lastSessionId=n,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(e){x(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(e))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=dc,this.realtime_||this.scheduleConnect_(0)),this.visible_=e}onOnline_(e){e?(this.log_("Browser went online."),this.reconnectDelay_=dc,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>HK&&(this.reconnectDelay_=dc),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());const e=new Date().getTime()-this.lastConnectionAttemptTime_;let n=Math.max(0,this.reconnectDelay_-e);n=Math.random()*n,this.log_("Trying to reconnect in "+n+"ms"),this.scheduleConnect_(n),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*WK)}this.onConnectStatus_(!1)}async establishConnection_(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;const e=this.onDataMessage_.bind(this),n=this.onReady_.bind(this),s=this.onRealtimeDisconnect_.bind(this),r=this.id+":"+tr.nextConnectionId_++,i=this.lastSessionId;let o=!1,a=null;const c=function(){a?a.close():(o=!0,s())},l=function(h){x(a,"sendRequest call when we're not connected not allowed."),a.sendRequest(h)};this.realtime_={close:c,sendRequest:l};const u=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{const[h,d]=await Promise.all([this.authTokenProvider_.getToken(u),this.appCheckTokenProvider_.getToken(u)]);o?Et("getToken() completed but was canceled"):(Et("getToken() completed. Creating connection."),this.authToken_=h&&h.accessToken,this.appCheckToken_=d&&d.token,a=new UK(r,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,e,n,s,f=>{Yt(f+" ("+this.repoInfo_.toString()+")"),this.interrupt(GK)},i))}catch(h){this.log_("Failed to get token: "+h),o||(this.repoInfo_.nodeAdmin&&Yt(h),c())}}}interrupt(e){Et("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(e){Et("Resuming connection for reason: "+e),delete this.interruptReasons_[e],xh(this.interruptReasons_)&&(this.reconnectDelay_=dc,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(e){const n=e-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:n})}cancelSentTransactions_(){for(let e=0;e<this.outstandingPuts_.length;e++){const n=this.outstandingPuts_[e];n&&"h"in n.request&&n.queued&&(n.onComplete&&n.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(e,n){let s;n?s=n.map(i=>iy(i)).join("$"):s="default";const r=this.removeListen_(e,s);r&&r.onComplete&&r.onComplete("permission_denied")}removeListen_(e,n){const s=new Ce(e).toString();let r;if(this.listens.has(s)){const i=this.listens.get(s);r=i.get(n),i.delete(n),i.size===0&&this.listens.delete(s)}else r=void 0;return r}onAuthRevoked_(e,n){Et("Auth token revoked: "+e+"/"+n),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(e==="invalid_token"||e==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=CI&&(this.reconnectDelay_=SI,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(e,n){Et("App check token revoked: "+e+"/"+n),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(e==="invalid_token"||e==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=CI&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const e of this.listens.values())for(const n of e.values())this.sendListen_(n);for(let e=0;e<this.outstandingPuts_.length;e++)this.outstandingPuts_[e]&&this.sendPut_(e);for(;this.onDisconnectRequestQueue_.length;){const e=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(e.action,e.pathString,e.data,e.onComplete)}for(let e=0;e<this.outstandingGets_.length;e++)this.outstandingGets_[e]&&this.sendGet_(e)}sendConnectStats_(){const e={};let n="js";e["sdk."+n+"."+bA.replace(/\./g,"-")]=1,Gd()?e["framework.cordova"]=1:tu()&&(e["framework.reactnative"]=1),this.reportStats(e)}shouldReconnect_(){const e=zh.getInstance().currentlyOnline();return xh(this.interruptReasons_)&&e}}tr.nextPersistentConnectionId_=0;tr.nextConnectionId_=0;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ge{constructor(e,n){this.name=e,this.node=n}static Wrap(e,n){return new ge(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ff{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,n){const s=new ge(ir,e),r=new ge(ir,n);return this.compare(s,r)!==0}minPost(){return ge.MIN}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Gu;class YA extends ff{static get __EMPTY_NODE(){return Gu}static set __EMPTY_NODE(e){Gu=e}compare(e,n){return Eo(e.name,n.name)}isDefinedOn(e){throw Ua("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,n){return!1}minPost(){return ge.MIN}maxPost(){return new ge(Ms,Gu)}makePost(e,n){return x(typeof e=="string","KeyIndex indexValue must always be a string."),new ge(e,Gu)}toString(){return".key"}}const As=new YA;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zu{constructor(e,n,s,r,i=null){this.isReverse_=r,this.resultGenerator_=i,this.nodeStack_=[];let o=1;for(;!e.isEmpty();)if(e=e,o=n?s(e.key,n):1,r&&(o*=-1),o<0)this.isReverse_?e=e.left:e=e.right;else if(o===0){this.nodeStack_.push(e);break}else this.nodeStack_.push(e),this.isReverse_?e=e.right:e=e.left}getNext(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_.pop(),n;if(this.resultGenerator_?n=this.resultGenerator_(e.key,e.value):n={key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return n}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;const e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}}class bt{constructor(e,n,s,r,i){this.key=e,this.value=n,this.color=s!=null?s:bt.RED,this.left=r!=null?r:_n.EMPTY_NODE,this.right=i!=null?i:_n.EMPTY_NODE}copy(e,n,s,r,i){return new bt(e!=null?e:this.key,n!=null?n:this.value,s!=null?s:this.color,r!=null?r:this.left,i!=null?i:this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,s){let r=this;const i=s(e,r.key);return i<0?r=r.copy(null,null,null,r.left.insert(e,n,s),null):i===0?r=r.copy(null,n,null,null,null):r=r.copy(null,null,null,null,r.right.insert(e,n,s)),r.fixUp_()}removeMin_(){if(this.left.isEmpty())return _n.EMPTY_NODE;let e=this;return!e.left.isRed_()&&!e.left.left.isRed_()&&(e=e.moveRedLeft_()),e=e.copy(null,null,null,e.left.removeMin_(),null),e.fixUp_()}remove(e,n){let s,r;if(s=this,n(e,s.key)<0)!s.left.isEmpty()&&!s.left.isRed_()&&!s.left.left.isRed_()&&(s=s.moveRedLeft_()),s=s.copy(null,null,null,s.left.remove(e,n),null);else{if(s.left.isRed_()&&(s=s.rotateRight_()),!s.right.isEmpty()&&!s.right.isRed_()&&!s.right.left.isRed_()&&(s=s.moveRedRight_()),n(e,s.key)===0){if(s.right.isEmpty())return _n.EMPTY_NODE;r=s.right.min_(),s=s.copy(r.key,r.value,null,null,s.right.removeMin_())}s=s.copy(null,null,null,null,s.right.remove(e,n))}return s.fixUp_()}isRed_(){return this.color}fixUp_(){let e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e}moveRedLeft_(){let e=this.colorFlip_();return e.right.left.isRed_()&&(e=e.copy(null,null,null,null,e.right.rotateRight_()),e=e.rotateLeft_(),e=e.colorFlip_()),e}moveRedRight_(){let e=this.colorFlip_();return e.left.left.isRed_()&&(e=e.rotateRight_(),e=e.colorFlip_()),e}rotateLeft_(){const e=this.copy(null,null,bt.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight_(){const e=this.copy(null,null,bt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip_(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth_(){const e=this.check_();return Math.pow(2,e)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)}}bt.RED=!0;bt.BLACK=!1;class zK{copy(e,n,s,r,i){return this}insert(e,n,s){return new bt(e,n,null)}remove(e,n){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}}class _n{constructor(e,n=_n.EMPTY_NODE){this.comparator_=e,this.root_=n}insert(e,n){return new _n(this.comparator_,this.root_.insert(e,n,this.comparator_).copy(null,null,bt.BLACK,null,null))}remove(e){return new _n(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,bt.BLACK,null,null))}get(e){let n,s=this.root_;for(;!s.isEmpty();){if(n=this.comparator_(e,s.key),n===0)return s.value;n<0?s=s.left:n>0&&(s=s.right)}return null}getPredecessorKey(e){let n,s=this.root_,r=null;for(;!s.isEmpty();)if(n=this.comparator_(e,s.key),n===0){if(s.left.isEmpty())return r?r.key:null;for(s=s.left;!s.right.isEmpty();)s=s.right;return s.key}else n<0?s=s.left:n>0&&(r=s,s=s.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new zu(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,n){return new zu(this.root_,e,this.comparator_,!1,n)}getReverseIteratorFrom(e,n){return new zu(this.root_,e,this.comparator_,!0,n)}getReverseIterator(e){return new zu(this.root_,null,this.comparator_,!0,e)}}_n.EMPTY_NODE=new zK;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function QK(t,e){return Eo(t.name,e.name)}function fy(t,e){return Eo(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let rm;function YK(t){rm=t}const JA=function(t){return typeof t=="number"?"number:"+kA(t):"string:"+t},XA=function(t){if(t.isLeafNode()){const e=t.val();x(typeof e=="string"||typeof e=="number"||typeof e=="object"&&Dn(e,".sv"),"Priority must be a string or number.")}else x(t===rm||t.isEmpty(),"priority of unexpected type.");x(t===rm||t.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let AI;class yt{constructor(e,n=yt.__childrenNodeConstructor.EMPTY_NODE){this.value_=e,this.priorityNode_=n,this.lazyHash_=null,x(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),XA(this.priorityNode_)}static set __childrenNodeConstructor(e){AI=e}static get __childrenNodeConstructor(){return AI}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(e){return new yt(this.value_,e)}getImmediateChild(e){return e===".priority"?this.priorityNode_:yt.__childrenNodeConstructor.EMPTY_NODE}getChild(e){return pe(e)?this:fe(e)===".priority"?this.priorityNode_:yt.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(e,n){return null}updateImmediateChild(e,n){return e===".priority"?this.updatePriority(n):n.isEmpty()&&e!==".priority"?this:yt.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,n).updatePriority(this.priorityNode_)}updateChild(e,n){const s=fe(e);return s===null?n:n.isEmpty()&&s!==".priority"?this:(x(s!==".priority"||Gr(e)===1,".priority must be the last token in a path"),this.updateImmediateChild(s,yt.__childrenNodeConstructor.EMPTY_NODE.updateChild(Me(e),n)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(e,n){return!1}val(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let e="";this.priorityNode_.isEmpty()||(e+="priority:"+JA(this.priorityNode_.val())+":");const n=typeof this.value_;e+=n+":",n==="number"?e+=kA(this.value_):e+=this.value_,this.lazyHash_=SA(e)}return this.lazyHash_}getValue(){return this.value_}compareTo(e){return e===yt.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof yt.__childrenNodeConstructor?-1:(x(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))}compareToLeafNode_(e){const n=typeof e.value_,s=typeof this.value_,r=yt.VALUE_TYPE_ORDER.indexOf(n),i=yt.VALUE_TYPE_ORDER.indexOf(s);return x(r>=0,"Unknown leaf type: "+n),x(i>=0,"Unknown leaf type: "+s),r===i?s==="object"?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:i-r}withIndex(){return this}isIndexed(){return!0}equals(e){if(e===this)return!0;if(e.isLeafNode()){const n=e;return this.value_===n.value_&&this.priorityNode_.equals(n.priorityNode_)}else return!1}}yt.VALUE_TYPE_ORDER=["object","boolean","number","string"];/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ZA,ek;function JK(t){ZA=t}function XK(t){ek=t}class ZK extends ff{compare(e,n){const s=e.node.getPriority(),r=n.node.getPriority(),i=s.compareTo(r);return i===0?Eo(e.name,n.name):i}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,n){return!e.getPriority().equals(n.getPriority())}minPost(){return ge.MIN}maxPost(){return new ge(Ms,new yt("[PRIORITY-POST]",ek))}makePost(e,n){const s=ZA(e);return new ge(n,new yt("[PRIORITY-POST]",s))}toString(){return".priority"}}const qe=new ZK;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eW=Math.log(2);class tW{constructor(e){const n=i=>parseInt(Math.log(i)/eW,10),s=i=>parseInt(Array(i+1).join("1"),2);this.count=n(e+1),this.current_=this.count-1;const r=s(this.count);this.bits_=e+1&r}nextBitIsOne(){const e=!(this.bits_&1<<this.current_);return this.current_--,e}}const Qh=function(t,e,n,s){t.sort(e);const r=function(c,l){const u=l-c;let h,d;if(u===0)return null;if(u===1)return h=t[c],d=n?n(h):h,new bt(d,h.node,bt.BLACK,null,null);{const f=parseInt(u/2,10)+c,p=r(c,f),_=r(f+1,l);return h=t[f],d=n?n(h):h,new bt(d,h.node,bt.BLACK,p,_)}},i=function(c){let l=null,u=null,h=t.length;const d=function(p,_){const y=h-p,I=h;h-=p;const N=r(y+1,I),k=t[y],M=n?n(k):k;f(new bt(M,k.node,_,null,N))},f=function(p){l?(l.left=p,l=p):(u=p,l=p)};for(let p=0;p<c.count;++p){const _=c.nextBitIsOne(),y=Math.pow(2,c.count-(p+1));_?d(y,bt.BLACK):(d(y,bt.BLACK),d(y,bt.RED))}return u},o=new tW(t.length),a=i(o);return new _n(s||e,a)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let $p;const Lo={};class Ys{constructor(e,n){this.indexes_=e,this.indexSet_=n}static get Default(){return x(Lo&&qe,"ChildrenNode.ts has not been loaded"),$p=$p||new Ys({".priority":Lo},{".priority":qe}),$p}get(e){const n=Hi(this.indexes_,e);if(!n)throw new Error("No index defined for "+e);return n instanceof _n?n:null}hasIndex(e){return Dn(this.indexSet_,e.toString())}addIndex(e,n){x(e!==As,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const s=[];let r=!1;const i=n.getIterator(ge.Wrap);let o=i.getNext();for(;o;)r=r||e.isDefinedOn(o.node),s.push(o),o=i.getNext();let a;r?a=Qh(s,e.getCompare()):a=Lo;const c=e.toString(),l=Object.assign({},this.indexSet_);l[c]=e;const u=Object.assign({},this.indexes_);return u[c]=a,new Ys(u,l)}addToIndexes(e,n){const s=Oh(this.indexes_,(r,i)=>{const o=Hi(this.indexSet_,i);if(x(o,"Missing index implementation for "+i),r===Lo)if(o.isDefinedOn(e.node)){const a=[],c=n.getIterator(ge.Wrap);let l=c.getNext();for(;l;)l.name!==e.name&&a.push(l),l=c.getNext();return a.push(e),Qh(a,o.getCompare())}else return Lo;else{const a=n.get(e.name);let c=r;return a&&(c=c.remove(new ge(e.name,a))),c.insert(e,e.node)}});return new Ys(s,this.indexSet_)}removeFromIndexes(e,n){const s=Oh(this.indexes_,r=>{if(r===Lo)return r;{const i=n.get(e.name);return i?r.remove(new ge(e.name,i)):r}});return new Ys(s,this.indexSet_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let fc;class te{constructor(e,n,s){this.children_=e,this.priorityNode_=n,this.indexMap_=s,this.lazyHash_=null,this.priorityNode_&&XA(this.priorityNode_),this.children_.isEmpty()&&x(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return fc||(fc=new te(new _n(fy),null,Ys.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||fc}updatePriority(e){return this.children_.isEmpty()?this:new te(this.children_,e,this.indexMap_)}getImmediateChild(e){if(e===".priority")return this.getPriority();{const n=this.children_.get(e);return n===null?fc:n}}getChild(e){const n=fe(e);return n===null?this:this.getImmediateChild(n).getChild(Me(e))}hasChild(e){return this.children_.get(e)!==null}updateImmediateChild(e,n){if(x(n,"We should always be passing snapshot nodes"),e===".priority")return this.updatePriority(n);{const s=new ge(e,n);let r,i;n.isEmpty()?(r=this.children_.remove(e),i=this.indexMap_.removeFromIndexes(s,this.children_)):(r=this.children_.insert(e,n),i=this.indexMap_.addToIndexes(s,this.children_));const o=r.isEmpty()?fc:this.priorityNode_;return new te(r,o,i)}}updateChild(e,n){const s=fe(e);if(s===null)return n;{x(fe(e)!==".priority"||Gr(e)===1,".priority must be the last token in a path");const r=this.getImmediateChild(s).updateChild(Me(e),n);return this.updateImmediateChild(s,r)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(e){if(this.isEmpty())return null;const n={};let s=0,r=0,i=!0;if(this.forEachChild(qe,(o,a)=>{n[o]=a.val(e),s++,i&&te.INTEGER_REGEXP_.test(o)?r=Math.max(r,Number(o)):i=!1}),!e&&i&&r<2*s){const o=[];for(const a in n)o[a]=n[a];return o}else return e&&!this.getPriority().isEmpty()&&(n[".priority"]=this.getPriority().val()),n}hash(){if(this.lazyHash_===null){let e="";this.getPriority().isEmpty()||(e+="priority:"+JA(this.getPriority().val())+":"),this.forEachChild(qe,(n,s)=>{const r=s.hash();r!==""&&(e+=":"+n+":"+r)}),this.lazyHash_=e===""?"":SA(e)}return this.lazyHash_}getPredecessorChildName(e,n,s){const r=this.resolveIndex_(s);if(r){const i=r.getPredecessorKey(new ge(e,n));return i?i.name:null}else return this.children_.getPredecessorKey(e)}getFirstChildName(e){const n=this.resolveIndex_(e);if(n){const s=n.minKey();return s&&s.name}else return this.children_.minKey()}getFirstChild(e){const n=this.getFirstChildName(e);return n?new ge(n,this.children_.get(n)):null}getLastChildName(e){const n=this.resolveIndex_(e);if(n){const s=n.maxKey();return s&&s.name}else return this.children_.maxKey()}getLastChild(e){const n=this.getLastChildName(e);return n?new ge(n,this.children_.get(n)):null}forEachChild(e,n){const s=this.resolveIndex_(e);return s?s.inorderTraversal(r=>n(r.name,r.node)):this.children_.inorderTraversal(n)}getIterator(e){return this.getIteratorFrom(e.minPost(),e)}getIteratorFrom(e,n){const s=this.resolveIndex_(n);if(s)return s.getIteratorFrom(e,r=>r);{const r=this.children_.getIteratorFrom(e.name,ge.Wrap);let i=r.peek();for(;i!=null&&n.compare(i,e)<0;)r.getNext(),i=r.peek();return r}}getReverseIterator(e){return this.getReverseIteratorFrom(e.maxPost(),e)}getReverseIteratorFrom(e,n){const s=this.resolveIndex_(n);if(s)return s.getReverseIteratorFrom(e,r=>r);{const r=this.children_.getReverseIteratorFrom(e.name,ge.Wrap);let i=r.peek();for(;i!=null&&n.compare(i,e)>0;)r.getNext(),i=r.peek();return r}}compareTo(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===uu?-1:0}withIndex(e){if(e===As||this.indexMap_.hasIndex(e))return this;{const n=this.indexMap_.addIndex(e,this.children_);return new te(this.children_,this.priorityNode_,n)}}isIndexed(e){return e===As||this.indexMap_.hasIndex(e)}equals(e){if(e===this)return!0;if(e.isLeafNode())return!1;{const n=e;if(this.getPriority().equals(n.getPriority()))if(this.children_.count()===n.children_.count()){const s=this.getIterator(qe),r=n.getIterator(qe);let i=s.getNext(),o=r.getNext();for(;i&&o;){if(i.name!==o.name||!i.node.equals(o.node))return!1;i=s.getNext(),o=r.getNext()}return i===null&&o===null}else return!1;else return!1}}resolveIndex_(e){return e===As?null:this.indexMap_.get(e.toString())}}te.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;class nW extends te{constructor(){super(new _n(fy),te.EMPTY_NODE,Ys.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return te.EMPTY_NODE}isEmpty(){return!1}}const uu=new nW;Object.defineProperties(ge,{MIN:{value:new ge(ir,te.EMPTY_NODE)},MAX:{value:new ge(Ms,uu)}});YA.__EMPTY_NODE=te.EMPTY_NODE;yt.__childrenNodeConstructor=te;YK(uu);XK(uu);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sW=!0;function Qe(t,e=null){if(t===null)return te.EMPTY_NODE;if(typeof t=="object"&&".priority"in t&&(e=t[".priority"]),x(e===null||typeof e=="string"||typeof e=="number"||typeof e=="object"&&".sv"in e,"Invalid priority type found: "+typeof e),typeof t=="object"&&".value"in t&&t[".value"]!==null&&(t=t[".value"]),typeof t!="object"||".sv"in t){const n=t;return new yt(n,Qe(e))}if(!(t instanceof Array)&&sW){const n=[];let s=!1;if(Pt(t,(o,a)=>{if(o.substring(0,1)!=="."){const c=Qe(a);c.isEmpty()||(s=s||!c.getPriority().isEmpty(),n.push(new ge(o,c)))}}),n.length===0)return te.EMPTY_NODE;const i=Qh(n,QK,o=>o.name,fy);if(s){const o=Qh(n,qe.getCompare());return new te(i,Qe(e),new Ys({".priority":o},{".priority":qe}))}else return new te(i,Qe(e),Ys.Default)}else{let n=te.EMPTY_NODE;return Pt(t,(s,r)=>{if(Dn(t,s)&&s.substring(0,1)!=="."){const i=Qe(r);(i.isLeafNode()||!i.isEmpty())&&(n=n.updateImmediateChild(s,i))}}),n.updatePriority(Qe(e))}}JK(Qe);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class py extends ff{constructor(e){super(),this.indexPath_=e,x(!pe(e)&&fe(e)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,n){const s=this.extractChild(e.node),r=this.extractChild(n.node),i=s.compareTo(r);return i===0?Eo(e.name,n.name):i}makePost(e,n){const s=Qe(e),r=te.EMPTY_NODE.updateChild(this.indexPath_,s);return new ge(n,r)}maxPost(){const e=te.EMPTY_NODE.updateChild(this.indexPath_,uu);return new ge(Ms,e)}toString(){return El(this.indexPath_,0).join("/")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rW extends ff{compare(e,n){const s=e.node.compareTo(n.node);return s===0?Eo(e.name,n.name):s}isDefinedOn(e){return!0}indexedValueChanged(e,n){return!e.equals(n)}minPost(){return ge.MIN}maxPost(){return ge.MAX}makePost(e,n){const s=Qe(e);return new ge(n,s)}toString(){return".value"}}const gy=new rW;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ya="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",im="-",tk="z",nk=786,iW=function(){let t=0;const e=[];return function(n){const s=n===t;t=n;let r;const i=new Array(8);for(r=7;r>=0;r--)i[r]=ya.charAt(n%64),n=Math.floor(n/64);x(n===0,"Cannot push at time == 0");let o=i.join("");if(s){for(r=11;r>=0&&e[r]===63;r--)e[r]=0;e[r]++}else for(r=0;r<12;r++)e[r]=Math.floor(Math.random()*64);for(r=0;r<12;r++)o+=ya.charAt(e[r]);return x(o.length===20,"nextPushId: Length should be 20."),o}}(),kI=function(t){if(t===""+oy)return im;const e=Hh(t);if(e!=null)return""+(e+1);const n=new Array(t.length);for(let o=0;o<n.length;o++)n[o]=t.charAt(o);if(n.length<nk)return n.push(im),n.join("");let s=n.length-1;for(;s>=0&&n[s]===tk;)s--;if(s===-1)return Ms;const r=n[s],i=ya.charAt(ya.indexOf(r)+1);return n[s]=i,n.slice(0,s+1).join("")},RI=function(t){if(t===""+RA)return ir;const e=Hh(t);if(e!=null)return""+(e-1);const n=new Array(t.length);for(let s=0;s<n.length;s++)n[s]=t.charAt(s);return n[n.length-1]===im?n.length===1?""+oy:(delete n[n.length-1],n.join("")):(n[n.length-1]=ya.charAt(ya.indexOf(n[n.length-1])-1),n.join("")+tk.repeat(nk-n.length))};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sk(t){return{type:"value",snapshotNode:t}}function va(t,e){return{type:"child_added",snapshotNode:e,childName:t}}function Tl(t,e){return{type:"child_removed",snapshotNode:e,childName:t}}function Sl(t,e,n){return{type:"child_changed",snapshotNode:e,childName:t,oldSnap:n}}function oW(t,e){return{type:"child_moved",snapshotNode:e,childName:t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class my{constructor(e){this.index_=e}updateChild(e,n,s,r,i,o){x(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");const a=e.getImmediateChild(n);return a.getChild(r).equals(s.getChild(r))&&a.isEmpty()===s.isEmpty()||(o!=null&&(s.isEmpty()?e.hasChild(n)?o.trackChildChange(Tl(n,a)):x(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):a.isEmpty()?o.trackChildChange(va(n,s)):o.trackChildChange(Sl(n,s,a))),e.isLeafNode()&&s.isEmpty())?e:e.updateImmediateChild(n,s).withIndex(this.index_)}updateFullNode(e,n,s){return s!=null&&(e.isLeafNode()||e.forEachChild(qe,(r,i)=>{n.hasChild(r)||s.trackChildChange(Tl(r,i))}),n.isLeafNode()||n.forEachChild(qe,(r,i)=>{if(e.hasChild(r)){const o=e.getImmediateChild(r);o.equals(i)||s.trackChildChange(Sl(r,i,o))}else s.trackChildChange(va(r,i))})),n.withIndex(this.index_)}updatePriority(e,n){return e.isEmpty()?te.EMPTY_NODE:e.updatePriority(n)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cl{constructor(e){this.indexedFilter_=new my(e.getIndex()),this.index_=e.getIndex(),this.startPost_=Cl.getStartPost_(e),this.endPost_=Cl.getEndPost_(e)}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){return this.index_.compare(this.getStartPost(),e)<=0&&this.index_.compare(e,this.getEndPost())<=0}updateChild(e,n,s,r,i,o){return this.matches(new ge(n,s))||(s=te.EMPTY_NODE),this.indexedFilter_.updateChild(e,n,s,r,i,o)}updateFullNode(e,n,s){n.isLeafNode()&&(n=te.EMPTY_NODE);let r=n.withIndex(this.index_);r=r.updatePriority(te.EMPTY_NODE);const i=this;return n.forEachChild(qe,(o,a)=>{i.matches(new ge(o,a))||(r=r.updateImmediateChild(o,te.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,r,s)}updatePriority(e,n){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){const n=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),n)}else return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){const n=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),n)}else return e.getIndex().maxPost()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aW{constructor(e){this.rangedFilter_=new Cl(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft()}updateChild(e,n,s,r,i,o){return this.rangedFilter_.matches(new ge(n,s))||(s=te.EMPTY_NODE),e.getImmediateChild(n).equals(s)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,n,s,r,i,o):this.fullLimitUpdateChild_(e,n,s,i,o)}updateFullNode(e,n,s){let r;if(n.isLeafNode()||n.isEmpty())r=te.EMPTY_NODE.withIndex(this.index_);else if(this.limit_*2<n.numChildren()&&n.isIndexed(this.index_)){r=te.EMPTY_NODE.withIndex(this.index_);let i;this.reverse_?i=n.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):i=n.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let o=0;for(;i.hasNext()&&o<this.limit_;){const a=i.getNext();let c;if(this.reverse_?c=this.index_.compare(this.rangedFilter_.getStartPost(),a)<=0:c=this.index_.compare(a,this.rangedFilter_.getEndPost())<=0,c)r=r.updateImmediateChild(a.name,a.node),o++;else break}}else{r=n.withIndex(this.index_),r=r.updatePriority(te.EMPTY_NODE);let i,o,a,c;if(this.reverse_){c=r.getReverseIterator(this.index_),i=this.rangedFilter_.getEndPost(),o=this.rangedFilter_.getStartPost();const h=this.index_.getCompare();a=(d,f)=>h(f,d)}else c=r.getIterator(this.index_),i=this.rangedFilter_.getStartPost(),o=this.rangedFilter_.getEndPost(),a=this.index_.getCompare();let l=0,u=!1;for(;c.hasNext();){const h=c.getNext();!u&&a(i,h)<=0&&(u=!0),u&&l<this.limit_&&a(h,o)<=0?l++:r=r.updateImmediateChild(h.name,te.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,r,s)}updatePriority(e,n){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,n,s,r,i){let o;if(this.reverse_){const h=this.index_.getCompare();o=(d,f)=>h(f,d)}else o=this.index_.getCompare();const a=e;x(a.numChildren()===this.limit_,"");const c=new ge(n,s),l=this.reverse_?a.getFirstChild(this.index_):a.getLastChild(this.index_),u=this.rangedFilter_.matches(c);if(a.hasChild(n)){const h=a.getImmediateChild(n);let d=r.getChildAfterChild(this.index_,l,this.reverse_);for(;d!=null&&(d.name===n||a.hasChild(d.name));)d=r.getChildAfterChild(this.index_,d,this.reverse_);const f=d==null?1:o(d,c);if(u&&!s.isEmpty()&&f>=0)return i!=null&&i.trackChildChange(Sl(n,s,h)),a.updateImmediateChild(n,s);{i!=null&&i.trackChildChange(Tl(n,h));const _=a.updateImmediateChild(n,te.EMPTY_NODE);return d!=null&&this.rangedFilter_.matches(d)?(i!=null&&i.trackChildChange(va(d.name,d.node)),_.updateImmediateChild(d.name,d.node)):_}}else return s.isEmpty()?e:u&&o(l,c)>=0?(i!=null&&(i.trackChildChange(Tl(l.name,l.node)),i.trackChildChange(va(n,s))),a.updateImmediateChild(n,s).updateImmediateChild(l.name,te.EMPTY_NODE)):e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pf{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=qe}hasStart(){return this.startSet_}hasStartAfter(){return this.startAfterSet_}hasEndBefore(){return this.endBeforeSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return x(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return x(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:ir}hasEnd(){return this.endSet_}getIndexEndValue(){return x(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return x(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:Ms}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return x(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===qe}copy(){const e=new pf;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}}function cW(t){return t.loadsAllData()?new my(t.getIndex()):t.hasLimit()?new aW(t):new Cl(t)}function lW(t,e){const n=t.copy();return n.limitSet_=!0,n.limit_=e,n.viewFrom_="l",n}function uW(t,e){const n=t.copy();return n.limitSet_=!0,n.limit_=e,n.viewFrom_="r",n}function om(t,e,n){const s=t.copy();return s.startSet_=!0,e===void 0&&(e=null),s.indexStartValue_=e,n!=null?(s.startNameSet_=!0,s.indexStartName_=n):(s.startNameSet_=!1,s.indexStartName_=""),s}function hW(t,e,n){let s;if(t.index_===As)typeof e=="string"&&(e=kI(e)),s=om(t,e,n);else{let r;n==null?r=Ms:r=kI(n),s=om(t,e,r)}return s.startAfterSet_=!0,s}function am(t,e,n){const s=t.copy();return s.endSet_=!0,e===void 0&&(e=null),s.indexEndValue_=e,n!==void 0?(s.endNameSet_=!0,s.indexEndName_=n):(s.endNameSet_=!1,s.indexEndName_=""),s}function dW(t,e,n){let s,r;return t.index_===As?(typeof e=="string"&&(e=RI(e)),r=am(t,e,n)):(n==null?s=ir:s=RI(n),r=am(t,e,s)),r.endBeforeSet_=!0,r}function gf(t,e){const n=t.copy();return n.index_=e,n}function NI(t){const e={};if(t.isDefault())return e;let n;return t.index_===qe?n="$priority":t.index_===gy?n="$value":t.index_===As?n="$key":(x(t.index_ instanceof py,"Unrecognized index type!"),n=t.index_.toString()),e.orderBy=gt(n),t.startSet_&&(e.startAt=gt(t.indexStartValue_),t.startNameSet_&&(e.startAt+=","+gt(t.indexStartName_))),t.endSet_&&(e.endAt=gt(t.indexEndValue_),t.endNameSet_&&(e.endAt+=","+gt(t.indexEndName_))),t.limitSet_&&(t.isViewFromLeft()?e.limitToFirst=t.limit_:e.limitToLast=t.limit_),e}function PI(t){const e={};if(t.startSet_&&(e.sp=t.indexStartValue_,t.startNameSet_&&(e.sn=t.indexStartName_)),t.endSet_&&(e.ep=t.indexEndValue_,t.endNameSet_&&(e.en=t.indexEndName_)),t.limitSet_){e.l=t.limit_;let n=t.viewFrom_;n===""&&(t.isViewFromLeft()?n="l":n="r"),e.vf=n}return t.index_!==qe&&(e.i=t.index_.toString()),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yh extends HA{constructor(e,n,s,r){super(),this.repoInfo_=e,this.onDataUpdate_=n,this.authTokenProvider_=s,this.appCheckTokenProvider_=r,this.log_=lu("p:rest:"),this.listens_={}}reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,n){return n!==void 0?"tag$"+n:(x(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}listen(e,n,s,r){const i=e._path.toString();this.log_("Listen called for "+i+" "+e._queryIdentifier);const o=Yh.getListenId_(e,s),a={};this.listens_[o]=a;const c=NI(e._queryParams);this.restRequest_(i+".json",c,(l,u)=>{let h=u;if(l===404&&(h=null,l=null),l===null&&this.onDataUpdate_(i,h,!1,s),Hi(this.listens_,o)===a){let d;l?l===401?d="permission_denied":d="rest_error:"+l:d="ok",r(d,null)}})}unlisten(e,n){const s=Yh.getListenId_(e,n);delete this.listens_[s]}get(e){const n=NI(e._queryParams),s=e._path.toString(),r=new pt;return this.restRequest_(s+".json",n,(i,o)=>{let a=o;i===404&&(a=null,i=null),i===null?(this.onDataUpdate_(s,a,!1,null),r.resolve(a)):r.reject(new Error(a))}),r.promise}refreshAuthToken(e){}restRequest_(e,n={},s){return n.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([r,i])=>{r&&r.accessToken&&(n.auth=r.accessToken),i&&i.token&&(n.ac=i.token);const o=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+wo(n);this.log_("Sending REST request for "+o);const a=new XMLHttpRequest;a.onreadystatechange=()=>{if(s&&a.readyState===4){this.log_("REST Response for "+o+" received. status:",a.status,"response:",a.responseText);let c=null;if(a.status>=200&&a.status<300){try{c=hl(a.responseText)}catch{Yt("Failed to parse JSON response for "+o+": "+a.responseText)}s(null,c)}else a.status!==401&&a.status!==404&&Yt("Got unsuccessful REST response for "+o+" Status: "+a.status),s(a.status);s=null}},a.open("GET",o,!0),a.send()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fW{constructor(){this.rootNode_=te.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,n){this.rootNode_=this.rootNode_.updateChild(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Jh(){return{value:null,children:new Map}}function Wa(t,e,n){if(pe(e))t.value=n,t.children.clear();else if(t.value!==null)t.value=t.value.updateChild(e,n);else{const s=fe(e);t.children.has(s)||t.children.set(s,Jh());const r=t.children.get(s);e=Me(e),Wa(r,e,n)}}function cm(t,e){if(pe(e))return t.value=null,t.children.clear(),!0;if(t.value!==null){if(t.value.isLeafNode())return!1;{const n=t.value;return t.value=null,n.forEachChild(qe,(s,r)=>{Wa(t,new Ce(s),r)}),cm(t,e)}}else if(t.children.size>0){const n=fe(e);return e=Me(e),t.children.has(n)&&cm(t.children.get(n),e)&&t.children.delete(n),t.children.size===0}else return!0}function lm(t,e,n){t.value!==null?n(e,t.value):pW(t,(s,r)=>{const i=new Ce(e.toString()+"/"+s);lm(r,i,n)})}function pW(t,e){t.children.forEach((n,s)=>{e(s,n)})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gW{constructor(e){this.collection_=e,this.last_=null}get(){const e=this.collection_.get(),n=Object.assign({},e);return this.last_&&Pt(this.last_,(s,r)=>{n[s]=n[s]-r}),this.last_=e,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DI=10*1e3,mW=30*1e3,_W=5*60*1e3;class yW{constructor(e,n){this.server_=n,this.statsToReport_={},this.statsListener_=new gW(e);const s=DI+(mW-DI)*Math.random();Vc(this.reportStats_.bind(this),Math.floor(s))}reportStats_(){const e=this.statsListener_.get(),n={};let s=!1;Pt(e,(r,i)=>{i>0&&Dn(this.statsToReport_,r)&&(n[r]=i,s=!0)}),s&&this.server_.reportStats(n),Vc(this.reportStats_.bind(this),Math.floor(Math.random()*2*_W))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ss;(function(t){t[t.OVERWRITE=0]="OVERWRITE",t[t.MERGE=1]="MERGE",t[t.ACK_USER_WRITE=2]="ACK_USER_WRITE",t[t.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"})(ss||(ss={}));function _y(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function yy(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function vy(t){return{fromUser:!1,fromServer:!0,queryId:t,tagged:!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xh{constructor(e,n,s){this.path=e,this.affectedTree=n,this.revert=s,this.type=ss.ACK_USER_WRITE,this.source=_y()}operationForChild(e){if(pe(this.path)){if(this.affectedTree.value!=null)return x(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const n=this.affectedTree.subtree(new Ce(e));return new Xh(Te(),n,this.revert)}}else return x(fe(this.path)===e,"operationForChild called for unrelated child."),new Xh(Me(this.path),this.affectedTree,this.revert)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Al{constructor(e,n){this.source=e,this.path=n,this.type=ss.LISTEN_COMPLETE}operationForChild(e){return pe(this.path)?new Al(this.source,Te()):new Al(this.source,Me(this.path))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xi{constructor(e,n,s){this.source=e,this.path=n,this.snap=s,this.type=ss.OVERWRITE}operationForChild(e){return pe(this.path)?new Xi(this.source,Te(),this.snap.getImmediateChild(e)):new Xi(this.source,Me(this.path),this.snap)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wa{constructor(e,n,s){this.source=e,this.path=n,this.children=s,this.type=ss.MERGE}operationForChild(e){if(pe(this.path)){const n=this.children.subtree(new Ce(e));return n.isEmpty()?null:n.value?new Xi(this.source,Te(),n.value):new wa(this.source,Te(),n)}else return x(fe(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new wa(this.source,Me(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zr{constructor(e,n,s){this.node_=e,this.fullyInitialized_=n,this.filtered_=s}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(pe(e))return this.isFullyInitialized()&&!this.filtered_;const n=fe(e);return this.isCompleteForChild(n)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vW{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}}function wW(t,e,n,s){const r=[],i=[];return e.forEach(o=>{o.type==="child_changed"&&t.index_.indexedValueChanged(o.oldSnap,o.snapshotNode)&&i.push(oW(o.childName,o.snapshotNode))}),pc(t,r,"child_removed",e,s,n),pc(t,r,"child_added",e,s,n),pc(t,r,"child_moved",i,s,n),pc(t,r,"child_changed",e,s,n),pc(t,r,"value",e,s,n),r}function pc(t,e,n,s,r,i){const o=s.filter(a=>a.type===n);o.sort((a,c)=>IW(t,a,c)),o.forEach(a=>{const c=bW(t,a,i);r.forEach(l=>{l.respondsTo(a.type)&&e.push(l.createEvent(c,t.query_))})})}function bW(t,e,n){return e.type==="value"||e.type==="child_removed"||(e.prevName=n.getPredecessorChildName(e.childName,e.snapshotNode,t.index_)),e}function IW(t,e,n){if(e.childName==null||n.childName==null)throw Ua("Should only compare child_ events.");const s=new ge(e.childName,e.snapshotNode),r=new ge(n.childName,n.snapshotNode);return t.index_.compare(s,r)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mf(t,e){return{eventCache:t,serverCache:e}}function Bc(t,e,n,s){return mf(new zr(e,n,s),t.serverCache)}function rk(t,e,n,s){return mf(t.eventCache,new zr(e,n,s))}function Zh(t){return t.eventCache.isFullyInitialized()?t.eventCache.getNode():null}function Zi(t){return t.serverCache.isFullyInitialized()?t.serverCache.getNode():null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Vp;const EW=()=>(Vp||(Vp=new _n(oK)),Vp);class Ve{constructor(e,n=EW()){this.value=e,this.children=n}static fromObject(e){let n=new Ve(null);return Pt(e,(s,r)=>{n=n.set(new Ce(s),r)}),n}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,n){if(this.value!=null&&n(this.value))return{path:Te(),value:this.value};if(pe(e))return null;{const s=fe(e),r=this.children.get(s);if(r!==null){const i=r.findRootMostMatchingPathAndValue(Me(e),n);return i!=null?{path:Ge(new Ce(s),i.path),value:i.value}:null}else return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(pe(e))return this;{const n=fe(e),s=this.children.get(n);return s!==null?s.subtree(Me(e)):new Ve(null)}}set(e,n){if(pe(e))return new Ve(n,this.children);{const s=fe(e),i=(this.children.get(s)||new Ve(null)).set(Me(e),n),o=this.children.insert(s,i);return new Ve(this.value,o)}}remove(e){if(pe(e))return this.children.isEmpty()?new Ve(null):new Ve(null,this.children);{const n=fe(e),s=this.children.get(n);if(s){const r=s.remove(Me(e));let i;return r.isEmpty()?i=this.children.remove(n):i=this.children.insert(n,r),this.value===null&&i.isEmpty()?new Ve(null):new Ve(this.value,i)}else return this}}get(e){if(pe(e))return this.value;{const n=fe(e),s=this.children.get(n);return s?s.get(Me(e)):null}}setTree(e,n){if(pe(e))return n;{const s=fe(e),i=(this.children.get(s)||new Ve(null)).setTree(Me(e),n);let o;return i.isEmpty()?o=this.children.remove(s):o=this.children.insert(s,i),new Ve(this.value,o)}}fold(e){return this.fold_(Te(),e)}fold_(e,n){const s={};return this.children.inorderTraversal((r,i)=>{s[r]=i.fold_(Ge(e,r),n)}),n(e,this.value,s)}findOnPath(e,n){return this.findOnPath_(e,Te(),n)}findOnPath_(e,n,s){const r=this.value?s(n,this.value):!1;if(r)return r;if(pe(e))return null;{const i=fe(e),o=this.children.get(i);return o?o.findOnPath_(Me(e),Ge(n,i),s):null}}foreachOnPath(e,n){return this.foreachOnPath_(e,Te(),n)}foreachOnPath_(e,n,s){if(pe(e))return this;{this.value&&s(n,this.value);const r=fe(e),i=this.children.get(r);return i?i.foreachOnPath_(Me(e),Ge(n,r),s):new Ve(null)}}foreach(e){this.foreach_(Te(),e)}foreach_(e,n){this.children.inorderTraversal((s,r)=>{r.foreach_(Ge(e,s),n)}),this.value&&n(e,this.value)}foreachChild(e){this.children.inorderTraversal((n,s)=>{s.value&&e(n,s.value)})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cs{constructor(e){this.writeTree_=e}static empty(){return new cs(new Ve(null))}}function qc(t,e,n){if(pe(e))return new cs(new Ve(n));{const s=t.writeTree_.findRootMostValueAndPath(e);if(s!=null){const r=s.path;let i=s.value;const o=cn(r,e);return i=i.updateChild(o,n),new cs(t.writeTree_.set(r,i))}else{const r=new Ve(n),i=t.writeTree_.setTree(e,r);return new cs(i)}}}function um(t,e,n){let s=t;return Pt(n,(r,i)=>{s=qc(s,Ge(e,r),i)}),s}function xI(t,e){if(pe(e))return cs.empty();{const n=t.writeTree_.setTree(e,new Ve(null));return new cs(n)}}function hm(t,e){return To(t,e)!=null}function To(t,e){const n=t.writeTree_.findRootMostValueAndPath(e);return n!=null?t.writeTree_.get(n.path).getChild(cn(n.path,e)):null}function OI(t){const e=[],n=t.writeTree_.value;return n!=null?n.isLeafNode()||n.forEachChild(qe,(s,r)=>{e.push(new ge(s,r))}):t.writeTree_.children.inorderTraversal((s,r)=>{r.value!=null&&e.push(new ge(s,r.value))}),e}function Fr(t,e){if(pe(e))return t;{const n=To(t,e);return n!=null?new cs(new Ve(n)):new cs(t.writeTree_.subtree(e))}}function dm(t){return t.writeTree_.isEmpty()}function ba(t,e){return ik(Te(),t.writeTree_,e)}function ik(t,e,n){if(e.value!=null)return n.updateChild(t,e.value);{let s=null;return e.children.inorderTraversal((r,i)=>{r===".priority"?(x(i.value!==null,"Priority writes must always be leaf nodes"),s=i.value):n=ik(Ge(t,r),i,n)}),!n.getChild(t).isEmpty()&&s!==null&&(n=n.updateChild(Ge(t,".priority"),s)),n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _f(t,e){return lk(e,t)}function TW(t,e,n,s,r){x(s>t.lastWriteId,"Stacking an older write on top of newer ones"),r===void 0&&(r=!0),t.allWrites.push({path:e,snap:n,writeId:s,visible:r}),r&&(t.visibleWrites=qc(t.visibleWrites,e,n)),t.lastWriteId=s}function SW(t,e,n,s){x(s>t.lastWriteId,"Stacking an older merge on top of newer ones"),t.allWrites.push({path:e,children:n,writeId:s,visible:!0}),t.visibleWrites=um(t.visibleWrites,e,n),t.lastWriteId=s}function CW(t,e){for(let n=0;n<t.allWrites.length;n++){const s=t.allWrites[n];if(s.writeId===e)return s}return null}function AW(t,e){const n=t.allWrites.findIndex(a=>a.writeId===e);x(n>=0,"removeWrite called with nonexistent writeId.");const s=t.allWrites[n];t.allWrites.splice(n,1);let r=s.visible,i=!1,o=t.allWrites.length-1;for(;r&&o>=0;){const a=t.allWrites[o];a.visible&&(o>=n&&kW(a,s.path)?r=!1:$n(s.path,a.path)&&(i=!0)),o--}if(r){if(i)return RW(t),!0;if(s.snap)t.visibleWrites=xI(t.visibleWrites,s.path);else{const a=s.children;Pt(a,c=>{t.visibleWrites=xI(t.visibleWrites,Ge(s.path,c))})}return!0}else return!1}function kW(t,e){if(t.snap)return $n(t.path,e);for(const n in t.children)if(t.children.hasOwnProperty(n)&&$n(Ge(t.path,n),e))return!0;return!1}function RW(t){t.visibleWrites=ok(t.allWrites,NW,Te()),t.allWrites.length>0?t.lastWriteId=t.allWrites[t.allWrites.length-1].writeId:t.lastWriteId=-1}function NW(t){return t.visible}function ok(t,e,n){let s=cs.empty();for(let r=0;r<t.length;++r){const i=t[r];if(e(i)){const o=i.path;let a;if(i.snap)$n(n,o)?(a=cn(n,o),s=qc(s,a,i.snap)):$n(o,n)&&(a=cn(o,n),s=qc(s,Te(),i.snap.getChild(a)));else if(i.children){if($n(n,o))a=cn(n,o),s=um(s,a,i.children);else if($n(o,n))if(a=cn(o,n),pe(a))s=um(s,Te(),i.children);else{const c=Hi(i.children,fe(a));if(c){const l=c.getChild(Me(a));s=qc(s,Te(),l)}}}else throw Ua("WriteRecord should have .snap or .children")}}return s}function ak(t,e,n,s,r){if(!s&&!r){const i=To(t.visibleWrites,e);if(i!=null)return i;{const o=Fr(t.visibleWrites,e);if(dm(o))return n;if(n==null&&!hm(o,Te()))return null;{const a=n||te.EMPTY_NODE;return ba(o,a)}}}else{const i=Fr(t.visibleWrites,e);if(!r&&dm(i))return n;if(!r&&n==null&&!hm(i,Te()))return null;{const o=function(l){return(l.visible||r)&&(!s||!~s.indexOf(l.writeId))&&($n(l.path,e)||$n(e,l.path))},a=ok(t.allWrites,o,e),c=n||te.EMPTY_NODE;return ba(a,c)}}}function PW(t,e,n){let s=te.EMPTY_NODE;const r=To(t.visibleWrites,e);if(r)return r.isLeafNode()||r.forEachChild(qe,(i,o)=>{s=s.updateImmediateChild(i,o)}),s;if(n){const i=Fr(t.visibleWrites,e);return n.forEachChild(qe,(o,a)=>{const c=ba(Fr(i,new Ce(o)),a);s=s.updateImmediateChild(o,c)}),OI(i).forEach(o=>{s=s.updateImmediateChild(o.name,o.node)}),s}else{const i=Fr(t.visibleWrites,e);return OI(i).forEach(o=>{s=s.updateImmediateChild(o.name,o.node)}),s}}function DW(t,e,n,s,r){x(s||r,"Either existingEventSnap or existingServerSnap must exist");const i=Ge(e,n);if(hm(t.visibleWrites,i))return null;{const o=Fr(t.visibleWrites,i);return dm(o)?r.getChild(n):ba(o,r.getChild(n))}}function xW(t,e,n,s){const r=Ge(e,n),i=To(t.visibleWrites,r);if(i!=null)return i;if(s.isCompleteForChild(n)){const o=Fr(t.visibleWrites,r);return ba(o,s.getNode().getImmediateChild(n))}else return null}function OW(t,e){return To(t.visibleWrites,e)}function MW(t,e,n,s,r,i,o){let a;const c=Fr(t.visibleWrites,e),l=To(c,Te());if(l!=null)a=l;else if(n!=null)a=ba(c,n);else return[];if(a=a.withIndex(o),!a.isEmpty()&&!a.isLeafNode()){const u=[],h=o.getCompare(),d=i?a.getReverseIteratorFrom(s,o):a.getIteratorFrom(s,o);let f=d.getNext();for(;f&&u.length<r;)h(f,s)!==0&&u.push(f),f=d.getNext();return u}else return[]}function LW(){return{visibleWrites:cs.empty(),allWrites:[],lastWriteId:-1}}function ed(t,e,n,s){return ak(t.writeTree,t.treePath,e,n,s)}function wy(t,e){return PW(t.writeTree,t.treePath,e)}function MI(t,e,n,s){return DW(t.writeTree,t.treePath,e,n,s)}function td(t,e){return OW(t.writeTree,Ge(t.treePath,e))}function FW(t,e,n,s,r,i){return MW(t.writeTree,t.treePath,e,n,s,r,i)}function by(t,e,n){return xW(t.writeTree,t.treePath,e,n)}function ck(t,e){return lk(Ge(t.treePath,e),t.writeTree)}function lk(t,e){return{treePath:t,writeTree:e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UW{constructor(){this.changeMap=new Map}trackChildChange(e){const n=e.type,s=e.childName;x(n==="child_added"||n==="child_changed"||n==="child_removed","Only child changes supported for tracking"),x(s!==".priority","Only non-priority child changes can be tracked.");const r=this.changeMap.get(s);if(r){const i=r.type;if(n==="child_added"&&i==="child_removed")this.changeMap.set(s,Sl(s,e.snapshotNode,r.snapshotNode));else if(n==="child_removed"&&i==="child_added")this.changeMap.delete(s);else if(n==="child_removed"&&i==="child_changed")this.changeMap.set(s,Tl(s,r.oldSnap));else if(n==="child_changed"&&i==="child_added")this.changeMap.set(s,va(s,e.snapshotNode));else if(n==="child_changed"&&i==="child_changed")this.changeMap.set(s,Sl(s,e.snapshotNode,r.oldSnap));else throw Ua("Illegal combination of changes: "+e+" occurred after "+r)}else this.changeMap.set(s,e)}getChanges(){return Array.from(this.changeMap.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $W{getCompleteChild(e){return null}getChildAfterChild(e,n,s){return null}}const uk=new $W;class Iy{constructor(e,n,s=null){this.writes_=e,this.viewCache_=n,this.optCompleteServerCache_=s}getCompleteChild(e){const n=this.viewCache_.eventCache;if(n.isCompleteForChild(e))return n.getNode().getImmediateChild(e);{const s=this.optCompleteServerCache_!=null?new zr(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return by(this.writes_,e,s)}}getChildAfterChild(e,n,s){const r=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:Zi(this.viewCache_),i=FW(this.writes_,r,n,1,s,e);return i.length===0?null:i[0]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VW(t){return{filter:t}}function BW(t,e){x(e.eventCache.getNode().isIndexed(t.filter.getIndex()),"Event snap not indexed"),x(e.serverCache.getNode().isIndexed(t.filter.getIndex()),"Server snap not indexed")}function qW(t,e,n,s,r){const i=new UW;let o,a;if(n.type===ss.OVERWRITE){const l=n;l.source.fromUser?o=fm(t,e,l.path,l.snap,s,r,i):(x(l.source.fromServer,"Unknown source."),a=l.source.tagged||e.serverCache.isFiltered()&&!pe(l.path),o=nd(t,e,l.path,l.snap,s,r,a,i))}else if(n.type===ss.MERGE){const l=n;l.source.fromUser?o=KW(t,e,l.path,l.children,s,r,i):(x(l.source.fromServer,"Unknown source."),a=l.source.tagged||e.serverCache.isFiltered(),o=pm(t,e,l.path,l.children,s,r,a,i))}else if(n.type===ss.ACK_USER_WRITE){const l=n;l.revert?o=GW(t,e,l.path,s,r,i):o=WW(t,e,l.path,l.affectedTree,s,r,i)}else if(n.type===ss.LISTEN_COMPLETE)o=HW(t,e,n.path,s,i);else throw Ua("Unknown operation type: "+n.type);const c=i.getChanges();return jW(e,o,c),{viewCache:o,changes:c}}function jW(t,e,n){const s=e.eventCache;if(s.isFullyInitialized()){const r=s.getNode().isLeafNode()||s.getNode().isEmpty(),i=Zh(t);(n.length>0||!t.eventCache.isFullyInitialized()||r&&!s.getNode().equals(i)||!s.getNode().getPriority().equals(i.getPriority()))&&n.push(sk(Zh(e)))}}function hk(t,e,n,s,r,i){const o=e.eventCache;if(td(s,n)!=null)return e;{let a,c;if(pe(n))if(x(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){const l=Zi(e),u=l instanceof te?l:te.EMPTY_NODE,h=wy(s,u);a=t.filter.updateFullNode(e.eventCache.getNode(),h,i)}else{const l=ed(s,Zi(e));a=t.filter.updateFullNode(e.eventCache.getNode(),l,i)}else{const l=fe(n);if(l===".priority"){x(Gr(n)===1,"Can't have a priority with additional path components");const u=o.getNode();c=e.serverCache.getNode();const h=MI(s,n,u,c);h!=null?a=t.filter.updatePriority(u,h):a=o.getNode()}else{const u=Me(n);let h;if(o.isCompleteForChild(l)){c=e.serverCache.getNode();const d=MI(s,n,o.getNode(),c);d!=null?h=o.getNode().getImmediateChild(l).updateChild(u,d):h=o.getNode().getImmediateChild(l)}else h=by(s,l,e.serverCache);h!=null?a=t.filter.updateChild(o.getNode(),l,h,u,r,i):a=o.getNode()}}return Bc(e,a,o.isFullyInitialized()||pe(n),t.filter.filtersNodes())}}function nd(t,e,n,s,r,i,o,a){const c=e.serverCache;let l;const u=o?t.filter:t.filter.getIndexedFilter();if(pe(n))l=u.updateFullNode(c.getNode(),s,null);else if(u.filtersNodes()&&!c.isFiltered()){const f=c.getNode().updateChild(n,s);l=u.updateFullNode(c.getNode(),f,null)}else{const f=fe(n);if(!c.isCompleteForPath(n)&&Gr(n)>1)return e;const p=Me(n),y=c.getNode().getImmediateChild(f).updateChild(p,s);f===".priority"?l=u.updatePriority(c.getNode(),y):l=u.updateChild(c.getNode(),f,y,p,uk,null)}const h=rk(e,l,c.isFullyInitialized()||pe(n),u.filtersNodes()),d=new Iy(r,h,i);return hk(t,h,n,r,d,a)}function fm(t,e,n,s,r,i,o){const a=e.eventCache;let c,l;const u=new Iy(r,e,i);if(pe(n))l=t.filter.updateFullNode(e.eventCache.getNode(),s,o),c=Bc(e,l,!0,t.filter.filtersNodes());else{const h=fe(n);if(h===".priority")l=t.filter.updatePriority(e.eventCache.getNode(),s),c=Bc(e,l,a.isFullyInitialized(),a.isFiltered());else{const d=Me(n),f=a.getNode().getImmediateChild(h);let p;if(pe(d))p=s;else{const _=u.getCompleteChild(h);_!=null?uy(d)===".priority"&&_.getChild(zA(d)).isEmpty()?p=_:p=_.updateChild(d,s):p=te.EMPTY_NODE}if(f.equals(p))c=e;else{const _=t.filter.updateChild(a.getNode(),h,p,d,u,o);c=Bc(e,_,a.isFullyInitialized(),t.filter.filtersNodes())}}}return c}function LI(t,e){return t.eventCache.isCompleteForChild(e)}function KW(t,e,n,s,r,i,o){let a=e;return s.foreach((c,l)=>{const u=Ge(n,c);LI(e,fe(u))&&(a=fm(t,a,u,l,r,i,o))}),s.foreach((c,l)=>{const u=Ge(n,c);LI(e,fe(u))||(a=fm(t,a,u,l,r,i,o))}),a}function FI(t,e,n){return n.foreach((s,r)=>{e=e.updateChild(s,r)}),e}function pm(t,e,n,s,r,i,o,a){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let c=e,l;pe(n)?l=s:l=new Ve(null).setTree(n,s);const u=e.serverCache.getNode();return l.children.inorderTraversal((h,d)=>{if(u.hasChild(h)){const f=e.serverCache.getNode().getImmediateChild(h),p=FI(t,f,d);c=nd(t,c,new Ce(h),p,r,i,o,a)}}),l.children.inorderTraversal((h,d)=>{const f=!e.serverCache.isCompleteForChild(h)&&d.value===void 0;if(!u.hasChild(h)&&!f){const p=e.serverCache.getNode().getImmediateChild(h),_=FI(t,p,d);c=nd(t,c,new Ce(h),_,r,i,o,a)}}),c}function WW(t,e,n,s,r,i,o){if(td(r,n)!=null)return e;const a=e.serverCache.isFiltered(),c=e.serverCache;if(s.value!=null){if(pe(n)&&c.isFullyInitialized()||c.isCompleteForPath(n))return nd(t,e,n,c.getNode().getChild(n),r,i,a,o);if(pe(n)){let l=new Ve(null);return c.getNode().forEachChild(As,(u,h)=>{l=l.set(new Ce(u),h)}),pm(t,e,n,l,r,i,a,o)}else return e}else{let l=new Ve(null);return s.foreach((u,h)=>{const d=Ge(n,u);c.isCompleteForPath(d)&&(l=l.set(u,c.getNode().getChild(d)))}),pm(t,e,n,l,r,i,a,o)}}function HW(t,e,n,s,r){const i=e.serverCache,o=rk(e,i.getNode(),i.isFullyInitialized()||pe(n),i.isFiltered());return hk(t,o,n,s,uk,r)}function GW(t,e,n,s,r,i){let o;if(td(s,n)!=null)return e;{const a=new Iy(s,e,r),c=e.eventCache.getNode();let l;if(pe(n)||fe(n)===".priority"){let u;if(e.serverCache.isFullyInitialized())u=ed(s,Zi(e));else{const h=e.serverCache.getNode();x(h instanceof te,"serverChildren would be complete if leaf node"),u=wy(s,h)}u=u,l=t.filter.updateFullNode(c,u,i)}else{const u=fe(n);let h=by(s,u,e.serverCache);h==null&&e.serverCache.isCompleteForChild(u)&&(h=c.getImmediateChild(u)),h!=null?l=t.filter.updateChild(c,u,h,Me(n),a,i):e.eventCache.getNode().hasChild(u)?l=t.filter.updateChild(c,u,te.EMPTY_NODE,Me(n),a,i):l=c,l.isEmpty()&&e.serverCache.isFullyInitialized()&&(o=ed(s,Zi(e)),o.isLeafNode()&&(l=t.filter.updateFullNode(l,o,i)))}return o=e.serverCache.isFullyInitialized()||td(s,Te())!=null,Bc(e,l,o,t.filter.filtersNodes())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zW{constructor(e,n){this.query_=e,this.eventRegistrations_=[];const s=this.query_._queryParams,r=new my(s.getIndex()),i=cW(s);this.processor_=VW(i);const o=n.serverCache,a=n.eventCache,c=r.updateFullNode(te.EMPTY_NODE,o.getNode(),null),l=i.updateFullNode(te.EMPTY_NODE,a.getNode(),null),u=new zr(c,o.isFullyInitialized(),r.filtersNodes()),h=new zr(l,a.isFullyInitialized(),i.filtersNodes());this.viewCache_=mf(h,u),this.eventGenerator_=new vW(this.query_)}get query(){return this.query_}}function QW(t){return t.viewCache_.serverCache.getNode()}function YW(t){return Zh(t.viewCache_)}function JW(t,e){const n=Zi(t.viewCache_);return n&&(t.query._queryParams.loadsAllData()||!pe(e)&&!n.getImmediateChild(fe(e)).isEmpty())?n.getChild(e):null}function UI(t){return t.eventRegistrations_.length===0}function XW(t,e){t.eventRegistrations_.push(e)}function $I(t,e,n){const s=[];if(n){x(e==null,"A cancel should cancel all event registrations.");const r=t.query._path;t.eventRegistrations_.forEach(i=>{const o=i.createCancelEvent(n,r);o&&s.push(o)})}if(e){let r=[];for(let i=0;i<t.eventRegistrations_.length;++i){const o=t.eventRegistrations_[i];if(!o.matches(e))r.push(o);else if(e.hasAnyCallback()){r=r.concat(t.eventRegistrations_.slice(i+1));break}}t.eventRegistrations_=r}else t.eventRegistrations_=[];return s}function VI(t,e,n,s){e.type===ss.MERGE&&e.source.queryId!==null&&(x(Zi(t.viewCache_),"We should always have a full cache before handling merges"),x(Zh(t.viewCache_),"Missing event cache, even though we have a server cache"));const r=t.viewCache_,i=qW(t.processor_,r,e,n,s);return BW(t.processor_,i.viewCache),x(i.viewCache.serverCache.isFullyInitialized()||!r.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),t.viewCache_=i.viewCache,dk(t,i.changes,i.viewCache.eventCache.getNode(),null)}function ZW(t,e){const n=t.viewCache_.eventCache,s=[];return n.getNode().isLeafNode()||n.getNode().forEachChild(qe,(i,o)=>{s.push(va(i,o))}),n.isFullyInitialized()&&s.push(sk(n.getNode())),dk(t,s,n.getNode(),e)}function dk(t,e,n,s){const r=s?[s]:t.eventRegistrations_;return wW(t.eventGenerator_,e,n,r)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let sd;class fk{constructor(){this.views=new Map}}function eH(t){x(!sd,"__referenceConstructor has already been defined"),sd=t}function tH(){return x(sd,"Reference.ts has not been loaded"),sd}function nH(t){return t.views.size===0}function Ey(t,e,n,s){const r=e.source.queryId;if(r!==null){const i=t.views.get(r);return x(i!=null,"SyncTree gave us an op for an invalid query."),VI(i,e,n,s)}else{let i=[];for(const o of t.views.values())i=i.concat(VI(o,e,n,s));return i}}function Ty(t,e,n,s,r){const i=e._queryIdentifier,o=t.views.get(i);if(!o){let a=ed(n,r?s:null),c=!1;a?c=!0:s instanceof te?(a=wy(n,s),c=!1):(a=te.EMPTY_NODE,c=!1);const l=mf(new zr(a,c,!1),new zr(s,r,!1));return new zW(e,l)}return o}function sH(t,e,n,s,r,i){const o=Ty(t,e,s,r,i);return t.views.has(e._queryIdentifier)||t.views.set(e._queryIdentifier,o),XW(o,n),ZW(o,n)}function rH(t,e,n,s){const r=e._queryIdentifier,i=[];let o=[];const a=Qr(t);if(r==="default")for(const[c,l]of t.views.entries())o=o.concat($I(l,n,s)),UI(l)&&(t.views.delete(c),l.query._queryParams.loadsAllData()||i.push(l.query));else{const c=t.views.get(r);c&&(o=o.concat($I(c,n,s)),UI(c)&&(t.views.delete(r),c.query._queryParams.loadsAllData()||i.push(c.query)))}return a&&!Qr(t)&&i.push(new(tH())(e._repo,e._path)),{removed:i,events:o}}function pk(t){const e=[];for(const n of t.views.values())n.query._queryParams.loadsAllData()||e.push(n);return e}function Ur(t,e){let n=null;for(const s of t.views.values())n=n||JW(s,e);return n}function gk(t,e){if(e._queryParams.loadsAllData())return yf(t);{const s=e._queryIdentifier;return t.views.get(s)}}function mk(t,e){return gk(t,e)!=null}function Qr(t){return yf(t)!=null}function yf(t){for(const e of t.views.values())if(e.query._queryParams.loadsAllData())return e;return null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let rd;function iH(t){x(!rd,"__referenceConstructor has already been defined"),rd=t}function oH(){return x(rd,"Reference.ts has not been loaded"),rd}let aH=1;class BI{constructor(e){this.listenProvider_=e,this.syncPointTree_=new Ve(null),this.pendingWriteTree_=LW(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function Sy(t,e,n,s,r){return TW(t.pendingWriteTree_,e,n,s,r),r?Ha(t,new Xi(_y(),e,n)):[]}function cH(t,e,n,s){SW(t.pendingWriteTree_,e,n,s);const r=Ve.fromObject(n);return Ha(t,new wa(_y(),e,r))}function Dr(t,e,n=!1){const s=CW(t.pendingWriteTree_,e);if(AW(t.pendingWriteTree_,e)){let i=new Ve(null);return s.snap!=null?i=i.set(Te(),!0):Pt(s.children,o=>{i=i.set(new Ce(o),!0)}),Ha(t,new Xh(s.path,i,n))}else return[]}function hu(t,e,n){return Ha(t,new Xi(yy(),e,n))}function lH(t,e,n){const s=Ve.fromObject(n);return Ha(t,new wa(yy(),e,s))}function uH(t,e){return Ha(t,new Al(yy(),e))}function hH(t,e,n){const s=Cy(t,n);if(s){const r=Ay(s),i=r.path,o=r.queryId,a=cn(i,e),c=new Al(vy(o),a);return ky(t,i,c)}else return[]}function id(t,e,n,s){const r=e._path,i=t.syncPointTree_.get(r);let o=[];if(i&&(e._queryIdentifier==="default"||mk(i,e))){const a=rH(i,e,n,s);nH(i)&&(t.syncPointTree_=t.syncPointTree_.remove(r));const c=a.removed;o=a.events;const l=c.findIndex(h=>h._queryParams.loadsAllData())!==-1,u=t.syncPointTree_.findOnPath(r,(h,d)=>Qr(d));if(l&&!u){const h=t.syncPointTree_.subtree(r);if(!h.isEmpty()){const d=gH(h);for(let f=0;f<d.length;++f){const p=d[f],_=p.query,y=bk(t,p);t.listenProvider_.startListening(jc(_),kl(t,_),y.hashFn,y.onComplete)}}}!u&&c.length>0&&!s&&(l?t.listenProvider_.stopListening(jc(e),null):c.forEach(h=>{const d=t.queryToTagMap.get(wf(h));t.listenProvider_.stopListening(jc(h),d)})),mH(t,c)}return o}function dH(t,e){const{syncPoint:n,serverCache:s,writesCache:r,serverCacheComplete:i}=yk(e,t),o=Ty(n,e,r,s,i);return n.views.has(e._queryIdentifier)||n.views.set(e._queryIdentifier,o),e._queryParams.loadsAllData()?null:kl(t,e)}function _k(t,e,n,s){const r=Cy(t,s);if(r!=null){const i=Ay(r),o=i.path,a=i.queryId,c=cn(o,e),l=new Xi(vy(a),c,n);return ky(t,o,l)}else return[]}function fH(t,e,n,s){const r=Cy(t,s);if(r){const i=Ay(r),o=i.path,a=i.queryId,c=cn(o,e),l=Ve.fromObject(n),u=new wa(vy(a),c,l);return ky(t,o,u)}else return[]}function yk(t,e){const n=t._path;let s=null,r=!1;e.syncPointTree_.foreachOnPath(n,(l,u)=>{const h=cn(l,n);s=s||Ur(u,h),r=r||Qr(u)});let i=e.syncPointTree_.get(n);i?(r=r||Qr(i),s=s||Ur(i,Te())):(i=new fk,e.syncPointTree_=e.syncPointTree_.set(n,i));let o;s!=null?o=!0:(o=!1,s=te.EMPTY_NODE,e.syncPointTree_.subtree(n).foreachChild((u,h)=>{const d=Ur(h,Te());d&&(s=s.updateImmediateChild(u,d))}));const a=mk(i,t);if(!a&&!t._queryParams.loadsAllData()){const l=wf(t);x(!e.queryToTagMap.has(l),"View does not exist, but we have a tag");const u=_H();e.queryToTagMap.set(l,u),e.tagToQueryMap.set(u,l)}const c=_f(e.pendingWriteTree_,n);return{syncPoint:i,writesCache:c,serverCache:s,serverCacheComplete:o,foundAncestorDefaultView:r,viewAlreadyExists:a}}function qI(t,e,n){const{syncPoint:s,serverCache:r,writesCache:i,serverCacheComplete:o,viewAlreadyExists:a,foundAncestorDefaultView:c}=yk(e,t);let l=sH(s,e,n,i,r,o);if(!a&&!c){const u=gk(s,e);l=l.concat(yH(t,e,u))}return l}function vf(t,e,n){const r=t.pendingWriteTree_,i=t.syncPointTree_.findOnPath(e,(o,a)=>{const c=cn(o,e),l=Ur(a,c);if(l)return l});return ak(r,e,i,n,!0)}function pH(t,e){const n=e._path;let s=null;t.syncPointTree_.foreachOnPath(n,(l,u)=>{const h=cn(l,n);s=s||Ur(u,h)});let r=t.syncPointTree_.get(n);r?s=s||Ur(r,Te()):(r=new fk,t.syncPointTree_=t.syncPointTree_.set(n,r));const i=s!=null,o=i?new zr(s,!0,!1):null,a=_f(t.pendingWriteTree_,e._path),c=Ty(r,e,a,i?o.getNode():te.EMPTY_NODE,i);return YW(c)}function Ha(t,e){return vk(e,t.syncPointTree_,null,_f(t.pendingWriteTree_,Te()))}function vk(t,e,n,s){if(pe(t.path))return wk(t,e,n,s);{const r=e.get(Te());n==null&&r!=null&&(n=Ur(r,Te()));let i=[];const o=fe(t.path),a=t.operationForChild(o),c=e.children.get(o);if(c&&a){const l=n?n.getImmediateChild(o):null,u=ck(s,o);i=i.concat(vk(a,c,l,u))}return r&&(i=i.concat(Ey(r,t,s,n))),i}}function wk(t,e,n,s){const r=e.get(Te());n==null&&r!=null&&(n=Ur(r,Te()));let i=[];return e.children.inorderTraversal((o,a)=>{const c=n?n.getImmediateChild(o):null,l=ck(s,o),u=t.operationForChild(o);u&&(i=i.concat(wk(u,a,c,l)))}),r&&(i=i.concat(Ey(r,t,s,n))),i}function bk(t,e){const n=e.query,s=kl(t,n);return{hashFn:()=>(QW(e)||te.EMPTY_NODE).hash(),onComplete:r=>{if(r==="ok")return s?hH(t,n._path,s):uH(t,n._path);{const i=lK(r,n);return id(t,n,null,i)}}}}function kl(t,e){const n=wf(e);return t.queryToTagMap.get(n)}function wf(t){return t._path.toString()+"$"+t._queryIdentifier}function Cy(t,e){return t.tagToQueryMap.get(e)}function Ay(t){const e=t.indexOf("$");return x(e!==-1&&e<t.length-1,"Bad queryKey."),{queryId:t.substr(e+1),path:new Ce(t.substr(0,e))}}function ky(t,e,n){const s=t.syncPointTree_.get(e);x(s,"Missing sync point for query tag that we're tracking");const r=_f(t.pendingWriteTree_,e);return Ey(s,n,r,null)}function gH(t){return t.fold((e,n,s)=>{if(n&&Qr(n))return[yf(n)];{let r=[];return n&&(r=pk(n)),Pt(s,(i,o)=>{r=r.concat(o)}),r}})}function jc(t){return t._queryParams.loadsAllData()&&!t._queryParams.isDefault()?new(oH())(t._repo,t._path):t}function mH(t,e){for(let n=0;n<e.length;++n){const s=e[n];if(!s._queryParams.loadsAllData()){const r=wf(s),i=t.queryToTagMap.get(r);t.queryToTagMap.delete(r),t.tagToQueryMap.delete(i)}}}function _H(){return aH++}function yH(t,e,n){const s=e._path,r=kl(t,e),i=bk(t,n),o=t.listenProvider_.startListening(jc(e),r,i.hashFn,i.onComplete),a=t.syncPointTree_.subtree(s);if(r)x(!Qr(a.value),"If we're adding a query, it shouldn't be shadowed");else{const c=a.fold((l,u,h)=>{if(!pe(l)&&u&&Qr(u))return[yf(u).query];{let d=[];return u&&(d=d.concat(pk(u).map(f=>f.query))),Pt(h,(f,p)=>{d=d.concat(p)}),d}});for(let l=0;l<c.length;++l){const u=c[l];t.listenProvider_.stopListening(jc(u),kl(t,u))}}return o}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ry{constructor(e){this.node_=e}getImmediateChild(e){const n=this.node_.getImmediateChild(e);return new Ry(n)}node(){return this.node_}}class Ny{constructor(e,n){this.syncTree_=e,this.path_=n}getImmediateChild(e){const n=Ge(this.path_,e);return new Ny(this.syncTree_,n)}node(){return vf(this.syncTree_,this.path_)}}const vH=function(t){return t=t||{},t.timestamp=t.timestamp||new Date().getTime(),t},jI=function(t,e,n){if(!t||typeof t!="object")return t;if(x(".sv"in t,"Unexpected leaf node or priority contents"),typeof t[".sv"]=="string")return wH(t[".sv"],e,n);if(typeof t[".sv"]=="object")return bH(t[".sv"],e);x(!1,"Unexpected server value: "+JSON.stringify(t,null,2))},wH=function(t,e,n){switch(t){case"timestamp":return n.timestamp;default:x(!1,"Unexpected server value: "+t)}},bH=function(t,e,n){t.hasOwnProperty("increment")||x(!1,"Unexpected server value: "+JSON.stringify(t,null,2));const s=t.increment;typeof s!="number"&&x(!1,"Unexpected increment value: "+s);const r=e.node();if(x(r!==null&&typeof r!="undefined","Expected ChildrenNode.EMPTY_NODE for nulls"),!r.isLeafNode())return s;const o=r.getValue();return typeof o!="number"?s:o+s},Ik=function(t,e,n,s){return Dy(e,new Ny(n,t),s)},Py=function(t,e,n){return Dy(t,new Ry(e),n)};function Dy(t,e,n){const s=t.getPriority().val(),r=jI(s,e.getImmediateChild(".priority"),n);let i;if(t.isLeafNode()){const o=t,a=jI(o.getValue(),e,n);return a!==o.getValue()||r!==o.getPriority().val()?new yt(a,Qe(r)):t}else{const o=t;return i=o,r!==o.getPriority().val()&&(i=i.updatePriority(new yt(r))),o.forEachChild(qe,(a,c)=>{const l=Dy(c,e.getImmediateChild(a),n);l!==c&&(i=i.updateImmediateChild(a,l))}),i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xy{constructor(e="",n=null,s={children:{},childCount:0}){this.name=e,this.parent=n,this.node=s}}function bf(t,e){let n=e instanceof Ce?e:new Ce(e),s=t,r=fe(n);for(;r!==null;){const i=Hi(s.node.children,r)||{children:{},childCount:0};s=new xy(r,s,i),n=Me(n),r=fe(n)}return s}function So(t){return t.node.value}function Oy(t,e){t.node.value=e,gm(t)}function Ek(t){return t.node.childCount>0}function IH(t){return So(t)===void 0&&!Ek(t)}function If(t,e){Pt(t.node.children,(n,s)=>{e(new xy(n,t,s))})}function Tk(t,e,n,s){n&&!s&&e(t),If(t,r=>{Tk(r,e,!0,s)}),n&&s&&e(t)}function EH(t,e,n){let s=n?t:t.parent;for(;s!==null;){if(e(s))return!0;s=s.parent}return!1}function du(t){return new Ce(t.parent===null?t.name:du(t.parent)+"/"+t.name)}function gm(t){t.parent!==null&&TH(t.parent,t.name,t)}function TH(t,e,n){const s=IH(n),r=Dn(t.node.children,e);s&&r?(delete t.node.children[e],t.node.childCount--,gm(t)):!s&&!r&&(t.node.children[e]=n.node,t.node.childCount++,gm(t))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SH=/[\[\].#$\/\u0000-\u001F\u007F]/,CH=/[\[\].#$\u0000-\u001F\u007F]/,Bp=10*1024*1024,Ef=function(t){return typeof t=="string"&&t.length!==0&&!SH.test(t)},Sk=function(t){return typeof t=="string"&&t.length!==0&&!CH.test(t)},AH=function(t){return t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),Sk(t)},Rl=function(t){return t===null||typeof t=="string"||typeof t=="number"&&!df(t)||t&&typeof t=="object"&&Dn(t,".sv")},Ls=function(t,e,n,s){s&&e===void 0||fu(wn(t,"value"),e,n)},fu=function(t,e,n){const s=n instanceof Ce?new BK(n,t):n;if(e===void 0)throw new Error(t+"contains undefined "+bi(s));if(typeof e=="function")throw new Error(t+"contains a function "+bi(s)+" with contents = "+e.toString());if(df(e))throw new Error(t+"contains "+e.toString()+" "+bi(s));if(typeof e=="string"&&e.length>Bp/3&&Qd(e)>Bp)throw new Error(t+"contains a string greater than "+Bp+" utf8 bytes "+bi(s)+" ('"+e.substring(0,50)+"...')");if(e&&typeof e=="object"){let r=!1,i=!1;if(Pt(e,(o,a)=>{if(o===".value")r=!0;else if(o!==".priority"&&o!==".sv"&&(i=!0,!Ef(o)))throw new Error(t+" contains an invalid key ("+o+") "+bi(s)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);qK(s,o),fu(t,a,s),jK(s)}),r&&i)throw new Error(t+' contains ".value" child '+bi(s)+" in addition to actual children.")}},kH=function(t,e){let n,s;for(n=0;n<e.length;n++){s=e[n];const i=El(s);for(let o=0;o<i.length;o++)if(!(i[o]===".priority"&&o===i.length-1)){if(!Ef(i[o]))throw new Error(t+"contains an invalid key ("+i[o]+") in path "+s.toString()+`. Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`)}}e.sort(VK);let r=null;for(n=0;n<e.length;n++){if(s=e[n],r!==null&&$n(r,s))throw new Error(t+"contains a path "+r.toString()+" that is ancestor of another path "+s.toString());r=s}},Ck=function(t,e,n,s){if(s&&e===void 0)return;const r=wn(t,"values");if(!(e&&typeof e=="object")||Array.isArray(e))throw new Error(r+" must be an object containing the children to replace.");const i=[];Pt(e,(o,a)=>{const c=new Ce(o);if(fu(r,a,Ge(n,c)),uy(c)===".priority"&&!Rl(a))throw new Error(r+"contains an invalid value for '"+c.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");i.push(c)}),kH(r,i)},My=function(t,e,n){if(!(n&&e===void 0)){if(df(e))throw new Error(wn(t,"priority")+"is "+e.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!Rl(e))throw new Error(wn(t,"priority")+"must be a valid Firebase priority (a string, finite number, server value, or null).")}},pu=function(t,e,n,s){if(!(s&&n===void 0)&&!Ef(n))throw new Error(wn(t,e)+'was an invalid key = "'+n+`".  Firebase keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]").`)},Nl=function(t,e,n,s){if(!(s&&n===void 0)&&!Sk(n))throw new Error(wn(t,e)+'was an invalid path = "'+n+`". Paths must be non-empty strings and can't contain ".", "#", "$", "[", or "]"`)},RH=function(t,e,n,s){n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),Nl(t,e,n,s)},Vn=function(t,e){if(fe(e)===".info")throw new Error(t+" failed = Can't modify data under /.info/")},Ak=function(t,e){const n=e.path.toString();if(typeof e.repoInfo.host!="string"||e.repoInfo.host.length===0||!Ef(e.repoInfo.namespace)&&e.repoInfo.host.split(":")[0]!=="localhost"||n.length!==0&&!AH(n))throw new Error(wn(t,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NH{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function Tf(t,e){let n=null;for(let s=0;s<e.length;s++){const r=e[s],i=r.getPath();n!==null&&!hy(i,n.path)&&(t.eventLists_.push(n),n=null),n===null&&(n={events:[],path:i}),n.events.push(r)}n&&t.eventLists_.push(n)}function kk(t,e,n){Tf(t,n),Rk(t,s=>hy(s,e))}function Gn(t,e,n){Tf(t,n),Rk(t,s=>$n(s,e)||$n(e,s))}function Rk(t,e){t.recursionDepth_++;let n=!0;for(let s=0;s<t.eventLists_.length;s++){const r=t.eventLists_[s];if(r){const i=r.path;e(i)?(PH(t.eventLists_[s]),t.eventLists_[s]=null):n=!1}}n&&(t.eventLists_=[]),t.recursionDepth_--}function PH(t){for(let e=0;e<t.events.length;e++){const n=t.events[e];if(n!==null){t.events[e]=null;const s=n.getEventRunner();Ki&&Et("event: "+n.toString()),Ka(s)}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nk="repo_interrupt",DH=25;class xH{constructor(e,n,s,r){this.repoInfo_=e,this.forceRestClient_=n,this.authTokenProvider_=s,this.appCheckProvider_=r,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new NH,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=Jh(),this.transactionQueueTree_=new xy,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function OH(t,e,n){if(t.stats_=cy(t.repoInfo_),t.forceRestClient_||hK())t.server_=new Yh(t.repoInfo_,(s,r,i,o)=>{KI(t,s,r,i,o)},t.authTokenProvider_,t.appCheckProvider_),setTimeout(()=>WI(t,!0),0);else{if(typeof n!="undefined"&&n!==null){if(typeof n!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{gt(n)}catch(s){throw new Error("Invalid authOverride provided: "+s)}}t.persistentConnection_=new tr(t.repoInfo_,e,(s,r,i,o)=>{KI(t,s,r,i,o)},s=>{WI(t,s)},s=>{MH(t,s)},t.authTokenProvider_,t.appCheckProvider_,n),t.server_=t.persistentConnection_}t.authTokenProvider_.addTokenChangeListener(s=>{t.server_.refreshAuthToken(s)}),t.appCheckProvider_.addTokenChangeListener(s=>{t.server_.refreshAppCheckToken(s.token)}),t.statsReporter_=mK(t.repoInfo_,()=>new yW(t.stats_,t.server_)),t.infoData_=new fW,t.infoSyncTree_=new BI({startListening:(s,r,i,o)=>{let a=[];const c=t.infoData_.getNode(s._path);return c.isEmpty()||(a=hu(t.infoSyncTree_,s._path,c),setTimeout(()=>{o("ok")},0)),a},stopListening:()=>{}}),Ly(t,"connected",!1),t.serverSyncTree_=new BI({startListening:(s,r,i,o)=>(t.server_.listen(s,i,r,(a,c)=>{const l=o(a,c);Gn(t.eventQueue_,s._path,l)}),[]),stopListening:(s,r)=>{t.server_.unlisten(s,r)}})}function Pk(t){const n=t.infoData_.getNode(new Ce(".info/serverTimeOffset")).val()||0;return new Date().getTime()+n}function gu(t){return vH({timestamp:Pk(t)})}function KI(t,e,n,s,r){t.dataUpdateCount++;const i=new Ce(e);n=t.interceptServerDataCallback_?t.interceptServerDataCallback_(e,n):n;let o=[];if(r)if(s){const c=Oh(n,l=>Qe(l));o=fH(t.serverSyncTree_,i,c,r)}else{const c=Qe(n);o=_k(t.serverSyncTree_,i,c,r)}else if(s){const c=Oh(n,l=>Qe(l));o=lH(t.serverSyncTree_,i,c)}else{const c=Qe(n);o=hu(t.serverSyncTree_,i,c)}let a=i;o.length>0&&(a=Ia(t,i)),Gn(t.eventQueue_,a,o)}function WI(t,e){Ly(t,"connected",e),e===!1&&UH(t)}function MH(t,e){Pt(e,(n,s)=>{Ly(t,n,s)})}function Ly(t,e,n){const s=new Ce("/.info/"+e),r=Qe(n);t.infoData_.updateSnapshot(s,r);const i=hu(t.infoSyncTree_,s,r);Gn(t.eventQueue_,s,i)}function Sf(t){return t.nextWriteId_++}function LH(t,e){const n=pH(t.serverSyncTree_,e);return n!=null?Promise.resolve(n):t.server_.get(e).then(s=>{const r=Qe(s).withIndex(e._queryParams.getIndex());if(e._queryParams.loadsAllData())hu(t.serverSyncTree_,e._path,r);else{const o=dH(t.serverSyncTree_,e);_k(t.serverSyncTree_,e._path,r,o)}return id(t.serverSyncTree_,e,null).length>0&&eo(t,"unexpected cancel events in repoGetValue"),r},s=>(eo(t,"get for query "+gt(e)+" failed: "+s),Promise.reject(new Error(s))))}function Fy(t,e,n,s,r){eo(t,"set",{path:e.toString(),value:n,priority:s});const i=gu(t),o=Qe(n,s),a=vf(t.serverSyncTree_,e),c=Py(o,a,i),l=Sf(t),u=Sy(t.serverSyncTree_,e,c,l,!0);Tf(t.eventQueue_,u),t.server_.put(e.toString(),o.val(!0),(d,f)=>{const p=d==="ok";p||Yt("set at "+e+" failed: "+d);const _=Dr(t.serverSyncTree_,l,!p);Gn(t.eventQueue_,e,_),Yr(t,r,d,f)});const h=$y(t,e);Ia(t,h),Gn(t.eventQueue_,h,[])}function FH(t,e,n,s){eo(t,"update",{path:e.toString(),value:n});let r=!0;const i=gu(t),o={};if(Pt(n,(a,c)=>{r=!1,o[a]=Ik(Ge(e,a),Qe(c),t.serverSyncTree_,i)}),r)Et("update() called with empty data.  Don't do anything."),Yr(t,s,"ok",void 0);else{const a=Sf(t),c=cH(t.serverSyncTree_,e,o,a);Tf(t.eventQueue_,c),t.server_.merge(e.toString(),n,(l,u)=>{const h=l==="ok";h||Yt("update at "+e+" failed: "+l);const d=Dr(t.serverSyncTree_,a,!h),f=d.length>0?Ia(t,e):e;Gn(t.eventQueue_,f,d),Yr(t,s,l,u)}),Pt(n,l=>{const u=$y(t,Ge(e,l));Ia(t,u)}),Gn(t.eventQueue_,e,[])}}function UH(t){eo(t,"onDisconnectEvents");const e=gu(t),n=Jh();lm(t.onDisconnect_,Te(),(r,i)=>{const o=Ik(r,i,t.serverSyncTree_,e);Wa(n,r,o)});let s=[];lm(n,Te(),(r,i)=>{s=s.concat(hu(t.serverSyncTree_,r,i));const o=$y(t,r);Ia(t,o)}),t.onDisconnect_=Jh(),Gn(t.eventQueue_,Te(),s)}function $H(t,e,n){t.server_.onDisconnectCancel(e.toString(),(s,r)=>{s==="ok"&&cm(t.onDisconnect_,e),Yr(t,n,s,r)})}function HI(t,e,n,s){const r=Qe(n);t.server_.onDisconnectPut(e.toString(),r.val(!0),(i,o)=>{i==="ok"&&Wa(t.onDisconnect_,e,r),Yr(t,s,i,o)})}function VH(t,e,n,s,r){const i=Qe(n,s);t.server_.onDisconnectPut(e.toString(),i.val(!0),(o,a)=>{o==="ok"&&Wa(t.onDisconnect_,e,i),Yr(t,r,o,a)})}function BH(t,e,n,s){if(xh(n)){Et("onDisconnect().update() called with empty data.  Don't do anything."),Yr(t,s,"ok",void 0);return}t.server_.onDisconnectMerge(e.toString(),n,(r,i)=>{r==="ok"&&Pt(n,(o,a)=>{const c=Qe(a);Wa(t.onDisconnect_,Ge(e,o),c)}),Yr(t,s,r,i)})}function qH(t,e,n){let s;fe(e._path)===".info"?s=qI(t.infoSyncTree_,e,n):s=qI(t.serverSyncTree_,e,n),kk(t.eventQueue_,e._path,s)}function mm(t,e,n){let s;fe(e._path)===".info"?s=id(t.infoSyncTree_,e,n):s=id(t.serverSyncTree_,e,n),kk(t.eventQueue_,e._path,s)}function Dk(t){t.persistentConnection_&&t.persistentConnection_.interrupt(Nk)}function jH(t){t.persistentConnection_&&t.persistentConnection_.resume(Nk)}function eo(t,...e){let n="";t.persistentConnection_&&(n=t.persistentConnection_.id+":"),Et(n,...e)}function Yr(t,e,n,s){e&&Ka(()=>{if(n==="ok")e(null);else{const r=(n||"error").toUpperCase();let i=r;s&&(i+=": "+s);const o=new Error(i);o.code=r,e(o)}})}function KH(t,e,n,s,r,i){eo(t,"transaction on "+e);const o={path:e,update:n,onComplete:s,status:null,order:TA(),applyLocally:i,retryCount:0,unwatcher:r,abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},a=Uy(t,e,void 0);o.currentInputSnapshot=a;const c=o.update(a.val());if(c===void 0)o.unwatcher(),o.currentOutputSnapshotRaw=null,o.currentOutputSnapshotResolved=null,o.onComplete&&o.onComplete(null,!1,o.currentInputSnapshot);else{fu("transaction failed: Data returned ",c,o.path),o.status=0;const l=bf(t.transactionQueueTree_,e),u=So(l)||[];u.push(o),Oy(l,u);let h;typeof c=="object"&&c!==null&&Dn(c,".priority")?(h=Hi(c,".priority"),x(Rl(h),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.")):h=(vf(t.serverSyncTree_,e)||te.EMPTY_NODE).getPriority().val();const d=gu(t),f=Qe(c,h),p=Py(f,a,d);o.currentOutputSnapshotRaw=f,o.currentOutputSnapshotResolved=p,o.currentWriteId=Sf(t);const _=Sy(t.serverSyncTree_,e,p,o.currentWriteId,o.applyLocally);Gn(t.eventQueue_,e,_),Cf(t,t.transactionQueueTree_)}}function Uy(t,e,n){return vf(t.serverSyncTree_,e,n)||te.EMPTY_NODE}function Cf(t,e=t.transactionQueueTree_){if(e||Af(t,e),So(e)){const n=Ok(t,e);x(n.length>0,"Sending zero length transaction queue"),n.every(r=>r.status===0)&&WH(t,du(e),n)}else Ek(e)&&If(e,n=>{Cf(t,n)})}function WH(t,e,n){const s=n.map(l=>l.currentWriteId),r=Uy(t,e,s);let i=r;const o=r.hash();for(let l=0;l<n.length;l++){const u=n[l];x(u.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),u.status=1,u.retryCount++;const h=cn(e,u.path);i=i.updateChild(h,u.currentOutputSnapshotRaw)}const a=i.val(!0),c=e;t.server_.put(c.toString(),a,l=>{eo(t,"transaction put response",{path:c.toString(),status:l});let u=[];if(l==="ok"){const h=[];for(let d=0;d<n.length;d++)n[d].status=2,u=u.concat(Dr(t.serverSyncTree_,n[d].currentWriteId)),n[d].onComplete&&h.push(()=>n[d].onComplete(null,!0,n[d].currentOutputSnapshotResolved)),n[d].unwatcher();Af(t,bf(t.transactionQueueTree_,e)),Cf(t,t.transactionQueueTree_),Gn(t.eventQueue_,e,u);for(let d=0;d<h.length;d++)Ka(h[d])}else{if(l==="datastale")for(let h=0;h<n.length;h++)n[h].status===3?n[h].status=4:n[h].status=0;else{Yt("transaction at "+c.toString()+" failed: "+l);for(let h=0;h<n.length;h++)n[h].status=4,n[h].abortReason=l}Ia(t,e)}},o)}function Ia(t,e){const n=xk(t,e),s=du(n),r=Ok(t,n);return HH(t,r,s),s}function HH(t,e,n){if(e.length===0)return;const s=[];let r=[];const o=e.filter(a=>a.status===0).map(a=>a.currentWriteId);for(let a=0;a<e.length;a++){const c=e[a],l=cn(n,c.path);let u=!1,h;if(x(l!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),c.status===4)u=!0,h=c.abortReason,r=r.concat(Dr(t.serverSyncTree_,c.currentWriteId,!0));else if(c.status===0)if(c.retryCount>=DH)u=!0,h="maxretry",r=r.concat(Dr(t.serverSyncTree_,c.currentWriteId,!0));else{const d=Uy(t,c.path,o);c.currentInputSnapshot=d;const f=e[a].update(d.val());if(f!==void 0){fu("transaction failed: Data returned ",f,c.path);let p=Qe(f);typeof f=="object"&&f!=null&&Dn(f,".priority")||(p=p.updatePriority(d.getPriority()));const y=c.currentWriteId,I=gu(t),N=Py(p,d,I);c.currentOutputSnapshotRaw=p,c.currentOutputSnapshotResolved=N,c.currentWriteId=Sf(t),o.splice(o.indexOf(y),1),r=r.concat(Sy(t.serverSyncTree_,c.path,N,c.currentWriteId,c.applyLocally)),r=r.concat(Dr(t.serverSyncTree_,y,!0))}else u=!0,h="nodata",r=r.concat(Dr(t.serverSyncTree_,c.currentWriteId,!0))}Gn(t.eventQueue_,n,r),r=[],u&&(e[a].status=2,function(d){setTimeout(d,Math.floor(0))}(e[a].unwatcher),e[a].onComplete&&(h==="nodata"?s.push(()=>e[a].onComplete(null,!1,e[a].currentInputSnapshot)):s.push(()=>e[a].onComplete(new Error(h),!1,null))))}Af(t,t.transactionQueueTree_);for(let a=0;a<s.length;a++)Ka(s[a]);Cf(t,t.transactionQueueTree_)}function xk(t,e){let n,s=t.transactionQueueTree_;for(n=fe(e);n!==null&&So(s)===void 0;)s=bf(s,n),e=Me(e),n=fe(e);return s}function Ok(t,e){const n=[];return Mk(t,e,n),n.sort((s,r)=>s.order-r.order),n}function Mk(t,e,n){const s=So(e);if(s)for(let r=0;r<s.length;r++)n.push(s[r]);If(e,r=>{Mk(t,r,n)})}function Af(t,e){const n=So(e);if(n){let s=0;for(let r=0;r<n.length;r++)n[r].status!==2&&(n[s]=n[r],s++);n.length=s,Oy(e,n.length>0?n:void 0)}If(e,s=>{Af(t,s)})}function $y(t,e){const n=du(xk(t,e)),s=bf(t.transactionQueueTree_,e);return EH(s,r=>{qp(t,r)}),qp(t,s),Tk(s,r=>{qp(t,r)}),n}function qp(t,e){const n=So(e);if(n){const s=[];let r=[],i=-1;for(let o=0;o<n.length;o++)n[o].status===3||(n[o].status===1?(x(i===o-1,"All SENT items should be at beginning of queue."),i=o,n[o].status=3,n[o].abortReason="set"):(x(n[o].status===0,"Unexpected transaction status in abort"),n[o].unwatcher(),r=r.concat(Dr(t.serverSyncTree_,n[o].currentWriteId,!0)),n[o].onComplete&&s.push(n[o].onComplete.bind(null,new Error("set"),!1,null))));i===-1?Oy(e,void 0):n.length=i+1,Gn(t.eventQueue_,du(e),r);for(let o=0;o<s.length;o++)Ka(s[o])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GH(t){let e="";const n=t.split("/");for(let s=0;s<n.length;s++)if(n[s].length>0){let r=n[s];try{r=decodeURIComponent(r.replace(/\+/g," "))}catch{}e+="/"+r}return e}function zH(t){const e={};t.charAt(0)==="?"&&(t=t.substring(1));for(const n of t.split("&")){if(n.length===0)continue;const s=n.split("=");s.length===2?e[decodeURIComponent(s[0])]=decodeURIComponent(s[1]):Yt(`Invalid query segment '${n}' in query '${t}'`)}return e}const _m=function(t,e){const n=QH(t),s=n.namespace;n.domain==="firebase.com"&&Os(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!s||s==="undefined")&&n.domain!=="localhost"&&Os("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||rK();const r=n.scheme==="ws"||n.scheme==="wss";return{repoInfo:new $A(n.host,n.secure,s,r,e,"",s!==n.subdomain),path:new Ce(n.pathString)}},QH=function(t){let e="",n="",s="",r="",i="",o=!0,a="https",c=443;if(typeof t=="string"){let l=t.indexOf("//");l>=0&&(a=t.substring(0,l-1),t=t.substring(l+2));let u=t.indexOf("/");u===-1&&(u=t.length);let h=t.indexOf("?");h===-1&&(h=t.length),e=t.substring(0,Math.min(u,h)),u<h&&(r=GH(t.substring(u,h)));const d=zH(t.substring(Math.min(t.length,h)));l=e.indexOf(":"),l>=0?(o=a==="https"||a==="wss",c=parseInt(e.substring(l+1),10)):l=e.length;const f=e.slice(0,l);if(f.toLowerCase()==="localhost")n="localhost";else if(f.split(".").length<=2)n=f;else{const p=e.indexOf(".");s=e.substring(0,p).toLowerCase(),n=e.substring(p+1),i=s}"ns"in d&&(i=d.ns)}return{host:e,port:c,domain:n,subdomain:s,secure:o,scheme:a,pathString:r,namespace:i}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lk{constructor(e,n,s,r){this.eventType=e,this.eventRegistration=n,this.snapshot=s,this.prevName=r}getPath(){const e=this.snapshot.ref;return this.eventType==="value"?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+gt(this.snapshot.exportVal())}}class Fk{constructor(e,n,s){this.eventRegistration=e,this.error=n,this.path=s}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uk{constructor(e,n){this.snapshotCallback=e,this.cancelCallback=n}onValue(e,n){this.snapshotCallback.call(null,e,n)}onCancel(e){return x(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||this.snapshotCallback.userCallback!==void 0&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YH{constructor(e,n){this._repo=e,this._path=n}cancel(){const e=new pt;return $H(this._repo,this._path,e.wrapCallback(()=>{})),e.promise}remove(){Vn("OnDisconnect.remove",this._path);const e=new pt;return HI(this._repo,this._path,null,e.wrapCallback(()=>{})),e.promise}set(e){Vn("OnDisconnect.set",this._path),Ls("OnDisconnect.set",e,this._path,!1);const n=new pt;return HI(this._repo,this._path,e,n.wrapCallback(()=>{})),n.promise}setWithPriority(e,n){Vn("OnDisconnect.setWithPriority",this._path),Ls("OnDisconnect.setWithPriority",e,this._path,!1),My("OnDisconnect.setWithPriority",n,!1);const s=new pt;return VH(this._repo,this._path,e,n,s.wrapCallback(()=>{})),s.promise}update(e){Vn("OnDisconnect.update",this._path),Ck("OnDisconnect.update",e,this._path,!1);const n=new pt;return BH(this._repo,this._path,e,n.wrapCallback(()=>{})),n.promise}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class In{constructor(e,n,s,r){this._repo=e,this._path=n,this._queryParams=s,this._orderByCalled=r}get key(){return pe(this._path)?null:uy(this._path)}get ref(){return new Qn(this._repo,this._path)}get _queryIdentifier(){const e=PI(this._queryParams),n=iy(e);return n==="{}"?"default":n}get _queryObject(){return PI(this._queryParams)}isEqual(e){if(e=A(e),!(e instanceof In))return!1;const n=this._repo===e._repo,s=hy(this._path,e._path),r=this._queryIdentifier===e._queryIdentifier;return n&&s&&r}toJSON(){return this.toString()}toString(){return this._repo.toString()+$K(this._path)}}function kf(t,e){if(t._orderByCalled===!0)throw new Error(e+": You can't combine multiple orderBy calls.")}function ii(t){let e=null,n=null;if(t.hasStart()&&(e=t.getIndexStartValue()),t.hasEnd()&&(n=t.getIndexEndValue()),t.getIndex()===As){const s="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",r="Query: When ordering by key, the argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() must be a string.";if(t.hasStart()){if(t.getIndexStartName()!==ir)throw new Error(s);if(typeof e!="string")throw new Error(r)}if(t.hasEnd()){if(t.getIndexEndName()!==Ms)throw new Error(s);if(typeof n!="string")throw new Error(r)}}else if(t.getIndex()===qe){if(e!=null&&!Rl(e)||n!=null&&!Rl(n))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), startAfter() endAt(), endBefore(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if(x(t.getIndex()instanceof py||t.getIndex()===gy,"unknown index type."),e!=null&&typeof e=="object"||n!=null&&typeof n=="object")throw new Error("Query: First argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() cannot be an object.")}function Rf(t){if(t.hasStart()&&t.hasEnd()&&t.hasLimit()&&!t.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), startAfter(), endAt(), endBefore(), and limit(). Use limitToFirst() or limitToLast() instead.")}class Qn extends In{constructor(e,n){super(e,n,new pf,!1)}get parent(){const e=zA(this._path);return e===null?null:new Qn(this._repo,e)}get root(){let e=this;for(;e.parent!==null;)e=e.parent;return e}}class to{constructor(e,n,s){this._node=e,this.ref=n,this._index=s}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){const n=new Ce(e),s=no(this.ref,e);return new to(this._node.getChild(n),s,qe)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return this._node.isLeafNode()?!1:!!this._node.forEachChild(this._index,(s,r)=>e(new to(r,no(this.ref,s),qe)))}hasChild(e){const n=new Ce(e);return!this._node.getChild(n).isEmpty()}hasChildren(){return this._node.isLeafNode()?!1:!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}}function $k(t,e){return t=A(t),t._checkNotDeleted("ref"),e!==void 0?no(t._root,e):t._root}function GI(t,e){t=A(t),t._checkNotDeleted("refFromURL");const n=_m(e,t._repo.repoInfo_.nodeAdmin);Ak("refFromURL",n);const s=n.repoInfo;return!t._repo.repoInfo_.isCustomHost()&&s.host!==t._repo.repoInfo_.host&&Os("refFromURL: Host name does not match the current database: (found "+s.host+" but expected "+t._repo.repoInfo_.host+")"),$k(t,n.path.toString())}function no(t,e){return t=A(t),fe(t._path)===null?RH("child","path",e,!1):Nl("child","path",e,!1),new Qn(t._repo,Ge(t._path,e))}function JH(t,e){t=A(t),Vn("push",t._path),Ls("push",e,t._path,!0);const n=Pk(t._repo),s=iW(n),r=no(t,s),i=no(t,s);let o;return e!=null?o=Vy(i,e).then(()=>i):o=Promise.resolve(i),r.then=o.then.bind(o),r.catch=o.then.bind(o,void 0),r}function XH(t){return Vn("remove",t._path),Vy(t,null)}function Vy(t,e){t=A(t),Vn("set",t._path),Ls("set",e,t._path,!1);const n=new pt;return Fy(t._repo,t._path,e,null,n.wrapCallback(()=>{})),n.promise}function ZH(t,e){t=A(t),Vn("setPriority",t._path),My("setPriority",e,!1);const n=new pt;return Fy(t._repo,Ge(t._path,".priority"),e,null,n.wrapCallback(()=>{})),n.promise}function eG(t,e,n){if(Vn("setWithPriority",t._path),Ls("setWithPriority",e,t._path,!1),My("setWithPriority",n,!1),t.key===".length"||t.key===".keys")throw"setWithPriority failed: "+t.key+" is a read-only object.";const s=new pt;return Fy(t._repo,t._path,e,n,s.wrapCallback(()=>{})),s.promise}function tG(t,e){Ck("update",e,t._path,!1);const n=new pt;return FH(t._repo,t._path,e,n.wrapCallback(()=>{})),n.promise}function nG(t){return t=A(t),LH(t._repo,t).then(e=>new to(e,new Qn(t._repo,t._path),t._queryParams.getIndex()))}class Nf{constructor(e){this.callbackContext=e}respondsTo(e){return e==="value"}createEvent(e,n){const s=n._queryParams.getIndex();return new Lk("value",this,new to(e.snapshotNode,new Qn(n._repo,n._path),s))}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,n){return this.callbackContext.hasCancelCallback?new Fk(this,e,n):null}matches(e){return e instanceof Nf?!e.callbackContext||!this.callbackContext?!0:e.callbackContext.matches(this.callbackContext):!1}hasAnyCallback(){return this.callbackContext!==null}}class Pf{constructor(e,n){this.eventType=e,this.callbackContext=n}respondsTo(e){let n=e==="children_added"?"child_added":e;return n=n==="children_removed"?"child_removed":n,this.eventType===n}createCancelEvent(e,n){return this.callbackContext.hasCancelCallback?new Fk(this,e,n):null}createEvent(e,n){x(e.childName!=null,"Child events should have a childName.");const s=no(new Qn(n._repo,n._path),e.childName),r=n._queryParams.getIndex();return new Lk(e.type,this,new to(e.snapshotNode,s,r),e.prevName)}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,e.prevName)}matches(e){return e instanceof Pf?this.eventType===e.eventType&&(!this.callbackContext||!e.callbackContext||this.callbackContext.matches(e.callbackContext)):!1}hasAnyCallback(){return!!this.callbackContext}}function mu(t,e,n,s,r){let i;if(typeof s=="object"&&(i=void 0,r=s),typeof s=="function"&&(i=s),r&&r.onlyOnce){const c=n,l=(u,h)=>{mm(t._repo,t,a),c(u,h)};l.userCallback=n.userCallback,l.context=n.context,n=l}const o=new Uk(n,i||void 0),a=e==="value"?new Nf(o):new Pf(e,o);return qH(t._repo,t,a),()=>mm(t._repo,t,a)}function ym(t,e,n,s){return mu(t,"value",e,n,s)}function zI(t,e,n,s){return mu(t,"child_added",e,n,s)}function QI(t,e,n,s){return mu(t,"child_changed",e,n,s)}function YI(t,e,n,s){return mu(t,"child_moved",e,n,s)}function JI(t,e,n,s){return mu(t,"child_removed",e,n,s)}function XI(t,e,n){let s=null;const r=n?new Uk(n):null;e==="value"?s=new Nf(r):e&&(s=new Pf(e,r)),mm(t._repo,t,s)}class hs{}class Vk extends hs{constructor(e,n){super(),this._value=e,this._key=n}_apply(e){Ls("endAt",this._value,e._path,!0);const n=am(e._queryParams,this._value,this._key);if(Rf(n),ii(n),e._queryParams.hasEnd())throw new Error("endAt: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new In(e._repo,e._path,n,e._orderByCalled)}}function sG(t,e){return pu("endAt","key",e,!0),new Vk(t,e)}class rG extends hs{constructor(e,n){super(),this._value=e,this._key=n}_apply(e){Ls("endBefore",this._value,e._path,!1);const n=dW(e._queryParams,this._value,this._key);if(Rf(n),ii(n),e._queryParams.hasEnd())throw new Error("endBefore: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new In(e._repo,e._path,n,e._orderByCalled)}}function iG(t,e){return pu("endBefore","key",e,!0),new rG(t,e)}class Bk extends hs{constructor(e,n){super(),this._value=e,this._key=n}_apply(e){Ls("startAt",this._value,e._path,!0);const n=om(e._queryParams,this._value,this._key);if(Rf(n),ii(n),e._queryParams.hasStart())throw new Error("startAt: Starting point was already set (by another call to startAt, startBefore or equalTo).");return new In(e._repo,e._path,n,e._orderByCalled)}}function oG(t=null,e){return pu("startAt","key",e,!0),new Bk(t,e)}class aG extends hs{constructor(e,n){super(),this._value=e,this._key=n}_apply(e){Ls("startAfter",this._value,e._path,!1);const n=hW(e._queryParams,this._value,this._key);if(Rf(n),ii(n),e._queryParams.hasStart())throw new Error("startAfter: Starting point was already set (by another call to startAt, startAfter, or equalTo).");return new In(e._repo,e._path,n,e._orderByCalled)}}function cG(t,e){return pu("startAfter","key",e,!0),new aG(t,e)}class lG extends hs{constructor(e){super(),this._limit=e}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToFirst: Limit was already set (by another call to limitToFirst or limitToLast).");return new In(e._repo,e._path,lW(e._queryParams,this._limit),e._orderByCalled)}}function uG(t){if(typeof t!="number"||Math.floor(t)!==t||t<=0)throw new Error("limitToFirst: First argument must be a positive integer.");return new lG(t)}class hG extends hs{constructor(e){super(),this._limit=e}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToLast: Limit was already set (by another call to limitToFirst or limitToLast).");return new In(e._repo,e._path,uW(e._queryParams,this._limit),e._orderByCalled)}}function dG(t){if(typeof t!="number"||Math.floor(t)!==t||t<=0)throw new Error("limitToLast: First argument must be a positive integer.");return new hG(t)}class fG extends hs{constructor(e){super(),this._path=e}_apply(e){kf(e,"orderByChild");const n=new Ce(this._path);if(pe(n))throw new Error("orderByChild: cannot pass in empty path. Use orderByValue() instead.");const s=new py(n),r=gf(e._queryParams,s);return ii(r),new In(e._repo,e._path,r,!0)}}function pG(t){if(t==="$key")throw new Error('orderByChild: "$key" is invalid.  Use orderByKey() instead.');if(t==="$priority")throw new Error('orderByChild: "$priority" is invalid.  Use orderByPriority() instead.');if(t==="$value")throw new Error('orderByChild: "$value" is invalid.  Use orderByValue() instead.');return Nl("orderByChild","path",t,!1),new fG(t)}class gG extends hs{_apply(e){kf(e,"orderByKey");const n=gf(e._queryParams,As);return ii(n),new In(e._repo,e._path,n,!0)}}function mG(){return new gG}class _G extends hs{_apply(e){kf(e,"orderByPriority");const n=gf(e._queryParams,qe);return ii(n),new In(e._repo,e._path,n,!0)}}function yG(){return new _G}class vG extends hs{_apply(e){kf(e,"orderByValue");const n=gf(e._queryParams,gy);return ii(n),new In(e._repo,e._path,n,!0)}}function wG(){return new vG}class bG extends hs{constructor(e,n){super(),this._value=e,this._key=n}_apply(e){if(Ls("equalTo",this._value,e._path,!1),e._queryParams.hasStart())throw new Error("equalTo: Starting point was already set (by another call to startAt/startAfter or equalTo).");if(e._queryParams.hasEnd())throw new Error("equalTo: Ending point was already set (by another call to endAt/endBefore or equalTo).");return new Vk(this._value,this._key)._apply(new Bk(this._value,this._key)._apply(e))}}function IG(t,e){return pu("equalTo","key",e,!0),new bG(t,e)}function Jn(t,...e){let n=A(t);for(const s of e)n=s._apply(n);return n}eH(Qn);iH(Qn);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const EG="FIREBASE_DATABASE_EMULATOR_HOST",vm={};let TG=!1;function SG(t,e,n,s){t.repoInfo_=new $A(`${e}:${n}`,!1,t.repoInfo_.namespace,t.repoInfo_.webSocketOnly,t.repoInfo_.nodeAdmin,t.repoInfo_.persistenceKey,t.repoInfo_.includeNamespaceInQueryParams),s&&(t.authTokenProvider_=s)}function qk(t,e,n,s,r){let i=s||t.options.databaseURL;i===void 0&&(t.options.projectId||Os("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),Et("Using default host for project ",t.options.projectId),i=`${t.options.projectId}-default-rtdb.firebaseio.com`);let o=_m(i,r),a=o.repoInfo,c,l;typeof process!="undefined"&&process.env&&(l=process.env[EG]),l?(c=!0,i=`http://${l}?ns=${a.namespace}`,o=_m(i,r),a=o.repoInfo):c=!o.repoInfo.secure;const u=r&&c?new na(na.OWNER):new fK(t.name,t.options,e);Ak("Invalid Firebase Database URL",o),pe(o.path)||Os("Database URL must point to the root of a Firebase Database (not including a child path).");const h=AG(a,t,u,new dK(t.name,n));return new kG(h,t)}function CG(t,e){const n=vm[e];(!n||n[t.key]!==t)&&Os(`Database ${e}(${t.repoInfo_}) has already been deleted.`),Dk(t),delete n[t.key]}function AG(t,e,n,s){let r=vm[e.name];r||(r={},vm[e.name]=r);let i=r[t.toURLString()];return i&&Os("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),i=new xH(t,TG,n,s),r[t.toURLString()]=i,i}class kG{constructor(e,n){this._repoInternal=e,this.app=n,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(OH(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new Qn(this._repo,Te())),this._rootInternal}_delete(){return this._rootInternal!==null&&(CG(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){this._rootInternal===null&&Os("Cannot call "+e+" on a deleted database.")}}function jk(){_a.IS_TRANSPORT_INITIALIZED&&Yt("Transport has already been initialized. Please call this function before calling ref or setting up a listener")}function RG(){jk(),Pr.forceDisallow()}function NG(){jk(),Fn.forceDisallow(),Pr.forceAllow()}function PG(t,e,n,s={}){t=A(t),t._checkNotDeleted("useEmulator"),t._instanceStarted&&Os("Cannot call useEmulator() after instance has already been initialized.");const r=t._repoInternal;let i;if(r.repoInfo_.nodeAdmin)s.mockUserToken&&Os('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),i=new na(na.OWNER);else if(s.mockUserToken){const o=typeof s.mockUserToken=="string"?s.mockUserToken:S_(s.mockUserToken,t.app.options.projectId);i=new na(o)}SG(r,e,n,i)}function DG(t){t=A(t),t._checkNotDeleted("goOffline"),Dk(t._repo)}function xG(t){t=A(t),t._checkNotDeleted("goOnline"),jH(t._repo)}function OG(t,e){CA(t,e)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function MG(t){IA(Bs),nt(new Ee("database",(e,{instanceIdentifier:n})=>{const s=e.getProvider("app").getImmediate(),r=e.getProvider("auth-internal"),i=e.getProvider("app-check-internal");return qk(s,r,i,n)},"PUBLIC").setMultipleInstances(!0)),Le(fI,pI,t),Le(fI,pI,"esm2017")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LG={".sv":"timestamp"};function FG(){return LG}function UG(t){return{".sv":{increment:t}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $G{constructor(e,n){this.committed=e,this.snapshot=n}toJSON(){return{committed:this.committed,snapshot:this.snapshot.toJSON()}}}function VG(t,e,n){var s;if(t=A(t),Vn("Reference.transaction",t._path),t.key===".length"||t.key===".keys")throw"Reference.transaction failed: "+t.key+" is a read-only object.";const r=(s=n==null?void 0:n.applyLocally)!==null&&s!==void 0?s:!0,i=new pt,o=(c,l,u)=>{let h=null;c?i.reject(c):(h=new to(u,new Qn(t._repo,t._path),qe),i.resolve(new $G(l,h)))},a=ym(t,()=>{});return KH(t._repo,t._path,e,o,a,r),i.promise}tr.prototype.simpleListen=function(t,e){this.sendRequest("q",{p:t},e)};tr.prototype.echo=function(t,e){this.sendRequest("echo",{d:t},e)};MG();const BG="@firebase/database-compat",qG="0.2.3";/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jG=new Vs("@firebase/database-compat"),Kk=function(t){const e="FIREBASE WARNING: "+t;jG.warn(e)};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KG=function(t,e,n,s){if(!(s&&n===void 0)&&typeof n!="boolean")throw new Error(wn(t,e)+"must be a boolean.")},WG=function(t,e,n){if(!(n&&e===void 0))switch(e){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:throw new Error(wn(t,"eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HG{constructor(e){this._delegate=e}cancel(e){ne("OnDisconnect.cancel",0,1,arguments.length),wt("OnDisconnect.cancel","onComplete",e,!0);const n=this._delegate.cancel();return e&&n.then(()=>e(null),s=>e(s)),n}remove(e){ne("OnDisconnect.remove",0,1,arguments.length),wt("OnDisconnect.remove","onComplete",e,!0);const n=this._delegate.remove();return e&&n.then(()=>e(null),s=>e(s)),n}set(e,n){ne("OnDisconnect.set",1,2,arguments.length),wt("OnDisconnect.set","onComplete",n,!0);const s=this._delegate.set(e);return n&&s.then(()=>n(null),r=>n(r)),s}setWithPriority(e,n,s){ne("OnDisconnect.setWithPriority",2,3,arguments.length),wt("OnDisconnect.setWithPriority","onComplete",s,!0);const r=this._delegate.setWithPriority(e,n);return s&&r.then(()=>s(null),i=>s(i)),r}update(e,n){if(ne("OnDisconnect.update",1,2,arguments.length),Array.isArray(e)){const r={};for(let i=0;i<e.length;++i)r[""+i]=e[i];e=r,Kk("Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}wt("OnDisconnect.update","onComplete",n,!0);const s=this._delegate.update(e);return n&&s.then(()=>n(null),r=>n(r)),s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GG{constructor(e,n){this.committed=e,this.snapshot=n}toJSON(){return ne("TransactionResult.toJSON",0,1,arguments.length),{committed:this.committed,snapshot:this.snapshot.toJSON()}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $r{constructor(e,n){this._database=e,this._delegate=n}val(){return ne("DataSnapshot.val",0,0,arguments.length),this._delegate.val()}exportVal(){return ne("DataSnapshot.exportVal",0,0,arguments.length),this._delegate.exportVal()}toJSON(){return ne("DataSnapshot.toJSON",0,1,arguments.length),this._delegate.toJSON()}exists(){return ne("DataSnapshot.exists",0,0,arguments.length),this._delegate.exists()}child(e){return ne("DataSnapshot.child",0,1,arguments.length),e=String(e),Nl("DataSnapshot.child","path",e,!1),new $r(this._database,this._delegate.child(e))}hasChild(e){return ne("DataSnapshot.hasChild",1,1,arguments.length),Nl("DataSnapshot.hasChild","path",e,!1),this._delegate.hasChild(e)}getPriority(){return ne("DataSnapshot.getPriority",0,0,arguments.length),this._delegate.priority}forEach(e){return ne("DataSnapshot.forEach",1,1,arguments.length),wt("DataSnapshot.forEach","action",e,!1),this._delegate.forEach(n=>e(new $r(this._database,n)))}hasChildren(){return ne("DataSnapshot.hasChildren",0,0,arguments.length),this._delegate.hasChildren()}get key(){return this._delegate.key}numChildren(){return ne("DataSnapshot.numChildren",0,0,arguments.length),this._delegate.size}getRef(){return ne("DataSnapshot.ref",0,0,arguments.length),new An(this._database,this._delegate.ref)}get ref(){return this.getRef()}}class Lt{constructor(e,n){this.database=e,this._delegate=n}on(e,n,s,r){var i;ne("Query.on",2,4,arguments.length),wt("Query.on","callback",n,!1);const o=Lt.getCancelAndContextArgs_("Query.on",s,r),a=(l,u)=>{n.call(o.context,new $r(this.database,l),u)};a.userCallback=n,a.context=o.context;const c=(i=o.cancel)===null||i===void 0?void 0:i.bind(o.context);switch(e){case"value":return ym(this._delegate,a,c),n;case"child_added":return zI(this._delegate,a,c),n;case"child_removed":return JI(this._delegate,a,c),n;case"child_changed":return QI(this._delegate,a,c),n;case"child_moved":return YI(this._delegate,a,c),n;default:throw new Error(wn("Query.on","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}}off(e,n,s){if(ne("Query.off",0,3,arguments.length),WG("Query.off",e,!0),wt("Query.off","callback",n,!0),kb("Query.off","context",s,!0),n){const r=()=>{};r.userCallback=n,r.context=s,XI(this._delegate,e,r)}else XI(this._delegate,e)}get(){return nG(this._delegate).then(e=>new $r(this.database,e))}once(e,n,s,r){ne("Query.once",1,4,arguments.length),wt("Query.once","callback",n,!0);const i=Lt.getCancelAndContextArgs_("Query.once",s,r),o=new pt,a=(l,u)=>{const h=new $r(this.database,l);n&&n.call(i.context,h,u),o.resolve(h)};a.userCallback=n,a.context=i.context;const c=l=>{i.cancel&&i.cancel.call(i.context,l),o.reject(l)};switch(e){case"value":ym(this._delegate,a,c,{onlyOnce:!0});break;case"child_added":zI(this._delegate,a,c,{onlyOnce:!0});break;case"child_removed":JI(this._delegate,a,c,{onlyOnce:!0});break;case"child_changed":QI(this._delegate,a,c,{onlyOnce:!0});break;case"child_moved":YI(this._delegate,a,c,{onlyOnce:!0});break;default:throw new Error(wn("Query.once","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}return o.promise}limitToFirst(e){return ne("Query.limitToFirst",1,1,arguments.length),new Lt(this.database,Jn(this._delegate,uG(e)))}limitToLast(e){return ne("Query.limitToLast",1,1,arguments.length),new Lt(this.database,Jn(this._delegate,dG(e)))}orderByChild(e){return ne("Query.orderByChild",1,1,arguments.length),new Lt(this.database,Jn(this._delegate,pG(e)))}orderByKey(){return ne("Query.orderByKey",0,0,arguments.length),new Lt(this.database,Jn(this._delegate,mG()))}orderByPriority(){return ne("Query.orderByPriority",0,0,arguments.length),new Lt(this.database,Jn(this._delegate,yG()))}orderByValue(){return ne("Query.orderByValue",0,0,arguments.length),new Lt(this.database,Jn(this._delegate,wG()))}startAt(e=null,n){return ne("Query.startAt",0,2,arguments.length),new Lt(this.database,Jn(this._delegate,oG(e,n)))}startAfter(e=null,n){return ne("Query.startAfter",0,2,arguments.length),new Lt(this.database,Jn(this._delegate,cG(e,n)))}endAt(e=null,n){return ne("Query.endAt",0,2,arguments.length),new Lt(this.database,Jn(this._delegate,sG(e,n)))}endBefore(e=null,n){return ne("Query.endBefore",0,2,arguments.length),new Lt(this.database,Jn(this._delegate,iG(e,n)))}equalTo(e,n){return ne("Query.equalTo",1,2,arguments.length),new Lt(this.database,Jn(this._delegate,IG(e,n)))}toString(){return ne("Query.toString",0,0,arguments.length),this._delegate.toString()}toJSON(){return ne("Query.toJSON",0,1,arguments.length),this._delegate.toJSON()}isEqual(e){if(ne("Query.isEqual",1,1,arguments.length),!(e instanceof Lt)){const n="Query.isEqual failed: First argument must be an instance of firebase.database.Query.";throw new Error(n)}return this._delegate.isEqual(e._delegate)}static getCancelAndContextArgs_(e,n,s){const r={cancel:void 0,context:void 0};if(n&&s)r.cancel=n,wt(e,"cancel",r.cancel,!0),r.context=s,kb(e,"context",r.context,!0);else if(n)if(typeof n=="object"&&n!==null)r.context=n;else if(typeof n=="function")r.cancel=n;else throw new Error(wn(e,"cancelOrContext")+" must either be a cancel callback or a context object.");return r}get ref(){return new An(this.database,new Qn(this._delegate._repo,this._delegate._path))}}class An extends Lt{constructor(e,n){super(e,new In(n._repo,n._path,new pf,!1)),this.database=e,this._delegate=n}getKey(){return ne("Reference.key",0,0,arguments.length),this._delegate.key}child(e){return ne("Reference.child",1,1,arguments.length),typeof e=="number"&&(e=String(e)),new An(this.database,no(this._delegate,e))}getParent(){ne("Reference.parent",0,0,arguments.length);const e=this._delegate.parent;return e?new An(this.database,e):null}getRoot(){return ne("Reference.root",0,0,arguments.length),new An(this.database,this._delegate.root)}set(e,n){ne("Reference.set",1,2,arguments.length),wt("Reference.set","onComplete",n,!0);const s=Vy(this._delegate,e);return n&&s.then(()=>n(null),r=>n(r)),s}update(e,n){if(ne("Reference.update",1,2,arguments.length),Array.isArray(e)){const r={};for(let i=0;i<e.length;++i)r[""+i]=e[i];e=r,Kk("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}Vn("Reference.update",this._delegate._path),wt("Reference.update","onComplete",n,!0);const s=tG(this._delegate,e);return n&&s.then(()=>n(null),r=>n(r)),s}setWithPriority(e,n,s){ne("Reference.setWithPriority",2,3,arguments.length),wt("Reference.setWithPriority","onComplete",s,!0);const r=eG(this._delegate,e,n);return s&&r.then(()=>s(null),i=>s(i)),r}remove(e){ne("Reference.remove",0,1,arguments.length),wt("Reference.remove","onComplete",e,!0);const n=XH(this._delegate);return e&&n.then(()=>e(null),s=>e(s)),n}transaction(e,n,s){ne("Reference.transaction",1,3,arguments.length),wt("Reference.transaction","transactionUpdate",e,!1),wt("Reference.transaction","onComplete",n,!0),KG("Reference.transaction","applyLocally",s,!0);const r=VG(this._delegate,e,{applyLocally:s}).then(i=>new GG(i.committed,new $r(this.database,i.snapshot)));return n&&r.then(i=>n(null,i.committed,i.snapshot),i=>n(i,!1,null)),r}setPriority(e,n){ne("Reference.setPriority",1,2,arguments.length),wt("Reference.setPriority","onComplete",n,!0);const s=ZH(this._delegate,e);return n&&s.then(()=>n(null),r=>n(r)),s}push(e,n){ne("Reference.push",0,2,arguments.length),wt("Reference.push","onComplete",n,!0);const s=JH(this._delegate,e),r=s.then(o=>new An(this.database,o));n&&r.then(()=>n(null),o=>n(o));const i=new An(this.database,s);return i.then=r.then.bind(r),i.catch=r.catch.bind(r,void 0),i}onDisconnect(){return Vn("Reference.onDisconnect",this._delegate._path),new HG(new YH(this._delegate._repo,this._delegate._path))}get key(){return this.getKey()}get parent(){return this.getParent()}get root(){return this.getRoot()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pl{constructor(e,n){this._delegate=e,this.app=n,this.INTERNAL={delete:()=>this._delegate._delete(),forceWebSockets:RG,forceLongPolling:NG}}useEmulator(e,n,s={}){PG(this._delegate,e,n,s)}ref(e){if(ne("database.ref",0,1,arguments.length),e instanceof An){const n=GI(this._delegate,e.toString());return new An(this,n)}else{const n=$k(this._delegate,e);return new An(this,n)}}refFromURL(e){ne("database.refFromURL",1,1,arguments.length);const s=GI(this._delegate,e);return new An(this,s)}goOffline(){return ne("database.goOffline",0,0,arguments.length),DG(this._delegate)}goOnline(){return ne("database.goOnline",0,0,arguments.length),xG(this._delegate)}}Pl.ServerValue={TIMESTAMP:FG(),increment:t=>UG(t)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zG({app:t,url:e,version:n,customAuthImpl:s,namespace:r,nodeAdmin:i=!1}){IA(n);const o=new TC("auth-internal",new SC("database-standalone"));return o.setComponent(new Ee("auth-internal",()=>s,"PRIVATE")),{instance:new Pl(qk(t,o,void 0,e,i),t),namespace:r}}var QG=Object.freeze({__proto__:null,initStandalone:zG});/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YG=Pl.ServerValue;function JG(t){t.INTERNAL.registerComponent(new Ee("database-compat",(e,{instanceIdentifier:n})=>{const s=e.getProvider("app-compat").getImmediate(),r=e.getProvider("database").getImmediate({identifier:n});return new Pl(r,s)},"PUBLIC").setServiceProps({Reference:An,Query:Lt,Database:Pl,DataSnapshot:$r,enableLogging:OG,INTERNAL:QG,ServerValue:YG}).setMultipleInstances(!0)),t.registerVersion(BG,qG)}JG(lt);var XG=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{},K,By=By||{},oe=XG||self;function od(){}function wm(t){var e=typeof t;return e=e!="object"?e:t?Array.isArray(t)?"array":e:"null",e=="array"||e=="object"&&typeof t.length=="number"}function _u(t){var e=typeof t;return e=="object"&&t!=null||e=="function"}function ZG(t){return Object.prototype.hasOwnProperty.call(t,jp)&&t[jp]||(t[jp]=++ez)}var jp="closure_uid_"+(1e9*Math.random()>>>0),ez=0;function tz(t,e,n){return t.call.apply(t.bind,arguments)}function nz(t,e,n){if(!t)throw Error();if(2<arguments.length){var s=Array.prototype.slice.call(arguments,2);return function(){var r=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(r,s),t.apply(e,r)}}return function(){return t.apply(e,arguments)}}function jt(t,e,n){return Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?jt=tz:jt=nz,jt.apply(null,arguments)}function Qu(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var s=n.slice();return s.push.apply(s,arguments),t.apply(this,s)}}function Gt(t,e){function n(){}n.prototype=e.prototype,t.Z=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.Vb=function(s,r,i){for(var o=Array(arguments.length-2),a=2;a<arguments.length;a++)o[a-2]=arguments[a];return e.prototype[r].apply(s,o)}}function oi(){this.s=this.s,this.o=this.o}var sz=0;oi.prototype.s=!1;oi.prototype.na=function(){!this.s&&(this.s=!0,this.M(),sz!=0)&&ZG(this)};oi.prototype.M=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const Wk=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if(typeof t=="string")return typeof e!="string"||e.length!=1?-1:t.indexOf(e,0);for(let n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},Hk=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){const s=t.length,r=typeof t=="string"?t.split(""):t;for(let i=0;i<s;i++)i in r&&e.call(n,r[i],i,t)};function rz(t){e:{var e=Qz;const n=t.length,s=typeof t=="string"?t.split(""):t;for(let r=0;r<n;r++)if(r in s&&e.call(void 0,s[r],r,t)){e=r;break e}e=-1}return 0>e?null:typeof t=="string"?t.charAt(e):t[e]}function ZI(t){return Array.prototype.concat.apply([],arguments)}function qy(t){const e=t.length;if(0<e){const n=Array(e);for(let s=0;s<e;s++)n[s]=t[s];return n}return[]}function ad(t){return/^[\s\xa0]*$/.test(t)}var eE=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function rn(t,e){return t.indexOf(e)!=-1}function Kp(t,e){return t<e?-1:t>e?1:0}var on;e:{var tE=oe.navigator;if(tE){var nE=tE.userAgent;if(nE){on=nE;break e}}on=""}function jy(t,e,n){for(const s in t)e.call(n,t[s],s,t)}function Gk(t){const e={};for(const n in t)e[n]=t[n];return e}var sE="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function zk(t,e){let n,s;for(let r=1;r<arguments.length;r++){s=arguments[r];for(n in s)t[n]=s[n];for(let i=0;i<sE.length;i++)n=sE[i],Object.prototype.hasOwnProperty.call(s,n)&&(t[n]=s[n])}}function Ky(t){return Ky[" "](t),t}Ky[" "]=od;function iz(t){var e=cz;return Object.prototype.hasOwnProperty.call(e,9)?e[9]:e[9]=t(9)}var oz=rn(on,"Opera"),Ea=rn(on,"Trident")||rn(on,"MSIE"),Qk=rn(on,"Edge"),bm=Qk||Ea,Yk=rn(on,"Gecko")&&!(rn(on.toLowerCase(),"webkit")&&!rn(on,"Edge"))&&!(rn(on,"Trident")||rn(on,"MSIE"))&&!rn(on,"Edge"),az=rn(on.toLowerCase(),"webkit")&&!rn(on,"Edge");function Jk(){var t=oe.document;return t?t.documentMode:void 0}var cd;e:{var Wp="",Hp=function(){var t=on;if(Yk)return/rv:([^\);]+)(\)|;)/.exec(t);if(Qk)return/Edge\/([\d\.]+)/.exec(t);if(Ea)return/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(t);if(az)return/WebKit\/(\S+)/.exec(t);if(oz)return/(?:Version)[ \/]?(\S+)/.exec(t)}();if(Hp&&(Wp=Hp?Hp[1]:""),Ea){var Gp=Jk();if(Gp!=null&&Gp>parseFloat(Wp)){cd=String(Gp);break e}}cd=Wp}var cz={};function lz(){return iz(function(){let t=0;const e=eE(String(cd)).split("."),n=eE("9").split("."),s=Math.max(e.length,n.length);for(let o=0;t==0&&o<s;o++){var r=e[o]||"",i=n[o]||"";do{if(r=/(\d*)(\D*)(.*)/.exec(r)||["","","",""],i=/(\d*)(\D*)(.*)/.exec(i)||["","","",""],r[0].length==0&&i[0].length==0)break;t=Kp(r[1].length==0?0:parseInt(r[1],10),i[1].length==0?0:parseInt(i[1],10))||Kp(r[2].length==0,i[2].length==0)||Kp(r[2],i[2]),r=r[3],i=i[3]}while(t==0)}return 0<=t})}var Im;if(oe.document&&Ea){var rE=Jk();Im=rE||parseInt(cd,10)||void 0}else Im=void 0;var uz=Im,hz=function(){if(!oe.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{oe.addEventListener("test",od,e),oe.removeEventListener("test",od,e)}catch{}return t}();function Jt(t,e){this.type=t,this.g=this.target=e,this.defaultPrevented=!1}Jt.prototype.h=function(){this.defaultPrevented=!0};function Dl(t,e){if(Jt.call(this,t?t.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,t){var n=this.type=t.type,s=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.g=e,e=t.relatedTarget){if(Yk){e:{try{Ky(e.nodeName);var r=!0;break e}catch{}r=!1}r||(e=null)}}else n=="mouseover"?e=t.fromElement:n=="mouseout"&&(e=t.toElement);this.relatedTarget=e,s?(this.clientX=s.clientX!==void 0?s.clientX:s.pageX,this.clientY=s.clientY!==void 0?s.clientY:s.pageY,this.screenX=s.screenX||0,this.screenY=s.screenY||0):(this.clientX=t.clientX!==void 0?t.clientX:t.pageX,this.clientY=t.clientY!==void 0?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType=typeof t.pointerType=="string"?t.pointerType:dz[t.pointerType]||"",this.state=t.state,this.i=t,t.defaultPrevented&&Dl.Z.h.call(this)}}Gt(Dl,Jt);var dz={2:"touch",3:"pen",4:"mouse"};Dl.prototype.h=function(){Dl.Z.h.call(this);var t=this.i;t.preventDefault?t.preventDefault():t.returnValue=!1};var yu="closure_listenable_"+(1e6*Math.random()|0),fz=0;function pz(t,e,n,s,r){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!s,this.ia=r,this.key=++fz,this.ca=this.fa=!1}function Df(t){t.ca=!0,t.listener=null,t.proxy=null,t.src=null,t.ia=null}function xf(t){this.src=t,this.g={},this.h=0}xf.prototype.add=function(t,e,n,s,r){var i=t.toString();t=this.g[i],t||(t=this.g[i]=[],this.h++);var o=Tm(t,e,s,r);return-1<o?(e=t[o],n||(e.fa=!1)):(e=new pz(e,this.src,i,!!s,r),e.fa=n,t.push(e)),e};function Em(t,e){var n=e.type;if(n in t.g){var s=t.g[n],r=Wk(s,e),i;(i=0<=r)&&Array.prototype.splice.call(s,r,1),i&&(Df(e),t.g[n].length==0&&(delete t.g[n],t.h--))}}function Tm(t,e,n,s){for(var r=0;r<t.length;++r){var i=t[r];if(!i.ca&&i.listener==e&&i.capture==!!n&&i.ia==s)return r}return-1}var Wy="closure_lm_"+(1e6*Math.random()|0),zp={};function Xk(t,e,n,s,r){if(s&&s.once)return eR(t,e,n,s,r);if(Array.isArray(e)){for(var i=0;i<e.length;i++)Xk(t,e[i],n,s,r);return null}return n=zy(n),t&&t[yu]?t.N(e,n,_u(s)?!!s.capture:!!s,r):Zk(t,e,n,!1,s,r)}function Zk(t,e,n,s,r,i){if(!e)throw Error("Invalid event type");var o=_u(r)?!!r.capture:!!r,a=Gy(t);if(a||(t[Wy]=a=new xf(t)),n=a.add(e,n,s,o,i),n.proxy)return n;if(s=gz(),n.proxy=s,s.src=t,s.listener=n,t.addEventListener)hz||(r=o),r===void 0&&(r=!1),t.addEventListener(e.toString(),s,r);else if(t.attachEvent)t.attachEvent(nR(e.toString()),s);else if(t.addListener&&t.removeListener)t.addListener(s);else throw Error("addEventListener and attachEvent are unavailable.");return n}function gz(){function t(n){return e.call(t.src,t.listener,n)}var e=mz;return t}function eR(t,e,n,s,r){if(Array.isArray(e)){for(var i=0;i<e.length;i++)eR(t,e[i],n,s,r);return null}return n=zy(n),t&&t[yu]?t.O(e,n,_u(s)?!!s.capture:!!s,r):Zk(t,e,n,!0,s,r)}function tR(t,e,n,s,r){if(Array.isArray(e))for(var i=0;i<e.length;i++)tR(t,e[i],n,s,r);else s=_u(s)?!!s.capture:!!s,n=zy(n),t&&t[yu]?(t=t.i,e=String(e).toString(),e in t.g&&(i=t.g[e],n=Tm(i,n,s,r),-1<n&&(Df(i[n]),Array.prototype.splice.call(i,n,1),i.length==0&&(delete t.g[e],t.h--)))):t&&(t=Gy(t))&&(e=t.g[e.toString()],t=-1,e&&(t=Tm(e,n,s,r)),(n=-1<t?e[t]:null)&&Hy(n))}function Hy(t){if(typeof t!="number"&&t&&!t.ca){var e=t.src;if(e&&e[yu])Em(e.i,t);else{var n=t.type,s=t.proxy;e.removeEventListener?e.removeEventListener(n,s,t.capture):e.detachEvent?e.detachEvent(nR(n),s):e.addListener&&e.removeListener&&e.removeListener(s),(n=Gy(e))?(Em(n,t),n.h==0&&(n.src=null,e[Wy]=null)):Df(t)}}}function nR(t){return t in zp?zp[t]:zp[t]="on"+t}function mz(t,e){if(t.ca)t=!0;else{e=new Dl(e,this);var n=t.listener,s=t.ia||t.src;t.fa&&Hy(t),t=n.call(s,e)}return t}function Gy(t){return t=t[Wy],t instanceof xf?t:null}var Qp="__closure_events_fn_"+(1e9*Math.random()>>>0);function zy(t){return typeof t=="function"?t:(t[Qp]||(t[Qp]=function(e){return t.handleEvent(e)}),t[Qp])}function Dt(){oi.call(this),this.i=new xf(this),this.P=this,this.I=null}Gt(Dt,oi);Dt.prototype[yu]=!0;Dt.prototype.removeEventListener=function(t,e,n,s){tR(this,t,e,n,s)};function Kt(t,e){var n,s=t.I;if(s)for(n=[];s;s=s.I)n.push(s);if(t=t.P,s=e.type||e,typeof e=="string")e=new Jt(e,t);else if(e instanceof Jt)e.target=e.target||t;else{var r=e;e=new Jt(s,t),zk(e,r)}if(r=!0,n)for(var i=n.length-1;0<=i;i--){var o=e.g=n[i];r=Yu(o,s,!0,e)&&r}if(o=e.g=t,r=Yu(o,s,!0,e)&&r,r=Yu(o,s,!1,e)&&r,n)for(i=0;i<n.length;i++)o=e.g=n[i],r=Yu(o,s,!1,e)&&r}Dt.prototype.M=function(){if(Dt.Z.M.call(this),this.i){var t=this.i,e;for(e in t.g){for(var n=t.g[e],s=0;s<n.length;s++)Df(n[s]);delete t.g[e],t.h--}}this.I=null};Dt.prototype.N=function(t,e,n,s){return this.i.add(String(t),e,!1,n,s)};Dt.prototype.O=function(t,e,n,s){return this.i.add(String(t),e,!0,n,s)};function Yu(t,e,n,s){if(e=t.i.g[String(e)],!e)return!0;e=e.concat();for(var r=!0,i=0;i<e.length;++i){var o=e[i];if(o&&!o.ca&&o.capture==n){var a=o.listener,c=o.ia||o.src;o.fa&&Em(t.i,o),r=a.call(c,s)!==!1&&r}}return r&&!s.defaultPrevented}var Qy=oe.JSON.stringify;function _z(){var t=rR;let e=null;return t.g&&(e=t.g,t.g=t.g.next,t.g||(t.h=null),e.next=null),e}class yz{constructor(){this.h=this.g=null}add(e,n){const s=sR.get();s.set(e,n),this.h?this.h.next=s:this.g=s,this.h=s}}var sR=new class{constructor(t,e){this.i=t,this.j=e,this.h=0,this.g=null}get(){let t;return 0<this.h?(this.h--,t=this.g,this.g=t.next,t.next=null):t=this.i(),t}}(()=>new vz,t=>t.reset());class vz{constructor(){this.next=this.g=this.h=null}set(e,n){this.h=e,this.g=n,this.next=null}reset(){this.next=this.g=this.h=null}}function wz(t){oe.setTimeout(()=>{throw t},0)}function Yy(t,e){Sm||bz(),Cm||(Sm(),Cm=!0),rR.add(t,e)}var Sm;function bz(){var t=oe.Promise.resolve(void 0);Sm=function(){t.then(Iz)}}var Cm=!1,rR=new yz;function Iz(){for(var t;t=_z();){try{t.h.call(t.g)}catch(n){wz(n)}var e=sR;e.j(t),100>e.h&&(e.h++,t.next=e.g,e.g=t)}Cm=!1}function Of(t,e){Dt.call(this),this.h=t||1,this.g=e||oe,this.j=jt(this.kb,this),this.l=Date.now()}Gt(Of,Dt);K=Of.prototype;K.da=!1;K.S=null;K.kb=function(){if(this.da){var t=Date.now()-this.l;0<t&&t<.8*this.h?this.S=this.g.setTimeout(this.j,this.h-t):(this.S&&(this.g.clearTimeout(this.S),this.S=null),Kt(this,"tick"),this.da&&(Jy(this),this.start()))}};K.start=function(){this.da=!0,this.S||(this.S=this.g.setTimeout(this.j,this.h),this.l=Date.now())};function Jy(t){t.da=!1,t.S&&(t.g.clearTimeout(t.S),t.S=null)}K.M=function(){Of.Z.M.call(this),Jy(this),delete this.g};function Xy(t,e,n){if(typeof t=="function")n&&(t=jt(t,n));else if(t&&typeof t.handleEvent=="function")t=jt(t.handleEvent,t);else throw Error("Invalid listener argument");return 2147483647<Number(e)?-1:oe.setTimeout(t,e||0)}function iR(t){t.g=Xy(()=>{t.g=null,t.i&&(t.i=!1,iR(t))},t.j);const e=t.h;t.h=null,t.m.apply(null,e)}class Ez extends oi{constructor(e,n){super(),this.m=e,this.j=n,this.h=null,this.i=!1,this.g=null}l(e){this.h=arguments,this.g?this.i=!0:iR(this)}M(){super.M(),this.g&&(oe.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function xl(t){oi.call(this),this.h=t,this.g={}}Gt(xl,oi);var iE=[];function oR(t,e,n,s){Array.isArray(n)||(n&&(iE[0]=n.toString()),n=iE);for(var r=0;r<n.length;r++){var i=Xk(e,n[r],s||t.handleEvent,!1,t.h||t);if(!i)break;t.g[i.key]=i}}function aR(t){jy(t.g,function(e,n){this.g.hasOwnProperty(n)&&Hy(e)},t),t.g={}}xl.prototype.M=function(){xl.Z.M.call(this),aR(this)};xl.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};function Mf(){this.g=!0}Mf.prototype.Aa=function(){this.g=!1};function Tz(t,e,n,s,r,i){t.info(function(){if(t.g)if(i)for(var o="",a=i.split("&"),c=0;c<a.length;c++){var l=a[c].split("=");if(1<l.length){var u=l[0];l=l[1];var h=u.split("_");o=2<=h.length&&h[1]=="type"?o+(u+"="+l+"&"):o+(u+"=redacted&")}}else o=null;else o=i;return"XMLHTTP REQ ("+s+") [attempt "+r+"]: "+e+`
`+n+`
`+o})}function Sz(t,e,n,s,r,i,o){t.info(function(){return"XMLHTTP RESP ("+s+") [ attempt "+r+"]: "+e+`
`+n+`
`+i+" "+o})}function Go(t,e,n,s){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+Az(t,n)+(s?" "+s:"")})}function Cz(t,e){t.info(function(){return"TIMEOUT: "+e})}Mf.prototype.info=function(){};function Az(t,e){if(!t.g)return e;if(!e)return null;try{var n=JSON.parse(e);if(n){for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var s=n[t];if(!(2>s.length)){var r=s[1];if(Array.isArray(r)&&!(1>r.length)){var i=r[0];if(i!="noop"&&i!="stop"&&i!="close")for(var o=1;o<r.length;o++)r[o]=""}}}}return Qy(n)}catch{return e}}var Co={},oE=null;function Lf(){return oE=oE||new Dt}Co.Ma="serverreachability";function cR(t){Jt.call(this,Co.Ma,t)}Gt(cR,Jt);function Ol(t){const e=Lf();Kt(e,new cR(e))}Co.STAT_EVENT="statevent";function lR(t,e){Jt.call(this,Co.STAT_EVENT,t),this.stat=e}Gt(lR,Jt);function ln(t){const e=Lf();Kt(e,new lR(e,t))}Co.Na="timingevent";function uR(t,e){Jt.call(this,Co.Na,t),this.size=e}Gt(uR,Jt);function vu(t,e){if(typeof t!="function")throw Error("Fn must not be null and must be a function");return oe.setTimeout(function(){t()},e)}var Ff={NO_ERROR:0,lb:1,yb:2,xb:3,sb:4,wb:5,zb:6,Ja:7,TIMEOUT:8,Cb:9},hR={qb:"complete",Mb:"success",Ka:"error",Ja:"abort",Eb:"ready",Fb:"readystatechange",TIMEOUT:"timeout",Ab:"incrementaldata",Db:"progress",tb:"downloadprogress",Ub:"uploadprogress"};function Zy(){}Zy.prototype.h=null;function aE(t){return t.h||(t.h=t.i())}function dR(){}var wu={OPEN:"a",pb:"b",Ka:"c",Bb:"d"};function ev(){Jt.call(this,"d")}Gt(ev,Jt);function tv(){Jt.call(this,"c")}Gt(tv,Jt);var Am;function Uf(){}Gt(Uf,Zy);Uf.prototype.g=function(){return new XMLHttpRequest};Uf.prototype.i=function(){return{}};Am=new Uf;function bu(t,e,n,s){this.l=t,this.j=e,this.m=n,this.X=s||1,this.V=new xl(this),this.P=kz,t=bm?125:void 0,this.W=new Of(t),this.H=null,this.i=!1,this.s=this.A=this.v=this.K=this.F=this.Y=this.B=null,this.D=[],this.g=null,this.C=0,this.o=this.u=null,this.N=-1,this.I=!1,this.O=0,this.L=null,this.aa=this.J=this.$=this.U=!1,this.h=new fR}function fR(){this.i=null,this.g="",this.h=!1}var kz=45e3,km={},ld={};K=bu.prototype;K.setTimeout=function(t){this.P=t};function Rm(t,e,n){t.K=1,t.v=Vf(or(e)),t.s=n,t.U=!0,pR(t,null)}function pR(t,e){t.F=Date.now(),Iu(t),t.A=or(t.v);var n=t.A,s=t.X;Array.isArray(s)||(s=[String(s)]),bR(n.h,"t",s),t.C=0,n=t.l.H,t.h=new fR,t.g=BR(t.l,n?e:null,!t.s),0<t.O&&(t.L=new Ez(jt(t.Ia,t,t.g),t.O)),oR(t.V,t.g,"readystatechange",t.gb),e=t.H?Gk(t.H):{},t.s?(t.u||(t.u="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.g.ea(t.A,t.u,t.s,e)):(t.u="GET",t.g.ea(t.A,t.u,null,e)),Ol(),Tz(t.j,t.u,t.A,t.m,t.X,t.s)}K.gb=function(t){t=t.target;const e=this.L;e&&Js(t)==3?e.l():this.Ia(t)};K.Ia=function(t){try{if(t==this.g)e:{const u=Js(this.g);var e=this.g.Da();const h=this.g.ba();if(!(3>u)&&(u!=3||bm||this.g&&(this.h.h||this.g.ga()||hE(this.g)))){this.I||u!=4||e==7||(e==8||0>=h?Ol(3):Ol(2)),$f(this);var n=this.g.ba();this.N=n;t:if(gR(this)){var s=hE(this.g);t="";var r=s.length,i=Js(this.g)==4;if(!this.h.i){if(typeof TextDecoder=="undefined"){Mi(this),Kc(this);var o="";break t}this.h.i=new oe.TextDecoder}for(e=0;e<r;e++)this.h.h=!0,t+=this.h.i.decode(s[e],{stream:i&&e==r-1});s.splice(0,r),this.h.g+=t,this.C=0,o=this.h.g}else o=this.g.ga();if(this.i=n==200,Sz(this.j,this.u,this.A,this.m,this.X,u,n),this.i){if(this.$&&!this.J){t:{if(this.g){var a,c=this.g;if((a=c.g?c.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!ad(a)){var l=a;break t}}l=null}if(n=l)Go(this.j,this.m,n,"Initial handshake response via X-HTTP-Initial-Response"),this.J=!0,Nm(this,n);else{this.i=!1,this.o=3,ln(12),Mi(this),Kc(this);break e}}this.U?(mR(this,u,o),bm&&this.i&&u==3&&(oR(this.V,this.W,"tick",this.fb),this.W.start())):(Go(this.j,this.m,o,null),Nm(this,o)),u==4&&Mi(this),this.i&&!this.I&&(u==4?FR(this.l,this):(this.i=!1,Iu(this)))}else n==400&&0<o.indexOf("Unknown SID")?(this.o=3,ln(12)):(this.o=0,ln(13)),Mi(this),Kc(this)}}}catch{}finally{}};function gR(t){return t.g?t.u=="GET"&&t.K!=2&&t.l.Ba:!1}function mR(t,e,n){let s=!0,r;for(;!t.I&&t.C<n.length;)if(r=Rz(t,n),r==ld){e==4&&(t.o=4,ln(14),s=!1),Go(t.j,t.m,null,"[Incomplete Response]");break}else if(r==km){t.o=4,ln(15),Go(t.j,t.m,n,"[Invalid Chunk]"),s=!1;break}else Go(t.j,t.m,r,null),Nm(t,r);gR(t)&&r!=ld&&r!=km&&(t.h.g="",t.C=0),e!=4||n.length!=0||t.h.h||(t.o=1,ln(16),s=!1),t.i=t.i&&s,s?0<n.length&&!t.aa&&(t.aa=!0,e=t.l,e.g==t&&e.$&&!e.L&&(e.h.info("Great, no buffering proxy detected. Bytes received: "+n.length),uv(e),e.L=!0,ln(11))):(Go(t.j,t.m,n,"[Invalid Chunked Response]"),Mi(t),Kc(t))}K.fb=function(){if(this.g){var t=Js(this.g),e=this.g.ga();this.C<e.length&&($f(this),mR(this,t,e),this.i&&t!=4&&Iu(this))}};function Rz(t,e){var n=t.C,s=e.indexOf(`
`,n);return s==-1?ld:(n=Number(e.substring(n,s)),isNaN(n)?km:(s+=1,s+n>e.length?ld:(e=e.substr(s,n),t.C=s+n,e)))}K.cancel=function(){this.I=!0,Mi(this)};function Iu(t){t.Y=Date.now()+t.P,_R(t,t.P)}function _R(t,e){if(t.B!=null)throw Error("WatchDog timer not null");t.B=vu(jt(t.eb,t),e)}function $f(t){t.B&&(oe.clearTimeout(t.B),t.B=null)}K.eb=function(){this.B=null;const t=Date.now();0<=t-this.Y?(Cz(this.j,this.A),this.K!=2&&(Ol(),ln(17)),Mi(this),this.o=2,Kc(this)):_R(this,this.Y-t)};function Kc(t){t.l.G==0||t.I||FR(t.l,t)}function Mi(t){$f(t);var e=t.L;e&&typeof e.na=="function"&&e.na(),t.L=null,Jy(t.W),aR(t.V),t.g&&(e=t.g,t.g=null,e.abort(),e.na())}function Nm(t,e){try{var n=t.l;if(n.G!=0&&(n.g==t||Pm(n.i,t))){if(n.I=t.N,!t.J&&Pm(n.i,t)&&n.G==3){try{var s=n.Ca.g.parse(e)}catch{s=null}if(Array.isArray(s)&&s.length==3){var r=s;if(r[0]==0){e:if(!n.u){if(n.g)if(n.g.F+3e3<t.F)fd(n),jf(n);else break e;lv(n),ln(18)}}else n.ta=r[1],0<n.ta-n.U&&37500>r[2]&&n.N&&n.A==0&&!n.v&&(n.v=vu(jt(n.ab,n),6e3));if(1>=TR(n.i)&&n.ka){try{n.ka()}catch{}n.ka=void 0}}else Li(n,11)}else if((t.J||n.g==t)&&fd(n),!ad(e))for(r=n.Ca.g.parse(e),e=0;e<r.length;e++){let l=r[e];if(n.U=l[0],l=l[1],n.G==2)if(l[0]=="c"){n.J=l[1],n.la=l[2];const u=l[3];u!=null&&(n.ma=u,n.h.info("VER="+n.ma));const h=l[4];h!=null&&(n.za=h,n.h.info("SVER="+n.za));const d=l[5];d!=null&&typeof d=="number"&&0<d&&(s=1.5*d,n.K=s,n.h.info("backChannelRequestTimeoutMs_="+s)),s=n;const f=t.g;if(f){const p=f.g?f.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(p){var i=s.i;!i.g&&(rn(p,"spdy")||rn(p,"quic")||rn(p,"h2"))&&(i.j=i.l,i.g=new Set,i.h&&(rv(i,i.h),i.h=null))}if(s.D){const _=f.g?f.g.getResponseHeader("X-HTTP-Session-Id"):null;_&&(s.sa=_,He(s.F,s.D,_))}}n.G=3,n.j&&n.j.xa(),n.$&&(n.O=Date.now()-t.F,n.h.info("Handshake RTT: "+n.O+"ms")),s=n;var o=t;if(s.oa=VR(s,s.H?s.la:null,s.W),o.J){SR(s.i,o);var a=o,c=s.K;c&&a.setTimeout(c),a.B&&($f(a),Iu(a)),s.g=o}else MR(s);0<n.l.length&&Kf(n)}else l[0]!="stop"&&l[0]!="close"||Li(n,7);else n.G==3&&(l[0]=="stop"||l[0]=="close"?l[0]=="stop"?Li(n,7):cv(n):l[0]!="noop"&&n.j&&n.j.wa(l),n.A=0)}}Ol(4)}catch{}}function Nz(t){if(t.R&&typeof t.R=="function")return t.R();if(typeof t=="string")return t.split("");if(wm(t)){for(var e=[],n=t.length,s=0;s<n;s++)e.push(t[s]);return e}e=[],n=0;for(s in t)e[n++]=t[s];return e}function nv(t,e){if(t.forEach&&typeof t.forEach=="function")t.forEach(e,void 0);else if(wm(t)||typeof t=="string")Hk(t,e,void 0);else{if(t.T&&typeof t.T=="function")var n=t.T();else if(t.R&&typeof t.R=="function")n=void 0;else if(wm(t)||typeof t=="string"){n=[];for(var s=t.length,r=0;r<s;r++)n.push(r)}else for(r in n=[],s=0,t)n[s++]=r;s=Nz(t),r=s.length;for(var i=0;i<r;i++)e.call(void 0,s[i],n&&n[i],t)}}function Ga(t,e){this.h={},this.g=[],this.i=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var s=0;s<n;s+=2)this.set(arguments[s],arguments[s+1])}else if(t)if(t instanceof Ga)for(n=t.T(),s=0;s<n.length;s++)this.set(n[s],t.get(n[s]));else for(s in t)this.set(s,t[s])}K=Ga.prototype;K.R=function(){sv(this);for(var t=[],e=0;e<this.g.length;e++)t.push(this.h[this.g[e]]);return t};K.T=function(){return sv(this),this.g.concat()};function sv(t){if(t.i!=t.g.length){for(var e=0,n=0;e<t.g.length;){var s=t.g[e];so(t.h,s)&&(t.g[n++]=s),e++}t.g.length=n}if(t.i!=t.g.length){var r={};for(n=e=0;e<t.g.length;)s=t.g[e],so(r,s)||(t.g[n++]=s,r[s]=1),e++;t.g.length=n}}K.get=function(t,e){return so(this.h,t)?this.h[t]:e};K.set=function(t,e){so(this.h,t)||(this.i++,this.g.push(t)),this.h[t]=e};K.forEach=function(t,e){for(var n=this.T(),s=0;s<n.length;s++){var r=n[s],i=this.get(r);t.call(e,i,r,this)}};function so(t,e){return Object.prototype.hasOwnProperty.call(t,e)}var yR=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Pz(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var s=t[n].indexOf("="),r=null;if(0<=s){var i=t[n].substring(0,s);r=t[n].substring(s+1)}else i=t[n];e(i,r?decodeURIComponent(r.replace(/\+/g," ")):"")}}}function ro(t,e){if(this.i=this.s=this.j="",this.m=null,this.o=this.l="",this.g=!1,t instanceof ro){this.g=e!==void 0?e:t.g,ud(this,t.j),this.s=t.s,hd(this,t.i),dd(this,t.m),this.l=t.l,e=t.h;var n=new Ml;n.i=e.i,e.g&&(n.g=new Ga(e.g),n.h=e.h),cE(this,n),this.o=t.o}else t&&(n=String(t).match(yR))?(this.g=!!e,ud(this,n[1]||"",!0),this.s=Wc(n[2]||""),hd(this,n[3]||"",!0),dd(this,n[4]),this.l=Wc(n[5]||"",!0),cE(this,n[6]||"",!0),this.o=Wc(n[7]||"")):(this.g=!!e,this.h=new Ml(null,this.g))}ro.prototype.toString=function(){var t=[],e=this.j;e&&t.push(Ac(e,lE,!0),":");var n=this.i;return(n||e=="file")&&(t.push("//"),(e=this.s)&&t.push(Ac(e,lE,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),n=this.m,n!=null&&t.push(":",String(n))),(n=this.l)&&(this.i&&n.charAt(0)!="/"&&t.push("/"),t.push(Ac(n,n.charAt(0)=="/"?Lz:Mz,!0))),(n=this.h.toString())&&t.push("?",n),(n=this.o)&&t.push("#",Ac(n,Uz)),t.join("")};function or(t){return new ro(t)}function ud(t,e,n){t.j=n?Wc(e,!0):e,t.j&&(t.j=t.j.replace(/:$/,""))}function hd(t,e,n){t.i=n?Wc(e,!0):e}function dd(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.m=e}else t.m=null}function cE(t,e,n){e instanceof Ml?(t.h=e,$z(t.h,t.g)):(n||(e=Ac(e,Fz)),t.h=new Ml(e,t.g))}function He(t,e,n){t.h.set(e,n)}function Vf(t){return He(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),t}function Dz(t){return t instanceof ro?or(t):new ro(t,void 0)}function xz(t,e,n,s){var r=new ro(null,void 0);return t&&ud(r,t),e&&hd(r,e),n&&dd(r,n),s&&(r.l=s),r}function Wc(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function Ac(t,e,n){return typeof t=="string"?(t=encodeURI(t).replace(e,Oz),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function Oz(t){return t=t.charCodeAt(0),"%"+(t>>4&15).toString(16)+(t&15).toString(16)}var lE=/[#\/\?@]/g,Mz=/[#\?:]/g,Lz=/[#\?]/g,Fz=/[#\?@]/g,Uz=/#/g;function Ml(t,e){this.h=this.g=null,this.i=t||null,this.j=!!e}function ai(t){t.g||(t.g=new Ga,t.h=0,t.i&&Pz(t.i,function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)}))}K=Ml.prototype;K.add=function(t,e){ai(this),this.i=null,t=za(this,t);var n=this.g.get(t);return n||this.g.set(t,n=[]),n.push(e),this.h+=1,this};function vR(t,e){ai(t),e=za(t,e),so(t.g.h,e)&&(t.i=null,t.h-=t.g.get(e).length,t=t.g,so(t.h,e)&&(delete t.h[e],t.i--,t.g.length>2*t.i&&sv(t)))}function wR(t,e){return ai(t),e=za(t,e),so(t.g.h,e)}K.forEach=function(t,e){ai(this),this.g.forEach(function(n,s){Hk(n,function(r){t.call(e,r,s,this)},this)},this)};K.T=function(){ai(this);for(var t=this.g.R(),e=this.g.T(),n=[],s=0;s<e.length;s++)for(var r=t[s],i=0;i<r.length;i++)n.push(e[s]);return n};K.R=function(t){ai(this);var e=[];if(typeof t=="string")wR(this,t)&&(e=ZI(e,this.g.get(za(this,t))));else{t=this.g.R();for(var n=0;n<t.length;n++)e=ZI(e,t[n])}return e};K.set=function(t,e){return ai(this),this.i=null,t=za(this,t),wR(this,t)&&(this.h-=this.g.get(t).length),this.g.set(t,[e]),this.h+=1,this};K.get=function(t,e){return t?(t=this.R(t),0<t.length?String(t[0]):e):e};function bR(t,e,n){vR(t,e),0<n.length&&(t.i=null,t.g.set(za(t,e),qy(n)),t.h+=n.length)}K.toString=function(){if(this.i)return this.i;if(!this.g)return"";for(var t=[],e=this.g.T(),n=0;n<e.length;n++){var s=e[n],r=encodeURIComponent(String(s));s=this.R(s);for(var i=0;i<s.length;i++){var o=r;s[i]!==""&&(o+="="+encodeURIComponent(String(s[i]))),t.push(o)}}return this.i=t.join("&")};function za(t,e){return e=String(e),t.j&&(e=e.toLowerCase()),e}function $z(t,e){e&&!t.j&&(ai(t),t.i=null,t.g.forEach(function(n,s){var r=s.toLowerCase();s!=r&&(vR(this,s),bR(this,r,n))},t)),t.j=e}var Vz=class{constructor(t,e){this.h=t,this.g=e}};function IR(t){this.l=t||Bz,oe.PerformanceNavigationTiming?(t=oe.performance.getEntriesByType("navigation"),t=0<t.length&&(t[0].nextHopProtocol=="hq"||t[0].nextHopProtocol=="h2")):t=!!(oe.g&&oe.g.Ea&&oe.g.Ea()&&oe.g.Ea().Zb),this.j=t?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var Bz=10;function ER(t){return t.h?!0:t.g?t.g.size>=t.j:!1}function TR(t){return t.h?1:t.g?t.g.size:0}function Pm(t,e){return t.h?t.h==e:t.g?t.g.has(e):!1}function rv(t,e){t.g?t.g.add(e):t.h=e}function SR(t,e){t.h&&t.h==e?t.h=null:t.g&&t.g.has(e)&&t.g.delete(e)}IR.prototype.cancel=function(){if(this.i=CR(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const t of this.g.values())t.cancel();this.g.clear()}};function CR(t){if(t.h!=null)return t.i.concat(t.h.D);if(t.g!=null&&t.g.size!==0){let e=t.i;for(const n of t.g.values())e=e.concat(n.D);return e}return qy(t.i)}function iv(){}iv.prototype.stringify=function(t){return oe.JSON.stringify(t,void 0)};iv.prototype.parse=function(t){return oe.JSON.parse(t,void 0)};function qz(){this.g=new iv}function jz(t,e,n){const s=n||"";try{nv(t,function(r,i){let o=r;_u(r)&&(o=Qy(r)),e.push(s+i+"="+encodeURIComponent(o))})}catch(r){throw e.push(s+"type="+encodeURIComponent("_badmap")),r}}function Kz(t,e){const n=new Mf;if(oe.Image){const s=new Image;s.onload=Qu(Ju,n,s,"TestLoadImage: loaded",!0,e),s.onerror=Qu(Ju,n,s,"TestLoadImage: error",!1,e),s.onabort=Qu(Ju,n,s,"TestLoadImage: abort",!1,e),s.ontimeout=Qu(Ju,n,s,"TestLoadImage: timeout",!1,e),oe.setTimeout(function(){s.ontimeout&&s.ontimeout()},1e4),s.src=t}else e(!1)}function Ju(t,e,n,s,r){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,r(s)}catch{}}function Eu(t){this.l=t.$b||null,this.j=t.ib||!1}Gt(Eu,Zy);Eu.prototype.g=function(){return new Bf(this.l,this.j)};Eu.prototype.i=function(t){return function(){return t}}({});function Bf(t,e){Dt.call(this),this.D=t,this.u=e,this.m=void 0,this.readyState=ov,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}Gt(Bf,Dt);var ov=0;K=Bf.prototype;K.open=function(t,e){if(this.readyState!=ov)throw this.abort(),Error("Error reopening a connection");this.C=t,this.B=e,this.readyState=1,Ll(this)};K.send=function(t){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};t&&(e.body=t),(this.D||oe).fetch(new Request(this.B,e)).then(this.Va.bind(this),this.ha.bind(this))};K.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted."),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Tu(this)),this.readyState=ov};K.Va=function(t){if(this.g&&(this.l=t,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=t.headers,this.readyState=2,Ll(this)),this.g&&(this.readyState=3,Ll(this),this.g)))if(this.responseType==="arraybuffer")t.arrayBuffer().then(this.Ta.bind(this),this.ha.bind(this));else if(typeof oe.ReadableStream!="undefined"&&"body"in t){if(this.j=t.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;AR(this)}else t.text().then(this.Ua.bind(this),this.ha.bind(this))};function AR(t){t.j.read().then(t.Sa.bind(t)).catch(t.ha.bind(t))}K.Sa=function(t){if(this.g){if(this.u&&t.value)this.response.push(t.value);else if(!this.u){var e=t.value?t.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!t.done}))&&(this.response=this.responseText+=e)}t.done?Tu(this):Ll(this),this.readyState==3&&AR(this)}};K.Ua=function(t){this.g&&(this.response=this.responseText=t,Tu(this))};K.Ta=function(t){this.g&&(this.response=t,Tu(this))};K.ha=function(){this.g&&Tu(this)};function Tu(t){t.readyState=4,t.l=null,t.j=null,t.A=null,Ll(t)}K.setRequestHeader=function(t,e){this.v.append(t,e)};K.getResponseHeader=function(t){return this.h&&this.h.get(t.toLowerCase())||""};K.getAllResponseHeaders=function(){if(!this.h)return"";const t=[],e=this.h.entries();for(var n=e.next();!n.done;)n=n.value,t.push(n[0]+": "+n[1]),n=e.next();return t.join(`\r
`)};function Ll(t){t.onreadystatechange&&t.onreadystatechange.call(t)}Object.defineProperty(Bf.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(t){this.m=t?"include":"same-origin"}});var Wz=oe.JSON.parse;function dt(t){Dt.call(this),this.headers=new Ga,this.u=t||null,this.h=!1,this.C=this.g=null,this.H="",this.m=0,this.j="",this.l=this.F=this.v=this.D=!1,this.B=0,this.A=null,this.J=kR,this.K=this.L=!1}Gt(dt,Dt);var kR="",Hz=/^https?$/i,Gz=["POST","PUT"];K=dt.prototype;K.ea=function(t,e,n,s){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.H+"; newUri="+t);e=e?e.toUpperCase():"GET",this.H=t,this.j="",this.m=0,this.D=!1,this.h=!0,this.g=this.u?this.u.g():Am.g(),this.C=this.u?aE(this.u):aE(Am),this.g.onreadystatechange=jt(this.Fa,this);try{this.F=!0,this.g.open(e,String(t),!0),this.F=!1}catch(i){uE(this,i);return}t=n||"";const r=new Ga(this.headers);s&&nv(s,function(i,o){r.set(o,i)}),s=rz(r.T()),n=oe.FormData&&t instanceof oe.FormData,!(0<=Wk(Gz,e))||s||n||r.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),r.forEach(function(i,o){this.g.setRequestHeader(o,i)},this),this.J&&(this.g.responseType=this.J),"withCredentials"in this.g&&this.g.withCredentials!==this.L&&(this.g.withCredentials=this.L);try{PR(this),0<this.B&&((this.K=zz(this.g))?(this.g.timeout=this.B,this.g.ontimeout=jt(this.pa,this)):this.A=Xy(this.pa,this.B,this)),this.v=!0,this.g.send(t),this.v=!1}catch(i){uE(this,i)}};function zz(t){return Ea&&lz()&&typeof t.timeout=="number"&&t.ontimeout!==void 0}function Qz(t){return t.toLowerCase()=="content-type"}K.pa=function(){typeof By!="undefined"&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,Kt(this,"timeout"),this.abort(8))};function uE(t,e){t.h=!1,t.g&&(t.l=!0,t.g.abort(),t.l=!1),t.j=e,t.m=5,RR(t),qf(t)}function RR(t){t.D||(t.D=!0,Kt(t,"complete"),Kt(t,"error"))}K.abort=function(t){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=t||7,Kt(this,"complete"),Kt(this,"abort"),qf(this))};K.M=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),qf(this,!0)),dt.Z.M.call(this)};K.Fa=function(){this.s||(this.F||this.v||this.l?NR(this):this.cb())};K.cb=function(){NR(this)};function NR(t){if(t.h&&typeof By!="undefined"&&(!t.C[1]||Js(t)!=4||t.ba()!=2)){if(t.v&&Js(t)==4)Xy(t.Fa,0,t);else if(Kt(t,"readystatechange"),Js(t)==4){t.h=!1;try{const a=t.ba();e:switch(a){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break e;default:e=!1}var n;if(!(n=e)){var s;if(s=a===0){var r=String(t.H).match(yR)[1]||null;if(!r&&oe.self&&oe.self.location){var i=oe.self.location.protocol;r=i.substr(0,i.length-1)}s=!Hz.test(r?r.toLowerCase():"")}n=s}if(n)Kt(t,"complete"),Kt(t,"success");else{t.m=6;try{var o=2<Js(t)?t.g.statusText:""}catch{o=""}t.j=o+" ["+t.ba()+"]",RR(t)}}finally{qf(t)}}}}function qf(t,e){if(t.g){PR(t);const n=t.g,s=t.C[0]?od:null;t.g=null,t.C=null,e||Kt(t,"ready");try{n.onreadystatechange=s}catch{}}}function PR(t){t.g&&t.K&&(t.g.ontimeout=null),t.A&&(oe.clearTimeout(t.A),t.A=null)}function Js(t){return t.g?t.g.readyState:0}K.ba=function(){try{return 2<Js(this)?this.g.status:-1}catch{return-1}};K.ga=function(){try{return this.g?this.g.responseText:""}catch{return""}};K.Qa=function(t){if(this.g){var e=this.g.responseText;return t&&e.indexOf(t)==0&&(e=e.substring(t.length)),Wz(e)}};function hE(t){try{if(!t.g)return null;if("response"in t.g)return t.g.response;switch(t.J){case kR:case"text":return t.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in t.g)return t.g.mozResponseArrayBuffer}return null}catch{return null}}K.Da=function(){return this.m};K.La=function(){return typeof this.j=="string"?this.j:String(this.j)};function Yz(t){let e="";return jy(t,function(n,s){e+=s,e+=":",e+=n,e+=`\r
`}),e}function av(t,e,n){e:{for(s in n){var s=!1;break e}s=!0}s||(n=Yz(n),typeof t=="string"?n!=null&&encodeURIComponent(String(n)):He(t,e,n))}function gc(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function DR(t){this.za=0,this.l=[],this.h=new Mf,this.la=this.oa=this.F=this.W=this.g=this.sa=this.D=this.aa=this.o=this.P=this.s=null,this.Za=this.V=0,this.Xa=gc("failFast",!1,t),this.N=this.v=this.u=this.m=this.j=null,this.X=!0,this.I=this.ta=this.U=-1,this.Y=this.A=this.C=0,this.Pa=gc("baseRetryDelayMs",5e3,t),this.$a=gc("retryDelaySeedMs",1e4,t),this.Ya=gc("forwardChannelMaxRetries",2,t),this.ra=gc("forwardChannelRequestTimeoutMs",2e4,t),this.qa=t&&t.xmlHttpFactory||void 0,this.Ba=t&&t.Yb||!1,this.K=void 0,this.H=t&&t.supportsCrossDomainXhr||!1,this.J="",this.i=new IR(t&&t.concurrentRequestLimit),this.Ca=new qz,this.ja=t&&t.fastHandshake||!1,this.Ra=t&&t.Wb||!1,t&&t.Aa&&this.h.Aa(),t&&t.forceLongPolling&&(this.X=!1),this.$=!this.ja&&this.X&&t&&t.detectBufferingProxy||!1,this.ka=void 0,this.O=0,this.L=!1,this.B=null,this.Wa=!t||t.Xb!==!1}K=DR.prototype;K.ma=8;K.G=1;function cv(t){if(xR(t),t.G==3){var e=t.V++,n=or(t.F);He(n,"SID",t.J),He(n,"RID",e),He(n,"TYPE","terminate"),Su(t,n),e=new bu(t,t.h,e,void 0),e.K=2,e.v=Vf(or(n)),n=!1,oe.navigator&&oe.navigator.sendBeacon&&(n=oe.navigator.sendBeacon(e.v.toString(),"")),!n&&oe.Image&&(new Image().src=e.v,n=!0),n||(e.g=BR(e.l,null),e.g.ea(e.v)),e.F=Date.now(),Iu(e)}$R(t)}K.hb=function(t){try{this.h.info("Origin Trials invoked: "+t)}catch{}};function jf(t){t.g&&(uv(t),t.g.cancel(),t.g=null)}function xR(t){jf(t),t.u&&(oe.clearTimeout(t.u),t.u=null),fd(t),t.i.cancel(),t.m&&(typeof t.m=="number"&&oe.clearTimeout(t.m),t.m=null)}function Yp(t,e){t.l.push(new Vz(t.Za++,e)),t.G==3&&Kf(t)}function Kf(t){ER(t.i)||t.m||(t.m=!0,Yy(t.Ha,t),t.C=0)}function Jz(t,e){return TR(t.i)>=t.i.j-(t.m?1:0)?!1:t.m?(t.l=e.D.concat(t.l),!0):t.G==1||t.G==2||t.C>=(t.Xa?0:t.Ya)?!1:(t.m=vu(jt(t.Ha,t,e),UR(t,t.C)),t.C++,!0)}K.Ha=function(t){if(this.m)if(this.m=null,this.G==1){if(!t){this.V=Math.floor(1e5*Math.random()),t=this.V++;const r=new bu(this,this.h,t,void 0);let i=this.s;if(this.P&&(i?(i=Gk(i),zk(i,this.P)):i=this.P),this.o===null&&(r.H=i),this.ja)e:{for(var e=0,n=0;n<this.l.length;n++){t:{var s=this.l[n];if("__data__"in s.g&&(s=s.g.__data__,typeof s=="string")){s=s.length;break t}s=void 0}if(s===void 0)break;if(e+=s,4096<e){e=n;break e}if(e===4096||n===this.l.length-1){e=n+1;break e}}e=1e3}else e=1e3;e=OR(this,r,e),n=or(this.F),He(n,"RID",t),He(n,"CVER",22),this.D&&He(n,"X-HTTP-Session-Id",this.D),Su(this,n),this.o&&i&&av(n,this.o,i),rv(this.i,r),this.Ra&&He(n,"TYPE","init"),this.ja?(He(n,"$req",e),He(n,"SID","null"),r.$=!0,Rm(r,n,null)):Rm(r,n,e),this.G=2}}else this.G==3&&(t?dE(this,t):this.l.length==0||ER(this.i)||dE(this))};function dE(t,e){var n;e?n=e.m:n=t.V++;const s=or(t.F);He(s,"SID",t.J),He(s,"RID",n),He(s,"AID",t.U),Su(t,s),t.o&&t.s&&av(s,t.o,t.s),n=new bu(t,t.h,n,t.C+1),t.o===null&&(n.H=t.s),e&&(t.l=e.D.concat(t.l)),e=OR(t,n,1e3),n.setTimeout(Math.round(.5*t.ra)+Math.round(.5*t.ra*Math.random())),rv(t.i,n),Rm(n,s,e)}function Su(t,e){t.j&&nv({},function(n,s){He(e,s,n)})}function OR(t,e,n){n=Math.min(t.l.length,n);var s=t.j?jt(t.j.Oa,t.j,t):null;e:{var r=t.l;let i=-1;for(;;){const o=["count="+n];i==-1?0<n?(i=r[0].h,o.push("ofs="+i)):i=0:o.push("ofs="+i);let a=!0;for(let c=0;c<n;c++){let l=r[c].h;const u=r[c].g;if(l-=i,0>l)i=Math.max(0,r[c].h-100),a=!1;else try{jz(u,o,"req"+l+"_")}catch{s&&s(u)}}if(a){s=o.join("&");break e}}}return t=t.l.splice(0,n),e.D=t,s}function MR(t){t.g||t.u||(t.Y=1,Yy(t.Ga,t),t.A=0)}function lv(t){return t.g||t.u||3<=t.A?!1:(t.Y++,t.u=vu(jt(t.Ga,t),UR(t,t.A)),t.A++,!0)}K.Ga=function(){if(this.u=null,LR(this),this.$&&!(this.L||this.g==null||0>=this.O)){var t=2*this.O;this.h.info("BP detection timer enabled: "+t),this.B=vu(jt(this.bb,this),t)}};K.bb=function(){this.B&&(this.B=null,this.h.info("BP detection timeout reached."),this.h.info("Buffering proxy detected and switch to long-polling!"),this.N=!1,this.L=!0,ln(10),jf(this),LR(this))};function uv(t){t.B!=null&&(oe.clearTimeout(t.B),t.B=null)}function LR(t){t.g=new bu(t,t.h,"rpc",t.Y),t.o===null&&(t.g.H=t.s),t.g.O=0;var e=or(t.oa);He(e,"RID","rpc"),He(e,"SID",t.J),He(e,"CI",t.N?"0":"1"),He(e,"AID",t.U),Su(t,e),He(e,"TYPE","xmlhttp"),t.o&&t.s&&av(e,t.o,t.s),t.K&&t.g.setTimeout(t.K);var n=t.g;t=t.la,n.K=1,n.v=Vf(or(e)),n.s=null,n.U=!0,pR(n,t)}K.ab=function(){this.v!=null&&(this.v=null,jf(this),lv(this),ln(19))};function fd(t){t.v!=null&&(oe.clearTimeout(t.v),t.v=null)}function FR(t,e){var n=null;if(t.g==e){fd(t),uv(t),t.g=null;var s=2}else if(Pm(t.i,e))n=e.D,SR(t.i,e),s=1;else return;if(t.I=e.N,t.G!=0){if(e.i)if(s==1){n=e.s?e.s.length:0,e=Date.now()-e.F;var r=t.C;s=Lf(),Kt(s,new uR(s,n)),Kf(t)}else MR(t);else if(r=e.o,r==3||r==0&&0<t.I||!(s==1&&Jz(t,e)||s==2&&lv(t)))switch(n&&0<n.length&&(e=t.i,e.i=e.i.concat(n)),r){case 1:Li(t,5);break;case 4:Li(t,10);break;case 3:Li(t,6);break;default:Li(t,2)}}}function UR(t,e){let n=t.Pa+Math.floor(Math.random()*t.$a);return t.j||(n*=2),n*e}function Li(t,e){if(t.h.info("Error code "+e),e==2){var n=null;t.j&&(n=null);var s=jt(t.jb,t);n||(n=new ro("//www.google.com/images/cleardot.gif"),oe.location&&oe.location.protocol=="http"||ud(n,"https"),Vf(n)),Kz(n.toString(),s)}else ln(2);t.G=0,t.j&&t.j.va(e),$R(t),xR(t)}K.jb=function(t){t?(this.h.info("Successfully pinged google.com"),ln(2)):(this.h.info("Failed to ping google.com"),ln(1))};function $R(t){t.G=0,t.I=-1,t.j&&((CR(t.i).length!=0||t.l.length!=0)&&(t.i.i.length=0,qy(t.l),t.l.length=0),t.j.ua())}function VR(t,e,n){let s=Dz(n);if(s.i!="")e&&hd(s,e+"."+s.i),dd(s,s.m);else{const r=oe.location;s=xz(r.protocol,e?e+"."+r.hostname:r.hostname,+r.port,n)}return t.aa&&jy(t.aa,function(r,i){He(s,i,r)}),e=t.D,n=t.sa,e&&n&&He(s,e,n),He(s,"VER",t.ma),Su(t,s),s}function BR(t,e,n){if(e&&!t.H)throw Error("Can't create secondary domain capable XhrIo object.");return e=n&&t.Ba&&!t.qa?new dt(new Eu({ib:!0})):new dt(t.qa),e.L=t.H,e}function qR(){}K=qR.prototype;K.xa=function(){};K.wa=function(){};K.va=function(){};K.ua=function(){};K.Oa=function(){};function pd(){if(Ea&&!(10<=Number(uz)))throw Error("Environmental error: no available transport.")}pd.prototype.g=function(t,e){return new xn(t,e)};function xn(t,e){Dt.call(this),this.g=new DR(e),this.l=t,this.h=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.g.s=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.ya&&(t?t["X-WebChannel-Client-Profile"]=e.ya:t={"X-WebChannel-Client-Profile":e.ya}),this.g.P=t,(t=e&&e.httpHeadersOverwriteParam)&&!ad(t)&&(this.g.o=t),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!ad(e)&&(this.g.D=e,t=this.h,t!==null&&e in t&&(t=this.h,e in t&&delete t[e])),this.j=new Qa(this)}Gt(xn,Dt);xn.prototype.m=function(){this.g.j=this.j,this.A&&(this.g.H=!0);var t=this.g,e=this.l,n=this.h||void 0;t.Wa&&(t.h.info("Origin Trials enabled."),Yy(jt(t.hb,t,e))),ln(0),t.W=e,t.aa=n||{},t.N=t.X,t.F=VR(t,null,t.W),Kf(t)};xn.prototype.close=function(){cv(this.g)};xn.prototype.u=function(t){if(typeof t=="string"){var e={};e.__data__=t,Yp(this.g,e)}else this.v?(e={},e.__data__=Qy(t),Yp(this.g,e)):Yp(this.g,t)};xn.prototype.M=function(){this.g.j=null,delete this.j,cv(this.g),delete this.g,xn.Z.M.call(this)};function jR(t){ev.call(this);var e=t.__sm__;if(e){e:{for(const n in e){t=n;break e}t=void 0}(this.i=t)&&(t=this.i,e=e!==null&&t in e?e[t]:void 0),this.data=e}else this.data=t}Gt(jR,ev);function KR(){tv.call(this),this.status=1}Gt(KR,tv);function Qa(t){this.g=t}Gt(Qa,qR);Qa.prototype.xa=function(){Kt(this.g,"a")};Qa.prototype.wa=function(t){Kt(this.g,new jR(t))};Qa.prototype.va=function(t){Kt(this.g,new KR)};Qa.prototype.ua=function(){Kt(this.g,"b")};pd.prototype.createWebChannel=pd.prototype.g;xn.prototype.send=xn.prototype.u;xn.prototype.open=xn.prototype.m;xn.prototype.close=xn.prototype.close;Ff.NO_ERROR=0;Ff.TIMEOUT=8;Ff.HTTP_ERROR=6;hR.COMPLETE="complete";dR.EventType=wu;wu.OPEN="a";wu.CLOSE="b";wu.ERROR="c";wu.MESSAGE="d";Dt.prototype.listen=Dt.prototype.N;dt.prototype.listenOnce=dt.prototype.O;dt.prototype.getLastError=dt.prototype.La;dt.prototype.getLastErrorCode=dt.prototype.Da;dt.prototype.getStatus=dt.prototype.ba;dt.prototype.getResponseJson=dt.prototype.Qa;dt.prototype.getResponseText=dt.prototype.ga;dt.prototype.send=dt.prototype.ea;var Xz=function(){return new pd},Zz=function(){return Lf()},Jp=Ff,e2=hR,t2=Co,fE={rb:0,ub:1,vb:2,Ob:3,Tb:4,Qb:5,Rb:6,Pb:7,Nb:8,Sb:9,PROXY:10,NOPROXY:11,Lb:12,Hb:13,Ib:14,Gb:15,Jb:16,Kb:17,nb:18,mb:19,ob:20},n2=Eu,Xu=dR,s2=dt;const pE="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class It{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}It.UNAUTHENTICATED=new It(null),It.GOOGLE_CREDENTIALS=new It("google-credentials-uid"),It.FIRST_PARTY=new It("first-party-uid"),It.MOCK_USER=new It("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ya="9.9.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jr=new Vs("@firebase/firestore");function Dm(){return Jr.logLevel}function r2(t){Jr.setLogLevel(t)}function R(t,...e){if(Jr.logLevel<=de.DEBUG){const n=e.map(hv);Jr.debug(`Firestore (${Ya}): ${t}`,...n)}}function ht(t,...e){if(Jr.logLevel<=de.ERROR){const n=e.map(hv);Jr.error(`Firestore (${Ya}): ${t}`,...n)}}function Fl(t,...e){if(Jr.logLevel<=de.WARN){const n=e.map(hv);Jr.warn(`Firestore (${Ya}): ${t}`,...n)}}function hv(t){if(typeof t=="string")return t;try{return e=t,JSON.stringify(e)}catch{return t}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/var e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function W(t="Unexpected state"){const e=`FIRESTORE (${Ya}) INTERNAL ASSERTION FAILED: `+t;throw ht(e),new Error(e)}function re(t,e){t||W()}function i2(t,e){t||W()}function B(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const w={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class S extends ct{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class St{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WR{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class o2{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(It.UNAUTHENTICATED))}shutdown(){}}class a2{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class c2{constructor(e){this.t=e,this.currentUser=It.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){let s=this.i;const r=c=>this.i!==s?(s=this.i,n(c)):Promise.resolve();let i=new St;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new St,e.enqueueRetryable(()=>r(this.currentUser))};const o=()=>{const c=i;e.enqueueRetryable(async()=>{await c.promise,await r(this.currentUser)})},a=c=>{R("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.auth.addAuthTokenListener(this.o),o()};this.t.onInit(c=>a(c)),setTimeout(()=>{if(!this.auth){const c=this.t.getImmediate({optional:!0});c?a(c):(R("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new St)}},0),o()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(s=>this.i!==e?(R("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):s?(re(typeof s.accessToken=="string"),new WR(s.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const e=this.auth&&this.auth.getUid();return re(e===null||typeof e=="string"),new It(e)}}class l2{constructor(e,n,s){this.type="FirstParty",this.user=It.FIRST_PARTY,this.headers=new Map,this.headers.set("X-Goog-AuthUser",n);const r=e.auth.getAuthHeaderValueForFirstParty([]);r&&this.headers.set("Authorization",r),s&&this.headers.set("X-Goog-Iam-Authorization-Token",s)}}class u2{constructor(e,n,s){this.h=e,this.l=n,this.m=s}getToken(){return Promise.resolve(new l2(this.h,this.l,this.m))}start(e,n){e.enqueueRetryable(()=>n(It.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class h2{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class d2{constructor(e){this.g=e,this.forceRefresh=!1,this.appCheck=null,this.p=null}start(e,n){const s=i=>{i.error!=null&&R("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const o=i.token!==this.p;return this.p=i.token,R("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>s(i))};const r=i=>{R("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.appCheck.addTokenListener(this.o)};this.g.onInit(i=>r(i)),setTimeout(()=>{if(!this.appCheck){const i=this.g.getImmediate({optional:!0});i?r(i):R("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(re(typeof n.token=="string"),this.p=n.token,new h2(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function f2(t){const e=typeof self!="undefined"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let s=0;s<t;s++)n[s]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HR{static I(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=Math.floor(256/e.length)*e.length;let s="";for(;s.length<20;){const r=f2(40);for(let i=0;i<r.length;++i)s.length<20&&r[i]<n&&(s+=e.charAt(r[i]%e.length))}return s}}function ce(t,e){return t<e?-1:t>e?1:0}function Ta(t,e,n){return t.length===e.length&&t.every((s,r)=>n(s,e[r]))}function GR(t){return t+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ze{constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new S(w.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new S(w.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<-62135596800)throw new S(w.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new S(w.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return ze.fromMillis(Date.now())}static fromDate(e){return ze.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),s=Math.floor(1e6*(e-1e3*n));return new ze(n,s)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?ce(this.nanoseconds,e.nanoseconds):ce(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class se{constructor(e){this.timestamp=e}static fromTimestamp(e){return new se(e)}static min(){return new se(new ze(0,0))}static max(){return new se(new ze(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ul{constructor(e,n,s){n===void 0?n=0:n>e.length&&W(),s===void 0?s=e.length-n:s>e.length-n&&W(),this.segments=e,this.offset=n,this.len=s}get length(){return this.len}isEqual(e){return Ul.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof Ul?e.forEach(s=>{n.push(s)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,s=this.limit();n<s;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const s=Math.min(e.length,n.length);for(let r=0;r<s;r++){const i=e.get(r),o=n.get(r);if(i<o)return-1;if(i>o)return 1}return e.length<n.length?-1:e.length>n.length?1:0}}class we extends Ul{construct(e,n,s){return new we(e,n,s)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...e){const n=[];for(const s of e){if(s.indexOf("//")>=0)throw new S(w.INVALID_ARGUMENT,`Invalid segment (${s}). Paths must not contain // in them.`);n.push(...s.split("/").filter(r=>r.length>0))}return new we(n)}static emptyPath(){return new we([])}}const p2=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class ot extends Ul{construct(e,n,s){return new ot(e,n,s)}static isValidIdentifier(e){return p2.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),ot.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new ot(["__name__"])}static fromServerFormat(e){const n=[];let s="",r=0;const i=()=>{if(s.length===0)throw new S(w.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(s),s=""};let o=!1;for(;r<e.length;){const a=e[r];if(a==="\\"){if(r+1===e.length)throw new S(w.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const c=e[r+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new S(w.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);s+=c,r+=2}else a==="`"?(o=!o,r++):a!=="."||o?(s+=a,r++):(i(),r++)}if(i(),o)throw new S(w.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new ot(n)}static emptyPath(){return new ot([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F{constructor(e){this.path=e}static fromPath(e){return new F(we.fromString(e))}static fromName(e){return new F(we.fromString(e).popFirst(5))}static empty(){return new F(we.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&we.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return we.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new F(new we(e.slice()))}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zR{constructor(e,n,s,r){this.indexId=e,this.collectionGroup=n,this.fields=s,this.indexState=r}}function xm(t){return t.fields.find(e=>e.kind===2)}function Ii(t){return t.fields.filter(e=>e.kind!==2)}zR.UNKNOWN_ID=-1;class g2{constructor(e,n){this.fieldPath=e,this.kind=n}}class gd{constructor(e,n){this.sequenceNumber=e,this.offset=n}static empty(){return new gd(0,On.min())}}function QR(t,e){const n=t.toTimestamp().seconds,s=t.toTimestamp().nanoseconds+1,r=se.fromTimestamp(s===1e9?new ze(n+1,0):new ze(n,s));return new On(r,F.empty(),e)}function YR(t){return new On(t.readTime,t.key,-1)}class On{constructor(e,n,s){this.readTime=e,this.documentKey=n,this.largestBatchId=s}static min(){return new On(se.min(),F.empty(),-1)}static max(){return new On(se.max(),F.empty(),-1)}}function dv(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=F.comparator(t.documentKey,e.documentKey),n!==0?n:ce(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JR="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class XR{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ci(t){if(t.code!==w.FAILED_PRECONDITION||t.message!==JR)throw t;R("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class v{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&W(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new v((s,r)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(s,r)},this.catchCallback=i=>{this.wrapFailure(n,i).next(s,r)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof v?n:v.resolve(n)}catch(n){return v.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):v.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):v.reject(n)}static resolve(e){return new v((n,s)=>{n(e)})}static reject(e){return new v((n,s)=>{s(e)})}static waitFor(e){return new v((n,s)=>{let r=0,i=0,o=!1;e.forEach(a=>{++r,a.next(()=>{++i,o&&i===r&&n()},c=>s(c))}),o=!0,i===r&&n()})}static or(e){let n=v.resolve(!1);for(const s of e)n=n.next(r=>r?v.resolve(r):s());return n}static forEach(e,n){const s=[];return e.forEach((r,i)=>{s.push(n.call(this,r,i))}),this.waitFor(s)}static mapArray(e,n){return new v((s,r)=>{const i=e.length,o=new Array(i);let a=0;for(let c=0;c<i;c++){const l=c;n(e[l]).next(u=>{o[l]=u,++a,a===i&&s(o)},u=>r(u))}})}static doWhile(e,n){return new v((s,r)=>{const i=()=>{e()===!0?n().next(()=>{i()},r):s()};i()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wf{constructor(e,n){this.action=e,this.transaction=n,this.aborted=!1,this.T=new St,this.transaction.oncomplete=()=>{this.T.resolve()},this.transaction.onabort=()=>{n.error?this.T.reject(new Hc(e,n.error)):this.T.resolve()},this.transaction.onerror=s=>{const r=fv(s.target.error);this.T.reject(new Hc(e,r))}}static open(e,n,s,r){try{return new Wf(n,e.transaction(r,s))}catch(i){throw new Hc(n,i)}}get A(){return this.T.promise}abort(e){e&&this.T.reject(e),this.aborted||(R("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}R(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const n=this.transaction.objectStore(e);return new _2(n)}}class rs{constructor(e,n,s){this.name=e,this.version=n,this.P=s,rs.v(We())===12.2&&ht("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return R("SimpleDb","Removing database:",e),Ci(window.indexedDB.deleteDatabase(e)).toPromise()}static V(){if(!bn())return!1;if(rs.S())return!0;const e=We(),n=rs.v(e),s=0<n&&n<10,r=rs.D(e),i=0<r&&r<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||s||i)}static S(){var e;return typeof process!="undefined"&&((e=process.env)===null||e===void 0?void 0:e.C)==="YES"}static N(e,n){return e.store(n)}static v(e){const n=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),s=n?n[1].split("_").slice(0,2).join("."):"-1";return Number(s)}static D(e){const n=e.match(/Android ([\d.]+)/i),s=n?n[1].split(".").slice(0,2).join("."):"-1";return Number(s)}async k(e){return this.db||(R("SimpleDb","Opening database:",this.name),this.db=await new Promise((n,s)=>{const r=indexedDB.open(this.name,this.version);r.onsuccess=i=>{const o=i.target.result;n(o)},r.onblocked=()=>{s(new Hc(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},r.onerror=i=>{const o=i.target.error;o.name==="VersionError"?s(new S(w.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?s(new S(w.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):s(new Hc(e,o))},r.onupgradeneeded=i=>{R("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',i.oldVersion);const o=i.target.result;this.P.O(o,r.transaction,i.oldVersion,this.version).next(()=>{R("SimpleDb","Database upgrade to version "+this.version+" complete")})}})),this.M&&(this.db.onversionchange=n=>this.M(n)),this.db}F(e){this.M=e,this.db&&(this.db.onversionchange=n=>e(n))}async runTransaction(e,n,s,r){const i=n==="readonly";let o=0;for(;;){++o;try{this.db=await this.k(e);const a=Wf.open(this.db,e,i?"readonly":"readwrite",s),c=r(a).next(l=>(a.R(),l)).catch(l=>(a.abort(l),v.reject(l))).toPromise();return c.catch(()=>{}),await a.A,c}catch(a){const c=a,l=c.name!=="FirebaseError"&&o<3;if(R("SimpleDb","Transaction failed with error:",c.message,"Retrying:",l),this.close(),!l)return Promise.reject(c)}}}close(){this.db&&this.db.close(),this.db=void 0}}class m2{constructor(e){this.$=e,this.B=!1,this.L=null}get isDone(){return this.B}get U(){return this.L}set cursor(e){this.$=e}done(){this.B=!0}q(e){this.L=e}delete(){return Ci(this.$.delete())}}class Hc extends S{constructor(e,n){super(w.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${n}`),this.name="IndexedDbTransactionError"}}function li(t){return t.name==="IndexedDbTransactionError"}class _2{constructor(e){this.store=e}put(e,n){let s;return n!==void 0?(R("SimpleDb","PUT",this.store.name,e,n),s=this.store.put(n,e)):(R("SimpleDb","PUT",this.store.name,"<auto-key>",e),s=this.store.put(e)),Ci(s)}add(e){return R("SimpleDb","ADD",this.store.name,e,e),Ci(this.store.add(e))}get(e){return Ci(this.store.get(e)).next(n=>(n===void 0&&(n=null),R("SimpleDb","GET",this.store.name,e,n),n))}delete(e){return R("SimpleDb","DELETE",this.store.name,e),Ci(this.store.delete(e))}count(){return R("SimpleDb","COUNT",this.store.name),Ci(this.store.count())}K(e,n){const s=this.options(e,n);if(s.index||typeof this.store.getAll!="function"){const r=this.cursor(s),i=[];return this.G(r,(o,a)=>{i.push(a)}).next(()=>i)}{const r=this.store.getAll(s.range);return new v((i,o)=>{r.onerror=a=>{o(a.target.error)},r.onsuccess=a=>{i(a.target.result)}})}}j(e,n){const s=this.store.getAll(e,n===null?void 0:n);return new v((r,i)=>{s.onerror=o=>{i(o.target.error)},s.onsuccess=o=>{r(o.target.result)}})}W(e,n){R("SimpleDb","DELETE ALL",this.store.name);const s=this.options(e,n);s.H=!1;const r=this.cursor(s);return this.G(r,(i,o,a)=>a.delete())}J(e,n){let s;n?s=e:(s={},n=e);const r=this.cursor(s);return this.G(r,n)}Y(e){const n=this.cursor({});return new v((s,r)=>{n.onerror=i=>{const o=fv(i.target.error);r(o)},n.onsuccess=i=>{const o=i.target.result;o?e(o.primaryKey,o.value).next(a=>{a?o.continue():s()}):s()}})}G(e,n){const s=[];return new v((r,i)=>{e.onerror=o=>{i(o.target.error)},e.onsuccess=o=>{const a=o.target.result;if(!a)return void r();const c=new m2(a),l=n(a.primaryKey,a.value,c);if(l instanceof v){const u=l.catch(h=>(c.done(),v.reject(h)));s.push(u)}c.isDone?r():c.U===null?a.continue():a.continue(c.U)}}).next(()=>v.waitFor(s))}options(e,n){let s;return e!==void 0&&(typeof e=="string"?s=e:n=e),{index:s,range:n}}cursor(e){let n="next";if(e.reverse&&(n="prev"),e.index){const s=this.store.index(e.index);return e.H?s.openKeyCursor(e.range,n):s.openCursor(e.range,n)}return this.store.openCursor(e.range,n)}}function Ci(t){return new v((e,n)=>{t.onsuccess=s=>{const r=s.target.result;e(r)},t.onerror=s=>{const r=fv(s.target.error);n(r)}})}let gE=!1;function fv(t){const e=rs.v(We());if(e>=12.2&&e<13){const n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){const s=new S("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${n}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return gE||(gE=!0,setTimeout(()=>{throw s},0)),s}}return t}class y2{constructor(e,n){this.asyncQueue=e,this.X=n,this.task=null}start(){}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}Z(e){R("IndexBackiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{R("IndexBackiller",`Documents written: ${await this.X.tt()}`)}catch(n){li(n)?R("IndexBackiller","Ignoring IndexedDB error during index backfill: ",n):await ci(n)}await this.Z(1)})}}class v2{constructor(e,n){this.localStore=e,this.persistence=n}async tt(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",n=>this.et(n,e))}et(e,n){const s=new Set;let r=n,i=!0;return v.doWhile(()=>i===!0&&r>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(o!==null&&!s.has(o))return R("IndexBackiller",`Processing collection: ${o}`),this.nt(e,o,r).next(a=>{r-=a,s.add(o)});i=!1})).next(()=>n-r)}nt(e,n,s){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,n).next(r=>this.localStore.localDocuments.getNextDocuments(e,n,r,s).next(i=>{const o=i.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this.st(r,i)).next(a=>(R("IndexBackiller",`Updating offset: ${a}`),this.localStore.indexManager.updateCollectionGroup(e,n,a))).next(()=>o.size)}))}st(e,n){let s=e;return n.changes.forEach((r,i)=>{const o=YR(i);dv(o,s)>0&&(s=o)}),new On(s.readTime,s.documentKey,Math.max(n.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yn{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=s=>this.it(s),this.rt=s=>n.writeSequenceNumber(s))}it(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.rt&&this.rt(e),e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mE(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Ao(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function ZR(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */yn.ot=-1;class st{constructor(e,n){this.comparator=e,this.root=n||Ft.EMPTY}insert(e,n){return new st(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,Ft.BLACK,null,null))}remove(e){return new st(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Ft.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const s=this.comparator(e,n.key);if(s===0)return n.value;s<0?n=n.left:s>0&&(n=n.right)}return null}indexOf(e){let n=0,s=this.root;for(;!s.isEmpty();){const r=this.comparator(e,s.key);if(r===0)return n+s.left.size;r<0?s=s.left:(n+=s.left.size+1,s=s.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,s)=>(e(n,s),!1))}toString(){const e=[];return this.inorderTraversal((n,s)=>(e.push(`${n}:${s}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Zu(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Zu(this.root,e,this.comparator,!1)}getReverseIterator(){return new Zu(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Zu(this.root,e,this.comparator,!0)}}class Zu{constructor(e,n,s,r){this.isReverse=r,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=n?s(e.key,n):1,n&&r&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Ft{constructor(e,n,s,r,i){this.key=e,this.value=n,this.color=s!=null?s:Ft.RED,this.left=r!=null?r:Ft.EMPTY,this.right=i!=null?i:Ft.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,s,r,i){return new Ft(e!=null?e:this.key,n!=null?n:this.value,s!=null?s:this.color,r!=null?r:this.left,i!=null?i:this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,s){let r=this;const i=s(e,r.key);return r=i<0?r.copy(null,null,null,r.left.insert(e,n,s),null):i===0?r.copy(null,n,null,null,null):r.copy(null,null,null,null,r.right.insert(e,n,s)),r.fixUp()}removeMin(){if(this.left.isEmpty())return Ft.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let s,r=this;if(n(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,n),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),n(e,r.key)===0){if(r.right.isEmpty())return Ft.EMPTY;s=r.right.min(),r=r.copy(s.key,s.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,n))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Ft.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Ft.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw W();const e=this.left.check();if(e!==this.right.check())throw W();return e+(this.isRed()?0:1)}}Ft.EMPTY=null,Ft.RED=!0,Ft.BLACK=!1;Ft.EMPTY=new class{constructor(){this.size=0}get key(){throw W()}get value(){throw W()}get color(){throw W()}get left(){throw W()}get right(){throw W()}copy(t,e,n,s,r){return this}insert(t,e,n){return new Ft(t,e)}remove(t,e){return this}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ae{constructor(e){this.comparator=e,this.data=new st(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,s)=>(e(n),!1))}forEachInRange(e,n){const s=this.data.getIteratorFrom(e[0]);for(;s.hasNext();){const r=s.getNext();if(this.comparator(r.key,e[1])>=0)return;n(r.key)}}forEachWhile(e,n){let s;for(s=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();s.hasNext();)if(!e(s.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new _E(this.data.getIterator())}getIteratorFrom(e){return new _E(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(s=>{n=n.add(s)}),n}isEqual(e){if(!(e instanceof Ae)||this.size!==e.size)return!1;const n=this.data.getIterator(),s=e.data.getIterator();for(;n.hasNext();){const r=n.getNext().key,i=s.getNext().key;if(this.comparator(r,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new Ae(this.comparator);return n.data=e,n}}class _E{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function Fo(t){return t.hasNext()?t.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nn{constructor(e){this.fields=e,e.sort(ot.comparator)}static empty(){return new Nn([])}unionWith(e){let n=new Ae(ot.comparator);for(const s of this.fields)n=n.add(s);for(const s of e)n=n.add(s);return new Nn(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return Ta(this.fields,e.fields,(n,s)=>n.isEqual(s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function w2(){return typeof atob!="undefined"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mt{constructor(e){this.binaryString=e}static fromBase64String(e){const n=atob(e);return new mt(n)}static fromUint8Array(e){const n=function(s){let r="";for(let i=0;i<s.length;++i)r+=String.fromCharCode(s[i]);return r}(e);return new mt(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return e=this.binaryString,btoa(e);var e}toUint8Array(){return function(e){const n=new Uint8Array(e.length);for(let s=0;s<e.length;s++)n[s]=e.charCodeAt(s);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return ce(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}mt.EMPTY_BYTE_STRING=new mt("");const b2=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Xr(t){if(re(!!t),typeof t=="string"){let e=0;const n=b2.exec(t);if(re(!!n),n[1]){let r=n[1];r=(r+"000000000").substr(0,9),e=Number(r)}const s=new Date(t);return{seconds:Math.floor(s.getTime()/1e3),nanos:e}}return{seconds:et(t.seconds),nanos:et(t.nanos)}}function et(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function io(t){return typeof t=="string"?mt.fromBase64String(t):mt.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pv(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="server_timestamp"}function eN(t){const e=t.mapValue.fields.__previous_value__;return pv(e)?eN(e):e}function $l(t){const e=Xr(t.mapValue.fields.__local_write_time__.timestampValue);return new ze(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class I2{constructor(e,n,s,r,i,o,a,c){this.databaseId=e,this.appId=n,this.persistenceKey=s,this.host=r,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.useFetchStreams=c}}class ar{constructor(e,n){this.projectId=e,this.database=n||"(default)"}static empty(){return new ar("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof ar&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cu(t){return t==null}function Vl(t){return t===0&&1/t==-1/0}function tN(t){return typeof t=="number"&&Number.isInteger(t)&&!Vl(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xr={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},yh={nullValue:"NULL_VALUE"};function oo(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?pv(t)?4:nN(t)?9007199254740991:10:W()}function Fs(t,e){if(t===e)return!0;const n=oo(t);if(n!==oo(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return $l(t).isEqual($l(e));case 3:return function(s,r){if(typeof s.timestampValue=="string"&&typeof r.timestampValue=="string"&&s.timestampValue.length===r.timestampValue.length)return s.timestampValue===r.timestampValue;const i=Xr(s.timestampValue),o=Xr(r.timestampValue);return i.seconds===o.seconds&&i.nanos===o.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(s,r){return io(s.bytesValue).isEqual(io(r.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(s,r){return et(s.geoPointValue.latitude)===et(r.geoPointValue.latitude)&&et(s.geoPointValue.longitude)===et(r.geoPointValue.longitude)}(t,e);case 2:return function(s,r){if("integerValue"in s&&"integerValue"in r)return et(s.integerValue)===et(r.integerValue);if("doubleValue"in s&&"doubleValue"in r){const i=et(s.doubleValue),o=et(r.doubleValue);return i===o?Vl(i)===Vl(o):isNaN(i)&&isNaN(o)}return!1}(t,e);case 9:return Ta(t.arrayValue.values||[],e.arrayValue.values||[],Fs);case 10:return function(s,r){const i=s.mapValue.fields||{},o=r.mapValue.fields||{};if(mE(i)!==mE(o))return!1;for(const a in i)if(i.hasOwnProperty(a)&&(o[a]===void 0||!Fs(i[a],o[a])))return!1;return!0}(t,e);default:return W()}}function Bl(t,e){return(t.values||[]).find(n=>Fs(n,e))!==void 0}function Zr(t,e){if(t===e)return 0;const n=oo(t),s=oo(e);if(n!==s)return ce(n,s);switch(n){case 0:case 9007199254740991:return 0;case 1:return ce(t.booleanValue,e.booleanValue);case 2:return function(r,i){const o=et(r.integerValue||r.doubleValue),a=et(i.integerValue||i.doubleValue);return o<a?-1:o>a?1:o===a?0:isNaN(o)?isNaN(a)?0:-1:1}(t,e);case 3:return yE(t.timestampValue,e.timestampValue);case 4:return yE($l(t),$l(e));case 5:return ce(t.stringValue,e.stringValue);case 6:return function(r,i){const o=io(r),a=io(i);return o.compareTo(a)}(t.bytesValue,e.bytesValue);case 7:return function(r,i){const o=r.split("/"),a=i.split("/");for(let c=0;c<o.length&&c<a.length;c++){const l=ce(o[c],a[c]);if(l!==0)return l}return ce(o.length,a.length)}(t.referenceValue,e.referenceValue);case 8:return function(r,i){const o=ce(et(r.latitude),et(i.latitude));return o!==0?o:ce(et(r.longitude),et(i.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(r,i){const o=r.values||[],a=i.values||[];for(let c=0;c<o.length&&c<a.length;++c){const l=Zr(o[c],a[c]);if(l)return l}return ce(o.length,a.length)}(t.arrayValue,e.arrayValue);case 10:return function(r,i){if(r===xr.mapValue&&i===xr.mapValue)return 0;if(r===xr.mapValue)return 1;if(i===xr.mapValue)return-1;const o=r.fields||{},a=Object.keys(o),c=i.fields||{},l=Object.keys(c);a.sort(),l.sort();for(let u=0;u<a.length&&u<l.length;++u){const h=ce(a[u],l[u]);if(h!==0)return h;const d=Zr(o[a[u]],c[l[u]]);if(d!==0)return d}return ce(a.length,l.length)}(t.mapValue,e.mapValue);default:throw W()}}function yE(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return ce(t,e);const n=Xr(t),s=Xr(e),r=ce(n.seconds,s.seconds);return r!==0?r:ce(n.nanos,s.nanos)}function sa(t){return Om(t)}function Om(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(s){const r=Xr(s);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?io(t.bytesValue).toBase64():"referenceValue"in t?(n=t.referenceValue,F.fromName(n).toString()):"geoPointValue"in t?`geo(${(e=t.geoPointValue).latitude},${e.longitude})`:"arrayValue"in t?function(s){let r="[",i=!0;for(const o of s.values||[])i?i=!1:r+=",",r+=Om(o);return r+"]"}(t.arrayValue):"mapValue"in t?function(s){const r=Object.keys(s.fields||{}).sort();let i="{",o=!0;for(const a of r)o?o=!1:i+=",",i+=`${a}:${Om(s.fields[a])}`;return i+"}"}(t.mapValue):W();var e,n}function ao(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function Mm(t){return!!t&&"integerValue"in t}function ql(t){return!!t&&"arrayValue"in t}function vE(t){return!!t&&"nullValue"in t}function wE(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function vh(t){return!!t&&"mapValue"in t}function Gc(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return Ao(t.mapValue.fields,(n,s)=>e.mapValue.fields[n]=Gc(s)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=Gc(t.arrayValue.values[n]);return e}return Object.assign({},t)}function nN(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}function E2(t){return"nullValue"in t?yh:"booleanValue"in t?{booleanValue:!1}:"integerValue"in t||"doubleValue"in t?{doubleValue:NaN}:"timestampValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in t?{stringValue:""}:"bytesValue"in t?{bytesValue:""}:"referenceValue"in t?ao(ar.empty(),F.empty()):"geoPointValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in t?{arrayValue:{}}:"mapValue"in t?{mapValue:{}}:W()}function T2(t){return"nullValue"in t?{booleanValue:!1}:"booleanValue"in t?{doubleValue:NaN}:"integerValue"in t||"doubleValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in t?{stringValue:""}:"stringValue"in t?{bytesValue:""}:"bytesValue"in t?ao(ar.empty(),F.empty()):"referenceValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in t?{arrayValue:{}}:"arrayValue"in t?{mapValue:{}}:"mapValue"in t?xr:W()}function bE(t,e){const n=Zr(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?-1:!t.inclusive&&e.inclusive?1:0}function IE(t,e){const n=Zr(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?1:!t.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ut{constructor(e){this.value=e}static empty(){return new Ut({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let s=0;s<e.length-1;++s)if(n=(n.mapValue.fields||{})[e.get(s)],!vh(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=Gc(n)}setAll(e){let n=ot.emptyPath(),s={},r=[];e.forEach((o,a)=>{if(!n.isImmediateParentOf(a)){const c=this.getFieldsMap(n);this.applyChanges(c,s,r),s={},r=[],n=a.popLast()}o?s[a.lastSegment()]=Gc(o):r.push(a.lastSegment())});const i=this.getFieldsMap(n);this.applyChanges(i,s,r)}delete(e){const n=this.field(e.popLast());vh(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return Fs(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let s=0;s<e.length;++s){let r=n.mapValue.fields[e.get(s)];vh(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},n.mapValue.fields[e.get(s)]=r),n=r}return n.mapValue.fields}applyChanges(e,n,s){Ao(n,(r,i)=>e[r]=i);for(const r of s)delete e[r]}clone(){return new Ut(Gc(this.value))}}function sN(t){const e=[];return Ao(t.fields,(n,s)=>{const r=new ot([n]);if(vh(s)){const i=sN(s.mapValue).fields;if(i.length===0)e.push(r);else for(const o of i)e.push(r.child(o))}else e.push(r)}),new Nn(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Be{constructor(e,n,s,r,i,o){this.key=e,this.documentType=n,this.version=s,this.readTime=r,this.data=i,this.documentState=o}static newInvalidDocument(e){return new Be(e,0,se.min(),se.min(),Ut.empty(),0)}static newFoundDocument(e,n,s){return new Be(e,1,n,se.min(),s,0)}static newNoDocument(e,n){return new Be(e,2,n,se.min(),Ut.empty(),0)}static newUnknownDocument(e,n){return new Be(e,3,n,se.min(),Ut.empty(),2)}convertToFoundDocument(e,n){return this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Ut.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Ut.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=se.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Be&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Be(this.key,this.documentType,this.version,this.readTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S2{constructor(e,n=null,s=[],r=[],i=null,o=null,a=null){this.path=e,this.collectionGroup=n,this.orderBy=s,this.filters=r,this.limit=i,this.startAt=o,this.endAt=a,this.ut=null}}function EE(t,e=null,n=[],s=[],r=null,i=null,o=null){return new S2(t,e,n,s,r,i,o)}function co(t){const e=B(t);if(e.ut===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(s=>{return(r=s).field.canonicalString()+r.op.toString()+sa(r.value);var r}).join(","),n+="|ob:",n+=e.orderBy.map(s=>function(r){return r.field.canonicalString()+r.dir}(s)).join(","),Cu(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(s=>sa(s)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(s=>sa(s)).join(",")),e.ut=n}return e.ut}function C2(t){let e=t.path.canonicalString();return t.collectionGroup!==null&&(e+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(e+=`, filters: [${t.filters.map(n=>{return`${(s=n).field.canonicalString()} ${s.op} ${sa(s.value)}`;var s}).join(", ")}]`),Cu(t.limit)||(e+=", limit: "+t.limit),t.orderBy.length>0&&(e+=`, orderBy: [${t.orderBy.map(n=>function(s){return`${s.field.canonicalString()} (${s.dir})`}(n)).join(", ")}]`),t.startAt&&(e+=", startAt: ",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map(n=>sa(n)).join(",")),t.endAt&&(e+=", endAt: ",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map(n=>sa(n)).join(",")),`Target(${e})`}function Au(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let r=0;r<t.orderBy.length;r++)if(!O2(t.orderBy[r],e.orderBy[r]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let r=0;r<t.filters.length;r++)if(n=t.filters[r],s=e.filters[r],n.op!==s.op||!n.field.isEqual(s.field)||!Fs(n.value,s.value))return!1;var n,s;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!AE(t.startAt,e.startAt)&&AE(t.endAt,e.endAt)}function md(t){return F.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}function _d(t,e){return t.filters.filter(n=>n instanceof Vt&&n.field.isEqual(e))}function TE(t,e,n){let s=yh,r=!0;for(const i of _d(t,e)){let o=yh,a=!0;switch(i.op){case"<":case"<=":o=E2(i.value);break;case"==":case"in":case">=":o=i.value;break;case">":o=i.value,a=!1;break;case"!=":case"not-in":o=yh}bE({value:s,inclusive:r},{value:o,inclusive:a})<0&&(s=o,r=a)}if(n!==null){for(let i=0;i<t.orderBy.length;++i)if(t.orderBy[i].field.isEqual(e)){const o=n.position[i];bE({value:s,inclusive:r},{value:o,inclusive:n.inclusive})<0&&(s=o,r=n.inclusive);break}}return{value:s,inclusive:r}}function SE(t,e,n){let s=xr,r=!0;for(const i of _d(t,e)){let o=xr,a=!0;switch(i.op){case">=":case">":o=T2(i.value),a=!1;break;case"==":case"in":case"<=":o=i.value;break;case"<":o=i.value,a=!1;break;case"!=":case"not-in":o=xr}IE({value:s,inclusive:r},{value:o,inclusive:a})>0&&(s=o,r=a)}if(n!==null){for(let i=0;i<t.orderBy.length;++i)if(t.orderBy[i].field.isEqual(e)){const o=n.position[i];IE({value:s,inclusive:r},{value:o,inclusive:n.inclusive})>0&&(s=o,r=n.inclusive);break}}return{value:s,inclusive:r}}class Vt extends class{}{constructor(e,n,s){super(),this.field=e,this.op=n,this.value=s}static create(e,n,s){return e.isKeyField()?n==="in"||n==="not-in"?this.ct(e,n,s):new A2(e,n,s):n==="array-contains"?new N2(e,s):n==="in"?new P2(e,s):n==="not-in"?new D2(e,s):n==="array-contains-any"?new x2(e,s):new Vt(e,n,s)}static ct(e,n,s){return n==="in"?new k2(e,s):new R2(e,s)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&this.at(Zr(n,this.value)):n!==null&&oo(this.value)===oo(n)&&this.at(Zr(n,this.value))}at(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return W()}}ht(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}}class A2 extends Vt{constructor(e,n,s){super(e,n,s),this.key=F.fromName(s.referenceValue)}matches(e){const n=F.comparator(e.key,this.key);return this.at(n)}}class k2 extends Vt{constructor(e,n){super(e,"in",n),this.keys=rN("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class R2 extends Vt{constructor(e,n){super(e,"not-in",n),this.keys=rN("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function rN(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(s=>F.fromName(s.referenceValue))}class N2 extends Vt{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return ql(n)&&Bl(n.arrayValue,this.value)}}class P2 extends Vt{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&Bl(this.value.arrayValue,n)}}class D2 extends Vt{constructor(e,n){super(e,"not-in",n)}matches(e){if(Bl(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&!Bl(this.value.arrayValue,n)}}class x2 extends Vt{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!ql(n)||!n.arrayValue.values)&&n.arrayValue.values.some(s=>Bl(this.value.arrayValue,s))}}class ei{constructor(e,n){this.position=e,this.inclusive=n}}class ra{constructor(e,n="asc"){this.field=e,this.dir=n}}function O2(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}function CE(t,e,n){let s=0;for(let r=0;r<t.position.length;r++){const i=e[r],o=t.position[r];if(i.field.isKeyField()?s=F.comparator(F.fromName(o.referenceValue),n.key):s=Zr(o,n.data.field(i.field)),i.dir==="desc"&&(s*=-1),s!==0)break}return s}function AE(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!Fs(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dr{constructor(e,n=null,s=[],r=[],i=null,o="F",a=null,c=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=s,this.filters=r,this.limit=i,this.limitType=o,this.startAt=a,this.endAt=c,this.lt=null,this.ft=null,this.startAt,this.endAt}}function iN(t,e,n,s,r,i,o,a){return new dr(t,e,n,s,r,i,o,a)}function Ja(t){return new dr(t)}function M2(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function gv(t){return t.explicitOrderBy.length>0?t.explicitOrderBy[0].field:null}function mv(t){for(const e of t.filters)if(e.ht())return e.field;return null}function _v(t){return t.collectionGroup!==null}function Sa(t){const e=B(t);if(e.lt===null){e.lt=[];const n=mv(e),s=gv(e);if(n!==null&&s===null)n.isKeyField()||e.lt.push(new ra(n)),e.lt.push(new ra(ot.keyField(),"asc"));else{let r=!1;for(const i of e.explicitOrderBy)e.lt.push(i),i.field.isKeyField()&&(r=!0);if(!r){const i=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";e.lt.push(new ra(ot.keyField(),i))}}}return e.lt}function zn(t){const e=B(t);if(!e.ft)if(e.limitType==="F")e.ft=EE(e.path,e.collectionGroup,Sa(e),e.filters,e.limit,e.startAt,e.endAt);else{const n=[];for(const i of Sa(e)){const o=i.dir==="desc"?"asc":"desc";n.push(new ra(i.field,o))}const s=e.endAt?new ei(e.endAt.position,e.endAt.inclusive):null,r=e.startAt?new ei(e.startAt.position,e.startAt.inclusive):null;e.ft=EE(e.path,e.collectionGroup,n,e.filters,e.limit,s,r)}return e.ft}function oN(t,e,n){return new dr(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function ku(t,e){return Au(zn(t),zn(e))&&t.limitType===e.limitType}function aN(t){return`${co(zn(t))}|lt:${t.limitType}`}function Lm(t){return`Query(target=${C2(zn(t))}; limitType=${t.limitType})`}function yv(t,e){return e.isFoundDocument()&&function(n,s){const r=s.key.path;return n.collectionGroup!==null?s.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(r):F.isDocumentKey(n.path)?n.path.isEqual(r):n.path.isImmediateParentOf(r)}(t,e)&&function(n,s){for(const r of n.explicitOrderBy)if(!r.field.isKeyField()&&s.data.field(r.field)===null)return!1;return!0}(t,e)&&function(n,s){for(const r of n.filters)if(!r.matches(s))return!1;return!0}(t,e)&&function(n,s){return!(n.startAt&&!function(r,i,o){const a=CE(r,i,o);return r.inclusive?a<=0:a<0}(n.startAt,Sa(n),s)||n.endAt&&!function(r,i,o){const a=CE(r,i,o);return r.inclusive?a>=0:a>0}(n.endAt,Sa(n),s))}(t,e)}function cN(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function lN(t){return(e,n)=>{let s=!1;for(const r of Sa(t)){const i=L2(r,e,n);if(i!==0)return i;s=s||r.field.isKeyField()}return 0}}function L2(t,e,n){const s=t.field.isKeyField()?F.comparator(e.key,n.key):function(r,i,o){const a=i.data.field(r),c=o.data.field(r);return a!==null&&c!==null?Zr(a,c):W()}(t.field,e,n);switch(t.dir){case"asc":return s;case"desc":return-1*s;default:return W()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uN(t,e){if(t.dt){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Vl(e)?"-0":e}}function hN(t){return{integerValue:""+t}}function dN(t,e){return tN(e)?hN(e):uN(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hf{constructor(){this._=void 0}}function F2(t,e,n){return t instanceof Ca?function(s,r){const i={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return r&&(i.fields.__previous_value__=r),{mapValue:i}}(n,e):t instanceof lo?pN(t,e):t instanceof uo?gN(t,e):function(s,r){const i=fN(s,r),o=kE(i)+kE(s._t);return Mm(i)&&Mm(s._t)?hN(o):uN(s.wt,o)}(t,e)}function U2(t,e,n){return t instanceof lo?pN(t,e):t instanceof uo?gN(t,e):n}function fN(t,e){return t instanceof Aa?Mm(n=e)||function(s){return!!s&&"doubleValue"in s}(n)?e:{integerValue:0}:null;var n}class Ca extends Hf{}class lo extends Hf{constructor(e){super(),this.elements=e}}function pN(t,e){const n=mN(e);for(const s of t.elements)n.some(r=>Fs(r,s))||n.push(s);return{arrayValue:{values:n}}}class uo extends Hf{constructor(e){super(),this.elements=e}}function gN(t,e){let n=mN(e);for(const s of t.elements)n=n.filter(r=>!Fs(r,s));return{arrayValue:{values:n}}}class Aa extends Hf{constructor(e,n){super(),this.wt=e,this._t=n}}function kE(t){return et(t.integerValue||t.doubleValue)}function mN(t){return ql(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ru{constructor(e,n){this.field=e,this.transform=n}}function $2(t,e){return t.field.isEqual(e.field)&&function(n,s){return n instanceof lo&&s instanceof lo||n instanceof uo&&s instanceof uo?Ta(n.elements,s.elements,Fs):n instanceof Aa&&s instanceof Aa?Fs(n._t,s._t):n instanceof Ca&&s instanceof Ca}(t.transform,e.transform)}class V2{constructor(e,n){this.version=e,this.transformResults=n}}class Ye{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new Ye}static exists(e){return new Ye(void 0,e)}static updateTime(e){return new Ye(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function wh(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class Gf{}function _N(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new Za(t.key,Ye.none()):new Xa(t.key,t.data,Ye.none());{const n=t.data,s=Ut.empty();let r=new Ae(ot.comparator);for(let i of e.fields)if(!r.has(i)){let o=n.field(i);o===null&&i.length>1&&(i=i.popLast(),o=n.field(i)),o===null?s.delete(i):s.set(i,o),r=r.add(i)}return new fr(t.key,s,new Nn(r.toArray()),Ye.none())}}function B2(t,e,n){t instanceof Xa?function(s,r,i){const o=s.value.clone(),a=NE(s.fieldTransforms,r,i.transformResults);o.setAll(a),r.convertToFoundDocument(i.version,o).setHasCommittedMutations()}(t,e,n):t instanceof fr?function(s,r,i){if(!wh(s.precondition,r))return void r.convertToUnknownDocument(i.version);const o=NE(s.fieldTransforms,r,i.transformResults),a=r.data;a.setAll(yN(s)),a.setAll(o),r.convertToFoundDocument(i.version,a).setHasCommittedMutations()}(t,e,n):function(s,r,i){r.convertToNoDocument(i.version).setHasCommittedMutations()}(0,e,n)}function zc(t,e,n,s){return t instanceof Xa?function(r,i,o,a){if(!wh(r.precondition,i))return o;const c=r.value.clone(),l=PE(r.fieldTransforms,a,i);return c.setAll(l),i.convertToFoundDocument(i.version,c).setHasLocalMutations(),null}(t,e,n,s):t instanceof fr?function(r,i,o,a){if(!wh(r.precondition,i))return o;const c=PE(r.fieldTransforms,a,i),l=i.data;return l.setAll(yN(r)),l.setAll(c),i.convertToFoundDocument(i.version,l).setHasLocalMutations(),o===null?null:o.unionWith(r.fieldMask.fields).unionWith(r.fieldTransforms.map(u=>u.field))}(t,e,n,s):function(r,i,o){return wh(r.precondition,i)?(i.convertToNoDocument(i.version).setHasLocalMutations(),null):o}(t,e,n)}function q2(t,e){let n=null;for(const s of t.fieldTransforms){const r=e.data.field(s.field),i=fN(s.transform,r||null);i!=null&&(n===null&&(n=Ut.empty()),n.set(s.field,i))}return n||null}function RE(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(n,s){return n===void 0&&s===void 0||!(!n||!s)&&Ta(n,s,(r,i)=>$2(r,i))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class Xa extends Gf{constructor(e,n,s,r=[]){super(),this.key=e,this.value=n,this.precondition=s,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class fr extends Gf{constructor(e,n,s,r,i=[]){super(),this.key=e,this.data=n,this.fieldMask=s,this.precondition=r,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function yN(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const s=t.data.field(n);e.set(n,s)}}),e}function NE(t,e,n){const s=new Map;re(t.length===n.length);for(let r=0;r<n.length;r++){const i=t[r],o=i.transform,a=e.data.field(i.field);s.set(i.field,U2(o,a,n[r]))}return s}function PE(t,e,n){const s=new Map;for(const r of t){const i=r.transform,o=n.data.field(r.field);s.set(r.field,F2(i,o,e))}return s}class Za extends Gf{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class vv extends Gf{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j2{constructor(e){this.count=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ut,ye;function vN(t){switch(t){default:return W();case w.CANCELLED:case w.UNKNOWN:case w.DEADLINE_EXCEEDED:case w.RESOURCE_EXHAUSTED:case w.INTERNAL:case w.UNAVAILABLE:case w.UNAUTHENTICATED:return!1;case w.INVALID_ARGUMENT:case w.NOT_FOUND:case w.ALREADY_EXISTS:case w.PERMISSION_DENIED:case w.FAILED_PRECONDITION:case w.ABORTED:case w.OUT_OF_RANGE:case w.UNIMPLEMENTED:case w.DATA_LOSS:return!0}}function wN(t){if(t===void 0)return ht("GRPC error has no .code"),w.UNKNOWN;switch(t){case ut.OK:return w.OK;case ut.CANCELLED:return w.CANCELLED;case ut.UNKNOWN:return w.UNKNOWN;case ut.DEADLINE_EXCEEDED:return w.DEADLINE_EXCEEDED;case ut.RESOURCE_EXHAUSTED:return w.RESOURCE_EXHAUSTED;case ut.INTERNAL:return w.INTERNAL;case ut.UNAVAILABLE:return w.UNAVAILABLE;case ut.UNAUTHENTICATED:return w.UNAUTHENTICATED;case ut.INVALID_ARGUMENT:return w.INVALID_ARGUMENT;case ut.NOT_FOUND:return w.NOT_FOUND;case ut.ALREADY_EXISTS:return w.ALREADY_EXISTS;case ut.PERMISSION_DENIED:return w.PERMISSION_DENIED;case ut.FAILED_PRECONDITION:return w.FAILED_PRECONDITION;case ut.ABORTED:return w.ABORTED;case ut.OUT_OF_RANGE:return w.OUT_OF_RANGE;case ut.UNIMPLEMENTED:return w.UNIMPLEMENTED;case ut.DATA_LOSS:return w.DATA_LOSS;default:return W()}}(ye=ut||(ut={}))[ye.OK=0]="OK",ye[ye.CANCELLED=1]="CANCELLED",ye[ye.UNKNOWN=2]="UNKNOWN",ye[ye.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",ye[ye.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",ye[ye.NOT_FOUND=5]="NOT_FOUND",ye[ye.ALREADY_EXISTS=6]="ALREADY_EXISTS",ye[ye.PERMISSION_DENIED=7]="PERMISSION_DENIED",ye[ye.UNAUTHENTICATED=16]="UNAUTHENTICATED",ye[ye.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",ye[ye.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",ye[ye.ABORTED=10]="ABORTED",ye[ye.OUT_OF_RANGE=11]="OUT_OF_RANGE",ye[ye.UNIMPLEMENTED=12]="UNIMPLEMENTED",ye[ye.INTERNAL=13]="INTERNAL",ye[ye.UNAVAILABLE=14]="UNAVAILABLE",ye[ye.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ui{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),s=this.inner[n];if(s!==void 0){for(const[r,i]of s)if(this.equalsFn(r,e))return i}}has(e){return this.get(e)!==void 0}set(e,n){const s=this.mapKeyFn(e),r=this.inner[s];if(r===void 0)return this.inner[s]=[[e,n]],void this.innerSize++;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return void(r[i]=[e,n]);r.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),s=this.inner[n];if(s===void 0)return!1;for(let r=0;r<s.length;r++)if(this.equalsFn(s[r][0],e))return s.length===1?delete this.inner[n]:s.splice(r,1),this.innerSize--,!0;return!1}forEach(e){Ao(this.inner,(n,s)=>{for(const[r,i]of s)e(r,i)})}isEmpty(){return ZR(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const K2=new st(F.comparator);function vn(){return K2}const bN=new st(F.comparator);function kc(...t){let e=bN;for(const n of t)e=e.insert(n.key,n);return e}function IN(t){let e=bN;return t.forEach((n,s)=>e=e.insert(n,s.overlayedDocument)),e}function Ts(){return Qc()}function EN(){return Qc()}function Qc(){return new ui(t=>t.toString(),(t,e)=>t.isEqual(e))}const W2=new st(F.comparator),H2=new Ae(F.comparator);function ue(...t){let e=H2;for(const n of t)e=e.add(n);return e}const G2=new Ae(ce);function zf(){return G2}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nu{constructor(e,n,s,r,i){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=s,this.documentUpdates=r,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,n){const s=new Map;return s.set(e,Pu.createSynthesizedTargetChangeForCurrentChange(e,n)),new Nu(se.min(),s,zf(),vn(),ue())}}class Pu{constructor(e,n,s,r,i){this.resumeToken=e,this.current=n,this.addedDocuments=s,this.modifiedDocuments=r,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,n){return new Pu(mt.EMPTY_BYTE_STRING,n,ue(),ue(),ue())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bh{constructor(e,n,s,r){this.gt=e,this.removedTargetIds=n,this.key=s,this.yt=r}}class TN{constructor(e,n){this.targetId=e,this.It=n}}class SN{constructor(e,n,s=mt.EMPTY_BYTE_STRING,r=null){this.state=e,this.targetIds=n,this.resumeToken=s,this.cause=r}}class DE{constructor(){this.Tt=0,this.Et=OE(),this.At=mt.EMPTY_BYTE_STRING,this.Rt=!1,this.bt=!0}get current(){return this.Rt}get resumeToken(){return this.At}get Pt(){return this.Tt!==0}get vt(){return this.bt}Vt(e){e.approximateByteSize()>0&&(this.bt=!0,this.At=e)}St(){let e=ue(),n=ue(),s=ue();return this.Et.forEach((r,i)=>{switch(i){case 0:e=e.add(r);break;case 2:n=n.add(r);break;case 1:s=s.add(r);break;default:W()}}),new Pu(this.At,this.Rt,e,n,s)}Dt(){this.bt=!1,this.Et=OE()}Ct(e,n){this.bt=!0,this.Et=this.Et.insert(e,n)}xt(e){this.bt=!0,this.Et=this.Et.remove(e)}Nt(){this.Tt+=1}kt(){this.Tt-=1}Ot(){this.bt=!0,this.Rt=!0}}class z2{constructor(e){this.Mt=e,this.Ft=new Map,this.$t=vn(),this.Bt=xE(),this.Lt=new Ae(ce)}Ut(e){for(const n of e.gt)e.yt&&e.yt.isFoundDocument()?this.qt(n,e.yt):this.Kt(n,e.key,e.yt);for(const n of e.removedTargetIds)this.Kt(n,e.key,e.yt)}Gt(e){this.forEachTarget(e,n=>{const s=this.Qt(n);switch(e.state){case 0:this.jt(n)&&s.Vt(e.resumeToken);break;case 1:s.kt(),s.Pt||s.Dt(),s.Vt(e.resumeToken);break;case 2:s.kt(),s.Pt||this.removeTarget(n);break;case 3:this.jt(n)&&(s.Ot(),s.Vt(e.resumeToken));break;case 4:this.jt(n)&&(this.Wt(n),s.Vt(e.resumeToken));break;default:W()}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.Ft.forEach((s,r)=>{this.jt(r)&&n(r)})}zt(e){const n=e.targetId,s=e.It.count,r=this.Ht(n);if(r){const i=r.target;if(md(i))if(s===0){const o=new F(i.path);this.Kt(n,o,Be.newNoDocument(o,se.min()))}else re(s===1);else this.Jt(n)!==s&&(this.Wt(n),this.Lt=this.Lt.add(n))}}Yt(e){const n=new Map;this.Ft.forEach((i,o)=>{const a=this.Ht(o);if(a){if(i.current&&md(a.target)){const c=new F(a.target.path);this.$t.get(c)!==null||this.Xt(o,c)||this.Kt(o,c,Be.newNoDocument(c,e))}i.vt&&(n.set(o,i.St()),i.Dt())}});let s=ue();this.Bt.forEach((i,o)=>{let a=!0;o.forEachWhile(c=>{const l=this.Ht(c);return!l||l.purpose===2||(a=!1,!1)}),a&&(s=s.add(i))}),this.$t.forEach((i,o)=>o.setReadTime(e));const r=new Nu(e,n,this.Lt,this.$t,s);return this.$t=vn(),this.Bt=xE(),this.Lt=new Ae(ce),r}qt(e,n){if(!this.jt(e))return;const s=this.Xt(e,n.key)?2:0;this.Qt(e).Ct(n.key,s),this.$t=this.$t.insert(n.key,n),this.Bt=this.Bt.insert(n.key,this.Zt(n.key).add(e))}Kt(e,n,s){if(!this.jt(e))return;const r=this.Qt(e);this.Xt(e,n)?r.Ct(n,1):r.xt(n),this.Bt=this.Bt.insert(n,this.Zt(n).delete(e)),s&&(this.$t=this.$t.insert(n,s))}removeTarget(e){this.Ft.delete(e)}Jt(e){const n=this.Qt(e).St();return this.Mt.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}Nt(e){this.Qt(e).Nt()}Qt(e){let n=this.Ft.get(e);return n||(n=new DE,this.Ft.set(e,n)),n}Zt(e){let n=this.Bt.get(e);return n||(n=new Ae(ce),this.Bt=this.Bt.insert(e,n)),n}jt(e){const n=this.Ht(e)!==null;return n||R("WatchChangeAggregator","Detected inactive target",e),n}Ht(e){const n=this.Ft.get(e);return n&&n.Pt?null:this.Mt.te(e)}Wt(e){this.Ft.set(e,new DE),this.Mt.getRemoteKeysForTarget(e).forEach(n=>{this.Kt(e,n,null)})}Xt(e,n){return this.Mt.getRemoteKeysForTarget(e).has(n)}}function xE(){return new st(F.comparator)}function OE(){return new st(F.comparator)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Q2=(()=>({asc:"ASCENDING",desc:"DESCENDING"}))(),Y2=(()=>({"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"}))();class J2{constructor(e,n){this.databaseId=e,this.dt=n}}function jl(t,e){return t.dt?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function CN(t,e){return t.dt?e.toBase64():e.toUint8Array()}function X2(t,e){return jl(t,e.toTimestamp())}function Ct(t){return re(!!t),se.fromTimestamp(function(e){const n=Xr(e);return new ze(n.seconds,n.nanos)}(t))}function wv(t,e){return function(n){return new we(["projects",n.projectId,"databases",n.database])}(t).child("documents").child(e).canonicalString()}function AN(t){const e=we.fromString(t);return re(MN(e)),e}function Kl(t,e){return wv(t.databaseId,e.path)}function ks(t,e){const n=AN(e);if(n.get(1)!==t.databaseId.projectId)throw new S(w.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new S(w.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new F(RN(n))}function Fm(t,e){return wv(t.databaseId,e)}function kN(t){const e=AN(t);return e.length===4?we.emptyPath():RN(e)}function Wl(t){return new we(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function RN(t){return re(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function ME(t,e,n){return{name:Kl(t,e),fields:n.value.mapValue.fields}}function NN(t,e,n){const s=ks(t,e.name),r=Ct(e.updateTime),i=new Ut({mapValue:{fields:e.fields}}),o=Be.newFoundDocument(s,r,i);return n&&o.setHasCommittedMutations(),n?o.setHasCommittedMutations():o}function Z2(t,e){return"found"in e?function(n,s){re(!!s.found),s.found.name,s.found.updateTime;const r=ks(n,s.found.name),i=Ct(s.found.updateTime),o=new Ut({mapValue:{fields:s.found.fields}});return Be.newFoundDocument(r,i,o)}(t,e):"missing"in e?function(n,s){re(!!s.missing),re(!!s.readTime);const r=ks(n,s.missing),i=Ct(s.readTime);return Be.newNoDocument(r,i)}(t,e):W()}function e4(t,e){let n;if("targetChange"in e){e.targetChange;const s=function(c){return c==="NO_CHANGE"?0:c==="ADD"?1:c==="REMOVE"?2:c==="CURRENT"?3:c==="RESET"?4:W()}(e.targetChange.targetChangeType||"NO_CHANGE"),r=e.targetChange.targetIds||[],i=function(c,l){return c.dt?(re(l===void 0||typeof l=="string"),mt.fromBase64String(l||"")):(re(l===void 0||l instanceof Uint8Array),mt.fromUint8Array(l||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(c){const l=c.code===void 0?w.UNKNOWN:wN(c.code);return new S(l,c.message||"")}(o);n=new SN(s,r,i,a||null)}else if("documentChange"in e){e.documentChange;const s=e.documentChange;s.document,s.document.name,s.document.updateTime;const r=ks(t,s.document.name),i=Ct(s.document.updateTime),o=new Ut({mapValue:{fields:s.document.fields}}),a=Be.newFoundDocument(r,i,o),c=s.targetIds||[],l=s.removedTargetIds||[];n=new bh(c,l,a.key,a)}else if("documentDelete"in e){e.documentDelete;const s=e.documentDelete;s.document;const r=ks(t,s.document),i=s.readTime?Ct(s.readTime):se.min(),o=Be.newNoDocument(r,i),a=s.removedTargetIds||[];n=new bh([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const s=e.documentRemove;s.document;const r=ks(t,s.document),i=s.removedTargetIds||[];n=new bh([],i,r,null)}else{if(!("filter"in e))return W();{e.filter;const s=e.filter;s.targetId;const r=s.count||0,i=new j2(r),o=s.targetId;n=new TN(o,i)}}return n}function Hl(t,e){let n;if(e instanceof Xa)n={update:ME(t,e.key,e.value)};else if(e instanceof Za)n={delete:Kl(t,e.key)};else if(e instanceof fr)n={update:ME(t,e.key,e.data),updateMask:a4(e.fieldMask)};else{if(!(e instanceof vv))return W();n={verify:Kl(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(s=>function(r,i){const o=i.transform;if(o instanceof Ca)return{fieldPath:i.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(o instanceof lo)return{fieldPath:i.field.canonicalString(),appendMissingElements:{values:o.elements}};if(o instanceof uo)return{fieldPath:i.field.canonicalString(),removeAllFromArray:{values:o.elements}};if(o instanceof Aa)return{fieldPath:i.field.canonicalString(),increment:o._t};throw W()}(0,s))),e.precondition.isNone||(n.currentDocument=function(s,r){return r.updateTime!==void 0?{updateTime:X2(s,r.updateTime)}:r.exists!==void 0?{exists:r.exists}:W()}(t,e.precondition)),n}function Um(t,e){const n=e.currentDocument?function(r){return r.updateTime!==void 0?Ye.updateTime(Ct(r.updateTime)):r.exists!==void 0?Ye.exists(r.exists):Ye.none()}(e.currentDocument):Ye.none(),s=e.updateTransforms?e.updateTransforms.map(r=>function(i,o){let a=null;if("setToServerValue"in o)re(o.setToServerValue==="REQUEST_TIME"),a=new Ca;else if("appendMissingElements"in o){const l=o.appendMissingElements.values||[];a=new lo(l)}else if("removeAllFromArray"in o){const l=o.removeAllFromArray.values||[];a=new uo(l)}else"increment"in o?a=new Aa(i,o.increment):W();const c=ot.fromServerFormat(o.fieldPath);return new Ru(c,a)}(t,r)):[];if(e.update){e.update.name;const r=ks(t,e.update.name),i=new Ut({mapValue:{fields:e.update.fields}});if(e.updateMask){const o=function(a){const c=a.fieldPaths||[];return new Nn(c.map(l=>ot.fromServerFormat(l)))}(e.updateMask);return new fr(r,i,o,n,s)}return new Xa(r,i,n,s)}if(e.delete){const r=ks(t,e.delete);return new Za(r,n)}if(e.verify){const r=ks(t,e.verify);return new vv(r,n)}return W()}function t4(t,e){return t&&t.length>0?(re(e!==void 0),t.map(n=>function(s,r){let i=s.updateTime?Ct(s.updateTime):Ct(r);return i.isEqual(se.min())&&(i=Ct(r)),new V2(i,s.transformResults||[])}(n,e))):[]}function PN(t,e){return{documents:[Fm(t,e.path)]}}function DN(t,e){const n={structuredQuery:{}},s=e.path;e.collectionGroup!==null?(n.parent=Fm(t,s),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=Fm(t,s.popLast()),n.structuredQuery.from=[{collectionId:s.lastSegment()}]);const r=function(c){if(c.length===0)return;const l=c.map(u=>function(h){if(h.op==="=="){if(wE(h.value))return{unaryFilter:{field:Uo(h.field),op:"IS_NAN"}};if(vE(h.value))return{unaryFilter:{field:Uo(h.field),op:"IS_NULL"}}}else if(h.op==="!="){if(wE(h.value))return{unaryFilter:{field:Uo(h.field),op:"IS_NOT_NAN"}};if(vE(h.value))return{unaryFilter:{field:Uo(h.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Uo(h.field),op:r4(h.op),value:h.value}}}(u));return l.length===1?l[0]:{compositeFilter:{op:"AND",filters:l}}}(e.filters);r&&(n.structuredQuery.where=r);const i=function(c){if(c.length!==0)return c.map(l=>function(u){return{field:Uo(u.field),direction:s4(u.dir)}}(l))}(e.orderBy);i&&(n.structuredQuery.orderBy=i);const o=function(c,l){return c.dt||Cu(l)?l:{value:l}}(t,e.limit);var a;return o!==null&&(n.structuredQuery.limit=o),e.startAt&&(n.structuredQuery.startAt={before:(a=e.startAt).inclusive,values:a.position}),e.endAt&&(n.structuredQuery.endAt=function(c){return{before:!c.inclusive,values:c.position}}(e.endAt)),n}function xN(t){let e=kN(t.parent);const n=t.structuredQuery,s=n.from?n.from.length:0;let r=null;if(s>0){re(s===1);const u=n.from[0];u.allDescendants?r=u.collectionId:e=e.child(u.collectionId)}let i=[];n.where&&(i=ON(n.where));let o=[];n.orderBy&&(o=n.orderBy.map(u=>function(h){return new ra(zo(h.field),function(d){switch(d){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(h.direction))}(u)));let a=null;n.limit&&(a=function(u){let h;return h=typeof u=="object"?u.value:u,Cu(h)?null:h}(n.limit));let c=null;n.startAt&&(c=function(u){const h=!!u.before,d=u.values||[];return new ei(d,h)}(n.startAt));let l=null;return n.endAt&&(l=function(u){const h=!u.before,d=u.values||[];return new ei(d,h)}(n.endAt)),iN(e,r,o,i,a,"F",c,l)}function n4(t,e){const n=function(s,r){switch(r){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return W()}}(0,e.purpose);return n==null?null:{"goog-listen-tags":n}}function ON(t){return t?t.unaryFilter!==void 0?[o4(t)]:t.fieldFilter!==void 0?[i4(t)]:t.compositeFilter!==void 0?t.compositeFilter.filters.map(e=>ON(e)).reduce((e,n)=>e.concat(n)):W():[]}function s4(t){return Q2[t]}function r4(t){return Y2[t]}function Uo(t){return{fieldPath:t.canonicalString()}}function zo(t){return ot.fromServerFormat(t.fieldPath)}function i4(t){return Vt.create(zo(t.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return W()}}(t.fieldFilter.op),t.fieldFilter.value)}function o4(t){switch(t.unaryFilter.op){case"IS_NAN":const e=zo(t.unaryFilter.field);return Vt.create(e,"==",{doubleValue:NaN});case"IS_NULL":const n=zo(t.unaryFilter.field);return Vt.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=zo(t.unaryFilter.field);return Vt.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const r=zo(t.unaryFilter.field);return Vt.create(r,"!=",{nullValue:"NULL_VALUE"});default:return W()}}function a4(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function MN(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function un(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=LE(e)),e=c4(t.get(n),e);return LE(e)}function c4(t,e){let n=e;const s=t.length;for(let r=0;r<s;r++){const i=t.charAt(r);switch(i){case"\0":n+="";break;case"":n+="";break;default:n+=i}}return n}function LE(t){return t+""}function Ss(t){const e=t.length;if(re(e>=2),e===2)return re(t.charAt(0)===""&&t.charAt(1)===""),we.emptyPath();const n=e-2,s=[];let r="";for(let i=0;i<e;){const o=t.indexOf("",i);switch((o<0||o>n)&&W(),t.charAt(o+1)){case"":const a=t.substring(i,o);let c;r.length===0?c=a:(r+=a,c=r,r=""),s.push(c);break;case"":r+=t.substring(i,o),r+="\0";break;case"":r+=t.substring(i,o+1);break;default:W()}i=o+2}return new we(s)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FE=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ih(t,e){return[t,un(e)]}function LN(t,e,n){return[t,un(e),n]}const l4={},u4=["prefixPath","collectionGroup","readTime","documentId"],h4=["prefixPath","collectionGroup","documentId"],d4=["collectionGroup","readTime","prefixPath","documentId"],f4=["canonicalId","targetId"],p4=["targetId","path"],g4=["path","targetId"],m4=["collectionId","parent"],_4=["indexId","uid"],y4=["uid","sequenceNumber"],v4=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],w4=["indexId","uid","orderedDocumentKey"],b4=["userId","collectionPath","documentId"],I4=["userId","collectionPath","largestBatchId"],E4=["userId","collectionGroup","largestBatchId"],FN=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],T4=[...FN,"documentOverlays"],UN=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],$N=UN,S4=[...$N,"indexConfiguration","indexState","indexEntries"];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $m extends XR{constructor(e,n){super(),this.ee=e,this.currentSequenceNumber=n}}function Ot(t,e){const n=B(t);return rs.N(n.ee,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bv{constructor(e,n,s,r){this.batchId=e,this.localWriteTime=n,this.baseMutations=s,this.mutations=r}applyToRemoteDocument(e,n){const s=n.mutationResults;for(let r=0;r<this.mutations.length;r++){const i=this.mutations[r];i.key.isEqual(e.key)&&B2(i,e,s[r])}}applyToLocalView(e,n){for(const s of this.baseMutations)s.key.isEqual(e.key)&&(n=zc(s,e,n,this.localWriteTime));for(const s of this.mutations)s.key.isEqual(e.key)&&(n=zc(s,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const s=EN();return this.mutations.forEach(r=>{const i=e.get(r.key),o=i.overlayedDocument;let a=this.applyToLocalView(o,i.mutatedFields);a=n.has(r.key)?null:a;const c=_N(o,a);c!==null&&s.set(r.key,c),o.isValidDocument()||o.convertToNoDocument(se.min())}),s}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),ue())}isEqual(e){return this.batchId===e.batchId&&Ta(this.mutations,e.mutations,(n,s)=>RE(n,s))&&Ta(this.baseMutations,e.baseMutations,(n,s)=>RE(n,s))}}class Iv{constructor(e,n,s,r){this.batch=e,this.commitVersion=n,this.mutationResults=s,this.docVersions=r}static from(e,n,s){re(e.mutations.length===s.length);let r=W2;const i=e.mutations;for(let o=0;o<i.length;o++)r=r.insert(i[o].key,s[o].version);return new Iv(e,n,s,r)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ev{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vr{constructor(e,n,s,r,i=se.min(),o=se.min(),a=mt.EMPTY_BYTE_STRING){this.target=e,this.targetId=n,this.purpose=s,this.sequenceNumber=r,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a}withSequenceNumber(e){return new Vr(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)}withResumeToken(e,n){return new Vr(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e)}withLastLimboFreeSnapshotVersion(e){return new Vr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VN{constructor(e){this.ne=e}}function C4(t,e){let n;if(e.document)n=NN(t.ne,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const s=F.fromSegments(e.noDocument.path),r=fo(e.noDocument.readTime);n=Be.newNoDocument(s,r),e.hasCommittedMutations&&n.setHasCommittedMutations()}else{if(!e.unknownDocument)return W();{const s=F.fromSegments(e.unknownDocument.path),r=fo(e.unknownDocument.version);n=Be.newUnknownDocument(s,r)}}return e.readTime&&n.setReadTime(function(s){const r=new ze(s[0],s[1]);return se.fromTimestamp(r)}(e.readTime)),n}function UE(t,e){const n=e.key,s={prefixPath:n.getCollectionPath().popLast().toArray(),collectionGroup:n.collectionGroup,documentId:n.path.lastSegment(),readTime:yd(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())s.document=function(r,i){return{name:Kl(r,i.key),fields:i.data.value.mapValue.fields,updateTime:jl(r,i.version.toTimestamp())}}(t.ne,e);else if(e.isNoDocument())s.noDocument={path:n.path.toArray(),readTime:ho(e.version)};else{if(!e.isUnknownDocument())return W();s.unknownDocument={path:n.path.toArray(),version:ho(e.version)}}return s}function yd(t){const e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function ho(t){const e=t.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function fo(t){const e=new ze(t.seconds,t.nanoseconds);return se.fromTimestamp(e)}function Ai(t,e){const n=(e.baseMutations||[]).map(i=>Um(t.ne,i));for(let i=0;i<e.mutations.length-1;++i){const o=e.mutations[i];if(i+1<e.mutations.length&&e.mutations[i+1].transform!==void 0){const a=e.mutations[i+1];o.updateTransforms=a.transform.fieldTransforms,e.mutations.splice(i+1,1),++i}}const s=e.mutations.map(i=>Um(t.ne,i)),r=ze.fromMillis(e.localWriteTimeMs);return new bv(e.batchId,r,n,s)}function Rc(t){const e=fo(t.readTime),n=t.lastLimboFreeSnapshotVersion!==void 0?fo(t.lastLimboFreeSnapshotVersion):se.min();let s;var r;return t.query.documents!==void 0?(re((r=t.query).documents.length===1),s=zn(Ja(kN(r.documents[0])))):s=function(i){return zn(xN(i))}(t.query),new Vr(s,t.targetId,0,t.lastListenSequenceNumber,e,n,mt.fromBase64String(t.resumeToken))}function BN(t,e){const n=ho(e.snapshotVersion),s=ho(e.lastLimboFreeSnapshotVersion);let r;r=md(e.target)?PN(t.ne,e.target):DN(t.ne,e.target);const i=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:co(e.target),readTime:n,resumeToken:i,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:s,query:r}}function Tv(t){const e=xN({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?oN(e,e.limit,"L"):e}function Xp(t,e){return new Ev(e.largestBatchId,Um(t.ne,e.overlayMutation))}function $E(t,e){const n=e.path.lastSegment();return[t,un(e.path.popLast()),n]}function VE(t,e,n,s){return{indexId:t,uid:e.uid||"",sequenceNumber:n,readTime:ho(s.readTime),documentKey:un(s.documentKey.path),largestBatchId:s.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A4{getBundleMetadata(e,n){return BE(e).get(n).next(s=>{if(s)return{id:(r=s).bundleId,createTime:fo(r.createTime),version:r.version};var r})}saveBundleMetadata(e,n){return BE(e).put({bundleId:(s=n).id,createTime:ho(Ct(s.createTime)),version:s.version});var s}getNamedQuery(e,n){return qE(e).get(n).next(s=>{if(s)return{name:(r=s).name,query:Tv(r.bundledQuery),readTime:fo(r.readTime)};var r})}saveNamedQuery(e,n){return qE(e).put(function(s){return{name:s.name,readTime:ho(Ct(s.readTime)),bundledQuery:s.bundledQuery}}(n))}}function BE(t){return Ot(t,"bundles")}function qE(t){return Ot(t,"namedQueries")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qf{constructor(e,n){this.wt=e,this.userId=n}static se(e,n){const s=n.uid||"";return new Qf(e,s)}getOverlay(e,n){return mc(e).get($E(this.userId,n)).next(s=>s?Xp(this.wt,s):null)}getOverlays(e,n){const s=Ts();return v.forEach(n,r=>this.getOverlay(e,r).next(i=>{i!==null&&s.set(r,i)})).next(()=>s)}saveOverlays(e,n,s){const r=[];return s.forEach((i,o)=>{const a=new Ev(n,o);r.push(this.ie(e,a))}),v.waitFor(r)}removeOverlaysForBatchId(e,n,s){const r=new Set;n.forEach(o=>r.add(un(o.getCollectionPath())));const i=[];return r.forEach(o=>{const a=IDBKeyRange.bound([this.userId,o,s],[this.userId,o,s+1],!1,!0);i.push(mc(e).W("collectionPathOverlayIndex",a))}),v.waitFor(i)}getOverlaysForCollection(e,n,s){const r=Ts(),i=un(n),o=IDBKeyRange.bound([this.userId,i,s],[this.userId,i,Number.POSITIVE_INFINITY],!0);return mc(e).K("collectionPathOverlayIndex",o).next(a=>{for(const c of a){const l=Xp(this.wt,c);r.set(l.getKey(),l)}return r})}getOverlaysForCollectionGroup(e,n,s,r){const i=Ts();let o;const a=IDBKeyRange.bound([this.userId,n,s],[this.userId,n,Number.POSITIVE_INFINITY],!0);return mc(e).J({index:"collectionGroupOverlayIndex",range:a},(c,l,u)=>{const h=Xp(this.wt,l);i.size()<r||h.largestBatchId===o?(i.set(h.getKey(),h),o=h.largestBatchId):u.done()}).next(()=>i)}ie(e,n){return mc(e).put(function(s,r,i){const[o,a,c]=$E(r,i.mutation.key);return{userId:r,collectionPath:a,documentId:c,collectionGroup:i.mutation.key.getCollectionGroup(),largestBatchId:i.largestBatchId,overlayMutation:Hl(s.ne,i.mutation)}}(this.wt,this.userId,n))}}function mc(t){return Ot(t,"documentOverlays")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ki{constructor(){}re(e,n){this.oe(e,n),n.ue()}oe(e,n){if("nullValue"in e)this.ce(n,5);else if("booleanValue"in e)this.ce(n,10),n.ae(e.booleanValue?1:0);else if("integerValue"in e)this.ce(n,15),n.ae(et(e.integerValue));else if("doubleValue"in e){const s=et(e.doubleValue);isNaN(s)?this.ce(n,13):(this.ce(n,15),Vl(s)?n.ae(0):n.ae(s))}else if("timestampValue"in e){const s=e.timestampValue;this.ce(n,20),typeof s=="string"?n.he(s):(n.he(`${s.seconds||""}`),n.ae(s.nanos||0))}else if("stringValue"in e)this.le(e.stringValue,n),this.fe(n);else if("bytesValue"in e)this.ce(n,30),n.de(io(e.bytesValue)),this.fe(n);else if("referenceValue"in e)this._e(e.referenceValue,n);else if("geoPointValue"in e){const s=e.geoPointValue;this.ce(n,45),n.ae(s.latitude||0),n.ae(s.longitude||0)}else"mapValue"in e?nN(e)?this.ce(n,Number.MAX_SAFE_INTEGER):(this.we(e.mapValue,n),this.fe(n)):"arrayValue"in e?(this.me(e.arrayValue,n),this.fe(n)):W()}le(e,n){this.ce(n,25),this.ge(e,n)}ge(e,n){n.he(e)}we(e,n){const s=e.fields||{};this.ce(n,55);for(const r of Object.keys(s))this.le(r,n),this.oe(s[r],n)}me(e,n){const s=e.values||[];this.ce(n,50);for(const r of s)this.oe(r,n)}_e(e,n){this.ce(n,37),F.fromName(e).path.forEach(s=>{this.ce(n,60),this.ge(s,n)})}ce(e,n){e.ae(n)}fe(e){e.ae(2)}}ki.ye=new ki;function k4(t){if(t===0)return 8;let e=0;return t>>4==0&&(e+=4,t<<=4),t>>6==0&&(e+=2,t<<=2),t>>7==0&&(e+=1),e}function jE(t){const e=64-function(n){let s=0;for(let r=0;r<8;++r){const i=k4(255&n[r]);if(s+=i,i!==8)break}return s}(t);return Math.ceil(e/8)}class R4{constructor(){this.buffer=new Uint8Array(1024),this.position=0}pe(e){const n=e[Symbol.iterator]();let s=n.next();for(;!s.done;)this.Ie(s.value),s=n.next();this.Te()}Ee(e){const n=e[Symbol.iterator]();let s=n.next();for(;!s.done;)this.Ae(s.value),s=n.next();this.Re()}be(e){for(const n of e){const s=n.charCodeAt(0);if(s<128)this.Ie(s);else if(s<2048)this.Ie(960|s>>>6),this.Ie(128|63&s);else if(n<"\uD800"||"\uDBFF"<n)this.Ie(480|s>>>12),this.Ie(128|63&s>>>6),this.Ie(128|63&s);else{const r=n.codePointAt(0);this.Ie(240|r>>>18),this.Ie(128|63&r>>>12),this.Ie(128|63&r>>>6),this.Ie(128|63&r)}}this.Te()}Pe(e){for(const n of e){const s=n.charCodeAt(0);if(s<128)this.Ae(s);else if(s<2048)this.Ae(960|s>>>6),this.Ae(128|63&s);else if(n<"\uD800"||"\uDBFF"<n)this.Ae(480|s>>>12),this.Ae(128|63&s>>>6),this.Ae(128|63&s);else{const r=n.codePointAt(0);this.Ae(240|r>>>18),this.Ae(128|63&r>>>12),this.Ae(128|63&r>>>6),this.Ae(128|63&r)}}this.Re()}ve(e){const n=this.Ve(e),s=jE(n);this.Se(1+s),this.buffer[this.position++]=255&s;for(let r=n.length-s;r<n.length;++r)this.buffer[this.position++]=255&n[r]}De(e){const n=this.Ve(e),s=jE(n);this.Se(1+s),this.buffer[this.position++]=~(255&s);for(let r=n.length-s;r<n.length;++r)this.buffer[this.position++]=~(255&n[r])}Ce(){this.xe(255),this.xe(255)}Ne(){this.ke(255),this.ke(255)}reset(){this.position=0}seed(e){this.Se(e.length),this.buffer.set(e,this.position),this.position+=e.length}Oe(){return this.buffer.slice(0,this.position)}Ve(e){const n=function(r){const i=new DataView(new ArrayBuffer(8));return i.setFloat64(0,r,!1),new Uint8Array(i.buffer)}(e),s=(128&n[0])!=0;n[0]^=s?255:128;for(let r=1;r<n.length;++r)n[r]^=s?255:0;return n}Ie(e){const n=255&e;n===0?(this.xe(0),this.xe(255)):n===255?(this.xe(255),this.xe(0)):this.xe(n)}Ae(e){const n=255&e;n===0?(this.ke(0),this.ke(255)):n===255?(this.ke(255),this.ke(0)):this.ke(e)}Te(){this.xe(0),this.xe(1)}Re(){this.ke(0),this.ke(1)}xe(e){this.Se(1),this.buffer[this.position++]=e}ke(e){this.Se(1),this.buffer[this.position++]=~e}Se(e){const n=e+this.position;if(n<=this.buffer.length)return;let s=2*this.buffer.length;s<n&&(s=n);const r=new Uint8Array(s);r.set(this.buffer),this.buffer=r}}class N4{constructor(e){this.Me=e}de(e){this.Me.pe(e)}he(e){this.Me.be(e)}ae(e){this.Me.ve(e)}ue(){this.Me.Ce()}}class P4{constructor(e){this.Me=e}de(e){this.Me.Ee(e)}he(e){this.Me.Pe(e)}ae(e){this.Me.De(e)}ue(){this.Me.Ne()}}class _c{constructor(){this.Me=new R4,this.Fe=new N4(this.Me),this.$e=new P4(this.Me)}seed(e){this.Me.seed(e)}Be(e){return e===0?this.Fe:this.$e}Oe(){return this.Me.Oe()}reset(){this.Me.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ri{constructor(e,n,s,r){this.indexId=e,this.documentKey=n,this.arrayValue=s,this.directionalValue=r}Le(){const e=this.directionalValue.length,n=e===0||this.directionalValue[e-1]===255?e+1:e,s=new Uint8Array(n);return s.set(this.directionalValue,0),n!==e?s.set([0],this.directionalValue.length):++s[s.length-1],new Ri(this.indexId,this.documentKey,this.arrayValue,s)}}function _i(t,e){let n=t.indexId-e.indexId;return n!==0?n:(n=KE(t.arrayValue,e.arrayValue),n!==0?n:(n=KE(t.directionalValue,e.directionalValue),n!==0?n:F.comparator(t.documentKey,e.documentKey)))}function KE(t,e){for(let n=0;n<t.length&&n<e.length;++n){const s=t[n]-e[n];if(s!==0)return s}return t.length-e.length}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class D4{constructor(e){this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.Ue=e.orderBy,this.qe=[];for(const n of e.filters){const s=n;s.ht()?this.Ke=s:this.qe.push(s)}}Ge(e){const n=xm(e);if(n!==void 0&&!this.Qe(n))return!1;const s=Ii(e);let r=0,i=0;for(;r<s.length&&this.Qe(s[r]);++r);if(r===s.length)return!0;if(this.Ke!==void 0){const o=s[r];if(!this.je(this.Ke,o)||!this.We(this.Ue[i++],o))return!1;++r}for(;r<s.length;++r){const o=s[r];if(i>=this.Ue.length||!this.We(this.Ue[i++],o))return!1}return!0}Qe(e){for(const n of this.qe)if(this.je(n,e))return!0;return!1}je(e,n){if(e===void 0||!e.field.isEqual(n.fieldPath))return!1;const s=e.op==="array-contains"||e.op==="array-contains-any";return n.kind===2===s}We(e,n){return!!e.field.isEqual(n.fieldPath)&&(n.kind===0&&e.dir==="asc"||n.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x4{constructor(){this.ze=new Sv}addToCollectionParentIndex(e,n){return this.ze.add(n),v.resolve()}getCollectionParents(e,n){return v.resolve(this.ze.getEntries(n))}addFieldIndex(e,n){return v.resolve()}deleteFieldIndex(e,n){return v.resolve()}getDocumentsMatchingTarget(e,n){return v.resolve(null)}getIndexType(e,n){return v.resolve(0)}getFieldIndexes(e,n){return v.resolve([])}getNextCollectionGroupToUpdate(e){return v.resolve(null)}getMinOffset(e,n){return v.resolve(On.min())}getMinOffsetFromCollectionGroup(e,n){return v.resolve(On.min())}updateCollectionGroup(e,n,s){return v.resolve()}updateIndexEntries(e,n){return v.resolve()}}class Sv{constructor(){this.index={}}add(e){const n=e.lastSegment(),s=e.popLast(),r=this.index[n]||new Ae(we.comparator),i=!r.has(s);return this.index[n]=r.add(s),i}has(e){const n=e.lastSegment(),s=e.popLast(),r=this.index[n];return r&&r.has(s)}getEntries(e){return(this.index[e]||new Ae(we.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eh=new Uint8Array(0);class O4{constructor(e,n){this.user=e,this.databaseId=n,this.He=new Sv,this.Je=new ui(s=>co(s),(s,r)=>Au(s,r)),this.uid=e.uid||""}addToCollectionParentIndex(e,n){if(!this.He.has(n)){const s=n.lastSegment(),r=n.popLast();e.addOnCommittedListener(()=>{this.He.add(n)});const i={collectionId:s,parent:un(r)};return WE(e).put(i)}return v.resolve()}getCollectionParents(e,n){const s=[],r=IDBKeyRange.bound([n,""],[GR(n),""],!1,!0);return WE(e).K(r).next(i=>{for(const o of i){if(o.collectionId!==n)break;s.push(Ss(o.parent))}return s})}addFieldIndex(e,n){const s=th(e),r=function(o){return{indexId:o.indexId,collectionGroup:o.collectionGroup,fields:o.fields.map(a=>[a.fieldPath.canonicalString(),a.kind])}}(n);delete r.indexId;const i=s.add(r);if(n.indexState){const o=vc(e);return i.next(a=>{o.put(VE(a,this.user,n.indexState.sequenceNumber,n.indexState.offset))})}return i.next()}deleteFieldIndex(e,n){const s=th(e),r=vc(e),i=yc(e);return s.delete(n.indexId).next(()=>r.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0))).next(()=>i.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0)))}getDocumentsMatchingTarget(e,n){const s=yc(e);let r=!0;const i=new Map;return v.forEach(this.Ye(n),o=>this.Xe(e,o).next(a=>{r&&(r=!!a),i.set(o,a)})).next(()=>{if(r){let o=ue();const a=[];return v.forEach(i,(c,l)=>{var u;R("IndexedDbIndexManager",`Using index ${u=c,`id=${u.indexId}|cg=${u.collectionGroup}|f=${u.fields.map(k=>`${k.fieldPath}:${k.kind}`).join(",")}`} to execute ${co(n)}`);const h=function(k,M){const j=xm(M);if(j===void 0)return null;for(const Y of _d(k,j.fieldPath))switch(Y.op){case"array-contains-any":return Y.value.arrayValue.values||[];case"array-contains":return[Y.value]}return null}(l,c),d=function(k,M){const j=new Map;for(const Y of Ii(M))for(const z of _d(k,Y.fieldPath))switch(z.op){case"==":case"in":j.set(Y.fieldPath.canonicalString(),z.value);break;case"not-in":case"!=":return j.set(Y.fieldPath.canonicalString(),z.value),Array.from(j.values())}return null}(l,c),f=function(k,M){const j=[];let Y=!0;for(const z of Ii(M)){const V=z.kind===0?TE(k,z.fieldPath,k.startAt):SE(k,z.fieldPath,k.startAt);j.push(V.value),Y&&(Y=V.inclusive)}return new ei(j,Y)}(l,c),p=function(k,M){const j=[];let Y=!0;for(const z of Ii(M)){const V=z.kind===0?SE(k,z.fieldPath,k.endAt):TE(k,z.fieldPath,k.endAt);j.push(V.value),Y&&(Y=V.inclusive)}return new ei(j,Y)}(l,c),_=this.Ze(c,l,f),y=this.Ze(c,l,p),I=this.tn(c,l,d),N=this.en(c.indexId,h,_,f.inclusive,y,p.inclusive,I);return v.forEach(N,k=>s.j(k,n.limit).next(M=>{M.forEach(j=>{const Y=F.fromSegments(j.documentKey);o.has(Y)||(o=o.add(Y),a.push(Y))})}))}).next(()=>a)}return v.resolve(null)})}Ye(e){let n=this.Je.get(e);return n||(n=[e],this.Je.set(e,n),n)}en(e,n,s,r,i,o,a){const c=(n!=null?n.length:1)*Math.max(s.length,i.length),l=c/(n!=null?n.length:1),u=[];for(let h=0;h<c;++h){const d=n?this.nn(n[h/l]):eh,f=this.sn(e,d,s[h%l],r),p=this.rn(e,d,i[h%l],o),_=a.map(y=>this.sn(e,d,y,!0));u.push(...this.createRange(f,p,_))}return u}sn(e,n,s,r){const i=new Ri(e,F.empty(),n,s);return r?i:i.Le()}rn(e,n,s,r){const i=new Ri(e,F.empty(),n,s);return r?i.Le():i}Xe(e,n){const s=new D4(n),r=n.collectionGroup!=null?n.collectionGroup:n.path.lastSegment();return this.getFieldIndexes(e,r).next(i=>{let o=null;for(const a of i)s.Ge(a)&&(!o||a.fields.length>o.fields.length)&&(o=a);return o})}getIndexType(e,n){let s=2;return v.forEach(this.Ye(n),r=>this.Xe(e,r).next(i=>{i?s!==0&&i.fields.length<function(o){let a=new Ae(ot.comparator),c=!1;for(const l of o.filters){const u=l;u.field.isKeyField()||(u.op==="array-contains"||u.op==="array-contains-any"?c=!0:a=a.add(u.field))}for(const l of o.orderBy)l.field.isKeyField()||(a=a.add(l.field));return a.size+(c?1:0)}(r)&&(s=1):s=0})).next(()=>s)}on(e,n){const s=new _c;for(const r of Ii(e)){const i=n.data.field(r.fieldPath);if(i==null)return null;const o=s.Be(r.kind);ki.ye.re(i,o)}return s.Oe()}nn(e){const n=new _c;return ki.ye.re(e,n.Be(0)),n.Oe()}un(e,n){const s=new _c;return ki.ye.re(ao(this.databaseId,n),s.Be(function(r){const i=Ii(r);return i.length===0?0:i[i.length-1].kind}(e))),s.Oe()}tn(e,n,s){if(s===null)return[];let r=[];r.push(new _c);let i=0;for(const o of Ii(e)){const a=s[i++];for(const c of r)if(this.cn(n,o.fieldPath)&&ql(a))r=this.an(r,o,a);else{const l=c.Be(o.kind);ki.ye.re(a,l)}}return this.hn(r)}Ze(e,n,s){return this.tn(e,n,s.position)}hn(e){const n=[];for(let s=0;s<e.length;++s)n[s]=e[s].Oe();return n}an(e,n,s){const r=[...e],i=[];for(const o of s.arrayValue.values||[])for(const a of r){const c=new _c;c.seed(a.Oe()),ki.ye.re(o,c.Be(n.kind)),i.push(c)}return i}cn(e,n){return!!e.filters.find(s=>s instanceof Vt&&s.field.isEqual(n)&&(s.op==="in"||s.op==="not-in"))}getFieldIndexes(e,n){const s=th(e),r=vc(e);return(n?s.K("collectionGroupIndex",IDBKeyRange.bound(n,n)):s.K()).next(i=>{const o=[];return v.forEach(i,a=>r.get([a.indexId,this.uid]).next(c=>{o.push(function(l,u){const h=u?new gd(u.sequenceNumber,new On(fo(u.readTime),new F(Ss(u.documentKey)),u.largestBatchId)):gd.empty(),d=l.fields.map(([f,p])=>new g2(ot.fromServerFormat(f),p));return new zR(l.indexId,l.collectionGroup,d,h)}(a,c))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(n=>n.length===0?null:(n.sort((s,r)=>{const i=s.indexState.sequenceNumber-r.indexState.sequenceNumber;return i!==0?i:ce(s.collectionGroup,r.collectionGroup)}),n[0].collectionGroup))}updateCollectionGroup(e,n,s){const r=th(e),i=vc(e);return this.ln(e).next(o=>r.K("collectionGroupIndex",IDBKeyRange.bound(n,n)).next(a=>v.forEach(a,c=>i.put(VE(c.indexId,this.user,o,s)))))}updateIndexEntries(e,n){const s=new Map;return v.forEach(n,(r,i)=>{const o=s.get(r.collectionGroup);return(o?v.resolve(o):this.getFieldIndexes(e,r.collectionGroup)).next(a=>(s.set(r.collectionGroup,a),v.forEach(a,c=>this.fn(e,r,c).next(l=>{const u=this.dn(i,c);return l.isEqual(u)?v.resolve():this._n(e,i,c,l,u)}))))})}wn(e,n,s,r){return yc(e).put({indexId:r.indexId,uid:this.uid,arrayValue:r.arrayValue,directionalValue:r.directionalValue,orderedDocumentKey:this.un(s,n.key),documentKey:n.key.path.toArray()})}mn(e,n,s,r){return yc(e).delete([r.indexId,this.uid,r.arrayValue,r.directionalValue,this.un(s,n.key),n.key.path.toArray()])}fn(e,n,s){const r=yc(e);let i=new Ae(_i);return r.J({index:"documentKeyIndex",range:IDBKeyRange.only([s.indexId,this.uid,this.un(s,n)])},(o,a)=>{i=i.add(new Ri(s.indexId,n,a.arrayValue,a.directionalValue))}).next(()=>i)}dn(e,n){let s=new Ae(_i);const r=this.on(n,e);if(r==null)return s;const i=xm(n);if(i!=null){const o=e.data.field(i.fieldPath);if(ql(o))for(const a of o.arrayValue.values||[])s=s.add(new Ri(n.indexId,e.key,this.nn(a),r))}else s=s.add(new Ri(n.indexId,e.key,eh,r));return s}_n(e,n,s,r,i){R("IndexedDbIndexManager","Updating index entries for document '%s'",n.key);const o=[];return function(a,c,l,u,h){const d=a.getIterator(),f=c.getIterator();let p=Fo(d),_=Fo(f);for(;p||_;){let y=!1,I=!1;if(p&&_){const N=l(p,_);N<0?I=!0:N>0&&(y=!0)}else p!=null?I=!0:y=!0;y?(u(_),_=Fo(f)):I?(h(p),p=Fo(d)):(p=Fo(d),_=Fo(f))}}(r,i,_i,a=>{o.push(this.wn(e,n,s,a))},a=>{o.push(this.mn(e,n,s,a))}),v.waitFor(o)}ln(e){let n=1;return vc(e).J({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(s,r,i)=>{i.done(),n=r.sequenceNumber+1}).next(()=>n)}createRange(e,n,s){s=s.sort((o,a)=>_i(o,a)).filter((o,a,c)=>!a||_i(o,c[a-1])!==0);const r=[];r.push(e);for(const o of s){const a=_i(o,e),c=_i(o,n);if(a===0)r[0]=e.Le();else if(a>0&&c<0)r.push(o),r.push(o.Le());else if(c>0)break}r.push(n);const i=[];for(let o=0;o<r.length;o+=2)i.push(IDBKeyRange.bound([r[o].indexId,this.uid,r[o].arrayValue,r[o].directionalValue,eh,[]],[r[o+1].indexId,this.uid,r[o+1].arrayValue,r[o+1].directionalValue,eh,[]]));return i}getMinOffsetFromCollectionGroup(e,n){return this.getFieldIndexes(e,n).next(HE)}getMinOffset(e,n){return v.mapArray(this.Ye(n),s=>this.Xe(e,s).next(r=>r||W())).next(HE)}}function WE(t){return Ot(t,"collectionParents")}function yc(t){return Ot(t,"indexEntries")}function th(t){return Ot(t,"indexConfiguration")}function vc(t){return Ot(t,"indexState")}function HE(t){re(t.length!==0);let e=t[0].indexState.offset,n=e.largestBatchId;for(let s=1;s<t.length;s++){const r=t[s].indexState.offset;dv(r,e)<0&&(e=r),n<r.largestBatchId&&(n=r.largestBatchId)}return new On(e.readTime,e.documentKey,n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GE={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class gn{constructor(e,n,s){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=s}static withCacheSize(e){return new gn(e,gn.DEFAULT_COLLECTION_PERCENTILE,gn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qN(t,e,n){const s=t.store("mutations"),r=t.store("documentMutations"),i=[],o=IDBKeyRange.only(n.batchId);let a=0;const c=s.J({range:o},(u,h,d)=>(a++,d.delete()));i.push(c.next(()=>{re(a===1)}));const l=[];for(const u of n.mutations){const h=LN(e,u.key.path,n.batchId);i.push(r.delete(h)),l.push(u.key)}return v.waitFor(i).next(()=>l)}function vd(t){if(!t)return 0;let e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw W();e=t.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */gn.DEFAULT_COLLECTION_PERCENTILE=10,gn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,gn.DEFAULT=new gn(41943040,gn.DEFAULT_COLLECTION_PERCENTILE,gn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),gn.DISABLED=new gn(-1,0,0);class Yf{constructor(e,n,s,r){this.userId=e,this.wt=n,this.indexManager=s,this.referenceDelegate=r,this.gn={}}static se(e,n,s,r){re(e.uid!=="");const i=e.isAuthenticated()?e.uid:"";return new Yf(i,n,s,r)}checkEmpty(e){let n=!0;const s=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Ir(e).J({index:"userMutationsIndex",range:s},(r,i,o)=>{n=!1,o.done()}).next(()=>n)}addMutationBatch(e,n,s,r){const i=Wo(e),o=Ir(e);return o.add({}).next(a=>{re(typeof a=="number");const c=new bv(a,n,s,r),l=function(d,f,p){const _=p.baseMutations.map(I=>Hl(d.ne,I)),y=p.mutations.map(I=>Hl(d.ne,I));return{userId:f,batchId:p.batchId,localWriteTimeMs:p.localWriteTime.toMillis(),baseMutations:_,mutations:y}}(this.wt,this.userId,c),u=[];let h=new Ae((d,f)=>ce(d.canonicalString(),f.canonicalString()));for(const d of r){const f=LN(this.userId,d.key.path,a);h=h.add(d.key.path.popLast()),u.push(o.put(l)),u.push(i.put(f,l4))}return h.forEach(d=>{u.push(this.indexManager.addToCollectionParentIndex(e,d))}),e.addOnCommittedListener(()=>{this.gn[a]=c.keys()}),v.waitFor(u).next(()=>c)})}lookupMutationBatch(e,n){return Ir(e).get(n).next(s=>s?(re(s.userId===this.userId),Ai(this.wt,s)):null)}yn(e,n){return this.gn[n]?v.resolve(this.gn[n]):this.lookupMutationBatch(e,n).next(s=>{if(s){const r=s.keys();return this.gn[n]=r,r}return null})}getNextMutationBatchAfterBatchId(e,n){const s=n+1,r=IDBKeyRange.lowerBound([this.userId,s]);let i=null;return Ir(e).J({index:"userMutationsIndex",range:r},(o,a,c)=>{a.userId===this.userId&&(re(a.batchId>=s),i=Ai(this.wt,a)),c.done()}).next(()=>i)}getHighestUnacknowledgedBatchId(e){const n=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let s=-1;return Ir(e).J({index:"userMutationsIndex",range:n,reverse:!0},(r,i,o)=>{s=i.batchId,o.done()}).next(()=>s)}getAllMutationBatches(e){const n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Ir(e).K("userMutationsIndex",n).next(s=>s.map(r=>Ai(this.wt,r)))}getAllMutationBatchesAffectingDocumentKey(e,n){const s=Ih(this.userId,n.path),r=IDBKeyRange.lowerBound(s),i=[];return Wo(e).J({range:r},(o,a,c)=>{const[l,u,h]=o,d=Ss(u);if(l===this.userId&&n.path.isEqual(d))return Ir(e).get(h).next(f=>{if(!f)throw W();re(f.userId===this.userId),i.push(Ai(this.wt,f))});c.done()}).next(()=>i)}getAllMutationBatchesAffectingDocumentKeys(e,n){let s=new Ae(ce);const r=[];return n.forEach(i=>{const o=Ih(this.userId,i.path),a=IDBKeyRange.lowerBound(o),c=Wo(e).J({range:a},(l,u,h)=>{const[d,f,p]=l,_=Ss(f);d===this.userId&&i.path.isEqual(_)?s=s.add(p):h.done()});r.push(c)}),v.waitFor(r).next(()=>this.pn(e,s))}getAllMutationBatchesAffectingQuery(e,n){const s=n.path,r=s.length+1,i=Ih(this.userId,s),o=IDBKeyRange.lowerBound(i);let a=new Ae(ce);return Wo(e).J({range:o},(c,l,u)=>{const[h,d,f]=c,p=Ss(d);h===this.userId&&s.isPrefixOf(p)?p.length===r&&(a=a.add(f)):u.done()}).next(()=>this.pn(e,a))}pn(e,n){const s=[],r=[];return n.forEach(i=>{r.push(Ir(e).get(i).next(o=>{if(o===null)throw W();re(o.userId===this.userId),s.push(Ai(this.wt,o))}))}),v.waitFor(r).next(()=>s)}removeMutationBatch(e,n){return qN(e.ee,this.userId,n).next(s=>(e.addOnCommittedListener(()=>{this.In(n.batchId)}),v.forEach(s,r=>this.referenceDelegate.markPotentiallyOrphaned(e,r))))}In(e){delete this.gn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(n=>{if(!n)return v.resolve();const s=IDBKeyRange.lowerBound([this.userId]),r=[];return Wo(e).J({range:s},(i,o,a)=>{if(i[0]===this.userId){const c=Ss(i[1]);r.push(c)}else a.done()}).next(()=>{re(r.length===0)})})}containsKey(e,n){return jN(e,this.userId,n)}Tn(e){return KN(e).get(this.userId).next(n=>n||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}}function jN(t,e,n){const s=Ih(e,n.path),r=s[1],i=IDBKeyRange.lowerBound(s);let o=!1;return Wo(t).J({range:i,H:!0},(a,c,l)=>{const[u,h,d]=a;u===e&&h===r&&(o=!0),l.done()}).next(()=>o)}function Ir(t){return Ot(t,"mutations")}function Wo(t){return Ot(t,"documentMutations")}function KN(t){return Ot(t,"mutationQueues")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class po{constructor(e){this.En=e}next(){return this.En+=2,this.En}static An(){return new po(0)}static Rn(){return new po(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M4{constructor(e,n){this.referenceDelegate=e,this.wt=n}allocateTargetId(e){return this.bn(e).next(n=>{const s=new po(n.highestTargetId);return n.highestTargetId=s.next(),this.Pn(e,n).next(()=>n.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.bn(e).next(n=>se.fromTimestamp(new ze(n.lastRemoteSnapshotVersion.seconds,n.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.bn(e).next(n=>n.highestListenSequenceNumber)}setTargetsMetadata(e,n,s){return this.bn(e).next(r=>(r.highestListenSequenceNumber=n,s&&(r.lastRemoteSnapshotVersion=s.toTimestamp()),n>r.highestListenSequenceNumber&&(r.highestListenSequenceNumber=n),this.Pn(e,r)))}addTargetData(e,n){return this.vn(e,n).next(()=>this.bn(e).next(s=>(s.targetCount+=1,this.Vn(n,s),this.Pn(e,s))))}updateTargetData(e,n){return this.vn(e,n)}removeTargetData(e,n){return this.removeMatchingKeysForTargetId(e,n.targetId).next(()=>$o(e).delete(n.targetId)).next(()=>this.bn(e)).next(s=>(re(s.targetCount>0),s.targetCount-=1,this.Pn(e,s)))}removeTargets(e,n,s){let r=0;const i=[];return $o(e).J((o,a)=>{const c=Rc(a);c.sequenceNumber<=n&&s.get(c.targetId)===null&&(r++,i.push(this.removeTargetData(e,c)))}).next(()=>v.waitFor(i)).next(()=>r)}forEachTarget(e,n){return $o(e).J((s,r)=>{const i=Rc(r);n(i)})}bn(e){return zE(e).get("targetGlobalKey").next(n=>(re(n!==null),n))}Pn(e,n){return zE(e).put("targetGlobalKey",n)}vn(e,n){return $o(e).put(BN(this.wt,n))}Vn(e,n){let s=!1;return e.targetId>n.highestTargetId&&(n.highestTargetId=e.targetId,s=!0),e.sequenceNumber>n.highestListenSequenceNumber&&(n.highestListenSequenceNumber=e.sequenceNumber,s=!0),s}getTargetCount(e){return this.bn(e).next(n=>n.targetCount)}getTargetData(e,n){const s=co(n),r=IDBKeyRange.bound([s,Number.NEGATIVE_INFINITY],[s,Number.POSITIVE_INFINITY]);let i=null;return $o(e).J({range:r,index:"queryTargetsIndex"},(o,a,c)=>{const l=Rc(a);Au(n,l.target)&&(i=l,c.done())}).next(()=>i)}addMatchingKeys(e,n,s){const r=[],i=kr(e);return n.forEach(o=>{const a=un(o.path);r.push(i.put({targetId:s,path:a})),r.push(this.referenceDelegate.addReference(e,s,o))}),v.waitFor(r)}removeMatchingKeys(e,n,s){const r=kr(e);return v.forEach(n,i=>{const o=un(i.path);return v.waitFor([r.delete([s,o]),this.referenceDelegate.removeReference(e,s,i)])})}removeMatchingKeysForTargetId(e,n){const s=kr(e),r=IDBKeyRange.bound([n],[n+1],!1,!0);return s.delete(r)}getMatchingKeysForTargetId(e,n){const s=IDBKeyRange.bound([n],[n+1],!1,!0),r=kr(e);let i=ue();return r.J({range:s,H:!0},(o,a,c)=>{const l=Ss(o[1]),u=new F(l);i=i.add(u)}).next(()=>i)}containsKey(e,n){const s=un(n.path),r=IDBKeyRange.bound([s],[GR(s)],!1,!0);let i=0;return kr(e).J({index:"documentTargetsIndex",H:!0,range:r},([o,a],c,l)=>{o!==0&&(i++,l.done())}).next(()=>i>0)}te(e,n){return $o(e).get(n).next(s=>s?Rc(s):null)}}function $o(t){return Ot(t,"targets")}function zE(t){return Ot(t,"targetGlobal")}function kr(t){return Ot(t,"targetDocuments")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function QE([t,e],[n,s]){const r=ce(t,n);return r===0?ce(e,s):r}class L4{constructor(e){this.Sn=e,this.buffer=new Ae(QE),this.Dn=0}Cn(){return++this.Dn}xn(e){const n=[e,this.Cn()];if(this.buffer.size<this.Sn)this.buffer=this.buffer.add(n);else{const s=this.buffer.last();QE(n,s)<0&&(this.buffer=this.buffer.delete(s).add(n))}}get maxValue(){return this.buffer.last()[0]}}class F4{constructor(e,n,s){this.garbageCollector=e,this.asyncQueue=n,this.localStore=s,this.Nn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.kn(6e4)}stop(){this.Nn&&(this.Nn.cancel(),this.Nn=null)}get started(){return this.Nn!==null}kn(e){R("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.Nn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Nn=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){li(n)?R("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",n):await ci(n)}await this.kn(3e5)})}}class U4{constructor(e,n){this.On=e,this.params=n}calculateTargetCount(e,n){return this.On.Mn(e).next(s=>Math.floor(n/100*s))}nthSequenceNumber(e,n){if(n===0)return v.resolve(yn.ot);const s=new L4(n);return this.On.forEachTarget(e,r=>s.xn(r.sequenceNumber)).next(()=>this.On.Fn(e,r=>s.xn(r))).next(()=>s.maxValue)}removeTargets(e,n,s){return this.On.removeTargets(e,n,s)}removeOrphanedDocuments(e,n){return this.On.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(R("LruGarbageCollector","Garbage collection skipped; disabled"),v.resolve(GE)):this.getCacheSize(e).next(s=>s<this.params.cacheSizeCollectionThreshold?(R("LruGarbageCollector",`Garbage collection skipped; Cache size ${s} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),GE):this.$n(e,n))}getCacheSize(e){return this.On.getCacheSize(e)}$n(e,n){let s,r,i,o,a,c,l;const u=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(h=>(h>this.params.maximumSequenceNumbersToCollect?(R("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${h}`),r=this.params.maximumSequenceNumbersToCollect):r=h,o=Date.now(),this.nthSequenceNumber(e,r))).next(h=>(s=h,a=Date.now(),this.removeTargets(e,s,n))).next(h=>(i=h,c=Date.now(),this.removeOrphanedDocuments(e,s))).next(h=>(l=Date.now(),Dm()<=de.DEBUG&&R("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-u}ms
	Determined least recently used ${r} in `+(a-o)+`ms
	Removed ${i} targets in `+(c-a)+`ms
	Removed ${h} documents in `+(l-c)+`ms
Total Duration: ${l-u}ms`),v.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:i,documentsRemoved:h})))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $4{constructor(e,n){this.db=e,this.garbageCollector=function(s,r){return new U4(s,r)}(this,n)}Mn(e){const n=this.Bn(e);return this.db.getTargetCache().getTargetCount(e).next(s=>n.next(r=>s+r))}Bn(e){let n=0;return this.Fn(e,s=>{n++}).next(()=>n)}forEachTarget(e,n){return this.db.getTargetCache().forEachTarget(e,n)}Fn(e,n){return this.Ln(e,(s,r)=>n(r))}addReference(e,n,s){return nh(e,s)}removeReference(e,n,s){return nh(e,s)}removeTargets(e,n,s){return this.db.getTargetCache().removeTargets(e,n,s)}markPotentiallyOrphaned(e,n){return nh(e,n)}Un(e,n){return function(s,r){let i=!1;return KN(s).Y(o=>jN(s,o,r).next(a=>(a&&(i=!0),v.resolve(!a)))).next(()=>i)}(e,n)}removeOrphanedDocuments(e,n){const s=this.db.getRemoteDocumentCache().newChangeBuffer(),r=[];let i=0;return this.Ln(e,(o,a)=>{if(a<=n){const c=this.Un(e,o).next(l=>{if(!l)return i++,s.getEntry(e,o).next(()=>(s.removeEntry(o,se.min()),kr(e).delete([0,un(o.path)])))});r.push(c)}}).next(()=>v.waitFor(r)).next(()=>s.apply(e)).next(()=>i)}removeTarget(e,n){const s=n.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,s)}updateLimboDocument(e,n){return nh(e,n)}Ln(e,n){const s=kr(e);let r,i=yn.ot;return s.J({index:"documentTargetsIndex"},([o,a],{path:c,sequenceNumber:l})=>{o===0?(i!==yn.ot&&n(new F(Ss(r)),i),i=l,r=c):i=yn.ot}).next(()=>{i!==yn.ot&&n(new F(Ss(r)),i)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function nh(t,e){return kr(t).put(function(n,s){return{targetId:0,path:un(n.path),sequenceNumber:s}}(e,t.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WN{constructor(){this.changes=new ui(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,Be.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const s=this.changes.get(n);return s!==void 0?v.resolve(s):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V4{constructor(e){this.wt=e}setIndexManager(e){this.indexManager=e}addEntry(e,n,s){return yi(e).put(s)}removeEntry(e,n,s){return yi(e).delete(function(r,i){const o=r.path.toArray();return[o.slice(0,o.length-2),o[o.length-2],yd(i),o[o.length-1]]}(n,s))}updateMetadata(e,n){return this.getMetadata(e).next(s=>(s.byteSize+=n,this.qn(e,s)))}getEntry(e,n){let s=Be.newInvalidDocument(n);return yi(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(wc(n))},(r,i)=>{s=this.Kn(n,i)}).next(()=>s)}Gn(e,n){let s={size:0,document:Be.newInvalidDocument(n)};return yi(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(wc(n))},(r,i)=>{s={document:this.Kn(n,i),size:vd(i)}}).next(()=>s)}getEntries(e,n){let s=vn();return this.Qn(e,n,(r,i)=>{const o=this.Kn(r,i);s=s.insert(r,o)}).next(()=>s)}jn(e,n){let s=vn(),r=new st(F.comparator);return this.Qn(e,n,(i,o)=>{const a=this.Kn(i,o);s=s.insert(i,a),r=r.insert(i,vd(o))}).next(()=>({documents:s,Wn:r}))}Qn(e,n,s){if(n.isEmpty())return v.resolve();let r=new Ae(XE);n.forEach(c=>r=r.add(c));const i=IDBKeyRange.bound(wc(r.first()),wc(r.last())),o=r.getIterator();let a=o.getNext();return yi(e).J({index:"documentKeyIndex",range:i},(c,l,u)=>{const h=F.fromSegments([...l.prefixPath,l.collectionGroup,l.documentId]);for(;a&&XE(a,h)<0;)s(a,null),a=o.getNext();a&&a.isEqual(h)&&(s(a,l),a=o.hasNext()?o.getNext():null),a?u.q(wc(a)):u.done()}).next(()=>{for(;a;)s(a,null),a=o.hasNext()?o.getNext():null})}getAllFromCollection(e,n,s){const r=[n.popLast().toArray(),n.lastSegment(),yd(s.readTime),s.documentKey.path.isEmpty()?"":s.documentKey.path.lastSegment()],i=[n.popLast().toArray(),n.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return yi(e).K(IDBKeyRange.bound(r,i,!0)).next(o=>{let a=vn();for(const c of o){const l=this.Kn(F.fromSegments(c.prefixPath.concat(c.collectionGroup,c.documentId)),c);a=a.insert(l.key,l)}return a})}getAllFromCollectionGroup(e,n,s,r){let i=vn();const o=JE(n,s),a=JE(n,On.max());return yi(e).J({index:"collectionGroupIndex",range:IDBKeyRange.bound(o,a,!0)},(c,l,u)=>{const h=this.Kn(F.fromSegments(l.prefixPath.concat(l.collectionGroup,l.documentId)),l);i=i.insert(h.key,h),i.size===r&&u.done()}).next(()=>i)}newChangeBuffer(e){return new B4(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(n=>n.byteSize)}getMetadata(e){return YE(e).get("remoteDocumentGlobalKey").next(n=>(re(!!n),n))}qn(e,n){return YE(e).put("remoteDocumentGlobalKey",n)}Kn(e,n){if(n){const s=C4(this.wt,n);if(!(s.isNoDocument()&&s.version.isEqual(se.min())))return s}return Be.newInvalidDocument(e)}}function HN(t){return new V4(t)}class B4 extends WN{constructor(e,n){super(),this.zn=e,this.trackRemovals=n,this.Hn=new ui(s=>s.toString(),(s,r)=>s.isEqual(r))}applyChanges(e){const n=[];let s=0,r=new Ae((i,o)=>ce(i.canonicalString(),o.canonicalString()));return this.changes.forEach((i,o)=>{const a=this.Hn.get(i);if(n.push(this.zn.removeEntry(e,i,a.readTime)),o.isValidDocument()){const c=UE(this.zn.wt,o);r=r.add(i.path.popLast()),s+=vd(c)-a.size,n.push(this.zn.addEntry(e,i,c))}else if(s-=a.size,this.trackRemovals){const c=UE(this.zn.wt,o.convertToNoDocument(se.min()));n.push(this.zn.addEntry(e,i,c))}}),r.forEach(i=>{n.push(this.zn.indexManager.addToCollectionParentIndex(e,i))}),n.push(this.zn.updateMetadata(e,s)),v.waitFor(n)}getFromCache(e,n){return this.zn.Gn(e,n).next(s=>(this.Hn.set(n,{size:s.size,readTime:s.document.readTime}),s.document))}getAllFromCache(e,n){return this.zn.jn(e,n).next(({documents:s,Wn:r})=>(r.forEach((i,o)=>{this.Hn.set(i,{size:o,readTime:s.get(i).readTime})}),s))}}function YE(t){return Ot(t,"remoteDocumentGlobal")}function yi(t){return Ot(t,"remoteDocumentsV14")}function wc(t){const e=t.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function JE(t,e){const n=e.documentKey.path.toArray();return[t,yd(e.readTime),n.slice(0,n.length-2),n.length>0?n[n.length-1]:""]}function XE(t,e){const n=t.path.toArray(),s=e.path.toArray();let r=0;for(let i=0;i<n.length-2&&i<s.length-2;++i)if(r=ce(n[i],s[i]),r)return r;return r=ce(n.length,s.length),r||(r=ce(n[n.length-2],s[s.length-2]),r||ce(n[n.length-1],s[s.length-1]))}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q4{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GN{constructor(e,n,s,r){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=s,this.indexManager=r}getDocument(e,n){let s=null;return this.documentOverlayCache.getOverlay(e,n).next(r=>(s=r,this.getBaseDocument(e,n,s))).next(r=>(s!==null&&zc(s.mutation,r,Nn.empty(),ze.now()),r))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(s=>this.getLocalViewOfDocuments(e,s,ue()).next(()=>s))}getLocalViewOfDocuments(e,n,s=ue()){const r=Ts();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,s).next(i=>{let o=kc();return i.forEach((a,c)=>{o=o.insert(a,c.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){const s=Ts();return this.populateOverlays(e,s,n).next(()=>this.computeViews(e,n,s,ue()))}populateOverlays(e,n,s){const r=[];return s.forEach(i=>{n.has(i)||r.push(i)}),this.documentOverlayCache.getOverlays(e,r).next(i=>{i.forEach((o,a)=>{n.set(o,a)})})}computeViews(e,n,s,r){let i=vn();const o=Qc(),a=Qc();return n.forEach((c,l)=>{const u=s.get(l.key);r.has(l.key)&&(u===void 0||u.mutation instanceof fr)?i=i.insert(l.key,l):u!==void 0&&(o.set(l.key,u.mutation.getFieldMask()),zc(u.mutation,l,u.mutation.getFieldMask(),ze.now()))}),this.recalculateAndSaveOverlays(e,i).next(c=>(c.forEach((l,u)=>o.set(l,u)),n.forEach((l,u)=>{var h;return a.set(l,new q4(u,(h=o.get(l))!==null&&h!==void 0?h:null))}),a))}recalculateAndSaveOverlays(e,n){const s=Qc();let r=new st((o,a)=>o-a),i=ue();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(const a of o)a.keys().forEach(c=>{const l=n.get(c);if(l===null)return;let u=s.get(c)||Nn.empty();u=a.applyToLocalView(l,u),s.set(c,u);const h=(r.get(a.batchId)||ue()).add(c);r=r.insert(a.batchId,h)})}).next(()=>{const o=[],a=r.getReverseIterator();for(;a.hasNext();){const c=a.getNext(),l=c.key,u=c.value,h=EN();u.forEach(d=>{if(!i.has(d)){const f=_N(n.get(d),s.get(d));f!==null&&h.set(d,f),i=i.add(d)}}),o.push(this.documentOverlayCache.saveOverlays(e,l,h))}return v.waitFor(o)}).next(()=>s)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(s=>this.recalculateAndSaveOverlays(e,s))}getDocumentsMatchingQuery(e,n,s){return function(r){return F.isDocumentKey(r.path)&&r.collectionGroup===null&&r.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):_v(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,s):this.getDocumentsMatchingCollectionQuery(e,n,s)}getNextDocuments(e,n,s,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,s,r).next(i=>{const o=r-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,s.largestBatchId,r-i.size):v.resolve(Ts());let a=-1,c=i;return o.next(l=>v.forEach(l,(u,h)=>(a<h.largestBatchId&&(a=h.largestBatchId),i.get(u)?v.resolve():this.getBaseDocument(e,u,h).next(d=>{c=c.insert(u,d)}))).next(()=>this.populateOverlays(e,l,i)).next(()=>this.computeViews(e,c,l,ue())).next(u=>({batchId:a,changes:IN(u)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new F(n)).next(s=>{let r=kc();return s.isFoundDocument()&&(r=r.insert(s.key,s)),r})}getDocumentsMatchingCollectionGroupQuery(e,n,s){const r=n.collectionGroup;let i=kc();return this.indexManager.getCollectionParents(e,r).next(o=>v.forEach(o,a=>{const c=function(l,u){return new dr(u,null,l.explicitOrderBy.slice(),l.filters.slice(),l.limit,l.limitType,l.startAt,l.endAt)}(n,a.child(r));return this.getDocumentsMatchingCollectionQuery(e,c,s).next(l=>{l.forEach((u,h)=>{i=i.insert(u,h)})})}).next(()=>i))}getDocumentsMatchingCollectionQuery(e,n,s){let r;return this.remoteDocumentCache.getAllFromCollection(e,n.path,s).next(i=>(r=i,this.documentOverlayCache.getOverlaysForCollection(e,n.path,s.largestBatchId))).next(i=>{i.forEach((a,c)=>{const l=c.getKey();r.get(l)===null&&(r=r.insert(l,Be.newInvalidDocument(l)))});let o=kc();return r.forEach((a,c)=>{const l=i.get(a);l!==void 0&&zc(l.mutation,c,Nn.empty(),ze.now()),yv(n,c)&&(o=o.insert(a,c))}),o})}getBaseDocument(e,n,s){return s===null||s.mutation.type===1?this.remoteDocumentCache.getEntry(e,n):v.resolve(Be.newInvalidDocument(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j4{constructor(e){this.wt=e,this.Jn=new Map,this.Yn=new Map}getBundleMetadata(e,n){return v.resolve(this.Jn.get(n))}saveBundleMetadata(e,n){var s;return this.Jn.set(n.id,{id:(s=n).id,version:s.version,createTime:Ct(s.createTime)}),v.resolve()}getNamedQuery(e,n){return v.resolve(this.Yn.get(n))}saveNamedQuery(e,n){return this.Yn.set(n.name,function(s){return{name:s.name,query:Tv(s.bundledQuery),readTime:Ct(s.readTime)}}(n)),v.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K4{constructor(){this.overlays=new st(F.comparator),this.Xn=new Map}getOverlay(e,n){return v.resolve(this.overlays.get(n))}getOverlays(e,n){const s=Ts();return v.forEach(n,r=>this.getOverlay(e,r).next(i=>{i!==null&&s.set(r,i)})).next(()=>s)}saveOverlays(e,n,s){return s.forEach((r,i)=>{this.ie(e,n,i)}),v.resolve()}removeOverlaysForBatchId(e,n,s){const r=this.Xn.get(s);return r!==void 0&&(r.forEach(i=>this.overlays=this.overlays.remove(i)),this.Xn.delete(s)),v.resolve()}getOverlaysForCollection(e,n,s){const r=Ts(),i=n.length+1,o=new F(n.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const c=a.getNext().value,l=c.getKey();if(!n.isPrefixOf(l.path))break;l.path.length===i&&c.largestBatchId>s&&r.set(c.getKey(),c)}return v.resolve(r)}getOverlaysForCollectionGroup(e,n,s,r){let i=new st((l,u)=>l-u);const o=this.overlays.getIterator();for(;o.hasNext();){const l=o.getNext().value;if(l.getKey().getCollectionGroup()===n&&l.largestBatchId>s){let u=i.get(l.largestBatchId);u===null&&(u=Ts(),i=i.insert(l.largestBatchId,u)),u.set(l.getKey(),l)}}const a=Ts(),c=i.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((l,u)=>a.set(l,u)),!(a.size()>=r)););return v.resolve(a)}ie(e,n,s){const r=this.overlays.get(s.key);if(r!==null){const o=this.Xn.get(r.largestBatchId).delete(s.key);this.Xn.set(r.largestBatchId,o)}this.overlays=this.overlays.insert(s.key,new Ev(n,s));let i=this.Xn.get(n);i===void 0&&(i=ue(),this.Xn.set(n,i)),this.Xn.set(n,i.add(s.key))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cv{constructor(){this.Zn=new Ae(vt.ts),this.es=new Ae(vt.ns)}isEmpty(){return this.Zn.isEmpty()}addReference(e,n){const s=new vt(e,n);this.Zn=this.Zn.add(s),this.es=this.es.add(s)}ss(e,n){e.forEach(s=>this.addReference(s,n))}removeReference(e,n){this.rs(new vt(e,n))}os(e,n){e.forEach(s=>this.removeReference(s,n))}us(e){const n=new F(new we([])),s=new vt(n,e),r=new vt(n,e+1),i=[];return this.es.forEachInRange([s,r],o=>{this.rs(o),i.push(o.key)}),i}cs(){this.Zn.forEach(e=>this.rs(e))}rs(e){this.Zn=this.Zn.delete(e),this.es=this.es.delete(e)}hs(e){const n=new F(new we([])),s=new vt(n,e),r=new vt(n,e+1);let i=ue();return this.es.forEachInRange([s,r],o=>{i=i.add(o.key)}),i}containsKey(e){const n=new vt(e,0),s=this.Zn.firstAfterOrEqual(n);return s!==null&&e.isEqual(s.key)}}class vt{constructor(e,n){this.key=e,this.ls=n}static ts(e,n){return F.comparator(e.key,n.key)||ce(e.ls,n.ls)}static ns(e,n){return ce(e.ls,n.ls)||F.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W4{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.fs=1,this.ds=new Ae(vt.ts)}checkEmpty(e){return v.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,s,r){const i=this.fs;this.fs++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new bv(i,n,s,r);this.mutationQueue.push(o);for(const a of r)this.ds=this.ds.add(new vt(a.key,i)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return v.resolve(o)}lookupMutationBatch(e,n){return v.resolve(this._s(n))}getNextMutationBatchAfterBatchId(e,n){const s=n+1,r=this.ws(s),i=r<0?0:r;return v.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return v.resolve(this.mutationQueue.length===0?-1:this.fs-1)}getAllMutationBatches(e){return v.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const s=new vt(n,0),r=new vt(n,Number.POSITIVE_INFINITY),i=[];return this.ds.forEachInRange([s,r],o=>{const a=this._s(o.ls);i.push(a)}),v.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,n){let s=new Ae(ce);return n.forEach(r=>{const i=new vt(r,0),o=new vt(r,Number.POSITIVE_INFINITY);this.ds.forEachInRange([i,o],a=>{s=s.add(a.ls)})}),v.resolve(this.gs(s))}getAllMutationBatchesAffectingQuery(e,n){const s=n.path,r=s.length+1;let i=s;F.isDocumentKey(i)||(i=i.child(""));const o=new vt(new F(i),0);let a=new Ae(ce);return this.ds.forEachWhile(c=>{const l=c.key.path;return!!s.isPrefixOf(l)&&(l.length===r&&(a=a.add(c.ls)),!0)},o),v.resolve(this.gs(a))}gs(e){const n=[];return e.forEach(s=>{const r=this._s(s);r!==null&&n.push(r)}),n}removeMutationBatch(e,n){re(this.ys(n.batchId,"removed")===0),this.mutationQueue.shift();let s=this.ds;return v.forEach(n.mutations,r=>{const i=new vt(r.key,n.batchId);return s=s.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)}).next(()=>{this.ds=s})}In(e){}containsKey(e,n){const s=new vt(n,0),r=this.ds.firstAfterOrEqual(s);return v.resolve(n.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,v.resolve()}ys(e,n){return this.ws(e)}ws(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}_s(e){const n=this.ws(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H4{constructor(e){this.ps=e,this.docs=new st(F.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const s=n.key,r=this.docs.get(s),i=r?r.size:0,o=this.ps(n);return this.docs=this.docs.insert(s,{document:n.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(e,s.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const s=this.docs.get(n);return v.resolve(s?s.document.mutableCopy():Be.newInvalidDocument(n))}getEntries(e,n){let s=vn();return n.forEach(r=>{const i=this.docs.get(r);s=s.insert(r,i?i.document.mutableCopy():Be.newInvalidDocument(r))}),v.resolve(s)}getAllFromCollection(e,n,s){let r=vn();const i=new F(n.child("")),o=this.docs.getIteratorFrom(i);for(;o.hasNext();){const{key:a,value:{document:c}}=o.getNext();if(!n.isPrefixOf(a.path))break;a.path.length>n.length+1||dv(YR(c),s)<=0||(r=r.insert(c.key,c.mutableCopy()))}return v.resolve(r)}getAllFromCollectionGroup(e,n,s,r){W()}Is(e,n){return v.forEach(this.docs,s=>n(s))}newChangeBuffer(e){return new G4(this)}getSize(e){return v.resolve(this.size)}}class G4 extends WN{constructor(e){super(),this.zn=e}applyChanges(e){const n=[];return this.changes.forEach((s,r)=>{r.isValidDocument()?n.push(this.zn.addEntry(e,r)):this.zn.removeEntry(s)}),v.waitFor(n)}getFromCache(e,n){return this.zn.getEntry(e,n)}getAllFromCache(e,n){return this.zn.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z4{constructor(e){this.persistence=e,this.Ts=new ui(n=>co(n),Au),this.lastRemoteSnapshotVersion=se.min(),this.highestTargetId=0,this.Es=0,this.As=new Cv,this.targetCount=0,this.Rs=po.An()}forEachTarget(e,n){return this.Ts.forEach((s,r)=>n(r)),v.resolve()}getLastRemoteSnapshotVersion(e){return v.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return v.resolve(this.Es)}allocateTargetId(e){return this.highestTargetId=this.Rs.next(),v.resolve(this.highestTargetId)}setTargetsMetadata(e,n,s){return s&&(this.lastRemoteSnapshotVersion=s),n>this.Es&&(this.Es=n),v.resolve()}vn(e){this.Ts.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.Rs=new po(n),this.highestTargetId=n),e.sequenceNumber>this.Es&&(this.Es=e.sequenceNumber)}addTargetData(e,n){return this.vn(n),this.targetCount+=1,v.resolve()}updateTargetData(e,n){return this.vn(n),v.resolve()}removeTargetData(e,n){return this.Ts.delete(n.target),this.As.us(n.targetId),this.targetCount-=1,v.resolve()}removeTargets(e,n,s){let r=0;const i=[];return this.Ts.forEach((o,a)=>{a.sequenceNumber<=n&&s.get(a.targetId)===null&&(this.Ts.delete(o),i.push(this.removeMatchingKeysForTargetId(e,a.targetId)),r++)}),v.waitFor(i).next(()=>r)}getTargetCount(e){return v.resolve(this.targetCount)}getTargetData(e,n){const s=this.Ts.get(n)||null;return v.resolve(s)}addMatchingKeys(e,n,s){return this.As.ss(n,s),v.resolve()}removeMatchingKeys(e,n,s){this.As.os(n,s);const r=this.persistence.referenceDelegate,i=[];return r&&n.forEach(o=>{i.push(r.markPotentiallyOrphaned(e,o))}),v.waitFor(i)}removeMatchingKeysForTargetId(e,n){return this.As.us(n),v.resolve()}getMatchingKeysForTargetId(e,n){const s=this.As.hs(n);return v.resolve(s)}containsKey(e,n){return v.resolve(this.As.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zN{constructor(e,n){this.bs={},this.overlays={},this.Ps=new yn(0),this.vs=!1,this.vs=!0,this.referenceDelegate=e(this),this.Vs=new z4(this),this.indexManager=new x4,this.remoteDocumentCache=function(s){return new H4(s)}(s=>this.referenceDelegate.Ss(s)),this.wt=new VN(n),this.Ds=new j4(this.wt)}start(){return Promise.resolve()}shutdown(){return this.vs=!1,Promise.resolve()}get started(){return this.vs}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new K4,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let s=this.bs[e.toKey()];return s||(s=new W4(n,this.referenceDelegate),this.bs[e.toKey()]=s),s}getTargetCache(){return this.Vs}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ds}runTransaction(e,n,s){R("MemoryPersistence","Starting transaction:",e);const r=new Q4(this.Ps.next());return this.referenceDelegate.Cs(),s(r).next(i=>this.referenceDelegate.xs(r).next(()=>i)).toPromise().then(i=>(r.raiseOnCommittedEvent(),i))}Ns(e,n){return v.or(Object.values(this.bs).map(s=>()=>s.containsKey(e,n)))}}class Q4 extends XR{constructor(e){super(),this.currentSequenceNumber=e}}class Jf{constructor(e){this.persistence=e,this.ks=new Cv,this.Os=null}static Ms(e){return new Jf(e)}get Fs(){if(this.Os)return this.Os;throw W()}addReference(e,n,s){return this.ks.addReference(s,n),this.Fs.delete(s.toString()),v.resolve()}removeReference(e,n,s){return this.ks.removeReference(s,n),this.Fs.add(s.toString()),v.resolve()}markPotentiallyOrphaned(e,n){return this.Fs.add(n.toString()),v.resolve()}removeTarget(e,n){this.ks.us(n.targetId).forEach(r=>this.Fs.add(r.toString()));const s=this.persistence.getTargetCache();return s.getMatchingKeysForTargetId(e,n.targetId).next(r=>{r.forEach(i=>this.Fs.add(i.toString()))}).next(()=>s.removeTargetData(e,n))}Cs(){this.Os=new Set}xs(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return v.forEach(this.Fs,s=>{const r=F.fromPath(s);return this.$s(e,r).next(i=>{i||n.removeEntry(r,se.min())})}).next(()=>(this.Os=null,n.apply(e)))}updateLimboDocument(e,n){return this.$s(e,n).next(s=>{s?this.Fs.delete(n.toString()):this.Fs.add(n.toString())})}Ss(e){return 0}$s(e,n){return v.or([()=>v.resolve(this.ks.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Ns(e,n)])}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y4{constructor(e){this.wt=e}O(e,n,s,r){const i=new Wf("createOrUpgrade",n);s<1&&r>=1&&(function(a){a.createObjectStore("owner")}(e),function(a){a.createObjectStore("mutationQueues",{keyPath:"userId"}),a.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",FE,{unique:!0}),a.createObjectStore("documentMutations")}(e),ZE(e),function(a){a.createObjectStore("remoteDocuments")}(e));let o=v.resolve();return s<3&&r>=3&&(s!==0&&(function(a){a.deleteObjectStore("targetDocuments"),a.deleteObjectStore("targets"),a.deleteObjectStore("targetGlobal")}(e),ZE(e)),o=o.next(()=>function(a){const c=a.store("targetGlobal"),l={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:se.min().toTimestamp(),targetCount:0};return c.put("targetGlobalKey",l)}(i))),s<4&&r>=4&&(s!==0&&(o=o.next(()=>function(a,c){return c.store("mutations").K().next(l=>{a.deleteObjectStore("mutations"),a.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",FE,{unique:!0});const u=c.store("mutations"),h=l.map(d=>u.put(d));return v.waitFor(h)})}(e,i))),o=o.next(()=>{(function(a){a.createObjectStore("clientMetadata",{keyPath:"clientId"})})(e)})),s<5&&r>=5&&(o=o.next(()=>this.Bs(i))),s<6&&r>=6&&(o=o.next(()=>(function(a){a.createObjectStore("remoteDocumentGlobal")}(e),this.Ls(i)))),s<7&&r>=7&&(o=o.next(()=>this.Us(i))),s<8&&r>=8&&(o=o.next(()=>this.qs(e,i))),s<9&&r>=9&&(o=o.next(()=>{(function(a){a.objectStoreNames.contains("remoteDocumentChanges")&&a.deleteObjectStore("remoteDocumentChanges")})(e)})),s<10&&r>=10&&(o=o.next(()=>this.Ks(i))),s<11&&r>=11&&(o=o.next(()=>{(function(a){a.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(a){a.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),s<12&&r>=12&&(o=o.next(()=>{(function(a){const c=a.createObjectStore("documentOverlays",{keyPath:b4});c.createIndex("collectionPathOverlayIndex",I4,{unique:!1}),c.createIndex("collectionGroupOverlayIndex",E4,{unique:!1})})(e)})),s<13&&r>=13&&(o=o.next(()=>function(a){const c=a.createObjectStore("remoteDocumentsV14",{keyPath:u4});c.createIndex("documentKeyIndex",h4),c.createIndex("collectionGroupIndex",d4)}(e)).next(()=>this.Gs(e,i)).next(()=>e.deleteObjectStore("remoteDocuments"))),s<14&&r>=14&&(o=o.next(()=>this.Qs(e,i))),s<15&&r>=15&&(o=o.next(()=>function(a){a.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),a.createObjectStore("indexState",{keyPath:_4}).createIndex("sequenceNumberIndex",y4,{unique:!1}),a.createObjectStore("indexEntries",{keyPath:v4}).createIndex("documentKeyIndex",w4,{unique:!1})}(e))),o}Ls(e){let n=0;return e.store("remoteDocuments").J((s,r)=>{n+=vd(r)}).next(()=>{const s={byteSize:n};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",s)})}Bs(e){const n=e.store("mutationQueues"),s=e.store("mutations");return n.K().next(r=>v.forEach(r,i=>{const o=IDBKeyRange.bound([i.userId,-1],[i.userId,i.lastAcknowledgedBatchId]);return s.K("userMutationsIndex",o).next(a=>v.forEach(a,c=>{re(c.userId===i.userId);const l=Ai(this.wt,c);return qN(e,i.userId,l).next(()=>{})}))}))}Us(e){const n=e.store("targetDocuments"),s=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(r=>{const i=[];return s.J((o,a)=>{const c=new we(o),l=function(u){return[0,un(u)]}(c);i.push(n.get(l).next(u=>u?v.resolve():(h=>n.put({targetId:0,path:un(h),sequenceNumber:r.highestListenSequenceNumber}))(c)))}).next(()=>v.waitFor(i))})}qs(e,n){e.createObjectStore("collectionParents",{keyPath:m4});const s=n.store("collectionParents"),r=new Sv,i=o=>{if(r.add(o)){const a=o.lastSegment(),c=o.popLast();return s.put({collectionId:a,parent:un(c)})}};return n.store("remoteDocuments").J({H:!0},(o,a)=>{const c=new we(o);return i(c.popLast())}).next(()=>n.store("documentMutations").J({H:!0},([o,a,c],l)=>{const u=Ss(a);return i(u.popLast())}))}Ks(e){const n=e.store("targets");return n.J((s,r)=>{const i=Rc(r),o=BN(this.wt,i);return n.put(o)})}Gs(e,n){const s=n.store("remoteDocuments"),r=[];return s.J((i,o)=>{const a=n.store("remoteDocumentsV14"),c=(l=o,l.document?new F(we.fromString(l.document.name).popFirst(5)):l.noDocument?F.fromSegments(l.noDocument.path):l.unknownDocument?F.fromSegments(l.unknownDocument.path):W()).path.toArray();var l;/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const u={prefixPath:c.slice(0,c.length-2),collectionGroup:c[c.length-2],documentId:c[c.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};r.push(a.put(u))}).next(()=>v.waitFor(r))}Qs(e,n){const s=n.store("mutations"),r=HN(this.wt),i=new zN(Jf.Ms,this.wt.ne);return s.K().next(o=>{const a=new Map;return o.forEach(c=>{var l;let u=(l=a.get(c.userId))!==null&&l!==void 0?l:ue();Ai(this.wt,c).keys().forEach(h=>u=u.add(h)),a.set(c.userId,u)}),v.forEach(a,(c,l)=>{const u=new It(l),h=Qf.se(this.wt,u),d=i.getIndexManager(u),f=Yf.se(u,this.wt,d,i.referenceDelegate);return new GN(r,f,h,d).recalculateAndSaveOverlaysForDocumentKeys(new $m(n,yn.ot),c).next()})})}}function ZE(t){t.createObjectStore("targetDocuments",{keyPath:p4}).createIndex("documentTargetsIndex",g4,{unique:!0}),t.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",f4,{unique:!0}),t.createObjectStore("targetGlobal")}const Zp="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class Av{constructor(e,n,s,r,i,o,a,c,l,u,h=14){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=s,this.js=i,this.window=o,this.document=a,this.Ws=l,this.zs=u,this.Hs=h,this.Ps=null,this.vs=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Js=null,this.inForeground=!1,this.Ys=null,this.Xs=null,this.Zs=Number.NEGATIVE_INFINITY,this.ti=d=>Promise.resolve(),!Av.V())throw new S(w.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new $4(this,r),this.ei=n+"main",this.wt=new VN(c),this.ni=new rs(this.ei,this.Hs,new Y4(this.wt)),this.Vs=new M4(this.referenceDelegate,this.wt),this.remoteDocumentCache=HN(this.wt),this.Ds=new A4,this.window&&this.window.localStorage?this.si=this.window.localStorage:(this.si=null,u===!1&&ht("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.ii().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new S(w.FAILED_PRECONDITION,Zp);return this.ri(),this.oi(),this.ui(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Vs.getHighestSequenceNumber(e))}).then(e=>{this.Ps=new yn(e,this.Ws)}).then(()=>{this.vs=!0}).catch(e=>(this.ni&&this.ni.close(),Promise.reject(e)))}ci(e){return this.ti=async n=>{if(this.started)return e(n)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.ni.F(async n=>{n.newVersion===null&&await e()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.js.enqueueAndForget(async()=>{this.started&&await this.ii()}))}ii(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>sh(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.ai(e).next(n=>{n||(this.isPrimary=!1,this.js.enqueueRetryable(()=>this.ti(!1)))})}).next(()=>this.hi(e)).next(n=>this.isPrimary&&!n?this.li(e).next(()=>!1):!!n&&this.fi(e).next(()=>!0))).catch(e=>{if(li(e))return R("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return R("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.js.enqueueRetryable(()=>this.ti(e)),this.isPrimary=e})}ai(e){return bc(e).get("owner").next(n=>v.resolve(this.di(n)))}_i(e){return sh(e).delete(this.clientId)}async wi(){if(this.isPrimary&&!this.mi(this.Zs,18e5)){this.Zs=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",n=>{const s=Ot(n,"clientMetadata");return s.K().next(r=>{const i=this.gi(r,18e5),o=r.filter(a=>i.indexOf(a)===-1);return v.forEach(o,a=>s.delete(a.clientId)).next(()=>o)})}).catch(()=>[]);if(this.si)for(const n of e)this.si.removeItem(this.yi(n.clientId))}}ui(){this.Xs=this.js.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.ii().then(()=>this.wi()).then(()=>this.ui()))}di(e){return!!e&&e.ownerId===this.clientId}hi(e){return this.zs?v.resolve(!0):bc(e).get("owner").next(n=>{if(n!==null&&this.mi(n.leaseTimestampMs,5e3)&&!this.pi(n.ownerId)){if(this.di(n)&&this.networkEnabled)return!0;if(!this.di(n)){if(!n.allowTabSynchronization)throw new S(w.FAILED_PRECONDITION,Zp);return!1}}return!(!this.networkEnabled||!this.inForeground)||sh(e).K().next(s=>this.gi(s,5e3).find(r=>{if(this.clientId!==r.clientId){const i=!this.networkEnabled&&r.networkEnabled,o=!this.inForeground&&r.inForeground,a=this.networkEnabled===r.networkEnabled;if(i||o&&a)return!0}return!1})===void 0)}).next(n=>(this.isPrimary!==n&&R("IndexedDbPersistence",`Client ${n?"is":"is not"} eligible for a primary lease.`),n))}async shutdown(){this.vs=!1,this.Ii(),this.Xs&&(this.Xs.cancel(),this.Xs=null),this.Ti(),this.Ei(),await this.ni.runTransaction("shutdown","readwrite",["owner","clientMetadata"],e=>{const n=new $m(e,yn.ot);return this.li(n).next(()=>this._i(n))}),this.ni.close(),this.Ai()}gi(e,n){return e.filter(s=>this.mi(s.updateTimeMs,n)&&!this.pi(s.clientId))}Ri(){return this.runTransaction("getActiveClients","readonly",e=>sh(e).K().next(n=>this.gi(n,18e5).map(s=>s.clientId)))}get started(){return this.vs}getMutationQueue(e,n){return Yf.se(e,this.wt,n,this.referenceDelegate)}getTargetCache(){return this.Vs}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new O4(e,this.wt.ne.databaseId)}getDocumentOverlayCache(e){return Qf.se(this.wt,e)}getBundleCache(){return this.Ds}runTransaction(e,n,s){R("IndexedDbPersistence","Starting transaction:",e);const r=n==="readonly"?"readonly":"readwrite",i=(o=this.Hs)===15?S4:o===14?$N:o===13?UN:o===12?T4:o===11?FN:void W();var o;let a;return this.ni.runTransaction(e,r,i,c=>(a=new $m(c,this.Ps?this.Ps.next():yn.ot),n==="readwrite-primary"?this.ai(a).next(l=>!!l||this.hi(a)).next(l=>{if(!l)throw ht(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.js.enqueueRetryable(()=>this.ti(!1)),new S(w.FAILED_PRECONDITION,JR);return s(a)}).next(l=>this.fi(a).next(()=>l)):this.bi(a).next(()=>s(a)))).then(c=>(a.raiseOnCommittedEvent(),c))}bi(e){return bc(e).get("owner").next(n=>{if(n!==null&&this.mi(n.leaseTimestampMs,5e3)&&!this.pi(n.ownerId)&&!this.di(n)&&!(this.zs||this.allowTabSynchronization&&n.allowTabSynchronization))throw new S(w.FAILED_PRECONDITION,Zp)})}fi(e){const n={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return bc(e).put("owner",n)}static V(){return rs.V()}li(e){const n=bc(e);return n.get("owner").next(s=>this.di(s)?(R("IndexedDbPersistence","Releasing primary lease."),n.delete("owner")):v.resolve())}mi(e,n){const s=Date.now();return!(e<s-n)&&(!(e>s)||(ht(`Detected an update time that is in the future: ${e} > ${s}`),!1))}ri(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Ys=()=>{this.js.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.ii()))},this.document.addEventListener("visibilitychange",this.Ys),this.inForeground=this.document.visibilityState==="visible")}Ti(){this.Ys&&(this.document.removeEventListener("visibilitychange",this.Ys),this.Ys=null)}oi(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.Js=()=>{this.Ii(),fL()&&navigator.appVersion.match(/Version\/1[45]/)&&this.js.enterRestrictedMode(!0),this.js.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Js))}Ei(){this.Js&&(this.window.removeEventListener("pagehide",this.Js),this.Js=null)}pi(e){var n;try{const s=((n=this.si)===null||n===void 0?void 0:n.getItem(this.yi(e)))!==null;return R("IndexedDbPersistence",`Client '${e}' ${s?"is":"is not"} zombied in LocalStorage`),s}catch(s){return ht("IndexedDbPersistence","Failed to get zombied client id.",s),!1}}Ii(){if(this.si)try{this.si.setItem(this.yi(this.clientId),String(Date.now()))}catch(e){ht("Failed to set zombie client id.",e)}}Ai(){if(this.si)try{this.si.removeItem(this.yi(this.clientId))}catch{}}yi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function bc(t){return Ot(t,"owner")}function sh(t){return Ot(t,"clientMetadata")}function kv(t,e){let n=t.projectId;return t.isDefaultDatabase||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rv{constructor(e,n,s,r){this.targetId=e,this.fromCache=n,this.Pi=s,this.vi=r}static Vi(e,n){let s=ue(),r=ue();for(const i of n.docChanges)switch(i.type){case 0:s=s.add(i.doc.key);break;case 1:r=r.add(i.doc.key)}return new Rv(e,n.fromCache,s,r)}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QN{constructor(){this.Si=!1}initialize(e,n){this.Di=e,this.indexManager=n,this.Si=!0}getDocumentsMatchingQuery(e,n,s,r){return this.Ci(e,n).next(i=>i||this.xi(e,n,r,s)).next(i=>i||this.Ni(e,n))}Ci(e,n){return v.resolve(null)}xi(e,n,s,r){return M2(n)||r.isEqual(se.min())?this.Ni(e,n):this.Di.getDocuments(e,s).next(i=>{const o=this.ki(n,i);return this.Oi(n,o,s,r)?this.Ni(e,n):(Dm()<=de.DEBUG&&R("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),Lm(n)),this.Mi(e,o,n,QR(r,-1)))})}ki(e,n){let s=new Ae(lN(e));return n.forEach((r,i)=>{yv(e,i)&&(s=s.add(i))}),s}Oi(e,n,s,r){if(e.limit===null)return!1;if(s.size!==n.size)return!0;const i=e.limitType==="F"?n.last():n.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)}Ni(e,n){return Dm()<=de.DEBUG&&R("QueryEngine","Using full collection scan to execute query:",Lm(n)),this.Di.getDocumentsMatchingQuery(e,n,On.min())}Mi(e,n,s,r){return this.Di.getDocumentsMatchingQuery(e,s,r).next(i=>(n.forEach(o=>{i=i.insert(o.key,o)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J4{constructor(e,n,s,r){this.persistence=e,this.Fi=n,this.wt=r,this.$i=new st(ce),this.Bi=new ui(i=>co(i),Au),this.Li=new Map,this.Ui=e.getRemoteDocumentCache(),this.Vs=e.getTargetCache(),this.Ds=e.getBundleCache(),this.qi(s)}qi(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new GN(this.Ui,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ui.setIndexManager(this.indexManager),this.Fi.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.$i))}}function YN(t,e,n,s){return new J4(t,e,n,s)}async function JN(t,e){const n=B(t);return await n.persistence.runTransaction("Handle user change","readonly",s=>{let r;return n.mutationQueue.getAllMutationBatches(s).next(i=>(r=i,n.qi(e),n.mutationQueue.getAllMutationBatches(s))).next(i=>{const o=[],a=[];let c=ue();for(const l of r){o.push(l.batchId);for(const u of l.mutations)c=c.add(u.key)}for(const l of i){a.push(l.batchId);for(const u of l.mutations)c=c.add(u.key)}return n.localDocuments.getDocuments(s,c).next(l=>({Ki:l,removedBatchIds:o,addedBatchIds:a}))})})}function X4(t,e){const n=B(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",s=>{const r=e.batch.keys(),i=n.Ui.newChangeBuffer({trackRemovals:!0});return function(o,a,c,l){const u=c.batch,h=u.keys();let d=v.resolve();return h.forEach(f=>{d=d.next(()=>l.getEntry(a,f)).next(p=>{const _=c.docVersions.get(f);re(_!==null),p.version.compareTo(_)<0&&(u.applyToRemoteDocument(p,c),p.isValidDocument()&&(p.setReadTime(c.commitVersion),l.addEntry(p)))})}),d.next(()=>o.mutationQueue.removeMutationBatch(a,u))}(n,s,e,i).next(()=>i.apply(s)).next(()=>n.mutationQueue.performConsistencyCheck(s)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(s,r,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(s,function(o){let a=ue();for(let c=0;c<o.mutationResults.length;++c)o.mutationResults[c].transformResults.length>0&&(a=a.add(o.batch.mutations[c].key));return a}(e))).next(()=>n.localDocuments.getDocuments(s,r))})}function XN(t){const e=B(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Vs.getLastRemoteSnapshotVersion(n))}function Z4(t,e){const n=B(t),s=e.snapshotVersion;let r=n.$i;return n.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const o=n.Ui.newChangeBuffer({trackRemovals:!0});r=n.$i;const a=[];e.targetChanges.forEach((u,h)=>{const d=r.get(h);if(!d)return;a.push(n.Vs.removeMatchingKeys(i,u.removedDocuments,h).next(()=>n.Vs.addMatchingKeys(i,u.addedDocuments,h)));let f=d.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.has(h)?f=f.withResumeToken(mt.EMPTY_BYTE_STRING,se.min()).withLastLimboFreeSnapshotVersion(se.min()):u.resumeToken.approximateByteSize()>0&&(f=f.withResumeToken(u.resumeToken,s)),r=r.insert(h,f),function(p,_,y){return p.resumeToken.approximateByteSize()===0||_.snapshotVersion.toMicroseconds()-p.snapshotVersion.toMicroseconds()>=3e8?!0:y.addedDocuments.size+y.modifiedDocuments.size+y.removedDocuments.size>0}(d,f,u)&&a.push(n.Vs.updateTargetData(i,f))});let c=vn(),l=ue();if(e.documentUpdates.forEach(u=>{e.resolvedLimboDocuments.has(u)&&a.push(n.persistence.referenceDelegate.updateLimboDocument(i,u))}),a.push(ZN(i,o,e.documentUpdates).next(u=>{c=u.Gi,l=u.Qi})),!s.isEqual(se.min())){const u=n.Vs.getLastRemoteSnapshotVersion(i).next(h=>n.Vs.setTargetsMetadata(i,i.currentSequenceNumber,s));a.push(u)}return v.waitFor(a).next(()=>o.apply(i)).next(()=>n.localDocuments.getLocalViewOfDocuments(i,c,l)).next(()=>c)}).then(i=>(n.$i=r,i))}function ZN(t,e,n){let s=ue(),r=ue();return n.forEach(i=>s=s.add(i)),e.getEntries(t,s).next(i=>{let o=vn();return n.forEach((a,c)=>{const l=i.get(a);c.isFoundDocument()!==l.isFoundDocument()&&(r=r.add(a)),c.isNoDocument()&&c.version.isEqual(se.min())?(e.removeEntry(a,c.readTime),o=o.insert(a,c)):!l.isValidDocument()||c.version.compareTo(l.version)>0||c.version.compareTo(l.version)===0&&l.hasPendingWrites?(e.addEntry(c),o=o.insert(a,c)):R("LocalStore","Ignoring outdated watch update for ",a,". Current version:",l.version," Watch version:",c.version)}),{Gi:o,Qi:r}})}function e6(t,e){const n=B(t);return n.persistence.runTransaction("Get next mutation batch","readonly",s=>(e===void 0&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(s,e)))}function ka(t,e){const n=B(t);return n.persistence.runTransaction("Allocate target","readwrite",s=>{let r;return n.Vs.getTargetData(s,e).next(i=>i?(r=i,v.resolve(r)):n.Vs.allocateTargetId(s).next(o=>(r=new Vr(e,o,0,s.currentSequenceNumber),n.Vs.addTargetData(s,r).next(()=>r))))}).then(s=>{const r=n.$i.get(s.targetId);return(r===null||s.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.$i=n.$i.insert(s.targetId,s),n.Bi.set(e,s.targetId)),s})}async function Ra(t,e,n){const s=B(t),r=s.$i.get(e),i=n?"readwrite":"readwrite-primary";try{n||await s.persistence.runTransaction("Release target",i,o=>s.persistence.referenceDelegate.removeTarget(o,r))}catch(o){if(!li(o))throw o;R("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}s.$i=s.$i.remove(e),s.Bi.delete(r.target)}function wd(t,e,n){const s=B(t);let r=se.min(),i=ue();return s.persistence.runTransaction("Execute query","readonly",o=>function(a,c,l){const u=B(a),h=u.Bi.get(l);return h!==void 0?v.resolve(u.$i.get(h)):u.Vs.getTargetData(c,l)}(s,o,zn(e)).next(a=>{if(a)return r=a.lastLimboFreeSnapshotVersion,s.Vs.getMatchingKeysForTargetId(o,a.targetId).next(c=>{i=c})}).next(()=>s.Fi.getDocumentsMatchingQuery(o,e,n?r:se.min(),n?i:ue())).next(a=>(nP(s,cN(e),a),{documents:a,ji:i})))}function eP(t,e){const n=B(t),s=B(n.Vs),r=n.$i.get(e);return r?Promise.resolve(r.target):n.persistence.runTransaction("Get target data","readonly",i=>s.te(i,e).next(o=>o?o.target:null))}function tP(t,e){const n=B(t),s=n.Li.get(e)||se.min();return n.persistence.runTransaction("Get new document changes","readonly",r=>n.Ui.getAllFromCollectionGroup(r,e,QR(s,-1),Number.MAX_SAFE_INTEGER)).then(r=>(nP(n,e,r),r))}function nP(t,e,n){let s=se.min();n.forEach((r,i)=>{i.readTime.compareTo(s)>0&&(s=i.readTime)}),t.Li.set(e,s)}async function t6(t,e,n,s){const r=B(t);let i=ue(),o=vn();for(const l of n){const u=e.Wi(l.metadata.name);l.document&&(i=i.add(u));const h=e.zi(l);h.setReadTime(e.Hi(l.metadata.readTime)),o=o.insert(u,h)}const a=r.Ui.newChangeBuffer({trackRemovals:!0}),c=await ka(r,function(l){return zn(Ja(we.fromString(`__bundle__/docs/${l}`)))}(s));return r.persistence.runTransaction("Apply bundle documents","readwrite",l=>ZN(l,a,o).next(u=>(a.apply(l),u)).next(u=>r.Vs.removeMatchingKeysForTargetId(l,c.targetId).next(()=>r.Vs.addMatchingKeys(l,i,c.targetId)).next(()=>r.localDocuments.getLocalViewOfDocuments(l,u.Gi,u.Qi)).next(()=>u.Gi)))}async function n6(t,e,n=ue()){const s=await ka(t,zn(Tv(e.bundledQuery))),r=B(t);return r.persistence.runTransaction("Save named query","readwrite",i=>{const o=Ct(e.readTime);if(s.snapshotVersion.compareTo(o)>=0)return r.Ds.saveNamedQuery(i,e);const a=s.withResumeToken(mt.EMPTY_BYTE_STRING,o);return r.$i=r.$i.insert(a.targetId,a),r.Vs.updateTargetData(i,a).next(()=>r.Vs.removeMatchingKeysForTargetId(i,s.targetId)).next(()=>r.Vs.addMatchingKeys(i,n,s.targetId)).next(()=>r.Ds.saveNamedQuery(i,e))})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eT(t,e){return`firestore_clients_${t}_${e}`}function tT(t,e,n){let s=`firestore_mutations_${t}_${n}`;return e.isAuthenticated()&&(s+=`_${e.uid}`),s}function eg(t,e){return`firestore_targets_${t}_${e}`}class bd{constructor(e,n,s,r){this.user=e,this.batchId=n,this.state=s,this.error=r}static Ji(e,n,s){const r=JSON.parse(s);let i,o=typeof r=="object"&&["pending","acknowledged","rejected"].indexOf(r.state)!==-1&&(r.error===void 0||typeof r.error=="object");return o&&r.error&&(o=typeof r.error.message=="string"&&typeof r.error.code=="string",o&&(i=new S(r.error.code,r.error.message))),o?new bd(e,n,r.state,i):(ht("SharedClientState",`Failed to parse mutation state for ID '${n}': ${s}`),null)}Yi(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Yc{constructor(e,n,s){this.targetId=e,this.state=n,this.error=s}static Ji(e,n){const s=JSON.parse(n);let r,i=typeof s=="object"&&["not-current","current","rejected"].indexOf(s.state)!==-1&&(s.error===void 0||typeof s.error=="object");return i&&s.error&&(i=typeof s.error.message=="string"&&typeof s.error.code=="string",i&&(r=new S(s.error.code,s.error.message))),i?new Yc(e,s.state,r):(ht("SharedClientState",`Failed to parse target state for ID '${e}': ${n}`),null)}Yi(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Id{constructor(e,n){this.clientId=e,this.activeTargetIds=n}static Ji(e,n){const s=JSON.parse(n);let r=typeof s=="object"&&s.activeTargetIds instanceof Array,i=zf();for(let o=0;r&&o<s.activeTargetIds.length;++o)r=tN(s.activeTargetIds[o]),i=i.add(s.activeTargetIds[o]);return r?new Id(e,i):(ht("SharedClientState",`Failed to parse client data for instance '${e}': ${n}`),null)}}class Nv{constructor(e,n){this.clientId=e,this.onlineState=n}static Ji(e){const n=JSON.parse(e);return typeof n=="object"&&["Unknown","Online","Offline"].indexOf(n.onlineState)!==-1&&typeof n.clientId=="string"?new Nv(n.clientId,n.onlineState):(ht("SharedClientState",`Failed to parse online state: ${e}`),null)}}class Vm{constructor(){this.activeTargetIds=zf()}Xi(e){this.activeTargetIds=this.activeTargetIds.add(e)}Zi(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Yi(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class tg{constructor(e,n,s,r,i){this.window=e,this.js=n,this.persistenceKey=s,this.tr=r,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.er=this.nr.bind(this),this.sr=new st(ce),this.started=!1,this.ir=[];const o=s.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.rr=eT(this.persistenceKey,this.tr),this.ur=function(a){return`firestore_sequence_number_${a}`}(this.persistenceKey),this.sr=this.sr.insert(this.tr,new Vm),this.cr=new RegExp(`^firestore_clients_${o}_([^_]*)$`),this.ar=new RegExp(`^firestore_mutations_${o}_(\\d+)(?:_(.*))?$`),this.hr=new RegExp(`^firestore_targets_${o}_(\\d+)$`),this.lr=function(a){return`firestore_online_state_${a}`}(this.persistenceKey),this.dr=function(a){return`firestore_bundle_loaded_v2_${a}`}(this.persistenceKey),this.window.addEventListener("storage",this.er)}static V(e){return!(!e||!e.localStorage)}async start(){const e=await this.syncEngine.Ri();for(const s of e){if(s===this.tr)continue;const r=this.getItem(eT(this.persistenceKey,s));if(r){const i=Id.Ji(s,r);i&&(this.sr=this.sr.insert(i.clientId,i))}}this._r();const n=this.storage.getItem(this.lr);if(n){const s=this.wr(n);s&&this.mr(s)}for(const s of this.ir)this.nr(s);this.ir=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0}writeSequenceNumber(e){this.setItem(this.ur,JSON.stringify(e))}getAllActiveQueryTargets(){return this.gr(this.sr)}isActiveQueryTarget(e){let n=!1;return this.sr.forEach((s,r)=>{r.activeTargetIds.has(e)&&(n=!0)}),n}addPendingMutation(e){this.yr(e,"pending")}updateMutationState(e,n,s){this.yr(e,n,s),this.pr(e)}addLocalQueryTarget(e){let n="not-current";if(this.isActiveQueryTarget(e)){const s=this.storage.getItem(eg(this.persistenceKey,e));if(s){const r=Yc.Ji(e,s);r&&(n=r.state)}}return this.Ir.Xi(e),this._r(),n}removeLocalQueryTarget(e){this.Ir.Zi(e),this._r()}isLocalQueryTarget(e){return this.Ir.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(eg(this.persistenceKey,e))}updateQueryState(e,n,s){this.Tr(e,n,s)}handleUserChange(e,n,s){n.forEach(r=>{this.pr(r)}),this.currentUser=e,s.forEach(r=>{this.addPendingMutation(r)})}setOnlineState(e){this.Er(e)}notifyBundleLoaded(e){this.Ar(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.er),this.removeItem(this.rr),this.started=!1)}getItem(e){const n=this.storage.getItem(e);return R("SharedClientState","READ",e,n),n}setItem(e,n){R("SharedClientState","SET",e,n),this.storage.setItem(e,n)}removeItem(e){R("SharedClientState","REMOVE",e),this.storage.removeItem(e)}nr(e){const n=e;if(n.storageArea===this.storage){if(R("SharedClientState","EVENT",n.key,n.newValue),n.key===this.rr)return void ht("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.js.enqueueRetryable(async()=>{if(this.started){if(n.key!==null){if(this.cr.test(n.key)){if(n.newValue==null){const s=this.Rr(n.key);return this.br(s,null)}{const s=this.Pr(n.key,n.newValue);if(s)return this.br(s.clientId,s)}}else if(this.ar.test(n.key)){if(n.newValue!==null){const s=this.vr(n.key,n.newValue);if(s)return this.Vr(s)}}else if(this.hr.test(n.key)){if(n.newValue!==null){const s=this.Sr(n.key,n.newValue);if(s)return this.Dr(s)}}else if(n.key===this.lr){if(n.newValue!==null){const s=this.wr(n.newValue);if(s)return this.mr(s)}}else if(n.key===this.ur){const s=function(r){let i=yn.ot;if(r!=null)try{const o=JSON.parse(r);re(typeof o=="number"),i=o}catch(o){ht("SharedClientState","Failed to read sequence number from WebStorage",o)}return i}(n.newValue);s!==yn.ot&&this.sequenceNumberHandler(s)}else if(n.key===this.dr){const s=this.Cr(n.newValue);await Promise.all(s.map(r=>this.syncEngine.Nr(r)))}}}else this.ir.push(n)})}}get Ir(){return this.sr.get(this.tr)}_r(){this.setItem(this.rr,this.Ir.Yi())}yr(e,n,s){const r=new bd(this.currentUser,e,n,s),i=tT(this.persistenceKey,this.currentUser,e);this.setItem(i,r.Yi())}pr(e){const n=tT(this.persistenceKey,this.currentUser,e);this.removeItem(n)}Er(e){const n={clientId:this.tr,onlineState:e};this.storage.setItem(this.lr,JSON.stringify(n))}Tr(e,n,s){const r=eg(this.persistenceKey,e),i=new Yc(e,n,s);this.setItem(r,i.Yi())}Ar(e){const n=JSON.stringify(Array.from(e));this.setItem(this.dr,n)}Rr(e){const n=this.cr.exec(e);return n?n[1]:null}Pr(e,n){const s=this.Rr(e);return Id.Ji(s,n)}vr(e,n){const s=this.ar.exec(e),r=Number(s[1]),i=s[2]!==void 0?s[2]:null;return bd.Ji(new It(i),r,n)}Sr(e,n){const s=this.hr.exec(e),r=Number(s[1]);return Yc.Ji(r,n)}wr(e){return Nv.Ji(e)}Cr(e){return JSON.parse(e)}async Vr(e){if(e.user.uid===this.currentUser.uid)return this.syncEngine.kr(e.batchId,e.state,e.error);R("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)}Dr(e){return this.syncEngine.Or(e.targetId,e.state,e.error)}br(e,n){const s=n?this.sr.insert(e,n):this.sr.remove(e),r=this.gr(this.sr),i=this.gr(s),o=[],a=[];return i.forEach(c=>{r.has(c)||o.push(c)}),r.forEach(c=>{i.has(c)||a.push(c)}),this.syncEngine.Mr(o,a).then(()=>{this.sr=s})}mr(e){this.sr.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}gr(e){let n=zf();return e.forEach((s,r)=>{n=n.unionWith(r.activeTargetIds)}),n}}class sP{constructor(){this.Fr=new Vm,this.$r={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,s){}addLocalQueryTarget(e){return this.Fr.Xi(e),this.$r[e]||"not-current"}updateQueryState(e,n,s){this.$r[e]=n}removeLocalQueryTarget(e){this.Fr.Zi(e)}isLocalQueryTarget(e){return this.Fr.activeTargetIds.has(e)}clearQueryState(e){delete this.$r[e]}getAllActiveQueryTargets(){return this.Fr.activeTargetIds}isActiveQueryTarget(e){return this.Fr.activeTargetIds.has(e)}start(){return this.Fr=new Vm,Promise.resolve()}handleUserChange(e,n,s){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s6{Br(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nT{constructor(){this.Lr=()=>this.Ur(),this.qr=()=>this.Kr(),this.Gr=[],this.Qr()}Br(e){this.Gr.push(e)}shutdown(){window.removeEventListener("online",this.Lr),window.removeEventListener("offline",this.qr)}Qr(){window.addEventListener("online",this.Lr),window.addEventListener("offline",this.qr)}Ur(){R("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.Gr)e(0)}Kr(){R("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.Gr)e(1)}static V(){return typeof window!="undefined"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const r6={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class i6{constructor(e){this.jr=e.jr,this.Wr=e.Wr}zr(e){this.Hr=e}Jr(e){this.Yr=e}onMessage(e){this.Xr=e}close(){this.Wr()}send(e){this.jr(e)}Zr(){this.Hr()}eo(e){this.Yr(e)}no(e){this.Xr(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class o6 extends class{constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const n=e.ssl?"https":"http";this.so=n+"://"+e.host,this.io="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}ro(e,n,s,r,i){const o=this.oo(e,n);R("RestConnection","Sending: ",o,s);const a={};return this.uo(a,r,i),this.co(e,o,a,s).then(c=>(R("RestConnection","Received: ",c),c),c=>{throw Fl("RestConnection",`${e} failed with error: `,c,"url: ",o,"request:",s),c})}ao(e,n,s,r,i,o){return this.ro(e,n,s,r,i)}uo(e,n,s){e["X-Goog-Api-Client"]="gl-js/ fire/"+Ya,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((r,i)=>e[i]=r),s&&s.headers.forEach((r,i)=>e[i]=r)}oo(e,n){const s=r6[e];return`${this.so}/v1/${n}:${s}`}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams}co(e,n,s,r){return new Promise((i,o)=>{const a=new s2;a.listenOnce(e2.COMPLETE,()=>{try{switch(a.getLastErrorCode()){case Jp.NO_ERROR:const l=a.getResponseJson();R("Connection","XHR received:",JSON.stringify(l)),i(l);break;case Jp.TIMEOUT:R("Connection",'RPC "'+e+'" timed out'),o(new S(w.DEADLINE_EXCEEDED,"Request time out"));break;case Jp.HTTP_ERROR:const u=a.getStatus();if(R("Connection",'RPC "'+e+'" failed with status:',u,"response text:",a.getResponseText()),u>0){const h=a.getResponseJson().error;if(h&&h.status&&h.message){const d=function(f){const p=f.toLowerCase().replace(/_/g,"-");return Object.values(w).indexOf(p)>=0?p:w.UNKNOWN}(h.status);o(new S(d,h.message))}else o(new S(w.UNKNOWN,"Server responded with status "+a.getStatus()))}else o(new S(w.UNAVAILABLE,"Connection failed."));break;default:W()}}finally{R("Connection",'RPC "'+e+'" completed.')}});const c=JSON.stringify(r);a.send(n,"POST",c,s,15)})}ho(e,n,s){const r=[this.so,"/","google.firestore.v1.Firestore","/",e,"/channel"],i=Xz(),o=Zz(),a={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.useFetchStreams&&(a.xmlHttpFactory=new n2({})),this.uo(a.initMessageHeaders,n,s),Gd()||tu()||hL()||A_()||dL()||eu()||(a.httpHeadersOverwriteParam="$httpHeaders");const c=r.join("");R("Connection","Creating WebChannel: "+c,a);const l=i.createWebChannel(c,a);let u=!1,h=!1;const d=new i6({jr:p=>{h?R("Connection","Not sending because WebChannel is closed:",p):(u||(R("Connection","Opening WebChannel transport."),l.open(),u=!0),R("Connection","WebChannel sending:",p),l.send(p))},Wr:()=>l.close()}),f=(p,_,y)=>{p.listen(_,I=>{try{y(I)}catch(N){setTimeout(()=>{throw N},0)}})};return f(l,Xu.EventType.OPEN,()=>{h||R("Connection","WebChannel transport opened.")}),f(l,Xu.EventType.CLOSE,()=>{h||(h=!0,R("Connection","WebChannel transport closed"),d.eo())}),f(l,Xu.EventType.ERROR,p=>{h||(h=!0,Fl("Connection","WebChannel transport errored:",p),d.eo(new S(w.UNAVAILABLE,"The operation could not be completed")))}),f(l,Xu.EventType.MESSAGE,p=>{var _;if(!h){const y=p.data[0];re(!!y);const I=y,N=I.error||((_=I[0])===null||_===void 0?void 0:_.error);if(N){R("Connection","WebChannel received error:",N);const k=N.status;let M=function(Y){const z=ut[Y];if(z!==void 0)return wN(z)}(k),j=N.message;M===void 0&&(M=w.INTERNAL,j="Unknown error status: "+k+" with message "+N.message),h=!0,d.eo(new S(M,j)),l.close()}else R("Connection","WebChannel received:",y),d.no(y)}}),f(o,t2.STAT_EVENT,p=>{p.stat===fE.PROXY?R("Connection","Detected buffering proxy"):p.stat===fE.NOPROXY&&R("Connection","Detected no buffering proxy")}),setTimeout(()=>{d.Zr()},0),d}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rP(){return typeof window!="undefined"?window:null}function Eh(){return typeof document!="undefined"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Du(t){return new J2(t,!0)}class Pv{constructor(e,n,s=1e3,r=1.5,i=6e4){this.js=e,this.timerId=n,this.lo=s,this.fo=r,this._o=i,this.wo=0,this.mo=null,this.yo=Date.now(),this.reset()}reset(){this.wo=0}po(){this.wo=this._o}Io(e){this.cancel();const n=Math.floor(this.wo+this.To()),s=Math.max(0,Date.now()-this.yo),r=Math.max(0,n-s);r>0&&R("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.wo} ms, delay with jitter: ${n} ms, last attempt: ${s} ms ago)`),this.mo=this.js.enqueueAfterDelay(this.timerId,r,()=>(this.yo=Date.now(),e())),this.wo*=this.fo,this.wo<this.lo&&(this.wo=this.lo),this.wo>this._o&&(this.wo=this._o)}Eo(){this.mo!==null&&(this.mo.skipDelay(),this.mo=null)}cancel(){this.mo!==null&&(this.mo.cancel(),this.mo=null)}To(){return(Math.random()-.5)*this.wo}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iP{constructor(e,n,s,r,i,o,a,c){this.js=e,this.Ao=s,this.Ro=r,this.bo=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=c,this.state=0,this.Po=0,this.vo=null,this.Vo=null,this.stream=null,this.So=new Pv(e,n)}Do(){return this.state===1||this.state===5||this.Co()}Co(){return this.state===2||this.state===3}start(){this.state!==4?this.auth():this.xo()}async stop(){this.Do()&&await this.close(0)}No(){this.state=0,this.So.reset()}ko(){this.Co()&&this.vo===null&&(this.vo=this.js.enqueueAfterDelay(this.Ao,6e4,()=>this.Oo()))}Mo(e){this.Fo(),this.stream.send(e)}async Oo(){if(this.Co())return this.close(0)}Fo(){this.vo&&(this.vo.cancel(),this.vo=null)}$o(){this.Vo&&(this.Vo.cancel(),this.Vo=null)}async close(e,n){this.Fo(),this.$o(),this.So.cancel(),this.Po++,e!==4?this.So.reset():n&&n.code===w.RESOURCE_EXHAUSTED?(ht(n.toString()),ht("Using maximum backoff delay to prevent overloading the backend."),this.So.po()):n&&n.code===w.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.Bo(),this.stream.close(),this.stream=null),this.state=e,await this.listener.Jr(n)}Bo(){}auth(){this.state=1;const e=this.Lo(this.Po),n=this.Po;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([s,r])=>{this.Po===n&&this.Uo(s,r)},s=>{e(()=>{const r=new S(w.UNKNOWN,"Fetching auth token failed: "+s.message);return this.qo(r)})})}Uo(e,n){const s=this.Lo(this.Po);this.stream=this.Ko(e,n),this.stream.zr(()=>{s(()=>(this.state=2,this.Vo=this.js.enqueueAfterDelay(this.Ro,1e4,()=>(this.Co()&&(this.state=3),Promise.resolve())),this.listener.zr()))}),this.stream.Jr(r=>{s(()=>this.qo(r))}),this.stream.onMessage(r=>{s(()=>this.onMessage(r))})}xo(){this.state=5,this.So.Io(async()=>{this.state=0,this.start()})}qo(e){return R("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}Lo(e){return n=>{this.js.enqueueAndForget(()=>this.Po===e?n():(R("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class a6 extends iP{constructor(e,n,s,r,i,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,s,r,o),this.wt=i}Ko(e,n){return this.bo.ho("Listen",e,n)}onMessage(e){this.So.reset();const n=e4(this.wt,e),s=function(r){if(!("targetChange"in r))return se.min();const i=r.targetChange;return i.targetIds&&i.targetIds.length?se.min():i.readTime?Ct(i.readTime):se.min()}(e);return this.listener.Go(n,s)}Qo(e){const n={};n.database=Wl(this.wt),n.addTarget=function(r,i){let o;const a=i.target;return o=md(a)?{documents:PN(r,a)}:{query:DN(r,a)},o.targetId=i.targetId,i.resumeToken.approximateByteSize()>0?o.resumeToken=CN(r,i.resumeToken):i.snapshotVersion.compareTo(se.min())>0&&(o.readTime=jl(r,i.snapshotVersion.toTimestamp())),o}(this.wt,e);const s=n4(this.wt,e);s&&(n.labels=s),this.Mo(n)}jo(e){const n={};n.database=Wl(this.wt),n.removeTarget=e,this.Mo(n)}}class c6 extends iP{constructor(e,n,s,r,i,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,s,r,o),this.wt=i,this.Wo=!1}get zo(){return this.Wo}start(){this.Wo=!1,this.lastStreamToken=void 0,super.start()}Bo(){this.Wo&&this.Ho([])}Ko(e,n){return this.bo.ho("Write",e,n)}onMessage(e){if(re(!!e.streamToken),this.lastStreamToken=e.streamToken,this.Wo){this.So.reset();const n=t4(e.writeResults,e.commitTime),s=Ct(e.commitTime);return this.listener.Jo(s,n)}return re(!e.writeResults||e.writeResults.length===0),this.Wo=!0,this.listener.Yo()}Xo(){const e={};e.database=Wl(this.wt),this.Mo(e)}Ho(e){const n={streamToken:this.lastStreamToken,writes:e.map(s=>Hl(this.wt,s))};this.Mo(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l6 extends class{}{constructor(e,n,s,r){super(),this.authCredentials=e,this.appCheckCredentials=n,this.bo=s,this.wt=r,this.Zo=!1}tu(){if(this.Zo)throw new S(w.FAILED_PRECONDITION,"The client has already been terminated.")}ro(e,n,s){return this.tu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([r,i])=>this.bo.ro(e,n,s,r,i)).catch(r=>{throw r.name==="FirebaseError"?(r.code===w.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),r):new S(w.UNKNOWN,r.toString())})}ao(e,n,s,r){return this.tu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.bo.ao(e,n,s,i,o,r)).catch(i=>{throw i.name==="FirebaseError"?(i.code===w.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new S(w.UNKNOWN,i.toString())})}terminate(){this.Zo=!0}}class u6{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.eu=0,this.nu=null,this.su=!0}iu(){this.eu===0&&(this.ru("Unknown"),this.nu=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.nu=null,this.ou("Backend didn't respond within 10 seconds."),this.ru("Offline"),Promise.resolve())))}uu(e){this.state==="Online"?this.ru("Unknown"):(this.eu++,this.eu>=1&&(this.cu(),this.ou(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ru("Offline")))}set(e){this.cu(),this.eu=0,e==="Online"&&(this.su=!1),this.ru(e)}ru(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}ou(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.su?(ht(n),this.su=!1):R("OnlineStateTracker",n)}cu(){this.nu!==null&&(this.nu.cancel(),this.nu=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h6{constructor(e,n,s,r,i){this.localStore=e,this.datastore=n,this.asyncQueue=s,this.remoteSyncer={},this.au=[],this.hu=new Map,this.lu=new Set,this.fu=[],this.du=i,this.du.Br(o=>{s.enqueueAndForget(async()=>{hi(this)&&(R("RemoteStore","Restarting streams for network reachability change."),await async function(a){const c=B(a);c.lu.add(4),await ec(c),c._u.set("Unknown"),c.lu.delete(4),await xu(c)}(this))})}),this._u=new u6(s,r)}}async function xu(t){if(hi(t))for(const e of t.fu)await e(!0)}async function ec(t){for(const e of t.fu)await e(!1)}function Xf(t,e){const n=B(t);n.hu.has(e.targetId)||(n.hu.set(e.targetId,e),Ov(n)?xv(n):nc(n).Co()&&Dv(n,e))}function Gl(t,e){const n=B(t),s=nc(n);n.hu.delete(e),s.Co()&&oP(n,e),n.hu.size===0&&(s.Co()?s.ko():hi(n)&&n._u.set("Unknown"))}function Dv(t,e){t.wu.Nt(e.targetId),nc(t).Qo(e)}function oP(t,e){t.wu.Nt(e),nc(t).jo(e)}function xv(t){t.wu=new z2({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),te:e=>t.hu.get(e)||null}),nc(t).start(),t._u.iu()}function Ov(t){return hi(t)&&!nc(t).Do()&&t.hu.size>0}function hi(t){return B(t).lu.size===0}function aP(t){t.wu=void 0}async function d6(t){t.hu.forEach((e,n)=>{Dv(t,e)})}async function f6(t,e){aP(t),Ov(t)?(t._u.uu(e),xv(t)):t._u.set("Unknown")}async function p6(t,e,n){if(t._u.set("Online"),e instanceof SN&&e.state===2&&e.cause)try{await async function(s,r){const i=r.cause;for(const o of r.targetIds)s.hu.has(o)&&(await s.remoteSyncer.rejectListen(o,i),s.hu.delete(o),s.wu.removeTarget(o))}(t,e)}catch(s){R("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),s),await Ed(t,s)}else if(e instanceof bh?t.wu.Ut(e):e instanceof TN?t.wu.zt(e):t.wu.Gt(e),!n.isEqual(se.min()))try{const s=await XN(t.localStore);n.compareTo(s)>=0&&await function(r,i){const o=r.wu.Yt(i);return o.targetChanges.forEach((a,c)=>{if(a.resumeToken.approximateByteSize()>0){const l=r.hu.get(c);l&&r.hu.set(c,l.withResumeToken(a.resumeToken,i))}}),o.targetMismatches.forEach(a=>{const c=r.hu.get(a);if(!c)return;r.hu.set(a,c.withResumeToken(mt.EMPTY_BYTE_STRING,c.snapshotVersion)),oP(r,a);const l=new Vr(c.target,a,1,c.sequenceNumber);Dv(r,l)}),r.remoteSyncer.applyRemoteEvent(o)}(t,n)}catch(s){R("RemoteStore","Failed to raise snapshot:",s),await Ed(t,s)}}async function Ed(t,e,n){if(!li(e))throw e;t.lu.add(1),await ec(t),t._u.set("Offline"),n||(n=()=>XN(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{R("RemoteStore","Retrying IndexedDB access"),await n(),t.lu.delete(1),await xu(t)})}function cP(t,e){return e().catch(n=>Ed(t,n,e))}async function tc(t){const e=B(t),n=ti(e);let s=e.au.length>0?e.au[e.au.length-1].batchId:-1;for(;g6(e);)try{const r=await e6(e.localStore,s);if(r===null){e.au.length===0&&n.ko();break}s=r.batchId,m6(e,r)}catch(r){await Ed(e,r)}lP(e)&&uP(e)}function g6(t){return hi(t)&&t.au.length<10}function m6(t,e){t.au.push(e);const n=ti(t);n.Co()&&n.zo&&n.Ho(e.mutations)}function lP(t){return hi(t)&&!ti(t).Do()&&t.au.length>0}function uP(t){ti(t).start()}async function _6(t){ti(t).Xo()}async function y6(t){const e=ti(t);for(const n of t.au)e.Ho(n.mutations)}async function v6(t,e,n){const s=t.au.shift(),r=Iv.from(s,e,n);await cP(t,()=>t.remoteSyncer.applySuccessfulWrite(r)),await tc(t)}async function w6(t,e){e&&ti(t).zo&&await async function(n,s){if(r=s.code,vN(r)&&r!==w.ABORTED){const i=n.au.shift();ti(n).No(),await cP(n,()=>n.remoteSyncer.rejectFailedWrite(i.batchId,s)),await tc(n)}var r}(t,e),lP(t)&&uP(t)}async function sT(t,e){const n=B(t);n.asyncQueue.verifyOperationInProgress(),R("RemoteStore","RemoteStore received new credentials");const s=hi(n);n.lu.add(3),await ec(n),s&&n._u.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.lu.delete(3),await xu(n)}async function Bm(t,e){const n=B(t);e?(n.lu.delete(2),await xu(n)):e||(n.lu.add(2),await ec(n),n._u.set("Unknown"))}function nc(t){return t.mu||(t.mu=function(e,n,s){const r=B(e);return r.tu(),new a6(n,r.bo,r.authCredentials,r.appCheckCredentials,r.wt,s)}(t.datastore,t.asyncQueue,{zr:d6.bind(null,t),Jr:f6.bind(null,t),Go:p6.bind(null,t)}),t.fu.push(async e=>{e?(t.mu.No(),Ov(t)?xv(t):t._u.set("Unknown")):(await t.mu.stop(),aP(t))})),t.mu}function ti(t){return t.gu||(t.gu=function(e,n,s){const r=B(e);return r.tu(),new c6(n,r.bo,r.authCredentials,r.appCheckCredentials,r.wt,s)}(t.datastore,t.asyncQueue,{zr:_6.bind(null,t),Jr:w6.bind(null,t),Yo:y6.bind(null,t),Jo:v6.bind(null,t)}),t.fu.push(async e=>{e?(t.gu.No(),await tc(t)):(await t.gu.stop(),t.au.length>0&&(R("RemoteStore",`Stopping write stream with ${t.au.length} pending writes`),t.au=[]))})),t.gu}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mv{constructor(e,n,s,r,i){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=s,this.op=r,this.removalCallback=i,this.deferred=new St,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}static createAndSchedule(e,n,s,r,i){const o=Date.now()+s,a=new Mv(e,n,o,r,i);return a.start(s),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new S(w.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function sc(t,e){if(ht("AsyncQueue",`${e}: ${t}`),li(t))return new S(w.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ia{constructor(e){this.comparator=e?(n,s)=>e(n,s)||F.comparator(n.key,s.key):(n,s)=>F.comparator(n.key,s.key),this.keyedMap=kc(),this.sortedSet=new st(this.comparator)}static emptySet(e){return new ia(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,s)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof ia)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),s=e.sortedSet.getIterator();for(;n.hasNext();){const r=n.getNext().key,i=s.getNext().key;if(!r.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const s=new ia;return s.comparator=this.comparator,s.keyedMap=e,s.sortedSet=n,s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rT{constructor(){this.yu=new st(F.comparator)}track(e){const n=e.doc.key,s=this.yu.get(n);s?e.type!==0&&s.type===3?this.yu=this.yu.insert(n,e):e.type===3&&s.type!==1?this.yu=this.yu.insert(n,{type:s.type,doc:e.doc}):e.type===2&&s.type===2?this.yu=this.yu.insert(n,{type:2,doc:e.doc}):e.type===2&&s.type===0?this.yu=this.yu.insert(n,{type:0,doc:e.doc}):e.type===1&&s.type===0?this.yu=this.yu.remove(n):e.type===1&&s.type===2?this.yu=this.yu.insert(n,{type:1,doc:s.doc}):e.type===0&&s.type===1?this.yu=this.yu.insert(n,{type:2,doc:e.doc}):W():this.yu=this.yu.insert(n,e)}pu(){const e=[];return this.yu.inorderTraversal((n,s)=>{e.push(s)}),e}}class Na{constructor(e,n,s,r,i,o,a,c){this.query=e,this.docs=n,this.oldDocs=s,this.docChanges=r,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=c}static fromInitialDocuments(e,n,s,r){const i=[];return n.forEach(o=>{i.push({type:0,doc:o})}),new Na(e,n,ia.emptySet(n),i,s,r,!0,!1)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&ku(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,s=e.docChanges;if(n.length!==s.length)return!1;for(let r=0;r<n.length;r++)if(n[r].type!==s[r].type||!n[r].doc.isEqual(s[r].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b6{constructor(){this.Iu=void 0,this.listeners=[]}}class I6{constructor(){this.queries=new ui(e=>aN(e),ku),this.onlineState="Unknown",this.Tu=new Set}}async function Lv(t,e){const n=B(t),s=e.query;let r=!1,i=n.queries.get(s);if(i||(r=!0,i=new b6),r)try{i.Iu=await n.onListen(s)}catch(o){const a=sc(o,`Initialization of query '${Lm(e.query)}' failed`);return void e.onError(a)}n.queries.set(s,i),i.listeners.push(e),e.Eu(n.onlineState),i.Iu&&e.Au(i.Iu)&&Uv(n)}async function Fv(t,e){const n=B(t),s=e.query;let r=!1;const i=n.queries.get(s);if(i){const o=i.listeners.indexOf(e);o>=0&&(i.listeners.splice(o,1),r=i.listeners.length===0)}if(r)return n.queries.delete(s),n.onUnlisten(s)}function E6(t,e){const n=B(t);let s=!1;for(const r of e){const i=r.query,o=n.queries.get(i);if(o){for(const a of o.listeners)a.Au(r)&&(s=!0);o.Iu=r}}s&&Uv(n)}function T6(t,e,n){const s=B(t),r=s.queries.get(e);if(r)for(const i of r.listeners)i.onError(n);s.queries.delete(e)}function Uv(t){t.Tu.forEach(e=>{e.next()})}class $v{constructor(e,n,s){this.query=e,this.Ru=n,this.bu=!1,this.Pu=null,this.onlineState="Unknown",this.options=s||{}}Au(e){if(!this.options.includeMetadataChanges){const s=[];for(const r of e.docChanges)r.type!==3&&s.push(r);e=new Na(e.query,e.docs,e.oldDocs,s,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0)}let n=!1;return this.bu?this.vu(e)&&(this.Ru.next(e),n=!0):this.Vu(e,this.onlineState)&&(this.Su(e),n=!0),this.Pu=e,n}onError(e){this.Ru.error(e)}Eu(e){this.onlineState=e;let n=!1;return this.Pu&&!this.bu&&this.Vu(this.Pu,e)&&(this.Su(this.Pu),n=!0),n}Vu(e,n){if(!e.fromCache)return!0;const s=n!=="Offline";return(!this.options.Du||!s)&&(!e.docs.isEmpty()||n==="Offline")}vu(e){if(e.docChanges.length>0)return!0;const n=this.Pu&&this.Pu.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}Su(e){e=Na.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache),this.bu=!0,this.Ru.next(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S6{constructor(e,n){this.payload=e,this.byteLength=n}Cu(){return"metadata"in this.payload}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iT{constructor(e){this.wt=e}Wi(e){return ks(this.wt,e)}zi(e){return e.metadata.exists?NN(this.wt,e.document,!1):Be.newNoDocument(this.Wi(e.metadata.name),this.Hi(e.metadata.readTime))}Hi(e){return Ct(e)}}class C6{constructor(e,n,s){this.xu=e,this.localStore=n,this.wt=s,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=hP(e)}Nu(e){this.progress.bytesLoaded+=e.byteLength;let n=this.progress.documentsLoaded;if(e.payload.namedQuery)this.queries.push(e.payload.namedQuery);else if(e.payload.documentMetadata){this.documents.push({metadata:e.payload.documentMetadata}),e.payload.documentMetadata.exists||++n;const s=we.fromString(e.payload.documentMetadata.name);this.collectionGroups.add(s.get(s.length-2))}else e.payload.document&&(this.documents[this.documents.length-1].document=e.payload.document,++n);return n!==this.progress.documentsLoaded?(this.progress.documentsLoaded=n,Object.assign({},this.progress)):null}ku(e){const n=new Map,s=new iT(this.wt);for(const r of e)if(r.metadata.queries){const i=s.Wi(r.metadata.name);for(const o of r.metadata.queries){const a=(n.get(o)||ue()).add(i);n.set(o,a)}}return n}async complete(){const e=await t6(this.localStore,new iT(this.wt),this.documents,this.xu.id),n=this.ku(this.documents);for(const s of this.queries)await n6(this.localStore,s,n.get(s.name));return this.progress.taskState="Success",{progress:this.progress,Ou:this.collectionGroups,Mu:e}}}function hP(t){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:t.totalDocuments,totalBytes:t.totalBytes}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dP{constructor(e){this.key=e}}class fP{constructor(e){this.key=e}}class pP{constructor(e,n){this.query=e,this.Fu=n,this.$u=null,this.current=!1,this.Bu=ue(),this.mutatedKeys=ue(),this.Lu=lN(e),this.Uu=new ia(this.Lu)}get qu(){return this.Fu}Ku(e,n){const s=n?n.Gu:new rT,r=n?n.Uu:this.Uu;let i=n?n.mutatedKeys:this.mutatedKeys,o=r,a=!1;const c=this.query.limitType==="F"&&r.size===this.query.limit?r.last():null,l=this.query.limitType==="L"&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal((u,h)=>{const d=r.get(u),f=yv(this.query,h)?h:null,p=!!d&&this.mutatedKeys.has(d.key),_=!!f&&(f.hasLocalMutations||this.mutatedKeys.has(f.key)&&f.hasCommittedMutations);let y=!1;d&&f?d.data.isEqual(f.data)?p!==_&&(s.track({type:3,doc:f}),y=!0):this.Qu(d,f)||(s.track({type:2,doc:f}),y=!0,(c&&this.Lu(f,c)>0||l&&this.Lu(f,l)<0)&&(a=!0)):!d&&f?(s.track({type:0,doc:f}),y=!0):d&&!f&&(s.track({type:1,doc:d}),y=!0,(c||l)&&(a=!0)),y&&(f?(o=o.add(f),i=_?i.add(u):i.delete(u)):(o=o.delete(u),i=i.delete(u)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const u=this.query.limitType==="F"?o.last():o.first();o=o.delete(u.key),i=i.delete(u.key),s.track({type:1,doc:u})}return{Uu:o,Gu:s,Oi:a,mutatedKeys:i}}Qu(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,s){const r=this.Uu;this.Uu=e.Uu,this.mutatedKeys=e.mutatedKeys;const i=e.Gu.pu();i.sort((l,u)=>function(h,d){const f=p=>{switch(p){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return W()}};return f(h)-f(d)}(l.type,u.type)||this.Lu(l.doc,u.doc)),this.ju(s);const o=n?this.Wu():[],a=this.Bu.size===0&&this.current?1:0,c=a!==this.$u;return this.$u=a,i.length!==0||c?{snapshot:new Na(this.query,e.Uu,r,i,e.mutatedKeys,a===0,c,!1),zu:o}:{zu:o}}Eu(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Uu:this.Uu,Gu:new rT,mutatedKeys:this.mutatedKeys,Oi:!1},!1)):{zu:[]}}Hu(e){return!this.Fu.has(e)&&!!this.Uu.has(e)&&!this.Uu.get(e).hasLocalMutations}ju(e){e&&(e.addedDocuments.forEach(n=>this.Fu=this.Fu.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Fu=this.Fu.delete(n)),this.current=e.current)}Wu(){if(!this.current)return[];const e=this.Bu;this.Bu=ue(),this.Uu.forEach(s=>{this.Hu(s.key)&&(this.Bu=this.Bu.add(s.key))});const n=[];return e.forEach(s=>{this.Bu.has(s)||n.push(new fP(s))}),this.Bu.forEach(s=>{e.has(s)||n.push(new dP(s))}),n}Ju(e){this.Fu=e.ji,this.Bu=ue();const n=this.Ku(e.documents);return this.applyChanges(n,!0)}Yu(){return Na.fromInitialDocuments(this.query,this.Uu,this.mutatedKeys,this.$u===0)}}class A6{constructor(e,n,s){this.query=e,this.targetId=n,this.view=s}}class k6{constructor(e){this.key=e,this.Xu=!1}}class R6{constructor(e,n,s,r,i,o){this.localStore=e,this.remoteStore=n,this.eventManager=s,this.sharedClientState=r,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.Zu={},this.tc=new ui(a=>aN(a),ku),this.ec=new Map,this.nc=new Set,this.sc=new st(F.comparator),this.ic=new Map,this.rc=new Cv,this.oc={},this.uc=new Map,this.cc=po.Rn(),this.onlineState="Unknown",this.ac=void 0}get isPrimaryClient(){return this.ac===!0}}async function N6(t,e){const n=Kv(t);let s,r;const i=n.tc.get(e);if(i)s=i.targetId,n.sharedClientState.addLocalQueryTarget(s),r=i.view.Yu();else{const o=await ka(n.localStore,zn(e));n.isPrimaryClient&&Xf(n.remoteStore,o);const a=n.sharedClientState.addLocalQueryTarget(o.targetId);s=o.targetId,r=await Vv(n,e,s,a==="current")}return r}async function Vv(t,e,n,s){t.hc=(u,h,d)=>async function(f,p,_,y){let I=p.view.Ku(_);I.Oi&&(I=await wd(f.localStore,p.query,!1).then(({documents:M})=>p.view.Ku(M,I)));const N=y&&y.targetChanges.get(p.targetId),k=p.view.applyChanges(I,f.isPrimaryClient,N);return qm(f,p.targetId,k.zu),k.snapshot}(t,u,h,d);const r=await wd(t.localStore,e,!0),i=new pP(e,r.ji),o=i.Ku(r.documents),a=Pu.createSynthesizedTargetChangeForCurrentChange(n,s&&t.onlineState!=="Offline"),c=i.applyChanges(o,t.isPrimaryClient,a);qm(t,n,c.zu);const l=new A6(e,n,i);return t.tc.set(e,l),t.ec.has(n)?t.ec.get(n).push(e):t.ec.set(n,[e]),c.snapshot}async function P6(t,e){const n=B(t),s=n.tc.get(e),r=n.ec.get(s.targetId);if(r.length>1)return n.ec.set(s.targetId,r.filter(i=>!ku(i,e))),void n.tc.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(s.targetId),n.sharedClientState.isActiveQueryTarget(s.targetId)||await Ra(n.localStore,s.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(s.targetId),Gl(n.remoteStore,s.targetId),Pa(n,s.targetId)}).catch(ci)):(Pa(n,s.targetId),await Ra(n.localStore,s.targetId,!0))}async function D6(t,e,n){const s=Wv(t);try{const r=await function(i,o){const a=B(i),c=ze.now(),l=o.reduce((d,f)=>d.add(f.key),ue());let u,h;return a.persistence.runTransaction("Locally write mutations","readwrite",d=>{let f=vn(),p=ue();return a.Ui.getEntries(d,l).next(_=>{f=_,f.forEach((y,I)=>{I.isValidDocument()||(p=p.add(y))})}).next(()=>a.localDocuments.getOverlayedDocuments(d,f)).next(_=>{u=_;const y=[];for(const I of o){const N=q2(I,u.get(I.key).overlayedDocument);N!=null&&y.push(new fr(I.key,N,sN(N.value.mapValue),Ye.exists(!0)))}return a.mutationQueue.addMutationBatch(d,c,y,o)}).next(_=>{h=_;const y=_.applyToLocalDocumentSet(u,p);return a.documentOverlayCache.saveOverlays(d,_.batchId,y)})}).then(()=>({batchId:h.batchId,changes:IN(u)}))}(s.localStore,e);s.sharedClientState.addPendingMutation(r.batchId),function(i,o,a){let c=i.oc[i.currentUser.toKey()];c||(c=new st(ce)),c=c.insert(o,a),i.oc[i.currentUser.toKey()]=c}(s,r.batchId,n),await pr(s,r.changes),await tc(s.remoteStore)}catch(r){const i=sc(r,"Failed to persist write");n.reject(i)}}async function gP(t,e){const n=B(t);try{const s=await Z4(n.localStore,e);e.targetChanges.forEach((r,i)=>{const o=n.ic.get(i);o&&(re(r.addedDocuments.size+r.modifiedDocuments.size+r.removedDocuments.size<=1),r.addedDocuments.size>0?o.Xu=!0:r.modifiedDocuments.size>0?re(o.Xu):r.removedDocuments.size>0&&(re(o.Xu),o.Xu=!1))}),await pr(n,s,e)}catch(s){await ci(s)}}function oT(t,e,n){const s=B(t);if(s.isPrimaryClient&&n===0||!s.isPrimaryClient&&n===1){const r=[];s.tc.forEach((i,o)=>{const a=o.view.Eu(e);a.snapshot&&r.push(a.snapshot)}),function(i,o){const a=B(i);a.onlineState=o;let c=!1;a.queries.forEach((l,u)=>{for(const h of u.listeners)h.Eu(o)&&(c=!0)}),c&&Uv(a)}(s.eventManager,e),r.length&&s.Zu.Go(r),s.onlineState=e,s.isPrimaryClient&&s.sharedClientState.setOnlineState(e)}}async function x6(t,e,n){const s=B(t);s.sharedClientState.updateQueryState(e,"rejected",n);const r=s.ic.get(e),i=r&&r.key;if(i){let o=new st(F.comparator);o=o.insert(i,Be.newNoDocument(i,se.min()));const a=ue().add(i),c=new Nu(se.min(),new Map,new Ae(ce),o,a);await gP(s,c),s.sc=s.sc.remove(i),s.ic.delete(e),jv(s)}else await Ra(s.localStore,e,!1).then(()=>Pa(s,e,n)).catch(ci)}async function O6(t,e){const n=B(t),s=e.batch.batchId;try{const r=await X4(n.localStore,e);qv(n,s,null),Bv(n,s),n.sharedClientState.updateMutationState(s,"acknowledged"),await pr(n,r)}catch(r){await ci(r)}}async function M6(t,e,n){const s=B(t);try{const r=await function(i,o){const a=B(i);return a.persistence.runTransaction("Reject batch","readwrite-primary",c=>{let l;return a.mutationQueue.lookupMutationBatch(c,o).next(u=>(re(u!==null),l=u.keys(),a.mutationQueue.removeMutationBatch(c,u))).next(()=>a.mutationQueue.performConsistencyCheck(c)).next(()=>a.documentOverlayCache.removeOverlaysForBatchId(c,l,o)).next(()=>a.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(c,l)).next(()=>a.localDocuments.getDocuments(c,l))})}(s.localStore,e);qv(s,e,n),Bv(s,e),s.sharedClientState.updateMutationState(e,"rejected",n),await pr(s,r)}catch(r){await ci(r)}}async function L6(t,e){const n=B(t);hi(n.remoteStore)||R("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{const s=await function(i){const o=B(i);return o.persistence.runTransaction("Get highest unacknowledged batch id","readonly",a=>o.mutationQueue.getHighestUnacknowledgedBatchId(a))}(n.localStore);if(s===-1)return void e.resolve();const r=n.uc.get(s)||[];r.push(e),n.uc.set(s,r)}catch(s){const r=sc(s,"Initialization of waitForPendingWrites() operation failed");e.reject(r)}}function Bv(t,e){(t.uc.get(e)||[]).forEach(n=>{n.resolve()}),t.uc.delete(e)}function qv(t,e,n){const s=B(t);let r=s.oc[s.currentUser.toKey()];if(r){const i=r.get(e);i&&(n?i.reject(n):i.resolve(),r=r.remove(e)),s.oc[s.currentUser.toKey()]=r}}function Pa(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const s of t.ec.get(e))t.tc.delete(s),n&&t.Zu.lc(s,n);t.ec.delete(e),t.isPrimaryClient&&t.rc.us(e).forEach(s=>{t.rc.containsKey(s)||mP(t,s)})}function mP(t,e){t.nc.delete(e.path.canonicalString());const n=t.sc.get(e);n!==null&&(Gl(t.remoteStore,n),t.sc=t.sc.remove(e),t.ic.delete(n),jv(t))}function qm(t,e,n){for(const s of n)s instanceof dP?(t.rc.addReference(s.key,e),F6(t,s)):s instanceof fP?(R("SyncEngine","Document no longer in limbo: "+s.key),t.rc.removeReference(s.key,e),t.rc.containsKey(s.key)||mP(t,s.key)):W()}function F6(t,e){const n=e.key,s=n.path.canonicalString();t.sc.get(n)||t.nc.has(s)||(R("SyncEngine","New document in limbo: "+n),t.nc.add(s),jv(t))}function jv(t){for(;t.nc.size>0&&t.sc.size<t.maxConcurrentLimboResolutions;){const e=t.nc.values().next().value;t.nc.delete(e);const n=new F(we.fromString(e)),s=t.cc.next();t.ic.set(s,new k6(n)),t.sc=t.sc.insert(n,s),Xf(t.remoteStore,new Vr(zn(Ja(n.path)),s,2,yn.ot))}}async function pr(t,e,n){const s=B(t),r=[],i=[],o=[];s.tc.isEmpty()||(s.tc.forEach((a,c)=>{o.push(s.hc(c,e,n).then(l=>{if(l){s.isPrimaryClient&&s.sharedClientState.updateQueryState(c.targetId,l.fromCache?"not-current":"current"),r.push(l);const u=Rv.Vi(c.targetId,l);i.push(u)}}))}),await Promise.all(o),s.Zu.Go(r),await async function(a,c){const l=B(a);try{await l.persistence.runTransaction("notifyLocalViewChanges","readwrite",u=>v.forEach(c,h=>v.forEach(h.Pi,d=>l.persistence.referenceDelegate.addReference(u,h.targetId,d)).next(()=>v.forEach(h.vi,d=>l.persistence.referenceDelegate.removeReference(u,h.targetId,d)))))}catch(u){if(!li(u))throw u;R("LocalStore","Failed to update sequence numbers: "+u)}for(const u of c){const h=u.targetId;if(!u.fromCache){const d=l.$i.get(h),f=d.snapshotVersion,p=d.withLastLimboFreeSnapshotVersion(f);l.$i=l.$i.insert(h,p)}}}(s.localStore,i))}async function U6(t,e){const n=B(t);if(!n.currentUser.isEqual(e)){R("SyncEngine","User change. New user:",e.toKey());const s=await JN(n.localStore,e);n.currentUser=e,function(r,i){r.uc.forEach(o=>{o.forEach(a=>{a.reject(new S(w.CANCELLED,i))})}),r.uc.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,s.removedBatchIds,s.addedBatchIds),await pr(n,s.Ki)}}function $6(t,e){const n=B(t),s=n.ic.get(e);if(s&&s.Xu)return ue().add(s.key);{let r=ue();const i=n.ec.get(e);if(!i)return r;for(const o of i){const a=n.tc.get(o);r=r.unionWith(a.view.qu)}return r}}async function V6(t,e){const n=B(t),s=await wd(n.localStore,e.query,!0),r=e.view.Ju(s);return n.isPrimaryClient&&qm(n,e.targetId,r.zu),r}async function B6(t,e){const n=B(t);return tP(n.localStore,e).then(s=>pr(n,s))}async function q6(t,e,n,s){const r=B(t),i=await function(o,a){const c=B(o),l=B(c.mutationQueue);return c.persistence.runTransaction("Lookup mutation documents","readonly",u=>l.yn(u,a).next(h=>h?c.localDocuments.getDocuments(u,h):v.resolve(null)))}(r.localStore,e);i!==null?(n==="pending"?await tc(r.remoteStore):n==="acknowledged"||n==="rejected"?(qv(r,e,s||null),Bv(r,e),function(o,a){B(B(o).mutationQueue).In(a)}(r.localStore,e)):W(),await pr(r,i)):R("SyncEngine","Cannot apply mutation batch with id: "+e)}async function j6(t,e){const n=B(t);if(Kv(n),Wv(n),e===!0&&n.ac!==!0){const s=n.sharedClientState.getAllActiveQueryTargets(),r=await aT(n,s.toArray());n.ac=!0,await Bm(n.remoteStore,!0);for(const i of r)Xf(n.remoteStore,i)}else if(e===!1&&n.ac!==!1){const s=[];let r=Promise.resolve();n.ec.forEach((i,o)=>{n.sharedClientState.isLocalQueryTarget(o)?s.push(o):r=r.then(()=>(Pa(n,o),Ra(n.localStore,o,!0))),Gl(n.remoteStore,o)}),await r,await aT(n,s),function(i){const o=B(i);o.ic.forEach((a,c)=>{Gl(o.remoteStore,c)}),o.rc.cs(),o.ic=new Map,o.sc=new st(F.comparator)}(n),n.ac=!1,await Bm(n.remoteStore,!1)}}async function aT(t,e,n){const s=B(t),r=[],i=[];for(const o of e){let a;const c=s.ec.get(o);if(c&&c.length!==0){a=await ka(s.localStore,zn(c[0]));for(const l of c){const u=s.tc.get(l),h=await V6(s,u);h.snapshot&&i.push(h.snapshot)}}else{const l=await eP(s.localStore,o);a=await ka(s.localStore,l),await Vv(s,_P(l),o,!1)}r.push(a)}return s.Zu.Go(i),r}function _P(t){return iN(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function K6(t){const e=B(t);return B(B(e.localStore).persistence).Ri()}async function W6(t,e,n,s){const r=B(t);if(r.ac)return void R("SyncEngine","Ignoring unexpected query state notification.");const i=r.ec.get(e);if(i&&i.length>0)switch(n){case"current":case"not-current":{const o=await tP(r.localStore,cN(i[0])),a=Nu.createSynthesizedRemoteEventForCurrentChange(e,n==="current");await pr(r,o,a);break}case"rejected":await Ra(r.localStore,e,!0),Pa(r,e,s);break;default:W()}}async function H6(t,e,n){const s=Kv(t);if(s.ac){for(const r of e){if(s.ec.has(r)){R("SyncEngine","Adding an already active target "+r);continue}const i=await eP(s.localStore,r),o=await ka(s.localStore,i);await Vv(s,_P(i),o.targetId,!1),Xf(s.remoteStore,o)}for(const r of n)s.ec.has(r)&&await Ra(s.localStore,r,!1).then(()=>{Gl(s.remoteStore,r),Pa(s,r)}).catch(ci)}}function Kv(t){const e=B(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=gP.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=$6.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=x6.bind(null,e),e.Zu.Go=E6.bind(null,e.eventManager),e.Zu.lc=T6.bind(null,e.eventManager),e}function Wv(t){const e=B(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=O6.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=M6.bind(null,e),e}function G6(t,e,n){const s=B(t);(async function(r,i,o){try{const a=await i.getMetadata();if(await function(h,d){const f=B(h),p=Ct(d.createTime);return f.persistence.runTransaction("hasNewerBundle","readonly",_=>f.Ds.getBundleMetadata(_,d.id)).then(_=>!!_&&_.createTime.compareTo(p)>=0)}(r.localStore,a))return await i.close(),o._completeWith(function(h){return{taskState:"Success",documentsLoaded:h.totalDocuments,bytesLoaded:h.totalBytes,totalDocuments:h.totalDocuments,totalBytes:h.totalBytes}}(a)),Promise.resolve(new Set);o._updateProgress(hP(a));const c=new C6(a,r.localStore,i.wt);let l=await i.fc();for(;l;){const h=await c.Nu(l);h&&o._updateProgress(h),l=await i.fc()}const u=await c.complete();return await pr(r,u.Mu,void 0),await function(h,d){const f=B(h);return f.persistence.runTransaction("Save bundle","readwrite",p=>f.Ds.saveBundleMetadata(p,d))}(r.localStore,a),o._completeWith(u.progress),Promise.resolve(u.Ou)}catch(a){return Fl("SyncEngine",`Loading bundle failed with ${a}`),o._failWith(a),Promise.resolve(new Set)}})(s,e,n).then(r=>{s.sharedClientState.notifyBundleLoaded(r)})}class yP{constructor(){this.synchronizeTabs=!1}async initialize(e){this.wt=Du(e.databaseInfo.databaseId),this.sharedClientState=this.dc(e),this.persistence=this._c(e),await this.persistence.start(),this.localStore=this.wc(e),this.gcScheduler=this.mc(e,this.localStore),this.indexBackfillerScheduler=this.gc(e,this.localStore)}mc(e,n){return null}gc(e,n){return null}wc(e){return YN(this.persistence,new QN,e.initialUser,this.wt)}_c(e){return new zN(Jf.Ms,this.wt)}dc(e){return new sP}async terminate(){this.gcScheduler&&this.gcScheduler.stop(),await this.sharedClientState.shutdown(),await this.persistence.shutdown()}}class vP extends yP{constructor(e,n,s){super(),this.yc=e,this.cacheSizeBytes=n,this.forceOwnership=s,this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.yc.initialize(this,e),await Wv(this.yc.syncEngine),await tc(this.yc.remoteStore),await this.persistence.ci(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}wc(e){return YN(this.persistence,new QN,e.initialUser,this.wt)}mc(e,n){const s=this.persistence.referenceDelegate.garbageCollector;return new F4(s,e.asyncQueue,n)}gc(e,n){const s=new v2(n,this.persistence);return new y2(e.asyncQueue,s)}_c(e){const n=kv(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),s=this.cacheSizeBytes!==void 0?gn.withCacheSize(this.cacheSizeBytes):gn.DEFAULT;return new Av(this.synchronizeTabs,n,e.clientId,s,e.asyncQueue,rP(),Eh(),this.wt,this.sharedClientState,!!this.forceOwnership)}dc(e){return new sP}}class z6 extends vP{constructor(e,n){super(e,n,!1),this.yc=e,this.cacheSizeBytes=n,this.synchronizeTabs=!0}async initialize(e){await super.initialize(e);const n=this.yc.syncEngine;this.sharedClientState instanceof tg&&(this.sharedClientState.syncEngine={kr:q6.bind(null,n),Or:W6.bind(null,n),Mr:H6.bind(null,n),Ri:K6.bind(null,n),Nr:B6.bind(null,n)},await this.sharedClientState.start()),await this.persistence.ci(async s=>{await j6(this.yc.syncEngine,s),this.gcScheduler&&(s&&!this.gcScheduler.started?this.gcScheduler.start():s||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(s&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():s||this.indexBackfillerScheduler.stop())})}dc(e){const n=rP();if(!tg.V(n))throw new S(w.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const s=kv(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new tg(n,e.asyncQueue,s,e.clientId,e.initialUser)}}class Hv{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=s=>oT(this.syncEngine,s,1),this.remoteStore.remoteSyncer.handleCredentialChange=U6.bind(null,this.syncEngine),await Bm(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return new I6}createDatastore(e){const n=Du(e.databaseInfo.databaseId),s=(r=e.databaseInfo,new o6(r));var r;return function(i,o,a,c){return new l6(i,o,a,c)}(e.authCredentials,e.appCheckCredentials,s,n)}createRemoteStore(e){return n=this.localStore,s=this.datastore,r=e.asyncQueue,i=a=>oT(this.syncEngine,a,0),o=nT.V()?new nT:new s6,new h6(n,s,r,i,o);var n,s,r,i,o}createSyncEngine(e,n){return function(s,r,i,o,a,c,l){const u=new R6(s,r,i,o,a,c);return l&&(u.ac=!0),u}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}terminate(){return async function(e){const n=B(e);R("RemoteStore","RemoteStore shutting down."),n.lu.add(5),await ec(n),n.du.shutdown(),n._u.set("Unknown")}(this.remoteStore)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cT(t,e=10240){let n=0;return{async read(){if(n<t.byteLength){const s={value:t.slice(n,n+e),done:!1};return n+=e,s}return{done:!0}},async cancel(){},releaseLock(){},closed:Promise.reject("unimplemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zf{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Ic(this.observer.next,e)}error(e){this.observer.error?this.Ic(this.observer.error,e):console.error("Uncaught Error in snapshot listener:",e)}Tc(){this.muted=!0}Ic(e,n){this.muted||setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q6{constructor(e,n){this.Ec=e,this.wt=n,this.metadata=new St,this.buffer=new Uint8Array,this.Ac=new TextDecoder("utf-8"),this.Rc().then(s=>{s&&s.Cu()?this.metadata.resolve(s.payload.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(s==null?void 0:s.payload)}`))},s=>this.metadata.reject(s))}close(){return this.Ec.cancel()}async getMetadata(){return this.metadata.promise}async fc(){return await this.getMetadata(),this.Rc()}async Rc(){const e=await this.bc();if(e===null)return null;const n=this.Ac.decode(e),s=Number(n);isNaN(s)&&this.Pc(`length string (${n}) is not valid number`);const r=await this.vc(s);return new S6(JSON.parse(r),e.length+s)}Vc(){return this.buffer.findIndex(e=>e==="{".charCodeAt(0))}async bc(){for(;this.Vc()<0&&!await this.Sc(););if(this.buffer.length===0)return null;const e=this.Vc();e<0&&this.Pc("Reached the end of bundle when a length string is expected.");const n=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),n}async vc(e){for(;this.buffer.length<e;)await this.Sc()&&this.Pc("Reached the end of bundle when more is expected.");const n=this.Ac.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),n}Pc(e){throw this.Ec.cancel(),new Error(`Invalid bundle format: ${e}`)}async Sc(){const e=await this.Ec.read();if(!e.done){const n=new Uint8Array(this.buffer.length+e.value.length);n.set(this.buffer),n.set(e.value,this.buffer.length),this.buffer=n}return e.done}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y6{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastWriteError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw new S(w.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");const n=await async function(s,r){const i=B(s),o=Wl(i.wt)+"/documents",a={documents:r.map(h=>Kl(i.wt,h))},c=await i.ao("BatchGetDocuments",o,a,r.length),l=new Map;c.forEach(h=>{const d=Z2(i.wt,h);l.set(d.key.toString(),d)});const u=[];return r.forEach(h=>{const d=l.get(h.toString());re(!!d),u.push(d)}),u}(this.datastore,e);return n.forEach(s=>this.recordVersion(s)),n}set(e,n){this.write(n.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,n){try{this.write(n.toMutation(e,this.preconditionForUpdate(e)))}catch(s){this.lastWriteError=s}this.writtenDocs.add(e.toString())}delete(e){this.write(new Za(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastWriteError)throw this.lastWriteError;const e=this.readVersions;this.mutations.forEach(n=>{e.delete(n.key.toString())}),e.forEach((n,s)=>{const r=F.fromPath(s);this.mutations.push(new vv(r,this.precondition(r)))}),await async function(n,s){const r=B(n),i=Wl(r.wt)+"/documents",o={writes:s.map(a=>Hl(r.wt,a))};await r.ro("Commit",i,o)}(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let n;if(e.isFoundDocument())n=e.version;else{if(!e.isNoDocument())throw W();n=se.min()}const s=this.readVersions.get(e.key.toString());if(s){if(!n.isEqual(s))throw new S(w.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),n)}precondition(e){const n=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&n?Ye.updateTime(n):Ye.none()}preconditionForUpdate(e){const n=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&n){if(n.isEqual(se.min()))throw new S(w.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Ye.updateTime(n)}return Ye.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J6{constructor(e,n,s,r,i){this.asyncQueue=e,this.datastore=n,this.options=s,this.updateFunction=r,this.deferred=i,this.Dc=s.maxAttempts,this.So=new Pv(this.asyncQueue,"transaction_retry")}run(){this.Dc-=1,this.Cc()}Cc(){this.So.Io(async()=>{const e=new Y6(this.datastore),n=this.xc(e);n&&n.then(s=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(s)}).catch(r=>{this.Nc(r)}))}).catch(s=>{this.Nc(s)})})}xc(e){try{const n=this.updateFunction(e);return!Cu(n)&&n.catch&&n.then?n:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(n){return this.deferred.reject(n),null}}Nc(e){this.Dc>0&&this.kc(e)?(this.Dc-=1,this.asyncQueue.enqueueAndForget(()=>(this.Cc(),Promise.resolve()))):this.deferred.reject(e)}kc(e){if(e.name==="FirebaseError"){const n=e.code;return n==="aborted"||n==="failed-precondition"||!vN(n)}return!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X6{constructor(e,n,s,r){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=s,this.databaseInfo=r,this.user=It.UNAUTHENTICATED,this.clientId=HR.I(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(s,async i=>{R("FirestoreClient","Received user=",i.uid),await this.authCredentialListener(i),this.user=i}),this.appCheckCredentials.start(s,i=>(R("FirestoreClient","Received new app check token=",i),this.appCheckCredentialListener(i,this.user)))}async getConfiguration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new S(w.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();const e=new St;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this.onlineComponents&&await this.onlineComponents.terminate(),this.offlineComponents&&await this.offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const s=sc(n,"Failed to shutdown persistence");e.reject(s)}}),e.promise}}async function wP(t,e){t.asyncQueue.verifyOperationInProgress(),R("FirestoreClient","Initializing OfflineComponentProvider");const n=await t.getConfiguration();await e.initialize(n);let s=n.initialUser;t.setCredentialChangeListener(async r=>{s.isEqual(r)||(await JN(e.localStore,r),s=r)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t.offlineComponents=e}async function bP(t,e){t.asyncQueue.verifyOperationInProgress();const n=await Gv(t);R("FirestoreClient","Initializing OnlineComponentProvider");const s=await t.getConfiguration();await e.initialize(n,s),t.setCredentialChangeListener(r=>sT(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,i)=>sT(e.remoteStore,i)),t.onlineComponents=e}async function Gv(t){return t.offlineComponents||(R("FirestoreClient","Using default OfflineComponentProvider"),await wP(t,new yP)),t.offlineComponents}async function ep(t){return t.onlineComponents||(R("FirestoreClient","Using default OnlineComponentProvider"),await bP(t,new Hv)),t.onlineComponents}function IP(t){return Gv(t).then(e=>e.persistence)}function zv(t){return Gv(t).then(e=>e.localStore)}function EP(t){return ep(t).then(e=>e.remoteStore)}function Qv(t){return ep(t).then(e=>e.syncEngine)}async function Da(t){const e=await ep(t),n=e.eventManager;return n.onListen=N6.bind(null,e.syncEngine),n.onUnlisten=P6.bind(null,e.syncEngine),n}function Z6(t){return t.asyncQueue.enqueue(async()=>{const e=await IP(t),n=await EP(t);return e.setNetworkEnabled(!0),function(s){const r=B(s);return r.lu.delete(0),xu(r)}(n)})}function eQ(t){return t.asyncQueue.enqueue(async()=>{const e=await IP(t),n=await EP(t);return e.setNetworkEnabled(!1),async function(s){const r=B(s);r.lu.add(0),await ec(r),r._u.set("Offline")}(n)})}function tQ(t,e){const n=new St;return t.asyncQueue.enqueueAndForget(async()=>async function(s,r,i){try{const o=await function(a,c){const l=B(a);return l.persistence.runTransaction("read document","readonly",u=>l.localDocuments.getDocument(u,c))}(s,r);o.isFoundDocument()?i.resolve(o):o.isNoDocument()?i.resolve(null):i.reject(new S(w.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(o){const a=sc(o,`Failed to get document '${r} from cache`);i.reject(a)}}(await zv(t),e,n)),n.promise}function TP(t,e,n={}){const s=new St;return t.asyncQueue.enqueueAndForget(async()=>function(r,i,o,a,c){const l=new Zf({next:h=>{i.enqueueAndForget(()=>Fv(r,u));const d=h.docs.has(o);!d&&h.fromCache?c.reject(new S(w.UNAVAILABLE,"Failed to get document because the client is offline.")):d&&h.fromCache&&a&&a.source==="server"?c.reject(new S(w.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):c.resolve(h)},error:h=>c.reject(h)}),u=new $v(Ja(o.path),l,{includeMetadataChanges:!0,Du:!0});return Lv(r,u)}(await Da(t),t.asyncQueue,e,n,s)),s.promise}function nQ(t,e){const n=new St;return t.asyncQueue.enqueueAndForget(async()=>async function(s,r,i){try{const o=await wd(s,r,!0),a=new pP(r,o.ji),c=a.Ku(o.documents),l=a.applyChanges(c,!1);i.resolve(l.snapshot)}catch(o){const a=sc(o,`Failed to execute query '${r} against cache`);i.reject(a)}}(await zv(t),e,n)),n.promise}function SP(t,e,n={}){const s=new St;return t.asyncQueue.enqueueAndForget(async()=>function(r,i,o,a,c){const l=new Zf({next:h=>{i.enqueueAndForget(()=>Fv(r,u)),h.fromCache&&a.source==="server"?c.reject(new S(w.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):c.resolve(h)},error:h=>c.reject(h)}),u=new $v(o,l,{includeMetadataChanges:!0,Du:!0});return Lv(r,u)}(await Da(t),t.asyncQueue,e,n,s)),s.promise}function sQ(t,e){const n=new Zf(e);return t.asyncQueue.enqueueAndForget(async()=>function(s,r){B(s).Tu.add(r),r.next()}(await Da(t),n)),()=>{n.Tc(),t.asyncQueue.enqueueAndForget(async()=>function(s,r){B(s).Tu.delete(r)}(await Da(t),n))}}function rQ(t,e,n){const s=new St;return t.asyncQueue.enqueueAndForget(async()=>{const r=await function(i){return ep(i).then(o=>o.datastore)}(t);new J6(t.asyncQueue,r,n,e,s).run()}),s.promise}function iQ(t,e,n,s){const r=function(i,o){let a;return a=typeof i=="string"?new TextEncoder().encode(i):i,function(c,l){return new Q6(c,l)}(function(c,l){if(c instanceof Uint8Array)return cT(c,l);if(c instanceof ArrayBuffer)return cT(new Uint8Array(c),l);if(c instanceof ReadableStream)return c.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(a),o)}(n,Du(e));t.asyncQueue.enqueueAndForget(async()=>{G6(await Qv(t),r,s)})}function oQ(t,e){return t.asyncQueue.enqueue(async()=>function(n,s){const r=B(n);return r.persistence.runTransaction("Get named query","readonly",i=>r.Ds.getNamedQuery(i,s))}(await zv(t),e))}const lT=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yv(t,e,n){if(!n)throw new S(w.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function CP(t,e,n,s){if(e===!0&&s===!0)throw new S(w.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function uT(t){if(!F.isDocumentKey(t))throw new S(w.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function hT(t){if(F.isDocumentKey(t))throw new S(w.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function tp(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(n){return n.constructor?n.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":W()}function Ie(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new S(w.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=tp(t);throw new S(w.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}function AP(t,e){if(e<=0)throw new S(w.INVALID_ARGUMENT,`Function ${t}() requires a positive number, but it was: ${e}.`)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dT{constructor(e){var n;if(e.host===void 0){if(e.ssl!==void 0)throw new S(w.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(n=e.ssl)===null||n===void 0||n;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new S(w.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.useFetchStreams=!!e.useFetchStreams,CP("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling)}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ou{constructor(e,n,s){this._authCredentials=n,this._appCheckCredentials=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new dT({}),this._settingsFrozen=!1,e instanceof ar?this._databaseId=e:(this._app=e,this._databaseId=function(r){if(!Object.prototype.hasOwnProperty.apply(r.options,["projectId"]))throw new S(w.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new ar(r.options.projectId)}(e))}get app(){if(!this._app)throw new S(w.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!==void 0}_setSettings(e){if(this._settingsFrozen)throw new S(w.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new dT(e),e.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new o2;switch(n.type){case"gapi":const s=n.client;return re(!(typeof s!="object"||s===null||!s.auth||!s.auth.getAuthHeaderValueForFirstParty)),new u2(s,n.sessionIndex||"0",n.iamToken||null);case"provider":return n.client;default:throw new S(w.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const n=lT.get(e);n&&(R("ComponentProvider","Removing Datastore"),lT.delete(e),n.terminate())}(this),Promise.resolve()}}function aQ(t,e,n,s={}){var r;const i=(t=Ie(t,Ou))._getSettings();if(i.host!=="firestore.googleapis.com"&&i.host!==e&&Fl("Host has been set in both settings() and useEmulator(), emulator host will be used"),t._setSettings(Object.assign(Object.assign({},i),{host:`${e}:${n}`,ssl:!1})),s.mockUserToken){let o,a;if(typeof s.mockUserToken=="string")o=s.mockUserToken,a=It.MOCK_USER;else{o=S_(s.mockUserToken,(r=t._app)===null||r===void 0?void 0:r.options.projectId);const c=s.mockUserToken.sub||s.mockUserToken.user_id;if(!c)throw new S(w.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");a=new It(c)}t._authCredentials=new a2(new WR(o,a))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ke{constructor(e,n,s){this.converter=n,this._key=s,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Rs(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Ke(this.firestore,e,this._key)}}class Xt{constructor(e,n,s){this.converter=n,this._query=s,this.type="query",this.firestore=e}withConverter(e){return new Xt(this.firestore,e,this._query)}}class Rs extends Xt{constructor(e,n,s){super(e,n,Ja(s)),this._path=s,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Ke(this.firestore,null,new F(e))}withConverter(e){return new Rs(this.firestore,e,this._path)}}function kP(t,e,...n){if(t=A(t),Yv("collection","path",e),t instanceof Ou){const s=we.fromString(e,...n);return hT(s),new Rs(t,null,s)}{if(!(t instanceof Ke||t instanceof Rs))throw new S(w.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const s=t._path.child(we.fromString(e,...n));return hT(s),new Rs(t.firestore,null,s)}}function cQ(t,e){if(t=Ie(t,Ou),Yv("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new S(w.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new Xt(t,null,function(n){return new dr(we.emptyPath(),n)}(e))}function Td(t,e,...n){if(t=A(t),arguments.length===1&&(e=HR.I()),Yv("doc","path",e),t instanceof Ou){const s=we.fromString(e,...n);return uT(s),new Ke(t,null,new F(s))}{if(!(t instanceof Ke||t instanceof Rs))throw new S(w.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const s=t._path.child(we.fromString(e,...n));return uT(s),new Ke(t.firestore,t instanceof Rs?t.converter:null,new F(s))}}function RP(t,e){return t=A(t),e=A(e),(t instanceof Ke||t instanceof Rs)&&(e instanceof Ke||e instanceof Rs)&&t.firestore===e.firestore&&t.path===e.path&&t.converter===e.converter}function NP(t,e){return t=A(t),e=A(e),t instanceof Xt&&e instanceof Xt&&t.firestore===e.firestore&&ku(t._query,e._query)&&t.converter===e.converter}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lQ{constructor(){this.Oc=Promise.resolve(),this.Mc=[],this.Fc=!1,this.$c=[],this.Bc=null,this.Lc=!1,this.Uc=!1,this.qc=[],this.So=new Pv(this,"async_queue_retry"),this.Kc=()=>{const n=Eh();n&&R("AsyncQueue","Visibility state changed to "+n.visibilityState),this.So.Eo()};const e=Eh();e&&typeof e.addEventListener=="function"&&e.addEventListener("visibilitychange",this.Kc)}get isShuttingDown(){return this.Fc}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.Gc(),this.Qc(e)}enterRestrictedMode(e){if(!this.Fc){this.Fc=!0,this.Uc=e||!1;const n=Eh();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.Kc)}}enqueue(e){if(this.Gc(),this.Fc)return new Promise(()=>{});const n=new St;return this.Qc(()=>this.Fc&&this.Uc?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Mc.push(e),this.jc()))}async jc(){if(this.Mc.length!==0){try{await this.Mc[0](),this.Mc.shift(),this.So.reset()}catch(e){if(!li(e))throw e;R("AsyncQueue","Operation failed with retryable error: "+e)}this.Mc.length>0&&this.So.Io(()=>this.jc())}}Qc(e){const n=this.Oc.then(()=>(this.Lc=!0,e().catch(s=>{this.Bc=s,this.Lc=!1;const r=function(i){let o=i.message||"";return i.stack&&(o=i.stack.includes(i.message)?i.stack:i.message+`
`+i.stack),o}(s);throw ht("INTERNAL UNHANDLED ERROR: ",r),s}).then(s=>(this.Lc=!1,s))));return this.Oc=n,n}enqueueAfterDelay(e,n,s){this.Gc(),this.qc.indexOf(e)>-1&&(n=0);const r=Mv.createAndSchedule(this,e,n,s,i=>this.Wc(i));return this.$c.push(r),r}Gc(){this.Bc&&W()}verifyOperationInProgress(){}async zc(){let e;do e=this.Oc,await e;while(e!==this.Oc)}Hc(e){for(const n of this.$c)if(n.timerId===e)return!0;return!1}Jc(e){return this.zc().then(()=>{this.$c.sort((n,s)=>n.targetTimeMs-s.targetTimeMs);for(const n of this.$c)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.zc()})}Yc(e){this.qc.push(e)}Wc(e){const n=this.$c.indexOf(e);this.$c.splice(n,1)}}function jm(t){return function(e,n){if(typeof e!="object"||e===null)return!1;const s=e;for(const r of n)if(r in s&&typeof s[r]=="function")return!0;return!1}(t,["next","error","complete"])}class uQ{constructor(){this._progressObserver={},this._taskCompletionResolver=new St,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,n,s){this._progressObserver={next:e,error:n,complete:s}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,n){return this._taskCompletionResolver.promise.then(e,n)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hQ=-1;class rt extends Ou{constructor(e,n,s){super(e,n,s),this.type="firestore",this._queue=new lQ,this._persistenceKey="name"in e?e.name:"[DEFAULT]"}_terminate(){return this._firestoreClient||PP(this),this._firestoreClient.terminate()}}function Mt(t){return t._firestoreClient||PP(t),t._firestoreClient.verifyNotTerminated(),t._firestoreClient}function PP(t){var e;const n=t._freezeSettings(),s=function(r,i,o,a){return new I2(r,i,o,a.host,a.ssl,a.experimentalForceLongPolling,a.experimentalAutoDetectLongPolling,a.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,n);t._firestoreClient=new X6(t._authCredentials,t._appCheckCredentials,t._queue,s)}function dQ(t,e){xP(t=Ie(t,rt));const n=Mt(t),s=t._freezeSettings(),r=new Hv;return DP(n,r,new vP(r,s.cacheSizeBytes,e==null?void 0:e.forceOwnership))}function fQ(t){xP(t=Ie(t,rt));const e=Mt(t),n=t._freezeSettings(),s=new Hv;return DP(e,s,new z6(s,n.cacheSizeBytes))}function DP(t,e,n){const s=new St;return t.asyncQueue.enqueue(async()=>{try{await wP(t,n),await bP(t,e),s.resolve()}catch(r){const i=r;if(!function(o){return o.name==="FirebaseError"?o.code===w.FAILED_PRECONDITION||o.code===w.UNIMPLEMENTED:typeof DOMException!="undefined"&&o instanceof DOMException?o.code===22||o.code===20||o.code===11:!0}(i))throw i;console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+i),s.reject(i)}}).then(()=>s.promise)}function pQ(t){if(t._initialized&&!t._terminated)throw new S(w.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");const e=new St;return t._queue.enqueueAndForgetEvenWhileRestricted(async()=>{try{await async function(n){if(!rs.V())return Promise.resolve();const s=n+"main";await rs.delete(s)}(kv(t._databaseId,t._persistenceKey)),e.resolve()}catch(n){e.reject(n)}}),e.promise}function gQ(t){return function(e){const n=new St;return e.asyncQueue.enqueueAndForget(async()=>L6(await Qv(e),n)),n.promise}(Mt(t=Ie(t,rt)))}function mQ(t){return Z6(Mt(t=Ie(t,rt)))}function _Q(t){return eQ(Mt(t=Ie(t,rt)))}function yQ(t,e){const n=Mt(t=Ie(t,rt)),s=new uQ;return iQ(n,t._databaseId,e,s),s}function vQ(t,e){return oQ(Mt(t=Ie(t,rt)),e).then(n=>n?new Xt(t,null,n.query):null)}function xP(t){if(t._initialized||t._terminated)throw new S(w.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ni{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new S(w.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new ot(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Us{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Us(mt.fromBase64String(e))}catch(n){throw new S(w.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new Us(mt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ko{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class np{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new S(w.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new S(w.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return ce(this._lat,e._lat)||ce(this._long,e._long)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wQ=/^__.*__$/;class bQ{constructor(e,n,s){this.data=e,this.fieldMask=n,this.fieldTransforms=s}toMutation(e,n){return this.fieldMask!==null?new fr(e,this.data,this.fieldMask,n,this.fieldTransforms):new Xa(e,this.data,n,this.fieldTransforms)}}class OP{constructor(e,n,s){this.data=e,this.fieldMask=n,this.fieldTransforms=s}toMutation(e,n){return new fr(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function MP(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw W()}}class sp{constructor(e,n,s,r,i,o){this.settings=e,this.databaseId=n,this.wt=s,this.ignoreUndefinedProperties=r,i===void 0&&this.Xc(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Zc(){return this.settings.Zc}ta(e){return new sp(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.wt,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}ea(e){var n;const s=(n=this.path)===null||n===void 0?void 0:n.child(e),r=this.ta({path:s,na:!1});return r.sa(e),r}ia(e){var n;const s=(n=this.path)===null||n===void 0?void 0:n.child(e),r=this.ta({path:s,na:!1});return r.Xc(),r}ra(e){return this.ta({path:void 0,na:!0})}oa(e){return Sd(e,this.settings.methodName,this.settings.ua||!1,this.path,this.settings.ca)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}Xc(){if(this.path)for(let e=0;e<this.path.length;e++)this.sa(this.path.get(e))}sa(e){if(e.length===0)throw this.oa("Document fields must not be empty");if(MP(this.Zc)&&wQ.test(e))throw this.oa('Document fields cannot begin and end with "__"')}}class IQ{constructor(e,n,s){this.databaseId=e,this.ignoreUndefinedProperties=n,this.wt=s||Du(e)}aa(e,n,s,r=!1){return new sp({Zc:e,methodName:n,ca:s,path:ot.emptyPath(),na:!1,ua:r},this.databaseId,this.wt,this.ignoreUndefinedProperties)}}function Ro(t){const e=t._freezeSettings(),n=Du(t._databaseId);return new IQ(t._databaseId,!!e.ignoreUndefinedProperties,n)}function rp(t,e,n,s,r,i={}){const o=t.aa(i.merge||i.mergeFields?2:0,e,n,r);ew("Data must be an object, but it was:",o,s);const a=UP(s,o);let c,l;if(i.merge)c=new Nn(o.fieldMask),l=o.fieldTransforms;else if(i.mergeFields){const u=[];for(const h of i.mergeFields){const d=Km(e,h,n);if(!o.contains(d))throw new S(w.INVALID_ARGUMENT,`Field '${d}' is specified in your field mask but missing from your input data.`);VP(u,d)||u.push(d)}c=new Nn(u),l=o.fieldTransforms.filter(h=>c.covers(h.field))}else c=null,l=o.fieldTransforms;return new bQ(new Ut(a),c,l)}class Mu extends ko{_toFieldTransform(e){if(e.Zc!==2)throw e.Zc===1?e.oa(`${this._methodName}() can only appear at the top level of your update data`):e.oa(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Mu}}function LP(t,e,n){return new sp({Zc:3,ca:e.settings.ca,methodName:t._methodName,na:n},e.databaseId,e.wt,e.ignoreUndefinedProperties)}class Jv extends ko{_toFieldTransform(e){return new Ru(e.path,new Ca)}isEqual(e){return e instanceof Jv}}class EQ extends ko{constructor(e,n){super(e),this.ha=n}_toFieldTransform(e){const n=LP(this,e,!0),s=this.ha.map(i=>No(i,n)),r=new lo(s);return new Ru(e.path,r)}isEqual(e){return this===e}}class TQ extends ko{constructor(e,n){super(e),this.ha=n}_toFieldTransform(e){const n=LP(this,e,!0),s=this.ha.map(i=>No(i,n)),r=new uo(s);return new Ru(e.path,r)}isEqual(e){return this===e}}class SQ extends ko{constructor(e,n){super(e),this.la=n}_toFieldTransform(e){const n=new Aa(e.wt,dN(e.wt,this.la));return new Ru(e.path,n)}isEqual(e){return this===e}}function Xv(t,e,n,s){const r=t.aa(1,e,n);ew("Data must be an object, but it was:",r,s);const i=[],o=Ut.empty();Ao(s,(c,l)=>{const u=tw(e,c,n);l=A(l);const h=r.ia(u);if(l instanceof Mu)i.push(u);else{const d=No(l,h);d!=null&&(i.push(u),o.set(u,d))}});const a=new Nn(i);return new OP(o,a,r.fieldTransforms)}function Zv(t,e,n,s,r,i){const o=t.aa(1,e,n),a=[Km(e,s,n)],c=[r];if(i.length%2!=0)throw new S(w.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let d=0;d<i.length;d+=2)a.push(Km(e,i[d])),c.push(i[d+1]);const l=[],u=Ut.empty();for(let d=a.length-1;d>=0;--d)if(!VP(l,a[d])){const f=a[d];let p=c[d];p=A(p);const _=o.ia(f);if(p instanceof Mu)l.push(f);else{const y=No(p,_);y!=null&&(l.push(f),u.set(f,y))}}const h=new Nn(l);return new OP(u,h,o.fieldTransforms)}function FP(t,e,n,s=!1){return No(n,t.aa(s?4:3,e))}function No(t,e){if($P(t=A(t)))return ew("Unsupported field value:",e,t),UP(t,e);if(t instanceof ko)return function(n,s){if(!MP(s.Zc))throw s.oa(`${n._methodName}() can only be used with update() and set()`);if(!s.path)throw s.oa(`${n._methodName}() is not currently supported inside arrays`);const r=n._toFieldTransform(s);r&&s.fieldTransforms.push(r)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.na&&e.Zc!==4)throw e.oa("Nested arrays are not supported");return function(n,s){const r=[];let i=0;for(const o of n){let a=No(o,s.ra(i));a==null&&(a={nullValue:"NULL_VALUE"}),r.push(a),i++}return{arrayValue:{values:r}}}(t,e)}return function(n,s){if((n=A(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return dN(s.wt,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const r=ze.fromDate(n);return{timestampValue:jl(s.wt,r)}}if(n instanceof ze){const r=new ze(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:jl(s.wt,r)}}if(n instanceof np)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof Us)return{bytesValue:CN(s.wt,n._byteString)};if(n instanceof Ke){const r=s.databaseId,i=n.firestore._databaseId;if(!i.isEqual(r))throw s.oa(`Document reference is for database ${i.projectId}/${i.database} but should be for database ${r.projectId}/${r.database}`);return{referenceValue:wv(n.firestore._databaseId||s.databaseId,n._key.path)}}throw s.oa(`Unsupported field value: ${tp(n)}`)}(t,e)}function UP(t,e){const n={};return ZR(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Ao(t,(s,r)=>{const i=No(r,e.ea(s));i!=null&&(n[s]=i)}),{mapValue:{fields:n}}}function $P(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof ze||t instanceof np||t instanceof Us||t instanceof Ke||t instanceof ko)}function ew(t,e,n){if(!$P(n)||!function(s){return typeof s=="object"&&s!==null&&(Object.getPrototypeOf(s)===Object.prototype||Object.getPrototypeOf(s)===null)}(n)){const s=tp(n);throw s==="an object"?e.oa(t+" a custom object"):e.oa(t+" "+s)}}function Km(t,e,n){if((e=A(e))instanceof ni)return e._internalPath;if(typeof e=="string")return tw(t,e);throw Sd("Field path arguments must be of type string or ",t,!1,void 0,n)}const CQ=new RegExp("[~\\*/\\[\\]]");function tw(t,e,n){if(e.search(CQ)>=0)throw Sd(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new ni(...e.split("."))._internalPath}catch{throw Sd(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function Sd(t,e,n,s,r){const i=s&&!s.isEmpty(),o=r!==void 0;let a=`Function ${e}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(i||o)&&(c+=" (found",i&&(c+=` in field ${s}`),o&&(c+=` in document ${r}`),c+=")"),new S(w.INVALID_ARGUMENT,a+t+c)}function VP(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zl{constructor(e,n,s,r,i){this._firestore=e,this._userDataWriter=n,this._key=s,this._document=r,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new Ke(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new AQ(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(ip("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class AQ extends zl{data(){return super.data()}}function ip(t,e){return typeof e=="string"?tw(t,e):e instanceof ni?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fi{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class cr extends zl{constructor(e,n,s,r,i,o){super(e,n,s,r,o),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new Jc(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const s=this._document.data.field(ip("DocumentSnapshot.get",e));if(s!==null)return this._userDataWriter.convertValue(s,n.serverTimestamps)}}}class Jc extends cr{data(e={}){return super.data(e)}}class si{constructor(e,n,s,r){this._firestore=e,this._userDataWriter=n,this._snapshot=r,this.metadata=new Fi(r.hasPendingWrites,r.fromCache),this.query=s}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(s=>{e.call(n,new Jc(this._firestore,this._userDataWriter,s.key,s,new Fi(this._snapshot.mutatedKeys.has(s.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new S(w.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(s,r){if(s._snapshot.oldDocs.isEmpty()){let i=0;return s._snapshot.docChanges.map(o=>({type:"added",doc:new Jc(s._firestore,s._userDataWriter,o.doc.key,o.doc,new Fi(s._snapshot.mutatedKeys.has(o.doc.key),s._snapshot.fromCache),s.query.converter),oldIndex:-1,newIndex:i++}))}{let i=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(o=>r||o.type!==3).map(o=>{const a=new Jc(s._firestore,s._userDataWriter,o.doc.key,o.doc,new Fi(s._snapshot.mutatedKeys.has(o.doc.key),s._snapshot.fromCache),s.query.converter);let c=-1,l=-1;return o.type!==0&&(c=i.indexOf(o.doc.key),i=i.delete(o.doc.key)),o.type!==1&&(i=i.add(o.doc),l=i.indexOf(o.doc.key)),{type:kQ(o.type),doc:a,oldIndex:c,newIndex:l}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}}function kQ(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return W()}}function BP(t,e){return t instanceof cr&&e instanceof cr?t._firestore===e._firestore&&t._key.isEqual(e._key)&&(t._document===null?e._document===null:t._document.isEqual(e._document))&&t._converter===e._converter:t instanceof si&&e instanceof si&&t._firestore===e._firestore&&NP(t.query,e.query)&&t.metadata.isEqual(e.metadata)&&t._snapshot.isEqual(e._snapshot)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qP(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new S(w.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Lu{}function Er(t,...e){for(const n of e)t=n._apply(t);return t}class RQ extends Lu{constructor(e,n,s){super(),this.fa=e,this.da=n,this._a=s,this.type="where"}_apply(e){const n=Ro(e.firestore),s=function(r,i,o,a,c,l,u){let h;if(c.isKeyField()){if(l==="array-contains"||l==="array-contains-any")throw new S(w.INVALID_ARGUMENT,`Invalid Query. You can't perform '${l}' queries on documentId().`);if(l==="in"||l==="not-in"){pT(u,l);const f=[];for(const p of u)f.push(fT(a,r,p));h={arrayValue:{values:f}}}else h=fT(a,r,u)}else l!=="in"&&l!=="not-in"&&l!=="array-contains-any"||pT(u,l),h=FP(o,i,u,l==="in"||l==="not-in");const d=Vt.create(c,l,h);return function(f,p){if(p.ht()){const y=mv(f);if(y!==null&&!y.isEqual(p.field))throw new S(w.INVALID_ARGUMENT,`Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '${y.toString()}' and '${p.field.toString()}'`);const I=gv(f);I!==null&&GP(f,p.field,I)}const _=function(y,I){for(const N of y.filters)if(I.indexOf(N.op)>=0)return N.op;return null}(f,function(y){switch(y){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}(p.op));if(_!==null)throw _===p.op?new S(w.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${p.op.toString()}' filter.`):new S(w.INVALID_ARGUMENT,`Invalid query. You cannot use '${p.op.toString()}' filters with '${_.toString()}' filters.`)}(r,d),d}(e._query,"where",n,e.firestore._databaseId,this.fa,this.da,this._a);return new Xt(e.firestore,e.converter,function(r,i){const o=r.filters.concat([i]);return new dr(r.path,r.collectionGroup,r.explicitOrderBy.slice(),o,r.limit,r.limitType,r.startAt,r.endAt)}(e._query,s))}}function NQ(t,e,n){const s=e,r=ip("where",t);return new RQ(r,s,n)}class PQ extends Lu{constructor(e,n){super(),this.fa=e,this.wa=n,this.type="orderBy"}_apply(e){const n=function(s,r,i){if(s.startAt!==null)throw new S(w.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(s.endAt!==null)throw new S(w.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");const o=new ra(r,i);return function(a,c){if(gv(a)===null){const l=mv(a);l!==null&&GP(a,l,c.field)}}(s,o),o}(e._query,this.fa,this.wa);return new Xt(e.firestore,e.converter,function(s,r){const i=s.explicitOrderBy.concat([r]);return new dr(s.path,s.collectionGroup,i,s.filters.slice(),s.limit,s.limitType,s.startAt,s.endAt)}(e._query,n))}}function DQ(t,e="asc"){const n=e,s=ip("orderBy",t);return new PQ(s,n)}class jP extends Lu{constructor(e,n,s){super(),this.type=e,this.ma=n,this.ga=s}_apply(e){return new Xt(e.firestore,e.converter,oN(e._query,this.ma,this.ga))}}function xQ(t){return AP("limit",t),new jP("limit",t,"F")}function OQ(t){return AP("limitToLast",t),new jP("limitToLast",t,"L")}class KP extends Lu{constructor(e,n,s){super(),this.type=e,this.ya=n,this.pa=s}_apply(e){const n=HP(e,this.type,this.ya,this.pa);return new Xt(e.firestore,e.converter,function(s,r){return new dr(s.path,s.collectionGroup,s.explicitOrderBy.slice(),s.filters.slice(),s.limit,s.limitType,r,s.endAt)}(e._query,n))}}function MQ(...t){return new KP("startAt",t,!0)}function LQ(...t){return new KP("startAfter",t,!1)}class WP extends Lu{constructor(e,n,s){super(),this.type=e,this.ya=n,this.pa=s}_apply(e){const n=HP(e,this.type,this.ya,this.pa);return new Xt(e.firestore,e.converter,function(s,r){return new dr(s.path,s.collectionGroup,s.explicitOrderBy.slice(),s.filters.slice(),s.limit,s.limitType,s.startAt,r)}(e._query,n))}}function FQ(...t){return new WP("endBefore",t,!1)}function UQ(...t){return new WP("endAt",t,!0)}function HP(t,e,n,s){if(n[0]=A(n[0]),n[0]instanceof zl)return function(r,i,o,a,c){if(!a)throw new S(w.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${o}().`);const l=[];for(const u of Sa(r))if(u.field.isKeyField())l.push(ao(i,a.key));else{const h=a.data.field(u.field);if(pv(h))throw new S(w.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+u.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(h===null){const d=u.field.canonicalString();throw new S(w.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${d}' (used as the orderBy) does not exist.`)}l.push(h)}return new ei(l,c)}(t._query,t.firestore._databaseId,e,n[0]._document,s);{const r=Ro(t.firestore);return function(i,o,a,c,l,u){const h=i.explicitOrderBy;if(l.length>h.length)throw new S(w.INVALID_ARGUMENT,`Too many arguments provided to ${c}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const d=[];for(let f=0;f<l.length;f++){const p=l[f];if(h[f].field.isKeyField()){if(typeof p!="string")throw new S(w.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${c}(), but got a ${typeof p}`);if(!_v(i)&&p.indexOf("/")!==-1)throw new S(w.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${c}() must be a plain document ID, but '${p}' contains a slash.`);const _=i.path.child(we.fromString(p));if(!F.isDocumentKey(_))throw new S(w.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${c}() must result in a valid document path, but '${_}' is not because it contains an odd number of segments.`);const y=new F(_);d.push(ao(o,y))}else{const _=FP(a,c,p);d.push(_)}}return new ei(d,u)}(t._query,t.firestore._databaseId,r,e,n,s)}}function fT(t,e,n){if(typeof(n=A(n))=="string"){if(n==="")throw new S(w.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!_v(e)&&n.indexOf("/")!==-1)throw new S(w.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const s=e.path.child(we.fromString(n));if(!F.isDocumentKey(s))throw new S(w.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${s}' is not because it has an odd number of segments (${s.length}).`);return ao(t,new F(s))}if(n instanceof Ke)return ao(t,n._key);throw new S(w.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${tp(n)}.`)}function pT(t,e){if(!Array.isArray(t)||t.length===0)throw new S(w.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`);if(t.length>10)throw new S(w.INVALID_ARGUMENT,`Invalid Query. '${e.toString()}' filters support a maximum of 10 elements in the value array.`)}function GP(t,e,n){if(!n.isEqual(e))throw new S(w.INVALID_ARGUMENT,`Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '${e.toString()}' and so you must also use '${e.toString()}' as your first argument to orderBy(), but your first orderBy() is on field '${n.toString()}' instead.`)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $Q={maxAttempts:5};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nw{convertValue(e,n="none"){switch(oo(e)){case 0:return null;case 1:return e.booleanValue;case 2:return et(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(io(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 10:return this.convertObject(e.mapValue,n);default:throw W()}}convertObject(e,n){const s={};return Ao(e.fields,(r,i)=>{s[r]=this.convertValue(i,n)}),s}convertGeoPoint(e){return new np(et(e.latitude),et(e.longitude))}convertArray(e,n){return(e.values||[]).map(s=>this.convertValue(s,n))}convertServerTimestamp(e,n){switch(n){case"previous":const s=eN(e);return s==null?null:this.convertValue(s,n);case"estimate":return this.convertTimestamp($l(e));default:return null}}convertTimestamp(e){const n=Xr(e);return new ze(n.seconds,n.nanos)}convertDocumentKey(e,n){const s=we.fromString(e);re(MN(s));const r=new ar(s.get(1),s.get(3)),i=new F(s.popFirst(5));return r.isEqual(n)||ht(`Document ${i} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function op(t,e,n){let s;return s=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,s}class VQ extends nw{constructor(e){super(),this.firestore=e}convertBytes(e){return new Us(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new Ke(this.firestore,null,n)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BQ{constructor(e,n){this._firestore=e,this._commitHandler=n,this._mutations=[],this._committed=!1,this._dataReader=Ro(e)}set(e,n,s){this._verifyNotCommitted();const r=Rr(e,this._firestore),i=op(r.converter,n,s),o=rp(this._dataReader,"WriteBatch.set",r._key,i,r.converter!==null,s);return this._mutations.push(o.toMutation(r._key,Ye.none())),this}update(e,n,s,...r){this._verifyNotCommitted();const i=Rr(e,this._firestore);let o;return o=typeof(n=A(n))=="string"||n instanceof ni?Zv(this._dataReader,"WriteBatch.update",i._key,n,s,r):Xv(this._dataReader,"WriteBatch.update",i._key,n),this._mutations.push(o.toMutation(i._key,Ye.exists(!0))),this}delete(e){this._verifyNotCommitted();const n=Rr(e,this._firestore);return this._mutations=this._mutations.concat(new Za(n._key,Ye.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new S(w.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function Rr(t,e){if((t=A(t)).firestore!==e)throw new S(w.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qQ(t){t=Ie(t,Ke);const e=Ie(t.firestore,rt);return TP(Mt(e),t._key).then(n=>sw(e,t,n))}class Po extends nw{constructor(e){super(),this.firestore=e}convertBytes(e){return new Us(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new Ke(this.firestore,null,n)}}function jQ(t){t=Ie(t,Ke);const e=Ie(t.firestore,rt),n=Mt(e),s=new Po(e);return tQ(n,t._key).then(r=>new cr(e,s,t._key,r,new Fi(r!==null&&r.hasLocalMutations,!0),t.converter))}function KQ(t){t=Ie(t,Ke);const e=Ie(t.firestore,rt);return TP(Mt(e),t._key,{source:"server"}).then(n=>sw(e,t,n))}function WQ(t){t=Ie(t,Xt);const e=Ie(t.firestore,rt),n=Mt(e),s=new Po(e);return qP(t._query),SP(n,t._query).then(r=>new si(e,s,t,r))}function HQ(t){t=Ie(t,Xt);const e=Ie(t.firestore,rt),n=Mt(e),s=new Po(e);return nQ(n,t._query).then(r=>new si(e,s,t,r))}function GQ(t){t=Ie(t,Xt);const e=Ie(t.firestore,rt),n=Mt(e),s=new Po(e);return SP(n,t._query,{source:"server"}).then(r=>new si(e,s,t,r))}function gT(t,e,n){t=Ie(t,Ke);const s=Ie(t.firestore,rt),r=op(t.converter,e,n);return Fu(s,[rp(Ro(s),"setDoc",t._key,r,t.converter!==null,n).toMutation(t._key,Ye.none())])}function mT(t,e,n,...s){t=Ie(t,Ke);const r=Ie(t.firestore,rt),i=Ro(r);let o;return o=typeof(e=A(e))=="string"||e instanceof ni?Zv(i,"updateDoc",t._key,e,n,s):Xv(i,"updateDoc",t._key,e),Fu(r,[o.toMutation(t._key,Ye.exists(!0))])}function zQ(t){return Fu(Ie(t.firestore,rt),[new Za(t._key,Ye.none())])}function QQ(t,e){const n=Ie(t.firestore,rt),s=Td(t),r=op(t.converter,e);return Fu(n,[rp(Ro(t.firestore),"addDoc",s._key,r,t.converter!==null,{}).toMutation(s._key,Ye.exists(!1))]).then(()=>s)}function zP(t,...e){var n,s,r;t=A(t);let i={includeMetadataChanges:!1},o=0;typeof e[o]!="object"||jm(e[o])||(i=e[o],o++);const a={includeMetadataChanges:i.includeMetadataChanges};if(jm(e[o])){const h=e[o];e[o]=(n=h.next)===null||n===void 0?void 0:n.bind(h),e[o+1]=(s=h.error)===null||s===void 0?void 0:s.bind(h),e[o+2]=(r=h.complete)===null||r===void 0?void 0:r.bind(h)}let c,l,u;if(t instanceof Ke)l=Ie(t.firestore,rt),u=Ja(t._key.path),c={next:h=>{e[o]&&e[o](sw(l,t,h))},error:e[o+1],complete:e[o+2]};else{const h=Ie(t,Xt);l=Ie(h.firestore,rt),u=h._query;const d=new Po(l);c={next:f=>{e[o]&&e[o](new si(l,d,h,f))},error:e[o+1],complete:e[o+2]},qP(t._query)}return function(h,d,f,p){const _=new Zf(p),y=new $v(d,_,f);return h.asyncQueue.enqueueAndForget(async()=>Lv(await Da(h),y)),()=>{_.Tc(),h.asyncQueue.enqueueAndForget(async()=>Fv(await Da(h),y))}}(Mt(l),u,a,c)}function YQ(t,e){return sQ(Mt(t=Ie(t,rt)),jm(e)?e:{next:e})}function Fu(t,e){return function(n,s){const r=new St;return n.asyncQueue.enqueueAndForget(async()=>D6(await Qv(n),s,r)),r.promise}(Mt(t),e)}function sw(t,e,n){const s=n.docs.get(e._key),r=new Po(t);return new cr(t,r,e._key,s,new Fi(n.hasPendingWrites,n.fromCache),e.converter)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JQ extends class{constructor(e,n){this._firestore=e,this._transaction=n,this._dataReader=Ro(e)}get(e){const n=Rr(e,this._firestore),s=new VQ(this._firestore);return this._transaction.lookup([n._key]).then(r=>{if(!r||r.length!==1)return W();const i=r[0];if(i.isFoundDocument())return new zl(this._firestore,s,i.key,i,n.converter);if(i.isNoDocument())return new zl(this._firestore,s,n._key,null,n.converter);throw W()})}set(e,n,s){const r=Rr(e,this._firestore),i=op(r.converter,n,s),o=rp(this._dataReader,"Transaction.set",r._key,i,r.converter!==null,s);return this._transaction.set(r._key,o),this}update(e,n,s,...r){const i=Rr(e,this._firestore);let o;return o=typeof(n=A(n))=="string"||n instanceof ni?Zv(this._dataReader,"Transaction.update",i._key,n,s,r):Xv(this._dataReader,"Transaction.update",i._key,n),this._transaction.update(i._key,o),this}delete(e){const n=Rr(e,this._firestore);return this._transaction.delete(n._key),this}}{constructor(e,n){super(e,n),this._firestore=e}get(e){const n=Rr(e,this._firestore),s=new Po(this._firestore);return super.get(e).then(r=>new cr(this._firestore,s,n._key,r._document,new Fi(!1,!1),n.converter))}}function XQ(t,e,n){t=Ie(t,rt);const s=Object.assign(Object.assign({},$Q),n);return function(r){if(r.maxAttempts<1)throw new S(w.INVALID_ARGUMENT,"Max attempts must be at least 1")}(s),rQ(Mt(t),r=>e(new JQ(t,r)),s)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ZQ(){return new Mu("deleteField")}function eY(){return new Jv("serverTimestamp")}function tY(...t){return new EQ("arrayUnion",t)}function nY(...t){return new TQ("arrayRemove",t)}function sY(t){return new SQ("increment",t)}(function(t,e=!0){(function(n){Ya=n})(Bs),nt(new Ee("firestore",(n,{options:s})=>{const r=n.getProvider("app").getImmediate(),i=new rt(r,new c2(n.getProvider("auth-internal")),new d2(n.getProvider("app-check-internal")));return s=Object.assign({useFetchStreams:e},s),i._setSettings(s),i},"PUBLIC")),Le(pE,"3.4.12",t),Le(pE,"3.4.12","esm2017")})();const rY="@firebase/firestore-compat",iY="0.1.21";/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rw(t,e){if(e===void 0)return{merge:!1};if(e.mergeFields!==void 0&&e.merge!==void 0)throw new S("invalid-argument",`Invalid options passed to function ${t}(): You cannot specify both "merge" and "mergeFields".`);return e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _T(){if(typeof Uint8Array=="undefined")throw new S("unimplemented","Uint8Arrays are not available in this environment.")}function yT(){if(!w2())throw new S("unimplemented","Blobs are unavailable in Firestore in this environment.")}class Ql{constructor(e){this._delegate=e}static fromBase64String(e){return yT(),new Ql(Us.fromBase64String(e))}static fromUint8Array(e){return _T(),new Ql(Us.fromUint8Array(e))}toBase64(){return yT(),this._delegate.toBase64()}toUint8Array(){return _T(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wm(t){return oY(t,["next","error","complete"])}function oY(t,e){if(typeof t!="object"||t===null)return!1;const n=t;for(const s of e)if(s in n&&typeof n[s]=="function")return!0;return!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aY{enableIndexedDbPersistence(e,n){return dQ(e._delegate,{forceOwnership:n})}enableMultiTabIndexedDbPersistence(e){return fQ(e._delegate)}clearIndexedDbPersistence(e){return pQ(e._delegate)}}class QP{constructor(e,n,s){this._delegate=n,this._persistenceProvider=s,this.INTERNAL={delete:()=>this.terminate()},e instanceof ar||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){const n=this._delegate._getSettings();!e.merge&&n.host!==e.host&&Fl("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&(e=Object.assign(Object.assign({},n),e),delete e.merge),this._delegate._setSettings(e)}useEmulator(e,n,s={}){aQ(this._delegate,e,n,s)}enableNetwork(){return mQ(this._delegate)}disableNetwork(){return _Q(this._delegate)}enablePersistence(e){let n=!1,s=!1;return e&&(n=!!e.synchronizeTabs,s=!!e.experimentalForceOwningTab,CP("synchronizeTabs",n,"experimentalForceOwningTab",s)),n?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,s)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return gQ(this._delegate)}onSnapshotsInSync(e){return YQ(this._delegate,e)}get app(){if(!this._appCompat)throw new S("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new xa(this,kP(this._delegate,e))}catch(n){throw nn(n,"collection()","Firestore.collection()")}}doc(e){try{return new Bn(this,Td(this._delegate,e))}catch(n){throw nn(n,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new tn(this,cQ(this._delegate,e))}catch(n){throw nn(n,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return XQ(this._delegate,n=>e(new YP(this,n)))}batch(){return Mt(this._delegate),new JP(new BQ(this._delegate,e=>Fu(this._delegate,e)))}loadBundle(e){return yQ(this._delegate,e)}namedQuery(e){return vQ(this._delegate,e).then(n=>n?new tn(this,n):null)}}class ap extends nw{constructor(e){super(),this.firestore=e}convertBytes(e){return new Ql(new Us(e))}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return Bn.forKey(n,this.firestore,null)}}function cY(t){r2(t)}class YP{constructor(e,n){this._firestore=e,this._delegate=n,this._userDataWriter=new ap(e)}get(e){const n=Ui(e);return this._delegate.get(n).then(s=>new Yl(this._firestore,new cr(this._firestore._delegate,this._userDataWriter,s._key,s._document,s.metadata,n.converter)))}set(e,n,s){const r=Ui(e);return s?(rw("Transaction.set",s),this._delegate.set(r,n,s)):this._delegate.set(r,n),this}update(e,n,s,...r){const i=Ui(e);return arguments.length===2?this._delegate.update(i,n):this._delegate.update(i,n,s,...r),this}delete(e){const n=Ui(e);return this._delegate.delete(n),this}}class JP{constructor(e){this._delegate=e}set(e,n,s){const r=Ui(e);return s?(rw("WriteBatch.set",s),this._delegate.set(r,n,s)):this._delegate.set(r,n),this}update(e,n,s,...r){const i=Ui(e);return arguments.length===2?this._delegate.update(i,n):this._delegate.update(i,n,s,...r),this}delete(e){const n=Ui(e);return this._delegate.delete(n),this}commit(){return this._delegate.commit()}}class go{constructor(e,n,s){this._firestore=e,this._userDataWriter=n,this._delegate=s}fromFirestore(e,n){const s=new Jc(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new Jl(this._firestore,s),n!=null?n:{})}toFirestore(e,n){return n?this._delegate.toFirestore(e,n):this._delegate.toFirestore(e)}static getInstance(e,n){const s=go.INSTANCES;let r=s.get(e);r||(r=new WeakMap,s.set(e,r));let i=r.get(n);return i||(i=new go(e,new ap(e),n),r.set(n,i)),i}}go.INSTANCES=new WeakMap;class Bn{constructor(e,n){this.firestore=e,this._delegate=n,this._userDataWriter=new ap(e)}static forPath(e,n,s){if(e.length%2!==0)throw new S("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new Bn(n,new Ke(n._delegate,s,new F(e)))}static forKey(e,n,s){return new Bn(n,new Ke(n._delegate,s,e))}get id(){return this._delegate.id}get parent(){return new xa(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new xa(this.firestore,kP(this._delegate,e))}catch(n){throw nn(n,"collection()","DocumentReference.collection()")}}isEqual(e){return e=A(e),e instanceof Ke?RP(this._delegate,e):!1}set(e,n){n=rw("DocumentReference.set",n);try{return n?gT(this._delegate,e,n):gT(this._delegate,e)}catch(s){throw nn(s,"setDoc()","DocumentReference.set()")}}update(e,n,...s){try{return arguments.length===1?mT(this._delegate,e):mT(this._delegate,e,n,...s)}catch(r){throw nn(r,"updateDoc()","DocumentReference.update()")}}delete(){return zQ(this._delegate)}onSnapshot(...e){const n=XP(e),s=ZP(e,r=>new Yl(this.firestore,new cr(this.firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,this._delegate.converter)));return zP(this._delegate,n,s)}get(e){let n;return(e==null?void 0:e.source)==="cache"?n=jQ(this._delegate):(e==null?void 0:e.source)==="server"?n=KQ(this._delegate):n=qQ(this._delegate),n.then(s=>new Yl(this.firestore,new cr(this.firestore._delegate,this._userDataWriter,s._key,s._document,s.metadata,this._delegate.converter)))}withConverter(e){return new Bn(this.firestore,e?this._delegate.withConverter(go.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}function nn(t,e,n){return t.message=t.message.replace(e,n),t}function XP(t){for(const e of t)if(typeof e=="object"&&!Wm(e))return e;return{}}function ZP(t,e){var n,s;let r;return Wm(t[0])?r=t[0]:Wm(t[1])?r=t[1]:typeof t[0]=="function"?r={next:t[0],error:t[1],complete:t[2]}:r={next:t[1],error:t[2],complete:t[3]},{next:i=>{r.next&&r.next(e(i))},error:(n=r.error)===null||n===void 0?void 0:n.bind(r),complete:(s=r.complete)===null||s===void 0?void 0:s.bind(r)}}class Yl{constructor(e,n){this._firestore=e,this._delegate=n}get ref(){return new Bn(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,n){return this._delegate.get(e,n)}isEqual(e){return BP(this._delegate,e._delegate)}}class Jl extends Yl{data(e){const n=this._delegate.data(e);return i2(n!==void 0),n}}class tn{constructor(e,n){this.firestore=e,this._delegate=n,this._userDataWriter=new ap(e)}where(e,n,s){try{return new tn(this.firestore,Er(this._delegate,NQ(e,n,s)))}catch(r){throw nn(r,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,n){try{return new tn(this.firestore,Er(this._delegate,DQ(e,n)))}catch(s){throw nn(s,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new tn(this.firestore,Er(this._delegate,xQ(e)))}catch(n){throw nn(n,"limit()","Query.limit()")}}limitToLast(e){try{return new tn(this.firestore,Er(this._delegate,OQ(e)))}catch(n){throw nn(n,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new tn(this.firestore,Er(this._delegate,MQ(...e)))}catch(n){throw nn(n,"startAt()","Query.startAt()")}}startAfter(...e){try{return new tn(this.firestore,Er(this._delegate,LQ(...e)))}catch(n){throw nn(n,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new tn(this.firestore,Er(this._delegate,FQ(...e)))}catch(n){throw nn(n,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new tn(this.firestore,Er(this._delegate,UQ(...e)))}catch(n){throw nn(n,"endAt()","Query.endAt()")}}isEqual(e){return NP(this._delegate,e._delegate)}get(e){let n;return(e==null?void 0:e.source)==="cache"?n=HQ(this._delegate):(e==null?void 0:e.source)==="server"?n=GQ(this._delegate):n=WQ(this._delegate),n.then(s=>new Hm(this.firestore,new si(this.firestore._delegate,this._userDataWriter,this._delegate,s._snapshot)))}onSnapshot(...e){const n=XP(e),s=ZP(e,r=>new Hm(this.firestore,new si(this.firestore._delegate,this._userDataWriter,this._delegate,r._snapshot)));return zP(this._delegate,n,s)}withConverter(e){return new tn(this.firestore,e?this._delegate.withConverter(go.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}class lY{constructor(e,n){this._firestore=e,this._delegate=n}get type(){return this._delegate.type}get doc(){return new Jl(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}}class Hm{constructor(e,n){this._firestore=e,this._delegate=n}get query(){return new tn(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(e=>new Jl(this._firestore,e))}docChanges(e){return this._delegate.docChanges(e).map(n=>new lY(this._firestore,n))}forEach(e,n){this._delegate.forEach(s=>{e.call(n,new Jl(this._firestore,s))})}isEqual(e){return BP(this._delegate,e._delegate)}}class xa extends tn{constructor(e,n){super(e,n),this.firestore=e,this._delegate=n}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){const e=this._delegate.parent;return e?new Bn(this.firestore,e):null}doc(e){try{return e===void 0?new Bn(this.firestore,Td(this._delegate)):new Bn(this.firestore,Td(this._delegate,e))}catch(n){throw nn(n,"doc()","CollectionReference.doc()")}}add(e){return QQ(this._delegate,e).then(n=>new Bn(this.firestore,n))}isEqual(e){return RP(this._delegate,e._delegate)}withConverter(e){return new xa(this.firestore,e?this._delegate.withConverter(go.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}function Ui(t){return Ie(t,Ke)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iw{constructor(...e){this._delegate=new ni(...e)}static documentId(){return new iw(ot.keyField().canonicalString())}isEqual(e){return e=A(e),e instanceof ni?this._delegate._internalPath.isEqual(e._internalPath):!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ni{constructor(e){this._delegate=e}static serverTimestamp(){const e=eY();return e._methodName="FieldValue.serverTimestamp",new Ni(e)}static delete(){const e=ZQ();return e._methodName="FieldValue.delete",new Ni(e)}static arrayUnion(...e){const n=tY(...e);return n._methodName="FieldValue.arrayUnion",new Ni(n)}static arrayRemove(...e){const n=nY(...e);return n._methodName="FieldValue.arrayRemove",new Ni(n)}static increment(e){const n=sY(e);return n._methodName="FieldValue.increment",new Ni(n)}isEqual(e){return this._delegate.isEqual(e._delegate)}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uY={Firestore:QP,GeoPoint:np,Timestamp:ze,Blob:Ql,Transaction:YP,WriteBatch:JP,DocumentReference:Bn,DocumentSnapshot:Yl,Query:tn,QueryDocumentSnapshot:Jl,QuerySnapshot:Hm,CollectionReference:xa,FieldPath:iw,FieldValue:Ni,setLogLevel:cY,CACHE_SIZE_UNLIMITED:hQ};function hY(t,e){t.INTERNAL.registerComponent(new Ee("firestore-compat",n=>{const s=n.getProvider("app-compat").getImmediate(),r=n.getProvider("firestore").getImmediate();return e(s,r)},"PUBLIC").setServiceProps(Object.assign({},uY)))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dY(t){hY(t,(e,n)=>new QP(e,n,new aY)),t.registerVersion(rY,iY)}dY(lt);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fY="type.googleapis.com/google.protobuf.Int64Value",pY="type.googleapis.com/google.protobuf.UInt64Value";function eD(t,e){const n={};for(const s in t)t.hasOwnProperty(s)&&(n[s]=e(t[s]));return n}function Gm(t){if(t==null)return null;if(t instanceof Number&&(t=t.valueOf()),typeof t=="number"&&isFinite(t)||t===!0||t===!1||Object.prototype.toString.call(t)==="[object String]")return t;if(t instanceof Date)return t.toISOString();if(Array.isArray(t))return t.map(e=>Gm(e));if(typeof t=="function"||typeof t=="object")return eD(t,e=>Gm(e));throw new Error("Data cannot be encoded in JSON: "+t)}function Cd(t){if(t==null)return t;if(t["@type"])switch(t["@type"]){case fY:case pY:{const e=Number(t.value);if(isNaN(e))throw new Error("Data cannot be decoded from JSON: "+t);return e}default:throw new Error("Data cannot be decoded from JSON: "+t)}return Array.isArray(t)?t.map(e=>Cd(e)):typeof t=="function"||typeof t=="object"?eD(t,e=>Cd(e)):t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tD="functions";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vT={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class oa extends ct{constructor(e,n,s){super(`${tD}/${e}`,n||""),this.details=s}}function gY(t){if(t>=200&&t<300)return"ok";switch(t){case 0:return"internal";case 400:return"invalid-argument";case 401:return"unauthenticated";case 403:return"permission-denied";case 404:return"not-found";case 409:return"aborted";case 429:return"resource-exhausted";case 499:return"cancelled";case 500:return"internal";case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline-exceeded"}return"unknown"}function mY(t,e){let n=gY(t),s=n,r;try{const i=e&&e.error;if(i){const o=i.status;if(typeof o=="string"){if(!vT[o])return new oa("internal","internal");n=vT[o],s=o}const a=i.message;typeof a=="string"&&(s=a),r=i.details,r!==void 0&&(r=Cd(r))}}catch{}return n==="ok"?null:new oa(n,s,r)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _Y{constructor(e,n,s){this.auth=null,this.messaging=null,this.appCheck=null,this.auth=e.getImmediate({optional:!0}),this.messaging=n.getImmediate({optional:!0}),this.auth||e.get().then(r=>this.auth=r,()=>{}),this.messaging||n.get().then(r=>this.messaging=r,()=>{}),this.appCheck||s.get().then(r=>this.appCheck=r,()=>{})}async getAuthToken(){if(!!this.auth)try{const e=await this.auth.getToken();return e==null?void 0:e.accessToken}catch{return}}async getMessagingToken(){if(!(!this.messaging||!("Notification"in self)||Notification.permission!=="granted"))try{return await this.messaging.getToken()}catch{return}}async getAppCheckToken(){if(this.appCheck){const e=await this.appCheck.getToken();return e.error?null:e.token}return null}async getContext(){const e=await this.getAuthToken(),n=await this.getMessagingToken(),s=await this.getAppCheckToken();return{authToken:e,messagingToken:n,appCheckToken:s}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wT="us-central1";function yY(t){let e=null;return{promise:new Promise((n,s)=>{e=setTimeout(()=>{s(new oa("deadline-exceeded","deadline-exceeded"))},t)}),cancel:()=>{e&&clearTimeout(e)}}}class vY{constructor(e,n,s,r,i=wT,o){this.app=e,this.fetchImpl=o,this.emulatorOrigin=null,this.contextProvider=new _Y(n,s,r),this.cancelAllRequests=new Promise(a=>{this.deleteService=()=>Promise.resolve(a())});try{const a=new URL(i);this.customDomain=a.origin,this.region=wT}catch{this.customDomain=null,this.region=i}}_delete(){return this.deleteService()}_url(e){const n=this.app.options.projectId;return this.emulatorOrigin!==null?`${this.emulatorOrigin}/${n}/${this.region}/${e}`:this.customDomain!==null?`${this.customDomain}/${e}`:`https://${this.region}-${n}.cloudfunctions.net/${e}`}}function wY(t,e,n){t.emulatorOrigin=`http://${e}:${n}`}function bY(t,e,n){return s=>TY(t,e,s,n||{})}function IY(t,e,n){return s=>nD(t,e,s,n||{})}async function EY(t,e,n,s){n["Content-Type"]="application/json";let r;try{r=await s(t,{method:"POST",body:JSON.stringify(e),headers:n})}catch{return{status:0,json:null}}let i=null;try{i=await r.json()}catch{}return{status:r.status,json:i}}function TY(t,e,n,s){const r=t._url(e);return nD(t,r,n,s)}async function nD(t,e,n,s){n=Gm(n);const r={data:n},i={},o=await t.contextProvider.getContext();o.authToken&&(i.Authorization="Bearer "+o.authToken),o.messagingToken&&(i["Firebase-Instance-ID-Token"]=o.messagingToken),o.appCheckToken!==null&&(i["X-Firebase-AppCheck"]=o.appCheckToken);const a=s.timeout||7e4,c=yY(a),l=await Promise.race([EY(e,r,i,t.fetchImpl),c.promise,t.cancelAllRequests]);if(c.cancel(),!l)throw new oa("cancelled","Firebase Functions instance was deleted.");const u=mY(l.status,l.json);if(u)throw u;if(!l.json)throw new oa("internal","Response is not valid JSON object.");let h=l.json.data;if(typeof h=="undefined"&&(h=l.json.result),typeof h=="undefined")throw new oa("internal","Response is missing data field.");return{data:Cd(h)}}const bT="@firebase/functions",IT="0.8.4";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SY="auth-internal",CY="app-check-internal",AY="messaging-internal";function kY(t,e){const n=(s,{instanceIdentifier:r})=>{const i=s.getProvider("app").getImmediate(),o=s.getProvider(SY),a=s.getProvider(AY),c=s.getProvider(CY);return new vY(i,o,a,c,r,t)};nt(new Ee(tD,n,"PUBLIC").setMultipleInstances(!0)),Le(bT,IT,e),Le(bT,IT,"esm2017")}function ET(t,e,n){wY(A(t),e,n)}function RY(t,e,n){return bY(A(t),e,n)}function NY(t,e,n){return IY(A(t),e,n)}kY(fetch.bind(self));const PY="@firebase/functions-compat",DY="0.2.4";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sD{constructor(e,n){this.app=e,this._delegate=n,this._region=this._delegate.region,this._customDomain=this._delegate.customDomain}httpsCallable(e,n){return RY(this._delegate,e,n)}httpsCallableFromURL(e,n){return NY(this._delegate,e,n)}useFunctionsEmulator(e){const n=e.match("[a-zA-Z]+://([a-zA-Z0-9.-]+)(?::([0-9]+))?");if(n==null)throw new ct("functions","No origin provided to useFunctionsEmulator()");if(n[2]==null)throw new ct("functions","Port missing in origin provided to useFunctionsEmulator()");return ET(this._delegate,n[1],Number(n[2]))}useEmulator(e,n){return ET(this._delegate,e,n)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xY="us-central1",OY=(t,{instanceIdentifier:e})=>{const n=t.getProvider("app-compat").getImmediate(),s=t.getProvider("functions").getImmediate({identifier:e!=null?e:xY});return new sD(n,s)};function MY(){const t={Functions:sD};lt.INTERNAL.registerComponent(new Ee("functions-compat",OY,"PUBLIC").setServiceProps(t).setMultipleInstances(!0))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */MY();lt.registerVersion(PY,DY);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LY="/firebase-messaging-sw.js",FY="/firebase-cloud-messaging-push-scope",rD="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",UY="https://fcmregistrations.googleapis.com/v1",iD="google.c.a.c_id",$Y="google.c.a.c_l",VY="google.c.a.ts",BY="google.c.a.e";var TT;(function(t){t[t.DATA_MESSAGE=1]="DATA_MESSAGE",t[t.DISPLAY_NOTIFICATION=3]="DISPLAY_NOTIFICATION"})(TT||(TT={}));/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License"); you may not use this file except
 * in compliance with the License. You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software distributed under the License
 * is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express
 * or implied. See the License for the specific language governing permissions and limitations under
 * the License.
 */var Xl;(function(t){t.PUSH_RECEIVED="push-received",t.NOTIFICATION_CLICKED="notification-clicked"})(Xl||(Xl={}));/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function js(t){const e=new Uint8Array(t);return btoa(String.fromCharCode(...e)).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function qY(t){const e="=".repeat((4-t.length%4)%4),n=(t+e).replace(/\-/g,"+").replace(/_/g,"/"),s=atob(n),r=new Uint8Array(s.length);for(let i=0;i<s.length;++i)r[i]=s.charCodeAt(i);return r}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ng="fcm_token_details_db",jY=5,ST="fcm_token_object_Store";async function KY(t){if("databases"in indexedDB&&!(await indexedDB.databases()).map(i=>i.name).includes(ng))return null;let e=null;return(await $a(ng,jY,{upgrade:async(s,r,i,o)=>{var a;if(r<2||!s.objectStoreNames.contains(ST))return;const c=o.objectStore(ST),l=await c.index("fcmSenderId").get(t);if(await c.clear(),!!l){if(r===2){const u=l;if(!u.auth||!u.p256dh||!u.endpoint)return;e={token:u.fcmToken,createTime:(a=u.createTime)!==null&&a!==void 0?a:Date.now(),subscriptionOptions:{auth:u.auth,p256dh:u.p256dh,endpoint:u.endpoint,swScope:u.swScope,vapidKey:typeof u.vapidKey=="string"?u.vapidKey:js(u.vapidKey)}}}else if(r===3){const u=l;e={token:u.fcmToken,createTime:u.createTime,subscriptionOptions:{auth:js(u.auth),p256dh:js(u.p256dh),endpoint:u.endpoint,swScope:u.swScope,vapidKey:js(u.vapidKey)}}}else if(r===4){const u=l;e={token:u.fcmToken,createTime:u.createTime,subscriptionOptions:{auth:js(u.auth),p256dh:js(u.p256dh),endpoint:u.endpoint,swScope:u.swScope,vapidKey:js(u.vapidKey)}}}}}})).close(),await Jo(ng),await Jo("fcm_vapid_details_db"),await Jo("undefined"),WY(e)?e:null}function WY(t){if(!t||!t.subscriptionOptions)return!1;const{subscriptionOptions:e}=t;return typeof t.createTime=="number"&&t.createTime>0&&typeof t.token=="string"&&t.token.length>0&&typeof e.auth=="string"&&e.auth.length>0&&typeof e.p256dh=="string"&&e.p256dh.length>0&&typeof e.endpoint=="string"&&e.endpoint.length>0&&typeof e.swScope=="string"&&e.swScope.length>0&&typeof e.vapidKey=="string"&&e.vapidKey.length>0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HY="firebase-messaging-database",GY=1,mo="firebase-messaging-store";let sg=null;function ow(){return sg||(sg=$a(HY,GY,{upgrade:(t,e)=>{switch(e){case 0:t.createObjectStore(mo)}}})),sg}async function oD(t){const e=cw(t),s=await(await ow()).transaction(mo).objectStore(mo).get(e);if(s)return s;{const r=await KY(t.appConfig.senderId);if(r)return await aw(t,r),r}}async function aw(t,e){const n=cw(t),r=(await ow()).transaction(mo,"readwrite");return await r.objectStore(mo).put(e,n),await r.done,e}async function zY(t){const e=cw(t),s=(await ow()).transaction(mo,"readwrite");await s.objectStore(mo).delete(e),await s.done}function cw({appConfig:t}){return t.appId}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QY={["missing-app-config-values"]:'Missing App configuration value: "{$valueName}"',["only-available-in-window"]:"This method is available in a Window context.",["only-available-in-sw"]:"This method is available in a service worker context.",["permission-default"]:"The notification permission was not granted and dismissed instead.",["permission-blocked"]:"The notification permission was not granted and blocked instead.",["unsupported-browser"]:"This browser doesn't support the API's required to use the Firebase SDK.",["indexed-db-unsupported"]:"This browser doesn't support indexedDb.open() (ex. Safari iFrame, Firefox Private Browsing, etc)",["failed-service-worker-registration"]:"We are unable to register the default service worker. {$browserErrorMessage}",["token-subscribe-failed"]:"A problem occurred while subscribing the user to FCM: {$errorInfo}",["token-subscribe-no-token"]:"FCM returned no token when subscribing the user to push.",["token-unsubscribe-failed"]:"A problem occurred while unsubscribing the user from FCM: {$errorInfo}",["token-update-failed"]:"A problem occurred while updating the user from FCM: {$errorInfo}",["token-update-no-token"]:"FCM returned no token when updating the user to push.",["use-sw-after-get-token"]:"The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.",["invalid-sw-registration"]:"The input to useServiceWorker() must be a ServiceWorkerRegistration.",["invalid-bg-handler"]:"The input to setBackgroundMessageHandler() must be a function.",["invalid-vapid-key"]:"The public VAPID key must be a string.",["use-vapid-key-after-get-token"]:"The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used."},hn=new dn("messaging","Messaging",QY);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function YY(t,e){var n;const s=await uw(t),r=cD(e),i={method:"POST",headers:s,body:JSON.stringify(r)};let o;try{o=await(await fetch(lw(t.appConfig),i)).json()}catch(a){throw hn.create("token-subscribe-failed",{errorInfo:(n=a)===null||n===void 0?void 0:n.toString()})}if(o.error){const a=o.error.message;throw hn.create("token-subscribe-failed",{errorInfo:a})}if(!o.token)throw hn.create("token-subscribe-no-token");return o.token}async function JY(t,e){var n;const s=await uw(t),r=cD(e.subscriptionOptions),i={method:"PATCH",headers:s,body:JSON.stringify(r)};let o;try{o=await(await fetch(`${lw(t.appConfig)}/${e.token}`,i)).json()}catch(a){throw hn.create("token-update-failed",{errorInfo:(n=a)===null||n===void 0?void 0:n.toString()})}if(o.error){const a=o.error.message;throw hn.create("token-update-failed",{errorInfo:a})}if(!o.token)throw hn.create("token-update-no-token");return o.token}async function aD(t,e){var n;const s=await uw(t),r={method:"DELETE",headers:s};try{const o=await(await fetch(`${lw(t.appConfig)}/${e}`,r)).json();if(o.error){const a=o.error.message;throw hn.create("token-unsubscribe-failed",{errorInfo:a})}}catch(i){throw hn.create("token-unsubscribe-failed",{errorInfo:(n=i)===null||n===void 0?void 0:n.toString()})}}function lw({projectId:t}){return`${UY}/projects/${t}/registrations`}async function uw({appConfig:t,installations:e}){const n=await e.getToken();return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t.apiKey,"x-goog-firebase-installations-auth":`FIS ${n}`})}function cD({p256dh:t,auth:e,endpoint:n,vapidKey:s}){const r={web:{endpoint:n,auth:e,p256dh:t}};return s!==rD&&(r.web.applicationPubKey=s),r}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XY=7*24*60*60*1e3;async function ZY(t){const e=await t3(t.swRegistration,t.vapidKey),n={vapidKey:t.vapidKey,swScope:t.swRegistration.scope,endpoint:e.endpoint,auth:js(e.getKey("auth")),p256dh:js(e.getKey("p256dh"))},s=await oD(t.firebaseDependencies);if(s){if(n3(s.subscriptionOptions,n))return Date.now()>=s.createTime+XY?e3(t,{token:s.token,createTime:Date.now(),subscriptionOptions:n}):s.token;try{await aD(t.firebaseDependencies,s.token)}catch(r){console.warn(r)}return CT(t.firebaseDependencies,n)}else return CT(t.firebaseDependencies,n)}async function lD(t){const e=await oD(t.firebaseDependencies);e&&(await aD(t.firebaseDependencies,e.token),await zY(t.firebaseDependencies));const n=await t.swRegistration.pushManager.getSubscription();return n?n.unsubscribe():!0}async function e3(t,e){try{const n=await JY(t.firebaseDependencies,e),s=Object.assign(Object.assign({},e),{token:n,createTime:Date.now()});return await aw(t.firebaseDependencies,s),n}catch(n){throw await lD(t),n}}async function CT(t,e){const s={token:await YY(t,e),createTime:Date.now(),subscriptionOptions:e};return await aw(t,s),s.token}async function t3(t,e){const n=await t.pushManager.getSubscription();return n||t.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:qY(e)})}function n3(t,e){const n=e.vapidKey===t.vapidKey,s=e.endpoint===t.endpoint,r=e.auth===t.auth,i=e.p256dh===t.p256dh;return n&&s&&r&&i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function AT(t){const e={from:t.from,collapseKey:t.collapse_key,messageId:t.fcmMessageId};return s3(e,t),r3(e,t),i3(e,t),e}function s3(t,e){if(!e.notification)return;t.notification={};const n=e.notification.title;n&&(t.notification.title=n);const s=e.notification.body;s&&(t.notification.body=s);const r=e.notification.image;r&&(t.notification.image=r)}function r3(t,e){!e.data||(t.data=e.data)}function i3(t,e){var n,s,r,i,o;if(!e.fcmOptions&&!(!((n=e.notification)===null||n===void 0)&&n.click_action))return;t.fcmOptions={};const a=(r=(s=e.fcmOptions)===null||s===void 0?void 0:s.link)!==null&&r!==void 0?r:(i=e.notification)===null||i===void 0?void 0:i.click_action;a&&(t.fcmOptions.link=a);const c=(o=e.fcmOptions)===null||o===void 0?void 0:o.analytics_label;c&&(t.fcmOptions.analyticsLabel=c)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function o3(t){return typeof t=="object"&&!!t&&iD in t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */uD("hts/frbslgigp.ogepscmv/ieo/eaylg","tp:/ieaeogn-agolai.o/1frlglgc/o");uD("AzSCbw63g1R0nCw85jG8","Iaya3yLKwmgvh7cF0q4");function uD(t,e){const n=[];for(let s=0;s<t.length;s++)n.push(t.charAt(s)),s<e.length&&n.push(e.charAt(s));return n.join("")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function a3(t){if(!t||!t.options)throw rg("App Configuration Object");if(!t.name)throw rg("App Name");const e=["projectId","apiKey","appId","messagingSenderId"],{options:n}=t;for(const s of e)if(!n[s])throw rg(s);return{appName:t.name,projectId:n.projectId,apiKey:n.apiKey,appId:n.appId,senderId:n.messagingSenderId}}function rg(t){return hn.create("missing-app-config-values",{valueName:t})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c3{constructor(e,n,s){this.deliveryMetricsExportedToBigQueryEnabled=!1,this.onBackgroundMessageHandler=null,this.onMessageHandler=null,this.logEvents=[],this.isLogServiceStarted=!1;const r=a3(e);this.firebaseDependencies={app:e,appConfig:r,installations:n,analyticsProvider:s}}_delete(){return Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function hD(t){var e;try{t.swRegistration=await navigator.serviceWorker.register(LY,{scope:FY}),t.swRegistration.update().catch(()=>{})}catch(n){throw hn.create("failed-service-worker-registration",{browserErrorMessage:(e=n)===null||e===void 0?void 0:e.message})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function l3(t,e){if(!e&&!t.swRegistration&&await hD(t),!(!e&&!!t.swRegistration)){if(!(e instanceof ServiceWorkerRegistration))throw hn.create("invalid-sw-registration");t.swRegistration=e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function u3(t,e){e?t.vapidKey=e:t.vapidKey||(t.vapidKey=rD)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function dD(t,e){if(!navigator)throw hn.create("only-available-in-window");if(Notification.permission==="default"&&await Notification.requestPermission(),Notification.permission!=="granted")throw hn.create("permission-blocked");return await u3(t,e==null?void 0:e.vapidKey),await l3(t,e==null?void 0:e.serviceWorkerRegistration),ZY(t)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function h3(t,e,n){const s=d3(e);(await t.firebaseDependencies.analyticsProvider.get()).logEvent(s,{message_id:n[iD],message_name:n[$Y],message_time:n[VY],message_device_time:Math.floor(Date.now()/1e3)})}function d3(t){switch(t){case Xl.NOTIFICATION_CLICKED:return"notification_open";case Xl.PUSH_RECEIVED:return"notification_foreground";default:throw new Error}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function f3(t,e){const n=e.data;if(!n.isFirebaseMessaging)return;t.onMessageHandler&&n.messageType===Xl.PUSH_RECEIVED&&(typeof t.onMessageHandler=="function"?t.onMessageHandler(AT(n)):t.onMessageHandler.next(AT(n)));const s=n.data;o3(s)&&s[BY]==="1"&&await h3(t,n.messageType,s)}const kT="@firebase/messaging",RT="0.9.16";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const p3=t=>{const e=new c3(t.getProvider("app").getImmediate(),t.getProvider("installations-internal").getImmediate(),t.getProvider("analytics-internal"));return navigator.serviceWorker.addEventListener("message",n=>f3(e,n)),e},g3=t=>{const e=t.getProvider("messaging").getImmediate();return{getToken:s=>dD(e,s)}};function m3(){nt(new Ee("messaging",p3,"PUBLIC")),nt(new Ee("messaging-internal",g3,"PRIVATE")),Le(kT,RT),Le(kT,RT,"esm2017")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _3(t){if(!navigator)throw hn.create("only-available-in-window");return t.swRegistration||await hD(t),lD(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function y3(t,e){if(!navigator)throw hn.create("only-available-in-window");return t.onMessageHandler=e,()=>{t.onMessageHandler=null}}async function v3(t,e){return t=A(t),dD(t,e)}function w3(t){return t=A(t),_3(t)}function b3(t,e){return t=A(t),y3(t,e)}m3();/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fD="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",I3="https://fcmregistrations.googleapis.com/v1",pD="FCM_MSG",E3="google.c.a.c_id",T3=3,S3=1;var Ad;(function(t){t[t.DATA_MESSAGE=1]="DATA_MESSAGE",t[t.DISPLAY_NOTIFICATION=3]="DISPLAY_NOTIFICATION"})(Ad||(Ad={}));/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License"); you may not use this file except
 * in compliance with the License. You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software distributed under the License
 * is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express
 * or implied. See the License for the specific language governing permissions and limitations under
 * the License.
 */var kd;(function(t){t.PUSH_RECEIVED="push-received",t.NOTIFICATION_CLICKED="notification-clicked"})(kd||(kd={}));/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ks(t){const e=new Uint8Array(t);return btoa(String.fromCharCode(...e)).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function C3(t){const e="=".repeat((4-t.length%4)%4),n=(t+e).replace(/\-/g,"+").replace(/_/g,"/"),s=atob(n),r=new Uint8Array(s.length);for(let i=0;i<s.length;++i)r[i]=s.charCodeAt(i);return r}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ig="fcm_token_details_db",A3=5,NT="fcm_token_object_Store";async function k3(t){if("databases"in indexedDB&&!(await indexedDB.databases()).map(i=>i.name).includes(ig))return null;let e=null;return(await $a(ig,A3,{upgrade:async(s,r,i,o)=>{var a;if(r<2||!s.objectStoreNames.contains(NT))return;const c=o.objectStore(NT),l=await c.index("fcmSenderId").get(t);if(await c.clear(),!!l){if(r===2){const u=l;if(!u.auth||!u.p256dh||!u.endpoint)return;e={token:u.fcmToken,createTime:(a=u.createTime)!==null&&a!==void 0?a:Date.now(),subscriptionOptions:{auth:u.auth,p256dh:u.p256dh,endpoint:u.endpoint,swScope:u.swScope,vapidKey:typeof u.vapidKey=="string"?u.vapidKey:Ks(u.vapidKey)}}}else if(r===3){const u=l;e={token:u.fcmToken,createTime:u.createTime,subscriptionOptions:{auth:Ks(u.auth),p256dh:Ks(u.p256dh),endpoint:u.endpoint,swScope:u.swScope,vapidKey:Ks(u.vapidKey)}}}else if(r===4){const u=l;e={token:u.fcmToken,createTime:u.createTime,subscriptionOptions:{auth:Ks(u.auth),p256dh:Ks(u.p256dh),endpoint:u.endpoint,swScope:u.swScope,vapidKey:Ks(u.vapidKey)}}}}}})).close(),await Jo(ig),await Jo("fcm_vapid_details_db"),await Jo("undefined"),R3(e)?e:null}function R3(t){if(!t||!t.subscriptionOptions)return!1;const{subscriptionOptions:e}=t;return typeof t.createTime=="number"&&t.createTime>0&&typeof t.token=="string"&&t.token.length>0&&typeof e.auth=="string"&&e.auth.length>0&&typeof e.p256dh=="string"&&e.p256dh.length>0&&typeof e.endpoint=="string"&&e.endpoint.length>0&&typeof e.swScope=="string"&&e.swScope.length>0&&typeof e.vapidKey=="string"&&e.vapidKey.length>0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const N3="firebase-messaging-database",P3=1,_o="firebase-messaging-store";let og=null;function hw(){return og||(og=$a(N3,P3,{upgrade:(t,e)=>{switch(e){case 0:t.createObjectStore(_o)}}})),og}async function dw(t){const e=pw(t),s=await(await hw()).transaction(_o).objectStore(_o).get(e);if(s)return s;{const r=await k3(t.appConfig.senderId);if(r)return await fw(t,r),r}}async function fw(t,e){const n=pw(t),r=(await hw()).transaction(_o,"readwrite");return await r.objectStore(_o).put(e,n),await r.done,e}async function D3(t){const e=pw(t),s=(await hw()).transaction(_o,"readwrite");await s.objectStore(_o).delete(e),await s.done}function pw({appConfig:t}){return t.appId}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const x3={["missing-app-config-values"]:'Missing App configuration value: "{$valueName}"',["only-available-in-window"]:"This method is available in a Window context.",["only-available-in-sw"]:"This method is available in a service worker context.",["permission-default"]:"The notification permission was not granted and dismissed instead.",["permission-blocked"]:"The notification permission was not granted and blocked instead.",["unsupported-browser"]:"This browser doesn't support the API's required to use the Firebase SDK.",["indexed-db-unsupported"]:"This browser doesn't support indexedDb.open() (ex. Safari iFrame, Firefox Private Browsing, etc)",["failed-service-worker-registration"]:"We are unable to register the default service worker. {$browserErrorMessage}",["token-subscribe-failed"]:"A problem occurred while subscribing the user to FCM: {$errorInfo}",["token-subscribe-no-token"]:"FCM returned no token when subscribing the user to push.",["token-unsubscribe-failed"]:"A problem occurred while unsubscribing the user from FCM: {$errorInfo}",["token-update-failed"]:"A problem occurred while updating the user from FCM: {$errorInfo}",["token-update-no-token"]:"FCM returned no token when updating the user to push.",["use-sw-after-get-token"]:"The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.",["invalid-sw-registration"]:"The input to useServiceWorker() must be a ServiceWorkerRegistration.",["invalid-bg-handler"]:"The input to setBackgroundMessageHandler() must be a function.",["invalid-vapid-key"]:"The public VAPID key must be a string.",["use-vapid-key-after-get-token"]:"The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used."},Ns=new dn("messaging","Messaging",x3);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function O3(t,e){var n;const s=await mw(t),r=mD(e),i={method:"POST",headers:s,body:JSON.stringify(r)};let o;try{o=await(await fetch(gw(t.appConfig),i)).json()}catch(a){throw Ns.create("token-subscribe-failed",{errorInfo:(n=a)===null||n===void 0?void 0:n.toString()})}if(o.error){const a=o.error.message;throw Ns.create("token-subscribe-failed",{errorInfo:a})}if(!o.token)throw Ns.create("token-subscribe-no-token");return o.token}async function M3(t,e){var n;const s=await mw(t),r=mD(e.subscriptionOptions),i={method:"PATCH",headers:s,body:JSON.stringify(r)};let o;try{o=await(await fetch(`${gw(t.appConfig)}/${e.token}`,i)).json()}catch(a){throw Ns.create("token-update-failed",{errorInfo:(n=a)===null||n===void 0?void 0:n.toString()})}if(o.error){const a=o.error.message;throw Ns.create("token-update-failed",{errorInfo:a})}if(!o.token)throw Ns.create("token-update-no-token");return o.token}async function gD(t,e){var n;const s=await mw(t),r={method:"DELETE",headers:s};try{const o=await(await fetch(`${gw(t.appConfig)}/${e}`,r)).json();if(o.error){const a=o.error.message;throw Ns.create("token-unsubscribe-failed",{errorInfo:a})}}catch(i){throw Ns.create("token-unsubscribe-failed",{errorInfo:(n=i)===null||n===void 0?void 0:n.toString()})}}function gw({projectId:t}){return`${I3}/projects/${t}/registrations`}async function mw({appConfig:t,installations:e}){const n=await e.getToken();return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t.apiKey,"x-goog-firebase-installations-auth":`FIS ${n}`})}function mD({p256dh:t,auth:e,endpoint:n,vapidKey:s}){const r={web:{endpoint:n,auth:e,p256dh:t}};return s!==fD&&(r.web.applicationPubKey=s),r}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const L3=7*24*60*60*1e3;async function F3(t){const e=await $3(t.swRegistration,t.vapidKey),n={vapidKey:t.vapidKey,swScope:t.swRegistration.scope,endpoint:e.endpoint,auth:Ks(e.getKey("auth")),p256dh:Ks(e.getKey("p256dh"))},s=await dw(t.firebaseDependencies);if(s){if(V3(s.subscriptionOptions,n))return Date.now()>=s.createTime+L3?U3(t,{token:s.token,createTime:Date.now(),subscriptionOptions:n}):s.token;try{await gD(t.firebaseDependencies,s.token)}catch(r){console.warn(r)}return PT(t.firebaseDependencies,n)}else return PT(t.firebaseDependencies,n)}async function zm(t){const e=await dw(t.firebaseDependencies);e&&(await gD(t.firebaseDependencies,e.token),await D3(t.firebaseDependencies));const n=await t.swRegistration.pushManager.getSubscription();return n?n.unsubscribe():!0}async function U3(t,e){try{const n=await M3(t.firebaseDependencies,e),s=Object.assign(Object.assign({},e),{token:n,createTime:Date.now()});return await fw(t.firebaseDependencies,s),n}catch(n){throw await zm(t),n}}async function PT(t,e){const s={token:await O3(t,e),createTime:Date.now(),subscriptionOptions:e};return await fw(t,s),s.token}async function $3(t,e){const n=await t.pushManager.getSubscription();return n||t.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:C3(e)})}function V3(t,e){const n=e.vapidKey===t.vapidKey,s=e.endpoint===t.endpoint,r=e.auth===t.auth,i=e.p256dh===t.p256dh;return n&&s&&r&&i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function B3(t){const e={from:t.from,collapseKey:t.collapse_key,messageId:t.fcmMessageId};return q3(e,t),j3(e,t),K3(e,t),e}function q3(t,e){if(!e.notification)return;t.notification={};const n=e.notification.title;n&&(t.notification.title=n);const s=e.notification.body;s&&(t.notification.body=s);const r=e.notification.image;r&&(t.notification.image=r)}function j3(t,e){!e.data||(t.data=e.data)}function K3(t,e){var n,s,r,i,o;if(!e.fcmOptions&&!(!((n=e.notification)===null||n===void 0)&&n.click_action))return;t.fcmOptions={};const a=(r=(s=e.fcmOptions)===null||s===void 0?void 0:s.link)!==null&&r!==void 0?r:(i=e.notification)===null||i===void 0?void 0:i.click_action;a&&(t.fcmOptions.link=a);const c=(o=e.fcmOptions)===null||o===void 0?void 0:o.analytics_label;c&&(t.fcmOptions.analyticsLabel=c)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function W3(t){return typeof t=="object"&&!!t&&E3 in t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function H3(t){return new Promise(e=>{setTimeout(e,t)})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */_D("hts/frbslgigp.ogepscmv/ieo/eaylg","tp:/ieaeogn-agolai.o/1frlglgc/o");_D("AzSCbw63g1R0nCw85jG8","Iaya3yLKwmgvh7cF0q4");async function G3(t,e){const n=z3(e,await t.firebaseDependencies.installations.getId());Q3(t,n)}function z3(t,e){var n,s;const r={};return t.from&&(r.project_number=t.from),t.fcmMessageId&&(r.message_id=t.fcmMessageId),r.instance_id=e,t.notification?r.message_type=Ad.DISPLAY_NOTIFICATION.toString():r.message_type=Ad.DATA_MESSAGE.toString(),r.sdk_platform=T3.toString(),r.package_name=self.origin.replace(/(^\w+:|^)\/\//,""),t.collapse_key&&(r.collapse_key=t.collapse_key),r.event=S3.toString(),!((n=t.fcmOptions)===null||n===void 0)&&n.analytics_label&&(r.analytics_label=(s=t.fcmOptions)===null||s===void 0?void 0:s.analytics_label),r}function Q3(t,e){const n={};n.event_time_ms=Math.floor(Date.now()).toString(),n.source_extension_json_proto3=JSON.stringify(e),t.logEvents.push(n)}function _D(t,e){const n=[];for(let s=0;s<t.length;s++)n.push(t.charAt(s)),s<e.length&&n.push(e.charAt(s));return n.join("")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Y3(t,e){var n,s;const{newSubscription:r}=t;if(!r){await zm(e);return}const i=await dw(e.firebaseDependencies);await zm(e),e.vapidKey=(s=(n=i==null?void 0:i.subscriptionOptions)===null||n===void 0?void 0:n.vapidKey)!==null&&s!==void 0?s:fD,await F3(e)}async function J3(t,e){const n=e5(t);if(!n)return;e.deliveryMetricsExportedToBigQueryEnabled&&await G3(e,n);const s=await yD();if(n5(s))return s5(s,n);if(n.notification&&await r5(Z3(n)),!!e&&e.onBackgroundMessageHandler){const r=B3(n);typeof e.onBackgroundMessageHandler=="function"?await e.onBackgroundMessageHandler(r):e.onBackgroundMessageHandler.next(r)}}async function X3(t){var e,n;const s=(n=(e=t.notification)===null||e===void 0?void 0:e.data)===null||n===void 0?void 0:n[pD];if(s){if(t.action)return}else return;t.stopImmediatePropagation(),t.notification.close();const r=i5(s);if(!r)return;const i=new URL(r,self.location.href),o=new URL(self.location.origin);if(i.host!==o.host)return;let a=await t5(i);if(a?a=await a.focus():(a=await self.clients.openWindow(r),await H3(3e3)),!!a)return s.messageType=kd.NOTIFICATION_CLICKED,s.isFirebaseMessaging=!0,a.postMessage(s)}function Z3(t){const e=Object.assign({},t.notification);return e.data={[pD]:t},e}function e5({data:t}){if(!t)return null;try{return t.json()}catch{return null}}async function t5(t){const e=await yD();for(const n of e){const s=new URL(n.url,self.location.href);if(t.host===s.host)return n}return null}function n5(t){return t.some(e=>e.visibilityState==="visible"&&!e.url.startsWith("chrome-extension://"))}function s5(t,e){e.isFirebaseMessaging=!0,e.messageType=kd.PUSH_RECEIVED;for(const n of t)n.postMessage(e)}function yD(){return self.clients.matchAll({type:"window",includeUncontrolled:!0})}function r5(t){var e;const{actions:n}=t,{maxActions:s}=Notification;return n&&s&&n.length>s&&console.warn(`This browser only supports ${s} actions. The remaining actions will not be displayed.`),self.registration.showNotification((e=t.title)!==null&&e!==void 0?e:"",t)}function i5(t){var e,n,s;const r=(n=(e=t.fcmOptions)===null||e===void 0?void 0:e.link)!==null&&n!==void 0?n:(s=t.notification)===null||s===void 0?void 0:s.click_action;return r||(W3(t.data)?self.location.origin:null)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function o5(t){if(!t||!t.options)throw ag("App Configuration Object");if(!t.name)throw ag("App Name");const e=["projectId","apiKey","appId","messagingSenderId"],{options:n}=t;for(const s of e)if(!n[s])throw ag(s);return{appName:t.name,projectId:n.projectId,apiKey:n.apiKey,appId:n.appId,senderId:n.messagingSenderId}}function ag(t){return Ns.create("missing-app-config-values",{valueName:t})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class a5{constructor(e,n,s){this.deliveryMetricsExportedToBigQueryEnabled=!1,this.onBackgroundMessageHandler=null,this.onMessageHandler=null,this.logEvents=[],this.isLogServiceStarted=!1;const r=o5(e);this.firebaseDependencies={app:e,appConfig:r,installations:n,analyticsProvider:s}}_delete(){return Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const c5=t=>{const e=new a5(t.getProvider("app").getImmediate(),t.getProvider("installations-internal").getImmediate(),t.getProvider("analytics-internal"));return self.addEventListener("push",n=>{n.waitUntil(J3(n,e))}),self.addEventListener("pushsubscriptionchange",n=>{n.waitUntil(Y3(n,e))}),self.addEventListener("notificationclick",n=>{n.waitUntil(X3(n))}),e};function l5(){nt(new Ee("messaging-sw",c5,"PUBLIC"))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function u5(t,e){if(self.document!==void 0)throw Ns.create("only-available-in-sw");return t.onBackgroundMessageHandler=e,()=>{t.onBackgroundMessageHandler=null}}function h5(t,e){return t=A(t),u5(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */l5();const d5="@firebase/messaging-compat",f5="0.1.16";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function p5(){return self&&"ServiceWorkerGlobalScope"in self?m5():g5()}function g5(){return typeof window!="undefined"&&bn()&&zd()&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")}function m5(){return bn()&&"PushManager"in self&&"Notification"in self&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")}class DT{constructor(e,n){this.app=e,this._delegate=n,this.app=e,this._delegate=n}async getToken(e){return v3(this._delegate,e)}async deleteToken(){return w3(this._delegate)}onMessage(e){return b3(this._delegate,e)}onBackgroundMessage(e){return h5(this._delegate,e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _5=t=>self&&"ServiceWorkerGlobalScope"in self?new DT(t.getProvider("app-compat").getImmediate(),t.getProvider("messaging-sw").getImmediate()):new DT(t.getProvider("app-compat").getImmediate(),t.getProvider("messaging").getImmediate()),y5={isSupported:p5};function v5(){lt.INTERNAL.registerComponent(new Ee("messaging-compat",_5,"PUBLIC").setServiceProps(y5))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */v5();lt.registerVersion(d5,f5);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vD="firebasestorage.googleapis.com",wD="storageBucket",w5=2*60*1e3,b5=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class it extends ct{constructor(e,n){super(cg(e),`Firebase Storage: ${n} (${cg(e)})`),this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,it.prototype)}_codeEquals(e){return cg(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}function cg(t){return"storage/"+t}function _w(){const t="An unknown error occurred, please check the error payload for server response.";return new it("unknown",t)}function I5(t){return new it("object-not-found","Object '"+t+"' does not exist.")}function E5(t){return new it("quota-exceeded","Quota for bucket '"+t+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function T5(){const t="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new it("unauthenticated",t)}function S5(){return new it("unauthorized-app","This app does not have permission to access Firebase Storage on this project.")}function C5(t){return new it("unauthorized","User does not have permission to access '"+t+"'.")}function A5(){return new it("retry-limit-exceeded","Max retry time for operation exceeded, please try again.")}function bD(){return new it("canceled","User canceled the upload/download.")}function k5(t){return new it("invalid-url","Invalid URL '"+t+"'.")}function R5(t){return new it("invalid-default-bucket","Invalid default bucket '"+t+"'.")}function N5(){return new it("no-default-bucket","No default bucket found. Did you set the '"+wD+"' property when initializing the app?")}function ID(){return new it("cannot-slice-blob","Cannot slice blob for upload. Please retry the upload.")}function P5(){return new it("server-file-wrong-size","Server recorded incorrect upload file size, please retry the upload.")}function D5(){return new it("no-download-url","The given file does not have any download URLs.")}function aa(t){return new it("invalid-argument",t)}function ED(){return new it("app-deleted","The Firebase app was deleted.")}function TD(t){return new it("invalid-root-operation","The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function Xc(t,e){return new it("invalid-format","String does not match format '"+t+"': "+e)}function Ic(t){throw new it("internal-error","Internal error: "+t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qt{constructor(e,n){this.bucket=e,this.path_=n}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,n){let s;try{s=Qt.makeFromUrl(e,n)}catch{return new Qt(e,"")}if(s.path==="")return s;throw R5(e)}static makeFromUrl(e,n){let s=null;const r="([A-Za-z0-9.\\-_]+)";function i(M){M.path.charAt(M.path.length-1)==="/"&&(M.path_=M.path_.slice(0,-1))}const o="(/(.*))?$",a=new RegExp("^gs://"+r+o,"i"),c={bucket:1,path:3};function l(M){M.path_=decodeURIComponent(M.path)}const u="v[A-Za-z0-9_]+",h=n.replace(/[.]/g,"\\."),d="(/([^?#]*).*)?$",f=new RegExp(`^https?://${h}/${u}/b/${r}/o${d}`,"i"),p={bucket:1,path:3},_=n===vD?"(?:storage.googleapis.com|storage.cloud.google.com)":n,y="([^?#]*)",I=new RegExp(`^https?://${_}/${r}/${y}`,"i"),k=[{regex:a,indices:c,postModify:i},{regex:f,indices:p,postModify:l},{regex:I,indices:{bucket:1,path:2},postModify:l}];for(let M=0;M<k.length;M++){const j=k[M],Y=j.regex.exec(e);if(Y){const z=Y[j.indices.bucket];let V=Y[j.indices.path];V||(V=""),s=new Qt(z,V),j.postModify(s);break}}if(s==null)throw k5(e);return s}}class x5{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function O5(t,e,n){let s=1,r=null,i=null,o=!1,a=0;function c(){return a===2}let l=!1;function u(...y){l||(l=!0,e.apply(null,y))}function h(y){r=setTimeout(()=>{r=null,t(f,c())},y)}function d(){i&&clearTimeout(i)}function f(y,...I){if(l){d();return}if(y){d(),u.call(null,y,...I);return}if(c()||o){d(),u.call(null,y,...I);return}s<64&&(s*=2);let k;a===1?(a=2,k=0):k=(s+Math.random())*1e3,h(k)}let p=!1;function _(y){p||(p=!0,d(),!l&&(r!==null?(y||(a=2),clearTimeout(r),h(0)):y||(a=1)))}return h(0),i=setTimeout(()=>{o=!0,_(!0)},n),_}function M5(t){t(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function L5(t){return t!==void 0}function F5(t){return typeof t=="function"}function U5(t){return typeof t=="object"&&!Array.isArray(t)}function cp(t){return typeof t=="string"||t instanceof String}function xT(t){return yw()&&t instanceof Blob}function yw(){return typeof Blob!="undefined"}function Qm(t,e,n,s){if(s<e)throw aa(`Invalid value for '${t}'. Expected ${e} or greater.`);if(s>n)throw aa(`Invalid value for '${t}'. Expected ${n} or less.`)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function di(t,e,n){let s=e;return n==null&&(s=`https://${e}`),`${n}://${s}/v0${t}`}function SD(t){const e=encodeURIComponent;let n="?";for(const s in t)if(t.hasOwnProperty(s)){const r=e(s)+"="+e(t[s]);n=n+r+"&"}return n=n.slice(0,-1),n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Wi;(function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"})(Wi||(Wi={}));/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $5{constructor(e,n,s,r,i,o,a,c,l,u,h){this.url_=e,this.method_=n,this.headers_=s,this.body_=r,this.successCodes_=i,this.additionalRetryCodes_=o,this.callback_=a,this.errorCallback_=c,this.timeout_=l,this.progressCallback_=u,this.connectionFactory_=h,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((d,f)=>{this.resolve_=d,this.reject_=f,this.start_()})}start_(){const e=(s,r)=>{if(r){s(!1,new rh(!1,null,!0));return}const i=this.connectionFactory_();this.pendingConnection_=i;const o=a=>{const c=a.loaded,l=a.lengthComputable?a.total:-1;this.progressCallback_!==null&&this.progressCallback_(c,l)};this.progressCallback_!==null&&i.addUploadProgressListener(o),i.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&i.removeUploadProgressListener(o),this.pendingConnection_=null;const a=i.getErrorCode()===Wi.NO_ERROR,c=i.getStatus();if(!a||this.isRetryStatusCode_(c)){const u=i.getErrorCode()===Wi.ABORT;s(!1,new rh(!1,null,u));return}const l=this.successCodes_.indexOf(c)!==-1;s(!0,new rh(l,i))})},n=(s,r)=>{const i=this.resolve_,o=this.reject_,a=r.connection;if(r.wasSuccessCode)try{const c=this.callback_(a,a.getResponse());L5(c)?i(c):i()}catch(c){o(c)}else if(a!==null){const c=_w();c.serverResponse=a.getErrorText(),this.errorCallback_?o(this.errorCallback_(a,c)):o(c)}else if(r.canceled){const c=this.appDelete_?ED():bD();o(c)}else{const c=A5();o(c)}};this.canceled_?n(!1,new rh(!1,null,!0)):this.backoffId_=O5(e,n,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&M5(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}isRetryStatusCode_(e){const n=e>=500&&e<600,r=[408,429].indexOf(e)!==-1,i=this.additionalRetryCodes_.indexOf(e)!==-1;return n||r||i}}class rh{constructor(e,n,s){this.wasSuccessCode=e,this.connection=n,this.canceled=!!s}}function V5(t,e){e!==null&&e.length>0&&(t.Authorization="Firebase "+e)}function B5(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(e!=null?e:"AppManager")}function q5(t,e){e&&(t["X-Firebase-GMPID"]=e)}function j5(t,e){e!==null&&(t["X-Firebase-AppCheck"]=e)}function K5(t,e,n,s,r,i){const o=SD(t.urlParams),a=t.url+o,c=Object.assign({},t.headers);return q5(c,e),V5(c,n),B5(c,i),j5(c,s),new $5(a,t.method,c,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,r)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function W5(){return typeof BlobBuilder!="undefined"?BlobBuilder:typeof WebKitBlobBuilder!="undefined"?WebKitBlobBuilder:void 0}function H5(...t){const e=W5();if(e!==void 0){const n=new e;for(let s=0;s<t.length;s++)n.append(t[s]);return n.getBlob()}else{if(yw())return new Blob(t);throw new it("unsupported-environment","This browser doesn't seem to support creating Blobs")}}function G5(t,e,n){return t.webkitSlice?t.webkitSlice(e,n):t.mozSlice?t.mozSlice(e,n):t.slice?t.slice(e,n):null}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function z5(t){return atob(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qn={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class lg{constructor(e,n){this.data=e,this.contentType=n||null}}function CD(t,e){switch(t){case qn.RAW:return new lg(AD(e));case qn.BASE64:case qn.BASE64URL:return new lg(kD(t,e));case qn.DATA_URL:return new lg(Y5(e),J5(e))}throw _w()}function AD(t){const e=[];for(let n=0;n<t.length;n++){let s=t.charCodeAt(n);if(s<=127)e.push(s);else if(s<=2047)e.push(192|s>>6,128|s&63);else if((s&64512)===55296)if(!(n<t.length-1&&(t.charCodeAt(n+1)&64512)===56320))e.push(239,191,189);else{const i=s,o=t.charCodeAt(++n);s=65536|(i&1023)<<10|o&1023,e.push(240|s>>18,128|s>>12&63,128|s>>6&63,128|s&63)}else(s&64512)===56320?e.push(239,191,189):e.push(224|s>>12,128|s>>6&63,128|s&63)}return new Uint8Array(e)}function Q5(t){let e;try{e=decodeURIComponent(t)}catch{throw Xc(qn.DATA_URL,"Malformed data URL.")}return AD(e)}function kD(t,e){switch(t){case qn.BASE64:{const r=e.indexOf("-")!==-1,i=e.indexOf("_")!==-1;if(r||i)throw Xc(t,"Invalid character '"+(r?"-":"_")+"' found: is it base64url encoded?");break}case qn.BASE64URL:{const r=e.indexOf("+")!==-1,i=e.indexOf("/")!==-1;if(r||i)throw Xc(t,"Invalid character '"+(r?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let n;try{n=z5(e)}catch{throw Xc(t,"Invalid character found")}const s=new Uint8Array(n.length);for(let r=0;r<n.length;r++)s[r]=n.charCodeAt(r);return s}class RD{constructor(e){this.base64=!1,this.contentType=null;const n=e.match(/^data:([^,]+)?,/);if(n===null)throw Xc(qn.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const s=n[1]||null;s!=null&&(this.base64=X5(s,";base64"),this.contentType=this.base64?s.substring(0,s.length-7):s),this.rest=e.substring(e.indexOf(",")+1)}}function Y5(t){const e=new RD(t);return e.base64?kD(qn.BASE64,e.rest):Q5(e.rest)}function J5(t){return new RD(t).contentType}function X5(t,e){return t.length>=e.length?t.substring(t.length-e.length)===e:!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gs{constructor(e,n){let s=0,r="";xT(e)?(this.data_=e,s=e.size,r=e.type):e instanceof ArrayBuffer?(n?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),s=this.data_.length):e instanceof Uint8Array&&(n?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),s=e.length),this.size_=s,this.type_=r}size(){return this.size_}type(){return this.type_}slice(e,n){if(xT(this.data_)){const s=this.data_,r=G5(s,e,n);return r===null?null:new Gs(r)}else{const s=new Uint8Array(this.data_.buffer,e,n-e);return new Gs(s,!0)}}static getBlob(...e){if(yw()){const n=e.map(s=>s instanceof Gs?s.data_:s);return new Gs(H5.apply(null,n))}else{const n=e.map(o=>cp(o)?CD(qn.RAW,o).data:o.data_);let s=0;n.forEach(o=>{s+=o.byteLength});const r=new Uint8Array(s);let i=0;return n.forEach(o=>{for(let a=0;a<o.length;a++)r[i++]=o[a]}),new Gs(r,!0)}}uploadData(){return this.data_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vw(t){let e;try{e=JSON.parse(t)}catch{return null}return U5(e)?e:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Z5(t){if(t.length===0)return null;const e=t.lastIndexOf("/");return e===-1?"":t.slice(0,e)}function eJ(t,e){const n=e.split("/").filter(s=>s.length>0).join("/");return t.length===0?n:t+"/"+n}function ND(t){const e=t.lastIndexOf("/",t.length-2);return e===-1?t:t.slice(e+1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tJ(t,e){return e}class Zt{constructor(e,n,s,r){this.server=e,this.local=n||e,this.writable=!!s,this.xform=r||tJ}}let ih=null;function nJ(t){return!cp(t)||t.length<2?t:ND(t)}function lp(){if(ih)return ih;const t=[];t.push(new Zt("bucket")),t.push(new Zt("generation")),t.push(new Zt("metageneration")),t.push(new Zt("name","fullPath",!0));function e(i,o){return nJ(o)}const n=new Zt("name");n.xform=e,t.push(n);function s(i,o){return o!==void 0?Number(o):o}const r=new Zt("size");return r.xform=s,t.push(r),t.push(new Zt("timeCreated")),t.push(new Zt("updated")),t.push(new Zt("md5Hash",null,!0)),t.push(new Zt("cacheControl",null,!0)),t.push(new Zt("contentDisposition",null,!0)),t.push(new Zt("contentEncoding",null,!0)),t.push(new Zt("contentLanguage",null,!0)),t.push(new Zt("contentType",null,!0)),t.push(new Zt("metadata","customMetadata",!0)),ih=t,ih}function sJ(t,e){function n(){const s=t.bucket,r=t.fullPath,i=new Qt(s,r);return e._makeStorageReference(i)}Object.defineProperty(t,"ref",{get:n})}function rJ(t,e,n){const s={};s.type="file";const r=n.length;for(let i=0;i<r;i++){const o=n[i];s[o.local]=o.xform(s,e[o.server])}return sJ(s,t),s}function PD(t,e,n){const s=vw(e);return s===null?null:rJ(t,s,n)}function iJ(t,e,n,s){const r=vw(e);if(r===null||!cp(r.downloadTokens))return null;const i=r.downloadTokens;if(i.length===0)return null;const o=encodeURIComponent;return i.split(",").map(l=>{const u=t.bucket,h=t.fullPath,d="/b/"+o(u)+"/o/"+o(h),f=di(d,n,s),p=SD({alt:"media",token:l});return f+p})[0]}function ww(t,e){const n={},s=e.length;for(let r=0;r<s;r++){const i=e[r];i.writable&&(n[i.server]=t[i.local])}return JSON.stringify(n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OT="prefixes",MT="items";function oJ(t,e,n){const s={prefixes:[],items:[],nextPageToken:n.nextPageToken};if(n[OT])for(const r of n[OT]){const i=r.replace(/\/$/,""),o=t._makeStorageReference(new Qt(e,i));s.prefixes.push(o)}if(n[MT])for(const r of n[MT]){const i=t._makeStorageReference(new Qt(e,r.name));s.items.push(i)}return s}function aJ(t,e,n){const s=vw(n);return s===null?null:oJ(t,e,s)}class gr{constructor(e,n,s,r){this.url=e,this.method=n,this.handler=s,this.timeout=r,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ps(t){if(!t)throw _w()}function up(t,e){function n(s,r){const i=PD(t,r,e);return Ps(i!==null),i}return n}function cJ(t,e){function n(s,r){const i=aJ(t,e,r);return Ps(i!==null),i}return n}function lJ(t,e){function n(s,r){const i=PD(t,r,e);return Ps(i!==null),iJ(i,r,t.host,t._protocol)}return n}function rc(t){function e(n,s){let r;return n.getStatus()===401?n.getErrorText().includes("Firebase App Check token is invalid")?r=S5():r=T5():n.getStatus()===402?r=E5(t.bucket):n.getStatus()===403?r=C5(t.path):r=s,r.serverResponse=s.serverResponse,r}return e}function hp(t){const e=rc(t);function n(s,r){let i=e(s,r);return s.getStatus()===404&&(i=I5(t.path)),i.serverResponse=r.serverResponse,i}return n}function DD(t,e,n){const s=e.fullServerUrl(),r=di(s,t.host,t._protocol),i="GET",o=t.maxOperationRetryTime,a=new gr(r,i,up(t,n),o);return a.errorHandler=hp(e),a}function uJ(t,e,n,s,r){const i={};e.isRoot?i.prefix="":i.prefix=e.path+"/",n&&n.length>0&&(i.delimiter=n),s&&(i.pageToken=s),r&&(i.maxResults=r);const o=e.bucketOnlyServerUrl(),a=di(o,t.host,t._protocol),c="GET",l=t.maxOperationRetryTime,u=new gr(a,c,cJ(t,e.bucket),l);return u.urlParams=i,u.errorHandler=rc(e),u}function hJ(t,e,n){const s=e.fullServerUrl(),r=di(s,t.host,t._protocol),i="GET",o=t.maxOperationRetryTime,a=new gr(r,i,lJ(t,n),o);return a.errorHandler=hp(e),a}function dJ(t,e,n,s){const r=e.fullServerUrl(),i=di(r,t.host,t._protocol),o="PATCH",a=ww(n,s),c={"Content-Type":"application/json; charset=utf-8"},l=t.maxOperationRetryTime,u=new gr(i,o,up(t,s),l);return u.headers=c,u.body=a,u.errorHandler=hp(e),u}function fJ(t,e){const n=e.fullServerUrl(),s=di(n,t.host,t._protocol),r="DELETE",i=t.maxOperationRetryTime;function o(c,l){}const a=new gr(s,r,o,i);return a.successCodes=[200,204],a.errorHandler=hp(e),a}function pJ(t,e){return t&&t.contentType||e&&e.type()||"application/octet-stream"}function xD(t,e,n){const s=Object.assign({},n);return s.fullPath=t.path,s.size=e.size(),s.contentType||(s.contentType=pJ(null,e)),s}function gJ(t,e,n,s,r){const i=e.bucketOnlyServerUrl(),o={"X-Goog-Upload-Protocol":"multipart"};function a(){let k="";for(let M=0;M<2;M++)k=k+Math.random().toString().slice(2);return k}const c=a();o["Content-Type"]="multipart/related; boundary="+c;const l=xD(e,s,r),u=ww(l,n),h="--"+c+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+u+`\r
--`+c+`\r
Content-Type: `+l.contentType+`\r
\r
`,d=`\r
--`+c+"--",f=Gs.getBlob(h,s,d);if(f===null)throw ID();const p={name:l.fullPath},_=di(i,t.host,t._protocol),y="POST",I=t.maxUploadRetryTime,N=new gr(_,y,up(t,n),I);return N.urlParams=p,N.headers=o,N.body=f.uploadData(),N.errorHandler=rc(e),N}class Rd{constructor(e,n,s,r){this.current=e,this.total=n,this.finalized=!!s,this.metadata=r||null}}function bw(t,e){let n=null;try{n=t.getResponseHeader("X-Goog-Upload-Status")}catch{Ps(!1)}return Ps(!!n&&(e||["active"]).indexOf(n)!==-1),n}function mJ(t,e,n,s,r){const i=e.bucketOnlyServerUrl(),o=xD(e,s,r),a={name:o.fullPath},c=di(i,t.host,t._protocol),l="POST",u={"X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${s.size()}`,"X-Goog-Upload-Header-Content-Type":o.contentType,"Content-Type":"application/json; charset=utf-8"},h=ww(o,n),d=t.maxUploadRetryTime;function f(_){bw(_);let y;try{y=_.getResponseHeader("X-Goog-Upload-URL")}catch{Ps(!1)}return Ps(cp(y)),y}const p=new gr(c,l,f,d);return p.urlParams=a,p.headers=u,p.body=h,p.errorHandler=rc(e),p}function _J(t,e,n,s){const r={"X-Goog-Upload-Command":"query"};function i(l){const u=bw(l,["active","final"]);let h=null;try{h=l.getResponseHeader("X-Goog-Upload-Size-Received")}catch{Ps(!1)}h||Ps(!1);const d=Number(h);return Ps(!isNaN(d)),new Rd(d,s.size(),u==="final")}const o="POST",a=t.maxUploadRetryTime,c=new gr(n,o,i,a);return c.headers=r,c.errorHandler=rc(e),c}const LT=256*1024;function yJ(t,e,n,s,r,i,o,a){const c=new Rd(0,0);if(o?(c.current=o.current,c.total=o.total):(c.current=0,c.total=s.size()),s.size()!==c.total)throw P5();const l=c.total-c.current;let u=l;r>0&&(u=Math.min(u,r));const h=c.current,d=h+u,p={"X-Goog-Upload-Command":u===l?"upload, finalize":"upload","X-Goog-Upload-Offset":`${c.current}`},_=s.slice(h,d);if(_===null)throw ID();function y(M,j){const Y=bw(M,["active","final"]),z=c.current+u,V=s.size();let ie;return Y==="final"?ie=up(e,i)(M,j):ie=null,new Rd(z,V,Y==="final",ie)}const I="POST",N=e.maxUploadRetryTime,k=new gr(n,I,y,N);return k.headers=p,k.body=_.uploadData(),k.progressCallback=a||null,k.errorHandler=rc(t),k}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vJ={STATE_CHANGED:"state_changed"},sn={RUNNING:"running",PAUSED:"paused",SUCCESS:"success",CANCELED:"canceled",ERROR:"error"};function ug(t){switch(t){case"running":case"pausing":case"canceling":return sn.RUNNING;case"paused":return sn.PAUSED;case"success":return sn.SUCCESS;case"canceled":return sn.CANCELED;case"error":return sn.ERROR;default:return sn.ERROR}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wJ{constructor(e,n,s){if(F5(e)||n!=null||s!=null)this.next=e,this.error=n!=null?n:void 0,this.complete=s!=null?s:void 0;else{const i=e;this.next=i.next,this.error=i.error,this.complete=i.complete}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vo(t){return(...e)=>{Promise.resolve().then(()=>t(...e))}}class bJ{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=Wi.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=Wi.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=Wi.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,n,s,r){if(this.sent_)throw Ic("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(n,e,!0),r!==void 0)for(const i in r)r.hasOwnProperty(i)&&this.xhr_.setRequestHeader(i,r[i].toString());return s!==void 0?this.xhr_.send(s):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw Ic("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw Ic("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw Ic("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw Ic("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class IJ extends bJ{initXhr(){this.xhr_.responseType="text"}}function Is(){return new IJ}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OD{constructor(e,n,s=null){this._transferred=0,this._needToFetchStatus=!1,this._needToFetchMetadata=!1,this._observers=[],this._error=void 0,this._uploadUrl=void 0,this._request=void 0,this._chunkMultiplier=1,this._resolve=void 0,this._reject=void 0,this._ref=e,this._blob=n,this._metadata=s,this._mappings=lp(),this._resumable=this._shouldDoResumable(this._blob),this._state="running",this._errorHandler=r=>{this._request=void 0,this._chunkMultiplier=1,r._codeEquals("canceled")?(this._needToFetchStatus=!0,this.completeTransitions_()):(this._error=r,this._transition("error"))},this._metadataErrorHandler=r=>{this._request=void 0,r._codeEquals("canceled")?this.completeTransitions_():(this._error=r,this._transition("error"))},this._promise=new Promise((r,i)=>{this._resolve=r,this._reject=i,this._start()}),this._promise.then(null,()=>{})}_makeProgressCallback(){const e=this._transferred;return n=>this._updateProgress(e+n)}_shouldDoResumable(e){return e.size()>256*1024}_start(){this._state==="running"&&this._request===void 0&&(this._resumable?this._uploadUrl===void 0?this._createResumable():this._needToFetchStatus?this._fetchStatus():this._needToFetchMetadata?this._fetchMetadata():this._continueUpload():this._oneShotUpload())}_resolveToken(e){Promise.all([this._ref.storage._getAuthToken(),this._ref.storage._getAppCheckToken()]).then(([n,s])=>{switch(this._state){case"running":e(n,s);break;case"canceling":this._transition("canceled");break;case"pausing":this._transition("paused");break}})}_createResumable(){this._resolveToken((e,n)=>{const s=mJ(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),r=this._ref.storage._makeRequest(s,Is,e,n);this._request=r,r.getPromise().then(i=>{this._request=void 0,this._uploadUrl=i,this._needToFetchStatus=!1,this.completeTransitions_()},this._errorHandler)})}_fetchStatus(){const e=this._uploadUrl;this._resolveToken((n,s)=>{const r=_J(this._ref.storage,this._ref._location,e,this._blob),i=this._ref.storage._makeRequest(r,Is,n,s);this._request=i,i.getPromise().then(o=>{o=o,this._request=void 0,this._updateProgress(o.current),this._needToFetchStatus=!1,o.finalized&&(this._needToFetchMetadata=!0),this.completeTransitions_()},this._errorHandler)})}_continueUpload(){const e=LT*this._chunkMultiplier,n=new Rd(this._transferred,this._blob.size()),s=this._uploadUrl;this._resolveToken((r,i)=>{let o;try{o=yJ(this._ref._location,this._ref.storage,s,this._blob,e,this._mappings,n,this._makeProgressCallback())}catch(c){this._error=c,this._transition("error");return}const a=this._ref.storage._makeRequest(o,Is,r,i);this._request=a,a.getPromise().then(c=>{this._increaseMultiplier(),this._request=void 0,this._updateProgress(c.current),c.finalized?(this._metadata=c.metadata,this._transition("success")):this.completeTransitions_()},this._errorHandler)})}_increaseMultiplier(){LT*this._chunkMultiplier<32*1024*1024&&(this._chunkMultiplier*=2)}_fetchMetadata(){this._resolveToken((e,n)=>{const s=DD(this._ref.storage,this._ref._location,this._mappings),r=this._ref.storage._makeRequest(s,Is,e,n);this._request=r,r.getPromise().then(i=>{this._request=void 0,this._metadata=i,this._transition("success")},this._metadataErrorHandler)})}_oneShotUpload(){this._resolveToken((e,n)=>{const s=gJ(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),r=this._ref.storage._makeRequest(s,Is,e,n);this._request=r,r.getPromise().then(i=>{this._request=void 0,this._metadata=i,this._updateProgress(this._blob.size()),this._transition("success")},this._errorHandler)})}_updateProgress(e){const n=this._transferred;this._transferred=e,this._transferred!==n&&this._notifyObservers()}_transition(e){if(this._state!==e)switch(e){case"canceling":this._state=e,this._request!==void 0&&this._request.cancel();break;case"pausing":this._state=e,this._request!==void 0&&this._request.cancel();break;case"running":const n=this._state==="paused";this._state=e,n&&(this._notifyObservers(),this._start());break;case"paused":this._state=e,this._notifyObservers();break;case"canceled":this._error=bD(),this._state=e,this._notifyObservers();break;case"error":this._state=e,this._notifyObservers();break;case"success":this._state=e,this._notifyObservers();break}}completeTransitions_(){switch(this._state){case"pausing":this._transition("paused");break;case"canceling":this._transition("canceled");break;case"running":this._start();break}}get snapshot(){const e=ug(this._state);return{bytesTransferred:this._transferred,totalBytes:this._blob.size(),state:e,metadata:this._metadata,task:this,ref:this._ref}}on(e,n,s,r){const i=new wJ(n||void 0,s||void 0,r||void 0);return this._addObserver(i),()=>{this._removeObserver(i)}}then(e,n){return this._promise.then(e,n)}catch(e){return this.then(null,e)}_addObserver(e){this._observers.push(e),this._notifyObserver(e)}_removeObserver(e){const n=this._observers.indexOf(e);n!==-1&&this._observers.splice(n,1)}_notifyObservers(){this._finishPromise(),this._observers.slice().forEach(n=>{this._notifyObserver(n)})}_finishPromise(){if(this._resolve!==void 0){let e=!0;switch(ug(this._state)){case sn.SUCCESS:Vo(this._resolve.bind(null,this.snapshot))();break;case sn.CANCELED:case sn.ERROR:const n=this._reject;Vo(n.bind(null,this._error))();break;default:e=!1;break}e&&(this._resolve=void 0,this._reject=void 0)}}_notifyObserver(e){switch(ug(this._state)){case sn.RUNNING:case sn.PAUSED:e.next&&Vo(e.next.bind(e,this.snapshot))();break;case sn.SUCCESS:e.complete&&Vo(e.complete.bind(e))();break;case sn.CANCELED:case sn.ERROR:e.error&&Vo(e.error.bind(e,this._error))();break;default:e.error&&Vo(e.error.bind(e,this._error))()}}resume(){const e=this._state==="paused"||this._state==="pausing";return e&&this._transition("running"),e}pause(){const e=this._state==="running";return e&&this._transition("pausing"),e}cancel(){const e=this._state==="running"||this._state==="pausing";return e&&this._transition("canceling"),e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yo{constructor(e,n){this._service=e,n instanceof Qt?this._location=n:this._location=Qt.makeFromUrl(n,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,n){return new yo(e,n)}get root(){const e=new Qt(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return ND(this._location.path)}get storage(){return this._service}get parent(){const e=Z5(this._location.path);if(e===null)return null;const n=new Qt(this._location.bucket,e);return new yo(this._service,n)}_throwIfRoot(e){if(this._location.path==="")throw TD(e)}}function EJ(t,e,n){return t._throwIfRoot("uploadBytesResumable"),new OD(t,new Gs(e),n)}function TJ(t){const e={prefixes:[],items:[]};return MD(t,e).then(()=>e)}async function MD(t,e,n){const r=await LD(t,{pageToken:n});e.prefixes.push(...r.prefixes),e.items.push(...r.items),r.nextPageToken!=null&&await MD(t,e,r.nextPageToken)}function LD(t,e){e!=null&&typeof e.maxResults=="number"&&Qm("options.maxResults",1,1e3,e.maxResults);const n=e||{},s=uJ(t.storage,t._location,"/",n.pageToken,n.maxResults);return t.storage.makeRequestWithTokens(s,Is)}function SJ(t){t._throwIfRoot("getMetadata");const e=DD(t.storage,t._location,lp());return t.storage.makeRequestWithTokens(e,Is)}function CJ(t,e){t._throwIfRoot("updateMetadata");const n=dJ(t.storage,t._location,e,lp());return t.storage.makeRequestWithTokens(n,Is)}function AJ(t){t._throwIfRoot("getDownloadURL");const e=hJ(t.storage,t._location,lp());return t.storage.makeRequestWithTokens(e,Is).then(n=>{if(n===null)throw D5();return n})}function kJ(t){t._throwIfRoot("deleteObject");const e=fJ(t.storage,t._location);return t.storage.makeRequestWithTokens(e,Is)}function FD(t,e){const n=eJ(t._location.path,e),s=new Qt(t._location.bucket,n);return new yo(t.storage,s)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function RJ(t){return/^[A-Za-z]+:\/\//.test(t)}function NJ(t,e){return new yo(t,e)}function UD(t,e){if(t instanceof Iw){const n=t;if(n._bucket==null)throw N5();const s=new yo(n,n._bucket);return e!=null?UD(s,e):s}else return e!==void 0?FD(t,e):t}function PJ(t,e){if(e&&RJ(e)){if(t instanceof Iw)return NJ(t,e);throw aa("To use ref(service, url), the first argument must be a Storage instance.")}else return UD(t,e)}function FT(t,e){const n=e==null?void 0:e[wD];return n==null?null:Qt.makeFromBucketSpec(n,t)}function DJ(t,e,n,s={}){t.host=`${e}:${n}`,t._protocol="http";const{mockUserToken:r}=s;r&&(t._overrideAuthToken=typeof r=="string"?r:S_(r,t.app.options.projectId))}class Iw{constructor(e,n,s,r,i){this.app=e,this._authProvider=n,this._appCheckProvider=s,this._url=r,this._firebaseVersion=i,this._bucket=null,this._host=vD,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=w5,this._maxUploadRetryTime=b5,this._requests=new Set,r!=null?this._bucket=Qt.makeFromBucketSpec(r,this._host):this._bucket=FT(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=Qt.makeFromBucketSpec(this._url,e):this._bucket=FT(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){Qm("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){Qm("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const n=await e.getToken();if(n!==null)return n.accessToken}return null}async _getAppCheckToken(){const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new yo(this,e)}_makeRequest(e,n,s,r){if(this._deleted)return new x5(ED());{const i=K5(e,this._appId,s,r,n,this._firebaseVersion);return this._requests.add(i),i.getPromise().then(()=>this._requests.delete(i),()=>this._requests.delete(i)),i}}async makeRequestWithTokens(e,n){const[s,r]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,n,s,r).getPromise()}}const UT="@firebase/storage",$T="0.9.9";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xJ="storage";function OJ(t,e,n){return t=A(t),EJ(t,e,n)}function MJ(t){return t=A(t),SJ(t)}function LJ(t,e){return t=A(t),CJ(t,e)}function FJ(t,e){return t=A(t),LD(t,e)}function UJ(t){return t=A(t),TJ(t)}function $J(t){return t=A(t),AJ(t)}function VJ(t){return t=A(t),kJ(t)}function VT(t,e){return t=A(t),PJ(t,e)}function BJ(t,e){return FD(t,e)}function qJ(t,e,n,s={}){DJ(t,e,n,s)}function jJ(t,{instanceIdentifier:e}){const n=t.getProvider("app").getImmediate(),s=t.getProvider("auth-internal"),r=t.getProvider("app-check-internal");return new Iw(n,s,r,e,Bs)}function KJ(){nt(new Ee(xJ,jJ,"PUBLIC").setMultipleInstances(!0)),Le(UT,$T,""),Le(UT,$T,"esm2017")}KJ();/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oh{constructor(e,n,s){this._delegate=e,this.task=n,this.ref=s}get bytesTransferred(){return this._delegate.bytesTransferred}get metadata(){return this._delegate.metadata}get state(){return this._delegate.state}get totalBytes(){return this._delegate.totalBytes}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BT{constructor(e,n){this._delegate=e,this._ref=n,this.cancel=this._delegate.cancel.bind(this._delegate),this.catch=this._delegate.catch.bind(this._delegate),this.pause=this._delegate.pause.bind(this._delegate),this.resume=this._delegate.resume.bind(this._delegate)}get snapshot(){return new oh(this._delegate.snapshot,this,this._ref)}then(e,n){return this._delegate.then(s=>{if(e)return e(new oh(s,this,this._ref))},n)}on(e,n,s,r){let i;return n&&(typeof n=="function"?i=o=>n(new oh(o,this,this._ref)):i={next:n.next?o=>n.next(new oh(o,this,this._ref)):void 0,complete:n.complete||void 0,error:n.error||void 0}),this._delegate.on(e,i,s||void 0,r||void 0)}}class qT{constructor(e,n){this._delegate=e,this._service=n}get prefixes(){return this._delegate.prefixes.map(e=>new nr(e,this._service))}get items(){return this._delegate.items.map(e=>new nr(e,this._service))}get nextPageToken(){return this._delegate.nextPageToken||null}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *  http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nr{constructor(e,n){this._delegate=e,this.storage=n}get name(){return this._delegate.name}get bucket(){return this._delegate.bucket}get fullPath(){return this._delegate.fullPath}toString(){return this._delegate.toString()}child(e){const n=BJ(this._delegate,e);return new nr(n,this.storage)}get root(){return new nr(this._delegate.root,this.storage)}get parent(){const e=this._delegate.parent;return e==null?null:new nr(e,this.storage)}put(e,n){return this._throwIfRoot("put"),new BT(OJ(this._delegate,e,n),this)}putString(e,n=qn.RAW,s){this._throwIfRoot("putString");const r=CD(n,e),i=Object.assign({},s);return i.contentType==null&&r.contentType!=null&&(i.contentType=r.contentType),new BT(new OD(this._delegate,new Gs(r.data,!0),i),this)}listAll(){return UJ(this._delegate).then(e=>new qT(e,this.storage))}list(e){return FJ(this._delegate,e||void 0).then(n=>new qT(n,this.storage))}getMetadata(){return MJ(this._delegate)}updateMetadata(e){return LJ(this._delegate,e)}getDownloadURL(){return $J(this._delegate)}delete(){return this._throwIfRoot("delete"),VJ(this._delegate)}_throwIfRoot(e){if(this._delegate._location.path==="")throw TD(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $D{constructor(e,n){this.app=e,this._delegate=n}get maxOperationRetryTime(){return this._delegate.maxOperationRetryTime}get maxUploadRetryTime(){return this._delegate.maxUploadRetryTime}ref(e){if(jT(e))throw aa("ref() expected a child path but got a URL, use refFromURL instead.");return new nr(VT(this._delegate,e),this)}refFromURL(e){if(!jT(e))throw aa("refFromURL() expected a full URL but got a child path, use ref() instead.");try{Qt.makeFromUrl(e,this._delegate.host)}catch{throw aa("refFromUrl() expected a valid full URL but got an invalid one.")}return new nr(VT(this._delegate,e),this)}setMaxUploadRetryTime(e){this._delegate.maxUploadRetryTime=e}setMaxOperationRetryTime(e){this._delegate.maxOperationRetryTime=e}useEmulator(e,n,s={}){qJ(this._delegate,e,n,s)}}function jT(t){return/^[A-Za-z]+:\/\//.test(t)}const WJ="@firebase/storage-compat",HJ="0.1.17";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GJ="storage-compat";function zJ(t,{instanceIdentifier:e}){const n=t.getProvider("app-compat").getImmediate(),s=t.getProvider("storage").getImmediate({identifier:e});return new $D(n,s)}function QJ(t){const e={TaskState:sn,TaskEvent:vJ,StringFormat:qn,Storage:$D,Reference:nr};t.INTERNAL.registerComponent(new Ee(GJ,zJ,"PUBLIC").setServiceProps(e).setMultipleInstances(!0)),t.registerVersion(WJ,HJ)}QJ(lt);const KT="@firebase/performance",Ym="0.5.12";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VD=Ym,YJ="FB-PERF-TRACE-START",JJ="FB-PERF-TRACE-STOP",Jm="FB-PERF-TRACE-MEASURE",BD="_wt_",qD="_fp",jD="_fcp",KD="_fid",WD="@firebase/performance/config",HD="@firebase/performance/configexpire",XJ="performance",GD="Performance";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZJ={["trace started"]:"Trace {$traceName} was started before.",["trace stopped"]:"Trace {$traceName} is not running.",["nonpositive trace startTime"]:"Trace {$traceName} startTime should be positive.",["nonpositive trace duration"]:"Trace {$traceName} duration should be positive.",["no window"]:"Window is not available.",["no app id"]:"App id is not available.",["no project id"]:"Project id is not available.",["no api key"]:"Api key is not available.",["invalid cc log"]:"Attempted to queue invalid cc event",["FB not default"]:"Performance can only start when Firebase app instance is the default one.",["RC response not ok"]:"RC response is not ok",["invalid attribute name"]:"Attribute name {$attributeName} is invalid.",["invalid attribute value"]:"Attribute value {$attributeValue} is invalid.",["invalid custom metric name"]:"Custom metric name {$customMetricName} is invalid",["invalid String merger input"]:"Input for String merger is invalid, contact support team to resolve.",["already initialized"]:"initializePerformance() has already been called with different options. To avoid this error, call initializePerformance() with the same options as when it was originally called, or call getPerformance() to return the already initialized instance."},zt=new dn(XJ,GD,ZJ);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $s=new Vs(GD);$s.logLevel=de.INFO;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let hg,zD;class At{constructor(e){if(this.window=e,!e)throw zt.create("no window");this.performance=e.performance,this.PerformanceObserver=e.PerformanceObserver,this.windowLocation=e.location,this.navigator=e.navigator,this.document=e.document,this.navigator&&this.navigator.cookieEnabled&&(this.localStorage=e.localStorage),e.perfMetrics&&e.perfMetrics.onFirstInputDelay&&(this.onFirstInputDelay=e.perfMetrics.onFirstInputDelay)}getUrl(){return this.windowLocation.href.split("?")[0]}mark(e){!this.performance||!this.performance.mark||this.performance.mark(e)}measure(e,n,s){!this.performance||!this.performance.measure||this.performance.measure(e,n,s)}getEntriesByType(e){return!this.performance||!this.performance.getEntriesByType?[]:this.performance.getEntriesByType(e)}getEntriesByName(e){return!this.performance||!this.performance.getEntriesByName?[]:this.performance.getEntriesByName(e)}getTimeOrigin(){return this.performance&&(this.performance.timeOrigin||this.performance.timing.navigationStart)}requiredApisAvailable(){return!fetch||!Promise||!zd()?($s.info("Firebase Performance cannot start if browser does not support fetch and Promise or cookie is disabled."),!1):bn()?!0:($s.info("IndexedDB is not supported by current browswer"),!1)}setupObserver(e,n){if(!this.PerformanceObserver)return;new this.PerformanceObserver(r=>{for(const i of r.getEntries())n(i)}).observe({entryTypes:[e]})}static getInstance(){return hg===void 0&&(hg=new At(zD)),hg}}function eX(t){zD=t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let QD;function tX(t){const e=t.getId();return e.then(n=>{QD=n}),e}function Ew(){return QD}function nX(t){const e=t.getToken();return e.then(n=>{}),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function WT(t,e){const n=t.length-e.length;if(n<0||n>1)throw zt.create("invalid String merger input");const s=[];for(let r=0;r<t.length;r++)s.push(t.charAt(r)),e.length>r&&s.push(e.charAt(r));return s.join("")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let dg;class Rn{constructor(){this.instrumentationEnabled=!0,this.dataCollectionEnabled=!0,this.loggingEnabled=!1,this.tracesSamplingRate=1,this.networkRequestsSamplingRate=1,this.logEndPointUrl="https://firebaselogging.googleapis.com/v0cc/log?format=json_proto",this.flTransportEndpointUrl=WT("hts/frbslgigp.ogepscmv/ieo/eaylg","tp:/ieaeogn-agolai.o/1frlglgc/o"),this.transportKey=WT("AzSC8r6ReiGqFMyfvgow","Iayx0u-XT3vksVM-pIV"),this.logSource=462,this.logTraceAfterSampling=!1,this.logNetworkAfterSampling=!1,this.configTimeToLive=12}getFlTransportFullUrl(){return this.flTransportEndpointUrl.concat("?key=",this.transportKey)}static getInstance(){return dg===void 0&&(dg=new Rn),dg}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ca;(function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.VISIBLE=1]="VISIBLE",t[t.HIDDEN=2]="HIDDEN"})(ca||(ca={}));const sX=["firebase_","google_","ga_"],rX=new RegExp("^[a-zA-Z]\\w*$"),iX=40,oX=100;function aX(){const t=At.getInstance().navigator;return"serviceWorker"in t?t.serviceWorker.controller?2:3:1}function YD(){switch(At.getInstance().document.visibilityState){case"visible":return ca.VISIBLE;case"hidden":return ca.HIDDEN;default:return ca.UNKNOWN}}function cX(){const e=At.getInstance().navigator.connection;switch(e&&e.effectiveType){case"slow-2g":return 1;case"2g":return 2;case"3g":return 3;case"4g":return 4;default:return 0}}function lX(t){return t.length===0||t.length>iX?!1:!sX.some(n=>t.startsWith(n))&&!!t.match(rX)}function uX(t){return t.length!==0&&t.length<=oX}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function JD(t){var e;const n=(e=t.options)===null||e===void 0?void 0:e.appId;if(!n)throw zt.create("no app id");return n}function hX(t){var e;const n=(e=t.options)===null||e===void 0?void 0:e.projectId;if(!n)throw zt.create("no project id");return n}function dX(t){var e;const n=(e=t.options)===null||e===void 0?void 0:e.apiKey;if(!n)throw zt.create("no api key");return n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fX="0.0.1",Xn={loggingEnabled:!0},pX="FIREBASE_INSTALLATIONS_AUTH";function gX(t,e){const n=mX();return n?(HT(n),Promise.resolve()):vX(t,e).then(HT).then(s=>_X(s),()=>{})}function mX(){const t=At.getInstance().localStorage;if(!t)return;const e=t.getItem(HD);if(!e||!wX(e))return;const n=t.getItem(WD);if(!!n)try{return JSON.parse(n)}catch{return}}function _X(t){const e=At.getInstance().localStorage;!t||!e||(e.setItem(WD,JSON.stringify(t)),e.setItem(HD,String(Date.now()+Rn.getInstance().configTimeToLive*60*60*1e3)))}const yX="Could not fetch config, will use default configs";function vX(t,e){return nX(t.installations).then(n=>{const s=hX(t.app),r=dX(t.app),i=`https://firebaseremoteconfig.googleapis.com/v1/projects/${s}/namespaces/fireperf:fetch?key=${r}`,o=new Request(i,{method:"POST",headers:{Authorization:`${pX} ${n}`},body:JSON.stringify({app_instance_id:e,app_instance_id_token:n,app_id:JD(t.app),app_version:VD,sdk_version:fX})});return fetch(o).then(a=>{if(a.ok)return a.json();throw zt.create("RC response not ok")})}).catch(()=>{$s.info(yX)})}function HT(t){if(!t)return t;const e=Rn.getInstance(),n=t.entries||{};return n.fpr_enabled!==void 0?e.loggingEnabled=String(n.fpr_enabled)==="true":e.loggingEnabled=Xn.loggingEnabled,n.fpr_log_source?e.logSource=Number(n.fpr_log_source):Xn.logSource&&(e.logSource=Xn.logSource),n.fpr_log_endpoint_url?e.logEndPointUrl=n.fpr_log_endpoint_url:Xn.logEndPointUrl&&(e.logEndPointUrl=Xn.logEndPointUrl),n.fpr_log_transport_key?e.transportKey=n.fpr_log_transport_key:Xn.transportKey&&(e.transportKey=Xn.transportKey),n.fpr_vc_network_request_sampling_rate!==void 0?e.networkRequestsSamplingRate=Number(n.fpr_vc_network_request_sampling_rate):Xn.networkRequestsSamplingRate!==void 0&&(e.networkRequestsSamplingRate=Xn.networkRequestsSamplingRate),n.fpr_vc_trace_sampling_rate!==void 0?e.tracesSamplingRate=Number(n.fpr_vc_trace_sampling_rate):Xn.tracesSamplingRate!==void 0&&(e.tracesSamplingRate=Xn.tracesSamplingRate),e.logTraceAfterSampling=GT(e.tracesSamplingRate),e.logNetworkAfterSampling=GT(e.networkRequestsSamplingRate),t}function wX(t){return Number(t)>Date.now()}function GT(t){return Math.random()<=t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Tw=1,fg;function XD(t){return Tw=2,fg=fg||IX(t),fg}function bX(){return Tw===3}function IX(t){return EX().then(()=>tX(t.installations)).then(e=>gX(t,e)).then(()=>zT(),()=>zT())}function EX(){const t=At.getInstance().document;return new Promise(e=>{if(t&&t.readyState!=="complete"){const n=()=>{t.readyState==="complete"&&(t.removeEventListener("readystatechange",n),e())};t.addEventListener("readystatechange",n)}else e()})}function zT(){Tw=3}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sw=10*1e3,TX=5.5*1e3,ZD=3,SX=1e3;let Nd=ZD,Br=[],QT=!1;function CX(){QT||(dp(TX),QT=!0)}function dp(t){setTimeout(()=>{if(Nd!==0){if(!Br.length)return dp(Sw);AX()}},t)}function AX(){const t=Br.splice(0,SX),e=t.map(s=>({source_extension_json_proto3:s.message,event_time_ms:String(s.eventTime)})),n={request_time_ms:String(Date.now()),client_info:{client_type:1,js_client_info:{}},log_source:Rn.getInstance().logSource,log_event:e};kX(n,t).catch(()=>{Br=[...t,...Br],Nd--,$s.info(`Tries left: ${Nd}.`),dp(Sw)})}function kX(t,e){return RX(t).then(n=>(n.ok||$s.info("Call to Firebase backend failed."),n.json())).then(n=>{const s=Number(n.nextRequestWaitMillis);let r=Sw;isNaN(s)||(r=Math.max(s,r));const i=n.logResponseDetails;Array.isArray(i)&&i.length>0&&i[0].responseAction==="RETRY_REQUEST_LATER"&&(Br=[...e,...Br],$s.info("Retry transport request later.")),Nd=ZD,dp(r)})}function RX(t){const e=Rn.getInstance().getFlTransportFullUrl();return fetch(e,{method:"POST",body:JSON.stringify(t)})}function NX(t){if(!t.eventTime||!t.message)throw zt.create("invalid cc log");Br=[...Br,t]}function PX(t){return(...e)=>{const n=t(...e);NX({message:n,eventTime:Date.now()})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let pg;function ex(t,e){pg||(pg=PX(xX)),pg(t,e)}function ah(t){const e=Rn.getInstance();!e.instrumentationEnabled&&t.isAuto||!e.dataCollectionEnabled&&!t.isAuto||!At.getInstance().requiredApisAvailable()||t.isAuto&&YD()!==ca.VISIBLE||(bX()?gg(t):XD(t.performanceController).then(()=>gg(t),()=>gg(t)))}function gg(t){if(!Ew())return;const e=Rn.getInstance();!e.loggingEnabled||!e.logTraceAfterSampling||setTimeout(()=>ex(t,1),0)}function DX(t){const e=Rn.getInstance();if(!e.instrumentationEnabled)return;const n=t.url,s=e.logEndPointUrl.split("?")[0],r=e.flTransportEndpointUrl.split("?")[0];n===s||n===r||!e.loggingEnabled||!e.logNetworkAfterSampling||setTimeout(()=>ex(t,0),0)}function xX(t,e){return e===0?OX(t):MX(t)}function OX(t){const e={url:t.url,http_method:t.httpMethod||0,http_response_code:200,response_payload_bytes:t.responsePayloadBytes,client_start_time_us:t.startTimeUs,time_to_response_initiated_us:t.timeToResponseInitiatedUs,time_to_response_completed_us:t.timeToResponseCompletedUs},n={application_info:tx(t.performanceController.app),network_request_metric:e};return JSON.stringify(n)}function MX(t){const e={name:t.name,is_auto:t.isAuto,client_start_time_us:t.startTimeUs,duration_us:t.durationUs};Object.keys(t.counters).length!==0&&(e.counters=t.counters);const n=t.getAttributes();Object.keys(n).length!==0&&(e.custom_attributes=n);const s={application_info:tx(t.performanceController.app),trace_metric:e};return JSON.stringify(s)}function tx(t){return{google_app_id:JD(t),app_instance_id:Ew(),web_app_info:{sdk_version:VD,page_url:At.getInstance().getUrl(),service_worker_status:aX(),visibility_state:YD(),effective_connection_type:cX()},application_process_state:0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LX=100,FX="_",UX=[qD,jD,KD];function $X(t,e){return t.length===0||t.length>LX?!1:e&&e.startsWith(BD)&&UX.indexOf(t)>-1||!t.startsWith(FX)}function VX(t){const e=Math.floor(t);return e<t&&$s.info(`Metric value should be an Integer, setting the value as : ${e}.`),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qr{constructor(e,n,s=!1,r){this.performanceController=e,this.name=n,this.isAuto=s,this.state=1,this.customAttributes={},this.counters={},this.api=At.getInstance(),this.randomId=Math.floor(Math.random()*1e6),this.isAuto||(this.traceStartMark=`${YJ}-${this.randomId}-${this.name}`,this.traceStopMark=`${JJ}-${this.randomId}-${this.name}`,this.traceMeasure=r||`${Jm}-${this.randomId}-${this.name}`,r&&this.calculateTraceMetrics())}start(){if(this.state!==1)throw zt.create("trace started",{traceName:this.name});this.api.mark(this.traceStartMark),this.state=2}stop(){if(this.state!==2)throw zt.create("trace stopped",{traceName:this.name});this.state=3,this.api.mark(this.traceStopMark),this.api.measure(this.traceMeasure,this.traceStartMark,this.traceStopMark),this.calculateTraceMetrics(),ah(this)}record(e,n,s){if(e<=0)throw zt.create("nonpositive trace startTime",{traceName:this.name});if(n<=0)throw zt.create("nonpositive trace duration",{traceName:this.name});if(this.durationUs=Math.floor(n*1e3),this.startTimeUs=Math.floor(e*1e3),s&&s.attributes&&(this.customAttributes=Object.assign({},s.attributes)),s&&s.metrics)for(const r of Object.keys(s.metrics))isNaN(Number(s.metrics[r]))||(this.counters[r]=Math.floor(Number(s.metrics[r])));ah(this)}incrementMetric(e,n=1){this.counters[e]===void 0?this.putMetric(e,n):this.putMetric(e,this.counters[e]+n)}putMetric(e,n){if($X(e,this.name))this.counters[e]=VX(n!=null?n:0);else throw zt.create("invalid custom metric name",{customMetricName:e})}getMetric(e){return this.counters[e]||0}putAttribute(e,n){const s=lX(e),r=uX(n);if(s&&r){this.customAttributes[e]=n;return}if(!s)throw zt.create("invalid attribute name",{attributeName:e});if(!r)throw zt.create("invalid attribute value",{attributeValue:n})}getAttribute(e){return this.customAttributes[e]}removeAttribute(e){this.customAttributes[e]!==void 0&&delete this.customAttributes[e]}getAttributes(){return Object.assign({},this.customAttributes)}setStartTime(e){this.startTimeUs=e}setDuration(e){this.durationUs=e}calculateTraceMetrics(){const e=this.api.getEntriesByName(this.traceMeasure),n=e&&e[0];n&&(this.durationUs=Math.floor(n.duration*1e3),this.startTimeUs=Math.floor((n.startTime+this.api.getTimeOrigin())*1e3))}static createOobTrace(e,n,s,r){const i=At.getInstance().getUrl();if(!i)return;const o=new qr(e,BD+i,!0),a=Math.floor(At.getInstance().getTimeOrigin()*1e3);o.setStartTime(a),n&&n[0]&&(o.setDuration(Math.floor(n[0].duration*1e3)),o.putMetric("domInteractive",Math.floor(n[0].domInteractive*1e3)),o.putMetric("domContentLoadedEventEnd",Math.floor(n[0].domContentLoadedEventEnd*1e3)),o.putMetric("loadEventEnd",Math.floor(n[0].loadEventEnd*1e3)));const c="first-paint",l="first-contentful-paint";if(s){const u=s.find(d=>d.name===c);u&&u.startTime&&o.putMetric(qD,Math.floor(u.startTime*1e3));const h=s.find(d=>d.name===l);h&&h.startTime&&o.putMetric(jD,Math.floor(h.startTime*1e3)),r&&o.putMetric(KD,Math.floor(r*1e3))}ah(o)}static createUserTimingTrace(e,n){const s=new qr(e,n,!1,n);ah(s)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function YT(t,e){const n=e;if(!n||n.responseStart===void 0)return;const s=At.getInstance().getTimeOrigin(),r=Math.floor((n.startTime+s)*1e3),i=n.responseStart?Math.floor((n.responseStart-n.startTime)*1e3):void 0,o=Math.floor((n.responseEnd-n.startTime)*1e3),a=n.name&&n.name.split("?")[0],c={performanceController:t,url:a,responsePayloadBytes:n.transferSize,startTimeUs:r,timeToResponseInitiatedUs:i,timeToResponseCompletedUs:o};DX(c)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BX=5e3;function JT(t){!Ew()||(setTimeout(()=>jX(t),0),setTimeout(()=>qX(t),0),setTimeout(()=>KX(t),0))}function qX(t){const e=At.getInstance(),n=e.getEntriesByType("resource");for(const s of n)YT(t,s);e.setupObserver("resource",s=>YT(t,s))}function jX(t){const e=At.getInstance(),n=e.getEntriesByType("navigation"),s=e.getEntriesByType("paint");if(e.onFirstInputDelay){let r=setTimeout(()=>{qr.createOobTrace(t,n,s),r=void 0},BX);e.onFirstInputDelay(i=>{r&&(clearTimeout(r),qr.createOobTrace(t,n,s,i))})}else qr.createOobTrace(t,n,s)}function KX(t){const e=At.getInstance(),n=e.getEntriesByType("measure");for(const s of n)XT(t,s);e.setupObserver("measure",s=>XT(t,s))}function XT(t,e){const n=e.name;n.substring(0,Jm.length)!==Jm&&qr.createUserTimingTrace(t,n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WX{constructor(e,n){this.app=e,this.installations=n,this.initialized=!1}_init(e){this.initialized||((e==null?void 0:e.dataCollectionEnabled)!==void 0&&(this.dataCollectionEnabled=e.dataCollectionEnabled),(e==null?void 0:e.instrumentationEnabled)!==void 0&&(this.instrumentationEnabled=e.instrumentationEnabled),At.getInstance().requiredApisAvailable()?nu().then(n=>{n&&(CX(),XD(this).then(()=>JT(this),()=>JT(this)),this.initialized=!0)}).catch(n=>{$s.info(`Environment doesn't support IndexedDB: ${n}`)}):$s.info('Firebase Performance cannot start if the browser does not support "Fetch" and "Promise", or cookies are disabled.'))}set instrumentationEnabled(e){Rn.getInstance().instrumentationEnabled=e}get instrumentationEnabled(){return Rn.getInstance().instrumentationEnabled}set dataCollectionEnabled(e){Rn.getInstance().dataCollectionEnabled=e}get dataCollectionEnabled(){return Rn.getInstance().dataCollectionEnabled}}const HX="[DEFAULT]";function GX(t,e){return t=A(t),new qr(t,e)}const zX=(t,{options:e})=>{const n=t.getProvider("app").getImmediate(),s=t.getProvider("installations-internal").getImmediate();if(n.name!==HX)throw zt.create("FB not default");if(typeof window=="undefined")throw zt.create("no window");eX(window);const r=new WX(n,s);return r._init(e),r};function QX(){nt(new Ee("performance",zX,"PUBLIC")),Le(KT,Ym),Le(KT,Ym,"esm2017")}QX();/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YX{constructor(e,n){this.app=e,this._delegate=n}get instrumentationEnabled(){return this._delegate.instrumentationEnabled}set instrumentationEnabled(e){this._delegate.instrumentationEnabled=e}get dataCollectionEnabled(){return this._delegate.dataCollectionEnabled}set dataCollectionEnabled(e){this._delegate.dataCollectionEnabled=e}trace(e){return GX(this._delegate,e)}}const JX="@firebase/performance-compat",XX="0.1.12";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ZX(t){t.INTERNAL.registerComponent(new Ee("performance-compat",e8,"PUBLIC")),t.registerVersion(JX,XX)}function e8(t){const e=t.getProvider("app-compat").getImmediate(),n=t.getProvider("performance").getImmediate();return new YX(e,n)}ZX(lt);const mg="@firebase/remote-config",ZT="0.3.11";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class t8{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const n8="remote-config";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const s8={["registration-window"]:"Undefined window object. This SDK only supports usage in a browser environment.",["registration-project-id"]:"Undefined project identifier. Check Firebase app initialization.",["registration-api-key"]:"Undefined API key. Check Firebase app initialization.",["registration-app-id"]:"Undefined app identifier. Check Firebase app initialization.",["storage-open"]:"Error thrown when opening storage. Original error: {$originalErrorMessage}.",["storage-get"]:"Error thrown when reading from storage. Original error: {$originalErrorMessage}.",["storage-set"]:"Error thrown when writing to storage. Original error: {$originalErrorMessage}.",["storage-delete"]:"Error thrown when deleting from storage. Original error: {$originalErrorMessage}.",["fetch-client-network"]:"Fetch client failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.",["fetch-timeout"]:'The config fetch request timed out.  Configure timeout using "fetchTimeoutMillis" SDK setting.',["fetch-throttle"]:'The config fetch request timed out while in an exponential backoff state. Configure timeout using "fetchTimeoutMillis" SDK setting. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.',["fetch-client-parse"]:"Fetch client could not parse response. Original error: {$originalErrorMessage}.",["fetch-status"]:"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.",["indexed-db-unavailable"]:"Indexed DB is not supported by current browser"},mn=new dn("remoteconfig","Remote Config",s8);function r8(t,e){return t instanceof ct&&t.code.indexOf(e)!==-1}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const i8=!1,o8="",eS=0,a8=["1","true","t","yes","y","on"];class _g{constructor(e,n=o8){this._source=e,this._value=n}asString(){return this._value}asBoolean(){return this._source==="static"?i8:a8.indexOf(this._value.toLowerCase())>=0}asNumber(){if(this._source==="static")return eS;let e=Number(this._value);return isNaN(e)&&(e=eS),e}getSource(){return this._source}}async function nx(t){const e=A(t),[n,s]=await Promise.all([e._storage.getLastSuccessfulFetchResponse(),e._storage.getActiveConfigEtag()]);return!n||!n.config||!n.eTag||n.eTag===s?!1:(await Promise.all([e._storageCache.setActiveConfig(n.config),e._storage.setActiveConfigEtag(n.eTag)]),!0)}function sx(t){const e=A(t);return e._initializePromise||(e._initializePromise=e._storageCache.loadFromStorage().then(()=>{e._isInitializationComplete=!0})),e._initializePromise}async function rx(t){const e=A(t),n=new t8;setTimeout(async()=>{n.abort()},e.settings.fetchTimeoutMillis);try{await e._client.fetch({cacheMaxAgeMillis:e.settings.minimumFetchIntervalMillis,signal:n}),await e._storageCache.setLastFetchStatus("success")}catch(s){const r=r8(s,"fetch-throttle")?"throttle":"failure";throw await e._storageCache.setLastFetchStatus(r),s}}function c8(t){const e=A(t);return f8(e._storageCache.getActiveConfig(),e.defaultConfig).reduce((n,s)=>(n[s]=Uu(t,s),n),{})}function l8(t,e){return Uu(A(t),e).asBoolean()}function u8(t,e){return Uu(A(t),e).asNumber()}function h8(t,e){return Uu(A(t),e).asString()}function Uu(t,e){const n=A(t);n._isInitializationComplete||n._logger.debug(`A value was requested for key "${e}" before SDK initialization completed. Await on ensureInitialized if the intent was to get a previously activated value.`);const s=n._storageCache.getActiveConfig();return s&&s[e]!==void 0?new _g("remote",s[e]):n.defaultConfig&&n.defaultConfig[e]!==void 0?new _g("default",String(n.defaultConfig[e])):(n._logger.debug(`Returning static value for key "${e}". Define a default or remote value if this is unintentional.`),new _g("static"))}function d8(t,e){const n=A(t);switch(e){case"debug":n._logger.logLevel=de.DEBUG;break;case"silent":n._logger.logLevel=de.SILENT;break;default:n._logger.logLevel=de.ERROR}}function f8(t={},e={}){return Object.keys(Object.assign(Object.assign({},t),e))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p8{constructor(e,n,s,r){this.client=e,this.storage=n,this.storageCache=s,this.logger=r}isCachedDataFresh(e,n){if(!n)return this.logger.debug("Config fetch cache check. Cache unpopulated."),!1;const s=Date.now()-n,r=s<=e;return this.logger.debug(`Config fetch cache check. Cache age millis: ${s}. Cache max age millis (minimumFetchIntervalMillis setting): ${e}. Is cache hit: ${r}.`),r}async fetch(e){const[n,s]=await Promise.all([this.storage.getLastSuccessfulFetchTimestampMillis(),this.storage.getLastSuccessfulFetchResponse()]);if(s&&this.isCachedDataFresh(e.cacheMaxAgeMillis,n))return s;e.eTag=s&&s.eTag;const r=await this.client.fetch(e),i=[this.storageCache.setLastSuccessfulFetchTimestampMillis(Date.now())];return r.status===200&&i.push(this.storage.setLastSuccessfulFetchResponse(r)),await Promise.all(i),r}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function g8(t=navigator){return t.languages&&t.languages[0]||t.language}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class m8{constructor(e,n,s,r,i,o){this.firebaseInstallations=e,this.sdkVersion=n,this.namespace=s,this.projectId=r,this.apiKey=i,this.appId=o}async fetch(e){var n,s,r;const[i,o]=await Promise.all([this.firebaseInstallations.getId(),this.firebaseInstallations.getToken()]),c=`${window.FIREBASE_REMOTE_CONFIG_URL_BASE||"https://firebaseremoteconfig.googleapis.com"}/v1/projects/${this.projectId}/namespaces/${this.namespace}:fetch?key=${this.apiKey}`,l={"Content-Type":"application/json","Content-Encoding":"gzip","If-None-Match":e.eTag||"*"},u={sdk_version:this.sdkVersion,app_instance_id:i,app_instance_id_token:o,app_id:this.appId,language_code:g8()},h={method:"POST",headers:l,body:JSON.stringify(u)},d=fetch(c,h),f=new Promise((k,M)=>{e.signal.addEventListener(()=>{const j=new Error("The operation was aborted.");j.name="AbortError",M(j)})});let p;try{await Promise.race([d,f]),p=await d}catch(k){let M="fetch-client-network";throw((n=k)===null||n===void 0?void 0:n.name)==="AbortError"&&(M="fetch-timeout"),mn.create(M,{originalErrorMessage:(s=k)===null||s===void 0?void 0:s.message})}let _=p.status;const y=p.headers.get("ETag")||void 0;let I,N;if(p.status===200){let k;try{k=await p.json()}catch(M){throw mn.create("fetch-client-parse",{originalErrorMessage:(r=M)===null||r===void 0?void 0:r.message})}I=k.entries,N=k.state}if(N==="INSTANCE_STATE_UNSPECIFIED"?_=500:N==="NO_CHANGE"?_=304:(N==="NO_TEMPLATE"||N==="EMPTY_CONFIG")&&(I={}),_!==304&&_!==200)throw mn.create("fetch-status",{httpStatus:_});return{status:_,eTag:y,config:I}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _8(t,e){return new Promise((n,s)=>{const r=Math.max(e-Date.now(),0),i=setTimeout(n,r);t.addEventListener(()=>{clearTimeout(i),s(mn.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}function y8(t){if(!(t instanceof ct)||!t.customData)return!1;const e=Number(t.customData.httpStatus);return e===429||e===500||e===503||e===504}class v8{constructor(e,n){this.client=e,this.storage=n}async fetch(e){const n=await this.storage.getThrottleMetadata()||{backoffCount:0,throttleEndTimeMillis:Date.now()};return this.attemptFetch(e,n)}async attemptFetch(e,{throttleEndTimeMillis:n,backoffCount:s}){await _8(e.signal,n);try{const r=await this.client.fetch(e);return await this.storage.deleteThrottleMetadata(),r}catch(r){if(!y8(r))throw r;const i={throttleEndTimeMillis:Date.now()+Mh(s),backoffCount:s+1};return await this.storage.setThrottleMetadata(i),this.attemptFetch(e,i)}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const w8=60*1e3,b8=12*60*60*1e3;class I8{constructor(e,n,s,r,i){this.app=e,this._client=n,this._storageCache=s,this._storage=r,this._logger=i,this._isInitializationComplete=!1,this.settings={fetchTimeoutMillis:w8,minimumFetchIntervalMillis:b8},this.defaultConfig={}}get fetchTimeMillis(){return this._storageCache.getLastSuccessfulFetchTimestampMillis()||-1}get lastFetchStatus(){return this._storageCache.getLastFetchStatus()||"no-fetch-yet"}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Th(t,e){var n;const s=t.target.error||void 0;return mn.create(e,{originalErrorMessage:s&&((n=s)===null||n===void 0?void 0:n.message)})}const Ei="app_namespace_store",E8="firebase_remote_config",T8=1;function S8(){return new Promise((t,e)=>{var n;try{const s=indexedDB.open(E8,T8);s.onerror=r=>{e(Th(r,"storage-open"))},s.onsuccess=r=>{t(r.target.result)},s.onupgradeneeded=r=>{const i=r.target.result;switch(r.oldVersion){case 0:i.createObjectStore(Ei,{keyPath:"compositeKey"})}}}catch(s){e(mn.create("storage-open",{originalErrorMessage:(n=s)===null||n===void 0?void 0:n.message}))}})}class C8{constructor(e,n,s,r=S8()){this.appId=e,this.appName=n,this.namespace=s,this.openDbPromise=r}getLastFetchStatus(){return this.get("last_fetch_status")}setLastFetchStatus(e){return this.set("last_fetch_status",e)}getLastSuccessfulFetchTimestampMillis(){return this.get("last_successful_fetch_timestamp_millis")}setLastSuccessfulFetchTimestampMillis(e){return this.set("last_successful_fetch_timestamp_millis",e)}getLastSuccessfulFetchResponse(){return this.get("last_successful_fetch_response")}setLastSuccessfulFetchResponse(e){return this.set("last_successful_fetch_response",e)}getActiveConfig(){return this.get("active_config")}setActiveConfig(e){return this.set("active_config",e)}getActiveConfigEtag(){return this.get("active_config_etag")}setActiveConfigEtag(e){return this.set("active_config_etag",e)}getThrottleMetadata(){return this.get("throttle_metadata")}setThrottleMetadata(e){return this.set("throttle_metadata",e)}deleteThrottleMetadata(){return this.delete("throttle_metadata")}async get(e){const n=await this.openDbPromise;return new Promise((s,r)=>{var i;const a=n.transaction([Ei],"readonly").objectStore(Ei),c=this.createCompositeKey(e);try{const l=a.get(c);l.onerror=u=>{r(Th(u,"storage-get"))},l.onsuccess=u=>{const h=u.target.result;s(h?h.value:void 0)}}catch(l){r(mn.create("storage-get",{originalErrorMessage:(i=l)===null||i===void 0?void 0:i.message}))}})}async set(e,n){const s=await this.openDbPromise;return new Promise((r,i)=>{var o;const c=s.transaction([Ei],"readwrite").objectStore(Ei),l=this.createCompositeKey(e);try{const u=c.put({compositeKey:l,value:n});u.onerror=h=>{i(Th(h,"storage-set"))},u.onsuccess=()=>{r()}}catch(u){i(mn.create("storage-set",{originalErrorMessage:(o=u)===null||o===void 0?void 0:o.message}))}})}async delete(e){const n=await this.openDbPromise;return new Promise((s,r)=>{var i;const a=n.transaction([Ei],"readwrite").objectStore(Ei),c=this.createCompositeKey(e);try{const l=a.delete(c);l.onerror=u=>{r(Th(u,"storage-delete"))},l.onsuccess=()=>{s()}}catch(l){r(mn.create("storage-delete",{originalErrorMessage:(i=l)===null||i===void 0?void 0:i.message}))}})}createCompositeKey(e){return[this.appId,this.appName,this.namespace,e].join()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A8{constructor(e){this.storage=e}getLastFetchStatus(){return this.lastFetchStatus}getLastSuccessfulFetchTimestampMillis(){return this.lastSuccessfulFetchTimestampMillis}getActiveConfig(){return this.activeConfig}async loadFromStorage(){const e=this.storage.getLastFetchStatus(),n=this.storage.getLastSuccessfulFetchTimestampMillis(),s=this.storage.getActiveConfig(),r=await e;r&&(this.lastFetchStatus=r);const i=await n;i&&(this.lastSuccessfulFetchTimestampMillis=i);const o=await s;o&&(this.activeConfig=o)}setLastFetchStatus(e){return this.lastFetchStatus=e,this.storage.setLastFetchStatus(e)}setLastSuccessfulFetchTimestampMillis(e){return this.lastSuccessfulFetchTimestampMillis=e,this.storage.setLastSuccessfulFetchTimestampMillis(e)}setActiveConfig(e){return this.activeConfig=e,this.storage.setActiveConfig(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function k8(){nt(new Ee(n8,t,"PUBLIC").setMultipleInstances(!0)),Le(mg,ZT),Le(mg,ZT,"esm2017");function t(e,{instanceIdentifier:n}){const s=e.getProvider("app").getImmediate(),r=e.getProvider("installations-internal").getImmediate();if(typeof window=="undefined")throw mn.create("registration-window");if(!bn())throw mn.create("indexed-db-unavailable");const{projectId:i,apiKey:o,appId:a}=s.options;if(!i)throw mn.create("registration-project-id");if(!o)throw mn.create("registration-api-key");if(!a)throw mn.create("registration-app-id");n=n||"firebase";const c=new C8(a,s.name,n),l=new A8(c),u=new Vs(mg);u.logLevel=de.ERROR;const h=new m8(r,Bs,n,i,o,a),d=new v8(h,c),f=new p8(d,c,l,u),p=new I8(s,f,l,c,u);return sx(p),p}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function R8(t){return t=A(t),await rx(t),nx(t)}async function N8(){if(!bn())return!1;try{return await nu()}catch{return!1}}k8();/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P8{constructor(e,n){this.app=e,this._delegate=n}get defaultConfig(){return this._delegate.defaultConfig}set defaultConfig(e){this._delegate.defaultConfig=e}get fetchTimeMillis(){return this._delegate.fetchTimeMillis}get lastFetchStatus(){return this._delegate.lastFetchStatus}get settings(){return this._delegate.settings}set settings(e){this._delegate.settings=e}activate(){return nx(this._delegate)}ensureInitialized(){return sx(this._delegate)}fetch(){return rx(this._delegate)}fetchAndActivate(){return R8(this._delegate)}getAll(){return c8(this._delegate)}getBoolean(e){return l8(this._delegate,e)}getNumber(e){return u8(this._delegate,e)}getString(e){return h8(this._delegate,e)}getValue(e){return Uu(this._delegate,e)}setLogLevel(e){d8(this._delegate,e)}}const D8="@firebase/remote-config-compat",x8="0.1.12";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function O8(t){t.INTERNAL.registerComponent(new Ee("remoteConfig-compat",M8,"PUBLIC").setMultipleInstances(!0).setServiceProps({isSupported:N8})),t.registerVersion(D8,x8)}function M8(t,{instanceIdentifier:e}){const n=t.getProvider("app-compat").getImmediate(),s=t.getProvider("remote-config").getImmediate({identifier:e});return new P8(n,s)}O8(lt);var L8="firebase",F8="9.9.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */lt.registerVersion(L8,F8,"app-compat");var U8="firebase",$8="9.9.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */console.warn(`
It looks like you're using the development build of the Firebase JS SDK.
When deploying Firebase apps to production, it is advisable to only import
the individual SDK components you intend to use.

For the module builds, these are available in the following manner
(replace <PACKAGE> with the name of a component - i.e. auth, database, etc):

CommonJS Modules:
const firebase = require('firebase/app');
require('firebase/<PACKAGE>');

ES Modules:
import firebase from 'firebase/app';
import 'firebase/<PACKAGE>';

Typescript:
import firebase from 'firebase/app';
import 'firebase/<PACKAGE>';
`);lt.registerVersion(U8,$8,"compat");var V8=!1;/*!
  * pinia v2.0.16
  * (c) 2022 Eduardo San Martin Morote
  * @license MIT
  */let ix;const fp=t=>ix=t,ox=Symbol();function Xm(t){return t&&typeof t=="object"&&Object.prototype.toString.call(t)==="[object Object]"&&typeof t.toJSON!="function"}var Zc;(function(t){t.direct="direct",t.patchObject="patch object",t.patchFunction="patch function"})(Zc||(Zc={}));function B8(){const t=cS(!0),e=t.run(()=>f_({}));let n=[],s=[];const r=ua({install(i){fp(r),r._a=i,i.provide(ox,r),i.config.globalProperties.$pinia=r,s.forEach(o=>n.push(o)),s=[]},use(i){return!this._a&&!V8?s.push(i):n.push(i),this},_p:n,_a:null,_e:t,_s:new Map,state:e});return r}const ax=()=>{};function tS(t,e,n,s=ax){t.push(e);const r=()=>{const i=t.indexOf(e);i>-1&&(t.splice(i,1),s())};return!n&&b_()&&m_(r),r}function Bo(t,...e){t.slice().forEach(n=>{n(...e)})}function Zm(t,e){for(const n in e){if(!e.hasOwnProperty(n))continue;const s=e[n],r=t[n];Xm(r)&&Xm(s)&&t.hasOwnProperty(n)&&!at(s)&&!Mr(s)?t[n]=Zm(r,s):t[n]=s}return t}const q8=Symbol();function j8(t){return!Xm(t)||!t.hasOwnProperty(q8)}const{assign:Ws}=Object;function K8(t){return!!(at(t)&&t.effect)}function W8(t,e,n,s){const{state:r,actions:i,getters:o}=e,a=n.state.value[t];let c;function l(){a||(n.state.value[t]=r?r():{});const u=eO(n.state.value[t]);return Ws(u,i,Object.keys(o||{}).reduce((h,d)=>(h[d]=ua(ts(()=>{fp(n);const f=n._s.get(t);return o[d].call(f,f)})),h),{}))}return c=cx(t,l,e,n,s,!0),c.$reset=function(){const h=r?r():{};this.$patch(d=>{Ws(d,h)})},c}function cx(t,e,n={},s,r,i){let o;const a=Ws({actions:{}},n),c={deep:!0};let l,u,h=ua([]),d=ua([]),f;const p=s.state.value[t];!i&&!p&&(s.state.value[t]={}),f_({});let _;function y(z){let V;l=u=!1,typeof z=="function"?(z(s.state.value[t]),V={type:Zc.patchFunction,storeId:t,events:f}):(Zm(s.state.value[t],z),V={type:Zc.patchObject,payload:z,storeId:t,events:f});const ie=_=Symbol();g_().then(()=>{_===ie&&(l=!0)}),u=!0,Bo(h,V,s.state.value[t])}const I=ax;function N(){o.stop(),h=[],d=[],s._s.delete(t)}function k(z,V){return function(){fp(s);const ie=Array.from(arguments),_e=[],Fe=[];function H(Xe){_e.push(Xe)}function ke(Xe){Fe.push(Xe)}Bo(d,{args:ie,name:z,store:j,after:H,onError:ke});let Je;try{Je=V.apply(this&&this.$id===t?this:j,ie)}catch(Xe){throw Bo(Fe,Xe),Xe}return Je instanceof Promise?Je.then(Xe=>(Bo(_e,Xe),Xe)).catch(Xe=>(Bo(Fe,Xe),Promise.reject(Xe))):(Bo(_e,Je),Je)}}const M={_p:s,$id:t,$onAction:tS.bind(null,d),$patch:y,$reset:I,$subscribe(z,V={}){const ie=tS(h,z,V.detached,()=>_e()),_e=o.run(()=>xc(()=>s.state.value[t],Fe=>{(V.flush==="sync"?u:l)&&z({storeId:t,type:Zc.direct,events:f},Fe)},Ws({},c,V)));return ie},$dispose:N},j=La(Ws({},M));s._s.set(t,j);const Y=s._e.run(()=>(o=cS(),o.run(()=>e())));for(const z in Y){const V=Y[z];if(at(V)&&!K8(V)||Mr(V))i||(p&&j8(V)&&(at(V)?V.value=p[z]:Zm(V,p[z])),s.state.value[t][z]=V);else if(typeof V=="function"){const ie=k(z,V);Y[z]=ie,a.actions[z]=V}}return Ws(j,Y),Ws(Se(j),Y),Object.defineProperty(j,"$state",{get:()=>s.state.value[t],set:z=>{y(V=>{Ws(V,z)})}}),s._p.forEach(z=>{Ws(j,o.run(()=>z({store:j,app:s._a,pinia:s,options:a})))}),p&&i&&n.hydrate&&n.hydrate(j.$state,p),l=!0,u=!0,j}function H8(t,e,n){let s,r;const i=typeof e=="function";typeof t=="string"?(s=t,r=i?n:e):(r=t,s=t.id);function o(a,c){const l=b_();return a=a||l&&Cs(ox),a&&fp(a),a=ix,a._s.has(s)||(i?cx(s,e,r,a):W8(s,r,a)),a._s.get(s)}return o.$id=s,o}const G8=H8({id:"university",state:()=>({univercities:[]}),actions:{getData(){lt.firestore().collection("Univercities").orderBy("name").get().then(e=>{e.forEach(n=>{const s=n.data(),r={uni_id:n.id,id:s.id,name:s.name,tags:s.tags,ranking:s.ranking,mainCampus:s.mainCampus,introduction:s.introduction,specialization:s.specialization,sector:s.sector,campuses:s.campuses,imgUrl:s.imgUrl,number:s.number,bsAdmission:s.bsAdmission,bsopendate:s.bsopendate,bsclosedate:s.bsclosedate,msAdmission:s.msAdmission,msopendate:s.msopendate,msclosedate:s.msclosedate,mpAdmission:s.mpAdmission,mpopendate:s.mpopendate,mpclosedate:s.mpclosedate,PhDAdmission:s.PhDAdmission,PhDopendate:s.PhDopendate,PhDclosedate:s.PhDclosedate,bsfees:s.bsfees,msfees:s.msfees,mpfees:s.mpfees,phfees:s.phfees,anycampus:s.anycampus,url:s.url,number:s.number,bsagricultue:s.bsagricultue,bsart:s.bsart,bsbiology:s.bsbiology,bschamical:s.bschamical,bscommerce:s.bscommerce,bscsdegree:s.bscsdegree,bsearth:s.bsearth,bseducation:s.bseducation,bsengineering:s.bsengineering,bslang:s.bslang,bsmanagement:s.bsmanagement,bsmedia:s.bsmedia,bsmedical:s.bsmedical,bsother:s.bsother,bsphysics:s.bsphysics,bsreligious:s.bsreligious,bssocial:s.bssocial,bstechnical:s.bschamical,msagricultue:s.msagricultue,msart:s.msart,msbiology:s.msbiology,mschamical:s.mschamical,mscommerce:s.mscommerce,mscsdegree:s.mscsdegree,msearth:s.msearth,mseducation:s.mseducation,msengineering:s.msengineering,mslang:s.mslang,msmanagement:s.msmanagement,msmedia:s.msmedia,msmedical:s.msmedical,msother:s.msother,msphysics:s.msphysics,msreligious:s.msreligious,mssocial:s.mssocial,mstechnical:s.mstechnical,mplagricultue:s.mplagricultue,mplart:s.mplart,mplbiology:s.mplbiology,mplchamical:s.mplchamical,mplcommerce:s.mplcommerce,mplcsdegree:s.mplcsdegree,mplearth:s.mplearth,mpleducation:s.mpleducation,mplengineering:s.mplengineering,mpllang:s.mpllang,mplmanagement:s.mplmanagement,mplmedia:s.mplmedia,mplmedical:s.mplmedical,mplother:s.mplother,mplphysics:s.mplphysics,mplreligious:s.mplreligious,mplsocial:s.mplsocial,mpltechnical:s.mpltechnical,phlagricultue:s.phlagricultue,phlart:s.phlart,phlbiology:s.phlbiology,phlchamical:s.phlchamical,phlcommerce:s.phlcommerce,phlcsdegree:s.phlcsdegree,phlearth:s.phlearth,phleducation:s.phleducation,phlengineering:s.phlengineering,phllang:s.phllang,phlmanagement:s.phlmanagement,phlmedia:s.phlmedia,phlmedical:s.phlmedical,phlphysics:s.phlphysics,phlreligious:s.phlreligious,phlsocial:s.phlsocial,phltechnical:s.phltechnical,phlphysics:s.phlphysics};this.univercities.push(r)})})},test(){console.log("TEsting")}}});const z8={components:{NavVue:oL},data(){return{mainNav:!0}},beforeMount(){window.innerWidth<760&&(this.mainNav=!1),G8().getData()}};function Q8(t,e,n,s,r,i){const o=kg("NavVue"),a=kg("router-view");return Nh(),XS(Zn,null,[r.mainNav?(Nh(),ZS(o,{key:0})):eM("",!0),$t(a)],64)}var Y8=yC(z8,[["render",Q8]]),J8="firebase",X8="9.9.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */lt.registerVersion(J8,X8,"app-compat");const Z8={apiKey:"AIzaSyD2b62AFYQbjcAHQKD_sndun59ZC72lb8E",authDomain:"educatia-170f3.firebaseapp.com",projectId:"educatia-170f3",storageBucket:"educatia-170f3.appspot.com",messagingSenderId:"111445876419",appId:"1:111445876419:web:8c6ca1e04409a7ddf6cc76",measurementId:"G-5KM7Z5KJ8R"};lt.initializeApp(Z8);const Cw=$M(Y8),e9=B8();Cw.use(e9);Cw.use(Q1);Cw.mount("#app");export{Zn as F,rC as T,yC as _,ZS as a,eM as b,XS as c,Kn as d,a9 as e,s9 as f,$t as g,Sg as h,dO as i,v_ as j,r9 as k,lt as l,l9 as m,o9 as n,Nh as o,hO as p,c9 as q,kg as r,t9 as t,G8 as u,i9 as v,n9 as w};
