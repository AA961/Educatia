const gx=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerpolicy&&(i.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?i.credentials="include":s.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}};gx();function o_(t,e){const n=Object.create(null),r=t.split(",");for(let s=0;s<r.length;s++)n[r[s]]=!0;return e?s=>!!n[s.toLowerCase()]:s=>!!n[s]}const mx="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",_x=o_(mx);function cS(t){return!!t||t===""}function a_(t){if(ee(t)){const e={};for(let n=0;n<t.length;n++){const r=t[n],s=Nt(r)?wx(r):a_(r);if(s)for(const i in s)e[i]=s[i]}return e}else{if(Nt(t))return t;if(tt(t))return t}}const yx=/;(?![^(]*\))/g,vx=/:(.+)/;function wx(t){const e={};return t.split(yx).forEach(n=>{if(n){const r=n.split(vx);r.length>1&&(e[r[0].trim()]=r[1].trim())}}),e}function c_(t){let e="";if(Nt(t))e=t;else if(ee(t))for(let n=0;n<t.length;n++){const r=c_(t[n]);r&&(e+=r+" ")}else if(tt(t))for(const n in t)t[n]&&(e+=n+" ");return e.trim()}function bx(t,e){if(t.length!==e.length)return!1;let n=!0;for(let r=0;n&&r<t.length;r++)n=da(t[r],e[r]);return n}function da(t,e){if(t===e)return!0;let n=Lw(t),r=Lw(e);if(n||r)return n&&r?t.getTime()===e.getTime():!1;if(n=rl(t),r=rl(e),n||r)return t===e;if(n=ee(t),r=ee(e),n||r)return n&&r?bx(t,e):!1;if(n=tt(t),r=tt(e),n||r){if(!n||!r)return!1;const s=Object.keys(t).length,i=Object.keys(e).length;if(s!==i)return!1;for(const o in t){const a=t.hasOwnProperty(o),c=e.hasOwnProperty(o);if(a&&!c||!a&&c||!da(t[o],e[o]))return!1}}return String(t)===String(e)}function Ix(t,e){return t.findIndex(n=>da(n,e))}const I9=t=>Nt(t)?t:t==null?"":ee(t)||tt(t)&&(t.toString===hS||!le(t.toString))?JSON.stringify(t,lS,2):String(t),lS=(t,e)=>e&&e.__v_isRef?lS(t,e.value):Xo(e)?{[`Map(${e.size})`]:[...e.entries()].reduce((n,[r,s])=>(n[`${r} =>`]=s,n),{})}:Fd(e)?{[`Set(${e.size})`]:[...e.values()]}:tt(e)&&!ee(e)&&!dS(e)?String(e):e,Oe={},Jo=[],ir=()=>{},Ex=()=>!1,Tx=/^on[^a-z]/,Ld=t=>Tx.test(t),l_=t=>t.startsWith("onUpdate:"),Ht=Object.assign,u_=(t,e)=>{const n=t.indexOf(e);n>-1&&t.splice(n,1)},Sx=Object.prototype.hasOwnProperty,ve=(t,e)=>Sx.call(t,e),ee=Array.isArray,Xo=t=>ru(t)==="[object Map]",Fd=t=>ru(t)==="[object Set]",Lw=t=>ru(t)==="[object Date]",le=t=>typeof t=="function",Nt=t=>typeof t=="string",rl=t=>typeof t=="symbol",tt=t=>t!==null&&typeof t=="object",uS=t=>tt(t)&&le(t.then)&&le(t.catch),hS=Object.prototype.toString,ru=t=>hS.call(t),Cx=t=>ru(t).slice(8,-1),dS=t=>ru(t)==="[object Object]",h_=t=>Nt(t)&&t!=="NaN"&&t[0]!=="-"&&""+parseInt(t,10)===t,ph=o_(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),Ud=t=>{const e=Object.create(null);return n=>e[n]||(e[n]=t(n))},Ax=/-(\w)/g,Dr=Ud(t=>t.replace(Ax,(e,n)=>n?n.toUpperCase():"")),kx=/\B([A-Z])/g,wo=Ud(t=>t.replace(kx,"-$1").toLowerCase()),$d=Ud(t=>t.charAt(0).toUpperCase()+t.slice(1)),bp=Ud(t=>t?`on${$d(t)}`:""),sl=(t,e)=>!Object.is(t,e),gh=(t,e)=>{for(let n=0;n<t.length;n++)t[n](e)},Ph=(t,e,n)=>{Object.defineProperty(t,e,{configurable:!0,enumerable:!1,value:n})},il=t=>{const e=parseFloat(t);return isNaN(e)?t:e};let Fw;const Rx=()=>Fw||(Fw=typeof globalThis!="undefined"?globalThis:typeof self!="undefined"?self:typeof window!="undefined"?window:typeof global!="undefined"?global:{});let mr;class fS{constructor(e=!1){this.active=!0,this.effects=[],this.cleanups=[],!e&&mr&&(this.parent=mr,this.index=(mr.scopes||(mr.scopes=[])).push(this)-1)}run(e){if(this.active){const n=mr;try{return mr=this,e()}finally{mr=n}}}on(){mr=this}off(){mr=this.parent}stop(e){if(this.active){let n,r;for(n=0,r=this.effects.length;n<r;n++)this.effects[n].stop();for(n=0,r=this.cleanups.length;n<r;n++)this.cleanups[n]();if(this.scopes)for(n=0,r=this.scopes.length;n<r;n++)this.scopes[n].stop(!0);if(this.parent&&!e){const s=this.parent.scopes.pop();s&&s!==this&&(this.parent.scopes[this.index]=s,s.index=this.index)}this.active=!1}}}function pS(t){return new fS(t)}function Nx(t,e=mr){e&&e.active&&e.effects.push(t)}const d_=t=>{const e=new Set(t);return e.w=0,e.n=0,e},gS=t=>(t.w&Ks)>0,mS=t=>(t.n&Ks)>0,Px=({deps:t})=>{if(t.length)for(let e=0;e<t.length;e++)t[e].w|=Ks},Dx=t=>{const{deps:e}=t;if(e.length){let n=0;for(let r=0;r<e.length;r++){const s=e[r];gS(s)&&!mS(s)?s.delete(t):e[n++]=s,s.w&=~Ks,s.n&=~Ks}e.length=n}},Tg=new WeakMap;let Cc=0,Ks=1;const Sg=30;let er;const Vi=Symbol(""),Cg=Symbol("");class f_{constructor(e,n=null,r){this.fn=e,this.scheduler=n,this.active=!0,this.deps=[],this.parent=void 0,Nx(this,r)}run(){if(!this.active)return this.fn();let e=er,n=Os;for(;e;){if(e===this)return;e=e.parent}try{return this.parent=er,er=this,Os=!0,Ks=1<<++Cc,Cc<=Sg?Px(this):Uw(this),this.fn()}finally{Cc<=Sg&&Dx(this),Ks=1<<--Cc,er=this.parent,Os=n,this.parent=void 0,this.deferStop&&this.stop()}}stop(){er===this?this.deferStop=!0:this.active&&(Uw(this),this.onStop&&this.onStop(),this.active=!1)}}function Uw(t){const{deps:e}=t;if(e.length){for(let n=0;n<e.length;n++)e[n].delete(t);e.length=0}}let Os=!0;const _S=[];function Fa(){_S.push(Os),Os=!1}function Ua(){const t=_S.pop();Os=t===void 0?!0:t}function Dn(t,e,n){if(Os&&er){let r=Tg.get(t);r||Tg.set(t,r=new Map);let s=r.get(n);s||r.set(n,s=d_()),yS(s)}}function yS(t,e){let n=!1;Cc<=Sg?mS(t)||(t.n|=Ks,n=!gS(t)):n=!t.has(er),n&&(t.add(er),er.deps.push(t))}function rs(t,e,n,r,s,i){const o=Tg.get(t);if(!o)return;let a=[];if(e==="clear")a=[...o.values()];else if(n==="length"&&ee(t))o.forEach((c,l)=>{(l==="length"||l>=r)&&a.push(c)});else switch(n!==void 0&&a.push(o.get(n)),e){case"add":ee(t)?h_(n)&&a.push(o.get("length")):(a.push(o.get(Vi)),Xo(t)&&a.push(o.get(Cg)));break;case"delete":ee(t)||(a.push(o.get(Vi)),Xo(t)&&a.push(o.get(Cg)));break;case"set":Xo(t)&&a.push(o.get(Vi));break}if(a.length===1)a[0]&&Ag(a[0]);else{const c=[];for(const l of a)l&&c.push(...l);Ag(d_(c))}}function Ag(t,e){const n=ee(t)?t:[...t];for(const r of n)r.computed&&$w(r);for(const r of n)r.computed||$w(r)}function $w(t,e){(t!==er||t.allowRecurse)&&(t.scheduler?t.scheduler():t.run())}const xx=o_("__proto__,__v_isRef,__isVue"),vS=new Set(Object.getOwnPropertyNames(Symbol).filter(t=>t!=="arguments"&&t!=="caller").map(t=>Symbol[t]).filter(rl)),Ox=p_(),Mx=p_(!1,!0),Lx=p_(!0),Vw=Fx();function Fx(){const t={};return["includes","indexOf","lastIndexOf"].forEach(e=>{t[e]=function(...n){const r=Se(this);for(let i=0,o=this.length;i<o;i++)Dn(r,"get",i+"");const s=r[e](...n);return s===-1||s===!1?r[e](...n.map(Se)):s}}),["push","pop","shift","unshift","splice"].forEach(e=>{t[e]=function(...n){Fa();const r=Se(this)[e].apply(this,n);return Ua(),r}}),t}function p_(t=!1,e=!1){return function(r,s,i){if(s==="__v_isReactive")return!t;if(s==="__v_isReadonly")return t;if(s==="__v_isShallow")return e;if(s==="__v_raw"&&i===(t?e?Zx:TS:e?ES:IS).get(r))return r;const o=ee(r);if(!t&&o&&ve(Vw,s))return Reflect.get(Vw,s,i);const a=Reflect.get(r,s,i);return(rl(s)?vS.has(s):xx(s))||(t||Dn(r,"get",s),e)?a:at(a)?o&&h_(s)?a:a.value:tt(a)?t?SS(a):$a(a):a}}const Ux=wS(),$x=wS(!0);function wS(t=!1){return function(n,r,s,i){let o=n[r];if(ol(o)&&at(o)&&!at(s))return!1;if(!t&&!ol(s)&&(kg(s)||(s=Se(s),o=Se(o)),!ee(n)&&at(o)&&!at(s)))return o.value=s,!0;const a=ee(n)&&h_(r)?Number(r)<n.length:ve(n,r),c=Reflect.set(n,r,s,i);return n===Se(i)&&(a?sl(s,o)&&rs(n,"set",r,s):rs(n,"add",r,s)),c}}function Vx(t,e){const n=ve(t,e);t[e];const r=Reflect.deleteProperty(t,e);return r&&n&&rs(t,"delete",e,void 0),r}function Bx(t,e){const n=Reflect.has(t,e);return(!rl(e)||!vS.has(e))&&Dn(t,"has",e),n}function qx(t){return Dn(t,"iterate",ee(t)?"length":Vi),Reflect.ownKeys(t)}const bS={get:Ox,set:Ux,deleteProperty:Vx,has:Bx,ownKeys:qx},jx={get:Lx,set(t,e){return!0},deleteProperty(t,e){return!0}},Kx=Ht({},bS,{get:Mx,set:$x}),g_=t=>t,Vd=t=>Reflect.getPrototypeOf(t);function Ku(t,e,n=!1,r=!1){t=t.__v_raw;const s=Se(t),i=Se(e);n||(e!==i&&Dn(s,"get",e),Dn(s,"get",i));const{has:o}=Vd(s),a=r?g_:n?y_:al;if(o.call(s,e))return a(t.get(e));if(o.call(s,i))return a(t.get(i));t!==s&&t.get(e)}function Wu(t,e=!1){const n=this.__v_raw,r=Se(n),s=Se(t);return e||(t!==s&&Dn(r,"has",t),Dn(r,"has",s)),t===s?n.has(t):n.has(t)||n.has(s)}function Hu(t,e=!1){return t=t.__v_raw,!e&&Dn(Se(t),"iterate",Vi),Reflect.get(t,"size",t)}function Bw(t){t=Se(t);const e=Se(this);return Vd(e).has.call(e,t)||(e.add(t),rs(e,"add",t,t)),this}function qw(t,e){e=Se(e);const n=Se(this),{has:r,get:s}=Vd(n);let i=r.call(n,t);i||(t=Se(t),i=r.call(n,t));const o=s.call(n,t);return n.set(t,e),i?sl(e,o)&&rs(n,"set",t,e):rs(n,"add",t,e),this}function jw(t){const e=Se(this),{has:n,get:r}=Vd(e);let s=n.call(e,t);s||(t=Se(t),s=n.call(e,t)),r&&r.call(e,t);const i=e.delete(t);return s&&rs(e,"delete",t,void 0),i}function Kw(){const t=Se(this),e=t.size!==0,n=t.clear();return e&&rs(t,"clear",void 0,void 0),n}function Gu(t,e){return function(r,s){const i=this,o=i.__v_raw,a=Se(o),c=e?g_:t?y_:al;return!t&&Dn(a,"iterate",Vi),o.forEach((l,u)=>r.call(s,c(l),c(u),i))}}function zu(t,e,n){return function(...r){const s=this.__v_raw,i=Se(s),o=Xo(i),a=t==="entries"||t===Symbol.iterator&&o,c=t==="keys"&&o,l=s[t](...r),u=n?g_:e?y_:al;return!e&&Dn(i,"iterate",c?Cg:Vi),{next(){const{value:h,done:d}=l.next();return d?{value:h,done:d}:{value:a?[u(h[0]),u(h[1])]:u(h),done:d}},[Symbol.iterator](){return this}}}}function ms(t){return function(...e){return t==="delete"?!1:this}}function Wx(){const t={get(i){return Ku(this,i)},get size(){return Hu(this)},has:Wu,add:Bw,set:qw,delete:jw,clear:Kw,forEach:Gu(!1,!1)},e={get(i){return Ku(this,i,!1,!0)},get size(){return Hu(this)},has:Wu,add:Bw,set:qw,delete:jw,clear:Kw,forEach:Gu(!1,!0)},n={get(i){return Ku(this,i,!0)},get size(){return Hu(this,!0)},has(i){return Wu.call(this,i,!0)},add:ms("add"),set:ms("set"),delete:ms("delete"),clear:ms("clear"),forEach:Gu(!0,!1)},r={get(i){return Ku(this,i,!0,!0)},get size(){return Hu(this,!0)},has(i){return Wu.call(this,i,!0)},add:ms("add"),set:ms("set"),delete:ms("delete"),clear:ms("clear"),forEach:Gu(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(i=>{t[i]=zu(i,!1,!1),n[i]=zu(i,!0,!1),e[i]=zu(i,!1,!0),r[i]=zu(i,!0,!0)}),[t,n,e,r]}const[Hx,Gx,zx,Qx]=Wx();function m_(t,e){const n=e?t?Qx:zx:t?Gx:Hx;return(r,s,i)=>s==="__v_isReactive"?!t:s==="__v_isReadonly"?t:s==="__v_raw"?r:Reflect.get(ve(n,s)&&s in r?n:r,s,i)}const Yx={get:m_(!1,!1)},Jx={get:m_(!1,!0)},Xx={get:m_(!0,!1)},IS=new WeakMap,ES=new WeakMap,TS=new WeakMap,Zx=new WeakMap;function eO(t){switch(t){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function tO(t){return t.__v_skip||!Object.isExtensible(t)?0:eO(Cx(t))}function $a(t){return ol(t)?t:__(t,!1,bS,Yx,IS)}function nO(t){return __(t,!1,Kx,Jx,ES)}function SS(t){return __(t,!0,jx,Xx,TS)}function __(t,e,n,r,s){if(!tt(t)||t.__v_raw&&!(e&&t.__v_isReactive))return t;const i=s.get(t);if(i)return i;const o=tO(t);if(o===0)return t;const a=new Proxy(t,o===2?r:n);return s.set(t,a),a}function Ms(t){return ol(t)?Ms(t.__v_raw):!!(t&&t.__v_isReactive)}function ol(t){return!!(t&&t.__v_isReadonly)}function kg(t){return!!(t&&t.__v_isShallow)}function CS(t){return Ms(t)||ol(t)}function Se(t){const e=t&&t.__v_raw;return e?Se(e):t}function fa(t){return Ph(t,"__v_skip",!0),t}const al=t=>tt(t)?$a(t):t,y_=t=>tt(t)?SS(t):t;function AS(t){Os&&er&&(t=Se(t),yS(t.dep||(t.dep=d_())))}function kS(t,e){t=Se(t),t.dep&&Ag(t.dep)}function at(t){return!!(t&&t.__v_isRef===!0)}function v_(t){return RS(t,!1)}function rO(t){return RS(t,!0)}function RS(t,e){return at(t)?t:new sO(t,e)}class sO{constructor(e,n){this.__v_isShallow=n,this.dep=void 0,this.__v_isRef=!0,this._rawValue=n?e:Se(e),this._value=n?e:al(e)}get value(){return AS(this),this._value}set value(e){e=this.__v_isShallow?e:Se(e),sl(e,this._rawValue)&&(this._rawValue=e,this._value=this.__v_isShallow?e:al(e),kS(this))}}function xc(t){return at(t)?t.value:t}const iO={get:(t,e,n)=>xc(Reflect.get(t,e,n)),set:(t,e,n,r)=>{const s=t[e];return at(s)&&!at(n)?(s.value=n,!0):Reflect.set(t,e,n,r)}};function NS(t){return Ms(t)?t:new Proxy(t,iO)}function oO(t){const e=ee(t)?new Array(t.length):{};for(const n in t)e[n]=cO(t,n);return e}class aO{constructor(e,n,r){this._object=e,this._key=n,this._defaultValue=r,this.__v_isRef=!0}get value(){const e=this._object[this._key];return e===void 0?this._defaultValue:e}set value(e){this._object[this._key]=e}}function cO(t,e,n){const r=t[e];return at(r)?r:new aO(t,e,n)}class lO{constructor(e,n,r,s){this._setter=n,this.dep=void 0,this.__v_isRef=!0,this._dirty=!0,this.effect=new f_(e,()=>{this._dirty||(this._dirty=!0,kS(this))}),this.effect.computed=this,this.effect.active=this._cacheable=!s,this.__v_isReadonly=r}get value(){const e=Se(this);return AS(e),(e._dirty||!e._cacheable)&&(e._dirty=!1,e._value=e.effect.run()),e._value}set value(e){this._setter(e)}}function uO(t,e,n=!1){let r,s;const i=le(t);return i?(r=t,s=ir):(r=t.get,s=t.set),new lO(r,s,i||!s,n)}function Ls(t,e,n,r){let s;try{s=r?t(...r):t()}catch(i){Bd(i,e,n)}return s}function Wn(t,e,n,r){if(le(t)){const i=Ls(t,e,n,r);return i&&uS(i)&&i.catch(o=>{Bd(o,e,n)}),i}const s=[];for(let i=0;i<t.length;i++)s.push(Wn(t[i],e,n,r));return s}function Bd(t,e,n,r=!0){const s=e?e.vnode:null;if(e){let i=e.parent;const o=e.proxy,a=n;for(;i;){const l=i.ec;if(l){for(let u=0;u<l.length;u++)if(l[u](t,o,a)===!1)return}i=i.parent}const c=e.appContext.config.errorHandler;if(c){Ls(c,null,10,[t,o,a]);return}}hO(t,n,s,r)}function hO(t,e,n,r=!0){console.error(t)}let Dh=!1,Rg=!1;const An=[];let Hr=0;const Oc=[];let Ac=null,jo=0;const Mc=[];let Ts=null,Ko=0;const PS=Promise.resolve();let w_=null,Ng=null;function b_(t){const e=w_||PS;return t?e.then(this?t.bind(this):t):e}function dO(t){let e=Hr+1,n=An.length;for(;e<n;){const r=e+n>>>1;cl(An[r])<t?e=r+1:n=r}return e}function DS(t){(!An.length||!An.includes(t,Dh&&t.allowRecurse?Hr+1:Hr))&&t!==Ng&&(t.id==null?An.push(t):An.splice(dO(t.id),0,t),xS())}function xS(){!Dh&&!Rg&&(Rg=!0,w_=PS.then(LS))}function fO(t){const e=An.indexOf(t);e>Hr&&An.splice(e,1)}function OS(t,e,n,r){ee(t)?n.push(...t):(!e||!e.includes(t,t.allowRecurse?r+1:r))&&n.push(t),xS()}function pO(t){OS(t,Ac,Oc,jo)}function gO(t){OS(t,Ts,Mc,Ko)}function qd(t,e=null){if(Oc.length){for(Ng=e,Ac=[...new Set(Oc)],Oc.length=0,jo=0;jo<Ac.length;jo++)Ac[jo]();Ac=null,jo=0,Ng=null,qd(t,e)}}function MS(t){if(qd(),Mc.length){const e=[...new Set(Mc)];if(Mc.length=0,Ts){Ts.push(...e);return}for(Ts=e,Ts.sort((n,r)=>cl(n)-cl(r)),Ko=0;Ko<Ts.length;Ko++)Ts[Ko]();Ts=null,Ko=0}}const cl=t=>t.id==null?1/0:t.id;function LS(t){Rg=!1,Dh=!0,qd(t),An.sort((n,r)=>cl(n)-cl(r));const e=ir;try{for(Hr=0;Hr<An.length;Hr++){const n=An[Hr];n&&n.active!==!1&&Ls(n,null,14)}}finally{Hr=0,An.length=0,MS(),Dh=!1,w_=null,(An.length||Oc.length||Mc.length)&&LS(t)}}function mO(t,e,...n){if(t.isUnmounted)return;const r=t.vnode.props||Oe;let s=n;const i=e.startsWith("update:"),o=i&&e.slice(7);if(o&&o in r){const u=`${o==="modelValue"?"model":o}Modifiers`,{number:h,trim:d}=r[u]||Oe;d&&(s=n.map(f=>f.trim())),h&&(s=n.map(il))}let a,c=r[a=bp(e)]||r[a=bp(Dr(e))];!c&&i&&(c=r[a=bp(wo(e))]),c&&Wn(c,t,6,s);const l=r[a+"Once"];if(l){if(!t.emitted)t.emitted={};else if(t.emitted[a])return;t.emitted[a]=!0,Wn(l,t,6,s)}}function FS(t,e,n=!1){const r=e.emitsCache,s=r.get(t);if(s!==void 0)return s;const i=t.emits;let o={},a=!1;if(!le(t)){const c=l=>{const u=FS(l,e,!0);u&&(a=!0,Ht(o,u))};!n&&e.mixins.length&&e.mixins.forEach(c),t.extends&&c(t.extends),t.mixins&&t.mixins.forEach(c)}return!i&&!a?(r.set(t,null),null):(ee(i)?i.forEach(c=>o[c]=null):Ht(o,i),r.set(t,o),o)}function jd(t,e){return!t||!Ld(e)?!1:(e=e.slice(2).replace(/Once$/,""),ve(t,e[0].toLowerCase()+e.slice(1))||ve(t,wo(e))||ve(t,e))}let Vn=null,Kd=null;function xh(t){const e=Vn;return Vn=t,Kd=t&&t.type.__scopeId||null,e}function US(t){Kd=t}function $S(){Kd=null}function Zo(t,e=Vn,n){if(!e||t._n)return t;const r=(...s)=>{r._d&&tb(-1);const i=xh(e),o=t(...s);return xh(i),r._d&&tb(1),o};return r._n=!0,r._c=!0,r._d=!0,r}function Ip(t){const{type:e,vnode:n,proxy:r,withProxy:s,props:i,propsOptions:[o],slots:a,attrs:c,emit:l,render:u,renderCache:h,data:d,setupState:f,ctx:p,inheritAttrs:_}=t;let y,I;const N=xh(t);try{if(n.shapeFlag&4){const M=s||r;y=_r(u.call(M,M,h,i,f,d,p)),I=c}else{const M=e;y=_r(M.length>1?M(i,{attrs:c,slots:a,emit:l}):M(i,null)),I=e.props?c:_O(c)}}catch(M){Fc.length=0,Bd(M,t,1),y=ct(or)}let k=y;if(I&&_!==!1){const M=Object.keys(I),{shapeFlag:j}=k;M.length&&j&7&&(o&&M.some(l_)&&(I=yO(I,o)),k=Ws(k,I))}return n.dirs&&(k=Ws(k),k.dirs=k.dirs?k.dirs.concat(n.dirs):n.dirs),n.transition&&(k.transition=n.transition),y=k,xh(N),y}const _O=t=>{let e;for(const n in t)(n==="class"||n==="style"||Ld(n))&&((e||(e={}))[n]=t[n]);return e},yO=(t,e)=>{const n={};for(const r in t)(!l_(r)||!(r.slice(9)in e))&&(n[r]=t[r]);return n};function vO(t,e,n){const{props:r,children:s,component:i}=t,{props:o,children:a,patchFlag:c}=e,l=i.emitsOptions;if(e.dirs||e.transition)return!0;if(n&&c>=0){if(c&1024)return!0;if(c&16)return r?Ww(r,o,l):!!o;if(c&8){const u=e.dynamicProps;for(let h=0;h<u.length;h++){const d=u[h];if(o[d]!==r[d]&&!jd(l,d))return!0}}}else return(s||a)&&(!a||!a.$stable)?!0:r===o?!1:r?o?Ww(r,o,l):!0:!!o;return!1}function Ww(t,e,n){const r=Object.keys(e);if(r.length!==Object.keys(t).length)return!0;for(let s=0;s<r.length;s++){const i=r[s];if(e[i]!==t[i]&&!jd(n,i))return!0}return!1}function wO({vnode:t,parent:e},n){for(;e&&e.subTree===t;)(t=e.vnode).el=n,e=e.parent}const bO=t=>t.__isSuspense;function IO(t,e){e&&e.pendingBranch?ee(t)?e.effects.push(...t):e.effects.push(t):gO(t)}function mh(t,e){if(St){let n=St.provides;const r=St.parent&&St.parent.provides;r===n&&(n=St.provides=Object.create(r)),n[t]=e}}function Cr(t,e,n=!1){const r=St||Vn;if(r){const s=r.parent==null?r.vnode.appContext&&r.vnode.appContext.provides:r.parent.provides;if(s&&t in s)return s[t];if(arguments.length>1)return n&&le(e)?e.call(r.proxy):e}}const Hw={};function Lc(t,e,n){return VS(t,e,n)}function VS(t,e,{immediate:n,deep:r,flush:s,onTrack:i,onTrigger:o}=Oe){const a=St;let c,l=!1,u=!1;if(at(t)?(c=()=>t.value,l=kg(t)):Ms(t)?(c=()=>t,r=!0):ee(t)?(u=!0,l=t.some(I=>Ms(I)||kg(I)),c=()=>t.map(I=>{if(at(I))return I.value;if(Ms(I))return Di(I);if(le(I))return Ls(I,a,2)})):le(t)?e?c=()=>Ls(t,a,2):c=()=>{if(!(a&&a.isUnmounted))return h&&h(),Wn(t,a,3,[d])}:c=ir,e&&r){const I=c;c=()=>Di(I())}let h,d=I=>{h=y.onStop=()=>{Ls(I,a,4)}};if(hl)return d=ir,e?n&&Wn(e,a,3,[c(),u?[]:void 0,d]):c(),ir;let f=u?[]:Hw;const p=()=>{if(!!y.active)if(e){const I=y.run();(r||l||(u?I.some((N,k)=>sl(N,f[k])):sl(I,f)))&&(h&&h(),Wn(e,a,3,[I,f===Hw?void 0:f,d]),f=I)}else y.run()};p.allowRecurse=!!e;let _;s==="sync"?_=p:s==="post"?_=()=>pn(p,a&&a.suspense):_=()=>pO(p);const y=new f_(c,_);return e?n?p():f=y.run():s==="post"?pn(y.run.bind(y),a&&a.suspense):y.run(),()=>{y.stop(),a&&a.scope&&u_(a.scope.effects,y)}}function EO(t,e,n){const r=this.proxy,s=Nt(t)?t.includes(".")?BS(r,t):()=>r[t]:t.bind(r,r);let i;le(e)?i=e:(i=e.handler,n=e);const o=St;pa(this);const a=VS(s,i.bind(r),n);return o?pa(o):Bi(),a}function BS(t,e){const n=e.split(".");return()=>{let r=t;for(let s=0;s<n.length&&r;s++)r=r[n[s]];return r}}function Di(t,e){if(!tt(t)||t.__v_skip||(e=e||new Set,e.has(t)))return t;if(e.add(t),at(t))Di(t.value,e);else if(ee(t))for(let n=0;n<t.length;n++)Di(t[n],e);else if(Fd(t)||Xo(t))t.forEach(n=>{Di(n,e)});else if(dS(t))for(const n in t)Di(t[n],e);return t}function TO(){const t={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return GS(()=>{t.isMounted=!0}),zS(()=>{t.isUnmounting=!0}),t}const Fn=[Function,Array],SO={name:"BaseTransition",props:{mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:Fn,onEnter:Fn,onAfterEnter:Fn,onEnterCancelled:Fn,onBeforeLeave:Fn,onLeave:Fn,onAfterLeave:Fn,onLeaveCancelled:Fn,onBeforeAppear:Fn,onAppear:Fn,onAfterAppear:Fn,onAppearCancelled:Fn},setup(t,{slots:e}){const n=C_(),r=TO();let s;return()=>{const i=e.default&&KS(e.default(),!0);if(!i||!i.length)return;let o=i[0];if(i.length>1){for(const _ of i)if(_.type!==or){o=_;break}}const a=Se(t),{mode:c}=a;if(r.isLeaving)return Ep(o);const l=Gw(o);if(!l)return Ep(o);const u=Pg(l,a,r,n);Dg(l,u);const h=n.subTree,d=h&&Gw(h);let f=!1;const{getTransitionKey:p}=l.type;if(p){const _=p();s===void 0?s=_:_!==s&&(s=_,f=!0)}if(d&&d.type!==or&&(!Si(l,d)||f)){const _=Pg(d,a,r,n);if(Dg(d,_),c==="out-in")return r.isLeaving=!0,_.afterLeave=()=>{r.isLeaving=!1,n.update()},Ep(o);c==="in-out"&&l.type!==or&&(_.delayLeave=(y,I,N)=>{const k=jS(r,d);k[String(d.key)]=d,y._leaveCb=()=>{I(),y._leaveCb=void 0,delete u.delayedLeave},u.delayedLeave=N})}return o}}},qS=SO;function jS(t,e){const{leavingVNodes:n}=t;let r=n.get(e.type);return r||(r=Object.create(null),n.set(e.type,r)),r}function Pg(t,e,n,r){const{appear:s,mode:i,persisted:o=!1,onBeforeEnter:a,onEnter:c,onAfterEnter:l,onEnterCancelled:u,onBeforeLeave:h,onLeave:d,onAfterLeave:f,onLeaveCancelled:p,onBeforeAppear:_,onAppear:y,onAfterAppear:I,onAppearCancelled:N}=e,k=String(t.key),M=jS(n,t),j=(V,ie)=>{V&&Wn(V,r,9,ie)},Y=(V,ie)=>{const _e=ie[1];j(V,ie),ee(V)?V.every(Fe=>Fe.length<=1)&&_e():V.length<=1&&_e()},z={mode:i,persisted:o,beforeEnter(V){let ie=a;if(!n.isMounted)if(s)ie=_||a;else return;V._leaveCb&&V._leaveCb(!0);const _e=M[k];_e&&Si(t,_e)&&_e.el._leaveCb&&_e.el._leaveCb(),j(ie,[V])},enter(V){let ie=c,_e=l,Fe=u;if(!n.isMounted)if(s)ie=y||c,_e=I||l,Fe=N||u;else return;let H=!1;const ke=V._enterCb=Je=>{H||(H=!0,Je?j(Fe,[V]):j(_e,[V]),z.delayedLeave&&z.delayedLeave(),V._enterCb=void 0)};ie?Y(ie,[V,ke]):ke()},leave(V,ie){const _e=String(t.key);if(V._enterCb&&V._enterCb(!0),n.isUnmounting)return ie();j(h,[V]);let Fe=!1;const H=V._leaveCb=ke=>{Fe||(Fe=!0,ie(),ke?j(p,[V]):j(f,[V]),V._leaveCb=void 0,M[_e]===t&&delete M[_e])};M[_e]=t,d?Y(d,[V,H]):H()},clone(V){return Pg(V,e,n,r)}};return z}function Ep(t){if(Wd(t))return t=Ws(t),t.children=null,t}function Gw(t){return Wd(t)?t.children?t.children[0]:void 0:t}function Dg(t,e){t.shapeFlag&6&&t.component?Dg(t.component.subTree,e):t.shapeFlag&128?(t.ssContent.transition=e.clone(t.ssContent),t.ssFallback.transition=e.clone(t.ssFallback)):t.transition=e}function KS(t,e=!1,n){let r=[],s=0;for(let i=0;i<t.length;i++){let o=t[i];const a=n==null?o.key:String(n)+String(o.key!=null?o.key:i);o.type===Un?(o.patchFlag&128&&s++,r=r.concat(KS(o.children,e,a))):(e||o.type!==or)&&r.push(a!=null?Ws(o,{key:a}):o)}if(s>1)for(let i=0;i<r.length;i++)r[i].patchFlag=-2;return r}function WS(t){return le(t)?{setup:t,name:t.name}:t}const _h=t=>!!t.type.__asyncLoader,Wd=t=>t.type.__isKeepAlive;function CO(t,e){HS(t,"a",e)}function AO(t,e){HS(t,"da",e)}function HS(t,e,n=St){const r=t.__wdc||(t.__wdc=()=>{let s=n;for(;s;){if(s.isDeactivated)return;s=s.parent}return t()});if(Hd(e,r,n),n){let s=n.parent;for(;s&&s.parent;)Wd(s.parent.vnode)&&kO(r,e,n,s),s=s.parent}}function kO(t,e,n,r){const s=Hd(e,t,r,!0);I_(()=>{u_(r[e],s)},n)}function Hd(t,e,n=St,r=!1){if(n){const s=n[t]||(n[t]=[]),i=e.__weh||(e.__weh=(...o)=>{if(n.isUnmounted)return;Fa(),pa(n);const a=Wn(e,n,t,o);return Bi(),Ua(),a});return r?s.unshift(i):s.push(i),i}}const ls=t=>(e,n=St)=>(!hl||t==="sp")&&Hd(t,e,n),RO=ls("bm"),GS=ls("m"),NO=ls("bu"),PO=ls("u"),zS=ls("bum"),I_=ls("um"),DO=ls("sp"),xO=ls("rtg"),OO=ls("rtc");function MO(t,e=St){Hd("ec",t,e)}function E9(t,e){const n=Vn;if(n===null)return t;const r=zd(n)||n.proxy,s=t.dirs||(t.dirs=[]);for(let i=0;i<e.length;i++){let[o,a,c,l=Oe]=e[i];le(o)&&(o={mounted:o,updated:o}),o.deep&&Di(a),s.push({dir:o,instance:r,value:a,oldValue:void 0,arg:c,modifiers:l})}return t}function pi(t,e,n,r){const s=t.dirs,i=e&&e.dirs;for(let o=0;o<s.length;o++){const a=s[o];i&&(a.oldValue=i[o].value);let c=a.dir[r];c&&(Fa(),Wn(c,n,8,[t.el,a,t,e]),Ua())}}const QS="components";function Go(t,e){return FO(QS,t,!0,e)||t}const LO=Symbol();function FO(t,e,n=!0,r=!1){const s=Vn||St;if(s){const i=s.type;if(t===QS){const a=fM(i,!1);if(a&&(a===e||a===Dr(e)||a===$d(Dr(e))))return i}const o=zw(s[t]||i[t],e)||zw(s.appContext[t],e);return!o&&r?i:o}}function zw(t,e){return t&&(t[e]||t[Dr(e)]||t[$d(Dr(e))])}function T9(t,e,n,r){let s;const i=n&&n[r];if(ee(t)||Nt(t)){s=new Array(t.length);for(let o=0,a=t.length;o<a;o++)s[o]=e(t[o],o,void 0,i&&i[o])}else if(typeof t=="number"){s=new Array(t);for(let o=0;o<t;o++)s[o]=e(o+1,o,void 0,i&&i[o])}else if(tt(t))if(t[Symbol.iterator])s=Array.from(t,(o,a)=>e(o,a,void 0,i&&i[a]));else{const o=Object.keys(t);s=new Array(o.length);for(let a=0,c=o.length;a<c;a++){const l=o[a];s[a]=e(t[l],l,a,i&&i[a])}}else s=[];return n&&(n[r]=s),s}const xg=t=>t?a0(t)?zd(t)||t.proxy:xg(t.parent):null,Oh=Ht(Object.create(null),{$:t=>t,$el:t=>t.vnode.el,$data:t=>t.data,$props:t=>t.props,$attrs:t=>t.attrs,$slots:t=>t.slots,$refs:t=>t.refs,$parent:t=>xg(t.parent),$root:t=>xg(t.root),$emit:t=>t.emit,$options:t=>JS(t),$forceUpdate:t=>t.f||(t.f=()=>DS(t.update)),$nextTick:t=>t.n||(t.n=b_.bind(t.proxy)),$watch:t=>EO.bind(t)}),UO={get({_:t},e){const{ctx:n,setupState:r,data:s,props:i,accessCache:o,type:a,appContext:c}=t;let l;if(e[0]!=="$"){const f=o[e];if(f!==void 0)switch(f){case 1:return r[e];case 2:return s[e];case 4:return n[e];case 3:return i[e]}else{if(r!==Oe&&ve(r,e))return o[e]=1,r[e];if(s!==Oe&&ve(s,e))return o[e]=2,s[e];if((l=t.propsOptions[0])&&ve(l,e))return o[e]=3,i[e];if(n!==Oe&&ve(n,e))return o[e]=4,n[e];Og&&(o[e]=0)}}const u=Oh[e];let h,d;if(u)return e==="$attrs"&&Dn(t,"get",e),u(t);if((h=a.__cssModules)&&(h=h[e]))return h;if(n!==Oe&&ve(n,e))return o[e]=4,n[e];if(d=c.config.globalProperties,ve(d,e))return d[e]},set({_:t},e,n){const{data:r,setupState:s,ctx:i}=t;return s!==Oe&&ve(s,e)?(s[e]=n,!0):r!==Oe&&ve(r,e)?(r[e]=n,!0):ve(t.props,e)||e[0]==="$"&&e.slice(1)in t?!1:(i[e]=n,!0)},has({_:{data:t,setupState:e,accessCache:n,ctx:r,appContext:s,propsOptions:i}},o){let a;return!!n[o]||t!==Oe&&ve(t,o)||e!==Oe&&ve(e,o)||(a=i[0])&&ve(a,o)||ve(r,o)||ve(Oh,o)||ve(s.config.globalProperties,o)},defineProperty(t,e,n){return n.get!=null?t._.accessCache[e]=0:ve(n,"value")&&this.set(t,e,n.value,null),Reflect.defineProperty(t,e,n)}};let Og=!0;function $O(t){const e=JS(t),n=t.proxy,r=t.ctx;Og=!1,e.beforeCreate&&Qw(e.beforeCreate,t,"bc");const{data:s,computed:i,methods:o,watch:a,provide:c,inject:l,created:u,beforeMount:h,mounted:d,beforeUpdate:f,updated:p,activated:_,deactivated:y,beforeDestroy:I,beforeUnmount:N,destroyed:k,unmounted:M,render:j,renderTracked:Y,renderTriggered:z,errorCaptured:V,serverPrefetch:ie,expose:_e,inheritAttrs:Fe,components:H,directives:ke,filters:Je}=e;if(l&&VO(l,r,null,t.appContext.config.unwrapInjectedRef),o)for(const Ue in o){const Re=o[Ue];le(Re)&&(r[Ue]=Re.bind(n))}if(s){const Ue=s.call(n,n);tt(Ue)&&(t.data=$a(Ue))}if(Og=!0,i)for(const Ue in i){const Re=i[Ue],Tn=le(Re)?Re.bind(n,n):le(Re.get)?Re.get.bind(n,n):ir,xo=!le(Re)&&le(Re.set)?Re.set.bind(n):ir,qr=tr({get:Tn,set:xo});Object.defineProperty(r,Ue,{enumerable:!0,configurable:!0,get:()=>qr.value,set:dr=>qr.value=dr})}if(a)for(const Ue in a)YS(a[Ue],r,n,Ue);if(c){const Ue=le(c)?c.call(n):c;Reflect.ownKeys(Ue).forEach(Re=>{mh(Re,Ue[Re])})}u&&Qw(u,t,"c");function Ze(Ue,Re){ee(Re)?Re.forEach(Tn=>Ue(Tn.bind(n))):Re&&Ue(Re.bind(n))}if(Ze(RO,h),Ze(GS,d),Ze(NO,f),Ze(PO,p),Ze(CO,_),Ze(AO,y),Ze(MO,V),Ze(OO,Y),Ze(xO,z),Ze(zS,N),Ze(I_,M),Ze(DO,ie),ee(_e))if(_e.length){const Ue=t.exposed||(t.exposed={});_e.forEach(Re=>{Object.defineProperty(Ue,Re,{get:()=>n[Re],set:Tn=>n[Re]=Tn})})}else t.exposed||(t.exposed={});j&&t.render===ir&&(t.render=j),Fe!=null&&(t.inheritAttrs=Fe),H&&(t.components=H),ke&&(t.directives=ke)}function VO(t,e,n=ir,r=!1){ee(t)&&(t=Mg(t));for(const s in t){const i=t[s];let o;tt(i)?"default"in i?o=Cr(i.from||s,i.default,!0):o=Cr(i.from||s):o=Cr(i),at(o)&&r?Object.defineProperty(e,s,{enumerable:!0,configurable:!0,get:()=>o.value,set:a=>o.value=a}):e[s]=o}}function Qw(t,e,n){Wn(ee(t)?t.map(r=>r.bind(e.proxy)):t.bind(e.proxy),e,n)}function YS(t,e,n,r){const s=r.includes(".")?BS(n,r):()=>n[r];if(Nt(t)){const i=e[t];le(i)&&Lc(s,i)}else if(le(t))Lc(s,t.bind(n));else if(tt(t))if(ee(t))t.forEach(i=>YS(i,e,n,r));else{const i=le(t.handler)?t.handler.bind(n):e[t.handler];le(i)&&Lc(s,i,t)}}function JS(t){const e=t.type,{mixins:n,extends:r}=e,{mixins:s,optionsCache:i,config:{optionMergeStrategies:o}}=t.appContext,a=i.get(e);let c;return a?c=a:!s.length&&!n&&!r?c=e:(c={},s.length&&s.forEach(l=>Mh(c,l,o,!0)),Mh(c,e,o)),i.set(e,c),c}function Mh(t,e,n,r=!1){const{mixins:s,extends:i}=e;i&&Mh(t,i,n,!0),s&&s.forEach(o=>Mh(t,o,n,!0));for(const o in e)if(!(r&&o==="expose")){const a=BO[o]||n&&n[o];t[o]=a?a(t[o],e[o]):e[o]}return t}const BO={data:Yw,props:wi,emits:wi,methods:wi,computed:wi,beforeCreate:tn,created:tn,beforeMount:tn,mounted:tn,beforeUpdate:tn,updated:tn,beforeDestroy:tn,beforeUnmount:tn,destroyed:tn,unmounted:tn,activated:tn,deactivated:tn,errorCaptured:tn,serverPrefetch:tn,components:wi,directives:wi,watch:jO,provide:Yw,inject:qO};function Yw(t,e){return e?t?function(){return Ht(le(t)?t.call(this,this):t,le(e)?e.call(this,this):e)}:e:t}function qO(t,e){return wi(Mg(t),Mg(e))}function Mg(t){if(ee(t)){const e={};for(let n=0;n<t.length;n++)e[t[n]]=t[n];return e}return t}function tn(t,e){return t?[...new Set([].concat(t,e))]:e}function wi(t,e){return t?Ht(Ht(Object.create(null),t),e):e}function jO(t,e){if(!t)return e;if(!e)return t;const n=Ht(Object.create(null),t);for(const r in e)n[r]=tn(t[r],e[r]);return n}function KO(t,e,n,r=!1){const s={},i={};Ph(i,Gd,1),t.propsDefaults=Object.create(null),XS(t,e,s,i);for(const o in t.propsOptions[0])o in s||(s[o]=void 0);n?t.props=r?s:nO(s):t.type.props?t.props=s:t.props=i,t.attrs=i}function WO(t,e,n,r){const{props:s,attrs:i,vnode:{patchFlag:o}}=t,a=Se(s),[c]=t.propsOptions;let l=!1;if((r||o>0)&&!(o&16)){if(o&8){const u=t.vnode.dynamicProps;for(let h=0;h<u.length;h++){let d=u[h];if(jd(t.emitsOptions,d))continue;const f=e[d];if(c)if(ve(i,d))f!==i[d]&&(i[d]=f,l=!0);else{const p=Dr(d);s[p]=Lg(c,a,p,f,t,!1)}else f!==i[d]&&(i[d]=f,l=!0)}}}else{XS(t,e,s,i)&&(l=!0);let u;for(const h in a)(!e||!ve(e,h)&&((u=wo(h))===h||!ve(e,u)))&&(c?n&&(n[h]!==void 0||n[u]!==void 0)&&(s[h]=Lg(c,a,h,void 0,t,!0)):delete s[h]);if(i!==a)for(const h in i)(!e||!ve(e,h)&&!0)&&(delete i[h],l=!0)}l&&rs(t,"set","$attrs")}function XS(t,e,n,r){const[s,i]=t.propsOptions;let o=!1,a;if(e)for(let c in e){if(ph(c))continue;const l=e[c];let u;s&&ve(s,u=Dr(c))?!i||!i.includes(u)?n[u]=l:(a||(a={}))[u]=l:jd(t.emitsOptions,c)||(!(c in r)||l!==r[c])&&(r[c]=l,o=!0)}if(i){const c=Se(n),l=a||Oe;for(let u=0;u<i.length;u++){const h=i[u];n[h]=Lg(s,c,h,l[h],t,!ve(l,h))}}return o}function Lg(t,e,n,r,s,i){const o=t[n];if(o!=null){const a=ve(o,"default");if(a&&r===void 0){const c=o.default;if(o.type!==Function&&le(c)){const{propsDefaults:l}=s;n in l?r=l[n]:(pa(s),r=l[n]=c.call(null,e),Bi())}else r=c}o[0]&&(i&&!a?r=!1:o[1]&&(r===""||r===wo(n))&&(r=!0))}return r}function ZS(t,e,n=!1){const r=e.propsCache,s=r.get(t);if(s)return s;const i=t.props,o={},a=[];let c=!1;if(!le(t)){const u=h=>{c=!0;const[d,f]=ZS(h,e,!0);Ht(o,d),f&&a.push(...f)};!n&&e.mixins.length&&e.mixins.forEach(u),t.extends&&u(t.extends),t.mixins&&t.mixins.forEach(u)}if(!i&&!c)return r.set(t,Jo),Jo;if(ee(i))for(let u=0;u<i.length;u++){const h=Dr(i[u]);Jw(h)&&(o[h]=Oe)}else if(i)for(const u in i){const h=Dr(u);if(Jw(h)){const d=i[u],f=o[h]=ee(d)||le(d)?{type:d}:d;if(f){const p=eb(Boolean,f.type),_=eb(String,f.type);f[0]=p>-1,f[1]=_<0||p<_,(p>-1||ve(f,"default"))&&a.push(h)}}}const l=[o,a];return r.set(t,l),l}function Jw(t){return t[0]!=="$"}function Xw(t){const e=t&&t.toString().match(/^\s*function (\w+)/);return e?e[1]:t===null?"null":""}function Zw(t,e){return Xw(t)===Xw(e)}function eb(t,e){return ee(e)?e.findIndex(n=>Zw(n,t)):le(e)&&Zw(e,t)?0:-1}const e0=t=>t[0]==="_"||t==="$stable",E_=t=>ee(t)?t.map(_r):[_r(t)],HO=(t,e,n)=>{if(e._n)return e;const r=Zo((...s)=>E_(e(...s)),n);return r._c=!1,r},t0=(t,e,n)=>{const r=t._ctx;for(const s in t){if(e0(s))continue;const i=t[s];if(le(i))e[s]=HO(s,i,r);else if(i!=null){const o=E_(i);e[s]=()=>o}}},n0=(t,e)=>{const n=E_(e);t.slots.default=()=>n},GO=(t,e)=>{if(t.vnode.shapeFlag&32){const n=e._;n?(t.slots=Se(e),Ph(e,"_",n)):t0(e,t.slots={})}else t.slots={},e&&n0(t,e);Ph(t.slots,Gd,1)},zO=(t,e,n)=>{const{vnode:r,slots:s}=t;let i=!0,o=Oe;if(r.shapeFlag&32){const a=e._;a?n&&a===1?i=!1:(Ht(s,e),!n&&a===1&&delete s._):(i=!e.$stable,t0(e,s)),o=e}else e&&(n0(t,e),o={default:1});if(i)for(const a in s)!e0(a)&&!(a in o)&&delete s[a]};function r0(){return{app:null,config:{isNativeTag:Ex,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let QO=0;function YO(t,e){return function(r,s=null){le(r)||(r=Object.assign({},r)),s!=null&&!tt(s)&&(s=null);const i=r0(),o=new Set;let a=!1;const c=i.app={_uid:QO++,_component:r,_props:s,_container:null,_context:i,_instance:null,version:gM,get config(){return i.config},set config(l){},use(l,...u){return o.has(l)||(l&&le(l.install)?(o.add(l),l.install(c,...u)):le(l)&&(o.add(l),l(c,...u))),c},mixin(l){return i.mixins.includes(l)||i.mixins.push(l),c},component(l,u){return u?(i.components[l]=u,c):i.components[l]},directive(l,u){return u?(i.directives[l]=u,c):i.directives[l]},mount(l,u,h){if(!a){const d=ct(r,s);return d.appContext=i,u&&e?e(d,l):t(d,l,h),a=!0,c._container=l,l.__vue_app__=c,zd(d.component)||d.component.proxy}},unmount(){a&&(t(null,c._container),delete c._container.__vue_app__)},provide(l,u){return i.provides[l]=u,c}};return c}}function Fg(t,e,n,r,s=!1){if(ee(t)){t.forEach((d,f)=>Fg(d,e&&(ee(e)?e[f]:e),n,r,s));return}if(_h(r)&&!s)return;const i=r.shapeFlag&4?zd(r.component)||r.component.proxy:r.el,o=s?null:i,{i:a,r:c}=t,l=e&&e.r,u=a.refs===Oe?a.refs={}:a.refs,h=a.setupState;if(l!=null&&l!==c&&(Nt(l)?(u[l]=null,ve(h,l)&&(h[l]=null)):at(l)&&(l.value=null)),le(c))Ls(c,a,12,[o,u]);else{const d=Nt(c),f=at(c);if(d||f){const p=()=>{if(t.f){const _=d?u[c]:c.value;s?ee(_)&&u_(_,i):ee(_)?_.includes(i)||_.push(i):d?(u[c]=[i],ve(h,c)&&(h[c]=u[c])):(c.value=[i],t.k&&(u[t.k]=c.value))}else d?(u[c]=o,ve(h,c)&&(h[c]=o)):f&&(c.value=o,t.k&&(u[t.k]=o))};o?(p.id=-1,pn(p,n)):p()}}}const pn=IO;function JO(t){return XO(t)}function XO(t,e){const n=Rx();n.__VUE__=!0;const{insert:r,remove:s,patchProp:i,createElement:o,createText:a,createComment:c,setText:l,setElementText:u,parentNode:h,nextSibling:d,setScopeId:f=ir,cloneNode:p,insertStaticContent:_}=t,y=(g,m,b,C=null,T=null,L=null,q=!1,O=null,U=!!m.dynamicChildren)=>{if(g===m)return;g&&!Si(g,m)&&(C=J(g),Ln(g,T,L,!0),g=null),m.patchFlag===-2&&(U=!1,m.dynamicChildren=null);const{type:P,ref:X,shapeFlag:G}=m;switch(P){case T_:I(g,m,b,C);break;case or:N(g,m,b,C);break;case yh:g==null&&k(m,b,C,q);break;case Un:ke(g,m,b,C,T,L,q,O,U);break;default:G&1?Y(g,m,b,C,T,L,q,O,U):G&6?Je(g,m,b,C,T,L,q,O,U):(G&64||G&128)&&P.process(g,m,b,C,T,L,q,O,U,$e)}X!=null&&T&&Fg(X,g&&g.ref,L,m||g,!m)},I=(g,m,b,C)=>{if(g==null)r(m.el=a(m.children),b,C);else{const T=m.el=g.el;m.children!==g.children&&l(T,m.children)}},N=(g,m,b,C)=>{g==null?r(m.el=c(m.children||""),b,C):m.el=g.el},k=(g,m,b,C)=>{[g.el,g.anchor]=_(g.children,m,b,C,g.el,g.anchor)},M=({el:g,anchor:m},b,C)=>{let T;for(;g&&g!==m;)T=d(g),r(g,b,C),g=T;r(m,b,C)},j=({el:g,anchor:m})=>{let b;for(;g&&g!==m;)b=d(g),s(g),g=b;s(m)},Y=(g,m,b,C,T,L,q,O,U)=>{q=q||m.type==="svg",g==null?z(m,b,C,T,L,q,O,U):_e(g,m,T,L,q,O,U)},z=(g,m,b,C,T,L,q,O)=>{let U,P;const{type:X,props:G,shapeFlag:Z,transition:ae,patchFlag:be,dirs:Pe}=g;if(g.el&&p!==void 0&&be===-1)U=g.el=p(g.el);else{if(U=g.el=o(g.type,L,G&&G.is,G),Z&8?u(U,g.children):Z&16&&ie(g.children,U,null,C,T,L&&X!=="foreignObject",q,O),Pe&&pi(g,null,C,"created"),G){for(const je in G)je!=="value"&&!ph(je)&&i(U,je,null,G[je],L,g.children,C,T,$);"value"in G&&i(U,"value",null,G.value),(P=G.onVnodeBeforeMount)&&pr(P,C,g)}V(U,g,g.scopeId,q,C)}Pe&&pi(g,null,C,"beforeMount");const De=(!T||T&&!T.pendingBranch)&&ae&&!ae.persisted;De&&ae.beforeEnter(U),r(U,m,b),((P=G&&G.onVnodeMounted)||De||Pe)&&pn(()=>{P&&pr(P,C,g),De&&ae.enter(U),Pe&&pi(g,null,C,"mounted")},T)},V=(g,m,b,C,T)=>{if(b&&f(g,b),C)for(let L=0;L<C.length;L++)f(g,C[L]);if(T){let L=T.subTree;if(m===L){const q=T.vnode;V(g,q,q.scopeId,q.slotScopeIds,T.parent)}}},ie=(g,m,b,C,T,L,q,O,U=0)=>{for(let P=U;P<g.length;P++){const X=g[P]=O?Ss(g[P]):_r(g[P]);y(null,X,m,b,C,T,L,q,O)}},_e=(g,m,b,C,T,L,q)=>{const O=m.el=g.el;let{patchFlag:U,dynamicChildren:P,dirs:X}=m;U|=g.patchFlag&16;const G=g.props||Oe,Z=m.props||Oe;let ae;b&&gi(b,!1),(ae=Z.onVnodeBeforeUpdate)&&pr(ae,b,m,g),X&&pi(m,g,b,"beforeUpdate"),b&&gi(b,!0);const be=T&&m.type!=="foreignObject";if(P?Fe(g.dynamicChildren,P,O,b,C,be,L):q||Tn(g,m,O,null,b,C,be,L,!1),U>0){if(U&16)H(O,m,G,Z,b,C,T);else if(U&2&&G.class!==Z.class&&i(O,"class",null,Z.class,T),U&4&&i(O,"style",G.style,Z.style,T),U&8){const Pe=m.dynamicProps;for(let De=0;De<Pe.length;De++){const je=Pe[De],Jn=G[je],Oo=Z[je];(Oo!==Jn||je==="value")&&i(O,je,Jn,Oo,T,g.children,b,C,$)}}U&1&&g.children!==m.children&&u(O,m.children)}else!q&&P==null&&H(O,m,G,Z,b,C,T);((ae=Z.onVnodeUpdated)||X)&&pn(()=>{ae&&pr(ae,b,m,g),X&&pi(m,g,b,"updated")},C)},Fe=(g,m,b,C,T,L,q)=>{for(let O=0;O<m.length;O++){const U=g[O],P=m[O],X=U.el&&(U.type===Un||!Si(U,P)||U.shapeFlag&70)?h(U.el):b;y(U,P,X,null,C,T,L,q,!0)}},H=(g,m,b,C,T,L,q)=>{if(b!==C){for(const O in C){if(ph(O))continue;const U=C[O],P=b[O];U!==P&&O!=="value"&&i(g,O,P,U,q,m.children,T,L,$)}if(b!==Oe)for(const O in b)!ph(O)&&!(O in C)&&i(g,O,b[O],null,q,m.children,T,L,$);"value"in C&&i(g,"value",b.value,C.value)}},ke=(g,m,b,C,T,L,q,O,U)=>{const P=m.el=g?g.el:a(""),X=m.anchor=g?g.anchor:a("");let{patchFlag:G,dynamicChildren:Z,slotScopeIds:ae}=m;ae&&(O=O?O.concat(ae):ae),g==null?(r(P,b,C),r(X,b,C),ie(m.children,b,X,T,L,q,O,U)):G>0&&G&64&&Z&&g.dynamicChildren?(Fe(g.dynamicChildren,Z,b,T,L,q,O),(m.key!=null||T&&m===T.subTree)&&s0(g,m,!0)):Tn(g,m,b,X,T,L,q,O,U)},Je=(g,m,b,C,T,L,q,O,U)=>{m.slotScopeIds=O,g==null?m.shapeFlag&512?T.ctx.activate(m,b,C,q,U):Xe(m,b,C,T,L,q,U):Ze(g,m,U)},Xe=(g,m,b,C,T,L,q)=>{const O=g.component=cM(g,C,T);if(Wd(g)&&(O.ctx.renderer=$e),lM(O),O.asyncDep){if(T&&T.registerDep(O,Ue),!g.el){const U=O.subTree=ct(or);N(null,U,m,b)}return}Ue(O,g,m,b,T,L,q)},Ze=(g,m,b)=>{const C=m.component=g.component;if(vO(g,m,b))if(C.asyncDep&&!C.asyncResolved){Re(C,m,b);return}else C.next=m,fO(C.update),C.update();else m.el=g.el,C.vnode=m},Ue=(g,m,b,C,T,L,q)=>{const O=()=>{if(g.isMounted){let{next:X,bu:G,u:Z,parent:ae,vnode:be}=g,Pe=X,De;gi(g,!1),X?(X.el=be.el,Re(g,X,q)):X=be,G&&gh(G),(De=X.props&&X.props.onVnodeBeforeUpdate)&&pr(De,ae,X,be),gi(g,!0);const je=Ip(g),Jn=g.subTree;g.subTree=je,y(Jn,je,h(Jn.el),J(Jn),g,T,L),X.el=je.el,Pe===null&&wO(g,je.el),Z&&pn(Z,T),(De=X.props&&X.props.onVnodeUpdated)&&pn(()=>pr(De,ae,X,be),T)}else{let X;const{el:G,props:Z}=m,{bm:ae,m:be,parent:Pe}=g,De=_h(m);if(gi(g,!1),ae&&gh(ae),!De&&(X=Z&&Z.onVnodeBeforeMount)&&pr(X,Pe,m),gi(g,!0),G&&he){const je=()=>{g.subTree=Ip(g),he(G,g.subTree,g,T,null)};De?m.type.__asyncLoader().then(()=>!g.isUnmounted&&je()):je()}else{const je=g.subTree=Ip(g);y(null,je,b,C,g,T,L),m.el=je.el}if(be&&pn(be,T),!De&&(X=Z&&Z.onVnodeMounted)){const je=m;pn(()=>pr(X,Pe,je),T)}(m.shapeFlag&256||Pe&&_h(Pe.vnode)&&Pe.vnode.shapeFlag&256)&&g.a&&pn(g.a,T),g.isMounted=!0,m=b=C=null}},U=g.effect=new f_(O,()=>DS(P),g.scope),P=g.update=()=>U.run();P.id=g.uid,gi(g,!0),P()},Re=(g,m,b)=>{m.component=g;const C=g.vnode.props;g.vnode=m,g.next=null,WO(g,m.props,C,b),zO(g,m.children,b),Fa(),qd(void 0,g.update),Ua()},Tn=(g,m,b,C,T,L,q,O,U=!1)=>{const P=g&&g.children,X=g?g.shapeFlag:0,G=m.children,{patchFlag:Z,shapeFlag:ae}=m;if(Z>0){if(Z&128){qr(P,G,b,C,T,L,q,O,U);return}else if(Z&256){xo(P,G,b,C,T,L,q,O,U);return}}ae&8?(X&16&&$(P,T,L),G!==P&&u(b,G)):X&16?ae&16?qr(P,G,b,C,T,L,q,O,U):$(P,T,L,!0):(X&8&&u(b,""),ae&16&&ie(G,b,C,T,L,q,O,U))},xo=(g,m,b,C,T,L,q,O,U)=>{g=g||Jo,m=m||Jo;const P=g.length,X=m.length,G=Math.min(P,X);let Z;for(Z=0;Z<G;Z++){const ae=m[Z]=U?Ss(m[Z]):_r(m[Z]);y(g[Z],ae,b,null,T,L,q,O,U)}P>X?$(g,T,L,!0,!1,G):ie(m,b,C,T,L,q,O,U,G)},qr=(g,m,b,C,T,L,q,O,U)=>{let P=0;const X=m.length;let G=g.length-1,Z=X-1;for(;P<=G&&P<=Z;){const ae=g[P],be=m[P]=U?Ss(m[P]):_r(m[P]);if(Si(ae,be))y(ae,be,b,null,T,L,q,O,U);else break;P++}for(;P<=G&&P<=Z;){const ae=g[G],be=m[Z]=U?Ss(m[Z]):_r(m[Z]);if(Si(ae,be))y(ae,be,b,null,T,L,q,O,U);else break;G--,Z--}if(P>G){if(P<=Z){const ae=Z+1,be=ae<X?m[ae].el:C;for(;P<=Z;)y(null,m[P]=U?Ss(m[P]):_r(m[P]),b,be,T,L,q,O,U),P++}}else if(P>Z)for(;P<=G;)Ln(g[P],T,L,!0),P++;else{const ae=P,be=P,Pe=new Map;for(P=be;P<=Z;P++){const Sn=m[P]=U?Ss(m[P]):_r(m[P]);Sn.key!=null&&Pe.set(Sn.key,P)}let De,je=0;const Jn=Z-be+1;let Oo=!1,xw=0;const cc=new Array(Jn);for(P=0;P<Jn;P++)cc[P]=0;for(P=ae;P<=G;P++){const Sn=g[P];if(je>=Jn){Ln(Sn,T,L,!0);continue}let fr;if(Sn.key!=null)fr=Pe.get(Sn.key);else for(De=be;De<=Z;De++)if(cc[De-be]===0&&Si(Sn,m[De])){fr=De;break}fr===void 0?Ln(Sn,T,L,!0):(cc[fr-be]=P+1,fr>=xw?xw=fr:Oo=!0,y(Sn,m[fr],b,null,T,L,q,O,U),je++)}const Ow=Oo?ZO(cc):Jo;for(De=Ow.length-1,P=Jn-1;P>=0;P--){const Sn=be+P,fr=m[Sn],Mw=Sn+1<X?m[Sn+1].el:C;cc[P]===0?y(null,fr,b,Mw,T,L,q,O,U):Oo&&(De<0||P!==Ow[De]?dr(fr,b,Mw,2):De--)}}},dr=(g,m,b,C,T=null)=>{const{el:L,type:q,transition:O,children:U,shapeFlag:P}=g;if(P&6){dr(g.component.subTree,m,b,C);return}if(P&128){g.suspense.move(m,b,C);return}if(P&64){q.move(g,m,b,$e);return}if(q===Un){r(L,m,b);for(let G=0;G<U.length;G++)dr(U[G],m,b,C);r(g.anchor,m,b);return}if(q===yh){M(g,m,b);return}if(C!==2&&P&1&&O)if(C===0)O.beforeEnter(L),r(L,m,b),pn(()=>O.enter(L),T);else{const{leave:G,delayLeave:Z,afterLeave:ae}=O,be=()=>r(L,m,b),Pe=()=>{G(L,()=>{be(),ae&&ae()})};Z?Z(L,be,Pe):Pe()}else r(L,m,b)},Ln=(g,m,b,C=!1,T=!1)=>{const{type:L,props:q,ref:O,children:U,dynamicChildren:P,shapeFlag:X,patchFlag:G,dirs:Z}=g;if(O!=null&&Fg(O,null,b,g,!0),X&256){m.ctx.deactivate(g);return}const ae=X&1&&Z,be=!_h(g);let Pe;if(be&&(Pe=q&&q.onVnodeBeforeUnmount)&&pr(Pe,m,g),X&6)Q(g.component,b,C);else{if(X&128){g.suspense.unmount(b,C);return}ae&&pi(g,null,m,"beforeUnmount"),X&64?g.type.remove(g,m,b,T,$e,C):P&&(L!==Un||G>0&&G&64)?$(P,m,b,!1,!0):(L===Un&&G&384||!T&&X&16)&&$(U,m,b),C&&wp(g)}(be&&(Pe=q&&q.onVnodeUnmounted)||ae)&&pn(()=>{Pe&&pr(Pe,m,g),ae&&pi(g,null,m,"unmounted")},b)},wp=g=>{const{type:m,el:b,anchor:C,transition:T}=g;if(m===Un){E(b,C);return}if(m===yh){j(g);return}const L=()=>{s(b),T&&!T.persisted&&T.afterLeave&&T.afterLeave()};if(g.shapeFlag&1&&T&&!T.persisted){const{leave:q,delayLeave:O}=T,U=()=>q(b,L);O?O(g.el,L,U):U()}else L()},E=(g,m)=>{let b;for(;g!==m;)b=d(g),s(g),g=b;s(m)},Q=(g,m,b)=>{const{bum:C,scope:T,update:L,subTree:q,um:O}=g;C&&gh(C),T.stop(),L&&(L.active=!1,Ln(q,g,m,b)),O&&pn(O,m),pn(()=>{g.isUnmounted=!0},m),m&&m.pendingBranch&&!m.isUnmounted&&g.asyncDep&&!g.asyncResolved&&g.suspenseId===m.pendingId&&(m.deps--,m.deps===0&&m.resolve())},$=(g,m,b,C=!1,T=!1,L=0)=>{for(let q=L;q<g.length;q++)Ln(g[q],m,b,C,T)},J=g=>g.shapeFlag&6?J(g.component.subTree):g.shapeFlag&128?g.suspense.next():d(g.anchor||g.el),Ne=(g,m,b)=>{g==null?m._vnode&&Ln(m._vnode,null,null,!0):y(m._vnode||null,g,m,null,null,null,b),MS(),m._vnode=g},$e={p:y,um:Ln,m:dr,r:wp,mt:Xe,mc:ie,pc:Tn,pbc:Fe,n:J,o:t};let me,he;return e&&([me,he]=e($e)),{render:Ne,hydrate:me,createApp:YO(Ne,me)}}function gi({effect:t,update:e},n){t.allowRecurse=e.allowRecurse=n}function s0(t,e,n=!1){const r=t.children,s=e.children;if(ee(r)&&ee(s))for(let i=0;i<r.length;i++){const o=r[i];let a=s[i];a.shapeFlag&1&&!a.dynamicChildren&&((a.patchFlag<=0||a.patchFlag===32)&&(a=s[i]=Ss(s[i]),a.el=o.el),n||s0(o,a))}}function ZO(t){const e=t.slice(),n=[0];let r,s,i,o,a;const c=t.length;for(r=0;r<c;r++){const l=t[r];if(l!==0){if(s=n[n.length-1],t[s]<l){e[r]=s,n.push(r);continue}for(i=0,o=n.length-1;i<o;)a=i+o>>1,t[n[a]]<l?i=a+1:o=a;l<t[n[i]]&&(i>0&&(e[r]=n[i-1]),n[i]=r)}}for(i=n.length,o=n[i-1];i-- >0;)n[i]=o,o=e[o];return n}const eM=t=>t.__isTeleport,Un=Symbol(void 0),T_=Symbol(void 0),or=Symbol(void 0),yh=Symbol(void 0),Fc=[];let nr=null;function Fs(t=!1){Fc.push(nr=t?null:[])}function tM(){Fc.pop(),nr=Fc[Fc.length-1]||null}let ll=1;function tb(t){ll+=t}function i0(t){return t.dynamicChildren=ll>0?nr||Jo:null,tM(),ll>0&&nr&&nr.push(t),t}function ul(t,e,n,r,s,i){return i0(Ct(t,e,n,r,s,i,!0))}function Ug(t,e,n,r,s){return i0(ct(t,e,n,r,s,!0))}function $g(t){return t?t.__v_isVNode===!0:!1}function Si(t,e){return t.type===e.type&&t.key===e.key}const Gd="__vInternal",o0=({key:t})=>t!=null?t:null,vh=({ref:t,ref_key:e,ref_for:n})=>t!=null?Nt(t)||at(t)||le(t)?{i:Vn,r:t,k:e,f:!!n}:t:null;function Ct(t,e=null,n=null,r=0,s=null,i=t===Un?0:1,o=!1,a=!1){const c={__v_isVNode:!0,__v_skip:!0,type:t,props:e,key:e&&o0(e),ref:e&&vh(e),scopeId:Kd,slotScopeIds:null,children:n,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:i,patchFlag:r,dynamicProps:s,dynamicChildren:null,appContext:null};return a?(S_(c,n),i&128&&t.normalize(c)):n&&(c.shapeFlag|=Nt(n)?8:16),ll>0&&!o&&nr&&(c.patchFlag>0||i&6)&&c.patchFlag!==32&&nr.push(c),c}const ct=nM;function nM(t,e=null,n=null,r=0,s=null,i=!1){if((!t||t===LO)&&(t=or),$g(t)){const a=Ws(t,e,!0);return n&&S_(a,n),ll>0&&!i&&nr&&(a.shapeFlag&6?nr[nr.indexOf(t)]=a:nr.push(a)),a.patchFlag|=-2,a}if(pM(t)&&(t=t.__vccOpts),e){e=rM(e);let{class:a,style:c}=e;a&&!Nt(a)&&(e.class=c_(a)),tt(c)&&(CS(c)&&!ee(c)&&(c=Ht({},c)),e.style=a_(c))}const o=Nt(t)?1:bO(t)?128:eM(t)?64:tt(t)?4:le(t)?2:0;return Ct(t,e,n,r,s,o,i,!0)}function rM(t){return t?CS(t)||Gd in t?Ht({},t):t:null}function Ws(t,e,n=!1){const{props:r,ref:s,patchFlag:i,children:o}=t,a=e?iM(r||{},e):r;return{__v_isVNode:!0,__v_skip:!0,type:t.type,props:a,key:a&&o0(a),ref:e&&e.ref?n&&s?ee(s)?s.concat(vh(e)):[s,vh(e)]:vh(e):s,scopeId:t.scopeId,slotScopeIds:t.slotScopeIds,children:o,target:t.target,targetAnchor:t.targetAnchor,staticCount:t.staticCount,shapeFlag:t.shapeFlag,patchFlag:e&&t.type!==Un?i===-1?16:i|16:i,dynamicProps:t.dynamicProps,dynamicChildren:t.dynamicChildren,appContext:t.appContext,dirs:t.dirs,transition:t.transition,component:t.component,suspense:t.suspense,ssContent:t.ssContent&&Ws(t.ssContent),ssFallback:t.ssFallback&&Ws(t.ssFallback),el:t.el,anchor:t.anchor}}function su(t=" ",e=0){return ct(T_,null,t,e)}function sM(t,e){const n=ct(yh,null,t);return n.staticCount=e,n}function Vg(t="",e=!1){return e?(Fs(),Ug(or,null,t)):ct(or,null,t)}function _r(t){return t==null||typeof t=="boolean"?ct(or):ee(t)?ct(Un,null,t.slice()):typeof t=="object"?Ss(t):ct(T_,null,String(t))}function Ss(t){return t.el===null||t.memo?t:Ws(t)}function S_(t,e){let n=0;const{shapeFlag:r}=t;if(e==null)e=null;else if(ee(e))n=16;else if(typeof e=="object")if(r&65){const s=e.default;s&&(s._c&&(s._d=!1),S_(t,s()),s._c&&(s._d=!0));return}else{n=32;const s=e._;!s&&!(Gd in e)?e._ctx=Vn:s===3&&Vn&&(Vn.slots._===1?e._=1:(e._=2,t.patchFlag|=1024))}else le(e)?(e={default:e,_ctx:Vn},n=32):(e=String(e),r&64?(n=16,e=[su(e)]):n=8);t.children=e,t.shapeFlag|=n}function iM(...t){const e={};for(let n=0;n<t.length;n++){const r=t[n];for(const s in r)if(s==="class")e.class!==r.class&&(e.class=c_([e.class,r.class]));else if(s==="style")e.style=a_([e.style,r.style]);else if(Ld(s)){const i=e[s],o=r[s];o&&i!==o&&!(ee(i)&&i.includes(o))&&(e[s]=i?[].concat(i,o):o)}else s!==""&&(e[s]=r[s])}return e}function pr(t,e,n,r=null){Wn(t,e,7,[n,r])}const oM=r0();let aM=0;function cM(t,e,n){const r=t.type,s=(e?e.appContext:t.appContext)||oM,i={uid:aM++,vnode:t,type:r,parent:e,appContext:s,root:null,next:null,subTree:null,effect:null,update:null,scope:new fS(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:e?e.provides:Object.create(s.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:ZS(r,s),emitsOptions:FS(r,s),emit:null,emitted:null,propsDefaults:Oe,inheritAttrs:r.inheritAttrs,ctx:Oe,data:Oe,props:Oe,attrs:Oe,slots:Oe,refs:Oe,setupState:Oe,setupContext:null,suspense:n,suspenseId:n?n.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return i.ctx={_:i},i.root=e?e.root:i,i.emit=mO.bind(null,i),t.ce&&t.ce(i),i}let St=null;const C_=()=>St||Vn,pa=t=>{St=t,t.scope.on()},Bi=()=>{St&&St.scope.off(),St=null};function a0(t){return t.vnode.shapeFlag&4}let hl=!1;function lM(t,e=!1){hl=e;const{props:n,children:r}=t.vnode,s=a0(t);KO(t,n,s,e),GO(t,r);const i=s?uM(t,e):void 0;return hl=!1,i}function uM(t,e){const n=t.type;t.accessCache=Object.create(null),t.proxy=fa(new Proxy(t.ctx,UO));const{setup:r}=n;if(r){const s=t.setupContext=r.length>1?dM(t):null;pa(t),Fa();const i=Ls(r,t,0,[t.props,s]);if(Ua(),Bi(),uS(i)){if(i.then(Bi,Bi),e)return i.then(o=>{nb(t,o,e)}).catch(o=>{Bd(o,t,0)});t.asyncDep=i}else nb(t,i,e)}else c0(t,e)}function nb(t,e,n){le(e)?t.type.__ssrInlineRender?t.ssrRender=e:t.render=e:tt(e)&&(t.setupState=NS(e)),c0(t,n)}let rb;function c0(t,e,n){const r=t.type;if(!t.render){if(!e&&rb&&!r.render){const s=r.template;if(s){const{isCustomElement:i,compilerOptions:o}=t.appContext.config,{delimiters:a,compilerOptions:c}=r,l=Ht(Ht({isCustomElement:i,delimiters:a},o),c);r.render=rb(s,l)}}t.render=r.render||ir}pa(t),Fa(),$O(t),Ua(),Bi()}function hM(t){return new Proxy(t.attrs,{get(e,n){return Dn(t,"get","$attrs"),e[n]}})}function dM(t){const e=r=>{t.exposed=r||{}};let n;return{get attrs(){return n||(n=hM(t))},slots:t.slots,emit:t.emit,expose:e}}function zd(t){if(t.exposed)return t.exposeProxy||(t.exposeProxy=new Proxy(NS(fa(t.exposed)),{get(e,n){if(n in e)return e[n];if(n in Oh)return Oh[n](t)}}))}function fM(t,e=!0){return le(t)?t.displayName||t.name:t.name||e&&t.__name}function pM(t){return le(t)&&"__vccOpts"in t}const tr=(t,e)=>uO(t,e,hl);function A_(t,e,n){const r=arguments.length;return r===2?tt(e)&&!ee(e)?$g(e)?ct(t,null,[e]):ct(t,e):ct(t,null,e):(r>3?n=Array.prototype.slice.call(arguments,2):r===3&&$g(n)&&(n=[n]),ct(t,e,n))}const gM="3.2.37",mM="http://www.w3.org/2000/svg",Ci=typeof document!="undefined"?document:null,sb=Ci&&Ci.createElement("template"),_M={insert:(t,e,n)=>{e.insertBefore(t,n||null)},remove:t=>{const e=t.parentNode;e&&e.removeChild(t)},createElement:(t,e,n,r)=>{const s=e?Ci.createElementNS(mM,t):Ci.createElement(t,n?{is:n}:void 0);return t==="select"&&r&&r.multiple!=null&&s.setAttribute("multiple",r.multiple),s},createText:t=>Ci.createTextNode(t),createComment:t=>Ci.createComment(t),setText:(t,e)=>{t.nodeValue=e},setElementText:(t,e)=>{t.textContent=e},parentNode:t=>t.parentNode,nextSibling:t=>t.nextSibling,querySelector:t=>Ci.querySelector(t),setScopeId(t,e){t.setAttribute(e,"")},cloneNode(t){const e=t.cloneNode(!0);return"_value"in t&&(e._value=t._value),e},insertStaticContent(t,e,n,r,s,i){const o=n?n.previousSibling:e.lastChild;if(s&&(s===i||s.nextSibling))for(;e.insertBefore(s.cloneNode(!0),n),!(s===i||!(s=s.nextSibling)););else{sb.innerHTML=r?`<svg>${t}</svg>`:t;const a=sb.content;if(r){const c=a.firstChild;for(;c.firstChild;)a.appendChild(c.firstChild);a.removeChild(c)}e.insertBefore(a,n)}return[o?o.nextSibling:e.firstChild,n?n.previousSibling:e.lastChild]}};function yM(t,e,n){const r=t._vtc;r&&(e=(e?[e,...r]:[...r]).join(" ")),e==null?t.removeAttribute("class"):n?t.setAttribute("class",e):t.className=e}function vM(t,e,n){const r=t.style,s=Nt(n);if(n&&!s){for(const i in n)Bg(r,i,n[i]);if(e&&!Nt(e))for(const i in e)n[i]==null&&Bg(r,i,"")}else{const i=r.display;s?e!==n&&(r.cssText=n):e&&t.removeAttribute("style"),"_vod"in t&&(r.display=i)}}const ib=/\s*!important$/;function Bg(t,e,n){if(ee(n))n.forEach(r=>Bg(t,e,r));else if(n==null&&(n=""),e.startsWith("--"))t.setProperty(e,n);else{const r=wM(t,e);ib.test(n)?t.setProperty(wo(r),n.replace(ib,""),"important"):t[r]=n}}const ob=["Webkit","Moz","ms"],Tp={};function wM(t,e){const n=Tp[e];if(n)return n;let r=Dr(e);if(r!=="filter"&&r in t)return Tp[e]=r;r=$d(r);for(let s=0;s<ob.length;s++){const i=ob[s]+r;if(i in t)return Tp[e]=i}return e}const ab="http://www.w3.org/1999/xlink";function bM(t,e,n,r,s){if(r&&e.startsWith("xlink:"))n==null?t.removeAttributeNS(ab,e.slice(6,e.length)):t.setAttributeNS(ab,e,n);else{const i=_x(e);n==null||i&&!cS(n)?t.removeAttribute(e):t.setAttribute(e,i?"":n)}}function IM(t,e,n,r,s,i,o){if(e==="innerHTML"||e==="textContent"){r&&o(r,s,i),t[e]=n==null?"":n;return}if(e==="value"&&t.tagName!=="PROGRESS"&&!t.tagName.includes("-")){t._value=n;const c=n==null?"":n;(t.value!==c||t.tagName==="OPTION")&&(t.value=c),n==null&&t.removeAttribute(e);return}let a=!1;if(n===""||n==null){const c=typeof t[e];c==="boolean"?n=cS(n):n==null&&c==="string"?(n="",a=!0):c==="number"&&(n=0,a=!0)}try{t[e]=n}catch{}a&&t.removeAttribute(e)}const[l0,EM]=(()=>{let t=Date.now,e=!1;if(typeof window!="undefined"){Date.now()>document.createEvent("Event").timeStamp&&(t=performance.now.bind(performance));const n=navigator.userAgent.match(/firefox\/(\d+)/i);e=!!(n&&Number(n[1])<=53)}return[t,e]})();let qg=0;const TM=Promise.resolve(),SM=()=>{qg=0},CM=()=>qg||(TM.then(SM),qg=l0());function As(t,e,n,r){t.addEventListener(e,n,r)}function AM(t,e,n,r){t.removeEventListener(e,n,r)}function kM(t,e,n,r,s=null){const i=t._vei||(t._vei={}),o=i[e];if(r&&o)o.value=r;else{const[a,c]=RM(e);if(r){const l=i[e]=NM(r,s);As(t,a,l,c)}else o&&(AM(t,a,o,c),i[e]=void 0)}}const cb=/(?:Once|Passive|Capture)$/;function RM(t){let e;if(cb.test(t)){e={};let n;for(;n=t.match(cb);)t=t.slice(0,t.length-n[0].length),e[n[0].toLowerCase()]=!0}return[wo(t.slice(2)),e]}function NM(t,e){const n=r=>{const s=r.timeStamp||l0();(EM||s>=n.attached-1)&&Wn(PM(r,n.value),e,5,[r])};return n.value=t,n.attached=CM(),n}function PM(t,e){if(ee(e)){const n=t.stopImmediatePropagation;return t.stopImmediatePropagation=()=>{n.call(t),t._stopped=!0},e.map(r=>s=>!s._stopped&&r&&r(s))}else return e}const lb=/^on[a-z]/,DM=(t,e,n,r,s=!1,i,o,a,c)=>{e==="class"?yM(t,r,s):e==="style"?vM(t,n,r):Ld(e)?l_(e)||kM(t,e,n,r,o):(e[0]==="."?(e=e.slice(1),!0):e[0]==="^"?(e=e.slice(1),!1):xM(t,e,r,s))?IM(t,e,r,i,o,a,c):(e==="true-value"?t._trueValue=r:e==="false-value"&&(t._falseValue=r),bM(t,e,r,s))};function xM(t,e,n,r){return r?!!(e==="innerHTML"||e==="textContent"||e in t&&lb.test(e)&&le(n)):e==="spellcheck"||e==="draggable"||e==="translate"||e==="form"||e==="list"&&t.tagName==="INPUT"||e==="type"&&t.tagName==="TEXTAREA"||lb.test(e)&&Nt(n)?!1:e in t}const _s="transition",lc="animation",k_=(t,{slots:e})=>A_(qS,OM(t),e);k_.displayName="Transition";const u0={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String};k_.props=Ht({},qS.props,u0);const mi=(t,e=[])=>{ee(t)?t.forEach(n=>n(...e)):t&&t(...e)},ub=t=>t?ee(t)?t.some(e=>e.length>1):t.length>1:!1;function OM(t){const e={};for(const H in t)H in u0||(e[H]=t[H]);if(t.css===!1)return e;const{name:n="v",type:r,duration:s,enterFromClass:i=`${n}-enter-from`,enterActiveClass:o=`${n}-enter-active`,enterToClass:a=`${n}-enter-to`,appearFromClass:c=i,appearActiveClass:l=o,appearToClass:u=a,leaveFromClass:h=`${n}-leave-from`,leaveActiveClass:d=`${n}-leave-active`,leaveToClass:f=`${n}-leave-to`}=t,p=MM(s),_=p&&p[0],y=p&&p[1],{onBeforeEnter:I,onEnter:N,onEnterCancelled:k,onLeave:M,onLeaveCancelled:j,onBeforeAppear:Y=I,onAppear:z=N,onAppearCancelled:V=k}=e,ie=(H,ke,Je)=>{_i(H,ke?u:a),_i(H,ke?l:o),Je&&Je()},_e=(H,ke)=>{H._isLeaving=!1,_i(H,h),_i(H,f),_i(H,d),ke&&ke()},Fe=H=>(ke,Je)=>{const Xe=H?z:N,Ze=()=>ie(ke,H,Je);mi(Xe,[ke,Ze]),hb(()=>{_i(ke,H?c:i),ys(ke,H?u:a),ub(Xe)||db(ke,r,_,Ze)})};return Ht(e,{onBeforeEnter(H){mi(I,[H]),ys(H,i),ys(H,o)},onBeforeAppear(H){mi(Y,[H]),ys(H,c),ys(H,l)},onEnter:Fe(!1),onAppear:Fe(!0),onLeave(H,ke){H._isLeaving=!0;const Je=()=>_e(H,ke);ys(H,h),UM(),ys(H,d),hb(()=>{!H._isLeaving||(_i(H,h),ys(H,f),ub(M)||db(H,r,y,Je))}),mi(M,[H,Je])},onEnterCancelled(H){ie(H,!1),mi(k,[H])},onAppearCancelled(H){ie(H,!0),mi(V,[H])},onLeaveCancelled(H){_e(H),mi(j,[H])}})}function MM(t){if(t==null)return null;if(tt(t))return[Sp(t.enter),Sp(t.leave)];{const e=Sp(t);return[e,e]}}function Sp(t){return il(t)}function ys(t,e){e.split(/\s+/).forEach(n=>n&&t.classList.add(n)),(t._vtc||(t._vtc=new Set)).add(e)}function _i(t,e){e.split(/\s+/).forEach(r=>r&&t.classList.remove(r));const{_vtc:n}=t;n&&(n.delete(e),n.size||(t._vtc=void 0))}function hb(t){requestAnimationFrame(()=>{requestAnimationFrame(t)})}let LM=0;function db(t,e,n,r){const s=t._endId=++LM,i=()=>{s===t._endId&&r()};if(n)return setTimeout(i,n);const{type:o,timeout:a,propCount:c}=FM(t,e);if(!o)return r();const l=o+"end";let u=0;const h=()=>{t.removeEventListener(l,d),i()},d=f=>{f.target===t&&++u>=c&&h()};setTimeout(()=>{u<c&&h()},a+1),t.addEventListener(l,d)}function FM(t,e){const n=window.getComputedStyle(t),r=p=>(n[p]||"").split(", "),s=r(_s+"Delay"),i=r(_s+"Duration"),o=fb(s,i),a=r(lc+"Delay"),c=r(lc+"Duration"),l=fb(a,c);let u=null,h=0,d=0;e===_s?o>0&&(u=_s,h=o,d=i.length):e===lc?l>0&&(u=lc,h=l,d=c.length):(h=Math.max(o,l),u=h>0?o>l?_s:lc:null,d=u?u===_s?i.length:c.length:0);const f=u===_s&&/\b(transform|all)(,|$)/.test(n[_s+"Property"]);return{type:u,timeout:h,propCount:d,hasTransform:f}}function fb(t,e){for(;t.length<e.length;)t=t.concat(t);return Math.max(...e.map((n,r)=>pb(n)+pb(t[r])))}function pb(t){return Number(t.slice(0,-1).replace(",","."))*1e3}function UM(){return document.body.offsetHeight}const ga=t=>{const e=t.props["onUpdate:modelValue"]||!1;return ee(e)?n=>gh(e,n):e};function $M(t){t.target.composing=!0}function gb(t){const e=t.target;e.composing&&(e.composing=!1,e.dispatchEvent(new Event("input")))}const S9={created(t,{modifiers:{lazy:e,trim:n,number:r}},s){t._assign=ga(s);const i=r||s.props&&s.props.type==="number";As(t,e?"change":"input",o=>{if(o.target.composing)return;let a=t.value;n&&(a=a.trim()),i&&(a=il(a)),t._assign(a)}),n&&As(t,"change",()=>{t.value=t.value.trim()}),e||(As(t,"compositionstart",$M),As(t,"compositionend",gb),As(t,"change",gb))},mounted(t,{value:e}){t.value=e==null?"":e},beforeUpdate(t,{value:e,modifiers:{lazy:n,trim:r,number:s}},i){if(t._assign=ga(i),t.composing||document.activeElement===t&&t.type!=="range"&&(n||r&&t.value.trim()===e||(s||t.type==="number")&&il(t.value)===e))return;const o=e==null?"":e;t.value!==o&&(t.value=o)}},C9={created(t,{value:e},n){t.checked=da(e,n.props.value),t._assign=ga(n),As(t,"change",()=>{t._assign(dl(t))})},beforeUpdate(t,{value:e,oldValue:n},r){t._assign=ga(r),e!==n&&(t.checked=da(e,r.props.value))}},A9={deep:!0,created(t,{value:e,modifiers:{number:n}},r){const s=Fd(e);As(t,"change",()=>{const i=Array.prototype.filter.call(t.options,o=>o.selected).map(o=>n?il(dl(o)):dl(o));t._assign(t.multiple?s?new Set(i):i:i[0])}),t._assign=ga(r)},mounted(t,{value:e}){mb(t,e)},beforeUpdate(t,e,n){t._assign=ga(n)},updated(t,{value:e}){mb(t,e)}};function mb(t,e){const n=t.multiple;if(!(n&&!ee(e)&&!Fd(e))){for(let r=0,s=t.options.length;r<s;r++){const i=t.options[r],o=dl(i);if(n)ee(e)?i.selected=Ix(e,o)>-1:i.selected=e.has(o);else if(da(dl(i),e)){t.selectedIndex!==r&&(t.selectedIndex=r);return}}!n&&t.selectedIndex!==-1&&(t.selectedIndex=-1)}}function dl(t){return"_value"in t?t._value:t.value}const VM={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},k9=(t,e)=>n=>{if(!("key"in n))return;const r=wo(n.key);if(e.some(s=>s===r||VM[s]===r))return t(n)},BM=Ht({patchProp:DM},_M);let _b;function qM(){return _b||(_b=JO(BM))}const jM=(...t)=>{const e=qM().createApp(...t),{mount:n}=e;return e.mount=r=>{const s=KM(r);if(!s)return;const i=e._component;!le(i)&&!i.render&&!i.template&&(i.template=s.innerHTML),s.innerHTML="";const o=n(s,!1,s instanceof SVGElement);return s instanceof Element&&(s.removeAttribute("v-cloak"),s.setAttribute("data-v-app","")),o},e};function KM(t){return Nt(t)?document.querySelector(t):t}const WM="modulepreload",yb={},HM="/Educatia/",gr=function(e,n){return!n||n.length===0?e():Promise.all(n.map(r=>{if(r=`${HM}${r}`,r in yb)return;yb[r]=!0;const s=r.endsWith(".css"),i=s?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${r}"]${i}`))return;const o=document.createElement("link");if(o.rel=s?"stylesheet":WM,s||(o.as="script",o.crossOrigin=""),o.href=r,document.head.appendChild(o),s)return new Promise((a,c)=>{o.addEventListener("load",a),o.addEventListener("error",()=>c(new Error(`Unable to preload CSS for ${r}`)))})})).then(()=>e())};/*!
  * vue-router v4.0.13
  * (c) 2022 Eduardo San Martin Morote
  * @license MIT
  */const h0=typeof Symbol=="function"&&typeof Symbol.toStringTag=="symbol",Va=t=>h0?Symbol(t):"_vr_"+t,GM=Va("rvlm"),vb=Va("rvd"),Qd=Va("r"),d0=Va("rl"),jg=Va("rvl"),Wo=typeof window!="undefined";function zM(t){return t.__esModule||h0&&t[Symbol.toStringTag]==="Module"}const xe=Object.assign;function Cp(t,e){const n={};for(const r in e){const s=e[r];n[r]=Array.isArray(s)?s.map(t):t(s)}return n}const Uc=()=>{},QM=/\/$/,YM=t=>t.replace(QM,"");function Ap(t,e,n="/"){let r,s={},i="",o="";const a=e.indexOf("?"),c=e.indexOf("#",a>-1?a:0);return a>-1&&(r=e.slice(0,a),i=e.slice(a+1,c>-1?c:e.length),s=t(i)),c>-1&&(r=r||e.slice(0,c),o=e.slice(c,e.length)),r=e1(r!=null?r:e,n),{fullPath:r+(i&&"?")+i+o,path:r,query:s,hash:o}}function JM(t,e){const n=e.query?t(e.query):"";return e.path+(n&&"?")+n+(e.hash||"")}function wb(t,e){return!e||!t.toLowerCase().startsWith(e.toLowerCase())?t:t.slice(e.length)||"/"}function XM(t,e,n){const r=e.matched.length-1,s=n.matched.length-1;return r>-1&&r===s&&ma(e.matched[r],n.matched[s])&&f0(e.params,n.params)&&t(e.query)===t(n.query)&&e.hash===n.hash}function ma(t,e){return(t.aliasOf||t)===(e.aliasOf||e)}function f0(t,e){if(Object.keys(t).length!==Object.keys(e).length)return!1;for(const n in t)if(!ZM(t[n],e[n]))return!1;return!0}function ZM(t,e){return Array.isArray(t)?bb(t,e):Array.isArray(e)?bb(e,t):t===e}function bb(t,e){return Array.isArray(e)?t.length===e.length&&t.every((n,r)=>n===e[r]):t.length===1&&t[0]===e}function e1(t,e){if(t.startsWith("/"))return t;if(!t)return e;const n=e.split("/"),r=t.split("/");let s=n.length-1,i,o;for(i=0;i<r.length;i++)if(o=r[i],!(s===1||o==="."))if(o==="..")s--;else break;return n.slice(0,s).join("/")+"/"+r.slice(i-(i===r.length?1:0)).join("/")}var fl;(function(t){t.pop="pop",t.push="push"})(fl||(fl={}));var $c;(function(t){t.back="back",t.forward="forward",t.unknown=""})($c||($c={}));function t1(t){if(!t)if(Wo){const e=document.querySelector("base");t=e&&e.getAttribute("href")||"/",t=t.replace(/^\w+:\/\/[^\/]+/,"")}else t="/";return t[0]!=="/"&&t[0]!=="#"&&(t="/"+t),YM(t)}const n1=/^[^#]+#/;function r1(t,e){return t.replace(n1,"#")+e}function s1(t,e){const n=document.documentElement.getBoundingClientRect(),r=t.getBoundingClientRect();return{behavior:e.behavior,left:r.left-n.left-(e.left||0),top:r.top-n.top-(e.top||0)}}const Yd=()=>({left:window.pageXOffset,top:window.pageYOffset});function i1(t){let e;if("el"in t){const n=t.el,r=typeof n=="string"&&n.startsWith("#"),s=typeof n=="string"?r?document.getElementById(n.slice(1)):document.querySelector(n):n;if(!s)return;e=s1(s,t)}else e=t;"scrollBehavior"in document.documentElement.style?window.scrollTo(e):window.scrollTo(e.left!=null?e.left:window.pageXOffset,e.top!=null?e.top:window.pageYOffset)}function Ib(t,e){return(history.state?history.state.position-e:-1)+t}const Kg=new Map;function o1(t,e){Kg.set(t,e)}function a1(t){const e=Kg.get(t);return Kg.delete(t),e}let c1=()=>location.protocol+"//"+location.host;function p0(t,e){const{pathname:n,search:r,hash:s}=e,i=t.indexOf("#");if(i>-1){let a=s.includes(t.slice(i))?t.slice(i).length:1,c=s.slice(a);return c[0]!=="/"&&(c="/"+c),wb(c,"")}return wb(n,t)+r+s}function l1(t,e,n,r){let s=[],i=[],o=null;const a=({state:d})=>{const f=p0(t,location),p=n.value,_=e.value;let y=0;if(d){if(n.value=f,e.value=d,o&&o===p){o=null;return}y=_?d.position-_.position:0}else r(f);s.forEach(I=>{I(n.value,p,{delta:y,type:fl.pop,direction:y?y>0?$c.forward:$c.back:$c.unknown})})};function c(){o=n.value}function l(d){s.push(d);const f=()=>{const p=s.indexOf(d);p>-1&&s.splice(p,1)};return i.push(f),f}function u(){const{history:d}=window;!d.state||d.replaceState(xe({},d.state,{scroll:Yd()}),"")}function h(){for(const d of i)d();i=[],window.removeEventListener("popstate",a),window.removeEventListener("beforeunload",u)}return window.addEventListener("popstate",a),window.addEventListener("beforeunload",u),{pauseListeners:c,listen:l,destroy:h}}function Eb(t,e,n,r=!1,s=!1){return{back:t,current:e,forward:n,replaced:r,position:window.history.length,scroll:s?Yd():null}}function u1(t){const{history:e,location:n}=window,r={value:p0(t,n)},s={value:e.state};s.value||i(r.value,{back:null,current:r.value,forward:null,position:e.length-1,replaced:!0,scroll:null},!0);function i(c,l,u){const h=t.indexOf("#"),d=h>-1?(n.host&&document.querySelector("base")?t:t.slice(h))+c:c1()+t+c;try{e[u?"replaceState":"pushState"](l,"",d),s.value=l}catch(f){console.error(f),n[u?"replace":"assign"](d)}}function o(c,l){const u=xe({},e.state,Eb(s.value.back,c,s.value.forward,!0),l,{position:s.value.position});i(c,u,!0),r.value=c}function a(c,l){const u=xe({},s.value,e.state,{forward:c,scroll:Yd()});i(u.current,u,!0);const h=xe({},Eb(r.value,c,null),{position:u.position+1},l);i(c,h,!1),r.value=c}return{location:r,state:s,push:a,replace:o}}function h1(t){t=t1(t);const e=u1(t),n=l1(t,e.state,e.location,e.replace);function r(i,o=!0){o||n.pauseListeners(),history.go(i)}const s=xe({location:"",base:t,go:r,createHref:r1.bind(null,t)},e,n);return Object.defineProperty(s,"location",{enumerable:!0,get:()=>e.location.value}),Object.defineProperty(s,"state",{enumerable:!0,get:()=>e.state.value}),s}function d1(t){return t=location.host?t||location.pathname+location.search:"",t.includes("#")||(t+="#"),h1(t)}function f1(t){return typeof t=="string"||t&&typeof t=="object"}function g0(t){return typeof t=="string"||typeof t=="symbol"}const vs={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0},m0=Va("nf");var Tb;(function(t){t[t.aborted=4]="aborted",t[t.cancelled=8]="cancelled",t[t.duplicated=16]="duplicated"})(Tb||(Tb={}));function _a(t,e){return xe(new Error,{type:t,[m0]:!0},e)}function ws(t,e){return t instanceof Error&&m0 in t&&(e==null||!!(t.type&e))}const Sb="[^/]+?",p1={sensitive:!1,strict:!1,start:!0,end:!0},g1=/[.+*?^${}()[\]/\\]/g;function m1(t,e){const n=xe({},p1,e),r=[];let s=n.start?"^":"";const i=[];for(const l of t){const u=l.length?[]:[90];n.strict&&!l.length&&(s+="/");for(let h=0;h<l.length;h++){const d=l[h];let f=40+(n.sensitive?.25:0);if(d.type===0)h||(s+="/"),s+=d.value.replace(g1,"\\$&"),f+=40;else if(d.type===1){const{value:p,repeatable:_,optional:y,regexp:I}=d;i.push({name:p,repeatable:_,optional:y});const N=I||Sb;if(N!==Sb){f+=10;try{new RegExp(`(${N})`)}catch(M){throw new Error(`Invalid custom RegExp for param "${p}" (${N}): `+M.message)}}let k=_?`((?:${N})(?:/(?:${N}))*)`:`(${N})`;h||(k=y&&l.length<2?`(?:/${k})`:"/"+k),y&&(k+="?"),s+=k,f+=20,y&&(f+=-8),_&&(f+=-20),N===".*"&&(f+=-50)}u.push(f)}r.push(u)}if(n.strict&&n.end){const l=r.length-1;r[l][r[l].length-1]+=.7000000000000001}n.strict||(s+="/?"),n.end?s+="$":n.strict&&(s+="(?:/|$)");const o=new RegExp(s,n.sensitive?"":"i");function a(l){const u=l.match(o),h={};if(!u)return null;for(let d=1;d<u.length;d++){const f=u[d]||"",p=i[d-1];h[p.name]=f&&p.repeatable?f.split("/"):f}return h}function c(l){let u="",h=!1;for(const d of t){(!h||!u.endsWith("/"))&&(u+="/"),h=!1;for(const f of d)if(f.type===0)u+=f.value;else if(f.type===1){const{value:p,repeatable:_,optional:y}=f,I=p in l?l[p]:"";if(Array.isArray(I)&&!_)throw new Error(`Provided param "${p}" is an array but it is not repeatable (* or + modifiers)`);const N=Array.isArray(I)?I.join("/"):I;if(!N)if(y)d.length<2&&(u.endsWith("/")?u=u.slice(0,-1):h=!0);else throw new Error(`Missing required param "${p}"`);u+=N}}return u}return{re:o,score:r,keys:i,parse:a,stringify:c}}function _1(t,e){let n=0;for(;n<t.length&&n<e.length;){const r=e[n]-t[n];if(r)return r;n++}return t.length<e.length?t.length===1&&t[0]===40+40?-1:1:t.length>e.length?e.length===1&&e[0]===40+40?1:-1:0}function y1(t,e){let n=0;const r=t.score,s=e.score;for(;n<r.length&&n<s.length;){const i=_1(r[n],s[n]);if(i)return i;n++}return s.length-r.length}const v1={type:0,value:""},w1=/[a-zA-Z0-9_]/;function b1(t){if(!t)return[[]];if(t==="/")return[[v1]];if(!t.startsWith("/"))throw new Error(`Invalid path "${t}"`);function e(f){throw new Error(`ERR (${n})/"${l}": ${f}`)}let n=0,r=n;const s=[];let i;function o(){i&&s.push(i),i=[]}let a=0,c,l="",u="";function h(){!l||(n===0?i.push({type:0,value:l}):n===1||n===2||n===3?(i.length>1&&(c==="*"||c==="+")&&e(`A repeatable param (${l}) must be alone in its segment. eg: '/:ids+.`),i.push({type:1,value:l,regexp:u,repeatable:c==="*"||c==="+",optional:c==="*"||c==="?"})):e("Invalid state to consume buffer"),l="")}function d(){l+=c}for(;a<t.length;){if(c=t[a++],c==="\\"&&n!==2){r=n,n=4;continue}switch(n){case 0:c==="/"?(l&&h(),o()):c===":"?(h(),n=1):d();break;case 4:d(),n=r;break;case 1:c==="("?n=2:w1.test(c)?d():(h(),n=0,c!=="*"&&c!=="?"&&c!=="+"&&a--);break;case 2:c===")"?u[u.length-1]=="\\"?u=u.slice(0,-1)+c:n=3:u+=c;break;case 3:h(),n=0,c!=="*"&&c!=="?"&&c!=="+"&&a--,u="";break;default:e("Unknown state");break}}return n===2&&e(`Unfinished custom RegExp for param "${l}"`),h(),o(),s}function I1(t,e,n){const r=m1(b1(t.path),n),s=xe(r,{record:t,parent:e,children:[],alias:[]});return e&&!s.record.aliasOf==!e.record.aliasOf&&e.children.push(s),s}function E1(t,e){const n=[],r=new Map;e=Ab({strict:!1,end:!0,sensitive:!1},e);function s(u){return r.get(u)}function i(u,h,d){const f=!d,p=S1(u);p.aliasOf=d&&d.record;const _=Ab(e,u),y=[p];if("alias"in u){const k=typeof u.alias=="string"?[u.alias]:u.alias;for(const M of k)y.push(xe({},p,{components:d?d.record.components:p.components,path:M,aliasOf:d?d.record:p}))}let I,N;for(const k of y){const{path:M}=k;if(h&&M[0]!=="/"){const j=h.record.path,Y=j[j.length-1]==="/"?"":"/";k.path=h.record.path+(M&&Y+M)}if(I=I1(k,h,_),d?d.alias.push(I):(N=N||I,N!==I&&N.alias.push(I),f&&u.name&&!Cb(I)&&o(u.name)),"children"in p){const j=p.children;for(let Y=0;Y<j.length;Y++)i(j[Y],I,d&&d.children[Y])}d=d||I,c(I)}return N?()=>{o(N)}:Uc}function o(u){if(g0(u)){const h=r.get(u);h&&(r.delete(u),n.splice(n.indexOf(h),1),h.children.forEach(o),h.alias.forEach(o))}else{const h=n.indexOf(u);h>-1&&(n.splice(h,1),u.record.name&&r.delete(u.record.name),u.children.forEach(o),u.alias.forEach(o))}}function a(){return n}function c(u){let h=0;for(;h<n.length&&y1(u,n[h])>=0&&(u.record.path!==n[h].record.path||!_0(u,n[h]));)h++;n.splice(h,0,u),u.record.name&&!Cb(u)&&r.set(u.record.name,u)}function l(u,h){let d,f={},p,_;if("name"in u&&u.name){if(d=r.get(u.name),!d)throw _a(1,{location:u});_=d.record.name,f=xe(T1(h.params,d.keys.filter(N=>!N.optional).map(N=>N.name)),u.params),p=d.stringify(f)}else if("path"in u)p=u.path,d=n.find(N=>N.re.test(p)),d&&(f=d.parse(p),_=d.record.name);else{if(d=h.name?r.get(h.name):n.find(N=>N.re.test(h.path)),!d)throw _a(1,{location:u,currentLocation:h});_=d.record.name,f=xe({},h.params,u.params),p=d.stringify(f)}const y=[];let I=d;for(;I;)y.unshift(I.record),I=I.parent;return{name:_,path:p,params:f,matched:y,meta:A1(y)}}return t.forEach(u=>i(u)),{addRoute:i,resolve:l,removeRoute:o,getRoutes:a,getRecordMatcher:s}}function T1(t,e){const n={};for(const r of e)r in t&&(n[r]=t[r]);return n}function S1(t){return{path:t.path,redirect:t.redirect,name:t.name,meta:t.meta||{},aliasOf:void 0,beforeEnter:t.beforeEnter,props:C1(t),children:t.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in t?t.components||{}:{default:t.component}}}function C1(t){const e={},n=t.props||!1;if("component"in t)e.default=n;else for(const r in t.components)e[r]=typeof n=="boolean"?n:n[r];return e}function Cb(t){for(;t;){if(t.record.aliasOf)return!0;t=t.parent}return!1}function A1(t){return t.reduce((e,n)=>xe(e,n.meta),{})}function Ab(t,e){const n={};for(const r in t)n[r]=r in e?e[r]:t[r];return n}function _0(t,e){return e.children.some(n=>n===t||_0(t,n))}const y0=/#/g,k1=/&/g,R1=/\//g,N1=/=/g,P1=/\?/g,v0=/\+/g,D1=/%5B/g,x1=/%5D/g,w0=/%5E/g,O1=/%60/g,b0=/%7B/g,M1=/%7C/g,I0=/%7D/g,L1=/%20/g;function R_(t){return encodeURI(""+t).replace(M1,"|").replace(D1,"[").replace(x1,"]")}function F1(t){return R_(t).replace(b0,"{").replace(I0,"}").replace(w0,"^")}function Wg(t){return R_(t).replace(v0,"%2B").replace(L1,"+").replace(y0,"%23").replace(k1,"%26").replace(O1,"`").replace(b0,"{").replace(I0,"}").replace(w0,"^")}function U1(t){return Wg(t).replace(N1,"%3D")}function $1(t){return R_(t).replace(y0,"%23").replace(P1,"%3F")}function V1(t){return t==null?"":$1(t).replace(R1,"%2F")}function Lh(t){try{return decodeURIComponent(""+t)}catch{}return""+t}function B1(t){const e={};if(t===""||t==="?")return e;const r=(t[0]==="?"?t.slice(1):t).split("&");for(let s=0;s<r.length;++s){const i=r[s].replace(v0," "),o=i.indexOf("="),a=Lh(o<0?i:i.slice(0,o)),c=o<0?null:Lh(i.slice(o+1));if(a in e){let l=e[a];Array.isArray(l)||(l=e[a]=[l]),l.push(c)}else e[a]=c}return e}function kb(t){let e="";for(let n in t){const r=t[n];if(n=U1(n),r==null){r!==void 0&&(e+=(e.length?"&":"")+n);continue}(Array.isArray(r)?r.map(i=>i&&Wg(i)):[r&&Wg(r)]).forEach(i=>{i!==void 0&&(e+=(e.length?"&":"")+n,i!=null&&(e+="="+i))})}return e}function q1(t){const e={};for(const n in t){const r=t[n];r!==void 0&&(e[n]=Array.isArray(r)?r.map(s=>s==null?null:""+s):r==null?r:""+r)}return e}function uc(){let t=[];function e(r){return t.push(r),()=>{const s=t.indexOf(r);s>-1&&t.splice(s,1)}}function n(){t=[]}return{add:e,list:()=>t,reset:n}}function Cs(t,e,n,r,s){const i=r&&(r.enterCallbacks[s]=r.enterCallbacks[s]||[]);return()=>new Promise((o,a)=>{const c=h=>{h===!1?a(_a(4,{from:n,to:e})):h instanceof Error?a(h):f1(h)?a(_a(2,{from:e,to:h})):(i&&r.enterCallbacks[s]===i&&typeof h=="function"&&i.push(h),o())},l=t.call(r&&r.instances[s],e,n,c);let u=Promise.resolve(l);t.length<3&&(u=u.then(c)),u.catch(h=>a(h))})}function kp(t,e,n,r){const s=[];for(const i of t)for(const o in i.components){let a=i.components[o];if(!(e!=="beforeRouteEnter"&&!i.instances[o]))if(j1(a)){const l=(a.__vccOpts||a)[e];l&&s.push(Cs(l,n,r,i,o))}else{let c=a();s.push(()=>c.then(l=>{if(!l)return Promise.reject(new Error(`Couldn't resolve component "${o}" at "${i.path}"`));const u=zM(l)?l.default:l;i.components[o]=u;const d=(u.__vccOpts||u)[e];return d&&Cs(d,n,r,i,o)()}))}}return s}function j1(t){return typeof t=="object"||"displayName"in t||"props"in t||"__vccOpts"in t}function Rb(t){const e=Cr(Qd),n=Cr(d0),r=tr(()=>e.resolve(xc(t.to))),s=tr(()=>{const{matched:c}=r.value,{length:l}=c,u=c[l-1],h=n.matched;if(!u||!h.length)return-1;const d=h.findIndex(ma.bind(null,u));if(d>-1)return d;const f=Nb(c[l-2]);return l>1&&Nb(u)===f&&h[h.length-1].path!==f?h.findIndex(ma.bind(null,c[l-2])):d}),i=tr(()=>s.value>-1&&G1(n.params,r.value.params)),o=tr(()=>s.value>-1&&s.value===n.matched.length-1&&f0(n.params,r.value.params));function a(c={}){return H1(c)?e[xc(t.replace)?"replace":"push"](xc(t.to)).catch(Uc):Promise.resolve()}return{route:r,href:tr(()=>r.value.href),isActive:i,isExactActive:o,navigate:a}}const K1=WS({name:"RouterLink",props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"}},useLink:Rb,setup(t,{slots:e}){const n=$a(Rb(t)),{options:r}=Cr(Qd),s=tr(()=>({[Pb(t.activeClass,r.linkActiveClass,"router-link-active")]:n.isActive,[Pb(t.exactActiveClass,r.linkExactActiveClass,"router-link-exact-active")]:n.isExactActive}));return()=>{const i=e.default&&e.default(n);return t.custom?i:A_("a",{"aria-current":n.isExactActive?t.ariaCurrentValue:null,href:n.href,onClick:n.navigate,class:s.value},i)}}}),W1=K1;function H1(t){if(!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)&&!t.defaultPrevented&&!(t.button!==void 0&&t.button!==0)){if(t.currentTarget&&t.currentTarget.getAttribute){const e=t.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(e))return}return t.preventDefault&&t.preventDefault(),!0}}function G1(t,e){for(const n in e){const r=e[n],s=t[n];if(typeof r=="string"){if(r!==s)return!1}else if(!Array.isArray(s)||s.length!==r.length||r.some((i,o)=>i!==s[o]))return!1}return!0}function Nb(t){return t?t.aliasOf?t.aliasOf.path:t.path:""}const Pb=(t,e,n)=>t!=null?t:e!=null?e:n,z1=WS({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},setup(t,{attrs:e,slots:n}){const r=Cr(jg),s=tr(()=>t.route||r.value),i=Cr(vb,0),o=tr(()=>s.value.matched[i]);mh(vb,i+1),mh(GM,o),mh(jg,s);const a=v_();return Lc(()=>[a.value,o.value,t.name],([c,l,u],[h,d,f])=>{l&&(l.instances[u]=c,d&&d!==l&&c&&c===h&&(l.leaveGuards.size||(l.leaveGuards=d.leaveGuards),l.updateGuards.size||(l.updateGuards=d.updateGuards))),c&&l&&(!d||!ma(l,d)||!h)&&(l.enterCallbacks[u]||[]).forEach(p=>p(c))},{flush:"post"}),()=>{const c=s.value,l=o.value,u=l&&l.components[t.name],h=t.name;if(!u)return Db(n.default,{Component:u,route:c});const d=l.props[t.name],f=d?d===!0?c.params:typeof d=="function"?d(c):d:null,_=A_(u,xe({},f,e,{onVnodeUnmounted:y=>{y.component.isUnmounted&&(l.instances[h]=null)},ref:a}));return Db(n.default,{Component:_,route:c})||_}}});function Db(t,e){if(!t)return null;const n=t(e);return n.length===1?n[0]:n}const Q1=z1;function Y1(t){const e=E1(t.routes,t),n=t.parseQuery||B1,r=t.stringifyQuery||kb,s=t.history,i=uc(),o=uc(),a=uc(),c=rO(vs);let l=vs;Wo&&t.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const u=Cp.bind(null,E=>""+E),h=Cp.bind(null,V1),d=Cp.bind(null,Lh);function f(E,Q){let $,J;return g0(E)?($=e.getRecordMatcher(E),J=Q):J=E,e.addRoute(J,$)}function p(E){const Q=e.getRecordMatcher(E);Q&&e.removeRoute(Q)}function _(){return e.getRoutes().map(E=>E.record)}function y(E){return!!e.getRecordMatcher(E)}function I(E,Q){if(Q=xe({},Q||c.value),typeof E=="string"){const he=Ap(n,E,Q.path),g=e.resolve({path:he.path},Q),m=s.createHref(he.fullPath);return xe(he,g,{params:d(g.params),hash:Lh(he.hash),redirectedFrom:void 0,href:m})}let $;if("path"in E)$=xe({},E,{path:Ap(n,E.path,Q.path).path});else{const he=xe({},E.params);for(const g in he)he[g]==null&&delete he[g];$=xe({},E,{params:h(E.params)}),Q.params=h(Q.params)}const J=e.resolve($,Q),Ne=E.hash||"";J.params=u(d(J.params));const $e=JM(r,xe({},E,{hash:F1(Ne),path:J.path})),me=s.createHref($e);return xe({fullPath:$e,hash:Ne,query:r===kb?q1(E.query):E.query||{}},J,{redirectedFrom:void 0,href:me})}function N(E){return typeof E=="string"?Ap(n,E,c.value.path):xe({},E)}function k(E,Q){if(l!==E)return _a(8,{from:Q,to:E})}function M(E){return z(E)}function j(E){return M(xe(N(E),{replace:!0}))}function Y(E){const Q=E.matched[E.matched.length-1];if(Q&&Q.redirect){const{redirect:$}=Q;let J=typeof $=="function"?$(E):$;return typeof J=="string"&&(J=J.includes("?")||J.includes("#")?J=N(J):{path:J},J.params={}),xe({query:E.query,hash:E.hash,params:E.params},J)}}function z(E,Q){const $=l=I(E),J=c.value,Ne=E.state,$e=E.force,me=E.replace===!0,he=Y($);if(he)return z(xe(N(he),{state:Ne,force:$e,replace:me}),Q||$);const g=$;g.redirectedFrom=Q;let m;return!$e&&XM(r,J,$)&&(m=_a(16,{to:g,from:J}),xo(J,J,!0,!1)),(m?Promise.resolve(m):ie(g,J)).catch(b=>ws(b)?ws(b,2)?b:Tn(b):Ue(b,g,J)).then(b=>{if(b){if(ws(b,2))return z(xe(N(b.to),{state:Ne,force:$e,replace:me}),Q||g)}else b=Fe(g,J,!0,me,Ne);return _e(g,J,b),b})}function V(E,Q){const $=k(E,Q);return $?Promise.reject($):Promise.resolve()}function ie(E,Q){let $;const[J,Ne,$e]=J1(E,Q);$=kp(J.reverse(),"beforeRouteLeave",E,Q);for(const he of J)he.leaveGuards.forEach(g=>{$.push(Cs(g,E,Q))});const me=V.bind(null,E,Q);return $.push(me),Mo($).then(()=>{$=[];for(const he of i.list())$.push(Cs(he,E,Q));return $.push(me),Mo($)}).then(()=>{$=kp(Ne,"beforeRouteUpdate",E,Q);for(const he of Ne)he.updateGuards.forEach(g=>{$.push(Cs(g,E,Q))});return $.push(me),Mo($)}).then(()=>{$=[];for(const he of E.matched)if(he.beforeEnter&&!Q.matched.includes(he))if(Array.isArray(he.beforeEnter))for(const g of he.beforeEnter)$.push(Cs(g,E,Q));else $.push(Cs(he.beforeEnter,E,Q));return $.push(me),Mo($)}).then(()=>(E.matched.forEach(he=>he.enterCallbacks={}),$=kp($e,"beforeRouteEnter",E,Q),$.push(me),Mo($))).then(()=>{$=[];for(const he of o.list())$.push(Cs(he,E,Q));return $.push(me),Mo($)}).catch(he=>ws(he,8)?he:Promise.reject(he))}function _e(E,Q,$){for(const J of a.list())J(E,Q,$)}function Fe(E,Q,$,J,Ne){const $e=k(E,Q);if($e)return $e;const me=Q===vs,he=Wo?history.state:{};$&&(J||me?s.replace(E.fullPath,xe({scroll:me&&he&&he.scroll},Ne)):s.push(E.fullPath,Ne)),c.value=E,xo(E,Q,$,me),Tn()}let H;function ke(){H=s.listen((E,Q,$)=>{const J=I(E),Ne=Y(J);if(Ne){z(xe(Ne,{replace:!0}),J).catch(Uc);return}l=J;const $e=c.value;Wo&&o1(Ib($e.fullPath,$.delta),Yd()),ie(J,$e).catch(me=>ws(me,12)?me:ws(me,2)?(z(me.to,J).then(he=>{ws(he,20)&&!$.delta&&$.type===fl.pop&&s.go(-1,!1)}).catch(Uc),Promise.reject()):($.delta&&s.go(-$.delta,!1),Ue(me,J,$e))).then(me=>{me=me||Fe(J,$e,!1),me&&($.delta?s.go(-$.delta,!1):$.type===fl.pop&&ws(me,20)&&s.go(-1,!1)),_e(J,$e,me)}).catch(Uc)})}let Je=uc(),Xe=uc(),Ze;function Ue(E,Q,$){Tn(E);const J=Xe.list();return J.length?J.forEach(Ne=>Ne(E,Q,$)):console.error(E),Promise.reject(E)}function Re(){return Ze&&c.value!==vs?Promise.resolve():new Promise((E,Q)=>{Je.add([E,Q])})}function Tn(E){return Ze||(Ze=!E,ke(),Je.list().forEach(([Q,$])=>E?$(E):Q()),Je.reset()),E}function xo(E,Q,$,J){const{scrollBehavior:Ne}=t;if(!Wo||!Ne)return Promise.resolve();const $e=!$&&a1(Ib(E.fullPath,0))||(J||!$)&&history.state&&history.state.scroll||null;return b_().then(()=>Ne(E,Q,$e)).then(me=>me&&i1(me)).catch(me=>Ue(me,E,Q))}const qr=E=>s.go(E);let dr;const Ln=new Set;return{currentRoute:c,addRoute:f,removeRoute:p,hasRoute:y,getRoutes:_,resolve:I,options:t,push:M,replace:j,go:qr,back:()=>qr(-1),forward:()=>qr(1),beforeEach:i.add,beforeResolve:o.add,afterEach:a.add,onError:Xe.add,isReady:Re,install(E){const Q=this;E.component("RouterLink",W1),E.component("RouterView",Q1),E.config.globalProperties.$router=Q,Object.defineProperty(E.config.globalProperties,"$route",{enumerable:!0,get:()=>xc(c)}),Wo&&!dr&&c.value===vs&&(dr=!0,M(s.location).catch(Ne=>{}));const $={};for(const Ne in vs)$[Ne]=tr(()=>c.value[Ne]);E.provide(Qd,Q),E.provide(d0,$a($)),E.provide(jg,c);const J=E.unmount;Ln.add(E),E.unmount=function(){Ln.delete(E),Ln.size<1&&(l=vs,H&&H(),c.value=vs,dr=!1,Ze=!1),J()}}}}function Mo(t){return t.reduce((e,n)=>e.then(()=>n()),Promise.resolve())}function J1(t,e){const n=[],r=[],s=[],i=Math.max(e.matched.length,t.matched.length);for(let o=0;o<i;o++){const a=e.matched[o];a&&(t.matched.find(l=>ma(l,a))?r.push(a):n.push(a));const c=t.matched[o];c&&(e.matched.find(l=>ma(l,c))||s.push(c))}return[n,r,s]}function R9(){return Cr(Qd)}const X1=[{name:"Home",component:()=>gr(()=>import("./Home.c82bb50d.js"),["assets/Home.c82bb50d.js","assets/Home.23f9ecd1.css","assets/loader.c5738979.js","assets/loader.3b2bd4b3.css"]),path:"/"},{name:"Add",component:()=>gr(()=>import("./Add.3621f918.js"),["assets/Add.3621f918.js","assets/Add.734cd8a9.css","assets/level.19f89a9b.js","assets/types.7d33b1ee.js","assets/loader.c5738979.js","assets/loader.3b2bd4b3.css"]),path:"/add"},{name:"Admin",component:()=>gr(()=>import("./admin.3cb66fe1.js"),["assets/admin.3cb66fe1.js","assets/admin.1da9aa51.css","assets/loader.c5738979.js","assets/loader.3b2bd4b3.css"]),path:"/admin"},{name:"Univercities",component:()=>gr(()=>import("./Uni.b6cffe33.js"),["assets/Uni.b6cffe33.js","assets/Uni.0ea995fa.css","assets/loader.c5738979.js","assets/loader.3b2bd4b3.css"]),path:"/Univercities"},{name:"loader",component:()=>gr(()=>import("./loader.c5738979.js"),["assets/loader.c5738979.js","assets/loader.3b2bd4b3.css"]),path:"/loader"},{name:"details",component:()=>gr(()=>import("./details.b716610a.js"),["assets/details.b716610a.js","assets/details.511e542e.css","assets/loader.c5738979.js","assets/loader.3b2bd4b3.css"]),path:"/University/:name"},{name:"mobileNav",component:()=>gr(()=>Promise.resolve().then(function(){return EL}),void 0),path:"/nav"},{name:"Dashboard",component:()=>gr(()=>import("./Dashboard.5623b74a.js"),["assets/Dashboard.5623b74a.js","assets/Dashboard.bc87434d.css","assets/loader.c5738979.js","assets/loader.3b2bd4b3.css"]),path:"/admin/dashboard"},{name:"Edit",component:()=>gr(()=>import("./Edit.df8a3936.js"),["assets/Edit.df8a3936.js","assets/Edit.65fbaaa0.css","assets/loader.c5738979.js","assets/loader.3b2bd4b3.css","assets/level.19f89a9b.js","assets/types.7d33b1ee.js"]),path:"/admin/dashboard/edit/:name"},{name:"Testing",component:()=>gr(()=>import("./teting.cea25178.js"),["assets/teting.cea25178.js","assets/types.7d33b1ee.js"]),path:"/Testing"}],Z1=Y1({history:d1(),routes:X1});var Jd=(t,e)=>{const n=t.__vccOpts||t;for(const[r,s]of e)n[r]=s;return n};const eL={},N_=t=>(US("data-v-6f460565"),t=t(),$S(),t),tL={class:"container"},nL={class:"flex center between",id:"main-nav"},rL=N_(()=>Ct("div",{class:"flex center"},[Ct("div",{class:"logo"},[Ct("h1",null,"EDUCATIA")])],-1)),sL={class:"li"},iL=su("Home"),oL=su("Universities"),aL=N_(()=>Ct("a",{href:"#"},"Degrees",-1)),cL=N_(()=>Ct("div",{class:"nav-button"},[Ct("a",{href:"#contact-form"},[Ct("button",{class:"btn btn-primary"},"Conatact")])],-1));function lL(t,e,n,r,s,i){const o=Go("router-link");return Fs(),ul("header",null,[Ct("div",tL,[Ct("nav",nL,[rL,Ct("div",sL,[ct(o,{to:"/"},{default:Zo(()=>[iL]),_:1}),ct(o,{to:"/Univercities"},{default:Zo(()=>[oL]),_:1}),aL]),cL])])])}var uL=Jd(eL,[["render",lL],["__scopeId","data-v-6f460565"]]),hL="/Educatia/icons8-hamburger-64.png",dL="/Educatia/icons8-multiply-40.png";const fL={name:"mobileNav",data(){return{isNav:!1}}},E0=t=>(US("data-v-77c0f15d"),t=t(),$S(),t),pL={class:"icon"},gL={key:0,class:"main-nav",ref:"nav"},mL=E0(()=>Ct("img",{src:dL,alt:""},null,-1)),_L=[mL],yL={class:"links"},vL=su("Home"),wL=su("Universities"),bL=E0(()=>Ct("a",{href:"#"},"Degrees",-1));function IL(t,e,n,r,s,i){const o=Go("router-link");return Fs(),ul(Un,null,[Ct("div",pL,[Ct("img",{ref:"ham",onClick:e[0]||(e[0]=a=>s.isNav=!0),src:hL,alt:""},null,512)]),ct(k_,null,{default:Zo(()=>[s.isNav==!0?(Fs(),ul("div",gL,[Ct("div",{class:"cross",onClick:e[1]||(e[1]=a=>s.isNav=!1)},_L),Ct("div",yL,[ct(o,{to:"/",onClick:e[2]||(e[2]=a=>s.isNav=!1)},{default:Zo(()=>[vL]),_:1}),ct(o,{to:"/Univercities",onClick:e[3]||(e[3]=a=>s.isNav=!1)},{default:Zo(()=>[wL]),_:1}),bL])],512)):Vg("",!0)]),_:1})],64)}var T0=Jd(fL,[["render",IL],["__scopeId","data-v-77c0f15d"]]),EL=Object.freeze(Object.defineProperty({__proto__:null,default:T0},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const S0={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const x=function(t,e){if(!t)throw Ba(e)},Ba=function(t){return new Error("Firebase Database ("+S0.SDK_VERSION+") INTERNAL ASSERT FAILED: "+t)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const C0=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let s=t.charCodeAt(r);s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=s&63|128):(s&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=s&63|128):(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=s&63|128)}return e},TL=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const s=t[n++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=t[n++];e[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=t[n++],o=t[n++],a=t[n++],c=((s&7)<<18|(i&63)<<12|(o&63)<<6|a&63)-65536;e[r++]=String.fromCharCode(55296+(c>>10)),e[r++]=String.fromCharCode(56320+(c&1023))}else{const i=t[n++],o=t[n++];e[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|o&63)}}return e.join("")},Xd={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<t.length;s+=3){const i=t[s],o=s+1<t.length,a=o?t[s+1]:0,c=s+2<t.length,l=c?t[s+2]:0,u=i>>2,h=(i&3)<<4|a>>4;let d=(a&15)<<2|l>>6,f=l&63;c||(f=64,o||(d=64)),r.push(n[u],n[h],n[d],n[f])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(C0(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):TL(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<t.length;){const i=n[t.charAt(s++)],a=s<t.length?n[t.charAt(s)]:0;++s;const l=s<t.length?n[t.charAt(s)]:64;++s;const h=s<t.length?n[t.charAt(s)]:64;if(++s,i==null||a==null||l==null||h==null)throw Error();const d=i<<2|a>>4;if(r.push(d),l!==64){const f=a<<4&240|l>>2;if(r.push(f),h!==64){const p=l<<6&192|h;r.push(p)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}},A0=function(t){const e=C0(t);return Xd.encodeByteArray(e,!0)},Fh=function(t){return A0(t).replace(/\./g,"")},Hg=function(t){try{return Xd.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function SL(t){return pl(void 0,t)}function pl(t,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:const n=e;return new Date(n.getTime());case Object:t===void 0&&(t={});break;case Array:t=[];break;default:return e}for(const n in e)!e.hasOwnProperty(n)||!CL(n)||(t[n]=pl(t[n],e[n]));return t}function CL(t){return t!=="__proto__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gt{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function P_(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",s=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},t),a="";return[Fh(JSON.stringify(n)),Fh(JSON.stringify(o)),a].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function We(){return typeof navigator!="undefined"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function Zd(){return typeof window!="undefined"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(We())}function D_(){try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function AL(){return typeof self=="object"&&self.self===self}function iu(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function ou(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function kL(){return We().indexOf("Electron/")>=0}function x_(){const t=We();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function RL(){return We().indexOf("MSAppHost/")>=0}function k0(){return S0.NODE_ADMIN===!0}function NL(){return!D_()&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function In(){return typeof indexedDB=="object"}function au(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},s.onupgradeneeded=()=>{n=!1},s.onerror=()=>{var i;e(((i=s.error)===null||i===void 0?void 0:i.message)||"")}}catch(n){e(n)}})}function ef(){return!(typeof navigator=="undefined"||!navigator.cookieEnabled)}function PL(){if(typeof self!="undefined")return self;if(typeof window!="undefined")return window;if(typeof global!="undefined")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DL="FirebaseError";class lt extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=DL,Object.setPrototypeOf(this,lt.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,fn.prototype.create)}}class fn{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},s=`${this.service}/${e}`,i=this.errors[e],o=i?xL(i,r):"Error",a=`${this.serviceName}: ${o} (${s}).`;return new lt(s,a,r)}}function xL(t,e){return t.replace(OL,(n,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const OL=/\{\$([^}]+)}/g;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gl(t){return JSON.parse(t)}function mt(t){return JSON.stringify(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const O_=function(t){let e={},n={},r={},s="";try{const i=t.split(".");e=gl(Hg(i[0])||""),n=gl(Hg(i[1])||""),s=i[2],r=n.d||{},delete n.d}catch{}return{header:e,claims:n,data:r,signature:s}},ML=function(t){const e=O_(t).claims;return typeof e=="object"&&e.hasOwnProperty("iat")?e.iat:null},LL=function(t){const e=O_(t),n=e.claims;return!!n&&typeof n=="object"&&n.hasOwnProperty("iat")},FL=function(t){const e=O_(t).claims;return typeof e=="object"&&e.admin===!0};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xn(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function Gi(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]}function Uh(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function $h(t,e,n){const r={};for(const s in t)Object.prototype.hasOwnProperty.call(t,s)&&(r[s]=e.call(n,t[s],s,t));return r}function Gg(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const s of n){if(!r.includes(s))return!1;const i=t[s],o=e[s];if(xb(i)&&xb(o)){if(!Gg(i,o))return!1}else if(i!==o)return!1}for(const s of r)if(!n.includes(s))return!1;return!0}function xb(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bo(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(s=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function zo(t){const e={};return t.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[s,i]=r.split("=");e[decodeURIComponent(s)]=decodeURIComponent(i)}}),e}function kc(t){const e=t.indexOf("?");if(!e)return"";const n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UL{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=512/8,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(e,n){n||(n=0);const r=this.W_;if(typeof e=="string")for(let h=0;h<16;h++)r[h]=e.charCodeAt(n)<<24|e.charCodeAt(n+1)<<16|e.charCodeAt(n+2)<<8|e.charCodeAt(n+3),n+=4;else for(let h=0;h<16;h++)r[h]=e[n]<<24|e[n+1]<<16|e[n+2]<<8|e[n+3],n+=4;for(let h=16;h<80;h++){const d=r[h-3]^r[h-8]^r[h-14]^r[h-16];r[h]=(d<<1|d>>>31)&4294967295}let s=this.chain_[0],i=this.chain_[1],o=this.chain_[2],a=this.chain_[3],c=this.chain_[4],l,u;for(let h=0;h<80;h++){h<40?h<20?(l=a^i&(o^a),u=1518500249):(l=i^o^a,u=1859775393):h<60?(l=i&o|a&(i|o),u=2400959708):(l=i^o^a,u=3395469782);const d=(s<<5|s>>>27)+l+c+u+r[h]&4294967295;c=a,a=o,o=(i<<30|i>>>2)&4294967295,i=s,s=d}this.chain_[0]=this.chain_[0]+s&4294967295,this.chain_[1]=this.chain_[1]+i&4294967295,this.chain_[2]=this.chain_[2]+o&4294967295,this.chain_[3]=this.chain_[3]+a&4294967295,this.chain_[4]=this.chain_[4]+c&4294967295}update(e,n){if(e==null)return;n===void 0&&(n=e.length);const r=n-this.blockSize;let s=0;const i=this.buf_;let o=this.inbuf_;for(;s<n;){if(o===0)for(;s<=r;)this.compress_(e,s),s+=this.blockSize;if(typeof e=="string"){for(;s<n;)if(i[o]=e.charCodeAt(s),++o,++s,o===this.blockSize){this.compress_(i),o=0;break}}else for(;s<n;)if(i[o]=e[s],++o,++s,o===this.blockSize){this.compress_(i),o=0;break}}this.inbuf_=o,this.total_+=n}digest(){const e=[];let n=this.total_*8;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let s=this.blockSize-1;s>=56;s--)this.buf_[s]=n&255,n/=256;this.compress_(this.buf_);let r=0;for(let s=0;s<5;s++)for(let i=24;i>=0;i-=8)e[r]=this.chain_[s]>>i&255,++r;return e}}function R0(t,e){const n=new $L(t,e);return n.subscribe.bind(n)}class $L{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let s;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");VL(e,["next","error","complete"])?s=e:s={next:e,error:n,complete:r},s.next===void 0&&(s.next=Rp),s.error===void 0&&(s.error=Rp),s.complete===void 0&&(s.complete=Rp);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console!="undefined"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function VL(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function Rp(){}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ne=function(t,e,n,r){let s;if(r<e?s="at least "+e:r>n&&(s=n===0?"none":"no more than "+n),s){const i=t+" failed: Was called with "+r+(r===1?" argument.":" arguments.")+" Expects "+s+".";throw new Error(i)}};function bn(t,e){return`${t} failed: ${e} argument `}function bt(t,e,n,r){if(!(r&&!n)&&typeof n!="function")throw new Error(bn(t,e)+"must be a valid function.")}function Ob(t,e,n,r){if(!(r&&!n)&&(typeof n!="object"||n===null))throw new Error(bn(t,e)+"must be a valid context object.")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BL=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let s=t.charCodeAt(r);if(s>=55296&&s<=56319){const i=s-55296;r++,x(r<t.length,"Surrogate pair missing trail surrogate.");const o=t.charCodeAt(r)-56320;s=65536+(i<<10)+o}s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=s&63|128):s<65536?(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=s&63|128):(e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=s&63|128)}return e},tf=function(t){let e=0;for(let n=0;n<t.length;n++){const r=t.charCodeAt(n);r<128?e++:r<2048?e+=2:r>=55296&&r<=56319?(e+=4,n++):e+=3}return e};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qL=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,t=>{const e=Math.random()*16|0;return(t==="x"?e:e&3|8).toString(16)})};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jL=1e3,KL=2,WL=4*60*60*1e3,HL=.5;function Vh(t,e=jL,n=KL){const r=e*Math.pow(n,t),s=Math.round(HL*r*(Math.random()-.5)*2);return Math.min(WL,r+s)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function A(t){return t&&t._delegate?t._delegate:t}class Ee{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bi="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N0{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new gt;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:n});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),s=(n=e==null?void 0:e.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(i){if(s)return null;throw i}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(zL(e))try{this.getOrInitializeService({instanceIdentifier:bi})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(n);try{const i=this.getOrInitializeService({instanceIdentifier:s});r.resolve(i)}catch{}}}}clearInstance(e=bi){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=bi){return this.instances.has(e)}getOptions(e=bi){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[i,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(i);r===a&&o.resolve(s)}return s}onInit(e,n){var r;const s=this.normalizeInstanceIdentifier(n),i=(r=this.onInitCallbacks.get(s))!==null&&r!==void 0?r:new Set;i.add(e),this.onInitCallbacks.set(s,i);const o=this.instances.get(s);return o&&e(o,s),()=>{i.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(!!r)for(const s of r)try{s(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:GL(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=bi){return this.component?this.component.multipleInstances?e:bi:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function GL(t){return t===bi?void 0:t}function zL(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P0{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new N0(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const M_=[];var de;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(de||(de={}));const D0={debug:de.DEBUG,verbose:de.VERBOSE,info:de.INFO,warn:de.WARN,error:de.ERROR,silent:de.SILENT},QL=de.INFO,YL={[de.DEBUG]:"log",[de.VERBOSE]:"log",[de.INFO]:"info",[de.WARN]:"warn",[de.ERROR]:"error"},JL=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),s=YL[e];if(s)console[s](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Vr{constructor(e){this.name=e,this._logLevel=QL,this._logHandler=JL,this._userLogHandler=null,M_.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in de))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?D0[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,de.DEBUG,...e),this._logHandler(this,de.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,de.VERBOSE,...e),this._logHandler(this,de.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,de.INFO,...e),this._logHandler(this,de.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,de.WARN,...e),this._logHandler(this,de.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,de.ERROR,...e),this._logHandler(this,de.ERROR,...e)}}function XL(t){M_.forEach(e=>{e.setLogLevel(t)})}function ZL(t,e){for(const n of M_){let r=null;e&&e.level&&(r=D0[e.level]),t===null?n.userLogHandler=null:n.userLogHandler=(s,i,...o)=>{const a=o.map(c=>{if(c==null)return null;if(typeof c=="string")return c;if(typeof c=="number"||typeof c=="boolean")return c.toString();if(c instanceof Error)return c.message;try{return JSON.stringify(c)}catch{return null}}).filter(c=>c).join(" ");i>=(r!=null?r:s.logLevel)&&t({level:de[i].toLowerCase(),message:a,args:o,type:s.name})}}}const eF=(t,e)=>e.some(n=>t instanceof n);let Mb,Lb;function tF(){return Mb||(Mb=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function nF(){return Lb||(Lb=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const x0=new WeakMap,zg=new WeakMap,O0=new WeakMap,Np=new WeakMap,L_=new WeakMap;function rF(t){const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("success",i),t.removeEventListener("error",o)},i=()=>{n(Xr(t.result)),s()},o=()=>{r(t.error),s()};t.addEventListener("success",i),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&x0.set(n,t)}).catch(()=>{}),L_.set(e,t),e}function sF(t){if(zg.has(t))return;const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",o),t.removeEventListener("abort",o)},i=()=>{n(),s()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",i),t.addEventListener("error",o),t.addEventListener("abort",o)});zg.set(t,e)}let Qg={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return zg.get(t);if(e==="objectStoreNames")return t.objectStoreNames||O0.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Xr(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function iF(t){Qg=t(Qg)}function oF(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(Pp(this),e,...n);return O0.set(r,e.sort?e.sort():[e]),Xr(r)}:nF().includes(t)?function(...e){return t.apply(Pp(this),e),Xr(x0.get(this))}:function(...e){return Xr(t.apply(Pp(this),e))}}function aF(t){return typeof t=="function"?oF(t):(t instanceof IDBTransaction&&sF(t),eF(t,tF())?new Proxy(t,Qg):t)}function Xr(t){if(t instanceof IDBRequest)return rF(t);if(Np.has(t))return Np.get(t);const e=aF(t);return e!==t&&(Np.set(t,e),L_.set(e,t)),e}const Pp=t=>L_.get(t);function qa(t,e,{blocked:n,upgrade:r,blocking:s,terminated:i}={}){const o=indexedDB.open(t,e),a=Xr(o);return r&&o.addEventListener("upgradeneeded",c=>{r(Xr(o.result),c.oldVersion,c.newVersion,Xr(o.transaction))}),n&&o.addEventListener("blocked",()=>n()),a.then(c=>{i&&c.addEventListener("close",()=>i()),s&&c.addEventListener("versionchange",()=>s())}).catch(()=>{}),a}function ea(t,{blocked:e}={}){const n=indexedDB.deleteDatabase(t);return e&&n.addEventListener("blocked",()=>e()),Xr(n).then(()=>{})}const cF=["get","getKey","getAll","getAllKeys","count"],lF=["put","add","delete","clear"],Dp=new Map;function Fb(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(Dp.get(e))return Dp.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,s=lF.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(s||cF.includes(n)))return;const i=async function(o,...a){const c=this.transaction(o,s?"readwrite":"readonly");let l=c.store;return r&&(l=l.index(a.shift())),(await Promise.all([l[n](...a),s&&c.done]))[0]};return Dp.set(e,i),i}iF(t=>({...t,get:(e,n,r)=>Fb(e,n)||t.get(e,n,r),has:(e,n)=>!!Fb(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uF{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(hF(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function hF(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Yg="@firebase/app",Ub="0.7.28";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const F_=new Vr("@firebase/app"),dF="@firebase/app-compat",fF="@firebase/analytics-compat",pF="@firebase/analytics",gF="@firebase/app-check-compat",mF="@firebase/app-check",_F="@firebase/auth",yF="@firebase/auth-compat",vF="@firebase/database",wF="@firebase/database-compat",bF="@firebase/functions",IF="@firebase/functions-compat",EF="@firebase/installations",TF="@firebase/installations-compat",SF="@firebase/messaging",CF="@firebase/messaging-compat",AF="@firebase/performance",kF="@firebase/performance-compat",RF="@firebase/remote-config",NF="@firebase/remote-config-compat",PF="@firebase/storage",DF="@firebase/storage-compat",xF="@firebase/firestore",OF="@firebase/firestore-compat",MF="firebase",LF="9.9.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zi="[DEFAULT]",FF={[Yg]:"fire-core",[dF]:"fire-core-compat",[pF]:"fire-analytics",[fF]:"fire-analytics-compat",[mF]:"fire-app-check",[gF]:"fire-app-check-compat",[_F]:"fire-auth",[yF]:"fire-auth-compat",[vF]:"fire-rtdb",[wF]:"fire-rtdb-compat",[bF]:"fire-fn",[IF]:"fire-fn-compat",[EF]:"fire-iid",[TF]:"fire-iid-compat",[SF]:"fire-fcm",[CF]:"fire-fcm-compat",[AF]:"fire-perf",[kF]:"fire-perf-compat",[RF]:"fire-rc",[NF]:"fire-rc-compat",[PF]:"fire-gcs",[DF]:"fire-gcs-compat",[xF]:"fire-fst",[OF]:"fire-fst-compat","fire-js":"fire-js",[MF]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hs=new Map,ml=new Map;function Bh(t,e){try{t.container.addComponent(e)}catch(n){F_.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function M0(t,e){t.container.addOrOverwriteComponent(e)}function nt(t){const e=t.name;if(ml.has(e))return F_.debug(`There were multiple attempts to register component ${e}.`),!1;ml.set(e,t);for(const n of Hs.values())Bh(n,t);return!0}function Io(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function UF(t,e,n=zi){Io(t,e).clearInstance(n)}function $F(){ml.clear()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VF={["no-app"]:"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()",["bad-app-name"]:"Illegal App name: '{$appName}",["duplicate-app"]:"Firebase App named '{$appName}' already exists with different options or config",["app-deleted"]:"Firebase App named '{$appName}' already deleted",["invalid-app-argument"]:"firebase.{$appName}() takes either no argument or a Firebase App instance.",["invalid-log-argument"]:"First argument to `onLog` must be null or a function.",["storage-open"]:"Error thrown when opening storage. Original error: {$originalErrorMessage}.",["storage-get"]:"Error thrown when reading from storage. Original error: {$originalErrorMessage}.",["storage-set"]:"Error thrown when writing to storage. Original error: {$originalErrorMessage}.",["storage-delete"]:"Error thrown when deleting from storage. Original error: {$originalErrorMessage}."},Gs=new fn("app","Firebase",VF);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BF{constructor(e,n,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Ee("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Gs.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Br=LF;function L0(t,e={}){typeof e!="object"&&(e={name:e});const n=Object.assign({name:zi,automaticDataCollectionEnabled:!1},e),r=n.name;if(typeof r!="string"||!r)throw Gs.create("bad-app-name",{appName:String(r)});const s=Hs.get(r);if(s){if(Gg(t,s.options)&&Gg(n,s.config))return s;throw Gs.create("duplicate-app",{appName:r})}const i=new P0(r);for(const a of ml.values())i.addComponent(a);const o=new BF(t,n,i);return Hs.set(r,o),o}function F0(t=zi){const e=Hs.get(t);if(!e)throw Gs.create("no-app",{appName:t});return e}function qF(){return Array.from(Hs.values())}async function U0(t){const e=t.name;Hs.has(e)&&(Hs.delete(e),await Promise.all(t.container.getProviders().map(n=>n.delete())),t.isDeleted=!0)}function Le(t,e,n){var r;let s=(r=FF[t])!==null&&r!==void 0?r:t;n&&(s+=`-${n}`);const i=s.match(/\s|\//),o=e.match(/\s|\//);if(i||o){const a=[`Unable to register library "${s}" with version "${e}":`];i&&a.push(`library name "${s}" contains illegal characters (whitespace or "/")`),i&&o&&a.push("and"),o&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),F_.warn(a.join(" "));return}nt(new Ee(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}function $0(t,e){if(t!==null&&typeof t!="function")throw Gs.create("invalid-log-argument");ZL(t,e)}function V0(t){XL(t)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jF="firebase-heartbeat-database",KF=1,_l="firebase-heartbeat-store";let xp=null;function B0(){return xp||(xp=qa(jF,KF,{upgrade:(t,e)=>{switch(e){case 0:t.createObjectStore(_l)}}}).catch(t=>{throw Gs.create("storage-open",{originalErrorMessage:t.message})})),xp}async function WF(t){var e;try{return(await B0()).transaction(_l).objectStore(_l).get(q0(t))}catch(n){throw Gs.create("storage-get",{originalErrorMessage:(e=n)===null||e===void 0?void 0:e.message})}}async function $b(t,e){var n;try{const s=(await B0()).transaction(_l,"readwrite");return await s.objectStore(_l).put(e,q0(t)),s.done}catch(r){throw Gs.create("storage-set",{originalErrorMessage:(n=r)===null||n===void 0?void 0:n.message})}}function q0(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HF=1024,GF=30*24*60*60*1e3;class zF{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new YF(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=Vb();if(this._heartbeatsCache===null&&(this._heartbeatsCache=await this._heartbeatsCachePromise),!(this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(s=>s.date===r)))return this._heartbeatsCache.heartbeats.push({date:r,agent:n}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(s=>{const i=new Date(s.date).valueOf();return Date.now()-i<=GF}),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache===null||this._heartbeatsCache.heartbeats.length===0)return"";const e=Vb(),{heartbeatsToSend:n,unsentEntries:r}=QF(this._heartbeatsCache.heartbeats),s=Fh(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=e,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}}function Vb(){return new Date().toISOString().substring(0,10)}function QF(t,e=HF){const n=[];let r=t.slice();for(const s of t){const i=n.find(o=>o.agent===s.agent);if(i){if(i.dates.push(s.date),Bb(n)>e){i.dates.pop();break}}else if(n.push({agent:s.agent,dates:[s.date]}),Bb(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class YF{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return In()?au().then(()=>!0).catch(()=>!1):!1}async read(){return await this._canUseIndexedDBPromise?await WF(this.app)||{heartbeats:[]}:{heartbeats:[]}}async overwrite(e){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return $b(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return $b(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function Bb(t){return Fh(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function JF(t){nt(new Ee("platform-logger",e=>new uF(e),"PRIVATE")),nt(new Ee("heartbeat",e=>new zF(e),"PRIVATE")),Le(Yg,Ub,t),Le(Yg,Ub,"esm2017"),Le("fire-js","")}JF("");var XF=Object.freeze(Object.defineProperty({__proto__:null,SDK_VERSION:Br,_DEFAULT_ENTRY_NAME:zi,_addComponent:Bh,_addOrOverwriteComponent:M0,_apps:Hs,_clearComponents:$F,_components:ml,_getProvider:Io,_registerComponent:nt,_removeServiceInstance:UF,deleteApp:U0,getApp:F0,getApps:qF,initializeApp:L0,onLog:$0,registerVersion:Le,setLogLevel:V0,FirebaseError:lt},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZF{constructor(e,n){this._delegate=e,this.firebase=n,Bh(e,new Ee("app-compat",()=>this,"PUBLIC")),this.container=e.container}get automaticDataCollectionEnabled(){return this._delegate.automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this._delegate.automaticDataCollectionEnabled=e}get name(){return this._delegate.name}get options(){return this._delegate.options}delete(){return new Promise(e=>{this._delegate.checkDestroyed(),e()}).then(()=>(this.firebase.INTERNAL.removeApp(this.name),U0(this._delegate)))}_getService(e,n=zi){var r;this._delegate.checkDestroyed();const s=this._delegate.container.getProvider(e);return!s.isInitialized()&&((r=s.getComponent())===null||r===void 0?void 0:r.instantiationMode)==="EXPLICIT"&&s.initialize(),s.getImmediate({identifier:n})}_removeServiceInstance(e,n=zi){this._delegate.container.getProvider(e).clearInstance(n)}_addComponent(e){Bh(this._delegate,e)}_addOrOverwriteComponent(e){M0(this._delegate,e)}toJSON(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eU={["no-app"]:"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()",["invalid-app-argument"]:"firebase.{$appName}() takes either no argument or a Firebase App instance."},qb=new fn("app-compat","Firebase",eU);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tU(t){const e={},n={__esModule:!0,initializeApp:i,app:s,registerVersion:Le,setLogLevel:V0,onLog:$0,apps:null,SDK_VERSION:Br,INTERNAL:{registerComponent:a,removeApp:r,useAsService:c,modularAPIs:XF}};n.default=n,Object.defineProperty(n,"apps",{get:o});function r(l){delete e[l]}function s(l){if(l=l||zi,!xn(e,l))throw qb.create("no-app",{appName:l});return e[l]}s.App=t;function i(l,u={}){const h=L0(l,u);if(xn(e,h.name))return e[h.name];const d=new t(h,n);return e[h.name]=d,d}function o(){return Object.keys(e).map(l=>e[l])}function a(l){const u=l.name,h=u.replace("-compat","");if(nt(l)&&l.type==="PUBLIC"){const d=(f=s())=>{if(typeof f[h]!="function")throw qb.create("invalid-app-argument",{appName:u});return f[h]()};l.serviceProps!==void 0&&pl(d,l.serviceProps),n[h]=d,t.prototype[h]=function(...f){return this._getService.bind(this,u).apply(this,l.multipleInstances?f:[])}}return l.type==="PUBLIC"?n[h]:null}function c(l,u){return u==="serverAuth"?null:u}return n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function j0(){const t=tU(ZF);t.INTERNAL=Object.assign(Object.assign({},t.INTERNAL),{createFirebaseNamespace:j0,extendNamespace:e,createSubscribe:R0,ErrorFactory:fn,deepExtend:pl});function e(n){pl(t,n)}return t}const nU=j0();/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jb=new Vr("@firebase/app-compat"),rU="@firebase/app-compat",sU="0.1.29";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iU(t){Le(rU,sU,t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */if(AL()&&self.firebase!==void 0){jb.warn(`
    Warning: Firebase is already defined in the global scope. Please make sure
    Firebase library is only loaded once.
  `);const t=self.firebase.SDK_VERSION;t&&t.indexOf("LITE")>=0&&jb.warn(`
    Warning: You are trying to load Firebase while using Firebase Performance standalone script.
    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.
    `)}const ut=nU;iU();const K0="@firebase/installations",U_="0.5.12";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const W0=1e4,H0=`w:${U_}`,G0="FIS_v2",oU="https://firebaseinstallations.googleapis.com/v1",aU=60*60*1e3,cU="installations",lU="Installations";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uU={["missing-app-config-values"]:'Missing App configuration value: "{$valueName}"',["not-registered"]:"Firebase Installation is not registered.",["installation-not-found"]:"Firebase Installation not found.",["request-failed"]:'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',["app-offline"]:"Could not process request. Application offline.",["delete-pending-registration"]:"Can't delete installation while there is a pending registration request."},Qi=new fn(cU,lU,uU);function z0(t){return t instanceof lt&&t.code.includes("request-failed")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Q0({projectId:t}){return`${oU}/projects/${t}/installations`}function Y0(t){return{token:t.token,requestStatus:2,expiresIn:dU(t.expiresIn),creationTime:Date.now()}}async function J0(t,e){const r=(await e.json()).error;return Qi.create("request-failed",{requestName:t,serverCode:r.code,serverMessage:r.message,serverStatus:r.status})}function X0({apiKey:t}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t})}function hU(t,{refreshToken:e}){const n=X0(t);return n.append("Authorization",fU(e)),n}async function Z0(t){const e=await t();return e.status>=500&&e.status<600?t():e}function dU(t){return Number(t.replace("s","000"))}function fU(t){return`${G0} ${t}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function pU({appConfig:t,heartbeatServiceProvider:e},{fid:n}){const r=Q0(t),s=X0(t),i=e.getImmediate({optional:!0});if(i){const l=await i.getHeartbeatsHeader();l&&s.append("x-firebase-client",l)}const o={fid:n,authVersion:G0,appId:t.appId,sdkVersion:H0},a={method:"POST",headers:s,body:JSON.stringify(o)},c=await Z0(()=>fetch(r,a));if(c.ok){const l=await c.json();return{fid:l.fid||n,registrationStatus:2,refreshToken:l.refreshToken,authToken:Y0(l.authToken)}}else throw await J0("Create Installation",c)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eC(t){return new Promise(e=>{setTimeout(e,t)})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gU(t){return btoa(String.fromCharCode(...t)).replace(/\+/g,"-").replace(/\//g,"_")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mU=/^[cdef][\w-]{21}$/,Jg="";function _U(){try{const t=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(t),t[0]=112+t[0]%16;const n=yU(t);return mU.test(n)?n:Jg}catch{return Jg}}function yU(t){return gU(t).substr(0,22)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nf(t){return`${t.appName}!${t.appId}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tC=new Map;function nC(t,e){const n=nf(t);rC(n,e),vU(n,e)}function rC(t,e){const n=tC.get(t);if(!!n)for(const r of n)r(e)}function vU(t,e){const n=wU();n&&n.postMessage({key:t,fid:e}),bU()}let xi=null;function wU(){return!xi&&"BroadcastChannel"in self&&(xi=new BroadcastChannel("[Firebase] FID Change"),xi.onmessage=t=>{rC(t.data.key,t.data.fid)}),xi}function bU(){tC.size===0&&xi&&(xi.close(),xi=null)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IU="firebase-installations-database",EU=1,Yi="firebase-installations-store";let Op=null;function $_(){return Op||(Op=qa(IU,EU,{upgrade:(t,e)=>{switch(e){case 0:t.createObjectStore(Yi)}}})),Op}async function qh(t,e){const n=nf(t),s=(await $_()).transaction(Yi,"readwrite"),i=s.objectStore(Yi),o=await i.get(n);return await i.put(e,n),await s.done,(!o||o.fid!==e.fid)&&nC(t,e.fid),e}async function sC(t){const e=nf(t),r=(await $_()).transaction(Yi,"readwrite");await r.objectStore(Yi).delete(e),await r.done}async function rf(t,e){const n=nf(t),s=(await $_()).transaction(Yi,"readwrite"),i=s.objectStore(Yi),o=await i.get(n),a=e(o);return a===void 0?await i.delete(n):await i.put(a,n),await s.done,a&&(!o||o.fid!==a.fid)&&nC(t,a.fid),a}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function V_(t){let e;const n=await rf(t.appConfig,r=>{const s=TU(r),i=SU(t,s);return e=i.registrationPromise,i.installationEntry});return n.fid===Jg?{installationEntry:await e}:{installationEntry:n,registrationPromise:e}}function TU(t){const e=t||{fid:_U(),registrationStatus:0};return iC(e)}function SU(t,e){if(e.registrationStatus===0){if(!navigator.onLine){const s=Promise.reject(Qi.create("app-offline"));return{installationEntry:e,registrationPromise:s}}const n={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},r=CU(t,n);return{installationEntry:n,registrationPromise:r}}else return e.registrationStatus===1?{installationEntry:e,registrationPromise:AU(t)}:{installationEntry:e}}async function CU(t,e){try{const n=await pU(t,e);return qh(t.appConfig,n)}catch(n){throw z0(n)&&n.customData.serverCode===409?await sC(t.appConfig):await qh(t.appConfig,{fid:e.fid,registrationStatus:0}),n}}async function AU(t){let e=await Kb(t.appConfig);for(;e.registrationStatus===1;)await eC(100),e=await Kb(t.appConfig);if(e.registrationStatus===0){const{installationEntry:n,registrationPromise:r}=await V_(t);return r||n}return e}function Kb(t){return rf(t,e=>{if(!e)throw Qi.create("installation-not-found");return iC(e)})}function iC(t){return kU(t)?{fid:t.fid,registrationStatus:0}:t}function kU(t){return t.registrationStatus===1&&t.registrationTime+W0<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function RU({appConfig:t,heartbeatServiceProvider:e},n){const r=NU(t,n),s=hU(t,n),i=e.getImmediate({optional:!0});if(i){const l=await i.getHeartbeatsHeader();l&&s.append("x-firebase-client",l)}const o={installation:{sdkVersion:H0,appId:t.appId}},a={method:"POST",headers:s,body:JSON.stringify(o)},c=await Z0(()=>fetch(r,a));if(c.ok){const l=await c.json();return Y0(l)}else throw await J0("Generate Auth Token",c)}function NU(t,{fid:e}){return`${Q0(t)}/${e}/authTokens:generate`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function B_(t,e=!1){let n;const r=await rf(t.appConfig,i=>{if(!oC(i))throw Qi.create("not-registered");const o=i.authToken;if(!e&&xU(o))return i;if(o.requestStatus===1)return n=PU(t,e),i;{if(!navigator.onLine)throw Qi.create("app-offline");const a=MU(i);return n=DU(t,a),a}});return n?await n:r.authToken}async function PU(t,e){let n=await Wb(t.appConfig);for(;n.authToken.requestStatus===1;)await eC(100),n=await Wb(t.appConfig);const r=n.authToken;return r.requestStatus===0?B_(t,e):r}function Wb(t){return rf(t,e=>{if(!oC(e))throw Qi.create("not-registered");const n=e.authToken;return LU(n)?Object.assign(Object.assign({},e),{authToken:{requestStatus:0}}):e})}async function DU(t,e){try{const n=await RU(t,e),r=Object.assign(Object.assign({},e),{authToken:n});return await qh(t.appConfig,r),n}catch(n){if(z0(n)&&(n.customData.serverCode===401||n.customData.serverCode===404))await sC(t.appConfig);else{const r=Object.assign(Object.assign({},e),{authToken:{requestStatus:0}});await qh(t.appConfig,r)}throw n}}function oC(t){return t!==void 0&&t.registrationStatus===2}function xU(t){return t.requestStatus===2&&!OU(t)}function OU(t){const e=Date.now();return e<t.creationTime||t.creationTime+t.expiresIn<e+aU}function MU(t){const e={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},t),{authToken:e})}function LU(t){return t.requestStatus===1&&t.requestTime+W0<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function FU(t){const e=t,{installationEntry:n,registrationPromise:r}=await V_(e);return r?r.catch(console.error):B_(e).catch(console.error),n.fid}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function UU(t,e=!1){const n=t;return await $U(n),(await B_(n,e)).token}async function $U(t){const{registrationPromise:e}=await V_(t);e&&await e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VU(t){if(!t||!t.options)throw Mp("App Configuration");if(!t.name)throw Mp("App Name");const e=["projectId","apiKey","appId"];for(const n of e)if(!t.options[n])throw Mp(n);return{appName:t.name,projectId:t.options.projectId,apiKey:t.options.apiKey,appId:t.options.appId}}function Mp(t){return Qi.create("missing-app-config-values",{valueName:t})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aC="installations",BU="installations-internal",qU=t=>{const e=t.getProvider("app").getImmediate(),n=VU(e),r=Io(e,"heartbeat");return{app:e,appConfig:n,heartbeatServiceProvider:r,_delete:()=>Promise.resolve()}},jU=t=>{const e=t.getProvider("app").getImmediate(),n=Io(e,aC).getImmediate();return{getId:()=>FU(n),getToken:s=>UU(n,s)}};function KU(){nt(new Ee(aC,qU,"PUBLIC")),nt(new Ee(BU,jU,"PRIVATE"))}KU();Le(K0,U_);Le(K0,U_,"esm2017");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hb="analytics",WU="firebase_id",HU="origin",GU=60*1e3,zU="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",cC="https://www.googletagmanager.com/gtag/js";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qt=new Vr("@firebase/analytics");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lC(t){return Promise.all(t.map(e=>e.catch(n=>n)))}function QU(t,e){const n=document.createElement("script");n.src=`${cC}?l=${t}&id=${e}`,n.async=!0,document.head.appendChild(n)}function YU(t){let e=[];return Array.isArray(window[t])?e=window[t]:window[t]=e,e}async function JU(t,e,n,r,s,i){const o=r[s];try{if(o)await e[o];else{const c=(await lC(n)).find(l=>l.measurementId===s);c&&await e[c.appId]}}catch(a){qt.error(a)}t("config",s,i)}async function XU(t,e,n,r,s){try{let i=[];if(s&&s.send_to){let o=s.send_to;Array.isArray(o)||(o=[o]);const a=await lC(n);for(const c of o){const l=a.find(h=>h.measurementId===c),u=l&&e[l.appId];if(u)i.push(u);else{i=[];break}}}i.length===0&&(i=Object.values(e)),await Promise.all(i),t("event",r,s||{})}catch(i){qt.error(i)}}function ZU(t,e,n,r){async function s(i,o,a){try{i==="event"?await XU(t,e,n,o,a):i==="config"?await JU(t,e,n,r,o,a):i==="consent"?t("consent","update",a):t("set",o)}catch(c){qt.error(c)}}return s}function e$(t,e,n,r,s){let i=function(...o){window[r].push(arguments)};return window[s]&&typeof window[s]=="function"&&(i=window[s]),window[s]=ZU(i,t,e,n),{gtagCore:i,wrappedGtag:window[s]}}function t$(){const t=window.document.getElementsByTagName("script");for(const e of Object.values(t))if(e.src&&e.src.includes(cC))return e;return null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const n$={["already-exists"]:"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.",["already-initialized"]:"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-intialized instance.",["already-initialized-settings"]:"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.",["interop-component-reg-failed"]:"Firebase Analytics Interop Component failed to instantiate: {$reason}",["invalid-analytics-context"]:"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}",["indexeddb-unavailable"]:"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}",["fetch-throttle"]:"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.",["config-fetch-failed"]:"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}",["no-api-key"]:'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',["no-app-id"]:'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.'},Hn=new fn("analytics","Analytics",n$);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const r$=30,s$=1e3;class i${constructor(e={},n=s$){this.throttleMetadata=e,this.intervalMillis=n}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,n){this.throttleMetadata[e]=n}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}}const uC=new i$;function o$(t){return new Headers({Accept:"application/json","x-goog-api-key":t})}async function a$(t){var e;const{appId:n,apiKey:r}=t,s={method:"GET",headers:o$(r)},i=zU.replace("{app-id}",n),o=await fetch(i,s);if(o.status!==200&&o.status!==304){let a="";try{const c=await o.json();!((e=c.error)===null||e===void 0)&&e.message&&(a=c.error.message)}catch{}throw Hn.create("config-fetch-failed",{httpStatus:o.status,responseMessage:a})}return o.json()}async function c$(t,e=uC,n){const{appId:r,apiKey:s,measurementId:i}=t.options;if(!r)throw Hn.create("no-app-id");if(!s){if(i)return{measurementId:i,appId:r};throw Hn.create("no-api-key")}const o=e.getThrottleMetadata(r)||{backoffCount:0,throttleEndTimeMillis:Date.now()},a=new h$;return setTimeout(async()=>{a.abort()},n!==void 0?n:GU),hC({appId:r,apiKey:s,measurementId:i},o,a,e)}async function hC(t,{throttleEndTimeMillis:e,backoffCount:n},r,s=uC){var i,o;const{appId:a,measurementId:c}=t;try{await l$(r,e)}catch(l){if(c)return qt.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${c} provided in the "measurementId" field in the local Firebase config. [${(i=l)===null||i===void 0?void 0:i.message}]`),{appId:a,measurementId:c};throw l}try{const l=await a$(t);return s.deleteThrottleMetadata(a),l}catch(l){const u=l;if(!u$(u)){if(s.deleteThrottleMetadata(a),c)return qt.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${c} provided in the "measurementId" field in the local Firebase config. [${u==null?void 0:u.message}]`),{appId:a,measurementId:c};throw l}const h=Number((o=u==null?void 0:u.customData)===null||o===void 0?void 0:o.httpStatus)===503?Vh(n,s.intervalMillis,r$):Vh(n,s.intervalMillis),d={throttleEndTimeMillis:Date.now()+h,backoffCount:n+1};return s.setThrottleMetadata(a,d),qt.debug(`Calling attemptFetch again in ${h} millis`),hC(t,d,r,s)}}function l$(t,e){return new Promise((n,r)=>{const s=Math.max(e-Date.now(),0),i=setTimeout(n,s);t.addEventListener(()=>{clearTimeout(i),r(Hn.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}function u$(t){if(!(t instanceof lt)||!t.customData)return!1;const e=Number(t.customData.httpStatus);return e===429||e===500||e===503||e===504}class h${constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach(e=>e())}}async function d$(t,e,n,r,s){if(s&&s.global){t("event",n,r);return}else{const i=await e,o=Object.assign(Object.assign({},r),{send_to:i});t("event",n,o)}}async function f$(t,e,n,r){if(r&&r.global)return t("set",{screen_name:n}),Promise.resolve();{const s=await e;t("config",s,{update:!0,screen_name:n})}}async function p$(t,e,n,r){if(r&&r.global)return t("set",{user_id:n}),Promise.resolve();{const s=await e;t("config",s,{update:!0,user_id:n})}}async function g$(t,e,n,r){if(r&&r.global){const s={};for(const i of Object.keys(n))s[`user_properties.${i}`]=n[i];return t("set",s),Promise.resolve()}else{const s=await e;t("config",s,{update:!0,user_properties:n})}}async function m$(t,e){const n=await t;window[`ga-disable-${n}`]=!e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _$(){var t;if(In())try{await au()}catch(e){return qt.warn(Hn.create("indexeddb-unavailable",{errorInfo:(t=e)===null||t===void 0?void 0:t.toString()}).message),!1}else return qt.warn(Hn.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;return!0}async function y$(t,e,n,r,s,i,o){var a;const c=c$(t);c.then(f=>{n[f.measurementId]=f.appId,t.options.measurementId&&f.measurementId!==t.options.measurementId&&qt.warn(`The measurement ID in the local Firebase config (${t.options.measurementId}) does not match the measurement ID fetched from the server (${f.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(f=>qt.error(f)),e.push(c);const l=_$().then(f=>{if(f)return r.getId()}),[u,h]=await Promise.all([c,l]);t$()||QU(i,u.measurementId),s("js",new Date);const d=(a=o==null?void 0:o.config)!==null&&a!==void 0?a:{};return d[HU]="firebase",d.update=!0,h!=null&&(d[WU]=h),s("config",u.measurementId,d),u.measurementId}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class v${constructor(e){this.app=e}_delete(){return delete Zr[this.app.options.appId],Promise.resolve()}}let Zr={},Gb=[];const zb={};let wh="dataLayer",dC="gtag",Qb,cu,Xg=!1;function w$(t){if(Xg)throw Hn.create("already-initialized");t.dataLayerName&&(wh=t.dataLayerName),t.gtagName&&(dC=t.gtagName)}function b$(){const t=[];if(iu()&&t.push("This is a browser extension environment."),ef()||t.push("Cookies are not available."),t.length>0){const e=t.map((r,s)=>`(${s+1}) ${r}`).join(" "),n=Hn.create("invalid-analytics-context",{errorInfo:e});qt.warn(n.message)}}function I$(t,e,n){b$();const r=t.options.appId;if(!r)throw Hn.create("no-app-id");if(!t.options.apiKey)if(t.options.measurementId)qt.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${t.options.measurementId} provided in the "measurementId" field in the local Firebase config.`);else throw Hn.create("no-api-key");if(Zr[r]!=null)throw Hn.create("already-exists",{id:r});if(!Xg){YU(wh);const{wrappedGtag:i,gtagCore:o}=e$(Zr,Gb,zb,wh,dC);cu=i,Qb=o,Xg=!0}return Zr[r]=y$(t,Gb,zb,e,Qb,wh,n),new v$(t)}async function E$(){if(iu()||!ef()||!In())return!1;try{return await au()}catch{return!1}}function T$(t,e,n){t=A(t),f$(cu,Zr[t.app.options.appId],e,n).catch(r=>qt.error(r))}function S$(t,e,n){t=A(t),p$(cu,Zr[t.app.options.appId],e,n).catch(r=>qt.error(r))}function C$(t,e,n){t=A(t),g$(cu,Zr[t.app.options.appId],e,n).catch(r=>qt.error(r))}function A$(t,e){t=A(t),m$(Zr[t.app.options.appId],e).catch(n=>qt.error(n))}function fC(t,e,n,r){t=A(t),d$(cu,Zr[t.app.options.appId],e,n,r).catch(s=>qt.error(s))}const Yb="@firebase/analytics",Jb="0.8.0";function k$(){nt(new Ee(Hb,(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("installations-internal").getImmediate();return I$(r,s,n)},"PUBLIC")),nt(new Ee("analytics-internal",t,"PRIVATE")),Le(Yb,Jb),Le(Yb,Jb,"esm2017");function t(e){try{const n=e.getProvider(Hb).getImmediate();return{logEvent:(r,s,i)=>fC(n,r,s,i)}}catch(n){throw Hn.create("interop-component-reg-failed",{reason:n})}}}k$();const R$="@firebase/analytics-compat",N$="0.1.13";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pC{constructor(e,n){this.app=e,this._delegate=n}logEvent(e,n,r){fC(this._delegate,e,n,r)}setCurrentScreen(e,n){T$(this._delegate,e,n)}setUserId(e,n){S$(this._delegate,e,n)}setUserProperties(e,n){C$(this._delegate,e,n)}setAnalyticsCollectionEnabled(e){A$(this._delegate,e)}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Zg;(function(t){t.ADD_SHIPPING_INFO="add_shipping_info",t.ADD_PAYMENT_INFO="add_payment_info",t.ADD_TO_CART="add_to_cart",t.ADD_TO_WISHLIST="add_to_wishlist",t.BEGIN_CHECKOUT="begin_checkout",t.CHECKOUT_PROGRESS="checkout_progress",t.EXCEPTION="exception",t.GENERATE_LEAD="generate_lead",t.LOGIN="login",t.PAGE_VIEW="page_view",t.PURCHASE="purchase",t.REFUND="refund",t.REMOVE_FROM_CART="remove_from_cart",t.SCREEN_VIEW="screen_view",t.SEARCH="search",t.SELECT_CONTENT="select_content",t.SELECT_ITEM="select_item",t.SELECT_PROMOTION="select_promotion",t.SET_CHECKOUT_OPTION="set_checkout_option",t.SHARE="share",t.SIGN_UP="sign_up",t.TIMING_COMPLETE="timing_complete",t.VIEW_CART="view_cart",t.VIEW_ITEM="view_item",t.VIEW_ITEM_LIST="view_item_list",t.VIEW_PROMOTION="view_promotion",t.VIEW_SEARCH_RESULTS="view_search_results"})(Zg||(Zg={}));/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const P$=t=>{const e=t.getProvider("app-compat").getImmediate(),n=t.getProvider("analytics").getImmediate();return new pC(e,n)};function D$(){const t={Analytics:pC,settings:w$,isSupported:E$,EventName:Zg};ut.INTERNAL.registerComponent(new Ee("analytics-compat",P$,"PUBLIC").setServiceProps(t).setMultipleInstances(!0))}D$();ut.registerVersion(R$,N$);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gC=new Map,x$={activated:!1,tokenObservers:[]},O$={initialized:!1,enabled:!1};function Pt(t){return gC.get(t)||x$}function lr(t,e){gC.set(t,e)}function sf(){return O$}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const q_="https://content-firebaseappcheck.googleapis.com/v1",M$="exchangeRecaptchaV3Token",L$="exchangeRecaptchaEnterpriseToken",F$="exchangeDebugToken",Xb={OFFSET_DURATION:5*60*1e3,RETRIAL_MIN_WAIT:30*1e3,RETRIAL_MAX_WAIT:16*60*1e3},U$=24*60*60*1e3;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $${constructor(e,n,r,s,i){if(this.operation=e,this.retryPolicy=n,this.getWaitDuration=r,this.lowerBound=s,this.upperBound=i,this.pending=null,this.nextErrorWaitInterval=s,s>i)throw new Error("Proactive refresh lower bound greater than upper bound!")}start(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch(()=>{})}stop(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)}isRunning(){return!!this.pending}async process(e){this.stop();try{this.pending=new gt,await V$(this.getNextRun(e)),this.pending.resolve(),await this.pending.promise,this.pending=new gt,await this.operation(),this.pending.resolve(),await this.pending.promise,this.process(!0).catch(()=>{})}catch(n){this.retryPolicy(n)?this.process(!1).catch(()=>{}):this.stop()}}getNextRun(e){if(e)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();{const n=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),n}}}function V$(t){return new Promise(e=>{setTimeout(e,t)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const B$={["already-initialized"]:"You have already called initializeAppCheck() for FirebaseApp {$appName} with different options. To avoid this error, call initializeAppCheck() with the same options as when it was originally called. This will return the already initialized instance.",["use-before-activation"]:"App Check is being used before initializeAppCheck() is called for FirebaseApp {$appName}. Call initializeAppCheck() before instantiating other Firebase services.",["fetch-network-error"]:"Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.",["fetch-parse-error"]:"Fetch client could not parse response. Original error: {$originalErrorMessage}.",["fetch-status-error"]:"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.",["storage-open"]:"Error thrown when opening storage. Original error: {$originalErrorMessage}.",["storage-get"]:"Error thrown when reading from storage. Original error: {$originalErrorMessage}.",["storage-set"]:"Error thrown when writing to storage. Original error: {$originalErrorMessage}.",["recaptcha-error"]:"ReCAPTCHA error.",throttled:"Requests throttled due to {$httpStatus} error. Attempts allowed again after {$time}"},cn=new fn("appCheck","AppCheck",B$);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jh(t=!1){var e;return t?(e=self.grecaptcha)===null||e===void 0?void 0:e.enterprise:self.grecaptcha}function mC(t){if(!Pt(t).activated)throw cn.create("use-before-activation",{appName:t.name})}function j_(t){const e=Math.round(t/1e3),n=Math.floor(e/(3600*24)),r=Math.floor((e-n*3600*24)/3600),s=Math.floor((e-n*3600*24-r*3600)/60),i=e-n*3600*24-r*3600-s*60;let o="";return n&&(o+=Qu(n)+"d:"),r&&(o+=Qu(r)+"h:"),o+=Qu(s)+"m:"+Qu(i)+"s",o}function Qu(t){return t===0?"00":t>=10?t.toString():"0"+t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function K_({url:t,body:e},n){var r,s;const i={"Content-Type":"application/json"},o=n.getImmediate({optional:!0});if(o){const f=await o.getHeartbeatsHeader();f&&(i["X-Firebase-Client"]=f)}const a={method:"POST",body:JSON.stringify(e),headers:i};let c;try{c=await fetch(t,a)}catch(f){throw cn.create("fetch-network-error",{originalErrorMessage:(r=f)===null||r===void 0?void 0:r.message})}if(c.status!==200)throw cn.create("fetch-status-error",{httpStatus:c.status});let l;try{l=await c.json()}catch(f){throw cn.create("fetch-parse-error",{originalErrorMessage:(s=f)===null||s===void 0?void 0:s.message})}const u=l.ttl.match(/^([\d.]+)(s)$/);if(!u||!u[2]||isNaN(Number(u[1])))throw cn.create("fetch-parse-error",{originalErrorMessage:`ttl field (timeToLive) is not in standard Protobuf Duration format: ${l.ttl}`});const h=Number(u[1])*1e3,d=Date.now();return{token:l.token,expireTimeMillis:d+h,issuedAtTimeMillis:d}}function q$(t,e){const{projectId:n,appId:r,apiKey:s}=t.options;return{url:`${q_}/projects/${n}/apps/${r}:${M$}?key=${s}`,body:{recaptcha_v3_token:e}}}function j$(t,e){const{projectId:n,appId:r,apiKey:s}=t.options;return{url:`${q_}/projects/${n}/apps/${r}:${L$}?key=${s}`,body:{recaptcha_enterprise_token:e}}}function K$(t,e){const{projectId:n,appId:r,apiKey:s}=t.options;return{url:`${q_}/projects/${n}/apps/${r}:${F$}?key=${s}`,body:{debug_token:e}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const W$="firebase-app-check-database",H$=1,yl="firebase-app-check-store",_C="debug-token";let Yu=null;function yC(){return Yu||(Yu=new Promise((t,e)=>{var n;try{const r=indexedDB.open(W$,H$);r.onsuccess=s=>{t(s.target.result)},r.onerror=s=>{var i;e(cn.create("storage-open",{originalErrorMessage:(i=s.target.error)===null||i===void 0?void 0:i.message}))},r.onupgradeneeded=s=>{const i=s.target.result;switch(s.oldVersion){case 0:i.createObjectStore(yl,{keyPath:"compositeKey"})}}}catch(r){e(cn.create("storage-open",{originalErrorMessage:(n=r)===null||n===void 0?void 0:n.message}))}}),Yu)}function G$(t){return wC(bC(t))}function z$(t,e){return vC(bC(t),e)}function Q$(t){return vC(_C,t)}function Y$(){return wC(_C)}async function vC(t,e){const r=(await yC()).transaction(yl,"readwrite"),i=r.objectStore(yl).put({compositeKey:t,value:e});return new Promise((o,a)=>{i.onsuccess=c=>{o()},r.onerror=c=>{var l;a(cn.create("storage-set",{originalErrorMessage:(l=c.target.error)===null||l===void 0?void 0:l.message}))}})}async function wC(t){const n=(await yC()).transaction(yl,"readonly"),s=n.objectStore(yl).get(t);return new Promise((i,o)=>{s.onsuccess=a=>{const c=a.target.result;i(c?c.value:void 0)},n.onerror=a=>{var c;o(cn.create("storage-get",{originalErrorMessage:(c=a.target.error)===null||c===void 0?void 0:c.message}))}})}function bC(t){return`${t.options.appId}-${t.name}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vl=new Vr("@firebase/app-check");/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function J$(t){if(In()){let e;try{e=await G$(t)}catch(n){vl.warn(`Failed to read token from IndexedDB. Error: ${n}`)}return e}}function Zb(t,e){return In()?z$(t,e).catch(n=>{vl.warn(`Failed to write token to IndexedDB. Error: ${n}`)}):Promise.resolve()}async function X$(){let t;try{t=await Y$()}catch{}if(t)return t;{const e=qL();return Q$(e).catch(n=>vl.warn(`Failed to persist debug token to IndexedDB. Error: ${n}`)),e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function IC(){return sf().enabled}async function EC(){const t=sf();if(t.enabled&&t.token)return t.token.promise;throw Error(`
            Can't get debug token in production mode.
        `)}function Z$(){const t=PL(),e=sf();if(e.initialized=!0,typeof t.FIREBASE_APPCHECK_DEBUG_TOKEN!="string"&&t.FIREBASE_APPCHECK_DEBUG_TOKEN!==!0)return;e.enabled=!0;const n=new gt;e.token=n,typeof t.FIREBASE_APPCHECK_DEBUG_TOKEN=="string"?n.resolve(t.FIREBASE_APPCHECK_DEBUG_TOKEN):n.resolve(X$())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eV={error:"UNKNOWN_ERROR"};function tV(t){return Xd.encodeString(JSON.stringify(t),!1)}async function Kh(t,e=!1){const n=t.app;mC(n);const r=Pt(n);let s=r.token,i;if(!s){const c=await r.cachedTokenPromise;c&&Wh(c)&&(s=c)}if(!e&&s&&Wh(s))return{token:s.token};let o=!1;if(IC()){r.exchangeTokenPromise||(r.exchangeTokenPromise=K_(K$(n,await EC()),t.heartbeatServiceProvider).then(l=>(r.exchangeTokenPromise=void 0,l)),o=!0);const c=await r.exchangeTokenPromise;return await Zb(n,c),lr(n,Object.assign(Object.assign({},r),{token:c})),{token:c.token}}try{r.exchangeTokenPromise||(r.exchangeTokenPromise=r.provider.getToken().then(c=>(r.exchangeTokenPromise=void 0,c)),o=!0),s=await r.exchangeTokenPromise}catch(c){c.code==="appCheck/throttled"?vl.warn(c.message):vl.error(c),i=c}let a;return s?(a={token:s.token},lr(n,Object.assign(Object.assign({},r),{token:s})),await Zb(n,s)):a=rV(i),o&&TC(n,a),a}function W_(t,e,n,r){const{app:s}=t,i=Pt(s),o={next:n,error:r,type:e};if(lr(s,Object.assign(Object.assign({},i),{tokenObservers:[...i.tokenObservers,o]})),i.token&&Wh(i.token)){const a=i.token;Promise.resolve().then(()=>{n({token:a.token}),eI(t)}).catch(()=>{})}i.cachedTokenPromise.then(()=>eI(t))}function H_(t,e){const n=Pt(t),r=n.tokenObservers.filter(s=>s.next!==e);r.length===0&&n.tokenRefresher&&n.tokenRefresher.isRunning()&&n.tokenRefresher.stop(),lr(t,Object.assign(Object.assign({},n),{tokenObservers:r}))}function eI(t){const{app:e}=t,n=Pt(e);let r=n.tokenRefresher;r||(r=nV(t),lr(e,Object.assign(Object.assign({},n),{tokenRefresher:r}))),!r.isRunning()&&n.isTokenAutoRefreshEnabled&&r.start()}function nV(t){const{app:e}=t;return new $$(async()=>{const n=Pt(e);let r;if(n.token?r=await Kh(t,!0):r=await Kh(t),r.error)throw r.error},()=>!0,()=>{const n=Pt(e);if(n.token){let r=n.token.issuedAtTimeMillis+(n.token.expireTimeMillis-n.token.issuedAtTimeMillis)*.5+3e5;const s=n.token.expireTimeMillis-5*60*1e3;return r=Math.min(r,s),Math.max(0,r-Date.now())}else return 0},Xb.RETRIAL_MIN_WAIT,Xb.RETRIAL_MAX_WAIT)}function TC(t,e){const n=Pt(t).tokenObservers;for(const r of n)try{r.type==="EXTERNAL"&&e.error!=null?r.error(e.error):r.next(e)}catch{}}function Wh(t){return t.expireTimeMillis-Date.now()>0}function rV(t){return{token:tV(eV),error:t}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sV{constructor(e,n){this.app=e,this.heartbeatServiceProvider=n}_delete(){const{tokenObservers:e}=Pt(this.app);for(const n of e)H_(this.app,n.next);return Promise.resolve()}}function iV(t,e){return new sV(t,e)}function oV(t){return{getToken:e=>Kh(t,e),addTokenListener:e=>W_(t,"INTERNAL",e),removeTokenListener:e=>H_(t.app,e)}}const aV="@firebase/app-check",cV="0.5.11";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lV="https://www.google.com/recaptcha/api.js",uV="https://www.google.com/recaptcha/enterprise.js";function hV(t,e){const n=Pt(t),r=new gt;lr(t,Object.assign(Object.assign({},n),{reCAPTCHAState:{initialized:r}}));const s=SC(t),i=jh(!1);return i?Hh(t,e,i,s,r):pV(()=>{const o=jh(!1);if(!o)throw new Error("no recaptcha");Hh(t,e,o,s,r)}),r.promise}function dV(t,e){const n=Pt(t),r=new gt;lr(t,Object.assign(Object.assign({},n),{reCAPTCHAState:{initialized:r}}));const s=SC(t),i=jh(!0);return i?Hh(t,e,i,s,r):gV(()=>{const o=jh(!0);if(!o)throw new Error("no recaptcha");Hh(t,e,o,s,r)}),r.promise}function Hh(t,e,n,r,s){n.ready(()=>{fV(t,e,n,r),s.resolve(n)})}function SC(t){const e=`fire_app_check_${t.name}`,n=document.createElement("div");return n.id=e,n.style.display="none",document.body.appendChild(n),e}async function CC(t){mC(t);const n=await Pt(t).reCAPTCHAState.initialized.promise;return new Promise((r,s)=>{const i=Pt(t).reCAPTCHAState;n.ready(()=>{r(n.execute(i.widgetId,{action:"fire_app_check"}))})})}function fV(t,e,n,r){const s=n.render(r,{sitekey:e,size:"invisible"}),i=Pt(t);lr(t,Object.assign(Object.assign({},i),{reCAPTCHAState:Object.assign(Object.assign({},i.reCAPTCHAState),{widgetId:s})}))}function pV(t){const e=document.createElement("script");e.src=lV,e.onload=t,document.head.appendChild(e)}function gV(t){const e=document.createElement("script");e.src=uV,e.onload=t,document.head.appendChild(e)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wl{constructor(e){this._siteKey=e,this._throttleData=null}async getToken(){var e;kC(this._throttleData);const n=await CC(this._app).catch(s=>{throw cn.create("recaptcha-error")});let r;try{r=await K_(q$(this._app,n),this._heartbeatServiceProvider)}catch(s){throw s.code==="fetch-status-error"?(this._throttleData=AC(Number((e=s.customData)===null||e===void 0?void 0:e.httpStatus),this._throttleData),cn.create("throttled",{time:j_(this._throttleData.allowRequestsAfter-Date.now()),httpStatus:this._throttleData.httpStatus})):s}return this._throttleData=null,r}initialize(e){this._app=e,this._heartbeatServiceProvider=Io(e,"heartbeat"),hV(e,this._siteKey).catch(()=>{})}isEqual(e){return e instanceof wl?this._siteKey===e._siteKey:!1}}class of{constructor(e){this._siteKey=e,this._throttleData=null}async getToken(){var e;kC(this._throttleData);const n=await CC(this._app).catch(s=>{throw cn.create("recaptcha-error")});let r;try{r=await K_(j$(this._app,n),this._heartbeatServiceProvider)}catch(s){throw s.code==="fetch-status-error"?(this._throttleData=AC(Number((e=s.customData)===null||e===void 0?void 0:e.httpStatus),this._throttleData),cn.create("throttled",{time:j_(this._throttleData.allowRequestsAfter-Date.now()),httpStatus:this._throttleData.httpStatus})):s}return this._throttleData=null,r}initialize(e){this._app=e,this._heartbeatServiceProvider=Io(e,"heartbeat"),dV(e,this._siteKey).catch(()=>{})}isEqual(e){return e instanceof of?this._siteKey===e._siteKey:!1}}class bl{constructor(e){this._customProviderOptions=e}async getToken(){const e=await this._customProviderOptions.getToken(),n=ML(e.token),r=n!==null&&n<Date.now()&&n>0?n*1e3:Date.now();return Object.assign(Object.assign({},e),{issuedAtTimeMillis:r})}initialize(e){this._app=e}isEqual(e){return e instanceof bl?this._customProviderOptions.getToken.toString()===e._customProviderOptions.getToken.toString():!1}}function AC(t,e){if(t===404||t===403)return{backoffCount:1,allowRequestsAfter:Date.now()+U$,httpStatus:t};{const n=e?e.backoffCount:0,r=Vh(n,1e3,2);return{backoffCount:n+1,allowRequestsAfter:Date.now()+r,httpStatus:t}}}function kC(t){if(t&&Date.now()-t.allowRequestsAfter<=0)throw cn.create("throttled",{time:j_(t.allowRequestsAfter-Date.now()),httpStatus:t.httpStatus})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mV(t=F0(),e){t=A(t);const n=Io(t,"app-check");if(sf().initialized||Z$(),IC()&&EC().then(s=>console.log(`App Check debug token: ${s}. You will need to add it to your app's App Check settings in the Firebase console for it to work.`)),n.isInitialized()){const s=n.getImmediate(),i=n.getOptions();if(i.isTokenAutoRefreshEnabled===e.isTokenAutoRefreshEnabled&&i.provider.isEqual(e.provider))return s;throw cn.create("already-initialized",{appName:t.name})}const r=n.initialize({options:e});return _V(t,e.provider,e.isTokenAutoRefreshEnabled),Pt(t).isTokenAutoRefreshEnabled&&W_(r,"INTERNAL",()=>{}),r}function _V(t,e,n){const r=Pt(t),s=Object.assign(Object.assign({},r),{activated:!0});s.provider=e,s.cachedTokenPromise=J$(t).then(i=>(i&&Wh(i)&&(lr(t,Object.assign(Object.assign({},Pt(t)),{token:i})),TC(t,{token:i.token})),i)),s.isTokenAutoRefreshEnabled=n===void 0?t.automaticDataCollectionEnabled:n,lr(t,s),s.provider.initialize(t)}function yV(t,e){const n=t.app,r=Pt(n);r.tokenRefresher&&(e===!0?r.tokenRefresher.start():r.tokenRefresher.stop()),lr(n,Object.assign(Object.assign({},r),{isTokenAutoRefreshEnabled:e}))}async function vV(t,e){const n=await Kh(t,e);if(n.error)throw n.error;return{token:n.token}}function wV(t,e,n,r){let s=()=>{},i=()=>{};return e.next!=null?s=e.next.bind(e):s=e,e.error!=null?i=e.error.bind(e):n&&(i=n),W_(t,"EXTERNAL",s,i),()=>H_(t.app,s)}const bV="app-check",tI="app-check-internal";function IV(){nt(new Ee(bV,t=>{const e=t.getProvider("app").getImmediate(),n=t.getProvider("heartbeat");return iV(e,n)},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((t,e,n)=>{t.getProvider(tI).initialize()})),nt(new Ee(tI,t=>{const e=t.getProvider("app-check").getImmediate();return oV(e)},"PUBLIC").setInstantiationMode("EXPLICIT")),Le(aV,cV)}IV();const EV="@firebase/app-check-compat",TV="0.2.11";/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SV={["use-before-activation"]:"App Check is being used before activate() is called for FirebaseApp {$appName}. Call activate() before instantiating other Firebase services."},Lp=new fn("appCheck","AppCheck",SV);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CV{constructor(e){this.app=e}activate(e,n){let r;typeof e=="string"?r=new wl(e):e instanceof of||e instanceof wl||e instanceof bl?r=e:r=new bl({getToken:e.getToken}),this._delegate=mV(this.app,{provider:r,isTokenAutoRefreshEnabled:n})}setTokenAutoRefreshEnabled(e){if(!this._delegate)throw Lp.create("use-before-activation",{appName:this.app.name});yV(this._delegate,e)}getToken(e){if(!this._delegate)throw Lp.create("use-before-activation",{appName:this.app.name});return vV(this._delegate,e)}onTokenChanged(e,n,r){if(!this._delegate)throw Lp.create("use-before-activation",{appName:this.app.name});return wV(this._delegate,e,n)}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AV=t=>{const e=t.getProvider("app-compat").getImmediate();return new CV(e)};function kV(){ut.INTERNAL.registerComponent(new Ee("appCheck-compat",AV,"PUBLIC").setServiceProps({ReCaptchaEnterpriseProvider:of,ReCaptchaV3Provider:wl,CustomProvider:bl}))}kV();ut.registerVersion(EV,TV);function G_(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(t);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(t,r[s])&&(n[r[s]]=t[r[s]]);return n}const hc={FACEBOOK:"facebook.com",GITHUB:"github.com",GOOGLE:"google.com",PASSWORD:"password",PHONE:"phone",TWITTER:"twitter.com"},Lo={EMAIL_SIGNIN:"EMAIL_SIGNIN",PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:"REVERT_SECOND_FACTOR_ADDITION",VERIFY_AND_CHANGE_EMAIL:"VERIFY_AND_CHANGE_EMAIL",VERIFY_EMAIL:"VERIFY_EMAIL"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function RV(){return{["admin-restricted-operation"]:"This operation is restricted to administrators only.",["argument-error"]:"",["app-not-authorized"]:"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.",["app-not-installed"]:"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.",["captcha-check-failed"]:"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.",["code-expired"]:"The SMS code has expired. Please re-send the verification code to try again.",["cordova-not-ready"]:"Cordova framework is not ready.",["cors-unsupported"]:"This browser is not supported.",["credential-already-in-use"]:"This credential is already associated with a different user account.",["custom-token-mismatch"]:"The custom token corresponds to a different audience.",["requires-recent-login"]:"This operation is sensitive and requires recent authentication. Log in again before retrying this request.",["dependent-sdk-initialized-before-auth"]:"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK.",["dynamic-link-not-activated"]:"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.",["email-change-needs-verification"]:"Multi-factor users must always have a verified email.",["email-already-in-use"]:"The email address is already in use by another account.",["emulator-config-failed"]:'Auth instance has already been used to make a network call. Auth can no longer be configured to use the emulator. Try calling "connectAuthEmulator()" sooner.',["expired-action-code"]:"The action code has expired.",["cancelled-popup-request"]:"This operation has been cancelled due to another conflicting popup being opened.",["internal-error"]:"An internal AuthError has occurred.",["invalid-app-credential"]:"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.",["invalid-app-id"]:"The mobile app identifier is not registed for the current project.",["invalid-user-token"]:"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.",["invalid-auth-event"]:"An internal AuthError has occurred.",["invalid-verification-code"]:"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure to use the verification code provided by the user.",["invalid-continue-uri"]:"The continue URL provided in the request is invalid.",["invalid-cordova-configuration"]:"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.",["invalid-custom-token"]:"The custom token format is incorrect. Please check the documentation.",["invalid-dynamic-link-domain"]:"The provided dynamic link domain is not configured or authorized for the current project.",["invalid-email"]:"The email address is badly formatted.",["invalid-emulator-scheme"]:"Emulator URL must start with a valid scheme (http:// or https://).",["invalid-api-key"]:"Your API key is invalid, please check you have copied it correctly.",["invalid-cert-hash"]:"The SHA-1 certificate hash provided is invalid.",["invalid-credential"]:"The supplied auth credential is malformed or has expired.",["invalid-message-payload"]:"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.",["invalid-multi-factor-session"]:"The request does not contain a valid proof of first factor successful sign-in.",["invalid-oauth-provider"]:"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.",["invalid-oauth-client-id"]:"The OAuth client ID provided is either invalid or does not match the specified API key.",["unauthorized-domain"]:"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.",["invalid-action-code"]:"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.",["wrong-password"]:"The password is invalid or the user does not have a password.",["invalid-persistence-type"]:"The specified persistence type is invalid. It can only be local, session or none.",["invalid-phone-number"]:"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].",["invalid-provider-id"]:"The specified provider ID is invalid.",["invalid-recipient-email"]:"The email corresponding to this action failed to send as the provided recipient email address is invalid.",["invalid-sender"]:"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.",["invalid-verification-id"]:"The verification ID used to create the phone auth credential is invalid.",["invalid-tenant-id"]:"The Auth instance's tenant ID is invalid.",["login-blocked"]:"Login blocked by user-provided method: {$originalMessage}",["missing-android-pkg-name"]:"An Android Package Name must be provided if the Android App is required to be installed.",["auth-domain-config-required"]:"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.",["missing-app-credential"]:"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.",["missing-verification-code"]:"The phone auth credential was created with an empty SMS verification code.",["missing-continue-uri"]:"A continue URL must be provided in the request.",["missing-iframe-start"]:"An internal AuthError has occurred.",["missing-ios-bundle-id"]:"An iOS Bundle ID must be provided if an App Store ID is provided.",["missing-or-invalid-nonce"]:"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.",["missing-multi-factor-info"]:"No second factor identifier is provided.",["missing-multi-factor-session"]:"The request is missing proof of first factor successful sign-in.",["missing-phone-number"]:"To send verification codes, provide a phone number for the recipient.",["missing-verification-id"]:"The phone auth credential was created with an empty verification ID.",["app-deleted"]:"This instance of FirebaseApp has been deleted.",["multi-factor-info-not-found"]:"The user does not have a second factor matching the identifier provided.",["multi-factor-auth-required"]:"Proof of ownership of a second factor is required to complete sign-in.",["account-exists-with-different-credential"]:"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.",["network-request-failed"]:"A network AuthError (such as timeout, interrupted connection or unreachable host) has occurred.",["no-auth-event"]:"An internal AuthError has occurred.",["no-such-provider"]:"User was not linked to an account with the given provider.",["null-user"]:"A null user object was provided as the argument for an operation which requires a non-null user object.",["operation-not-allowed"]:"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.",["operation-not-supported-in-this-environment"]:'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',["popup-blocked"]:"Unable to establish a connection with the popup. It may have been blocked by the browser.",["popup-closed-by-user"]:"The popup has been closed by the user before finalizing the operation.",["provider-already-linked"]:"User can only be linked to one identity for the given provider.",["quota-exceeded"]:"The project's quota for this operation has been exceeded.",["redirect-cancelled-by-user"]:"The redirect operation has been cancelled by the user before finalizing.",["redirect-operation-pending"]:"A redirect sign-in operation is already pending.",["rejected-credential"]:"The request contains malformed or mismatching credentials.",["second-factor-already-in-use"]:"The second factor is already enrolled on this account.",["maximum-second-factor-count-exceeded"]:"The maximum allowed number of second factors on a user has been exceeded.",["tenant-id-mismatch"]:"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.",["user-token-expired"]:"The user's credential is no longer valid. The user must sign in again.",["too-many-requests"]:"We have blocked all requests from this device due to unusual activity. Try again later.",["unauthorized-continue-uri"]:"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.",["unsupported-first-factor"]:"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.",["unsupported-persistence-type"]:"The current environment does not support the specified persistence type.",["unsupported-tenant-operation"]:"This operation is not supported in a multi-tenant context.",["unverified-email"]:"The operation requires a verified email.",["user-cancelled"]:"The user did not grant your application the permissions it requested.",["user-not-found"]:"There is no user record corresponding to this identifier. The user may have been deleted.",["user-disabled"]:"The user account has been disabled by an administrator.",["user-mismatch"]:"The supplied credentials do not correspond to the previously signed in user.",["user-signed-out"]:"",["weak-password"]:"The password must be 6 characters long or more.",["web-storage-unsupported"]:"This browser is not supported or 3rd party cookies and data may be disabled.",["already-initialized"]:"initializeAuth() has already been called with different options. To avoid this error, call initializeAuth() with the same options as when it was originally called, or call getAuth() to return the already initialized instance."}}function RC(){return{["dependent-sdk-initialized-before-auth"]:"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const NV=RV,PV=RC,NC=new fn("auth","Firebase",RC());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nI=new Vr("@firebase/auth");function bh(t,...e){nI.logLevel<=de.ERROR&&nI.error(`Auth (${Br}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gt(t,...e){throw z_(t,...e)}function jt(t,...e){return z_(t,...e)}function PC(t,e,n){const r=Object.assign(Object.assign({},PV()),{[e]:n});return new fn("auth","Firebase",r).create(e,{appName:t.name})}function ja(t,e,n){const r=n;if(!(e instanceof r))throw r.name!==e.constructor.name&&Gt(t,"argument-error"),PC(t,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function z_(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return NC.create(t,...e)}function D(t,e,...n){if(!t)throw z_(e,...n)}function Er(t){const e="INTERNAL ASSERTION FAILED: "+t;throw bh(e),new Error(e)}function ur(t,e){t||Er(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rI=new Map;function Rn(t){ur(t instanceof Function,"Expected a class definition");let e=rI.get(t);return e?(ur(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,rI.set(t,e),e)}function DV(t,e){const n=(e==null?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map(Rn);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Il(){var t;return typeof self!="undefined"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function Q_(){return sI()==="http:"||sI()==="https:"}function sI(){var t;return typeof self!="undefined"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xV(){return typeof navigator!="undefined"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(Q_()||iu()||"connection"in navigator)?navigator.onLine:!0}function OV(){if(typeof navigator=="undefined")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lu{constructor(e,n){this.shortDelay=e,this.longDelay=n,ur(n>e,"Short delay should be less than long delay!"),this.isMobile=Zd()||ou()}get(){return xV()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Y_(t,e){ur(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DC{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self!="undefined"&&"fetch"in self)return self.fetch;Er("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self!="undefined"&&"Headers"in self)return self.Headers;Er("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self!="undefined"&&"Response"in self)return self.Response;Er("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MV={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"internal-error",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LV=new lu(3e4,6e4);function yt(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function Mt(t,e,n,r,s={}){return xC(t,s,async()=>{let i={},o={};r&&(e==="GET"?o=r:i={body:JSON.stringify(r)});const a=bo(Object.assign({key:t.config.apiKey},o)).slice(1),c=await t._getAdditionalHeaders();return c["Content-Type"]="application/json",t.languageCode&&(c["X-Firebase-Locale"]=t.languageCode),DC.fetch()(OC(t,t.config.apiHost,n,a),Object.assign({method:e,headers:c,referrerPolicy:"no-referrer"},i))})}async function xC(t,e,n){t._canInitEmulator=!1;const r=Object.assign(Object.assign({},MV),e);try{const s=new FV(t),i=await Promise.race([n(),s.promise]);s.clearNetworkTimeout();const o=await i.json();if("needConfirmation"in o)throw Rc(t,"account-exists-with-different-credential",o);if(i.ok&&!("errorMessage"in o))return o;{const a=i.ok?o.errorMessage:o.error.message,[c,l]=a.split(" : ");if(c==="FEDERATED_USER_ID_ALREADY_LINKED")throw Rc(t,"credential-already-in-use",o);if(c==="EMAIL_EXISTS")throw Rc(t,"email-already-in-use",o);if(c==="USER_DISABLED")throw Rc(t,"user-disabled",o);const u=r[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(l)throw PC(t,u,l);Gt(t,u)}}catch(s){if(s instanceof lt)throw s;Gt(t,"network-request-failed")}}async function us(t,e,n,r,s={}){const i=await Mt(t,e,n,r,s);return"mfaPendingCredential"in i&&Gt(t,"multi-factor-auth-required",{_serverResponse:i}),i}function OC(t,e,n,r){const s=`${e}${n}?${r}`;return t.config.emulator?Y_(t.config,s):`${t.config.apiScheme}://${s}`}class FV{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(jt(this.auth,"network-request-failed")),LV.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function Rc(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const s=jt(t,e,r);return s.customData._tokenResponse=n,s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function UV(t,e){return Mt(t,"POST","/v1/accounts:delete",e)}async function $V(t,e){return Mt(t,"POST","/v1/accounts:update",e)}async function VV(t,e){return Mt(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vc(t){if(!!t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function BV(t,e=!1){const n=A(t),r=await n.getIdToken(e),s=af(r);D(s&&s.exp&&s.auth_time&&s.iat,n.auth,"internal-error");const i=typeof s.firebase=="object"?s.firebase:void 0,o=i==null?void 0:i.sign_in_provider;return{claims:s,token:r,authTime:Vc(Fp(s.auth_time)),issuedAtTime:Vc(Fp(s.iat)),expirationTime:Vc(Fp(s.exp)),signInProvider:o||null,signInSecondFactor:(i==null?void 0:i.sign_in_second_factor)||null}}function Fp(t){return Number(t)*1e3}function af(t){var e;const[n,r,s]=t.split(".");if(n===void 0||r===void 0||s===void 0)return bh("JWT malformed, contained fewer than 3 sections"),null;try{const i=Hg(r);return i?JSON.parse(i):(bh("Failed to decode base64 JWT payload"),null)}catch(i){return bh("Caught error parsing JWT payload as JSON",(e=i)===null||e===void 0?void 0:e.toString()),null}}function qV(t){const e=af(t);return D(e,"internal-error"),D(typeof e.exp!="undefined","internal-error"),D(typeof e.iat!="undefined","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ss(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof lt&&jV(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function jV({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KV{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){!this.isRunning||(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var n;if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const s=((n=this.user.stsTokenManager.expirationTime)!==null&&n!==void 0?n:0)-Date.now()-3e5;return Math.max(0,s)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){var e;try{await this.user.getIdToken(!0)}catch(n){((e=n)===null||e===void 0?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MC{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=Vc(this.lastLoginAt),this.creationTime=Vc(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function El(t){var e;const n=t.auth,r=await t.getIdToken(),s=await ss(t,VV(n,{idToken:r}));D(s==null?void 0:s.users.length,n,"internal-error");const i=s.users[0];t._notifyReloadListener(i);const o=!((e=i.providerUserInfo)===null||e===void 0)&&e.length?GV(i.providerUserInfo):[],a=HV(t.providerData,o),c=t.isAnonymous,l=!(t.email&&i.passwordHash)&&!(a!=null&&a.length),u=c?l:!1,h={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:a,metadata:new MC(i.createdAt,i.lastLoginAt),isAnonymous:u};Object.assign(t,h)}async function WV(t){const e=A(t);await El(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function HV(t,e){return[...t.filter(r=>!e.some(s=>s.providerId===r.providerId)),...e]}function GV(t){return t.map(e=>{var{providerId:n}=e,r=G_(e,["providerId"]);return{providerId:n,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function zV(t,e){const n=await xC(t,{},async()=>{const r=bo({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:i}=t.config,o=OC(t,s,"/v1/token",`key=${i}`),a=await t._getAdditionalHeaders();return a["Content-Type"]="application/x-www-form-urlencoded",DC.fetch()(o,{method:"POST",headers:a,body:r})});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tl{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){D(e.idToken,"internal-error"),D(typeof e.idToken!="undefined","internal-error"),D(typeof e.refreshToken!="undefined","internal-error");const n="expiresIn"in e&&typeof e.expiresIn!="undefined"?Number(e.expiresIn):qV(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}async getToken(e,n=!1){return D(!this.accessToken||this.refreshToken,e,"user-token-expired"),!n&&this.accessToken&&!this.isExpired?this.accessToken:this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:s,expiresIn:i}=await zV(e,n);this.updateTokensAndExpiration(r,s,Number(i))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:s,expirationTime:i}=n,o=new Tl;return r&&(D(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),s&&(D(typeof s=="string","internal-error",{appName:e}),o.accessToken=s),i&&(D(typeof i=="number","internal-error",{appName:e}),o.expirationTime=i),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Tl,this.toJSON())}_performRefresh(){return Er("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bs(t,e){D(typeof t=="string"||typeof t=="undefined","internal-error",{appName:e})}class qi{constructor(e){var{uid:n,auth:r,stsTokenManager:s}=e,i=G_(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new KV(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=n,this.auth=r,this.stsTokenManager=s,this.accessToken=s.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new MC(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const n=await ss(this,this.stsTokenManager.getToken(this.auth,e));return D(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return BV(this,e)}reload(){return WV(this)}_assign(e){this!==e&&(D(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>Object.assign({},n)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){return new qi(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}))}_onReload(e){D(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await El(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){const e=await this.getIdToken();return await ss(this,UV(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){var r,s,i,o,a,c,l,u;const h=(r=n.displayName)!==null&&r!==void 0?r:void 0,d=(s=n.email)!==null&&s!==void 0?s:void 0,f=(i=n.phoneNumber)!==null&&i!==void 0?i:void 0,p=(o=n.photoURL)!==null&&o!==void 0?o:void 0,_=(a=n.tenantId)!==null&&a!==void 0?a:void 0,y=(c=n._redirectEventId)!==null&&c!==void 0?c:void 0,I=(l=n.createdAt)!==null&&l!==void 0?l:void 0,N=(u=n.lastLoginAt)!==null&&u!==void 0?u:void 0,{uid:k,emailVerified:M,isAnonymous:j,providerData:Y,stsTokenManager:z}=n;D(k&&z,e,"internal-error");const V=Tl.fromJSON(this.name,z);D(typeof k=="string",e,"internal-error"),bs(h,e.name),bs(d,e.name),D(typeof M=="boolean",e,"internal-error"),D(typeof j=="boolean",e,"internal-error"),bs(f,e.name),bs(p,e.name),bs(_,e.name),bs(y,e.name),bs(I,e.name),bs(N,e.name);const ie=new qi({uid:k,auth:e,email:d,emailVerified:M,displayName:h,isAnonymous:j,photoURL:p,phoneNumber:f,tenantId:_,stsTokenManager:V,createdAt:I,lastLoginAt:N});return Y&&Array.isArray(Y)&&(ie.providerData=Y.map(_e=>Object.assign({},_e))),y&&(ie._redirectEventId=y),ie}static async _fromIdTokenResponse(e,n,r=!1){const s=new Tl;s.updateFromServerResponse(n);const i=new qi({uid:n.localId,auth:e,stsTokenManager:s,isAnonymous:r});return await El(i),i}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LC{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}LC.type="NONE";const ya=LC;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ji(t,e,n){return`firebase:${t}:${e}:${n}`}class ta{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:s,name:i}=this.auth;this.fullUserKey=ji(this.userKey,s.apiKey,i),this.fullPersistenceKey=ji("persistence",s.apiKey,i),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?qi._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new ta(Rn(ya),e,r);const s=(await Promise.all(n.map(async l=>{if(await l._isAvailable())return l}))).filter(l=>l);let i=s[0]||Rn(ya);const o=ji(r,e.config.apiKey,e.name);let a=null;for(const l of n)try{const u=await l._get(o);if(u){const h=qi._fromJSON(e,u);l!==i&&(a=h),i=l;break}}catch{}const c=s.filter(l=>l._shouldAllowMigration);return!i._shouldAllowMigration||!c.length?new ta(i,e,r):(i=c[0],a&&await i._set(o,a.toJSON()),await Promise.all(n.map(async l=>{if(l!==i)try{await l._remove(o)}catch{}})),new ta(i,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iI(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if($C(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(FC(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(VC(e))return"Blackberry";if(BC(e))return"Webos";if(J_(e))return"Safari";if((e.includes("chrome/")||UC(e))&&!e.includes("edge/"))return"Chrome";if(uu(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function FC(t=We()){return/firefox\//i.test(t)}function J_(t=We()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function UC(t=We()){return/crios\//i.test(t)}function $C(t=We()){return/iemobile/i.test(t)}function uu(t=We()){return/android/i.test(t)}function VC(t=We()){return/blackberry/i.test(t)}function BC(t=We()){return/webos/i.test(t)}function Ka(t=We()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function QV(t=We()){return/(iPad|iPhone|iPod).*OS 7_\d/i.test(t)||/(iPad|iPhone|iPod).*OS 8_\d/i.test(t)}function YV(t=We()){var e;return Ka(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function JV(){return x_()&&document.documentMode===10}function qC(t=We()){return Ka(t)||uu(t)||BC(t)||VC(t)||/windows phone/i.test(t)||$C(t)}function XV(){try{return!!(window&&window!==window.top)}catch{return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jC(t,e=[]){let n;switch(t){case"Browser":n=iI(We());break;case"Worker":n=`${iI(We())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${Br}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZV{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=i=>new Promise((o,a)=>{try{const c=e(i);o(c)}catch(c){a(c)}});r.onAbort=n,this.queue.push(r);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){var n;if(this.auth.currentUser===e)return;const r=[];try{for(const s of this.queue)await s(e),s.onAbort&&r.push(s.onAbort)}catch(s){r.reverse();for(const i of r)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:(n=s)===null||n===void 0?void 0:n.message})}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eB{constructor(e,n,r){this.app=e,this.heartbeatServiceProvider=n,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new oI(this),this.idTokenSubscription=new oI(this),this.beforeStateQueue=new ZV(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=NC,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=r.sdkClientVersion}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=Rn(n)),this._initializationPromise=this.queue(async()=>{var r,s;if(!this._deleted&&(this.persistenceManager=await ta.create(this,e),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((s=this.currentUser)===null||s===void 0?void 0:s.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUser(e){var n;const r=await this.assertedPersistence.getCurrentUser();let s=r,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId,a=s==null?void 0:s._redirectEventId,c=await this.tryRedirectSignIn(e);(!o||o===a)&&(c==null?void 0:c.user)&&(s=c.user,i=!0)}if(!s)return this.directlySetCurrentUser(null);if(!s._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(s)}catch(o){s=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return s?this.reloadAndSetCurrentUserOrClear(s):this.directlySetCurrentUser(null)}return D(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===s._redirectEventId?this.directlySetCurrentUser(s):this.reloadAndSetCurrentUserOrClear(s)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){var n;try{await El(e)}catch(r){if(((n=r)===null||n===void 0?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=OV()}async _delete(){this._deleted=!0}async updateCurrentUser(e){const n=e?A(e):null;return n&&D(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&D(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0)}setPersistence(e){return this.queue(async()=>{await this.assertedPersistence.setPersistence(Rn(e))})}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new fn("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&Rn(e)||this._popupRedirectResolver;D(n,this,"argument-error"),this.redirectPersistenceManager=await ta.create(this,[Rn(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,r;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)===null||n===void 0?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const r=(n=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&n!==void 0?n:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,s){if(this._deleted)return()=>{};const i=typeof n=="function"?n:n.next.bind(n),o=this._isInitialized?Promise.resolve():this._initializationPromise;return D(o,this,"internal-error"),o.then(()=>i(this.currentUser)),typeof n=="function"?e.addObserver(n,r,s):e.addObserver(n)}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&(this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh()),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return D(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=jC(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const n={["X-Client-Version"]:this.clientVersion};this.app.options.appId&&(n["X-Firebase-gmpid"]=this.app.options.appId);const r=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());return r&&(n["X-Firebase-Client"]=r),n}}function Dt(t){return A(t)}class oI{constructor(e){this.auth=e,this.observer=null,this.addObserver=R0(n=>this.observer=n)}get next(){return D(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}function tB(t,e,n){const r=Dt(t);D(r._canInitEmulator,r,"emulator-config-failed"),D(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const s=!!(n!=null&&n.disableWarnings),i=KC(e),{host:o,port:a}=nB(e),c=a===null?"":`:${a}`;r.config.emulator={url:`${i}//${o}${c}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:o,port:a,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:s})}),s||rB()}function KC(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function nB(t){const e=KC(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(r);if(s){const i=s[1];return{host:i,port:aI(r.substr(i.length+1))}}else{const[i,o]=r.split(":");return{host:i,port:aI(o)}}}function aI(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function rB(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console!="undefined"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window!="undefined"&&typeof document!="undefined"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wa{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return Er("not implemented")}_getIdTokenResponse(e){return Er("not implemented")}_linkToIdToken(e,n){return Er("not implemented")}_getReauthenticationResolver(e){return Er("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function WC(t,e){return Mt(t,"POST","/v1/accounts:resetPassword",yt(t,e))}async function HC(t,e){return Mt(t,"POST","/v1/accounts:update",e)}async function sB(t,e){return Mt(t,"POST","/v1/accounts:update",yt(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function iB(t,e){return us(t,"POST","/v1/accounts:signInWithPassword",yt(t,e))}async function cf(t,e){return Mt(t,"POST","/v1/accounts:sendOobCode",yt(t,e))}async function oB(t,e){return cf(t,e)}async function aB(t,e){return cf(t,e)}async function cB(t,e){return cf(t,e)}async function lB(t,e){return cf(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function uB(t,e){return us(t,"POST","/v1/accounts:signInWithEmailLink",yt(t,e))}async function hB(t,e){return us(t,"POST","/v1/accounts:signInWithEmailLink",yt(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sl extends Wa{constructor(e,n,r,s=null){super("password",r),this._email=e,this._password=n,this._tenantId=s}static _fromEmailAndPassword(e,n){return new Sl(e,n,"password")}static _fromEmailAndCode(e,n,r=null){return new Sl(e,n,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;if((n==null?void 0:n.email)&&(n==null?void 0:n.password)){if(n.signInMethod==="password")return this._fromEmailAndPassword(n.email,n.password);if(n.signInMethod==="emailLink")return this._fromEmailAndCode(n.email,n.password,n.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":return iB(e,{returnSecureToken:!0,email:this._email,password:this._password});case"emailLink":return uB(e,{email:this._email,oobCode:this._password});default:Gt(e,"internal-error")}}async _linkToIdToken(e,n){switch(this.signInMethod){case"password":return HC(e,{idToken:n,returnSecureToken:!0,email:this._email,password:this._password});case"emailLink":return hB(e,{idToken:n,email:this._email,oobCode:this._password});default:Gt(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function es(t,e){return us(t,"POST","/v1/accounts:signInWithIdp",yt(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dB="http://localhost";class xr extends Wa{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new xr(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):Gt("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:s}=n,i=G_(n,["providerId","signInMethod"]);if(!r||!s)return null;const o=new xr(r,s);return o.idToken=i.idToken||void 0,o.accessToken=i.accessToken||void 0,o.secret=i.secret,o.nonce=i.nonce,o.pendingToken=i.pendingToken||null,o}_getIdTokenResponse(e){const n=this.buildRequest();return es(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,es(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,es(e,n)}buildRequest(){const e={requestUri:dB,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=bo(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function fB(t,e){return Mt(t,"POST","/v1/accounts:sendVerificationCode",yt(t,e))}async function pB(t,e){return us(t,"POST","/v1/accounts:signInWithPhoneNumber",yt(t,e))}async function gB(t,e){const n=await us(t,"POST","/v1/accounts:signInWithPhoneNumber",yt(t,e));if(n.temporaryProof)throw Rc(t,"account-exists-with-different-credential",n);return n}const mB={USER_NOT_FOUND:"user-not-found"};async function _B(t,e){const n=Object.assign(Object.assign({},e),{operation:"REAUTH"});return us(t,"POST","/v1/accounts:signInWithPhoneNumber",yt(t,n),mB)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ki extends Wa{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,n){return new Ki({verificationId:e,verificationCode:n})}static _fromTokenResponse(e,n){return new Ki({phoneNumber:e,temporaryProof:n})}_getIdTokenResponse(e){return pB(e,this._makeVerificationRequest())}_linkToIdToken(e,n){return gB(e,Object.assign({idToken:n},this._makeVerificationRequest()))}_getReauthenticationResolver(e){return _B(e,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:e,phoneNumber:n,verificationId:r,verificationCode:s}=this.params;return e&&n?{temporaryProof:e,phoneNumber:n}:{sessionInfo:r,code:s}}toJSON(){const e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){typeof e=="string"&&(e=JSON.parse(e));const{verificationId:n,verificationCode:r,phoneNumber:s,temporaryProof:i}=e;return!r&&!n&&!s&&!i?null:new Ki({verificationId:n,verificationCode:r,phoneNumber:s,temporaryProof:i})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yB(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function vB(t){const e=zo(kc(t)).link,n=e?zo(kc(e)).deep_link_id:null,r=zo(kc(t)).deep_link_id;return(r?zo(kc(r)).link:null)||r||n||e||t}class lf{constructor(e){var n,r,s,i,o,a;const c=zo(kc(e)),l=(n=c.apiKey)!==null&&n!==void 0?n:null,u=(r=c.oobCode)!==null&&r!==void 0?r:null,h=yB((s=c.mode)!==null&&s!==void 0?s:null);D(l&&u&&h,"argument-error"),this.apiKey=l,this.operation=h,this.code=u,this.continueUrl=(i=c.continueUrl)!==null&&i!==void 0?i:null,this.languageCode=(o=c.languageCode)!==null&&o!==void 0?o:null,this.tenantId=(a=c.tenantId)!==null&&a!==void 0?a:null}static parseLink(e){const n=vB(e);try{return new lf(n)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ii{constructor(){this.providerId=ii.PROVIDER_ID}static credential(e,n){return Sl._fromEmailAndPassword(e,n)}static credentialWithLink(e,n){const r=lf.parseLink(n);return D(r,"argument-error"),Sl._fromEmailAndCode(e,r.code,r.tenantId)}}ii.PROVIDER_ID="password";ii.EMAIL_PASSWORD_SIGN_IN_METHOD="password";ii.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hs{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ha extends hs{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class na extends Ha{static credentialFromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;return D("providerId"in n&&"signInMethod"in n,"argument-error"),xr._fromParams(n)}credential(e){return this._credential(Object.assign(Object.assign({},e),{nonce:e.rawNonce}))}_credential(e){return D(e.idToken||e.accessToken,"argument-error"),xr._fromParams(Object.assign(Object.assign({},e),{providerId:this.providerId,signInMethod:this.providerId}))}static credentialFromResult(e){return na.oauthCredentialFromTaggedObject(e)}static credentialFromError(e){return na.oauthCredentialFromTaggedObject(e.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r,oauthTokenSecret:s,pendingToken:i,nonce:o,providerId:a}=e;if(!r&&!s&&!n&&!i||!a)return null;try{return new na(a)._credential({idToken:n,accessToken:r,nonce:o,pendingToken:i})}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yr extends Ha{constructor(){super("facebook.com")}static credential(e){return xr._fromParams({providerId:yr.PROVIDER_ID,signInMethod:yr.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return yr.credentialFromTaggedObject(e)}static credentialFromError(e){return yr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return yr.credential(e.oauthAccessToken)}catch{return null}}}yr.FACEBOOK_SIGN_IN_METHOD="facebook.com";yr.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vr extends Ha{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return xr._fromParams({providerId:vr.PROVIDER_ID,signInMethod:vr.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return vr.credentialFromTaggedObject(e)}static credentialFromError(e){return vr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return vr.credential(n,r)}catch{return null}}}vr.GOOGLE_SIGN_IN_METHOD="google.com";vr.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wr extends Ha{constructor(){super("github.com")}static credential(e){return xr._fromParams({providerId:wr.PROVIDER_ID,signInMethod:wr.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return wr.credentialFromTaggedObject(e)}static credentialFromError(e){return wr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return wr.credential(e.oauthAccessToken)}catch{return null}}}wr.GITHUB_SIGN_IN_METHOD="github.com";wr.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wB="http://localhost";class va extends Wa{constructor(e,n){super(e,e),this.pendingToken=n}_getIdTokenResponse(e){const n=this.buildRequest();return es(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,es(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,es(e,n)}toJSON(){return{signInMethod:this.signInMethod,providerId:this.providerId,pendingToken:this.pendingToken}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:s,pendingToken:i}=n;return!r||!s||!i||r!==s?null:new va(r,i)}static _create(e,n){return new va(e,n)}buildRequest(){return{requestUri:wB,returnSecureToken:!0,pendingToken:this.pendingToken}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bB="saml.";class Gh extends hs{constructor(e){D(e.startsWith(bB),"argument-error"),super(e)}static credentialFromResult(e){return Gh.samlCredentialFromTaggedObject(e)}static credentialFromError(e){return Gh.samlCredentialFromTaggedObject(e.customData||{})}static credentialFromJSON(e){const n=va.fromJSON(e);return D(n,"argument-error"),n}static samlCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{pendingToken:n,providerId:r}=e;if(!n||!r)return null;try{return va._create(r,n)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class br extends Ha{constructor(){super("twitter.com")}static credential(e,n){return xr._fromParams({providerId:br.PROVIDER_ID,signInMethod:br.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return br.credentialFromTaggedObject(e)}static credentialFromError(e){return br.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return br.credential(n,r)}catch{return null}}}br.TWITTER_SIGN_IN_METHOD="twitter.com";br.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function GC(t,e){return us(t,"POST","/v1/accounts:signUp",yt(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gn{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,s=!1){const i=await qi._fromIdTokenResponse(e,r,s),o=cI(r);return new Gn({user:i,providerId:o,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const s=cI(r);return new Gn({user:e,providerId:s,_tokenResponse:r,operationType:n})}}function cI(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function IB(t){var e;const n=Dt(t);if(await n._initializationPromise,!((e=n.currentUser)===null||e===void 0)&&e.isAnonymous)return new Gn({user:n.currentUser,providerId:null,operationType:"signIn"});const r=await GC(n,{returnSecureToken:!0}),s=await Gn._fromIdTokenResponse(n,"signIn",r,!0);return await n._updateCurrentUser(s.user),s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zh extends lt{constructor(e,n,r,s){var i;super(n.code,n.message),this.operationType=r,this.user=s,Object.setPrototypeOf(this,zh.prototype),this.customData={appName:e.name,tenantId:(i=e.tenantId)!==null&&i!==void 0?i:void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,s){return new zh(e,n,r,s)}}function zC(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?zh._fromErrorAndOperation(t,i,e,r):i})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function QC(t){return new Set(t.map(({providerId:e})=>e).filter(e=>!!e))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function EB(t,e){const n=A(t);await uf(!0,n,e);const{providerUserInfo:r}=await $V(n.auth,{idToken:await n.getIdToken(),deleteProvider:[e]}),s=QC(r||[]);return n.providerData=n.providerData.filter(i=>s.has(i.providerId)),s.has("phone")||(n.phoneNumber=null),await n.auth._persistUserIfCurrent(n),n}async function X_(t,e,n=!1){const r=await ss(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return Gn._forOperation(t,"link",r)}async function uf(t,e,n){await El(e);const r=QC(e.providerData),s=t===!1?"provider-already-linked":"no-such-provider";D(r.has(n)===t,e.auth,s)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function YC(t,e,n=!1){var r;const{auth:s}=t,i="reauthenticate";try{const o=await ss(t,zC(s,i,e,t),n);D(o.idToken,s,"internal-error");const a=af(o.idToken);D(a,s,"internal-error");const{sub:c}=a;return D(t.uid===c,s,"user-mismatch"),Gn._forOperation(t,i,o)}catch(o){throw((r=o)===null||r===void 0?void 0:r.code)==="auth/user-not-found"&&Gt(s,"user-mismatch"),o}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function JC(t,e,n=!1){const r="signIn",s=await zC(t,r,e),i=await Gn._fromIdTokenResponse(t,r,s);return n||await t._updateCurrentUser(i.user),i}async function hf(t,e){return JC(Dt(t),e)}async function XC(t,e){const n=A(t);return await uf(!1,n,e.providerId),X_(n,e)}async function ZC(t,e){return YC(A(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function TB(t,e){return us(t,"POST","/v1/accounts:signInWithCustomToken",yt(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function SB(t,e){const n=Dt(t),r=await TB(n,{token:e,returnSecureToken:!0}),s=await Gn._fromIdTokenResponse(n,"signIn",r);return await n._updateCurrentUser(s.user),s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class df{constructor(e,n){this.factorId=e,this.uid=n.mfaEnrollmentId,this.enrollmentTime=new Date(n.enrolledAt).toUTCString(),this.displayName=n.displayName}static _fromServerResponse(e,n){return"phoneInfo"in n?Z_._fromServerResponse(e,n):Gt(e,"internal-error")}}class Z_ extends df{constructor(e){super("phone",e),this.phoneNumber=e.phoneInfo}static _fromServerResponse(e,n){return new Z_(n)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ff(t,e,n){var r;D(((r=n.url)===null||r===void 0?void 0:r.length)>0,t,"invalid-continue-uri"),D(typeof n.dynamicLinkDomain=="undefined"||n.dynamicLinkDomain.length>0,t,"invalid-dynamic-link-domain"),e.continueUrl=n.url,e.dynamicLinkDomain=n.dynamicLinkDomain,e.canHandleCodeInApp=n.handleCodeInApp,n.iOS&&(D(n.iOS.bundleId.length>0,t,"missing-ios-bundle-id"),e.iOSBundleId=n.iOS.bundleId),n.android&&(D(n.android.packageName.length>0,t,"missing-android-pkg-name"),e.androidInstallApp=n.android.installApp,e.androidMinimumVersionCode=n.android.minimumVersion,e.androidPackageName=n.android.packageName)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function CB(t,e,n){const r=A(t),s={requestType:"PASSWORD_RESET",email:e};n&&ff(r,s,n),await aB(r,s)}async function AB(t,e,n){await WC(A(t),{oobCode:e,newPassword:n})}async function kB(t,e){await sB(A(t),{oobCode:e})}async function eA(t,e){const n=A(t),r=await WC(n,{oobCode:e}),s=r.requestType;switch(D(s,n,"internal-error"),s){case"EMAIL_SIGNIN":break;case"VERIFY_AND_CHANGE_EMAIL":D(r.newEmail,n,"internal-error");break;case"REVERT_SECOND_FACTOR_ADDITION":D(r.mfaInfo,n,"internal-error");default:D(r.email,n,"internal-error")}let i=null;return r.mfaInfo&&(i=df._fromServerResponse(Dt(n),r.mfaInfo)),{data:{email:(r.requestType==="VERIFY_AND_CHANGE_EMAIL"?r.newEmail:r.email)||null,previousEmail:(r.requestType==="VERIFY_AND_CHANGE_EMAIL"?r.email:r.newEmail)||null,multiFactorInfo:i},operation:s}}async function RB(t,e){const{data:n}=await eA(A(t),e);return n.email}async function NB(t,e,n){const r=Dt(t),s=await GC(r,{returnSecureToken:!0,email:e,password:n}),i=await Gn._fromIdTokenResponse(r,"signIn",s);return await r._updateCurrentUser(i.user),i}function PB(t,e,n){return hf(A(t),ii.credential(e,n))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function DB(t,e,n){const r=A(t),s={requestType:"EMAIL_SIGNIN",email:e};D(n.handleCodeInApp,r,"argument-error"),n&&ff(r,s,n),await cB(r,s)}function xB(t,e){const n=lf.parseLink(e);return(n==null?void 0:n.operation)==="EMAIL_SIGNIN"}async function OB(t,e,n){const r=A(t),s=ii.credentialWithLink(e,n||Il());return D(s._tenantId===(r.tenantId||null),r,"tenant-id-mismatch"),hf(r,s)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function MB(t,e){return Mt(t,"POST","/v1/accounts:createAuthUri",yt(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function LB(t,e){const n=Q_()?Il():"http://localhost",r={identifier:e,continueUri:n},{signinMethods:s}=await MB(A(t),r);return s||[]}async function FB(t,e){const n=A(t),r=await t.getIdToken(),s={requestType:"VERIFY_EMAIL",idToken:r};e&&ff(n.auth,s,e);const{email:i}=await oB(n.auth,s);i!==t.email&&await t.reload()}async function UB(t,e,n){const r=A(t),s=await t.getIdToken(),i={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:s,newEmail:e};n&&ff(r.auth,i,n);const{email:o}=await lB(r.auth,i);o!==t.email&&await t.reload()}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function $B(t,e){return Mt(t,"POST","/v1/accounts:update",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function VB(t,{displayName:e,photoURL:n}){if(e===void 0&&n===void 0)return;const r=A(t),i={idToken:await r.getIdToken(),displayName:e,photoUrl:n,returnSecureToken:!0},o=await ss(r,$B(r.auth,i));r.displayName=o.displayName||null,r.photoURL=o.photoUrl||null;const a=r.providerData.find(({providerId:c})=>c==="password");a&&(a.displayName=r.displayName,a.photoURL=r.photoURL),await r._updateTokensIfNecessary(o)}function BB(t,e){return tA(A(t),e,null)}function qB(t,e){return tA(A(t),null,e)}async function tA(t,e,n){const{auth:r}=t,i={idToken:await t.getIdToken(),returnSecureToken:!0};e&&(i.email=e),n&&(i.password=n);const o=await ss(t,HC(r,i));await t._updateTokensIfNecessary(o,!0)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jB(t){var e,n;if(!t)return null;const{providerId:r}=t,s=t.rawUserInfo?JSON.parse(t.rawUserInfo):{},i=t.isNewUser||t.kind==="identitytoolkit#SignupNewUserResponse";if(!r&&(t==null?void 0:t.idToken)){const o=(n=(e=af(t.idToken))===null||e===void 0?void 0:e.firebase)===null||n===void 0?void 0:n.sign_in_provider;if(o){const a=o!=="anonymous"&&o!=="custom"?o:null;return new ra(i,a)}}if(!r)return null;switch(r){case"facebook.com":return new KB(i,s);case"github.com":return new WB(i,s);case"google.com":return new HB(i,s);case"twitter.com":return new GB(i,s,t.screenName||null);case"custom":case"anonymous":return new ra(i,null);default:return new ra(i,r,s)}}class ra{constructor(e,n,r={}){this.isNewUser=e,this.providerId=n,this.profile=r}}class nA extends ra{constructor(e,n,r,s){super(e,n,r),this.username=s}}class KB extends ra{constructor(e,n){super(e,"facebook.com",n)}}class WB extends nA{constructor(e,n){super(e,"github.com",n,typeof(n==null?void 0:n.login)=="string"?n==null?void 0:n.login:null)}}class HB extends ra{constructor(e,n){super(e,"google.com",n)}}class GB extends nA{constructor(e,n,r){super(e,"twitter.com",n,r)}}function zB(t){const{user:e,_tokenResponse:n}=t;return e.isAnonymous&&!n?{providerId:null,isNewUser:!1,profile:null}:jB(n)}class Oi{constructor(e,n){this.type=e,this.credential=n}static _fromIdtoken(e){return new Oi("enroll",e)}static _fromMfaPendingCredential(e){return new Oi("signin",e)}toJSON(){return{multiFactorSession:{[this.type==="enroll"?"idToken":"pendingCredential"]:this.credential}}}static fromJSON(e){var n,r;if(e!=null&&e.multiFactorSession){if(!((n=e.multiFactorSession)===null||n===void 0)&&n.pendingCredential)return Oi._fromMfaPendingCredential(e.multiFactorSession.pendingCredential);if(!((r=e.multiFactorSession)===null||r===void 0)&&r.idToken)return Oi._fromIdtoken(e.multiFactorSession.idToken)}return null}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ey{constructor(e,n,r){this.session=e,this.hints=n,this.signInResolver=r}static _fromError(e,n){const r=Dt(e),s=n.customData._serverResponse,i=(s.mfaInfo||[]).map(a=>df._fromServerResponse(r,a));D(s.mfaPendingCredential,r,"internal-error");const o=Oi._fromMfaPendingCredential(s.mfaPendingCredential);return new ey(o,i,async a=>{const c=await a._process(r,o);delete s.mfaInfo,delete s.mfaPendingCredential;const l=Object.assign(Object.assign({},s),{idToken:c.idToken,refreshToken:c.refreshToken});switch(n.operationType){case"signIn":const u=await Gn._fromIdTokenResponse(r,n.operationType,l);return await r._updateCurrentUser(u.user),u;case"reauthenticate":return D(n.user,r,"internal-error"),Gn._forOperation(n.user,n.operationType,l);default:Gt(r,"internal-error")}})}async resolveSignIn(e){const n=e;return this.signInResolver(n)}}function QB(t,e){var n;const r=A(t),s=e;return D(e.customData.operationType,r,"argument-error"),D((n=s.customData._serverResponse)===null||n===void 0?void 0:n.mfaPendingCredential,r,"argument-error"),ey._fromError(r,s)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function YB(t,e){return Mt(t,"POST","/v2/accounts/mfaEnrollment:start",yt(t,e))}function JB(t,e){return Mt(t,"POST","/v2/accounts/mfaEnrollment:finalize",yt(t,e))}function XB(t,e){return Mt(t,"POST","/v2/accounts/mfaEnrollment:withdraw",yt(t,e))}class ty{constructor(e){this.user=e,this.enrolledFactors=[],e._onReload(n=>{n.mfaInfo&&(this.enrolledFactors=n.mfaInfo.map(r=>df._fromServerResponse(e.auth,r)))})}static _fromUser(e){return new ty(e)}async getSession(){return Oi._fromIdtoken(await this.user.getIdToken())}async enroll(e,n){const r=e,s=await this.getSession(),i=await ss(this.user,r._process(this.user.auth,s,n));return await this.user._updateTokensIfNecessary(i),this.user.reload()}async unenroll(e){var n;const r=typeof e=="string"?e:e.uid,s=await this.user.getIdToken(),i=await ss(this.user,XB(this.user.auth,{idToken:s,mfaEnrollmentId:r}));this.enrolledFactors=this.enrolledFactors.filter(({uid:o})=>o!==r),await this.user._updateTokensIfNecessary(i);try{await this.user.reload()}catch(o){if(((n=o)===null||n===void 0?void 0:n.code)!=="auth/user-token-expired")throw o}}}const Up=new WeakMap;function ZB(t){const e=A(t);return Up.has(e)||Up.set(e,ty._fromUser(e)),Up.get(e)}const Qh="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rA{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(Qh,"1"),this.storage.removeItem(Qh),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eq(){const t=We();return J_(t)||Ka(t)}const tq=1e3,nq=10;class sA extends rA{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=eq()&&XV(),this.fallbackToPolling=qC(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),s=this.localCache[n];r!==s&&e(n,s,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((o,a,c)=>{this.notifyListeners(o,c)});return}const r=e.key;if(n?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const o=this.storage.getItem(r);if(e.newValue!==o)e.newValue!==null?this.storage.setItem(r,e.newValue):this.storage.removeItem(r);else if(this.localCache[r]===e.newValue&&!n)return}const s=()=>{const o=this.storage.getItem(r);!n&&this.localCache[r]===o||this.notifyListeners(r,o)},i=this.storage.getItem(r);JV()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,nq):s()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},tq)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}sA.type="LOCAL";const ny=sA;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iA extends rA{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}iA.type="SESSION";const Ji=iA;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rq(t){return Promise.all(t.map(async e=>{try{const n=await e;return{fulfilled:!0,value:n}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pf{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(s=>s.isListeningto(e));if(n)return n;const r=new pf(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:s,data:i}=n.data,o=this.handlersMap[s];if(!(o!=null&&o.size))return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:s});const a=Array.from(o).map(async l=>l(n.origin,i)),c=await rq(a);n.ports[0].postMessage({status:"done",eventId:r,eventType:s,response:c})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}pf.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hu(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sq{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const s=typeof MessageChannel!="undefined"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let i,o;return new Promise((a,c)=>{const l=hu("",20);s.port1.start();const u=setTimeout(()=>{c(new Error("unsupported_event"))},r);o={messageChannel:s,onMessage(h){const d=h;if(d.data.eventId===l)switch(d.data.status){case"ack":clearTimeout(u),i=setTimeout(()=>{c(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),a(d.data.response);break;default:clearTimeout(u),clearTimeout(i),c(new Error("invalid_response"));break}}},this.handlers.add(o),s.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:l,data:n},[s.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pt(){return window}function iq(t){pt().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ry(){return typeof pt().WorkerGlobalScope!="undefined"&&typeof pt().importScripts=="function"}async function oq(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function aq(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function cq(){return ry()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oA="firebaseLocalStorageDb",lq=1,Yh="firebaseLocalStorage",aA="fbase_key";class du{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function gf(t,e){return t.transaction([Yh],e?"readwrite":"readonly").objectStore(Yh)}function uq(){const t=indexedDB.deleteDatabase(oA);return new du(t).toPromise()}function em(){const t=indexedDB.open(oA,lq);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(Yh,{keyPath:aA})}catch(s){n(s)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains(Yh)?e(r):(r.close(),await uq(),e(await em()))})})}async function lI(t,e,n){const r=gf(t,!0).put({[aA]:e,value:n});return new du(r).toPromise()}async function hq(t,e){const n=gf(t,!1).get(e),r=await new du(n).toPromise();return r===void 0?null:r.value}function uI(t,e){const n=gf(t,!0).delete(e);return new du(n).toPromise()}const dq=800,fq=3;class cA{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await em(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>fq)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return ry()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=pf._getInstance(cq()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var e,n;if(this.activeServiceWorker=await oq(),!this.activeServiceWorker)return;this.sender=new sq(this.activeServiceWorker);const r=await this.sender._send("ping",{},800);!r||((e=r[0])===null||e===void 0?void 0:e.fulfilled)&&((n=r[0])===null||n===void 0?void 0:n.value.includes("keyChanged"))&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||aq()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await em();return await lI(e,Qh,"1"),await uI(e,Qh),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>lI(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>hq(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>uI(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const i=gf(s,!1).getAll();return new du(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;for(const{fbase_key:s,value:i}of e)r.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(i)&&(this.notifyListeners(s,i),n.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!r.has(s)&&(this.notifyListeners(s,null),n.push(s));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),dq)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}cA.type="LOCAL";const Cl=cA;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pq(t,e){return Mt(t,"POST","/v2/accounts/mfaSignIn:start",yt(t,e))}function gq(t,e){return Mt(t,"POST","/v2/accounts/mfaSignIn:finalize",yt(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function mq(t){return(await Mt(t,"GET","/v1/recaptchaParams")).recaptchaSiteKey||""}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _q(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}function lA(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=s=>{const i=jt("internal-error");i.customData=s,n(i)},r.type="text/javascript",r.charset="UTF-8",_q().appendChild(r)})}function uA(t){return`__${t}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yq=500,vq=6e4,Ju=1e12;class wq{constructor(e){this.auth=e,this.counter=Ju,this._widgets=new Map}render(e,n){const r=this.counter;return this._widgets.set(r,new bq(e,this.auth.name,n||{})),this.counter++,r}reset(e){var n;const r=e||Ju;(n=this._widgets.get(r))===null||n===void 0||n.delete(),this._widgets.delete(r)}getResponse(e){var n;const r=e||Ju;return((n=this._widgets.get(r))===null||n===void 0?void 0:n.getResponse())||""}async execute(e){var n;const r=e||Ju;return(n=this._widgets.get(r))===null||n===void 0||n.execute(),""}}class bq{constructor(e,n,r){this.params=r,this.timerId=null,this.deleted=!1,this.responseToken=null,this.clickHandler=()=>{this.execute()};const s=typeof e=="string"?document.getElementById(e):e;D(s,"argument-error",{appName:n}),this.container=s,this.isVisible=this.params.size!=="invisible",this.isVisible?this.execute():this.container.addEventListener("click",this.clickHandler)}getResponse(){return this.checkIfDeleted(),this.responseToken}delete(){this.checkIfDeleted(),this.deleted=!0,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.container.removeEventListener("click",this.clickHandler)}execute(){this.checkIfDeleted(),!this.timerId&&(this.timerId=window.setTimeout(()=>{this.responseToken=Iq(50);const{callback:e,"expired-callback":n}=this.params;if(e)try{e(this.responseToken)}catch{}this.timerId=window.setTimeout(()=>{if(this.timerId=null,this.responseToken=null,n)try{n()}catch{}this.isVisible&&this.execute()},vq)},yq))}checkIfDeleted(){if(this.deleted)throw new Error("reCAPTCHA mock was already deleted!")}}function Iq(t){const e=[],n="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let r=0;r<t;r++)e.push(n.charAt(Math.floor(Math.random()*n.length)));return e.join("")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $p=uA("rcb"),Eq=new lu(3e4,6e4),Tq="https://www.google.com/recaptcha/api.js?";class Sq{constructor(){var e;this.hostLanguage="",this.counter=0,this.librarySeparatelyLoaded=!!(!((e=pt().grecaptcha)===null||e===void 0)&&e.render)}load(e,n=""){return D(Cq(n),e,"argument-error"),this.shouldResolveImmediately(n)?Promise.resolve(pt().grecaptcha):new Promise((r,s)=>{const i=pt().setTimeout(()=>{s(jt(e,"network-request-failed"))},Eq.get());pt()[$p]=()=>{pt().clearTimeout(i),delete pt()[$p];const a=pt().grecaptcha;if(!a){s(jt(e,"internal-error"));return}const c=a.render;a.render=(l,u)=>{const h=c(l,u);return this.counter++,h},this.hostLanguage=n,r(a)};const o=`${Tq}?${bo({onload:$p,render:"explicit",hl:n})}`;lA(o).catch(()=>{clearTimeout(i),s(jt(e,"internal-error"))})})}clearedOneInstance(){this.counter--}shouldResolveImmediately(e){var n;return!!(!((n=pt().grecaptcha)===null||n===void 0)&&n.render)&&(e===this.hostLanguage||this.counter>0||this.librarySeparatelyLoaded)}}function Cq(t){return t.length<=6&&/^\s*[a-zA-Z0-9\-]*\s*$/.test(t)}class Aq{async load(e){return new wq(e)}clearedOneInstance(){}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hA="recaptcha",kq={theme:"light",type:"image"};class Rq{constructor(e,n=Object.assign({},kq),r){this.parameters=n,this.type=hA,this.destroyed=!1,this.widgetId=null,this.tokenChangeListeners=new Set,this.renderPromise=null,this.recaptcha=null,this.auth=Dt(r),this.isInvisible=this.parameters.size==="invisible",D(typeof document!="undefined",this.auth,"operation-not-supported-in-this-environment");const s=typeof e=="string"?document.getElementById(e):e;D(s,this.auth,"argument-error"),this.container=s,this.parameters.callback=this.makeTokenCallback(this.parameters.callback),this._recaptchaLoader=this.auth.settings.appVerificationDisabledForTesting?new Aq:new Sq,this.validateStartingState()}async verify(){this.assertNotDestroyed();const e=await this.render(),n=this.getAssertedRecaptcha(),r=n.getResponse(e);return r||new Promise(s=>{const i=o=>{!o||(this.tokenChangeListeners.delete(i),s(o))};this.tokenChangeListeners.add(i),this.isInvisible&&n.execute(e)})}render(){try{this.assertNotDestroyed()}catch(e){return Promise.reject(e)}return this.renderPromise?this.renderPromise:(this.renderPromise=this.makeRenderPromise().catch(e=>{throw this.renderPromise=null,e}),this.renderPromise)}_reset(){this.assertNotDestroyed(),this.widgetId!==null&&this.getAssertedRecaptcha().reset(this.widgetId)}clear(){this.assertNotDestroyed(),this.destroyed=!0,this._recaptchaLoader.clearedOneInstance(),this.isInvisible||this.container.childNodes.forEach(e=>{this.container.removeChild(e)})}validateStartingState(){D(!this.parameters.sitekey,this.auth,"argument-error"),D(this.isInvisible||!this.container.hasChildNodes(),this.auth,"argument-error"),D(typeof document!="undefined",this.auth,"operation-not-supported-in-this-environment")}makeTokenCallback(e){return n=>{if(this.tokenChangeListeners.forEach(r=>r(n)),typeof e=="function")e(n);else if(typeof e=="string"){const r=pt()[e];typeof r=="function"&&r(n)}}}assertNotDestroyed(){D(!this.destroyed,this.auth,"internal-error")}async makeRenderPromise(){if(await this.init(),!this.widgetId){let e=this.container;if(!this.isInvisible){const n=document.createElement("div");e.appendChild(n),e=n}this.widgetId=this.getAssertedRecaptcha().render(e,this.parameters)}return this.widgetId}async init(){D(Q_()&&!ry(),this.auth,"internal-error"),await Nq(),this.recaptcha=await this._recaptchaLoader.load(this.auth,this.auth.languageCode||void 0);const e=await mq(this.auth);D(e,this.auth,"internal-error"),this.parameters.sitekey=e}getAssertedRecaptcha(){return D(this.recaptcha,this.auth,"internal-error"),this.recaptcha}}function Nq(){let t=null;return new Promise(e=>{if(document.readyState==="complete"){e();return}t=()=>e(),window.addEventListener("load",t)}).catch(e=>{throw t&&window.removeEventListener("load",t),e})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sy{constructor(e,n){this.verificationId=e,this.onConfirmation=n}confirm(e){const n=Ki._fromVerification(this.verificationId,e);return this.onConfirmation(n)}}async function Pq(t,e,n){const r=Dt(t),s=await mf(r,e,A(n));return new sy(s,i=>hf(r,i))}async function Dq(t,e,n){const r=A(t);await uf(!1,r,"phone");const s=await mf(r.auth,e,A(n));return new sy(s,i=>XC(r,i))}async function xq(t,e,n){const r=A(t),s=await mf(r.auth,e,A(n));return new sy(s,i=>ZC(r,i))}async function mf(t,e,n){var r;const s=await n.verify();try{D(typeof s=="string",t,"argument-error"),D(n.type===hA,t,"argument-error");let i;if(typeof e=="string"?i={phoneNumber:e}:i=e,"session"in i){const o=i.session;if("phoneNumber"in i)return D(o.type==="enroll",t,"internal-error"),(await YB(t,{idToken:o.credential,phoneEnrollmentInfo:{phoneNumber:i.phoneNumber,recaptchaToken:s}})).phoneSessionInfo.sessionInfo;{D(o.type==="signin",t,"internal-error");const a=((r=i.multiFactorHint)===null||r===void 0?void 0:r.uid)||i.multiFactorUid;return D(a,t,"missing-multi-factor-info"),(await pq(t,{mfaPendingCredential:o.credential,mfaEnrollmentId:a,phoneSignInInfo:{recaptchaToken:s}})).phoneResponseInfo.sessionInfo}}else{const{sessionInfo:o}=await fB(t,{phoneNumber:i.phoneNumber,recaptchaToken:s});return o}}finally{n._reset()}}async function Oq(t,e){await X_(A(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ar{constructor(e){this.providerId=ar.PROVIDER_ID,this.auth=Dt(e)}verifyPhoneNumber(e,n){return mf(this.auth,e,A(n))}static credential(e,n){return Ki._fromVerification(e,n)}static credentialFromResult(e){const n=e;return ar.credentialFromTaggedObject(n)}static credentialFromError(e){return ar.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{phoneNumber:n,temporaryProof:r}=e;return n&&r?Ki._fromTokenResponse(n,r):null}}ar.PROVIDER_ID="phone";ar.PHONE_SIGN_IN_METHOD="phone";/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Eo(t,e){return e?Rn(e):(D(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iy extends Wa{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return es(e,this._buildIdpRequest())}_linkToIdToken(e,n){return es(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return es(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function Mq(t){return JC(t.auth,new iy(t),t.bypassAuthState)}function Lq(t){const{auth:e,user:n}=t;return D(n,e,"internal-error"),YC(n,new iy(t),t.bypassAuthState)}async function Fq(t){const{auth:e,user:n}=t;return D(n,e,"internal-error"),X_(n,new iy(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dA{constructor(e,n,r,s,i=!1){this.auth=e,this.resolver=r,this.user=s,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:s,tenantId:i,error:o,type:a}=e;if(o){this.reject(o);return}const c={auth:this.auth,requestUri:n,sessionId:r,tenantId:i||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(c))}catch(l){this.reject(l)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return Mq;case"linkViaPopup":case"linkViaRedirect":return Fq;case"reauthViaPopup":case"reauthViaRedirect":return Lq;default:Gt(this.auth,"internal-error")}}resolve(e){ur(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){ur(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Uq=new lu(2e3,1e4);async function $q(t,e,n){const r=Dt(t);ja(t,e,hs);const s=Eo(r,n);return new zr(r,"signInViaPopup",e,s).executeNotNull()}async function Vq(t,e,n){const r=A(t);ja(r.auth,e,hs);const s=Eo(r.auth,n);return new zr(r.auth,"reauthViaPopup",e,s,r).executeNotNull()}async function Bq(t,e,n){const r=A(t);ja(r.auth,e,hs);const s=Eo(r.auth,n);return new zr(r.auth,"linkViaPopup",e,s,r).executeNotNull()}class zr extends dA{constructor(e,n,r,s,i){super(e,n,s,i),this.provider=r,this.authWindow=null,this.pollId=null,zr.currentPopupAction&&zr.currentPopupAction.cancel(),zr.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return D(e,this.auth,"internal-error"),e}async onExecution(){ur(this.filter.length===1,"Popup operations only handle one event");const e=hu();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(jt(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(jt(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,zr.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,r;if(!((r=(n=this.authWindow)===null||n===void 0?void 0:n.window)===null||r===void 0)&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(jt(this.auth,"popup-closed-by-user"))},2e3);return}this.pollId=window.setTimeout(e,Uq.get())};e()}}zr.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qq="pendingRedirect",Bc=new Map;class jq extends dA{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=Bc.get(this.auth._key());if(!e){try{const r=await Kq(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}Bc.set(this.auth._key(),e)}return this.bypassAuthState||Bc.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function Kq(t,e){const n=pA(e),r=fA(t);if(!await r._isAvailable())return!1;const s=await r._get(n)==="true";return await r._remove(n),s}async function oy(t,e){return fA(t)._set(pA(e),"true")}function Wq(){Bc.clear()}function ay(t,e){Bc.set(t._key(),e)}function fA(t){return Rn(t._redirectPersistence)}function pA(t){return ji(qq,t.config.apiKey,t.name)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hq(t,e,n){return Gq(t,e,n)}async function Gq(t,e,n){const r=Dt(t);ja(t,e,hs);const s=Eo(r,n);return await oy(s,r),s._openRedirect(r,e,"signInViaRedirect")}function zq(t,e,n){return Qq(t,e,n)}async function Qq(t,e,n){const r=A(t);ja(r.auth,e,hs);const s=Eo(r.auth,n);await oy(s,r.auth);const i=await gA(r);return s._openRedirect(r.auth,e,"reauthViaRedirect",i)}function Yq(t,e,n){return Jq(t,e,n)}async function Jq(t,e,n){const r=A(t);ja(r.auth,e,hs);const s=Eo(r.auth,n);await uf(!1,r,e.providerId),await oy(s,r.auth);const i=await gA(r);return s._openRedirect(r.auth,e,"linkViaRedirect",i)}async function Xq(t,e){return await Dt(t)._initializationPromise,_f(t,e,!1)}async function _f(t,e,n=!1){const r=Dt(t),s=Eo(r,e),o=await new jq(r,s,n).execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}async function gA(t){const e=hu(`${t.uid}:::`);return t._redirectEventId=e,await t.auth._setRedirectUser(t),await t.auth._persistUserIfCurrent(t),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zq=10*60*1e3;class mA{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!ej(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var r;if(e.error&&!_A(e)){const s=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";n.onError(jt(this.auth,s))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=Zq&&this.cachedEventUids.clear(),this.cachedEventUids.has(hI(e))}saveEventToCache(e){this.cachedEventUids.add(hI(e)),this.lastProcessedEventTime=Date.now()}}function hI(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function _A({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function ej(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return _A(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function yA(t,e={}){return Mt(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tj=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,nj=/^https?/;async function rj(t){if(t.config.emulator)return;const{authorizedDomains:e}=await yA(t);for(const n of e)try{if(sj(n))return}catch{}Gt(t,"unauthorized-domain")}function sj(t){const e=Il(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&o.hostname===r}if(!nj.test(n))return!1;if(tj.test(t))return r===t;const s=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ij=new lu(3e4,6e4);function dI(){const t=pt().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function oj(t){return new Promise((e,n)=>{var r,s,i;function o(){dI(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{dI(),n(jt(t,"network-request-failed"))},timeout:ij.get()})}if(!((s=(r=pt().gapi)===null||r===void 0?void 0:r.iframes)===null||s===void 0)&&s.Iframe)e(gapi.iframes.getContext());else if(!((i=pt().gapi)===null||i===void 0)&&i.load)o();else{const a=uA("iframefcb");return pt()[a]=()=>{gapi.load?o():n(jt(t,"network-request-failed"))},lA(`https://apis.google.com/js/api.js?onload=${a}`).catch(c=>n(c))}}).catch(e=>{throw Ih=null,e})}let Ih=null;function aj(t){return Ih=Ih||oj(t),Ih}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cj=new lu(5e3,15e3),lj="__/auth/iframe",uj="emulator/auth/iframe",hj={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},dj=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function fj(t){const e=t.config;D(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?Y_(e,uj):`https://${t.config.authDomain}/${lj}`,r={apiKey:e.apiKey,appName:t.name,v:Br},s=dj.get(t.config.apiHost);s&&(r.eid=s);const i=t._getFrameworks();return i.length&&(r.fw=i.join(",")),`${n}?${bo(r).slice(1)}`}async function pj(t){const e=await aj(t),n=pt().gapi;return D(n,t,"internal-error"),e.open({where:document.body,url:fj(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:hj,dontclear:!0},r=>new Promise(async(s,i)=>{await r.restyle({setHideOnLeave:!1});const o=jt(t,"network-request-failed"),a=pt().setTimeout(()=>{i(o)},cj.get());function c(){pt().clearTimeout(a),s(r)}r.ping(c).then(c,()=>{i(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gj={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},mj=500,_j=600,yj="_blank",vj="http://localhost";class fI{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function wj(t,e,n,r=mj,s=_j){const i=Math.max((window.screen.availHeight-s)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let a="";const c=Object.assign(Object.assign({},gj),{width:r.toString(),height:s.toString(),top:i,left:o}),l=We().toLowerCase();n&&(a=UC(l)?yj:n),FC(l)&&(e=e||vj,c.scrollbars="yes");const u=Object.entries(c).reduce((d,[f,p])=>`${d}${f}=${p},`,"");if(YV(l)&&a!=="_self")return bj(e||"",a),new fI(null);const h=window.open(e||"",a,u);D(h,t,"popup-blocked");try{h.focus()}catch{}return new fI(h)}function bj(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ij="__/auth/handler",Ej="emulator/auth/handler";function tm(t,e,n,r,s,i){D(t.config.authDomain,t,"auth-domain-config-required"),D(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:Br,eventId:s};if(e instanceof hs){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",Uh(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[c,l]of Object.entries(i||{}))o[c]=l}if(e instanceof Ha){const c=e.getScopes().filter(l=>l!=="");c.length>0&&(o.scopes=c.join(","))}t.tenantId&&(o.tid=t.tenantId);const a=o;for(const c of Object.keys(a))a[c]===void 0&&delete a[c];return`${Tj(t)}?${bo(a).slice(1)}`}function Tj({config:t}){return t.emulator?Y_(t,Ej):`https://${t.authDomain}/${Ij}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vp="webStorageSupport";class Sj{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Ji,this._completeRedirectFn=_f,this._overrideRedirectResult=ay}async _openPopup(e,n,r,s){var i;ur((i=this.eventManagers[e._key()])===null||i===void 0?void 0:i.manager,"_initialize() not called before _openPopup()");const o=tm(e,n,r,Il(),s);return wj(e,o,hu())}async _openRedirect(e,n,r,s){return await this._originValidation(e),iq(tm(e,n,r,Il(),s)),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:s,promise:i}=this.eventManagers[n];return s?Promise.resolve(s):(ur(i,"If manager is not set, promise should be"),i)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await pj(e),r=new mA(e);return n.register("authEvent",s=>(D(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:r.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(Vp,{type:Vp},s=>{var i;const o=(i=s==null?void 0:s[0])===null||i===void 0?void 0:i[Vp];o!==void 0&&n(!!o),Gt(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=rj(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return qC()||J_()||Ka()}}const Cj=Sj;class Aj{constructor(e){this.factorId=e}_process(e,n,r){switch(n.type){case"enroll":return this._finalizeEnroll(e,n.credential,r);case"signin":return this._finalizeSignIn(e,n.credential);default:return Er("unexpected MultiFactorSessionType")}}}class cy extends Aj{constructor(e){super("phone"),this.credential=e}static _fromCredential(e){return new cy(e)}_finalizeEnroll(e,n,r){return JB(e,{idToken:n,displayName:r,phoneVerificationInfo:this.credential._makeVerificationRequest()})}_finalizeSignIn(e,n){return gq(e,{mfaPendingCredential:n,phoneVerificationInfo:this.credential._makeVerificationRequest()})}}class vA{constructor(){}static assertion(e){return cy._fromCredential(e)}}vA.FACTOR_ID="phone";var pI="@firebase/auth",gI="0.20.5";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kj{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{var s;e(((s=r)===null||s===void 0?void 0:s.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);!n||(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){D(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rj(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";default:return}}function Nj(t){nt(new Ee("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),{apiKey:i,authDomain:o}=r.options;return((a,c)=>{D(i&&!i.includes(":"),"invalid-api-key",{appName:a.name}),D(!(o!=null&&o.includes(":")),"argument-error",{appName:a.name});const l={apiKey:i,authDomain:o,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:jC(t)},u=new eB(a,c,l);return DV(u,n),u})(r,s)},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),nt(new Ee("auth-internal",e=>{const n=Dt(e.getProvider("auth").getImmediate());return(r=>new kj(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),Le(pI,gI,Rj(t)),Le(pI,gI,"esm2017")}Nj("Browser");/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xi(){return window}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pj=2e3;async function Dj(t,e,n){var r;const{BuildInfo:s}=Xi();ur(e.sessionId,"AuthEvent did not contain a session ID");const i=await Fj(e.sessionId),o={};return Ka()?o.ibi=s.packageName:uu()?o.apn=s.packageName:Gt(t,"operation-not-supported-in-this-environment"),s.displayName&&(o.appDisplayName=s.displayName),o.sessionId=i,tm(t,n,e.type,void 0,(r=e.eventId)!==null&&r!==void 0?r:void 0,o)}async function xj(t){const{BuildInfo:e}=Xi(),n={};Ka()?n.iosBundleId=e.packageName:uu()?n.androidPackageName=e.packageName:Gt(t,"operation-not-supported-in-this-environment"),await yA(t,n)}function Oj(t){const{cordova:e}=Xi();return new Promise(n=>{e.plugins.browsertab.isAvailable(r=>{let s=null;r?e.plugins.browsertab.openUrl(t):s=e.InAppBrowser.open(t,QV()?"_blank":"_system","location=yes"),n(s)})})}async function Mj(t,e,n){const{cordova:r}=Xi();let s=()=>{};try{await new Promise((i,o)=>{let a=null;function c(){var h;i();const d=(h=r.plugins.browsertab)===null||h===void 0?void 0:h.close;typeof d=="function"&&d(),typeof(n==null?void 0:n.close)=="function"&&n.close()}function l(){a||(a=window.setTimeout(()=>{o(jt(t,"redirect-cancelled-by-user"))},Pj))}function u(){(document==null?void 0:document.visibilityState)==="visible"&&l()}e.addPassiveListener(c),document.addEventListener("resume",l,!1),uu()&&document.addEventListener("visibilitychange",u,!1),s=()=>{e.removePassiveListener(c),document.removeEventListener("resume",l,!1),document.removeEventListener("visibilitychange",u,!1),a&&window.clearTimeout(a)}})}finally{s()}}function Lj(t){var e,n,r,s,i,o,a,c,l,u;const h=Xi();D(typeof((e=h==null?void 0:h.universalLinks)===null||e===void 0?void 0:e.subscribe)=="function",t,"invalid-cordova-configuration",{missingPlugin:"cordova-universal-links-plugin-fix"}),D(typeof((n=h==null?void 0:h.BuildInfo)===null||n===void 0?void 0:n.packageName)!="undefined",t,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-buildInfo"}),D(typeof((i=(s=(r=h==null?void 0:h.cordova)===null||r===void 0?void 0:r.plugins)===null||s===void 0?void 0:s.browsertab)===null||i===void 0?void 0:i.openUrl)=="function",t,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),D(typeof((c=(a=(o=h==null?void 0:h.cordova)===null||o===void 0?void 0:o.plugins)===null||a===void 0?void 0:a.browsertab)===null||c===void 0?void 0:c.isAvailable)=="function",t,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),D(typeof((u=(l=h==null?void 0:h.cordova)===null||l===void 0?void 0:l.InAppBrowser)===null||u===void 0?void 0:u.open)=="function",t,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-inappbrowser"})}async function Fj(t){const e=Uj(t),n=await crypto.subtle.digest("SHA-256",e);return Array.from(new Uint8Array(n)).map(s=>s.toString(16).padStart(2,"0")).join("")}function Uj(t){if(ur(/[0-9a-zA-Z]+/.test(t),"Can only convert alpha-numeric strings"),typeof TextEncoder!="undefined")return new TextEncoder().encode(t);const e=new ArrayBuffer(t.length),n=new Uint8Array(e);for(let r=0;r<t.length;r++)n[r]=t.charCodeAt(r);return n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $j=20;class Vj extends mA{constructor(){super(...arguments),this.passiveListeners=new Set,this.initPromise=new Promise(e=>{this.resolveInialized=e})}addPassiveListener(e){this.passiveListeners.add(e)}removePassiveListener(e){this.passiveListeners.delete(e)}resetRedirect(){this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1}onEvent(e){return this.resolveInialized(),this.passiveListeners.forEach(n=>n(e)),super.onEvent(e)}async initialized(){await this.initPromise}}function Bj(t,e,n=null){return{type:e,eventId:n,urlResponse:null,sessionId:Kj(),postBody:null,tenantId:t.tenantId,error:jt(t,"no-auth-event")}}function qj(t,e){return nm()._set(rm(t),e)}async function mI(t){const e=await nm()._get(rm(t));return e&&await nm()._remove(rm(t)),e}function jj(t,e){var n,r;const s=Hj(e);if(s.includes("/__/auth/callback")){const i=Eh(s),o=i.firebaseError?Wj(decodeURIComponent(i.firebaseError)):null,a=(r=(n=o==null?void 0:o.code)===null||n===void 0?void 0:n.split("auth/"))===null||r===void 0?void 0:r[1],c=a?jt(a):null;return c?{type:t.type,eventId:t.eventId,tenantId:t.tenantId,error:c,urlResponse:null,sessionId:null,postBody:null}:{type:t.type,eventId:t.eventId,tenantId:t.tenantId,sessionId:t.sessionId,urlResponse:s,postBody:null}}return null}function Kj(){const t=[],e="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let n=0;n<$j;n++){const r=Math.floor(Math.random()*e.length);t.push(e.charAt(r))}return t.join("")}function nm(){return Rn(ny)}function rm(t){return ji("authEvent",t.config.apiKey,t.name)}function Wj(t){try{return JSON.parse(t)}catch{return null}}function Hj(t){const e=Eh(t),n=e.link?decodeURIComponent(e.link):void 0,r=Eh(n).link,s=e.deep_link_id?decodeURIComponent(e.deep_link_id):void 0;return Eh(s).link||s||r||n||t}function Eh(t){if(!(t!=null&&t.includes("?")))return{};const[e,...n]=t.split("?");return zo(n.join("?"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gj=500;class zj{constructor(){this._redirectPersistence=Ji,this._shouldInitProactively=!0,this.eventManagers=new Map,this.originValidationPromises={},this._completeRedirectFn=_f,this._overrideRedirectResult=ay}async _initialize(e){const n=e._key();let r=this.eventManagers.get(n);return r||(r=new Vj(e),this.eventManagers.set(n,r),this.attachCallbackListeners(e,r)),r}_openPopup(e){Gt(e,"operation-not-supported-in-this-environment")}async _openRedirect(e,n,r,s){Lj(e);const i=await this._initialize(e);await i.initialized(),i.resetRedirect(),Wq(),await this._originValidation(e);const o=Bj(e,r,s);await qj(e,o);const a=await Dj(e,o,n),c=await Oj(a);return Mj(e,i,c)}_isIframeWebStorageSupported(e,n){throw new Error("Method not implemented.")}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=xj(e)),this.originValidationPromises[n]}attachCallbackListeners(e,n){const{universalLinks:r,handleOpenURL:s,BuildInfo:i}=Xi(),o=setTimeout(async()=>{await mI(e),n.onEvent(_I())},Gj),a=async u=>{clearTimeout(o);const h=await mI(e);let d=null;h&&(u==null?void 0:u.url)&&(d=jj(h,u.url)),n.onEvent(d||_I())};typeof r!="undefined"&&typeof r.subscribe=="function"&&r.subscribe(null,a);const c=s,l=`${i.packageName.toLowerCase()}://`;Xi().handleOpenURL=async u=>{if(u.toLowerCase().startsWith(l)&&a({url:u}),typeof c=="function")try{c(u)}catch(h){console.error(h)}}}}const Qj=zj;function _I(){return{type:"unknown",eventId:null,sessionId:null,urlResponse:null,postBody:null,tenantId:null,error:jt("no-auth-event")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yj(t,e){Dt(t)._logFramework(e)}var Jj="@firebase/auth-compat",Xj="0.2.18";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zj=1e3;function qc(){var t;return((t=self==null?void 0:self.location)===null||t===void 0?void 0:t.protocol)||null}function eK(){return qc()==="http:"||qc()==="https:"}function wA(t=We()){return!!((qc()==="file:"||qc()==="ionic:"||qc()==="capacitor:")&&t.toLowerCase().match(/iphone|ipad|ipod|android/))}function tK(){return ou()||D_()}function nK(){return x_()&&(document==null?void 0:document.documentMode)===11}function rK(t=We()){return/Edge\/\d+/.test(t)}function sK(t=We()){return nK()||rK(t)}function bA(){try{const t=self.localStorage,e=hu();if(t)return t.setItem(e,"1"),t.removeItem(e),sK()?In():!0}catch{return ly()&&In()}return!1}function ly(){return typeof global!="undefined"&&"WorkerGlobalScope"in global&&"importScripts"in global}function Bp(){return(eK()||iu()||wA())&&!tK()&&bA()&&!ly()}function IA(){return wA()&&typeof document!="undefined"}async function iK(){return IA()?new Promise(t=>{const e=setTimeout(()=>{t(!1)},Zj);document.addEventListener("deviceready",()=>{clearTimeout(e),t(!0)})}):!1}function oK(){return typeof window!="undefined"?window:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cn={LOCAL:"local",NONE:"none",SESSION:"session"},dc=D,EA="persistence";function aK(t,e){if(dc(Object.values(Cn).includes(e),t,"invalid-persistence-type"),ou()){dc(e!==Cn.SESSION,t,"unsupported-persistence-type");return}if(D_()){dc(e===Cn.NONE,t,"unsupported-persistence-type");return}if(ly()){dc(e===Cn.NONE||e===Cn.LOCAL&&In(),t,"unsupported-persistence-type");return}dc(e===Cn.NONE||bA(),t,"unsupported-persistence-type")}async function sm(t){await t._initializationPromise;const e=TA(),n=ji(EA,t.config.apiKey,t.name);e&&e.setItem(n,t._getPersistence())}function cK(t,e){const n=TA();if(!n)return[];const r=ji(EA,t,e);switch(n.getItem(r)){case Cn.NONE:return[ya];case Cn.LOCAL:return[Cl,Ji];case Cn.SESSION:return[Ji];default:return[]}}function TA(){var t;try{return((t=oK())===null||t===void 0?void 0:t.sessionStorage)||null}catch{return null}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lK=D;class Ns{constructor(){this.browserResolver=Rn(Cj),this.cordovaResolver=Rn(Qj),this.underlyingResolver=null,this._redirectPersistence=Ji,this._completeRedirectFn=_f,this._overrideRedirectResult=ay}async _initialize(e){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._initialize(e)}async _openPopup(e,n,r,s){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._openPopup(e,n,r,s)}async _openRedirect(e,n,r,s){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._openRedirect(e,n,r,s)}_isIframeWebStorageSupported(e,n){this.assertedUnderlyingResolver._isIframeWebStorageSupported(e,n)}_originValidation(e){return this.assertedUnderlyingResolver._originValidation(e)}get _shouldInitProactively(){return IA()||this.browserResolver._shouldInitProactively}get assertedUnderlyingResolver(){return lK(this.underlyingResolver,"internal-error"),this.underlyingResolver}async selectUnderlyingResolver(){if(this.underlyingResolver)return;const e=await iK();this.underlyingResolver=e?this.cordovaResolver:this.browserResolver}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function SA(t){return t.unwrap()}function uK(t){return t.wrapped()}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hK(t){return CA(t)}function dK(t,e){var n,r;const s=(n=e.customData)===null||n===void 0?void 0:n._tokenResponse;if(((r=e)===null||r===void 0?void 0:r.code)==="auth/multi-factor-auth-required"){const i=e;i.resolver=new fK(t,QB(t,e))}else if(s){const i=CA(e),o=e;i&&(o.credential=i,o.tenantId=s.tenantId||void 0,o.email=s.email||void 0,o.phoneNumber=s.phoneNumber||void 0)}}function CA(t){const{_tokenResponse:e}=t instanceof lt?t.customData:t;if(!e)return null;if(!(t instanceof lt)&&"temporaryProof"in e&&"phoneNumber"in e)return ar.credentialFromResult(t);const n=e.providerId;if(!n||n===hc.PASSWORD)return null;let r;switch(n){case hc.GOOGLE:r=vr;break;case hc.FACEBOOK:r=yr;break;case hc.GITHUB:r=wr;break;case hc.TWITTER:r=br;break;default:const{oauthIdToken:s,oauthAccessToken:i,oauthTokenSecret:o,pendingToken:a,nonce:c}=e;return!i&&!o&&!s&&!a?null:a?n.startsWith("saml.")?va._create(n,a):xr._fromParams({providerId:n,signInMethod:n,pendingToken:a,idToken:s,accessToken:i}):new na(n).credential({idToken:s,accessToken:i,rawNonce:c})}return t instanceof lt?r.credentialFromError(t):r.credentialFromResult(t)}function gn(t,e){return e.catch(n=>{throw n instanceof lt&&dK(t,n),n}).then(n=>{const r=n.operationType,s=n.user;return{operationType:r,credential:hK(n),additionalUserInfo:zB(n),user:Qr.getOrCreate(s)}})}async function im(t,e){const n=await e;return{verificationId:n.verificationId,confirm:r=>gn(t,n.confirm(r))}}class fK{constructor(e,n){this.resolver=n,this.auth=uK(e)}get session(){return this.resolver.session}get hints(){return this.resolver.hints}resolveSignIn(e){return gn(SA(this.auth),this.resolver.resolveSignIn(e))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qr{constructor(e){this._delegate=e,this.multiFactor=ZB(e)}static getOrCreate(e){return Qr.USER_MAP.has(e)||Qr.USER_MAP.set(e,new Qr(e)),Qr.USER_MAP.get(e)}delete(){return this._delegate.delete()}reload(){return this._delegate.reload()}toJSON(){return this._delegate.toJSON()}getIdTokenResult(e){return this._delegate.getIdTokenResult(e)}getIdToken(e){return this._delegate.getIdToken(e)}linkAndRetrieveDataWithCredential(e){return this.linkWithCredential(e)}async linkWithCredential(e){return gn(this.auth,XC(this._delegate,e))}async linkWithPhoneNumber(e,n){return im(this.auth,Dq(this._delegate,e,n))}async linkWithPopup(e){return gn(this.auth,Bq(this._delegate,e,Ns))}async linkWithRedirect(e){return await sm(Dt(this.auth)),Yq(this._delegate,e,Ns)}reauthenticateAndRetrieveDataWithCredential(e){return this.reauthenticateWithCredential(e)}async reauthenticateWithCredential(e){return gn(this.auth,ZC(this._delegate,e))}reauthenticateWithPhoneNumber(e,n){return im(this.auth,xq(this._delegate,e,n))}reauthenticateWithPopup(e){return gn(this.auth,Vq(this._delegate,e,Ns))}async reauthenticateWithRedirect(e){return await sm(Dt(this.auth)),zq(this._delegate,e,Ns)}sendEmailVerification(e){return FB(this._delegate,e)}async unlink(e){return await EB(this._delegate,e),this}updateEmail(e){return BB(this._delegate,e)}updatePassword(e){return qB(this._delegate,e)}updatePhoneNumber(e){return Oq(this._delegate,e)}updateProfile(e){return VB(this._delegate,e)}verifyBeforeUpdateEmail(e,n){return UB(this._delegate,e,n)}get emailVerified(){return this._delegate.emailVerified}get isAnonymous(){return this._delegate.isAnonymous}get metadata(){return this._delegate.metadata}get phoneNumber(){return this._delegate.phoneNumber}get providerData(){return this._delegate.providerData}get refreshToken(){return this._delegate.refreshToken}get tenantId(){return this._delegate.tenantId}get displayName(){return this._delegate.displayName}get email(){return this._delegate.email}get photoURL(){return this._delegate.photoURL}get providerId(){return this._delegate.providerId}get uid(){return this._delegate.uid}get auth(){return this._delegate.auth}}Qr.USER_MAP=new WeakMap;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fc=D;class om{constructor(e,n){if(this.app=e,n.isInitialized()){this._delegate=n.getImmediate(),this.linkUnderlyingAuth();return}const{apiKey:r}=e.options;fc(r,"invalid-api-key",{appName:e.name}),fc(r,"invalid-api-key",{appName:e.name});const s=typeof window!="undefined"?Ns:void 0;this._delegate=n.initialize({options:{persistence:pK(r,e.name),popupRedirectResolver:s}}),this._delegate._updateErrorMap(NV),this.linkUnderlyingAuth()}get emulatorConfig(){return this._delegate.emulatorConfig}get currentUser(){return this._delegate.currentUser?Qr.getOrCreate(this._delegate.currentUser):null}get languageCode(){return this._delegate.languageCode}set languageCode(e){this._delegate.languageCode=e}get settings(){return this._delegate.settings}get tenantId(){return this._delegate.tenantId}set tenantId(e){this._delegate.tenantId=e}useDeviceLanguage(){this._delegate.useDeviceLanguage()}signOut(){return this._delegate.signOut()}useEmulator(e,n){tB(this._delegate,e,n)}applyActionCode(e){return kB(this._delegate,e)}checkActionCode(e){return eA(this._delegate,e)}confirmPasswordReset(e,n){return AB(this._delegate,e,n)}async createUserWithEmailAndPassword(e,n){return gn(this._delegate,NB(this._delegate,e,n))}fetchProvidersForEmail(e){return this.fetchSignInMethodsForEmail(e)}fetchSignInMethodsForEmail(e){return LB(this._delegate,e)}isSignInWithEmailLink(e){return xB(this._delegate,e)}async getRedirectResult(){fc(Bp(),this._delegate,"operation-not-supported-in-this-environment");const e=await Xq(this._delegate,Ns);return e?gn(this._delegate,Promise.resolve(e)):{credential:null,user:null}}addFrameworkForLogging(e){Yj(this._delegate,e)}onAuthStateChanged(e,n,r){const{next:s,error:i,complete:o}=yI(e,n,r);return this._delegate.onAuthStateChanged(s,i,o)}onIdTokenChanged(e,n,r){const{next:s,error:i,complete:o}=yI(e,n,r);return this._delegate.onIdTokenChanged(s,i,o)}sendSignInLinkToEmail(e,n){return DB(this._delegate,e,n)}sendPasswordResetEmail(e,n){return CB(this._delegate,e,n||void 0)}async setPersistence(e){aK(this._delegate,e);let n;switch(e){case Cn.SESSION:n=Ji;break;case Cn.LOCAL:n=await Rn(Cl)._isAvailable()?Cl:ny;break;case Cn.NONE:n=ya;break;default:return Gt("argument-error",{appName:this._delegate.name})}return this._delegate.setPersistence(n)}signInAndRetrieveDataWithCredential(e){return this.signInWithCredential(e)}signInAnonymously(){return gn(this._delegate,IB(this._delegate))}signInWithCredential(e){return gn(this._delegate,hf(this._delegate,e))}signInWithCustomToken(e){return gn(this._delegate,SB(this._delegate,e))}signInWithEmailAndPassword(e,n){return gn(this._delegate,PB(this._delegate,e,n))}signInWithEmailLink(e,n){return gn(this._delegate,OB(this._delegate,e,n))}signInWithPhoneNumber(e,n){return im(this._delegate,Pq(this._delegate,e,n))}async signInWithPopup(e){return fc(Bp(),this._delegate,"operation-not-supported-in-this-environment"),gn(this._delegate,$q(this._delegate,e,Ns))}async signInWithRedirect(e){return fc(Bp(),this._delegate,"operation-not-supported-in-this-environment"),await sm(this._delegate),Hq(this._delegate,e,Ns)}updateCurrentUser(e){return this._delegate.updateCurrentUser(e)}verifyPasswordResetCode(e){return RB(this._delegate,e)}unwrap(){return this._delegate}_delete(){return this._delegate._delete()}linkUnderlyingAuth(){this._delegate.wrapped=()=>this}}om.Persistence=Cn;function yI(t,e,n){let r=t;typeof t!="function"&&({next:r,error:e,complete:n}=t);const s=r;return{next:o=>s(o&&Qr.getOrCreate(o)),error:e,complete:n}}function pK(t,e){const n=cK(t,e);if(typeof self!="undefined"&&!n.includes(Cl)&&n.push(Cl),typeof window!="undefined")for(const r of[ny,Ji])n.includes(r)||n.push(r);return n.includes(ya)||n.push(ya),n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uy{constructor(){this.providerId="phone",this._delegate=new ar(SA(ut.auth()))}static credential(e,n){return ar.credential(e,n)}verifyPhoneNumber(e,n){return this._delegate.verifyPhoneNumber(e,n)}unwrap(){return this._delegate}}uy.PHONE_SIGN_IN_METHOD=ar.PHONE_SIGN_IN_METHOD;uy.PROVIDER_ID=ar.PROVIDER_ID;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gK=D;class mK{constructor(e,n,r=ut.app()){var s;gK((s=r.options)===null||s===void 0?void 0:s.apiKey,"invalid-api-key",{appName:r.name}),this._delegate=new Rq(e,n,r.auth()),this.type=this._delegate.type}clear(){this._delegate.clear()}render(){return this._delegate.render()}verify(){return this._delegate.verify()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _K="auth-compat";function yK(t){t.INTERNAL.registerComponent(new Ee(_K,e=>{const n=e.getProvider("app-compat").getImmediate(),r=e.getProvider("auth");return new om(n,r)},"PUBLIC").setServiceProps({ActionCodeInfo:{Operation:{EMAIL_SIGNIN:Lo.EMAIL_SIGNIN,PASSWORD_RESET:Lo.PASSWORD_RESET,RECOVER_EMAIL:Lo.RECOVER_EMAIL,REVERT_SECOND_FACTOR_ADDITION:Lo.REVERT_SECOND_FACTOR_ADDITION,VERIFY_AND_CHANGE_EMAIL:Lo.VERIFY_AND_CHANGE_EMAIL,VERIFY_EMAIL:Lo.VERIFY_EMAIL}},EmailAuthProvider:ii,FacebookAuthProvider:yr,GithubAuthProvider:wr,GoogleAuthProvider:vr,OAuthProvider:na,SAMLAuthProvider:Gh,PhoneAuthProvider:uy,PhoneMultiFactorGenerator:vA,RecaptchaVerifier:mK,TwitterAuthProvider:br,Auth:om,AuthCredential:Wa,Error:lt}).setInstantiationMode("LAZY").setMultipleInstances(!1)),t.registerVersion(Jj,Xj)}yK(ut);const vI="@firebase/database",wI="0.13.3";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let AA="";function kA(t){AA=t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vK{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,n){n==null?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),mt(n))}get(e){const n=this.domStorage_.getItem(this.prefixedName_(e));return n==null?null:gl(n)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wK{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,n){n==null?delete this.cache_[e]:this.cache_[e]=n}get(e){return xn(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RA=function(t){try{if(typeof window!="undefined"&&typeof window[t]!="undefined"){const e=window[t];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new vK(e)}}catch{}return new wK},Mi=RA("localStorage"),am=RA("sessionStorage");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sa=new Vr("@firebase/database"),NA=function(){let t=1;return function(){return t++}}(),PA=function(t){const e=BL(t),n=new UL;n.update(e);const r=n.digest();return Xd.encodeByteArray(r)},fu=function(...t){let e="";for(let n=0;n<t.length;n++){const r=t[n];Array.isArray(r)||r&&typeof r=="object"&&typeof r.length=="number"?e+=fu.apply(null,r):typeof r=="object"?e+=mt(r):e+=r,e+=" "}return e};let Wi=null,bI=!0;const DA=function(t,e){x(!e||t===!0||t===!1,"Can't turn on custom loggers persistently."),t===!0?(sa.logLevel=de.VERBOSE,Wi=sa.log.bind(sa),e&&am.set("logging_enabled",!0)):typeof t=="function"?Wi=t:(Wi=null,am.remove("logging_enabled"))},Tt=function(...t){if(bI===!0&&(bI=!1,Wi===null&&am.get("logging_enabled")===!0&&DA(!0)),Wi){const e=fu.apply(null,t);Wi(e)}},pu=function(t){return function(...e){Tt(t,...e)}},cm=function(...t){const e="FIREBASE INTERNAL ERROR: "+fu(...t);sa.error(e)},Or=function(...t){const e=`FIREBASE FATAL ERROR: ${fu(...t)}`;throw sa.error(e),new Error(e)},Jt=function(...t){const e="FIREBASE WARNING: "+fu(...t);sa.warn(e)},bK=function(){typeof window!="undefined"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&Jt("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},yf=function(t){return typeof t=="number"&&(t!==t||t===Number.POSITIVE_INFINITY||t===Number.NEGATIVE_INFINITY)},IK=function(t){if(document.readyState==="complete")t();else{let e=!1;const n=function(){if(!document.body){setTimeout(n,Math.floor(10));return}e||(e=!0,t())};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&n()}),window.attachEvent("onload",n))}},is="[MIN_NAME]",Mr="[MAX_NAME]",To=function(t,e){if(t===e)return 0;if(t===is||e===Mr)return-1;if(e===is||t===Mr)return 1;{const n=Jh(t),r=Jh(e);return n!==null?r!==null?n-r===0?t.length-e.length:n-r:-1:r!==null?1:t<e?-1:1}},EK=function(t,e){return t===e?0:t<e?-1:1},pc=function(t,e){if(e&&t in e)return e[t];throw new Error("Missing required key ("+t+") in object: "+mt(e))},hy=function(t){if(typeof t!="object"||t===null)return mt(t);const e=[];for(const r in t)e.push(r);e.sort();let n="{";for(let r=0;r<e.length;r++)r!==0&&(n+=","),n+=mt(e[r]),n+=":",n+=hy(t[e[r]]);return n+="}",n},xA=function(t,e){const n=t.length;if(n<=e)return[t];const r=[];for(let s=0;s<n;s+=e)s+e>n?r.push(t.substring(s,n)):r.push(t.substring(s,s+e));return r};function xt(t,e){for(const n in t)t.hasOwnProperty(n)&&e(n,t[n])}const OA=function(t){x(!yf(t),"Invalid JSON number");const e=11,n=52,r=(1<<e-1)-1;let s,i,o,a,c;t===0?(i=0,o=0,s=1/t===-1/0?1:0):(s=t<0,t=Math.abs(t),t>=Math.pow(2,1-r)?(a=Math.min(Math.floor(Math.log(t)/Math.LN2),r),i=a+r,o=Math.round(t*Math.pow(2,n-a)-Math.pow(2,n))):(i=0,o=Math.round(t/Math.pow(2,1-r-n))));const l=[];for(c=n;c;c-=1)l.push(o%2?1:0),o=Math.floor(o/2);for(c=e;c;c-=1)l.push(i%2?1:0),i=Math.floor(i/2);l.push(s?1:0),l.reverse();const u=l.join("");let h="";for(c=0;c<64;c+=8){let d=parseInt(u.substr(c,8),2).toString(16);d.length===1&&(d="0"+d),h=h+d}return h.toLowerCase()},TK=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},SK=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};function CK(t,e){let n="Unknown Error";t==="too_big"?n="The data requested exceeds the maximum size that can be accessed with a single request.":t==="permission_denied"?n="Client doesn't have permission to access the desired data.":t==="unavailable"&&(n="The service is unavailable");const r=new Error(t+" at "+e._path.toString()+": "+n);return r.code=t.toUpperCase(),r}const AK=new RegExp("^-?(0*)\\d{1,10}$"),MA=-2147483648,dy=2147483647,Jh=function(t){if(AK.test(t)){const e=Number(t);if(e>=MA&&e<=dy)return e}return null},Ga=function(t){try{t()}catch(e){setTimeout(()=>{const n=e.stack||"";throw Jt("Exception was thrown by user callback.",n),e},Math.floor(0))}},kK=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},jc=function(t,e){const n=setTimeout(t,e);return typeof n=="object"&&n.unref&&n.unref(),n};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RK{constructor(e,n){this.appName_=e,this.appCheckProvider=n,this.appCheck=n==null?void 0:n.getImmediate({optional:!0}),this.appCheck||n==null||n.get().then(r=>this.appCheck=r)}getToken(e){return this.appCheck?this.appCheck.getToken(e):new Promise((n,r)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(n,r):n(null)},0)})}addTokenChangeListener(e){var n;(n=this.appCheckProvider)===null||n===void 0||n.get().then(r=>r.addTokenListener(e))}notifyForInvalidToken(){Jt(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NK{constructor(e,n,r){this.appName_=e,this.firebaseOptions_=n,this.authProvider_=r,this.auth_=null,this.auth_=r.getImmediate({optional:!0}),this.auth_||r.onInit(s=>this.auth_=s)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(n=>n&&n.code==="auth/token-not-initialized"?(Tt("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(n)):new Promise((n,r)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(n,r):n(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(n=>n.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(n=>n.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',Jt(e)}}class ia{constructor(e){this.accessToken=e}getToken(e){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(e){e(this.accessToken)}removeTokenChangeListener(e){}notifyForInvalidToken(){}}ia.OWNER="owner";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fy="5",LA="v",FA="s",UA="r",$A="f",VA=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,BA="ls",qA="p",lm="ac",jA="websocket",KA="long_polling";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WA{constructor(e,n,r,s,i=!1,o="",a=!1){this.secure=n,this.namespace=r,this.webSocketOnly=s,this.nodeAdmin=i,this.persistenceKey=o,this.includeNamespaceInQueryParams=a,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=Mi.get("host:"+e)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&Mi.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){const e=this.secure?"https://":"http://",n=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${n}`}}function PK(t){return t.host!==t.internalHost||t.isCustomHost()||t.includeNamespaceInQueryParams}function HA(t,e,n){x(typeof e=="string","typeof type must == string"),x(typeof n=="object","typeof params must == object");let r;if(e===jA)r=(t.secure?"wss://":"ws://")+t.internalHost+"/.ws?";else if(e===KA)r=(t.secure?"https://":"http://")+t.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+e);PK(t)&&(n.ns=t.namespace);const s=[];return xt(n,(i,o)=>{s.push(i+"="+o)}),r+s.join("&")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DK{constructor(){this.counters_={}}incrementCounter(e,n=1){xn(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=n}get(){return SL(this.counters_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qp={},jp={};function py(t){const e=t.toString();return qp[e]||(qp[e]=new DK),qp[e]}function xK(t,e){const n=t.toString();return jp[n]||(jp[n]=e()),jp[n]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OK{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,n){this.closeAfterResponse=e,this.onClose=n,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,n){for(this.pendingResponses[e]=n;this.pendingResponses[this.currentResponseNum];){const r=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let s=0;s<r.length;++s)r[s]&&Ga(()=>{this.onMessage_(r[s])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const II="start",MK="close",LK="pLPCommand",FK="pRTLPCB",GA="id",zA="pw",QA="ser",UK="cb",$K="seg",VK="ts",BK="d",qK="dframe",YA=1870,JA=30,jK=YA-JA,KK=25e3,WK=3e4;class Ps{constructor(e,n,r,s,i,o,a){this.connId=e,this.repoInfo=n,this.applicationId=r,this.appCheckToken=s,this.authToken=i,this.transportSessionId=o,this.lastSessionId=a,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=pu(e),this.stats_=py(n),this.urlFn=c=>(this.appCheckToken&&(c[lm]=this.appCheckToken),HA(n,KA,c))}open(e,n){this.curSegmentNum=0,this.onDisconnect_=n,this.myPacketOrderer=new OK(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(WK)),IK(()=>{if(this.isClosed_)return;this.scriptTagHolder=new gy((...i)=>{const[o,a,c,l,u]=i;if(this.incrementIncomingBytes_(i),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,o===II)this.id=a,this.password=c;else if(o===MK)a?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(a,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+o)},(...i)=>{const[o,a]=i;this.incrementIncomingBytes_(i),this.myPacketOrderer.handleResponse(o,a)},()=>{this.onClosed_()},this.urlFn);const r={};r[II]="t",r[QA]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(r[UK]=this.scriptTagHolder.uniqueCallbackIdentifier),r[LA]=fy,this.transportSessionId&&(r[FA]=this.transportSessionId),this.lastSessionId&&(r[BA]=this.lastSessionId),this.applicationId&&(r[qA]=this.applicationId),this.appCheckToken&&(r[lm]=this.appCheckToken),typeof location!="undefined"&&location.hostname&&VA.test(location.hostname)&&(r[UA]=$A);const s=this.urlFn(r);this.log_("Connecting via long-poll to "+s),this.scriptTagHolder.addTag(s,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){Ps.forceAllow_=!0}static forceDisallow(){Ps.forceDisallow_=!0}static isAvailable(){return Ps.forceAllow_?!0:!Ps.forceDisallow_&&typeof document!="undefined"&&document.createElement!=null&&!TK()&&!SK()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){const n=mt(e);this.bytesSent+=n.length,this.stats_.incrementCounter("bytes_sent",n.length);const r=A0(n),s=xA(r,jK);for(let i=0;i<s.length;i++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,s.length,s[i]),this.curSegmentNum++}addDisconnectPingFrame(e,n){this.myDisconnFrame=document.createElement("iframe");const r={};r[qK]="t",r[GA]=e,r[zA]=n,this.myDisconnFrame.src=this.urlFn(r),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){const n=mt(e).length;this.bytesReceived+=n,this.stats_.incrementCounter("bytes_received",n)}}class gy{constructor(e,n,r,s){this.onDisconnect=r,this.urlFn=s,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0;{this.uniqueCallbackIdentifier=NA(),window[LK+this.uniqueCallbackIdentifier]=e,window[FK+this.uniqueCallbackIdentifier]=n,this.myIFrame=gy.createIFrame_();let i="";if(this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"){const a=document.domain;i='<script>document.domain="'+a+'";<\/script>'}const o="<html><body>"+i+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(o),this.myIFrame.doc.close()}catch(a){Tt("frame writing exception"),a.stack&&Tt(a.stack),Tt(a)}}}static createIFrame_(){const e=document.createElement("iframe");if(e.style.display="none",document.body){document.body.appendChild(e);try{e.contentWindow.document||Tt("No IE domain setting required")}catch{const r=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+r+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.innerHTML="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));const e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,n){for(this.myID=e,this.myPW=n,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const e={};e[GA]=this.myID,e[zA]=this.myPW,e[QA]=this.currentSerial;let n=this.urlFn(e),r="",s=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+JA+r.length<=YA;){const o=this.pendingSegs.shift();r=r+"&"+$K+s+"="+o.seg+"&"+VK+s+"="+o.ts+"&"+BK+s+"="+o.d,s++}return n=n+r,this.addLongPollTag_(n,this.currentSerial),!0}else return!1}enqueueSegment(e,n,r){this.pendingSegs.push({seg:e,ts:n,d:r}),this.alive&&this.newRequest_()}addLongPollTag_(e,n){this.outstandingRequests.add(n);const r=()=>{this.outstandingRequests.delete(n),this.newRequest_()},s=setTimeout(r,Math.floor(KK)),i=()=>{clearTimeout(s),r()};this.addTag(e,i)}addTag(e,n){setTimeout(()=>{try{if(!this.sendNewPolls)return;const r=this.myIFrame.doc.createElement("script");r.type="text/javascript",r.async=!0,r.src=e,r.onload=r.onreadystatechange=function(){const s=r.readyState;(!s||s==="loaded"||s==="complete")&&(r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),n())},r.onerror=()=>{Tt("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(r)}catch{}},Math.floor(1))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HK=16384,GK=45e3;let Xh=null;typeof MozWebSocket!="undefined"?Xh=MozWebSocket:typeof WebSocket!="undefined"&&(Xh=WebSocket);class $n{constructor(e,n,r,s,i,o,a){this.connId=e,this.applicationId=r,this.appCheckToken=s,this.authToken=i,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=pu(this.connId),this.stats_=py(n),this.connURL=$n.connectionURL_(n,o,a,s,r),this.nodeAdmin=n.nodeAdmin}static connectionURL_(e,n,r,s,i){const o={};return o[LA]=fy,typeof location!="undefined"&&location.hostname&&VA.test(location.hostname)&&(o[UA]=$A),n&&(o[FA]=n),r&&(o[BA]=r),s&&(o[lm]=s),i&&(o[qA]=i),HA(e,jA,o)}open(e,n){this.onDisconnect=n,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,Mi.set("previous_websocket_failure",!0);try{let r;k0(),this.mySock=new Xh(this.connURL,[],r)}catch(r){this.log_("Error instantiating WebSocket.");const s=r.message||r.data;s&&this.log_(s),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=r=>{this.handleIncomingFrame(r)},this.mySock.onerror=r=>{this.log_("WebSocket error.  Closing connection.");const s=r.message||r.data;s&&this.log_(s),this.onClosed_()}}start(){}static forceDisallow(){$n.forceDisallow_=!0}static isAvailable(){let e=!1;if(typeof navigator!="undefined"&&navigator.userAgent){const n=/Android ([0-9]{0,}\.[0-9]{0,})/,r=navigator.userAgent.match(n);r&&r.length>1&&parseFloat(r[1])<4.4&&(e=!0)}return!e&&Xh!==null&&!$n.forceDisallow_}static previouslyFailed(){return Mi.isInMemoryStorage||Mi.get("previous_websocket_failure")===!0}markConnectionHealthy(){Mi.remove("previous_websocket_failure")}appendFrame_(e){if(this.frames.push(e),this.frames.length===this.totalFrames){const n=this.frames.join("");this.frames=null;const r=gl(n);this.onMessage(r)}}handleNewFrameCount_(e){this.totalFrames=e,this.frames=[]}extractFrameCount_(e){if(x(this.frames===null,"We already have a frame buffer"),e.length<=6){const n=Number(e);if(!isNaN(n))return this.handleNewFrameCount_(n),null}return this.handleNewFrameCount_(1),e}handleIncomingFrame(e){if(this.mySock===null)return;const n=e.data;if(this.bytesReceived+=n.length,this.stats_.incrementCounter("bytes_received",n.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(n);else{const r=this.extractFrameCount_(n);r!==null&&this.appendFrame_(r)}}send(e){this.resetKeepAlive();const n=mt(e);this.bytesSent+=n.length,this.stats_.incrementCounter("bytes_sent",n.length);const r=xA(n,HK);r.length>1&&this.sendString_(String(r.length));for(let s=0;s<r.length;s++)this.sendString_(r[s])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(GK))}sendString_(e){try{this.mySock.send(e)}catch(n){this.log_("Exception thrown from WebSocket.send():",n.message||n.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}$n.responsesRequiredToBeHealthy=2;$n.healthyTimeout=3e4;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wa{constructor(e){this.initTransports_(e)}static get ALL_TRANSPORTS(){return[Ps,$n]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(e){const n=$n&&$n.isAvailable();let r=n&&!$n.previouslyFailed();if(e.webSocketOnly&&(n||Jt("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),r=!0),r)this.transports_=[$n];else{const s=this.transports_=[];for(const i of wa.ALL_TRANSPORTS)i&&i.isAvailable()&&s.push(i);wa.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}wa.globalTransportInitialized_=!1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zK=6e4,QK=5e3,YK=10*1024,JK=100*1024,Kp="t",EI="d",XK="s",TI="r",ZK="e",SI="o",CI="a",AI="n",kI="p",eW="h";class tW{constructor(e,n,r,s,i,o,a,c,l,u){this.id=e,this.repoInfo_=n,this.applicationId_=r,this.appCheckToken_=s,this.authToken_=i,this.onMessage_=o,this.onReady_=a,this.onDisconnect_=c,this.onKill_=l,this.lastSessionId=u,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=pu("c:"+this.id+":"),this.transportManager_=new wa(n),this.log_("Connection created"),this.start_()}start_(){const e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const n=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(n,r)},Math.floor(0));const s=e.healthyTimeout||0;s>0&&(this.healthyTimeout_=jc(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>JK?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>YK?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(s)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return n=>{e===this.conn_?this.onConnectionLost_(n):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return n=>{this.state_!==2&&(e===this.rx_?this.onPrimaryMessageReceived_(n):e===this.secondaryConn_?this.onSecondaryMessageReceived_(n):this.log_("message on old connection"))}}sendRequest(e){const n={t:"d",d:e};this.sendData_(n)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if(Kp in e){const n=e[Kp];n===CI?this.upgradeIfSecondaryHealthy_():n===TI?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):n===SI&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){const n=pc("t",e),r=pc("d",e);if(n==="c")this.onSecondaryControl_(r);else if(n==="d")this.pendingDataMessages.push(r);else throw new Error("Unknown protocol layer: "+n)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:kI,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:CI,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:AI,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){const n=pc("t",e),r=pc("d",e);n==="c"?this.onControl_(r):n==="d"&&this.onDataMessage_(r)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){const n=pc(Kp,e);if(EI in e){const r=e[EI];if(n===eW)this.onHandshake_(r);else if(n===AI){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let s=0;s<this.pendingDataMessages.length;++s)this.onDataMessage_(this.pendingDataMessages[s]);this.pendingDataMessages=[],this.tryCleanupConnection()}else n===XK?this.onConnectionShutdown_(r):n===TI?this.onReset_(r):n===ZK?cm("Server Error: "+r):n===SI?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):cm("Unknown control packet command: "+n)}}onHandshake_(e){const n=e.ts,r=e.v,s=e.h;this.sessionId=e.s,this.repoInfo_.host=s,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,n),fy!==r&&Jt("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const n=this.connReceiver_(this.secondaryConn_),r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(n,r),jc(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(zK))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,n){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(n,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):jc(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(QK))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:kI,d:{}}}))}onSecondaryConnectionLost_(){const e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,!e&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(Mi.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(e)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XA{put(e,n,r,s){}merge(e,n,r,s){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,n,r){}onDisconnectMerge(e,n,r){}onDisconnectCancel(e,n){}reportStats(e){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZA{constructor(e){this.allowedEvents_=e,this.listeners_={},x(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...n){if(Array.isArray(this.listeners_[e])){const r=[...this.listeners_[e]];for(let s=0;s<r.length;s++)r[s].callback.apply(r[s].context,n)}}on(e,n,r){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:n,context:r});const s=this.getInitialEvent(e);s&&n.apply(r,s)}off(e,n,r){this.validateEventType_(e);const s=this.listeners_[e]||[];for(let i=0;i<s.length;i++)if(s[i].callback===n&&(!r||r===s[i].context)){s.splice(i,1);return}}validateEventType_(e){x(this.allowedEvents_.find(n=>n===e),"Unknown event: "+e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zh extends ZA{constructor(){super(["online"]),this.online_=!0,typeof window!="undefined"&&typeof window.addEventListener!="undefined"&&!Zd()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}static getInstance(){return new Zh}getInitialEvent(e){return x(e==="online","Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RI=32,NI=768;class Ce{constructor(e,n){if(n===void 0){this.pieces_=e.split("/");let r=0;for(let s=0;s<this.pieces_.length;s++)this.pieces_[s].length>0&&(this.pieces_[r]=this.pieces_[s],r++);this.pieces_.length=r,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=n}toString(){let e="";for(let n=this.pieceNum_;n<this.pieces_.length;n++)this.pieces_[n]!==""&&(e+="/"+this.pieces_[n]);return e||"/"}}function Te(){return new Ce("")}function fe(t){return t.pieceNum_>=t.pieces_.length?null:t.pieces_[t.pieceNum_]}function zs(t){return t.pieces_.length-t.pieceNum_}function Me(t){let e=t.pieceNum_;return e<t.pieces_.length&&e++,new Ce(t.pieces_,e)}function my(t){return t.pieceNum_<t.pieces_.length?t.pieces_[t.pieces_.length-1]:null}function nW(t){let e="";for(let n=t.pieceNum_;n<t.pieces_.length;n++)t.pieces_[n]!==""&&(e+="/"+encodeURIComponent(String(t.pieces_[n])));return e||"/"}function Al(t,e=0){return t.pieces_.slice(t.pieceNum_+e)}function ek(t){if(t.pieceNum_>=t.pieces_.length)return null;const e=[];for(let n=t.pieceNum_;n<t.pieces_.length-1;n++)e.push(t.pieces_[n]);return new Ce(e,0)}function Ge(t,e){const n=[];for(let r=t.pieceNum_;r<t.pieces_.length;r++)n.push(t.pieces_[r]);if(e instanceof Ce)for(let r=e.pieceNum_;r<e.pieces_.length;r++)n.push(e.pieces_[r]);else{const r=e.split("/");for(let s=0;s<r.length;s++)r[s].length>0&&n.push(r[s])}return new Ce(n,0)}function pe(t){return t.pieceNum_>=t.pieces_.length}function ln(t,e){const n=fe(t),r=fe(e);if(n===null)return e;if(n===r)return ln(Me(t),Me(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+t+")")}function rW(t,e){const n=Al(t,0),r=Al(e,0);for(let s=0;s<n.length&&s<r.length;s++){const i=To(n[s],r[s]);if(i!==0)return i}return n.length===r.length?0:n.length<r.length?-1:1}function _y(t,e){if(zs(t)!==zs(e))return!1;for(let n=t.pieceNum_,r=e.pieceNum_;n<=t.pieces_.length;n++,r++)if(t.pieces_[n]!==e.pieces_[r])return!1;return!0}function Bn(t,e){let n=t.pieceNum_,r=e.pieceNum_;if(zs(t)>zs(e))return!1;for(;n<t.pieces_.length;){if(t.pieces_[n]!==e.pieces_[r])return!1;++n,++r}return!0}class sW{constructor(e,n){this.errorPrefix_=n,this.parts_=Al(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let r=0;r<this.parts_.length;r++)this.byteLength_+=tf(this.parts_[r]);tk(this)}}function iW(t,e){t.parts_.length>0&&(t.byteLength_+=1),t.parts_.push(e),t.byteLength_+=tf(e),tk(t)}function oW(t){const e=t.parts_.pop();t.byteLength_-=tf(e),t.parts_.length>0&&(t.byteLength_-=1)}function tk(t){if(t.byteLength_>NI)throw new Error(t.errorPrefix_+"has a key path longer than "+NI+" bytes ("+t.byteLength_+").");if(t.parts_.length>RI)throw new Error(t.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+RI+") or object contains a cycle "+Ii(t))}function Ii(t){return t.parts_.length===0?"":"in property '"+t.parts_.join(".")+"'"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yy extends ZA{constructor(){super(["visible"]);let e,n;typeof document!="undefined"&&typeof document.addEventListener!="undefined"&&(typeof document.hidden!="undefined"?(n="visibilitychange",e="hidden"):typeof document.mozHidden!="undefined"?(n="mozvisibilitychange",e="mozHidden"):typeof document.msHidden!="undefined"?(n="msvisibilitychange",e="msHidden"):typeof document.webkitHidden!="undefined"&&(n="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,n&&document.addEventListener(n,()=>{const r=!document[e];r!==this.visible_&&(this.visible_=r,this.trigger("visible",r))},!1)}static getInstance(){return new yy}getInitialEvent(e){return x(e==="visible","Unknown event type: "+e),[this.visible_]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gc=1e3,aW=60*5*1e3,PI=30*1e3,cW=1.3,lW=3e4,uW="server_kill",DI=3;class ts extends XA{constructor(e,n,r,s,i,o,a,c){if(super(),this.repoInfo_=e,this.applicationId_=n,this.onDataUpdate_=r,this.onConnectStatus_=s,this.onServerInfoUpdate_=i,this.authTokenProvider_=o,this.appCheckTokenProvider_=a,this.authOverride_=c,this.id=ts.nextPersistentConnectionId_++,this.log_=pu("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=gc,this.maxReconnectDelay_=aW,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,c&&!k0())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");yy.getInstance().on("visible",this.onVisible_,this),e.host.indexOf("fblocal")===-1&&Zh.getInstance().on("online",this.onOnline_,this)}sendRequest(e,n,r){const s=++this.requestNumber_,i={r:s,a:e,b:n};this.log_(mt(i)),x(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(i),r&&(this.requestCBHash_[s]=r)}get(e){this.initConnection_();const n=new gt,r={p:e._path.toString(),q:e._queryObject},s={action:"g",request:r,onComplete:o=>{const a=o.d;o.s==="ok"?n.resolve(a):n.reject(a)}};this.outstandingGets_.push(s),this.outstandingGetCount_++;const i=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(i),n.promise}listen(e,n,r,s){this.initConnection_();const i=e._queryIdentifier,o=e._path.toString();this.log_("Listen called for "+o+" "+i),this.listens.has(o)||this.listens.set(o,new Map),x(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"listen() called for non-default but complete query"),x(!this.listens.get(o).has(i),"listen() called twice for same path/queryId.");const a={onComplete:s,hashFn:n,query:e,tag:r};this.listens.get(o).set(i,a),this.connected_&&this.sendListen_(a)}sendGet_(e){const n=this.outstandingGets_[e];this.sendRequest("g",n.request,r=>{delete this.outstandingGets_[e],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),n.onComplete&&n.onComplete(r)})}sendListen_(e){const n=e.query,r=n._path.toString(),s=n._queryIdentifier;this.log_("Listen on "+r+" for "+s);const i={p:r},o="q";e.tag&&(i.q=n._queryObject,i.t=e.tag),i.h=e.hashFn(),this.sendRequest(o,i,a=>{const c=a.d,l=a.s;ts.warnOnListenWarnings_(c,n),(this.listens.get(r)&&this.listens.get(r).get(s))===e&&(this.log_("listen response",a),l!=="ok"&&this.removeListen_(r,s),e.onComplete&&e.onComplete(l,c))})}static warnOnListenWarnings_(e,n){if(e&&typeof e=="object"&&xn(e,"w")){const r=Gi(e,"w");if(Array.isArray(r)&&~r.indexOf("no_index")){const s='".indexOn": "'+n._queryParams.getIndex().toString()+'"',i=n._path.toString();Jt(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${s} at ${i} to your security rules for better performance.`)}}}refreshAuthToken(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(e)}reduceReconnectDelayIfAdminCredential_(e){(e&&e.length===40||FL(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=PI)}refreshAppCheckToken(e){this.appCheckToken_=e,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){const e=this.authToken_,n=LL(e)?"auth":"gauth",r={cred:e};this.authOverride_===null?r.noauth=!0:typeof this.authOverride_=="object"&&(r.authvar=this.authOverride_),this.sendRequest(n,r,s=>{const i=s.s,o=s.d||"error";this.authToken_===e&&(i==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(i,o))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},e=>{const n=e.s,r=e.d||"error";n==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(n,r)})}unlisten(e,n){const r=e._path.toString(),s=e._queryIdentifier;this.log_("Unlisten called for "+r+" "+s),x(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(r,s)&&this.connected_&&this.sendUnlisten_(r,s,e._queryObject,n)}sendUnlisten_(e,n,r,s){this.log_("Unlisten on "+e+" for "+n);const i={p:e},o="n";s&&(i.q=r,i.t=s),this.sendRequest(o,i)}onDisconnectPut(e,n,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",e,n,r):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:n,onComplete:r})}onDisconnectMerge(e,n,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",e,n,r):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:n,onComplete:r})}onDisconnectCancel(e,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",e,null,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:n})}sendOnDisconnect_(e,n,r,s){const i={p:n,d:r};this.log_("onDisconnect "+e,i),this.sendRequest(e,i,o=>{s&&setTimeout(()=>{s(o.s,o.d)},Math.floor(0))})}put(e,n,r,s){this.putInternal("p",e,n,r,s)}merge(e,n,r,s){this.putInternal("m",e,n,r,s)}putInternal(e,n,r,s,i){this.initConnection_();const o={p:n,d:r};i!==void 0&&(o.h=i),this.outstandingPuts_.push({action:e,request:o,onComplete:s}),this.outstandingPutCount_++;const a=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(a):this.log_("Buffering put: "+n)}sendPut_(e){const n=this.outstandingPuts_[e].action,r=this.outstandingPuts_[e].request,s=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(n,r,i=>{this.log_(n+" response",i),delete this.outstandingPuts_[e],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),s&&s(i.s,i.d)})}reportStats(e){if(this.connected_){const n={c:e};this.log_("reportStats",n),this.sendRequest("s",n,r=>{if(r.s!=="ok"){const i=r.d;this.log_("reportStats","Error sending stats: "+i)}})}}onDataMessage_(e){if("r"in e){this.log_("from server: "+mt(e));const n=e.r,r=this.requestCBHash_[n];r&&(delete this.requestCBHash_[n],r(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}}onDataPush_(e,n){this.log_("handleServerMessage",e,n),e==="d"?this.onDataUpdate_(n.p,n.d,!1,n.t):e==="m"?this.onDataUpdate_(n.p,n.d,!0,n.t):e==="c"?this.onListenRevoked_(n.p,n.q):e==="ac"?this.onAuthRevoked_(n.s,n.d):e==="apc"?this.onAppCheckRevoked_(n.s,n.d):e==="sd"?this.onSecurityDebugPacket_(n):cm("Unrecognized action received from server: "+mt(e)+`
Are you using the latest client?`)}onReady_(e,n){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(e),this.lastSessionId=n,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(e){x(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(e))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=gc,this.realtime_||this.scheduleConnect_(0)),this.visible_=e}onOnline_(e){e?(this.log_("Browser went online."),this.reconnectDelay_=gc,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>lW&&(this.reconnectDelay_=gc),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());const e=new Date().getTime()-this.lastConnectionAttemptTime_;let n=Math.max(0,this.reconnectDelay_-e);n=Math.random()*n,this.log_("Trying to reconnect in "+n+"ms"),this.scheduleConnect_(n),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*cW)}this.onConnectStatus_(!1)}async establishConnection_(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;const e=this.onDataMessage_.bind(this),n=this.onReady_.bind(this),r=this.onRealtimeDisconnect_.bind(this),s=this.id+":"+ts.nextConnectionId_++,i=this.lastSessionId;let o=!1,a=null;const c=function(){a?a.close():(o=!0,r())},l=function(h){x(a,"sendRequest call when we're not connected not allowed."),a.sendRequest(h)};this.realtime_={close:c,sendRequest:l};const u=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{const[h,d]=await Promise.all([this.authTokenProvider_.getToken(u),this.appCheckTokenProvider_.getToken(u)]);o?Tt("getToken() completed but was canceled"):(Tt("getToken() completed. Creating connection."),this.authToken_=h&&h.accessToken,this.appCheckToken_=d&&d.token,a=new tW(s,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,e,n,r,f=>{Jt(f+" ("+this.repoInfo_.toString()+")"),this.interrupt(uW)},i))}catch(h){this.log_("Failed to get token: "+h),o||(this.repoInfo_.nodeAdmin&&Jt(h),c())}}}interrupt(e){Tt("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(e){Tt("Resuming connection for reason: "+e),delete this.interruptReasons_[e],Uh(this.interruptReasons_)&&(this.reconnectDelay_=gc,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(e){const n=e-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:n})}cancelSentTransactions_(){for(let e=0;e<this.outstandingPuts_.length;e++){const n=this.outstandingPuts_[e];n&&"h"in n.request&&n.queued&&(n.onComplete&&n.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(e,n){let r;n?r=n.map(i=>hy(i)).join("$"):r="default";const s=this.removeListen_(e,r);s&&s.onComplete&&s.onComplete("permission_denied")}removeListen_(e,n){const r=new Ce(e).toString();let s;if(this.listens.has(r)){const i=this.listens.get(r);s=i.get(n),i.delete(n),i.size===0&&this.listens.delete(r)}else s=void 0;return s}onAuthRevoked_(e,n){Tt("Auth token revoked: "+e+"/"+n),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(e==="invalid_token"||e==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=DI&&(this.reconnectDelay_=PI,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(e,n){Tt("App check token revoked: "+e+"/"+n),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(e==="invalid_token"||e==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=DI&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const e of this.listens.values())for(const n of e.values())this.sendListen_(n);for(let e=0;e<this.outstandingPuts_.length;e++)this.outstandingPuts_[e]&&this.sendPut_(e);for(;this.onDisconnectRequestQueue_.length;){const e=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(e.action,e.pathString,e.data,e.onComplete)}for(let e=0;e<this.outstandingGets_.length;e++)this.outstandingGets_[e]&&this.sendGet_(e)}sendConnectStats_(){const e={};let n="js";e["sdk."+n+"."+AA.replace(/\./g,"-")]=1,Zd()?e["framework.cordova"]=1:ou()&&(e["framework.reactnative"]=1),this.reportStats(e)}shouldReconnect_(){const e=Zh.getInstance().currentlyOnline();return Uh(this.interruptReasons_)&&e}}ts.nextPersistentConnectionId_=0;ts.nextConnectionId_=0;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ge{constructor(e,n){this.name=e,this.node=n}static Wrap(e,n){return new ge(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vf{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,n){const r=new ge(is,e),s=new ge(is,n);return this.compare(r,s)!==0}minPost(){return ge.MIN}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Xu;class nk extends vf{static get __EMPTY_NODE(){return Xu}static set __EMPTY_NODE(e){Xu=e}compare(e,n){return To(e.name,n.name)}isDefinedOn(e){throw Ba("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,n){return!1}minPost(){return ge.MIN}maxPost(){return new ge(Mr,Xu)}makePost(e,n){return x(typeof e=="string","KeyIndex indexValue must always be a string."),new ge(e,Xu)}toString(){return".key"}}const Ar=new nk;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zu{constructor(e,n,r,s,i=null){this.isReverse_=s,this.resultGenerator_=i,this.nodeStack_=[];let o=1;for(;!e.isEmpty();)if(e=e,o=n?r(e.key,n):1,s&&(o*=-1),o<0)this.isReverse_?e=e.left:e=e.right;else if(o===0){this.nodeStack_.push(e);break}else this.nodeStack_.push(e),this.isReverse_?e=e.right:e=e.left}getNext(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_.pop(),n;if(this.resultGenerator_?n=this.resultGenerator_(e.key,e.value):n={key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return n}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;const e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}}class It{constructor(e,n,r,s,i){this.key=e,this.value=n,this.color=r!=null?r:It.RED,this.left=s!=null?s:yn.EMPTY_NODE,this.right=i!=null?i:yn.EMPTY_NODE}copy(e,n,r,s,i){return new It(e!=null?e:this.key,n!=null?n:this.value,r!=null?r:this.color,s!=null?s:this.left,i!=null?i:this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let s=this;const i=r(e,s.key);return i<0?s=s.copy(null,null,null,s.left.insert(e,n,r),null):i===0?s=s.copy(null,n,null,null,null):s=s.copy(null,null,null,null,s.right.insert(e,n,r)),s.fixUp_()}removeMin_(){if(this.left.isEmpty())return yn.EMPTY_NODE;let e=this;return!e.left.isRed_()&&!e.left.left.isRed_()&&(e=e.moveRedLeft_()),e=e.copy(null,null,null,e.left.removeMin_(),null),e.fixUp_()}remove(e,n){let r,s;if(r=this,n(e,r.key)<0)!r.left.isEmpty()&&!r.left.isRed_()&&!r.left.left.isRed_()&&(r=r.moveRedLeft_()),r=r.copy(null,null,null,r.left.remove(e,n),null);else{if(r.left.isRed_()&&(r=r.rotateRight_()),!r.right.isEmpty()&&!r.right.isRed_()&&!r.right.left.isRed_()&&(r=r.moveRedRight_()),n(e,r.key)===0){if(r.right.isEmpty())return yn.EMPTY_NODE;s=r.right.min_(),r=r.copy(s.key,s.value,null,null,r.right.removeMin_())}r=r.copy(null,null,null,null,r.right.remove(e,n))}return r.fixUp_()}isRed_(){return this.color}fixUp_(){let e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e}moveRedLeft_(){let e=this.colorFlip_();return e.right.left.isRed_()&&(e=e.copy(null,null,null,null,e.right.rotateRight_()),e=e.rotateLeft_(),e=e.colorFlip_()),e}moveRedRight_(){let e=this.colorFlip_();return e.left.left.isRed_()&&(e=e.rotateRight_(),e=e.colorFlip_()),e}rotateLeft_(){const e=this.copy(null,null,It.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight_(){const e=this.copy(null,null,It.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip_(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth_(){const e=this.check_();return Math.pow(2,e)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)}}It.RED=!0;It.BLACK=!1;class hW{copy(e,n,r,s,i){return this}insert(e,n,r){return new It(e,n,null)}remove(e,n){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}}class yn{constructor(e,n=yn.EMPTY_NODE){this.comparator_=e,this.root_=n}insert(e,n){return new yn(this.comparator_,this.root_.insert(e,n,this.comparator_).copy(null,null,It.BLACK,null,null))}remove(e){return new yn(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,It.BLACK,null,null))}get(e){let n,r=this.root_;for(;!r.isEmpty();){if(n=this.comparator_(e,r.key),n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}getPredecessorKey(e){let n,r=this.root_,s=null;for(;!r.isEmpty();)if(n=this.comparator_(e,r.key),n===0){if(r.left.isEmpty())return s?s.key:null;for(r=r.left;!r.right.isEmpty();)r=r.right;return r.key}else n<0?r=r.left:n>0&&(s=r,r=r.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new Zu(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,n){return new Zu(this.root_,e,this.comparator_,!1,n)}getReverseIteratorFrom(e,n){return new Zu(this.root_,e,this.comparator_,!0,n)}getReverseIterator(e){return new Zu(this.root_,null,this.comparator_,!0,e)}}yn.EMPTY_NODE=new hW;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dW(t,e){return To(t.name,e.name)}function vy(t,e){return To(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let um;function fW(t){um=t}const rk=function(t){return typeof t=="number"?"number:"+OA(t):"string:"+t},sk=function(t){if(t.isLeafNode()){const e=t.val();x(typeof e=="string"||typeof e=="number"||typeof e=="object"&&xn(e,".sv"),"Priority must be a string or number.")}else x(t===um||t.isEmpty(),"priority of unexpected type.");x(t===um||t.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let xI;class vt{constructor(e,n=vt.__childrenNodeConstructor.EMPTY_NODE){this.value_=e,this.priorityNode_=n,this.lazyHash_=null,x(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),sk(this.priorityNode_)}static set __childrenNodeConstructor(e){xI=e}static get __childrenNodeConstructor(){return xI}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(e){return new vt(this.value_,e)}getImmediateChild(e){return e===".priority"?this.priorityNode_:vt.__childrenNodeConstructor.EMPTY_NODE}getChild(e){return pe(e)?this:fe(e)===".priority"?this.priorityNode_:vt.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(e,n){return null}updateImmediateChild(e,n){return e===".priority"?this.updatePriority(n):n.isEmpty()&&e!==".priority"?this:vt.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,n).updatePriority(this.priorityNode_)}updateChild(e,n){const r=fe(e);return r===null?n:n.isEmpty()&&r!==".priority"?this:(x(r!==".priority"||zs(e)===1,".priority must be the last token in a path"),this.updateImmediateChild(r,vt.__childrenNodeConstructor.EMPTY_NODE.updateChild(Me(e),n)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(e,n){return!1}val(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let e="";this.priorityNode_.isEmpty()||(e+="priority:"+rk(this.priorityNode_.val())+":");const n=typeof this.value_;e+=n+":",n==="number"?e+=OA(this.value_):e+=this.value_,this.lazyHash_=PA(e)}return this.lazyHash_}getValue(){return this.value_}compareTo(e){return e===vt.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof vt.__childrenNodeConstructor?-1:(x(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))}compareToLeafNode_(e){const n=typeof e.value_,r=typeof this.value_,s=vt.VALUE_TYPE_ORDER.indexOf(n),i=vt.VALUE_TYPE_ORDER.indexOf(r);return x(s>=0,"Unknown leaf type: "+n),x(i>=0,"Unknown leaf type: "+r),s===i?r==="object"?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:i-s}withIndex(){return this}isIndexed(){return!0}equals(e){if(e===this)return!0;if(e.isLeafNode()){const n=e;return this.value_===n.value_&&this.priorityNode_.equals(n.priorityNode_)}else return!1}}vt.VALUE_TYPE_ORDER=["object","boolean","number","string"];/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ik,ok;function pW(t){ik=t}function gW(t){ok=t}class mW extends vf{compare(e,n){const r=e.node.getPriority(),s=n.node.getPriority(),i=r.compareTo(s);return i===0?To(e.name,n.name):i}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,n){return!e.getPriority().equals(n.getPriority())}minPost(){return ge.MIN}maxPost(){return new ge(Mr,new vt("[PRIORITY-POST]",ok))}makePost(e,n){const r=ik(e);return new ge(n,new vt("[PRIORITY-POST]",r))}toString(){return".priority"}}const qe=new mW;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _W=Math.log(2);class yW{constructor(e){const n=i=>parseInt(Math.log(i)/_W,10),r=i=>parseInt(Array(i+1).join("1"),2);this.count=n(e+1),this.current_=this.count-1;const s=r(this.count);this.bits_=e+1&s}nextBitIsOne(){const e=!(this.bits_&1<<this.current_);return this.current_--,e}}const ed=function(t,e,n,r){t.sort(e);const s=function(c,l){const u=l-c;let h,d;if(u===0)return null;if(u===1)return h=t[c],d=n?n(h):h,new It(d,h.node,It.BLACK,null,null);{const f=parseInt(u/2,10)+c,p=s(c,f),_=s(f+1,l);return h=t[f],d=n?n(h):h,new It(d,h.node,It.BLACK,p,_)}},i=function(c){let l=null,u=null,h=t.length;const d=function(p,_){const y=h-p,I=h;h-=p;const N=s(y+1,I),k=t[y],M=n?n(k):k;f(new It(M,k.node,_,null,N))},f=function(p){l?(l.left=p,l=p):(u=p,l=p)};for(let p=0;p<c.count;++p){const _=c.nextBitIsOne(),y=Math.pow(2,c.count-(p+1));_?d(y,It.BLACK):(d(y,It.BLACK),d(y,It.RED))}return u},o=new yW(t.length),a=i(o);return new yn(r||e,a)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Wp;const Fo={};class Yr{constructor(e,n){this.indexes_=e,this.indexSet_=n}static get Default(){return x(Fo&&qe,"ChildrenNode.ts has not been loaded"),Wp=Wp||new Yr({".priority":Fo},{".priority":qe}),Wp}get(e){const n=Gi(this.indexes_,e);if(!n)throw new Error("No index defined for "+e);return n instanceof yn?n:null}hasIndex(e){return xn(this.indexSet_,e.toString())}addIndex(e,n){x(e!==Ar,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const r=[];let s=!1;const i=n.getIterator(ge.Wrap);let o=i.getNext();for(;o;)s=s||e.isDefinedOn(o.node),r.push(o),o=i.getNext();let a;s?a=ed(r,e.getCompare()):a=Fo;const c=e.toString(),l=Object.assign({},this.indexSet_);l[c]=e;const u=Object.assign({},this.indexes_);return u[c]=a,new Yr(u,l)}addToIndexes(e,n){const r=$h(this.indexes_,(s,i)=>{const o=Gi(this.indexSet_,i);if(x(o,"Missing index implementation for "+i),s===Fo)if(o.isDefinedOn(e.node)){const a=[],c=n.getIterator(ge.Wrap);let l=c.getNext();for(;l;)l.name!==e.name&&a.push(l),l=c.getNext();return a.push(e),ed(a,o.getCompare())}else return Fo;else{const a=n.get(e.name);let c=s;return a&&(c=c.remove(new ge(e.name,a))),c.insert(e,e.node)}});return new Yr(r,this.indexSet_)}removeFromIndexes(e,n){const r=$h(this.indexes_,s=>{if(s===Fo)return s;{const i=n.get(e.name);return i?s.remove(new ge(e.name,i)):s}});return new Yr(r,this.indexSet_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let mc;class te{constructor(e,n,r){this.children_=e,this.priorityNode_=n,this.indexMap_=r,this.lazyHash_=null,this.priorityNode_&&sk(this.priorityNode_),this.children_.isEmpty()&&x(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return mc||(mc=new te(new yn(vy),null,Yr.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||mc}updatePriority(e){return this.children_.isEmpty()?this:new te(this.children_,e,this.indexMap_)}getImmediateChild(e){if(e===".priority")return this.getPriority();{const n=this.children_.get(e);return n===null?mc:n}}getChild(e){const n=fe(e);return n===null?this:this.getImmediateChild(n).getChild(Me(e))}hasChild(e){return this.children_.get(e)!==null}updateImmediateChild(e,n){if(x(n,"We should always be passing snapshot nodes"),e===".priority")return this.updatePriority(n);{const r=new ge(e,n);let s,i;n.isEmpty()?(s=this.children_.remove(e),i=this.indexMap_.removeFromIndexes(r,this.children_)):(s=this.children_.insert(e,n),i=this.indexMap_.addToIndexes(r,this.children_));const o=s.isEmpty()?mc:this.priorityNode_;return new te(s,o,i)}}updateChild(e,n){const r=fe(e);if(r===null)return n;{x(fe(e)!==".priority"||zs(e)===1,".priority must be the last token in a path");const s=this.getImmediateChild(r).updateChild(Me(e),n);return this.updateImmediateChild(r,s)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(e){if(this.isEmpty())return null;const n={};let r=0,s=0,i=!0;if(this.forEachChild(qe,(o,a)=>{n[o]=a.val(e),r++,i&&te.INTEGER_REGEXP_.test(o)?s=Math.max(s,Number(o)):i=!1}),!e&&i&&s<2*r){const o=[];for(const a in n)o[a]=n[a];return o}else return e&&!this.getPriority().isEmpty()&&(n[".priority"]=this.getPriority().val()),n}hash(){if(this.lazyHash_===null){let e="";this.getPriority().isEmpty()||(e+="priority:"+rk(this.getPriority().val())+":"),this.forEachChild(qe,(n,r)=>{const s=r.hash();s!==""&&(e+=":"+n+":"+s)}),this.lazyHash_=e===""?"":PA(e)}return this.lazyHash_}getPredecessorChildName(e,n,r){const s=this.resolveIndex_(r);if(s){const i=s.getPredecessorKey(new ge(e,n));return i?i.name:null}else return this.children_.getPredecessorKey(e)}getFirstChildName(e){const n=this.resolveIndex_(e);if(n){const r=n.minKey();return r&&r.name}else return this.children_.minKey()}getFirstChild(e){const n=this.getFirstChildName(e);return n?new ge(n,this.children_.get(n)):null}getLastChildName(e){const n=this.resolveIndex_(e);if(n){const r=n.maxKey();return r&&r.name}else return this.children_.maxKey()}getLastChild(e){const n=this.getLastChildName(e);return n?new ge(n,this.children_.get(n)):null}forEachChild(e,n){const r=this.resolveIndex_(e);return r?r.inorderTraversal(s=>n(s.name,s.node)):this.children_.inorderTraversal(n)}getIterator(e){return this.getIteratorFrom(e.minPost(),e)}getIteratorFrom(e,n){const r=this.resolveIndex_(n);if(r)return r.getIteratorFrom(e,s=>s);{const s=this.children_.getIteratorFrom(e.name,ge.Wrap);let i=s.peek();for(;i!=null&&n.compare(i,e)<0;)s.getNext(),i=s.peek();return s}}getReverseIterator(e){return this.getReverseIteratorFrom(e.maxPost(),e)}getReverseIteratorFrom(e,n){const r=this.resolveIndex_(n);if(r)return r.getReverseIteratorFrom(e,s=>s);{const s=this.children_.getReverseIteratorFrom(e.name,ge.Wrap);let i=s.peek();for(;i!=null&&n.compare(i,e)>0;)s.getNext(),i=s.peek();return s}}compareTo(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===gu?-1:0}withIndex(e){if(e===Ar||this.indexMap_.hasIndex(e))return this;{const n=this.indexMap_.addIndex(e,this.children_);return new te(this.children_,this.priorityNode_,n)}}isIndexed(e){return e===Ar||this.indexMap_.hasIndex(e)}equals(e){if(e===this)return!0;if(e.isLeafNode())return!1;{const n=e;if(this.getPriority().equals(n.getPriority()))if(this.children_.count()===n.children_.count()){const r=this.getIterator(qe),s=n.getIterator(qe);let i=r.getNext(),o=s.getNext();for(;i&&o;){if(i.name!==o.name||!i.node.equals(o.node))return!1;i=r.getNext(),o=s.getNext()}return i===null&&o===null}else return!1;else return!1}}resolveIndex_(e){return e===Ar?null:this.indexMap_.get(e.toString())}}te.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;class vW extends te{constructor(){super(new yn(vy),te.EMPTY_NODE,Yr.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return te.EMPTY_NODE}isEmpty(){return!1}}const gu=new vW;Object.defineProperties(ge,{MIN:{value:new ge(is,te.EMPTY_NODE)},MAX:{value:new ge(Mr,gu)}});nk.__EMPTY_NODE=te.EMPTY_NODE;vt.__childrenNodeConstructor=te;fW(gu);gW(gu);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wW=!0;function Qe(t,e=null){if(t===null)return te.EMPTY_NODE;if(typeof t=="object"&&".priority"in t&&(e=t[".priority"]),x(e===null||typeof e=="string"||typeof e=="number"||typeof e=="object"&&".sv"in e,"Invalid priority type found: "+typeof e),typeof t=="object"&&".value"in t&&t[".value"]!==null&&(t=t[".value"]),typeof t!="object"||".sv"in t){const n=t;return new vt(n,Qe(e))}if(!(t instanceof Array)&&wW){const n=[];let r=!1;if(xt(t,(o,a)=>{if(o.substring(0,1)!=="."){const c=Qe(a);c.isEmpty()||(r=r||!c.getPriority().isEmpty(),n.push(new ge(o,c)))}}),n.length===0)return te.EMPTY_NODE;const i=ed(n,dW,o=>o.name,vy);if(r){const o=ed(n,qe.getCompare());return new te(i,Qe(e),new Yr({".priority":o},{".priority":qe}))}else return new te(i,Qe(e),Yr.Default)}else{let n=te.EMPTY_NODE;return xt(t,(r,s)=>{if(xn(t,r)&&r.substring(0,1)!=="."){const i=Qe(s);(i.isLeafNode()||!i.isEmpty())&&(n=n.updateImmediateChild(r,i))}}),n.updatePriority(Qe(e))}}pW(Qe);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wy extends vf{constructor(e){super(),this.indexPath_=e,x(!pe(e)&&fe(e)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,n){const r=this.extractChild(e.node),s=this.extractChild(n.node),i=r.compareTo(s);return i===0?To(e.name,n.name):i}makePost(e,n){const r=Qe(e),s=te.EMPTY_NODE.updateChild(this.indexPath_,r);return new ge(n,s)}maxPost(){const e=te.EMPTY_NODE.updateChild(this.indexPath_,gu);return new ge(Mr,e)}toString(){return Al(this.indexPath_,0).join("/")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bW extends vf{compare(e,n){const r=e.node.compareTo(n.node);return r===0?To(e.name,n.name):r}isDefinedOn(e){return!0}indexedValueChanged(e,n){return!e.equals(n)}minPost(){return ge.MIN}maxPost(){return ge.MAX}makePost(e,n){const r=Qe(e);return new ge(n,r)}toString(){return".value"}}const by=new bW;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ba="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",hm="-",ak="z",ck=786,IW=function(){let t=0;const e=[];return function(n){const r=n===t;t=n;let s;const i=new Array(8);for(s=7;s>=0;s--)i[s]=ba.charAt(n%64),n=Math.floor(n/64);x(n===0,"Cannot push at time == 0");let o=i.join("");if(r){for(s=11;s>=0&&e[s]===63;s--)e[s]=0;e[s]++}else for(s=0;s<12;s++)e[s]=Math.floor(Math.random()*64);for(s=0;s<12;s++)o+=ba.charAt(e[s]);return x(o.length===20,"nextPushId: Length should be 20."),o}}(),OI=function(t){if(t===""+dy)return hm;const e=Jh(t);if(e!=null)return""+(e+1);const n=new Array(t.length);for(let o=0;o<n.length;o++)n[o]=t.charAt(o);if(n.length<ck)return n.push(hm),n.join("");let r=n.length-1;for(;r>=0&&n[r]===ak;)r--;if(r===-1)return Mr;const s=n[r],i=ba.charAt(ba.indexOf(s)+1);return n[r]=i,n.slice(0,r+1).join("")},MI=function(t){if(t===""+MA)return is;const e=Jh(t);if(e!=null)return""+(e-1);const n=new Array(t.length);for(let r=0;r<n.length;r++)n[r]=t.charAt(r);return n[n.length-1]===hm?n.length===1?""+dy:(delete n[n.length-1],n.join("")):(n[n.length-1]=ba.charAt(ba.indexOf(n[n.length-1])-1),n.join("")+ak.repeat(ck-n.length))};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lk(t){return{type:"value",snapshotNode:t}}function Ia(t,e){return{type:"child_added",snapshotNode:e,childName:t}}function kl(t,e){return{type:"child_removed",snapshotNode:e,childName:t}}function Rl(t,e,n){return{type:"child_changed",snapshotNode:e,childName:t,oldSnap:n}}function EW(t,e){return{type:"child_moved",snapshotNode:e,childName:t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Iy{constructor(e){this.index_=e}updateChild(e,n,r,s,i,o){x(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");const a=e.getImmediateChild(n);return a.getChild(s).equals(r.getChild(s))&&a.isEmpty()===r.isEmpty()||(o!=null&&(r.isEmpty()?e.hasChild(n)?o.trackChildChange(kl(n,a)):x(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):a.isEmpty()?o.trackChildChange(Ia(n,r)):o.trackChildChange(Rl(n,r,a))),e.isLeafNode()&&r.isEmpty())?e:e.updateImmediateChild(n,r).withIndex(this.index_)}updateFullNode(e,n,r){return r!=null&&(e.isLeafNode()||e.forEachChild(qe,(s,i)=>{n.hasChild(s)||r.trackChildChange(kl(s,i))}),n.isLeafNode()||n.forEachChild(qe,(s,i)=>{if(e.hasChild(s)){const o=e.getImmediateChild(s);o.equals(i)||r.trackChildChange(Rl(s,i,o))}else r.trackChildChange(Ia(s,i))})),n.withIndex(this.index_)}updatePriority(e,n){return e.isEmpty()?te.EMPTY_NODE:e.updatePriority(n)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nl{constructor(e){this.indexedFilter_=new Iy(e.getIndex()),this.index_=e.getIndex(),this.startPost_=Nl.getStartPost_(e),this.endPost_=Nl.getEndPost_(e)}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){return this.index_.compare(this.getStartPost(),e)<=0&&this.index_.compare(e,this.getEndPost())<=0}updateChild(e,n,r,s,i,o){return this.matches(new ge(n,r))||(r=te.EMPTY_NODE),this.indexedFilter_.updateChild(e,n,r,s,i,o)}updateFullNode(e,n,r){n.isLeafNode()&&(n=te.EMPTY_NODE);let s=n.withIndex(this.index_);s=s.updatePriority(te.EMPTY_NODE);const i=this;return n.forEachChild(qe,(o,a)=>{i.matches(new ge(o,a))||(s=s.updateImmediateChild(o,te.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,s,r)}updatePriority(e,n){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){const n=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),n)}else return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){const n=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),n)}else return e.getIndex().maxPost()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TW{constructor(e){this.rangedFilter_=new Nl(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft()}updateChild(e,n,r,s,i,o){return this.rangedFilter_.matches(new ge(n,r))||(r=te.EMPTY_NODE),e.getImmediateChild(n).equals(r)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,n,r,s,i,o):this.fullLimitUpdateChild_(e,n,r,i,o)}updateFullNode(e,n,r){let s;if(n.isLeafNode()||n.isEmpty())s=te.EMPTY_NODE.withIndex(this.index_);else if(this.limit_*2<n.numChildren()&&n.isIndexed(this.index_)){s=te.EMPTY_NODE.withIndex(this.index_);let i;this.reverse_?i=n.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):i=n.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let o=0;for(;i.hasNext()&&o<this.limit_;){const a=i.getNext();let c;if(this.reverse_?c=this.index_.compare(this.rangedFilter_.getStartPost(),a)<=0:c=this.index_.compare(a,this.rangedFilter_.getEndPost())<=0,c)s=s.updateImmediateChild(a.name,a.node),o++;else break}}else{s=n.withIndex(this.index_),s=s.updatePriority(te.EMPTY_NODE);let i,o,a,c;if(this.reverse_){c=s.getReverseIterator(this.index_),i=this.rangedFilter_.getEndPost(),o=this.rangedFilter_.getStartPost();const h=this.index_.getCompare();a=(d,f)=>h(f,d)}else c=s.getIterator(this.index_),i=this.rangedFilter_.getStartPost(),o=this.rangedFilter_.getEndPost(),a=this.index_.getCompare();let l=0,u=!1;for(;c.hasNext();){const h=c.getNext();!u&&a(i,h)<=0&&(u=!0),u&&l<this.limit_&&a(h,o)<=0?l++:s=s.updateImmediateChild(h.name,te.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,s,r)}updatePriority(e,n){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,n,r,s,i){let o;if(this.reverse_){const h=this.index_.getCompare();o=(d,f)=>h(f,d)}else o=this.index_.getCompare();const a=e;x(a.numChildren()===this.limit_,"");const c=new ge(n,r),l=this.reverse_?a.getFirstChild(this.index_):a.getLastChild(this.index_),u=this.rangedFilter_.matches(c);if(a.hasChild(n)){const h=a.getImmediateChild(n);let d=s.getChildAfterChild(this.index_,l,this.reverse_);for(;d!=null&&(d.name===n||a.hasChild(d.name));)d=s.getChildAfterChild(this.index_,d,this.reverse_);const f=d==null?1:o(d,c);if(u&&!r.isEmpty()&&f>=0)return i!=null&&i.trackChildChange(Rl(n,r,h)),a.updateImmediateChild(n,r);{i!=null&&i.trackChildChange(kl(n,h));const _=a.updateImmediateChild(n,te.EMPTY_NODE);return d!=null&&this.rangedFilter_.matches(d)?(i!=null&&i.trackChildChange(Ia(d.name,d.node)),_.updateImmediateChild(d.name,d.node)):_}}else return r.isEmpty()?e:u&&o(l,c)>=0?(i!=null&&(i.trackChildChange(kl(l.name,l.node)),i.trackChildChange(Ia(n,r))),a.updateImmediateChild(n,r).updateImmediateChild(l.name,te.EMPTY_NODE)):e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wf{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=qe}hasStart(){return this.startSet_}hasStartAfter(){return this.startAfterSet_}hasEndBefore(){return this.endBeforeSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return x(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return x(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:is}hasEnd(){return this.endSet_}getIndexEndValue(){return x(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return x(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:Mr}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return x(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===qe}copy(){const e=new wf;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}}function SW(t){return t.loadsAllData()?new Iy(t.getIndex()):t.hasLimit()?new TW(t):new Nl(t)}function CW(t,e){const n=t.copy();return n.limitSet_=!0,n.limit_=e,n.viewFrom_="l",n}function AW(t,e){const n=t.copy();return n.limitSet_=!0,n.limit_=e,n.viewFrom_="r",n}function dm(t,e,n){const r=t.copy();return r.startSet_=!0,e===void 0&&(e=null),r.indexStartValue_=e,n!=null?(r.startNameSet_=!0,r.indexStartName_=n):(r.startNameSet_=!1,r.indexStartName_=""),r}function kW(t,e,n){let r;if(t.index_===Ar)typeof e=="string"&&(e=OI(e)),r=dm(t,e,n);else{let s;n==null?s=Mr:s=OI(n),r=dm(t,e,s)}return r.startAfterSet_=!0,r}function fm(t,e,n){const r=t.copy();return r.endSet_=!0,e===void 0&&(e=null),r.indexEndValue_=e,n!==void 0?(r.endNameSet_=!0,r.indexEndName_=n):(r.endNameSet_=!1,r.indexEndName_=""),r}function RW(t,e,n){let r,s;return t.index_===Ar?(typeof e=="string"&&(e=MI(e)),s=fm(t,e,n)):(n==null?r=is:r=MI(n),s=fm(t,e,r)),s.endBeforeSet_=!0,s}function bf(t,e){const n=t.copy();return n.index_=e,n}function LI(t){const e={};if(t.isDefault())return e;let n;return t.index_===qe?n="$priority":t.index_===by?n="$value":t.index_===Ar?n="$key":(x(t.index_ instanceof wy,"Unrecognized index type!"),n=t.index_.toString()),e.orderBy=mt(n),t.startSet_&&(e.startAt=mt(t.indexStartValue_),t.startNameSet_&&(e.startAt+=","+mt(t.indexStartName_))),t.endSet_&&(e.endAt=mt(t.indexEndValue_),t.endNameSet_&&(e.endAt+=","+mt(t.indexEndName_))),t.limitSet_&&(t.isViewFromLeft()?e.limitToFirst=t.limit_:e.limitToLast=t.limit_),e}function FI(t){const e={};if(t.startSet_&&(e.sp=t.indexStartValue_,t.startNameSet_&&(e.sn=t.indexStartName_)),t.endSet_&&(e.ep=t.indexEndValue_,t.endNameSet_&&(e.en=t.indexEndName_)),t.limitSet_){e.l=t.limit_;let n=t.viewFrom_;n===""&&(t.isViewFromLeft()?n="l":n="r"),e.vf=n}return t.index_!==qe&&(e.i=t.index_.toString()),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class td extends XA{constructor(e,n,r,s){super(),this.repoInfo_=e,this.onDataUpdate_=n,this.authTokenProvider_=r,this.appCheckTokenProvider_=s,this.log_=pu("p:rest:"),this.listens_={}}reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,n){return n!==void 0?"tag$"+n:(x(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}listen(e,n,r,s){const i=e._path.toString();this.log_("Listen called for "+i+" "+e._queryIdentifier);const o=td.getListenId_(e,r),a={};this.listens_[o]=a;const c=LI(e._queryParams);this.restRequest_(i+".json",c,(l,u)=>{let h=u;if(l===404&&(h=null,l=null),l===null&&this.onDataUpdate_(i,h,!1,r),Gi(this.listens_,o)===a){let d;l?l===401?d="permission_denied":d="rest_error:"+l:d="ok",s(d,null)}})}unlisten(e,n){const r=td.getListenId_(e,n);delete this.listens_[r]}get(e){const n=LI(e._queryParams),r=e._path.toString(),s=new gt;return this.restRequest_(r+".json",n,(i,o)=>{let a=o;i===404&&(a=null,i=null),i===null?(this.onDataUpdate_(r,a,!1,null),s.resolve(a)):s.reject(new Error(a))}),s.promise}refreshAuthToken(e){}restRequest_(e,n={},r){return n.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([s,i])=>{s&&s.accessToken&&(n.auth=s.accessToken),i&&i.token&&(n.ac=i.token);const o=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+bo(n);this.log_("Sending REST request for "+o);const a=new XMLHttpRequest;a.onreadystatechange=()=>{if(r&&a.readyState===4){this.log_("REST Response for "+o+" received. status:",a.status,"response:",a.responseText);let c=null;if(a.status>=200&&a.status<300){try{c=gl(a.responseText)}catch{Jt("Failed to parse JSON response for "+o+": "+a.responseText)}r(null,c)}else a.status!==401&&a.status!==404&&Jt("Got unsuccessful REST response for "+o+" Status: "+a.status),r(a.status);r=null}},a.open("GET",o,!0),a.send()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NW{constructor(){this.rootNode_=te.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,n){this.rootNode_=this.rootNode_.updateChild(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nd(){return{value:null,children:new Map}}function za(t,e,n){if(pe(e))t.value=n,t.children.clear();else if(t.value!==null)t.value=t.value.updateChild(e,n);else{const r=fe(e);t.children.has(r)||t.children.set(r,nd());const s=t.children.get(r);e=Me(e),za(s,e,n)}}function pm(t,e){if(pe(e))return t.value=null,t.children.clear(),!0;if(t.value!==null){if(t.value.isLeafNode())return!1;{const n=t.value;return t.value=null,n.forEachChild(qe,(r,s)=>{za(t,new Ce(r),s)}),pm(t,e)}}else if(t.children.size>0){const n=fe(e);return e=Me(e),t.children.has(n)&&pm(t.children.get(n),e)&&t.children.delete(n),t.children.size===0}else return!0}function gm(t,e,n){t.value!==null?n(e,t.value):PW(t,(r,s)=>{const i=new Ce(e.toString()+"/"+r);gm(s,i,n)})}function PW(t,e){t.children.forEach((n,r)=>{e(r,n)})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DW{constructor(e){this.collection_=e,this.last_=null}get(){const e=this.collection_.get(),n=Object.assign({},e);return this.last_&&xt(this.last_,(r,s)=>{n[r]=n[r]-s}),this.last_=e,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UI=10*1e3,xW=30*1e3,OW=5*60*1e3;class MW{constructor(e,n){this.server_=n,this.statsToReport_={},this.statsListener_=new DW(e);const r=UI+(xW-UI)*Math.random();jc(this.reportStats_.bind(this),Math.floor(r))}reportStats_(){const e=this.statsListener_.get(),n={};let r=!1;xt(e,(s,i)=>{i>0&&xn(this.statsToReport_,s)&&(n[s]=i,r=!0)}),r&&this.server_.reportStats(n),jc(this.reportStats_.bind(this),Math.floor(Math.random()*2*OW))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var rr;(function(t){t[t.OVERWRITE=0]="OVERWRITE",t[t.MERGE=1]="MERGE",t[t.ACK_USER_WRITE=2]="ACK_USER_WRITE",t[t.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"})(rr||(rr={}));function Ey(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function Ty(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function Sy(t){return{fromUser:!1,fromServer:!0,queryId:t,tagged:!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rd{constructor(e,n,r){this.path=e,this.affectedTree=n,this.revert=r,this.type=rr.ACK_USER_WRITE,this.source=Ey()}operationForChild(e){if(pe(this.path)){if(this.affectedTree.value!=null)return x(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const n=this.affectedTree.subtree(new Ce(e));return new rd(Te(),n,this.revert)}}else return x(fe(this.path)===e,"operationForChild called for unrelated child."),new rd(Me(this.path),this.affectedTree,this.revert)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pl{constructor(e,n){this.source=e,this.path=n,this.type=rr.LISTEN_COMPLETE}operationForChild(e){return pe(this.path)?new Pl(this.source,Te()):new Pl(this.source,Me(this.path))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zi{constructor(e,n,r){this.source=e,this.path=n,this.snap=r,this.type=rr.OVERWRITE}operationForChild(e){return pe(this.path)?new Zi(this.source,Te(),this.snap.getImmediateChild(e)):new Zi(this.source,Me(this.path),this.snap)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ea{constructor(e,n,r){this.source=e,this.path=n,this.children=r,this.type=rr.MERGE}operationForChild(e){if(pe(this.path)){const n=this.children.subtree(new Ce(e));return n.isEmpty()?null:n.value?new Zi(this.source,Te(),n.value):new Ea(this.source,Te(),n)}else return x(fe(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new Ea(this.source,Me(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qs{constructor(e,n,r){this.node_=e,this.fullyInitialized_=n,this.filtered_=r}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(pe(e))return this.isFullyInitialized()&&!this.filtered_;const n=fe(e);return this.isCompleteForChild(n)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LW{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}}function FW(t,e,n,r){const s=[],i=[];return e.forEach(o=>{o.type==="child_changed"&&t.index_.indexedValueChanged(o.oldSnap,o.snapshotNode)&&i.push(EW(o.childName,o.snapshotNode))}),_c(t,s,"child_removed",e,r,n),_c(t,s,"child_added",e,r,n),_c(t,s,"child_moved",i,r,n),_c(t,s,"child_changed",e,r,n),_c(t,s,"value",e,r,n),s}function _c(t,e,n,r,s,i){const o=r.filter(a=>a.type===n);o.sort((a,c)=>$W(t,a,c)),o.forEach(a=>{const c=UW(t,a,i);s.forEach(l=>{l.respondsTo(a.type)&&e.push(l.createEvent(c,t.query_))})})}function UW(t,e,n){return e.type==="value"||e.type==="child_removed"||(e.prevName=n.getPredecessorChildName(e.childName,e.snapshotNode,t.index_)),e}function $W(t,e,n){if(e.childName==null||n.childName==null)throw Ba("Should only compare child_ events.");const r=new ge(e.childName,e.snapshotNode),s=new ge(n.childName,n.snapshotNode);return t.index_.compare(r,s)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function If(t,e){return{eventCache:t,serverCache:e}}function Kc(t,e,n,r){return If(new Qs(e,n,r),t.serverCache)}function uk(t,e,n,r){return If(t.eventCache,new Qs(e,n,r))}function sd(t){return t.eventCache.isFullyInitialized()?t.eventCache.getNode():null}function eo(t){return t.serverCache.isFullyInitialized()?t.serverCache.getNode():null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Hp;const VW=()=>(Hp||(Hp=new yn(EK)),Hp);class Ve{constructor(e,n=VW()){this.value=e,this.children=n}static fromObject(e){let n=new Ve(null);return xt(e,(r,s)=>{n=n.set(new Ce(r),s)}),n}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,n){if(this.value!=null&&n(this.value))return{path:Te(),value:this.value};if(pe(e))return null;{const r=fe(e),s=this.children.get(r);if(s!==null){const i=s.findRootMostMatchingPathAndValue(Me(e),n);return i!=null?{path:Ge(new Ce(r),i.path),value:i.value}:null}else return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(pe(e))return this;{const n=fe(e),r=this.children.get(n);return r!==null?r.subtree(Me(e)):new Ve(null)}}set(e,n){if(pe(e))return new Ve(n,this.children);{const r=fe(e),i=(this.children.get(r)||new Ve(null)).set(Me(e),n),o=this.children.insert(r,i);return new Ve(this.value,o)}}remove(e){if(pe(e))return this.children.isEmpty()?new Ve(null):new Ve(null,this.children);{const n=fe(e),r=this.children.get(n);if(r){const s=r.remove(Me(e));let i;return s.isEmpty()?i=this.children.remove(n):i=this.children.insert(n,s),this.value===null&&i.isEmpty()?new Ve(null):new Ve(this.value,i)}else return this}}get(e){if(pe(e))return this.value;{const n=fe(e),r=this.children.get(n);return r?r.get(Me(e)):null}}setTree(e,n){if(pe(e))return n;{const r=fe(e),i=(this.children.get(r)||new Ve(null)).setTree(Me(e),n);let o;return i.isEmpty()?o=this.children.remove(r):o=this.children.insert(r,i),new Ve(this.value,o)}}fold(e){return this.fold_(Te(),e)}fold_(e,n){const r={};return this.children.inorderTraversal((s,i)=>{r[s]=i.fold_(Ge(e,s),n)}),n(e,this.value,r)}findOnPath(e,n){return this.findOnPath_(e,Te(),n)}findOnPath_(e,n,r){const s=this.value?r(n,this.value):!1;if(s)return s;if(pe(e))return null;{const i=fe(e),o=this.children.get(i);return o?o.findOnPath_(Me(e),Ge(n,i),r):null}}foreachOnPath(e,n){return this.foreachOnPath_(e,Te(),n)}foreachOnPath_(e,n,r){if(pe(e))return this;{this.value&&r(n,this.value);const s=fe(e),i=this.children.get(s);return i?i.foreachOnPath_(Me(e),Ge(n,s),r):new Ve(null)}}foreach(e){this.foreach_(Te(),e)}foreach_(e,n){this.children.inorderTraversal((r,s)=>{s.foreach_(Ge(e,r),n)}),this.value&&n(e,this.value)}foreachChild(e){this.children.inorderTraversal((n,r)=>{r.value&&e(n,r.value)})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cr{constructor(e){this.writeTree_=e}static empty(){return new cr(new Ve(null))}}function Wc(t,e,n){if(pe(e))return new cr(new Ve(n));{const r=t.writeTree_.findRootMostValueAndPath(e);if(r!=null){const s=r.path;let i=r.value;const o=ln(s,e);return i=i.updateChild(o,n),new cr(t.writeTree_.set(s,i))}else{const s=new Ve(n),i=t.writeTree_.setTree(e,s);return new cr(i)}}}function mm(t,e,n){let r=t;return xt(n,(s,i)=>{r=Wc(r,Ge(e,s),i)}),r}function $I(t,e){if(pe(e))return cr.empty();{const n=t.writeTree_.setTree(e,new Ve(null));return new cr(n)}}function _m(t,e){return So(t,e)!=null}function So(t,e){const n=t.writeTree_.findRootMostValueAndPath(e);return n!=null?t.writeTree_.get(n.path).getChild(ln(n.path,e)):null}function VI(t){const e=[],n=t.writeTree_.value;return n!=null?n.isLeafNode()||n.forEachChild(qe,(r,s)=>{e.push(new ge(r,s))}):t.writeTree_.children.inorderTraversal((r,s)=>{s.value!=null&&e.push(new ge(r,s.value))}),e}function Us(t,e){if(pe(e))return t;{const n=So(t,e);return n!=null?new cr(new Ve(n)):new cr(t.writeTree_.subtree(e))}}function ym(t){return t.writeTree_.isEmpty()}function Ta(t,e){return hk(Te(),t.writeTree_,e)}function hk(t,e,n){if(e.value!=null)return n.updateChild(t,e.value);{let r=null;return e.children.inorderTraversal((s,i)=>{s===".priority"?(x(i.value!==null,"Priority writes must always be leaf nodes"),r=i.value):n=hk(Ge(t,s),i,n)}),!n.getChild(t).isEmpty()&&r!==null&&(n=n.updateChild(Ge(t,".priority"),r)),n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ef(t,e){return gk(e,t)}function BW(t,e,n,r,s){x(r>t.lastWriteId,"Stacking an older write on top of newer ones"),s===void 0&&(s=!0),t.allWrites.push({path:e,snap:n,writeId:r,visible:s}),s&&(t.visibleWrites=Wc(t.visibleWrites,e,n)),t.lastWriteId=r}function qW(t,e,n,r){x(r>t.lastWriteId,"Stacking an older merge on top of newer ones"),t.allWrites.push({path:e,children:n,writeId:r,visible:!0}),t.visibleWrites=mm(t.visibleWrites,e,n),t.lastWriteId=r}function jW(t,e){for(let n=0;n<t.allWrites.length;n++){const r=t.allWrites[n];if(r.writeId===e)return r}return null}function KW(t,e){const n=t.allWrites.findIndex(a=>a.writeId===e);x(n>=0,"removeWrite called with nonexistent writeId.");const r=t.allWrites[n];t.allWrites.splice(n,1);let s=r.visible,i=!1,o=t.allWrites.length-1;for(;s&&o>=0;){const a=t.allWrites[o];a.visible&&(o>=n&&WW(a,r.path)?s=!1:Bn(r.path,a.path)&&(i=!0)),o--}if(s){if(i)return HW(t),!0;if(r.snap)t.visibleWrites=$I(t.visibleWrites,r.path);else{const a=r.children;xt(a,c=>{t.visibleWrites=$I(t.visibleWrites,Ge(r.path,c))})}return!0}else return!1}function WW(t,e){if(t.snap)return Bn(t.path,e);for(const n in t.children)if(t.children.hasOwnProperty(n)&&Bn(Ge(t.path,n),e))return!0;return!1}function HW(t){t.visibleWrites=dk(t.allWrites,GW,Te()),t.allWrites.length>0?t.lastWriteId=t.allWrites[t.allWrites.length-1].writeId:t.lastWriteId=-1}function GW(t){return t.visible}function dk(t,e,n){let r=cr.empty();for(let s=0;s<t.length;++s){const i=t[s];if(e(i)){const o=i.path;let a;if(i.snap)Bn(n,o)?(a=ln(n,o),r=Wc(r,a,i.snap)):Bn(o,n)&&(a=ln(o,n),r=Wc(r,Te(),i.snap.getChild(a)));else if(i.children){if(Bn(n,o))a=ln(n,o),r=mm(r,a,i.children);else if(Bn(o,n))if(a=ln(o,n),pe(a))r=mm(r,Te(),i.children);else{const c=Gi(i.children,fe(a));if(c){const l=c.getChild(Me(a));r=Wc(r,Te(),l)}}}else throw Ba("WriteRecord should have .snap or .children")}}return r}function fk(t,e,n,r,s){if(!r&&!s){const i=So(t.visibleWrites,e);if(i!=null)return i;{const o=Us(t.visibleWrites,e);if(ym(o))return n;if(n==null&&!_m(o,Te()))return null;{const a=n||te.EMPTY_NODE;return Ta(o,a)}}}else{const i=Us(t.visibleWrites,e);if(!s&&ym(i))return n;if(!s&&n==null&&!_m(i,Te()))return null;{const o=function(l){return(l.visible||s)&&(!r||!~r.indexOf(l.writeId))&&(Bn(l.path,e)||Bn(e,l.path))},a=dk(t.allWrites,o,e),c=n||te.EMPTY_NODE;return Ta(a,c)}}}function zW(t,e,n){let r=te.EMPTY_NODE;const s=So(t.visibleWrites,e);if(s)return s.isLeafNode()||s.forEachChild(qe,(i,o)=>{r=r.updateImmediateChild(i,o)}),r;if(n){const i=Us(t.visibleWrites,e);return n.forEachChild(qe,(o,a)=>{const c=Ta(Us(i,new Ce(o)),a);r=r.updateImmediateChild(o,c)}),VI(i).forEach(o=>{r=r.updateImmediateChild(o.name,o.node)}),r}else{const i=Us(t.visibleWrites,e);return VI(i).forEach(o=>{r=r.updateImmediateChild(o.name,o.node)}),r}}function QW(t,e,n,r,s){x(r||s,"Either existingEventSnap or existingServerSnap must exist");const i=Ge(e,n);if(_m(t.visibleWrites,i))return null;{const o=Us(t.visibleWrites,i);return ym(o)?s.getChild(n):Ta(o,s.getChild(n))}}function YW(t,e,n,r){const s=Ge(e,n),i=So(t.visibleWrites,s);if(i!=null)return i;if(r.isCompleteForChild(n)){const o=Us(t.visibleWrites,s);return Ta(o,r.getNode().getImmediateChild(n))}else return null}function JW(t,e){return So(t.visibleWrites,e)}function XW(t,e,n,r,s,i,o){let a;const c=Us(t.visibleWrites,e),l=So(c,Te());if(l!=null)a=l;else if(n!=null)a=Ta(c,n);else return[];if(a=a.withIndex(o),!a.isEmpty()&&!a.isLeafNode()){const u=[],h=o.getCompare(),d=i?a.getReverseIteratorFrom(r,o):a.getIteratorFrom(r,o);let f=d.getNext();for(;f&&u.length<s;)h(f,r)!==0&&u.push(f),f=d.getNext();return u}else return[]}function ZW(){return{visibleWrites:cr.empty(),allWrites:[],lastWriteId:-1}}function id(t,e,n,r){return fk(t.writeTree,t.treePath,e,n,r)}function Cy(t,e){return zW(t.writeTree,t.treePath,e)}function BI(t,e,n,r){return QW(t.writeTree,t.treePath,e,n,r)}function od(t,e){return JW(t.writeTree,Ge(t.treePath,e))}function eH(t,e,n,r,s,i){return XW(t.writeTree,t.treePath,e,n,r,s,i)}function Ay(t,e,n){return YW(t.writeTree,t.treePath,e,n)}function pk(t,e){return gk(Ge(t.treePath,e),t.writeTree)}function gk(t,e){return{treePath:t,writeTree:e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tH{constructor(){this.changeMap=new Map}trackChildChange(e){const n=e.type,r=e.childName;x(n==="child_added"||n==="child_changed"||n==="child_removed","Only child changes supported for tracking"),x(r!==".priority","Only non-priority child changes can be tracked.");const s=this.changeMap.get(r);if(s){const i=s.type;if(n==="child_added"&&i==="child_removed")this.changeMap.set(r,Rl(r,e.snapshotNode,s.snapshotNode));else if(n==="child_removed"&&i==="child_added")this.changeMap.delete(r);else if(n==="child_removed"&&i==="child_changed")this.changeMap.set(r,kl(r,s.oldSnap));else if(n==="child_changed"&&i==="child_added")this.changeMap.set(r,Ia(r,e.snapshotNode));else if(n==="child_changed"&&i==="child_changed")this.changeMap.set(r,Rl(r,e.snapshotNode,s.oldSnap));else throw Ba("Illegal combination of changes: "+e+" occurred after "+s)}else this.changeMap.set(r,e)}getChanges(){return Array.from(this.changeMap.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nH{getCompleteChild(e){return null}getChildAfterChild(e,n,r){return null}}const mk=new nH;class ky{constructor(e,n,r=null){this.writes_=e,this.viewCache_=n,this.optCompleteServerCache_=r}getCompleteChild(e){const n=this.viewCache_.eventCache;if(n.isCompleteForChild(e))return n.getNode().getImmediateChild(e);{const r=this.optCompleteServerCache_!=null?new Qs(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return Ay(this.writes_,e,r)}}getChildAfterChild(e,n,r){const s=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:eo(this.viewCache_),i=eH(this.writes_,s,n,1,r,e);return i.length===0?null:i[0]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rH(t){return{filter:t}}function sH(t,e){x(e.eventCache.getNode().isIndexed(t.filter.getIndex()),"Event snap not indexed"),x(e.serverCache.getNode().isIndexed(t.filter.getIndex()),"Server snap not indexed")}function iH(t,e,n,r,s){const i=new tH;let o,a;if(n.type===rr.OVERWRITE){const l=n;l.source.fromUser?o=vm(t,e,l.path,l.snap,r,s,i):(x(l.source.fromServer,"Unknown source."),a=l.source.tagged||e.serverCache.isFiltered()&&!pe(l.path),o=ad(t,e,l.path,l.snap,r,s,a,i))}else if(n.type===rr.MERGE){const l=n;l.source.fromUser?o=aH(t,e,l.path,l.children,r,s,i):(x(l.source.fromServer,"Unknown source."),a=l.source.tagged||e.serverCache.isFiltered(),o=wm(t,e,l.path,l.children,r,s,a,i))}else if(n.type===rr.ACK_USER_WRITE){const l=n;l.revert?o=uH(t,e,l.path,r,s,i):o=cH(t,e,l.path,l.affectedTree,r,s,i)}else if(n.type===rr.LISTEN_COMPLETE)o=lH(t,e,n.path,r,i);else throw Ba("Unknown operation type: "+n.type);const c=i.getChanges();return oH(e,o,c),{viewCache:o,changes:c}}function oH(t,e,n){const r=e.eventCache;if(r.isFullyInitialized()){const s=r.getNode().isLeafNode()||r.getNode().isEmpty(),i=sd(t);(n.length>0||!t.eventCache.isFullyInitialized()||s&&!r.getNode().equals(i)||!r.getNode().getPriority().equals(i.getPriority()))&&n.push(lk(sd(e)))}}function _k(t,e,n,r,s,i){const o=e.eventCache;if(od(r,n)!=null)return e;{let a,c;if(pe(n))if(x(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){const l=eo(e),u=l instanceof te?l:te.EMPTY_NODE,h=Cy(r,u);a=t.filter.updateFullNode(e.eventCache.getNode(),h,i)}else{const l=id(r,eo(e));a=t.filter.updateFullNode(e.eventCache.getNode(),l,i)}else{const l=fe(n);if(l===".priority"){x(zs(n)===1,"Can't have a priority with additional path components");const u=o.getNode();c=e.serverCache.getNode();const h=BI(r,n,u,c);h!=null?a=t.filter.updatePriority(u,h):a=o.getNode()}else{const u=Me(n);let h;if(o.isCompleteForChild(l)){c=e.serverCache.getNode();const d=BI(r,n,o.getNode(),c);d!=null?h=o.getNode().getImmediateChild(l).updateChild(u,d):h=o.getNode().getImmediateChild(l)}else h=Ay(r,l,e.serverCache);h!=null?a=t.filter.updateChild(o.getNode(),l,h,u,s,i):a=o.getNode()}}return Kc(e,a,o.isFullyInitialized()||pe(n),t.filter.filtersNodes())}}function ad(t,e,n,r,s,i,o,a){const c=e.serverCache;let l;const u=o?t.filter:t.filter.getIndexedFilter();if(pe(n))l=u.updateFullNode(c.getNode(),r,null);else if(u.filtersNodes()&&!c.isFiltered()){const f=c.getNode().updateChild(n,r);l=u.updateFullNode(c.getNode(),f,null)}else{const f=fe(n);if(!c.isCompleteForPath(n)&&zs(n)>1)return e;const p=Me(n),y=c.getNode().getImmediateChild(f).updateChild(p,r);f===".priority"?l=u.updatePriority(c.getNode(),y):l=u.updateChild(c.getNode(),f,y,p,mk,null)}const h=uk(e,l,c.isFullyInitialized()||pe(n),u.filtersNodes()),d=new ky(s,h,i);return _k(t,h,n,s,d,a)}function vm(t,e,n,r,s,i,o){const a=e.eventCache;let c,l;const u=new ky(s,e,i);if(pe(n))l=t.filter.updateFullNode(e.eventCache.getNode(),r,o),c=Kc(e,l,!0,t.filter.filtersNodes());else{const h=fe(n);if(h===".priority")l=t.filter.updatePriority(e.eventCache.getNode(),r),c=Kc(e,l,a.isFullyInitialized(),a.isFiltered());else{const d=Me(n),f=a.getNode().getImmediateChild(h);let p;if(pe(d))p=r;else{const _=u.getCompleteChild(h);_!=null?my(d)===".priority"&&_.getChild(ek(d)).isEmpty()?p=_:p=_.updateChild(d,r):p=te.EMPTY_NODE}if(f.equals(p))c=e;else{const _=t.filter.updateChild(a.getNode(),h,p,d,u,o);c=Kc(e,_,a.isFullyInitialized(),t.filter.filtersNodes())}}}return c}function qI(t,e){return t.eventCache.isCompleteForChild(e)}function aH(t,e,n,r,s,i,o){let a=e;return r.foreach((c,l)=>{const u=Ge(n,c);qI(e,fe(u))&&(a=vm(t,a,u,l,s,i,o))}),r.foreach((c,l)=>{const u=Ge(n,c);qI(e,fe(u))||(a=vm(t,a,u,l,s,i,o))}),a}function jI(t,e,n){return n.foreach((r,s)=>{e=e.updateChild(r,s)}),e}function wm(t,e,n,r,s,i,o,a){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let c=e,l;pe(n)?l=r:l=new Ve(null).setTree(n,r);const u=e.serverCache.getNode();return l.children.inorderTraversal((h,d)=>{if(u.hasChild(h)){const f=e.serverCache.getNode().getImmediateChild(h),p=jI(t,f,d);c=ad(t,c,new Ce(h),p,s,i,o,a)}}),l.children.inorderTraversal((h,d)=>{const f=!e.serverCache.isCompleteForChild(h)&&d.value===void 0;if(!u.hasChild(h)&&!f){const p=e.serverCache.getNode().getImmediateChild(h),_=jI(t,p,d);c=ad(t,c,new Ce(h),_,s,i,o,a)}}),c}function cH(t,e,n,r,s,i,o){if(od(s,n)!=null)return e;const a=e.serverCache.isFiltered(),c=e.serverCache;if(r.value!=null){if(pe(n)&&c.isFullyInitialized()||c.isCompleteForPath(n))return ad(t,e,n,c.getNode().getChild(n),s,i,a,o);if(pe(n)){let l=new Ve(null);return c.getNode().forEachChild(Ar,(u,h)=>{l=l.set(new Ce(u),h)}),wm(t,e,n,l,s,i,a,o)}else return e}else{let l=new Ve(null);return r.foreach((u,h)=>{const d=Ge(n,u);c.isCompleteForPath(d)&&(l=l.set(u,c.getNode().getChild(d)))}),wm(t,e,n,l,s,i,a,o)}}function lH(t,e,n,r,s){const i=e.serverCache,o=uk(e,i.getNode(),i.isFullyInitialized()||pe(n),i.isFiltered());return _k(t,o,n,r,mk,s)}function uH(t,e,n,r,s,i){let o;if(od(r,n)!=null)return e;{const a=new ky(r,e,s),c=e.eventCache.getNode();let l;if(pe(n)||fe(n)===".priority"){let u;if(e.serverCache.isFullyInitialized())u=id(r,eo(e));else{const h=e.serverCache.getNode();x(h instanceof te,"serverChildren would be complete if leaf node"),u=Cy(r,h)}u=u,l=t.filter.updateFullNode(c,u,i)}else{const u=fe(n);let h=Ay(r,u,e.serverCache);h==null&&e.serverCache.isCompleteForChild(u)&&(h=c.getImmediateChild(u)),h!=null?l=t.filter.updateChild(c,u,h,Me(n),a,i):e.eventCache.getNode().hasChild(u)?l=t.filter.updateChild(c,u,te.EMPTY_NODE,Me(n),a,i):l=c,l.isEmpty()&&e.serverCache.isFullyInitialized()&&(o=id(r,eo(e)),o.isLeafNode()&&(l=t.filter.updateFullNode(l,o,i)))}return o=e.serverCache.isFullyInitialized()||od(r,Te())!=null,Kc(e,l,o,t.filter.filtersNodes())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hH{constructor(e,n){this.query_=e,this.eventRegistrations_=[];const r=this.query_._queryParams,s=new Iy(r.getIndex()),i=SW(r);this.processor_=rH(i);const o=n.serverCache,a=n.eventCache,c=s.updateFullNode(te.EMPTY_NODE,o.getNode(),null),l=i.updateFullNode(te.EMPTY_NODE,a.getNode(),null),u=new Qs(c,o.isFullyInitialized(),s.filtersNodes()),h=new Qs(l,a.isFullyInitialized(),i.filtersNodes());this.viewCache_=If(h,u),this.eventGenerator_=new LW(this.query_)}get query(){return this.query_}}function dH(t){return t.viewCache_.serverCache.getNode()}function fH(t){return sd(t.viewCache_)}function pH(t,e){const n=eo(t.viewCache_);return n&&(t.query._queryParams.loadsAllData()||!pe(e)&&!n.getImmediateChild(fe(e)).isEmpty())?n.getChild(e):null}function KI(t){return t.eventRegistrations_.length===0}function gH(t,e){t.eventRegistrations_.push(e)}function WI(t,e,n){const r=[];if(n){x(e==null,"A cancel should cancel all event registrations.");const s=t.query._path;t.eventRegistrations_.forEach(i=>{const o=i.createCancelEvent(n,s);o&&r.push(o)})}if(e){let s=[];for(let i=0;i<t.eventRegistrations_.length;++i){const o=t.eventRegistrations_[i];if(!o.matches(e))s.push(o);else if(e.hasAnyCallback()){s=s.concat(t.eventRegistrations_.slice(i+1));break}}t.eventRegistrations_=s}else t.eventRegistrations_=[];return r}function HI(t,e,n,r){e.type===rr.MERGE&&e.source.queryId!==null&&(x(eo(t.viewCache_),"We should always have a full cache before handling merges"),x(sd(t.viewCache_),"Missing event cache, even though we have a server cache"));const s=t.viewCache_,i=iH(t.processor_,s,e,n,r);return sH(t.processor_,i.viewCache),x(i.viewCache.serverCache.isFullyInitialized()||!s.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),t.viewCache_=i.viewCache,yk(t,i.changes,i.viewCache.eventCache.getNode(),null)}function mH(t,e){const n=t.viewCache_.eventCache,r=[];return n.getNode().isLeafNode()||n.getNode().forEachChild(qe,(i,o)=>{r.push(Ia(i,o))}),n.isFullyInitialized()&&r.push(lk(n.getNode())),yk(t,r,n.getNode(),e)}function yk(t,e,n,r){const s=r?[r]:t.eventRegistrations_;return FW(t.eventGenerator_,e,n,s)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let cd;class vk{constructor(){this.views=new Map}}function _H(t){x(!cd,"__referenceConstructor has already been defined"),cd=t}function yH(){return x(cd,"Reference.ts has not been loaded"),cd}function vH(t){return t.views.size===0}function Ry(t,e,n,r){const s=e.source.queryId;if(s!==null){const i=t.views.get(s);return x(i!=null,"SyncTree gave us an op for an invalid query."),HI(i,e,n,r)}else{let i=[];for(const o of t.views.values())i=i.concat(HI(o,e,n,r));return i}}function Ny(t,e,n,r,s){const i=e._queryIdentifier,o=t.views.get(i);if(!o){let a=id(n,s?r:null),c=!1;a?c=!0:r instanceof te?(a=Cy(n,r),c=!1):(a=te.EMPTY_NODE,c=!1);const l=If(new Qs(a,c,!1),new Qs(r,s,!1));return new hH(e,l)}return o}function wH(t,e,n,r,s,i){const o=Ny(t,e,r,s,i);return t.views.has(e._queryIdentifier)||t.views.set(e._queryIdentifier,o),gH(o,n),mH(o,n)}function bH(t,e,n,r){const s=e._queryIdentifier,i=[];let o=[];const a=Ys(t);if(s==="default")for(const[c,l]of t.views.entries())o=o.concat(WI(l,n,r)),KI(l)&&(t.views.delete(c),l.query._queryParams.loadsAllData()||i.push(l.query));else{const c=t.views.get(s);c&&(o=o.concat(WI(c,n,r)),KI(c)&&(t.views.delete(s),c.query._queryParams.loadsAllData()||i.push(c.query)))}return a&&!Ys(t)&&i.push(new(yH())(e._repo,e._path)),{removed:i,events:o}}function wk(t){const e=[];for(const n of t.views.values())n.query._queryParams.loadsAllData()||e.push(n);return e}function $s(t,e){let n=null;for(const r of t.views.values())n=n||pH(r,e);return n}function bk(t,e){if(e._queryParams.loadsAllData())return Tf(t);{const r=e._queryIdentifier;return t.views.get(r)}}function Ik(t,e){return bk(t,e)!=null}function Ys(t){return Tf(t)!=null}function Tf(t){for(const e of t.views.values())if(e.query._queryParams.loadsAllData())return e;return null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ld;function IH(t){x(!ld,"__referenceConstructor has already been defined"),ld=t}function EH(){return x(ld,"Reference.ts has not been loaded"),ld}let TH=1;class GI{constructor(e){this.listenProvider_=e,this.syncPointTree_=new Ve(null),this.pendingWriteTree_=ZW(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function Py(t,e,n,r,s){return BW(t.pendingWriteTree_,e,n,r,s),s?Qa(t,new Zi(Ey(),e,n)):[]}function SH(t,e,n,r){qW(t.pendingWriteTree_,e,n,r);const s=Ve.fromObject(n);return Qa(t,new Ea(Ey(),e,s))}function Ds(t,e,n=!1){const r=jW(t.pendingWriteTree_,e);if(KW(t.pendingWriteTree_,e)){let i=new Ve(null);return r.snap!=null?i=i.set(Te(),!0):xt(r.children,o=>{i=i.set(new Ce(o),!0)}),Qa(t,new rd(r.path,i,n))}else return[]}function mu(t,e,n){return Qa(t,new Zi(Ty(),e,n))}function CH(t,e,n){const r=Ve.fromObject(n);return Qa(t,new Ea(Ty(),e,r))}function AH(t,e){return Qa(t,new Pl(Ty(),e))}function kH(t,e,n){const r=Dy(t,n);if(r){const s=xy(r),i=s.path,o=s.queryId,a=ln(i,e),c=new Pl(Sy(o),a);return Oy(t,i,c)}else return[]}function ud(t,e,n,r){const s=e._path,i=t.syncPointTree_.get(s);let o=[];if(i&&(e._queryIdentifier==="default"||Ik(i,e))){const a=bH(i,e,n,r);vH(i)&&(t.syncPointTree_=t.syncPointTree_.remove(s));const c=a.removed;o=a.events;const l=c.findIndex(h=>h._queryParams.loadsAllData())!==-1,u=t.syncPointTree_.findOnPath(s,(h,d)=>Ys(d));if(l&&!u){const h=t.syncPointTree_.subtree(s);if(!h.isEmpty()){const d=DH(h);for(let f=0;f<d.length;++f){const p=d[f],_=p.query,y=Ak(t,p);t.listenProvider_.startListening(Hc(_),Dl(t,_),y.hashFn,y.onComplete)}}}!u&&c.length>0&&!r&&(l?t.listenProvider_.stopListening(Hc(e),null):c.forEach(h=>{const d=t.queryToTagMap.get(Cf(h));t.listenProvider_.stopListening(Hc(h),d)})),xH(t,c)}return o}function RH(t,e){const{syncPoint:n,serverCache:r,writesCache:s,serverCacheComplete:i}=Tk(e,t),o=Ny(n,e,s,r,i);return n.views.has(e._queryIdentifier)||n.views.set(e._queryIdentifier,o),e._queryParams.loadsAllData()?null:Dl(t,e)}function Ek(t,e,n,r){const s=Dy(t,r);if(s!=null){const i=xy(s),o=i.path,a=i.queryId,c=ln(o,e),l=new Zi(Sy(a),c,n);return Oy(t,o,l)}else return[]}function NH(t,e,n,r){const s=Dy(t,r);if(s){const i=xy(s),o=i.path,a=i.queryId,c=ln(o,e),l=Ve.fromObject(n),u=new Ea(Sy(a),c,l);return Oy(t,o,u)}else return[]}function Tk(t,e){const n=t._path;let r=null,s=!1;e.syncPointTree_.foreachOnPath(n,(l,u)=>{const h=ln(l,n);r=r||$s(u,h),s=s||Ys(u)});let i=e.syncPointTree_.get(n);i?(s=s||Ys(i),r=r||$s(i,Te())):(i=new vk,e.syncPointTree_=e.syncPointTree_.set(n,i));let o;r!=null?o=!0:(o=!1,r=te.EMPTY_NODE,e.syncPointTree_.subtree(n).foreachChild((u,h)=>{const d=$s(h,Te());d&&(r=r.updateImmediateChild(u,d))}));const a=Ik(i,t);if(!a&&!t._queryParams.loadsAllData()){const l=Cf(t);x(!e.queryToTagMap.has(l),"View does not exist, but we have a tag");const u=OH();e.queryToTagMap.set(l,u),e.tagToQueryMap.set(u,l)}const c=Ef(e.pendingWriteTree_,n);return{syncPoint:i,writesCache:c,serverCache:r,serverCacheComplete:o,foundAncestorDefaultView:s,viewAlreadyExists:a}}function zI(t,e,n){const{syncPoint:r,serverCache:s,writesCache:i,serverCacheComplete:o,viewAlreadyExists:a,foundAncestorDefaultView:c}=Tk(e,t);let l=wH(r,e,n,i,s,o);if(!a&&!c){const u=bk(r,e);l=l.concat(MH(t,e,u))}return l}function Sf(t,e,n){const s=t.pendingWriteTree_,i=t.syncPointTree_.findOnPath(e,(o,a)=>{const c=ln(o,e),l=$s(a,c);if(l)return l});return fk(s,e,i,n,!0)}function PH(t,e){const n=e._path;let r=null;t.syncPointTree_.foreachOnPath(n,(l,u)=>{const h=ln(l,n);r=r||$s(u,h)});let s=t.syncPointTree_.get(n);s?r=r||$s(s,Te()):(s=new vk,t.syncPointTree_=t.syncPointTree_.set(n,s));const i=r!=null,o=i?new Qs(r,!0,!1):null,a=Ef(t.pendingWriteTree_,e._path),c=Ny(s,e,a,i?o.getNode():te.EMPTY_NODE,i);return fH(c)}function Qa(t,e){return Sk(e,t.syncPointTree_,null,Ef(t.pendingWriteTree_,Te()))}function Sk(t,e,n,r){if(pe(t.path))return Ck(t,e,n,r);{const s=e.get(Te());n==null&&s!=null&&(n=$s(s,Te()));let i=[];const o=fe(t.path),a=t.operationForChild(o),c=e.children.get(o);if(c&&a){const l=n?n.getImmediateChild(o):null,u=pk(r,o);i=i.concat(Sk(a,c,l,u))}return s&&(i=i.concat(Ry(s,t,r,n))),i}}function Ck(t,e,n,r){const s=e.get(Te());n==null&&s!=null&&(n=$s(s,Te()));let i=[];return e.children.inorderTraversal((o,a)=>{const c=n?n.getImmediateChild(o):null,l=pk(r,o),u=t.operationForChild(o);u&&(i=i.concat(Ck(u,a,c,l)))}),s&&(i=i.concat(Ry(s,t,r,n))),i}function Ak(t,e){const n=e.query,r=Dl(t,n);return{hashFn:()=>(dH(e)||te.EMPTY_NODE).hash(),onComplete:s=>{if(s==="ok")return r?kH(t,n._path,r):AH(t,n._path);{const i=CK(s,n);return ud(t,n,null,i)}}}}function Dl(t,e){const n=Cf(e);return t.queryToTagMap.get(n)}function Cf(t){return t._path.toString()+"$"+t._queryIdentifier}function Dy(t,e){return t.tagToQueryMap.get(e)}function xy(t){const e=t.indexOf("$");return x(e!==-1&&e<t.length-1,"Bad queryKey."),{queryId:t.substr(e+1),path:new Ce(t.substr(0,e))}}function Oy(t,e,n){const r=t.syncPointTree_.get(e);x(r,"Missing sync point for query tag that we're tracking");const s=Ef(t.pendingWriteTree_,e);return Ry(r,n,s,null)}function DH(t){return t.fold((e,n,r)=>{if(n&&Ys(n))return[Tf(n)];{let s=[];return n&&(s=wk(n)),xt(r,(i,o)=>{s=s.concat(o)}),s}})}function Hc(t){return t._queryParams.loadsAllData()&&!t._queryParams.isDefault()?new(EH())(t._repo,t._path):t}function xH(t,e){for(let n=0;n<e.length;++n){const r=e[n];if(!r._queryParams.loadsAllData()){const s=Cf(r),i=t.queryToTagMap.get(s);t.queryToTagMap.delete(s),t.tagToQueryMap.delete(i)}}}function OH(){return TH++}function MH(t,e,n){const r=e._path,s=Dl(t,e),i=Ak(t,n),o=t.listenProvider_.startListening(Hc(e),s,i.hashFn,i.onComplete),a=t.syncPointTree_.subtree(r);if(s)x(!Ys(a.value),"If we're adding a query, it shouldn't be shadowed");else{const c=a.fold((l,u,h)=>{if(!pe(l)&&u&&Ys(u))return[Tf(u).query];{let d=[];return u&&(d=d.concat(wk(u).map(f=>f.query))),xt(h,(f,p)=>{d=d.concat(p)}),d}});for(let l=0;l<c.length;++l){const u=c[l];t.listenProvider_.stopListening(Hc(u),Dl(t,u))}}return o}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class My{constructor(e){this.node_=e}getImmediateChild(e){const n=this.node_.getImmediateChild(e);return new My(n)}node(){return this.node_}}class Ly{constructor(e,n){this.syncTree_=e,this.path_=n}getImmediateChild(e){const n=Ge(this.path_,e);return new Ly(this.syncTree_,n)}node(){return Sf(this.syncTree_,this.path_)}}const LH=function(t){return t=t||{},t.timestamp=t.timestamp||new Date().getTime(),t},QI=function(t,e,n){if(!t||typeof t!="object")return t;if(x(".sv"in t,"Unexpected leaf node or priority contents"),typeof t[".sv"]=="string")return FH(t[".sv"],e,n);if(typeof t[".sv"]=="object")return UH(t[".sv"],e);x(!1,"Unexpected server value: "+JSON.stringify(t,null,2))},FH=function(t,e,n){switch(t){case"timestamp":return n.timestamp;default:x(!1,"Unexpected server value: "+t)}},UH=function(t,e,n){t.hasOwnProperty("increment")||x(!1,"Unexpected server value: "+JSON.stringify(t,null,2));const r=t.increment;typeof r!="number"&&x(!1,"Unexpected increment value: "+r);const s=e.node();if(x(s!==null&&typeof s!="undefined","Expected ChildrenNode.EMPTY_NODE for nulls"),!s.isLeafNode())return r;const o=s.getValue();return typeof o!="number"?r:o+r},kk=function(t,e,n,r){return Uy(e,new Ly(n,t),r)},Fy=function(t,e,n){return Uy(t,new My(e),n)};function Uy(t,e,n){const r=t.getPriority().val(),s=QI(r,e.getImmediateChild(".priority"),n);let i;if(t.isLeafNode()){const o=t,a=QI(o.getValue(),e,n);return a!==o.getValue()||s!==o.getPriority().val()?new vt(a,Qe(s)):t}else{const o=t;return i=o,s!==o.getPriority().val()&&(i=i.updatePriority(new vt(s))),o.forEachChild(qe,(a,c)=>{const l=Uy(c,e.getImmediateChild(a),n);l!==c&&(i=i.updateImmediateChild(a,l))}),i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $y{constructor(e="",n=null,r={children:{},childCount:0}){this.name=e,this.parent=n,this.node=r}}function Af(t,e){let n=e instanceof Ce?e:new Ce(e),r=t,s=fe(n);for(;s!==null;){const i=Gi(r.node.children,s)||{children:{},childCount:0};r=new $y(s,r,i),n=Me(n),s=fe(n)}return r}function Co(t){return t.node.value}function Vy(t,e){t.node.value=e,bm(t)}function Rk(t){return t.node.childCount>0}function $H(t){return Co(t)===void 0&&!Rk(t)}function kf(t,e){xt(t.node.children,(n,r)=>{e(new $y(n,t,r))})}function Nk(t,e,n,r){n&&!r&&e(t),kf(t,s=>{Nk(s,e,!0,r)}),n&&r&&e(t)}function VH(t,e,n){let r=n?t:t.parent;for(;r!==null;){if(e(r))return!0;r=r.parent}return!1}function _u(t){return new Ce(t.parent===null?t.name:_u(t.parent)+"/"+t.name)}function bm(t){t.parent!==null&&BH(t.parent,t.name,t)}function BH(t,e,n){const r=$H(n),s=xn(t.node.children,e);r&&s?(delete t.node.children[e],t.node.childCount--,bm(t)):!r&&!s&&(t.node.children[e]=n.node,t.node.childCount++,bm(t))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qH=/[\[\].#$\/\u0000-\u001F\u007F]/,jH=/[\[\].#$\u0000-\u001F\u007F]/,Gp=10*1024*1024,Rf=function(t){return typeof t=="string"&&t.length!==0&&!qH.test(t)},Pk=function(t){return typeof t=="string"&&t.length!==0&&!jH.test(t)},KH=function(t){return t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),Pk(t)},xl=function(t){return t===null||typeof t=="string"||typeof t=="number"&&!yf(t)||t&&typeof t=="object"&&xn(t,".sv")},Lr=function(t,e,n,r){r&&e===void 0||yu(bn(t,"value"),e,n)},yu=function(t,e,n){const r=n instanceof Ce?new sW(n,t):n;if(e===void 0)throw new Error(t+"contains undefined "+Ii(r));if(typeof e=="function")throw new Error(t+"contains a function "+Ii(r)+" with contents = "+e.toString());if(yf(e))throw new Error(t+"contains "+e.toString()+" "+Ii(r));if(typeof e=="string"&&e.length>Gp/3&&tf(e)>Gp)throw new Error(t+"contains a string greater than "+Gp+" utf8 bytes "+Ii(r)+" ('"+e.substring(0,50)+"...')");if(e&&typeof e=="object"){let s=!1,i=!1;if(xt(e,(o,a)=>{if(o===".value")s=!0;else if(o!==".priority"&&o!==".sv"&&(i=!0,!Rf(o)))throw new Error(t+" contains an invalid key ("+o+") "+Ii(r)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);iW(r,o),yu(t,a,r),oW(r)}),s&&i)throw new Error(t+' contains ".value" child '+Ii(r)+" in addition to actual children.")}},WH=function(t,e){let n,r;for(n=0;n<e.length;n++){r=e[n];const i=Al(r);for(let o=0;o<i.length;o++)if(!(i[o]===".priority"&&o===i.length-1)){if(!Rf(i[o]))throw new Error(t+"contains an invalid key ("+i[o]+") in path "+r.toString()+`. Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`)}}e.sort(rW);let s=null;for(n=0;n<e.length;n++){if(r=e[n],s!==null&&Bn(s,r))throw new Error(t+"contains a path "+s.toString()+" that is ancestor of another path "+r.toString());s=r}},Dk=function(t,e,n,r){if(r&&e===void 0)return;const s=bn(t,"values");if(!(e&&typeof e=="object")||Array.isArray(e))throw new Error(s+" must be an object containing the children to replace.");const i=[];xt(e,(o,a)=>{const c=new Ce(o);if(yu(s,a,Ge(n,c)),my(c)===".priority"&&!xl(a))throw new Error(s+"contains an invalid value for '"+c.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");i.push(c)}),WH(s,i)},By=function(t,e,n){if(!(n&&e===void 0)){if(yf(e))throw new Error(bn(t,"priority")+"is "+e.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!xl(e))throw new Error(bn(t,"priority")+"must be a valid Firebase priority (a string, finite number, server value, or null).")}},vu=function(t,e,n,r){if(!(r&&n===void 0)&&!Rf(n))throw new Error(bn(t,e)+'was an invalid key = "'+n+`".  Firebase keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]").`)},Ol=function(t,e,n,r){if(!(r&&n===void 0)&&!Pk(n))throw new Error(bn(t,e)+'was an invalid path = "'+n+`". Paths must be non-empty strings and can't contain ".", "#", "$", "[", or "]"`)},HH=function(t,e,n,r){n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),Ol(t,e,n,r)},qn=function(t,e){if(fe(e)===".info")throw new Error(t+" failed = Can't modify data under /.info/")},xk=function(t,e){const n=e.path.toString();if(typeof e.repoInfo.host!="string"||e.repoInfo.host.length===0||!Rf(e.repoInfo.namespace)&&e.repoInfo.host.split(":")[0]!=="localhost"||n.length!==0&&!KH(n))throw new Error(bn(t,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GH{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function Nf(t,e){let n=null;for(let r=0;r<e.length;r++){const s=e[r],i=s.getPath();n!==null&&!_y(i,n.path)&&(t.eventLists_.push(n),n=null),n===null&&(n={events:[],path:i}),n.events.push(s)}n&&t.eventLists_.push(n)}function Ok(t,e,n){Nf(t,n),Mk(t,r=>_y(r,e))}function zn(t,e,n){Nf(t,n),Mk(t,r=>Bn(r,e)||Bn(e,r))}function Mk(t,e){t.recursionDepth_++;let n=!0;for(let r=0;r<t.eventLists_.length;r++){const s=t.eventLists_[r];if(s){const i=s.path;e(i)?(zH(t.eventLists_[r]),t.eventLists_[r]=null):n=!1}}n&&(t.eventLists_=[]),t.recursionDepth_--}function zH(t){for(let e=0;e<t.events.length;e++){const n=t.events[e];if(n!==null){t.events[e]=null;const r=n.getEventRunner();Wi&&Tt("event: "+n.toString()),Ga(r)}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lk="repo_interrupt",QH=25;class YH{constructor(e,n,r,s){this.repoInfo_=e,this.forceRestClient_=n,this.authTokenProvider_=r,this.appCheckProvider_=s,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new GH,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=nd(),this.transactionQueueTree_=new $y,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function JH(t,e,n){if(t.stats_=py(t.repoInfo_),t.forceRestClient_||kK())t.server_=new td(t.repoInfo_,(r,s,i,o)=>{YI(t,r,s,i,o)},t.authTokenProvider_,t.appCheckProvider_),setTimeout(()=>JI(t,!0),0);else{if(typeof n!="undefined"&&n!==null){if(typeof n!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{mt(n)}catch(r){throw new Error("Invalid authOverride provided: "+r)}}t.persistentConnection_=new ts(t.repoInfo_,e,(r,s,i,o)=>{YI(t,r,s,i,o)},r=>{JI(t,r)},r=>{XH(t,r)},t.authTokenProvider_,t.appCheckProvider_,n),t.server_=t.persistentConnection_}t.authTokenProvider_.addTokenChangeListener(r=>{t.server_.refreshAuthToken(r)}),t.appCheckProvider_.addTokenChangeListener(r=>{t.server_.refreshAppCheckToken(r.token)}),t.statsReporter_=xK(t.repoInfo_,()=>new MW(t.stats_,t.server_)),t.infoData_=new NW,t.infoSyncTree_=new GI({startListening:(r,s,i,o)=>{let a=[];const c=t.infoData_.getNode(r._path);return c.isEmpty()||(a=mu(t.infoSyncTree_,r._path,c),setTimeout(()=>{o("ok")},0)),a},stopListening:()=>{}}),qy(t,"connected",!1),t.serverSyncTree_=new GI({startListening:(r,s,i,o)=>(t.server_.listen(r,i,s,(a,c)=>{const l=o(a,c);zn(t.eventQueue_,r._path,l)}),[]),stopListening:(r,s)=>{t.server_.unlisten(r,s)}})}function Fk(t){const n=t.infoData_.getNode(new Ce(".info/serverTimeOffset")).val()||0;return new Date().getTime()+n}function wu(t){return LH({timestamp:Fk(t)})}function YI(t,e,n,r,s){t.dataUpdateCount++;const i=new Ce(e);n=t.interceptServerDataCallback_?t.interceptServerDataCallback_(e,n):n;let o=[];if(s)if(r){const c=$h(n,l=>Qe(l));o=NH(t.serverSyncTree_,i,c,s)}else{const c=Qe(n);o=Ek(t.serverSyncTree_,i,c,s)}else if(r){const c=$h(n,l=>Qe(l));o=CH(t.serverSyncTree_,i,c)}else{const c=Qe(n);o=mu(t.serverSyncTree_,i,c)}let a=i;o.length>0&&(a=Sa(t,i)),zn(t.eventQueue_,a,o)}function JI(t,e){qy(t,"connected",e),e===!1&&tG(t)}function XH(t,e){xt(e,(n,r)=>{qy(t,n,r)})}function qy(t,e,n){const r=new Ce("/.info/"+e),s=Qe(n);t.infoData_.updateSnapshot(r,s);const i=mu(t.infoSyncTree_,r,s);zn(t.eventQueue_,r,i)}function Pf(t){return t.nextWriteId_++}function ZH(t,e){const n=PH(t.serverSyncTree_,e);return n!=null?Promise.resolve(n):t.server_.get(e).then(r=>{const s=Qe(r).withIndex(e._queryParams.getIndex());if(e._queryParams.loadsAllData())mu(t.serverSyncTree_,e._path,s);else{const o=RH(t.serverSyncTree_,e);Ek(t.serverSyncTree_,e._path,s,o)}return ud(t.serverSyncTree_,e,null).length>0&&to(t,"unexpected cancel events in repoGetValue"),s},r=>(to(t,"get for query "+mt(e)+" failed: "+r),Promise.reject(new Error(r))))}function jy(t,e,n,r,s){to(t,"set",{path:e.toString(),value:n,priority:r});const i=wu(t),o=Qe(n,r),a=Sf(t.serverSyncTree_,e),c=Fy(o,a,i),l=Pf(t),u=Py(t.serverSyncTree_,e,c,l,!0);Nf(t.eventQueue_,u),t.server_.put(e.toString(),o.val(!0),(d,f)=>{const p=d==="ok";p||Jt("set at "+e+" failed: "+d);const _=Ds(t.serverSyncTree_,l,!p);zn(t.eventQueue_,e,_),Js(t,s,d,f)});const h=Wy(t,e);Sa(t,h),zn(t.eventQueue_,h,[])}function eG(t,e,n,r){to(t,"update",{path:e.toString(),value:n});let s=!0;const i=wu(t),o={};if(xt(n,(a,c)=>{s=!1,o[a]=kk(Ge(e,a),Qe(c),t.serverSyncTree_,i)}),s)Tt("update() called with empty data.  Don't do anything."),Js(t,r,"ok",void 0);else{const a=Pf(t),c=SH(t.serverSyncTree_,e,o,a);Nf(t.eventQueue_,c),t.server_.merge(e.toString(),n,(l,u)=>{const h=l==="ok";h||Jt("update at "+e+" failed: "+l);const d=Ds(t.serverSyncTree_,a,!h),f=d.length>0?Sa(t,e):e;zn(t.eventQueue_,f,d),Js(t,r,l,u)}),xt(n,l=>{const u=Wy(t,Ge(e,l));Sa(t,u)}),zn(t.eventQueue_,e,[])}}function tG(t){to(t,"onDisconnectEvents");const e=wu(t),n=nd();gm(t.onDisconnect_,Te(),(s,i)=>{const o=kk(s,i,t.serverSyncTree_,e);za(n,s,o)});let r=[];gm(n,Te(),(s,i)=>{r=r.concat(mu(t.serverSyncTree_,s,i));const o=Wy(t,s);Sa(t,o)}),t.onDisconnect_=nd(),zn(t.eventQueue_,Te(),r)}function nG(t,e,n){t.server_.onDisconnectCancel(e.toString(),(r,s)=>{r==="ok"&&pm(t.onDisconnect_,e),Js(t,n,r,s)})}function XI(t,e,n,r){const s=Qe(n);t.server_.onDisconnectPut(e.toString(),s.val(!0),(i,o)=>{i==="ok"&&za(t.onDisconnect_,e,s),Js(t,r,i,o)})}function rG(t,e,n,r,s){const i=Qe(n,r);t.server_.onDisconnectPut(e.toString(),i.val(!0),(o,a)=>{o==="ok"&&za(t.onDisconnect_,e,i),Js(t,s,o,a)})}function sG(t,e,n,r){if(Uh(n)){Tt("onDisconnect().update() called with empty data.  Don't do anything."),Js(t,r,"ok",void 0);return}t.server_.onDisconnectMerge(e.toString(),n,(s,i)=>{s==="ok"&&xt(n,(o,a)=>{const c=Qe(a);za(t.onDisconnect_,Ge(e,o),c)}),Js(t,r,s,i)})}function iG(t,e,n){let r;fe(e._path)===".info"?r=zI(t.infoSyncTree_,e,n):r=zI(t.serverSyncTree_,e,n),Ok(t.eventQueue_,e._path,r)}function Im(t,e,n){let r;fe(e._path)===".info"?r=ud(t.infoSyncTree_,e,n):r=ud(t.serverSyncTree_,e,n),Ok(t.eventQueue_,e._path,r)}function Uk(t){t.persistentConnection_&&t.persistentConnection_.interrupt(Lk)}function oG(t){t.persistentConnection_&&t.persistentConnection_.resume(Lk)}function to(t,...e){let n="";t.persistentConnection_&&(n=t.persistentConnection_.id+":"),Tt(n,...e)}function Js(t,e,n,r){e&&Ga(()=>{if(n==="ok")e(null);else{const s=(n||"error").toUpperCase();let i=s;r&&(i+=": "+r);const o=new Error(i);o.code=s,e(o)}})}function aG(t,e,n,r,s,i){to(t,"transaction on "+e);const o={path:e,update:n,onComplete:r,status:null,order:NA(),applyLocally:i,retryCount:0,unwatcher:s,abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},a=Ky(t,e,void 0);o.currentInputSnapshot=a;const c=o.update(a.val());if(c===void 0)o.unwatcher(),o.currentOutputSnapshotRaw=null,o.currentOutputSnapshotResolved=null,o.onComplete&&o.onComplete(null,!1,o.currentInputSnapshot);else{yu("transaction failed: Data returned ",c,o.path),o.status=0;const l=Af(t.transactionQueueTree_,e),u=Co(l)||[];u.push(o),Vy(l,u);let h;typeof c=="object"&&c!==null&&xn(c,".priority")?(h=Gi(c,".priority"),x(xl(h),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.")):h=(Sf(t.serverSyncTree_,e)||te.EMPTY_NODE).getPriority().val();const d=wu(t),f=Qe(c,h),p=Fy(f,a,d);o.currentOutputSnapshotRaw=f,o.currentOutputSnapshotResolved=p,o.currentWriteId=Pf(t);const _=Py(t.serverSyncTree_,e,p,o.currentWriteId,o.applyLocally);zn(t.eventQueue_,e,_),Df(t,t.transactionQueueTree_)}}function Ky(t,e,n){return Sf(t.serverSyncTree_,e,n)||te.EMPTY_NODE}function Df(t,e=t.transactionQueueTree_){if(e||xf(t,e),Co(e)){const n=Vk(t,e);x(n.length>0,"Sending zero length transaction queue"),n.every(s=>s.status===0)&&cG(t,_u(e),n)}else Rk(e)&&kf(e,n=>{Df(t,n)})}function cG(t,e,n){const r=n.map(l=>l.currentWriteId),s=Ky(t,e,r);let i=s;const o=s.hash();for(let l=0;l<n.length;l++){const u=n[l];x(u.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),u.status=1,u.retryCount++;const h=ln(e,u.path);i=i.updateChild(h,u.currentOutputSnapshotRaw)}const a=i.val(!0),c=e;t.server_.put(c.toString(),a,l=>{to(t,"transaction put response",{path:c.toString(),status:l});let u=[];if(l==="ok"){const h=[];for(let d=0;d<n.length;d++)n[d].status=2,u=u.concat(Ds(t.serverSyncTree_,n[d].currentWriteId)),n[d].onComplete&&h.push(()=>n[d].onComplete(null,!0,n[d].currentOutputSnapshotResolved)),n[d].unwatcher();xf(t,Af(t.transactionQueueTree_,e)),Df(t,t.transactionQueueTree_),zn(t.eventQueue_,e,u);for(let d=0;d<h.length;d++)Ga(h[d])}else{if(l==="datastale")for(let h=0;h<n.length;h++)n[h].status===3?n[h].status=4:n[h].status=0;else{Jt("transaction at "+c.toString()+" failed: "+l);for(let h=0;h<n.length;h++)n[h].status=4,n[h].abortReason=l}Sa(t,e)}},o)}function Sa(t,e){const n=$k(t,e),r=_u(n),s=Vk(t,n);return lG(t,s,r),r}function lG(t,e,n){if(e.length===0)return;const r=[];let s=[];const o=e.filter(a=>a.status===0).map(a=>a.currentWriteId);for(let a=0;a<e.length;a++){const c=e[a],l=ln(n,c.path);let u=!1,h;if(x(l!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),c.status===4)u=!0,h=c.abortReason,s=s.concat(Ds(t.serverSyncTree_,c.currentWriteId,!0));else if(c.status===0)if(c.retryCount>=QH)u=!0,h="maxretry",s=s.concat(Ds(t.serverSyncTree_,c.currentWriteId,!0));else{const d=Ky(t,c.path,o);c.currentInputSnapshot=d;const f=e[a].update(d.val());if(f!==void 0){yu("transaction failed: Data returned ",f,c.path);let p=Qe(f);typeof f=="object"&&f!=null&&xn(f,".priority")||(p=p.updatePriority(d.getPriority()));const y=c.currentWriteId,I=wu(t),N=Fy(p,d,I);c.currentOutputSnapshotRaw=p,c.currentOutputSnapshotResolved=N,c.currentWriteId=Pf(t),o.splice(o.indexOf(y),1),s=s.concat(Py(t.serverSyncTree_,c.path,N,c.currentWriteId,c.applyLocally)),s=s.concat(Ds(t.serverSyncTree_,y,!0))}else u=!0,h="nodata",s=s.concat(Ds(t.serverSyncTree_,c.currentWriteId,!0))}zn(t.eventQueue_,n,s),s=[],u&&(e[a].status=2,function(d){setTimeout(d,Math.floor(0))}(e[a].unwatcher),e[a].onComplete&&(h==="nodata"?r.push(()=>e[a].onComplete(null,!1,e[a].currentInputSnapshot)):r.push(()=>e[a].onComplete(new Error(h),!1,null))))}xf(t,t.transactionQueueTree_);for(let a=0;a<r.length;a++)Ga(r[a]);Df(t,t.transactionQueueTree_)}function $k(t,e){let n,r=t.transactionQueueTree_;for(n=fe(e);n!==null&&Co(r)===void 0;)r=Af(r,n),e=Me(e),n=fe(e);return r}function Vk(t,e){const n=[];return Bk(t,e,n),n.sort((r,s)=>r.order-s.order),n}function Bk(t,e,n){const r=Co(e);if(r)for(let s=0;s<r.length;s++)n.push(r[s]);kf(e,s=>{Bk(t,s,n)})}function xf(t,e){const n=Co(e);if(n){let r=0;for(let s=0;s<n.length;s++)n[s].status!==2&&(n[r]=n[s],r++);n.length=r,Vy(e,n.length>0?n:void 0)}kf(e,r=>{xf(t,r)})}function Wy(t,e){const n=_u($k(t,e)),r=Af(t.transactionQueueTree_,e);return VH(r,s=>{zp(t,s)}),zp(t,r),Nk(r,s=>{zp(t,s)}),n}function zp(t,e){const n=Co(e);if(n){const r=[];let s=[],i=-1;for(let o=0;o<n.length;o++)n[o].status===3||(n[o].status===1?(x(i===o-1,"All SENT items should be at beginning of queue."),i=o,n[o].status=3,n[o].abortReason="set"):(x(n[o].status===0,"Unexpected transaction status in abort"),n[o].unwatcher(),s=s.concat(Ds(t.serverSyncTree_,n[o].currentWriteId,!0)),n[o].onComplete&&r.push(n[o].onComplete.bind(null,new Error("set"),!1,null))));i===-1?Vy(e,void 0):n.length=i+1,zn(t.eventQueue_,_u(e),s);for(let o=0;o<r.length;o++)Ga(r[o])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uG(t){let e="";const n=t.split("/");for(let r=0;r<n.length;r++)if(n[r].length>0){let s=n[r];try{s=decodeURIComponent(s.replace(/\+/g," "))}catch{}e+="/"+s}return e}function hG(t){const e={};t.charAt(0)==="?"&&(t=t.substring(1));for(const n of t.split("&")){if(n.length===0)continue;const r=n.split("=");r.length===2?e[decodeURIComponent(r[0])]=decodeURIComponent(r[1]):Jt(`Invalid query segment '${n}' in query '${t}'`)}return e}const Em=function(t,e){const n=dG(t),r=n.namespace;n.domain==="firebase.com"&&Or(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!r||r==="undefined")&&n.domain!=="localhost"&&Or("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||bK();const s=n.scheme==="ws"||n.scheme==="wss";return{repoInfo:new WA(n.host,n.secure,r,s,e,"",r!==n.subdomain),path:new Ce(n.pathString)}},dG=function(t){let e="",n="",r="",s="",i="",o=!0,a="https",c=443;if(typeof t=="string"){let l=t.indexOf("//");l>=0&&(a=t.substring(0,l-1),t=t.substring(l+2));let u=t.indexOf("/");u===-1&&(u=t.length);let h=t.indexOf("?");h===-1&&(h=t.length),e=t.substring(0,Math.min(u,h)),u<h&&(s=uG(t.substring(u,h)));const d=hG(t.substring(Math.min(t.length,h)));l=e.indexOf(":"),l>=0?(o=a==="https"||a==="wss",c=parseInt(e.substring(l+1),10)):l=e.length;const f=e.slice(0,l);if(f.toLowerCase()==="localhost")n="localhost";else if(f.split(".").length<=2)n=f;else{const p=e.indexOf(".");r=e.substring(0,p).toLowerCase(),n=e.substring(p+1),i=r}"ns"in d&&(i=d.ns)}return{host:e,port:c,domain:n,subdomain:r,secure:o,scheme:a,pathString:s,namespace:i}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qk{constructor(e,n,r,s){this.eventType=e,this.eventRegistration=n,this.snapshot=r,this.prevName=s}getPath(){const e=this.snapshot.ref;return this.eventType==="value"?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+mt(this.snapshot.exportVal())}}class jk{constructor(e,n,r){this.eventRegistration=e,this.error=n,this.path=r}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kk{constructor(e,n){this.snapshotCallback=e,this.cancelCallback=n}onValue(e,n){this.snapshotCallback.call(null,e,n)}onCancel(e){return x(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||this.snapshotCallback.userCallback!==void 0&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fG{constructor(e,n){this._repo=e,this._path=n}cancel(){const e=new gt;return nG(this._repo,this._path,e.wrapCallback(()=>{})),e.promise}remove(){qn("OnDisconnect.remove",this._path);const e=new gt;return XI(this._repo,this._path,null,e.wrapCallback(()=>{})),e.promise}set(e){qn("OnDisconnect.set",this._path),Lr("OnDisconnect.set",e,this._path,!1);const n=new gt;return XI(this._repo,this._path,e,n.wrapCallback(()=>{})),n.promise}setWithPriority(e,n){qn("OnDisconnect.setWithPriority",this._path),Lr("OnDisconnect.setWithPriority",e,this._path,!1),By("OnDisconnect.setWithPriority",n,!1);const r=new gt;return rG(this._repo,this._path,e,n,r.wrapCallback(()=>{})),r.promise}update(e){qn("OnDisconnect.update",this._path),Dk("OnDisconnect.update",e,this._path,!1);const n=new gt;return sG(this._repo,this._path,e,n.wrapCallback(()=>{})),n.promise}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class En{constructor(e,n,r,s){this._repo=e,this._path=n,this._queryParams=r,this._orderByCalled=s}get key(){return pe(this._path)?null:my(this._path)}get ref(){return new Yn(this._repo,this._path)}get _queryIdentifier(){const e=FI(this._queryParams),n=hy(e);return n==="{}"?"default":n}get _queryObject(){return FI(this._queryParams)}isEqual(e){if(e=A(e),!(e instanceof En))return!1;const n=this._repo===e._repo,r=_y(this._path,e._path),s=this._queryIdentifier===e._queryIdentifier;return n&&r&&s}toJSON(){return this.toString()}toString(){return this._repo.toString()+nW(this._path)}}function Of(t,e){if(t._orderByCalled===!0)throw new Error(e+": You can't combine multiple orderBy calls.")}function oi(t){let e=null,n=null;if(t.hasStart()&&(e=t.getIndexStartValue()),t.hasEnd()&&(n=t.getIndexEndValue()),t.getIndex()===Ar){const r="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",s="Query: When ordering by key, the argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() must be a string.";if(t.hasStart()){if(t.getIndexStartName()!==is)throw new Error(r);if(typeof e!="string")throw new Error(s)}if(t.hasEnd()){if(t.getIndexEndName()!==Mr)throw new Error(r);if(typeof n!="string")throw new Error(s)}}else if(t.getIndex()===qe){if(e!=null&&!xl(e)||n!=null&&!xl(n))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), startAfter() endAt(), endBefore(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if(x(t.getIndex()instanceof wy||t.getIndex()===by,"unknown index type."),e!=null&&typeof e=="object"||n!=null&&typeof n=="object")throw new Error("Query: First argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() cannot be an object.")}function Mf(t){if(t.hasStart()&&t.hasEnd()&&t.hasLimit()&&!t.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), startAfter(), endAt(), endBefore(), and limit(). Use limitToFirst() or limitToLast() instead.")}class Yn extends En{constructor(e,n){super(e,n,new wf,!1)}get parent(){const e=ek(this._path);return e===null?null:new Yn(this._repo,e)}get root(){let e=this;for(;e.parent!==null;)e=e.parent;return e}}class no{constructor(e,n,r){this._node=e,this.ref=n,this._index=r}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){const n=new Ce(e),r=ro(this.ref,e);return new no(this._node.getChild(n),r,qe)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return this._node.isLeafNode()?!1:!!this._node.forEachChild(this._index,(r,s)=>e(new no(s,ro(this.ref,r),qe)))}hasChild(e){const n=new Ce(e);return!this._node.getChild(n).isEmpty()}hasChildren(){return this._node.isLeafNode()?!1:!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}}function Wk(t,e){return t=A(t),t._checkNotDeleted("ref"),e!==void 0?ro(t._root,e):t._root}function ZI(t,e){t=A(t),t._checkNotDeleted("refFromURL");const n=Em(e,t._repo.repoInfo_.nodeAdmin);xk("refFromURL",n);const r=n.repoInfo;return!t._repo.repoInfo_.isCustomHost()&&r.host!==t._repo.repoInfo_.host&&Or("refFromURL: Host name does not match the current database: (found "+r.host+" but expected "+t._repo.repoInfo_.host+")"),Wk(t,n.path.toString())}function ro(t,e){return t=A(t),fe(t._path)===null?HH("child","path",e,!1):Ol("child","path",e,!1),new Yn(t._repo,Ge(t._path,e))}function pG(t,e){t=A(t),qn("push",t._path),Lr("push",e,t._path,!0);const n=Fk(t._repo),r=IW(n),s=ro(t,r),i=ro(t,r);let o;return e!=null?o=Hy(i,e).then(()=>i):o=Promise.resolve(i),s.then=o.then.bind(o),s.catch=o.then.bind(o,void 0),s}function gG(t){return qn("remove",t._path),Hy(t,null)}function Hy(t,e){t=A(t),qn("set",t._path),Lr("set",e,t._path,!1);const n=new gt;return jy(t._repo,t._path,e,null,n.wrapCallback(()=>{})),n.promise}function mG(t,e){t=A(t),qn("setPriority",t._path),By("setPriority",e,!1);const n=new gt;return jy(t._repo,Ge(t._path,".priority"),e,null,n.wrapCallback(()=>{})),n.promise}function _G(t,e,n){if(qn("setWithPriority",t._path),Lr("setWithPriority",e,t._path,!1),By("setWithPriority",n,!1),t.key===".length"||t.key===".keys")throw"setWithPriority failed: "+t.key+" is a read-only object.";const r=new gt;return jy(t._repo,t._path,e,n,r.wrapCallback(()=>{})),r.promise}function yG(t,e){Dk("update",e,t._path,!1);const n=new gt;return eG(t._repo,t._path,e,n.wrapCallback(()=>{})),n.promise}function vG(t){return t=A(t),ZH(t._repo,t).then(e=>new no(e,new Yn(t._repo,t._path),t._queryParams.getIndex()))}class Lf{constructor(e){this.callbackContext=e}respondsTo(e){return e==="value"}createEvent(e,n){const r=n._queryParams.getIndex();return new qk("value",this,new no(e.snapshotNode,new Yn(n._repo,n._path),r))}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,n){return this.callbackContext.hasCancelCallback?new jk(this,e,n):null}matches(e){return e instanceof Lf?!e.callbackContext||!this.callbackContext?!0:e.callbackContext.matches(this.callbackContext):!1}hasAnyCallback(){return this.callbackContext!==null}}class Ff{constructor(e,n){this.eventType=e,this.callbackContext=n}respondsTo(e){let n=e==="children_added"?"child_added":e;return n=n==="children_removed"?"child_removed":n,this.eventType===n}createCancelEvent(e,n){return this.callbackContext.hasCancelCallback?new jk(this,e,n):null}createEvent(e,n){x(e.childName!=null,"Child events should have a childName.");const r=ro(new Yn(n._repo,n._path),e.childName),s=n._queryParams.getIndex();return new qk(e.type,this,new no(e.snapshotNode,r,s),e.prevName)}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,e.prevName)}matches(e){return e instanceof Ff?this.eventType===e.eventType&&(!this.callbackContext||!e.callbackContext||this.callbackContext.matches(e.callbackContext)):!1}hasAnyCallback(){return!!this.callbackContext}}function bu(t,e,n,r,s){let i;if(typeof r=="object"&&(i=void 0,s=r),typeof r=="function"&&(i=r),s&&s.onlyOnce){const c=n,l=(u,h)=>{Im(t._repo,t,a),c(u,h)};l.userCallback=n.userCallback,l.context=n.context,n=l}const o=new Kk(n,i||void 0),a=e==="value"?new Lf(o):new Ff(e,o);return iG(t._repo,t,a),()=>Im(t._repo,t,a)}function Tm(t,e,n,r){return bu(t,"value",e,n,r)}function eE(t,e,n,r){return bu(t,"child_added",e,n,r)}function tE(t,e,n,r){return bu(t,"child_changed",e,n,r)}function nE(t,e,n,r){return bu(t,"child_moved",e,n,r)}function rE(t,e,n,r){return bu(t,"child_removed",e,n,r)}function sE(t,e,n){let r=null;const s=n?new Kk(n):null;e==="value"?r=new Lf(s):e&&(r=new Ff(e,s)),Im(t._repo,t,r)}class hr{}class Hk extends hr{constructor(e,n){super(),this._value=e,this._key=n}_apply(e){Lr("endAt",this._value,e._path,!0);const n=fm(e._queryParams,this._value,this._key);if(Mf(n),oi(n),e._queryParams.hasEnd())throw new Error("endAt: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new En(e._repo,e._path,n,e._orderByCalled)}}function wG(t,e){return vu("endAt","key",e,!0),new Hk(t,e)}class bG extends hr{constructor(e,n){super(),this._value=e,this._key=n}_apply(e){Lr("endBefore",this._value,e._path,!1);const n=RW(e._queryParams,this._value,this._key);if(Mf(n),oi(n),e._queryParams.hasEnd())throw new Error("endBefore: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new En(e._repo,e._path,n,e._orderByCalled)}}function IG(t,e){return vu("endBefore","key",e,!0),new bG(t,e)}class Gk extends hr{constructor(e,n){super(),this._value=e,this._key=n}_apply(e){Lr("startAt",this._value,e._path,!0);const n=dm(e._queryParams,this._value,this._key);if(Mf(n),oi(n),e._queryParams.hasStart())throw new Error("startAt: Starting point was already set (by another call to startAt, startBefore or equalTo).");return new En(e._repo,e._path,n,e._orderByCalled)}}function EG(t=null,e){return vu("startAt","key",e,!0),new Gk(t,e)}class TG extends hr{constructor(e,n){super(),this._value=e,this._key=n}_apply(e){Lr("startAfter",this._value,e._path,!1);const n=kW(e._queryParams,this._value,this._key);if(Mf(n),oi(n),e._queryParams.hasStart())throw new Error("startAfter: Starting point was already set (by another call to startAt, startAfter, or equalTo).");return new En(e._repo,e._path,n,e._orderByCalled)}}function SG(t,e){return vu("startAfter","key",e,!0),new TG(t,e)}class CG extends hr{constructor(e){super(),this._limit=e}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToFirst: Limit was already set (by another call to limitToFirst or limitToLast).");return new En(e._repo,e._path,CW(e._queryParams,this._limit),e._orderByCalled)}}function AG(t){if(typeof t!="number"||Math.floor(t)!==t||t<=0)throw new Error("limitToFirst: First argument must be a positive integer.");return new CG(t)}class kG extends hr{constructor(e){super(),this._limit=e}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToLast: Limit was already set (by another call to limitToFirst or limitToLast).");return new En(e._repo,e._path,AW(e._queryParams,this._limit),e._orderByCalled)}}function RG(t){if(typeof t!="number"||Math.floor(t)!==t||t<=0)throw new Error("limitToLast: First argument must be a positive integer.");return new kG(t)}class NG extends hr{constructor(e){super(),this._path=e}_apply(e){Of(e,"orderByChild");const n=new Ce(this._path);if(pe(n))throw new Error("orderByChild: cannot pass in empty path. Use orderByValue() instead.");const r=new wy(n),s=bf(e._queryParams,r);return oi(s),new En(e._repo,e._path,s,!0)}}function PG(t){if(t==="$key")throw new Error('orderByChild: "$key" is invalid.  Use orderByKey() instead.');if(t==="$priority")throw new Error('orderByChild: "$priority" is invalid.  Use orderByPriority() instead.');if(t==="$value")throw new Error('orderByChild: "$value" is invalid.  Use orderByValue() instead.');return Ol("orderByChild","path",t,!1),new NG(t)}class DG extends hr{_apply(e){Of(e,"orderByKey");const n=bf(e._queryParams,Ar);return oi(n),new En(e._repo,e._path,n,!0)}}function xG(){return new DG}class OG extends hr{_apply(e){Of(e,"orderByPriority");const n=bf(e._queryParams,qe);return oi(n),new En(e._repo,e._path,n,!0)}}function MG(){return new OG}class LG extends hr{_apply(e){Of(e,"orderByValue");const n=bf(e._queryParams,by);return oi(n),new En(e._repo,e._path,n,!0)}}function FG(){return new LG}class UG extends hr{constructor(e,n){super(),this._value=e,this._key=n}_apply(e){if(Lr("equalTo",this._value,e._path,!1),e._queryParams.hasStart())throw new Error("equalTo: Starting point was already set (by another call to startAt/startAfter or equalTo).");if(e._queryParams.hasEnd())throw new Error("equalTo: Ending point was already set (by another call to endAt/endBefore or equalTo).");return new Hk(this._value,this._key)._apply(new Gk(this._value,this._key)._apply(e))}}function $G(t,e){return vu("equalTo","key",e,!0),new UG(t,e)}function Xn(t,...e){let n=A(t);for(const r of e)n=r._apply(n);return n}_H(Yn);IH(Yn);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VG="FIREBASE_DATABASE_EMULATOR_HOST",Sm={};let BG=!1;function qG(t,e,n,r){t.repoInfo_=new WA(`${e}:${n}`,!1,t.repoInfo_.namespace,t.repoInfo_.webSocketOnly,t.repoInfo_.nodeAdmin,t.repoInfo_.persistenceKey,t.repoInfo_.includeNamespaceInQueryParams),r&&(t.authTokenProvider_=r)}function zk(t,e,n,r,s){let i=r||t.options.databaseURL;i===void 0&&(t.options.projectId||Or("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),Tt("Using default host for project ",t.options.projectId),i=`${t.options.projectId}-default-rtdb.firebaseio.com`);let o=Em(i,s),a=o.repoInfo,c,l;typeof process!="undefined"&&process.env&&(l=process.env[VG]),l?(c=!0,i=`http://${l}?ns=${a.namespace}`,o=Em(i,s),a=o.repoInfo):c=!o.repoInfo.secure;const u=s&&c?new ia(ia.OWNER):new NK(t.name,t.options,e);xk("Invalid Firebase Database URL",o),pe(o.path)||Or("Database URL must point to the root of a Firebase Database (not including a child path).");const h=KG(a,t,u,new RK(t.name,n));return new WG(h,t)}function jG(t,e){const n=Sm[e];(!n||n[t.key]!==t)&&Or(`Database ${e}(${t.repoInfo_}) has already been deleted.`),Uk(t),delete n[t.key]}function KG(t,e,n,r){let s=Sm[e.name];s||(s={},Sm[e.name]=s);let i=s[t.toURLString()];return i&&Or("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),i=new YH(t,BG,n,r),s[t.toURLString()]=i,i}class WG{constructor(e,n){this._repoInternal=e,this.app=n,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(JH(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new Yn(this._repo,Te())),this._rootInternal}_delete(){return this._rootInternal!==null&&(jG(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){this._rootInternal===null&&Or("Cannot call "+e+" on a deleted database.")}}function Qk(){wa.IS_TRANSPORT_INITIALIZED&&Jt("Transport has already been initialized. Please call this function before calling ref or setting up a listener")}function HG(){Qk(),Ps.forceDisallow()}function GG(){Qk(),$n.forceDisallow(),Ps.forceAllow()}function zG(t,e,n,r={}){t=A(t),t._checkNotDeleted("useEmulator"),t._instanceStarted&&Or("Cannot call useEmulator() after instance has already been initialized.");const s=t._repoInternal;let i;if(s.repoInfo_.nodeAdmin)r.mockUserToken&&Or('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),i=new ia(ia.OWNER);else if(r.mockUserToken){const o=typeof r.mockUserToken=="string"?r.mockUserToken:P_(r.mockUserToken,t.app.options.projectId);i=new ia(o)}qG(s,e,n,i)}function QG(t){t=A(t),t._checkNotDeleted("goOffline"),Uk(t._repo)}function YG(t){t=A(t),t._checkNotDeleted("goOnline"),oG(t._repo)}function JG(t,e){DA(t,e)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function XG(t){kA(Br),nt(new Ee("database",(e,{instanceIdentifier:n})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("auth-internal"),i=e.getProvider("app-check-internal");return zk(r,s,i,n)},"PUBLIC").setMultipleInstances(!0)),Le(vI,wI,t),Le(vI,wI,"esm2017")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZG={".sv":"timestamp"};function ez(){return ZG}function tz(t){return{".sv":{increment:t}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nz{constructor(e,n){this.committed=e,this.snapshot=n}toJSON(){return{committed:this.committed,snapshot:this.snapshot.toJSON()}}}function rz(t,e,n){var r;if(t=A(t),qn("Reference.transaction",t._path),t.key===".length"||t.key===".keys")throw"Reference.transaction failed: "+t.key+" is a read-only object.";const s=(r=n==null?void 0:n.applyLocally)!==null&&r!==void 0?r:!0,i=new gt,o=(c,l,u)=>{let h=null;c?i.reject(c):(h=new no(u,new Yn(t._repo,t._path),qe),i.resolve(new nz(l,h)))},a=Tm(t,()=>{});return aG(t._repo,t._path,e,o,a,s),i.promise}ts.prototype.simpleListen=function(t,e){this.sendRequest("q",{p:t},e)};ts.prototype.echo=function(t,e){this.sendRequest("echo",{d:t},e)};XG();const sz="@firebase/database-compat",iz="0.2.3";/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oz=new Vr("@firebase/database-compat"),Yk=function(t){const e="FIREBASE WARNING: "+t;oz.warn(e)};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const az=function(t,e,n,r){if(!(r&&n===void 0)&&typeof n!="boolean")throw new Error(bn(t,e)+"must be a boolean.")},cz=function(t,e,n){if(!(n&&e===void 0))switch(e){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:throw new Error(bn(t,"eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lz{constructor(e){this._delegate=e}cancel(e){ne("OnDisconnect.cancel",0,1,arguments.length),bt("OnDisconnect.cancel","onComplete",e,!0);const n=this._delegate.cancel();return e&&n.then(()=>e(null),r=>e(r)),n}remove(e){ne("OnDisconnect.remove",0,1,arguments.length),bt("OnDisconnect.remove","onComplete",e,!0);const n=this._delegate.remove();return e&&n.then(()=>e(null),r=>e(r)),n}set(e,n){ne("OnDisconnect.set",1,2,arguments.length),bt("OnDisconnect.set","onComplete",n,!0);const r=this._delegate.set(e);return n&&r.then(()=>n(null),s=>n(s)),r}setWithPriority(e,n,r){ne("OnDisconnect.setWithPriority",2,3,arguments.length),bt("OnDisconnect.setWithPriority","onComplete",r,!0);const s=this._delegate.setWithPriority(e,n);return r&&s.then(()=>r(null),i=>r(i)),s}update(e,n){if(ne("OnDisconnect.update",1,2,arguments.length),Array.isArray(e)){const s={};for(let i=0;i<e.length;++i)s[""+i]=e[i];e=s,Yk("Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}bt("OnDisconnect.update","onComplete",n,!0);const r=this._delegate.update(e);return n&&r.then(()=>n(null),s=>n(s)),r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uz{constructor(e,n){this.committed=e,this.snapshot=n}toJSON(){return ne("TransactionResult.toJSON",0,1,arguments.length),{committed:this.committed,snapshot:this.snapshot.toJSON()}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vs{constructor(e,n){this._database=e,this._delegate=n}val(){return ne("DataSnapshot.val",0,0,arguments.length),this._delegate.val()}exportVal(){return ne("DataSnapshot.exportVal",0,0,arguments.length),this._delegate.exportVal()}toJSON(){return ne("DataSnapshot.toJSON",0,1,arguments.length),this._delegate.toJSON()}exists(){return ne("DataSnapshot.exists",0,0,arguments.length),this._delegate.exists()}child(e){return ne("DataSnapshot.child",0,1,arguments.length),e=String(e),Ol("DataSnapshot.child","path",e,!1),new Vs(this._database,this._delegate.child(e))}hasChild(e){return ne("DataSnapshot.hasChild",1,1,arguments.length),Ol("DataSnapshot.hasChild","path",e,!1),this._delegate.hasChild(e)}getPriority(){return ne("DataSnapshot.getPriority",0,0,arguments.length),this._delegate.priority}forEach(e){return ne("DataSnapshot.forEach",1,1,arguments.length),bt("DataSnapshot.forEach","action",e,!1),this._delegate.forEach(n=>e(new Vs(this._database,n)))}hasChildren(){return ne("DataSnapshot.hasChildren",0,0,arguments.length),this._delegate.hasChildren()}get key(){return this._delegate.key}numChildren(){return ne("DataSnapshot.numChildren",0,0,arguments.length),this._delegate.size}getRef(){return ne("DataSnapshot.ref",0,0,arguments.length),new kn(this._database,this._delegate.ref)}get ref(){return this.getRef()}}class Ut{constructor(e,n){this.database=e,this._delegate=n}on(e,n,r,s){var i;ne("Query.on",2,4,arguments.length),bt("Query.on","callback",n,!1);const o=Ut.getCancelAndContextArgs_("Query.on",r,s),a=(l,u)=>{n.call(o.context,new Vs(this.database,l),u)};a.userCallback=n,a.context=o.context;const c=(i=o.cancel)===null||i===void 0?void 0:i.bind(o.context);switch(e){case"value":return Tm(this._delegate,a,c),n;case"child_added":return eE(this._delegate,a,c),n;case"child_removed":return rE(this._delegate,a,c),n;case"child_changed":return tE(this._delegate,a,c),n;case"child_moved":return nE(this._delegate,a,c),n;default:throw new Error(bn("Query.on","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}}off(e,n,r){if(ne("Query.off",0,3,arguments.length),cz("Query.off",e,!0),bt("Query.off","callback",n,!0),Ob("Query.off","context",r,!0),n){const s=()=>{};s.userCallback=n,s.context=r,sE(this._delegate,e,s)}else sE(this._delegate,e)}get(){return vG(this._delegate).then(e=>new Vs(this.database,e))}once(e,n,r,s){ne("Query.once",1,4,arguments.length),bt("Query.once","callback",n,!0);const i=Ut.getCancelAndContextArgs_("Query.once",r,s),o=new gt,a=(l,u)=>{const h=new Vs(this.database,l);n&&n.call(i.context,h,u),o.resolve(h)};a.userCallback=n,a.context=i.context;const c=l=>{i.cancel&&i.cancel.call(i.context,l),o.reject(l)};switch(e){case"value":Tm(this._delegate,a,c,{onlyOnce:!0});break;case"child_added":eE(this._delegate,a,c,{onlyOnce:!0});break;case"child_removed":rE(this._delegate,a,c,{onlyOnce:!0});break;case"child_changed":tE(this._delegate,a,c,{onlyOnce:!0});break;case"child_moved":nE(this._delegate,a,c,{onlyOnce:!0});break;default:throw new Error(bn("Query.once","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}return o.promise}limitToFirst(e){return ne("Query.limitToFirst",1,1,arguments.length),new Ut(this.database,Xn(this._delegate,AG(e)))}limitToLast(e){return ne("Query.limitToLast",1,1,arguments.length),new Ut(this.database,Xn(this._delegate,RG(e)))}orderByChild(e){return ne("Query.orderByChild",1,1,arguments.length),new Ut(this.database,Xn(this._delegate,PG(e)))}orderByKey(){return ne("Query.orderByKey",0,0,arguments.length),new Ut(this.database,Xn(this._delegate,xG()))}orderByPriority(){return ne("Query.orderByPriority",0,0,arguments.length),new Ut(this.database,Xn(this._delegate,MG()))}orderByValue(){return ne("Query.orderByValue",0,0,arguments.length),new Ut(this.database,Xn(this._delegate,FG()))}startAt(e=null,n){return ne("Query.startAt",0,2,arguments.length),new Ut(this.database,Xn(this._delegate,EG(e,n)))}startAfter(e=null,n){return ne("Query.startAfter",0,2,arguments.length),new Ut(this.database,Xn(this._delegate,SG(e,n)))}endAt(e=null,n){return ne("Query.endAt",0,2,arguments.length),new Ut(this.database,Xn(this._delegate,wG(e,n)))}endBefore(e=null,n){return ne("Query.endBefore",0,2,arguments.length),new Ut(this.database,Xn(this._delegate,IG(e,n)))}equalTo(e,n){return ne("Query.equalTo",1,2,arguments.length),new Ut(this.database,Xn(this._delegate,$G(e,n)))}toString(){return ne("Query.toString",0,0,arguments.length),this._delegate.toString()}toJSON(){return ne("Query.toJSON",0,1,arguments.length),this._delegate.toJSON()}isEqual(e){if(ne("Query.isEqual",1,1,arguments.length),!(e instanceof Ut)){const n="Query.isEqual failed: First argument must be an instance of firebase.database.Query.";throw new Error(n)}return this._delegate.isEqual(e._delegate)}static getCancelAndContextArgs_(e,n,r){const s={cancel:void 0,context:void 0};if(n&&r)s.cancel=n,bt(e,"cancel",s.cancel,!0),s.context=r,Ob(e,"context",s.context,!0);else if(n)if(typeof n=="object"&&n!==null)s.context=n;else if(typeof n=="function")s.cancel=n;else throw new Error(bn(e,"cancelOrContext")+" must either be a cancel callback or a context object.");return s}get ref(){return new kn(this.database,new Yn(this._delegate._repo,this._delegate._path))}}class kn extends Ut{constructor(e,n){super(e,new En(n._repo,n._path,new wf,!1)),this.database=e,this._delegate=n}getKey(){return ne("Reference.key",0,0,arguments.length),this._delegate.key}child(e){return ne("Reference.child",1,1,arguments.length),typeof e=="number"&&(e=String(e)),new kn(this.database,ro(this._delegate,e))}getParent(){ne("Reference.parent",0,0,arguments.length);const e=this._delegate.parent;return e?new kn(this.database,e):null}getRoot(){return ne("Reference.root",0,0,arguments.length),new kn(this.database,this._delegate.root)}set(e,n){ne("Reference.set",1,2,arguments.length),bt("Reference.set","onComplete",n,!0);const r=Hy(this._delegate,e);return n&&r.then(()=>n(null),s=>n(s)),r}update(e,n){if(ne("Reference.update",1,2,arguments.length),Array.isArray(e)){const s={};for(let i=0;i<e.length;++i)s[""+i]=e[i];e=s,Yk("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}qn("Reference.update",this._delegate._path),bt("Reference.update","onComplete",n,!0);const r=yG(this._delegate,e);return n&&r.then(()=>n(null),s=>n(s)),r}setWithPriority(e,n,r){ne("Reference.setWithPriority",2,3,arguments.length),bt("Reference.setWithPriority","onComplete",r,!0);const s=_G(this._delegate,e,n);return r&&s.then(()=>r(null),i=>r(i)),s}remove(e){ne("Reference.remove",0,1,arguments.length),bt("Reference.remove","onComplete",e,!0);const n=gG(this._delegate);return e&&n.then(()=>e(null),r=>e(r)),n}transaction(e,n,r){ne("Reference.transaction",1,3,arguments.length),bt("Reference.transaction","transactionUpdate",e,!1),bt("Reference.transaction","onComplete",n,!0),az("Reference.transaction","applyLocally",r,!0);const s=rz(this._delegate,e,{applyLocally:r}).then(i=>new uz(i.committed,new Vs(this.database,i.snapshot)));return n&&s.then(i=>n(null,i.committed,i.snapshot),i=>n(i,!1,null)),s}setPriority(e,n){ne("Reference.setPriority",1,2,arguments.length),bt("Reference.setPriority","onComplete",n,!0);const r=mG(this._delegate,e);return n&&r.then(()=>n(null),s=>n(s)),r}push(e,n){ne("Reference.push",0,2,arguments.length),bt("Reference.push","onComplete",n,!0);const r=pG(this._delegate,e),s=r.then(o=>new kn(this.database,o));n&&s.then(()=>n(null),o=>n(o));const i=new kn(this.database,r);return i.then=s.then.bind(s),i.catch=s.catch.bind(s,void 0),i}onDisconnect(){return qn("Reference.onDisconnect",this._delegate._path),new lz(new fG(this._delegate._repo,this._delegate._path))}get key(){return this.getKey()}get parent(){return this.getParent()}get root(){return this.getRoot()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ml{constructor(e,n){this._delegate=e,this.app=n,this.INTERNAL={delete:()=>this._delegate._delete(),forceWebSockets:HG,forceLongPolling:GG}}useEmulator(e,n,r={}){zG(this._delegate,e,n,r)}ref(e){if(ne("database.ref",0,1,arguments.length),e instanceof kn){const n=ZI(this._delegate,e.toString());return new kn(this,n)}else{const n=Wk(this._delegate,e);return new kn(this,n)}}refFromURL(e){ne("database.refFromURL",1,1,arguments.length);const r=ZI(this._delegate,e);return new kn(this,r)}goOffline(){return ne("database.goOffline",0,0,arguments.length),QG(this._delegate)}goOnline(){return ne("database.goOnline",0,0,arguments.length),YG(this._delegate)}}Ml.ServerValue={TIMESTAMP:ez(),increment:t=>tz(t)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hz({app:t,url:e,version:n,customAuthImpl:r,namespace:s,nodeAdmin:i=!1}){kA(n);const o=new N0("auth-internal",new P0("database-standalone"));return o.setComponent(new Ee("auth-internal",()=>r,"PRIVATE")),{instance:new Ml(zk(t,o,void 0,e,i),t),namespace:s}}var dz=Object.freeze({__proto__:null,initStandalone:hz});/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fz=Ml.ServerValue;function pz(t){t.INTERNAL.registerComponent(new Ee("database-compat",(e,{instanceIdentifier:n})=>{const r=e.getProvider("app-compat").getImmediate(),s=e.getProvider("database").getImmediate({identifier:n});return new Ml(s,r)},"PUBLIC").setServiceProps({Reference:kn,Query:Ut,Database:Ml,DataSnapshot:Vs,enableLogging:JG,INTERNAL:dz,ServerValue:fz}).setMultipleInstances(!0)),t.registerVersion(sz,iz)}pz(ut);var gz=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{},K,Gy=Gy||{},oe=gz||self;function hd(){}function Cm(t){var e=typeof t;return e=e!="object"?e:t?Array.isArray(t)?"array":e:"null",e=="array"||e=="object"&&typeof t.length=="number"}function Iu(t){var e=typeof t;return e=="object"&&t!=null||e=="function"}function mz(t){return Object.prototype.hasOwnProperty.call(t,Qp)&&t[Qp]||(t[Qp]=++_z)}var Qp="closure_uid_"+(1e9*Math.random()>>>0),_z=0;function yz(t,e,n){return t.call.apply(t.bind,arguments)}function vz(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var s=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(s,r),t.apply(e,s)}}return function(){return t.apply(e,arguments)}}function Kt(t,e,n){return Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?Kt=yz:Kt=vz,Kt.apply(null,arguments)}function eh(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var r=n.slice();return r.push.apply(r,arguments),t.apply(this,r)}}function zt(t,e){function n(){}n.prototype=e.prototype,t.Z=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.Vb=function(r,s,i){for(var o=Array(arguments.length-2),a=2;a<arguments.length;a++)o[a-2]=arguments[a];return e.prototype[s].apply(r,o)}}function ai(){this.s=this.s,this.o=this.o}var wz=0;ai.prototype.s=!1;ai.prototype.na=function(){!this.s&&(this.s=!0,this.M(),wz!=0)&&mz(this)};ai.prototype.M=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const Jk=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if(typeof t=="string")return typeof e!="string"||e.length!=1?-1:t.indexOf(e,0);for(let n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},Xk=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){const r=t.length,s=typeof t=="string"?t.split(""):t;for(let i=0;i<r;i++)i in s&&e.call(n,s[i],i,t)};function bz(t){e:{var e=d2;const n=t.length,r=typeof t=="string"?t.split(""):t;for(let s=0;s<n;s++)if(s in r&&e.call(void 0,r[s],s,t)){e=s;break e}e=-1}return 0>e?null:typeof t=="string"?t.charAt(e):t[e]}function iE(t){return Array.prototype.concat.apply([],arguments)}function zy(t){const e=t.length;if(0<e){const n=Array(e);for(let r=0;r<e;r++)n[r]=t[r];return n}return[]}function dd(t){return/^[\s\xa0]*$/.test(t)}var oE=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function on(t,e){return t.indexOf(e)!=-1}function Yp(t,e){return t<e?-1:t>e?1:0}var an;e:{var aE=oe.navigator;if(aE){var cE=aE.userAgent;if(cE){an=cE;break e}}an=""}function Qy(t,e,n){for(const r in t)e.call(n,t[r],r,t)}function Zk(t){const e={};for(const n in t)e[n]=t[n];return e}var lE="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function eR(t,e){let n,r;for(let s=1;s<arguments.length;s++){r=arguments[s];for(n in r)t[n]=r[n];for(let i=0;i<lE.length;i++)n=lE[i],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function Yy(t){return Yy[" "](t),t}Yy[" "]=hd;function Iz(t){var e=Sz;return Object.prototype.hasOwnProperty.call(e,9)?e[9]:e[9]=t(9)}var Ez=on(an,"Opera"),Ca=on(an,"Trident")||on(an,"MSIE"),tR=on(an,"Edge"),Am=tR||Ca,nR=on(an,"Gecko")&&!(on(an.toLowerCase(),"webkit")&&!on(an,"Edge"))&&!(on(an,"Trident")||on(an,"MSIE"))&&!on(an,"Edge"),Tz=on(an.toLowerCase(),"webkit")&&!on(an,"Edge");function rR(){var t=oe.document;return t?t.documentMode:void 0}var fd;e:{var Jp="",Xp=function(){var t=an;if(nR)return/rv:([^\);]+)(\)|;)/.exec(t);if(tR)return/Edge\/([\d\.]+)/.exec(t);if(Ca)return/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(t);if(Tz)return/WebKit\/(\S+)/.exec(t);if(Ez)return/(?:Version)[ \/]?(\S+)/.exec(t)}();if(Xp&&(Jp=Xp?Xp[1]:""),Ca){var Zp=rR();if(Zp!=null&&Zp>parseFloat(Jp)){fd=String(Zp);break e}}fd=Jp}var Sz={};function Cz(){return Iz(function(){let t=0;const e=oE(String(fd)).split("."),n=oE("9").split("."),r=Math.max(e.length,n.length);for(let o=0;t==0&&o<r;o++){var s=e[o]||"",i=n[o]||"";do{if(s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],i=/(\d*)(\D*)(.*)/.exec(i)||["","","",""],s[0].length==0&&i[0].length==0)break;t=Yp(s[1].length==0?0:parseInt(s[1],10),i[1].length==0?0:parseInt(i[1],10))||Yp(s[2].length==0,i[2].length==0)||Yp(s[2],i[2]),s=s[3],i=i[3]}while(t==0)}return 0<=t})}var km;if(oe.document&&Ca){var uE=rR();km=uE||parseInt(fd,10)||void 0}else km=void 0;var Az=km,kz=function(){if(!oe.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{oe.addEventListener("test",hd,e),oe.removeEventListener("test",hd,e)}catch{}return t}();function Xt(t,e){this.type=t,this.g=this.target=e,this.defaultPrevented=!1}Xt.prototype.h=function(){this.defaultPrevented=!0};function Ll(t,e){if(Xt.call(this,t?t.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.g=e,e=t.relatedTarget){if(nR){e:{try{Yy(e.nodeName);var s=!0;break e}catch{}s=!1}s||(e=null)}}else n=="mouseover"?e=t.fromElement:n=="mouseout"&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=r.clientX!==void 0?r.clientX:r.pageX,this.clientY=r.clientY!==void 0?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=t.clientX!==void 0?t.clientX:t.pageX,this.clientY=t.clientY!==void 0?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType=typeof t.pointerType=="string"?t.pointerType:Rz[t.pointerType]||"",this.state=t.state,this.i=t,t.defaultPrevented&&Ll.Z.h.call(this)}}zt(Ll,Xt);var Rz={2:"touch",3:"pen",4:"mouse"};Ll.prototype.h=function(){Ll.Z.h.call(this);var t=this.i;t.preventDefault?t.preventDefault():t.returnValue=!1};var Eu="closure_listenable_"+(1e6*Math.random()|0),Nz=0;function Pz(t,e,n,r,s){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ia=s,this.key=++Nz,this.ca=this.fa=!1}function Uf(t){t.ca=!0,t.listener=null,t.proxy=null,t.src=null,t.ia=null}function $f(t){this.src=t,this.g={},this.h=0}$f.prototype.add=function(t,e,n,r,s){var i=t.toString();t=this.g[i],t||(t=this.g[i]=[],this.h++);var o=Nm(t,e,r,s);return-1<o?(e=t[o],n||(e.fa=!1)):(e=new Pz(e,this.src,i,!!r,s),e.fa=n,t.push(e)),e};function Rm(t,e){var n=e.type;if(n in t.g){var r=t.g[n],s=Jk(r,e),i;(i=0<=s)&&Array.prototype.splice.call(r,s,1),i&&(Uf(e),t.g[n].length==0&&(delete t.g[n],t.h--))}}function Nm(t,e,n,r){for(var s=0;s<t.length;++s){var i=t[s];if(!i.ca&&i.listener==e&&i.capture==!!n&&i.ia==r)return s}return-1}var Jy="closure_lm_"+(1e6*Math.random()|0),eg={};function sR(t,e,n,r,s){if(r&&r.once)return oR(t,e,n,r,s);if(Array.isArray(e)){for(var i=0;i<e.length;i++)sR(t,e[i],n,r,s);return null}return n=ev(n),t&&t[Eu]?t.N(e,n,Iu(r)?!!r.capture:!!r,s):iR(t,e,n,!1,r,s)}function iR(t,e,n,r,s,i){if(!e)throw Error("Invalid event type");var o=Iu(s)?!!s.capture:!!s,a=Zy(t);if(a||(t[Jy]=a=new $f(t)),n=a.add(e,n,r,o,i),n.proxy)return n;if(r=Dz(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)kz||(s=o),s===void 0&&(s=!1),t.addEventListener(e.toString(),r,s);else if(t.attachEvent)t.attachEvent(cR(e.toString()),r);else if(t.addListener&&t.removeListener)t.addListener(r);else throw Error("addEventListener and attachEvent are unavailable.");return n}function Dz(){function t(n){return e.call(t.src,t.listener,n)}var e=xz;return t}function oR(t,e,n,r,s){if(Array.isArray(e)){for(var i=0;i<e.length;i++)oR(t,e[i],n,r,s);return null}return n=ev(n),t&&t[Eu]?t.O(e,n,Iu(r)?!!r.capture:!!r,s):iR(t,e,n,!0,r,s)}function aR(t,e,n,r,s){if(Array.isArray(e))for(var i=0;i<e.length;i++)aR(t,e[i],n,r,s);else r=Iu(r)?!!r.capture:!!r,n=ev(n),t&&t[Eu]?(t=t.i,e=String(e).toString(),e in t.g&&(i=t.g[e],n=Nm(i,n,r,s),-1<n&&(Uf(i[n]),Array.prototype.splice.call(i,n,1),i.length==0&&(delete t.g[e],t.h--)))):t&&(t=Zy(t))&&(e=t.g[e.toString()],t=-1,e&&(t=Nm(e,n,r,s)),(n=-1<t?e[t]:null)&&Xy(n))}function Xy(t){if(typeof t!="number"&&t&&!t.ca){var e=t.src;if(e&&e[Eu])Rm(e.i,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(cR(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=Zy(e))?(Rm(n,t),n.h==0&&(n.src=null,e[Jy]=null)):Uf(t)}}}function cR(t){return t in eg?eg[t]:eg[t]="on"+t}function xz(t,e){if(t.ca)t=!0;else{e=new Ll(e,this);var n=t.listener,r=t.ia||t.src;t.fa&&Xy(t),t=n.call(r,e)}return t}function Zy(t){return t=t[Jy],t instanceof $f?t:null}var tg="__closure_events_fn_"+(1e9*Math.random()>>>0);function ev(t){return typeof t=="function"?t:(t[tg]||(t[tg]=function(e){return t.handleEvent(e)}),t[tg])}function Ot(){ai.call(this),this.i=new $f(this),this.P=this,this.I=null}zt(Ot,ai);Ot.prototype[Eu]=!0;Ot.prototype.removeEventListener=function(t,e,n,r){aR(this,t,e,n,r)};function Wt(t,e){var n,r=t.I;if(r)for(n=[];r;r=r.I)n.push(r);if(t=t.P,r=e.type||e,typeof e=="string")e=new Xt(e,t);else if(e instanceof Xt)e.target=e.target||t;else{var s=e;e=new Xt(r,t),eR(e,s)}if(s=!0,n)for(var i=n.length-1;0<=i;i--){var o=e.g=n[i];s=th(o,r,!0,e)&&s}if(o=e.g=t,s=th(o,r,!0,e)&&s,s=th(o,r,!1,e)&&s,n)for(i=0;i<n.length;i++)o=e.g=n[i],s=th(o,r,!1,e)&&s}Ot.prototype.M=function(){if(Ot.Z.M.call(this),this.i){var t=this.i,e;for(e in t.g){for(var n=t.g[e],r=0;r<n.length;r++)Uf(n[r]);delete t.g[e],t.h--}}this.I=null};Ot.prototype.N=function(t,e,n,r){return this.i.add(String(t),e,!1,n,r)};Ot.prototype.O=function(t,e,n,r){return this.i.add(String(t),e,!0,n,r)};function th(t,e,n,r){if(e=t.i.g[String(e)],!e)return!0;e=e.concat();for(var s=!0,i=0;i<e.length;++i){var o=e[i];if(o&&!o.ca&&o.capture==n){var a=o.listener,c=o.ia||o.src;o.fa&&Rm(t.i,o),s=a.call(c,r)!==!1&&s}}return s&&!r.defaultPrevented}var tv=oe.JSON.stringify;function Oz(){var t=uR;let e=null;return t.g&&(e=t.g,t.g=t.g.next,t.g||(t.h=null),e.next=null),e}class Mz{constructor(){this.h=this.g=null}add(e,n){const r=lR.get();r.set(e,n),this.h?this.h.next=r:this.g=r,this.h=r}}var lR=new class{constructor(t,e){this.i=t,this.j=e,this.h=0,this.g=null}get(){let t;return 0<this.h?(this.h--,t=this.g,this.g=t.next,t.next=null):t=this.i(),t}}(()=>new Lz,t=>t.reset());class Lz{constructor(){this.next=this.g=this.h=null}set(e,n){this.h=e,this.g=n,this.next=null}reset(){this.next=this.g=this.h=null}}function Fz(t){oe.setTimeout(()=>{throw t},0)}function nv(t,e){Pm||Uz(),Dm||(Pm(),Dm=!0),uR.add(t,e)}var Pm;function Uz(){var t=oe.Promise.resolve(void 0);Pm=function(){t.then($z)}}var Dm=!1,uR=new Mz;function $z(){for(var t;t=Oz();){try{t.h.call(t.g)}catch(n){Fz(n)}var e=lR;e.j(t),100>e.h&&(e.h++,t.next=e.g,e.g=t)}Dm=!1}function Vf(t,e){Ot.call(this),this.h=t||1,this.g=e||oe,this.j=Kt(this.kb,this),this.l=Date.now()}zt(Vf,Ot);K=Vf.prototype;K.da=!1;K.S=null;K.kb=function(){if(this.da){var t=Date.now()-this.l;0<t&&t<.8*this.h?this.S=this.g.setTimeout(this.j,this.h-t):(this.S&&(this.g.clearTimeout(this.S),this.S=null),Wt(this,"tick"),this.da&&(rv(this),this.start()))}};K.start=function(){this.da=!0,this.S||(this.S=this.g.setTimeout(this.j,this.h),this.l=Date.now())};function rv(t){t.da=!1,t.S&&(t.g.clearTimeout(t.S),t.S=null)}K.M=function(){Vf.Z.M.call(this),rv(this),delete this.g};function sv(t,e,n){if(typeof t=="function")n&&(t=Kt(t,n));else if(t&&typeof t.handleEvent=="function")t=Kt(t.handleEvent,t);else throw Error("Invalid listener argument");return 2147483647<Number(e)?-1:oe.setTimeout(t,e||0)}function hR(t){t.g=sv(()=>{t.g=null,t.i&&(t.i=!1,hR(t))},t.j);const e=t.h;t.h=null,t.m.apply(null,e)}class Vz extends ai{constructor(e,n){super(),this.m=e,this.j=n,this.h=null,this.i=!1,this.g=null}l(e){this.h=arguments,this.g?this.i=!0:hR(this)}M(){super.M(),this.g&&(oe.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Fl(t){ai.call(this),this.h=t,this.g={}}zt(Fl,ai);var hE=[];function dR(t,e,n,r){Array.isArray(n)||(n&&(hE[0]=n.toString()),n=hE);for(var s=0;s<n.length;s++){var i=sR(e,n[s],r||t.handleEvent,!1,t.h||t);if(!i)break;t.g[i.key]=i}}function fR(t){Qy(t.g,function(e,n){this.g.hasOwnProperty(n)&&Xy(e)},t),t.g={}}Fl.prototype.M=function(){Fl.Z.M.call(this),fR(this)};Fl.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};function Bf(){this.g=!0}Bf.prototype.Aa=function(){this.g=!1};function Bz(t,e,n,r,s,i){t.info(function(){if(t.g)if(i)for(var o="",a=i.split("&"),c=0;c<a.length;c++){var l=a[c].split("=");if(1<l.length){var u=l[0];l=l[1];var h=u.split("_");o=2<=h.length&&h[1]=="type"?o+(u+"="+l+"&"):o+(u+"=redacted&")}}else o=null;else o=i;return"XMLHTTP REQ ("+r+") [attempt "+s+"]: "+e+`
`+n+`
`+o})}function qz(t,e,n,r,s,i,o){t.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+s+"]: "+e+`
`+n+`
`+i+" "+o})}function Qo(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+Kz(t,n)+(r?" "+r:"")})}function jz(t,e){t.info(function(){return"TIMEOUT: "+e})}Bf.prototype.info=function(){};function Kz(t,e){if(!t.g)return e;if(!e)return null;try{var n=JSON.parse(e);if(n){for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(2>r.length)){var s=r[1];if(Array.isArray(s)&&!(1>s.length)){var i=s[0];if(i!="noop"&&i!="stop"&&i!="close")for(var o=1;o<s.length;o++)s[o]=""}}}}return tv(n)}catch{return e}}var Ao={},dE=null;function qf(){return dE=dE||new Ot}Ao.Ma="serverreachability";function pR(t){Xt.call(this,Ao.Ma,t)}zt(pR,Xt);function Ul(t){const e=qf();Wt(e,new pR(e))}Ao.STAT_EVENT="statevent";function gR(t,e){Xt.call(this,Ao.STAT_EVENT,t),this.stat=e}zt(gR,Xt);function un(t){const e=qf();Wt(e,new gR(e,t))}Ao.Na="timingevent";function mR(t,e){Xt.call(this,Ao.Na,t),this.size=e}zt(mR,Xt);function Tu(t,e){if(typeof t!="function")throw Error("Fn must not be null and must be a function");return oe.setTimeout(function(){t()},e)}var jf={NO_ERROR:0,lb:1,yb:2,xb:3,sb:4,wb:5,zb:6,Ja:7,TIMEOUT:8,Cb:9},_R={qb:"complete",Mb:"success",Ka:"error",Ja:"abort",Eb:"ready",Fb:"readystatechange",TIMEOUT:"timeout",Ab:"incrementaldata",Db:"progress",tb:"downloadprogress",Ub:"uploadprogress"};function iv(){}iv.prototype.h=null;function fE(t){return t.h||(t.h=t.i())}function yR(){}var Su={OPEN:"a",pb:"b",Ka:"c",Bb:"d"};function ov(){Xt.call(this,"d")}zt(ov,Xt);function av(){Xt.call(this,"c")}zt(av,Xt);var xm;function Kf(){}zt(Kf,iv);Kf.prototype.g=function(){return new XMLHttpRequest};Kf.prototype.i=function(){return{}};xm=new Kf;function Cu(t,e,n,r){this.l=t,this.j=e,this.m=n,this.X=r||1,this.V=new Fl(this),this.P=Wz,t=Am?125:void 0,this.W=new Vf(t),this.H=null,this.i=!1,this.s=this.A=this.v=this.K=this.F=this.Y=this.B=null,this.D=[],this.g=null,this.C=0,this.o=this.u=null,this.N=-1,this.I=!1,this.O=0,this.L=null,this.aa=this.J=this.$=this.U=!1,this.h=new vR}function vR(){this.i=null,this.g="",this.h=!1}var Wz=45e3,Om={},pd={};K=Cu.prototype;K.setTimeout=function(t){this.P=t};function Mm(t,e,n){t.K=1,t.v=Hf(os(e)),t.s=n,t.U=!0,wR(t,null)}function wR(t,e){t.F=Date.now(),Au(t),t.A=os(t.v);var n=t.A,r=t.X;Array.isArray(r)||(r=[String(r)]),AR(n.h,"t",r),t.C=0,n=t.l.H,t.h=new vR,t.g=GR(t.l,n?e:null,!t.s),0<t.O&&(t.L=new Vz(Kt(t.Ia,t,t.g),t.O)),dR(t.V,t.g,"readystatechange",t.gb),e=t.H?Zk(t.H):{},t.s?(t.u||(t.u="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.g.ea(t.A,t.u,t.s,e)):(t.u="GET",t.g.ea(t.A,t.u,null,e)),Ul(),Bz(t.j,t.u,t.A,t.m,t.X,t.s)}K.gb=function(t){t=t.target;const e=this.L;e&&Jr(t)==3?e.l():this.Ia(t)};K.Ia=function(t){try{if(t==this.g)e:{const u=Jr(this.g);var e=this.g.Da();const h=this.g.ba();if(!(3>u)&&(u!=3||Am||this.g&&(this.h.h||this.g.ga()||_E(this.g)))){this.I||u!=4||e==7||(e==8||0>=h?Ul(3):Ul(2)),Wf(this);var n=this.g.ba();this.N=n;t:if(bR(this)){var r=_E(this.g);t="";var s=r.length,i=Jr(this.g)==4;if(!this.h.i){if(typeof TextDecoder=="undefined"){Li(this),Gc(this);var o="";break t}this.h.i=new oe.TextDecoder}for(e=0;e<s;e++)this.h.h=!0,t+=this.h.i.decode(r[e],{stream:i&&e==s-1});r.splice(0,s),this.h.g+=t,this.C=0,o=this.h.g}else o=this.g.ga();if(this.i=n==200,qz(this.j,this.u,this.A,this.m,this.X,u,n),this.i){if(this.$&&!this.J){t:{if(this.g){var a,c=this.g;if((a=c.g?c.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!dd(a)){var l=a;break t}}l=null}if(n=l)Qo(this.j,this.m,n,"Initial handshake response via X-HTTP-Initial-Response"),this.J=!0,Lm(this,n);else{this.i=!1,this.o=3,un(12),Li(this),Gc(this);break e}}this.U?(IR(this,u,o),Am&&this.i&&u==3&&(dR(this.V,this.W,"tick",this.fb),this.W.start())):(Qo(this.j,this.m,o,null),Lm(this,o)),u==4&&Li(this),this.i&&!this.I&&(u==4?jR(this.l,this):(this.i=!1,Au(this)))}else n==400&&0<o.indexOf("Unknown SID")?(this.o=3,un(12)):(this.o=0,un(13)),Li(this),Gc(this)}}}catch{}finally{}};function bR(t){return t.g?t.u=="GET"&&t.K!=2&&t.l.Ba:!1}function IR(t,e,n){let r=!0,s;for(;!t.I&&t.C<n.length;)if(s=Hz(t,n),s==pd){e==4&&(t.o=4,un(14),r=!1),Qo(t.j,t.m,null,"[Incomplete Response]");break}else if(s==Om){t.o=4,un(15),Qo(t.j,t.m,n,"[Invalid Chunk]"),r=!1;break}else Qo(t.j,t.m,s,null),Lm(t,s);bR(t)&&s!=pd&&s!=Om&&(t.h.g="",t.C=0),e!=4||n.length!=0||t.h.h||(t.o=1,un(16),r=!1),t.i=t.i&&r,r?0<n.length&&!t.aa&&(t.aa=!0,e=t.l,e.g==t&&e.$&&!e.L&&(e.h.info("Great, no buffering proxy detected. Bytes received: "+n.length),mv(e),e.L=!0,un(11))):(Qo(t.j,t.m,n,"[Invalid Chunked Response]"),Li(t),Gc(t))}K.fb=function(){if(this.g){var t=Jr(this.g),e=this.g.ga();this.C<e.length&&(Wf(this),IR(this,t,e),this.i&&t!=4&&Au(this))}};function Hz(t,e){var n=t.C,r=e.indexOf(`
`,n);return r==-1?pd:(n=Number(e.substring(n,r)),isNaN(n)?Om:(r+=1,r+n>e.length?pd:(e=e.substr(r,n),t.C=r+n,e)))}K.cancel=function(){this.I=!0,Li(this)};function Au(t){t.Y=Date.now()+t.P,ER(t,t.P)}function ER(t,e){if(t.B!=null)throw Error("WatchDog timer not null");t.B=Tu(Kt(t.eb,t),e)}function Wf(t){t.B&&(oe.clearTimeout(t.B),t.B=null)}K.eb=function(){this.B=null;const t=Date.now();0<=t-this.Y?(jz(this.j,this.A),this.K!=2&&(Ul(),un(17)),Li(this),this.o=2,Gc(this)):ER(this,this.Y-t)};function Gc(t){t.l.G==0||t.I||jR(t.l,t)}function Li(t){Wf(t);var e=t.L;e&&typeof e.na=="function"&&e.na(),t.L=null,rv(t.W),fR(t.V),t.g&&(e=t.g,t.g=null,e.abort(),e.na())}function Lm(t,e){try{var n=t.l;if(n.G!=0&&(n.g==t||Fm(n.i,t))){if(n.I=t.N,!t.J&&Fm(n.i,t)&&n.G==3){try{var r=n.Ca.g.parse(e)}catch{r=null}if(Array.isArray(r)&&r.length==3){var s=r;if(s[0]==0){e:if(!n.u){if(n.g)if(n.g.F+3e3<t.F)yd(n),Qf(n);else break e;gv(n),un(18)}}else n.ta=s[1],0<n.ta-n.U&&37500>s[2]&&n.N&&n.A==0&&!n.v&&(n.v=Tu(Kt(n.ab,n),6e3));if(1>=NR(n.i)&&n.ka){try{n.ka()}catch{}n.ka=void 0}}else Fi(n,11)}else if((t.J||n.g==t)&&yd(n),!dd(e))for(s=n.Ca.g.parse(e),e=0;e<s.length;e++){let l=s[e];if(n.U=l[0],l=l[1],n.G==2)if(l[0]=="c"){n.J=l[1],n.la=l[2];const u=l[3];u!=null&&(n.ma=u,n.h.info("VER="+n.ma));const h=l[4];h!=null&&(n.za=h,n.h.info("SVER="+n.za));const d=l[5];d!=null&&typeof d=="number"&&0<d&&(r=1.5*d,n.K=r,n.h.info("backChannelRequestTimeoutMs_="+r)),r=n;const f=t.g;if(f){const p=f.g?f.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(p){var i=r.i;!i.g&&(on(p,"spdy")||on(p,"quic")||on(p,"h2"))&&(i.j=i.l,i.g=new Set,i.h&&(uv(i,i.h),i.h=null))}if(r.D){const _=f.g?f.g.getResponseHeader("X-HTTP-Session-Id"):null;_&&(r.sa=_,He(r.F,r.D,_))}}n.G=3,n.j&&n.j.xa(),n.$&&(n.O=Date.now()-t.F,n.h.info("Handshake RTT: "+n.O+"ms")),r=n;var o=t;if(r.oa=HR(r,r.H?r.la:null,r.W),o.J){PR(r.i,o);var a=o,c=r.K;c&&a.setTimeout(c),a.B&&(Wf(a),Au(a)),r.g=o}else BR(r);0<n.l.length&&Yf(n)}else l[0]!="stop"&&l[0]!="close"||Fi(n,7);else n.G==3&&(l[0]=="stop"||l[0]=="close"?l[0]=="stop"?Fi(n,7):pv(n):l[0]!="noop"&&n.j&&n.j.wa(l),n.A=0)}}Ul(4)}catch{}}function Gz(t){if(t.R&&typeof t.R=="function")return t.R();if(typeof t=="string")return t.split("");if(Cm(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}e=[],n=0;for(r in t)e[n++]=t[r];return e}function cv(t,e){if(t.forEach&&typeof t.forEach=="function")t.forEach(e,void 0);else if(Cm(t)||typeof t=="string")Xk(t,e,void 0);else{if(t.T&&typeof t.T=="function")var n=t.T();else if(t.R&&typeof t.R=="function")n=void 0;else if(Cm(t)||typeof t=="string"){n=[];for(var r=t.length,s=0;s<r;s++)n.push(s)}else for(s in n=[],r=0,t)n[r++]=s;r=Gz(t),s=r.length;for(var i=0;i<s;i++)e.call(void 0,r[i],n&&n[i],t)}}function Ya(t,e){this.h={},this.g=[],this.i=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof Ya)for(n=t.T(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}K=Ya.prototype;K.R=function(){lv(this);for(var t=[],e=0;e<this.g.length;e++)t.push(this.h[this.g[e]]);return t};K.T=function(){return lv(this),this.g.concat()};function lv(t){if(t.i!=t.g.length){for(var e=0,n=0;e<t.g.length;){var r=t.g[e];so(t.h,r)&&(t.g[n++]=r),e++}t.g.length=n}if(t.i!=t.g.length){var s={};for(n=e=0;e<t.g.length;)r=t.g[e],so(s,r)||(t.g[n++]=r,s[r]=1),e++;t.g.length=n}}K.get=function(t,e){return so(this.h,t)?this.h[t]:e};K.set=function(t,e){so(this.h,t)||(this.i++,this.g.push(t)),this.h[t]=e};K.forEach=function(t,e){for(var n=this.T(),r=0;r<n.length;r++){var s=n[r],i=this.get(s);t.call(e,i,s,this)}};function so(t,e){return Object.prototype.hasOwnProperty.call(t,e)}var TR=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function zz(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),s=null;if(0<=r){var i=t[n].substring(0,r);s=t[n].substring(r+1)}else i=t[n];e(i,s?decodeURIComponent(s.replace(/\+/g," ")):"")}}}function io(t,e){if(this.i=this.s=this.j="",this.m=null,this.o=this.l="",this.g=!1,t instanceof io){this.g=e!==void 0?e:t.g,gd(this,t.j),this.s=t.s,md(this,t.i),_d(this,t.m),this.l=t.l,e=t.h;var n=new $l;n.i=e.i,e.g&&(n.g=new Ya(e.g),n.h=e.h),pE(this,n),this.o=t.o}else t&&(n=String(t).match(TR))?(this.g=!!e,gd(this,n[1]||"",!0),this.s=zc(n[2]||""),md(this,n[3]||"",!0),_d(this,n[4]),this.l=zc(n[5]||"",!0),pE(this,n[6]||"",!0),this.o=zc(n[7]||"")):(this.g=!!e,this.h=new $l(null,this.g))}io.prototype.toString=function(){var t=[],e=this.j;e&&t.push(Nc(e,gE,!0),":");var n=this.i;return(n||e=="file")&&(t.push("//"),(e=this.s)&&t.push(Nc(e,gE,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),n=this.m,n!=null&&t.push(":",String(n))),(n=this.l)&&(this.i&&n.charAt(0)!="/"&&t.push("/"),t.push(Nc(n,n.charAt(0)=="/"?Zz:Xz,!0))),(n=this.h.toString())&&t.push("?",n),(n=this.o)&&t.push("#",Nc(n,t2)),t.join("")};function os(t){return new io(t)}function gd(t,e,n){t.j=n?zc(e,!0):e,t.j&&(t.j=t.j.replace(/:$/,""))}function md(t,e,n){t.i=n?zc(e,!0):e}function _d(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.m=e}else t.m=null}function pE(t,e,n){e instanceof $l?(t.h=e,n2(t.h,t.g)):(n||(e=Nc(e,e2)),t.h=new $l(e,t.g))}function He(t,e,n){t.h.set(e,n)}function Hf(t){return He(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),t}function Qz(t){return t instanceof io?os(t):new io(t,void 0)}function Yz(t,e,n,r){var s=new io(null,void 0);return t&&gd(s,t),e&&md(s,e),n&&_d(s,n),r&&(s.l=r),s}function zc(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function Nc(t,e,n){return typeof t=="string"?(t=encodeURI(t).replace(e,Jz),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function Jz(t){return t=t.charCodeAt(0),"%"+(t>>4&15).toString(16)+(t&15).toString(16)}var gE=/[#\/\?@]/g,Xz=/[#\?:]/g,Zz=/[#\?]/g,e2=/[#\?@]/g,t2=/#/g;function $l(t,e){this.h=this.g=null,this.i=t||null,this.j=!!e}function ci(t){t.g||(t.g=new Ya,t.h=0,t.i&&zz(t.i,function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)}))}K=$l.prototype;K.add=function(t,e){ci(this),this.i=null,t=Ja(this,t);var n=this.g.get(t);return n||this.g.set(t,n=[]),n.push(e),this.h+=1,this};function SR(t,e){ci(t),e=Ja(t,e),so(t.g.h,e)&&(t.i=null,t.h-=t.g.get(e).length,t=t.g,so(t.h,e)&&(delete t.h[e],t.i--,t.g.length>2*t.i&&lv(t)))}function CR(t,e){return ci(t),e=Ja(t,e),so(t.g.h,e)}K.forEach=function(t,e){ci(this),this.g.forEach(function(n,r){Xk(n,function(s){t.call(e,s,r,this)},this)},this)};K.T=function(){ci(this);for(var t=this.g.R(),e=this.g.T(),n=[],r=0;r<e.length;r++)for(var s=t[r],i=0;i<s.length;i++)n.push(e[r]);return n};K.R=function(t){ci(this);var e=[];if(typeof t=="string")CR(this,t)&&(e=iE(e,this.g.get(Ja(this,t))));else{t=this.g.R();for(var n=0;n<t.length;n++)e=iE(e,t[n])}return e};K.set=function(t,e){return ci(this),this.i=null,t=Ja(this,t),CR(this,t)&&(this.h-=this.g.get(t).length),this.g.set(t,[e]),this.h+=1,this};K.get=function(t,e){return t?(t=this.R(t),0<t.length?String(t[0]):e):e};function AR(t,e,n){SR(t,e),0<n.length&&(t.i=null,t.g.set(Ja(t,e),zy(n)),t.h+=n.length)}K.toString=function(){if(this.i)return this.i;if(!this.g)return"";for(var t=[],e=this.g.T(),n=0;n<e.length;n++){var r=e[n],s=encodeURIComponent(String(r));r=this.R(r);for(var i=0;i<r.length;i++){var o=s;r[i]!==""&&(o+="="+encodeURIComponent(String(r[i]))),t.push(o)}}return this.i=t.join("&")};function Ja(t,e){return e=String(e),t.j&&(e=e.toLowerCase()),e}function n2(t,e){e&&!t.j&&(ci(t),t.i=null,t.g.forEach(function(n,r){var s=r.toLowerCase();r!=s&&(SR(this,r),AR(this,s,n))},t)),t.j=e}var r2=class{constructor(t,e){this.h=t,this.g=e}};function kR(t){this.l=t||s2,oe.PerformanceNavigationTiming?(t=oe.performance.getEntriesByType("navigation"),t=0<t.length&&(t[0].nextHopProtocol=="hq"||t[0].nextHopProtocol=="h2")):t=!!(oe.g&&oe.g.Ea&&oe.g.Ea()&&oe.g.Ea().Zb),this.j=t?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var s2=10;function RR(t){return t.h?!0:t.g?t.g.size>=t.j:!1}function NR(t){return t.h?1:t.g?t.g.size:0}function Fm(t,e){return t.h?t.h==e:t.g?t.g.has(e):!1}function uv(t,e){t.g?t.g.add(e):t.h=e}function PR(t,e){t.h&&t.h==e?t.h=null:t.g&&t.g.has(e)&&t.g.delete(e)}kR.prototype.cancel=function(){if(this.i=DR(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const t of this.g.values())t.cancel();this.g.clear()}};function DR(t){if(t.h!=null)return t.i.concat(t.h.D);if(t.g!=null&&t.g.size!==0){let e=t.i;for(const n of t.g.values())e=e.concat(n.D);return e}return zy(t.i)}function hv(){}hv.prototype.stringify=function(t){return oe.JSON.stringify(t,void 0)};hv.prototype.parse=function(t){return oe.JSON.parse(t,void 0)};function i2(){this.g=new hv}function o2(t,e,n){const r=n||"";try{cv(t,function(s,i){let o=s;Iu(s)&&(o=tv(s)),e.push(r+i+"="+encodeURIComponent(o))})}catch(s){throw e.push(r+"type="+encodeURIComponent("_badmap")),s}}function a2(t,e){const n=new Bf;if(oe.Image){const r=new Image;r.onload=eh(nh,n,r,"TestLoadImage: loaded",!0,e),r.onerror=eh(nh,n,r,"TestLoadImage: error",!1,e),r.onabort=eh(nh,n,r,"TestLoadImage: abort",!1,e),r.ontimeout=eh(nh,n,r,"TestLoadImage: timeout",!1,e),oe.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=t}else e(!1)}function nh(t,e,n,r,s){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,s(r)}catch{}}function ku(t){this.l=t.$b||null,this.j=t.ib||!1}zt(ku,iv);ku.prototype.g=function(){return new Gf(this.l,this.j)};ku.prototype.i=function(t){return function(){return t}}({});function Gf(t,e){Ot.call(this),this.D=t,this.u=e,this.m=void 0,this.readyState=dv,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}zt(Gf,Ot);var dv=0;K=Gf.prototype;K.open=function(t,e){if(this.readyState!=dv)throw this.abort(),Error("Error reopening a connection");this.C=t,this.B=e,this.readyState=1,Vl(this)};K.send=function(t){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};t&&(e.body=t),(this.D||oe).fetch(new Request(this.B,e)).then(this.Va.bind(this),this.ha.bind(this))};K.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted."),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Ru(this)),this.readyState=dv};K.Va=function(t){if(this.g&&(this.l=t,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=t.headers,this.readyState=2,Vl(this)),this.g&&(this.readyState=3,Vl(this),this.g)))if(this.responseType==="arraybuffer")t.arrayBuffer().then(this.Ta.bind(this),this.ha.bind(this));else if(typeof oe.ReadableStream!="undefined"&&"body"in t){if(this.j=t.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;xR(this)}else t.text().then(this.Ua.bind(this),this.ha.bind(this))};function xR(t){t.j.read().then(t.Sa.bind(t)).catch(t.ha.bind(t))}K.Sa=function(t){if(this.g){if(this.u&&t.value)this.response.push(t.value);else if(!this.u){var e=t.value?t.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!t.done}))&&(this.response=this.responseText+=e)}t.done?Ru(this):Vl(this),this.readyState==3&&xR(this)}};K.Ua=function(t){this.g&&(this.response=this.responseText=t,Ru(this))};K.Ta=function(t){this.g&&(this.response=t,Ru(this))};K.ha=function(){this.g&&Ru(this)};function Ru(t){t.readyState=4,t.l=null,t.j=null,t.A=null,Vl(t)}K.setRequestHeader=function(t,e){this.v.append(t,e)};K.getResponseHeader=function(t){return this.h&&this.h.get(t.toLowerCase())||""};K.getAllResponseHeaders=function(){if(!this.h)return"";const t=[],e=this.h.entries();for(var n=e.next();!n.done;)n=n.value,t.push(n[0]+": "+n[1]),n=e.next();return t.join(`\r
`)};function Vl(t){t.onreadystatechange&&t.onreadystatechange.call(t)}Object.defineProperty(Gf.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(t){this.m=t?"include":"same-origin"}});var c2=oe.JSON.parse;function ft(t){Ot.call(this),this.headers=new Ya,this.u=t||null,this.h=!1,this.C=this.g=null,this.H="",this.m=0,this.j="",this.l=this.F=this.v=this.D=!1,this.B=0,this.A=null,this.J=OR,this.K=this.L=!1}zt(ft,Ot);var OR="",l2=/^https?$/i,u2=["POST","PUT"];K=ft.prototype;K.ea=function(t,e,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.H+"; newUri="+t);e=e?e.toUpperCase():"GET",this.H=t,this.j="",this.m=0,this.D=!1,this.h=!0,this.g=this.u?this.u.g():xm.g(),this.C=this.u?fE(this.u):fE(xm),this.g.onreadystatechange=Kt(this.Fa,this);try{this.F=!0,this.g.open(e,String(t),!0),this.F=!1}catch(i){mE(this,i);return}t=n||"";const s=new Ya(this.headers);r&&cv(r,function(i,o){s.set(o,i)}),r=bz(s.T()),n=oe.FormData&&t instanceof oe.FormData,!(0<=Jk(u2,e))||r||n||s.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),s.forEach(function(i,o){this.g.setRequestHeader(o,i)},this),this.J&&(this.g.responseType=this.J),"withCredentials"in this.g&&this.g.withCredentials!==this.L&&(this.g.withCredentials=this.L);try{FR(this),0<this.B&&((this.K=h2(this.g))?(this.g.timeout=this.B,this.g.ontimeout=Kt(this.pa,this)):this.A=sv(this.pa,this.B,this)),this.v=!0,this.g.send(t),this.v=!1}catch(i){mE(this,i)}};function h2(t){return Ca&&Cz()&&typeof t.timeout=="number"&&t.ontimeout!==void 0}function d2(t){return t.toLowerCase()=="content-type"}K.pa=function(){typeof Gy!="undefined"&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,Wt(this,"timeout"),this.abort(8))};function mE(t,e){t.h=!1,t.g&&(t.l=!0,t.g.abort(),t.l=!1),t.j=e,t.m=5,MR(t),zf(t)}function MR(t){t.D||(t.D=!0,Wt(t,"complete"),Wt(t,"error"))}K.abort=function(t){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=t||7,Wt(this,"complete"),Wt(this,"abort"),zf(this))};K.M=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),zf(this,!0)),ft.Z.M.call(this)};K.Fa=function(){this.s||(this.F||this.v||this.l?LR(this):this.cb())};K.cb=function(){LR(this)};function LR(t){if(t.h&&typeof Gy!="undefined"&&(!t.C[1]||Jr(t)!=4||t.ba()!=2)){if(t.v&&Jr(t)==4)sv(t.Fa,0,t);else if(Wt(t,"readystatechange"),Jr(t)==4){t.h=!1;try{const a=t.ba();e:switch(a){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break e;default:e=!1}var n;if(!(n=e)){var r;if(r=a===0){var s=String(t.H).match(TR)[1]||null;if(!s&&oe.self&&oe.self.location){var i=oe.self.location.protocol;s=i.substr(0,i.length-1)}r=!l2.test(s?s.toLowerCase():"")}n=r}if(n)Wt(t,"complete"),Wt(t,"success");else{t.m=6;try{var o=2<Jr(t)?t.g.statusText:""}catch{o=""}t.j=o+" ["+t.ba()+"]",MR(t)}}finally{zf(t)}}}}function zf(t,e){if(t.g){FR(t);const n=t.g,r=t.C[0]?hd:null;t.g=null,t.C=null,e||Wt(t,"ready");try{n.onreadystatechange=r}catch{}}}function FR(t){t.g&&t.K&&(t.g.ontimeout=null),t.A&&(oe.clearTimeout(t.A),t.A=null)}function Jr(t){return t.g?t.g.readyState:0}K.ba=function(){try{return 2<Jr(this)?this.g.status:-1}catch{return-1}};K.ga=function(){try{return this.g?this.g.responseText:""}catch{return""}};K.Qa=function(t){if(this.g){var e=this.g.responseText;return t&&e.indexOf(t)==0&&(e=e.substring(t.length)),c2(e)}};function _E(t){try{if(!t.g)return null;if("response"in t.g)return t.g.response;switch(t.J){case OR:case"text":return t.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in t.g)return t.g.mozResponseArrayBuffer}return null}catch{return null}}K.Da=function(){return this.m};K.La=function(){return typeof this.j=="string"?this.j:String(this.j)};function f2(t){let e="";return Qy(t,function(n,r){e+=r,e+=":",e+=n,e+=`\r
`}),e}function fv(t,e,n){e:{for(r in n){var r=!1;break e}r=!0}r||(n=f2(n),typeof t=="string"?n!=null&&encodeURIComponent(String(n)):He(t,e,n))}function yc(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function UR(t){this.za=0,this.l=[],this.h=new Bf,this.la=this.oa=this.F=this.W=this.g=this.sa=this.D=this.aa=this.o=this.P=this.s=null,this.Za=this.V=0,this.Xa=yc("failFast",!1,t),this.N=this.v=this.u=this.m=this.j=null,this.X=!0,this.I=this.ta=this.U=-1,this.Y=this.A=this.C=0,this.Pa=yc("baseRetryDelayMs",5e3,t),this.$a=yc("retryDelaySeedMs",1e4,t),this.Ya=yc("forwardChannelMaxRetries",2,t),this.ra=yc("forwardChannelRequestTimeoutMs",2e4,t),this.qa=t&&t.xmlHttpFactory||void 0,this.Ba=t&&t.Yb||!1,this.K=void 0,this.H=t&&t.supportsCrossDomainXhr||!1,this.J="",this.i=new kR(t&&t.concurrentRequestLimit),this.Ca=new i2,this.ja=t&&t.fastHandshake||!1,this.Ra=t&&t.Wb||!1,t&&t.Aa&&this.h.Aa(),t&&t.forceLongPolling&&(this.X=!1),this.$=!this.ja&&this.X&&t&&t.detectBufferingProxy||!1,this.ka=void 0,this.O=0,this.L=!1,this.B=null,this.Wa=!t||t.Xb!==!1}K=UR.prototype;K.ma=8;K.G=1;function pv(t){if($R(t),t.G==3){var e=t.V++,n=os(t.F);He(n,"SID",t.J),He(n,"RID",e),He(n,"TYPE","terminate"),Nu(t,n),e=new Cu(t,t.h,e,void 0),e.K=2,e.v=Hf(os(n)),n=!1,oe.navigator&&oe.navigator.sendBeacon&&(n=oe.navigator.sendBeacon(e.v.toString(),"")),!n&&oe.Image&&(new Image().src=e.v,n=!0),n||(e.g=GR(e.l,null),e.g.ea(e.v)),e.F=Date.now(),Au(e)}WR(t)}K.hb=function(t){try{this.h.info("Origin Trials invoked: "+t)}catch{}};function Qf(t){t.g&&(mv(t),t.g.cancel(),t.g=null)}function $R(t){Qf(t),t.u&&(oe.clearTimeout(t.u),t.u=null),yd(t),t.i.cancel(),t.m&&(typeof t.m=="number"&&oe.clearTimeout(t.m),t.m=null)}function ng(t,e){t.l.push(new r2(t.Za++,e)),t.G==3&&Yf(t)}function Yf(t){RR(t.i)||t.m||(t.m=!0,nv(t.Ha,t),t.C=0)}function p2(t,e){return NR(t.i)>=t.i.j-(t.m?1:0)?!1:t.m?(t.l=e.D.concat(t.l),!0):t.G==1||t.G==2||t.C>=(t.Xa?0:t.Ya)?!1:(t.m=Tu(Kt(t.Ha,t,e),KR(t,t.C)),t.C++,!0)}K.Ha=function(t){if(this.m)if(this.m=null,this.G==1){if(!t){this.V=Math.floor(1e5*Math.random()),t=this.V++;const s=new Cu(this,this.h,t,void 0);let i=this.s;if(this.P&&(i?(i=Zk(i),eR(i,this.P)):i=this.P),this.o===null&&(s.H=i),this.ja)e:{for(var e=0,n=0;n<this.l.length;n++){t:{var r=this.l[n];if("__data__"in r.g&&(r=r.g.__data__,typeof r=="string")){r=r.length;break t}r=void 0}if(r===void 0)break;if(e+=r,4096<e){e=n;break e}if(e===4096||n===this.l.length-1){e=n+1;break e}}e=1e3}else e=1e3;e=VR(this,s,e),n=os(this.F),He(n,"RID",t),He(n,"CVER",22),this.D&&He(n,"X-HTTP-Session-Id",this.D),Nu(this,n),this.o&&i&&fv(n,this.o,i),uv(this.i,s),this.Ra&&He(n,"TYPE","init"),this.ja?(He(n,"$req",e),He(n,"SID","null"),s.$=!0,Mm(s,n,null)):Mm(s,n,e),this.G=2}}else this.G==3&&(t?yE(this,t):this.l.length==0||RR(this.i)||yE(this))};function yE(t,e){var n;e?n=e.m:n=t.V++;const r=os(t.F);He(r,"SID",t.J),He(r,"RID",n),He(r,"AID",t.U),Nu(t,r),t.o&&t.s&&fv(r,t.o,t.s),n=new Cu(t,t.h,n,t.C+1),t.o===null&&(n.H=t.s),e&&(t.l=e.D.concat(t.l)),e=VR(t,n,1e3),n.setTimeout(Math.round(.5*t.ra)+Math.round(.5*t.ra*Math.random())),uv(t.i,n),Mm(n,r,e)}function Nu(t,e){t.j&&cv({},function(n,r){He(e,r,n)})}function VR(t,e,n){n=Math.min(t.l.length,n);var r=t.j?Kt(t.j.Oa,t.j,t):null;e:{var s=t.l;let i=-1;for(;;){const o=["count="+n];i==-1?0<n?(i=s[0].h,o.push("ofs="+i)):i=0:o.push("ofs="+i);let a=!0;for(let c=0;c<n;c++){let l=s[c].h;const u=s[c].g;if(l-=i,0>l)i=Math.max(0,s[c].h-100),a=!1;else try{o2(u,o,"req"+l+"_")}catch{r&&r(u)}}if(a){r=o.join("&");break e}}}return t=t.l.splice(0,n),e.D=t,r}function BR(t){t.g||t.u||(t.Y=1,nv(t.Ga,t),t.A=0)}function gv(t){return t.g||t.u||3<=t.A?!1:(t.Y++,t.u=Tu(Kt(t.Ga,t),KR(t,t.A)),t.A++,!0)}K.Ga=function(){if(this.u=null,qR(this),this.$&&!(this.L||this.g==null||0>=this.O)){var t=2*this.O;this.h.info("BP detection timer enabled: "+t),this.B=Tu(Kt(this.bb,this),t)}};K.bb=function(){this.B&&(this.B=null,this.h.info("BP detection timeout reached."),this.h.info("Buffering proxy detected and switch to long-polling!"),this.N=!1,this.L=!0,un(10),Qf(this),qR(this))};function mv(t){t.B!=null&&(oe.clearTimeout(t.B),t.B=null)}function qR(t){t.g=new Cu(t,t.h,"rpc",t.Y),t.o===null&&(t.g.H=t.s),t.g.O=0;var e=os(t.oa);He(e,"RID","rpc"),He(e,"SID",t.J),He(e,"CI",t.N?"0":"1"),He(e,"AID",t.U),Nu(t,e),He(e,"TYPE","xmlhttp"),t.o&&t.s&&fv(e,t.o,t.s),t.K&&t.g.setTimeout(t.K);var n=t.g;t=t.la,n.K=1,n.v=Hf(os(e)),n.s=null,n.U=!0,wR(n,t)}K.ab=function(){this.v!=null&&(this.v=null,Qf(this),gv(this),un(19))};function yd(t){t.v!=null&&(oe.clearTimeout(t.v),t.v=null)}function jR(t,e){var n=null;if(t.g==e){yd(t),mv(t),t.g=null;var r=2}else if(Fm(t.i,e))n=e.D,PR(t.i,e),r=1;else return;if(t.I=e.N,t.G!=0){if(e.i)if(r==1){n=e.s?e.s.length:0,e=Date.now()-e.F;var s=t.C;r=qf(),Wt(r,new mR(r,n)),Yf(t)}else BR(t);else if(s=e.o,s==3||s==0&&0<t.I||!(r==1&&p2(t,e)||r==2&&gv(t)))switch(n&&0<n.length&&(e=t.i,e.i=e.i.concat(n)),s){case 1:Fi(t,5);break;case 4:Fi(t,10);break;case 3:Fi(t,6);break;default:Fi(t,2)}}}function KR(t,e){let n=t.Pa+Math.floor(Math.random()*t.$a);return t.j||(n*=2),n*e}function Fi(t,e){if(t.h.info("Error code "+e),e==2){var n=null;t.j&&(n=null);var r=Kt(t.jb,t);n||(n=new io("//www.google.com/images/cleardot.gif"),oe.location&&oe.location.protocol=="http"||gd(n,"https"),Hf(n)),a2(n.toString(),r)}else un(2);t.G=0,t.j&&t.j.va(e),WR(t),$R(t)}K.jb=function(t){t?(this.h.info("Successfully pinged google.com"),un(2)):(this.h.info("Failed to ping google.com"),un(1))};function WR(t){t.G=0,t.I=-1,t.j&&((DR(t.i).length!=0||t.l.length!=0)&&(t.i.i.length=0,zy(t.l),t.l.length=0),t.j.ua())}function HR(t,e,n){let r=Qz(n);if(r.i!="")e&&md(r,e+"."+r.i),_d(r,r.m);else{const s=oe.location;r=Yz(s.protocol,e?e+"."+s.hostname:s.hostname,+s.port,n)}return t.aa&&Qy(t.aa,function(s,i){He(r,i,s)}),e=t.D,n=t.sa,e&&n&&He(r,e,n),He(r,"VER",t.ma),Nu(t,r),r}function GR(t,e,n){if(e&&!t.H)throw Error("Can't create secondary domain capable XhrIo object.");return e=n&&t.Ba&&!t.qa?new ft(new ku({ib:!0})):new ft(t.qa),e.L=t.H,e}function zR(){}K=zR.prototype;K.xa=function(){};K.wa=function(){};K.va=function(){};K.ua=function(){};K.Oa=function(){};function vd(){if(Ca&&!(10<=Number(Az)))throw Error("Environmental error: no available transport.")}vd.prototype.g=function(t,e){return new On(t,e)};function On(t,e){Ot.call(this),this.g=new UR(e),this.l=t,this.h=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.g.s=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.ya&&(t?t["X-WebChannel-Client-Profile"]=e.ya:t={"X-WebChannel-Client-Profile":e.ya}),this.g.P=t,(t=e&&e.httpHeadersOverwriteParam)&&!dd(t)&&(this.g.o=t),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!dd(e)&&(this.g.D=e,t=this.h,t!==null&&e in t&&(t=this.h,e in t&&delete t[e])),this.j=new Xa(this)}zt(On,Ot);On.prototype.m=function(){this.g.j=this.j,this.A&&(this.g.H=!0);var t=this.g,e=this.l,n=this.h||void 0;t.Wa&&(t.h.info("Origin Trials enabled."),nv(Kt(t.hb,t,e))),un(0),t.W=e,t.aa=n||{},t.N=t.X,t.F=HR(t,null,t.W),Yf(t)};On.prototype.close=function(){pv(this.g)};On.prototype.u=function(t){if(typeof t=="string"){var e={};e.__data__=t,ng(this.g,e)}else this.v?(e={},e.__data__=tv(t),ng(this.g,e)):ng(this.g,t)};On.prototype.M=function(){this.g.j=null,delete this.j,pv(this.g),delete this.g,On.Z.M.call(this)};function QR(t){ov.call(this);var e=t.__sm__;if(e){e:{for(const n in e){t=n;break e}t=void 0}(this.i=t)&&(t=this.i,e=e!==null&&t in e?e[t]:void 0),this.data=e}else this.data=t}zt(QR,ov);function YR(){av.call(this),this.status=1}zt(YR,av);function Xa(t){this.g=t}zt(Xa,zR);Xa.prototype.xa=function(){Wt(this.g,"a")};Xa.prototype.wa=function(t){Wt(this.g,new QR(t))};Xa.prototype.va=function(t){Wt(this.g,new YR)};Xa.prototype.ua=function(){Wt(this.g,"b")};vd.prototype.createWebChannel=vd.prototype.g;On.prototype.send=On.prototype.u;On.prototype.open=On.prototype.m;On.prototype.close=On.prototype.close;jf.NO_ERROR=0;jf.TIMEOUT=8;jf.HTTP_ERROR=6;_R.COMPLETE="complete";yR.EventType=Su;Su.OPEN="a";Su.CLOSE="b";Su.ERROR="c";Su.MESSAGE="d";Ot.prototype.listen=Ot.prototype.N;ft.prototype.listenOnce=ft.prototype.O;ft.prototype.getLastError=ft.prototype.La;ft.prototype.getLastErrorCode=ft.prototype.Da;ft.prototype.getStatus=ft.prototype.ba;ft.prototype.getResponseJson=ft.prototype.Qa;ft.prototype.getResponseText=ft.prototype.ga;ft.prototype.send=ft.prototype.ea;var g2=function(){return new vd},m2=function(){return qf()},rg=jf,_2=_R,y2=Ao,vE={rb:0,ub:1,vb:2,Ob:3,Tb:4,Qb:5,Rb:6,Pb:7,Nb:8,Sb:9,PROXY:10,NOPROXY:11,Lb:12,Hb:13,Ib:14,Gb:15,Jb:16,Kb:17,nb:18,mb:19,ob:20},v2=ku,rh=yR,w2=ft;const wE="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Et{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Et.UNAUTHENTICATED=new Et(null),Et.GOOGLE_CREDENTIALS=new Et("google-credentials-uid"),Et.FIRST_PARTY=new Et("first-party-uid"),Et.MOCK_USER=new Et("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Za="9.9.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xs=new Vr("@firebase/firestore");function Um(){return Xs.logLevel}function b2(t){Xs.setLogLevel(t)}function R(t,...e){if(Xs.logLevel<=de.DEBUG){const n=e.map(_v);Xs.debug(`Firestore (${Za}): ${t}`,...n)}}function dt(t,...e){if(Xs.logLevel<=de.ERROR){const n=e.map(_v);Xs.error(`Firestore (${Za}): ${t}`,...n)}}function Bl(t,...e){if(Xs.logLevel<=de.WARN){const n=e.map(_v);Xs.warn(`Firestore (${Za}): ${t}`,...n)}}function _v(t){if(typeof t=="string")return t;try{return e=t,JSON.stringify(e)}catch{return t}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/var e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function W(t="Unexpected state"){const e=`FIRESTORE (${Za}) INTERNAL ASSERTION FAILED: `+t;throw dt(e),new Error(e)}function se(t,e){t||W()}function I2(t,e){t||W()}function B(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const w={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class S extends lt{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class At{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JR{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class E2{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(Et.UNAUTHENTICATED))}shutdown(){}}class T2{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class S2{constructor(e){this.t=e,this.currentUser=Et.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){let r=this.i;const s=c=>this.i!==r?(r=this.i,n(c)):Promise.resolve();let i=new At;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new At,e.enqueueRetryable(()=>s(this.currentUser))};const o=()=>{const c=i;e.enqueueRetryable(async()=>{await c.promise,await s(this.currentUser)})},a=c=>{R("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.auth.addAuthTokenListener(this.o),o()};this.t.onInit(c=>a(c)),setTimeout(()=>{if(!this.auth){const c=this.t.getImmediate({optional:!0});c?a(c):(R("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new At)}},0),o()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(R("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(se(typeof r.accessToken=="string"),new JR(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const e=this.auth&&this.auth.getUid();return se(e===null||typeof e=="string"),new Et(e)}}class C2{constructor(e,n,r){this.type="FirstParty",this.user=Et.FIRST_PARTY,this.headers=new Map,this.headers.set("X-Goog-AuthUser",n);const s=e.auth.getAuthHeaderValueForFirstParty([]);s&&this.headers.set("Authorization",s),r&&this.headers.set("X-Goog-Iam-Authorization-Token",r)}}class A2{constructor(e,n,r){this.h=e,this.l=n,this.m=r}getToken(){return Promise.resolve(new C2(this.h,this.l,this.m))}start(e,n){e.enqueueRetryable(()=>n(Et.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class k2{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class R2{constructor(e){this.g=e,this.forceRefresh=!1,this.appCheck=null,this.p=null}start(e,n){const r=i=>{i.error!=null&&R("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const o=i.token!==this.p;return this.p=i.token,R("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>r(i))};const s=i=>{R("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.appCheck.addTokenListener(this.o)};this.g.onInit(i=>s(i)),setTimeout(()=>{if(!this.appCheck){const i=this.g.getImmediate({optional:!0});i?s(i):R("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(se(typeof n.token=="string"),this.p=n.token,new k2(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function N2(t){const e=typeof self!="undefined"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XR{static I(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=Math.floor(256/e.length)*e.length;let r="";for(;r.length<20;){const s=N2(40);for(let i=0;i<s.length;++i)r.length<20&&s[i]<n&&(r+=e.charAt(s[i]%e.length))}return r}}function ce(t,e){return t<e?-1:t>e?1:0}function Aa(t,e,n){return t.length===e.length&&t.every((r,s)=>n(r,e[s]))}function ZR(t){return t+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ze{constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new S(w.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new S(w.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<-62135596800)throw new S(w.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new S(w.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return ze.fromMillis(Date.now())}static fromDate(e){return ze.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*n));return new ze(n,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?ce(this.nanoseconds,e.nanoseconds):ce(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class re{constructor(e){this.timestamp=e}static fromTimestamp(e){return new re(e)}static min(){return new re(new ze(0,0))}static max(){return new re(new ze(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ql{constructor(e,n,r){n===void 0?n=0:n>e.length&&W(),r===void 0?r=e.length-n:r>e.length-n&&W(),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return ql.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof ql?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let s=0;s<r;s++){const i=e.get(s),o=n.get(s);if(i<o)return-1;if(i>o)return 1}return e.length<n.length?-1:e.length>n.length?1:0}}class we extends ql{construct(e,n,r){return new we(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new S(w.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(s=>s.length>0))}return new we(n)}static emptyPath(){return new we([])}}const P2=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class ot extends ql{construct(e,n,r){return new ot(e,n,r)}static isValidIdentifier(e){return P2.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),ot.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new ot(["__name__"])}static fromServerFormat(e){const n=[];let r="",s=0;const i=()=>{if(r.length===0)throw new S(w.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let o=!1;for(;s<e.length;){const a=e[s];if(a==="\\"){if(s+1===e.length)throw new S(w.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const c=e[s+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new S(w.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=c,s+=2}else a==="`"?(o=!o,s++):a!=="."||o?(r+=a,s++):(i(),s++)}if(i(),o)throw new S(w.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new ot(n)}static emptyPath(){return new ot([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F{constructor(e){this.path=e}static fromPath(e){return new F(we.fromString(e))}static fromName(e){return new F(we.fromString(e).popFirst(5))}static empty(){return new F(we.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&we.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return we.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new F(new we(e.slice()))}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eN{constructor(e,n,r,s){this.indexId=e,this.collectionGroup=n,this.fields=r,this.indexState=s}}function $m(t){return t.fields.find(e=>e.kind===2)}function Ei(t){return t.fields.filter(e=>e.kind!==2)}eN.UNKNOWN_ID=-1;class D2{constructor(e,n){this.fieldPath=e,this.kind=n}}class wd{constructor(e,n){this.sequenceNumber=e,this.offset=n}static empty(){return new wd(0,Mn.min())}}function tN(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,s=re.fromTimestamp(r===1e9?new ze(n+1,0):new ze(n,r));return new Mn(s,F.empty(),e)}function nN(t){return new Mn(t.readTime,t.key,-1)}class Mn{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new Mn(re.min(),F.empty(),-1)}static max(){return new Mn(re.max(),F.empty(),-1)}}function yv(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=F.comparator(t.documentKey,e.documentKey),n!==0?n:ce(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rN="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class sN{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function li(t){if(t.code!==w.FAILED_PRECONDITION||t.message!==rN)throw t;R("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class v{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&W(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new v((r,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(r,s)},this.catchCallback=i=>{this.wrapFailure(n,i).next(r,s)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof v?n:v.resolve(n)}catch(n){return v.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):v.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):v.reject(n)}static resolve(e){return new v((n,r)=>{n(e)})}static reject(e){return new v((n,r)=>{r(e)})}static waitFor(e){return new v((n,r)=>{let s=0,i=0,o=!1;e.forEach(a=>{++s,a.next(()=>{++i,o&&i===s&&n()},c=>r(c))}),o=!0,i===s&&n()})}static or(e){let n=v.resolve(!1);for(const r of e)n=n.next(s=>s?v.resolve(s):r());return n}static forEach(e,n){const r=[];return e.forEach((s,i)=>{r.push(n.call(this,s,i))}),this.waitFor(r)}static mapArray(e,n){return new v((r,s)=>{const i=e.length,o=new Array(i);let a=0;for(let c=0;c<i;c++){const l=c;n(e[l]).next(u=>{o[l]=u,++a,a===i&&r(o)},u=>s(u))}})}static doWhile(e,n){return new v((r,s)=>{const i=()=>{e()===!0?n().next(()=>{i()},s):r()};i()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jf{constructor(e,n){this.action=e,this.transaction=n,this.aborted=!1,this.T=new At,this.transaction.oncomplete=()=>{this.T.resolve()},this.transaction.onabort=()=>{n.error?this.T.reject(new Qc(e,n.error)):this.T.resolve()},this.transaction.onerror=r=>{const s=vv(r.target.error);this.T.reject(new Qc(e,s))}}static open(e,n,r,s){try{return new Jf(n,e.transaction(s,r))}catch(i){throw new Qc(n,i)}}get A(){return this.T.promise}abort(e){e&&this.T.reject(e),this.aborted||(R("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}R(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const n=this.transaction.objectStore(e);return new O2(n)}}class sr{constructor(e,n,r){this.name=e,this.version=n,this.P=r,sr.v(We())===12.2&&dt("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return R("SimpleDb","Removing database:",e),Ai(window.indexedDB.deleteDatabase(e)).toPromise()}static V(){if(!In())return!1;if(sr.S())return!0;const e=We(),n=sr.v(e),r=0<n&&n<10,s=sr.D(e),i=0<s&&s<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||i)}static S(){var e;return typeof process!="undefined"&&((e=process.env)===null||e===void 0?void 0:e.C)==="YES"}static N(e,n){return e.store(n)}static v(e){const n=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=n?n[1].split("_").slice(0,2).join("."):"-1";return Number(r)}static D(e){const n=e.match(/Android ([\d.]+)/i),r=n?n[1].split(".").slice(0,2).join("."):"-1";return Number(r)}async k(e){return this.db||(R("SimpleDb","Opening database:",this.name),this.db=await new Promise((n,r)=>{const s=indexedDB.open(this.name,this.version);s.onsuccess=i=>{const o=i.target.result;n(o)},s.onblocked=()=>{r(new Qc(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},s.onerror=i=>{const o=i.target.error;o.name==="VersionError"?r(new S(w.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?r(new S(w.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):r(new Qc(e,o))},s.onupgradeneeded=i=>{R("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',i.oldVersion);const o=i.target.result;this.P.O(o,s.transaction,i.oldVersion,this.version).next(()=>{R("SimpleDb","Database upgrade to version "+this.version+" complete")})}})),this.M&&(this.db.onversionchange=n=>this.M(n)),this.db}F(e){this.M=e,this.db&&(this.db.onversionchange=n=>e(n))}async runTransaction(e,n,r,s){const i=n==="readonly";let o=0;for(;;){++o;try{this.db=await this.k(e);const a=Jf.open(this.db,e,i?"readonly":"readwrite",r),c=s(a).next(l=>(a.R(),l)).catch(l=>(a.abort(l),v.reject(l))).toPromise();return c.catch(()=>{}),await a.A,c}catch(a){const c=a,l=c.name!=="FirebaseError"&&o<3;if(R("SimpleDb","Transaction failed with error:",c.message,"Retrying:",l),this.close(),!l)return Promise.reject(c)}}}close(){this.db&&this.db.close(),this.db=void 0}}class x2{constructor(e){this.$=e,this.B=!1,this.L=null}get isDone(){return this.B}get U(){return this.L}set cursor(e){this.$=e}done(){this.B=!0}q(e){this.L=e}delete(){return Ai(this.$.delete())}}class Qc extends S{constructor(e,n){super(w.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${n}`),this.name="IndexedDbTransactionError"}}function ui(t){return t.name==="IndexedDbTransactionError"}class O2{constructor(e){this.store=e}put(e,n){let r;return n!==void 0?(R("SimpleDb","PUT",this.store.name,e,n),r=this.store.put(n,e)):(R("SimpleDb","PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),Ai(r)}add(e){return R("SimpleDb","ADD",this.store.name,e,e),Ai(this.store.add(e))}get(e){return Ai(this.store.get(e)).next(n=>(n===void 0&&(n=null),R("SimpleDb","GET",this.store.name,e,n),n))}delete(e){return R("SimpleDb","DELETE",this.store.name,e),Ai(this.store.delete(e))}count(){return R("SimpleDb","COUNT",this.store.name),Ai(this.store.count())}K(e,n){const r=this.options(e,n);if(r.index||typeof this.store.getAll!="function"){const s=this.cursor(r),i=[];return this.G(s,(o,a)=>{i.push(a)}).next(()=>i)}{const s=this.store.getAll(r.range);return new v((i,o)=>{s.onerror=a=>{o(a.target.error)},s.onsuccess=a=>{i(a.target.result)}})}}j(e,n){const r=this.store.getAll(e,n===null?void 0:n);return new v((s,i)=>{r.onerror=o=>{i(o.target.error)},r.onsuccess=o=>{s(o.target.result)}})}W(e,n){R("SimpleDb","DELETE ALL",this.store.name);const r=this.options(e,n);r.H=!1;const s=this.cursor(r);return this.G(s,(i,o,a)=>a.delete())}J(e,n){let r;n?r=e:(r={},n=e);const s=this.cursor(r);return this.G(s,n)}Y(e){const n=this.cursor({});return new v((r,s)=>{n.onerror=i=>{const o=vv(i.target.error);s(o)},n.onsuccess=i=>{const o=i.target.result;o?e(o.primaryKey,o.value).next(a=>{a?o.continue():r()}):r()}})}G(e,n){const r=[];return new v((s,i)=>{e.onerror=o=>{i(o.target.error)},e.onsuccess=o=>{const a=o.target.result;if(!a)return void s();const c=new x2(a),l=n(a.primaryKey,a.value,c);if(l instanceof v){const u=l.catch(h=>(c.done(),v.reject(h)));r.push(u)}c.isDone?s():c.U===null?a.continue():a.continue(c.U)}}).next(()=>v.waitFor(r))}options(e,n){let r;return e!==void 0&&(typeof e=="string"?r=e:n=e),{index:r,range:n}}cursor(e){let n="next";if(e.reverse&&(n="prev"),e.index){const r=this.store.index(e.index);return e.H?r.openKeyCursor(e.range,n):r.openCursor(e.range,n)}return this.store.openCursor(e.range,n)}}function Ai(t){return new v((e,n)=>{t.onsuccess=r=>{const s=r.target.result;e(s)},t.onerror=r=>{const s=vv(r.target.error);n(s)}})}let bE=!1;function vv(t){const e=sr.v(We());if(e>=12.2&&e<13){const n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){const r=new S("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${n}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return bE||(bE=!0,setTimeout(()=>{throw r},0)),r}}return t}class M2{constructor(e,n){this.asyncQueue=e,this.X=n,this.task=null}start(){}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}Z(e){R("IndexBackiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{R("IndexBackiller",`Documents written: ${await this.X.tt()}`)}catch(n){ui(n)?R("IndexBackiller","Ignoring IndexedDB error during index backfill: ",n):await li(n)}await this.Z(1)})}}class L2{constructor(e,n){this.localStore=e,this.persistence=n}async tt(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",n=>this.et(n,e))}et(e,n){const r=new Set;let s=n,i=!0;return v.doWhile(()=>i===!0&&s>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(o!==null&&!r.has(o))return R("IndexBackiller",`Processing collection: ${o}`),this.nt(e,o,s).next(a=>{s-=a,r.add(o)});i=!1})).next(()=>n-s)}nt(e,n,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,n).next(s=>this.localStore.localDocuments.getNextDocuments(e,n,s,r).next(i=>{const o=i.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this.st(s,i)).next(a=>(R("IndexBackiller",`Updating offset: ${a}`),this.localStore.indexManager.updateCollectionGroup(e,n,a))).next(()=>o.size)}))}st(e,n){let r=e;return n.changes.forEach((s,i)=>{const o=nN(i);yv(o,r)>0&&(r=o)}),new Mn(r.readTime,r.documentKey,Math.max(n.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vn{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.it(r),this.rt=r=>n.writeSequenceNumber(r))}it(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.rt&&this.rt(e),e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function IE(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function ko(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function iN(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */vn.ot=-1;class rt{constructor(e,n){this.comparator=e,this.root=n||$t.EMPTY}insert(e,n){return new rt(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,$t.BLACK,null,null))}remove(e){return new rt(this.comparator,this.root.remove(e,this.comparator).copy(null,null,$t.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(e,r.key);if(s===0)return n+r.left.size;s<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new sh(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new sh(this.root,e,this.comparator,!1)}getReverseIterator(){return new sh(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new sh(this.root,e,this.comparator,!0)}}class sh{constructor(e,n,r,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=n?r(e.key,n):1,n&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class $t{constructor(e,n,r,s,i){this.key=e,this.value=n,this.color=r!=null?r:$t.RED,this.left=s!=null?s:$t.EMPTY,this.right=i!=null?i:$t.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,s,i){return new $t(e!=null?e:this.key,n!=null?n:this.value,r!=null?r:this.color,s!=null?s:this.left,i!=null?i:this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let s=this;const i=r(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,n,r),null):i===0?s.copy(null,n,null,null,null):s.copy(null,null,null,null,s.right.insert(e,n,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return $t.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,s=this;if(n(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,n),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),n(e,s.key)===0){if(s.right.isEmpty())return $t.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,n))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,$t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,$t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw W();const e=this.left.check();if(e!==this.right.check())throw W();return e+(this.isRed()?0:1)}}$t.EMPTY=null,$t.RED=!0,$t.BLACK=!1;$t.EMPTY=new class{constructor(){this.size=0}get key(){throw W()}get value(){throw W()}get color(){throw W()}get left(){throw W()}get right(){throw W()}copy(t,e,n,r,s){return this}insert(t,e,n){return new $t(t,e)}remove(t,e){return this}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ae{constructor(e){this.comparator=e,this.data=new rt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,e[1])>=0)return;n(s.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new EE(this.data.getIterator())}getIteratorFrom(e){return new EE(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof Ae)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new Ae(this.comparator);return n.data=e,n}}class EE{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function Uo(t){return t.hasNext()?t.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pn{constructor(e){this.fields=e,e.sort(ot.comparator)}static empty(){return new Pn([])}unionWith(e){let n=new Ae(ot.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new Pn(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return Aa(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function F2(){return typeof atob!="undefined"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _t{constructor(e){this.binaryString=e}static fromBase64String(e){const n=atob(e);return new _t(n)}static fromUint8Array(e){const n=function(r){let s="";for(let i=0;i<r.length;++i)s+=String.fromCharCode(r[i]);return s}(e);return new _t(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return e=this.binaryString,btoa(e);var e}toUint8Array(){return function(e){const n=new Uint8Array(e.length);for(let r=0;r<e.length;r++)n[r]=e.charCodeAt(r);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return ce(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}_t.EMPTY_BYTE_STRING=new _t("");const U2=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Zs(t){if(se(!!t),typeof t=="string"){let e=0;const n=U2.exec(t);if(se(!!n),n[1]){let s=n[1];s=(s+"000000000").substr(0,9),e=Number(s)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:et(t.seconds),nanos:et(t.nanos)}}function et(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function oo(t){return typeof t=="string"?_t.fromBase64String(t):_t.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wv(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="server_timestamp"}function oN(t){const e=t.mapValue.fields.__previous_value__;return wv(e)?oN(e):e}function jl(t){const e=Zs(t.mapValue.fields.__local_write_time__.timestampValue);return new ze(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $2{constructor(e,n,r,s,i,o,a,c){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=s,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.useFetchStreams=c}}class as{constructor(e,n){this.projectId=e,this.database=n||"(default)"}static empty(){return new as("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof as&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pu(t){return t==null}function Kl(t){return t===0&&1/t==-1/0}function aN(t){return typeof t=="number"&&Number.isInteger(t)&&!Kl(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xs={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},Th={nullValue:"NULL_VALUE"};function ao(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?wv(t)?4:cN(t)?9007199254740991:10:W()}function Fr(t,e){if(t===e)return!0;const n=ao(t);if(n!==ao(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return jl(t).isEqual(jl(e));case 3:return function(r,s){if(typeof r.timestampValue=="string"&&typeof s.timestampValue=="string"&&r.timestampValue.length===s.timestampValue.length)return r.timestampValue===s.timestampValue;const i=Zs(r.timestampValue),o=Zs(s.timestampValue);return i.seconds===o.seconds&&i.nanos===o.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(r,s){return oo(r.bytesValue).isEqual(oo(s.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(r,s){return et(r.geoPointValue.latitude)===et(s.geoPointValue.latitude)&&et(r.geoPointValue.longitude)===et(s.geoPointValue.longitude)}(t,e);case 2:return function(r,s){if("integerValue"in r&&"integerValue"in s)return et(r.integerValue)===et(s.integerValue);if("doubleValue"in r&&"doubleValue"in s){const i=et(r.doubleValue),o=et(s.doubleValue);return i===o?Kl(i)===Kl(o):isNaN(i)&&isNaN(o)}return!1}(t,e);case 9:return Aa(t.arrayValue.values||[],e.arrayValue.values||[],Fr);case 10:return function(r,s){const i=r.mapValue.fields||{},o=s.mapValue.fields||{};if(IE(i)!==IE(o))return!1;for(const a in i)if(i.hasOwnProperty(a)&&(o[a]===void 0||!Fr(i[a],o[a])))return!1;return!0}(t,e);default:return W()}}function Wl(t,e){return(t.values||[]).find(n=>Fr(n,e))!==void 0}function ei(t,e){if(t===e)return 0;const n=ao(t),r=ao(e);if(n!==r)return ce(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return ce(t.booleanValue,e.booleanValue);case 2:return function(s,i){const o=et(s.integerValue||s.doubleValue),a=et(i.integerValue||i.doubleValue);return o<a?-1:o>a?1:o===a?0:isNaN(o)?isNaN(a)?0:-1:1}(t,e);case 3:return TE(t.timestampValue,e.timestampValue);case 4:return TE(jl(t),jl(e));case 5:return ce(t.stringValue,e.stringValue);case 6:return function(s,i){const o=oo(s),a=oo(i);return o.compareTo(a)}(t.bytesValue,e.bytesValue);case 7:return function(s,i){const o=s.split("/"),a=i.split("/");for(let c=0;c<o.length&&c<a.length;c++){const l=ce(o[c],a[c]);if(l!==0)return l}return ce(o.length,a.length)}(t.referenceValue,e.referenceValue);case 8:return function(s,i){const o=ce(et(s.latitude),et(i.latitude));return o!==0?o:ce(et(s.longitude),et(i.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(s,i){const o=s.values||[],a=i.values||[];for(let c=0;c<o.length&&c<a.length;++c){const l=ei(o[c],a[c]);if(l)return l}return ce(o.length,a.length)}(t.arrayValue,e.arrayValue);case 10:return function(s,i){if(s===xs.mapValue&&i===xs.mapValue)return 0;if(s===xs.mapValue)return 1;if(i===xs.mapValue)return-1;const o=s.fields||{},a=Object.keys(o),c=i.fields||{},l=Object.keys(c);a.sort(),l.sort();for(let u=0;u<a.length&&u<l.length;++u){const h=ce(a[u],l[u]);if(h!==0)return h;const d=ei(o[a[u]],c[l[u]]);if(d!==0)return d}return ce(a.length,l.length)}(t.mapValue,e.mapValue);default:throw W()}}function TE(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return ce(t,e);const n=Zs(t),r=Zs(e),s=ce(n.seconds,r.seconds);return s!==0?s:ce(n.nanos,r.nanos)}function oa(t){return Vm(t)}function Vm(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(r){const s=Zs(r);return`time(${s.seconds},${s.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?oo(t.bytesValue).toBase64():"referenceValue"in t?(n=t.referenceValue,F.fromName(n).toString()):"geoPointValue"in t?`geo(${(e=t.geoPointValue).latitude},${e.longitude})`:"arrayValue"in t?function(r){let s="[",i=!0;for(const o of r.values||[])i?i=!1:s+=",",s+=Vm(o);return s+"]"}(t.arrayValue):"mapValue"in t?function(r){const s=Object.keys(r.fields||{}).sort();let i="{",o=!0;for(const a of s)o?o=!1:i+=",",i+=`${a}:${Vm(r.fields[a])}`;return i+"}"}(t.mapValue):W();var e,n}function co(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function Bm(t){return!!t&&"integerValue"in t}function Hl(t){return!!t&&"arrayValue"in t}function SE(t){return!!t&&"nullValue"in t}function CE(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Sh(t){return!!t&&"mapValue"in t}function Yc(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return ko(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=Yc(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=Yc(t.arrayValue.values[n]);return e}return Object.assign({},t)}function cN(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}function V2(t){return"nullValue"in t?Th:"booleanValue"in t?{booleanValue:!1}:"integerValue"in t||"doubleValue"in t?{doubleValue:NaN}:"timestampValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in t?{stringValue:""}:"bytesValue"in t?{bytesValue:""}:"referenceValue"in t?co(as.empty(),F.empty()):"geoPointValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in t?{arrayValue:{}}:"mapValue"in t?{mapValue:{}}:W()}function B2(t){return"nullValue"in t?{booleanValue:!1}:"booleanValue"in t?{doubleValue:NaN}:"integerValue"in t||"doubleValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in t?{stringValue:""}:"stringValue"in t?{bytesValue:""}:"bytesValue"in t?co(as.empty(),F.empty()):"referenceValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in t?{arrayValue:{}}:"arrayValue"in t?{mapValue:{}}:"mapValue"in t?xs:W()}function AE(t,e){const n=ei(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?-1:!t.inclusive&&e.inclusive?1:0}function kE(t,e){const n=ei(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?1:!t.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vt{constructor(e){this.value=e}static empty(){return new Vt({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!Sh(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=Yc(n)}setAll(e){let n=ot.emptyPath(),r={},s=[];e.forEach((o,a)=>{if(!n.isImmediateParentOf(a)){const c=this.getFieldsMap(n);this.applyChanges(c,r,s),r={},s=[],n=a.popLast()}o?r[a.lastSegment()]=Yc(o):s.push(a.lastSegment())});const i=this.getFieldsMap(n);this.applyChanges(i,r,s)}delete(e){const n=this.field(e.popLast());Sh(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return Fr(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let s=n.mapValue.fields[e.get(r)];Sh(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=s),n=s}return n.mapValue.fields}applyChanges(e,n,r){ko(n,(s,i)=>e[s]=i);for(const s of r)delete e[s]}clone(){return new Vt(Yc(this.value))}}function lN(t){const e=[];return ko(t.fields,(n,r)=>{const s=new ot([n]);if(Sh(r)){const i=lN(r.mapValue).fields;if(i.length===0)e.push(s);else for(const o of i)e.push(s.child(o))}else e.push(s)}),new Pn(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Be{constructor(e,n,r,s,i,o){this.key=e,this.documentType=n,this.version=r,this.readTime=s,this.data=i,this.documentState=o}static newInvalidDocument(e){return new Be(e,0,re.min(),re.min(),Vt.empty(),0)}static newFoundDocument(e,n,r){return new Be(e,1,n,re.min(),r,0)}static newNoDocument(e,n){return new Be(e,2,n,re.min(),Vt.empty(),0)}static newUnknownDocument(e,n){return new Be(e,3,n,re.min(),Vt.empty(),2)}convertToFoundDocument(e,n){return this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Vt.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Vt.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=re.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Be&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Be(this.key,this.documentType,this.version,this.readTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q2{constructor(e,n=null,r=[],s=[],i=null,o=null,a=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=s,this.limit=i,this.startAt=o,this.endAt=a,this.ut=null}}function RE(t,e=null,n=[],r=[],s=null,i=null,o=null){return new q2(t,e,n,r,s,i,o)}function lo(t){const e=B(t);if(e.ut===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>{return(s=r).field.canonicalString()+s.op.toString()+oa(s.value);var s}).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(s){return s.field.canonicalString()+s.dir}(r)).join(","),Pu(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>oa(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>oa(r)).join(",")),e.ut=n}return e.ut}function j2(t){let e=t.path.canonicalString();return t.collectionGroup!==null&&(e+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(e+=`, filters: [${t.filters.map(n=>{return`${(r=n).field.canonicalString()} ${r.op} ${oa(r.value)}`;var r}).join(", ")}]`),Pu(t.limit)||(e+=", limit: "+t.limit),t.orderBy.length>0&&(e+=`, orderBy: [${t.orderBy.map(n=>function(r){return`${r.field.canonicalString()} (${r.dir})`}(n)).join(", ")}]`),t.startAt&&(e+=", startAt: ",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map(n=>oa(n)).join(",")),t.endAt&&(e+=", endAt: ",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map(n=>oa(n)).join(",")),`Target(${e})`}function Du(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let s=0;s<t.orderBy.length;s++)if(!J2(t.orderBy[s],e.orderBy[s]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let s=0;s<t.filters.length;s++)if(n=t.filters[s],r=e.filters[s],n.op!==r.op||!n.field.isEqual(r.field)||!Fr(n.value,r.value))return!1;var n,r;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!xE(t.startAt,e.startAt)&&xE(t.endAt,e.endAt)}function bd(t){return F.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}function Id(t,e){return t.filters.filter(n=>n instanceof Bt&&n.field.isEqual(e))}function NE(t,e,n){let r=Th,s=!0;for(const i of Id(t,e)){let o=Th,a=!0;switch(i.op){case"<":case"<=":o=V2(i.value);break;case"==":case"in":case">=":o=i.value;break;case">":o=i.value,a=!1;break;case"!=":case"not-in":o=Th}AE({value:r,inclusive:s},{value:o,inclusive:a})<0&&(r=o,s=a)}if(n!==null){for(let i=0;i<t.orderBy.length;++i)if(t.orderBy[i].field.isEqual(e)){const o=n.position[i];AE({value:r,inclusive:s},{value:o,inclusive:n.inclusive})<0&&(r=o,s=n.inclusive);break}}return{value:r,inclusive:s}}function PE(t,e,n){let r=xs,s=!0;for(const i of Id(t,e)){let o=xs,a=!0;switch(i.op){case">=":case">":o=B2(i.value),a=!1;break;case"==":case"in":case"<=":o=i.value;break;case"<":o=i.value,a=!1;break;case"!=":case"not-in":o=xs}kE({value:r,inclusive:s},{value:o,inclusive:a})>0&&(r=o,s=a)}if(n!==null){for(let i=0;i<t.orderBy.length;++i)if(t.orderBy[i].field.isEqual(e)){const o=n.position[i];kE({value:r,inclusive:s},{value:o,inclusive:n.inclusive})>0&&(r=o,s=n.inclusive);break}}return{value:r,inclusive:s}}class Bt extends class{}{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.ct(e,n,r):new K2(e,n,r):n==="array-contains"?new G2(e,r):n==="in"?new z2(e,r):n==="not-in"?new Q2(e,r):n==="array-contains-any"?new Y2(e,r):new Bt(e,n,r)}static ct(e,n,r){return n==="in"?new W2(e,r):new H2(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&this.at(ei(n,this.value)):n!==null&&ao(this.value)===ao(n)&&this.at(ei(n,this.value))}at(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return W()}}ht(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}}class K2 extends Bt{constructor(e,n,r){super(e,n,r),this.key=F.fromName(r.referenceValue)}matches(e){const n=F.comparator(e.key,this.key);return this.at(n)}}class W2 extends Bt{constructor(e,n){super(e,"in",n),this.keys=uN("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class H2 extends Bt{constructor(e,n){super(e,"not-in",n),this.keys=uN("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function uN(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(r=>F.fromName(r.referenceValue))}class G2 extends Bt{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return Hl(n)&&Wl(n.arrayValue,this.value)}}class z2 extends Bt{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&Wl(this.value.arrayValue,n)}}class Q2 extends Bt{constructor(e,n){super(e,"not-in",n)}matches(e){if(Wl(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&!Wl(this.value.arrayValue,n)}}class Y2 extends Bt{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!Hl(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>Wl(this.value.arrayValue,r))}}class ti{constructor(e,n){this.position=e,this.inclusive=n}}class aa{constructor(e,n="asc"){this.field=e,this.dir=n}}function J2(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}function DE(t,e,n){let r=0;for(let s=0;s<t.position.length;s++){const i=e[s],o=t.position[s];if(i.field.isKeyField()?r=F.comparator(F.fromName(o.referenceValue),n.key):r=ei(o,n.data.field(i.field)),i.dir==="desc"&&(r*=-1),r!==0)break}return r}function xE(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!Fr(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ds{constructor(e,n=null,r=[],s=[],i=null,o="F",a=null,c=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=s,this.limit=i,this.limitType=o,this.startAt=a,this.endAt=c,this.lt=null,this.ft=null,this.startAt,this.endAt}}function hN(t,e,n,r,s,i,o,a){return new ds(t,e,n,r,s,i,o,a)}function ec(t){return new ds(t)}function X2(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function bv(t){return t.explicitOrderBy.length>0?t.explicitOrderBy[0].field:null}function Iv(t){for(const e of t.filters)if(e.ht())return e.field;return null}function Ev(t){return t.collectionGroup!==null}function ka(t){const e=B(t);if(e.lt===null){e.lt=[];const n=Iv(e),r=bv(e);if(n!==null&&r===null)n.isKeyField()||e.lt.push(new aa(n)),e.lt.push(new aa(ot.keyField(),"asc"));else{let s=!1;for(const i of e.explicitOrderBy)e.lt.push(i),i.field.isKeyField()&&(s=!0);if(!s){const i=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";e.lt.push(new aa(ot.keyField(),i))}}}return e.lt}function Qn(t){const e=B(t);if(!e.ft)if(e.limitType==="F")e.ft=RE(e.path,e.collectionGroup,ka(e),e.filters,e.limit,e.startAt,e.endAt);else{const n=[];for(const i of ka(e)){const o=i.dir==="desc"?"asc":"desc";n.push(new aa(i.field,o))}const r=e.endAt?new ti(e.endAt.position,e.endAt.inclusive):null,s=e.startAt?new ti(e.startAt.position,e.startAt.inclusive):null;e.ft=RE(e.path,e.collectionGroup,n,e.filters,e.limit,r,s)}return e.ft}function dN(t,e,n){return new ds(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function xu(t,e){return Du(Qn(t),Qn(e))&&t.limitType===e.limitType}function fN(t){return`${lo(Qn(t))}|lt:${t.limitType}`}function qm(t){return`Query(target=${j2(Qn(t))}; limitType=${t.limitType})`}function Tv(t,e){return e.isFoundDocument()&&function(n,r){const s=r.key.path;return n.collectionGroup!==null?r.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(s):F.isDocumentKey(n.path)?n.path.isEqual(s):n.path.isImmediateParentOf(s)}(t,e)&&function(n,r){for(const s of n.explicitOrderBy)if(!s.field.isKeyField()&&r.data.field(s.field)===null)return!1;return!0}(t,e)&&function(n,r){for(const s of n.filters)if(!s.matches(r))return!1;return!0}(t,e)&&function(n,r){return!(n.startAt&&!function(s,i,o){const a=DE(s,i,o);return s.inclusive?a<=0:a<0}(n.startAt,ka(n),r)||n.endAt&&!function(s,i,o){const a=DE(s,i,o);return s.inclusive?a>=0:a>0}(n.endAt,ka(n),r))}(t,e)}function pN(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function gN(t){return(e,n)=>{let r=!1;for(const s of ka(t)){const i=Z2(s,e,n);if(i!==0)return i;r=r||s.field.isKeyField()}return 0}}function Z2(t,e,n){const r=t.field.isKeyField()?F.comparator(e.key,n.key):function(s,i,o){const a=i.data.field(s),c=o.data.field(s);return a!==null&&c!==null?ei(a,c):W()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return W()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mN(t,e){if(t.dt){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Kl(e)?"-0":e}}function _N(t){return{integerValue:""+t}}function yN(t,e){return aN(e)?_N(e):mN(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xf{constructor(){this._=void 0}}function e4(t,e,n){return t instanceof Ra?function(r,s){const i={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:r.seconds,nanos:r.nanoseconds}}}};return s&&(i.fields.__previous_value__=s),{mapValue:i}}(n,e):t instanceof uo?wN(t,e):t instanceof ho?bN(t,e):function(r,s){const i=vN(r,s),o=OE(i)+OE(r._t);return Bm(i)&&Bm(r._t)?_N(o):mN(r.wt,o)}(t,e)}function t4(t,e,n){return t instanceof uo?wN(t,e):t instanceof ho?bN(t,e):n}function vN(t,e){return t instanceof Na?Bm(n=e)||function(r){return!!r&&"doubleValue"in r}(n)?e:{integerValue:0}:null;var n}class Ra extends Xf{}class uo extends Xf{constructor(e){super(),this.elements=e}}function wN(t,e){const n=IN(e);for(const r of t.elements)n.some(s=>Fr(s,r))||n.push(r);return{arrayValue:{values:n}}}class ho extends Xf{constructor(e){super(),this.elements=e}}function bN(t,e){let n=IN(e);for(const r of t.elements)n=n.filter(s=>!Fr(s,r));return{arrayValue:{values:n}}}class Na extends Xf{constructor(e,n){super(),this.wt=e,this._t=n}}function OE(t){return et(t.integerValue||t.doubleValue)}function IN(t){return Hl(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ou{constructor(e,n){this.field=e,this.transform=n}}function n4(t,e){return t.field.isEqual(e.field)&&function(n,r){return n instanceof uo&&r instanceof uo||n instanceof ho&&r instanceof ho?Aa(n.elements,r.elements,Fr):n instanceof Na&&r instanceof Na?Fr(n._t,r._t):n instanceof Ra&&r instanceof Ra}(t.transform,e.transform)}class r4{constructor(e,n){this.version=e,this.transformResults=n}}class Ye{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new Ye}static exists(e){return new Ye(void 0,e)}static updateTime(e){return new Ye(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Ch(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class Zf{}function EN(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new nc(t.key,Ye.none()):new tc(t.key,t.data,Ye.none());{const n=t.data,r=Vt.empty();let s=new Ae(ot.comparator);for(let i of e.fields)if(!s.has(i)){let o=n.field(i);o===null&&i.length>1&&(i=i.popLast(),o=n.field(i)),o===null?r.delete(i):r.set(i,o),s=s.add(i)}return new fs(t.key,r,new Pn(s.toArray()),Ye.none())}}function s4(t,e,n){t instanceof tc?function(r,s,i){const o=r.value.clone(),a=LE(r.fieldTransforms,s,i.transformResults);o.setAll(a),s.convertToFoundDocument(i.version,o).setHasCommittedMutations()}(t,e,n):t instanceof fs?function(r,s,i){if(!Ch(r.precondition,s))return void s.convertToUnknownDocument(i.version);const o=LE(r.fieldTransforms,s,i.transformResults),a=s.data;a.setAll(TN(r)),a.setAll(o),s.convertToFoundDocument(i.version,a).setHasCommittedMutations()}(t,e,n):function(r,s,i){s.convertToNoDocument(i.version).setHasCommittedMutations()}(0,e,n)}function Jc(t,e,n,r){return t instanceof tc?function(s,i,o,a){if(!Ch(s.precondition,i))return o;const c=s.value.clone(),l=FE(s.fieldTransforms,a,i);return c.setAll(l),i.convertToFoundDocument(i.version,c).setHasLocalMutations(),null}(t,e,n,r):t instanceof fs?function(s,i,o,a){if(!Ch(s.precondition,i))return o;const c=FE(s.fieldTransforms,a,i),l=i.data;return l.setAll(TN(s)),l.setAll(c),i.convertToFoundDocument(i.version,l).setHasLocalMutations(),o===null?null:o.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(u=>u.field))}(t,e,n,r):function(s,i,o){return Ch(s.precondition,i)?(i.convertToNoDocument(i.version).setHasLocalMutations(),null):o}(t,e,n)}function i4(t,e){let n=null;for(const r of t.fieldTransforms){const s=e.data.field(r.field),i=vN(r.transform,s||null);i!=null&&(n===null&&(n=Vt.empty()),n.set(r.field,i))}return n||null}function ME(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(n,r){return n===void 0&&r===void 0||!(!n||!r)&&Aa(n,r,(s,i)=>n4(s,i))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class tc extends Zf{constructor(e,n,r,s=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class fs extends Zf{constructor(e,n,r,s,i=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function TN(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function LE(t,e,n){const r=new Map;se(t.length===n.length);for(let s=0;s<n.length;s++){const i=t[s],o=i.transform,a=e.data.field(i.field);r.set(i.field,t4(o,a,n[s]))}return r}function FE(t,e,n){const r=new Map;for(const s of t){const i=s.transform,o=n.data.field(s.field);r.set(s.field,e4(i,o,e))}return r}class nc extends Zf{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Sv extends Zf{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class o4{constructor(e){this.count=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ht,ye;function SN(t){switch(t){default:return W();case w.CANCELLED:case w.UNKNOWN:case w.DEADLINE_EXCEEDED:case w.RESOURCE_EXHAUSTED:case w.INTERNAL:case w.UNAVAILABLE:case w.UNAUTHENTICATED:return!1;case w.INVALID_ARGUMENT:case w.NOT_FOUND:case w.ALREADY_EXISTS:case w.PERMISSION_DENIED:case w.FAILED_PRECONDITION:case w.ABORTED:case w.OUT_OF_RANGE:case w.UNIMPLEMENTED:case w.DATA_LOSS:return!0}}function CN(t){if(t===void 0)return dt("GRPC error has no .code"),w.UNKNOWN;switch(t){case ht.OK:return w.OK;case ht.CANCELLED:return w.CANCELLED;case ht.UNKNOWN:return w.UNKNOWN;case ht.DEADLINE_EXCEEDED:return w.DEADLINE_EXCEEDED;case ht.RESOURCE_EXHAUSTED:return w.RESOURCE_EXHAUSTED;case ht.INTERNAL:return w.INTERNAL;case ht.UNAVAILABLE:return w.UNAVAILABLE;case ht.UNAUTHENTICATED:return w.UNAUTHENTICATED;case ht.INVALID_ARGUMENT:return w.INVALID_ARGUMENT;case ht.NOT_FOUND:return w.NOT_FOUND;case ht.ALREADY_EXISTS:return w.ALREADY_EXISTS;case ht.PERMISSION_DENIED:return w.PERMISSION_DENIED;case ht.FAILED_PRECONDITION:return w.FAILED_PRECONDITION;case ht.ABORTED:return w.ABORTED;case ht.OUT_OF_RANGE:return w.OUT_OF_RANGE;case ht.UNIMPLEMENTED:return w.UNIMPLEMENTED;case ht.DATA_LOSS:return w.DATA_LOSS;default:return W()}}(ye=ht||(ht={}))[ye.OK=0]="OK",ye[ye.CANCELLED=1]="CANCELLED",ye[ye.UNKNOWN=2]="UNKNOWN",ye[ye.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",ye[ye.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",ye[ye.NOT_FOUND=5]="NOT_FOUND",ye[ye.ALREADY_EXISTS=6]="ALREADY_EXISTS",ye[ye.PERMISSION_DENIED=7]="PERMISSION_DENIED",ye[ye.UNAUTHENTICATED=16]="UNAUTHENTICATED",ye[ye.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",ye[ye.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",ye[ye.ABORTED=10]="ABORTED",ye[ye.OUT_OF_RANGE=11]="OUT_OF_RANGE",ye[ye.UNIMPLEMENTED=12]="UNIMPLEMENTED",ye[ye.INTERNAL=13]="INTERNAL",ye[ye.UNAVAILABLE=14]="UNAVAILABLE",ye[ye.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hi{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[s,i]of r)if(this.equalsFn(s,e))return i}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),s=this.inner[r];if(s===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,n]);s.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return r.length===1?delete this.inner[n]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(e){ko(this.inner,(n,r)=>{for(const[s,i]of r)e(s,i)})}isEmpty(){return iN(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const a4=new rt(F.comparator);function wn(){return a4}const AN=new rt(F.comparator);function Pc(...t){let e=AN;for(const n of t)e=e.insert(n.key,n);return e}function kN(t){let e=AN;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function Tr(){return Xc()}function RN(){return Xc()}function Xc(){return new hi(t=>t.toString(),(t,e)=>t.isEqual(e))}const c4=new rt(F.comparator),l4=new Ae(F.comparator);function ue(...t){let e=l4;for(const n of t)e=e.add(n);return e}const u4=new Ae(ce);function ep(){return u4}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mu{constructor(e,n,r,s,i){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,n){const r=new Map;return r.set(e,Lu.createSynthesizedTargetChangeForCurrentChange(e,n)),new Mu(re.min(),r,ep(),wn(),ue())}}class Lu{constructor(e,n,r,s,i){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,n){return new Lu(_t.EMPTY_BYTE_STRING,n,ue(),ue(),ue())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ah{constructor(e,n,r,s){this.gt=e,this.removedTargetIds=n,this.key=r,this.yt=s}}class NN{constructor(e,n){this.targetId=e,this.It=n}}class PN{constructor(e,n,r=_t.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=s}}class UE{constructor(){this.Tt=0,this.Et=VE(),this.At=_t.EMPTY_BYTE_STRING,this.Rt=!1,this.bt=!0}get current(){return this.Rt}get resumeToken(){return this.At}get Pt(){return this.Tt!==0}get vt(){return this.bt}Vt(e){e.approximateByteSize()>0&&(this.bt=!0,this.At=e)}St(){let e=ue(),n=ue(),r=ue();return this.Et.forEach((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:n=n.add(s);break;case 1:r=r.add(s);break;default:W()}}),new Lu(this.At,this.Rt,e,n,r)}Dt(){this.bt=!1,this.Et=VE()}Ct(e,n){this.bt=!0,this.Et=this.Et.insert(e,n)}xt(e){this.bt=!0,this.Et=this.Et.remove(e)}Nt(){this.Tt+=1}kt(){this.Tt-=1}Ot(){this.bt=!0,this.Rt=!0}}class h4{constructor(e){this.Mt=e,this.Ft=new Map,this.$t=wn(),this.Bt=$E(),this.Lt=new Ae(ce)}Ut(e){for(const n of e.gt)e.yt&&e.yt.isFoundDocument()?this.qt(n,e.yt):this.Kt(n,e.key,e.yt);for(const n of e.removedTargetIds)this.Kt(n,e.key,e.yt)}Gt(e){this.forEachTarget(e,n=>{const r=this.Qt(n);switch(e.state){case 0:this.jt(n)&&r.Vt(e.resumeToken);break;case 1:r.kt(),r.Pt||r.Dt(),r.Vt(e.resumeToken);break;case 2:r.kt(),r.Pt||this.removeTarget(n);break;case 3:this.jt(n)&&(r.Ot(),r.Vt(e.resumeToken));break;case 4:this.jt(n)&&(this.Wt(n),r.Vt(e.resumeToken));break;default:W()}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.Ft.forEach((r,s)=>{this.jt(s)&&n(s)})}zt(e){const n=e.targetId,r=e.It.count,s=this.Ht(n);if(s){const i=s.target;if(bd(i))if(r===0){const o=new F(i.path);this.Kt(n,o,Be.newNoDocument(o,re.min()))}else se(r===1);else this.Jt(n)!==r&&(this.Wt(n),this.Lt=this.Lt.add(n))}}Yt(e){const n=new Map;this.Ft.forEach((i,o)=>{const a=this.Ht(o);if(a){if(i.current&&bd(a.target)){const c=new F(a.target.path);this.$t.get(c)!==null||this.Xt(o,c)||this.Kt(o,c,Be.newNoDocument(c,e))}i.vt&&(n.set(o,i.St()),i.Dt())}});let r=ue();this.Bt.forEach((i,o)=>{let a=!0;o.forEachWhile(c=>{const l=this.Ht(c);return!l||l.purpose===2||(a=!1,!1)}),a&&(r=r.add(i))}),this.$t.forEach((i,o)=>o.setReadTime(e));const s=new Mu(e,n,this.Lt,this.$t,r);return this.$t=wn(),this.Bt=$E(),this.Lt=new Ae(ce),s}qt(e,n){if(!this.jt(e))return;const r=this.Xt(e,n.key)?2:0;this.Qt(e).Ct(n.key,r),this.$t=this.$t.insert(n.key,n),this.Bt=this.Bt.insert(n.key,this.Zt(n.key).add(e))}Kt(e,n,r){if(!this.jt(e))return;const s=this.Qt(e);this.Xt(e,n)?s.Ct(n,1):s.xt(n),this.Bt=this.Bt.insert(n,this.Zt(n).delete(e)),r&&(this.$t=this.$t.insert(n,r))}removeTarget(e){this.Ft.delete(e)}Jt(e){const n=this.Qt(e).St();return this.Mt.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}Nt(e){this.Qt(e).Nt()}Qt(e){let n=this.Ft.get(e);return n||(n=new UE,this.Ft.set(e,n)),n}Zt(e){let n=this.Bt.get(e);return n||(n=new Ae(ce),this.Bt=this.Bt.insert(e,n)),n}jt(e){const n=this.Ht(e)!==null;return n||R("WatchChangeAggregator","Detected inactive target",e),n}Ht(e){const n=this.Ft.get(e);return n&&n.Pt?null:this.Mt.te(e)}Wt(e){this.Ft.set(e,new UE),this.Mt.getRemoteKeysForTarget(e).forEach(n=>{this.Kt(e,n,null)})}Xt(e,n){return this.Mt.getRemoteKeysForTarget(e).has(n)}}function $E(){return new rt(F.comparator)}function VE(){return new rt(F.comparator)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const d4=(()=>({asc:"ASCENDING",desc:"DESCENDING"}))(),f4=(()=>({"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"}))();class p4{constructor(e,n){this.databaseId=e,this.dt=n}}function Gl(t,e){return t.dt?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function DN(t,e){return t.dt?e.toBase64():e.toUint8Array()}function g4(t,e){return Gl(t,e.toTimestamp())}function kt(t){return se(!!t),re.fromTimestamp(function(e){const n=Zs(e);return new ze(n.seconds,n.nanos)}(t))}function Cv(t,e){return function(n){return new we(["projects",n.projectId,"databases",n.database])}(t).child("documents").child(e).canonicalString()}function xN(t){const e=we.fromString(t);return se(BN(e)),e}function zl(t,e){return Cv(t.databaseId,e.path)}function kr(t,e){const n=xN(e);if(n.get(1)!==t.databaseId.projectId)throw new S(w.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new S(w.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new F(MN(n))}function jm(t,e){return Cv(t.databaseId,e)}function ON(t){const e=xN(t);return e.length===4?we.emptyPath():MN(e)}function Ql(t){return new we(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function MN(t){return se(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function BE(t,e,n){return{name:zl(t,e),fields:n.value.mapValue.fields}}function LN(t,e,n){const r=kr(t,e.name),s=kt(e.updateTime),i=new Vt({mapValue:{fields:e.fields}}),o=Be.newFoundDocument(r,s,i);return n&&o.setHasCommittedMutations(),n?o.setHasCommittedMutations():o}function m4(t,e){return"found"in e?function(n,r){se(!!r.found),r.found.name,r.found.updateTime;const s=kr(n,r.found.name),i=kt(r.found.updateTime),o=new Vt({mapValue:{fields:r.found.fields}});return Be.newFoundDocument(s,i,o)}(t,e):"missing"in e?function(n,r){se(!!r.missing),se(!!r.readTime);const s=kr(n,r.missing),i=kt(r.readTime);return Be.newNoDocument(s,i)}(t,e):W()}function _4(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(c){return c==="NO_CHANGE"?0:c==="ADD"?1:c==="REMOVE"?2:c==="CURRENT"?3:c==="RESET"?4:W()}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=function(c,l){return c.dt?(se(l===void 0||typeof l=="string"),_t.fromBase64String(l||"")):(se(l===void 0||l instanceof Uint8Array),_t.fromUint8Array(l||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(c){const l=c.code===void 0?w.UNKNOWN:CN(c.code);return new S(l,c.message||"")}(o);n=new PN(r,s,i,a||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const s=kr(t,r.document.name),i=kt(r.document.updateTime),o=new Vt({mapValue:{fields:r.document.fields}}),a=Be.newFoundDocument(s,i,o),c=r.targetIds||[],l=r.removedTargetIds||[];n=new Ah(c,l,a.key,a)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const s=kr(t,r.document),i=r.readTime?kt(r.readTime):re.min(),o=Be.newNoDocument(s,i),a=r.removedTargetIds||[];n=new Ah([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const s=kr(t,r.document),i=r.removedTargetIds||[];n=new Ah([],i,s,null)}else{if(!("filter"in e))return W();{e.filter;const r=e.filter;r.targetId;const s=r.count||0,i=new o4(s),o=r.targetId;n=new NN(o,i)}}return n}function Yl(t,e){let n;if(e instanceof tc)n={update:BE(t,e.key,e.value)};else if(e instanceof nc)n={delete:zl(t,e.key)};else if(e instanceof fs)n={update:BE(t,e.key,e.data),updateMask:T4(e.fieldMask)};else{if(!(e instanceof Sv))return W();n={verify:zl(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(s,i){const o=i.transform;if(o instanceof Ra)return{fieldPath:i.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(o instanceof uo)return{fieldPath:i.field.canonicalString(),appendMissingElements:{values:o.elements}};if(o instanceof ho)return{fieldPath:i.field.canonicalString(),removeAllFromArray:{values:o.elements}};if(o instanceof Na)return{fieldPath:i.field.canonicalString(),increment:o._t};throw W()}(0,r))),e.precondition.isNone||(n.currentDocument=function(r,s){return s.updateTime!==void 0?{updateTime:g4(r,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:W()}(t,e.precondition)),n}function Km(t,e){const n=e.currentDocument?function(s){return s.updateTime!==void 0?Ye.updateTime(kt(s.updateTime)):s.exists!==void 0?Ye.exists(s.exists):Ye.none()}(e.currentDocument):Ye.none(),r=e.updateTransforms?e.updateTransforms.map(s=>function(i,o){let a=null;if("setToServerValue"in o)se(o.setToServerValue==="REQUEST_TIME"),a=new Ra;else if("appendMissingElements"in o){const l=o.appendMissingElements.values||[];a=new uo(l)}else if("removeAllFromArray"in o){const l=o.removeAllFromArray.values||[];a=new ho(l)}else"increment"in o?a=new Na(i,o.increment):W();const c=ot.fromServerFormat(o.fieldPath);return new Ou(c,a)}(t,s)):[];if(e.update){e.update.name;const s=kr(t,e.update.name),i=new Vt({mapValue:{fields:e.update.fields}});if(e.updateMask){const o=function(a){const c=a.fieldPaths||[];return new Pn(c.map(l=>ot.fromServerFormat(l)))}(e.updateMask);return new fs(s,i,o,n,r)}return new tc(s,i,n,r)}if(e.delete){const s=kr(t,e.delete);return new nc(s,n)}if(e.verify){const s=kr(t,e.verify);return new Sv(s,n)}return W()}function y4(t,e){return t&&t.length>0?(se(e!==void 0),t.map(n=>function(r,s){let i=r.updateTime?kt(r.updateTime):kt(s);return i.isEqual(re.min())&&(i=kt(s)),new r4(i,r.transformResults||[])}(n,e))):[]}function FN(t,e){return{documents:[jm(t,e.path)]}}function UN(t,e){const n={structuredQuery:{}},r=e.path;e.collectionGroup!==null?(n.parent=jm(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=jm(t,r.popLast()),n.structuredQuery.from=[{collectionId:r.lastSegment()}]);const s=function(c){if(c.length===0)return;const l=c.map(u=>function(h){if(h.op==="=="){if(CE(h.value))return{unaryFilter:{field:$o(h.field),op:"IS_NAN"}};if(SE(h.value))return{unaryFilter:{field:$o(h.field),op:"IS_NULL"}}}else if(h.op==="!="){if(CE(h.value))return{unaryFilter:{field:$o(h.field),op:"IS_NOT_NAN"}};if(SE(h.value))return{unaryFilter:{field:$o(h.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:$o(h.field),op:b4(h.op),value:h.value}}}(u));return l.length===1?l[0]:{compositeFilter:{op:"AND",filters:l}}}(e.filters);s&&(n.structuredQuery.where=s);const i=function(c){if(c.length!==0)return c.map(l=>function(u){return{field:$o(u.field),direction:w4(u.dir)}}(l))}(e.orderBy);i&&(n.structuredQuery.orderBy=i);const o=function(c,l){return c.dt||Pu(l)?l:{value:l}}(t,e.limit);var a;return o!==null&&(n.structuredQuery.limit=o),e.startAt&&(n.structuredQuery.startAt={before:(a=e.startAt).inclusive,values:a.position}),e.endAt&&(n.structuredQuery.endAt=function(c){return{before:!c.inclusive,values:c.position}}(e.endAt)),n}function $N(t){let e=ON(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let s=null;if(r>0){se(r===1);const u=n.from[0];u.allDescendants?s=u.collectionId:e=e.child(u.collectionId)}let i=[];n.where&&(i=VN(n.where));let o=[];n.orderBy&&(o=n.orderBy.map(u=>function(h){return new aa(Yo(h.field),function(d){switch(d){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(h.direction))}(u)));let a=null;n.limit&&(a=function(u){let h;return h=typeof u=="object"?u.value:u,Pu(h)?null:h}(n.limit));let c=null;n.startAt&&(c=function(u){const h=!!u.before,d=u.values||[];return new ti(d,h)}(n.startAt));let l=null;return n.endAt&&(l=function(u){const h=!u.before,d=u.values||[];return new ti(d,h)}(n.endAt)),hN(e,s,o,i,a,"F",c,l)}function v4(t,e){const n=function(r,s){switch(s){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return W()}}(0,e.purpose);return n==null?null:{"goog-listen-tags":n}}function VN(t){return t?t.unaryFilter!==void 0?[E4(t)]:t.fieldFilter!==void 0?[I4(t)]:t.compositeFilter!==void 0?t.compositeFilter.filters.map(e=>VN(e)).reduce((e,n)=>e.concat(n)):W():[]}function w4(t){return d4[t]}function b4(t){return f4[t]}function $o(t){return{fieldPath:t.canonicalString()}}function Yo(t){return ot.fromServerFormat(t.fieldPath)}function I4(t){return Bt.create(Yo(t.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return W()}}(t.fieldFilter.op),t.fieldFilter.value)}function E4(t){switch(t.unaryFilter.op){case"IS_NAN":const e=Yo(t.unaryFilter.field);return Bt.create(e,"==",{doubleValue:NaN});case"IS_NULL":const n=Yo(t.unaryFilter.field);return Bt.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const r=Yo(t.unaryFilter.field);return Bt.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const s=Yo(t.unaryFilter.field);return Bt.create(s,"!=",{nullValue:"NULL_VALUE"});default:return W()}}function T4(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function BN(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hn(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=qE(e)),e=S4(t.get(n),e);return qE(e)}function S4(t,e){let n=e;const r=t.length;for(let s=0;s<r;s++){const i=t.charAt(s);switch(i){case"\0":n+="";break;case"":n+="";break;default:n+=i}}return n}function qE(t){return t+""}function Sr(t){const e=t.length;if(se(e>=2),e===2)return se(t.charAt(0)===""&&t.charAt(1)===""),we.emptyPath();const n=e-2,r=[];let s="";for(let i=0;i<e;){const o=t.indexOf("",i);switch((o<0||o>n)&&W(),t.charAt(o+1)){case"":const a=t.substring(i,o);let c;s.length===0?c=a:(s+=a,c=s,s=""),r.push(c);break;case"":s+=t.substring(i,o),s+="\0";break;case"":s+=t.substring(i,o+1);break;default:W()}i=o+2}return new we(r)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jE=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kh(t,e){return[t,hn(e)]}function qN(t,e,n){return[t,hn(e),n]}const C4={},A4=["prefixPath","collectionGroup","readTime","documentId"],k4=["prefixPath","collectionGroup","documentId"],R4=["collectionGroup","readTime","prefixPath","documentId"],N4=["canonicalId","targetId"],P4=["targetId","path"],D4=["path","targetId"],x4=["collectionId","parent"],O4=["indexId","uid"],M4=["uid","sequenceNumber"],L4=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],F4=["indexId","uid","orderedDocumentKey"],U4=["userId","collectionPath","documentId"],$4=["userId","collectionPath","largestBatchId"],V4=["userId","collectionGroup","largestBatchId"],jN=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],B4=[...jN,"documentOverlays"],KN=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],WN=KN,q4=[...WN,"indexConfiguration","indexState","indexEntries"];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wm extends sN{constructor(e,n){super(),this.ee=e,this.currentSequenceNumber=n}}function Lt(t,e){const n=B(t);return sr.N(n.ee,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Av{constructor(e,n,r,s){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&s4(i,e,r[s])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=Jc(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=Jc(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=RN();return this.mutations.forEach(s=>{const i=e.get(s.key),o=i.overlayedDocument;let a=this.applyToLocalView(o,i.mutatedFields);a=n.has(s.key)?null:a;const c=EN(o,a);c!==null&&r.set(s.key,c),o.isValidDocument()||o.convertToNoDocument(re.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),ue())}isEqual(e){return this.batchId===e.batchId&&Aa(this.mutations,e.mutations,(n,r)=>ME(n,r))&&Aa(this.baseMutations,e.baseMutations,(n,r)=>ME(n,r))}}class kv{constructor(e,n,r,s){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=s}static from(e,n,r){se(e.mutations.length===r.length);let s=c4;const i=e.mutations;for(let o=0;o<i.length;o++)s=s.insert(i[o].key,r[o].version);return new kv(e,n,r,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rv{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bs{constructor(e,n,r,s,i=re.min(),o=re.min(),a=_t.EMPTY_BYTE_STRING){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a}withSequenceNumber(e){return new Bs(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)}withResumeToken(e,n){return new Bs(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e)}withLastLimboFreeSnapshotVersion(e){return new Bs(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HN{constructor(e){this.ne=e}}function j4(t,e){let n;if(e.document)n=LN(t.ne,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=F.fromSegments(e.noDocument.path),s=po(e.noDocument.readTime);n=Be.newNoDocument(r,s),e.hasCommittedMutations&&n.setHasCommittedMutations()}else{if(!e.unknownDocument)return W();{const r=F.fromSegments(e.unknownDocument.path),s=po(e.unknownDocument.version);n=Be.newUnknownDocument(r,s)}}return e.readTime&&n.setReadTime(function(r){const s=new ze(r[0],r[1]);return re.fromTimestamp(s)}(e.readTime)),n}function KE(t,e){const n=e.key,r={prefixPath:n.getCollectionPath().popLast().toArray(),collectionGroup:n.collectionGroup,documentId:n.path.lastSegment(),readTime:Ed(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=function(s,i){return{name:zl(s,i.key),fields:i.data.value.mapValue.fields,updateTime:Gl(s,i.version.toTimestamp())}}(t.ne,e);else if(e.isNoDocument())r.noDocument={path:n.path.toArray(),readTime:fo(e.version)};else{if(!e.isUnknownDocument())return W();r.unknownDocument={path:n.path.toArray(),version:fo(e.version)}}return r}function Ed(t){const e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function fo(t){const e=t.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function po(t){const e=new ze(t.seconds,t.nanoseconds);return re.fromTimestamp(e)}function ki(t,e){const n=(e.baseMutations||[]).map(i=>Km(t.ne,i));for(let i=0;i<e.mutations.length-1;++i){const o=e.mutations[i];if(i+1<e.mutations.length&&e.mutations[i+1].transform!==void 0){const a=e.mutations[i+1];o.updateTransforms=a.transform.fieldTransforms,e.mutations.splice(i+1,1),++i}}const r=e.mutations.map(i=>Km(t.ne,i)),s=ze.fromMillis(e.localWriteTimeMs);return new Av(e.batchId,s,n,r)}function Dc(t){const e=po(t.readTime),n=t.lastLimboFreeSnapshotVersion!==void 0?po(t.lastLimboFreeSnapshotVersion):re.min();let r;var s;return t.query.documents!==void 0?(se((s=t.query).documents.length===1),r=Qn(ec(ON(s.documents[0])))):r=function(i){return Qn($N(i))}(t.query),new Bs(r,t.targetId,0,t.lastListenSequenceNumber,e,n,_t.fromBase64String(t.resumeToken))}function GN(t,e){const n=fo(e.snapshotVersion),r=fo(e.lastLimboFreeSnapshotVersion);let s;s=bd(e.target)?FN(t.ne,e.target):UN(t.ne,e.target);const i=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:lo(e.target),readTime:n,resumeToken:i,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:s}}function Nv(t){const e=$N({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?dN(e,e.limit,"L"):e}function sg(t,e){return new Rv(e.largestBatchId,Km(t.ne,e.overlayMutation))}function WE(t,e){const n=e.path.lastSegment();return[t,hn(e.path.popLast()),n]}function HE(t,e,n,r){return{indexId:t,uid:e.uid||"",sequenceNumber:n,readTime:fo(r.readTime),documentKey:hn(r.documentKey.path),largestBatchId:r.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K4{getBundleMetadata(e,n){return GE(e).get(n).next(r=>{if(r)return{id:(s=r).bundleId,createTime:po(s.createTime),version:s.version};var s})}saveBundleMetadata(e,n){return GE(e).put({bundleId:(r=n).id,createTime:fo(kt(r.createTime)),version:r.version});var r}getNamedQuery(e,n){return zE(e).get(n).next(r=>{if(r)return{name:(s=r).name,query:Nv(s.bundledQuery),readTime:po(s.readTime)};var s})}saveNamedQuery(e,n){return zE(e).put(function(r){return{name:r.name,readTime:fo(kt(r.readTime)),bundledQuery:r.bundledQuery}}(n))}}function GE(t){return Lt(t,"bundles")}function zE(t){return Lt(t,"namedQueries")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tp{constructor(e,n){this.wt=e,this.userId=n}static se(e,n){const r=n.uid||"";return new tp(e,r)}getOverlay(e,n){return vc(e).get(WE(this.userId,n)).next(r=>r?sg(this.wt,r):null)}getOverlays(e,n){const r=Tr();return v.forEach(n,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,n,r){const s=[];return r.forEach((i,o)=>{const a=new Rv(n,o);s.push(this.ie(e,a))}),v.waitFor(s)}removeOverlaysForBatchId(e,n,r){const s=new Set;n.forEach(o=>s.add(hn(o.getCollectionPath())));const i=[];return s.forEach(o=>{const a=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,r+1],!1,!0);i.push(vc(e).W("collectionPathOverlayIndex",a))}),v.waitFor(i)}getOverlaysForCollection(e,n,r){const s=Tr(),i=hn(n),o=IDBKeyRange.bound([this.userId,i,r],[this.userId,i,Number.POSITIVE_INFINITY],!0);return vc(e).K("collectionPathOverlayIndex",o).next(a=>{for(const c of a){const l=sg(this.wt,c);s.set(l.getKey(),l)}return s})}getOverlaysForCollectionGroup(e,n,r,s){const i=Tr();let o;const a=IDBKeyRange.bound([this.userId,n,r],[this.userId,n,Number.POSITIVE_INFINITY],!0);return vc(e).J({index:"collectionGroupOverlayIndex",range:a},(c,l,u)=>{const h=sg(this.wt,l);i.size()<s||h.largestBatchId===o?(i.set(h.getKey(),h),o=h.largestBatchId):u.done()}).next(()=>i)}ie(e,n){return vc(e).put(function(r,s,i){const[o,a,c]=WE(s,i.mutation.key);return{userId:s,collectionPath:a,documentId:c,collectionGroup:i.mutation.key.getCollectionGroup(),largestBatchId:i.largestBatchId,overlayMutation:Yl(r.ne,i.mutation)}}(this.wt,this.userId,n))}}function vc(t){return Lt(t,"documentOverlays")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ri{constructor(){}re(e,n){this.oe(e,n),n.ue()}oe(e,n){if("nullValue"in e)this.ce(n,5);else if("booleanValue"in e)this.ce(n,10),n.ae(e.booleanValue?1:0);else if("integerValue"in e)this.ce(n,15),n.ae(et(e.integerValue));else if("doubleValue"in e){const r=et(e.doubleValue);isNaN(r)?this.ce(n,13):(this.ce(n,15),Kl(r)?n.ae(0):n.ae(r))}else if("timestampValue"in e){const r=e.timestampValue;this.ce(n,20),typeof r=="string"?n.he(r):(n.he(`${r.seconds||""}`),n.ae(r.nanos||0))}else if("stringValue"in e)this.le(e.stringValue,n),this.fe(n);else if("bytesValue"in e)this.ce(n,30),n.de(oo(e.bytesValue)),this.fe(n);else if("referenceValue"in e)this._e(e.referenceValue,n);else if("geoPointValue"in e){const r=e.geoPointValue;this.ce(n,45),n.ae(r.latitude||0),n.ae(r.longitude||0)}else"mapValue"in e?cN(e)?this.ce(n,Number.MAX_SAFE_INTEGER):(this.we(e.mapValue,n),this.fe(n)):"arrayValue"in e?(this.me(e.arrayValue,n),this.fe(n)):W()}le(e,n){this.ce(n,25),this.ge(e,n)}ge(e,n){n.he(e)}we(e,n){const r=e.fields||{};this.ce(n,55);for(const s of Object.keys(r))this.le(s,n),this.oe(r[s],n)}me(e,n){const r=e.values||[];this.ce(n,50);for(const s of r)this.oe(s,n)}_e(e,n){this.ce(n,37),F.fromName(e).path.forEach(r=>{this.ce(n,60),this.ge(r,n)})}ce(e,n){e.ae(n)}fe(e){e.ae(2)}}Ri.ye=new Ri;function W4(t){if(t===0)return 8;let e=0;return t>>4==0&&(e+=4,t<<=4),t>>6==0&&(e+=2,t<<=2),t>>7==0&&(e+=1),e}function QE(t){const e=64-function(n){let r=0;for(let s=0;s<8;++s){const i=W4(255&n[s]);if(r+=i,i!==8)break}return r}(t);return Math.ceil(e/8)}class H4{constructor(){this.buffer=new Uint8Array(1024),this.position=0}pe(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.Ie(r.value),r=n.next();this.Te()}Ee(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.Ae(r.value),r=n.next();this.Re()}be(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.Ie(r);else if(r<2048)this.Ie(960|r>>>6),this.Ie(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Ie(480|r>>>12),this.Ie(128|63&r>>>6),this.Ie(128|63&r);else{const s=n.codePointAt(0);this.Ie(240|s>>>18),this.Ie(128|63&s>>>12),this.Ie(128|63&s>>>6),this.Ie(128|63&s)}}this.Te()}Pe(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.Ae(r);else if(r<2048)this.Ae(960|r>>>6),this.Ae(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Ae(480|r>>>12),this.Ae(128|63&r>>>6),this.Ae(128|63&r);else{const s=n.codePointAt(0);this.Ae(240|s>>>18),this.Ae(128|63&s>>>12),this.Ae(128|63&s>>>6),this.Ae(128|63&s)}}this.Re()}ve(e){const n=this.Ve(e),r=QE(n);this.Se(1+r),this.buffer[this.position++]=255&r;for(let s=n.length-r;s<n.length;++s)this.buffer[this.position++]=255&n[s]}De(e){const n=this.Ve(e),r=QE(n);this.Se(1+r),this.buffer[this.position++]=~(255&r);for(let s=n.length-r;s<n.length;++s)this.buffer[this.position++]=~(255&n[s])}Ce(){this.xe(255),this.xe(255)}Ne(){this.ke(255),this.ke(255)}reset(){this.position=0}seed(e){this.Se(e.length),this.buffer.set(e,this.position),this.position+=e.length}Oe(){return this.buffer.slice(0,this.position)}Ve(e){const n=function(s){const i=new DataView(new ArrayBuffer(8));return i.setFloat64(0,s,!1),new Uint8Array(i.buffer)}(e),r=(128&n[0])!=0;n[0]^=r?255:128;for(let s=1;s<n.length;++s)n[s]^=r?255:0;return n}Ie(e){const n=255&e;n===0?(this.xe(0),this.xe(255)):n===255?(this.xe(255),this.xe(0)):this.xe(n)}Ae(e){const n=255&e;n===0?(this.ke(0),this.ke(255)):n===255?(this.ke(255),this.ke(0)):this.ke(e)}Te(){this.xe(0),this.xe(1)}Re(){this.ke(0),this.ke(1)}xe(e){this.Se(1),this.buffer[this.position++]=e}ke(e){this.Se(1),this.buffer[this.position++]=~e}Se(e){const n=e+this.position;if(n<=this.buffer.length)return;let r=2*this.buffer.length;r<n&&(r=n);const s=new Uint8Array(r);s.set(this.buffer),this.buffer=s}}class G4{constructor(e){this.Me=e}de(e){this.Me.pe(e)}he(e){this.Me.be(e)}ae(e){this.Me.ve(e)}ue(){this.Me.Ce()}}class z4{constructor(e){this.Me=e}de(e){this.Me.Ee(e)}he(e){this.Me.Pe(e)}ae(e){this.Me.De(e)}ue(){this.Me.Ne()}}class wc{constructor(){this.Me=new H4,this.Fe=new G4(this.Me),this.$e=new z4(this.Me)}seed(e){this.Me.seed(e)}Be(e){return e===0?this.Fe:this.$e}Oe(){return this.Me.Oe()}reset(){this.Me.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ni{constructor(e,n,r,s){this.indexId=e,this.documentKey=n,this.arrayValue=r,this.directionalValue=s}Le(){const e=this.directionalValue.length,n=e===0||this.directionalValue[e-1]===255?e+1:e,r=new Uint8Array(n);return r.set(this.directionalValue,0),n!==e?r.set([0],this.directionalValue.length):++r[r.length-1],new Ni(this.indexId,this.documentKey,this.arrayValue,r)}}function yi(t,e){let n=t.indexId-e.indexId;return n!==0?n:(n=YE(t.arrayValue,e.arrayValue),n!==0?n:(n=YE(t.directionalValue,e.directionalValue),n!==0?n:F.comparator(t.documentKey,e.documentKey)))}function YE(t,e){for(let n=0;n<t.length&&n<e.length;++n){const r=t[n]-e[n];if(r!==0)return r}return t.length-e.length}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q4{constructor(e){this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.Ue=e.orderBy,this.qe=[];for(const n of e.filters){const r=n;r.ht()?this.Ke=r:this.qe.push(r)}}Ge(e){const n=$m(e);if(n!==void 0&&!this.Qe(n))return!1;const r=Ei(e);let s=0,i=0;for(;s<r.length&&this.Qe(r[s]);++s);if(s===r.length)return!0;if(this.Ke!==void 0){const o=r[s];if(!this.je(this.Ke,o)||!this.We(this.Ue[i++],o))return!1;++s}for(;s<r.length;++s){const o=r[s];if(i>=this.Ue.length||!this.We(this.Ue[i++],o))return!1}return!0}Qe(e){for(const n of this.qe)if(this.je(n,e))return!0;return!1}je(e,n){if(e===void 0||!e.field.isEqual(n.fieldPath))return!1;const r=e.op==="array-contains"||e.op==="array-contains-any";return n.kind===2===r}We(e,n){return!!e.field.isEqual(n.fieldPath)&&(n.kind===0&&e.dir==="asc"||n.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y4{constructor(){this.ze=new Pv}addToCollectionParentIndex(e,n){return this.ze.add(n),v.resolve()}getCollectionParents(e,n){return v.resolve(this.ze.getEntries(n))}addFieldIndex(e,n){return v.resolve()}deleteFieldIndex(e,n){return v.resolve()}getDocumentsMatchingTarget(e,n){return v.resolve(null)}getIndexType(e,n){return v.resolve(0)}getFieldIndexes(e,n){return v.resolve([])}getNextCollectionGroupToUpdate(e){return v.resolve(null)}getMinOffset(e,n){return v.resolve(Mn.min())}getMinOffsetFromCollectionGroup(e,n){return v.resolve(Mn.min())}updateCollectionGroup(e,n,r){return v.resolve()}updateIndexEntries(e,n){return v.resolve()}}class Pv{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n]||new Ae(we.comparator),i=!s.has(r);return this.index[n]=s.add(r),i}has(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n];return s&&s.has(r)}getEntries(e){return(this.index[e]||new Ae(we.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ih=new Uint8Array(0);class J4{constructor(e,n){this.user=e,this.databaseId=n,this.He=new Pv,this.Je=new hi(r=>lo(r),(r,s)=>Du(r,s)),this.uid=e.uid||""}addToCollectionParentIndex(e,n){if(!this.He.has(n)){const r=n.lastSegment(),s=n.popLast();e.addOnCommittedListener(()=>{this.He.add(n)});const i={collectionId:r,parent:hn(s)};return JE(e).put(i)}return v.resolve()}getCollectionParents(e,n){const r=[],s=IDBKeyRange.bound([n,""],[ZR(n),""],!1,!0);return JE(e).K(s).next(i=>{for(const o of i){if(o.collectionId!==n)break;r.push(Sr(o.parent))}return r})}addFieldIndex(e,n){const r=oh(e),s=function(o){return{indexId:o.indexId,collectionGroup:o.collectionGroup,fields:o.fields.map(a=>[a.fieldPath.canonicalString(),a.kind])}}(n);delete s.indexId;const i=r.add(s);if(n.indexState){const o=Ic(e);return i.next(a=>{o.put(HE(a,this.user,n.indexState.sequenceNumber,n.indexState.offset))})}return i.next()}deleteFieldIndex(e,n){const r=oh(e),s=Ic(e),i=bc(e);return r.delete(n.indexId).next(()=>s.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0))).next(()=>i.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0)))}getDocumentsMatchingTarget(e,n){const r=bc(e);let s=!0;const i=new Map;return v.forEach(this.Ye(n),o=>this.Xe(e,o).next(a=>{s&&(s=!!a),i.set(o,a)})).next(()=>{if(s){let o=ue();const a=[];return v.forEach(i,(c,l)=>{var u;R("IndexedDbIndexManager",`Using index ${u=c,`id=${u.indexId}|cg=${u.collectionGroup}|f=${u.fields.map(k=>`${k.fieldPath}:${k.kind}`).join(",")}`} to execute ${lo(n)}`);const h=function(k,M){const j=$m(M);if(j===void 0)return null;for(const Y of Id(k,j.fieldPath))switch(Y.op){case"array-contains-any":return Y.value.arrayValue.values||[];case"array-contains":return[Y.value]}return null}(l,c),d=function(k,M){const j=new Map;for(const Y of Ei(M))for(const z of Id(k,Y.fieldPath))switch(z.op){case"==":case"in":j.set(Y.fieldPath.canonicalString(),z.value);break;case"not-in":case"!=":return j.set(Y.fieldPath.canonicalString(),z.value),Array.from(j.values())}return null}(l,c),f=function(k,M){const j=[];let Y=!0;for(const z of Ei(M)){const V=z.kind===0?NE(k,z.fieldPath,k.startAt):PE(k,z.fieldPath,k.startAt);j.push(V.value),Y&&(Y=V.inclusive)}return new ti(j,Y)}(l,c),p=function(k,M){const j=[];let Y=!0;for(const z of Ei(M)){const V=z.kind===0?PE(k,z.fieldPath,k.endAt):NE(k,z.fieldPath,k.endAt);j.push(V.value),Y&&(Y=V.inclusive)}return new ti(j,Y)}(l,c),_=this.Ze(c,l,f),y=this.Ze(c,l,p),I=this.tn(c,l,d),N=this.en(c.indexId,h,_,f.inclusive,y,p.inclusive,I);return v.forEach(N,k=>r.j(k,n.limit).next(M=>{M.forEach(j=>{const Y=F.fromSegments(j.documentKey);o.has(Y)||(o=o.add(Y),a.push(Y))})}))}).next(()=>a)}return v.resolve(null)})}Ye(e){let n=this.Je.get(e);return n||(n=[e],this.Je.set(e,n),n)}en(e,n,r,s,i,o,a){const c=(n!=null?n.length:1)*Math.max(r.length,i.length),l=c/(n!=null?n.length:1),u=[];for(let h=0;h<c;++h){const d=n?this.nn(n[h/l]):ih,f=this.sn(e,d,r[h%l],s),p=this.rn(e,d,i[h%l],o),_=a.map(y=>this.sn(e,d,y,!0));u.push(...this.createRange(f,p,_))}return u}sn(e,n,r,s){const i=new Ni(e,F.empty(),n,r);return s?i:i.Le()}rn(e,n,r,s){const i=new Ni(e,F.empty(),n,r);return s?i.Le():i}Xe(e,n){const r=new Q4(n),s=n.collectionGroup!=null?n.collectionGroup:n.path.lastSegment();return this.getFieldIndexes(e,s).next(i=>{let o=null;for(const a of i)r.Ge(a)&&(!o||a.fields.length>o.fields.length)&&(o=a);return o})}getIndexType(e,n){let r=2;return v.forEach(this.Ye(n),s=>this.Xe(e,s).next(i=>{i?r!==0&&i.fields.length<function(o){let a=new Ae(ot.comparator),c=!1;for(const l of o.filters){const u=l;u.field.isKeyField()||(u.op==="array-contains"||u.op==="array-contains-any"?c=!0:a=a.add(u.field))}for(const l of o.orderBy)l.field.isKeyField()||(a=a.add(l.field));return a.size+(c?1:0)}(s)&&(r=1):r=0})).next(()=>r)}on(e,n){const r=new wc;for(const s of Ei(e)){const i=n.data.field(s.fieldPath);if(i==null)return null;const o=r.Be(s.kind);Ri.ye.re(i,o)}return r.Oe()}nn(e){const n=new wc;return Ri.ye.re(e,n.Be(0)),n.Oe()}un(e,n){const r=new wc;return Ri.ye.re(co(this.databaseId,n),r.Be(function(s){const i=Ei(s);return i.length===0?0:i[i.length-1].kind}(e))),r.Oe()}tn(e,n,r){if(r===null)return[];let s=[];s.push(new wc);let i=0;for(const o of Ei(e)){const a=r[i++];for(const c of s)if(this.cn(n,o.fieldPath)&&Hl(a))s=this.an(s,o,a);else{const l=c.Be(o.kind);Ri.ye.re(a,l)}}return this.hn(s)}Ze(e,n,r){return this.tn(e,n,r.position)}hn(e){const n=[];for(let r=0;r<e.length;++r)n[r]=e[r].Oe();return n}an(e,n,r){const s=[...e],i=[];for(const o of r.arrayValue.values||[])for(const a of s){const c=new wc;c.seed(a.Oe()),Ri.ye.re(o,c.Be(n.kind)),i.push(c)}return i}cn(e,n){return!!e.filters.find(r=>r instanceof Bt&&r.field.isEqual(n)&&(r.op==="in"||r.op==="not-in"))}getFieldIndexes(e,n){const r=oh(e),s=Ic(e);return(n?r.K("collectionGroupIndex",IDBKeyRange.bound(n,n)):r.K()).next(i=>{const o=[];return v.forEach(i,a=>s.get([a.indexId,this.uid]).next(c=>{o.push(function(l,u){const h=u?new wd(u.sequenceNumber,new Mn(po(u.readTime),new F(Sr(u.documentKey)),u.largestBatchId)):wd.empty(),d=l.fields.map(([f,p])=>new D2(ot.fromServerFormat(f),p));return new eN(l.indexId,l.collectionGroup,d,h)}(a,c))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(n=>n.length===0?null:(n.sort((r,s)=>{const i=r.indexState.sequenceNumber-s.indexState.sequenceNumber;return i!==0?i:ce(r.collectionGroup,s.collectionGroup)}),n[0].collectionGroup))}updateCollectionGroup(e,n,r){const s=oh(e),i=Ic(e);return this.ln(e).next(o=>s.K("collectionGroupIndex",IDBKeyRange.bound(n,n)).next(a=>v.forEach(a,c=>i.put(HE(c.indexId,this.user,o,r)))))}updateIndexEntries(e,n){const r=new Map;return v.forEach(n,(s,i)=>{const o=r.get(s.collectionGroup);return(o?v.resolve(o):this.getFieldIndexes(e,s.collectionGroup)).next(a=>(r.set(s.collectionGroup,a),v.forEach(a,c=>this.fn(e,s,c).next(l=>{const u=this.dn(i,c);return l.isEqual(u)?v.resolve():this._n(e,i,c,l,u)}))))})}wn(e,n,r,s){return bc(e).put({indexId:s.indexId,uid:this.uid,arrayValue:s.arrayValue,directionalValue:s.directionalValue,orderedDocumentKey:this.un(r,n.key),documentKey:n.key.path.toArray()})}mn(e,n,r,s){return bc(e).delete([s.indexId,this.uid,s.arrayValue,s.directionalValue,this.un(r,n.key),n.key.path.toArray()])}fn(e,n,r){const s=bc(e);let i=new Ae(yi);return s.J({index:"documentKeyIndex",range:IDBKeyRange.only([r.indexId,this.uid,this.un(r,n)])},(o,a)=>{i=i.add(new Ni(r.indexId,n,a.arrayValue,a.directionalValue))}).next(()=>i)}dn(e,n){let r=new Ae(yi);const s=this.on(n,e);if(s==null)return r;const i=$m(n);if(i!=null){const o=e.data.field(i.fieldPath);if(Hl(o))for(const a of o.arrayValue.values||[])r=r.add(new Ni(n.indexId,e.key,this.nn(a),s))}else r=r.add(new Ni(n.indexId,e.key,ih,s));return r}_n(e,n,r,s,i){R("IndexedDbIndexManager","Updating index entries for document '%s'",n.key);const o=[];return function(a,c,l,u,h){const d=a.getIterator(),f=c.getIterator();let p=Uo(d),_=Uo(f);for(;p||_;){let y=!1,I=!1;if(p&&_){const N=l(p,_);N<0?I=!0:N>0&&(y=!0)}else p!=null?I=!0:y=!0;y?(u(_),_=Uo(f)):I?(h(p),p=Uo(d)):(p=Uo(d),_=Uo(f))}}(s,i,yi,a=>{o.push(this.wn(e,n,r,a))},a=>{o.push(this.mn(e,n,r,a))}),v.waitFor(o)}ln(e){let n=1;return Ic(e).J({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,s,i)=>{i.done(),n=s.sequenceNumber+1}).next(()=>n)}createRange(e,n,r){r=r.sort((o,a)=>yi(o,a)).filter((o,a,c)=>!a||yi(o,c[a-1])!==0);const s=[];s.push(e);for(const o of r){const a=yi(o,e),c=yi(o,n);if(a===0)s[0]=e.Le();else if(a>0&&c<0)s.push(o),s.push(o.Le());else if(c>0)break}s.push(n);const i=[];for(let o=0;o<s.length;o+=2)i.push(IDBKeyRange.bound([s[o].indexId,this.uid,s[o].arrayValue,s[o].directionalValue,ih,[]],[s[o+1].indexId,this.uid,s[o+1].arrayValue,s[o+1].directionalValue,ih,[]]));return i}getMinOffsetFromCollectionGroup(e,n){return this.getFieldIndexes(e,n).next(XE)}getMinOffset(e,n){return v.mapArray(this.Ye(n),r=>this.Xe(e,r).next(s=>s||W())).next(XE)}}function JE(t){return Lt(t,"collectionParents")}function bc(t){return Lt(t,"indexEntries")}function oh(t){return Lt(t,"indexConfiguration")}function Ic(t){return Lt(t,"indexState")}function XE(t){se(t.length!==0);let e=t[0].indexState.offset,n=e.largestBatchId;for(let r=1;r<t.length;r++){const s=t[r].indexState.offset;yv(s,e)<0&&(e=s),n<s.largestBatchId&&(n=s.largestBatchId)}return new Mn(e.readTime,e.documentKey,n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZE={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class mn{constructor(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new mn(e,mn.DEFAULT_COLLECTION_PERCENTILE,mn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zN(t,e,n){const r=t.store("mutations"),s=t.store("documentMutations"),i=[],o=IDBKeyRange.only(n.batchId);let a=0;const c=r.J({range:o},(u,h,d)=>(a++,d.delete()));i.push(c.next(()=>{se(a===1)}));const l=[];for(const u of n.mutations){const h=qN(e,u.key.path,n.batchId);i.push(s.delete(h)),l.push(u.key)}return v.waitFor(i).next(()=>l)}function Td(t){if(!t)return 0;let e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw W();e=t.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */mn.DEFAULT_COLLECTION_PERCENTILE=10,mn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,mn.DEFAULT=new mn(41943040,mn.DEFAULT_COLLECTION_PERCENTILE,mn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),mn.DISABLED=new mn(-1,0,0);class np{constructor(e,n,r,s){this.userId=e,this.wt=n,this.indexManager=r,this.referenceDelegate=s,this.gn={}}static se(e,n,r,s){se(e.uid!=="");const i=e.isAuthenticated()?e.uid:"";return new np(i,n,r,s)}checkEmpty(e){let n=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Is(e).J({index:"userMutationsIndex",range:r},(s,i,o)=>{n=!1,o.done()}).next(()=>n)}addMutationBatch(e,n,r,s){const i=Ho(e),o=Is(e);return o.add({}).next(a=>{se(typeof a=="number");const c=new Av(a,n,r,s),l=function(d,f,p){const _=p.baseMutations.map(I=>Yl(d.ne,I)),y=p.mutations.map(I=>Yl(d.ne,I));return{userId:f,batchId:p.batchId,localWriteTimeMs:p.localWriteTime.toMillis(),baseMutations:_,mutations:y}}(this.wt,this.userId,c),u=[];let h=new Ae((d,f)=>ce(d.canonicalString(),f.canonicalString()));for(const d of s){const f=qN(this.userId,d.key.path,a);h=h.add(d.key.path.popLast()),u.push(o.put(l)),u.push(i.put(f,C4))}return h.forEach(d=>{u.push(this.indexManager.addToCollectionParentIndex(e,d))}),e.addOnCommittedListener(()=>{this.gn[a]=c.keys()}),v.waitFor(u).next(()=>c)})}lookupMutationBatch(e,n){return Is(e).get(n).next(r=>r?(se(r.userId===this.userId),ki(this.wt,r)):null)}yn(e,n){return this.gn[n]?v.resolve(this.gn[n]):this.lookupMutationBatch(e,n).next(r=>{if(r){const s=r.keys();return this.gn[n]=s,s}return null})}getNextMutationBatchAfterBatchId(e,n){const r=n+1,s=IDBKeyRange.lowerBound([this.userId,r]);let i=null;return Is(e).J({index:"userMutationsIndex",range:s},(o,a,c)=>{a.userId===this.userId&&(se(a.batchId>=r),i=ki(this.wt,a)),c.done()}).next(()=>i)}getHighestUnacknowledgedBatchId(e){const n=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=-1;return Is(e).J({index:"userMutationsIndex",range:n,reverse:!0},(s,i,o)=>{r=i.batchId,o.done()}).next(()=>r)}getAllMutationBatches(e){const n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Is(e).K("userMutationsIndex",n).next(r=>r.map(s=>ki(this.wt,s)))}getAllMutationBatchesAffectingDocumentKey(e,n){const r=kh(this.userId,n.path),s=IDBKeyRange.lowerBound(r),i=[];return Ho(e).J({range:s},(o,a,c)=>{const[l,u,h]=o,d=Sr(u);if(l===this.userId&&n.path.isEqual(d))return Is(e).get(h).next(f=>{if(!f)throw W();se(f.userId===this.userId),i.push(ki(this.wt,f))});c.done()}).next(()=>i)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Ae(ce);const s=[];return n.forEach(i=>{const o=kh(this.userId,i.path),a=IDBKeyRange.lowerBound(o),c=Ho(e).J({range:a},(l,u,h)=>{const[d,f,p]=l,_=Sr(f);d===this.userId&&i.path.isEqual(_)?r=r.add(p):h.done()});s.push(c)}),v.waitFor(s).next(()=>this.pn(e,r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,s=r.length+1,i=kh(this.userId,r),o=IDBKeyRange.lowerBound(i);let a=new Ae(ce);return Ho(e).J({range:o},(c,l,u)=>{const[h,d,f]=c,p=Sr(d);h===this.userId&&r.isPrefixOf(p)?p.length===s&&(a=a.add(f)):u.done()}).next(()=>this.pn(e,a))}pn(e,n){const r=[],s=[];return n.forEach(i=>{s.push(Is(e).get(i).next(o=>{if(o===null)throw W();se(o.userId===this.userId),r.push(ki(this.wt,o))}))}),v.waitFor(s).next(()=>r)}removeMutationBatch(e,n){return zN(e.ee,this.userId,n).next(r=>(e.addOnCommittedListener(()=>{this.In(n.batchId)}),v.forEach(r,s=>this.referenceDelegate.markPotentiallyOrphaned(e,s))))}In(e){delete this.gn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(n=>{if(!n)return v.resolve();const r=IDBKeyRange.lowerBound([this.userId]),s=[];return Ho(e).J({range:r},(i,o,a)=>{if(i[0]===this.userId){const c=Sr(i[1]);s.push(c)}else a.done()}).next(()=>{se(s.length===0)})})}containsKey(e,n){return QN(e,this.userId,n)}Tn(e){return YN(e).get(this.userId).next(n=>n||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}}function QN(t,e,n){const r=kh(e,n.path),s=r[1],i=IDBKeyRange.lowerBound(r);let o=!1;return Ho(t).J({range:i,H:!0},(a,c,l)=>{const[u,h,d]=a;u===e&&h===s&&(o=!0),l.done()}).next(()=>o)}function Is(t){return Lt(t,"mutations")}function Ho(t){return Lt(t,"documentMutations")}function YN(t){return Lt(t,"mutationQueues")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class go{constructor(e){this.En=e}next(){return this.En+=2,this.En}static An(){return new go(0)}static Rn(){return new go(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X4{constructor(e,n){this.referenceDelegate=e,this.wt=n}allocateTargetId(e){return this.bn(e).next(n=>{const r=new go(n.highestTargetId);return n.highestTargetId=r.next(),this.Pn(e,n).next(()=>n.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.bn(e).next(n=>re.fromTimestamp(new ze(n.lastRemoteSnapshotVersion.seconds,n.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.bn(e).next(n=>n.highestListenSequenceNumber)}setTargetsMetadata(e,n,r){return this.bn(e).next(s=>(s.highestListenSequenceNumber=n,r&&(s.lastRemoteSnapshotVersion=r.toTimestamp()),n>s.highestListenSequenceNumber&&(s.highestListenSequenceNumber=n),this.Pn(e,s)))}addTargetData(e,n){return this.vn(e,n).next(()=>this.bn(e).next(r=>(r.targetCount+=1,this.Vn(n,r),this.Pn(e,r))))}updateTargetData(e,n){return this.vn(e,n)}removeTargetData(e,n){return this.removeMatchingKeysForTargetId(e,n.targetId).next(()=>Vo(e).delete(n.targetId)).next(()=>this.bn(e)).next(r=>(se(r.targetCount>0),r.targetCount-=1,this.Pn(e,r)))}removeTargets(e,n,r){let s=0;const i=[];return Vo(e).J((o,a)=>{const c=Dc(a);c.sequenceNumber<=n&&r.get(c.targetId)===null&&(s++,i.push(this.removeTargetData(e,c)))}).next(()=>v.waitFor(i)).next(()=>s)}forEachTarget(e,n){return Vo(e).J((r,s)=>{const i=Dc(s);n(i)})}bn(e){return eT(e).get("targetGlobalKey").next(n=>(se(n!==null),n))}Pn(e,n){return eT(e).put("targetGlobalKey",n)}vn(e,n){return Vo(e).put(GN(this.wt,n))}Vn(e,n){let r=!1;return e.targetId>n.highestTargetId&&(n.highestTargetId=e.targetId,r=!0),e.sequenceNumber>n.highestListenSequenceNumber&&(n.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.bn(e).next(n=>n.targetCount)}getTargetData(e,n){const r=lo(n),s=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let i=null;return Vo(e).J({range:s,index:"queryTargetsIndex"},(o,a,c)=>{const l=Dc(a);Du(n,l.target)&&(i=l,c.done())}).next(()=>i)}addMatchingKeys(e,n,r){const s=[],i=ks(e);return n.forEach(o=>{const a=hn(o.path);s.push(i.put({targetId:r,path:a})),s.push(this.referenceDelegate.addReference(e,r,o))}),v.waitFor(s)}removeMatchingKeys(e,n,r){const s=ks(e);return v.forEach(n,i=>{const o=hn(i.path);return v.waitFor([s.delete([r,o]),this.referenceDelegate.removeReference(e,r,i)])})}removeMatchingKeysForTargetId(e,n){const r=ks(e),s=IDBKeyRange.bound([n],[n+1],!1,!0);return r.delete(s)}getMatchingKeysForTargetId(e,n){const r=IDBKeyRange.bound([n],[n+1],!1,!0),s=ks(e);let i=ue();return s.J({range:r,H:!0},(o,a,c)=>{const l=Sr(o[1]),u=new F(l);i=i.add(u)}).next(()=>i)}containsKey(e,n){const r=hn(n.path),s=IDBKeyRange.bound([r],[ZR(r)],!1,!0);let i=0;return ks(e).J({index:"documentTargetsIndex",H:!0,range:s},([o,a],c,l)=>{o!==0&&(i++,l.done())}).next(()=>i>0)}te(e,n){return Vo(e).get(n).next(r=>r?Dc(r):null)}}function Vo(t){return Lt(t,"targets")}function eT(t){return Lt(t,"targetGlobal")}function ks(t){return Lt(t,"targetDocuments")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tT([t,e],[n,r]){const s=ce(t,n);return s===0?ce(e,r):s}class Z4{constructor(e){this.Sn=e,this.buffer=new Ae(tT),this.Dn=0}Cn(){return++this.Dn}xn(e){const n=[e,this.Cn()];if(this.buffer.size<this.Sn)this.buffer=this.buffer.add(n);else{const r=this.buffer.last();tT(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}}class e6{constructor(e,n,r){this.garbageCollector=e,this.asyncQueue=n,this.localStore=r,this.Nn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.kn(6e4)}stop(){this.Nn&&(this.Nn.cancel(),this.Nn=null)}get started(){return this.Nn!==null}kn(e){R("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.Nn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Nn=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){ui(n)?R("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",n):await li(n)}await this.kn(3e5)})}}class t6{constructor(e,n){this.On=e,this.params=n}calculateTargetCount(e,n){return this.On.Mn(e).next(r=>Math.floor(n/100*r))}nthSequenceNumber(e,n){if(n===0)return v.resolve(vn.ot);const r=new Z4(n);return this.On.forEachTarget(e,s=>r.xn(s.sequenceNumber)).next(()=>this.On.Fn(e,s=>r.xn(s))).next(()=>r.maxValue)}removeTargets(e,n,r){return this.On.removeTargets(e,n,r)}removeOrphanedDocuments(e,n){return this.On.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(R("LruGarbageCollector","Garbage collection skipped; disabled"),v.resolve(ZE)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(R("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),ZE):this.$n(e,n))}getCacheSize(e){return this.On.getCacheSize(e)}$n(e,n){let r,s,i,o,a,c,l;const u=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(h=>(h>this.params.maximumSequenceNumbersToCollect?(R("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${h}`),s=this.params.maximumSequenceNumbersToCollect):s=h,o=Date.now(),this.nthSequenceNumber(e,s))).next(h=>(r=h,a=Date.now(),this.removeTargets(e,r,n))).next(h=>(i=h,c=Date.now(),this.removeOrphanedDocuments(e,r))).next(h=>(l=Date.now(),Um()<=de.DEBUG&&R("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-u}ms
	Determined least recently used ${s} in `+(a-o)+`ms
	Removed ${i} targets in `+(c-a)+`ms
	Removed ${h} documents in `+(l-c)+`ms
Total Duration: ${l-u}ms`),v.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:i,documentsRemoved:h})))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class n6{constructor(e,n){this.db=e,this.garbageCollector=function(r,s){return new t6(r,s)}(this,n)}Mn(e){const n=this.Bn(e);return this.db.getTargetCache().getTargetCount(e).next(r=>n.next(s=>r+s))}Bn(e){let n=0;return this.Fn(e,r=>{n++}).next(()=>n)}forEachTarget(e,n){return this.db.getTargetCache().forEachTarget(e,n)}Fn(e,n){return this.Ln(e,(r,s)=>n(s))}addReference(e,n,r){return ah(e,r)}removeReference(e,n,r){return ah(e,r)}removeTargets(e,n,r){return this.db.getTargetCache().removeTargets(e,n,r)}markPotentiallyOrphaned(e,n){return ah(e,n)}Un(e,n){return function(r,s){let i=!1;return YN(r).Y(o=>QN(r,o,s).next(a=>(a&&(i=!0),v.resolve(!a)))).next(()=>i)}(e,n)}removeOrphanedDocuments(e,n){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),s=[];let i=0;return this.Ln(e,(o,a)=>{if(a<=n){const c=this.Un(e,o).next(l=>{if(!l)return i++,r.getEntry(e,o).next(()=>(r.removeEntry(o,re.min()),ks(e).delete([0,hn(o.path)])))});s.push(c)}}).next(()=>v.waitFor(s)).next(()=>r.apply(e)).next(()=>i)}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,n){return ah(e,n)}Ln(e,n){const r=ks(e);let s,i=vn.ot;return r.J({index:"documentTargetsIndex"},([o,a],{path:c,sequenceNumber:l})=>{o===0?(i!==vn.ot&&n(new F(Sr(s)),i),i=l,s=c):i=vn.ot}).next(()=>{i!==vn.ot&&n(new F(Sr(s)),i)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function ah(t,e){return ks(t).put(function(n,r){return{targetId:0,path:hn(n.path),sequenceNumber:r}}(e,t.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JN{constructor(){this.changes=new hi(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,Be.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?v.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class r6{constructor(e){this.wt=e}setIndexManager(e){this.indexManager=e}addEntry(e,n,r){return vi(e).put(r)}removeEntry(e,n,r){return vi(e).delete(function(s,i){const o=s.path.toArray();return[o.slice(0,o.length-2),o[o.length-2],Ed(i),o[o.length-1]]}(n,r))}updateMetadata(e,n){return this.getMetadata(e).next(r=>(r.byteSize+=n,this.qn(e,r)))}getEntry(e,n){let r=Be.newInvalidDocument(n);return vi(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(Ec(n))},(s,i)=>{r=this.Kn(n,i)}).next(()=>r)}Gn(e,n){let r={size:0,document:Be.newInvalidDocument(n)};return vi(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(Ec(n))},(s,i)=>{r={document:this.Kn(n,i),size:Td(i)}}).next(()=>r)}getEntries(e,n){let r=wn();return this.Qn(e,n,(s,i)=>{const o=this.Kn(s,i);r=r.insert(s,o)}).next(()=>r)}jn(e,n){let r=wn(),s=new rt(F.comparator);return this.Qn(e,n,(i,o)=>{const a=this.Kn(i,o);r=r.insert(i,a),s=s.insert(i,Td(o))}).next(()=>({documents:r,Wn:s}))}Qn(e,n,r){if(n.isEmpty())return v.resolve();let s=new Ae(sT);n.forEach(c=>s=s.add(c));const i=IDBKeyRange.bound(Ec(s.first()),Ec(s.last())),o=s.getIterator();let a=o.getNext();return vi(e).J({index:"documentKeyIndex",range:i},(c,l,u)=>{const h=F.fromSegments([...l.prefixPath,l.collectionGroup,l.documentId]);for(;a&&sT(a,h)<0;)r(a,null),a=o.getNext();a&&a.isEqual(h)&&(r(a,l),a=o.hasNext()?o.getNext():null),a?u.q(Ec(a)):u.done()}).next(()=>{for(;a;)r(a,null),a=o.hasNext()?o.getNext():null})}getAllFromCollection(e,n,r){const s=[n.popLast().toArray(),n.lastSegment(),Ed(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],i=[n.popLast().toArray(),n.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return vi(e).K(IDBKeyRange.bound(s,i,!0)).next(o=>{let a=wn();for(const c of o){const l=this.Kn(F.fromSegments(c.prefixPath.concat(c.collectionGroup,c.documentId)),c);a=a.insert(l.key,l)}return a})}getAllFromCollectionGroup(e,n,r,s){let i=wn();const o=rT(n,r),a=rT(n,Mn.max());return vi(e).J({index:"collectionGroupIndex",range:IDBKeyRange.bound(o,a,!0)},(c,l,u)=>{const h=this.Kn(F.fromSegments(l.prefixPath.concat(l.collectionGroup,l.documentId)),l);i=i.insert(h.key,h),i.size===s&&u.done()}).next(()=>i)}newChangeBuffer(e){return new s6(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(n=>n.byteSize)}getMetadata(e){return nT(e).get("remoteDocumentGlobalKey").next(n=>(se(!!n),n))}qn(e,n){return nT(e).put("remoteDocumentGlobalKey",n)}Kn(e,n){if(n){const r=j4(this.wt,n);if(!(r.isNoDocument()&&r.version.isEqual(re.min())))return r}return Be.newInvalidDocument(e)}}function XN(t){return new r6(t)}class s6 extends JN{constructor(e,n){super(),this.zn=e,this.trackRemovals=n,this.Hn=new hi(r=>r.toString(),(r,s)=>r.isEqual(s))}applyChanges(e){const n=[];let r=0,s=new Ae((i,o)=>ce(i.canonicalString(),o.canonicalString()));return this.changes.forEach((i,o)=>{const a=this.Hn.get(i);if(n.push(this.zn.removeEntry(e,i,a.readTime)),o.isValidDocument()){const c=KE(this.zn.wt,o);s=s.add(i.path.popLast()),r+=Td(c)-a.size,n.push(this.zn.addEntry(e,i,c))}else if(r-=a.size,this.trackRemovals){const c=KE(this.zn.wt,o.convertToNoDocument(re.min()));n.push(this.zn.addEntry(e,i,c))}}),s.forEach(i=>{n.push(this.zn.indexManager.addToCollectionParentIndex(e,i))}),n.push(this.zn.updateMetadata(e,r)),v.waitFor(n)}getFromCache(e,n){return this.zn.Gn(e,n).next(r=>(this.Hn.set(n,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,n){return this.zn.jn(e,n).next(({documents:r,Wn:s})=>(s.forEach((i,o)=>{this.Hn.set(i,{size:o,readTime:r.get(i).readTime})}),r))}}function nT(t){return Lt(t,"remoteDocumentGlobal")}function vi(t){return Lt(t,"remoteDocumentsV14")}function Ec(t){const e=t.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function rT(t,e){const n=e.documentKey.path.toArray();return[t,Ed(e.readTime),n.slice(0,n.length-2),n.length>0?n[n.length-1]:""]}function sT(t,e){const n=t.path.toArray(),r=e.path.toArray();let s=0;for(let i=0;i<n.length-2&&i<r.length-2;++i)if(s=ce(n[i],r[i]),s)return s;return s=ce(n.length,r.length),s||(s=ce(n[n.length-2],r[r.length-2]),s||ce(n[n.length-1],r[r.length-1]))}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class i6{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZN{constructor(e,n,r,s){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=s}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(s=>(r=s,this.getBaseDocument(e,n,r))).next(s=>(r!==null&&Jc(r.mutation,s,Pn.empty(),ze.now()),s))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,ue()).next(()=>r))}getLocalViewOfDocuments(e,n,r=ue()){const s=Tr();return this.populateOverlays(e,s,n).next(()=>this.computeViews(e,n,s,r).next(i=>{let o=Pc();return i.forEach((a,c)=>{o=o.insert(a,c.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){const r=Tr();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,ue()))}populateOverlays(e,n,r){const s=[];return r.forEach(i=>{n.has(i)||s.push(i)}),this.documentOverlayCache.getOverlays(e,s).next(i=>{i.forEach((o,a)=>{n.set(o,a)})})}computeViews(e,n,r,s){let i=wn();const o=Xc(),a=Xc();return n.forEach((c,l)=>{const u=r.get(l.key);s.has(l.key)&&(u===void 0||u.mutation instanceof fs)?i=i.insert(l.key,l):u!==void 0&&(o.set(l.key,u.mutation.getFieldMask()),Jc(u.mutation,l,u.mutation.getFieldMask(),ze.now()))}),this.recalculateAndSaveOverlays(e,i).next(c=>(c.forEach((l,u)=>o.set(l,u)),n.forEach((l,u)=>{var h;return a.set(l,new i6(u,(h=o.get(l))!==null&&h!==void 0?h:null))}),a))}recalculateAndSaveOverlays(e,n){const r=Xc();let s=new rt((o,a)=>o-a),i=ue();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(const a of o)a.keys().forEach(c=>{const l=n.get(c);if(l===null)return;let u=r.get(c)||Pn.empty();u=a.applyToLocalView(l,u),r.set(c,u);const h=(s.get(a.batchId)||ue()).add(c);s=s.insert(a.batchId,h)})}).next(()=>{const o=[],a=s.getReverseIterator();for(;a.hasNext();){const c=a.getNext(),l=c.key,u=c.value,h=RN();u.forEach(d=>{if(!i.has(d)){const f=EN(n.get(d),r.get(d));f!==null&&h.set(d,f),i=i.add(d)}}),o.push(this.documentOverlayCache.saveOverlays(e,l,h))}return v.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r){return function(s){return F.isDocumentKey(s.path)&&s.collectionGroup===null&&s.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):Ev(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r):this.getDocumentsMatchingCollectionQuery(e,n,r)}getNextDocuments(e,n,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,s).next(i=>{const o=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,s-i.size):v.resolve(Tr());let a=-1,c=i;return o.next(l=>v.forEach(l,(u,h)=>(a<h.largestBatchId&&(a=h.largestBatchId),i.get(u)?v.resolve():this.getBaseDocument(e,u,h).next(d=>{c=c.insert(u,d)}))).next(()=>this.populateOverlays(e,l,i)).next(()=>this.computeViews(e,c,l,ue())).next(u=>({batchId:a,changes:kN(u)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new F(n)).next(r=>{let s=Pc();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s})}getDocumentsMatchingCollectionGroupQuery(e,n,r){const s=n.collectionGroup;let i=Pc();return this.indexManager.getCollectionParents(e,s).next(o=>v.forEach(o,a=>{const c=function(l,u){return new ds(u,null,l.explicitOrderBy.slice(),l.filters.slice(),l.limit,l.limitType,l.startAt,l.endAt)}(n,a.child(s));return this.getDocumentsMatchingCollectionQuery(e,c,r).next(l=>{l.forEach((u,h)=>{i=i.insert(u,h)})})}).next(()=>i))}getDocumentsMatchingCollectionQuery(e,n,r){let s;return this.remoteDocumentCache.getAllFromCollection(e,n.path,r).next(i=>(s=i,this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId))).next(i=>{i.forEach((a,c)=>{const l=c.getKey();s.get(l)===null&&(s=s.insert(l,Be.newInvalidDocument(l)))});let o=Pc();return s.forEach((a,c)=>{const l=i.get(a);l!==void 0&&Jc(l.mutation,c,Pn.empty(),ze.now()),Tv(n,c)&&(o=o.insert(a,c))}),o})}getBaseDocument(e,n,r){return r===null||r.mutation.type===1?this.remoteDocumentCache.getEntry(e,n):v.resolve(Be.newInvalidDocument(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class o6{constructor(e){this.wt=e,this.Jn=new Map,this.Yn=new Map}getBundleMetadata(e,n){return v.resolve(this.Jn.get(n))}saveBundleMetadata(e,n){var r;return this.Jn.set(n.id,{id:(r=n).id,version:r.version,createTime:kt(r.createTime)}),v.resolve()}getNamedQuery(e,n){return v.resolve(this.Yn.get(n))}saveNamedQuery(e,n){return this.Yn.set(n.name,function(r){return{name:r.name,query:Nv(r.bundledQuery),readTime:kt(r.readTime)}}(n)),v.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class a6{constructor(){this.overlays=new rt(F.comparator),this.Xn=new Map}getOverlay(e,n){return v.resolve(this.overlays.get(n))}getOverlays(e,n){const r=Tr();return v.forEach(n,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((s,i)=>{this.ie(e,n,i)}),v.resolve()}removeOverlaysForBatchId(e,n,r){const s=this.Xn.get(r);return s!==void 0&&(s.forEach(i=>this.overlays=this.overlays.remove(i)),this.Xn.delete(r)),v.resolve()}getOverlaysForCollection(e,n,r){const s=Tr(),i=n.length+1,o=new F(n.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const c=a.getNext().value,l=c.getKey();if(!n.isPrefixOf(l.path))break;l.path.length===i&&c.largestBatchId>r&&s.set(c.getKey(),c)}return v.resolve(s)}getOverlaysForCollectionGroup(e,n,r,s){let i=new rt((l,u)=>l-u);const o=this.overlays.getIterator();for(;o.hasNext();){const l=o.getNext().value;if(l.getKey().getCollectionGroup()===n&&l.largestBatchId>r){let u=i.get(l.largestBatchId);u===null&&(u=Tr(),i=i.insert(l.largestBatchId,u)),u.set(l.getKey(),l)}}const a=Tr(),c=i.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((l,u)=>a.set(l,u)),!(a.size()>=s)););return v.resolve(a)}ie(e,n,r){const s=this.overlays.get(r.key);if(s!==null){const o=this.Xn.get(s.largestBatchId).delete(r.key);this.Xn.set(s.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new Rv(n,r));let i=this.Xn.get(n);i===void 0&&(i=ue(),this.Xn.set(n,i)),this.Xn.set(n,i.add(r.key))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dv{constructor(){this.Zn=new Ae(wt.ts),this.es=new Ae(wt.ns)}isEmpty(){return this.Zn.isEmpty()}addReference(e,n){const r=new wt(e,n);this.Zn=this.Zn.add(r),this.es=this.es.add(r)}ss(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.rs(new wt(e,n))}os(e,n){e.forEach(r=>this.removeReference(r,n))}us(e){const n=new F(new we([])),r=new wt(n,e),s=new wt(n,e+1),i=[];return this.es.forEachInRange([r,s],o=>{this.rs(o),i.push(o.key)}),i}cs(){this.Zn.forEach(e=>this.rs(e))}rs(e){this.Zn=this.Zn.delete(e),this.es=this.es.delete(e)}hs(e){const n=new F(new we([])),r=new wt(n,e),s=new wt(n,e+1);let i=ue();return this.es.forEachInRange([r,s],o=>{i=i.add(o.key)}),i}containsKey(e){const n=new wt(e,0),r=this.Zn.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class wt{constructor(e,n){this.key=e,this.ls=n}static ts(e,n){return F.comparator(e.key,n.key)||ce(e.ls,n.ls)}static ns(e,n){return ce(e.ls,n.ls)||F.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c6{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.fs=1,this.ds=new Ae(wt.ts)}checkEmpty(e){return v.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,s){const i=this.fs;this.fs++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new Av(i,n,r,s);this.mutationQueue.push(o);for(const a of s)this.ds=this.ds.add(new wt(a.key,i)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return v.resolve(o)}lookupMutationBatch(e,n){return v.resolve(this._s(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,s=this.ws(r),i=s<0?0:s;return v.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return v.resolve(this.mutationQueue.length===0?-1:this.fs-1)}getAllMutationBatches(e){return v.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new wt(n,0),s=new wt(n,Number.POSITIVE_INFINITY),i=[];return this.ds.forEachInRange([r,s],o=>{const a=this._s(o.ls);i.push(a)}),v.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Ae(ce);return n.forEach(s=>{const i=new wt(s,0),o=new wt(s,Number.POSITIVE_INFINITY);this.ds.forEachInRange([i,o],a=>{r=r.add(a.ls)})}),v.resolve(this.gs(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,s=r.length+1;let i=r;F.isDocumentKey(i)||(i=i.child(""));const o=new wt(new F(i),0);let a=new Ae(ce);return this.ds.forEachWhile(c=>{const l=c.key.path;return!!r.isPrefixOf(l)&&(l.length===s&&(a=a.add(c.ls)),!0)},o),v.resolve(this.gs(a))}gs(e){const n=[];return e.forEach(r=>{const s=this._s(r);s!==null&&n.push(s)}),n}removeMutationBatch(e,n){se(this.ys(n.batchId,"removed")===0),this.mutationQueue.shift();let r=this.ds;return v.forEach(n.mutations,s=>{const i=new wt(s.key,n.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.ds=r})}In(e){}containsKey(e,n){const r=new wt(n,0),s=this.ds.firstAfterOrEqual(r);return v.resolve(n.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,v.resolve()}ys(e,n){return this.ws(e)}ws(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}_s(e){const n=this.ws(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l6{constructor(e){this.ps=e,this.docs=new rt(F.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,s=this.docs.get(r),i=s?s.size:0,o=this.ps(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return v.resolve(r?r.document.mutableCopy():Be.newInvalidDocument(n))}getEntries(e,n){let r=wn();return n.forEach(s=>{const i=this.docs.get(s);r=r.insert(s,i?i.document.mutableCopy():Be.newInvalidDocument(s))}),v.resolve(r)}getAllFromCollection(e,n,r){let s=wn();const i=new F(n.child("")),o=this.docs.getIteratorFrom(i);for(;o.hasNext();){const{key:a,value:{document:c}}=o.getNext();if(!n.isPrefixOf(a.path))break;a.path.length>n.length+1||yv(nN(c),r)<=0||(s=s.insert(c.key,c.mutableCopy()))}return v.resolve(s)}getAllFromCollectionGroup(e,n,r,s){W()}Is(e,n){return v.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new u6(this)}getSize(e){return v.resolve(this.size)}}class u6 extends JN{constructor(e){super(),this.zn=e}applyChanges(e){const n=[];return this.changes.forEach((r,s)=>{s.isValidDocument()?n.push(this.zn.addEntry(e,s)):this.zn.removeEntry(r)}),v.waitFor(n)}getFromCache(e,n){return this.zn.getEntry(e,n)}getAllFromCache(e,n){return this.zn.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h6{constructor(e){this.persistence=e,this.Ts=new hi(n=>lo(n),Du),this.lastRemoteSnapshotVersion=re.min(),this.highestTargetId=0,this.Es=0,this.As=new Dv,this.targetCount=0,this.Rs=go.An()}forEachTarget(e,n){return this.Ts.forEach((r,s)=>n(s)),v.resolve()}getLastRemoteSnapshotVersion(e){return v.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return v.resolve(this.Es)}allocateTargetId(e){return this.highestTargetId=this.Rs.next(),v.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.Es&&(this.Es=n),v.resolve()}vn(e){this.Ts.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.Rs=new go(n),this.highestTargetId=n),e.sequenceNumber>this.Es&&(this.Es=e.sequenceNumber)}addTargetData(e,n){return this.vn(n),this.targetCount+=1,v.resolve()}updateTargetData(e,n){return this.vn(n),v.resolve()}removeTargetData(e,n){return this.Ts.delete(n.target),this.As.us(n.targetId),this.targetCount-=1,v.resolve()}removeTargets(e,n,r){let s=0;const i=[];return this.Ts.forEach((o,a)=>{a.sequenceNumber<=n&&r.get(a.targetId)===null&&(this.Ts.delete(o),i.push(this.removeMatchingKeysForTargetId(e,a.targetId)),s++)}),v.waitFor(i).next(()=>s)}getTargetCount(e){return v.resolve(this.targetCount)}getTargetData(e,n){const r=this.Ts.get(n)||null;return v.resolve(r)}addMatchingKeys(e,n,r){return this.As.ss(n,r),v.resolve()}removeMatchingKeys(e,n,r){this.As.os(n,r);const s=this.persistence.referenceDelegate,i=[];return s&&n.forEach(o=>{i.push(s.markPotentiallyOrphaned(e,o))}),v.waitFor(i)}removeMatchingKeysForTargetId(e,n){return this.As.us(n),v.resolve()}getMatchingKeysForTargetId(e,n){const r=this.As.hs(n);return v.resolve(r)}containsKey(e,n){return v.resolve(this.As.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eP{constructor(e,n){this.bs={},this.overlays={},this.Ps=new vn(0),this.vs=!1,this.vs=!0,this.referenceDelegate=e(this),this.Vs=new h6(this),this.indexManager=new Y4,this.remoteDocumentCache=function(r){return new l6(r)}(r=>this.referenceDelegate.Ss(r)),this.wt=new HN(n),this.Ds=new o6(this.wt)}start(){return Promise.resolve()}shutdown(){return this.vs=!1,Promise.resolve()}get started(){return this.vs}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new a6,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.bs[e.toKey()];return r||(r=new c6(n,this.referenceDelegate),this.bs[e.toKey()]=r),r}getTargetCache(){return this.Vs}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ds}runTransaction(e,n,r){R("MemoryPersistence","Starting transaction:",e);const s=new d6(this.Ps.next());return this.referenceDelegate.Cs(),r(s).next(i=>this.referenceDelegate.xs(s).next(()=>i)).toPromise().then(i=>(s.raiseOnCommittedEvent(),i))}Ns(e,n){return v.or(Object.values(this.bs).map(r=>()=>r.containsKey(e,n)))}}class d6 extends sN{constructor(e){super(),this.currentSequenceNumber=e}}class rp{constructor(e){this.persistence=e,this.ks=new Dv,this.Os=null}static Ms(e){return new rp(e)}get Fs(){if(this.Os)return this.Os;throw W()}addReference(e,n,r){return this.ks.addReference(r,n),this.Fs.delete(r.toString()),v.resolve()}removeReference(e,n,r){return this.ks.removeReference(r,n),this.Fs.add(r.toString()),v.resolve()}markPotentiallyOrphaned(e,n){return this.Fs.add(n.toString()),v.resolve()}removeTarget(e,n){this.ks.us(n.targetId).forEach(s=>this.Fs.add(s.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(s=>{s.forEach(i=>this.Fs.add(i.toString()))}).next(()=>r.removeTargetData(e,n))}Cs(){this.Os=new Set}xs(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return v.forEach(this.Fs,r=>{const s=F.fromPath(r);return this.$s(e,s).next(i=>{i||n.removeEntry(s,re.min())})}).next(()=>(this.Os=null,n.apply(e)))}updateLimboDocument(e,n){return this.$s(e,n).next(r=>{r?this.Fs.delete(n.toString()):this.Fs.add(n.toString())})}Ss(e){return 0}$s(e,n){return v.or([()=>v.resolve(this.ks.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Ns(e,n)])}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class f6{constructor(e){this.wt=e}O(e,n,r,s){const i=new Jf("createOrUpgrade",n);r<1&&s>=1&&(function(a){a.createObjectStore("owner")}(e),function(a){a.createObjectStore("mutationQueues",{keyPath:"userId"}),a.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",jE,{unique:!0}),a.createObjectStore("documentMutations")}(e),iT(e),function(a){a.createObjectStore("remoteDocuments")}(e));let o=v.resolve();return r<3&&s>=3&&(r!==0&&(function(a){a.deleteObjectStore("targetDocuments"),a.deleteObjectStore("targets"),a.deleteObjectStore("targetGlobal")}(e),iT(e)),o=o.next(()=>function(a){const c=a.store("targetGlobal"),l={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:re.min().toTimestamp(),targetCount:0};return c.put("targetGlobalKey",l)}(i))),r<4&&s>=4&&(r!==0&&(o=o.next(()=>function(a,c){return c.store("mutations").K().next(l=>{a.deleteObjectStore("mutations"),a.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",jE,{unique:!0});const u=c.store("mutations"),h=l.map(d=>u.put(d));return v.waitFor(h)})}(e,i))),o=o.next(()=>{(function(a){a.createObjectStore("clientMetadata",{keyPath:"clientId"})})(e)})),r<5&&s>=5&&(o=o.next(()=>this.Bs(i))),r<6&&s>=6&&(o=o.next(()=>(function(a){a.createObjectStore("remoteDocumentGlobal")}(e),this.Ls(i)))),r<7&&s>=7&&(o=o.next(()=>this.Us(i))),r<8&&s>=8&&(o=o.next(()=>this.qs(e,i))),r<9&&s>=9&&(o=o.next(()=>{(function(a){a.objectStoreNames.contains("remoteDocumentChanges")&&a.deleteObjectStore("remoteDocumentChanges")})(e)})),r<10&&s>=10&&(o=o.next(()=>this.Ks(i))),r<11&&s>=11&&(o=o.next(()=>{(function(a){a.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(a){a.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),r<12&&s>=12&&(o=o.next(()=>{(function(a){const c=a.createObjectStore("documentOverlays",{keyPath:U4});c.createIndex("collectionPathOverlayIndex",$4,{unique:!1}),c.createIndex("collectionGroupOverlayIndex",V4,{unique:!1})})(e)})),r<13&&s>=13&&(o=o.next(()=>function(a){const c=a.createObjectStore("remoteDocumentsV14",{keyPath:A4});c.createIndex("documentKeyIndex",k4),c.createIndex("collectionGroupIndex",R4)}(e)).next(()=>this.Gs(e,i)).next(()=>e.deleteObjectStore("remoteDocuments"))),r<14&&s>=14&&(o=o.next(()=>this.Qs(e,i))),r<15&&s>=15&&(o=o.next(()=>function(a){a.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),a.createObjectStore("indexState",{keyPath:O4}).createIndex("sequenceNumberIndex",M4,{unique:!1}),a.createObjectStore("indexEntries",{keyPath:L4}).createIndex("documentKeyIndex",F4,{unique:!1})}(e))),o}Ls(e){let n=0;return e.store("remoteDocuments").J((r,s)=>{n+=Td(s)}).next(()=>{const r={byteSize:n};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",r)})}Bs(e){const n=e.store("mutationQueues"),r=e.store("mutations");return n.K().next(s=>v.forEach(s,i=>{const o=IDBKeyRange.bound([i.userId,-1],[i.userId,i.lastAcknowledgedBatchId]);return r.K("userMutationsIndex",o).next(a=>v.forEach(a,c=>{se(c.userId===i.userId);const l=ki(this.wt,c);return zN(e,i.userId,l).next(()=>{})}))}))}Us(e){const n=e.store("targetDocuments"),r=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(s=>{const i=[];return r.J((o,a)=>{const c=new we(o),l=function(u){return[0,hn(u)]}(c);i.push(n.get(l).next(u=>u?v.resolve():(h=>n.put({targetId:0,path:hn(h),sequenceNumber:s.highestListenSequenceNumber}))(c)))}).next(()=>v.waitFor(i))})}qs(e,n){e.createObjectStore("collectionParents",{keyPath:x4});const r=n.store("collectionParents"),s=new Pv,i=o=>{if(s.add(o)){const a=o.lastSegment(),c=o.popLast();return r.put({collectionId:a,parent:hn(c)})}};return n.store("remoteDocuments").J({H:!0},(o,a)=>{const c=new we(o);return i(c.popLast())}).next(()=>n.store("documentMutations").J({H:!0},([o,a,c],l)=>{const u=Sr(a);return i(u.popLast())}))}Ks(e){const n=e.store("targets");return n.J((r,s)=>{const i=Dc(s),o=GN(this.wt,i);return n.put(o)})}Gs(e,n){const r=n.store("remoteDocuments"),s=[];return r.J((i,o)=>{const a=n.store("remoteDocumentsV14"),c=(l=o,l.document?new F(we.fromString(l.document.name).popFirst(5)):l.noDocument?F.fromSegments(l.noDocument.path):l.unknownDocument?F.fromSegments(l.unknownDocument.path):W()).path.toArray();var l;/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const u={prefixPath:c.slice(0,c.length-2),collectionGroup:c[c.length-2],documentId:c[c.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};s.push(a.put(u))}).next(()=>v.waitFor(s))}Qs(e,n){const r=n.store("mutations"),s=XN(this.wt),i=new eP(rp.Ms,this.wt.ne);return r.K().next(o=>{const a=new Map;return o.forEach(c=>{var l;let u=(l=a.get(c.userId))!==null&&l!==void 0?l:ue();ki(this.wt,c).keys().forEach(h=>u=u.add(h)),a.set(c.userId,u)}),v.forEach(a,(c,l)=>{const u=new Et(l),h=tp.se(this.wt,u),d=i.getIndexManager(u),f=np.se(u,this.wt,d,i.referenceDelegate);return new ZN(s,f,h,d).recalculateAndSaveOverlaysForDocumentKeys(new Wm(n,vn.ot),c).next()})})}}function iT(t){t.createObjectStore("targetDocuments",{keyPath:P4}).createIndex("documentTargetsIndex",D4,{unique:!0}),t.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",N4,{unique:!0}),t.createObjectStore("targetGlobal")}const ig="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class xv{constructor(e,n,r,s,i,o,a,c,l,u,h=14){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.js=i,this.window=o,this.document=a,this.Ws=l,this.zs=u,this.Hs=h,this.Ps=null,this.vs=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Js=null,this.inForeground=!1,this.Ys=null,this.Xs=null,this.Zs=Number.NEGATIVE_INFINITY,this.ti=d=>Promise.resolve(),!xv.V())throw new S(w.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new n6(this,s),this.ei=n+"main",this.wt=new HN(c),this.ni=new sr(this.ei,this.Hs,new f6(this.wt)),this.Vs=new X4(this.referenceDelegate,this.wt),this.remoteDocumentCache=XN(this.wt),this.Ds=new K4,this.window&&this.window.localStorage?this.si=this.window.localStorage:(this.si=null,u===!1&&dt("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.ii().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new S(w.FAILED_PRECONDITION,ig);return this.ri(),this.oi(),this.ui(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Vs.getHighestSequenceNumber(e))}).then(e=>{this.Ps=new vn(e,this.Ws)}).then(()=>{this.vs=!0}).catch(e=>(this.ni&&this.ni.close(),Promise.reject(e)))}ci(e){return this.ti=async n=>{if(this.started)return e(n)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.ni.F(async n=>{n.newVersion===null&&await e()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.js.enqueueAndForget(async()=>{this.started&&await this.ii()}))}ii(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>ch(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.ai(e).next(n=>{n||(this.isPrimary=!1,this.js.enqueueRetryable(()=>this.ti(!1)))})}).next(()=>this.hi(e)).next(n=>this.isPrimary&&!n?this.li(e).next(()=>!1):!!n&&this.fi(e).next(()=>!0))).catch(e=>{if(ui(e))return R("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return R("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.js.enqueueRetryable(()=>this.ti(e)),this.isPrimary=e})}ai(e){return Tc(e).get("owner").next(n=>v.resolve(this.di(n)))}_i(e){return ch(e).delete(this.clientId)}async wi(){if(this.isPrimary&&!this.mi(this.Zs,18e5)){this.Zs=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",n=>{const r=Lt(n,"clientMetadata");return r.K().next(s=>{const i=this.gi(s,18e5),o=s.filter(a=>i.indexOf(a)===-1);return v.forEach(o,a=>r.delete(a.clientId)).next(()=>o)})}).catch(()=>[]);if(this.si)for(const n of e)this.si.removeItem(this.yi(n.clientId))}}ui(){this.Xs=this.js.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.ii().then(()=>this.wi()).then(()=>this.ui()))}di(e){return!!e&&e.ownerId===this.clientId}hi(e){return this.zs?v.resolve(!0):Tc(e).get("owner").next(n=>{if(n!==null&&this.mi(n.leaseTimestampMs,5e3)&&!this.pi(n.ownerId)){if(this.di(n)&&this.networkEnabled)return!0;if(!this.di(n)){if(!n.allowTabSynchronization)throw new S(w.FAILED_PRECONDITION,ig);return!1}}return!(!this.networkEnabled||!this.inForeground)||ch(e).K().next(r=>this.gi(r,5e3).find(s=>{if(this.clientId!==s.clientId){const i=!this.networkEnabled&&s.networkEnabled,o=!this.inForeground&&s.inForeground,a=this.networkEnabled===s.networkEnabled;if(i||o&&a)return!0}return!1})===void 0)}).next(n=>(this.isPrimary!==n&&R("IndexedDbPersistence",`Client ${n?"is":"is not"} eligible for a primary lease.`),n))}async shutdown(){this.vs=!1,this.Ii(),this.Xs&&(this.Xs.cancel(),this.Xs=null),this.Ti(),this.Ei(),await this.ni.runTransaction("shutdown","readwrite",["owner","clientMetadata"],e=>{const n=new Wm(e,vn.ot);return this.li(n).next(()=>this._i(n))}),this.ni.close(),this.Ai()}gi(e,n){return e.filter(r=>this.mi(r.updateTimeMs,n)&&!this.pi(r.clientId))}Ri(){return this.runTransaction("getActiveClients","readonly",e=>ch(e).K().next(n=>this.gi(n,18e5).map(r=>r.clientId)))}get started(){return this.vs}getMutationQueue(e,n){return np.se(e,this.wt,n,this.referenceDelegate)}getTargetCache(){return this.Vs}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new J4(e,this.wt.ne.databaseId)}getDocumentOverlayCache(e){return tp.se(this.wt,e)}getBundleCache(){return this.Ds}runTransaction(e,n,r){R("IndexedDbPersistence","Starting transaction:",e);const s=n==="readonly"?"readonly":"readwrite",i=(o=this.Hs)===15?q4:o===14?WN:o===13?KN:o===12?B4:o===11?jN:void W();var o;let a;return this.ni.runTransaction(e,s,i,c=>(a=new Wm(c,this.Ps?this.Ps.next():vn.ot),n==="readwrite-primary"?this.ai(a).next(l=>!!l||this.hi(a)).next(l=>{if(!l)throw dt(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.js.enqueueRetryable(()=>this.ti(!1)),new S(w.FAILED_PRECONDITION,rN);return r(a)}).next(l=>this.fi(a).next(()=>l)):this.bi(a).next(()=>r(a)))).then(c=>(a.raiseOnCommittedEvent(),c))}bi(e){return Tc(e).get("owner").next(n=>{if(n!==null&&this.mi(n.leaseTimestampMs,5e3)&&!this.pi(n.ownerId)&&!this.di(n)&&!(this.zs||this.allowTabSynchronization&&n.allowTabSynchronization))throw new S(w.FAILED_PRECONDITION,ig)})}fi(e){const n={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return Tc(e).put("owner",n)}static V(){return sr.V()}li(e){const n=Tc(e);return n.get("owner").next(r=>this.di(r)?(R("IndexedDbPersistence","Releasing primary lease."),n.delete("owner")):v.resolve())}mi(e,n){const r=Date.now();return!(e<r-n)&&(!(e>r)||(dt(`Detected an update time that is in the future: ${e} > ${r}`),!1))}ri(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Ys=()=>{this.js.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.ii()))},this.document.addEventListener("visibilitychange",this.Ys),this.inForeground=this.document.visibilityState==="visible")}Ti(){this.Ys&&(this.document.removeEventListener("visibilitychange",this.Ys),this.Ys=null)}oi(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.Js=()=>{this.Ii(),NL()&&navigator.appVersion.match(/Version\/1[45]/)&&this.js.enterRestrictedMode(!0),this.js.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Js))}Ei(){this.Js&&(this.window.removeEventListener("pagehide",this.Js),this.Js=null)}pi(e){var n;try{const r=((n=this.si)===null||n===void 0?void 0:n.getItem(this.yi(e)))!==null;return R("IndexedDbPersistence",`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return dt("IndexedDbPersistence","Failed to get zombied client id.",r),!1}}Ii(){if(this.si)try{this.si.setItem(this.yi(this.clientId),String(Date.now()))}catch(e){dt("Failed to set zombie client id.",e)}}Ai(){if(this.si)try{this.si.removeItem(this.yi(this.clientId))}catch{}}yi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function Tc(t){return Lt(t,"owner")}function ch(t){return Lt(t,"clientMetadata")}function Ov(t,e){let n=t.projectId;return t.isDefaultDatabase||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mv{constructor(e,n,r,s){this.targetId=e,this.fromCache=n,this.Pi=r,this.vi=s}static Vi(e,n){let r=ue(),s=ue();for(const i of n.docChanges)switch(i.type){case 0:r=r.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new Mv(e,n.fromCache,r,s)}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tP{constructor(){this.Si=!1}initialize(e,n){this.Di=e,this.indexManager=n,this.Si=!0}getDocumentsMatchingQuery(e,n,r,s){return this.Ci(e,n).next(i=>i||this.xi(e,n,s,r)).next(i=>i||this.Ni(e,n))}Ci(e,n){return v.resolve(null)}xi(e,n,r,s){return X2(n)||s.isEqual(re.min())?this.Ni(e,n):this.Di.getDocuments(e,r).next(i=>{const o=this.ki(n,i);return this.Oi(n,o,r,s)?this.Ni(e,n):(Um()<=de.DEBUG&&R("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),qm(n)),this.Mi(e,o,n,tN(s,-1)))})}ki(e,n){let r=new Ae(gN(e));return n.forEach((s,i)=>{Tv(e,i)&&(r=r.add(i))}),r}Oi(e,n,r,s){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const i=e.limitType==="F"?n.last():n.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}Ni(e,n){return Um()<=de.DEBUG&&R("QueryEngine","Using full collection scan to execute query:",qm(n)),this.Di.getDocumentsMatchingQuery(e,n,Mn.min())}Mi(e,n,r,s){return this.Di.getDocumentsMatchingQuery(e,r,s).next(i=>(n.forEach(o=>{i=i.insert(o.key,o)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p6{constructor(e,n,r,s){this.persistence=e,this.Fi=n,this.wt=s,this.$i=new rt(ce),this.Bi=new hi(i=>lo(i),Du),this.Li=new Map,this.Ui=e.getRemoteDocumentCache(),this.Vs=e.getTargetCache(),this.Ds=e.getBundleCache(),this.qi(r)}qi(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new ZN(this.Ui,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ui.setIndexManager(this.indexManager),this.Fi.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.$i))}}function nP(t,e,n,r){return new p6(t,e,n,r)}async function rP(t,e){const n=B(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let s;return n.mutationQueue.getAllMutationBatches(r).next(i=>(s=i,n.qi(e),n.mutationQueue.getAllMutationBatches(r))).next(i=>{const o=[],a=[];let c=ue();for(const l of s){o.push(l.batchId);for(const u of l.mutations)c=c.add(u.key)}for(const l of i){a.push(l.batchId);for(const u of l.mutations)c=c.add(u.key)}return n.localDocuments.getDocuments(r,c).next(l=>({Ki:l,removedBatchIds:o,addedBatchIds:a}))})})}function g6(t,e){const n=B(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const s=e.batch.keys(),i=n.Ui.newChangeBuffer({trackRemovals:!0});return function(o,a,c,l){const u=c.batch,h=u.keys();let d=v.resolve();return h.forEach(f=>{d=d.next(()=>l.getEntry(a,f)).next(p=>{const _=c.docVersions.get(f);se(_!==null),p.version.compareTo(_)<0&&(u.applyToRemoteDocument(p,c),p.isValidDocument()&&(p.setReadTime(c.commitVersion),l.addEntry(p)))})}),d.next(()=>o.mutationQueue.removeMutationBatch(a,u))}(n,r,e,i).next(()=>i.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,s,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(o){let a=ue();for(let c=0;c<o.mutationResults.length;++c)o.mutationResults[c].transformResults.length>0&&(a=a.add(o.batch.mutations[c].key));return a}(e))).next(()=>n.localDocuments.getDocuments(r,s))})}function sP(t){const e=B(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Vs.getLastRemoteSnapshotVersion(n))}function m6(t,e){const n=B(t),r=e.snapshotVersion;let s=n.$i;return n.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const o=n.Ui.newChangeBuffer({trackRemovals:!0});s=n.$i;const a=[];e.targetChanges.forEach((u,h)=>{const d=s.get(h);if(!d)return;a.push(n.Vs.removeMatchingKeys(i,u.removedDocuments,h).next(()=>n.Vs.addMatchingKeys(i,u.addedDocuments,h)));let f=d.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.has(h)?f=f.withResumeToken(_t.EMPTY_BYTE_STRING,re.min()).withLastLimboFreeSnapshotVersion(re.min()):u.resumeToken.approximateByteSize()>0&&(f=f.withResumeToken(u.resumeToken,r)),s=s.insert(h,f),function(p,_,y){return p.resumeToken.approximateByteSize()===0||_.snapshotVersion.toMicroseconds()-p.snapshotVersion.toMicroseconds()>=3e8?!0:y.addedDocuments.size+y.modifiedDocuments.size+y.removedDocuments.size>0}(d,f,u)&&a.push(n.Vs.updateTargetData(i,f))});let c=wn(),l=ue();if(e.documentUpdates.forEach(u=>{e.resolvedLimboDocuments.has(u)&&a.push(n.persistence.referenceDelegate.updateLimboDocument(i,u))}),a.push(iP(i,o,e.documentUpdates).next(u=>{c=u.Gi,l=u.Qi})),!r.isEqual(re.min())){const u=n.Vs.getLastRemoteSnapshotVersion(i).next(h=>n.Vs.setTargetsMetadata(i,i.currentSequenceNumber,r));a.push(u)}return v.waitFor(a).next(()=>o.apply(i)).next(()=>n.localDocuments.getLocalViewOfDocuments(i,c,l)).next(()=>c)}).then(i=>(n.$i=s,i))}function iP(t,e,n){let r=ue(),s=ue();return n.forEach(i=>r=r.add(i)),e.getEntries(t,r).next(i=>{let o=wn();return n.forEach((a,c)=>{const l=i.get(a);c.isFoundDocument()!==l.isFoundDocument()&&(s=s.add(a)),c.isNoDocument()&&c.version.isEqual(re.min())?(e.removeEntry(a,c.readTime),o=o.insert(a,c)):!l.isValidDocument()||c.version.compareTo(l.version)>0||c.version.compareTo(l.version)===0&&l.hasPendingWrites?(e.addEntry(c),o=o.insert(a,c)):R("LocalStore","Ignoring outdated watch update for ",a,". Current version:",l.version," Watch version:",c.version)}),{Gi:o,Qi:s}})}function _6(t,e){const n=B(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function Pa(t,e){const n=B(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let s;return n.Vs.getTargetData(r,e).next(i=>i?(s=i,v.resolve(s)):n.Vs.allocateTargetId(r).next(o=>(s=new Bs(e,o,0,r.currentSequenceNumber),n.Vs.addTargetData(r,s).next(()=>s))))}).then(r=>{const s=n.$i.get(r.targetId);return(s===null||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(n.$i=n.$i.insert(r.targetId,r),n.Bi.set(e,r.targetId)),r})}async function Da(t,e,n){const r=B(t),s=r.$i.get(e),i=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",i,o=>r.persistence.referenceDelegate.removeTarget(o,s))}catch(o){if(!ui(o))throw o;R("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}r.$i=r.$i.remove(e),r.Bi.delete(s.target)}function Sd(t,e,n){const r=B(t);let s=re.min(),i=ue();return r.persistence.runTransaction("Execute query","readonly",o=>function(a,c,l){const u=B(a),h=u.Bi.get(l);return h!==void 0?v.resolve(u.$i.get(h)):u.Vs.getTargetData(c,l)}(r,o,Qn(e)).next(a=>{if(a)return s=a.lastLimboFreeSnapshotVersion,r.Vs.getMatchingKeysForTargetId(o,a.targetId).next(c=>{i=c})}).next(()=>r.Fi.getDocumentsMatchingQuery(o,e,n?s:re.min(),n?i:ue())).next(a=>(cP(r,pN(e),a),{documents:a,ji:i})))}function oP(t,e){const n=B(t),r=B(n.Vs),s=n.$i.get(e);return s?Promise.resolve(s.target):n.persistence.runTransaction("Get target data","readonly",i=>r.te(i,e).next(o=>o?o.target:null))}function aP(t,e){const n=B(t),r=n.Li.get(e)||re.min();return n.persistence.runTransaction("Get new document changes","readonly",s=>n.Ui.getAllFromCollectionGroup(s,e,tN(r,-1),Number.MAX_SAFE_INTEGER)).then(s=>(cP(n,e,s),s))}function cP(t,e,n){let r=re.min();n.forEach((s,i)=>{i.readTime.compareTo(r)>0&&(r=i.readTime)}),t.Li.set(e,r)}async function y6(t,e,n,r){const s=B(t);let i=ue(),o=wn();for(const l of n){const u=e.Wi(l.metadata.name);l.document&&(i=i.add(u));const h=e.zi(l);h.setReadTime(e.Hi(l.metadata.readTime)),o=o.insert(u,h)}const a=s.Ui.newChangeBuffer({trackRemovals:!0}),c=await Pa(s,function(l){return Qn(ec(we.fromString(`__bundle__/docs/${l}`)))}(r));return s.persistence.runTransaction("Apply bundle documents","readwrite",l=>iP(l,a,o).next(u=>(a.apply(l),u)).next(u=>s.Vs.removeMatchingKeysForTargetId(l,c.targetId).next(()=>s.Vs.addMatchingKeys(l,i,c.targetId)).next(()=>s.localDocuments.getLocalViewOfDocuments(l,u.Gi,u.Qi)).next(()=>u.Gi)))}async function v6(t,e,n=ue()){const r=await Pa(t,Qn(Nv(e.bundledQuery))),s=B(t);return s.persistence.runTransaction("Save named query","readwrite",i=>{const o=kt(e.readTime);if(r.snapshotVersion.compareTo(o)>=0)return s.Ds.saveNamedQuery(i,e);const a=r.withResumeToken(_t.EMPTY_BYTE_STRING,o);return s.$i=s.$i.insert(a.targetId,a),s.Vs.updateTargetData(i,a).next(()=>s.Vs.removeMatchingKeysForTargetId(i,r.targetId)).next(()=>s.Vs.addMatchingKeys(i,n,r.targetId)).next(()=>s.Ds.saveNamedQuery(i,e))})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oT(t,e){return`firestore_clients_${t}_${e}`}function aT(t,e,n){let r=`firestore_mutations_${t}_${n}`;return e.isAuthenticated()&&(r+=`_${e.uid}`),r}function og(t,e){return`firestore_targets_${t}_${e}`}class Cd{constructor(e,n,r,s){this.user=e,this.batchId=n,this.state=r,this.error=s}static Ji(e,n,r){const s=JSON.parse(r);let i,o=typeof s=="object"&&["pending","acknowledged","rejected"].indexOf(s.state)!==-1&&(s.error===void 0||typeof s.error=="object");return o&&s.error&&(o=typeof s.error.message=="string"&&typeof s.error.code=="string",o&&(i=new S(s.error.code,s.error.message))),o?new Cd(e,n,s.state,i):(dt("SharedClientState",`Failed to parse mutation state for ID '${n}': ${r}`),null)}Yi(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Zc{constructor(e,n,r){this.targetId=e,this.state=n,this.error=r}static Ji(e,n){const r=JSON.parse(n);let s,i=typeof r=="object"&&["not-current","current","rejected"].indexOf(r.state)!==-1&&(r.error===void 0||typeof r.error=="object");return i&&r.error&&(i=typeof r.error.message=="string"&&typeof r.error.code=="string",i&&(s=new S(r.error.code,r.error.message))),i?new Zc(e,r.state,s):(dt("SharedClientState",`Failed to parse target state for ID '${e}': ${n}`),null)}Yi(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Ad{constructor(e,n){this.clientId=e,this.activeTargetIds=n}static Ji(e,n){const r=JSON.parse(n);let s=typeof r=="object"&&r.activeTargetIds instanceof Array,i=ep();for(let o=0;s&&o<r.activeTargetIds.length;++o)s=aN(r.activeTargetIds[o]),i=i.add(r.activeTargetIds[o]);return s?new Ad(e,i):(dt("SharedClientState",`Failed to parse client data for instance '${e}': ${n}`),null)}}class Lv{constructor(e,n){this.clientId=e,this.onlineState=n}static Ji(e){const n=JSON.parse(e);return typeof n=="object"&&["Unknown","Online","Offline"].indexOf(n.onlineState)!==-1&&typeof n.clientId=="string"?new Lv(n.clientId,n.onlineState):(dt("SharedClientState",`Failed to parse online state: ${e}`),null)}}class Hm{constructor(){this.activeTargetIds=ep()}Xi(e){this.activeTargetIds=this.activeTargetIds.add(e)}Zi(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Yi(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class ag{constructor(e,n,r,s,i){this.window=e,this.js=n,this.persistenceKey=r,this.tr=s,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.er=this.nr.bind(this),this.sr=new rt(ce),this.started=!1,this.ir=[];const o=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.rr=oT(this.persistenceKey,this.tr),this.ur=function(a){return`firestore_sequence_number_${a}`}(this.persistenceKey),this.sr=this.sr.insert(this.tr,new Hm),this.cr=new RegExp(`^firestore_clients_${o}_([^_]*)$`),this.ar=new RegExp(`^firestore_mutations_${o}_(\\d+)(?:_(.*))?$`),this.hr=new RegExp(`^firestore_targets_${o}_(\\d+)$`),this.lr=function(a){return`firestore_online_state_${a}`}(this.persistenceKey),this.dr=function(a){return`firestore_bundle_loaded_v2_${a}`}(this.persistenceKey),this.window.addEventListener("storage",this.er)}static V(e){return!(!e||!e.localStorage)}async start(){const e=await this.syncEngine.Ri();for(const r of e){if(r===this.tr)continue;const s=this.getItem(oT(this.persistenceKey,r));if(s){const i=Ad.Ji(r,s);i&&(this.sr=this.sr.insert(i.clientId,i))}}this._r();const n=this.storage.getItem(this.lr);if(n){const r=this.wr(n);r&&this.mr(r)}for(const r of this.ir)this.nr(r);this.ir=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0}writeSequenceNumber(e){this.setItem(this.ur,JSON.stringify(e))}getAllActiveQueryTargets(){return this.gr(this.sr)}isActiveQueryTarget(e){let n=!1;return this.sr.forEach((r,s)=>{s.activeTargetIds.has(e)&&(n=!0)}),n}addPendingMutation(e){this.yr(e,"pending")}updateMutationState(e,n,r){this.yr(e,n,r),this.pr(e)}addLocalQueryTarget(e){let n="not-current";if(this.isActiveQueryTarget(e)){const r=this.storage.getItem(og(this.persistenceKey,e));if(r){const s=Zc.Ji(e,r);s&&(n=s.state)}}return this.Ir.Xi(e),this._r(),n}removeLocalQueryTarget(e){this.Ir.Zi(e),this._r()}isLocalQueryTarget(e){return this.Ir.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(og(this.persistenceKey,e))}updateQueryState(e,n,r){this.Tr(e,n,r)}handleUserChange(e,n,r){n.forEach(s=>{this.pr(s)}),this.currentUser=e,r.forEach(s=>{this.addPendingMutation(s)})}setOnlineState(e){this.Er(e)}notifyBundleLoaded(e){this.Ar(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.er),this.removeItem(this.rr),this.started=!1)}getItem(e){const n=this.storage.getItem(e);return R("SharedClientState","READ",e,n),n}setItem(e,n){R("SharedClientState","SET",e,n),this.storage.setItem(e,n)}removeItem(e){R("SharedClientState","REMOVE",e),this.storage.removeItem(e)}nr(e){const n=e;if(n.storageArea===this.storage){if(R("SharedClientState","EVENT",n.key,n.newValue),n.key===this.rr)return void dt("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.js.enqueueRetryable(async()=>{if(this.started){if(n.key!==null){if(this.cr.test(n.key)){if(n.newValue==null){const r=this.Rr(n.key);return this.br(r,null)}{const r=this.Pr(n.key,n.newValue);if(r)return this.br(r.clientId,r)}}else if(this.ar.test(n.key)){if(n.newValue!==null){const r=this.vr(n.key,n.newValue);if(r)return this.Vr(r)}}else if(this.hr.test(n.key)){if(n.newValue!==null){const r=this.Sr(n.key,n.newValue);if(r)return this.Dr(r)}}else if(n.key===this.lr){if(n.newValue!==null){const r=this.wr(n.newValue);if(r)return this.mr(r)}}else if(n.key===this.ur){const r=function(s){let i=vn.ot;if(s!=null)try{const o=JSON.parse(s);se(typeof o=="number"),i=o}catch(o){dt("SharedClientState","Failed to read sequence number from WebStorage",o)}return i}(n.newValue);r!==vn.ot&&this.sequenceNumberHandler(r)}else if(n.key===this.dr){const r=this.Cr(n.newValue);await Promise.all(r.map(s=>this.syncEngine.Nr(s)))}}}else this.ir.push(n)})}}get Ir(){return this.sr.get(this.tr)}_r(){this.setItem(this.rr,this.Ir.Yi())}yr(e,n,r){const s=new Cd(this.currentUser,e,n,r),i=aT(this.persistenceKey,this.currentUser,e);this.setItem(i,s.Yi())}pr(e){const n=aT(this.persistenceKey,this.currentUser,e);this.removeItem(n)}Er(e){const n={clientId:this.tr,onlineState:e};this.storage.setItem(this.lr,JSON.stringify(n))}Tr(e,n,r){const s=og(this.persistenceKey,e),i=new Zc(e,n,r);this.setItem(s,i.Yi())}Ar(e){const n=JSON.stringify(Array.from(e));this.setItem(this.dr,n)}Rr(e){const n=this.cr.exec(e);return n?n[1]:null}Pr(e,n){const r=this.Rr(e);return Ad.Ji(r,n)}vr(e,n){const r=this.ar.exec(e),s=Number(r[1]),i=r[2]!==void 0?r[2]:null;return Cd.Ji(new Et(i),s,n)}Sr(e,n){const r=this.hr.exec(e),s=Number(r[1]);return Zc.Ji(s,n)}wr(e){return Lv.Ji(e)}Cr(e){return JSON.parse(e)}async Vr(e){if(e.user.uid===this.currentUser.uid)return this.syncEngine.kr(e.batchId,e.state,e.error);R("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)}Dr(e){return this.syncEngine.Or(e.targetId,e.state,e.error)}br(e,n){const r=n?this.sr.insert(e,n):this.sr.remove(e),s=this.gr(this.sr),i=this.gr(r),o=[],a=[];return i.forEach(c=>{s.has(c)||o.push(c)}),s.forEach(c=>{i.has(c)||a.push(c)}),this.syncEngine.Mr(o,a).then(()=>{this.sr=r})}mr(e){this.sr.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}gr(e){let n=ep();return e.forEach((r,s)=>{n=n.unionWith(s.activeTargetIds)}),n}}class lP{constructor(){this.Fr=new Hm,this.$r={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e){return this.Fr.Xi(e),this.$r[e]||"not-current"}updateQueryState(e,n,r){this.$r[e]=n}removeLocalQueryTarget(e){this.Fr.Zi(e)}isLocalQueryTarget(e){return this.Fr.activeTargetIds.has(e)}clearQueryState(e){delete this.$r[e]}getAllActiveQueryTargets(){return this.Fr.activeTargetIds}isActiveQueryTarget(e){return this.Fr.activeTargetIds.has(e)}start(){return this.Fr=new Hm,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class w6{Br(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cT{constructor(){this.Lr=()=>this.Ur(),this.qr=()=>this.Kr(),this.Gr=[],this.Qr()}Br(e){this.Gr.push(e)}shutdown(){window.removeEventListener("online",this.Lr),window.removeEventListener("offline",this.qr)}Qr(){window.addEventListener("online",this.Lr),window.addEventListener("offline",this.qr)}Ur(){R("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.Gr)e(0)}Kr(){R("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.Gr)e(1)}static V(){return typeof window!="undefined"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const b6={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class I6{constructor(e){this.jr=e.jr,this.Wr=e.Wr}zr(e){this.Hr=e}Jr(e){this.Yr=e}onMessage(e){this.Xr=e}close(){this.Wr()}send(e){this.jr(e)}Zr(){this.Hr()}eo(e){this.Yr(e)}no(e){this.Xr(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class E6 extends class{constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const n=e.ssl?"https":"http";this.so=n+"://"+e.host,this.io="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}ro(e,n,r,s,i){const o=this.oo(e,n);R("RestConnection","Sending: ",o,r);const a={};return this.uo(a,s,i),this.co(e,o,a,r).then(c=>(R("RestConnection","Received: ",c),c),c=>{throw Bl("RestConnection",`${e} failed with error: `,c,"url: ",o,"request:",r),c})}ao(e,n,r,s,i,o){return this.ro(e,n,r,s,i)}uo(e,n,r){e["X-Goog-Api-Client"]="gl-js/ fire/"+Za,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((s,i)=>e[i]=s),r&&r.headers.forEach((s,i)=>e[i]=s)}oo(e,n){const r=b6[e];return`${this.so}/v1/${n}:${r}`}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams}co(e,n,r,s){return new Promise((i,o)=>{const a=new w2;a.listenOnce(_2.COMPLETE,()=>{try{switch(a.getLastErrorCode()){case rg.NO_ERROR:const l=a.getResponseJson();R("Connection","XHR received:",JSON.stringify(l)),i(l);break;case rg.TIMEOUT:R("Connection",'RPC "'+e+'" timed out'),o(new S(w.DEADLINE_EXCEEDED,"Request time out"));break;case rg.HTTP_ERROR:const u=a.getStatus();if(R("Connection",'RPC "'+e+'" failed with status:',u,"response text:",a.getResponseText()),u>0){const h=a.getResponseJson().error;if(h&&h.status&&h.message){const d=function(f){const p=f.toLowerCase().replace(/_/g,"-");return Object.values(w).indexOf(p)>=0?p:w.UNKNOWN}(h.status);o(new S(d,h.message))}else o(new S(w.UNKNOWN,"Server responded with status "+a.getStatus()))}else o(new S(w.UNAVAILABLE,"Connection failed."));break;default:W()}}finally{R("Connection",'RPC "'+e+'" completed.')}});const c=JSON.stringify(s);a.send(n,"POST",c,r,15)})}ho(e,n,r){const s=[this.so,"/","google.firestore.v1.Firestore","/",e,"/channel"],i=g2(),o=m2(),a={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.useFetchStreams&&(a.xmlHttpFactory=new v2({})),this.uo(a.initMessageHeaders,n,r),Zd()||ou()||kL()||x_()||RL()||iu()||(a.httpHeadersOverwriteParam="$httpHeaders");const c=s.join("");R("Connection","Creating WebChannel: "+c,a);const l=i.createWebChannel(c,a);let u=!1,h=!1;const d=new I6({jr:p=>{h?R("Connection","Not sending because WebChannel is closed:",p):(u||(R("Connection","Opening WebChannel transport."),l.open(),u=!0),R("Connection","WebChannel sending:",p),l.send(p))},Wr:()=>l.close()}),f=(p,_,y)=>{p.listen(_,I=>{try{y(I)}catch(N){setTimeout(()=>{throw N},0)}})};return f(l,rh.EventType.OPEN,()=>{h||R("Connection","WebChannel transport opened.")}),f(l,rh.EventType.CLOSE,()=>{h||(h=!0,R("Connection","WebChannel transport closed"),d.eo())}),f(l,rh.EventType.ERROR,p=>{h||(h=!0,Bl("Connection","WebChannel transport errored:",p),d.eo(new S(w.UNAVAILABLE,"The operation could not be completed")))}),f(l,rh.EventType.MESSAGE,p=>{var _;if(!h){const y=p.data[0];se(!!y);const I=y,N=I.error||((_=I[0])===null||_===void 0?void 0:_.error);if(N){R("Connection","WebChannel received error:",N);const k=N.status;let M=function(Y){const z=ht[Y];if(z!==void 0)return CN(z)}(k),j=N.message;M===void 0&&(M=w.INTERNAL,j="Unknown error status: "+k+" with message "+N.message),h=!0,d.eo(new S(M,j)),l.close()}else R("Connection","WebChannel received:",y),d.no(y)}}),f(o,y2.STAT_EVENT,p=>{p.stat===vE.PROXY?R("Connection","Detected buffering proxy"):p.stat===vE.NOPROXY&&R("Connection","Detected no buffering proxy")}),setTimeout(()=>{d.Zr()},0),d}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uP(){return typeof window!="undefined"?window:null}function Rh(){return typeof document!="undefined"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fu(t){return new p4(t,!0)}class Fv{constructor(e,n,r=1e3,s=1.5,i=6e4){this.js=e,this.timerId=n,this.lo=r,this.fo=s,this._o=i,this.wo=0,this.mo=null,this.yo=Date.now(),this.reset()}reset(){this.wo=0}po(){this.wo=this._o}Io(e){this.cancel();const n=Math.floor(this.wo+this.To()),r=Math.max(0,Date.now()-this.yo),s=Math.max(0,n-r);s>0&&R("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.wo} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.mo=this.js.enqueueAfterDelay(this.timerId,s,()=>(this.yo=Date.now(),e())),this.wo*=this.fo,this.wo<this.lo&&(this.wo=this.lo),this.wo>this._o&&(this.wo=this._o)}Eo(){this.mo!==null&&(this.mo.skipDelay(),this.mo=null)}cancel(){this.mo!==null&&(this.mo.cancel(),this.mo=null)}To(){return(Math.random()-.5)*this.wo}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hP{constructor(e,n,r,s,i,o,a,c){this.js=e,this.Ao=r,this.Ro=s,this.bo=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=c,this.state=0,this.Po=0,this.vo=null,this.Vo=null,this.stream=null,this.So=new Fv(e,n)}Do(){return this.state===1||this.state===5||this.Co()}Co(){return this.state===2||this.state===3}start(){this.state!==4?this.auth():this.xo()}async stop(){this.Do()&&await this.close(0)}No(){this.state=0,this.So.reset()}ko(){this.Co()&&this.vo===null&&(this.vo=this.js.enqueueAfterDelay(this.Ao,6e4,()=>this.Oo()))}Mo(e){this.Fo(),this.stream.send(e)}async Oo(){if(this.Co())return this.close(0)}Fo(){this.vo&&(this.vo.cancel(),this.vo=null)}$o(){this.Vo&&(this.Vo.cancel(),this.Vo=null)}async close(e,n){this.Fo(),this.$o(),this.So.cancel(),this.Po++,e!==4?this.So.reset():n&&n.code===w.RESOURCE_EXHAUSTED?(dt(n.toString()),dt("Using maximum backoff delay to prevent overloading the backend."),this.So.po()):n&&n.code===w.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.Bo(),this.stream.close(),this.stream=null),this.state=e,await this.listener.Jr(n)}Bo(){}auth(){this.state=1;const e=this.Lo(this.Po),n=this.Po;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,s])=>{this.Po===n&&this.Uo(r,s)},r=>{e(()=>{const s=new S(w.UNKNOWN,"Fetching auth token failed: "+r.message);return this.qo(s)})})}Uo(e,n){const r=this.Lo(this.Po);this.stream=this.Ko(e,n),this.stream.zr(()=>{r(()=>(this.state=2,this.Vo=this.js.enqueueAfterDelay(this.Ro,1e4,()=>(this.Co()&&(this.state=3),Promise.resolve())),this.listener.zr()))}),this.stream.Jr(s=>{r(()=>this.qo(s))}),this.stream.onMessage(s=>{r(()=>this.onMessage(s))})}xo(){this.state=5,this.So.Io(async()=>{this.state=0,this.start()})}qo(e){return R("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}Lo(e){return n=>{this.js.enqueueAndForget(()=>this.Po===e?n():(R("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class T6 extends hP{constructor(e,n,r,s,i,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,s,o),this.wt=i}Ko(e,n){return this.bo.ho("Listen",e,n)}onMessage(e){this.So.reset();const n=_4(this.wt,e),r=function(s){if(!("targetChange"in s))return re.min();const i=s.targetChange;return i.targetIds&&i.targetIds.length?re.min():i.readTime?kt(i.readTime):re.min()}(e);return this.listener.Go(n,r)}Qo(e){const n={};n.database=Ql(this.wt),n.addTarget=function(s,i){let o;const a=i.target;return o=bd(a)?{documents:FN(s,a)}:{query:UN(s,a)},o.targetId=i.targetId,i.resumeToken.approximateByteSize()>0?o.resumeToken=DN(s,i.resumeToken):i.snapshotVersion.compareTo(re.min())>0&&(o.readTime=Gl(s,i.snapshotVersion.toTimestamp())),o}(this.wt,e);const r=v4(this.wt,e);r&&(n.labels=r),this.Mo(n)}jo(e){const n={};n.database=Ql(this.wt),n.removeTarget=e,this.Mo(n)}}class S6 extends hP{constructor(e,n,r,s,i,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,s,o),this.wt=i,this.Wo=!1}get zo(){return this.Wo}start(){this.Wo=!1,this.lastStreamToken=void 0,super.start()}Bo(){this.Wo&&this.Ho([])}Ko(e,n){return this.bo.ho("Write",e,n)}onMessage(e){if(se(!!e.streamToken),this.lastStreamToken=e.streamToken,this.Wo){this.So.reset();const n=y4(e.writeResults,e.commitTime),r=kt(e.commitTime);return this.listener.Jo(r,n)}return se(!e.writeResults||e.writeResults.length===0),this.Wo=!0,this.listener.Yo()}Xo(){const e={};e.database=Ql(this.wt),this.Mo(e)}Ho(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>Yl(this.wt,r))};this.Mo(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C6 extends class{}{constructor(e,n,r,s){super(),this.authCredentials=e,this.appCheckCredentials=n,this.bo=r,this.wt=s,this.Zo=!1}tu(){if(this.Zo)throw new S(w.FAILED_PRECONDITION,"The client has already been terminated.")}ro(e,n,r){return this.tu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,i])=>this.bo.ro(e,n,r,s,i)).catch(s=>{throw s.name==="FirebaseError"?(s.code===w.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new S(w.UNKNOWN,s.toString())})}ao(e,n,r,s){return this.tu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.bo.ao(e,n,r,i,o,s)).catch(i=>{throw i.name==="FirebaseError"?(i.code===w.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new S(w.UNKNOWN,i.toString())})}terminate(){this.Zo=!0}}class A6{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.eu=0,this.nu=null,this.su=!0}iu(){this.eu===0&&(this.ru("Unknown"),this.nu=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.nu=null,this.ou("Backend didn't respond within 10 seconds."),this.ru("Offline"),Promise.resolve())))}uu(e){this.state==="Online"?this.ru("Unknown"):(this.eu++,this.eu>=1&&(this.cu(),this.ou(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ru("Offline")))}set(e){this.cu(),this.eu=0,e==="Online"&&(this.su=!1),this.ru(e)}ru(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}ou(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.su?(dt(n),this.su=!1):R("OnlineStateTracker",n)}cu(){this.nu!==null&&(this.nu.cancel(),this.nu=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k6{constructor(e,n,r,s,i){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.au=[],this.hu=new Map,this.lu=new Set,this.fu=[],this.du=i,this.du.Br(o=>{r.enqueueAndForget(async()=>{di(this)&&(R("RemoteStore","Restarting streams for network reachability change."),await async function(a){const c=B(a);c.lu.add(4),await rc(c),c._u.set("Unknown"),c.lu.delete(4),await Uu(c)}(this))})}),this._u=new A6(r,s)}}async function Uu(t){if(di(t))for(const e of t.fu)await e(!0)}async function rc(t){for(const e of t.fu)await e(!1)}function sp(t,e){const n=B(t);n.hu.has(e.targetId)||(n.hu.set(e.targetId,e),Vv(n)?$v(n):ic(n).Co()&&Uv(n,e))}function Jl(t,e){const n=B(t),r=ic(n);n.hu.delete(e),r.Co()&&dP(n,e),n.hu.size===0&&(r.Co()?r.ko():di(n)&&n._u.set("Unknown"))}function Uv(t,e){t.wu.Nt(e.targetId),ic(t).Qo(e)}function dP(t,e){t.wu.Nt(e),ic(t).jo(e)}function $v(t){t.wu=new h4({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),te:e=>t.hu.get(e)||null}),ic(t).start(),t._u.iu()}function Vv(t){return di(t)&&!ic(t).Do()&&t.hu.size>0}function di(t){return B(t).lu.size===0}function fP(t){t.wu=void 0}async function R6(t){t.hu.forEach((e,n)=>{Uv(t,e)})}async function N6(t,e){fP(t),Vv(t)?(t._u.uu(e),$v(t)):t._u.set("Unknown")}async function P6(t,e,n){if(t._u.set("Online"),e instanceof PN&&e.state===2&&e.cause)try{await async function(r,s){const i=s.cause;for(const o of s.targetIds)r.hu.has(o)&&(await r.remoteSyncer.rejectListen(o,i),r.hu.delete(o),r.wu.removeTarget(o))}(t,e)}catch(r){R("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),await kd(t,r)}else if(e instanceof Ah?t.wu.Ut(e):e instanceof NN?t.wu.zt(e):t.wu.Gt(e),!n.isEqual(re.min()))try{const r=await sP(t.localStore);n.compareTo(r)>=0&&await function(s,i){const o=s.wu.Yt(i);return o.targetChanges.forEach((a,c)=>{if(a.resumeToken.approximateByteSize()>0){const l=s.hu.get(c);l&&s.hu.set(c,l.withResumeToken(a.resumeToken,i))}}),o.targetMismatches.forEach(a=>{const c=s.hu.get(a);if(!c)return;s.hu.set(a,c.withResumeToken(_t.EMPTY_BYTE_STRING,c.snapshotVersion)),dP(s,a);const l=new Bs(c.target,a,1,c.sequenceNumber);Uv(s,l)}),s.remoteSyncer.applyRemoteEvent(o)}(t,n)}catch(r){R("RemoteStore","Failed to raise snapshot:",r),await kd(t,r)}}async function kd(t,e,n){if(!ui(e))throw e;t.lu.add(1),await rc(t),t._u.set("Offline"),n||(n=()=>sP(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{R("RemoteStore","Retrying IndexedDB access"),await n(),t.lu.delete(1),await Uu(t)})}function pP(t,e){return e().catch(n=>kd(t,n,e))}async function sc(t){const e=B(t),n=ni(e);let r=e.au.length>0?e.au[e.au.length-1].batchId:-1;for(;D6(e);)try{const s=await _6(e.localStore,r);if(s===null){e.au.length===0&&n.ko();break}r=s.batchId,x6(e,s)}catch(s){await kd(e,s)}gP(e)&&mP(e)}function D6(t){return di(t)&&t.au.length<10}function x6(t,e){t.au.push(e);const n=ni(t);n.Co()&&n.zo&&n.Ho(e.mutations)}function gP(t){return di(t)&&!ni(t).Do()&&t.au.length>0}function mP(t){ni(t).start()}async function O6(t){ni(t).Xo()}async function M6(t){const e=ni(t);for(const n of t.au)e.Ho(n.mutations)}async function L6(t,e,n){const r=t.au.shift(),s=kv.from(r,e,n);await pP(t,()=>t.remoteSyncer.applySuccessfulWrite(s)),await sc(t)}async function F6(t,e){e&&ni(t).zo&&await async function(n,r){if(s=r.code,SN(s)&&s!==w.ABORTED){const i=n.au.shift();ni(n).No(),await pP(n,()=>n.remoteSyncer.rejectFailedWrite(i.batchId,r)),await sc(n)}var s}(t,e),gP(t)&&mP(t)}async function lT(t,e){const n=B(t);n.asyncQueue.verifyOperationInProgress(),R("RemoteStore","RemoteStore received new credentials");const r=di(n);n.lu.add(3),await rc(n),r&&n._u.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.lu.delete(3),await Uu(n)}async function Gm(t,e){const n=B(t);e?(n.lu.delete(2),await Uu(n)):e||(n.lu.add(2),await rc(n),n._u.set("Unknown"))}function ic(t){return t.mu||(t.mu=function(e,n,r){const s=B(e);return s.tu(),new T6(n,s.bo,s.authCredentials,s.appCheckCredentials,s.wt,r)}(t.datastore,t.asyncQueue,{zr:R6.bind(null,t),Jr:N6.bind(null,t),Go:P6.bind(null,t)}),t.fu.push(async e=>{e?(t.mu.No(),Vv(t)?$v(t):t._u.set("Unknown")):(await t.mu.stop(),fP(t))})),t.mu}function ni(t){return t.gu||(t.gu=function(e,n,r){const s=B(e);return s.tu(),new S6(n,s.bo,s.authCredentials,s.appCheckCredentials,s.wt,r)}(t.datastore,t.asyncQueue,{zr:O6.bind(null,t),Jr:F6.bind(null,t),Yo:M6.bind(null,t),Jo:L6.bind(null,t)}),t.fu.push(async e=>{e?(t.gu.No(),await sc(t)):(await t.gu.stop(),t.au.length>0&&(R("RemoteStore",`Stopping write stream with ${t.au.length} pending writes`),t.au=[]))})),t.gu}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bv{constructor(e,n,r,s,i){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=s,this.removalCallback=i,this.deferred=new At,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}static createAndSchedule(e,n,r,s,i){const o=Date.now()+r,a=new Bv(e,n,o,s,i);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new S(w.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function oc(t,e){if(dt("AsyncQueue",`${e}: ${t}`),ui(t))return new S(w.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ca{constructor(e){this.comparator=e?(n,r)=>e(n,r)||F.comparator(n.key,r.key):(n,r)=>F.comparator(n.key,r.key),this.keyedMap=Pc(),this.sortedSet=new rt(this.comparator)}static emptySet(e){return new ca(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof ca)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new ca;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uT{constructor(){this.yu=new rt(F.comparator)}track(e){const n=e.doc.key,r=this.yu.get(n);r?e.type!==0&&r.type===3?this.yu=this.yu.insert(n,e):e.type===3&&r.type!==1?this.yu=this.yu.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.yu=this.yu.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.yu=this.yu.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.yu=this.yu.remove(n):e.type===1&&r.type===2?this.yu=this.yu.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.yu=this.yu.insert(n,{type:2,doc:e.doc}):W():this.yu=this.yu.insert(n,e)}pu(){const e=[];return this.yu.inorderTraversal((n,r)=>{e.push(r)}),e}}class xa{constructor(e,n,r,s,i,o,a,c){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=c}static fromInitialDocuments(e,n,r,s){const i=[];return n.forEach(o=>{i.push({type:0,doc:o})}),new xa(e,n,ca.emptySet(n),i,r,s,!0,!1)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&xu(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let s=0;s<n.length;s++)if(n[s].type!==r[s].type||!n[s].doc.isEqual(r[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U6{constructor(){this.Iu=void 0,this.listeners=[]}}class $6{constructor(){this.queries=new hi(e=>fN(e),xu),this.onlineState="Unknown",this.Tu=new Set}}async function qv(t,e){const n=B(t),r=e.query;let s=!1,i=n.queries.get(r);if(i||(s=!0,i=new U6),s)try{i.Iu=await n.onListen(r)}catch(o){const a=oc(o,`Initialization of query '${qm(e.query)}' failed`);return void e.onError(a)}n.queries.set(r,i),i.listeners.push(e),e.Eu(n.onlineState),i.Iu&&e.Au(i.Iu)&&Kv(n)}async function jv(t,e){const n=B(t),r=e.query;let s=!1;const i=n.queries.get(r);if(i){const o=i.listeners.indexOf(e);o>=0&&(i.listeners.splice(o,1),s=i.listeners.length===0)}if(s)return n.queries.delete(r),n.onUnlisten(r)}function V6(t,e){const n=B(t);let r=!1;for(const s of e){const i=s.query,o=n.queries.get(i);if(o){for(const a of o.listeners)a.Au(s)&&(r=!0);o.Iu=s}}r&&Kv(n)}function B6(t,e,n){const r=B(t),s=r.queries.get(e);if(s)for(const i of s.listeners)i.onError(n);r.queries.delete(e)}function Kv(t){t.Tu.forEach(e=>{e.next()})}class Wv{constructor(e,n,r){this.query=e,this.Ru=n,this.bu=!1,this.Pu=null,this.onlineState="Unknown",this.options=r||{}}Au(e){if(!this.options.includeMetadataChanges){const r=[];for(const s of e.docChanges)s.type!==3&&r.push(s);e=new xa(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0)}let n=!1;return this.bu?this.vu(e)&&(this.Ru.next(e),n=!0):this.Vu(e,this.onlineState)&&(this.Su(e),n=!0),this.Pu=e,n}onError(e){this.Ru.error(e)}Eu(e){this.onlineState=e;let n=!1;return this.Pu&&!this.bu&&this.Vu(this.Pu,e)&&(this.Su(this.Pu),n=!0),n}Vu(e,n){if(!e.fromCache)return!0;const r=n!=="Offline";return(!this.options.Du||!r)&&(!e.docs.isEmpty()||n==="Offline")}vu(e){if(e.docChanges.length>0)return!0;const n=this.Pu&&this.Pu.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}Su(e){e=xa.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache),this.bu=!0,this.Ru.next(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q6{constructor(e,n){this.payload=e,this.byteLength=n}Cu(){return"metadata"in this.payload}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hT{constructor(e){this.wt=e}Wi(e){return kr(this.wt,e)}zi(e){return e.metadata.exists?LN(this.wt,e.document,!1):Be.newNoDocument(this.Wi(e.metadata.name),this.Hi(e.metadata.readTime))}Hi(e){return kt(e)}}class j6{constructor(e,n,r){this.xu=e,this.localStore=n,this.wt=r,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=_P(e)}Nu(e){this.progress.bytesLoaded+=e.byteLength;let n=this.progress.documentsLoaded;if(e.payload.namedQuery)this.queries.push(e.payload.namedQuery);else if(e.payload.documentMetadata){this.documents.push({metadata:e.payload.documentMetadata}),e.payload.documentMetadata.exists||++n;const r=we.fromString(e.payload.documentMetadata.name);this.collectionGroups.add(r.get(r.length-2))}else e.payload.document&&(this.documents[this.documents.length-1].document=e.payload.document,++n);return n!==this.progress.documentsLoaded?(this.progress.documentsLoaded=n,Object.assign({},this.progress)):null}ku(e){const n=new Map,r=new hT(this.wt);for(const s of e)if(s.metadata.queries){const i=r.Wi(s.metadata.name);for(const o of s.metadata.queries){const a=(n.get(o)||ue()).add(i);n.set(o,a)}}return n}async complete(){const e=await y6(this.localStore,new hT(this.wt),this.documents,this.xu.id),n=this.ku(this.documents);for(const r of this.queries)await v6(this.localStore,r,n.get(r.name));return this.progress.taskState="Success",{progress:this.progress,Ou:this.collectionGroups,Mu:e}}}function _P(t){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:t.totalDocuments,totalBytes:t.totalBytes}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yP{constructor(e){this.key=e}}class vP{constructor(e){this.key=e}}class wP{constructor(e,n){this.query=e,this.Fu=n,this.$u=null,this.current=!1,this.Bu=ue(),this.mutatedKeys=ue(),this.Lu=gN(e),this.Uu=new ca(this.Lu)}get qu(){return this.Fu}Ku(e,n){const r=n?n.Gu:new uT,s=n?n.Uu:this.Uu;let i=n?n.mutatedKeys:this.mutatedKeys,o=s,a=!1;const c=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,l=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((u,h)=>{const d=s.get(u),f=Tv(this.query,h)?h:null,p=!!d&&this.mutatedKeys.has(d.key),_=!!f&&(f.hasLocalMutations||this.mutatedKeys.has(f.key)&&f.hasCommittedMutations);let y=!1;d&&f?d.data.isEqual(f.data)?p!==_&&(r.track({type:3,doc:f}),y=!0):this.Qu(d,f)||(r.track({type:2,doc:f}),y=!0,(c&&this.Lu(f,c)>0||l&&this.Lu(f,l)<0)&&(a=!0)):!d&&f?(r.track({type:0,doc:f}),y=!0):d&&!f&&(r.track({type:1,doc:d}),y=!0,(c||l)&&(a=!0)),y&&(f?(o=o.add(f),i=_?i.add(u):i.delete(u)):(o=o.delete(u),i=i.delete(u)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const u=this.query.limitType==="F"?o.last():o.first();o=o.delete(u.key),i=i.delete(u.key),r.track({type:1,doc:u})}return{Uu:o,Gu:r,Oi:a,mutatedKeys:i}}Qu(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r){const s=this.Uu;this.Uu=e.Uu,this.mutatedKeys=e.mutatedKeys;const i=e.Gu.pu();i.sort((l,u)=>function(h,d){const f=p=>{switch(p){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return W()}};return f(h)-f(d)}(l.type,u.type)||this.Lu(l.doc,u.doc)),this.ju(r);const o=n?this.Wu():[],a=this.Bu.size===0&&this.current?1:0,c=a!==this.$u;return this.$u=a,i.length!==0||c?{snapshot:new xa(this.query,e.Uu,s,i,e.mutatedKeys,a===0,c,!1),zu:o}:{zu:o}}Eu(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Uu:this.Uu,Gu:new uT,mutatedKeys:this.mutatedKeys,Oi:!1},!1)):{zu:[]}}Hu(e){return!this.Fu.has(e)&&!!this.Uu.has(e)&&!this.Uu.get(e).hasLocalMutations}ju(e){e&&(e.addedDocuments.forEach(n=>this.Fu=this.Fu.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Fu=this.Fu.delete(n)),this.current=e.current)}Wu(){if(!this.current)return[];const e=this.Bu;this.Bu=ue(),this.Uu.forEach(r=>{this.Hu(r.key)&&(this.Bu=this.Bu.add(r.key))});const n=[];return e.forEach(r=>{this.Bu.has(r)||n.push(new vP(r))}),this.Bu.forEach(r=>{e.has(r)||n.push(new yP(r))}),n}Ju(e){this.Fu=e.ji,this.Bu=ue();const n=this.Ku(e.documents);return this.applyChanges(n,!0)}Yu(){return xa.fromInitialDocuments(this.query,this.Uu,this.mutatedKeys,this.$u===0)}}class K6{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class W6{constructor(e){this.key=e,this.Xu=!1}}class H6{constructor(e,n,r,s,i,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.Zu={},this.tc=new hi(a=>fN(a),xu),this.ec=new Map,this.nc=new Set,this.sc=new rt(F.comparator),this.ic=new Map,this.rc=new Dv,this.oc={},this.uc=new Map,this.cc=go.Rn(),this.onlineState="Unknown",this.ac=void 0}get isPrimaryClient(){return this.ac===!0}}async function G6(t,e){const n=Yv(t);let r,s;const i=n.tc.get(e);if(i)r=i.targetId,n.sharedClientState.addLocalQueryTarget(r),s=i.view.Yu();else{const o=await Pa(n.localStore,Qn(e));n.isPrimaryClient&&sp(n.remoteStore,o);const a=n.sharedClientState.addLocalQueryTarget(o.targetId);r=o.targetId,s=await Hv(n,e,r,a==="current")}return s}async function Hv(t,e,n,r){t.hc=(u,h,d)=>async function(f,p,_,y){let I=p.view.Ku(_);I.Oi&&(I=await Sd(f.localStore,p.query,!1).then(({documents:M})=>p.view.Ku(M,I)));const N=y&&y.targetChanges.get(p.targetId),k=p.view.applyChanges(I,f.isPrimaryClient,N);return zm(f,p.targetId,k.zu),k.snapshot}(t,u,h,d);const s=await Sd(t.localStore,e,!0),i=new wP(e,s.ji),o=i.Ku(s.documents),a=Lu.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline"),c=i.applyChanges(o,t.isPrimaryClient,a);zm(t,n,c.zu);const l=new K6(e,n,i);return t.tc.set(e,l),t.ec.has(n)?t.ec.get(n).push(e):t.ec.set(n,[e]),c.snapshot}async function z6(t,e){const n=B(t),r=n.tc.get(e),s=n.ec.get(r.targetId);if(s.length>1)return n.ec.set(r.targetId,s.filter(i=>!xu(i,e))),void n.tc.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(r.targetId),n.sharedClientState.isActiveQueryTarget(r.targetId)||await Da(n.localStore,r.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(r.targetId),Jl(n.remoteStore,r.targetId),Oa(n,r.targetId)}).catch(li)):(Oa(n,r.targetId),await Da(n.localStore,r.targetId,!0))}async function Q6(t,e,n){const r=Jv(t);try{const s=await function(i,o){const a=B(i),c=ze.now(),l=o.reduce((d,f)=>d.add(f.key),ue());let u,h;return a.persistence.runTransaction("Locally write mutations","readwrite",d=>{let f=wn(),p=ue();return a.Ui.getEntries(d,l).next(_=>{f=_,f.forEach((y,I)=>{I.isValidDocument()||(p=p.add(y))})}).next(()=>a.localDocuments.getOverlayedDocuments(d,f)).next(_=>{u=_;const y=[];for(const I of o){const N=i4(I,u.get(I.key).overlayedDocument);N!=null&&y.push(new fs(I.key,N,lN(N.value.mapValue),Ye.exists(!0)))}return a.mutationQueue.addMutationBatch(d,c,y,o)}).next(_=>{h=_;const y=_.applyToLocalDocumentSet(u,p);return a.documentOverlayCache.saveOverlays(d,_.batchId,y)})}).then(()=>({batchId:h.batchId,changes:kN(u)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(s.batchId),function(i,o,a){let c=i.oc[i.currentUser.toKey()];c||(c=new rt(ce)),c=c.insert(o,a),i.oc[i.currentUser.toKey()]=c}(r,s.batchId,n),await ps(r,s.changes),await sc(r.remoteStore)}catch(s){const i=oc(s,"Failed to persist write");n.reject(i)}}async function bP(t,e){const n=B(t);try{const r=await m6(n.localStore,e);e.targetChanges.forEach((s,i)=>{const o=n.ic.get(i);o&&(se(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1),s.addedDocuments.size>0?o.Xu=!0:s.modifiedDocuments.size>0?se(o.Xu):s.removedDocuments.size>0&&(se(o.Xu),o.Xu=!1))}),await ps(n,r,e)}catch(r){await li(r)}}function dT(t,e,n){const r=B(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const s=[];r.tc.forEach((i,o)=>{const a=o.view.Eu(e);a.snapshot&&s.push(a.snapshot)}),function(i,o){const a=B(i);a.onlineState=o;let c=!1;a.queries.forEach((l,u)=>{for(const h of u.listeners)h.Eu(o)&&(c=!0)}),c&&Kv(a)}(r.eventManager,e),s.length&&r.Zu.Go(s),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function Y6(t,e,n){const r=B(t);r.sharedClientState.updateQueryState(e,"rejected",n);const s=r.ic.get(e),i=s&&s.key;if(i){let o=new rt(F.comparator);o=o.insert(i,Be.newNoDocument(i,re.min()));const a=ue().add(i),c=new Mu(re.min(),new Map,new Ae(ce),o,a);await bP(r,c),r.sc=r.sc.remove(i),r.ic.delete(e),Qv(r)}else await Da(r.localStore,e,!1).then(()=>Oa(r,e,n)).catch(li)}async function J6(t,e){const n=B(t),r=e.batch.batchId;try{const s=await g6(n.localStore,e);zv(n,r,null),Gv(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await ps(n,s)}catch(s){await li(s)}}async function X6(t,e,n){const r=B(t);try{const s=await function(i,o){const a=B(i);return a.persistence.runTransaction("Reject batch","readwrite-primary",c=>{let l;return a.mutationQueue.lookupMutationBatch(c,o).next(u=>(se(u!==null),l=u.keys(),a.mutationQueue.removeMutationBatch(c,u))).next(()=>a.mutationQueue.performConsistencyCheck(c)).next(()=>a.documentOverlayCache.removeOverlaysForBatchId(c,l,o)).next(()=>a.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(c,l)).next(()=>a.localDocuments.getDocuments(c,l))})}(r.localStore,e);zv(r,e,n),Gv(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await ps(r,s)}catch(s){await li(s)}}async function Z6(t,e){const n=B(t);di(n.remoteStore)||R("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{const r=await function(i){const o=B(i);return o.persistence.runTransaction("Get highest unacknowledged batch id","readonly",a=>o.mutationQueue.getHighestUnacknowledgedBatchId(a))}(n.localStore);if(r===-1)return void e.resolve();const s=n.uc.get(r)||[];s.push(e),n.uc.set(r,s)}catch(r){const s=oc(r,"Initialization of waitForPendingWrites() operation failed");e.reject(s)}}function Gv(t,e){(t.uc.get(e)||[]).forEach(n=>{n.resolve()}),t.uc.delete(e)}function zv(t,e,n){const r=B(t);let s=r.oc[r.currentUser.toKey()];if(s){const i=s.get(e);i&&(n?i.reject(n):i.resolve(),s=s.remove(e)),r.oc[r.currentUser.toKey()]=s}}function Oa(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.ec.get(e))t.tc.delete(r),n&&t.Zu.lc(r,n);t.ec.delete(e),t.isPrimaryClient&&t.rc.us(e).forEach(r=>{t.rc.containsKey(r)||IP(t,r)})}function IP(t,e){t.nc.delete(e.path.canonicalString());const n=t.sc.get(e);n!==null&&(Jl(t.remoteStore,n),t.sc=t.sc.remove(e),t.ic.delete(n),Qv(t))}function zm(t,e,n){for(const r of n)r instanceof yP?(t.rc.addReference(r.key,e),eQ(t,r)):r instanceof vP?(R("SyncEngine","Document no longer in limbo: "+r.key),t.rc.removeReference(r.key,e),t.rc.containsKey(r.key)||IP(t,r.key)):W()}function eQ(t,e){const n=e.key,r=n.path.canonicalString();t.sc.get(n)||t.nc.has(r)||(R("SyncEngine","New document in limbo: "+n),t.nc.add(r),Qv(t))}function Qv(t){for(;t.nc.size>0&&t.sc.size<t.maxConcurrentLimboResolutions;){const e=t.nc.values().next().value;t.nc.delete(e);const n=new F(we.fromString(e)),r=t.cc.next();t.ic.set(r,new W6(n)),t.sc=t.sc.insert(n,r),sp(t.remoteStore,new Bs(Qn(ec(n.path)),r,2,vn.ot))}}async function ps(t,e,n){const r=B(t),s=[],i=[],o=[];r.tc.isEmpty()||(r.tc.forEach((a,c)=>{o.push(r.hc(c,e,n).then(l=>{if(l){r.isPrimaryClient&&r.sharedClientState.updateQueryState(c.targetId,l.fromCache?"not-current":"current"),s.push(l);const u=Mv.Vi(c.targetId,l);i.push(u)}}))}),await Promise.all(o),r.Zu.Go(s),await async function(a,c){const l=B(a);try{await l.persistence.runTransaction("notifyLocalViewChanges","readwrite",u=>v.forEach(c,h=>v.forEach(h.Pi,d=>l.persistence.referenceDelegate.addReference(u,h.targetId,d)).next(()=>v.forEach(h.vi,d=>l.persistence.referenceDelegate.removeReference(u,h.targetId,d)))))}catch(u){if(!ui(u))throw u;R("LocalStore","Failed to update sequence numbers: "+u)}for(const u of c){const h=u.targetId;if(!u.fromCache){const d=l.$i.get(h),f=d.snapshotVersion,p=d.withLastLimboFreeSnapshotVersion(f);l.$i=l.$i.insert(h,p)}}}(r.localStore,i))}async function tQ(t,e){const n=B(t);if(!n.currentUser.isEqual(e)){R("SyncEngine","User change. New user:",e.toKey());const r=await rP(n.localStore,e);n.currentUser=e,function(s,i){s.uc.forEach(o=>{o.forEach(a=>{a.reject(new S(w.CANCELLED,i))})}),s.uc.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await ps(n,r.Ki)}}function nQ(t,e){const n=B(t),r=n.ic.get(e);if(r&&r.Xu)return ue().add(r.key);{let s=ue();const i=n.ec.get(e);if(!i)return s;for(const o of i){const a=n.tc.get(o);s=s.unionWith(a.view.qu)}return s}}async function rQ(t,e){const n=B(t),r=await Sd(n.localStore,e.query,!0),s=e.view.Ju(r);return n.isPrimaryClient&&zm(n,e.targetId,s.zu),s}async function sQ(t,e){const n=B(t);return aP(n.localStore,e).then(r=>ps(n,r))}async function iQ(t,e,n,r){const s=B(t),i=await function(o,a){const c=B(o),l=B(c.mutationQueue);return c.persistence.runTransaction("Lookup mutation documents","readonly",u=>l.yn(u,a).next(h=>h?c.localDocuments.getDocuments(u,h):v.resolve(null)))}(s.localStore,e);i!==null?(n==="pending"?await sc(s.remoteStore):n==="acknowledged"||n==="rejected"?(zv(s,e,r||null),Gv(s,e),function(o,a){B(B(o).mutationQueue).In(a)}(s.localStore,e)):W(),await ps(s,i)):R("SyncEngine","Cannot apply mutation batch with id: "+e)}async function oQ(t,e){const n=B(t);if(Yv(n),Jv(n),e===!0&&n.ac!==!0){const r=n.sharedClientState.getAllActiveQueryTargets(),s=await fT(n,r.toArray());n.ac=!0,await Gm(n.remoteStore,!0);for(const i of s)sp(n.remoteStore,i)}else if(e===!1&&n.ac!==!1){const r=[];let s=Promise.resolve();n.ec.forEach((i,o)=>{n.sharedClientState.isLocalQueryTarget(o)?r.push(o):s=s.then(()=>(Oa(n,o),Da(n.localStore,o,!0))),Jl(n.remoteStore,o)}),await s,await fT(n,r),function(i){const o=B(i);o.ic.forEach((a,c)=>{Jl(o.remoteStore,c)}),o.rc.cs(),o.ic=new Map,o.sc=new rt(F.comparator)}(n),n.ac=!1,await Gm(n.remoteStore,!1)}}async function fT(t,e,n){const r=B(t),s=[],i=[];for(const o of e){let a;const c=r.ec.get(o);if(c&&c.length!==0){a=await Pa(r.localStore,Qn(c[0]));for(const l of c){const u=r.tc.get(l),h=await rQ(r,u);h.snapshot&&i.push(h.snapshot)}}else{const l=await oP(r.localStore,o);a=await Pa(r.localStore,l),await Hv(r,EP(l),o,!1)}s.push(a)}return r.Zu.Go(i),s}function EP(t){return hN(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function aQ(t){const e=B(t);return B(B(e.localStore).persistence).Ri()}async function cQ(t,e,n,r){const s=B(t);if(s.ac)return void R("SyncEngine","Ignoring unexpected query state notification.");const i=s.ec.get(e);if(i&&i.length>0)switch(n){case"current":case"not-current":{const o=await aP(s.localStore,pN(i[0])),a=Mu.createSynthesizedRemoteEventForCurrentChange(e,n==="current");await ps(s,o,a);break}case"rejected":await Da(s.localStore,e,!0),Oa(s,e,r);break;default:W()}}async function lQ(t,e,n){const r=Yv(t);if(r.ac){for(const s of e){if(r.ec.has(s)){R("SyncEngine","Adding an already active target "+s);continue}const i=await oP(r.localStore,s),o=await Pa(r.localStore,i);await Hv(r,EP(i),o.targetId,!1),sp(r.remoteStore,o)}for(const s of n)r.ec.has(s)&&await Da(r.localStore,s,!1).then(()=>{Jl(r.remoteStore,s),Oa(r,s)}).catch(li)}}function Yv(t){const e=B(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=bP.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=nQ.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=Y6.bind(null,e),e.Zu.Go=V6.bind(null,e.eventManager),e.Zu.lc=B6.bind(null,e.eventManager),e}function Jv(t){const e=B(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=J6.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=X6.bind(null,e),e}function uQ(t,e,n){const r=B(t);(async function(s,i,o){try{const a=await i.getMetadata();if(await function(h,d){const f=B(h),p=kt(d.createTime);return f.persistence.runTransaction("hasNewerBundle","readonly",_=>f.Ds.getBundleMetadata(_,d.id)).then(_=>!!_&&_.createTime.compareTo(p)>=0)}(s.localStore,a))return await i.close(),o._completeWith(function(h){return{taskState:"Success",documentsLoaded:h.totalDocuments,bytesLoaded:h.totalBytes,totalDocuments:h.totalDocuments,totalBytes:h.totalBytes}}(a)),Promise.resolve(new Set);o._updateProgress(_P(a));const c=new j6(a,s.localStore,i.wt);let l=await i.fc();for(;l;){const h=await c.Nu(l);h&&o._updateProgress(h),l=await i.fc()}const u=await c.complete();return await ps(s,u.Mu,void 0),await function(h,d){const f=B(h);return f.persistence.runTransaction("Save bundle","readwrite",p=>f.Ds.saveBundleMetadata(p,d))}(s.localStore,a),o._completeWith(u.progress),Promise.resolve(u.Ou)}catch(a){return Bl("SyncEngine",`Loading bundle failed with ${a}`),o._failWith(a),Promise.resolve(new Set)}})(r,e,n).then(s=>{r.sharedClientState.notifyBundleLoaded(s)})}class TP{constructor(){this.synchronizeTabs=!1}async initialize(e){this.wt=Fu(e.databaseInfo.databaseId),this.sharedClientState=this.dc(e),this.persistence=this._c(e),await this.persistence.start(),this.localStore=this.wc(e),this.gcScheduler=this.mc(e,this.localStore),this.indexBackfillerScheduler=this.gc(e,this.localStore)}mc(e,n){return null}gc(e,n){return null}wc(e){return nP(this.persistence,new tP,e.initialUser,this.wt)}_c(e){return new eP(rp.Ms,this.wt)}dc(e){return new lP}async terminate(){this.gcScheduler&&this.gcScheduler.stop(),await this.sharedClientState.shutdown(),await this.persistence.shutdown()}}class SP extends TP{constructor(e,n,r){super(),this.yc=e,this.cacheSizeBytes=n,this.forceOwnership=r,this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.yc.initialize(this,e),await Jv(this.yc.syncEngine),await sc(this.yc.remoteStore),await this.persistence.ci(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}wc(e){return nP(this.persistence,new tP,e.initialUser,this.wt)}mc(e,n){const r=this.persistence.referenceDelegate.garbageCollector;return new e6(r,e.asyncQueue,n)}gc(e,n){const r=new L2(n,this.persistence);return new M2(e.asyncQueue,r)}_c(e){const n=Ov(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?mn.withCacheSize(this.cacheSizeBytes):mn.DEFAULT;return new xv(this.synchronizeTabs,n,e.clientId,r,e.asyncQueue,uP(),Rh(),this.wt,this.sharedClientState,!!this.forceOwnership)}dc(e){return new lP}}class hQ extends SP{constructor(e,n){super(e,n,!1),this.yc=e,this.cacheSizeBytes=n,this.synchronizeTabs=!0}async initialize(e){await super.initialize(e);const n=this.yc.syncEngine;this.sharedClientState instanceof ag&&(this.sharedClientState.syncEngine={kr:iQ.bind(null,n),Or:cQ.bind(null,n),Mr:lQ.bind(null,n),Ri:aQ.bind(null,n),Nr:sQ.bind(null,n)},await this.sharedClientState.start()),await this.persistence.ci(async r=>{await oQ(this.yc.syncEngine,r),this.gcScheduler&&(r&&!this.gcScheduler.started?this.gcScheduler.start():r||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(r&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():r||this.indexBackfillerScheduler.stop())})}dc(e){const n=uP();if(!ag.V(n))throw new S(w.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const r=Ov(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new ag(n,e.asyncQueue,r,e.clientId,e.initialUser)}}class Xv{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>dT(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=tQ.bind(null,this.syncEngine),await Gm(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return new $6}createDatastore(e){const n=Fu(e.databaseInfo.databaseId),r=(s=e.databaseInfo,new E6(s));var s;return function(i,o,a,c){return new C6(i,o,a,c)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return n=this.localStore,r=this.datastore,s=e.asyncQueue,i=a=>dT(this.syncEngine,a,0),o=cT.V()?new cT:new w6,new k6(n,r,s,i,o);var n,r,s,i,o}createSyncEngine(e,n){return function(r,s,i,o,a,c,l){const u=new H6(r,s,i,o,a,c);return l&&(u.ac=!0),u}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}terminate(){return async function(e){const n=B(e);R("RemoteStore","RemoteStore shutting down."),n.lu.add(5),await rc(n),n.du.shutdown(),n._u.set("Unknown")}(this.remoteStore)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pT(t,e=10240){let n=0;return{async read(){if(n<t.byteLength){const r={value:t.slice(n,n+e),done:!1};return n+=e,r}return{done:!0}},async cancel(){},releaseLock(){},closed:Promise.reject("unimplemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ip{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Ic(this.observer.next,e)}error(e){this.observer.error?this.Ic(this.observer.error,e):console.error("Uncaught Error in snapshot listener:",e)}Tc(){this.muted=!0}Ic(e,n){this.muted||setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dQ{constructor(e,n){this.Ec=e,this.wt=n,this.metadata=new At,this.buffer=new Uint8Array,this.Ac=new TextDecoder("utf-8"),this.Rc().then(r=>{r&&r.Cu()?this.metadata.resolve(r.payload.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(r==null?void 0:r.payload)}`))},r=>this.metadata.reject(r))}close(){return this.Ec.cancel()}async getMetadata(){return this.metadata.promise}async fc(){return await this.getMetadata(),this.Rc()}async Rc(){const e=await this.bc();if(e===null)return null;const n=this.Ac.decode(e),r=Number(n);isNaN(r)&&this.Pc(`length string (${n}) is not valid number`);const s=await this.vc(r);return new q6(JSON.parse(s),e.length+r)}Vc(){return this.buffer.findIndex(e=>e==="{".charCodeAt(0))}async bc(){for(;this.Vc()<0&&!await this.Sc(););if(this.buffer.length===0)return null;const e=this.Vc();e<0&&this.Pc("Reached the end of bundle when a length string is expected.");const n=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),n}async vc(e){for(;this.buffer.length<e;)await this.Sc()&&this.Pc("Reached the end of bundle when more is expected.");const n=this.Ac.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),n}Pc(e){throw this.Ec.cancel(),new Error(`Invalid bundle format: ${e}`)}async Sc(){const e=await this.Ec.read();if(!e.done){const n=new Uint8Array(this.buffer.length+e.value.length);n.set(this.buffer),n.set(e.value,this.buffer.length),this.buffer=n}return e.done}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fQ{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastWriteError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw new S(w.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");const n=await async function(r,s){const i=B(r),o=Ql(i.wt)+"/documents",a={documents:s.map(h=>zl(i.wt,h))},c=await i.ao("BatchGetDocuments",o,a,s.length),l=new Map;c.forEach(h=>{const d=m4(i.wt,h);l.set(d.key.toString(),d)});const u=[];return s.forEach(h=>{const d=l.get(h.toString());se(!!d),u.push(d)}),u}(this.datastore,e);return n.forEach(r=>this.recordVersion(r)),n}set(e,n){this.write(n.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,n){try{this.write(n.toMutation(e,this.preconditionForUpdate(e)))}catch(r){this.lastWriteError=r}this.writtenDocs.add(e.toString())}delete(e){this.write(new nc(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastWriteError)throw this.lastWriteError;const e=this.readVersions;this.mutations.forEach(n=>{e.delete(n.key.toString())}),e.forEach((n,r)=>{const s=F.fromPath(r);this.mutations.push(new Sv(s,this.precondition(s)))}),await async function(n,r){const s=B(n),i=Ql(s.wt)+"/documents",o={writes:r.map(a=>Yl(s.wt,a))};await s.ro("Commit",i,o)}(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let n;if(e.isFoundDocument())n=e.version;else{if(!e.isNoDocument())throw W();n=re.min()}const r=this.readVersions.get(e.key.toString());if(r){if(!n.isEqual(r))throw new S(w.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),n)}precondition(e){const n=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&n?Ye.updateTime(n):Ye.none()}preconditionForUpdate(e){const n=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&n){if(n.isEqual(re.min()))throw new S(w.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Ye.updateTime(n)}return Ye.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pQ{constructor(e,n,r,s,i){this.asyncQueue=e,this.datastore=n,this.options=r,this.updateFunction=s,this.deferred=i,this.Dc=r.maxAttempts,this.So=new Fv(this.asyncQueue,"transaction_retry")}run(){this.Dc-=1,this.Cc()}Cc(){this.So.Io(async()=>{const e=new fQ(this.datastore),n=this.xc(e);n&&n.then(r=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(r)}).catch(s=>{this.Nc(s)}))}).catch(r=>{this.Nc(r)})})}xc(e){try{const n=this.updateFunction(e);return!Pu(n)&&n.catch&&n.then?n:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(n){return this.deferred.reject(n),null}}Nc(e){this.Dc>0&&this.kc(e)?(this.Dc-=1,this.asyncQueue.enqueueAndForget(()=>(this.Cc(),Promise.resolve()))):this.deferred.reject(e)}kc(e){if(e.name==="FirebaseError"){const n=e.code;return n==="aborted"||n==="failed-precondition"||!SN(n)}return!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gQ{constructor(e,n,r,s){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=s,this.user=Et.UNAUTHENTICATED,this.clientId=XR.I(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(r,async i=>{R("FirestoreClient","Received user=",i.uid),await this.authCredentialListener(i),this.user=i}),this.appCheckCredentials.start(r,i=>(R("FirestoreClient","Received new app check token=",i),this.appCheckCredentialListener(i,this.user)))}async getConfiguration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new S(w.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();const e=new At;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this.onlineComponents&&await this.onlineComponents.terminate(),this.offlineComponents&&await this.offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=oc(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function CP(t,e){t.asyncQueue.verifyOperationInProgress(),R("FirestoreClient","Initializing OfflineComponentProvider");const n=await t.getConfiguration();await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async s=>{r.isEqual(s)||(await rP(e.localStore,s),r=s)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t.offlineComponents=e}async function AP(t,e){t.asyncQueue.verifyOperationInProgress();const n=await Zv(t);R("FirestoreClient","Initializing OnlineComponentProvider");const r=await t.getConfiguration();await e.initialize(n,r),t.setCredentialChangeListener(s=>lT(e.remoteStore,s)),t.setAppCheckTokenChangeListener((s,i)=>lT(e.remoteStore,i)),t.onlineComponents=e}async function Zv(t){return t.offlineComponents||(R("FirestoreClient","Using default OfflineComponentProvider"),await CP(t,new TP)),t.offlineComponents}async function op(t){return t.onlineComponents||(R("FirestoreClient","Using default OnlineComponentProvider"),await AP(t,new Xv)),t.onlineComponents}function kP(t){return Zv(t).then(e=>e.persistence)}function ew(t){return Zv(t).then(e=>e.localStore)}function RP(t){return op(t).then(e=>e.remoteStore)}function tw(t){return op(t).then(e=>e.syncEngine)}async function Ma(t){const e=await op(t),n=e.eventManager;return n.onListen=G6.bind(null,e.syncEngine),n.onUnlisten=z6.bind(null,e.syncEngine),n}function mQ(t){return t.asyncQueue.enqueue(async()=>{const e=await kP(t),n=await RP(t);return e.setNetworkEnabled(!0),function(r){const s=B(r);return s.lu.delete(0),Uu(s)}(n)})}function _Q(t){return t.asyncQueue.enqueue(async()=>{const e=await kP(t),n=await RP(t);return e.setNetworkEnabled(!1),async function(r){const s=B(r);s.lu.add(0),await rc(s),s._u.set("Offline")}(n)})}function yQ(t,e){const n=new At;return t.asyncQueue.enqueueAndForget(async()=>async function(r,s,i){try{const o=await function(a,c){const l=B(a);return l.persistence.runTransaction("read document","readonly",u=>l.localDocuments.getDocument(u,c))}(r,s);o.isFoundDocument()?i.resolve(o):o.isNoDocument()?i.resolve(null):i.reject(new S(w.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(o){const a=oc(o,`Failed to get document '${s} from cache`);i.reject(a)}}(await ew(t),e,n)),n.promise}function NP(t,e,n={}){const r=new At;return t.asyncQueue.enqueueAndForget(async()=>function(s,i,o,a,c){const l=new ip({next:h=>{i.enqueueAndForget(()=>jv(s,u));const d=h.docs.has(o);!d&&h.fromCache?c.reject(new S(w.UNAVAILABLE,"Failed to get document because the client is offline.")):d&&h.fromCache&&a&&a.source==="server"?c.reject(new S(w.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):c.resolve(h)},error:h=>c.reject(h)}),u=new Wv(ec(o.path),l,{includeMetadataChanges:!0,Du:!0});return qv(s,u)}(await Ma(t),t.asyncQueue,e,n,r)),r.promise}function vQ(t,e){const n=new At;return t.asyncQueue.enqueueAndForget(async()=>async function(r,s,i){try{const o=await Sd(r,s,!0),a=new wP(s,o.ji),c=a.Ku(o.documents),l=a.applyChanges(c,!1);i.resolve(l.snapshot)}catch(o){const a=oc(o,`Failed to execute query '${s} against cache`);i.reject(a)}}(await ew(t),e,n)),n.promise}function PP(t,e,n={}){const r=new At;return t.asyncQueue.enqueueAndForget(async()=>function(s,i,o,a,c){const l=new ip({next:h=>{i.enqueueAndForget(()=>jv(s,u)),h.fromCache&&a.source==="server"?c.reject(new S(w.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):c.resolve(h)},error:h=>c.reject(h)}),u=new Wv(o,l,{includeMetadataChanges:!0,Du:!0});return qv(s,u)}(await Ma(t),t.asyncQueue,e,n,r)),r.promise}function wQ(t,e){const n=new ip(e);return t.asyncQueue.enqueueAndForget(async()=>function(r,s){B(r).Tu.add(s),s.next()}(await Ma(t),n)),()=>{n.Tc(),t.asyncQueue.enqueueAndForget(async()=>function(r,s){B(r).Tu.delete(s)}(await Ma(t),n))}}function bQ(t,e,n){const r=new At;return t.asyncQueue.enqueueAndForget(async()=>{const s=await function(i){return op(i).then(o=>o.datastore)}(t);new pQ(t.asyncQueue,s,n,e,r).run()}),r.promise}function IQ(t,e,n,r){const s=function(i,o){let a;return a=typeof i=="string"?new TextEncoder().encode(i):i,function(c,l){return new dQ(c,l)}(function(c,l){if(c instanceof Uint8Array)return pT(c,l);if(c instanceof ArrayBuffer)return pT(new Uint8Array(c),l);if(c instanceof ReadableStream)return c.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(a),o)}(n,Fu(e));t.asyncQueue.enqueueAndForget(async()=>{uQ(await tw(t),s,r)})}function EQ(t,e){return t.asyncQueue.enqueue(async()=>function(n,r){const s=B(n);return s.persistence.runTransaction("Get named query","readonly",i=>s.Ds.getNamedQuery(i,r))}(await ew(t),e))}const gT=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nw(t,e,n){if(!n)throw new S(w.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function DP(t,e,n,r){if(e===!0&&r===!0)throw new S(w.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function mT(t){if(!F.isDocumentKey(t))throw new S(w.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function _T(t){if(F.isDocumentKey(t))throw new S(w.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function ap(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(n){return n.constructor?n.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":W()}function Ie(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new S(w.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=ap(t);throw new S(w.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}function xP(t,e){if(e<=0)throw new S(w.INVALID_ARGUMENT,`Function ${t}() requires a positive number, but it was: ${e}.`)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yT{constructor(e){var n;if(e.host===void 0){if(e.ssl!==void 0)throw new S(w.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(n=e.ssl)===null||n===void 0||n;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new S(w.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.useFetchStreams=!!e.useFetchStreams,DP("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling)}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $u{constructor(e,n,r){this._authCredentials=n,this._appCheckCredentials=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new yT({}),this._settingsFrozen=!1,e instanceof as?this._databaseId=e:(this._app=e,this._databaseId=function(s){if(!Object.prototype.hasOwnProperty.apply(s.options,["projectId"]))throw new S(w.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new as(s.options.projectId)}(e))}get app(){if(!this._app)throw new S(w.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!==void 0}_setSettings(e){if(this._settingsFrozen)throw new S(w.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new yT(e),e.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new E2;switch(n.type){case"gapi":const r=n.client;return se(!(typeof r!="object"||r===null||!r.auth||!r.auth.getAuthHeaderValueForFirstParty)),new A2(r,n.sessionIndex||"0",n.iamToken||null);case"provider":return n.client;default:throw new S(w.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const n=gT.get(e);n&&(R("ComponentProvider","Removing Datastore"),gT.delete(e),n.terminate())}(this),Promise.resolve()}}function TQ(t,e,n,r={}){var s;const i=(t=Ie(t,$u))._getSettings();if(i.host!=="firestore.googleapis.com"&&i.host!==e&&Bl("Host has been set in both settings() and useEmulator(), emulator host will be used"),t._setSettings(Object.assign(Object.assign({},i),{host:`${e}:${n}`,ssl:!1})),r.mockUserToken){let o,a;if(typeof r.mockUserToken=="string")o=r.mockUserToken,a=Et.MOCK_USER;else{o=P_(r.mockUserToken,(s=t._app)===null||s===void 0?void 0:s.options.projectId);const c=r.mockUserToken.sub||r.mockUserToken.user_id;if(!c)throw new S(w.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");a=new Et(c)}t._authCredentials=new T2(new JR(o,a))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ke{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Rr(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Ke(this.firestore,e,this._key)}}class Zt{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new Zt(this.firestore,e,this._query)}}class Rr extends Zt{constructor(e,n,r){super(e,n,ec(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Ke(this.firestore,null,new F(e))}withConverter(e){return new Rr(this.firestore,e,this._path)}}function OP(t,e,...n){if(t=A(t),nw("collection","path",e),t instanceof $u){const r=we.fromString(e,...n);return _T(r),new Rr(t,null,r)}{if(!(t instanceof Ke||t instanceof Rr))throw new S(w.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(we.fromString(e,...n));return _T(r),new Rr(t.firestore,null,r)}}function SQ(t,e){if(t=Ie(t,$u),nw("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new S(w.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new Zt(t,null,function(n){return new ds(we.emptyPath(),n)}(e))}function Rd(t,e,...n){if(t=A(t),arguments.length===1&&(e=XR.I()),nw("doc","path",e),t instanceof $u){const r=we.fromString(e,...n);return mT(r),new Ke(t,null,new F(r))}{if(!(t instanceof Ke||t instanceof Rr))throw new S(w.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(we.fromString(e,...n));return mT(r),new Ke(t.firestore,t instanceof Rr?t.converter:null,new F(r))}}function MP(t,e){return t=A(t),e=A(e),(t instanceof Ke||t instanceof Rr)&&(e instanceof Ke||e instanceof Rr)&&t.firestore===e.firestore&&t.path===e.path&&t.converter===e.converter}function LP(t,e){return t=A(t),e=A(e),t instanceof Zt&&e instanceof Zt&&t.firestore===e.firestore&&xu(t._query,e._query)&&t.converter===e.converter}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CQ{constructor(){this.Oc=Promise.resolve(),this.Mc=[],this.Fc=!1,this.$c=[],this.Bc=null,this.Lc=!1,this.Uc=!1,this.qc=[],this.So=new Fv(this,"async_queue_retry"),this.Kc=()=>{const n=Rh();n&&R("AsyncQueue","Visibility state changed to "+n.visibilityState),this.So.Eo()};const e=Rh();e&&typeof e.addEventListener=="function"&&e.addEventListener("visibilitychange",this.Kc)}get isShuttingDown(){return this.Fc}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.Gc(),this.Qc(e)}enterRestrictedMode(e){if(!this.Fc){this.Fc=!0,this.Uc=e||!1;const n=Rh();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.Kc)}}enqueue(e){if(this.Gc(),this.Fc)return new Promise(()=>{});const n=new At;return this.Qc(()=>this.Fc&&this.Uc?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Mc.push(e),this.jc()))}async jc(){if(this.Mc.length!==0){try{await this.Mc[0](),this.Mc.shift(),this.So.reset()}catch(e){if(!ui(e))throw e;R("AsyncQueue","Operation failed with retryable error: "+e)}this.Mc.length>0&&this.So.Io(()=>this.jc())}}Qc(e){const n=this.Oc.then(()=>(this.Lc=!0,e().catch(r=>{this.Bc=r,this.Lc=!1;const s=function(i){let o=i.message||"";return i.stack&&(o=i.stack.includes(i.message)?i.stack:i.message+`
`+i.stack),o}(r);throw dt("INTERNAL UNHANDLED ERROR: ",s),r}).then(r=>(this.Lc=!1,r))));return this.Oc=n,n}enqueueAfterDelay(e,n,r){this.Gc(),this.qc.indexOf(e)>-1&&(n=0);const s=Bv.createAndSchedule(this,e,n,r,i=>this.Wc(i));return this.$c.push(s),s}Gc(){this.Bc&&W()}verifyOperationInProgress(){}async zc(){let e;do e=this.Oc,await e;while(e!==this.Oc)}Hc(e){for(const n of this.$c)if(n.timerId===e)return!0;return!1}Jc(e){return this.zc().then(()=>{this.$c.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.$c)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.zc()})}Yc(e){this.qc.push(e)}Wc(e){const n=this.$c.indexOf(e);this.$c.splice(n,1)}}function Qm(t){return function(e,n){if(typeof e!="object"||e===null)return!1;const r=e;for(const s of n)if(s in r&&typeof r[s]=="function")return!0;return!1}(t,["next","error","complete"])}class AQ{constructor(){this._progressObserver={},this._taskCompletionResolver=new At,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,n,r){this._progressObserver={next:e,error:n,complete:r}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,n){return this._taskCompletionResolver.promise.then(e,n)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kQ=-1;class st extends $u{constructor(e,n,r){super(e,n,r),this.type="firestore",this._queue=new CQ,this._persistenceKey="name"in e?e.name:"[DEFAULT]"}_terminate(){return this._firestoreClient||FP(this),this._firestoreClient.terminate()}}function Ft(t){return t._firestoreClient||FP(t),t._firestoreClient.verifyNotTerminated(),t._firestoreClient}function FP(t){var e;const n=t._freezeSettings(),r=function(s,i,o,a){return new $2(s,i,o,a.host,a.ssl,a.experimentalForceLongPolling,a.experimentalAutoDetectLongPolling,a.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,n);t._firestoreClient=new gQ(t._authCredentials,t._appCheckCredentials,t._queue,r)}function RQ(t,e){$P(t=Ie(t,st));const n=Ft(t),r=t._freezeSettings(),s=new Xv;return UP(n,s,new SP(s,r.cacheSizeBytes,e==null?void 0:e.forceOwnership))}function NQ(t){$P(t=Ie(t,st));const e=Ft(t),n=t._freezeSettings(),r=new Xv;return UP(e,r,new hQ(r,n.cacheSizeBytes))}function UP(t,e,n){const r=new At;return t.asyncQueue.enqueue(async()=>{try{await CP(t,n),await AP(t,e),r.resolve()}catch(s){const i=s;if(!function(o){return o.name==="FirebaseError"?o.code===w.FAILED_PRECONDITION||o.code===w.UNIMPLEMENTED:typeof DOMException!="undefined"&&o instanceof DOMException?o.code===22||o.code===20||o.code===11:!0}(i))throw i;console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+i),r.reject(i)}}).then(()=>r.promise)}function PQ(t){if(t._initialized&&!t._terminated)throw new S(w.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");const e=new At;return t._queue.enqueueAndForgetEvenWhileRestricted(async()=>{try{await async function(n){if(!sr.V())return Promise.resolve();const r=n+"main";await sr.delete(r)}(Ov(t._databaseId,t._persistenceKey)),e.resolve()}catch(n){e.reject(n)}}),e.promise}function DQ(t){return function(e){const n=new At;return e.asyncQueue.enqueueAndForget(async()=>Z6(await tw(e),n)),n.promise}(Ft(t=Ie(t,st)))}function xQ(t){return mQ(Ft(t=Ie(t,st)))}function OQ(t){return _Q(Ft(t=Ie(t,st)))}function MQ(t,e){const n=Ft(t=Ie(t,st)),r=new AQ;return IQ(n,t._databaseId,e,r),r}function LQ(t,e){return EQ(Ft(t=Ie(t,st)),e).then(n=>n?new Zt(t,null,n.query):null)}function $P(t){if(t._initialized||t._terminated)throw new S(w.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ri{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new S(w.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new ot(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ur{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Ur(_t.fromBase64String(e))}catch(n){throw new S(w.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new Ur(_t.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ro{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cp{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new S(w.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new S(w.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return ce(this._lat,e._lat)||ce(this._long,e._long)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FQ=/^__.*__$/;class UQ{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new fs(e,this.data,this.fieldMask,n,this.fieldTransforms):new tc(e,this.data,n,this.fieldTransforms)}}class VP{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new fs(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function BP(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw W()}}class lp{constructor(e,n,r,s,i,o){this.settings=e,this.databaseId=n,this.wt=r,this.ignoreUndefinedProperties=s,i===void 0&&this.Xc(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Zc(){return this.settings.Zc}ta(e){return new lp(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.wt,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}ea(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),s=this.ta({path:r,na:!1});return s.sa(e),s}ia(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),s=this.ta({path:r,na:!1});return s.Xc(),s}ra(e){return this.ta({path:void 0,na:!0})}oa(e){return Nd(e,this.settings.methodName,this.settings.ua||!1,this.path,this.settings.ca)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}Xc(){if(this.path)for(let e=0;e<this.path.length;e++)this.sa(this.path.get(e))}sa(e){if(e.length===0)throw this.oa("Document fields must not be empty");if(BP(this.Zc)&&FQ.test(e))throw this.oa('Document fields cannot begin and end with "__"')}}class $Q{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.wt=r||Fu(e)}aa(e,n,r,s=!1){return new lp({Zc:e,methodName:n,ca:r,path:ot.emptyPath(),na:!1,ua:s},this.databaseId,this.wt,this.ignoreUndefinedProperties)}}function No(t){const e=t._freezeSettings(),n=Fu(t._databaseId);return new $Q(t._databaseId,!!e.ignoreUndefinedProperties,n)}function up(t,e,n,r,s,i={}){const o=t.aa(i.merge||i.mergeFields?2:0,e,n,s);ow("Data must be an object, but it was:",o,r);const a=KP(r,o);let c,l;if(i.merge)c=new Pn(o.fieldMask),l=o.fieldTransforms;else if(i.mergeFields){const u=[];for(const h of i.mergeFields){const d=Ym(e,h,n);if(!o.contains(d))throw new S(w.INVALID_ARGUMENT,`Field '${d}' is specified in your field mask but missing from your input data.`);HP(u,d)||u.push(d)}c=new Pn(u),l=o.fieldTransforms.filter(h=>c.covers(h.field))}else c=null,l=o.fieldTransforms;return new UQ(new Vt(a),c,l)}class Vu extends Ro{_toFieldTransform(e){if(e.Zc!==2)throw e.Zc===1?e.oa(`${this._methodName}() can only appear at the top level of your update data`):e.oa(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Vu}}function qP(t,e,n){return new lp({Zc:3,ca:e.settings.ca,methodName:t._methodName,na:n},e.databaseId,e.wt,e.ignoreUndefinedProperties)}class rw extends Ro{_toFieldTransform(e){return new Ou(e.path,new Ra)}isEqual(e){return e instanceof rw}}class VQ extends Ro{constructor(e,n){super(e),this.ha=n}_toFieldTransform(e){const n=qP(this,e,!0),r=this.ha.map(i=>Po(i,n)),s=new uo(r);return new Ou(e.path,s)}isEqual(e){return this===e}}class BQ extends Ro{constructor(e,n){super(e),this.ha=n}_toFieldTransform(e){const n=qP(this,e,!0),r=this.ha.map(i=>Po(i,n)),s=new ho(r);return new Ou(e.path,s)}isEqual(e){return this===e}}class qQ extends Ro{constructor(e,n){super(e),this.la=n}_toFieldTransform(e){const n=new Na(e.wt,yN(e.wt,this.la));return new Ou(e.path,n)}isEqual(e){return this===e}}function sw(t,e,n,r){const s=t.aa(1,e,n);ow("Data must be an object, but it was:",s,r);const i=[],o=Vt.empty();ko(r,(c,l)=>{const u=aw(e,c,n);l=A(l);const h=s.ia(u);if(l instanceof Vu)i.push(u);else{const d=Po(l,h);d!=null&&(i.push(u),o.set(u,d))}});const a=new Pn(i);return new VP(o,a,s.fieldTransforms)}function iw(t,e,n,r,s,i){const o=t.aa(1,e,n),a=[Ym(e,r,n)],c=[s];if(i.length%2!=0)throw new S(w.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let d=0;d<i.length;d+=2)a.push(Ym(e,i[d])),c.push(i[d+1]);const l=[],u=Vt.empty();for(let d=a.length-1;d>=0;--d)if(!HP(l,a[d])){const f=a[d];let p=c[d];p=A(p);const _=o.ia(f);if(p instanceof Vu)l.push(f);else{const y=Po(p,_);y!=null&&(l.push(f),u.set(f,y))}}const h=new Pn(l);return new VP(u,h,o.fieldTransforms)}function jP(t,e,n,r=!1){return Po(n,t.aa(r?4:3,e))}function Po(t,e){if(WP(t=A(t)))return ow("Unsupported field value:",e,t),KP(t,e);if(t instanceof Ro)return function(n,r){if(!BP(r.Zc))throw r.oa(`${n._methodName}() can only be used with update() and set()`);if(!r.path)throw r.oa(`${n._methodName}() is not currently supported inside arrays`);const s=n._toFieldTransform(r);s&&r.fieldTransforms.push(s)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.na&&e.Zc!==4)throw e.oa("Nested arrays are not supported");return function(n,r){const s=[];let i=0;for(const o of n){let a=Po(o,r.ra(i));a==null&&(a={nullValue:"NULL_VALUE"}),s.push(a),i++}return{arrayValue:{values:s}}}(t,e)}return function(n,r){if((n=A(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return yN(r.wt,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const s=ze.fromDate(n);return{timestampValue:Gl(r.wt,s)}}if(n instanceof ze){const s=new ze(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:Gl(r.wt,s)}}if(n instanceof cp)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof Ur)return{bytesValue:DN(r.wt,n._byteString)};if(n instanceof Ke){const s=r.databaseId,i=n.firestore._databaseId;if(!i.isEqual(s))throw r.oa(`Document reference is for database ${i.projectId}/${i.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:Cv(n.firestore._databaseId||r.databaseId,n._key.path)}}throw r.oa(`Unsupported field value: ${ap(n)}`)}(t,e)}function KP(t,e){const n={};return iN(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):ko(t,(r,s)=>{const i=Po(s,e.ea(r));i!=null&&(n[r]=i)}),{mapValue:{fields:n}}}function WP(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof ze||t instanceof cp||t instanceof Ur||t instanceof Ke||t instanceof Ro)}function ow(t,e,n){if(!WP(n)||!function(r){return typeof r=="object"&&r!==null&&(Object.getPrototypeOf(r)===Object.prototype||Object.getPrototypeOf(r)===null)}(n)){const r=ap(n);throw r==="an object"?e.oa(t+" a custom object"):e.oa(t+" "+r)}}function Ym(t,e,n){if((e=A(e))instanceof ri)return e._internalPath;if(typeof e=="string")return aw(t,e);throw Nd("Field path arguments must be of type string or ",t,!1,void 0,n)}const jQ=new RegExp("[~\\*/\\[\\]]");function aw(t,e,n){if(e.search(jQ)>=0)throw Nd(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new ri(...e.split("."))._internalPath}catch{throw Nd(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function Nd(t,e,n,r,s){const i=r&&!r.isEmpty(),o=s!==void 0;let a=`Function ${e}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(i||o)&&(c+=" (found",i&&(c+=` in field ${r}`),o&&(c+=` in document ${s}`),c+=")"),new S(w.INVALID_ARGUMENT,a+t+c)}function HP(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xl{constructor(e,n,r,s,i){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new Ke(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new KQ(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(hp("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class KQ extends Xl{data(){return super.data()}}function hp(t,e){return typeof e=="string"?aw(t,e):e instanceof ri?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ui{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class cs extends Xl{constructor(e,n,r,s,i,o){super(e,n,r,s,o),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new el(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(hp("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}}class el extends cs{data(e={}){return super.data(e)}}class si{constructor(e,n,r,s){this._firestore=e,this._userDataWriter=n,this._snapshot=s,this.metadata=new Ui(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new el(this._firestore,this._userDataWriter,r.key,r,new Ui(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new S(w.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(r,s){if(r._snapshot.oldDocs.isEmpty()){let i=0;return r._snapshot.docChanges.map(o=>({type:"added",doc:new el(r._firestore,r._userDataWriter,o.doc.key,o.doc,new Ui(r._snapshot.mutatedKeys.has(o.doc.key),r._snapshot.fromCache),r.query.converter),oldIndex:-1,newIndex:i++}))}{let i=r._snapshot.oldDocs;return r._snapshot.docChanges.filter(o=>s||o.type!==3).map(o=>{const a=new el(r._firestore,r._userDataWriter,o.doc.key,o.doc,new Ui(r._snapshot.mutatedKeys.has(o.doc.key),r._snapshot.fromCache),r.query.converter);let c=-1,l=-1;return o.type!==0&&(c=i.indexOf(o.doc.key),i=i.delete(o.doc.key)),o.type!==1&&(i=i.add(o.doc),l=i.indexOf(o.doc.key)),{type:WQ(o.type),doc:a,oldIndex:c,newIndex:l}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}}function WQ(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return W()}}function GP(t,e){return t instanceof cs&&e instanceof cs?t._firestore===e._firestore&&t._key.isEqual(e._key)&&(t._document===null?e._document===null:t._document.isEqual(e._document))&&t._converter===e._converter:t instanceof si&&e instanceof si&&t._firestore===e._firestore&&LP(t.query,e.query)&&t.metadata.isEqual(e.metadata)&&t._snapshot.isEqual(e._snapshot)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zP(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new S(w.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Bu{}function Es(t,...e){for(const n of e)t=n._apply(t);return t}class HQ extends Bu{constructor(e,n,r){super(),this.fa=e,this.da=n,this._a=r,this.type="where"}_apply(e){const n=No(e.firestore),r=function(s,i,o,a,c,l,u){let h;if(c.isKeyField()){if(l==="array-contains"||l==="array-contains-any")throw new S(w.INVALID_ARGUMENT,`Invalid Query. You can't perform '${l}' queries on documentId().`);if(l==="in"||l==="not-in"){wT(u,l);const f=[];for(const p of u)f.push(vT(a,s,p));h={arrayValue:{values:f}}}else h=vT(a,s,u)}else l!=="in"&&l!=="not-in"&&l!=="array-contains-any"||wT(u,l),h=jP(o,i,u,l==="in"||l==="not-in");const d=Bt.create(c,l,h);return function(f,p){if(p.ht()){const y=Iv(f);if(y!==null&&!y.isEqual(p.field))throw new S(w.INVALID_ARGUMENT,`Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '${y.toString()}' and '${p.field.toString()}'`);const I=bv(f);I!==null&&ZP(f,p.field,I)}const _=function(y,I){for(const N of y.filters)if(I.indexOf(N.op)>=0)return N.op;return null}(f,function(y){switch(y){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}(p.op));if(_!==null)throw _===p.op?new S(w.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${p.op.toString()}' filter.`):new S(w.INVALID_ARGUMENT,`Invalid query. You cannot use '${p.op.toString()}' filters with '${_.toString()}' filters.`)}(s,d),d}(e._query,"where",n,e.firestore._databaseId,this.fa,this.da,this._a);return new Zt(e.firestore,e.converter,function(s,i){const o=s.filters.concat([i]);return new ds(s.path,s.collectionGroup,s.explicitOrderBy.slice(),o,s.limit,s.limitType,s.startAt,s.endAt)}(e._query,r))}}function GQ(t,e,n){const r=e,s=hp("where",t);return new HQ(s,r,n)}class zQ extends Bu{constructor(e,n){super(),this.fa=e,this.wa=n,this.type="orderBy"}_apply(e){const n=function(r,s,i){if(r.startAt!==null)throw new S(w.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(r.endAt!==null)throw new S(w.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");const o=new aa(s,i);return function(a,c){if(bv(a)===null){const l=Iv(a);l!==null&&ZP(a,l,c.field)}}(r,o),o}(e._query,this.fa,this.wa);return new Zt(e.firestore,e.converter,function(r,s){const i=r.explicitOrderBy.concat([s]);return new ds(r.path,r.collectionGroup,i,r.filters.slice(),r.limit,r.limitType,r.startAt,r.endAt)}(e._query,n))}}function QQ(t,e="asc"){const n=e,r=hp("orderBy",t);return new zQ(r,n)}class QP extends Bu{constructor(e,n,r){super(),this.type=e,this.ma=n,this.ga=r}_apply(e){return new Zt(e.firestore,e.converter,dN(e._query,this.ma,this.ga))}}function YQ(t){return xP("limit",t),new QP("limit",t,"F")}function JQ(t){return xP("limitToLast",t),new QP("limitToLast",t,"L")}class YP extends Bu{constructor(e,n,r){super(),this.type=e,this.ya=n,this.pa=r}_apply(e){const n=XP(e,this.type,this.ya,this.pa);return new Zt(e.firestore,e.converter,function(r,s){return new ds(r.path,r.collectionGroup,r.explicitOrderBy.slice(),r.filters.slice(),r.limit,r.limitType,s,r.endAt)}(e._query,n))}}function XQ(...t){return new YP("startAt",t,!0)}function ZQ(...t){return new YP("startAfter",t,!1)}class JP extends Bu{constructor(e,n,r){super(),this.type=e,this.ya=n,this.pa=r}_apply(e){const n=XP(e,this.type,this.ya,this.pa);return new Zt(e.firestore,e.converter,function(r,s){return new ds(r.path,r.collectionGroup,r.explicitOrderBy.slice(),r.filters.slice(),r.limit,r.limitType,r.startAt,s)}(e._query,n))}}function e3(...t){return new JP("endBefore",t,!1)}function t3(...t){return new JP("endAt",t,!0)}function XP(t,e,n,r){if(n[0]=A(n[0]),n[0]instanceof Xl)return function(s,i,o,a,c){if(!a)throw new S(w.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${o}().`);const l=[];for(const u of ka(s))if(u.field.isKeyField())l.push(co(i,a.key));else{const h=a.data.field(u.field);if(wv(h))throw new S(w.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+u.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(h===null){const d=u.field.canonicalString();throw new S(w.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${d}' (used as the orderBy) does not exist.`)}l.push(h)}return new ti(l,c)}(t._query,t.firestore._databaseId,e,n[0]._document,r);{const s=No(t.firestore);return function(i,o,a,c,l,u){const h=i.explicitOrderBy;if(l.length>h.length)throw new S(w.INVALID_ARGUMENT,`Too many arguments provided to ${c}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const d=[];for(let f=0;f<l.length;f++){const p=l[f];if(h[f].field.isKeyField()){if(typeof p!="string")throw new S(w.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${c}(), but got a ${typeof p}`);if(!Ev(i)&&p.indexOf("/")!==-1)throw new S(w.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${c}() must be a plain document ID, but '${p}' contains a slash.`);const _=i.path.child(we.fromString(p));if(!F.isDocumentKey(_))throw new S(w.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${c}() must result in a valid document path, but '${_}' is not because it contains an odd number of segments.`);const y=new F(_);d.push(co(o,y))}else{const _=jP(a,c,p);d.push(_)}}return new ti(d,u)}(t._query,t.firestore._databaseId,s,e,n,r)}}function vT(t,e,n){if(typeof(n=A(n))=="string"){if(n==="")throw new S(w.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Ev(e)&&n.indexOf("/")!==-1)throw new S(w.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(we.fromString(n));if(!F.isDocumentKey(r))throw new S(w.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return co(t,new F(r))}if(n instanceof Ke)return co(t,n._key);throw new S(w.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${ap(n)}.`)}function wT(t,e){if(!Array.isArray(t)||t.length===0)throw new S(w.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`);if(t.length>10)throw new S(w.INVALID_ARGUMENT,`Invalid Query. '${e.toString()}' filters support a maximum of 10 elements in the value array.`)}function ZP(t,e,n){if(!n.isEqual(e))throw new S(w.INVALID_ARGUMENT,`Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '${e.toString()}' and so you must also use '${e.toString()}' as your first argument to orderBy(), but your first orderBy() is on field '${n.toString()}' instead.`)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const n3={maxAttempts:5};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cw{convertValue(e,n="none"){switch(ao(e)){case 0:return null;case 1:return e.booleanValue;case 2:return et(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(oo(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 10:return this.convertObject(e.mapValue,n);default:throw W()}}convertObject(e,n){const r={};return ko(e.fields,(s,i)=>{r[s]=this.convertValue(i,n)}),r}convertGeoPoint(e){return new cp(et(e.latitude),et(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=oN(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(jl(e));default:return null}}convertTimestamp(e){const n=Zs(e);return new ze(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=we.fromString(e);se(BN(r));const s=new as(r.get(1),r.get(3)),i=new F(r.popFirst(5));return s.isEqual(n)||dt(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dp(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}class r3 extends cw{constructor(e){super(),this.firestore=e}convertBytes(e){return new Ur(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new Ke(this.firestore,null,n)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s3{constructor(e,n){this._firestore=e,this._commitHandler=n,this._mutations=[],this._committed=!1,this._dataReader=No(e)}set(e,n,r){this._verifyNotCommitted();const s=Rs(e,this._firestore),i=dp(s.converter,n,r),o=up(this._dataReader,"WriteBatch.set",s._key,i,s.converter!==null,r);return this._mutations.push(o.toMutation(s._key,Ye.none())),this}update(e,n,r,...s){this._verifyNotCommitted();const i=Rs(e,this._firestore);let o;return o=typeof(n=A(n))=="string"||n instanceof ri?iw(this._dataReader,"WriteBatch.update",i._key,n,r,s):sw(this._dataReader,"WriteBatch.update",i._key,n),this._mutations.push(o.toMutation(i._key,Ye.exists(!0))),this}delete(e){this._verifyNotCommitted();const n=Rs(e,this._firestore);return this._mutations=this._mutations.concat(new nc(n._key,Ye.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new S(w.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function Rs(t,e){if((t=A(t)).firestore!==e)throw new S(w.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function i3(t){t=Ie(t,Ke);const e=Ie(t.firestore,st);return NP(Ft(e),t._key).then(n=>lw(e,t,n))}class Do extends cw{constructor(e){super(),this.firestore=e}convertBytes(e){return new Ur(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new Ke(this.firestore,null,n)}}function o3(t){t=Ie(t,Ke);const e=Ie(t.firestore,st),n=Ft(e),r=new Do(e);return yQ(n,t._key).then(s=>new cs(e,r,t._key,s,new Ui(s!==null&&s.hasLocalMutations,!0),t.converter))}function a3(t){t=Ie(t,Ke);const e=Ie(t.firestore,st);return NP(Ft(e),t._key,{source:"server"}).then(n=>lw(e,t,n))}function c3(t){t=Ie(t,Zt);const e=Ie(t.firestore,st),n=Ft(e),r=new Do(e);return zP(t._query),PP(n,t._query).then(s=>new si(e,r,t,s))}function l3(t){t=Ie(t,Zt);const e=Ie(t.firestore,st),n=Ft(e),r=new Do(e);return vQ(n,t._query).then(s=>new si(e,r,t,s))}function u3(t){t=Ie(t,Zt);const e=Ie(t.firestore,st),n=Ft(e),r=new Do(e);return PP(n,t._query,{source:"server"}).then(s=>new si(e,r,t,s))}function bT(t,e,n){t=Ie(t,Ke);const r=Ie(t.firestore,st),s=dp(t.converter,e,n);return qu(r,[up(No(r),"setDoc",t._key,s,t.converter!==null,n).toMutation(t._key,Ye.none())])}function IT(t,e,n,...r){t=Ie(t,Ke);const s=Ie(t.firestore,st),i=No(s);let o;return o=typeof(e=A(e))=="string"||e instanceof ri?iw(i,"updateDoc",t._key,e,n,r):sw(i,"updateDoc",t._key,e),qu(s,[o.toMutation(t._key,Ye.exists(!0))])}function h3(t){return qu(Ie(t.firestore,st),[new nc(t._key,Ye.none())])}function d3(t,e){const n=Ie(t.firestore,st),r=Rd(t),s=dp(t.converter,e);return qu(n,[up(No(t.firestore),"addDoc",r._key,s,t.converter!==null,{}).toMutation(r._key,Ye.exists(!1))]).then(()=>r)}function eD(t,...e){var n,r,s;t=A(t);let i={includeMetadataChanges:!1},o=0;typeof e[o]!="object"||Qm(e[o])||(i=e[o],o++);const a={includeMetadataChanges:i.includeMetadataChanges};if(Qm(e[o])){const h=e[o];e[o]=(n=h.next)===null||n===void 0?void 0:n.bind(h),e[o+1]=(r=h.error)===null||r===void 0?void 0:r.bind(h),e[o+2]=(s=h.complete)===null||s===void 0?void 0:s.bind(h)}let c,l,u;if(t instanceof Ke)l=Ie(t.firestore,st),u=ec(t._key.path),c={next:h=>{e[o]&&e[o](lw(l,t,h))},error:e[o+1],complete:e[o+2]};else{const h=Ie(t,Zt);l=Ie(h.firestore,st),u=h._query;const d=new Do(l);c={next:f=>{e[o]&&e[o](new si(l,d,h,f))},error:e[o+1],complete:e[o+2]},zP(t._query)}return function(h,d,f,p){const _=new ip(p),y=new Wv(d,_,f);return h.asyncQueue.enqueueAndForget(async()=>qv(await Ma(h),y)),()=>{_.Tc(),h.asyncQueue.enqueueAndForget(async()=>jv(await Ma(h),y))}}(Ft(l),u,a,c)}function f3(t,e){return wQ(Ft(t=Ie(t,st)),Qm(e)?e:{next:e})}function qu(t,e){return function(n,r){const s=new At;return n.asyncQueue.enqueueAndForget(async()=>Q6(await tw(n),r,s)),s.promise}(Ft(t),e)}function lw(t,e,n){const r=n.docs.get(e._key),s=new Do(t);return new cs(t,s,e._key,r,new Ui(n.hasPendingWrites,n.fromCache),e.converter)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p3 extends class{constructor(e,n){this._firestore=e,this._transaction=n,this._dataReader=No(e)}get(e){const n=Rs(e,this._firestore),r=new r3(this._firestore);return this._transaction.lookup([n._key]).then(s=>{if(!s||s.length!==1)return W();const i=s[0];if(i.isFoundDocument())return new Xl(this._firestore,r,i.key,i,n.converter);if(i.isNoDocument())return new Xl(this._firestore,r,n._key,null,n.converter);throw W()})}set(e,n,r){const s=Rs(e,this._firestore),i=dp(s.converter,n,r),o=up(this._dataReader,"Transaction.set",s._key,i,s.converter!==null,r);return this._transaction.set(s._key,o),this}update(e,n,r,...s){const i=Rs(e,this._firestore);let o;return o=typeof(n=A(n))=="string"||n instanceof ri?iw(this._dataReader,"Transaction.update",i._key,n,r,s):sw(this._dataReader,"Transaction.update",i._key,n),this._transaction.update(i._key,o),this}delete(e){const n=Rs(e,this._firestore);return this._transaction.delete(n._key),this}}{constructor(e,n){super(e,n),this._firestore=e}get(e){const n=Rs(e,this._firestore),r=new Do(this._firestore);return super.get(e).then(s=>new cs(this._firestore,r,n._key,s._document,new Ui(!1,!1),n.converter))}}function g3(t,e,n){t=Ie(t,st);const r=Object.assign(Object.assign({},n3),n);return function(s){if(s.maxAttempts<1)throw new S(w.INVALID_ARGUMENT,"Max attempts must be at least 1")}(r),bQ(Ft(t),s=>e(new p3(t,s)),r)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function m3(){return new Vu("deleteField")}function _3(){return new rw("serverTimestamp")}function y3(...t){return new VQ("arrayUnion",t)}function v3(...t){return new BQ("arrayRemove",t)}function w3(t){return new qQ("increment",t)}(function(t,e=!0){(function(n){Za=n})(Br),nt(new Ee("firestore",(n,{options:r})=>{const s=n.getProvider("app").getImmediate(),i=new st(s,new S2(n.getProvider("auth-internal")),new R2(n.getProvider("app-check-internal")));return r=Object.assign({useFetchStreams:e},r),i._setSettings(r),i},"PUBLIC")),Le(wE,"3.4.12",t),Le(wE,"3.4.12","esm2017")})();const b3="@firebase/firestore-compat",I3="0.1.21";/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uw(t,e){if(e===void 0)return{merge:!1};if(e.mergeFields!==void 0&&e.merge!==void 0)throw new S("invalid-argument",`Invalid options passed to function ${t}(): You cannot specify both "merge" and "mergeFields".`);return e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ET(){if(typeof Uint8Array=="undefined")throw new S("unimplemented","Uint8Arrays are not available in this environment.")}function TT(){if(!F2())throw new S("unimplemented","Blobs are unavailable in Firestore in this environment.")}class Zl{constructor(e){this._delegate=e}static fromBase64String(e){return TT(),new Zl(Ur.fromBase64String(e))}static fromUint8Array(e){return ET(),new Zl(Ur.fromUint8Array(e))}toBase64(){return TT(),this._delegate.toBase64()}toUint8Array(){return ET(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Jm(t){return E3(t,["next","error","complete"])}function E3(t,e){if(typeof t!="object"||t===null)return!1;const n=t;for(const r of e)if(r in n&&typeof n[r]=="function")return!0;return!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T3{enableIndexedDbPersistence(e,n){return RQ(e._delegate,{forceOwnership:n})}enableMultiTabIndexedDbPersistence(e){return NQ(e._delegate)}clearIndexedDbPersistence(e){return PQ(e._delegate)}}class tD{constructor(e,n,r){this._delegate=n,this._persistenceProvider=r,this.INTERNAL={delete:()=>this.terminate()},e instanceof as||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){const n=this._delegate._getSettings();!e.merge&&n.host!==e.host&&Bl("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&(e=Object.assign(Object.assign({},n),e),delete e.merge),this._delegate._setSettings(e)}useEmulator(e,n,r={}){TQ(this._delegate,e,n,r)}enableNetwork(){return xQ(this._delegate)}disableNetwork(){return OQ(this._delegate)}enablePersistence(e){let n=!1,r=!1;return e&&(n=!!e.synchronizeTabs,r=!!e.experimentalForceOwningTab,DP("synchronizeTabs",n,"experimentalForceOwningTab",r)),n?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,r)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return DQ(this._delegate)}onSnapshotsInSync(e){return f3(this._delegate,e)}get app(){if(!this._appCompat)throw new S("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new La(this,OP(this._delegate,e))}catch(n){throw rn(n,"collection()","Firestore.collection()")}}doc(e){try{return new jn(this,Rd(this._delegate,e))}catch(n){throw rn(n,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new nn(this,SQ(this._delegate,e))}catch(n){throw rn(n,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return g3(this._delegate,n=>e(new nD(this,n)))}batch(){return Ft(this._delegate),new rD(new s3(this._delegate,e=>qu(this._delegate,e)))}loadBundle(e){return MQ(this._delegate,e)}namedQuery(e){return LQ(this._delegate,e).then(n=>n?new nn(this,n):null)}}class fp extends cw{constructor(e){super(),this.firestore=e}convertBytes(e){return new Zl(new Ur(e))}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return jn.forKey(n,this.firestore,null)}}function S3(t){b2(t)}class nD{constructor(e,n){this._firestore=e,this._delegate=n,this._userDataWriter=new fp(e)}get(e){const n=$i(e);return this._delegate.get(n).then(r=>new eu(this._firestore,new cs(this._firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,n.converter)))}set(e,n,r){const s=$i(e);return r?(uw("Transaction.set",r),this._delegate.set(s,n,r)):this._delegate.set(s,n),this}update(e,n,r,...s){const i=$i(e);return arguments.length===2?this._delegate.update(i,n):this._delegate.update(i,n,r,...s),this}delete(e){const n=$i(e);return this._delegate.delete(n),this}}class rD{constructor(e){this._delegate=e}set(e,n,r){const s=$i(e);return r?(uw("WriteBatch.set",r),this._delegate.set(s,n,r)):this._delegate.set(s,n),this}update(e,n,r,...s){const i=$i(e);return arguments.length===2?this._delegate.update(i,n):this._delegate.update(i,n,r,...s),this}delete(e){const n=$i(e);return this._delegate.delete(n),this}commit(){return this._delegate.commit()}}class mo{constructor(e,n,r){this._firestore=e,this._userDataWriter=n,this._delegate=r}fromFirestore(e,n){const r=new el(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new tu(this._firestore,r),n!=null?n:{})}toFirestore(e,n){return n?this._delegate.toFirestore(e,n):this._delegate.toFirestore(e)}static getInstance(e,n){const r=mo.INSTANCES;let s=r.get(e);s||(s=new WeakMap,r.set(e,s));let i=s.get(n);return i||(i=new mo(e,new fp(e),n),s.set(n,i)),i}}mo.INSTANCES=new WeakMap;class jn{constructor(e,n){this.firestore=e,this._delegate=n,this._userDataWriter=new fp(e)}static forPath(e,n,r){if(e.length%2!==0)throw new S("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new jn(n,new Ke(n._delegate,r,new F(e)))}static forKey(e,n,r){return new jn(n,new Ke(n._delegate,r,e))}get id(){return this._delegate.id}get parent(){return new La(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new La(this.firestore,OP(this._delegate,e))}catch(n){throw rn(n,"collection()","DocumentReference.collection()")}}isEqual(e){return e=A(e),e instanceof Ke?MP(this._delegate,e):!1}set(e,n){n=uw("DocumentReference.set",n);try{return n?bT(this._delegate,e,n):bT(this._delegate,e)}catch(r){throw rn(r,"setDoc()","DocumentReference.set()")}}update(e,n,...r){try{return arguments.length===1?IT(this._delegate,e):IT(this._delegate,e,n,...r)}catch(s){throw rn(s,"updateDoc()","DocumentReference.update()")}}delete(){return h3(this._delegate)}onSnapshot(...e){const n=sD(e),r=iD(e,s=>new eu(this.firestore,new cs(this.firestore._delegate,this._userDataWriter,s._key,s._document,s.metadata,this._delegate.converter)));return eD(this._delegate,n,r)}get(e){let n;return(e==null?void 0:e.source)==="cache"?n=o3(this._delegate):(e==null?void 0:e.source)==="server"?n=a3(this._delegate):n=i3(this._delegate),n.then(r=>new eu(this.firestore,new cs(this.firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,this._delegate.converter)))}withConverter(e){return new jn(this.firestore,e?this._delegate.withConverter(mo.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}function rn(t,e,n){return t.message=t.message.replace(e,n),t}function sD(t){for(const e of t)if(typeof e=="object"&&!Jm(e))return e;return{}}function iD(t,e){var n,r;let s;return Jm(t[0])?s=t[0]:Jm(t[1])?s=t[1]:typeof t[0]=="function"?s={next:t[0],error:t[1],complete:t[2]}:s={next:t[1],error:t[2],complete:t[3]},{next:i=>{s.next&&s.next(e(i))},error:(n=s.error)===null||n===void 0?void 0:n.bind(s),complete:(r=s.complete)===null||r===void 0?void 0:r.bind(s)}}class eu{constructor(e,n){this._firestore=e,this._delegate=n}get ref(){return new jn(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,n){return this._delegate.get(e,n)}isEqual(e){return GP(this._delegate,e._delegate)}}class tu extends eu{data(e){const n=this._delegate.data(e);return I2(n!==void 0),n}}class nn{constructor(e,n){this.firestore=e,this._delegate=n,this._userDataWriter=new fp(e)}where(e,n,r){try{return new nn(this.firestore,Es(this._delegate,GQ(e,n,r)))}catch(s){throw rn(s,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,n){try{return new nn(this.firestore,Es(this._delegate,QQ(e,n)))}catch(r){throw rn(r,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new nn(this.firestore,Es(this._delegate,YQ(e)))}catch(n){throw rn(n,"limit()","Query.limit()")}}limitToLast(e){try{return new nn(this.firestore,Es(this._delegate,JQ(e)))}catch(n){throw rn(n,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new nn(this.firestore,Es(this._delegate,XQ(...e)))}catch(n){throw rn(n,"startAt()","Query.startAt()")}}startAfter(...e){try{return new nn(this.firestore,Es(this._delegate,ZQ(...e)))}catch(n){throw rn(n,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new nn(this.firestore,Es(this._delegate,e3(...e)))}catch(n){throw rn(n,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new nn(this.firestore,Es(this._delegate,t3(...e)))}catch(n){throw rn(n,"endAt()","Query.endAt()")}}isEqual(e){return LP(this._delegate,e._delegate)}get(e){let n;return(e==null?void 0:e.source)==="cache"?n=l3(this._delegate):(e==null?void 0:e.source)==="server"?n=u3(this._delegate):n=c3(this._delegate),n.then(r=>new Xm(this.firestore,new si(this.firestore._delegate,this._userDataWriter,this._delegate,r._snapshot)))}onSnapshot(...e){const n=sD(e),r=iD(e,s=>new Xm(this.firestore,new si(this.firestore._delegate,this._userDataWriter,this._delegate,s._snapshot)));return eD(this._delegate,n,r)}withConverter(e){return new nn(this.firestore,e?this._delegate.withConverter(mo.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}class C3{constructor(e,n){this._firestore=e,this._delegate=n}get type(){return this._delegate.type}get doc(){return new tu(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}}class Xm{constructor(e,n){this._firestore=e,this._delegate=n}get query(){return new nn(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(e=>new tu(this._firestore,e))}docChanges(e){return this._delegate.docChanges(e).map(n=>new C3(this._firestore,n))}forEach(e,n){this._delegate.forEach(r=>{e.call(n,new tu(this._firestore,r))})}isEqual(e){return GP(this._delegate,e._delegate)}}class La extends nn{constructor(e,n){super(e,n),this.firestore=e,this._delegate=n}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){const e=this._delegate.parent;return e?new jn(this.firestore,e):null}doc(e){try{return e===void 0?new jn(this.firestore,Rd(this._delegate)):new jn(this.firestore,Rd(this._delegate,e))}catch(n){throw rn(n,"doc()","CollectionReference.doc()")}}add(e){return d3(this._delegate,e).then(n=>new jn(this.firestore,n))}isEqual(e){return MP(this._delegate,e._delegate)}withConverter(e){return new La(this.firestore,e?this._delegate.withConverter(mo.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}function $i(t){return Ie(t,Ke)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hw{constructor(...e){this._delegate=new ri(...e)}static documentId(){return new hw(ot.keyField().canonicalString())}isEqual(e){return e=A(e),e instanceof ri?this._delegate._internalPath.isEqual(e._internalPath):!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pi{constructor(e){this._delegate=e}static serverTimestamp(){const e=_3();return e._methodName="FieldValue.serverTimestamp",new Pi(e)}static delete(){const e=m3();return e._methodName="FieldValue.delete",new Pi(e)}static arrayUnion(...e){const n=y3(...e);return n._methodName="FieldValue.arrayUnion",new Pi(n)}static arrayRemove(...e){const n=v3(...e);return n._methodName="FieldValue.arrayRemove",new Pi(n)}static increment(e){const n=w3(e);return n._methodName="FieldValue.increment",new Pi(n)}isEqual(e){return this._delegate.isEqual(e._delegate)}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const A3={Firestore:tD,GeoPoint:cp,Timestamp:ze,Blob:Zl,Transaction:nD,WriteBatch:rD,DocumentReference:jn,DocumentSnapshot:eu,Query:nn,QueryDocumentSnapshot:tu,QuerySnapshot:Xm,CollectionReference:La,FieldPath:hw,FieldValue:Pi,setLogLevel:S3,CACHE_SIZE_UNLIMITED:kQ};function k3(t,e){t.INTERNAL.registerComponent(new Ee("firestore-compat",n=>{const r=n.getProvider("app-compat").getImmediate(),s=n.getProvider("firestore").getImmediate();return e(r,s)},"PUBLIC").setServiceProps(Object.assign({},A3)))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function R3(t){k3(t,(e,n)=>new tD(e,n,new T3)),t.registerVersion(b3,I3)}R3(ut);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const N3="type.googleapis.com/google.protobuf.Int64Value",P3="type.googleapis.com/google.protobuf.UInt64Value";function oD(t,e){const n={};for(const r in t)t.hasOwnProperty(r)&&(n[r]=e(t[r]));return n}function Zm(t){if(t==null)return null;if(t instanceof Number&&(t=t.valueOf()),typeof t=="number"&&isFinite(t)||t===!0||t===!1||Object.prototype.toString.call(t)==="[object String]")return t;if(t instanceof Date)return t.toISOString();if(Array.isArray(t))return t.map(e=>Zm(e));if(typeof t=="function"||typeof t=="object")return oD(t,e=>Zm(e));throw new Error("Data cannot be encoded in JSON: "+t)}function Pd(t){if(t==null)return t;if(t["@type"])switch(t["@type"]){case N3:case P3:{const e=Number(t.value);if(isNaN(e))throw new Error("Data cannot be decoded from JSON: "+t);return e}default:throw new Error("Data cannot be decoded from JSON: "+t)}return Array.isArray(t)?t.map(e=>Pd(e)):typeof t=="function"||typeof t=="object"?oD(t,e=>Pd(e)):t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aD="functions";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ST={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class la extends lt{constructor(e,n,r){super(`${aD}/${e}`,n||""),this.details=r}}function D3(t){if(t>=200&&t<300)return"ok";switch(t){case 0:return"internal";case 400:return"invalid-argument";case 401:return"unauthenticated";case 403:return"permission-denied";case 404:return"not-found";case 409:return"aborted";case 429:return"resource-exhausted";case 499:return"cancelled";case 500:return"internal";case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline-exceeded"}return"unknown"}function x3(t,e){let n=D3(t),r=n,s;try{const i=e&&e.error;if(i){const o=i.status;if(typeof o=="string"){if(!ST[o])return new la("internal","internal");n=ST[o],r=o}const a=i.message;typeof a=="string"&&(r=a),s=i.details,s!==void 0&&(s=Pd(s))}}catch{}return n==="ok"?null:new la(n,r,s)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O3{constructor(e,n,r){this.auth=null,this.messaging=null,this.appCheck=null,this.auth=e.getImmediate({optional:!0}),this.messaging=n.getImmediate({optional:!0}),this.auth||e.get().then(s=>this.auth=s,()=>{}),this.messaging||n.get().then(s=>this.messaging=s,()=>{}),this.appCheck||r.get().then(s=>this.appCheck=s,()=>{})}async getAuthToken(){if(!!this.auth)try{const e=await this.auth.getToken();return e==null?void 0:e.accessToken}catch{return}}async getMessagingToken(){if(!(!this.messaging||!("Notification"in self)||Notification.permission!=="granted"))try{return await this.messaging.getToken()}catch{return}}async getAppCheckToken(){if(this.appCheck){const e=await this.appCheck.getToken();return e.error?null:e.token}return null}async getContext(){const e=await this.getAuthToken(),n=await this.getMessagingToken(),r=await this.getAppCheckToken();return{authToken:e,messagingToken:n,appCheckToken:r}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CT="us-central1";function M3(t){let e=null;return{promise:new Promise((n,r)=>{e=setTimeout(()=>{r(new la("deadline-exceeded","deadline-exceeded"))},t)}),cancel:()=>{e&&clearTimeout(e)}}}class L3{constructor(e,n,r,s,i=CT,o){this.app=e,this.fetchImpl=o,this.emulatorOrigin=null,this.contextProvider=new O3(n,r,s),this.cancelAllRequests=new Promise(a=>{this.deleteService=()=>Promise.resolve(a())});try{const a=new URL(i);this.customDomain=a.origin,this.region=CT}catch{this.customDomain=null,this.region=i}}_delete(){return this.deleteService()}_url(e){const n=this.app.options.projectId;return this.emulatorOrigin!==null?`${this.emulatorOrigin}/${n}/${this.region}/${e}`:this.customDomain!==null?`${this.customDomain}/${e}`:`https://${this.region}-${n}.cloudfunctions.net/${e}`}}function F3(t,e,n){t.emulatorOrigin=`http://${e}:${n}`}function U3(t,e,n){return r=>B3(t,e,r,n||{})}function $3(t,e,n){return r=>cD(t,e,r,n||{})}async function V3(t,e,n,r){n["Content-Type"]="application/json";let s;try{s=await r(t,{method:"POST",body:JSON.stringify(e),headers:n})}catch{return{status:0,json:null}}let i=null;try{i=await s.json()}catch{}return{status:s.status,json:i}}function B3(t,e,n,r){const s=t._url(e);return cD(t,s,n,r)}async function cD(t,e,n,r){n=Zm(n);const s={data:n},i={},o=await t.contextProvider.getContext();o.authToken&&(i.Authorization="Bearer "+o.authToken),o.messagingToken&&(i["Firebase-Instance-ID-Token"]=o.messagingToken),o.appCheckToken!==null&&(i["X-Firebase-AppCheck"]=o.appCheckToken);const a=r.timeout||7e4,c=M3(a),l=await Promise.race([V3(e,s,i,t.fetchImpl),c.promise,t.cancelAllRequests]);if(c.cancel(),!l)throw new la("cancelled","Firebase Functions instance was deleted.");const u=x3(l.status,l.json);if(u)throw u;if(!l.json)throw new la("internal","Response is not valid JSON object.");let h=l.json.data;if(typeof h=="undefined"&&(h=l.json.result),typeof h=="undefined")throw new la("internal","Response is missing data field.");return{data:Pd(h)}}const AT="@firebase/functions",kT="0.8.4";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const q3="auth-internal",j3="app-check-internal",K3="messaging-internal";function W3(t,e){const n=(r,{instanceIdentifier:s})=>{const i=r.getProvider("app").getImmediate(),o=r.getProvider(q3),a=r.getProvider(K3),c=r.getProvider(j3);return new L3(i,o,a,c,s,t)};nt(new Ee(aD,n,"PUBLIC").setMultipleInstances(!0)),Le(AT,kT,e),Le(AT,kT,"esm2017")}function RT(t,e,n){F3(A(t),e,n)}function H3(t,e,n){return U3(A(t),e,n)}function G3(t,e,n){return $3(A(t),e,n)}W3(fetch.bind(self));const z3="@firebase/functions-compat",Q3="0.2.4";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lD{constructor(e,n){this.app=e,this._delegate=n,this._region=this._delegate.region,this._customDomain=this._delegate.customDomain}httpsCallable(e,n){return H3(this._delegate,e,n)}httpsCallableFromURL(e,n){return G3(this._delegate,e,n)}useFunctionsEmulator(e){const n=e.match("[a-zA-Z]+://([a-zA-Z0-9.-]+)(?::([0-9]+))?");if(n==null)throw new lt("functions","No origin provided to useFunctionsEmulator()");if(n[2]==null)throw new lt("functions","Port missing in origin provided to useFunctionsEmulator()");return RT(this._delegate,n[1],Number(n[2]))}useEmulator(e,n){return RT(this._delegate,e,n)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Y3="us-central1",J3=(t,{instanceIdentifier:e})=>{const n=t.getProvider("app-compat").getImmediate(),r=t.getProvider("functions").getImmediate({identifier:e!=null?e:Y3});return new lD(n,r)};function X3(){const t={Functions:lD};ut.INTERNAL.registerComponent(new Ee("functions-compat",J3,"PUBLIC").setServiceProps(t).setMultipleInstances(!0))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */X3();ut.registerVersion(z3,Q3);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Z3="/firebase-messaging-sw.js",eY="/firebase-cloud-messaging-push-scope",uD="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",tY="https://fcmregistrations.googleapis.com/v1",hD="google.c.a.c_id",nY="google.c.a.c_l",rY="google.c.a.ts",sY="google.c.a.e";var NT;(function(t){t[t.DATA_MESSAGE=1]="DATA_MESSAGE",t[t.DISPLAY_NOTIFICATION=3]="DISPLAY_NOTIFICATION"})(NT||(NT={}));/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License"); you may not use this file except
 * in compliance with the License. You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software distributed under the License
 * is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express
 * or implied. See the License for the specific language governing permissions and limitations under
 * the License.
 */var nu;(function(t){t.PUSH_RECEIVED="push-received",t.NOTIFICATION_CLICKED="notification-clicked"})(nu||(nu={}));/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jr(t){const e=new Uint8Array(t);return btoa(String.fromCharCode(...e)).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function iY(t){const e="=".repeat((4-t.length%4)%4),n=(t+e).replace(/\-/g,"+").replace(/_/g,"/"),r=atob(n),s=new Uint8Array(r.length);for(let i=0;i<r.length;++i)s[i]=r.charCodeAt(i);return s}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cg="fcm_token_details_db",oY=5,PT="fcm_token_object_Store";async function aY(t){if("databases"in indexedDB&&!(await indexedDB.databases()).map(i=>i.name).includes(cg))return null;let e=null;return(await qa(cg,oY,{upgrade:async(r,s,i,o)=>{var a;if(s<2||!r.objectStoreNames.contains(PT))return;const c=o.objectStore(PT),l=await c.index("fcmSenderId").get(t);if(await c.clear(),!!l){if(s===2){const u=l;if(!u.auth||!u.p256dh||!u.endpoint)return;e={token:u.fcmToken,createTime:(a=u.createTime)!==null&&a!==void 0?a:Date.now(),subscriptionOptions:{auth:u.auth,p256dh:u.p256dh,endpoint:u.endpoint,swScope:u.swScope,vapidKey:typeof u.vapidKey=="string"?u.vapidKey:jr(u.vapidKey)}}}else if(s===3){const u=l;e={token:u.fcmToken,createTime:u.createTime,subscriptionOptions:{auth:jr(u.auth),p256dh:jr(u.p256dh),endpoint:u.endpoint,swScope:u.swScope,vapidKey:jr(u.vapidKey)}}}else if(s===4){const u=l;e={token:u.fcmToken,createTime:u.createTime,subscriptionOptions:{auth:jr(u.auth),p256dh:jr(u.p256dh),endpoint:u.endpoint,swScope:u.swScope,vapidKey:jr(u.vapidKey)}}}}}})).close(),await ea(cg),await ea("fcm_vapid_details_db"),await ea("undefined"),cY(e)?e:null}function cY(t){if(!t||!t.subscriptionOptions)return!1;const{subscriptionOptions:e}=t;return typeof t.createTime=="number"&&t.createTime>0&&typeof t.token=="string"&&t.token.length>0&&typeof e.auth=="string"&&e.auth.length>0&&typeof e.p256dh=="string"&&e.p256dh.length>0&&typeof e.endpoint=="string"&&e.endpoint.length>0&&typeof e.swScope=="string"&&e.swScope.length>0&&typeof e.vapidKey=="string"&&e.vapidKey.length>0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lY="firebase-messaging-database",uY=1,_o="firebase-messaging-store";let lg=null;function dw(){return lg||(lg=qa(lY,uY,{upgrade:(t,e)=>{switch(e){case 0:t.createObjectStore(_o)}}})),lg}async function dD(t){const e=pw(t),r=await(await dw()).transaction(_o).objectStore(_o).get(e);if(r)return r;{const s=await aY(t.appConfig.senderId);if(s)return await fw(t,s),s}}async function fw(t,e){const n=pw(t),s=(await dw()).transaction(_o,"readwrite");return await s.objectStore(_o).put(e,n),await s.done,e}async function hY(t){const e=pw(t),r=(await dw()).transaction(_o,"readwrite");await r.objectStore(_o).delete(e),await r.done}function pw({appConfig:t}){return t.appId}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dY={["missing-app-config-values"]:'Missing App configuration value: "{$valueName}"',["only-available-in-window"]:"This method is available in a Window context.",["only-available-in-sw"]:"This method is available in a service worker context.",["permission-default"]:"The notification permission was not granted and dismissed instead.",["permission-blocked"]:"The notification permission was not granted and blocked instead.",["unsupported-browser"]:"This browser doesn't support the API's required to use the Firebase SDK.",["indexed-db-unsupported"]:"This browser doesn't support indexedDb.open() (ex. Safari iFrame, Firefox Private Browsing, etc)",["failed-service-worker-registration"]:"We are unable to register the default service worker. {$browserErrorMessage}",["token-subscribe-failed"]:"A problem occurred while subscribing the user to FCM: {$errorInfo}",["token-subscribe-no-token"]:"FCM returned no token when subscribing the user to push.",["token-unsubscribe-failed"]:"A problem occurred while unsubscribing the user from FCM: {$errorInfo}",["token-update-failed"]:"A problem occurred while updating the user from FCM: {$errorInfo}",["token-update-no-token"]:"FCM returned no token when updating the user to push.",["use-sw-after-get-token"]:"The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.",["invalid-sw-registration"]:"The input to useServiceWorker() must be a ServiceWorkerRegistration.",["invalid-bg-handler"]:"The input to setBackgroundMessageHandler() must be a function.",["invalid-vapid-key"]:"The public VAPID key must be a string.",["use-vapid-key-after-get-token"]:"The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used."},dn=new fn("messaging","Messaging",dY);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function fY(t,e){var n;const r=await mw(t),s=pD(e),i={method:"POST",headers:r,body:JSON.stringify(s)};let o;try{o=await(await fetch(gw(t.appConfig),i)).json()}catch(a){throw dn.create("token-subscribe-failed",{errorInfo:(n=a)===null||n===void 0?void 0:n.toString()})}if(o.error){const a=o.error.message;throw dn.create("token-subscribe-failed",{errorInfo:a})}if(!o.token)throw dn.create("token-subscribe-no-token");return o.token}async function pY(t,e){var n;const r=await mw(t),s=pD(e.subscriptionOptions),i={method:"PATCH",headers:r,body:JSON.stringify(s)};let o;try{o=await(await fetch(`${gw(t.appConfig)}/${e.token}`,i)).json()}catch(a){throw dn.create("token-update-failed",{errorInfo:(n=a)===null||n===void 0?void 0:n.toString()})}if(o.error){const a=o.error.message;throw dn.create("token-update-failed",{errorInfo:a})}if(!o.token)throw dn.create("token-update-no-token");return o.token}async function fD(t,e){var n;const r=await mw(t),s={method:"DELETE",headers:r};try{const o=await(await fetch(`${gw(t.appConfig)}/${e}`,s)).json();if(o.error){const a=o.error.message;throw dn.create("token-unsubscribe-failed",{errorInfo:a})}}catch(i){throw dn.create("token-unsubscribe-failed",{errorInfo:(n=i)===null||n===void 0?void 0:n.toString()})}}function gw({projectId:t}){return`${tY}/projects/${t}/registrations`}async function mw({appConfig:t,installations:e}){const n=await e.getToken();return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t.apiKey,"x-goog-firebase-installations-auth":`FIS ${n}`})}function pD({p256dh:t,auth:e,endpoint:n,vapidKey:r}){const s={web:{endpoint:n,auth:e,p256dh:t}};return r!==uD&&(s.web.applicationPubKey=r),s}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gY=7*24*60*60*1e3;async function mY(t){const e=await yY(t.swRegistration,t.vapidKey),n={vapidKey:t.vapidKey,swScope:t.swRegistration.scope,endpoint:e.endpoint,auth:jr(e.getKey("auth")),p256dh:jr(e.getKey("p256dh"))},r=await dD(t.firebaseDependencies);if(r){if(vY(r.subscriptionOptions,n))return Date.now()>=r.createTime+gY?_Y(t,{token:r.token,createTime:Date.now(),subscriptionOptions:n}):r.token;try{await fD(t.firebaseDependencies,r.token)}catch(s){console.warn(s)}return DT(t.firebaseDependencies,n)}else return DT(t.firebaseDependencies,n)}async function gD(t){const e=await dD(t.firebaseDependencies);e&&(await fD(t.firebaseDependencies,e.token),await hY(t.firebaseDependencies));const n=await t.swRegistration.pushManager.getSubscription();return n?n.unsubscribe():!0}async function _Y(t,e){try{const n=await pY(t.firebaseDependencies,e),r=Object.assign(Object.assign({},e),{token:n,createTime:Date.now()});return await fw(t.firebaseDependencies,r),n}catch(n){throw await gD(t),n}}async function DT(t,e){const r={token:await fY(t,e),createTime:Date.now(),subscriptionOptions:e};return await fw(t,r),r.token}async function yY(t,e){const n=await t.pushManager.getSubscription();return n||t.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:iY(e)})}function vY(t,e){const n=e.vapidKey===t.vapidKey,r=e.endpoint===t.endpoint,s=e.auth===t.auth,i=e.p256dh===t.p256dh;return n&&r&&s&&i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xT(t){const e={from:t.from,collapseKey:t.collapse_key,messageId:t.fcmMessageId};return wY(e,t),bY(e,t),IY(e,t),e}function wY(t,e){if(!e.notification)return;t.notification={};const n=e.notification.title;n&&(t.notification.title=n);const r=e.notification.body;r&&(t.notification.body=r);const s=e.notification.image;s&&(t.notification.image=s)}function bY(t,e){!e.data||(t.data=e.data)}function IY(t,e){var n,r,s,i,o;if(!e.fcmOptions&&!(!((n=e.notification)===null||n===void 0)&&n.click_action))return;t.fcmOptions={};const a=(s=(r=e.fcmOptions)===null||r===void 0?void 0:r.link)!==null&&s!==void 0?s:(i=e.notification)===null||i===void 0?void 0:i.click_action;a&&(t.fcmOptions.link=a);const c=(o=e.fcmOptions)===null||o===void 0?void 0:o.analytics_label;c&&(t.fcmOptions.analyticsLabel=c)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function EY(t){return typeof t=="object"&&!!t&&hD in t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */mD("hts/frbslgigp.ogepscmv/ieo/eaylg","tp:/ieaeogn-agolai.o/1frlglgc/o");mD("AzSCbw63g1R0nCw85jG8","Iaya3yLKwmgvh7cF0q4");function mD(t,e){const n=[];for(let r=0;r<t.length;r++)n.push(t.charAt(r)),r<e.length&&n.push(e.charAt(r));return n.join("")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function TY(t){if(!t||!t.options)throw ug("App Configuration Object");if(!t.name)throw ug("App Name");const e=["projectId","apiKey","appId","messagingSenderId"],{options:n}=t;for(const r of e)if(!n[r])throw ug(r);return{appName:t.name,projectId:n.projectId,apiKey:n.apiKey,appId:n.appId,senderId:n.messagingSenderId}}function ug(t){return dn.create("missing-app-config-values",{valueName:t})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SY{constructor(e,n,r){this.deliveryMetricsExportedToBigQueryEnabled=!1,this.onBackgroundMessageHandler=null,this.onMessageHandler=null,this.logEvents=[],this.isLogServiceStarted=!1;const s=TY(e);this.firebaseDependencies={app:e,appConfig:s,installations:n,analyticsProvider:r}}_delete(){return Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _D(t){var e;try{t.swRegistration=await navigator.serviceWorker.register(Z3,{scope:eY}),t.swRegistration.update().catch(()=>{})}catch(n){throw dn.create("failed-service-worker-registration",{browserErrorMessage:(e=n)===null||e===void 0?void 0:e.message})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function CY(t,e){if(!e&&!t.swRegistration&&await _D(t),!(!e&&!!t.swRegistration)){if(!(e instanceof ServiceWorkerRegistration))throw dn.create("invalid-sw-registration");t.swRegistration=e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function AY(t,e){e?t.vapidKey=e:t.vapidKey||(t.vapidKey=uD)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function yD(t,e){if(!navigator)throw dn.create("only-available-in-window");if(Notification.permission==="default"&&await Notification.requestPermission(),Notification.permission!=="granted")throw dn.create("permission-blocked");return await AY(t,e==null?void 0:e.vapidKey),await CY(t,e==null?void 0:e.serviceWorkerRegistration),mY(t)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function kY(t,e,n){const r=RY(e);(await t.firebaseDependencies.analyticsProvider.get()).logEvent(r,{message_id:n[hD],message_name:n[nY],message_time:n[rY],message_device_time:Math.floor(Date.now()/1e3)})}function RY(t){switch(t){case nu.NOTIFICATION_CLICKED:return"notification_open";case nu.PUSH_RECEIVED:return"notification_foreground";default:throw new Error}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function NY(t,e){const n=e.data;if(!n.isFirebaseMessaging)return;t.onMessageHandler&&n.messageType===nu.PUSH_RECEIVED&&(typeof t.onMessageHandler=="function"?t.onMessageHandler(xT(n)):t.onMessageHandler.next(xT(n)));const r=n.data;EY(r)&&r[sY]==="1"&&await kY(t,n.messageType,r)}const OT="@firebase/messaging",MT="0.9.16";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PY=t=>{const e=new SY(t.getProvider("app").getImmediate(),t.getProvider("installations-internal").getImmediate(),t.getProvider("analytics-internal"));return navigator.serviceWorker.addEventListener("message",n=>NY(e,n)),e},DY=t=>{const e=t.getProvider("messaging").getImmediate();return{getToken:r=>yD(e,r)}};function xY(){nt(new Ee("messaging",PY,"PUBLIC")),nt(new Ee("messaging-internal",DY,"PRIVATE")),Le(OT,MT),Le(OT,MT,"esm2017")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function OY(t){if(!navigator)throw dn.create("only-available-in-window");return t.swRegistration||await _D(t),gD(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function MY(t,e){if(!navigator)throw dn.create("only-available-in-window");return t.onMessageHandler=e,()=>{t.onMessageHandler=null}}async function LY(t,e){return t=A(t),yD(t,e)}function FY(t){return t=A(t),OY(t)}function UY(t,e){return t=A(t),MY(t,e)}xY();/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vD="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",$Y="https://fcmregistrations.googleapis.com/v1",wD="FCM_MSG",VY="google.c.a.c_id",BY=3,qY=1;var Dd;(function(t){t[t.DATA_MESSAGE=1]="DATA_MESSAGE",t[t.DISPLAY_NOTIFICATION=3]="DISPLAY_NOTIFICATION"})(Dd||(Dd={}));/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License"); you may not use this file except
 * in compliance with the License. You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software distributed under the License
 * is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express
 * or implied. See the License for the specific language governing permissions and limitations under
 * the License.
 */var xd;(function(t){t.PUSH_RECEIVED="push-received",t.NOTIFICATION_CLICKED="notification-clicked"})(xd||(xd={}));/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kr(t){const e=new Uint8Array(t);return btoa(String.fromCharCode(...e)).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function jY(t){const e="=".repeat((4-t.length%4)%4),n=(t+e).replace(/\-/g,"+").replace(/_/g,"/"),r=atob(n),s=new Uint8Array(r.length);for(let i=0;i<r.length;++i)s[i]=r.charCodeAt(i);return s}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hg="fcm_token_details_db",KY=5,LT="fcm_token_object_Store";async function WY(t){if("databases"in indexedDB&&!(await indexedDB.databases()).map(i=>i.name).includes(hg))return null;let e=null;return(await qa(hg,KY,{upgrade:async(r,s,i,o)=>{var a;if(s<2||!r.objectStoreNames.contains(LT))return;const c=o.objectStore(LT),l=await c.index("fcmSenderId").get(t);if(await c.clear(),!!l){if(s===2){const u=l;if(!u.auth||!u.p256dh||!u.endpoint)return;e={token:u.fcmToken,createTime:(a=u.createTime)!==null&&a!==void 0?a:Date.now(),subscriptionOptions:{auth:u.auth,p256dh:u.p256dh,endpoint:u.endpoint,swScope:u.swScope,vapidKey:typeof u.vapidKey=="string"?u.vapidKey:Kr(u.vapidKey)}}}else if(s===3){const u=l;e={token:u.fcmToken,createTime:u.createTime,subscriptionOptions:{auth:Kr(u.auth),p256dh:Kr(u.p256dh),endpoint:u.endpoint,swScope:u.swScope,vapidKey:Kr(u.vapidKey)}}}else if(s===4){const u=l;e={token:u.fcmToken,createTime:u.createTime,subscriptionOptions:{auth:Kr(u.auth),p256dh:Kr(u.p256dh),endpoint:u.endpoint,swScope:u.swScope,vapidKey:Kr(u.vapidKey)}}}}}})).close(),await ea(hg),await ea("fcm_vapid_details_db"),await ea("undefined"),HY(e)?e:null}function HY(t){if(!t||!t.subscriptionOptions)return!1;const{subscriptionOptions:e}=t;return typeof t.createTime=="number"&&t.createTime>0&&typeof t.token=="string"&&t.token.length>0&&typeof e.auth=="string"&&e.auth.length>0&&typeof e.p256dh=="string"&&e.p256dh.length>0&&typeof e.endpoint=="string"&&e.endpoint.length>0&&typeof e.swScope=="string"&&e.swScope.length>0&&typeof e.vapidKey=="string"&&e.vapidKey.length>0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GY="firebase-messaging-database",zY=1,yo="firebase-messaging-store";let dg=null;function _w(){return dg||(dg=qa(GY,zY,{upgrade:(t,e)=>{switch(e){case 0:t.createObjectStore(yo)}}})),dg}async function yw(t){const e=ww(t),r=await(await _w()).transaction(yo).objectStore(yo).get(e);if(r)return r;{const s=await WY(t.appConfig.senderId);if(s)return await vw(t,s),s}}async function vw(t,e){const n=ww(t),s=(await _w()).transaction(yo,"readwrite");return await s.objectStore(yo).put(e,n),await s.done,e}async function QY(t){const e=ww(t),r=(await _w()).transaction(yo,"readwrite");await r.objectStore(yo).delete(e),await r.done}function ww({appConfig:t}){return t.appId}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YY={["missing-app-config-values"]:'Missing App configuration value: "{$valueName}"',["only-available-in-window"]:"This method is available in a Window context.",["only-available-in-sw"]:"This method is available in a service worker context.",["permission-default"]:"The notification permission was not granted and dismissed instead.",["permission-blocked"]:"The notification permission was not granted and blocked instead.",["unsupported-browser"]:"This browser doesn't support the API's required to use the Firebase SDK.",["indexed-db-unsupported"]:"This browser doesn't support indexedDb.open() (ex. Safari iFrame, Firefox Private Browsing, etc)",["failed-service-worker-registration"]:"We are unable to register the default service worker. {$browserErrorMessage}",["token-subscribe-failed"]:"A problem occurred while subscribing the user to FCM: {$errorInfo}",["token-subscribe-no-token"]:"FCM returned no token when subscribing the user to push.",["token-unsubscribe-failed"]:"A problem occurred while unsubscribing the user from FCM: {$errorInfo}",["token-update-failed"]:"A problem occurred while updating the user from FCM: {$errorInfo}",["token-update-no-token"]:"FCM returned no token when updating the user to push.",["use-sw-after-get-token"]:"The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.",["invalid-sw-registration"]:"The input to useServiceWorker() must be a ServiceWorkerRegistration.",["invalid-bg-handler"]:"The input to setBackgroundMessageHandler() must be a function.",["invalid-vapid-key"]:"The public VAPID key must be a string.",["use-vapid-key-after-get-token"]:"The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used."},Nr=new fn("messaging","Messaging",YY);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function JY(t,e){var n;const r=await Iw(t),s=ID(e),i={method:"POST",headers:r,body:JSON.stringify(s)};let o;try{o=await(await fetch(bw(t.appConfig),i)).json()}catch(a){throw Nr.create("token-subscribe-failed",{errorInfo:(n=a)===null||n===void 0?void 0:n.toString()})}if(o.error){const a=o.error.message;throw Nr.create("token-subscribe-failed",{errorInfo:a})}if(!o.token)throw Nr.create("token-subscribe-no-token");return o.token}async function XY(t,e){var n;const r=await Iw(t),s=ID(e.subscriptionOptions),i={method:"PATCH",headers:r,body:JSON.stringify(s)};let o;try{o=await(await fetch(`${bw(t.appConfig)}/${e.token}`,i)).json()}catch(a){throw Nr.create("token-update-failed",{errorInfo:(n=a)===null||n===void 0?void 0:n.toString()})}if(o.error){const a=o.error.message;throw Nr.create("token-update-failed",{errorInfo:a})}if(!o.token)throw Nr.create("token-update-no-token");return o.token}async function bD(t,e){var n;const r=await Iw(t),s={method:"DELETE",headers:r};try{const o=await(await fetch(`${bw(t.appConfig)}/${e}`,s)).json();if(o.error){const a=o.error.message;throw Nr.create("token-unsubscribe-failed",{errorInfo:a})}}catch(i){throw Nr.create("token-unsubscribe-failed",{errorInfo:(n=i)===null||n===void 0?void 0:n.toString()})}}function bw({projectId:t}){return`${$Y}/projects/${t}/registrations`}async function Iw({appConfig:t,installations:e}){const n=await e.getToken();return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t.apiKey,"x-goog-firebase-installations-auth":`FIS ${n}`})}function ID({p256dh:t,auth:e,endpoint:n,vapidKey:r}){const s={web:{endpoint:n,auth:e,p256dh:t}};return r!==vD&&(s.web.applicationPubKey=r),s}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZY=7*24*60*60*1e3;async function e5(t){const e=await n5(t.swRegistration,t.vapidKey),n={vapidKey:t.vapidKey,swScope:t.swRegistration.scope,endpoint:e.endpoint,auth:Kr(e.getKey("auth")),p256dh:Kr(e.getKey("p256dh"))},r=await yw(t.firebaseDependencies);if(r){if(r5(r.subscriptionOptions,n))return Date.now()>=r.createTime+ZY?t5(t,{token:r.token,createTime:Date.now(),subscriptionOptions:n}):r.token;try{await bD(t.firebaseDependencies,r.token)}catch(s){console.warn(s)}return FT(t.firebaseDependencies,n)}else return FT(t.firebaseDependencies,n)}async function e_(t){const e=await yw(t.firebaseDependencies);e&&(await bD(t.firebaseDependencies,e.token),await QY(t.firebaseDependencies));const n=await t.swRegistration.pushManager.getSubscription();return n?n.unsubscribe():!0}async function t5(t,e){try{const n=await XY(t.firebaseDependencies,e),r=Object.assign(Object.assign({},e),{token:n,createTime:Date.now()});return await vw(t.firebaseDependencies,r),n}catch(n){throw await e_(t),n}}async function FT(t,e){const r={token:await JY(t,e),createTime:Date.now(),subscriptionOptions:e};return await vw(t,r),r.token}async function n5(t,e){const n=await t.pushManager.getSubscription();return n||t.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:jY(e)})}function r5(t,e){const n=e.vapidKey===t.vapidKey,r=e.endpoint===t.endpoint,s=e.auth===t.auth,i=e.p256dh===t.p256dh;return n&&r&&s&&i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function s5(t){const e={from:t.from,collapseKey:t.collapse_key,messageId:t.fcmMessageId};return i5(e,t),o5(e,t),a5(e,t),e}function i5(t,e){if(!e.notification)return;t.notification={};const n=e.notification.title;n&&(t.notification.title=n);const r=e.notification.body;r&&(t.notification.body=r);const s=e.notification.image;s&&(t.notification.image=s)}function o5(t,e){!e.data||(t.data=e.data)}function a5(t,e){var n,r,s,i,o;if(!e.fcmOptions&&!(!((n=e.notification)===null||n===void 0)&&n.click_action))return;t.fcmOptions={};const a=(s=(r=e.fcmOptions)===null||r===void 0?void 0:r.link)!==null&&s!==void 0?s:(i=e.notification)===null||i===void 0?void 0:i.click_action;a&&(t.fcmOptions.link=a);const c=(o=e.fcmOptions)===null||o===void 0?void 0:o.analytics_label;c&&(t.fcmOptions.analyticsLabel=c)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function c5(t){return typeof t=="object"&&!!t&&VY in t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function l5(t){return new Promise(e=>{setTimeout(e,t)})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ED("hts/frbslgigp.ogepscmv/ieo/eaylg","tp:/ieaeogn-agolai.o/1frlglgc/o");ED("AzSCbw63g1R0nCw85jG8","Iaya3yLKwmgvh7cF0q4");async function u5(t,e){const n=h5(e,await t.firebaseDependencies.installations.getId());d5(t,n)}function h5(t,e){var n,r;const s={};return t.from&&(s.project_number=t.from),t.fcmMessageId&&(s.message_id=t.fcmMessageId),s.instance_id=e,t.notification?s.message_type=Dd.DISPLAY_NOTIFICATION.toString():s.message_type=Dd.DATA_MESSAGE.toString(),s.sdk_platform=BY.toString(),s.package_name=self.origin.replace(/(^\w+:|^)\/\//,""),t.collapse_key&&(s.collapse_key=t.collapse_key),s.event=qY.toString(),!((n=t.fcmOptions)===null||n===void 0)&&n.analytics_label&&(s.analytics_label=(r=t.fcmOptions)===null||r===void 0?void 0:r.analytics_label),s}function d5(t,e){const n={};n.event_time_ms=Math.floor(Date.now()).toString(),n.source_extension_json_proto3=JSON.stringify(e),t.logEvents.push(n)}function ED(t,e){const n=[];for(let r=0;r<t.length;r++)n.push(t.charAt(r)),r<e.length&&n.push(e.charAt(r));return n.join("")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function f5(t,e){var n,r;const{newSubscription:s}=t;if(!s){await e_(e);return}const i=await yw(e.firebaseDependencies);await e_(e),e.vapidKey=(r=(n=i==null?void 0:i.subscriptionOptions)===null||n===void 0?void 0:n.vapidKey)!==null&&r!==void 0?r:vD,await e5(e)}async function p5(t,e){const n=_5(t);if(!n)return;e.deliveryMetricsExportedToBigQueryEnabled&&await u5(e,n);const r=await TD();if(v5(r))return w5(r,n);if(n.notification&&await b5(m5(n)),!!e&&e.onBackgroundMessageHandler){const s=s5(n);typeof e.onBackgroundMessageHandler=="function"?await e.onBackgroundMessageHandler(s):e.onBackgroundMessageHandler.next(s)}}async function g5(t){var e,n;const r=(n=(e=t.notification)===null||e===void 0?void 0:e.data)===null||n===void 0?void 0:n[wD];if(r){if(t.action)return}else return;t.stopImmediatePropagation(),t.notification.close();const s=I5(r);if(!s)return;const i=new URL(s,self.location.href),o=new URL(self.location.origin);if(i.host!==o.host)return;let a=await y5(i);if(a?a=await a.focus():(a=await self.clients.openWindow(s),await l5(3e3)),!!a)return r.messageType=xd.NOTIFICATION_CLICKED,r.isFirebaseMessaging=!0,a.postMessage(r)}function m5(t){const e=Object.assign({},t.notification);return e.data={[wD]:t},e}function _5({data:t}){if(!t)return null;try{return t.json()}catch{return null}}async function y5(t){const e=await TD();for(const n of e){const r=new URL(n.url,self.location.href);if(t.host===r.host)return n}return null}function v5(t){return t.some(e=>e.visibilityState==="visible"&&!e.url.startsWith("chrome-extension://"))}function w5(t,e){e.isFirebaseMessaging=!0,e.messageType=xd.PUSH_RECEIVED;for(const n of t)n.postMessage(e)}function TD(){return self.clients.matchAll({type:"window",includeUncontrolled:!0})}function b5(t){var e;const{actions:n}=t,{maxActions:r}=Notification;return n&&r&&n.length>r&&console.warn(`This browser only supports ${r} actions. The remaining actions will not be displayed.`),self.registration.showNotification((e=t.title)!==null&&e!==void 0?e:"",t)}function I5(t){var e,n,r;const s=(n=(e=t.fcmOptions)===null||e===void 0?void 0:e.link)!==null&&n!==void 0?n:(r=t.notification)===null||r===void 0?void 0:r.click_action;return s||(c5(t.data)?self.location.origin:null)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function E5(t){if(!t||!t.options)throw fg("App Configuration Object");if(!t.name)throw fg("App Name");const e=["projectId","apiKey","appId","messagingSenderId"],{options:n}=t;for(const r of e)if(!n[r])throw fg(r);return{appName:t.name,projectId:n.projectId,apiKey:n.apiKey,appId:n.appId,senderId:n.messagingSenderId}}function fg(t){return Nr.create("missing-app-config-values",{valueName:t})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T5{constructor(e,n,r){this.deliveryMetricsExportedToBigQueryEnabled=!1,this.onBackgroundMessageHandler=null,this.onMessageHandler=null,this.logEvents=[],this.isLogServiceStarted=!1;const s=E5(e);this.firebaseDependencies={app:e,appConfig:s,installations:n,analyticsProvider:r}}_delete(){return Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const S5=t=>{const e=new T5(t.getProvider("app").getImmediate(),t.getProvider("installations-internal").getImmediate(),t.getProvider("analytics-internal"));return self.addEventListener("push",n=>{n.waitUntil(p5(n,e))}),self.addEventListener("pushsubscriptionchange",n=>{n.waitUntil(f5(n,e))}),self.addEventListener("notificationclick",n=>{n.waitUntil(g5(n))}),e};function C5(){nt(new Ee("messaging-sw",S5,"PUBLIC"))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function A5(t,e){if(self.document!==void 0)throw Nr.create("only-available-in-sw");return t.onBackgroundMessageHandler=e,()=>{t.onBackgroundMessageHandler=null}}function k5(t,e){return t=A(t),A5(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */C5();const R5="@firebase/messaging-compat",N5="0.1.16";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function P5(){return self&&"ServiceWorkerGlobalScope"in self?x5():D5()}function D5(){return typeof window!="undefined"&&In()&&ef()&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")}function x5(){return In()&&"PushManager"in self&&"Notification"in self&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")}class UT{constructor(e,n){this.app=e,this._delegate=n,this.app=e,this._delegate=n}async getToken(e){return LY(this._delegate,e)}async deleteToken(){return FY(this._delegate)}onMessage(e){return UY(this._delegate,e)}onBackgroundMessage(e){return k5(this._delegate,e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const O5=t=>self&&"ServiceWorkerGlobalScope"in self?new UT(t.getProvider("app-compat").getImmediate(),t.getProvider("messaging-sw").getImmediate()):new UT(t.getProvider("app-compat").getImmediate(),t.getProvider("messaging").getImmediate()),M5={isSupported:P5};function L5(){ut.INTERNAL.registerComponent(new Ee("messaging-compat",O5,"PUBLIC").setServiceProps(M5))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */L5();ut.registerVersion(R5,N5);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SD="firebasestorage.googleapis.com",CD="storageBucket",F5=2*60*1e3,U5=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class it extends lt{constructor(e,n){super(pg(e),`Firebase Storage: ${n} (${pg(e)})`),this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,it.prototype)}_codeEquals(e){return pg(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}function pg(t){return"storage/"+t}function Ew(){const t="An unknown error occurred, please check the error payload for server response.";return new it("unknown",t)}function $5(t){return new it("object-not-found","Object '"+t+"' does not exist.")}function V5(t){return new it("quota-exceeded","Quota for bucket '"+t+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function B5(){const t="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new it("unauthenticated",t)}function q5(){return new it("unauthorized-app","This app does not have permission to access Firebase Storage on this project.")}function j5(t){return new it("unauthorized","User does not have permission to access '"+t+"'.")}function K5(){return new it("retry-limit-exceeded","Max retry time for operation exceeded, please try again.")}function AD(){return new it("canceled","User canceled the upload/download.")}function W5(t){return new it("invalid-url","Invalid URL '"+t+"'.")}function H5(t){return new it("invalid-default-bucket","Invalid default bucket '"+t+"'.")}function G5(){return new it("no-default-bucket","No default bucket found. Did you set the '"+CD+"' property when initializing the app?")}function kD(){return new it("cannot-slice-blob","Cannot slice blob for upload. Please retry the upload.")}function z5(){return new it("server-file-wrong-size","Server recorded incorrect upload file size, please retry the upload.")}function Q5(){return new it("no-download-url","The given file does not have any download URLs.")}function ua(t){return new it("invalid-argument",t)}function RD(){return new it("app-deleted","The Firebase app was deleted.")}function ND(t){return new it("invalid-root-operation","The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function tl(t,e){return new it("invalid-format","String does not match format '"+t+"': "+e)}function Sc(t){throw new it("internal-error","Internal error: "+t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yt{constructor(e,n){this.bucket=e,this.path_=n}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,n){let r;try{r=Yt.makeFromUrl(e,n)}catch{return new Yt(e,"")}if(r.path==="")return r;throw H5(e)}static makeFromUrl(e,n){let r=null;const s="([A-Za-z0-9.\\-_]+)";function i(M){M.path.charAt(M.path.length-1)==="/"&&(M.path_=M.path_.slice(0,-1))}const o="(/(.*))?$",a=new RegExp("^gs://"+s+o,"i"),c={bucket:1,path:3};function l(M){M.path_=decodeURIComponent(M.path)}const u="v[A-Za-z0-9_]+",h=n.replace(/[.]/g,"\\."),d="(/([^?#]*).*)?$",f=new RegExp(`^https?://${h}/${u}/b/${s}/o${d}`,"i"),p={bucket:1,path:3},_=n===SD?"(?:storage.googleapis.com|storage.cloud.google.com)":n,y="([^?#]*)",I=new RegExp(`^https?://${_}/${s}/${y}`,"i"),k=[{regex:a,indices:c,postModify:i},{regex:f,indices:p,postModify:l},{regex:I,indices:{bucket:1,path:2},postModify:l}];for(let M=0;M<k.length;M++){const j=k[M],Y=j.regex.exec(e);if(Y){const z=Y[j.indices.bucket];let V=Y[j.indices.path];V||(V=""),r=new Yt(z,V),j.postModify(r);break}}if(r==null)throw W5(e);return r}}class Y5{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function J5(t,e,n){let r=1,s=null,i=null,o=!1,a=0;function c(){return a===2}let l=!1;function u(...y){l||(l=!0,e.apply(null,y))}function h(y){s=setTimeout(()=>{s=null,t(f,c())},y)}function d(){i&&clearTimeout(i)}function f(y,...I){if(l){d();return}if(y){d(),u.call(null,y,...I);return}if(c()||o){d(),u.call(null,y,...I);return}r<64&&(r*=2);let k;a===1?(a=2,k=0):k=(r+Math.random())*1e3,h(k)}let p=!1;function _(y){p||(p=!0,d(),!l&&(s!==null?(y||(a=2),clearTimeout(s),h(0)):y||(a=1)))}return h(0),i=setTimeout(()=>{o=!0,_(!0)},n),_}function X5(t){t(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Z5(t){return t!==void 0}function e8(t){return typeof t=="function"}function t8(t){return typeof t=="object"&&!Array.isArray(t)}function pp(t){return typeof t=="string"||t instanceof String}function $T(t){return Tw()&&t instanceof Blob}function Tw(){return typeof Blob!="undefined"}function t_(t,e,n,r){if(r<e)throw ua(`Invalid value for '${t}'. Expected ${e} or greater.`);if(r>n)throw ua(`Invalid value for '${t}'. Expected ${n} or less.`)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fi(t,e,n){let r=e;return n==null&&(r=`https://${e}`),`${n}://${r}/v0${t}`}function PD(t){const e=encodeURIComponent;let n="?";for(const r in t)if(t.hasOwnProperty(r)){const s=e(r)+"="+e(t[r]);n=n+s+"&"}return n=n.slice(0,-1),n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Hi;(function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"})(Hi||(Hi={}));/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class n8{constructor(e,n,r,s,i,o,a,c,l,u,h){this.url_=e,this.method_=n,this.headers_=r,this.body_=s,this.successCodes_=i,this.additionalRetryCodes_=o,this.callback_=a,this.errorCallback_=c,this.timeout_=l,this.progressCallback_=u,this.connectionFactory_=h,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((d,f)=>{this.resolve_=d,this.reject_=f,this.start_()})}start_(){const e=(r,s)=>{if(s){r(!1,new lh(!1,null,!0));return}const i=this.connectionFactory_();this.pendingConnection_=i;const o=a=>{const c=a.loaded,l=a.lengthComputable?a.total:-1;this.progressCallback_!==null&&this.progressCallback_(c,l)};this.progressCallback_!==null&&i.addUploadProgressListener(o),i.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&i.removeUploadProgressListener(o),this.pendingConnection_=null;const a=i.getErrorCode()===Hi.NO_ERROR,c=i.getStatus();if(!a||this.isRetryStatusCode_(c)){const u=i.getErrorCode()===Hi.ABORT;r(!1,new lh(!1,null,u));return}const l=this.successCodes_.indexOf(c)!==-1;r(!0,new lh(l,i))})},n=(r,s)=>{const i=this.resolve_,o=this.reject_,a=s.connection;if(s.wasSuccessCode)try{const c=this.callback_(a,a.getResponse());Z5(c)?i(c):i()}catch(c){o(c)}else if(a!==null){const c=Ew();c.serverResponse=a.getErrorText(),this.errorCallback_?o(this.errorCallback_(a,c)):o(c)}else if(s.canceled){const c=this.appDelete_?RD():AD();o(c)}else{const c=K5();o(c)}};this.canceled_?n(!1,new lh(!1,null,!0)):this.backoffId_=J5(e,n,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&X5(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}isRetryStatusCode_(e){const n=e>=500&&e<600,s=[408,429].indexOf(e)!==-1,i=this.additionalRetryCodes_.indexOf(e)!==-1;return n||s||i}}class lh{constructor(e,n,r){this.wasSuccessCode=e,this.connection=n,this.canceled=!!r}}function r8(t,e){e!==null&&e.length>0&&(t.Authorization="Firebase "+e)}function s8(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(e!=null?e:"AppManager")}function i8(t,e){e&&(t["X-Firebase-GMPID"]=e)}function o8(t,e){e!==null&&(t["X-Firebase-AppCheck"]=e)}function a8(t,e,n,r,s,i){const o=PD(t.urlParams),a=t.url+o,c=Object.assign({},t.headers);return i8(c,e),r8(c,n),s8(c,i),o8(c,r),new n8(a,t.method,c,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,s)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function c8(){return typeof BlobBuilder!="undefined"?BlobBuilder:typeof WebKitBlobBuilder!="undefined"?WebKitBlobBuilder:void 0}function l8(...t){const e=c8();if(e!==void 0){const n=new e;for(let r=0;r<t.length;r++)n.append(t[r]);return n.getBlob()}else{if(Tw())return new Blob(t);throw new it("unsupported-environment","This browser doesn't seem to support creating Blobs")}}function u8(t,e,n){return t.webkitSlice?t.webkitSlice(e,n):t.mozSlice?t.mozSlice(e,n):t.slice?t.slice(e,n):null}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function h8(t){return atob(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kn={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class gg{constructor(e,n){this.data=e,this.contentType=n||null}}function DD(t,e){switch(t){case Kn.RAW:return new gg(xD(e));case Kn.BASE64:case Kn.BASE64URL:return new gg(OD(t,e));case Kn.DATA_URL:return new gg(f8(e),p8(e))}throw Ew()}function xD(t){const e=[];for(let n=0;n<t.length;n++){let r=t.charCodeAt(n);if(r<=127)e.push(r);else if(r<=2047)e.push(192|r>>6,128|r&63);else if((r&64512)===55296)if(!(n<t.length-1&&(t.charCodeAt(n+1)&64512)===56320))e.push(239,191,189);else{const i=r,o=t.charCodeAt(++n);r=65536|(i&1023)<<10|o&1023,e.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|r&63)}else(r&64512)===56320?e.push(239,191,189):e.push(224|r>>12,128|r>>6&63,128|r&63)}return new Uint8Array(e)}function d8(t){let e;try{e=decodeURIComponent(t)}catch{throw tl(Kn.DATA_URL,"Malformed data URL.")}return xD(e)}function OD(t,e){switch(t){case Kn.BASE64:{const s=e.indexOf("-")!==-1,i=e.indexOf("_")!==-1;if(s||i)throw tl(t,"Invalid character '"+(s?"-":"_")+"' found: is it base64url encoded?");break}case Kn.BASE64URL:{const s=e.indexOf("+")!==-1,i=e.indexOf("/")!==-1;if(s||i)throw tl(t,"Invalid character '"+(s?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let n;try{n=h8(e)}catch{throw tl(t,"Invalid character found")}const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}class MD{constructor(e){this.base64=!1,this.contentType=null;const n=e.match(/^data:([^,]+)?,/);if(n===null)throw tl(Kn.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const r=n[1]||null;r!=null&&(this.base64=g8(r,";base64"),this.contentType=this.base64?r.substring(0,r.length-7):r),this.rest=e.substring(e.indexOf(",")+1)}}function f8(t){const e=new MD(t);return e.base64?OD(Kn.BASE64,e.rest):d8(e.rest)}function p8(t){return new MD(t).contentType}function g8(t,e){return t.length>=e.length?t.substring(t.length-e.length)===e:!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gr{constructor(e,n){let r=0,s="";$T(e)?(this.data_=e,r=e.size,s=e.type):e instanceof ArrayBuffer?(n?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),r=this.data_.length):e instanceof Uint8Array&&(n?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),r=e.length),this.size_=r,this.type_=s}size(){return this.size_}type(){return this.type_}slice(e,n){if($T(this.data_)){const r=this.data_,s=u8(r,e,n);return s===null?null:new Gr(s)}else{const r=new Uint8Array(this.data_.buffer,e,n-e);return new Gr(r,!0)}}static getBlob(...e){if(Tw()){const n=e.map(r=>r instanceof Gr?r.data_:r);return new Gr(l8.apply(null,n))}else{const n=e.map(o=>pp(o)?DD(Kn.RAW,o).data:o.data_);let r=0;n.forEach(o=>{r+=o.byteLength});const s=new Uint8Array(r);let i=0;return n.forEach(o=>{for(let a=0;a<o.length;a++)s[i++]=o[a]}),new Gr(s,!0)}}uploadData(){return this.data_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sw(t){let e;try{e=JSON.parse(t)}catch{return null}return t8(e)?e:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function m8(t){if(t.length===0)return null;const e=t.lastIndexOf("/");return e===-1?"":t.slice(0,e)}function _8(t,e){const n=e.split("/").filter(r=>r.length>0).join("/");return t.length===0?n:t+"/"+n}function LD(t){const e=t.lastIndexOf("/",t.length-2);return e===-1?t:t.slice(e+1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function y8(t,e){return e}class en{constructor(e,n,r,s){this.server=e,this.local=n||e,this.writable=!!r,this.xform=s||y8}}let uh=null;function v8(t){return!pp(t)||t.length<2?t:LD(t)}function gp(){if(uh)return uh;const t=[];t.push(new en("bucket")),t.push(new en("generation")),t.push(new en("metageneration")),t.push(new en("name","fullPath",!0));function e(i,o){return v8(o)}const n=new en("name");n.xform=e,t.push(n);function r(i,o){return o!==void 0?Number(o):o}const s=new en("size");return s.xform=r,t.push(s),t.push(new en("timeCreated")),t.push(new en("updated")),t.push(new en("md5Hash",null,!0)),t.push(new en("cacheControl",null,!0)),t.push(new en("contentDisposition",null,!0)),t.push(new en("contentEncoding",null,!0)),t.push(new en("contentLanguage",null,!0)),t.push(new en("contentType",null,!0)),t.push(new en("metadata","customMetadata",!0)),uh=t,uh}function w8(t,e){function n(){const r=t.bucket,s=t.fullPath,i=new Yt(r,s);return e._makeStorageReference(i)}Object.defineProperty(t,"ref",{get:n})}function b8(t,e,n){const r={};r.type="file";const s=n.length;for(let i=0;i<s;i++){const o=n[i];r[o.local]=o.xform(r,e[o.server])}return w8(r,t),r}function FD(t,e,n){const r=Sw(e);return r===null?null:b8(t,r,n)}function I8(t,e,n,r){const s=Sw(e);if(s===null||!pp(s.downloadTokens))return null;const i=s.downloadTokens;if(i.length===0)return null;const o=encodeURIComponent;return i.split(",").map(l=>{const u=t.bucket,h=t.fullPath,d="/b/"+o(u)+"/o/"+o(h),f=fi(d,n,r),p=PD({alt:"media",token:l});return f+p})[0]}function Cw(t,e){const n={},r=e.length;for(let s=0;s<r;s++){const i=e[s];i.writable&&(n[i.server]=t[i.local])}return JSON.stringify(n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VT="prefixes",BT="items";function E8(t,e,n){const r={prefixes:[],items:[],nextPageToken:n.nextPageToken};if(n[VT])for(const s of n[VT]){const i=s.replace(/\/$/,""),o=t._makeStorageReference(new Yt(e,i));r.prefixes.push(o)}if(n[BT])for(const s of n[BT]){const i=t._makeStorageReference(new Yt(e,s.name));r.items.push(i)}return r}function T8(t,e,n){const r=Sw(n);return r===null?null:E8(t,e,r)}class gs{constructor(e,n,r,s){this.url=e,this.method=n,this.handler=r,this.timeout=s,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pr(t){if(!t)throw Ew()}function mp(t,e){function n(r,s){const i=FD(t,s,e);return Pr(i!==null),i}return n}function S8(t,e){function n(r,s){const i=T8(t,e,s);return Pr(i!==null),i}return n}function C8(t,e){function n(r,s){const i=FD(t,s,e);return Pr(i!==null),I8(i,s,t.host,t._protocol)}return n}function ac(t){function e(n,r){let s;return n.getStatus()===401?n.getErrorText().includes("Firebase App Check token is invalid")?s=q5():s=B5():n.getStatus()===402?s=V5(t.bucket):n.getStatus()===403?s=j5(t.path):s=r,s.serverResponse=r.serverResponse,s}return e}function _p(t){const e=ac(t);function n(r,s){let i=e(r,s);return r.getStatus()===404&&(i=$5(t.path)),i.serverResponse=s.serverResponse,i}return n}function UD(t,e,n){const r=e.fullServerUrl(),s=fi(r,t.host,t._protocol),i="GET",o=t.maxOperationRetryTime,a=new gs(s,i,mp(t,n),o);return a.errorHandler=_p(e),a}function A8(t,e,n,r,s){const i={};e.isRoot?i.prefix="":i.prefix=e.path+"/",n&&n.length>0&&(i.delimiter=n),r&&(i.pageToken=r),s&&(i.maxResults=s);const o=e.bucketOnlyServerUrl(),a=fi(o,t.host,t._protocol),c="GET",l=t.maxOperationRetryTime,u=new gs(a,c,S8(t,e.bucket),l);return u.urlParams=i,u.errorHandler=ac(e),u}function k8(t,e,n){const r=e.fullServerUrl(),s=fi(r,t.host,t._protocol),i="GET",o=t.maxOperationRetryTime,a=new gs(s,i,C8(t,n),o);return a.errorHandler=_p(e),a}function R8(t,e,n,r){const s=e.fullServerUrl(),i=fi(s,t.host,t._protocol),o="PATCH",a=Cw(n,r),c={"Content-Type":"application/json; charset=utf-8"},l=t.maxOperationRetryTime,u=new gs(i,o,mp(t,r),l);return u.headers=c,u.body=a,u.errorHandler=_p(e),u}function N8(t,e){const n=e.fullServerUrl(),r=fi(n,t.host,t._protocol),s="DELETE",i=t.maxOperationRetryTime;function o(c,l){}const a=new gs(r,s,o,i);return a.successCodes=[200,204],a.errorHandler=_p(e),a}function P8(t,e){return t&&t.contentType||e&&e.type()||"application/octet-stream"}function $D(t,e,n){const r=Object.assign({},n);return r.fullPath=t.path,r.size=e.size(),r.contentType||(r.contentType=P8(null,e)),r}function D8(t,e,n,r,s){const i=e.bucketOnlyServerUrl(),o={"X-Goog-Upload-Protocol":"multipart"};function a(){let k="";for(let M=0;M<2;M++)k=k+Math.random().toString().slice(2);return k}const c=a();o["Content-Type"]="multipart/related; boundary="+c;const l=$D(e,r,s),u=Cw(l,n),h="--"+c+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+u+`\r
--`+c+`\r
Content-Type: `+l.contentType+`\r
\r
`,d=`\r
--`+c+"--",f=Gr.getBlob(h,r,d);if(f===null)throw kD();const p={name:l.fullPath},_=fi(i,t.host,t._protocol),y="POST",I=t.maxUploadRetryTime,N=new gs(_,y,mp(t,n),I);return N.urlParams=p,N.headers=o,N.body=f.uploadData(),N.errorHandler=ac(e),N}class Od{constructor(e,n,r,s){this.current=e,this.total=n,this.finalized=!!r,this.metadata=s||null}}function Aw(t,e){let n=null;try{n=t.getResponseHeader("X-Goog-Upload-Status")}catch{Pr(!1)}return Pr(!!n&&(e||["active"]).indexOf(n)!==-1),n}function x8(t,e,n,r,s){const i=e.bucketOnlyServerUrl(),o=$D(e,r,s),a={name:o.fullPath},c=fi(i,t.host,t._protocol),l="POST",u={"X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${r.size()}`,"X-Goog-Upload-Header-Content-Type":o.contentType,"Content-Type":"application/json; charset=utf-8"},h=Cw(o,n),d=t.maxUploadRetryTime;function f(_){Aw(_);let y;try{y=_.getResponseHeader("X-Goog-Upload-URL")}catch{Pr(!1)}return Pr(pp(y)),y}const p=new gs(c,l,f,d);return p.urlParams=a,p.headers=u,p.body=h,p.errorHandler=ac(e),p}function O8(t,e,n,r){const s={"X-Goog-Upload-Command":"query"};function i(l){const u=Aw(l,["active","final"]);let h=null;try{h=l.getResponseHeader("X-Goog-Upload-Size-Received")}catch{Pr(!1)}h||Pr(!1);const d=Number(h);return Pr(!isNaN(d)),new Od(d,r.size(),u==="final")}const o="POST",a=t.maxUploadRetryTime,c=new gs(n,o,i,a);return c.headers=s,c.errorHandler=ac(e),c}const qT=256*1024;function M8(t,e,n,r,s,i,o,a){const c=new Od(0,0);if(o?(c.current=o.current,c.total=o.total):(c.current=0,c.total=r.size()),r.size()!==c.total)throw z5();const l=c.total-c.current;let u=l;s>0&&(u=Math.min(u,s));const h=c.current,d=h+u,p={"X-Goog-Upload-Command":u===l?"upload, finalize":"upload","X-Goog-Upload-Offset":`${c.current}`},_=r.slice(h,d);if(_===null)throw kD();function y(M,j){const Y=Aw(M,["active","final"]),z=c.current+u,V=r.size();let ie;return Y==="final"?ie=mp(e,i)(M,j):ie=null,new Od(z,V,Y==="final",ie)}const I="POST",N=e.maxUploadRetryTime,k=new gs(n,I,y,N);return k.headers=p,k.body=_.uploadData(),k.progressCallback=a||null,k.errorHandler=ac(t),k}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const L8={STATE_CHANGED:"state_changed"},sn={RUNNING:"running",PAUSED:"paused",SUCCESS:"success",CANCELED:"canceled",ERROR:"error"};function mg(t){switch(t){case"running":case"pausing":case"canceling":return sn.RUNNING;case"paused":return sn.PAUSED;case"success":return sn.SUCCESS;case"canceled":return sn.CANCELED;case"error":return sn.ERROR;default:return sn.ERROR}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F8{constructor(e,n,r){if(e8(e)||n!=null||r!=null)this.next=e,this.error=n!=null?n:void 0,this.complete=r!=null?r:void 0;else{const i=e;this.next=i.next,this.error=i.error,this.complete=i.complete}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bo(t){return(...e)=>{Promise.resolve().then(()=>t(...e))}}class U8{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=Hi.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=Hi.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=Hi.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,n,r,s){if(this.sent_)throw Sc("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(n,e,!0),s!==void 0)for(const i in s)s.hasOwnProperty(i)&&this.xhr_.setRequestHeader(i,s[i].toString());return r!==void 0?this.xhr_.send(r):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw Sc("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw Sc("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw Sc("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw Sc("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class $8 extends U8{initXhr(){this.xhr_.responseType="text"}}function Ir(){return new $8}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VD{constructor(e,n,r=null){this._transferred=0,this._needToFetchStatus=!1,this._needToFetchMetadata=!1,this._observers=[],this._error=void 0,this._uploadUrl=void 0,this._request=void 0,this._chunkMultiplier=1,this._resolve=void 0,this._reject=void 0,this._ref=e,this._blob=n,this._metadata=r,this._mappings=gp(),this._resumable=this._shouldDoResumable(this._blob),this._state="running",this._errorHandler=s=>{this._request=void 0,this._chunkMultiplier=1,s._codeEquals("canceled")?(this._needToFetchStatus=!0,this.completeTransitions_()):(this._error=s,this._transition("error"))},this._metadataErrorHandler=s=>{this._request=void 0,s._codeEquals("canceled")?this.completeTransitions_():(this._error=s,this._transition("error"))},this._promise=new Promise((s,i)=>{this._resolve=s,this._reject=i,this._start()}),this._promise.then(null,()=>{})}_makeProgressCallback(){const e=this._transferred;return n=>this._updateProgress(e+n)}_shouldDoResumable(e){return e.size()>256*1024}_start(){this._state==="running"&&this._request===void 0&&(this._resumable?this._uploadUrl===void 0?this._createResumable():this._needToFetchStatus?this._fetchStatus():this._needToFetchMetadata?this._fetchMetadata():this._continueUpload():this._oneShotUpload())}_resolveToken(e){Promise.all([this._ref.storage._getAuthToken(),this._ref.storage._getAppCheckToken()]).then(([n,r])=>{switch(this._state){case"running":e(n,r);break;case"canceling":this._transition("canceled");break;case"pausing":this._transition("paused");break}})}_createResumable(){this._resolveToken((e,n)=>{const r=x8(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),s=this._ref.storage._makeRequest(r,Ir,e,n);this._request=s,s.getPromise().then(i=>{this._request=void 0,this._uploadUrl=i,this._needToFetchStatus=!1,this.completeTransitions_()},this._errorHandler)})}_fetchStatus(){const e=this._uploadUrl;this._resolveToken((n,r)=>{const s=O8(this._ref.storage,this._ref._location,e,this._blob),i=this._ref.storage._makeRequest(s,Ir,n,r);this._request=i,i.getPromise().then(o=>{o=o,this._request=void 0,this._updateProgress(o.current),this._needToFetchStatus=!1,o.finalized&&(this._needToFetchMetadata=!0),this.completeTransitions_()},this._errorHandler)})}_continueUpload(){const e=qT*this._chunkMultiplier,n=new Od(this._transferred,this._blob.size()),r=this._uploadUrl;this._resolveToken((s,i)=>{let o;try{o=M8(this._ref._location,this._ref.storage,r,this._blob,e,this._mappings,n,this._makeProgressCallback())}catch(c){this._error=c,this._transition("error");return}const a=this._ref.storage._makeRequest(o,Ir,s,i);this._request=a,a.getPromise().then(c=>{this._increaseMultiplier(),this._request=void 0,this._updateProgress(c.current),c.finalized?(this._metadata=c.metadata,this._transition("success")):this.completeTransitions_()},this._errorHandler)})}_increaseMultiplier(){qT*this._chunkMultiplier<32*1024*1024&&(this._chunkMultiplier*=2)}_fetchMetadata(){this._resolveToken((e,n)=>{const r=UD(this._ref.storage,this._ref._location,this._mappings),s=this._ref.storage._makeRequest(r,Ir,e,n);this._request=s,s.getPromise().then(i=>{this._request=void 0,this._metadata=i,this._transition("success")},this._metadataErrorHandler)})}_oneShotUpload(){this._resolveToken((e,n)=>{const r=D8(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),s=this._ref.storage._makeRequest(r,Ir,e,n);this._request=s,s.getPromise().then(i=>{this._request=void 0,this._metadata=i,this._updateProgress(this._blob.size()),this._transition("success")},this._errorHandler)})}_updateProgress(e){const n=this._transferred;this._transferred=e,this._transferred!==n&&this._notifyObservers()}_transition(e){if(this._state!==e)switch(e){case"canceling":this._state=e,this._request!==void 0&&this._request.cancel();break;case"pausing":this._state=e,this._request!==void 0&&this._request.cancel();break;case"running":const n=this._state==="paused";this._state=e,n&&(this._notifyObservers(),this._start());break;case"paused":this._state=e,this._notifyObservers();break;case"canceled":this._error=AD(),this._state=e,this._notifyObservers();break;case"error":this._state=e,this._notifyObservers();break;case"success":this._state=e,this._notifyObservers();break}}completeTransitions_(){switch(this._state){case"pausing":this._transition("paused");break;case"canceling":this._transition("canceled");break;case"running":this._start();break}}get snapshot(){const e=mg(this._state);return{bytesTransferred:this._transferred,totalBytes:this._blob.size(),state:e,metadata:this._metadata,task:this,ref:this._ref}}on(e,n,r,s){const i=new F8(n||void 0,r||void 0,s||void 0);return this._addObserver(i),()=>{this._removeObserver(i)}}then(e,n){return this._promise.then(e,n)}catch(e){return this.then(null,e)}_addObserver(e){this._observers.push(e),this._notifyObserver(e)}_removeObserver(e){const n=this._observers.indexOf(e);n!==-1&&this._observers.splice(n,1)}_notifyObservers(){this._finishPromise(),this._observers.slice().forEach(n=>{this._notifyObserver(n)})}_finishPromise(){if(this._resolve!==void 0){let e=!0;switch(mg(this._state)){case sn.SUCCESS:Bo(this._resolve.bind(null,this.snapshot))();break;case sn.CANCELED:case sn.ERROR:const n=this._reject;Bo(n.bind(null,this._error))();break;default:e=!1;break}e&&(this._resolve=void 0,this._reject=void 0)}}_notifyObserver(e){switch(mg(this._state)){case sn.RUNNING:case sn.PAUSED:e.next&&Bo(e.next.bind(e,this.snapshot))();break;case sn.SUCCESS:e.complete&&Bo(e.complete.bind(e))();break;case sn.CANCELED:case sn.ERROR:e.error&&Bo(e.error.bind(e,this._error))();break;default:e.error&&Bo(e.error.bind(e,this._error))()}}resume(){const e=this._state==="paused"||this._state==="pausing";return e&&this._transition("running"),e}pause(){const e=this._state==="running";return e&&this._transition("pausing"),e}cancel(){const e=this._state==="running"||this._state==="pausing";return e&&this._transition("canceling"),e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vo{constructor(e,n){this._service=e,n instanceof Yt?this._location=n:this._location=Yt.makeFromUrl(n,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,n){return new vo(e,n)}get root(){const e=new Yt(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return LD(this._location.path)}get storage(){return this._service}get parent(){const e=m8(this._location.path);if(e===null)return null;const n=new Yt(this._location.bucket,e);return new vo(this._service,n)}_throwIfRoot(e){if(this._location.path==="")throw ND(e)}}function V8(t,e,n){return t._throwIfRoot("uploadBytesResumable"),new VD(t,new Gr(e),n)}function B8(t){const e={prefixes:[],items:[]};return BD(t,e).then(()=>e)}async function BD(t,e,n){const s=await qD(t,{pageToken:n});e.prefixes.push(...s.prefixes),e.items.push(...s.items),s.nextPageToken!=null&&await BD(t,e,s.nextPageToken)}function qD(t,e){e!=null&&typeof e.maxResults=="number"&&t_("options.maxResults",1,1e3,e.maxResults);const n=e||{},r=A8(t.storage,t._location,"/",n.pageToken,n.maxResults);return t.storage.makeRequestWithTokens(r,Ir)}function q8(t){t._throwIfRoot("getMetadata");const e=UD(t.storage,t._location,gp());return t.storage.makeRequestWithTokens(e,Ir)}function j8(t,e){t._throwIfRoot("updateMetadata");const n=R8(t.storage,t._location,e,gp());return t.storage.makeRequestWithTokens(n,Ir)}function K8(t){t._throwIfRoot("getDownloadURL");const e=k8(t.storage,t._location,gp());return t.storage.makeRequestWithTokens(e,Ir).then(n=>{if(n===null)throw Q5();return n})}function W8(t){t._throwIfRoot("deleteObject");const e=N8(t.storage,t._location);return t.storage.makeRequestWithTokens(e,Ir)}function jD(t,e){const n=_8(t._location.path,e),r=new Yt(t._location.bucket,n);return new vo(t.storage,r)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function H8(t){return/^[A-Za-z]+:\/\//.test(t)}function G8(t,e){return new vo(t,e)}function KD(t,e){if(t instanceof kw){const n=t;if(n._bucket==null)throw G5();const r=new vo(n,n._bucket);return e!=null?KD(r,e):r}else return e!==void 0?jD(t,e):t}function z8(t,e){if(e&&H8(e)){if(t instanceof kw)return G8(t,e);throw ua("To use ref(service, url), the first argument must be a Storage instance.")}else return KD(t,e)}function jT(t,e){const n=e==null?void 0:e[CD];return n==null?null:Yt.makeFromBucketSpec(n,t)}function Q8(t,e,n,r={}){t.host=`${e}:${n}`,t._protocol="http";const{mockUserToken:s}=r;s&&(t._overrideAuthToken=typeof s=="string"?s:P_(s,t.app.options.projectId))}class kw{constructor(e,n,r,s,i){this.app=e,this._authProvider=n,this._appCheckProvider=r,this._url=s,this._firebaseVersion=i,this._bucket=null,this._host=SD,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=F5,this._maxUploadRetryTime=U5,this._requests=new Set,s!=null?this._bucket=Yt.makeFromBucketSpec(s,this._host):this._bucket=jT(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=Yt.makeFromBucketSpec(this._url,e):this._bucket=jT(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){t_("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){t_("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const n=await e.getToken();if(n!==null)return n.accessToken}return null}async _getAppCheckToken(){const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new vo(this,e)}_makeRequest(e,n,r,s){if(this._deleted)return new Y5(RD());{const i=a8(e,this._appId,r,s,n,this._firebaseVersion);return this._requests.add(i),i.getPromise().then(()=>this._requests.delete(i),()=>this._requests.delete(i)),i}}async makeRequestWithTokens(e,n){const[r,s]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,n,r,s).getPromise()}}const KT="@firebase/storage",WT="0.9.9";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Y8="storage";function J8(t,e,n){return t=A(t),V8(t,e,n)}function X8(t){return t=A(t),q8(t)}function Z8(t,e){return t=A(t),j8(t,e)}function eJ(t,e){return t=A(t),qD(t,e)}function tJ(t){return t=A(t),B8(t)}function nJ(t){return t=A(t),K8(t)}function rJ(t){return t=A(t),W8(t)}function HT(t,e){return t=A(t),z8(t,e)}function sJ(t,e){return jD(t,e)}function iJ(t,e,n,r={}){Q8(t,e,n,r)}function oJ(t,{instanceIdentifier:e}){const n=t.getProvider("app").getImmediate(),r=t.getProvider("auth-internal"),s=t.getProvider("app-check-internal");return new kw(n,r,s,e,Br)}function aJ(){nt(new Ee(Y8,oJ,"PUBLIC").setMultipleInstances(!0)),Le(KT,WT,""),Le(KT,WT,"esm2017")}aJ();/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hh{constructor(e,n,r){this._delegate=e,this.task=n,this.ref=r}get bytesTransferred(){return this._delegate.bytesTransferred}get metadata(){return this._delegate.metadata}get state(){return this._delegate.state}get totalBytes(){return this._delegate.totalBytes}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GT{constructor(e,n){this._delegate=e,this._ref=n,this.cancel=this._delegate.cancel.bind(this._delegate),this.catch=this._delegate.catch.bind(this._delegate),this.pause=this._delegate.pause.bind(this._delegate),this.resume=this._delegate.resume.bind(this._delegate)}get snapshot(){return new hh(this._delegate.snapshot,this,this._ref)}then(e,n){return this._delegate.then(r=>{if(e)return e(new hh(r,this,this._ref))},n)}on(e,n,r,s){let i;return n&&(typeof n=="function"?i=o=>n(new hh(o,this,this._ref)):i={next:n.next?o=>n.next(new hh(o,this,this._ref)):void 0,complete:n.complete||void 0,error:n.error||void 0}),this._delegate.on(e,i,r||void 0,s||void 0)}}class zT{constructor(e,n){this._delegate=e,this._service=n}get prefixes(){return this._delegate.prefixes.map(e=>new ns(e,this._service))}get items(){return this._delegate.items.map(e=>new ns(e,this._service))}get nextPageToken(){return this._delegate.nextPageToken||null}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *  http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ns{constructor(e,n){this._delegate=e,this.storage=n}get name(){return this._delegate.name}get bucket(){return this._delegate.bucket}get fullPath(){return this._delegate.fullPath}toString(){return this._delegate.toString()}child(e){const n=sJ(this._delegate,e);return new ns(n,this.storage)}get root(){return new ns(this._delegate.root,this.storage)}get parent(){const e=this._delegate.parent;return e==null?null:new ns(e,this.storage)}put(e,n){return this._throwIfRoot("put"),new GT(J8(this._delegate,e,n),this)}putString(e,n=Kn.RAW,r){this._throwIfRoot("putString");const s=DD(n,e),i=Object.assign({},r);return i.contentType==null&&s.contentType!=null&&(i.contentType=s.contentType),new GT(new VD(this._delegate,new Gr(s.data,!0),i),this)}listAll(){return tJ(this._delegate).then(e=>new zT(e,this.storage))}list(e){return eJ(this._delegate,e||void 0).then(n=>new zT(n,this.storage))}getMetadata(){return X8(this._delegate)}updateMetadata(e){return Z8(this._delegate,e)}getDownloadURL(){return nJ(this._delegate)}delete(){return this._throwIfRoot("delete"),rJ(this._delegate)}_throwIfRoot(e){if(this._delegate._location.path==="")throw ND(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WD{constructor(e,n){this.app=e,this._delegate=n}get maxOperationRetryTime(){return this._delegate.maxOperationRetryTime}get maxUploadRetryTime(){return this._delegate.maxUploadRetryTime}ref(e){if(QT(e))throw ua("ref() expected a child path but got a URL, use refFromURL instead.");return new ns(HT(this._delegate,e),this)}refFromURL(e){if(!QT(e))throw ua("refFromURL() expected a full URL but got a child path, use ref() instead.");try{Yt.makeFromUrl(e,this._delegate.host)}catch{throw ua("refFromUrl() expected a valid full URL but got an invalid one.")}return new ns(HT(this._delegate,e),this)}setMaxUploadRetryTime(e){this._delegate.maxUploadRetryTime=e}setMaxOperationRetryTime(e){this._delegate.maxOperationRetryTime=e}useEmulator(e,n,r={}){iJ(this._delegate,e,n,r)}}function QT(t){return/^[A-Za-z]+:\/\//.test(t)}const cJ="@firebase/storage-compat",lJ="0.1.17";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uJ="storage-compat";function hJ(t,{instanceIdentifier:e}){const n=t.getProvider("app-compat").getImmediate(),r=t.getProvider("storage").getImmediate({identifier:e});return new WD(n,r)}function dJ(t){const e={TaskState:sn,TaskEvent:L8,StringFormat:Kn,Storage:WD,Reference:ns};t.INTERNAL.registerComponent(new Ee(uJ,hJ,"PUBLIC").setServiceProps(e).setMultipleInstances(!0)),t.registerVersion(cJ,lJ)}dJ(ut);const YT="@firebase/performance",n_="0.5.12";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HD=n_,fJ="FB-PERF-TRACE-START",pJ="FB-PERF-TRACE-STOP",r_="FB-PERF-TRACE-MEASURE",GD="_wt_",zD="_fp",QD="_fcp",YD="_fid",JD="@firebase/performance/config",XD="@firebase/performance/configexpire",gJ="performance",ZD="Performance";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mJ={["trace started"]:"Trace {$traceName} was started before.",["trace stopped"]:"Trace {$traceName} is not running.",["nonpositive trace startTime"]:"Trace {$traceName} startTime should be positive.",["nonpositive trace duration"]:"Trace {$traceName} duration should be positive.",["no window"]:"Window is not available.",["no app id"]:"App id is not available.",["no project id"]:"Project id is not available.",["no api key"]:"Api key is not available.",["invalid cc log"]:"Attempted to queue invalid cc event",["FB not default"]:"Performance can only start when Firebase app instance is the default one.",["RC response not ok"]:"RC response is not ok",["invalid attribute name"]:"Attribute name {$attributeName} is invalid.",["invalid attribute value"]:"Attribute value {$attributeValue} is invalid.",["invalid custom metric name"]:"Custom metric name {$customMetricName} is invalid",["invalid String merger input"]:"Input for String merger is invalid, contact support team to resolve.",["already initialized"]:"initializePerformance() has already been called with different options. To avoid this error, call initializePerformance() with the same options as when it was originally called, or call getPerformance() to return the already initialized instance."},Qt=new fn(gJ,ZD,mJ);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $r=new Vr(ZD);$r.logLevel=de.INFO;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let _g,ex;class Rt{constructor(e){if(this.window=e,!e)throw Qt.create("no window");this.performance=e.performance,this.PerformanceObserver=e.PerformanceObserver,this.windowLocation=e.location,this.navigator=e.navigator,this.document=e.document,this.navigator&&this.navigator.cookieEnabled&&(this.localStorage=e.localStorage),e.perfMetrics&&e.perfMetrics.onFirstInputDelay&&(this.onFirstInputDelay=e.perfMetrics.onFirstInputDelay)}getUrl(){return this.windowLocation.href.split("?")[0]}mark(e){!this.performance||!this.performance.mark||this.performance.mark(e)}measure(e,n,r){!this.performance||!this.performance.measure||this.performance.measure(e,n,r)}getEntriesByType(e){return!this.performance||!this.performance.getEntriesByType?[]:this.performance.getEntriesByType(e)}getEntriesByName(e){return!this.performance||!this.performance.getEntriesByName?[]:this.performance.getEntriesByName(e)}getTimeOrigin(){return this.performance&&(this.performance.timeOrigin||this.performance.timing.navigationStart)}requiredApisAvailable(){return!fetch||!Promise||!ef()?($r.info("Firebase Performance cannot start if browser does not support fetch and Promise or cookie is disabled."),!1):In()?!0:($r.info("IndexedDB is not supported by current browswer"),!1)}setupObserver(e,n){if(!this.PerformanceObserver)return;new this.PerformanceObserver(s=>{for(const i of s.getEntries())n(i)}).observe({entryTypes:[e]})}static getInstance(){return _g===void 0&&(_g=new Rt(ex)),_g}}function _J(t){ex=t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let tx;function yJ(t){const e=t.getId();return e.then(n=>{tx=n}),e}function Rw(){return tx}function vJ(t){const e=t.getToken();return e.then(n=>{}),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function JT(t,e){const n=t.length-e.length;if(n<0||n>1)throw Qt.create("invalid String merger input");const r=[];for(let s=0;s<t.length;s++)r.push(t.charAt(s)),e.length>s&&r.push(e.charAt(s));return r.join("")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let yg;class Nn{constructor(){this.instrumentationEnabled=!0,this.dataCollectionEnabled=!0,this.loggingEnabled=!1,this.tracesSamplingRate=1,this.networkRequestsSamplingRate=1,this.logEndPointUrl="https://firebaselogging.googleapis.com/v0cc/log?format=json_proto",this.flTransportEndpointUrl=JT("hts/frbslgigp.ogepscmv/ieo/eaylg","tp:/ieaeogn-agolai.o/1frlglgc/o"),this.transportKey=JT("AzSC8r6ReiGqFMyfvgow","Iayx0u-XT3vksVM-pIV"),this.logSource=462,this.logTraceAfterSampling=!1,this.logNetworkAfterSampling=!1,this.configTimeToLive=12}getFlTransportFullUrl(){return this.flTransportEndpointUrl.concat("?key=",this.transportKey)}static getInstance(){return yg===void 0&&(yg=new Nn),yg}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ha;(function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.VISIBLE=1]="VISIBLE",t[t.HIDDEN=2]="HIDDEN"})(ha||(ha={}));const wJ=["firebase_","google_","ga_"],bJ=new RegExp("^[a-zA-Z]\\w*$"),IJ=40,EJ=100;function TJ(){const t=Rt.getInstance().navigator;return"serviceWorker"in t?t.serviceWorker.controller?2:3:1}function nx(){switch(Rt.getInstance().document.visibilityState){case"visible":return ha.VISIBLE;case"hidden":return ha.HIDDEN;default:return ha.UNKNOWN}}function SJ(){const e=Rt.getInstance().navigator.connection;switch(e&&e.effectiveType){case"slow-2g":return 1;case"2g":return 2;case"3g":return 3;case"4g":return 4;default:return 0}}function CJ(t){return t.length===0||t.length>IJ?!1:!wJ.some(n=>t.startsWith(n))&&!!t.match(bJ)}function AJ(t){return t.length!==0&&t.length<=EJ}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rx(t){var e;const n=(e=t.options)===null||e===void 0?void 0:e.appId;if(!n)throw Qt.create("no app id");return n}function kJ(t){var e;const n=(e=t.options)===null||e===void 0?void 0:e.projectId;if(!n)throw Qt.create("no project id");return n}function RJ(t){var e;const n=(e=t.options)===null||e===void 0?void 0:e.apiKey;if(!n)throw Qt.create("no api key");return n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NJ="0.0.1",Zn={loggingEnabled:!0},PJ="FIREBASE_INSTALLATIONS_AUTH";function DJ(t,e){const n=xJ();return n?(XT(n),Promise.resolve()):LJ(t,e).then(XT).then(r=>OJ(r),()=>{})}function xJ(){const t=Rt.getInstance().localStorage;if(!t)return;const e=t.getItem(XD);if(!e||!FJ(e))return;const n=t.getItem(JD);if(!!n)try{return JSON.parse(n)}catch{return}}function OJ(t){const e=Rt.getInstance().localStorage;!t||!e||(e.setItem(JD,JSON.stringify(t)),e.setItem(XD,String(Date.now()+Nn.getInstance().configTimeToLive*60*60*1e3)))}const MJ="Could not fetch config, will use default configs";function LJ(t,e){return vJ(t.installations).then(n=>{const r=kJ(t.app),s=RJ(t.app),i=`https://firebaseremoteconfig.googleapis.com/v1/projects/${r}/namespaces/fireperf:fetch?key=${s}`,o=new Request(i,{method:"POST",headers:{Authorization:`${PJ} ${n}`},body:JSON.stringify({app_instance_id:e,app_instance_id_token:n,app_id:rx(t.app),app_version:HD,sdk_version:NJ})});return fetch(o).then(a=>{if(a.ok)return a.json();throw Qt.create("RC response not ok")})}).catch(()=>{$r.info(MJ)})}function XT(t){if(!t)return t;const e=Nn.getInstance(),n=t.entries||{};return n.fpr_enabled!==void 0?e.loggingEnabled=String(n.fpr_enabled)==="true":e.loggingEnabled=Zn.loggingEnabled,n.fpr_log_source?e.logSource=Number(n.fpr_log_source):Zn.logSource&&(e.logSource=Zn.logSource),n.fpr_log_endpoint_url?e.logEndPointUrl=n.fpr_log_endpoint_url:Zn.logEndPointUrl&&(e.logEndPointUrl=Zn.logEndPointUrl),n.fpr_log_transport_key?e.transportKey=n.fpr_log_transport_key:Zn.transportKey&&(e.transportKey=Zn.transportKey),n.fpr_vc_network_request_sampling_rate!==void 0?e.networkRequestsSamplingRate=Number(n.fpr_vc_network_request_sampling_rate):Zn.networkRequestsSamplingRate!==void 0&&(e.networkRequestsSamplingRate=Zn.networkRequestsSamplingRate),n.fpr_vc_trace_sampling_rate!==void 0?e.tracesSamplingRate=Number(n.fpr_vc_trace_sampling_rate):Zn.tracesSamplingRate!==void 0&&(e.tracesSamplingRate=Zn.tracesSamplingRate),e.logTraceAfterSampling=ZT(e.tracesSamplingRate),e.logNetworkAfterSampling=ZT(e.networkRequestsSamplingRate),t}function FJ(t){return Number(t)>Date.now()}function ZT(t){return Math.random()<=t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Nw=1,vg;function sx(t){return Nw=2,vg=vg||$J(t),vg}function UJ(){return Nw===3}function $J(t){return VJ().then(()=>yJ(t.installations)).then(e=>DJ(t,e)).then(()=>eS(),()=>eS())}function VJ(){const t=Rt.getInstance().document;return new Promise(e=>{if(t&&t.readyState!=="complete"){const n=()=>{t.readyState==="complete"&&(t.removeEventListener("readystatechange",n),e())};t.addEventListener("readystatechange",n)}else e()})}function eS(){Nw=3}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pw=10*1e3,BJ=5.5*1e3,ix=3,qJ=1e3;let Md=ix,qs=[],tS=!1;function jJ(){tS||(yp(BJ),tS=!0)}function yp(t){setTimeout(()=>{if(Md!==0){if(!qs.length)return yp(Pw);KJ()}},t)}function KJ(){const t=qs.splice(0,qJ),e=t.map(r=>({source_extension_json_proto3:r.message,event_time_ms:String(r.eventTime)})),n={request_time_ms:String(Date.now()),client_info:{client_type:1,js_client_info:{}},log_source:Nn.getInstance().logSource,log_event:e};WJ(n,t).catch(()=>{qs=[...t,...qs],Md--,$r.info(`Tries left: ${Md}.`),yp(Pw)})}function WJ(t,e){return HJ(t).then(n=>(n.ok||$r.info("Call to Firebase backend failed."),n.json())).then(n=>{const r=Number(n.nextRequestWaitMillis);let s=Pw;isNaN(r)||(s=Math.max(r,s));const i=n.logResponseDetails;Array.isArray(i)&&i.length>0&&i[0].responseAction==="RETRY_REQUEST_LATER"&&(qs=[...e,...qs],$r.info("Retry transport request later.")),Md=ix,yp(s)})}function HJ(t){const e=Nn.getInstance().getFlTransportFullUrl();return fetch(e,{method:"POST",body:JSON.stringify(t)})}function GJ(t){if(!t.eventTime||!t.message)throw Qt.create("invalid cc log");qs=[...qs,t]}function zJ(t){return(...e)=>{const n=t(...e);GJ({message:n,eventTime:Date.now()})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let wg;function ox(t,e){wg||(wg=zJ(YJ)),wg(t,e)}function dh(t){const e=Nn.getInstance();!e.instrumentationEnabled&&t.isAuto||!e.dataCollectionEnabled&&!t.isAuto||!Rt.getInstance().requiredApisAvailable()||t.isAuto&&nx()!==ha.VISIBLE||(UJ()?bg(t):sx(t.performanceController).then(()=>bg(t),()=>bg(t)))}function bg(t){if(!Rw())return;const e=Nn.getInstance();!e.loggingEnabled||!e.logTraceAfterSampling||setTimeout(()=>ox(t,1),0)}function QJ(t){const e=Nn.getInstance();if(!e.instrumentationEnabled)return;const n=t.url,r=e.logEndPointUrl.split("?")[0],s=e.flTransportEndpointUrl.split("?")[0];n===r||n===s||!e.loggingEnabled||!e.logNetworkAfterSampling||setTimeout(()=>ox(t,0),0)}function YJ(t,e){return e===0?JJ(t):XJ(t)}function JJ(t){const e={url:t.url,http_method:t.httpMethod||0,http_response_code:200,response_payload_bytes:t.responsePayloadBytes,client_start_time_us:t.startTimeUs,time_to_response_initiated_us:t.timeToResponseInitiatedUs,time_to_response_completed_us:t.timeToResponseCompletedUs},n={application_info:ax(t.performanceController.app),network_request_metric:e};return JSON.stringify(n)}function XJ(t){const e={name:t.name,is_auto:t.isAuto,client_start_time_us:t.startTimeUs,duration_us:t.durationUs};Object.keys(t.counters).length!==0&&(e.counters=t.counters);const n=t.getAttributes();Object.keys(n).length!==0&&(e.custom_attributes=n);const r={application_info:ax(t.performanceController.app),trace_metric:e};return JSON.stringify(r)}function ax(t){return{google_app_id:rx(t),app_instance_id:Rw(),web_app_info:{sdk_version:HD,page_url:Rt.getInstance().getUrl(),service_worker_status:TJ(),visibility_state:nx(),effective_connection_type:SJ()},application_process_state:0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZJ=100,eX="_",tX=[zD,QD,YD];function nX(t,e){return t.length===0||t.length>ZJ?!1:e&&e.startsWith(GD)&&tX.indexOf(t)>-1||!t.startsWith(eX)}function rX(t){const e=Math.floor(t);return e<t&&$r.info(`Metric value should be an Integer, setting the value as : ${e}.`),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class js{constructor(e,n,r=!1,s){this.performanceController=e,this.name=n,this.isAuto=r,this.state=1,this.customAttributes={},this.counters={},this.api=Rt.getInstance(),this.randomId=Math.floor(Math.random()*1e6),this.isAuto||(this.traceStartMark=`${fJ}-${this.randomId}-${this.name}`,this.traceStopMark=`${pJ}-${this.randomId}-${this.name}`,this.traceMeasure=s||`${r_}-${this.randomId}-${this.name}`,s&&this.calculateTraceMetrics())}start(){if(this.state!==1)throw Qt.create("trace started",{traceName:this.name});this.api.mark(this.traceStartMark),this.state=2}stop(){if(this.state!==2)throw Qt.create("trace stopped",{traceName:this.name});this.state=3,this.api.mark(this.traceStopMark),this.api.measure(this.traceMeasure,this.traceStartMark,this.traceStopMark),this.calculateTraceMetrics(),dh(this)}record(e,n,r){if(e<=0)throw Qt.create("nonpositive trace startTime",{traceName:this.name});if(n<=0)throw Qt.create("nonpositive trace duration",{traceName:this.name});if(this.durationUs=Math.floor(n*1e3),this.startTimeUs=Math.floor(e*1e3),r&&r.attributes&&(this.customAttributes=Object.assign({},r.attributes)),r&&r.metrics)for(const s of Object.keys(r.metrics))isNaN(Number(r.metrics[s]))||(this.counters[s]=Math.floor(Number(r.metrics[s])));dh(this)}incrementMetric(e,n=1){this.counters[e]===void 0?this.putMetric(e,n):this.putMetric(e,this.counters[e]+n)}putMetric(e,n){if(nX(e,this.name))this.counters[e]=rX(n!=null?n:0);else throw Qt.create("invalid custom metric name",{customMetricName:e})}getMetric(e){return this.counters[e]||0}putAttribute(e,n){const r=CJ(e),s=AJ(n);if(r&&s){this.customAttributes[e]=n;return}if(!r)throw Qt.create("invalid attribute name",{attributeName:e});if(!s)throw Qt.create("invalid attribute value",{attributeValue:n})}getAttribute(e){return this.customAttributes[e]}removeAttribute(e){this.customAttributes[e]!==void 0&&delete this.customAttributes[e]}getAttributes(){return Object.assign({},this.customAttributes)}setStartTime(e){this.startTimeUs=e}setDuration(e){this.durationUs=e}calculateTraceMetrics(){const e=this.api.getEntriesByName(this.traceMeasure),n=e&&e[0];n&&(this.durationUs=Math.floor(n.duration*1e3),this.startTimeUs=Math.floor((n.startTime+this.api.getTimeOrigin())*1e3))}static createOobTrace(e,n,r,s){const i=Rt.getInstance().getUrl();if(!i)return;const o=new js(e,GD+i,!0),a=Math.floor(Rt.getInstance().getTimeOrigin()*1e3);o.setStartTime(a),n&&n[0]&&(o.setDuration(Math.floor(n[0].duration*1e3)),o.putMetric("domInteractive",Math.floor(n[0].domInteractive*1e3)),o.putMetric("domContentLoadedEventEnd",Math.floor(n[0].domContentLoadedEventEnd*1e3)),o.putMetric("loadEventEnd",Math.floor(n[0].loadEventEnd*1e3)));const c="first-paint",l="first-contentful-paint";if(r){const u=r.find(d=>d.name===c);u&&u.startTime&&o.putMetric(zD,Math.floor(u.startTime*1e3));const h=r.find(d=>d.name===l);h&&h.startTime&&o.putMetric(QD,Math.floor(h.startTime*1e3)),s&&o.putMetric(YD,Math.floor(s*1e3))}dh(o)}static createUserTimingTrace(e,n){const r=new js(e,n,!1,n);dh(r)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nS(t,e){const n=e;if(!n||n.responseStart===void 0)return;const r=Rt.getInstance().getTimeOrigin(),s=Math.floor((n.startTime+r)*1e3),i=n.responseStart?Math.floor((n.responseStart-n.startTime)*1e3):void 0,o=Math.floor((n.responseEnd-n.startTime)*1e3),a=n.name&&n.name.split("?")[0],c={performanceController:t,url:a,responsePayloadBytes:n.transferSize,startTimeUs:s,timeToResponseInitiatedUs:i,timeToResponseCompletedUs:o};QJ(c)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sX=5e3;function rS(t){!Rw()||(setTimeout(()=>oX(t),0),setTimeout(()=>iX(t),0),setTimeout(()=>aX(t),0))}function iX(t){const e=Rt.getInstance(),n=e.getEntriesByType("resource");for(const r of n)nS(t,r);e.setupObserver("resource",r=>nS(t,r))}function oX(t){const e=Rt.getInstance(),n=e.getEntriesByType("navigation"),r=e.getEntriesByType("paint");if(e.onFirstInputDelay){let s=setTimeout(()=>{js.createOobTrace(t,n,r),s=void 0},sX);e.onFirstInputDelay(i=>{s&&(clearTimeout(s),js.createOobTrace(t,n,r,i))})}else js.createOobTrace(t,n,r)}function aX(t){const e=Rt.getInstance(),n=e.getEntriesByType("measure");for(const r of n)sS(t,r);e.setupObserver("measure",r=>sS(t,r))}function sS(t,e){const n=e.name;n.substring(0,r_.length)!==r_&&js.createUserTimingTrace(t,n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cX{constructor(e,n){this.app=e,this.installations=n,this.initialized=!1}_init(e){this.initialized||((e==null?void 0:e.dataCollectionEnabled)!==void 0&&(this.dataCollectionEnabled=e.dataCollectionEnabled),(e==null?void 0:e.instrumentationEnabled)!==void 0&&(this.instrumentationEnabled=e.instrumentationEnabled),Rt.getInstance().requiredApisAvailable()?au().then(n=>{n&&(jJ(),sx(this).then(()=>rS(this),()=>rS(this)),this.initialized=!0)}).catch(n=>{$r.info(`Environment doesn't support IndexedDB: ${n}`)}):$r.info('Firebase Performance cannot start if the browser does not support "Fetch" and "Promise", or cookies are disabled.'))}set instrumentationEnabled(e){Nn.getInstance().instrumentationEnabled=e}get instrumentationEnabled(){return Nn.getInstance().instrumentationEnabled}set dataCollectionEnabled(e){Nn.getInstance().dataCollectionEnabled=e}get dataCollectionEnabled(){return Nn.getInstance().dataCollectionEnabled}}const lX="[DEFAULT]";function uX(t,e){return t=A(t),new js(t,e)}const hX=(t,{options:e})=>{const n=t.getProvider("app").getImmediate(),r=t.getProvider("installations-internal").getImmediate();if(n.name!==lX)throw Qt.create("FB not default");if(typeof window=="undefined")throw Qt.create("no window");_J(window);const s=new cX(n,r);return s._init(e),s};function dX(){nt(new Ee("performance",hX,"PUBLIC")),Le(YT,n_),Le(YT,n_,"esm2017")}dX();/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fX{constructor(e,n){this.app=e,this._delegate=n}get instrumentationEnabled(){return this._delegate.instrumentationEnabled}set instrumentationEnabled(e){this._delegate.instrumentationEnabled=e}get dataCollectionEnabled(){return this._delegate.dataCollectionEnabled}set dataCollectionEnabled(e){this._delegate.dataCollectionEnabled=e}trace(e){return uX(this._delegate,e)}}const pX="@firebase/performance-compat",gX="0.1.12";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mX(t){t.INTERNAL.registerComponent(new Ee("performance-compat",_X,"PUBLIC")),t.registerVersion(pX,gX)}function _X(t){const e=t.getProvider("app-compat").getImmediate(),n=t.getProvider("performance").getImmediate();return new fX(e,n)}mX(ut);const Ig="@firebase/remote-config",iS="0.3.11";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yX{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vX="remote-config";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wX={["registration-window"]:"Undefined window object. This SDK only supports usage in a browser environment.",["registration-project-id"]:"Undefined project identifier. Check Firebase app initialization.",["registration-api-key"]:"Undefined API key. Check Firebase app initialization.",["registration-app-id"]:"Undefined app identifier. Check Firebase app initialization.",["storage-open"]:"Error thrown when opening storage. Original error: {$originalErrorMessage}.",["storage-get"]:"Error thrown when reading from storage. Original error: {$originalErrorMessage}.",["storage-set"]:"Error thrown when writing to storage. Original error: {$originalErrorMessage}.",["storage-delete"]:"Error thrown when deleting from storage. Original error: {$originalErrorMessage}.",["fetch-client-network"]:"Fetch client failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.",["fetch-timeout"]:'The config fetch request timed out.  Configure timeout using "fetchTimeoutMillis" SDK setting.',["fetch-throttle"]:'The config fetch request timed out while in an exponential backoff state. Configure timeout using "fetchTimeoutMillis" SDK setting. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.',["fetch-client-parse"]:"Fetch client could not parse response. Original error: {$originalErrorMessage}.",["fetch-status"]:"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.",["indexed-db-unavailable"]:"Indexed DB is not supported by current browser"},_n=new fn("remoteconfig","Remote Config",wX);function bX(t,e){return t instanceof lt&&t.code.indexOf(e)!==-1}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IX=!1,EX="",oS=0,TX=["1","true","t","yes","y","on"];class Eg{constructor(e,n=EX){this._source=e,this._value=n}asString(){return this._value}asBoolean(){return this._source==="static"?IX:TX.indexOf(this._value.toLowerCase())>=0}asNumber(){if(this._source==="static")return oS;let e=Number(this._value);return isNaN(e)&&(e=oS),e}getSource(){return this._source}}async function cx(t){const e=A(t),[n,r]=await Promise.all([e._storage.getLastSuccessfulFetchResponse(),e._storage.getActiveConfigEtag()]);return!n||!n.config||!n.eTag||n.eTag===r?!1:(await Promise.all([e._storageCache.setActiveConfig(n.config),e._storage.setActiveConfigEtag(n.eTag)]),!0)}function lx(t){const e=A(t);return e._initializePromise||(e._initializePromise=e._storageCache.loadFromStorage().then(()=>{e._isInitializationComplete=!0})),e._initializePromise}async function ux(t){const e=A(t),n=new yX;setTimeout(async()=>{n.abort()},e.settings.fetchTimeoutMillis);try{await e._client.fetch({cacheMaxAgeMillis:e.settings.minimumFetchIntervalMillis,signal:n}),await e._storageCache.setLastFetchStatus("success")}catch(r){const s=bX(r,"fetch-throttle")?"throttle":"failure";throw await e._storageCache.setLastFetchStatus(s),r}}function SX(t){const e=A(t);return NX(e._storageCache.getActiveConfig(),e.defaultConfig).reduce((n,r)=>(n[r]=ju(t,r),n),{})}function CX(t,e){return ju(A(t),e).asBoolean()}function AX(t,e){return ju(A(t),e).asNumber()}function kX(t,e){return ju(A(t),e).asString()}function ju(t,e){const n=A(t);n._isInitializationComplete||n._logger.debug(`A value was requested for key "${e}" before SDK initialization completed. Await on ensureInitialized if the intent was to get a previously activated value.`);const r=n._storageCache.getActiveConfig();return r&&r[e]!==void 0?new Eg("remote",r[e]):n.defaultConfig&&n.defaultConfig[e]!==void 0?new Eg("default",String(n.defaultConfig[e])):(n._logger.debug(`Returning static value for key "${e}". Define a default or remote value if this is unintentional.`),new Eg("static"))}function RX(t,e){const n=A(t);switch(e){case"debug":n._logger.logLevel=de.DEBUG;break;case"silent":n._logger.logLevel=de.SILENT;break;default:n._logger.logLevel=de.ERROR}}function NX(t={},e={}){return Object.keys(Object.assign(Object.assign({},t),e))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PX{constructor(e,n,r,s){this.client=e,this.storage=n,this.storageCache=r,this.logger=s}isCachedDataFresh(e,n){if(!n)return this.logger.debug("Config fetch cache check. Cache unpopulated."),!1;const r=Date.now()-n,s=r<=e;return this.logger.debug(`Config fetch cache check. Cache age millis: ${r}. Cache max age millis (minimumFetchIntervalMillis setting): ${e}. Is cache hit: ${s}.`),s}async fetch(e){const[n,r]=await Promise.all([this.storage.getLastSuccessfulFetchTimestampMillis(),this.storage.getLastSuccessfulFetchResponse()]);if(r&&this.isCachedDataFresh(e.cacheMaxAgeMillis,n))return r;e.eTag=r&&r.eTag;const s=await this.client.fetch(e),i=[this.storageCache.setLastSuccessfulFetchTimestampMillis(Date.now())];return s.status===200&&i.push(this.storage.setLastSuccessfulFetchResponse(s)),await Promise.all(i),s}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DX(t=navigator){return t.languages&&t.languages[0]||t.language}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xX{constructor(e,n,r,s,i,o){this.firebaseInstallations=e,this.sdkVersion=n,this.namespace=r,this.projectId=s,this.apiKey=i,this.appId=o}async fetch(e){var n,r,s;const[i,o]=await Promise.all([this.firebaseInstallations.getId(),this.firebaseInstallations.getToken()]),c=`${window.FIREBASE_REMOTE_CONFIG_URL_BASE||"https://firebaseremoteconfig.googleapis.com"}/v1/projects/${this.projectId}/namespaces/${this.namespace}:fetch?key=${this.apiKey}`,l={"Content-Type":"application/json","Content-Encoding":"gzip","If-None-Match":e.eTag||"*"},u={sdk_version:this.sdkVersion,app_instance_id:i,app_instance_id_token:o,app_id:this.appId,language_code:DX()},h={method:"POST",headers:l,body:JSON.stringify(u)},d=fetch(c,h),f=new Promise((k,M)=>{e.signal.addEventListener(()=>{const j=new Error("The operation was aborted.");j.name="AbortError",M(j)})});let p;try{await Promise.race([d,f]),p=await d}catch(k){let M="fetch-client-network";throw((n=k)===null||n===void 0?void 0:n.name)==="AbortError"&&(M="fetch-timeout"),_n.create(M,{originalErrorMessage:(r=k)===null||r===void 0?void 0:r.message})}let _=p.status;const y=p.headers.get("ETag")||void 0;let I,N;if(p.status===200){let k;try{k=await p.json()}catch(M){throw _n.create("fetch-client-parse",{originalErrorMessage:(s=M)===null||s===void 0?void 0:s.message})}I=k.entries,N=k.state}if(N==="INSTANCE_STATE_UNSPECIFIED"?_=500:N==="NO_CHANGE"?_=304:(N==="NO_TEMPLATE"||N==="EMPTY_CONFIG")&&(I={}),_!==304&&_!==200)throw _n.create("fetch-status",{httpStatus:_});return{status:_,eTag:y,config:I}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function OX(t,e){return new Promise((n,r)=>{const s=Math.max(e-Date.now(),0),i=setTimeout(n,s);t.addEventListener(()=>{clearTimeout(i),r(_n.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}function MX(t){if(!(t instanceof lt)||!t.customData)return!1;const e=Number(t.customData.httpStatus);return e===429||e===500||e===503||e===504}class LX{constructor(e,n){this.client=e,this.storage=n}async fetch(e){const n=await this.storage.getThrottleMetadata()||{backoffCount:0,throttleEndTimeMillis:Date.now()};return this.attemptFetch(e,n)}async attemptFetch(e,{throttleEndTimeMillis:n,backoffCount:r}){await OX(e.signal,n);try{const s=await this.client.fetch(e);return await this.storage.deleteThrottleMetadata(),s}catch(s){if(!MX(s))throw s;const i={throttleEndTimeMillis:Date.now()+Vh(r),backoffCount:r+1};return await this.storage.setThrottleMetadata(i),this.attemptFetch(e,i)}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FX=60*1e3,UX=12*60*60*1e3;class $X{constructor(e,n,r,s,i){this.app=e,this._client=n,this._storageCache=r,this._storage=s,this._logger=i,this._isInitializationComplete=!1,this.settings={fetchTimeoutMillis:FX,minimumFetchIntervalMillis:UX},this.defaultConfig={}}get fetchTimeMillis(){return this._storageCache.getLastSuccessfulFetchTimestampMillis()||-1}get lastFetchStatus(){return this._storageCache.getLastFetchStatus()||"no-fetch-yet"}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nh(t,e){var n;const r=t.target.error||void 0;return _n.create(e,{originalErrorMessage:r&&((n=r)===null||n===void 0?void 0:n.message)})}const Ti="app_namespace_store",VX="firebase_remote_config",BX=1;function qX(){return new Promise((t,e)=>{var n;try{const r=indexedDB.open(VX,BX);r.onerror=s=>{e(Nh(s,"storage-open"))},r.onsuccess=s=>{t(s.target.result)},r.onupgradeneeded=s=>{const i=s.target.result;switch(s.oldVersion){case 0:i.createObjectStore(Ti,{keyPath:"compositeKey"})}}}catch(r){e(_n.create("storage-open",{originalErrorMessage:(n=r)===null||n===void 0?void 0:n.message}))}})}class jX{constructor(e,n,r,s=qX()){this.appId=e,this.appName=n,this.namespace=r,this.openDbPromise=s}getLastFetchStatus(){return this.get("last_fetch_status")}setLastFetchStatus(e){return this.set("last_fetch_status",e)}getLastSuccessfulFetchTimestampMillis(){return this.get("last_successful_fetch_timestamp_millis")}setLastSuccessfulFetchTimestampMillis(e){return this.set("last_successful_fetch_timestamp_millis",e)}getLastSuccessfulFetchResponse(){return this.get("last_successful_fetch_response")}setLastSuccessfulFetchResponse(e){return this.set("last_successful_fetch_response",e)}getActiveConfig(){return this.get("active_config")}setActiveConfig(e){return this.set("active_config",e)}getActiveConfigEtag(){return this.get("active_config_etag")}setActiveConfigEtag(e){return this.set("active_config_etag",e)}getThrottleMetadata(){return this.get("throttle_metadata")}setThrottleMetadata(e){return this.set("throttle_metadata",e)}deleteThrottleMetadata(){return this.delete("throttle_metadata")}async get(e){const n=await this.openDbPromise;return new Promise((r,s)=>{var i;const a=n.transaction([Ti],"readonly").objectStore(Ti),c=this.createCompositeKey(e);try{const l=a.get(c);l.onerror=u=>{s(Nh(u,"storage-get"))},l.onsuccess=u=>{const h=u.target.result;r(h?h.value:void 0)}}catch(l){s(_n.create("storage-get",{originalErrorMessage:(i=l)===null||i===void 0?void 0:i.message}))}})}async set(e,n){const r=await this.openDbPromise;return new Promise((s,i)=>{var o;const c=r.transaction([Ti],"readwrite").objectStore(Ti),l=this.createCompositeKey(e);try{const u=c.put({compositeKey:l,value:n});u.onerror=h=>{i(Nh(h,"storage-set"))},u.onsuccess=()=>{s()}}catch(u){i(_n.create("storage-set",{originalErrorMessage:(o=u)===null||o===void 0?void 0:o.message}))}})}async delete(e){const n=await this.openDbPromise;return new Promise((r,s)=>{var i;const a=n.transaction([Ti],"readwrite").objectStore(Ti),c=this.createCompositeKey(e);try{const l=a.delete(c);l.onerror=u=>{s(Nh(u,"storage-delete"))},l.onsuccess=()=>{r()}}catch(l){s(_n.create("storage-delete",{originalErrorMessage:(i=l)===null||i===void 0?void 0:i.message}))}})}createCompositeKey(e){return[this.appId,this.appName,this.namespace,e].join()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KX{constructor(e){this.storage=e}getLastFetchStatus(){return this.lastFetchStatus}getLastSuccessfulFetchTimestampMillis(){return this.lastSuccessfulFetchTimestampMillis}getActiveConfig(){return this.activeConfig}async loadFromStorage(){const e=this.storage.getLastFetchStatus(),n=this.storage.getLastSuccessfulFetchTimestampMillis(),r=this.storage.getActiveConfig(),s=await e;s&&(this.lastFetchStatus=s);const i=await n;i&&(this.lastSuccessfulFetchTimestampMillis=i);const o=await r;o&&(this.activeConfig=o)}setLastFetchStatus(e){return this.lastFetchStatus=e,this.storage.setLastFetchStatus(e)}setLastSuccessfulFetchTimestampMillis(e){return this.lastSuccessfulFetchTimestampMillis=e,this.storage.setLastSuccessfulFetchTimestampMillis(e)}setActiveConfig(e){return this.activeConfig=e,this.storage.setActiveConfig(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function WX(){nt(new Ee(vX,t,"PUBLIC").setMultipleInstances(!0)),Le(Ig,iS),Le(Ig,iS,"esm2017");function t(e,{instanceIdentifier:n}){const r=e.getProvider("app").getImmediate(),s=e.getProvider("installations-internal").getImmediate();if(typeof window=="undefined")throw _n.create("registration-window");if(!In())throw _n.create("indexed-db-unavailable");const{projectId:i,apiKey:o,appId:a}=r.options;if(!i)throw _n.create("registration-project-id");if(!o)throw _n.create("registration-api-key");if(!a)throw _n.create("registration-app-id");n=n||"firebase";const c=new jX(a,r.name,n),l=new KX(c),u=new Vr(Ig);u.logLevel=de.ERROR;const h=new xX(s,Br,n,i,o,a),d=new LX(h,c),f=new PX(d,c,l,u),p=new $X(r,f,l,c,u);return lx(p),p}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function HX(t){return t=A(t),await ux(t),cx(t)}async function GX(){if(!In())return!1;try{return await au()}catch{return!1}}WX();/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zX{constructor(e,n){this.app=e,this._delegate=n}get defaultConfig(){return this._delegate.defaultConfig}set defaultConfig(e){this._delegate.defaultConfig=e}get fetchTimeMillis(){return this._delegate.fetchTimeMillis}get lastFetchStatus(){return this._delegate.lastFetchStatus}get settings(){return this._delegate.settings}set settings(e){this._delegate.settings=e}activate(){return cx(this._delegate)}ensureInitialized(){return lx(this._delegate)}fetch(){return ux(this._delegate)}fetchAndActivate(){return HX(this._delegate)}getAll(){return SX(this._delegate)}getBoolean(e){return CX(this._delegate,e)}getNumber(e){return AX(this._delegate,e)}getString(e){return kX(this._delegate,e)}getValue(e){return ju(this._delegate,e)}setLogLevel(e){RX(this._delegate,e)}}const QX="@firebase/remote-config-compat",YX="0.1.12";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function JX(t){t.INTERNAL.registerComponent(new Ee("remoteConfig-compat",XX,"PUBLIC").setMultipleInstances(!0).setServiceProps({isSupported:GX})),t.registerVersion(QX,YX)}function XX(t,{instanceIdentifier:e}){const n=t.getProvider("app-compat").getImmediate(),r=t.getProvider("remote-config").getImmediate({identifier:e});return new zX(n,r)}JX(ut);var ZX="firebase",e9="9.9.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ut.registerVersion(ZX,e9,"app-compat");var t9="firebase",n9="9.9.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */console.warn(`
It looks like you're using the development build of the Firebase JS SDK.
When deploying Firebase apps to production, it is advisable to only import
the individual SDK components you intend to use.

For the module builds, these are available in the following manner
(replace <PACKAGE> with the name of a component - i.e. auth, database, etc):

CommonJS Modules:
const firebase = require('firebase/app');
require('firebase/<PACKAGE>');

ES Modules:
import firebase from 'firebase/app';
import 'firebase/<PACKAGE>';

Typescript:
import firebase from 'firebase/app';
import 'firebase/<PACKAGE>';
`);ut.registerVersion(t9,n9,"compat");var r9=!1;/*!
  * pinia v2.0.16
  * (c) 2022 Eduardo San Martin Morote
  * @license MIT
  */let hx;const vp=t=>hx=t,dx=Symbol();function s_(t){return t&&typeof t=="object"&&Object.prototype.toString.call(t)==="[object Object]"&&typeof t.toJSON!="function"}var nl;(function(t){t.direct="direct",t.patchObject="patch object",t.patchFunction="patch function"})(nl||(nl={}));function s9(){const t=pS(!0),e=t.run(()=>v_({}));let n=[],r=[];const s=fa({install(i){vp(s),s._a=i,i.provide(dx,s),i.config.globalProperties.$pinia=s,r.forEach(o=>n.push(o)),r=[]},use(i){return!this._a&&!r9?r.push(i):n.push(i),this},_p:n,_a:null,_e:t,_s:new Map,state:e});return s}const fx=()=>{};function aS(t,e,n,r=fx){t.push(e);const s=()=>{const i=t.indexOf(e);i>-1&&(t.splice(i,1),r())};return!n&&C_()&&I_(s),s}function qo(t,...e){t.slice().forEach(n=>{n(...e)})}function i_(t,e){for(const n in e){if(!e.hasOwnProperty(n))continue;const r=e[n],s=t[n];s_(s)&&s_(r)&&t.hasOwnProperty(n)&&!at(r)&&!Ms(r)?t[n]=i_(s,r):t[n]=r}return t}const i9=Symbol();function o9(t){return!s_(t)||!t.hasOwnProperty(i9)}const{assign:Wr}=Object;function a9(t){return!!(at(t)&&t.effect)}function c9(t,e,n,r){const{state:s,actions:i,getters:o}=e,a=n.state.value[t];let c;function l(){a||(n.state.value[t]=s?s():{});const u=oO(n.state.value[t]);return Wr(u,i,Object.keys(o||{}).reduce((h,d)=>(h[d]=fa(tr(()=>{vp(n);const f=n._s.get(t);return o[d].call(f,f)})),h),{}))}return c=px(t,l,e,n,r,!0),c.$reset=function(){const h=s?s():{};this.$patch(d=>{Wr(d,h)})},c}function px(t,e,n={},r,s,i){let o;const a=Wr({actions:{}},n),c={deep:!0};let l,u,h=fa([]),d=fa([]),f;const p=r.state.value[t];!i&&!p&&(r.state.value[t]={}),v_({});let _;function y(z){let V;l=u=!1,typeof z=="function"?(z(r.state.value[t]),V={type:nl.patchFunction,storeId:t,events:f}):(i_(r.state.value[t],z),V={type:nl.patchObject,payload:z,storeId:t,events:f});const ie=_=Symbol();b_().then(()=>{_===ie&&(l=!0)}),u=!0,qo(h,V,r.state.value[t])}const I=fx;function N(){o.stop(),h=[],d=[],r._s.delete(t)}function k(z,V){return function(){vp(r);const ie=Array.from(arguments),_e=[],Fe=[];function H(Xe){_e.push(Xe)}function ke(Xe){Fe.push(Xe)}qo(d,{args:ie,name:z,store:j,after:H,onError:ke});let Je;try{Je=V.apply(this&&this.$id===t?this:j,ie)}catch(Xe){throw qo(Fe,Xe),Xe}return Je instanceof Promise?Je.then(Xe=>(qo(_e,Xe),Xe)).catch(Xe=>(qo(Fe,Xe),Promise.reject(Xe))):(qo(_e,Je),Je)}}const M={_p:r,$id:t,$onAction:aS.bind(null,d),$patch:y,$reset:I,$subscribe(z,V={}){const ie=aS(h,z,V.detached,()=>_e()),_e=o.run(()=>Lc(()=>r.state.value[t],Fe=>{(V.flush==="sync"?u:l)&&z({storeId:t,type:nl.direct,events:f},Fe)},Wr({},c,V)));return ie},$dispose:N},j=$a(Wr({},M));r._s.set(t,j);const Y=r._e.run(()=>(o=pS(),o.run(()=>e())));for(const z in Y){const V=Y[z];if(at(V)&&!a9(V)||Ms(V))i||(p&&o9(V)&&(at(V)?V.value=p[z]:i_(V,p[z])),r.state.value[t][z]=V);else if(typeof V=="function"){const ie=k(z,V);Y[z]=ie,a.actions[z]=V}}return Wr(j,Y),Wr(Se(j),Y),Object.defineProperty(j,"$state",{get:()=>r.state.value[t],set:z=>{y(V=>{Wr(V,z)})}}),r._p.forEach(z=>{Wr(j,o.run(()=>z({store:j,app:r._a,pinia:r,options:a})))}),p&&i&&n.hydrate&&n.hydrate(j.$state,p),l=!0,u=!0,j}function l9(t,e,n){let r,s;const i=typeof e=="function";typeof t=="string"?(r=t,s=i?n:e):(s=t,r=t.id);function o(a,c){const l=C_();return a=a||l&&Cr(dx),a&&vp(a),a=hx,a._s.has(r)||(i?px(r,e,s,a):c9(r,s,a)),a._s.get(r)}return o.$id=r,o}const fh=l9({id:"university",state:()=>({univercities:[]}),actions:{getData(){this.removeAll(this.univercities,this.univercities.length),ut.firestore().collection("Univercities").orderBy("name").get().then(e=>{e.forEach(n=>{const r=n.data();this.univercities.push(r)})})},removeAll(t,e){t.splice(0,e),this.univercities=t}}});const u9={name:"ticker",data(){return{tickerData:[{headlines:"Admission open in Comsatas",link:"https://comstas.com"},{headlines:"Today Entry Test in BZU",link:"https://bzu.com"}]}}},h9=sM('<div class="ticker-wrapper" data-v-4f3a5898><div class="big-heading" data-v-4f3a5898>News</div><div class="text-update" data-v-4f3a5898><ul data-v-4f3a5898><li data-v-4f3a5898><a href="" data-v-4f3a5898>Admission Open in ITU Lahore</a></li><li data-v-4f3a5898><a href="" data-v-4f3a5898>Today is entery Test in FAST</a></li><li data-v-4f3a5898><a href="" data-v-4f3a5898>Last Date of Admission in Ripah</a></li></ul></div></div>',1),d9=[h9];function f9(t,e,n,r,s,i){return Fs(),ul("section",null,d9)}var p9=Jd(u9,[["render",f9],["__scopeId","data-v-4f3a5898"]]);const g9={components:{NavVue:uL,tickerVue:p9,mobileNav:T0},data(){return{mainNav:!0,publicPath:"/Educatia/"}},methods:{removeAll(){const t=fh();t.removeAll(t.univercities,t.univercities.length),console.log(t.univercities)},getDataFromBase(){const t=fh();t.univercities.length<1&&(this.removeAll(),t.getData())},checkingScreenSize(){window.innerWidth<760?this.mainNav=!1:this.mainNav=!0}},beforeMount(){this.checkingScreenSize()},mounted(){window.addEventListener("resize",()=>{this.checkingScreenSize()}),fh().getData()},created(){const t=fh(),e=setInterval(this.getDataFromBase,7e3);t.univercities.length>1&&clearInterval(e)}};function m9(t,e,n,r,s,i){const o=Go("tickerVue"),a=Go("NavVue"),c=Go("mobileNav"),l=Go("router-view");return Fs(),ul(Un,null,[ct(o),s.mainNav?(Fs(),Ug(a,{key:0})):Vg("",!0),s.mainNav?Vg("",!0):(Fs(),Ug(c,{key:1})),ct(l)],64)}var _9=Jd(g9,[["render",m9]]),y9="firebase",v9="9.9.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ut.registerVersion(y9,v9,"app-compat");const w9={apiKey:"AIzaSyD2b62AFYQbjcAHQKD_sndun59ZC72lb8E",authDomain:"educatia-170f3.firebaseapp.com",projectId:"educatia-170f3",storageBucket:"educatia-170f3.appspot.com",messagingSenderId:"111445876419",appId:"1:111445876419:web:8c6ca1e04409a7ddf6cc76",measurementId:"G-5KM7Z5KJ8R"};ut.initializeApp(w9);const Dw=jM(_9),b9=s9();Dw.use(b9);Dw.use(Z1);Dw.mount("#app");export{Un as F,k_ as T,Jd as _,$S as a,Ct as b,ul as c,Ug as d,Vg as e,A9 as f,ct as g,T9 as h,Zo as i,su as j,sM as k,ut as l,R9 as m,C9 as n,Fs as o,US as p,k9 as q,Go as r,I9 as t,fh as u,S9 as v,E9 as w};
