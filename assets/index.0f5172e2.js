(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function n(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerpolicy&&(i.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?i.credentials="include":r.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(r){if(r.ep)return;r.ep=!0;const i=n(r);fetch(r.href,i)}})();function M_(t,e){const n=Object.create(null),s=t.split(",");for(let r=0;r<s.length;r++)n[s[r]]=!0;return e?r=>!!n[r.toLowerCase()]:r=>!!n[r]}const eO="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",tO=M_(eO);function KS(t){return!!t||t===""}function L_(t){if(se(t)){const e={};for(let n=0;n<t.length;n++){const s=t[n],r=mt(s)?rO(s):L_(s);if(r)for(const i in r)e[i]=r[i]}return e}else{if(mt(t))return t;if(st(t))return t}}const nO=/;(?![^(]*\))/g,sO=/:(.+)/;function rO(t){const e={};return t.split(nO).forEach(n=>{if(n){const s=n.split(sO);s.length>1&&(e[s[0].trim()]=s[1].trim())}}),e}function F_(t){let e="";if(mt(t))e=t;else if(se(t))for(let n=0;n<t.length;n++){const s=F_(t[n]);s&&(e+=s+" ")}else if(st(t))for(const n in t)t[n]&&(e+=n+" ");return e.trim()}function iO(t,e){if(t.length!==e.length)return!1;let n=!0;for(let s=0;n&&s<t.length;s++)n=Ra(t[s],e[s]);return n}function Ra(t,e){if(t===e)return!0;let n=db(t),s=db(e);if(n||s)return n&&s?t.getTime()===e.getTime():!1;if(n=bl(t),s=bl(e),n||s)return t===e;if(n=se(t),s=se(e),n||s)return n&&s?iO(t,e):!1;if(n=st(t),s=st(e),n||s){if(!n||!s)return!1;const r=Object.keys(t).length,i=Object.keys(e).length;if(r!==i)return!1;for(const o in t){const a=t.hasOwnProperty(o),c=e.hasOwnProperty(o);if(a&&!c||!a&&c||!Ra(t[o],e[o]))return!1}}return String(t)===String(e)}function oO(t,e){return t.findIndex(n=>Ra(n,e))}const jZ=t=>mt(t)?t:t==null?"":se(t)||st(t)&&(t.toString===GS||!de(t.toString))?JSON.stringify(t,HS,2):String(t),HS=(t,e)=>e&&e.__v_isRef?HS(t,e.value):pa(e)?{[`Map(${e.size})`]:[...e.entries()].reduce((n,[s,r])=>(n[`${s} =>`]=r,n),{})}:uf(e)?{[`Set(${e.size})`]:[...e.values()]}:st(e)&&!se(e)&&!zS(e)?String(e):e,Fe={},fa=[],ds=()=>{},aO=()=>!1,cO=/^on[^a-z]/,lf=t=>cO.test(t),U_=t=>t.startsWith("onUpdate:"),Gt=Object.assign,$_=(t,e)=>{const n=t.indexOf(e);n>-1&&t.splice(n,1)},lO=Object.prototype.hasOwnProperty,Ee=(t,e)=>lO.call(t,e),se=Array.isArray,pa=t=>wu(t)==="[object Map]",uf=t=>wu(t)==="[object Set]",db=t=>wu(t)==="[object Date]",de=t=>typeof t=="function",mt=t=>typeof t=="string",bl=t=>typeof t=="symbol",st=t=>t!==null&&typeof t=="object",WS=t=>st(t)&&de(t.then)&&de(t.catch),GS=Object.prototype.toString,wu=t=>GS.call(t),uO=t=>wu(t).slice(8,-1),zS=t=>wu(t)==="[object Object]",V_=t=>mt(t)&&t!=="NaN"&&t[0]!=="-"&&""+parseInt(t,10)===t,xh=M_(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),hf=t=>{const e=Object.create(null);return n=>e[n]||(e[n]=t(n))},hO=/-(\w)/g,Vs=hf(t=>t.replace(hO,(e,n)=>n?n.toUpperCase():"")),dO=/\B([A-Z])/g,Mo=hf(t=>t.replace(dO,"-$1").toLowerCase()),df=hf(t=>t.charAt(0).toUpperCase()+t.slice(1)),Gp=hf(t=>t?`on${df(t)}`:""),Il=(t,e)=>!Object.is(t,e),ga=(t,e)=>{for(let n=0;n<t.length;n++)t[n](e)},Xh=(t,e,n)=>{Object.defineProperty(t,e,{configurable:!0,enumerable:!1,value:n})},El=t=>{const e=parseFloat(t);return isNaN(e)?t:e};let fb;const fO=()=>fb||(fb=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});let Is;class QS{constructor(e=!1){this.active=!0,this.effects=[],this.cleanups=[],!e&&Is&&(this.parent=Is,this.index=(Is.scopes||(Is.scopes=[])).push(this)-1)}run(e){if(this.active){const n=Is;try{return Is=this,e()}finally{Is=n}}}on(){Is=this}off(){Is=this.parent}stop(e){if(this.active){let n,s;for(n=0,s=this.effects.length;n<s;n++)this.effects[n].stop();for(n=0,s=this.cleanups.length;n<s;n++)this.cleanups[n]();if(this.scopes)for(n=0,s=this.scopes.length;n<s;n++)this.scopes[n].stop(!0);if(this.parent&&!e){const r=this.parent.scopes.pop();r&&r!==this&&(this.parent.scopes[this.index]=r,r.index=this.index)}this.active=!1}}}function YS(t){return new QS(t)}function pO(t,e=Is){e&&e.active&&e.effects.push(t)}const B_=t=>{const e=new Set(t);return e.w=0,e.n=0,e},JS=t=>(t.w&ti)>0,XS=t=>(t.n&ti)>0,gO=({deps:t})=>{if(t.length)for(let e=0;e<t.length;e++)t[e].w|=ti},mO=t=>{const{deps:e}=t;if(e.length){let n=0;for(let s=0;s<e.length;s++){const r=e[s];JS(r)&&!XS(r)?r.delete(t):e[n++]=r,r.w&=~ti,r.n&=~ti}e.length=n}},Zg=new WeakMap;let Kc=0,ti=1;const em=30;let as;const Xi=Symbol(""),tm=Symbol("");class j_{constructor(e,n=null,s){this.fn=e,this.scheduler=n,this.active=!0,this.deps=[],this.parent=void 0,pO(this,s)}run(){if(!this.active)return this.fn();let e=as,n=Gr;for(;e;){if(e===this)return;e=e.parent}try{return this.parent=as,as=this,Gr=!0,ti=1<<++Kc,Kc<=em?gO(this):pb(this),this.fn()}finally{Kc<=em&&mO(this),ti=1<<--Kc,as=this.parent,Gr=n,this.parent=void 0,this.deferStop&&this.stop()}}stop(){as===this?this.deferStop=!0:this.active&&(pb(this),this.onStop&&this.onStop(),this.active=!1)}}function pb(t){const{deps:e}=t;if(e.length){for(let n=0;n<e.length;n++)e[n].delete(t);e.length=0}}let Gr=!0;const ZS=[];function tc(){ZS.push(Gr),Gr=!1}function nc(){const t=ZS.pop();Gr=t===void 0?!0:t}function On(t,e,n){if(Gr&&as){let s=Zg.get(t);s||Zg.set(t,s=new Map);let r=s.get(n);r||s.set(n,r=B_()),e0(r)}}function e0(t,e){let n=!1;Kc<=em?XS(t)||(t.n|=ti,n=!JS(t)):n=!t.has(as),n&&(t.add(as),as.deps.push(t))}function fr(t,e,n,s,r,i){const o=Zg.get(t);if(!o)return;let a=[];if(e==="clear")a=[...o.values()];else if(n==="length"&&se(t))o.forEach((c,l)=>{(l==="length"||l>=s)&&a.push(c)});else switch(n!==void 0&&a.push(o.get(n)),e){case"add":se(t)?V_(n)&&a.push(o.get("length")):(a.push(o.get(Xi)),pa(t)&&a.push(o.get(tm)));break;case"delete":se(t)||(a.push(o.get(Xi)),pa(t)&&a.push(o.get(tm)));break;case"set":pa(t)&&a.push(o.get(Xi));break}if(a.length===1)a[0]&&nm(a[0]);else{const c=[];for(const l of a)l&&c.push(...l);nm(B_(c))}}function nm(t,e){const n=se(t)?t:[...t];for(const s of n)s.computed&&gb(s);for(const s of n)s.computed||gb(s)}function gb(t,e){(t!==as||t.allowRecurse)&&(t.scheduler?t.scheduler():t.run())}const _O=M_("__proto__,__v_isRef,__isVue"),t0=new Set(Object.getOwnPropertyNames(Symbol).filter(t=>t!=="arguments"&&t!=="caller").map(t=>Symbol[t]).filter(bl)),yO=q_(),vO=q_(!1,!0),wO=q_(!0),mb=bO();function bO(){const t={};return["includes","indexOf","lastIndexOf"].forEach(e=>{t[e]=function(...n){const s=be(this);for(let i=0,o=this.length;i<o;i++)On(s,"get",i+"");const r=s[e](...n);return r===-1||r===!1?s[e](...n.map(be)):r}}),["push","pop","shift","unshift","splice"].forEach(e=>{t[e]=function(...n){tc();const s=be(this)[e].apply(this,n);return nc(),s}}),t}function q_(t=!1,e=!1){return function(s,r,i){if(r==="__v_isReactive")return!t;if(r==="__v_isReadonly")return t;if(r==="__v_isShallow")return e;if(r==="__v_raw"&&i===(t?e?FO:o0:e?i0:r0).get(s))return s;const o=se(s);if(!t&&o&&Ee(mb,r))return Reflect.get(mb,r,i);const a=Reflect.get(s,r,i);return(bl(r)?t0.has(r):_O(r))||(t||On(s,"get",r),e)?a:nt(a)?o&&V_(r)?a:a.value:st(a)?t?a0(a):sc(a):a}}const IO=n0(),EO=n0(!0);function n0(t=!1){return function(n,s,r,i){let o=n[s];if(Tl(o)&&nt(o)&&!nt(r))return!1;if(!t&&!Tl(r)&&(sm(r)||(r=be(r),o=be(o)),!se(n)&&nt(o)&&!nt(r)))return o.value=r,!0;const a=se(n)&&V_(s)?Number(s)<n.length:Ee(n,s),c=Reflect.set(n,s,r,i);return n===be(i)&&(a?Il(r,o)&&fr(n,"set",s,r):fr(n,"add",s,r)),c}}function TO(t,e){const n=Ee(t,e);t[e];const s=Reflect.deleteProperty(t,e);return s&&n&&fr(t,"delete",e,void 0),s}function SO(t,e){const n=Reflect.has(t,e);return(!bl(e)||!t0.has(e))&&On(t,"has",e),n}function CO(t){return On(t,"iterate",se(t)?"length":Xi),Reflect.ownKeys(t)}const s0={get:yO,set:IO,deleteProperty:TO,has:SO,ownKeys:CO},AO={get:wO,set(t,e){return!0},deleteProperty(t,e){return!0}},kO=Gt({},s0,{get:vO,set:EO}),K_=t=>t,ff=t=>Reflect.getPrototypeOf(t);function ah(t,e,n=!1,s=!1){t=t.__v_raw;const r=be(t),i=be(e);n||(e!==i&&On(r,"get",e),On(r,"get",i));const{has:o}=ff(r),a=s?K_:n?G_:Sl;if(o.call(r,e))return a(t.get(e));if(o.call(r,i))return a(t.get(i));t!==r&&t.get(e)}function ch(t,e=!1){const n=this.__v_raw,s=be(n),r=be(t);return e||(t!==r&&On(s,"has",t),On(s,"has",r)),t===r?n.has(t):n.has(t)||n.has(r)}function lh(t,e=!1){return t=t.__v_raw,!e&&On(be(t),"iterate",Xi),Reflect.get(t,"size",t)}function _b(t){t=be(t);const e=be(this);return ff(e).has.call(e,t)||(e.add(t),fr(e,"add",t,t)),this}function yb(t,e){e=be(e);const n=be(this),{has:s,get:r}=ff(n);let i=s.call(n,t);i||(t=be(t),i=s.call(n,t));const o=r.call(n,t);return n.set(t,e),i?Il(e,o)&&fr(n,"set",t,e):fr(n,"add",t,e),this}function vb(t){const e=be(this),{has:n,get:s}=ff(e);let r=n.call(e,t);r||(t=be(t),r=n.call(e,t)),s&&s.call(e,t);const i=e.delete(t);return r&&fr(e,"delete",t,void 0),i}function wb(){const t=be(this),e=t.size!==0,n=t.clear();return e&&fr(t,"clear",void 0,void 0),n}function uh(t,e){return function(s,r){const i=this,o=i.__v_raw,a=be(o),c=e?K_:t?G_:Sl;return!t&&On(a,"iterate",Xi),o.forEach((l,u)=>s.call(r,c(l),c(u),i))}}function hh(t,e,n){return function(...s){const r=this.__v_raw,i=be(r),o=pa(i),a=t==="entries"||t===Symbol.iterator&&o,c=t==="keys"&&o,l=r[t](...s),u=n?K_:e?G_:Sl;return!e&&On(i,"iterate",c?tm:Xi),{next(){const{value:h,done:d}=l.next();return d?{value:h,done:d}:{value:a?[u(h[0]),u(h[1])]:u(h),done:d}},[Symbol.iterator](){return this}}}}function Ar(t){return function(...e){return t==="delete"?!1:this}}function RO(){const t={get(i){return ah(this,i)},get size(){return lh(this)},has:ch,add:_b,set:yb,delete:vb,clear:wb,forEach:uh(!1,!1)},e={get(i){return ah(this,i,!1,!0)},get size(){return lh(this)},has:ch,add:_b,set:yb,delete:vb,clear:wb,forEach:uh(!1,!0)},n={get(i){return ah(this,i,!0)},get size(){return lh(this,!0)},has(i){return ch.call(this,i,!0)},add:Ar("add"),set:Ar("set"),delete:Ar("delete"),clear:Ar("clear"),forEach:uh(!0,!1)},s={get(i){return ah(this,i,!0,!0)},get size(){return lh(this,!0)},has(i){return ch.call(this,i,!0)},add:Ar("add"),set:Ar("set"),delete:Ar("delete"),clear:Ar("clear"),forEach:uh(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(i=>{t[i]=hh(i,!1,!1),n[i]=hh(i,!0,!1),e[i]=hh(i,!1,!0),s[i]=hh(i,!0,!0)}),[t,n,e,s]}const[NO,PO,xO,DO]=RO();function H_(t,e){const n=e?t?DO:xO:t?PO:NO;return(s,r,i)=>r==="__v_isReactive"?!t:r==="__v_isReadonly"?t:r==="__v_raw"?s:Reflect.get(Ee(n,r)&&r in s?n:s,r,i)}const OO={get:H_(!1,!1)},MO={get:H_(!1,!0)},LO={get:H_(!0,!1)},r0=new WeakMap,i0=new WeakMap,o0=new WeakMap,FO=new WeakMap;function UO(t){switch(t){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function $O(t){return t.__v_skip||!Object.isExtensible(t)?0:UO(uO(t))}function sc(t){return Tl(t)?t:W_(t,!1,s0,OO,r0)}function VO(t){return W_(t,!1,kO,MO,i0)}function a0(t){return W_(t,!0,AO,LO,o0)}function W_(t,e,n,s,r){if(!st(t)||t.__v_raw&&!(e&&t.__v_isReactive))return t;const i=r.get(t);if(i)return i;const o=$O(t);if(o===0)return t;const a=new Proxy(t,o===2?s:n);return r.set(t,a),a}function ar(t){return Tl(t)?ar(t.__v_raw):!!(t&&t.__v_isReactive)}function Tl(t){return!!(t&&t.__v_isReadonly)}function sm(t){return!!(t&&t.__v_isShallow)}function c0(t){return ar(t)||Tl(t)}function be(t){const e=t&&t.__v_raw;return e?be(e):t}function is(t){return Xh(t,"__v_skip",!0),t}const Sl=t=>st(t)?sc(t):t,G_=t=>st(t)?a0(t):t;function l0(t){Gr&&as&&(t=be(t),e0(t.dep||(t.dep=B_())))}function u0(t,e){t=be(t),t.dep&&nm(t.dep)}function nt(t){return!!(t&&t.__v_isRef===!0)}function pf(t){return h0(t,!1)}function BO(t){return h0(t,!0)}function h0(t,e){return nt(t)?t:new jO(t,e)}class jO{constructor(e,n){this.__v_isShallow=n,this.dep=void 0,this.__v_isRef=!0,this._rawValue=n?e:be(e),this._value=n?e:Sl(e)}get value(){return l0(this),this._value}set value(e){e=this.__v_isShallow?e:be(e),Il(e,this._rawValue)&&(this._rawValue=e,this._value=this.__v_isShallow?e:Sl(e),u0(this))}}function ma(t){return nt(t)?t.value:t}const qO={get:(t,e,n)=>ma(Reflect.get(t,e,n)),set:(t,e,n,s)=>{const r=t[e];return nt(r)&&!nt(n)?(r.value=n,!0):Reflect.set(t,e,n,s)}};function d0(t){return ar(t)?t:new Proxy(t,qO)}function bb(t){const e=se(t)?new Array(t.length):{};for(const n in t)e[n]=Dh(t,n);return e}class KO{constructor(e,n,s){this._object=e,this._key=n,this._defaultValue=s,this.__v_isRef=!0}get value(){const e=this._object[this._key];return e===void 0?this._defaultValue:e}set value(e){this._object[this._key]=e}}function Dh(t,e,n){const s=t[e];return nt(s)?s:new KO(t,e,n)}class HO{constructor(e,n,s,r){this._setter=n,this.dep=void 0,this.__v_isRef=!0,this._dirty=!0,this.effect=new j_(e,()=>{this._dirty||(this._dirty=!0,u0(this))}),this.effect.computed=this,this.effect.active=this._cacheable=!r,this.__v_isReadonly=s}get value(){const e=be(this);return l0(e),(e._dirty||!e._cacheable)&&(e._dirty=!1,e._value=e.effect.run()),e._value}set value(e){this._setter(e)}}function WO(t,e,n=!1){let s,r;const i=de(t);return i?(s=t,r=ds):(s=t.get,r=t.set),new HO(s,r,i||!r,n)}function zr(t,e,n,s){let r;try{r=s?t(...s):t()}catch(i){gf(i,e,n)}return r}function zn(t,e,n,s){if(de(t)){const i=zr(t,e,n,s);return i&&WS(i)&&i.catch(o=>{gf(o,e,n)}),i}const r=[];for(let i=0;i<t.length;i++)r.push(zn(t[i],e,n,s));return r}function gf(t,e,n,s=!0){const r=e?e.vnode:null;if(e){let i=e.parent;const o=e.proxy,a=n;for(;i;){const l=i.ec;if(l){for(let u=0;u<l.length;u++)if(l[u](t,o,a)===!1)return}i=i.parent}const c=e.appContext.config.errorHandler;if(c){zr(c,null,10,[t,o,a]);return}}GO(t,n,r,s)}function GO(t,e,n,s=!0){console.error(t)}let Zh=!1,rm=!1;const Rn=[];let tr=0;const Xc=[];let Hc=null,ia=0;const Zc=[];let Mr=null,oa=0;const f0=Promise.resolve();let z_=null,im=null;function ed(t){const e=z_||f0;return t?e.then(this?t.bind(this):t):e}function zO(t){let e=tr+1,n=Rn.length;for(;e<n;){const s=e+n>>>1;Cl(Rn[s])<t?e=s+1:n=s}return e}function p0(t){(!Rn.length||!Rn.includes(t,Zh&&t.allowRecurse?tr+1:tr))&&t!==im&&(t.id==null?Rn.push(t):Rn.splice(zO(t.id),0,t),g0())}function g0(){!Zh&&!rm&&(rm=!0,z_=f0.then(y0))}function QO(t){const e=Rn.indexOf(t);e>tr&&Rn.splice(e,1)}function m0(t,e,n,s){se(t)?n.push(...t):(!e||!e.includes(t,t.allowRecurse?s+1:s))&&n.push(t),g0()}function YO(t){m0(t,Hc,Xc,ia)}function JO(t){m0(t,Mr,Zc,oa)}function mf(t,e=null){if(Xc.length){for(im=e,Hc=[...new Set(Xc)],Xc.length=0,ia=0;ia<Hc.length;ia++)Hc[ia]();Hc=null,ia=0,im=null,mf(t,e)}}function _0(t){if(mf(),Zc.length){const e=[...new Set(Zc)];if(Zc.length=0,Mr){Mr.push(...e);return}for(Mr=e,Mr.sort((n,s)=>Cl(n)-Cl(s)),oa=0;oa<Mr.length;oa++)Mr[oa]();Mr=null,oa=0}}const Cl=t=>t.id==null?1/0:t.id;function y0(t){rm=!1,Zh=!0,mf(t),Rn.sort((n,s)=>Cl(n)-Cl(s));const e=ds;try{for(tr=0;tr<Rn.length;tr++){const n=Rn[tr];n&&n.active!==!1&&zr(n,null,14)}}finally{tr=0,Rn.length=0,_0(),Zh=!1,z_=null,(Rn.length||Xc.length||Zc.length)&&y0(t)}}function XO(t,e,...n){if(t.isUnmounted)return;const s=t.vnode.props||Fe;let r=n;const i=e.startsWith("update:"),o=i&&e.slice(7);if(o&&o in s){const u=`${o==="modelValue"?"model":o}Modifiers`,{number:h,trim:d}=s[u]||Fe;d&&(r=n.map(f=>f.trim())),h&&(r=n.map(El))}let a,c=s[a=Gp(e)]||s[a=Gp(Vs(e))];!c&&i&&(c=s[a=Gp(Mo(e))]),c&&zn(c,t,6,r);const l=s[a+"Once"];if(l){if(!t.emitted)t.emitted={};else if(t.emitted[a])return;t.emitted[a]=!0,zn(l,t,6,r)}}function v0(t,e,n=!1){const s=e.emitsCache,r=s.get(t);if(r!==void 0)return r;const i=t.emits;let o={},a=!1;if(!de(t)){const c=l=>{const u=v0(l,e,!0);u&&(a=!0,Gt(o,u))};!n&&e.mixins.length&&e.mixins.forEach(c),t.extends&&c(t.extends),t.mixins&&t.mixins.forEach(c)}return!i&&!a?(s.set(t,null),null):(se(i)?i.forEach(c=>o[c]=null):Gt(o,i),s.set(t,o),o)}function _f(t,e){return!t||!lf(e)?!1:(e=e.slice(2).replace(/Once$/,""),Ee(t,e[0].toLowerCase()+e.slice(1))||Ee(t,Mo(e))||Ee(t,e))}let qn=null,yf=null;function td(t){const e=qn;return qn=t,yf=t&&t.type.__scopeId||null,e}function Q_(t){yf=t}function Y_(){yf=null}function cs(t,e=qn,n){if(!e||t._n)return t;const s=(...r)=>{s._d&&xb(-1);const i=td(e),o=t(...r);return td(i),s._d&&xb(1),o};return s._n=!0,s._c=!0,s._d=!0,s}function zp(t){const{type:e,vnode:n,proxy:s,withProxy:r,props:i,propsOptions:[o],slots:a,attrs:c,emit:l,render:u,renderCache:h,data:d,setupState:f,ctx:p,inheritAttrs:_}=t;let y,T;const I=td(t);try{if(n.shapeFlag&4){const S=r||s;y=Es(u.call(S,S,h,i,f,d,p)),T=c}else{const S=e;y=Es(S.length>1?S(i,{attrs:c,slots:a,emit:l}):S(i,null)),T=e.props?c:ZO(c)}}catch(S){tl.length=0,gf(S,t,1),y=qe(fs)}let E=y;if(T&&_!==!1){const S=Object.keys(T),{shapeFlag:H}=E;S.length&&H&7&&(o&&S.some(U_)&&(T=eM(T,o)),E=pr(E,T))}return n.dirs&&(E=pr(E),E.dirs=E.dirs?E.dirs.concat(n.dirs):n.dirs),n.transition&&(E.transition=n.transition),y=E,td(I),y}const ZO=t=>{let e;for(const n in t)(n==="class"||n==="style"||lf(n))&&((e||(e={}))[n]=t[n]);return e},eM=(t,e)=>{const n={};for(const s in t)(!U_(s)||!(s.slice(9)in e))&&(n[s]=t[s]);return n};function tM(t,e,n){const{props:s,children:r,component:i}=t,{props:o,children:a,patchFlag:c}=e,l=i.emitsOptions;if(e.dirs||e.transition)return!0;if(n&&c>=0){if(c&1024)return!0;if(c&16)return s?Ib(s,o,l):!!o;if(c&8){const u=e.dynamicProps;for(let h=0;h<u.length;h++){const d=u[h];if(o[d]!==s[d]&&!_f(l,d))return!0}}}else return(r||a)&&(!a||!a.$stable)?!0:s===o?!1:s?o?Ib(s,o,l):!0:!!o;return!1}function Ib(t,e,n){const s=Object.keys(e);if(s.length!==Object.keys(t).length)return!0;for(let r=0;r<s.length;r++){const i=s[r];if(e[i]!==t[i]&&!_f(n,i))return!0}return!1}function nM({vnode:t,parent:e},n){for(;e&&e.subTree===t;)(t=e.vnode).el=n,e=e.parent}const w0=t=>t.__isSuspense;function sM(t,e){e&&e.pendingBranch?se(t)?e.effects.push(...t):e.effects.push(t):JO(t)}function Oh(t,e){if(At){let n=At.provides;const s=At.parent&&At.parent.provides;s===n&&(n=At.provides=Object.create(s)),n[t]=e}}function Ds(t,e,n=!1){const s=At||qn;if(s){const r=s.parent==null?s.vnode.appContext&&s.vnode.appContext.provides:s.parent.provides;if(r&&t in r)return r[t];if(arguments.length>1)return n&&de(e)?e.call(s.proxy):e}}const Eb={};function Zi(t,e,n){return b0(t,e,n)}function b0(t,e,{immediate:n,deep:s,flush:r,onTrack:i,onTrigger:o}=Fe){const a=At;let c,l=!1,u=!1;if(nt(t)?(c=()=>t.value,l=sm(t)):ar(t)?(c=()=>t,s=!0):se(t)?(u=!0,l=t.some(T=>ar(T)||sm(T)),c=()=>t.map(T=>{if(nt(T))return T.value;if(ar(T))return Ki(T);if(de(T))return zr(T,a,2)})):de(t)?e?c=()=>zr(t,a,2):c=()=>{if(!(a&&a.isUnmounted))return h&&h(),zn(t,a,3,[d])}:c=ds,e&&s){const T=c;c=()=>Ki(T())}let h,d=T=>{h=y.onStop=()=>{zr(T,a,4)}};if(kl)return d=ds,e?n&&zn(e,a,3,[c(),u?[]:void 0,d]):c(),ds;let f=u?[]:Eb;const p=()=>{if(!!y.active)if(e){const T=y.run();(s||l||(u?T.some((I,E)=>Il(I,f[E])):Il(T,f)))&&(h&&h(),zn(e,a,3,[T,f===Eb?void 0:f,d]),f=T)}else y.run()};p.allowRecurse=!!e;let _;r==="sync"?_=p:r==="post"?_=()=>$t(p,a&&a.suspense):_=()=>YO(p);const y=new j_(c,_);return e?n?p():f=y.run():r==="post"?$t(y.run.bind(y),a&&a.suspense):y.run(),()=>{y.stop(),a&&a.scope&&$_(a.scope.effects,y)}}function rM(t,e,n){const s=this.proxy,r=mt(t)?t.includes(".")?I0(s,t):()=>s[t]:t.bind(s,s);let i;de(e)?i=e:(i=e.handler,n=e);const o=At;Pa(this);const a=b0(r,i.bind(s),n);return o?Pa(o):eo(),a}function I0(t,e){const n=e.split(".");return()=>{let s=t;for(let r=0;r<n.length&&s;r++)s=s[n[r]];return s}}function Ki(t,e){if(!st(t)||t.__v_skip||(e=e||new Set,e.has(t)))return t;if(e.add(t),nt(t))Ki(t.value,e);else if(se(t))for(let n=0;n<t.length;n++)Ki(t[n],e);else if(uf(t)||pa(t))t.forEach(n=>{Ki(n,e)});else if(zS(t))for(const n in t)Ki(t[n],e);return t}function iM(){const t={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return J_(()=>{t.isMounted=!0}),X_(()=>{t.isUnmounting=!0}),t}const $n=[Function,Array],oM={name:"BaseTransition",props:{mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:$n,onEnter:$n,onAfterEnter:$n,onEnterCancelled:$n,onBeforeLeave:$n,onLeave:$n,onAfterLeave:$n,onLeaveCancelled:$n,onBeforeAppear:$n,onAppear:$n,onAfterAppear:$n,onAppearCancelled:$n},setup(t,{slots:e}){const n=If(),s=iM();let r;return()=>{const i=e.default&&S0(e.default(),!0);if(!i||!i.length)return;let o=i[0];if(i.length>1){for(const _ of i)if(_.type!==fs){o=_;break}}const a=be(t),{mode:c}=a;if(s.isLeaving)return Qp(o);const l=Tb(o);if(!l)return Qp(o);const u=om(l,a,s,n);nd(l,u);const h=n.subTree,d=h&&Tb(h);let f=!1;const{getTransitionKey:p}=l.type;if(p){const _=p();r===void 0?r=_:_!==r&&(r=_,f=!0)}if(d&&d.type!==fs&&(!Li(l,d)||f)){const _=om(d,a,s,n);if(nd(d,_),c==="out-in")return s.isLeaving=!0,_.afterLeave=()=>{s.isLeaving=!1,n.update()},Qp(o);c==="in-out"&&l.type!==fs&&(_.delayLeave=(y,T,I)=>{const E=T0(s,d);E[String(d.key)]=d,y._leaveCb=()=>{T(),y._leaveCb=void 0,delete u.delayedLeave},u.delayedLeave=I})}return o}}},E0=oM;function T0(t,e){const{leavingVNodes:n}=t;let s=n.get(e.type);return s||(s=Object.create(null),n.set(e.type,s)),s}function om(t,e,n,s){const{appear:r,mode:i,persisted:o=!1,onBeforeEnter:a,onEnter:c,onAfterEnter:l,onEnterCancelled:u,onBeforeLeave:h,onLeave:d,onAfterLeave:f,onLeaveCancelled:p,onBeforeAppear:_,onAppear:y,onAfterAppear:T,onAppearCancelled:I}=e,E=String(t.key),S=T0(n,t),H=(G,j)=>{G&&zn(G,s,9,j)},Y=(G,j)=>{const F=j[1];H(G,j),se(G)?G.every(X=>X.length<=1)&&F():G.length<=1&&F()},M={mode:i,persisted:o,beforeEnter(G){let j=a;if(!n.isMounted)if(r)j=_||a;else return;G._leaveCb&&G._leaveCb(!0);const F=S[E];F&&Li(t,F)&&F.el._leaveCb&&F.el._leaveCb(),H(j,[G])},enter(G){let j=c,F=l,X=u;if(!n.isMounted)if(r)j=y||c,F=T||l,X=I||u;else return;let K=!1;const ve=G._enterCb=vt=>{K||(K=!0,vt?H(X,[G]):H(F,[G]),M.delayedLeave&&M.delayedLeave(),G._enterCb=void 0)};j?Y(j,[G,ve]):ve()},leave(G,j){const F=String(t.key);if(G._enterCb&&G._enterCb(!0),n.isUnmounting)return j();H(h,[G]);let X=!1;const K=G._leaveCb=ve=>{X||(X=!0,j(),ve?H(p,[G]):H(f,[G]),G._leaveCb=void 0,S[F]===t&&delete S[F])};S[F]=t,d?Y(d,[G,K]):K()},clone(G){return om(G,e,n,s)}};return M}function Qp(t){if(vf(t))return t=pr(t),t.children=null,t}function Tb(t){return vf(t)?t.children?t.children[0]:void 0:t}function nd(t,e){t.shapeFlag&6&&t.component?nd(t.component.subTree,e):t.shapeFlag&128?(t.ssContent.transition=e.clone(t.ssContent),t.ssFallback.transition=e.clone(t.ssFallback)):t.transition=e}function S0(t,e=!1,n){let s=[],r=0;for(let i=0;i<t.length;i++){let o=t[i];const a=n==null?o.key:String(n)+String(o.key!=null?o.key:i);o.type===os?(o.patchFlag&128&&r++,s=s.concat(S0(o.children,e,a))):(e||o.type!==fs)&&s.push(a!=null?pr(o,{key:a}):o)}if(r>1)for(let i=0;i<s.length;i++)s[i].patchFlag=-2;return s}function C0(t){return de(t)?{setup:t,name:t.name}:t}const el=t=>!!t.type.__asyncLoader,vf=t=>t.type.__isKeepAlive,aM={name:"KeepAlive",__isKeepAlive:!0,props:{include:[String,RegExp,Array],exclude:[String,RegExp,Array],max:[String,Number]},setup(t,{slots:e}){const n=If(),s=n.ctx;if(!s.renderer)return()=>{const I=e.default&&e.default();return I&&I.length===1?I[0]:I};const r=new Map,i=new Set;let o=null;const a=n.suspense,{renderer:{p:c,m:l,um:u,o:{createElement:h}}}=s,d=h("div");s.activate=(I,E,S,H,Y)=>{const M=I.component;l(I,E,S,0,a),c(M.vnode,I,E,S,M,a,H,I.slotScopeIds,Y),$t(()=>{M.isDeactivated=!1,M.a&&ga(M.a);const G=I.props&&I.props.onVnodeMounted;G&&Vn(G,M.parent,I)},a)},s.deactivate=I=>{const E=I.component;l(I,d,null,1,a),$t(()=>{E.da&&ga(E.da);const S=I.props&&I.props.onVnodeUnmounted;S&&Vn(S,E.parent,I),E.isDeactivated=!0},a)};function f(I){Yp(I),u(I,n,a,!0)}function p(I){r.forEach((E,S)=>{const H=dm(E.type);H&&(!I||!I(H))&&_(S)})}function _(I){const E=r.get(I);!o||E.type!==o.type?f(E):o&&Yp(o),r.delete(I),i.delete(I)}Zi(()=>[t.include,t.exclude],([I,E])=>{I&&p(S=>Wc(I,S)),E&&p(S=>!Wc(E,S))},{flush:"post",deep:!0});let y=null;const T=()=>{y!=null&&r.set(y,Jp(n.subTree))};return J_(T),k0(T),X_(()=>{r.forEach(I=>{const{subTree:E,suspense:S}=n,H=Jp(E);if(I.type===H.type){Yp(H);const Y=H.component.da;Y&&$t(Y,S);return}f(I)})}),()=>{if(y=null,!e.default)return null;const I=e.default(),E=I[0];if(I.length>1)return o=null,I;if(!id(E)||!(E.shapeFlag&4)&&!(E.shapeFlag&128))return o=null,E;let S=Jp(E);const H=S.type,Y=dm(el(S)?S.type.__asyncResolved||{}:H),{include:M,exclude:G,max:j}=t;if(M&&(!Y||!Wc(M,Y))||G&&Y&&Wc(G,Y))return o=S,E;const F=S.key==null?H:S.key,X=r.get(F);return S.el&&(S=pr(S),E.shapeFlag&128&&(E.ssContent=S)),y=F,X?(S.el=X.el,S.component=X.component,S.transition&&nd(S,S.transition),S.shapeFlag|=512,i.delete(F),i.add(F)):(i.add(F),j&&i.size>parseInt(j,10)&&_(i.values().next().value)),S.shapeFlag|=256,o=S,w0(E.type)?E:S}}},qZ=aM;function Wc(t,e){return se(t)?t.some(n=>Wc(n,e)):mt(t)?t.split(",").includes(e):t.test?t.test(e):!1}function cM(t,e){A0(t,"a",e)}function lM(t,e){A0(t,"da",e)}function A0(t,e,n=At){const s=t.__wdc||(t.__wdc=()=>{let r=n;for(;r;){if(r.isDeactivated)return;r=r.parent}return t()});if(wf(e,s,n),n){let r=n.parent;for(;r&&r.parent;)vf(r.parent.vnode)&&uM(s,e,n,r),r=r.parent}}function uM(t,e,n,s){const r=wf(e,t,s,!0);Z_(()=>{$_(s[e],r)},n)}function Yp(t){let e=t.shapeFlag;e&256&&(e-=256),e&512&&(e-=512),t.shapeFlag=e}function Jp(t){return t.shapeFlag&128?t.ssContent:t}function wf(t,e,n=At,s=!1){if(n){const r=n[t]||(n[t]=[]),i=e.__weh||(e.__weh=(...o)=>{if(n.isUnmounted)return;tc(),Pa(n);const a=zn(e,n,t,o);return eo(),nc(),a});return s?r.unshift(i):r.push(i),i}}const wr=t=>(e,n=At)=>(!kl||t==="sp")&&wf(t,e,n),hM=wr("bm"),J_=wr("m"),dM=wr("bu"),k0=wr("u"),X_=wr("bum"),Z_=wr("um"),fM=wr("sp"),pM=wr("rtg"),gM=wr("rtc");function mM(t,e=At){wf("ec",t,e)}function KZ(t,e){const n=qn;if(n===null)return t;const s=Ef(n)||n.proxy,r=t.dirs||(t.dirs=[]);for(let i=0;i<e.length;i++){let[o,a,c,l=Fe]=e[i];de(o)&&(o={mounted:o,updated:o}),o.deep&&Ki(a),r.push({dir:o,instance:s,value:a,oldValue:void 0,arg:c,modifiers:l})}return t}function Ti(t,e,n,s){const r=t.dirs,i=e&&e.dirs;for(let o=0;o<r.length;o++){const a=r[o];i&&(a.oldValue=i[o].value);let c=a.dir[s];c&&(tc(),zn(c,n,8,[t.el,a,t,e]),nc())}}const R0="components";function Ur(t,e){return yM(R0,t,!0,e)||t}const _M=Symbol();function yM(t,e,n=!0,s=!1){const r=qn||At;if(r){const i=r.type;if(t===R0){const a=dm(i,!1);if(a&&(a===e||a===Vs(e)||a===df(Vs(e))))return i}const o=Sb(r[t]||i[t],e)||Sb(r.appContext[t],e);return!o&&s?i:o}}function Sb(t,e){return t&&(t[e]||t[Vs(e)]||t[df(Vs(e))])}function HZ(t,e,n,s){let r;const i=n&&n[s];if(se(t)||mt(t)){r=new Array(t.length);for(let o=0,a=t.length;o<a;o++)r[o]=e(t[o],o,void 0,i&&i[o])}else if(typeof t=="number"){r=new Array(t);for(let o=0;o<t;o++)r[o]=e(o+1,o,void 0,i&&i[o])}else if(st(t))if(t[Symbol.iterator])r=Array.from(t,(o,a)=>e(o,a,void 0,i&&i[a]));else{const o=Object.keys(t);r=new Array(o.length);for(let a=0,c=o.length;a<c;a++){const l=o[a];r[a]=e(t[l],l,a,i&&i[a])}}else r=[];return n&&(n[s]=r),r}const am=t=>t?B0(t)?Ef(t)||t.proxy:am(t.parent):null,sd=Gt(Object.create(null),{$:t=>t,$el:t=>t.vnode.el,$data:t=>t.data,$props:t=>t.props,$attrs:t=>t.attrs,$slots:t=>t.slots,$refs:t=>t.refs,$parent:t=>am(t.parent),$root:t=>am(t.root),$emit:t=>t.emit,$options:t=>P0(t),$forceUpdate:t=>t.f||(t.f=()=>p0(t.update)),$nextTick:t=>t.n||(t.n=ed.bind(t.proxy)),$watch:t=>rM.bind(t)}),vM={get({_:t},e){const{ctx:n,setupState:s,data:r,props:i,accessCache:o,type:a,appContext:c}=t;let l;if(e[0]!=="$"){const f=o[e];if(f!==void 0)switch(f){case 1:return s[e];case 2:return r[e];case 4:return n[e];case 3:return i[e]}else{if(s!==Fe&&Ee(s,e))return o[e]=1,s[e];if(r!==Fe&&Ee(r,e))return o[e]=2,r[e];if((l=t.propsOptions[0])&&Ee(l,e))return o[e]=3,i[e];if(n!==Fe&&Ee(n,e))return o[e]=4,n[e];cm&&(o[e]=0)}}const u=sd[e];let h,d;if(u)return e==="$attrs"&&On(t,"get",e),u(t);if((h=a.__cssModules)&&(h=h[e]))return h;if(n!==Fe&&Ee(n,e))return o[e]=4,n[e];if(d=c.config.globalProperties,Ee(d,e))return d[e]},set({_:t},e,n){const{data:s,setupState:r,ctx:i}=t;return r!==Fe&&Ee(r,e)?(r[e]=n,!0):s!==Fe&&Ee(s,e)?(s[e]=n,!0):Ee(t.props,e)||e[0]==="$"&&e.slice(1)in t?!1:(i[e]=n,!0)},has({_:{data:t,setupState:e,accessCache:n,ctx:s,appContext:r,propsOptions:i}},o){let a;return!!n[o]||t!==Fe&&Ee(t,o)||e!==Fe&&Ee(e,o)||(a=i[0])&&Ee(a,o)||Ee(s,o)||Ee(sd,o)||Ee(r.config.globalProperties,o)},defineProperty(t,e,n){return n.get!=null?t._.accessCache[e]=0:Ee(n,"value")&&this.set(t,e,n.value,null),Reflect.defineProperty(t,e,n)}};let cm=!0;function wM(t){const e=P0(t),n=t.proxy,s=t.ctx;cm=!1,e.beforeCreate&&Cb(e.beforeCreate,t,"bc");const{data:r,computed:i,methods:o,watch:a,provide:c,inject:l,created:u,beforeMount:h,mounted:d,beforeUpdate:f,updated:p,activated:_,deactivated:y,beforeDestroy:T,beforeUnmount:I,destroyed:E,unmounted:S,render:H,renderTracked:Y,renderTriggered:M,errorCaptured:G,serverPrefetch:j,expose:F,inheritAttrs:X,components:K,directives:ve,filters:vt}=e;if(l&&bM(l,s,null,t.appContext.config.unwrapInjectedRef),o)for(const pe in o){const xe=o[pe];de(xe)&&(s[pe]=xe.bind(n))}if(r){const pe=r.call(n,n);st(pe)&&(t.data=sc(pe))}if(cm=!0,i)for(const pe in i){const xe=i[pe],Cn=de(xe)?xe.bind(n,n):de(xe.get)?xe.get.bind(n,n):ds,zo=!de(xe)&&de(xe.set)?xe.set.bind(n):ds,Js=Bn({get:Cn,set:zo});Object.defineProperty(s,pe,{enumerable:!0,configurable:!0,get:()=>Js.value,set:vs=>Js.value=vs})}if(a)for(const pe in a)N0(a[pe],s,n,pe);if(c){const pe=de(c)?c.call(n):c;Reflect.ownKeys(pe).forEach(xe=>{Oh(xe,pe[xe])})}u&&Cb(u,t,"c");function Ne(pe,xe){se(xe)?xe.forEach(Cn=>pe(Cn.bind(n))):xe&&pe(xe.bind(n))}if(Ne(hM,h),Ne(J_,d),Ne(dM,f),Ne(k0,p),Ne(cM,_),Ne(lM,y),Ne(mM,G),Ne(gM,Y),Ne(pM,M),Ne(X_,I),Ne(Z_,S),Ne(fM,j),se(F))if(F.length){const pe=t.exposed||(t.exposed={});F.forEach(xe=>{Object.defineProperty(pe,xe,{get:()=>n[xe],set:Cn=>n[xe]=Cn})})}else t.exposed||(t.exposed={});H&&t.render===ds&&(t.render=H),X!=null&&(t.inheritAttrs=X),K&&(t.components=K),ve&&(t.directives=ve)}function bM(t,e,n=ds,s=!1){se(t)&&(t=lm(t));for(const r in t){const i=t[r];let o;st(i)?"default"in i?o=Ds(i.from||r,i.default,!0):o=Ds(i.from||r):o=Ds(i),nt(o)&&s?Object.defineProperty(e,r,{enumerable:!0,configurable:!0,get:()=>o.value,set:a=>o.value=a}):e[r]=o}}function Cb(t,e,n){zn(se(t)?t.map(s=>s.bind(e.proxy)):t.bind(e.proxy),e,n)}function N0(t,e,n,s){const r=s.includes(".")?I0(n,s):()=>n[s];if(mt(t)){const i=e[t];de(i)&&Zi(r,i)}else if(de(t))Zi(r,t.bind(n));else if(st(t))if(se(t))t.forEach(i=>N0(i,e,n,s));else{const i=de(t.handler)?t.handler.bind(n):e[t.handler];de(i)&&Zi(r,i,t)}}function P0(t){const e=t.type,{mixins:n,extends:s}=e,{mixins:r,optionsCache:i,config:{optionMergeStrategies:o}}=t.appContext,a=i.get(e);let c;return a?c=a:!r.length&&!n&&!s?c=e:(c={},r.length&&r.forEach(l=>rd(c,l,o,!0)),rd(c,e,o)),i.set(e,c),c}function rd(t,e,n,s=!1){const{mixins:r,extends:i}=e;i&&rd(t,i,n,!0),r&&r.forEach(o=>rd(t,o,n,!0));for(const o in e)if(!(s&&o==="expose")){const a=IM[o]||n&&n[o];t[o]=a?a(t[o],e[o]):e[o]}return t}const IM={data:Ab,props:Ni,emits:Ni,methods:Ni,computed:Ni,beforeCreate:sn,created:sn,beforeMount:sn,mounted:sn,beforeUpdate:sn,updated:sn,beforeDestroy:sn,beforeUnmount:sn,destroyed:sn,unmounted:sn,activated:sn,deactivated:sn,errorCaptured:sn,serverPrefetch:sn,components:Ni,directives:Ni,watch:TM,provide:Ab,inject:EM};function Ab(t,e){return e?t?function(){return Gt(de(t)?t.call(this,this):t,de(e)?e.call(this,this):e)}:e:t}function EM(t,e){return Ni(lm(t),lm(e))}function lm(t){if(se(t)){const e={};for(let n=0;n<t.length;n++)e[t[n]]=t[n];return e}return t}function sn(t,e){return t?[...new Set([].concat(t,e))]:e}function Ni(t,e){return t?Gt(Gt(Object.create(null),t),e):e}function TM(t,e){if(!t)return e;if(!e)return t;const n=Gt(Object.create(null),t);for(const s in e)n[s]=sn(t[s],e[s]);return n}function SM(t,e,n,s=!1){const r={},i={};Xh(i,bf,1),t.propsDefaults=Object.create(null),x0(t,e,r,i);for(const o in t.propsOptions[0])o in r||(r[o]=void 0);n?t.props=s?r:VO(r):t.type.props?t.props=r:t.props=i,t.attrs=i}function CM(t,e,n,s){const{props:r,attrs:i,vnode:{patchFlag:o}}=t,a=be(r),[c]=t.propsOptions;let l=!1;if((s||o>0)&&!(o&16)){if(o&8){const u=t.vnode.dynamicProps;for(let h=0;h<u.length;h++){let d=u[h];if(_f(t.emitsOptions,d))continue;const f=e[d];if(c)if(Ee(i,d))f!==i[d]&&(i[d]=f,l=!0);else{const p=Vs(d);r[p]=um(c,a,p,f,t,!1)}else f!==i[d]&&(i[d]=f,l=!0)}}}else{x0(t,e,r,i)&&(l=!0);let u;for(const h in a)(!e||!Ee(e,h)&&((u=Mo(h))===h||!Ee(e,u)))&&(c?n&&(n[h]!==void 0||n[u]!==void 0)&&(r[h]=um(c,a,h,void 0,t,!0)):delete r[h]);if(i!==a)for(const h in i)(!e||!Ee(e,h)&&!0)&&(delete i[h],l=!0)}l&&fr(t,"set","$attrs")}function x0(t,e,n,s){const[r,i]=t.propsOptions;let o=!1,a;if(e)for(let c in e){if(xh(c))continue;const l=e[c];let u;r&&Ee(r,u=Vs(c))?!i||!i.includes(u)?n[u]=l:(a||(a={}))[u]=l:_f(t.emitsOptions,c)||(!(c in s)||l!==s[c])&&(s[c]=l,o=!0)}if(i){const c=be(n),l=a||Fe;for(let u=0;u<i.length;u++){const h=i[u];n[h]=um(r,c,h,l[h],t,!Ee(l,h))}}return o}function um(t,e,n,s,r,i){const o=t[n];if(o!=null){const a=Ee(o,"default");if(a&&s===void 0){const c=o.default;if(o.type!==Function&&de(c)){const{propsDefaults:l}=r;n in l?s=l[n]:(Pa(r),s=l[n]=c.call(null,e),eo())}else s=c}o[0]&&(i&&!a?s=!1:o[1]&&(s===""||s===Mo(n))&&(s=!0))}return s}function D0(t,e,n=!1){const s=e.propsCache,r=s.get(t);if(r)return r;const i=t.props,o={},a=[];let c=!1;if(!de(t)){const u=h=>{c=!0;const[d,f]=D0(h,e,!0);Gt(o,d),f&&a.push(...f)};!n&&e.mixins.length&&e.mixins.forEach(u),t.extends&&u(t.extends),t.mixins&&t.mixins.forEach(u)}if(!i&&!c)return s.set(t,fa),fa;if(se(i))for(let u=0;u<i.length;u++){const h=Vs(i[u]);kb(h)&&(o[h]=Fe)}else if(i)for(const u in i){const h=Vs(u);if(kb(h)){const d=i[u],f=o[h]=se(d)||de(d)?{type:d}:d;if(f){const p=Pb(Boolean,f.type),_=Pb(String,f.type);f[0]=p>-1,f[1]=_<0||p<_,(p>-1||Ee(f,"default"))&&a.push(h)}}}const l=[o,a];return s.set(t,l),l}function kb(t){return t[0]!=="$"}function Rb(t){const e=t&&t.toString().match(/^\s*function (\w+)/);return e?e[1]:t===null?"null":""}function Nb(t,e){return Rb(t)===Rb(e)}function Pb(t,e){return se(e)?e.findIndex(n=>Nb(n,t)):de(e)&&Nb(e,t)?0:-1}const O0=t=>t[0]==="_"||t==="$stable",ey=t=>se(t)?t.map(Es):[Es(t)],AM=(t,e,n)=>{if(e._n)return e;const s=cs((...r)=>ey(e(...r)),n);return s._c=!1,s},M0=(t,e,n)=>{const s=t._ctx;for(const r in t){if(O0(r))continue;const i=t[r];if(de(i))e[r]=AM(r,i,s);else if(i!=null){const o=ey(i);e[r]=()=>o}}},L0=(t,e)=>{const n=ey(e);t.slots.default=()=>n},kM=(t,e)=>{if(t.vnode.shapeFlag&32){const n=e._;n?(t.slots=be(e),Xh(e,"_",n)):M0(e,t.slots={})}else t.slots={},e&&L0(t,e);Xh(t.slots,bf,1)},RM=(t,e,n)=>{const{vnode:s,slots:r}=t;let i=!0,o=Fe;if(s.shapeFlag&32){const a=e._;a?n&&a===1?i=!1:(Gt(r,e),!n&&a===1&&delete r._):(i=!e.$stable,M0(e,r)),o=e}else e&&(L0(t,e),o={default:1});if(i)for(const a in r)!O0(a)&&!(a in o)&&delete r[a]};function F0(){return{app:null,config:{isNativeTag:aO,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let NM=0;function PM(t,e){return function(s,r=null){de(s)||(s=Object.assign({},s)),r!=null&&!st(r)&&(r=null);const i=F0(),o=new Set;let a=!1;const c=i.app={_uid:NM++,_component:s,_props:r,_container:null,_context:i,_instance:null,version:QM,get config(){return i.config},set config(l){},use(l,...u){return o.has(l)||(l&&de(l.install)?(o.add(l),l.install(c,...u)):de(l)&&(o.add(l),l(c,...u))),c},mixin(l){return i.mixins.includes(l)||i.mixins.push(l),c},component(l,u){return u?(i.components[l]=u,c):i.components[l]},directive(l,u){return u?(i.directives[l]=u,c):i.directives[l]},mount(l,u,h){if(!a){const d=qe(s,r);return d.appContext=i,u&&e?e(d,l):t(d,l,h),a=!0,c._container=l,l.__vue_app__=c,Ef(d.component)||d.component.proxy}},unmount(){a&&(t(null,c._container),delete c._container.__vue_app__)},provide(l,u){return i.provides[l]=u,c}};return c}}function hm(t,e,n,s,r=!1){if(se(t)){t.forEach((d,f)=>hm(d,e&&(se(e)?e[f]:e),n,s,r));return}if(el(s)&&!r)return;const i=s.shapeFlag&4?Ef(s.component)||s.component.proxy:s.el,o=r?null:i,{i:a,r:c}=t,l=e&&e.r,u=a.refs===Fe?a.refs={}:a.refs,h=a.setupState;if(l!=null&&l!==c&&(mt(l)?(u[l]=null,Ee(h,l)&&(h[l]=null)):nt(l)&&(l.value=null)),de(c))zr(c,a,12,[o,u]);else{const d=mt(c),f=nt(c);if(d||f){const p=()=>{if(t.f){const _=d?u[c]:c.value;r?se(_)&&$_(_,i):se(_)?_.includes(i)||_.push(i):d?(u[c]=[i],Ee(h,c)&&(h[c]=u[c])):(c.value=[i],t.k&&(u[t.k]=c.value))}else d?(u[c]=o,Ee(h,c)&&(h[c]=o)):f&&(c.value=o,t.k&&(u[t.k]=o))};o?(p.id=-1,$t(p,n)):p()}}}const $t=sM;function xM(t){return DM(t)}function DM(t,e){const n=fO();n.__VUE__=!0;const{insert:s,remove:r,patchProp:i,createElement:o,createText:a,createComment:c,setText:l,setElementText:u,parentNode:h,nextSibling:d,setScopeId:f=ds,cloneNode:p,insertStaticContent:_}=t,y=(g,m,b,R=null,A=null,U=null,W=!1,L=null,V=!!m.dynamicChildren)=>{if(g===m)return;g&&!Li(g,m)&&(R=ee(g),Un(g,A,U,!0),g=null),m.patchFlag===-2&&(V=!1,m.dynamicChildren=null);const{type:x,ref:te,shapeFlag:J}=m;switch(x){case ty:T(g,m,b,R);break;case fs:I(g,m,b,R);break;case Mh:g==null&&E(m,b,R,W);break;case os:ve(g,m,b,R,A,U,W,L,V);break;default:J&1?Y(g,m,b,R,A,U,W,L,V):J&6?vt(g,m,b,R,A,U,W,L,V):(J&64||J&128)&&x.process(g,m,b,R,A,U,W,L,V,Ve)}te!=null&&A&&hm(te,g&&g.ref,U,m||g,!m)},T=(g,m,b,R)=>{if(g==null)s(m.el=a(m.children),b,R);else{const A=m.el=g.el;m.children!==g.children&&l(A,m.children)}},I=(g,m,b,R)=>{g==null?s(m.el=c(m.children||""),b,R):m.el=g.el},E=(g,m,b,R)=>{[g.el,g.anchor]=_(g.children,m,b,R,g.el,g.anchor)},S=({el:g,anchor:m},b,R)=>{let A;for(;g&&g!==m;)A=d(g),s(g,b,R),g=A;s(m,b,R)},H=({el:g,anchor:m})=>{let b;for(;g&&g!==m;)b=d(g),r(g),g=b;r(m)},Y=(g,m,b,R,A,U,W,L,V)=>{W=W||m.type==="svg",g==null?M(m,b,R,A,U,W,L,V):F(g,m,A,U,W,L,V)},M=(g,m,b,R,A,U,W,L)=>{let V,x;const{type:te,props:J,shapeFlag:ne,transition:le,patchFlag:Se,dirs:Oe}=g;if(g.el&&p!==void 0&&Se===-1)V=g.el=p(g.el);else{if(V=g.el=o(g.type,U,J&&J.is,J),ne&8?u(V,g.children):ne&16&&j(g.children,V,null,R,A,U&&te!=="foreignObject",W,L),Oe&&Ti(g,null,R,"created"),J){for(const He in J)He!=="value"&&!xh(He)&&i(V,He,null,J[He],U,g.children,R,A,B);"value"in J&&i(V,"value",null,J.value),(x=J.onVnodeBeforeMount)&&Vn(x,R,g)}G(V,g,g.scopeId,W,R)}Oe&&Ti(g,null,R,"beforeMount");const Me=(!A||A&&!A.pendingBranch)&&le&&!le.persisted;Me&&le.beforeEnter(V),s(V,m,b),((x=J&&J.onVnodeMounted)||Me||Oe)&&$t(()=>{x&&Vn(x,R,g),Me&&le.enter(V),Oe&&Ti(g,null,R,"mounted")},A)},G=(g,m,b,R,A)=>{if(b&&f(g,b),R)for(let U=0;U<R.length;U++)f(g,R[U]);if(A){let U=A.subTree;if(m===U){const W=A.vnode;G(g,W,W.scopeId,W.slotScopeIds,A.parent)}}},j=(g,m,b,R,A,U,W,L,V=0)=>{for(let x=V;x<g.length;x++){const te=g[x]=L?Lr(g[x]):Es(g[x]);y(null,te,m,b,R,A,U,W,L)}},F=(g,m,b,R,A,U,W)=>{const L=m.el=g.el;let{patchFlag:V,dynamicChildren:x,dirs:te}=m;V|=g.patchFlag&16;const J=g.props||Fe,ne=m.props||Fe;let le;b&&Si(b,!1),(le=ne.onVnodeBeforeUpdate)&&Vn(le,b,m,g),te&&Ti(m,g,b,"beforeUpdate"),b&&Si(b,!0);const Se=A&&m.type!=="foreignObject";if(x?X(g.dynamicChildren,x,L,b,R,Se,U):W||Cn(g,m,L,null,b,R,Se,U,!1),V>0){if(V&16)K(L,m,J,ne,b,R,A);else if(V&2&&J.class!==ne.class&&i(L,"class",null,ne.class,A),V&4&&i(L,"style",J.style,ne.style,A),V&8){const Oe=m.dynamicProps;for(let Me=0;Me<Oe.length;Me++){const He=Oe[Me],es=J[He],Qo=ne[He];(Qo!==es||He==="value")&&i(L,He,es,Qo,A,g.children,b,R,B)}}V&1&&g.children!==m.children&&u(L,m.children)}else!W&&x==null&&K(L,m,J,ne,b,R,A);((le=ne.onVnodeUpdated)||te)&&$t(()=>{le&&Vn(le,b,m,g),te&&Ti(m,g,b,"updated")},R)},X=(g,m,b,R,A,U,W)=>{for(let L=0;L<m.length;L++){const V=g[L],x=m[L],te=V.el&&(V.type===os||!Li(V,x)||V.shapeFlag&70)?h(V.el):b;y(V,x,te,null,R,A,U,W,!0)}},K=(g,m,b,R,A,U,W)=>{if(b!==R){for(const L in R){if(xh(L))continue;const V=R[L],x=b[L];V!==x&&L!=="value"&&i(g,L,x,V,W,m.children,A,U,B)}if(b!==Fe)for(const L in b)!xh(L)&&!(L in R)&&i(g,L,b[L],null,W,m.children,A,U,B);"value"in R&&i(g,"value",b.value,R.value)}},ve=(g,m,b,R,A,U,W,L,V)=>{const x=m.el=g?g.el:a(""),te=m.anchor=g?g.anchor:a("");let{patchFlag:J,dynamicChildren:ne,slotScopeIds:le}=m;le&&(L=L?L.concat(le):le),g==null?(s(x,b,R),s(te,b,R),j(m.children,b,te,A,U,W,L,V)):J>0&&J&64&&ne&&g.dynamicChildren?(X(g.dynamicChildren,ne,b,A,U,W,L),(m.key!=null||A&&m===A.subTree)&&U0(g,m,!0)):Cn(g,m,b,te,A,U,W,L,V)},vt=(g,m,b,R,A,U,W,L,V)=>{m.slotScopeIds=L,g==null?m.shapeFlag&512?A.ctx.activate(m,b,R,W,V):Zn(m,b,R,A,U,W,V):Ne(g,m,V)},Zn=(g,m,b,R,A,U,W)=>{const L=g.component=qM(g,R,A);if(vf(g)&&(L.ctx.renderer=Ve),KM(L),L.asyncDep){if(A&&A.registerDep(L,pe),!g.el){const V=L.subTree=qe(fs);I(null,V,m,b)}return}pe(L,g,m,b,A,U,W)},Ne=(g,m,b)=>{const R=m.component=g.component;if(tM(g,m,b))if(R.asyncDep&&!R.asyncResolved){xe(R,m,b);return}else R.next=m,QO(R.update),R.update();else m.el=g.el,R.vnode=m},pe=(g,m,b,R,A,U,W)=>{const L=()=>{if(g.isMounted){let{next:te,bu:J,u:ne,parent:le,vnode:Se}=g,Oe=te,Me;Si(g,!1),te?(te.el=Se.el,xe(g,te,W)):te=Se,J&&ga(J),(Me=te.props&&te.props.onVnodeBeforeUpdate)&&Vn(Me,le,te,Se),Si(g,!0);const He=zp(g),es=g.subTree;g.subTree=He,y(es,He,h(es.el),ee(es),g,A,U),te.el=He.el,Oe===null&&nM(g,He.el),ne&&$t(ne,A),(Me=te.props&&te.props.onVnodeUpdated)&&$t(()=>Vn(Me,le,te,Se),A)}else{let te;const{el:J,props:ne}=m,{bm:le,m:Se,parent:Oe}=g,Me=el(m);if(Si(g,!1),le&&ga(le),!Me&&(te=ne&&ne.onVnodeBeforeMount)&&Vn(te,Oe,m),Si(g,!0),J&&fe){const He=()=>{g.subTree=zp(g),fe(J,g.subTree,g,A,null)};Me?m.type.__asyncLoader().then(()=>!g.isUnmounted&&He()):He()}else{const He=g.subTree=zp(g);y(null,He,b,R,g,A,U),m.el=He.el}if(Se&&$t(Se,A),!Me&&(te=ne&&ne.onVnodeMounted)){const He=m;$t(()=>Vn(te,Oe,He),A)}(m.shapeFlag&256||Oe&&el(Oe.vnode)&&Oe.vnode.shapeFlag&256)&&g.a&&$t(g.a,A),g.isMounted=!0,m=b=R=null}},V=g.effect=new j_(L,()=>p0(x),g.scope),x=g.update=()=>V.run();x.id=g.uid,Si(g,!0),x()},xe=(g,m,b)=>{m.component=g;const R=g.vnode.props;g.vnode=m,g.next=null,CM(g,m.props,R,b),RM(g,m.children,b),tc(),mf(void 0,g.update),nc()},Cn=(g,m,b,R,A,U,W,L,V=!1)=>{const x=g&&g.children,te=g?g.shapeFlag:0,J=m.children,{patchFlag:ne,shapeFlag:le}=m;if(ne>0){if(ne&128){Js(x,J,b,R,A,U,W,L,V);return}else if(ne&256){zo(x,J,b,R,A,U,W,L,V);return}}le&8?(te&16&&B(x,A,U),J!==x&&u(b,J)):te&16?le&16?Js(x,J,b,R,A,U,W,L,V):B(x,A,U,!0):(te&8&&u(b,""),le&16&&j(J,b,R,A,U,W,L,V))},zo=(g,m,b,R,A,U,W,L,V)=>{g=g||fa,m=m||fa;const x=g.length,te=m.length,J=Math.min(x,te);let ne;for(ne=0;ne<J;ne++){const le=m[ne]=V?Lr(m[ne]):Es(m[ne]);y(g[ne],le,b,null,A,U,W,L,V)}x>te?B(g,A,U,!0,!1,J):j(m,b,R,A,U,W,L,V,J)},Js=(g,m,b,R,A,U,W,L,V)=>{let x=0;const te=m.length;let J=g.length-1,ne=te-1;for(;x<=J&&x<=ne;){const le=g[x],Se=m[x]=V?Lr(m[x]):Es(m[x]);if(Li(le,Se))y(le,Se,b,null,A,U,W,L,V);else break;x++}for(;x<=J&&x<=ne;){const le=g[J],Se=m[ne]=V?Lr(m[ne]):Es(m[ne]);if(Li(le,Se))y(le,Se,b,null,A,U,W,L,V);else break;J--,ne--}if(x>J){if(x<=ne){const le=ne+1,Se=le<te?m[le].el:R;for(;x<=ne;)y(null,m[x]=V?Lr(m[x]):Es(m[x]),b,Se,A,U,W,L,V),x++}}else if(x>ne)for(;x<=J;)Un(g[x],A,U,!0),x++;else{const le=x,Se=x,Oe=new Map;for(x=Se;x<=ne;x++){const An=m[x]=V?Lr(m[x]):Es(m[x]);An.key!=null&&Oe.set(An.key,x)}let Me,He=0;const es=ne-Se+1;let Qo=!1,lb=0;const Cc=new Array(es);for(x=0;x<es;x++)Cc[x]=0;for(x=le;x<=J;x++){const An=g[x];if(He>=es){Un(An,A,U,!0);continue}let ws;if(An.key!=null)ws=Oe.get(An.key);else for(Me=Se;Me<=ne;Me++)if(Cc[Me-Se]===0&&Li(An,m[Me])){ws=Me;break}ws===void 0?Un(An,A,U,!0):(Cc[ws-Se]=x+1,ws>=lb?lb=ws:Qo=!0,y(An,m[ws],b,null,A,U,W,L,V),He++)}const ub=Qo?OM(Cc):fa;for(Me=ub.length-1,x=es-1;x>=0;x--){const An=Se+x,ws=m[An],hb=An+1<te?m[An+1].el:R;Cc[x]===0?y(null,ws,b,hb,A,U,W,L,V):Qo&&(Me<0||x!==ub[Me]?vs(ws,b,hb,2):Me--)}}},vs=(g,m,b,R,A=null)=>{const{el:U,type:W,transition:L,children:V,shapeFlag:x}=g;if(x&6){vs(g.component.subTree,m,b,R);return}if(x&128){g.suspense.move(m,b,R);return}if(x&64){W.move(g,m,b,Ve);return}if(W===os){s(U,m,b);for(let J=0;J<V.length;J++)vs(V[J],m,b,R);s(g.anchor,m,b);return}if(W===Mh){S(g,m,b);return}if(R!==2&&x&1&&L)if(R===0)L.beforeEnter(U),s(U,m,b),$t(()=>L.enter(U),A);else{const{leave:J,delayLeave:ne,afterLeave:le}=L,Se=()=>s(U,m,b),Oe=()=>{J(U,()=>{Se(),le&&le()})};ne?ne(U,Se,Oe):Oe()}else s(U,m,b)},Un=(g,m,b,R=!1,A=!1)=>{const{type:U,props:W,ref:L,children:V,dynamicChildren:x,shapeFlag:te,patchFlag:J,dirs:ne}=g;if(L!=null&&hm(L,null,b,g,!0),te&256){m.ctx.deactivate(g);return}const le=te&1&&ne,Se=!el(g);let Oe;if(Se&&(Oe=W&&W.onVnodeBeforeUnmount)&&Vn(Oe,m,g),te&6)Z(g.component,b,R);else{if(te&128){g.suspense.unmount(b,R);return}le&&Ti(g,null,m,"beforeUnmount"),te&64?g.type.remove(g,m,b,A,Ve,R):x&&(U!==os||J>0&&J&64)?B(x,m,b,!1,!0):(U===os&&J&384||!A&&te&16)&&B(V,m,b),R&&Wp(g)}(Se&&(Oe=W&&W.onVnodeUnmounted)||le)&&$t(()=>{Oe&&Vn(Oe,m,g),le&&Ti(g,null,m,"unmounted")},b)},Wp=g=>{const{type:m,el:b,anchor:R,transition:A}=g;if(m===os){C(b,R);return}if(m===Mh){H(g);return}const U=()=>{r(b),A&&!A.persisted&&A.afterLeave&&A.afterLeave()};if(g.shapeFlag&1&&A&&!A.persisted){const{leave:W,delayLeave:L}=A,V=()=>W(b,U);L?L(g.el,U,V):V()}else U()},C=(g,m)=>{let b;for(;g!==m;)b=d(g),r(g),g=b;r(m)},Z=(g,m,b)=>{const{bum:R,scope:A,update:U,subTree:W,um:L}=g;R&&ga(R),A.stop(),U&&(U.active=!1,Un(W,g,m,b)),L&&$t(L,m),$t(()=>{g.isUnmounted=!0},m),m&&m.pendingBranch&&!m.isUnmounted&&g.asyncDep&&!g.asyncResolved&&g.suspenseId===m.pendingId&&(m.deps--,m.deps===0&&m.resolve())},B=(g,m,b,R=!1,A=!1,U=0)=>{for(let W=U;W<g.length;W++)Un(g[W],m,b,R,A)},ee=g=>g.shapeFlag&6?ee(g.component.subTree):g.shapeFlag&128?g.suspense.next():d(g.anchor||g.el),De=(g,m,b)=>{g==null?m._vnode&&Un(m._vnode,null,null,!0):y(m._vnode||null,g,m,null,null,null,b),_0(),m._vnode=g},Ve={p:y,um:Un,m:vs,r:Wp,mt:Zn,mc:j,pc:Cn,pbc:X,n:ee,o:t};let we,fe;return e&&([we,fe]=e(Ve)),{render:De,hydrate:we,createApp:PM(De,we)}}function Si({effect:t,update:e},n){t.allowRecurse=e.allowRecurse=n}function U0(t,e,n=!1){const s=t.children,r=e.children;if(se(s)&&se(r))for(let i=0;i<s.length;i++){const o=s[i];let a=r[i];a.shapeFlag&1&&!a.dynamicChildren&&((a.patchFlag<=0||a.patchFlag===32)&&(a=r[i]=Lr(r[i]),a.el=o.el),n||U0(o,a))}}function OM(t){const e=t.slice(),n=[0];let s,r,i,o,a;const c=t.length;for(s=0;s<c;s++){const l=t[s];if(l!==0){if(r=n[n.length-1],t[r]<l){e[s]=r,n.push(s);continue}for(i=0,o=n.length-1;i<o;)a=i+o>>1,t[n[a]]<l?i=a+1:o=a;l<t[n[i]]&&(i>0&&(e[s]=n[i-1]),n[i]=s)}}for(i=n.length,o=n[i-1];i-- >0;)n[i]=o,o=e[o];return n}const MM=t=>t.__isTeleport,os=Symbol(void 0),ty=Symbol(void 0),fs=Symbol(void 0),Mh=Symbol(void 0),tl=[];let ls=null;function Rs(t=!1){tl.push(ls=t?null:[])}function LM(){tl.pop(),ls=tl[tl.length-1]||null}let Al=1;function xb(t){Al+=t}function $0(t){return t.dynamicChildren=Al>0?ls||fa:null,LM(),Al>0&&ls&&ls.push(t),t}function Na(t,e,n,s,r,i){return $0(Je(t,e,n,s,r,i,!0))}function Lh(t,e,n,s,r){return $0(qe(t,e,n,s,r,!0))}function id(t){return t?t.__v_isVNode===!0:!1}function Li(t,e){return t.type===e.type&&t.key===e.key}const bf="__vInternal",V0=({key:t})=>t!=null?t:null,Fh=({ref:t,ref_key:e,ref_for:n})=>t!=null?mt(t)||nt(t)||de(t)?{i:qn,r:t,k:e,f:!!n}:t:null;function Je(t,e=null,n=null,s=0,r=null,i=t===os?0:1,o=!1,a=!1){const c={__v_isVNode:!0,__v_skip:!0,type:t,props:e,key:e&&V0(e),ref:e&&Fh(e),scopeId:yf,slotScopeIds:null,children:n,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:i,patchFlag:s,dynamicProps:r,dynamicChildren:null,appContext:null};return a?(ny(c,n),i&128&&t.normalize(c)):n&&(c.shapeFlag|=mt(n)?8:16),Al>0&&!o&&ls&&(c.patchFlag>0||i&6)&&c.patchFlag!==32&&ls.push(c),c}const qe=FM;function FM(t,e=null,n=null,s=0,r=null,i=!1){if((!t||t===_M)&&(t=fs),id(t)){const a=pr(t,e,!0);return n&&ny(a,n),Al>0&&!i&&ls&&(a.shapeFlag&6?ls[ls.indexOf(t)]=a:ls.push(a)),a.patchFlag|=-2,a}if(zM(t)&&(t=t.__vccOpts),e){e=UM(e);let{class:a,style:c}=e;a&&!mt(a)&&(e.class=F_(a)),st(c)&&(c0(c)&&!se(c)&&(c=Gt({},c)),e.style=L_(c))}const o=mt(t)?1:w0(t)?128:MM(t)?64:st(t)?4:de(t)?2:0;return Je(t,e,n,s,r,o,i,!0)}function UM(t){return t?c0(t)||bf in t?Gt({},t):t:null}function pr(t,e,n=!1){const{props:s,ref:r,patchFlag:i,children:o}=t,a=e?VM(s||{},e):s;return{__v_isVNode:!0,__v_skip:!0,type:t.type,props:a,key:a&&V0(a),ref:e&&e.ref?n&&r?se(r)?r.concat(Fh(e)):[r,Fh(e)]:Fh(e):r,scopeId:t.scopeId,slotScopeIds:t.slotScopeIds,children:o,target:t.target,targetAnchor:t.targetAnchor,staticCount:t.staticCount,shapeFlag:t.shapeFlag,patchFlag:e&&t.type!==os?i===-1?16:i|16:i,dynamicProps:t.dynamicProps,dynamicChildren:t.dynamicChildren,appContext:t.appContext,dirs:t.dirs,transition:t.transition,component:t.component,suspense:t.suspense,ssContent:t.ssContent&&pr(t.ssContent),ssFallback:t.ssFallback&&pr(t.ssFallback),el:t.el,anchor:t.anchor}}function zs(t=" ",e=0){return qe(ty,null,t,e)}function $M(t,e){const n=qe(Mh,null,t);return n.staticCount=e,n}function nl(t="",e=!1){return e?(Rs(),Lh(fs,null,t)):qe(fs,null,t)}function Es(t){return t==null||typeof t=="boolean"?qe(fs):se(t)?qe(os,null,t.slice()):typeof t=="object"?Lr(t):qe(ty,null,String(t))}function Lr(t){return t.el===null||t.memo?t:pr(t)}function ny(t,e){let n=0;const{shapeFlag:s}=t;if(e==null)e=null;else if(se(e))n=16;else if(typeof e=="object")if(s&65){const r=e.default;r&&(r._c&&(r._d=!1),ny(t,r()),r._c&&(r._d=!0));return}else{n=32;const r=e._;!r&&!(bf in e)?e._ctx=qn:r===3&&qn&&(qn.slots._===1?e._=1:(e._=2,t.patchFlag|=1024))}else de(e)?(e={default:e,_ctx:qn},n=32):(e=String(e),s&64?(n=16,e=[zs(e)]):n=8);t.children=e,t.shapeFlag|=n}function VM(...t){const e={};for(let n=0;n<t.length;n++){const s=t[n];for(const r in s)if(r==="class")e.class!==s.class&&(e.class=F_([e.class,s.class]));else if(r==="style")e.style=L_([e.style,s.style]);else if(lf(r)){const i=e[r],o=s[r];o&&i!==o&&!(se(i)&&i.includes(o))&&(e[r]=i?[].concat(i,o):o)}else r!==""&&(e[r]=s[r])}return e}function Vn(t,e,n,s=null){zn(t,e,7,[n,s])}const BM=F0();let jM=0;function qM(t,e,n){const s=t.type,r=(e?e.appContext:t.appContext)||BM,i={uid:jM++,vnode:t,type:s,parent:e,appContext:r,root:null,next:null,subTree:null,effect:null,update:null,scope:new QS(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:e?e.provides:Object.create(r.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:D0(s,r),emitsOptions:v0(s,r),emit:null,emitted:null,propsDefaults:Fe,inheritAttrs:s.inheritAttrs,ctx:Fe,data:Fe,props:Fe,attrs:Fe,slots:Fe,refs:Fe,setupState:Fe,setupContext:null,suspense:n,suspenseId:n?n.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return i.ctx={_:i},i.root=e?e.root:i,i.emit=XO.bind(null,i),t.ce&&t.ce(i),i}let At=null;const If=()=>At||qn,Pa=t=>{At=t,t.scope.on()},eo=()=>{At&&At.scope.off(),At=null};function B0(t){return t.vnode.shapeFlag&4}let kl=!1;function KM(t,e=!1){kl=e;const{props:n,children:s}=t.vnode,r=B0(t);SM(t,n,r,e),kM(t,s);const i=r?HM(t,e):void 0;return kl=!1,i}function HM(t,e){const n=t.type;t.accessCache=Object.create(null),t.proxy=is(new Proxy(t.ctx,vM));const{setup:s}=n;if(s){const r=t.setupContext=s.length>1?GM(t):null;Pa(t),tc();const i=zr(s,t,0,[t.props,r]);if(nc(),eo(),WS(i)){if(i.then(eo,eo),e)return i.then(o=>{Db(t,o,e)}).catch(o=>{gf(o,t,0)});t.asyncDep=i}else Db(t,i,e)}else j0(t,e)}function Db(t,e,n){de(e)?t.type.__ssrInlineRender?t.ssrRender=e:t.render=e:st(e)&&(t.setupState=d0(e)),j0(t,n)}let Ob;function j0(t,e,n){const s=t.type;if(!t.render){if(!e&&Ob&&!s.render){const r=s.template;if(r){const{isCustomElement:i,compilerOptions:o}=t.appContext.config,{delimiters:a,compilerOptions:c}=s,l=Gt(Gt({isCustomElement:i,delimiters:a},o),c);s.render=Ob(r,l)}}t.render=s.render||ds}Pa(t),tc(),wM(t),nc(),eo()}function WM(t){return new Proxy(t.attrs,{get(e,n){return On(t,"get","$attrs"),e[n]}})}function GM(t){const e=s=>{t.exposed=s||{}};let n;return{get attrs(){return n||(n=WM(t))},slots:t.slots,emit:t.emit,expose:e}}function Ef(t){if(t.exposed)return t.exposeProxy||(t.exposeProxy=new Proxy(d0(is(t.exposed)),{get(e,n){if(n in e)return e[n];if(n in sd)return sd[n](t)}}))}function dm(t,e=!0){return de(t)?t.displayName||t.name:t.name||e&&t.__name}function zM(t){return de(t)&&"__vccOpts"in t}const Bn=(t,e)=>WO(t,e,kl);function sy(t,e,n){const s=arguments.length;return s===2?st(e)&&!se(e)?id(e)?qe(t,null,[e]):qe(t,e):qe(t,null,e):(s>3?n=Array.prototype.slice.call(arguments,2):s===3&&id(n)&&(n=[n]),qe(t,e,n))}const QM="3.2.37",YM="http://www.w3.org/2000/svg",Fi=typeof document<"u"?document:null,Mb=Fi&&Fi.createElement("template"),JM={insert:(t,e,n)=>{e.insertBefore(t,n||null)},remove:t=>{const e=t.parentNode;e&&e.removeChild(t)},createElement:(t,e,n,s)=>{const r=e?Fi.createElementNS(YM,t):Fi.createElement(t,n?{is:n}:void 0);return t==="select"&&s&&s.multiple!=null&&r.setAttribute("multiple",s.multiple),r},createText:t=>Fi.createTextNode(t),createComment:t=>Fi.createComment(t),setText:(t,e)=>{t.nodeValue=e},setElementText:(t,e)=>{t.textContent=e},parentNode:t=>t.parentNode,nextSibling:t=>t.nextSibling,querySelector:t=>Fi.querySelector(t),setScopeId(t,e){t.setAttribute(e,"")},cloneNode(t){const e=t.cloneNode(!0);return"_value"in t&&(e._value=t._value),e},insertStaticContent(t,e,n,s,r,i){const o=n?n.previousSibling:e.lastChild;if(r&&(r===i||r.nextSibling))for(;e.insertBefore(r.cloneNode(!0),n),!(r===i||!(r=r.nextSibling)););else{Mb.innerHTML=s?`<svg>${t}</svg>`:t;const a=Mb.content;if(s){const c=a.firstChild;for(;c.firstChild;)a.appendChild(c.firstChild);a.removeChild(c)}e.insertBefore(a,n)}return[o?o.nextSibling:e.firstChild,n?n.previousSibling:e.lastChild]}};function XM(t,e,n){const s=t._vtc;s&&(e=(e?[e,...s]:[...s]).join(" ")),e==null?t.removeAttribute("class"):n?t.setAttribute("class",e):t.className=e}function ZM(t,e,n){const s=t.style,r=mt(n);if(n&&!r){for(const i in n)fm(s,i,n[i]);if(e&&!mt(e))for(const i in e)n[i]==null&&fm(s,i,"")}else{const i=s.display;r?e!==n&&(s.cssText=n):e&&t.removeAttribute("style"),"_vod"in t&&(s.display=i)}}const Lb=/\s*!important$/;function fm(t,e,n){if(se(n))n.forEach(s=>fm(t,e,s));else if(n==null&&(n=""),e.startsWith("--"))t.setProperty(e,n);else{const s=e1(t,e);Lb.test(n)?t.setProperty(Mo(s),n.replace(Lb,""),"important"):t[s]=n}}const Fb=["Webkit","Moz","ms"],Xp={};function e1(t,e){const n=Xp[e];if(n)return n;let s=Vs(e);if(s!=="filter"&&s in t)return Xp[e]=s;s=df(s);for(let r=0;r<Fb.length;r++){const i=Fb[r]+s;if(i in t)return Xp[e]=i}return e}const Ub="http://www.w3.org/1999/xlink";function t1(t,e,n,s,r){if(s&&e.startsWith("xlink:"))n==null?t.removeAttributeNS(Ub,e.slice(6,e.length)):t.setAttributeNS(Ub,e,n);else{const i=tO(e);n==null||i&&!KS(n)?t.removeAttribute(e):t.setAttribute(e,i?"":n)}}function n1(t,e,n,s,r,i,o){if(e==="innerHTML"||e==="textContent"){s&&o(s,r,i),t[e]=n==null?"":n;return}if(e==="value"&&t.tagName!=="PROGRESS"&&!t.tagName.includes("-")){t._value=n;const c=n==null?"":n;(t.value!==c||t.tagName==="OPTION")&&(t.value=c),n==null&&t.removeAttribute(e);return}let a=!1;if(n===""||n==null){const c=typeof t[e];c==="boolean"?n=KS(n):n==null&&c==="string"?(n="",a=!0):c==="number"&&(n=0,a=!0)}try{t[e]=n}catch{}a&&t.removeAttribute(e)}const[q0,s1]=(()=>{let t=Date.now,e=!1;if(typeof window<"u"){Date.now()>document.createEvent("Event").timeStamp&&(t=performance.now.bind(performance));const n=navigator.userAgent.match(/firefox\/(\d+)/i);e=!!(n&&Number(n[1])<=53)}return[t,e]})();let pm=0;const r1=Promise.resolve(),i1=()=>{pm=0},o1=()=>pm||(r1.then(i1),pm=q0());function $r(t,e,n,s){t.addEventListener(e,n,s)}function a1(t,e,n,s){t.removeEventListener(e,n,s)}function c1(t,e,n,s,r=null){const i=t._vei||(t._vei={}),o=i[e];if(s&&o)o.value=s;else{const[a,c]=l1(e);if(s){const l=i[e]=u1(s,r);$r(t,a,l,c)}else o&&(a1(t,a,o,c),i[e]=void 0)}}const $b=/(?:Once|Passive|Capture)$/;function l1(t){let e;if($b.test(t)){e={};let n;for(;n=t.match($b);)t=t.slice(0,t.length-n[0].length),e[n[0].toLowerCase()]=!0}return[Mo(t.slice(2)),e]}function u1(t,e){const n=s=>{const r=s.timeStamp||q0();(s1||r>=n.attached-1)&&zn(h1(s,n.value),e,5,[s])};return n.value=t,n.attached=o1(),n}function h1(t,e){if(se(e)){const n=t.stopImmediatePropagation;return t.stopImmediatePropagation=()=>{n.call(t),t._stopped=!0},e.map(s=>r=>!r._stopped&&s&&s(r))}else return e}const Vb=/^on[a-z]/,d1=(t,e,n,s,r=!1,i,o,a,c)=>{e==="class"?XM(t,s,r):e==="style"?ZM(t,n,s):lf(e)?U_(e)||c1(t,e,n,s,o):(e[0]==="."?(e=e.slice(1),!0):e[0]==="^"?(e=e.slice(1),!1):f1(t,e,s,r))?n1(t,e,s,i,o,a,c):(e==="true-value"?t._trueValue=s:e==="false-value"&&(t._falseValue=s),t1(t,e,s,r))};function f1(t,e,n,s){return s?!!(e==="innerHTML"||e==="textContent"||e in t&&Vb.test(e)&&de(n)):e==="spellcheck"||e==="draggable"||e==="translate"||e==="form"||e==="list"&&t.tagName==="INPUT"||e==="type"&&t.tagName==="TEXTAREA"||Vb.test(e)&&mt(n)?!1:e in t}const kr="transition",Ac="animation",ry=(t,{slots:e})=>sy(E0,p1(t),e);ry.displayName="Transition";const K0={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String};ry.props=Gt({},E0.props,K0);const Ci=(t,e=[])=>{se(t)?t.forEach(n=>n(...e)):t&&t(...e)},Bb=t=>t?se(t)?t.some(e=>e.length>1):t.length>1:!1;function p1(t){const e={};for(const K in t)K in K0||(e[K]=t[K]);if(t.css===!1)return e;const{name:n="v",type:s,duration:r,enterFromClass:i=`${n}-enter-from`,enterActiveClass:o=`${n}-enter-active`,enterToClass:a=`${n}-enter-to`,appearFromClass:c=i,appearActiveClass:l=o,appearToClass:u=a,leaveFromClass:h=`${n}-leave-from`,leaveActiveClass:d=`${n}-leave-active`,leaveToClass:f=`${n}-leave-to`}=t,p=g1(r),_=p&&p[0],y=p&&p[1],{onBeforeEnter:T,onEnter:I,onEnterCancelled:E,onLeave:S,onLeaveCancelled:H,onBeforeAppear:Y=T,onAppear:M=I,onAppearCancelled:G=E}=e,j=(K,ve,vt)=>{Ai(K,ve?u:a),Ai(K,ve?l:o),vt&&vt()},F=(K,ve)=>{K._isLeaving=!1,Ai(K,h),Ai(K,f),Ai(K,d),ve&&ve()},X=K=>(ve,vt)=>{const Zn=K?M:I,Ne=()=>j(ve,K,vt);Ci(Zn,[ve,Ne]),jb(()=>{Ai(ve,K?c:i),Rr(ve,K?u:a),Bb(Zn)||qb(ve,s,_,Ne)})};return Gt(e,{onBeforeEnter(K){Ci(T,[K]),Rr(K,i),Rr(K,o)},onBeforeAppear(K){Ci(Y,[K]),Rr(K,c),Rr(K,l)},onEnter:X(!1),onAppear:X(!0),onLeave(K,ve){K._isLeaving=!0;const vt=()=>F(K,ve);Rr(K,h),y1(),Rr(K,d),jb(()=>{!K._isLeaving||(Ai(K,h),Rr(K,f),Bb(S)||qb(K,s,y,vt))}),Ci(S,[K,vt])},onEnterCancelled(K){j(K,!1),Ci(E,[K])},onAppearCancelled(K){j(K,!0),Ci(G,[K])},onLeaveCancelled(K){F(K),Ci(H,[K])}})}function g1(t){if(t==null)return null;if(st(t))return[Zp(t.enter),Zp(t.leave)];{const e=Zp(t);return[e,e]}}function Zp(t){return El(t)}function Rr(t,e){e.split(/\s+/).forEach(n=>n&&t.classList.add(n)),(t._vtc||(t._vtc=new Set)).add(e)}function Ai(t,e){e.split(/\s+/).forEach(s=>s&&t.classList.remove(s));const{_vtc:n}=t;n&&(n.delete(e),n.size||(t._vtc=void 0))}function jb(t){requestAnimationFrame(()=>{requestAnimationFrame(t)})}let m1=0;function qb(t,e,n,s){const r=t._endId=++m1,i=()=>{r===t._endId&&s()};if(n)return setTimeout(i,n);const{type:o,timeout:a,propCount:c}=_1(t,e);if(!o)return s();const l=o+"end";let u=0;const h=()=>{t.removeEventListener(l,d),i()},d=f=>{f.target===t&&++u>=c&&h()};setTimeout(()=>{u<c&&h()},a+1),t.addEventListener(l,d)}function _1(t,e){const n=window.getComputedStyle(t),s=p=>(n[p]||"").split(", "),r=s(kr+"Delay"),i=s(kr+"Duration"),o=Kb(r,i),a=s(Ac+"Delay"),c=s(Ac+"Duration"),l=Kb(a,c);let u=null,h=0,d=0;e===kr?o>0&&(u=kr,h=o,d=i.length):e===Ac?l>0&&(u=Ac,h=l,d=c.length):(h=Math.max(o,l),u=h>0?o>l?kr:Ac:null,d=u?u===kr?i.length:c.length:0);const f=u===kr&&/\b(transform|all)(,|$)/.test(n[kr+"Property"]);return{type:u,timeout:h,propCount:d,hasTransform:f}}function Kb(t,e){for(;t.length<e.length;)t=t.concat(t);return Math.max(...e.map((n,s)=>Hb(n)+Hb(t[s])))}function Hb(t){return Number(t.slice(0,-1).replace(",","."))*1e3}function y1(){return document.body.offsetHeight}const xa=t=>{const e=t.props["onUpdate:modelValue"]||!1;return se(e)?n=>ga(e,n):e};function v1(t){t.target.composing=!0}function Wb(t){const e=t.target;e.composing&&(e.composing=!1,e.dispatchEvent(new Event("input")))}const WZ={created(t,{modifiers:{lazy:e,trim:n,number:s}},r){t._assign=xa(r);const i=s||r.props&&r.props.type==="number";$r(t,e?"change":"input",o=>{if(o.target.composing)return;let a=t.value;n&&(a=a.trim()),i&&(a=El(a)),t._assign(a)}),n&&$r(t,"change",()=>{t.value=t.value.trim()}),e||($r(t,"compositionstart",v1),$r(t,"compositionend",Wb),$r(t,"change",Wb))},mounted(t,{value:e}){t.value=e==null?"":e},beforeUpdate(t,{value:e,modifiers:{lazy:n,trim:s,number:r}},i){if(t._assign=xa(i),t.composing||document.activeElement===t&&t.type!=="range"&&(n||s&&t.value.trim()===e||(r||t.type==="number")&&El(t.value)===e))return;const o=e==null?"":e;t.value!==o&&(t.value=o)}},GZ={created(t,{value:e},n){t.checked=Ra(e,n.props.value),t._assign=xa(n),$r(t,"change",()=>{t._assign(Rl(t))})},beforeUpdate(t,{value:e,oldValue:n},s){t._assign=xa(s),e!==n&&(t.checked=Ra(e,s.props.value))}},zZ={deep:!0,created(t,{value:e,modifiers:{number:n}},s){const r=uf(e);$r(t,"change",()=>{const i=Array.prototype.filter.call(t.options,o=>o.selected).map(o=>n?El(Rl(o)):Rl(o));t._assign(t.multiple?r?new Set(i):i:i[0])}),t._assign=xa(s)},mounted(t,{value:e}){Gb(t,e)},beforeUpdate(t,e,n){t._assign=xa(n)},updated(t,{value:e}){Gb(t,e)}};function Gb(t,e){const n=t.multiple;if(!(n&&!se(e)&&!uf(e))){for(let s=0,r=t.options.length;s<r;s++){const i=t.options[s],o=Rl(i);if(n)se(e)?i.selected=oO(e,o)>-1:i.selected=e.has(o);else if(Ra(Rl(i),e)){t.selectedIndex!==s&&(t.selectedIndex=s);return}}!n&&t.selectedIndex!==-1&&(t.selectedIndex=-1)}}function Rl(t){return"_value"in t?t._value:t.value}const w1={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},QZ=(t,e)=>n=>{if(!("key"in n))return;const s=Mo(n.key);if(e.some(r=>r===s||w1[r]===s))return t(n)},b1=Gt({patchProp:d1},JM);let zb;function I1(){return zb||(zb=xM(b1))}const E1=(...t)=>{const e=I1().createApp(...t),{mount:n}=e;return e.mount=s=>{const r=T1(s);if(!r)return;const i=e._component;!de(i)&&!i.render&&!i.template&&(i.template=r.innerHTML),r.innerHTML="";const o=n(r,!1,r instanceof SVGElement);return r instanceof Element&&(r.removeAttribute("v-cloak"),r.setAttribute("data-v-app","")),o},e};function T1(t){return mt(t)?document.querySelector(t):t}const S1="modulepreload",C1=function(t){return"/Educatia/"+t},Qb={},bs=function(e,n,s){return!n||n.length===0?e():Promise.all(n.map(r=>{if(r=C1(r),r in Qb)return;Qb[r]=!0;const i=r.endsWith(".css"),o=i?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${r}"]${o}`))return;const a=document.createElement("link");if(a.rel=i?"stylesheet":S1,i||(a.as="script",a.crossOrigin=""),a.href=r,document.head.appendChild(a),i)return new Promise((c,l)=>{a.addEventListener("load",c),a.addEventListener("error",()=>l(new Error(`Unable to preload CSS for ${r}`)))})})).then(()=>e())};function A1(){return H0().__VUE_DEVTOOLS_GLOBAL_HOOK__}function H0(){return typeof navigator<"u"&&typeof window<"u"?window:typeof global<"u"?global:{}}const k1=typeof Proxy=="function",R1="devtools-plugin:setup",N1="plugin:settings:set";let Yo,gm;function P1(){var t;return Yo!==void 0||(typeof window<"u"&&window.performance?(Yo=!0,gm=window.performance):typeof global<"u"&&((t=global.perf_hooks)===null||t===void 0?void 0:t.performance)?(Yo=!0,gm=global.perf_hooks.performance):Yo=!1),Yo}function x1(){return P1()?gm.now():Date.now()}class D1{constructor(e,n){this.target=null,this.targetQueue=[],this.onQueue=[],this.plugin=e,this.hook=n;const s={};if(e.settings)for(const o in e.settings){const a=e.settings[o];s[o]=a.defaultValue}const r=`__vue-devtools-plugin-settings__${e.id}`;let i=Object.assign({},s);try{const o=localStorage.getItem(r),a=JSON.parse(o);Object.assign(i,a)}catch{}this.fallbacks={getSettings(){return i},setSettings(o){try{localStorage.setItem(r,JSON.stringify(o))}catch{}i=o},now(){return x1()}},n&&n.on(N1,(o,a)=>{o===this.plugin.id&&this.fallbacks.setSettings(a)}),this.proxiedOn=new Proxy({},{get:(o,a)=>this.target?this.target.on[a]:(...c)=>{this.onQueue.push({method:a,args:c})}}),this.proxiedTarget=new Proxy({},{get:(o,a)=>this.target?this.target[a]:a==="on"?this.proxiedOn:Object.keys(this.fallbacks).includes(a)?(...c)=>(this.targetQueue.push({method:a,args:c,resolve:()=>{}}),this.fallbacks[a](...c)):(...c)=>new Promise(l=>{this.targetQueue.push({method:a,args:c,resolve:l})})})}async setRealTarget(e){this.target=e;for(const n of this.onQueue)this.target.on[n.method](...n.args);for(const n of this.targetQueue)n.resolve(await this.target[n.method](...n.args))}}function W0(t,e){const n=t,s=H0(),r=A1(),i=k1&&n.enableEarlyProxy;if(r&&(s.__VUE_DEVTOOLS_PLUGIN_API_AVAILABLE__||!i))r.emit(R1,t,e);else{const o=i?new D1(n,r):null;(s.__VUE_DEVTOOLS_PLUGINS__=s.__VUE_DEVTOOLS_PLUGINS__||[]).push({pluginDescriptor:n,setupFn:e,proxy:o}),o&&e(o.proxiedTarget)}}/*!
  * vue-router v4.0.13
  * (c) 2022 Eduardo San Martin Morote
  * @license MIT
  */const G0=typeof Symbol=="function"&&typeof Symbol.toStringTag=="symbol",rc=t=>G0?Symbol(t):"_vr_"+t,O1=rc("rvlm"),Yb=rc("rvd"),Tf=rc("r"),z0=rc("rl"),mm=rc("rvl"),aa=typeof window<"u";function M1(t){return t.__esModule||G0&&t[Symbol.toStringTag]==="Module"}const Le=Object.assign;function eg(t,e){const n={};for(const s in e){const r=e[s];n[s]=Array.isArray(r)?r.map(t):t(r)}return n}const sl=()=>{},L1=/\/$/,F1=t=>t.replace(L1,"");function tg(t,e,n="/"){let s,r={},i="",o="";const a=e.indexOf("?"),c=e.indexOf("#",a>-1?a:0);return a>-1&&(s=e.slice(0,a),i=e.slice(a+1,c>-1?c:e.length),r=t(i)),c>-1&&(s=s||e.slice(0,c),o=e.slice(c,e.length)),s=B1(s!=null?s:e,n),{fullPath:s+(i&&"?")+i+o,path:s,query:r,hash:o}}function U1(t,e){const n=e.query?t(e.query):"";return e.path+(n&&"?")+n+(e.hash||"")}function Jb(t,e){return!e||!t.toLowerCase().startsWith(e.toLowerCase())?t:t.slice(e.length)||"/"}function $1(t,e,n){const s=e.matched.length-1,r=n.matched.length-1;return s>-1&&s===r&&Da(e.matched[s],n.matched[r])&&Q0(e.params,n.params)&&t(e.query)===t(n.query)&&e.hash===n.hash}function Da(t,e){return(t.aliasOf||t)===(e.aliasOf||e)}function Q0(t,e){if(Object.keys(t).length!==Object.keys(e).length)return!1;for(const n in t)if(!V1(t[n],e[n]))return!1;return!0}function V1(t,e){return Array.isArray(t)?Xb(t,e):Array.isArray(e)?Xb(e,t):t===e}function Xb(t,e){return Array.isArray(e)?t.length===e.length&&t.every((n,s)=>n===e[s]):t.length===1&&t[0]===e}function B1(t,e){if(t.startsWith("/"))return t;if(!t)return e;const n=e.split("/"),s=t.split("/");let r=n.length-1,i,o;for(i=0;i<s.length;i++)if(o=s[i],!(r===1||o==="."))if(o==="..")r--;else break;return n.slice(0,r).join("/")+"/"+s.slice(i-(i===s.length?1:0)).join("/")}var Nl;(function(t){t.pop="pop",t.push="push"})(Nl||(Nl={}));var rl;(function(t){t.back="back",t.forward="forward",t.unknown=""})(rl||(rl={}));function j1(t){if(!t)if(aa){const e=document.querySelector("base");t=e&&e.getAttribute("href")||"/",t=t.replace(/^\w+:\/\/[^\/]+/,"")}else t="/";return t[0]!=="/"&&t[0]!=="#"&&(t="/"+t),F1(t)}const q1=/^[^#]+#/;function K1(t,e){return t.replace(q1,"#")+e}function H1(t,e){const n=document.documentElement.getBoundingClientRect(),s=t.getBoundingClientRect();return{behavior:e.behavior,left:s.left-n.left-(e.left||0),top:s.top-n.top-(e.top||0)}}const Sf=()=>({left:window.pageXOffset,top:window.pageYOffset});function W1(t){let e;if("el"in t){const n=t.el,s=typeof n=="string"&&n.startsWith("#"),r=typeof n=="string"?s?document.getElementById(n.slice(1)):document.querySelector(n):n;if(!r)return;e=H1(r,t)}else e=t;"scrollBehavior"in document.documentElement.style?window.scrollTo(e):window.scrollTo(e.left!=null?e.left:window.pageXOffset,e.top!=null?e.top:window.pageYOffset)}function Zb(t,e){return(history.state?history.state.position-e:-1)+t}const _m=new Map;function G1(t,e){_m.set(t,e)}function z1(t){const e=_m.get(t);return _m.delete(t),e}let Q1=()=>location.protocol+"//"+location.host;function Y0(t,e){const{pathname:n,search:s,hash:r}=e,i=t.indexOf("#");if(i>-1){let a=r.includes(t.slice(i))?t.slice(i).length:1,c=r.slice(a);return c[0]!=="/"&&(c="/"+c),Jb(c,"")}return Jb(n,t)+s+r}function Y1(t,e,n,s){let r=[],i=[],o=null;const a=({state:d})=>{const f=Y0(t,location),p=n.value,_=e.value;let y=0;if(d){if(n.value=f,e.value=d,o&&o===p){o=null;return}y=_?d.position-_.position:0}else s(f);r.forEach(T=>{T(n.value,p,{delta:y,type:Nl.pop,direction:y?y>0?rl.forward:rl.back:rl.unknown})})};function c(){o=n.value}function l(d){r.push(d);const f=()=>{const p=r.indexOf(d);p>-1&&r.splice(p,1)};return i.push(f),f}function u(){const{history:d}=window;!d.state||d.replaceState(Le({},d.state,{scroll:Sf()}),"")}function h(){for(const d of i)d();i=[],window.removeEventListener("popstate",a),window.removeEventListener("beforeunload",u)}return window.addEventListener("popstate",a),window.addEventListener("beforeunload",u),{pauseListeners:c,listen:l,destroy:h}}function eI(t,e,n,s=!1,r=!1){return{back:t,current:e,forward:n,replaced:s,position:window.history.length,scroll:r?Sf():null}}function J1(t){const{history:e,location:n}=window,s={value:Y0(t,n)},r={value:e.state};r.value||i(s.value,{back:null,current:s.value,forward:null,position:e.length-1,replaced:!0,scroll:null},!0);function i(c,l,u){const h=t.indexOf("#"),d=h>-1?(n.host&&document.querySelector("base")?t:t.slice(h))+c:Q1()+t+c;try{e[u?"replaceState":"pushState"](l,"",d),r.value=l}catch(f){console.error(f),n[u?"replace":"assign"](d)}}function o(c,l){const u=Le({},e.state,eI(r.value.back,c,r.value.forward,!0),l,{position:r.value.position});i(c,u,!0),s.value=c}function a(c,l){const u=Le({},r.value,e.state,{forward:c,scroll:Sf()});i(u.current,u,!0);const h=Le({},eI(s.value,c,null),{position:u.position+1},l);i(c,h,!1),s.value=c}return{location:s,state:r,push:a,replace:o}}function X1(t){t=j1(t);const e=J1(t),n=Y1(t,e.state,e.location,e.replace);function s(i,o=!0){o||n.pauseListeners(),history.go(i)}const r=Le({location:"",base:t,go:s,createHref:K1.bind(null,t)},e,n);return Object.defineProperty(r,"location",{enumerable:!0,get:()=>e.location.value}),Object.defineProperty(r,"state",{enumerable:!0,get:()=>e.state.value}),r}function Z1(t){return t=location.host?t||location.pathname+location.search:"",t.includes("#")||(t+="#"),X1(t)}function eL(t){return typeof t=="string"||t&&typeof t=="object"}function J0(t){return typeof t=="string"||typeof t=="symbol"}const Nr={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0},X0=rc("nf");var tI;(function(t){t[t.aborted=4]="aborted",t[t.cancelled=8]="cancelled",t[t.duplicated=16]="duplicated"})(tI||(tI={}));function Oa(t,e){return Le(new Error,{type:t,[X0]:!0},e)}function Pr(t,e){return t instanceof Error&&X0 in t&&(e==null||!!(t.type&e))}const nI="[^/]+?",tL={sensitive:!1,strict:!1,start:!0,end:!0},nL=/[.+*?^${}()[\]/\\]/g;function sL(t,e){const n=Le({},tL,e),s=[];let r=n.start?"^":"";const i=[];for(const l of t){const u=l.length?[]:[90];n.strict&&!l.length&&(r+="/");for(let h=0;h<l.length;h++){const d=l[h];let f=40+(n.sensitive?.25:0);if(d.type===0)h||(r+="/"),r+=d.value.replace(nL,"\\$&"),f+=40;else if(d.type===1){const{value:p,repeatable:_,optional:y,regexp:T}=d;i.push({name:p,repeatable:_,optional:y});const I=T||nI;if(I!==nI){f+=10;try{new RegExp(`(${I})`)}catch(S){throw new Error(`Invalid custom RegExp for param "${p}" (${I}): `+S.message)}}let E=_?`((?:${I})(?:/(?:${I}))*)`:`(${I})`;h||(E=y&&l.length<2?`(?:/${E})`:"/"+E),y&&(E+="?"),r+=E,f+=20,y&&(f+=-8),_&&(f+=-20),I===".*"&&(f+=-50)}u.push(f)}s.push(u)}if(n.strict&&n.end){const l=s.length-1;s[l][s[l].length-1]+=.7000000000000001}n.strict||(r+="/?"),n.end?r+="$":n.strict&&(r+="(?:/|$)");const o=new RegExp(r,n.sensitive?"":"i");function a(l){const u=l.match(o),h={};if(!u)return null;for(let d=1;d<u.length;d++){const f=u[d]||"",p=i[d-1];h[p.name]=f&&p.repeatable?f.split("/"):f}return h}function c(l){let u="",h=!1;for(const d of t){(!h||!u.endsWith("/"))&&(u+="/"),h=!1;for(const f of d)if(f.type===0)u+=f.value;else if(f.type===1){const{value:p,repeatable:_,optional:y}=f,T=p in l?l[p]:"";if(Array.isArray(T)&&!_)throw new Error(`Provided param "${p}" is an array but it is not repeatable (* or + modifiers)`);const I=Array.isArray(T)?T.join("/"):T;if(!I)if(y)d.length<2&&(u.endsWith("/")?u=u.slice(0,-1):h=!0);else throw new Error(`Missing required param "${p}"`);u+=I}}return u}return{re:o,score:s,keys:i,parse:a,stringify:c}}function rL(t,e){let n=0;for(;n<t.length&&n<e.length;){const s=e[n]-t[n];if(s)return s;n++}return t.length<e.length?t.length===1&&t[0]===40+40?-1:1:t.length>e.length?e.length===1&&e[0]===40+40?1:-1:0}function iL(t,e){let n=0;const s=t.score,r=e.score;for(;n<s.length&&n<r.length;){const i=rL(s[n],r[n]);if(i)return i;n++}return r.length-s.length}const oL={type:0,value:""},aL=/[a-zA-Z0-9_]/;function cL(t){if(!t)return[[]];if(t==="/")return[[oL]];if(!t.startsWith("/"))throw new Error(`Invalid path "${t}"`);function e(f){throw new Error(`ERR (${n})/"${l}": ${f}`)}let n=0,s=n;const r=[];let i;function o(){i&&r.push(i),i=[]}let a=0,c,l="",u="";function h(){!l||(n===0?i.push({type:0,value:l}):n===1||n===2||n===3?(i.length>1&&(c==="*"||c==="+")&&e(`A repeatable param (${l}) must be alone in its segment. eg: '/:ids+.`),i.push({type:1,value:l,regexp:u,repeatable:c==="*"||c==="+",optional:c==="*"||c==="?"})):e("Invalid state to consume buffer"),l="")}function d(){l+=c}for(;a<t.length;){if(c=t[a++],c==="\\"&&n!==2){s=n,n=4;continue}switch(n){case 0:c==="/"?(l&&h(),o()):c===":"?(h(),n=1):d();break;case 4:d(),n=s;break;case 1:c==="("?n=2:aL.test(c)?d():(h(),n=0,c!=="*"&&c!=="?"&&c!=="+"&&a--);break;case 2:c===")"?u[u.length-1]=="\\"?u=u.slice(0,-1)+c:n=3:u+=c;break;case 3:h(),n=0,c!=="*"&&c!=="?"&&c!=="+"&&a--,u="";break;default:e("Unknown state");break}}return n===2&&e(`Unfinished custom RegExp for param "${l}"`),h(),o(),r}function lL(t,e,n){const s=sL(cL(t.path),n),r=Le(s,{record:t,parent:e,children:[],alias:[]});return e&&!r.record.aliasOf==!e.record.aliasOf&&e.children.push(r),r}function uL(t,e){const n=[],s=new Map;e=rI({strict:!1,end:!0,sensitive:!1},e);function r(u){return s.get(u)}function i(u,h,d){const f=!d,p=dL(u);p.aliasOf=d&&d.record;const _=rI(e,u),y=[p];if("alias"in u){const E=typeof u.alias=="string"?[u.alias]:u.alias;for(const S of E)y.push(Le({},p,{components:d?d.record.components:p.components,path:S,aliasOf:d?d.record:p}))}let T,I;for(const E of y){const{path:S}=E;if(h&&S[0]!=="/"){const H=h.record.path,Y=H[H.length-1]==="/"?"":"/";E.path=h.record.path+(S&&Y+S)}if(T=lL(E,h,_),d?d.alias.push(T):(I=I||T,I!==T&&I.alias.push(T),f&&u.name&&!sI(T)&&o(u.name)),"children"in p){const H=p.children;for(let Y=0;Y<H.length;Y++)i(H[Y],T,d&&d.children[Y])}d=d||T,c(T)}return I?()=>{o(I)}:sl}function o(u){if(J0(u)){const h=s.get(u);h&&(s.delete(u),n.splice(n.indexOf(h),1),h.children.forEach(o),h.alias.forEach(o))}else{const h=n.indexOf(u);h>-1&&(n.splice(h,1),u.record.name&&s.delete(u.record.name),u.children.forEach(o),u.alias.forEach(o))}}function a(){return n}function c(u){let h=0;for(;h<n.length&&iL(u,n[h])>=0&&(u.record.path!==n[h].record.path||!Z0(u,n[h]));)h++;n.splice(h,0,u),u.record.name&&!sI(u)&&s.set(u.record.name,u)}function l(u,h){let d,f={},p,_;if("name"in u&&u.name){if(d=s.get(u.name),!d)throw Oa(1,{location:u});_=d.record.name,f=Le(hL(h.params,d.keys.filter(I=>!I.optional).map(I=>I.name)),u.params),p=d.stringify(f)}else if("path"in u)p=u.path,d=n.find(I=>I.re.test(p)),d&&(f=d.parse(p),_=d.record.name);else{if(d=h.name?s.get(h.name):n.find(I=>I.re.test(h.path)),!d)throw Oa(1,{location:u,currentLocation:h});_=d.record.name,f=Le({},h.params,u.params),p=d.stringify(f)}const y=[];let T=d;for(;T;)y.unshift(T.record),T=T.parent;return{name:_,path:p,params:f,matched:y,meta:pL(y)}}return t.forEach(u=>i(u)),{addRoute:i,resolve:l,removeRoute:o,getRoutes:a,getRecordMatcher:r}}function hL(t,e){const n={};for(const s of e)s in t&&(n[s]=t[s]);return n}function dL(t){return{path:t.path,redirect:t.redirect,name:t.name,meta:t.meta||{},aliasOf:void 0,beforeEnter:t.beforeEnter,props:fL(t),children:t.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in t?t.components||{}:{default:t.component}}}function fL(t){const e={},n=t.props||!1;if("component"in t)e.default=n;else for(const s in t.components)e[s]=typeof n=="boolean"?n:n[s];return e}function sI(t){for(;t;){if(t.record.aliasOf)return!0;t=t.parent}return!1}function pL(t){return t.reduce((e,n)=>Le(e,n.meta),{})}function rI(t,e){const n={};for(const s in t)n[s]=s in e?e[s]:t[s];return n}function Z0(t,e){return e.children.some(n=>n===t||Z0(t,n))}const eC=/#/g,gL=/&/g,mL=/\//g,_L=/=/g,yL=/\?/g,tC=/\+/g,vL=/%5B/g,wL=/%5D/g,nC=/%5E/g,bL=/%60/g,sC=/%7B/g,IL=/%7C/g,rC=/%7D/g,EL=/%20/g;function iy(t){return encodeURI(""+t).replace(IL,"|").replace(vL,"[").replace(wL,"]")}function TL(t){return iy(t).replace(sC,"{").replace(rC,"}").replace(nC,"^")}function ym(t){return iy(t).replace(tC,"%2B").replace(EL,"+").replace(eC,"%23").replace(gL,"%26").replace(bL,"`").replace(sC,"{").replace(rC,"}").replace(nC,"^")}function SL(t){return ym(t).replace(_L,"%3D")}function CL(t){return iy(t).replace(eC,"%23").replace(yL,"%3F")}function AL(t){return t==null?"":CL(t).replace(mL,"%2F")}function od(t){try{return decodeURIComponent(""+t)}catch{}return""+t}function kL(t){const e={};if(t===""||t==="?")return e;const s=(t[0]==="?"?t.slice(1):t).split("&");for(let r=0;r<s.length;++r){const i=s[r].replace(tC," "),o=i.indexOf("="),a=od(o<0?i:i.slice(0,o)),c=o<0?null:od(i.slice(o+1));if(a in e){let l=e[a];Array.isArray(l)||(l=e[a]=[l]),l.push(c)}else e[a]=c}return e}function iI(t){let e="";for(let n in t){const s=t[n];if(n=SL(n),s==null){s!==void 0&&(e+=(e.length?"&":"")+n);continue}(Array.isArray(s)?s.map(i=>i&&ym(i)):[s&&ym(s)]).forEach(i=>{i!==void 0&&(e+=(e.length?"&":"")+n,i!=null&&(e+="="+i))})}return e}function RL(t){const e={};for(const n in t){const s=t[n];s!==void 0&&(e[n]=Array.isArray(s)?s.map(r=>r==null?null:""+r):s==null?s:""+s)}return e}function kc(){let t=[];function e(s){return t.push(s),()=>{const r=t.indexOf(s);r>-1&&t.splice(r,1)}}function n(){t=[]}return{add:e,list:()=>t,reset:n}}function Fr(t,e,n,s,r){const i=s&&(s.enterCallbacks[r]=s.enterCallbacks[r]||[]);return()=>new Promise((o,a)=>{const c=h=>{h===!1?a(Oa(4,{from:n,to:e})):h instanceof Error?a(h):eL(h)?a(Oa(2,{from:e,to:h})):(i&&s.enterCallbacks[r]===i&&typeof h=="function"&&i.push(h),o())},l=t.call(s&&s.instances[r],e,n,c);let u=Promise.resolve(l);t.length<3&&(u=u.then(c)),u.catch(h=>a(h))})}function ng(t,e,n,s){const r=[];for(const i of t)for(const o in i.components){let a=i.components[o];if(!(e!=="beforeRouteEnter"&&!i.instances[o]))if(NL(a)){const l=(a.__vccOpts||a)[e];l&&r.push(Fr(l,n,s,i,o))}else{let c=a();r.push(()=>c.then(l=>{if(!l)return Promise.reject(new Error(`Couldn't resolve component "${o}" at "${i.path}"`));const u=M1(l)?l.default:l;i.components[o]=u;const d=(u.__vccOpts||u)[e];return d&&Fr(d,n,s,i,o)()}))}}return r}function NL(t){return typeof t=="object"||"displayName"in t||"props"in t||"__vccOpts"in t}function oI(t){const e=Ds(Tf),n=Ds(z0),s=Bn(()=>e.resolve(ma(t.to))),r=Bn(()=>{const{matched:c}=s.value,{length:l}=c,u=c[l-1],h=n.matched;if(!u||!h.length)return-1;const d=h.findIndex(Da.bind(null,u));if(d>-1)return d;const f=aI(c[l-2]);return l>1&&aI(u)===f&&h[h.length-1].path!==f?h.findIndex(Da.bind(null,c[l-2])):d}),i=Bn(()=>r.value>-1&&OL(n.params,s.value.params)),o=Bn(()=>r.value>-1&&r.value===n.matched.length-1&&Q0(n.params,s.value.params));function a(c={}){return DL(c)?e[ma(t.replace)?"replace":"push"](ma(t.to)).catch(sl):Promise.resolve()}return{route:s,href:Bn(()=>s.value.href),isActive:i,isExactActive:o,navigate:a}}const PL=C0({name:"RouterLink",props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"}},useLink:oI,setup(t,{slots:e}){const n=sc(oI(t)),{options:s}=Ds(Tf),r=Bn(()=>({[cI(t.activeClass,s.linkActiveClass,"router-link-active")]:n.isActive,[cI(t.exactActiveClass,s.linkExactActiveClass,"router-link-exact-active")]:n.isExactActive}));return()=>{const i=e.default&&e.default(n);return t.custom?i:sy("a",{"aria-current":n.isExactActive?t.ariaCurrentValue:null,href:n.href,onClick:n.navigate,class:r.value},i)}}}),xL=PL;function DL(t){if(!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)&&!t.defaultPrevented&&!(t.button!==void 0&&t.button!==0)){if(t.currentTarget&&t.currentTarget.getAttribute){const e=t.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(e))return}return t.preventDefault&&t.preventDefault(),!0}}function OL(t,e){for(const n in e){const s=e[n],r=t[n];if(typeof s=="string"){if(s!==r)return!1}else if(!Array.isArray(r)||r.length!==s.length||s.some((i,o)=>i!==r[o]))return!1}return!0}function aI(t){return t?t.aliasOf?t.aliasOf.path:t.path:""}const cI=(t,e,n)=>t!=null?t:e!=null?e:n,ML=C0({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},setup(t,{attrs:e,slots:n}){const s=Ds(mm),r=Bn(()=>t.route||s.value),i=Ds(Yb,0),o=Bn(()=>r.value.matched[i]);Oh(Yb,i+1),Oh(O1,o),Oh(mm,r);const a=pf();return Zi(()=>[a.value,o.value,t.name],([c,l,u],[h,d,f])=>{l&&(l.instances[u]=c,d&&d!==l&&c&&c===h&&(l.leaveGuards.size||(l.leaveGuards=d.leaveGuards),l.updateGuards.size||(l.updateGuards=d.updateGuards))),c&&l&&(!d||!Da(l,d)||!h)&&(l.enterCallbacks[u]||[]).forEach(p=>p(c))},{flush:"post"}),()=>{const c=r.value,l=o.value,u=l&&l.components[t.name],h=t.name;if(!u)return lI(n.default,{Component:u,route:c});const d=l.props[t.name],f=d?d===!0?c.params:typeof d=="function"?d(c):d:null,_=sy(u,Le({},f,e,{onVnodeUnmounted:y=>{y.component.isUnmounted&&(l.instances[h]=null)},ref:a}));return lI(n.default,{Component:_,route:c})||_}}});function lI(t,e){if(!t)return null;const n=t(e);return n.length===1?n[0]:n}const LL=ML;function FL(t){const e=uL(t.routes,t),n=t.parseQuery||kL,s=t.stringifyQuery||iI,r=t.history,i=kc(),o=kc(),a=kc(),c=BO(Nr);let l=Nr;aa&&t.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const u=eg.bind(null,C=>""+C),h=eg.bind(null,AL),d=eg.bind(null,od);function f(C,Z){let B,ee;return J0(C)?(B=e.getRecordMatcher(C),ee=Z):ee=C,e.addRoute(ee,B)}function p(C){const Z=e.getRecordMatcher(C);Z&&e.removeRoute(Z)}function _(){return e.getRoutes().map(C=>C.record)}function y(C){return!!e.getRecordMatcher(C)}function T(C,Z){if(Z=Le({},Z||c.value),typeof C=="string"){const fe=tg(n,C,Z.path),g=e.resolve({path:fe.path},Z),m=r.createHref(fe.fullPath);return Le(fe,g,{params:d(g.params),hash:od(fe.hash),redirectedFrom:void 0,href:m})}let B;if("path"in C)B=Le({},C,{path:tg(n,C.path,Z.path).path});else{const fe=Le({},C.params);for(const g in fe)fe[g]==null&&delete fe[g];B=Le({},C,{params:h(C.params)}),Z.params=h(Z.params)}const ee=e.resolve(B,Z),De=C.hash||"";ee.params=u(d(ee.params));const Ve=U1(s,Le({},C,{hash:TL(De),path:ee.path})),we=r.createHref(Ve);return Le({fullPath:Ve,hash:De,query:s===iI?RL(C.query):C.query||{}},ee,{redirectedFrom:void 0,href:we})}function I(C){return typeof C=="string"?tg(n,C,c.value.path):Le({},C)}function E(C,Z){if(l!==C)return Oa(8,{from:Z,to:C})}function S(C){return M(C)}function H(C){return S(Le(I(C),{replace:!0}))}function Y(C){const Z=C.matched[C.matched.length-1];if(Z&&Z.redirect){const{redirect:B}=Z;let ee=typeof B=="function"?B(C):B;return typeof ee=="string"&&(ee=ee.includes("?")||ee.includes("#")?ee=I(ee):{path:ee},ee.params={}),Le({query:C.query,hash:C.hash,params:C.params},ee)}}function M(C,Z){const B=l=T(C),ee=c.value,De=C.state,Ve=C.force,we=C.replace===!0,fe=Y(B);if(fe)return M(Le(I(fe),{state:De,force:Ve,replace:we}),Z||B);const g=B;g.redirectedFrom=Z;let m;return!Ve&&$1(s,ee,B)&&(m=Oa(16,{to:g,from:ee}),zo(ee,ee,!0,!1)),(m?Promise.resolve(m):j(g,ee)).catch(b=>Pr(b)?Pr(b,2)?b:Cn(b):pe(b,g,ee)).then(b=>{if(b){if(Pr(b,2))return M(Le(I(b.to),{state:De,force:Ve,replace:we}),Z||g)}else b=X(g,ee,!0,we,De);return F(g,ee,b),b})}function G(C,Z){const B=E(C,Z);return B?Promise.reject(B):Promise.resolve()}function j(C,Z){let B;const[ee,De,Ve]=UL(C,Z);B=ng(ee.reverse(),"beforeRouteLeave",C,Z);for(const fe of ee)fe.leaveGuards.forEach(g=>{B.push(Fr(g,C,Z))});const we=G.bind(null,C,Z);return B.push(we),Jo(B).then(()=>{B=[];for(const fe of i.list())B.push(Fr(fe,C,Z));return B.push(we),Jo(B)}).then(()=>{B=ng(De,"beforeRouteUpdate",C,Z);for(const fe of De)fe.updateGuards.forEach(g=>{B.push(Fr(g,C,Z))});return B.push(we),Jo(B)}).then(()=>{B=[];for(const fe of C.matched)if(fe.beforeEnter&&!Z.matched.includes(fe))if(Array.isArray(fe.beforeEnter))for(const g of fe.beforeEnter)B.push(Fr(g,C,Z));else B.push(Fr(fe.beforeEnter,C,Z));return B.push(we),Jo(B)}).then(()=>(C.matched.forEach(fe=>fe.enterCallbacks={}),B=ng(Ve,"beforeRouteEnter",C,Z),B.push(we),Jo(B))).then(()=>{B=[];for(const fe of o.list())B.push(Fr(fe,C,Z));return B.push(we),Jo(B)}).catch(fe=>Pr(fe,8)?fe:Promise.reject(fe))}function F(C,Z,B){for(const ee of a.list())ee(C,Z,B)}function X(C,Z,B,ee,De){const Ve=E(C,Z);if(Ve)return Ve;const we=Z===Nr,fe=aa?history.state:{};B&&(ee||we?r.replace(C.fullPath,Le({scroll:we&&fe&&fe.scroll},De)):r.push(C.fullPath,De)),c.value=C,zo(C,Z,B,we),Cn()}let K;function ve(){K=r.listen((C,Z,B)=>{const ee=T(C),De=Y(ee);if(De){M(Le(De,{replace:!0}),ee).catch(sl);return}l=ee;const Ve=c.value;aa&&G1(Zb(Ve.fullPath,B.delta),Sf()),j(ee,Ve).catch(we=>Pr(we,12)?we:Pr(we,2)?(M(we.to,ee).then(fe=>{Pr(fe,20)&&!B.delta&&B.type===Nl.pop&&r.go(-1,!1)}).catch(sl),Promise.reject()):(B.delta&&r.go(-B.delta,!1),pe(we,ee,Ve))).then(we=>{we=we||X(ee,Ve,!1),we&&(B.delta?r.go(-B.delta,!1):B.type===Nl.pop&&Pr(we,20)&&r.go(-1,!1)),F(ee,Ve,we)}).catch(sl)})}let vt=kc(),Zn=kc(),Ne;function pe(C,Z,B){Cn(C);const ee=Zn.list();return ee.length?ee.forEach(De=>De(C,Z,B)):console.error(C),Promise.reject(C)}function xe(){return Ne&&c.value!==Nr?Promise.resolve():new Promise((C,Z)=>{vt.add([C,Z])})}function Cn(C){return Ne||(Ne=!C,ve(),vt.list().forEach(([Z,B])=>C?B(C):Z()),vt.reset()),C}function zo(C,Z,B,ee){const{scrollBehavior:De}=t;if(!aa||!De)return Promise.resolve();const Ve=!B&&z1(Zb(C.fullPath,0))||(ee||!B)&&history.state&&history.state.scroll||null;return ed().then(()=>De(C,Z,Ve)).then(we=>we&&W1(we)).catch(we=>pe(we,C,Z))}const Js=C=>r.go(C);let vs;const Un=new Set;return{currentRoute:c,addRoute:f,removeRoute:p,hasRoute:y,getRoutes:_,resolve:T,options:t,push:S,replace:H,go:Js,back:()=>Js(-1),forward:()=>Js(1),beforeEach:i.add,beforeResolve:o.add,afterEach:a.add,onError:Zn.add,isReady:xe,install(C){const Z=this;C.component("RouterLink",xL),C.component("RouterView",LL),C.config.globalProperties.$router=Z,Object.defineProperty(C.config.globalProperties,"$route",{enumerable:!0,get:()=>ma(c)}),aa&&!vs&&c.value===Nr&&(vs=!0,S(r.location).catch(De=>{}));const B={};for(const De in Nr)B[De]=Bn(()=>c.value[De]);C.provide(Tf,Z),C.provide(z0,sc(B)),C.provide(mm,c);const ee=C.unmount;Un.add(C),C.unmount=function(){Un.delete(C),Un.size<1&&(l=Nr,K&&K(),c.value=Nr,vs=!1,Ne=!1),ee()}}}}function Jo(t){return t.reduce((e,n)=>e.then(()=>n()),Promise.resolve())}function UL(t,e){const n=[],s=[],r=[],i=Math.max(e.matched.length,t.matched.length);for(let o=0;o<i;o++){const a=e.matched[o];a&&(t.matched.find(l=>Da(l,a))?s.push(a):n.push(a));const c=t.matched[o];c&&(e.matched.find(l=>Da(l,c))||r.push(c))}return[n,s,r]}function YZ(){return Ds(Tf)}const $L=[{name:"Home",component:()=>bs(()=>import("./Home.e49c4913.js"),["assets/Home.e49c4913.js","assets/Home.bb3752b9.css","assets/notes.9ac0241c.js"]),path:"/"},{name:"Add",component:()=>bs(()=>import("./Add.da5bbee2.js"),["assets/Add.da5bbee2.js","assets/Add.d9bdb00f.css","assets/level.9f216155.js","assets/types.0cccda48.js","assets/loader.9b15261f.js","assets/loader.bc61d3aa.css"]),path:"/add"},{name:"Admin",component:()=>bs(()=>import("./admin.14054b6c.js"),["assets/admin.14054b6c.js","assets/admin.0b4ed59a.css","assets/loader.9b15261f.js","assets/loader.bc61d3aa.css"]),path:"/admin"},{name:"Univercities",component:()=>bs(()=>import("./Uni.4b77388d.js"),["assets/Uni.4b77388d.js","assets/Uni.32be4119.css","assets/loader.9b15261f.js","assets/loader.bc61d3aa.css","assets/types.0cccda48.js"]),path:"/Univercities"},{name:"details",component:()=>bs(()=>import("./details.5904903f.js"),["assets/details.5904903f.js","assets/details.72729079.css","assets/loader.9b15261f.js","assets/loader.bc61d3aa.css"]),path:"/University/:name"},{name:"Dashboard",component:()=>bs(()=>import("./Dashboard.b71bb176.js"),["assets/Dashboard.b71bb176.js","assets/Dashboard.567ef4e0.css","assets/loader.9b15261f.js","assets/loader.bc61d3aa.css"]),path:"/admin/dashboard"},{name:"Edit",component:()=>bs(()=>import("./Edit.63f1cbcd.js"),["assets/Edit.63f1cbcd.js","assets/Edit.cb16d290.css","assets/loader.9b15261f.js","assets/loader.bc61d3aa.css","assets/level.9f216155.js","assets/types.0cccda48.js"]),path:"/admin/dashboard/edit/:name"},{name:"Testing",component:()=>bs(()=>import("./teting.807d59fd.js"),[]),path:"/Testing"},{name:"Note",component:()=>bs(()=>import("./WebViewer.6cfe3ece.js"),["assets/WebViewer.6cfe3ece.js","assets/WebViewer.51c57d3b.css"]),path:"/note/:fileName"},{name:"Notes",component:()=>bs(()=>import("./notes.c9a5bd34.js"),["assets/notes.c9a5bd34.js","assets/notes.1ad16511.css","assets/notes.9ac0241c.js"]),path:"/notes"}],VL=FL({history:Z1(),routes:$L});const bu=(t,e)=>{const n=t.__vccOpts||t;for(const[s,r]of e)n[s]=r;return n},BL={},iC=t=>(Q_("data-v-631d7d86"),t=t(),Y_(),t),jL={class:"container"},qL={class:"flex center between",id:"main-nav"},KL=iC(()=>Je("div",{class:"flex center"},[Je("div",{class:"logo"},[Je("h1",null,"EDUCATIA")])],-1)),HL={class:"li"},WL=zs("Home"),GL=zs("Universities"),zL=zs("Notes"),QL=iC(()=>Je("div",{class:"nav-button"},[Je("a",{href:"#contact-form"},[Je("button",{class:"btn btn-primary"},"Conatact")])],-1));function YL(t,e,n,s,r,i){const o=Ur("router-link");return Rs(),Na("header",null,[Je("div",jL,[Je("nav",qL,[KL,Je("div",HL,[qe(o,{to:"/"},{default:cs(()=>[WL]),_:1}),qe(o,{to:"/Univercities"},{default:cs(()=>[GL]),_:1}),qe(o,{to:{name:"Notes"}},{default:cs(()=>[zL]),_:1})]),QL])])])}const JL=bu(BL,[["render",YL],["__scopeId","data-v-631d7d86"]]),XL="/Educatia/icons8-hamburger-64.png",ZL="/Educatia/icons8-multiply-40.png";const eF={name:"mobileNav",data(){return{isNav:!1}}},tF=t=>(Q_("data-v-8580a92d"),t=t(),Y_(),t),nF={class:"wrapper"},sF={class:"icon"},rF={key:0,class:"main-nav",ref:"nav"},iF=tF(()=>Je("img",{src:ZL,alt:""},null,-1)),oF=[iF],aF={class:"links"},cF=zs("Home"),lF=zs("Universities"),uF=zs("Notes");function hF(t,e,n,s,r,i){const o=Ur("router-link");return Rs(),Na("div",nF,[Je("div",sF,[Je("img",{ref:"ham",onClick:e[0]||(e[0]=a=>r.isNav=!0),src:XL,alt:""},null,512)]),qe(ry,null,{default:cs(()=>[r.isNav==!0?(Rs(),Na("div",rF,[Je("div",{class:"cross",onClick:e[1]||(e[1]=a=>r.isNav=!1)},oF),Je("div",aF,[qe(o,{to:"/",onClick:e[2]||(e[2]=a=>r.isNav=!1)},{default:cs(()=>[cF]),_:1}),qe(o,{to:"/Univercities",onClick:e[3]||(e[3]=a=>r.isNav=!1)},{default:cs(()=>[lF]),_:1}),qe(o,{to:"/Notes",onClick:e[4]||(e[4]=a=>r.isNav=!1)},{default:cs(()=>[uF]),_:1})])],512)):nl("",!0)]),_:1})])}const dF=bu(eF,[["render",hF],["__scopeId","data-v-8580a92d"]]);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oC={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const O=function(t,e){if(!t)throw ic(e)},ic=function(t){return new Error("Firebase Database ("+oC.SDK_VERSION+") INTERNAL ASSERT FAILED: "+t)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aC=function(t){const e=[];let n=0;for(let s=0;s<t.length;s++){let r=t.charCodeAt(s);r<128?e[n++]=r:r<2048?(e[n++]=r>>6|192,e[n++]=r&63|128):(r&64512)===55296&&s+1<t.length&&(t.charCodeAt(s+1)&64512)===56320?(r=65536+((r&1023)<<10)+(t.charCodeAt(++s)&1023),e[n++]=r>>18|240,e[n++]=r>>12&63|128,e[n++]=r>>6&63|128,e[n++]=r&63|128):(e[n++]=r>>12|224,e[n++]=r>>6&63|128,e[n++]=r&63|128)}return e},fF=function(t){const e=[];let n=0,s=0;for(;n<t.length;){const r=t[n++];if(r<128)e[s++]=String.fromCharCode(r);else if(r>191&&r<224){const i=t[n++];e[s++]=String.fromCharCode((r&31)<<6|i&63)}else if(r>239&&r<365){const i=t[n++],o=t[n++],a=t[n++],c=((r&7)<<18|(i&63)<<12|(o&63)<<6|a&63)-65536;e[s++]=String.fromCharCode(55296+(c>>10)),e[s++]=String.fromCharCode(56320+(c&1023))}else{const i=t[n++],o=t[n++];e[s++]=String.fromCharCode((r&15)<<12|(i&63)<<6|o&63)}}return e.join("")},Cf={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,s=[];for(let r=0;r<t.length;r+=3){const i=t[r],o=r+1<t.length,a=o?t[r+1]:0,c=r+2<t.length,l=c?t[r+2]:0,u=i>>2,h=(i&3)<<4|a>>4;let d=(a&15)<<2|l>>6,f=l&63;c||(f=64,o||(d=64)),s.push(n[u],n[h],n[d],n[f])}return s.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(aC(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):fF(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,s=[];for(let r=0;r<t.length;){const i=n[t.charAt(r++)],a=r<t.length?n[t.charAt(r)]:0;++r;const l=r<t.length?n[t.charAt(r)]:64;++r;const h=r<t.length?n[t.charAt(r)]:64;if(++r,i==null||a==null||l==null||h==null)throw Error();const d=i<<2|a>>4;if(s.push(d),l!==64){const f=a<<4&240|l>>2;if(s.push(f),h!==64){const p=l<<6&192|h;s.push(p)}}}return s},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}},cC=function(t){const e=aC(t);return Cf.encodeByteArray(e,!0)},ad=function(t){return cC(t).replace(/\./g,"")},vm=function(t){try{return Cf.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pF(t){return Pl(void 0,t)}function Pl(t,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:const n=e;return new Date(n.getTime());case Object:t===void 0&&(t={});break;case Array:t=[];break;default:return e}for(const n in e)!e.hasOwnProperty(n)||!gF(n)||(t[n]=Pl(t[n],e[n]));return t}function gF(t){return t!=="__proto__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pt{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,s)=>{n?this.reject(n):this.resolve(s),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,s))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oy(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},s=e||"demo-project",r=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${s}`,aud:s,iat:r,exp:r+3600,auth_time:r,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},t),a="";return[ad(JSON.stringify(n)),ad(JSON.stringify(o)),a].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ge(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function Af(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Ge())}function ay(){try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function mF(){return typeof self=="object"&&self.self===self}function Iu(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function Eu(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function _F(){return Ge().indexOf("Electron/")>=0}function cy(){const t=Ge();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function yF(){return Ge().indexOf("MSAppHost/")>=0}function lC(){return oC.NODE_ADMIN===!0}function vF(){return!ay()&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function En(){return typeof indexedDB=="object"}function Tu(){return new Promise((t,e)=>{try{let n=!0;const s="validate-browser-context-for-indexeddb-analytics-module",r=self.indexedDB.open(s);r.onsuccess=()=>{r.result.close(),n||self.indexedDB.deleteDatabase(s),t(!0)},r.onupgradeneeded=()=>{n=!1},r.onerror=()=>{var i;e(((i=r.error)===null||i===void 0?void 0:i.message)||"")}}catch(n){e(n)}})}function kf(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}function wF(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bF="FirebaseError";class et extends Error{constructor(e,n,s){super(n),this.code=e,this.customData=s,this.name=bF,Object.setPrototypeOf(this,et.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,gn.prototype.create)}}class gn{constructor(e,n,s){this.service=e,this.serviceName=n,this.errors=s}create(e,...n){const s=n[0]||{},r=`${this.service}/${e}`,i=this.errors[e],o=i?IF(i,s):"Error",a=`${this.serviceName}: ${o} (${r}).`;return new et(r,a,s)}}function IF(t,e){return t.replace(EF,(n,s)=>{const r=e[s];return r!=null?String(r):`<${s}?>`})}const EF=/\{\$([^}]+)}/g;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xl(t){return JSON.parse(t)}function gt(t){return JSON.stringify(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ly=function(t){let e={},n={},s={},r="";try{const i=t.split(".");e=xl(vm(i[0])||""),n=xl(vm(i[1])||""),r=i[2],s=n.d||{},delete n.d}catch{}return{header:e,claims:n,data:s,signature:r}},TF=function(t){const e=ly(t).claims;return typeof e=="object"&&e.hasOwnProperty("iat")?e.iat:null},SF=function(t){const e=ly(t),n=e.claims;return!!n&&typeof n=="object"&&n.hasOwnProperty("iat")},CF=function(t){const e=ly(t).claims;return typeof e=="object"&&e.admin===!0};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mn(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function oo(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]}function cd(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function ld(t,e,n){const s={};for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&(s[r]=e.call(n,t[r],r,t));return s}function wm(t,e){if(t===e)return!0;const n=Object.keys(t),s=Object.keys(e);for(const r of n){if(!s.includes(r))return!1;const i=t[r],o=e[r];if(uI(i)&&uI(o)){if(!wm(i,o))return!1}else if(i!==o)return!1}for(const r of s)if(!n.includes(r))return!1;return!0}function uI(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lo(t){const e=[];for(const[n,s]of Object.entries(t))Array.isArray(s)?s.forEach(r=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(r))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(s));return e.length?"&"+e.join("&"):""}function la(t){const e={};return t.replace(/^\?/,"").split("&").forEach(s=>{if(s){const[r,i]=s.split("=");e[decodeURIComponent(r)]=decodeURIComponent(i)}}),e}function Gc(t){const e=t.indexOf("?");if(!e)return"";const n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AF{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=512/8,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(e,n){n||(n=0);const s=this.W_;if(typeof e=="string")for(let h=0;h<16;h++)s[h]=e.charCodeAt(n)<<24|e.charCodeAt(n+1)<<16|e.charCodeAt(n+2)<<8|e.charCodeAt(n+3),n+=4;else for(let h=0;h<16;h++)s[h]=e[n]<<24|e[n+1]<<16|e[n+2]<<8|e[n+3],n+=4;for(let h=16;h<80;h++){const d=s[h-3]^s[h-8]^s[h-14]^s[h-16];s[h]=(d<<1|d>>>31)&4294967295}let r=this.chain_[0],i=this.chain_[1],o=this.chain_[2],a=this.chain_[3],c=this.chain_[4],l,u;for(let h=0;h<80;h++){h<40?h<20?(l=a^i&(o^a),u=1518500249):(l=i^o^a,u=1859775393):h<60?(l=i&o|a&(i|o),u=2400959708):(l=i^o^a,u=3395469782);const d=(r<<5|r>>>27)+l+c+u+s[h]&4294967295;c=a,a=o,o=(i<<30|i>>>2)&4294967295,i=r,r=d}this.chain_[0]=this.chain_[0]+r&4294967295,this.chain_[1]=this.chain_[1]+i&4294967295,this.chain_[2]=this.chain_[2]+o&4294967295,this.chain_[3]=this.chain_[3]+a&4294967295,this.chain_[4]=this.chain_[4]+c&4294967295}update(e,n){if(e==null)return;n===void 0&&(n=e.length);const s=n-this.blockSize;let r=0;const i=this.buf_;let o=this.inbuf_;for(;r<n;){if(o===0)for(;r<=s;)this.compress_(e,r),r+=this.blockSize;if(typeof e=="string"){for(;r<n;)if(i[o]=e.charCodeAt(r),++o,++r,o===this.blockSize){this.compress_(i),o=0;break}}else for(;r<n;)if(i[o]=e[r],++o,++r,o===this.blockSize){this.compress_(i),o=0;break}}this.inbuf_=o,this.total_+=n}digest(){const e=[];let n=this.total_*8;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let r=this.blockSize-1;r>=56;r--)this.buf_[r]=n&255,n/=256;this.compress_(this.buf_);let s=0;for(let r=0;r<5;r++)for(let i=24;i>=0;i-=8)e[s]=this.chain_[r]>>i&255,++s;return e}}function uC(t,e){const n=new kF(t,e);return n.subscribe.bind(n)}class kF{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(s=>{this.error(s)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,s){let r;if(e===void 0&&n===void 0&&s===void 0)throw new Error("Missing Observer.");RF(e,["next","error","complete"])?r=e:r={next:e,error:n,complete:s},r.next===void 0&&(r.next=sg),r.error===void 0&&(r.error=sg),r.complete===void 0&&(r.complete=sg);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch{}}),this.observers.push(r),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(s){typeof console<"u"&&console.error&&console.error(s)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function RF(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function sg(){}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ie=function(t,e,n,s){let r;if(s<e?r="at least "+e:s>n&&(r=n===0?"none":"no more than "+n),r){const i=t+" failed: Was called with "+s+(s===1?" argument.":" arguments.")+" Expects "+r+".";throw new Error(i)}};function In(t,e){return`${t} failed: ${e} argument `}function It(t,e,n,s){if(!(s&&!n)&&typeof n!="function")throw new Error(In(t,e)+"must be a valid function.")}function hI(t,e,n,s){if(!(s&&!n)&&(typeof n!="object"||n===null))throw new Error(In(t,e)+"must be a valid context object.")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NF=function(t){const e=[];let n=0;for(let s=0;s<t.length;s++){let r=t.charCodeAt(s);if(r>=55296&&r<=56319){const i=r-55296;s++,O(s<t.length,"Surrogate pair missing trail surrogate.");const o=t.charCodeAt(s)-56320;r=65536+(i<<10)+o}r<128?e[n++]=r:r<2048?(e[n++]=r>>6|192,e[n++]=r&63|128):r<65536?(e[n++]=r>>12|224,e[n++]=r>>6&63|128,e[n++]=r&63|128):(e[n++]=r>>18|240,e[n++]=r>>12&63|128,e[n++]=r>>6&63|128,e[n++]=r&63|128)}return e},Rf=function(t){let e=0;for(let n=0;n<t.length;n++){const s=t.charCodeAt(n);s<128?e++:s<2048?e+=2:s>=55296&&s<=56319?(e+=4,n++):e+=3}return e};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PF=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,t=>{const e=Math.random()*16|0;return(t==="x"?e:e&3|8).toString(16)})};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xF=1e3,DF=2,OF=4*60*60*1e3,MF=.5;function ud(t,e=xF,n=DF){const s=e*Math.pow(n,t),r=Math.round(MF*s*(Math.random()-.5)*2);return Math.min(OF,s+r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function N(t){return t&&t._delegate?t._delegate:t}class Ae{constructor(e,n,s){this.name=e,this.instanceFactory=n,this.type=s,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pi="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hC{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const s=new pt;if(this.instancesDeferred.set(n,s),this.isInitialized(n)||this.shouldAutoInitialize())try{const r=this.getOrInitializeService({instanceIdentifier:n});r&&s.resolve(r)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;const s=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),r=(n=e==null?void 0:e.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(s)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:s})}catch(i){if(r)return null;throw i}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(FF(e))try{this.getOrInitializeService({instanceIdentifier:Pi})}catch{}for(const[n,s]of this.instancesDeferred.entries()){const r=this.normalizeInstanceIdentifier(n);try{const i=this.getOrInitializeService({instanceIdentifier:r});s.resolve(i)}catch{}}}}clearInstance(e=Pi){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Pi){return this.instances.has(e)}getOptions(e=Pi){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,s=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(s))throw Error(`${this.name}(${s}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const r=this.getOrInitializeService({instanceIdentifier:s,options:n});for(const[i,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(i);s===a&&o.resolve(r)}return r}onInit(e,n){var s;const r=this.normalizeInstanceIdentifier(n),i=(s=this.onInitCallbacks.get(r))!==null&&s!==void 0?s:new Set;i.add(e),this.onInitCallbacks.set(r,i);const o=this.instances.get(r);return o&&e(o,r),()=>{i.delete(e)}}invokeOnInitCallbacks(e,n){const s=this.onInitCallbacks.get(n);if(!!s)for(const r of s)try{r(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let s=this.instances.get(e);if(!s&&this.component&&(s=this.component.instanceFactory(this.container,{instanceIdentifier:LF(e),options:n}),this.instances.set(e,s),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(s,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,s)}catch{}return s||null}normalizeInstanceIdentifier(e=Pi){return this.component?this.component.multipleInstances?e:Pi:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function LF(t){return t===Pi?void 0:t}function FF(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dC{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new hC(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uy=[];var ge;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(ge||(ge={}));const fC={debug:ge.DEBUG,verbose:ge.VERBOSE,info:ge.INFO,warn:ge.WARN,error:ge.ERROR,silent:ge.SILENT},UF=ge.INFO,$F={[ge.DEBUG]:"log",[ge.VERBOSE]:"log",[ge.INFO]:"info",[ge.WARN]:"warn",[ge.ERROR]:"error"},VF=(t,e,...n)=>{if(e<t.logLevel)return;const s=new Date().toISOString(),r=$F[e];if(r)console[r](`[${s}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Qs{constructor(e){this.name=e,this._logLevel=UF,this._logHandler=VF,this._userLogHandler=null,uy.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in ge))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?fC[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,ge.DEBUG,...e),this._logHandler(this,ge.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,ge.VERBOSE,...e),this._logHandler(this,ge.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,ge.INFO,...e),this._logHandler(this,ge.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,ge.WARN,...e),this._logHandler(this,ge.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,ge.ERROR,...e),this._logHandler(this,ge.ERROR,...e)}}function BF(t){uy.forEach(e=>{e.setLogLevel(t)})}function jF(t,e){for(const n of uy){let s=null;e&&e.level&&(s=fC[e.level]),t===null?n.userLogHandler=null:n.userLogHandler=(r,i,...o)=>{const a=o.map(c=>{if(c==null)return null;if(typeof c=="string")return c;if(typeof c=="number"||typeof c=="boolean")return c.toString();if(c instanceof Error)return c.message;try{return JSON.stringify(c)}catch{return null}}).filter(c=>c).join(" ");i>=(s!=null?s:r.logLevel)&&t({level:ge[i].toLowerCase(),message:a,args:o,type:r.name})}}}const qF=(t,e)=>e.some(n=>t instanceof n);let dI,fI;function KF(){return dI||(dI=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function HF(){return fI||(fI=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const pC=new WeakMap,bm=new WeakMap,gC=new WeakMap,rg=new WeakMap,hy=new WeakMap;function WF(t){const e=new Promise((n,s)=>{const r=()=>{t.removeEventListener("success",i),t.removeEventListener("error",o)},i=()=>{n(cr(t.result)),r()},o=()=>{s(t.error),r()};t.addEventListener("success",i),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&pC.set(n,t)}).catch(()=>{}),hy.set(e,t),e}function GF(t){if(bm.has(t))return;const e=new Promise((n,s)=>{const r=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",o),t.removeEventListener("abort",o)},i=()=>{n(),r()},o=()=>{s(t.error||new DOMException("AbortError","AbortError")),r()};t.addEventListener("complete",i),t.addEventListener("error",o),t.addEventListener("abort",o)});bm.set(t,e)}let Im={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return bm.get(t);if(e==="objectStoreNames")return t.objectStoreNames||gC.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return cr(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function zF(t){Im=t(Im)}function QF(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const s=t.call(ig(this),e,...n);return gC.set(s,e.sort?e.sort():[e]),cr(s)}:HF().includes(t)?function(...e){return t.apply(ig(this),e),cr(pC.get(this))}:function(...e){return cr(t.apply(ig(this),e))}}function YF(t){return typeof t=="function"?QF(t):(t instanceof IDBTransaction&&GF(t),qF(t,KF())?new Proxy(t,Im):t)}function cr(t){if(t instanceof IDBRequest)return WF(t);if(rg.has(t))return rg.get(t);const e=YF(t);return e!==t&&(rg.set(t,e),hy.set(e,t)),e}const ig=t=>hy.get(t);function oc(t,e,{blocked:n,upgrade:s,blocking:r,terminated:i}={}){const o=indexedDB.open(t,e),a=cr(o);return s&&o.addEventListener("upgradeneeded",c=>{s(cr(o.result),c.oldVersion,c.newVersion,cr(o.transaction))}),n&&o.addEventListener("blocked",()=>n()),a.then(c=>{i&&c.addEventListener("close",()=>i()),r&&c.addEventListener("versionchange",()=>r())}).catch(()=>{}),a}function _a(t,{blocked:e}={}){const n=indexedDB.deleteDatabase(t);return e&&n.addEventListener("blocked",()=>e()),cr(n).then(()=>{})}const JF=["get","getKey","getAll","getAllKeys","count"],XF=["put","add","delete","clear"],og=new Map;function pI(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(og.get(e))return og.get(e);const n=e.replace(/FromIndex$/,""),s=e!==n,r=XF.includes(n);if(!(n in(s?IDBIndex:IDBObjectStore).prototype)||!(r||JF.includes(n)))return;const i=async function(o,...a){const c=this.transaction(o,r?"readwrite":"readonly");let l=c.store;return s&&(l=l.index(a.shift())),(await Promise.all([l[n](...a),r&&c.done]))[0]};return og.set(e,i),i}zF(t=>({...t,get:(e,n,s)=>pI(e,n)||t.get(e,n,s),has:(e,n)=>!!pI(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZF{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(eU(n)){const s=n.getImmediate();return`${s.library}/${s.version}`}else return null}).filter(n=>n).join(" ")}}function eU(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Em="@firebase/app",gI="0.7.30";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ao=new Qs("@firebase/app"),tU="@firebase/app-compat",nU="@firebase/analytics-compat",sU="@firebase/analytics",rU="@firebase/app-check-compat",iU="@firebase/app-check",oU="@firebase/auth",aU="@firebase/auth-compat",cU="@firebase/database",lU="@firebase/database-compat",uU="@firebase/functions",hU="@firebase/functions-compat",dU="@firebase/installations",fU="@firebase/installations-compat",pU="@firebase/messaging",gU="@firebase/messaging-compat",mU="@firebase/performance",_U="@firebase/performance-compat",yU="@firebase/remote-config",vU="@firebase/remote-config-compat",wU="@firebase/storage",bU="@firebase/storage-compat",IU="@firebase/firestore",EU="@firebase/firestore-compat",TU="firebase",SU="9.9.2";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const co="[DEFAULT]",CU={[Em]:"fire-core",[tU]:"fire-core-compat",[sU]:"fire-analytics",[nU]:"fire-analytics-compat",[iU]:"fire-app-check",[rU]:"fire-app-check-compat",[oU]:"fire-auth",[aU]:"fire-auth-compat",[cU]:"fire-rtdb",[lU]:"fire-rtdb-compat",[uU]:"fire-fn",[hU]:"fire-fn-compat",[dU]:"fire-iid",[fU]:"fire-iid-compat",[pU]:"fire-fcm",[gU]:"fire-fcm-compat",[mU]:"fire-perf",[_U]:"fire-perf-compat",[yU]:"fire-rc",[vU]:"fire-rc-compat",[wU]:"fire-gcs",[bU]:"fire-gcs-compat",[IU]:"fire-fst",[EU]:"fire-fst-compat","fire-js":"fire-js",[TU]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ni=new Map,Dl=new Map;function hd(t,e){try{t.container.addComponent(e)}catch(n){ao.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function mC(t,e){t.container.addOrOverwriteComponent(e)}function rt(t){const e=t.name;if(Dl.has(e))return ao.debug(`There were multiple attempts to register component ${e}.`),!1;Dl.set(e,t);for(const n of ni.values())hd(n,t);return!0}function Fo(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function AU(t,e,n=co){Fo(t,e).clearInstance(n)}function kU(){Dl.clear()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RU={["no-app"]:"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()",["bad-app-name"]:"Illegal App name: '{$appName}",["duplicate-app"]:"Firebase App named '{$appName}' already exists with different options or config",["app-deleted"]:"Firebase App named '{$appName}' already deleted",["invalid-app-argument"]:"firebase.{$appName}() takes either no argument or a Firebase App instance.",["invalid-log-argument"]:"First argument to `onLog` must be null or a function.",["idb-open"]:"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.",["idb-get"]:"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.",["idb-set"]:"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.",["idb-delete"]:"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."},si=new gn("app","Firebase",RU);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NU{constructor(e,n,s){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=s,this.container.addComponent(new Ae("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw si.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ys=SU;function _C(t,e={}){typeof e!="object"&&(e={name:e});const n=Object.assign({name:co,automaticDataCollectionEnabled:!1},e),s=n.name;if(typeof s!="string"||!s)throw si.create("bad-app-name",{appName:String(s)});const r=ni.get(s);if(r){if(wm(t,r.options)&&wm(n,r.config))return r;throw si.create("duplicate-app",{appName:s})}const i=new dC(s);for(const a of Dl.values())i.addComponent(a);const o=new NU(t,n,i);return ni.set(s,o),o}function yC(t=co){const e=ni.get(t);if(!e)throw si.create("no-app",{appName:t});return e}function PU(){return Array.from(ni.values())}async function vC(t){const e=t.name;ni.has(e)&&(ni.delete(e),await Promise.all(t.container.getProviders().map(n=>n.delete())),t.isDeleted=!0)}function $e(t,e,n){var s;let r=(s=CU[t])!==null&&s!==void 0?s:t;n&&(r+=`-${n}`);const i=r.match(/\s|\//),o=e.match(/\s|\//);if(i||o){const a=[`Unable to register library "${r}" with version "${e}":`];i&&a.push(`library name "${r}" contains illegal characters (whitespace or "/")`),i&&o&&a.push("and"),o&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),ao.warn(a.join(" "));return}rt(new Ae(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}function wC(t,e){if(t!==null&&typeof t!="function")throw si.create("invalid-log-argument");jF(t,e)}function bC(t){BF(t)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xU="firebase-heartbeat-database",DU=1,Ol="firebase-heartbeat-store";let ag=null;function IC(){return ag||(ag=oc(xU,DU,{upgrade:(t,e)=>{switch(e){case 0:t.createObjectStore(Ol)}}}).catch(t=>{throw si.create("idb-open",{originalErrorMessage:t.message})})),ag}async function OU(t){var e;try{return(await IC()).transaction(Ol).objectStore(Ol).get(EC(t))}catch(n){if(n instanceof et)ao.warn(n.message);else{const s=si.create("idb-get",{originalErrorMessage:(e=n)===null||e===void 0?void 0:e.message});ao.warn(s.message)}}}async function mI(t,e){var n;try{const r=(await IC()).transaction(Ol,"readwrite");return await r.objectStore(Ol).put(e,EC(t)),r.done}catch(s){if(s instanceof et)ao.warn(s.message);else{const r=si.create("idb-set",{originalErrorMessage:(n=s)===null||n===void 0?void 0:n.message});ao.warn(r.message)}}}function EC(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MU=1024,LU=30*24*60*60*1e3;class FU{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new $U(n),this._heartbeatsCachePromise=this._storage.read().then(s=>(this._heartbeatsCache=s,s))}async triggerHeartbeat(){const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=_I();if(this._heartbeatsCache===null&&(this._heartbeatsCache=await this._heartbeatsCachePromise),!(this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(r=>r.date===s)))return this._heartbeatsCache.heartbeats.push({date:s,agent:n}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(r=>{const i=new Date(r.date).valueOf();return Date.now()-i<=LU}),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache===null||this._heartbeatsCache.heartbeats.length===0)return"";const e=_I(),{heartbeatsToSend:n,unsentEntries:s}=UU(this._heartbeatsCache.heartbeats),r=ad(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=e,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),r}}function _I(){return new Date().toISOString().substring(0,10)}function UU(t,e=MU){const n=[];let s=t.slice();for(const r of t){const i=n.find(o=>o.agent===r.agent);if(i){if(i.dates.push(r.date),yI(n)>e){i.dates.pop();break}}else if(n.push({agent:r.agent,dates:[r.date]}),yI(n)>e){n.pop();break}s=s.slice(1)}return{heartbeatsToSend:n,unsentEntries:s}}class $U{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return En()?Tu().then(()=>!0).catch(()=>!1):!1}async read(){return await this._canUseIndexedDBPromise?await OU(this.app)||{heartbeats:[]}:{heartbeats:[]}}async overwrite(e){var n;if(await this._canUseIndexedDBPromise){const r=await this.read();return mI(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var n;if(await this._canUseIndexedDBPromise){const r=await this.read();return mI(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function yI(t){return ad(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VU(t){rt(new Ae("platform-logger",e=>new ZF(e),"PRIVATE")),rt(new Ae("heartbeat",e=>new FU(e),"PRIVATE")),$e(Em,gI,t),$e(Em,gI,"esm2017"),$e("fire-js","")}VU("");const BU=Object.freeze(Object.defineProperty({__proto__:null,SDK_VERSION:Ys,_DEFAULT_ENTRY_NAME:co,_addComponent:hd,_addOrOverwriteComponent:mC,_apps:ni,_clearComponents:kU,_components:Dl,_getProvider:Fo,_registerComponent:rt,_removeServiceInstance:AU,deleteApp:vC,getApp:yC,getApps:PU,initializeApp:_C,onLog:wC,registerVersion:$e,setLogLevel:bC,FirebaseError:et},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jU{constructor(e,n){this._delegate=e,this.firebase=n,hd(e,new Ae("app-compat",()=>this,"PUBLIC")),this.container=e.container}get automaticDataCollectionEnabled(){return this._delegate.automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this._delegate.automaticDataCollectionEnabled=e}get name(){return this._delegate.name}get options(){return this._delegate.options}delete(){return new Promise(e=>{this._delegate.checkDestroyed(),e()}).then(()=>(this.firebase.INTERNAL.removeApp(this.name),vC(this._delegate)))}_getService(e,n=co){var s;this._delegate.checkDestroyed();const r=this._delegate.container.getProvider(e);return!r.isInitialized()&&((s=r.getComponent())===null||s===void 0?void 0:s.instantiationMode)==="EXPLICIT"&&r.initialize(),r.getImmediate({identifier:n})}_removeServiceInstance(e,n=co){this._delegate.container.getProvider(e).clearInstance(n)}_addComponent(e){hd(this._delegate,e)}_addOrOverwriteComponent(e){mC(this._delegate,e)}toJSON(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qU={["no-app"]:"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()",["invalid-app-argument"]:"firebase.{$appName}() takes either no argument or a Firebase App instance."},vI=new gn("app-compat","Firebase",qU);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function KU(t){const e={},n={__esModule:!0,initializeApp:i,app:r,registerVersion:$e,setLogLevel:bC,onLog:wC,apps:null,SDK_VERSION:Ys,INTERNAL:{registerComponent:a,removeApp:s,useAsService:c,modularAPIs:BU}};n.default=n,Object.defineProperty(n,"apps",{get:o});function s(l){delete e[l]}function r(l){if(l=l||co,!Mn(e,l))throw vI.create("no-app",{appName:l});return e[l]}r.App=t;function i(l,u={}){const h=_C(l,u);if(Mn(e,h.name))return e[h.name];const d=new t(h,n);return e[h.name]=d,d}function o(){return Object.keys(e).map(l=>e[l])}function a(l){const u=l.name,h=u.replace("-compat","");if(rt(l)&&l.type==="PUBLIC"){const d=(f=r())=>{if(typeof f[h]!="function")throw vI.create("invalid-app-argument",{appName:u});return f[h]()};l.serviceProps!==void 0&&Pl(d,l.serviceProps),n[h]=d,t.prototype[h]=function(...f){return this._getService.bind(this,u).apply(this,l.multipleInstances?f:[])}}return l.type==="PUBLIC"?n[h]:null}function c(l,u){return u==="serverAuth"?null:u}return n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function TC(){const t=KU(jU);t.INTERNAL=Object.assign(Object.assign({},t.INTERNAL),{createFirebaseNamespace:TC,extendNamespace:e,createSubscribe:uC,ErrorFactory:gn,deepExtend:Pl});function e(n){Pl(t,n)}return t}const HU=TC();/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wI=new Qs("@firebase/app-compat"),WU="@firebase/app-compat",GU="0.1.31";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zU(t){$e(WU,GU,t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */if(mF()&&self.firebase!==void 0){wI.warn(`
    Warning: Firebase is already defined in the global scope. Please make sure
    Firebase library is only loaded once.
  `);const t=self.firebase.SDK_VERSION;t&&t.indexOf("LITE")>=0&&wI.warn(`
    Warning: You are trying to load Firebase while using Firebase Performance standalone script.
    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.
    `)}const ut=HU;zU();const SC="@firebase/installations",dy="0.5.12";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CC=1e4,AC=`w:${dy}`,kC="FIS_v2",QU="https://firebaseinstallations.googleapis.com/v1",YU=60*60*1e3,JU="installations",XU="Installations";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZU={["missing-app-config-values"]:'Missing App configuration value: "{$valueName}"',["not-registered"]:"Firebase Installation is not registered.",["installation-not-found"]:"Firebase Installation not found.",["request-failed"]:'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',["app-offline"]:"Could not process request. Application offline.",["delete-pending-registration"]:"Can't delete installation while there is a pending registration request."},lo=new gn(JU,XU,ZU);function RC(t){return t instanceof et&&t.code.includes("request-failed")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NC({projectId:t}){return`${QU}/projects/${t}/installations`}function PC(t){return{token:t.token,requestStatus:2,expiresIn:t$(t.expiresIn),creationTime:Date.now()}}async function xC(t,e){const s=(await e.json()).error;return lo.create("request-failed",{requestName:t,serverCode:s.code,serverMessage:s.message,serverStatus:s.status})}function DC({apiKey:t}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t})}function e$(t,{refreshToken:e}){const n=DC(t);return n.append("Authorization",n$(e)),n}async function OC(t){const e=await t();return e.status>=500&&e.status<600?t():e}function t$(t){return Number(t.replace("s","000"))}function n$(t){return`${kC} ${t}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function s$({appConfig:t,heartbeatServiceProvider:e},{fid:n}){const s=NC(t),r=DC(t),i=e.getImmediate({optional:!0});if(i){const l=await i.getHeartbeatsHeader();l&&r.append("x-firebase-client",l)}const o={fid:n,authVersion:kC,appId:t.appId,sdkVersion:AC},a={method:"POST",headers:r,body:JSON.stringify(o)},c=await OC(()=>fetch(s,a));if(c.ok){const l=await c.json();return{fid:l.fid||n,registrationStatus:2,refreshToken:l.refreshToken,authToken:PC(l.authToken)}}else throw await xC("Create Installation",c)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function MC(t){return new Promise(e=>{setTimeout(e,t)})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function r$(t){return btoa(String.fromCharCode(...t)).replace(/\+/g,"-").replace(/\//g,"_")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const i$=/^[cdef][\w-]{21}$/,Tm="";function o$(){try{const t=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(t),t[0]=112+t[0]%16;const n=a$(t);return i$.test(n)?n:Tm}catch{return Tm}}function a$(t){return r$(t).substr(0,22)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nf(t){return`${t.appName}!${t.appId}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LC=new Map;function FC(t,e){const n=Nf(t);UC(n,e),c$(n,e)}function UC(t,e){const n=LC.get(t);if(!!n)for(const s of n)s(e)}function c$(t,e){const n=l$();n&&n.postMessage({key:t,fid:e}),u$()}let Hi=null;function l$(){return!Hi&&"BroadcastChannel"in self&&(Hi=new BroadcastChannel("[Firebase] FID Change"),Hi.onmessage=t=>{UC(t.data.key,t.data.fid)}),Hi}function u$(){LC.size===0&&Hi&&(Hi.close(),Hi=null)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const h$="firebase-installations-database",d$=1,uo="firebase-installations-store";let cg=null;function fy(){return cg||(cg=oc(h$,d$,{upgrade:(t,e)=>{switch(e){case 0:t.createObjectStore(uo)}}})),cg}async function dd(t,e){const n=Nf(t),r=(await fy()).transaction(uo,"readwrite"),i=r.objectStore(uo),o=await i.get(n);return await i.put(e,n),await r.done,(!o||o.fid!==e.fid)&&FC(t,e.fid),e}async function $C(t){const e=Nf(t),s=(await fy()).transaction(uo,"readwrite");await s.objectStore(uo).delete(e),await s.done}async function Pf(t,e){const n=Nf(t),r=(await fy()).transaction(uo,"readwrite"),i=r.objectStore(uo),o=await i.get(n),a=e(o);return a===void 0?await i.delete(n):await i.put(a,n),await r.done,a&&(!o||o.fid!==a.fid)&&FC(t,a.fid),a}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function py(t){let e;const n=await Pf(t.appConfig,s=>{const r=f$(s),i=p$(t,r);return e=i.registrationPromise,i.installationEntry});return n.fid===Tm?{installationEntry:await e}:{installationEntry:n,registrationPromise:e}}function f$(t){const e=t||{fid:o$(),registrationStatus:0};return VC(e)}function p$(t,e){if(e.registrationStatus===0){if(!navigator.onLine){const r=Promise.reject(lo.create("app-offline"));return{installationEntry:e,registrationPromise:r}}const n={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},s=g$(t,n);return{installationEntry:n,registrationPromise:s}}else return e.registrationStatus===1?{installationEntry:e,registrationPromise:m$(t)}:{installationEntry:e}}async function g$(t,e){try{const n=await s$(t,e);return dd(t.appConfig,n)}catch(n){throw RC(n)&&n.customData.serverCode===409?await $C(t.appConfig):await dd(t.appConfig,{fid:e.fid,registrationStatus:0}),n}}async function m$(t){let e=await bI(t.appConfig);for(;e.registrationStatus===1;)await MC(100),e=await bI(t.appConfig);if(e.registrationStatus===0){const{installationEntry:n,registrationPromise:s}=await py(t);return s||n}return e}function bI(t){return Pf(t,e=>{if(!e)throw lo.create("installation-not-found");return VC(e)})}function VC(t){return _$(t)?{fid:t.fid,registrationStatus:0}:t}function _$(t){return t.registrationStatus===1&&t.registrationTime+CC<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function y$({appConfig:t,heartbeatServiceProvider:e},n){const s=v$(t,n),r=e$(t,n),i=e.getImmediate({optional:!0});if(i){const l=await i.getHeartbeatsHeader();l&&r.append("x-firebase-client",l)}const o={installation:{sdkVersion:AC,appId:t.appId}},a={method:"POST",headers:r,body:JSON.stringify(o)},c=await OC(()=>fetch(s,a));if(c.ok){const l=await c.json();return PC(l)}else throw await xC("Generate Auth Token",c)}function v$(t,{fid:e}){return`${NC(t)}/${e}/authTokens:generate`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function gy(t,e=!1){let n;const s=await Pf(t.appConfig,i=>{if(!BC(i))throw lo.create("not-registered");const o=i.authToken;if(!e&&I$(o))return i;if(o.requestStatus===1)return n=w$(t,e),i;{if(!navigator.onLine)throw lo.create("app-offline");const a=T$(i);return n=b$(t,a),a}});return n?await n:s.authToken}async function w$(t,e){let n=await II(t.appConfig);for(;n.authToken.requestStatus===1;)await MC(100),n=await II(t.appConfig);const s=n.authToken;return s.requestStatus===0?gy(t,e):s}function II(t){return Pf(t,e=>{if(!BC(e))throw lo.create("not-registered");const n=e.authToken;return S$(n)?Object.assign(Object.assign({},e),{authToken:{requestStatus:0}}):e})}async function b$(t,e){try{const n=await y$(t,e),s=Object.assign(Object.assign({},e),{authToken:n});return await dd(t.appConfig,s),n}catch(n){if(RC(n)&&(n.customData.serverCode===401||n.customData.serverCode===404))await $C(t.appConfig);else{const s=Object.assign(Object.assign({},e),{authToken:{requestStatus:0}});await dd(t.appConfig,s)}throw n}}function BC(t){return t!==void 0&&t.registrationStatus===2}function I$(t){return t.requestStatus===2&&!E$(t)}function E$(t){const e=Date.now();return e<t.creationTime||t.creationTime+t.expiresIn<e+YU}function T$(t){const e={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},t),{authToken:e})}function S$(t){return t.requestStatus===1&&t.requestTime+CC<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function C$(t){const e=t,{installationEntry:n,registrationPromise:s}=await py(e);return s?s.catch(console.error):gy(e).catch(console.error),n.fid}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function A$(t,e=!1){const n=t;return await k$(n),(await gy(n,e)).token}async function k$(t){const{registrationPromise:e}=await py(t);e&&await e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function R$(t){if(!t||!t.options)throw lg("App Configuration");if(!t.name)throw lg("App Name");const e=["projectId","apiKey","appId"];for(const n of e)if(!t.options[n])throw lg(n);return{appName:t.name,projectId:t.options.projectId,apiKey:t.options.apiKey,appId:t.options.appId}}function lg(t){return lo.create("missing-app-config-values",{valueName:t})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jC="installations",N$="installations-internal",P$=t=>{const e=t.getProvider("app").getImmediate(),n=R$(e),s=Fo(e,"heartbeat");return{app:e,appConfig:n,heartbeatServiceProvider:s,_delete:()=>Promise.resolve()}},x$=t=>{const e=t.getProvider("app").getImmediate(),n=Fo(e,jC).getImmediate();return{getId:()=>C$(n),getToken:r=>A$(n,r)}};function D$(){rt(new Ae(jC,P$,"PUBLIC")),rt(new Ae(N$,x$,"PRIVATE"))}D$();$e(SC,dy);$e(SC,dy,"esm2017");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const EI="analytics",O$="firebase_id",M$="origin",L$=60*1e3,F$="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",qC="https://www.googletagmanager.com/gtag/js";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qt=new Qs("@firebase/analytics");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function KC(t){return Promise.all(t.map(e=>e.catch(n=>n)))}function U$(t,e){const n=document.createElement("script");n.src=`${qC}?l=${t}&id=${e}`,n.async=!0,document.head.appendChild(n)}function $$(t){let e=[];return Array.isArray(window[t])?e=window[t]:window[t]=e,e}async function V$(t,e,n,s,r,i){const o=s[r];try{if(o)await e[o];else{const c=(await KC(n)).find(l=>l.measurementId===r);c&&await e[c.appId]}}catch(a){qt.error(a)}t("config",r,i)}async function B$(t,e,n,s,r){try{let i=[];if(r&&r.send_to){let o=r.send_to;Array.isArray(o)||(o=[o]);const a=await KC(n);for(const c of o){const l=a.find(h=>h.measurementId===c),u=l&&e[l.appId];if(u)i.push(u);else{i=[];break}}}i.length===0&&(i=Object.values(e)),await Promise.all(i),t("event",s,r||{})}catch(i){qt.error(i)}}function j$(t,e,n,s){async function r(i,o,a){try{i==="event"?await B$(t,e,n,o,a):i==="config"?await V$(t,e,n,s,o,a):i==="consent"?t("consent","update",a):t("set",o)}catch(c){qt.error(c)}}return r}function q$(t,e,n,s,r){let i=function(...o){window[s].push(arguments)};return window[r]&&typeof window[r]=="function"&&(i=window[r]),window[r]=j$(i,t,e,n),{gtagCore:i,wrappedGtag:window[r]}}function K$(){const t=window.document.getElementsByTagName("script");for(const e of Object.values(t))if(e.src&&e.src.includes(qC))return e;return null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const H$={["already-exists"]:"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.",["already-initialized"]:"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-intialized instance.",["already-initialized-settings"]:"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.",["interop-component-reg-failed"]:"Firebase Analytics Interop Component failed to instantiate: {$reason}",["invalid-analytics-context"]:"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}",["indexeddb-unavailable"]:"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}",["fetch-throttle"]:"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.",["config-fetch-failed"]:"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}",["no-api-key"]:'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',["no-app-id"]:'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.'},Qn=new gn("analytics","Analytics",H$);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const W$=30,G$=1e3;class z${constructor(e={},n=G$){this.throttleMetadata=e,this.intervalMillis=n}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,n){this.throttleMetadata[e]=n}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}}const HC=new z$;function Q$(t){return new Headers({Accept:"application/json","x-goog-api-key":t})}async function Y$(t){var e;const{appId:n,apiKey:s}=t,r={method:"GET",headers:Q$(s)},i=F$.replace("{app-id}",n),o=await fetch(i,r);if(o.status!==200&&o.status!==304){let a="";try{const c=await o.json();!((e=c.error)===null||e===void 0)&&e.message&&(a=c.error.message)}catch{}throw Qn.create("config-fetch-failed",{httpStatus:o.status,responseMessage:a})}return o.json()}async function J$(t,e=HC,n){const{appId:s,apiKey:r,measurementId:i}=t.options;if(!s)throw Qn.create("no-app-id");if(!r){if(i)return{measurementId:i,appId:s};throw Qn.create("no-api-key")}const o=e.getThrottleMetadata(s)||{backoffCount:0,throttleEndTimeMillis:Date.now()},a=new eV;return setTimeout(async()=>{a.abort()},n!==void 0?n:L$),WC({appId:s,apiKey:r,measurementId:i},o,a,e)}async function WC(t,{throttleEndTimeMillis:e,backoffCount:n},s,r=HC){var i,o;const{appId:a,measurementId:c}=t;try{await X$(s,e)}catch(l){if(c)return qt.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${c} provided in the "measurementId" field in the local Firebase config. [${(i=l)===null||i===void 0?void 0:i.message}]`),{appId:a,measurementId:c};throw l}try{const l=await Y$(t);return r.deleteThrottleMetadata(a),l}catch(l){const u=l;if(!Z$(u)){if(r.deleteThrottleMetadata(a),c)return qt.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${c} provided in the "measurementId" field in the local Firebase config. [${u==null?void 0:u.message}]`),{appId:a,measurementId:c};throw l}const h=Number((o=u==null?void 0:u.customData)===null||o===void 0?void 0:o.httpStatus)===503?ud(n,r.intervalMillis,W$):ud(n,r.intervalMillis),d={throttleEndTimeMillis:Date.now()+h,backoffCount:n+1};return r.setThrottleMetadata(a,d),qt.debug(`Calling attemptFetch again in ${h} millis`),WC(t,d,s,r)}}function X$(t,e){return new Promise((n,s)=>{const r=Math.max(e-Date.now(),0),i=setTimeout(n,r);t.addEventListener(()=>{clearTimeout(i),s(Qn.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}function Z$(t){if(!(t instanceof et)||!t.customData)return!1;const e=Number(t.customData.httpStatus);return e===429||e===500||e===503||e===504}class eV{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach(e=>e())}}async function tV(t,e,n,s,r){if(r&&r.global){t("event",n,s);return}else{const i=await e,o=Object.assign(Object.assign({},s),{send_to:i});t("event",n,o)}}async function nV(t,e,n,s){if(s&&s.global)return t("set",{screen_name:n}),Promise.resolve();{const r=await e;t("config",r,{update:!0,screen_name:n})}}async function sV(t,e,n,s){if(s&&s.global)return t("set",{user_id:n}),Promise.resolve();{const r=await e;t("config",r,{update:!0,user_id:n})}}async function rV(t,e,n,s){if(s&&s.global){const r={};for(const i of Object.keys(n))r[`user_properties.${i}`]=n[i];return t("set",r),Promise.resolve()}else{const r=await e;t("config",r,{update:!0,user_properties:n})}}async function iV(t,e){const n=await t;window[`ga-disable-${n}`]=!e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function oV(){var t;if(En())try{await Tu()}catch(e){return qt.warn(Qn.create("indexeddb-unavailable",{errorInfo:(t=e)===null||t===void 0?void 0:t.toString()}).message),!1}else return qt.warn(Qn.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;return!0}async function aV(t,e,n,s,r,i,o){var a;const c=J$(t);c.then(f=>{n[f.measurementId]=f.appId,t.options.measurementId&&f.measurementId!==t.options.measurementId&&qt.warn(`The measurement ID in the local Firebase config (${t.options.measurementId}) does not match the measurement ID fetched from the server (${f.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(f=>qt.error(f)),e.push(c);const l=oV().then(f=>{if(f)return s.getId()}),[u,h]=await Promise.all([c,l]);K$()||U$(i,u.measurementId),r("js",new Date);const d=(a=o==null?void 0:o.config)!==null&&a!==void 0?a:{};return d[M$]="firebase",d.update=!0,h!=null&&(d[O$]=h),r("config",u.measurementId,d),u.measurementId}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cV{constructor(e){this.app=e}_delete(){return delete lr[this.app.options.appId],Promise.resolve()}}let lr={},TI=[];const SI={};let Uh="dataLayer",GC="gtag",CI,Su,Sm=!1;function lV(t){if(Sm)throw Qn.create("already-initialized");t.dataLayerName&&(Uh=t.dataLayerName),t.gtagName&&(GC=t.gtagName)}function uV(){const t=[];if(Iu()&&t.push("This is a browser extension environment."),kf()||t.push("Cookies are not available."),t.length>0){const e=t.map((s,r)=>`(${r+1}) ${s}`).join(" "),n=Qn.create("invalid-analytics-context",{errorInfo:e});qt.warn(n.message)}}function hV(t,e,n){uV();const s=t.options.appId;if(!s)throw Qn.create("no-app-id");if(!t.options.apiKey)if(t.options.measurementId)qt.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${t.options.measurementId} provided in the "measurementId" field in the local Firebase config.`);else throw Qn.create("no-api-key");if(lr[s]!=null)throw Qn.create("already-exists",{id:s});if(!Sm){$$(Uh);const{wrappedGtag:i,gtagCore:o}=q$(lr,TI,SI,Uh,GC);Su=i,CI=o,Sm=!0}return lr[s]=aV(t,TI,SI,e,CI,Uh,n),new cV(t)}async function dV(){if(Iu()||!kf()||!En())return!1;try{return await Tu()}catch{return!1}}function fV(t,e,n){t=N(t),nV(Su,lr[t.app.options.appId],e,n).catch(s=>qt.error(s))}function pV(t,e,n){t=N(t),sV(Su,lr[t.app.options.appId],e,n).catch(s=>qt.error(s))}function gV(t,e,n){t=N(t),rV(Su,lr[t.app.options.appId],e,n).catch(s=>qt.error(s))}function mV(t,e){t=N(t),iV(lr[t.app.options.appId],e).catch(n=>qt.error(n))}function zC(t,e,n,s){t=N(t),tV(Su,lr[t.app.options.appId],e,n,s).catch(r=>qt.error(r))}const AI="@firebase/analytics",kI="0.8.0";function _V(){rt(new Ae(EI,(e,{options:n})=>{const s=e.getProvider("app").getImmediate(),r=e.getProvider("installations-internal").getImmediate();return hV(s,r,n)},"PUBLIC")),rt(new Ae("analytics-internal",t,"PRIVATE")),$e(AI,kI),$e(AI,kI,"esm2017");function t(e){try{const n=e.getProvider(EI).getImmediate();return{logEvent:(s,r,i)=>zC(n,s,r,i)}}catch(n){throw Qn.create("interop-component-reg-failed",{reason:n})}}}_V();const yV="@firebase/analytics-compat",vV="0.1.13";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QC{constructor(e,n){this.app=e,this._delegate=n}logEvent(e,n,s){zC(this._delegate,e,n,s)}setCurrentScreen(e,n){fV(this._delegate,e,n)}setUserId(e,n){pV(this._delegate,e,n)}setUserProperties(e,n){gV(this._delegate,e,n)}setAnalyticsCollectionEnabled(e){mV(this._delegate,e)}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Cm;(function(t){t.ADD_SHIPPING_INFO="add_shipping_info",t.ADD_PAYMENT_INFO="add_payment_info",t.ADD_TO_CART="add_to_cart",t.ADD_TO_WISHLIST="add_to_wishlist",t.BEGIN_CHECKOUT="begin_checkout",t.CHECKOUT_PROGRESS="checkout_progress",t.EXCEPTION="exception",t.GENERATE_LEAD="generate_lead",t.LOGIN="login",t.PAGE_VIEW="page_view",t.PURCHASE="purchase",t.REFUND="refund",t.REMOVE_FROM_CART="remove_from_cart",t.SCREEN_VIEW="screen_view",t.SEARCH="search",t.SELECT_CONTENT="select_content",t.SELECT_ITEM="select_item",t.SELECT_PROMOTION="select_promotion",t.SET_CHECKOUT_OPTION="set_checkout_option",t.SHARE="share",t.SIGN_UP="sign_up",t.TIMING_COMPLETE="timing_complete",t.VIEW_CART="view_cart",t.VIEW_ITEM="view_item",t.VIEW_ITEM_LIST="view_item_list",t.VIEW_PROMOTION="view_promotion",t.VIEW_SEARCH_RESULTS="view_search_results"})(Cm||(Cm={}));/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wV=t=>{const e=t.getProvider("app-compat").getImmediate(),n=t.getProvider("analytics").getImmediate();return new QC(e,n)};function bV(){const t={Analytics:QC,settings:lV,isSupported:dV,EventName:Cm};ut.INTERNAL.registerComponent(new Ae("analytics-compat",wV,"PUBLIC").setServiceProps(t).setMultipleInstances(!0))}bV();ut.registerVersion(yV,vV);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YC=new Map,IV={activated:!1,tokenObservers:[]},EV={initialized:!1,enabled:!1};function Pt(t){return YC.get(t)||IV}function ms(t,e){YC.set(t,e)}function xf(){return EV}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const my="https://content-firebaseappcheck.googleapis.com/v1",TV="exchangeRecaptchaV3Token",SV="exchangeRecaptchaEnterpriseToken",CV="exchangeDebugToken",RI={OFFSET_DURATION:5*60*1e3,RETRIAL_MIN_WAIT:30*1e3,RETRIAL_MAX_WAIT:16*60*1e3},AV=24*60*60*1e3;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kV{constructor(e,n,s,r,i){if(this.operation=e,this.retryPolicy=n,this.getWaitDuration=s,this.lowerBound=r,this.upperBound=i,this.pending=null,this.nextErrorWaitInterval=r,r>i)throw new Error("Proactive refresh lower bound greater than upper bound!")}start(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch(()=>{})}stop(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)}isRunning(){return!!this.pending}async process(e){this.stop();try{this.pending=new pt,await RV(this.getNextRun(e)),this.pending.resolve(),await this.pending.promise,this.pending=new pt,await this.operation(),this.pending.resolve(),await this.pending.promise,this.process(!0).catch(()=>{})}catch(n){this.retryPolicy(n)?this.process(!1).catch(()=>{}):this.stop()}}getNextRun(e){if(e)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();{const n=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),n}}}function RV(t){return new Promise(e=>{setTimeout(e,t)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NV={["already-initialized"]:"You have already called initializeAppCheck() for FirebaseApp {$appName} with different options. To avoid this error, call initializeAppCheck() with the same options as when it was originally called. This will return the already initialized instance.",["use-before-activation"]:"App Check is being used before initializeAppCheck() is called for FirebaseApp {$appName}. Call initializeAppCheck() before instantiating other Firebase services.",["fetch-network-error"]:"Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.",["fetch-parse-error"]:"Fetch client could not parse response. Original error: {$originalErrorMessage}.",["fetch-status-error"]:"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.",["storage-open"]:"Error thrown when opening storage. Original error: {$originalErrorMessage}.",["storage-get"]:"Error thrown when reading from storage. Original error: {$originalErrorMessage}.",["storage-set"]:"Error thrown when writing to storage. Original error: {$originalErrorMessage}.",["recaptcha-error"]:"ReCAPTCHA error.",throttled:"Requests throttled due to {$httpStatus} error. Attempts allowed again after {$time}"},un=new gn("appCheck","AppCheck",NV);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fd(t=!1){var e;return t?(e=self.grecaptcha)===null||e===void 0?void 0:e.enterprise:self.grecaptcha}function JC(t){if(!Pt(t).activated)throw un.create("use-before-activation",{appName:t.name})}function _y(t){const e=Math.round(t/1e3),n=Math.floor(e/(3600*24)),s=Math.floor((e-n*3600*24)/3600),r=Math.floor((e-n*3600*24-s*3600)/60),i=e-n*3600*24-s*3600-r*60;let o="";return n&&(o+=dh(n)+"d:"),s&&(o+=dh(s)+"h:"),o+=dh(r)+"m:"+dh(i)+"s",o}function dh(t){return t===0?"00":t>=10?t.toString():"0"+t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function yy({url:t,body:e},n){var s,r;const i={"Content-Type":"application/json"},o=n.getImmediate({optional:!0});if(o){const f=await o.getHeartbeatsHeader();f&&(i["X-Firebase-Client"]=f)}const a={method:"POST",body:JSON.stringify(e),headers:i};let c;try{c=await fetch(t,a)}catch(f){throw un.create("fetch-network-error",{originalErrorMessage:(s=f)===null||s===void 0?void 0:s.message})}if(c.status!==200)throw un.create("fetch-status-error",{httpStatus:c.status});let l;try{l=await c.json()}catch(f){throw un.create("fetch-parse-error",{originalErrorMessage:(r=f)===null||r===void 0?void 0:r.message})}const u=l.ttl.match(/^([\d.]+)(s)$/);if(!u||!u[2]||isNaN(Number(u[1])))throw un.create("fetch-parse-error",{originalErrorMessage:`ttl field (timeToLive) is not in standard Protobuf Duration format: ${l.ttl}`});const h=Number(u[1])*1e3,d=Date.now();return{token:l.token,expireTimeMillis:d+h,issuedAtTimeMillis:d}}function PV(t,e){const{projectId:n,appId:s,apiKey:r}=t.options;return{url:`${my}/projects/${n}/apps/${s}:${TV}?key=${r}`,body:{recaptcha_v3_token:e}}}function xV(t,e){const{projectId:n,appId:s,apiKey:r}=t.options;return{url:`${my}/projects/${n}/apps/${s}:${SV}?key=${r}`,body:{recaptcha_enterprise_token:e}}}function DV(t,e){const{projectId:n,appId:s,apiKey:r}=t.options;return{url:`${my}/projects/${n}/apps/${s}:${CV}?key=${r}`,body:{debug_token:e}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OV="firebase-app-check-database",MV=1,Ml="firebase-app-check-store",XC="debug-token";let fh=null;function ZC(){return fh||(fh=new Promise((t,e)=>{var n;try{const s=indexedDB.open(OV,MV);s.onsuccess=r=>{t(r.target.result)},s.onerror=r=>{var i;e(un.create("storage-open",{originalErrorMessage:(i=r.target.error)===null||i===void 0?void 0:i.message}))},s.onupgradeneeded=r=>{const i=r.target.result;switch(r.oldVersion){case 0:i.createObjectStore(Ml,{keyPath:"compositeKey"})}}}catch(s){e(un.create("storage-open",{originalErrorMessage:(n=s)===null||n===void 0?void 0:n.message}))}}),fh)}function LV(t){return tA(nA(t))}function FV(t,e){return eA(nA(t),e)}function UV(t){return eA(XC,t)}function $V(){return tA(XC)}async function eA(t,e){const s=(await ZC()).transaction(Ml,"readwrite"),i=s.objectStore(Ml).put({compositeKey:t,value:e});return new Promise((o,a)=>{i.onsuccess=c=>{o()},s.onerror=c=>{var l;a(un.create("storage-set",{originalErrorMessage:(l=c.target.error)===null||l===void 0?void 0:l.message}))}})}async function tA(t){const n=(await ZC()).transaction(Ml,"readonly"),r=n.objectStore(Ml).get(t);return new Promise((i,o)=>{r.onsuccess=a=>{const c=a.target.result;i(c?c.value:void 0)},n.onerror=a=>{var c;o(un.create("storage-get",{originalErrorMessage:(c=a.target.error)===null||c===void 0?void 0:c.message}))}})}function nA(t){return`${t.options.appId}-${t.name}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ll=new Qs("@firebase/app-check");/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function VV(t){if(En()){let e;try{e=await LV(t)}catch(n){Ll.warn(`Failed to read token from IndexedDB. Error: ${n}`)}return e}}function NI(t,e){return En()?FV(t,e).catch(n=>{Ll.warn(`Failed to write token to IndexedDB. Error: ${n}`)}):Promise.resolve()}async function BV(){let t;try{t=await $V()}catch{}if(t)return t;{const e=PF();return UV(e).catch(n=>Ll.warn(`Failed to persist debug token to IndexedDB. Error: ${n}`)),e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sA(){return xf().enabled}async function rA(){const t=xf();if(t.enabled&&t.token)return t.token.promise;throw Error(`
            Can't get debug token in production mode.
        `)}function jV(){const t=wF(),e=xf();if(e.initialized=!0,typeof t.FIREBASE_APPCHECK_DEBUG_TOKEN!="string"&&t.FIREBASE_APPCHECK_DEBUG_TOKEN!==!0)return;e.enabled=!0;const n=new pt;e.token=n,typeof t.FIREBASE_APPCHECK_DEBUG_TOKEN=="string"?n.resolve(t.FIREBASE_APPCHECK_DEBUG_TOKEN):n.resolve(BV())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qV={error:"UNKNOWN_ERROR"};function KV(t){return Cf.encodeString(JSON.stringify(t),!1)}async function pd(t,e=!1){const n=t.app;JC(n);const s=Pt(n);let r=s.token,i;if(!r){const c=await s.cachedTokenPromise;c&&gd(c)&&(r=c)}if(!e&&r&&gd(r))return{token:r.token};let o=!1;if(sA()){s.exchangeTokenPromise||(s.exchangeTokenPromise=yy(DV(n,await rA()),t.heartbeatServiceProvider).then(l=>(s.exchangeTokenPromise=void 0,l)),o=!0);const c=await s.exchangeTokenPromise;return await NI(n,c),ms(n,Object.assign(Object.assign({},s),{token:c})),{token:c.token}}try{s.exchangeTokenPromise||(s.exchangeTokenPromise=s.provider.getToken().then(c=>(s.exchangeTokenPromise=void 0,c)),o=!0),r=await s.exchangeTokenPromise}catch(c){c.code==="appCheck/throttled"?Ll.warn(c.message):Ll.error(c),i=c}let a;return r?(a={token:r.token},ms(n,Object.assign(Object.assign({},s),{token:r})),await NI(n,r)):a=WV(i),o&&iA(n,a),a}function vy(t,e,n,s){const{app:r}=t,i=Pt(r),o={next:n,error:s,type:e};if(ms(r,Object.assign(Object.assign({},i),{tokenObservers:[...i.tokenObservers,o]})),i.token&&gd(i.token)){const a=i.token;Promise.resolve().then(()=>{n({token:a.token}),PI(t)}).catch(()=>{})}i.cachedTokenPromise.then(()=>PI(t))}function wy(t,e){const n=Pt(t),s=n.tokenObservers.filter(r=>r.next!==e);s.length===0&&n.tokenRefresher&&n.tokenRefresher.isRunning()&&n.tokenRefresher.stop(),ms(t,Object.assign(Object.assign({},n),{tokenObservers:s}))}function PI(t){const{app:e}=t,n=Pt(e);let s=n.tokenRefresher;s||(s=HV(t),ms(e,Object.assign(Object.assign({},n),{tokenRefresher:s}))),!s.isRunning()&&n.isTokenAutoRefreshEnabled&&s.start()}function HV(t){const{app:e}=t;return new kV(async()=>{const n=Pt(e);let s;if(n.token?s=await pd(t,!0):s=await pd(t),s.error)throw s.error},()=>!0,()=>{const n=Pt(e);if(n.token){let s=n.token.issuedAtTimeMillis+(n.token.expireTimeMillis-n.token.issuedAtTimeMillis)*.5+3e5;const r=n.token.expireTimeMillis-5*60*1e3;return s=Math.min(s,r),Math.max(0,s-Date.now())}else return 0},RI.RETRIAL_MIN_WAIT,RI.RETRIAL_MAX_WAIT)}function iA(t,e){const n=Pt(t).tokenObservers;for(const s of n)try{s.type==="EXTERNAL"&&e.error!=null?s.error(e.error):s.next(e)}catch{}}function gd(t){return t.expireTimeMillis-Date.now()>0}function WV(t){return{token:KV(qV),error:t}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GV{constructor(e,n){this.app=e,this.heartbeatServiceProvider=n}_delete(){const{tokenObservers:e}=Pt(this.app);for(const n of e)wy(this.app,n.next);return Promise.resolve()}}function zV(t,e){return new GV(t,e)}function QV(t){return{getToken:e=>pd(t,e),addTokenListener:e=>vy(t,"INTERNAL",e),removeTokenListener:e=>wy(t.app,e)}}const YV="@firebase/app-check",JV="0.5.12";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XV="https://www.google.com/recaptcha/api.js",ZV="https://www.google.com/recaptcha/enterprise.js";function eB(t,e){const n=Pt(t),s=new pt;ms(t,Object.assign(Object.assign({},n),{reCAPTCHAState:{initialized:s}}));const r=oA(t),i=fd(!1);return i?md(t,e,i,r,s):sB(()=>{const o=fd(!1);if(!o)throw new Error("no recaptcha");md(t,e,o,r,s)}),s.promise}function tB(t,e){const n=Pt(t),s=new pt;ms(t,Object.assign(Object.assign({},n),{reCAPTCHAState:{initialized:s}}));const r=oA(t),i=fd(!0);return i?md(t,e,i,r,s):rB(()=>{const o=fd(!0);if(!o)throw new Error("no recaptcha");md(t,e,o,r,s)}),s.promise}function md(t,e,n,s,r){n.ready(()=>{nB(t,e,n,s),r.resolve(n)})}function oA(t){const e=`fire_app_check_${t.name}`,n=document.createElement("div");return n.id=e,n.style.display="none",document.body.appendChild(n),e}async function aA(t){JC(t);const n=await Pt(t).reCAPTCHAState.initialized.promise;return new Promise((s,r)=>{const i=Pt(t).reCAPTCHAState;n.ready(()=>{s(n.execute(i.widgetId,{action:"fire_app_check"}))})})}function nB(t,e,n,s){const r=n.render(s,{sitekey:e,size:"invisible"}),i=Pt(t);ms(t,Object.assign(Object.assign({},i),{reCAPTCHAState:Object.assign(Object.assign({},i.reCAPTCHAState),{widgetId:r})}))}function sB(t){const e=document.createElement("script");e.src=XV,e.onload=t,document.head.appendChild(e)}function rB(t){const e=document.createElement("script");e.src=ZV,e.onload=t,document.head.appendChild(e)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fl{constructor(e){this._siteKey=e,this._throttleData=null}async getToken(){var e,n;lA(this._throttleData);const s=await aA(this._app).catch(i=>{throw un.create("recaptcha-error")});let r;try{r=await yy(PV(this._app,s),this._heartbeatServiceProvider)}catch(i){throw!((e=i.code)===null||e===void 0)&&e.includes("fetch-status-error")?(this._throttleData=cA(Number((n=i.customData)===null||n===void 0?void 0:n.httpStatus),this._throttleData),un.create("throttled",{time:_y(this._throttleData.allowRequestsAfter-Date.now()),httpStatus:this._throttleData.httpStatus})):i}return this._throttleData=null,r}initialize(e){this._app=e,this._heartbeatServiceProvider=Fo(e,"heartbeat"),eB(e,this._siteKey).catch(()=>{})}isEqual(e){return e instanceof Fl?this._siteKey===e._siteKey:!1}}class Df{constructor(e){this._siteKey=e,this._throttleData=null}async getToken(){var e,n;lA(this._throttleData);const s=await aA(this._app).catch(i=>{throw un.create("recaptcha-error")});let r;try{r=await yy(xV(this._app,s),this._heartbeatServiceProvider)}catch(i){throw!((e=i.code)===null||e===void 0)&&e.includes("fetch-status-error")?(this._throttleData=cA(Number((n=i.customData)===null||n===void 0?void 0:n.httpStatus),this._throttleData),un.create("throttled",{time:_y(this._throttleData.allowRequestsAfter-Date.now()),httpStatus:this._throttleData.httpStatus})):i}return this._throttleData=null,r}initialize(e){this._app=e,this._heartbeatServiceProvider=Fo(e,"heartbeat"),tB(e,this._siteKey).catch(()=>{})}isEqual(e){return e instanceof Df?this._siteKey===e._siteKey:!1}}class Ul{constructor(e){this._customProviderOptions=e}async getToken(){const e=await this._customProviderOptions.getToken(),n=TF(e.token),s=n!==null&&n<Date.now()&&n>0?n*1e3:Date.now();return Object.assign(Object.assign({},e),{issuedAtTimeMillis:s})}initialize(e){this._app=e}isEqual(e){return e instanceof Ul?this._customProviderOptions.getToken.toString()===e._customProviderOptions.getToken.toString():!1}}function cA(t,e){if(t===404||t===403)return{backoffCount:1,allowRequestsAfter:Date.now()+AV,httpStatus:t};{const n=e?e.backoffCount:0,s=ud(n,1e3,2);return{backoffCount:n+1,allowRequestsAfter:Date.now()+s,httpStatus:t}}}function lA(t){if(t&&Date.now()-t.allowRequestsAfter<=0)throw un.create("throttled",{time:_y(t.allowRequestsAfter-Date.now()),httpStatus:t.httpStatus})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iB(t=yC(),e){t=N(t);const n=Fo(t,"app-check");if(xf().initialized||jV(),sA()&&rA().then(r=>console.log(`App Check debug token: ${r}. You will need to add it to your app's App Check settings in the Firebase console for it to work.`)),n.isInitialized()){const r=n.getImmediate(),i=n.getOptions();if(i.isTokenAutoRefreshEnabled===e.isTokenAutoRefreshEnabled&&i.provider.isEqual(e.provider))return r;throw un.create("already-initialized",{appName:t.name})}const s=n.initialize({options:e});return oB(t,e.provider,e.isTokenAutoRefreshEnabled),Pt(t).isTokenAutoRefreshEnabled&&vy(s,"INTERNAL",()=>{}),s}function oB(t,e,n){const s=Pt(t),r=Object.assign(Object.assign({},s),{activated:!0});r.provider=e,r.cachedTokenPromise=VV(t).then(i=>(i&&gd(i)&&(ms(t,Object.assign(Object.assign({},Pt(t)),{token:i})),iA(t,{token:i.token})),i)),r.isTokenAutoRefreshEnabled=n===void 0?t.automaticDataCollectionEnabled:n,ms(t,r),r.provider.initialize(t)}function aB(t,e){const n=t.app,s=Pt(n);s.tokenRefresher&&(e===!0?s.tokenRefresher.start():s.tokenRefresher.stop()),ms(n,Object.assign(Object.assign({},s),{isTokenAutoRefreshEnabled:e}))}async function cB(t,e){const n=await pd(t,e);if(n.error)throw n.error;return{token:n.token}}function lB(t,e,n,s){let r=()=>{},i=()=>{};return e.next!=null?r=e.next.bind(e):r=e,e.error!=null?i=e.error.bind(e):n&&(i=n),vy(t,"EXTERNAL",r,i),()=>wy(t.app,r)}const uB="app-check",xI="app-check-internal";function hB(){rt(new Ae(uB,t=>{const e=t.getProvider("app").getImmediate(),n=t.getProvider("heartbeat");return zV(e,n)},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((t,e,n)=>{t.getProvider(xI).initialize()})),rt(new Ae(xI,t=>{const e=t.getProvider("app-check").getImmediate();return QV(e)},"PUBLIC").setInstantiationMode("EXPLICIT")),$e(YV,JV)}hB();const dB="@firebase/app-check-compat",fB="0.2.12";/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pB={["use-before-activation"]:"App Check is being used before activate() is called for FirebaseApp {$appName}. Call activate() before instantiating other Firebase services."},ug=new gn("appCheck","AppCheck",pB);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gB{constructor(e){this.app=e}activate(e,n){let s;typeof e=="string"?s=new Fl(e):e instanceof Df||e instanceof Fl||e instanceof Ul?s=e:s=new Ul({getToken:e.getToken}),this._delegate=iB(this.app,{provider:s,isTokenAutoRefreshEnabled:n})}setTokenAutoRefreshEnabled(e){if(!this._delegate)throw ug.create("use-before-activation",{appName:this.app.name});aB(this._delegate,e)}getToken(e){if(!this._delegate)throw ug.create("use-before-activation",{appName:this.app.name});return cB(this._delegate,e)}onTokenChanged(e,n,s){if(!this._delegate)throw ug.create("use-before-activation",{appName:this.app.name});return lB(this._delegate,e,n)}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mB=t=>{const e=t.getProvider("app-compat").getImmediate();return new gB(e)};function _B(){ut.INTERNAL.registerComponent(new Ae("appCheck-compat",mB,"PUBLIC").setServiceProps({ReCaptchaEnterpriseProvider:Df,ReCaptchaV3Provider:Fl,CustomProvider:Ul}))}_B();ut.registerVersion(dB,fB);function by(t,e){var n={};for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&e.indexOf(s)<0&&(n[s]=t[s]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,s=Object.getOwnPropertySymbols(t);r<s.length;r++)e.indexOf(s[r])<0&&Object.prototype.propertyIsEnumerable.call(t,s[r])&&(n[s[r]]=t[s[r]]);return n}const Rc={FACEBOOK:"facebook.com",GITHUB:"github.com",GOOGLE:"google.com",PASSWORD:"password",PHONE:"phone",TWITTER:"twitter.com"},Xo={EMAIL_SIGNIN:"EMAIL_SIGNIN",PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:"REVERT_SECOND_FACTOR_ADDITION",VERIFY_AND_CHANGE_EMAIL:"VERIFY_AND_CHANGE_EMAIL",VERIFY_EMAIL:"VERIFY_EMAIL"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yB(){return{["admin-restricted-operation"]:"This operation is restricted to administrators only.",["argument-error"]:"",["app-not-authorized"]:"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.",["app-not-installed"]:"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.",["captcha-check-failed"]:"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.",["code-expired"]:"The SMS code has expired. Please re-send the verification code to try again.",["cordova-not-ready"]:"Cordova framework is not ready.",["cors-unsupported"]:"This browser is not supported.",["credential-already-in-use"]:"This credential is already associated with a different user account.",["custom-token-mismatch"]:"The custom token corresponds to a different audience.",["requires-recent-login"]:"This operation is sensitive and requires recent authentication. Log in again before retrying this request.",["dependent-sdk-initialized-before-auth"]:"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK.",["dynamic-link-not-activated"]:"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.",["email-change-needs-verification"]:"Multi-factor users must always have a verified email.",["email-already-in-use"]:"The email address is already in use by another account.",["emulator-config-failed"]:'Auth instance has already been used to make a network call. Auth can no longer be configured to use the emulator. Try calling "connectAuthEmulator()" sooner.',["expired-action-code"]:"The action code has expired.",["cancelled-popup-request"]:"This operation has been cancelled due to another conflicting popup being opened.",["internal-error"]:"An internal AuthError has occurred.",["invalid-app-credential"]:"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.",["invalid-app-id"]:"The mobile app identifier is not registed for the current project.",["invalid-user-token"]:"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.",["invalid-auth-event"]:"An internal AuthError has occurred.",["invalid-verification-code"]:"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure to use the verification code provided by the user.",["invalid-continue-uri"]:"The continue URL provided in the request is invalid.",["invalid-cordova-configuration"]:"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.",["invalid-custom-token"]:"The custom token format is incorrect. Please check the documentation.",["invalid-dynamic-link-domain"]:"The provided dynamic link domain is not configured or authorized for the current project.",["invalid-email"]:"The email address is badly formatted.",["invalid-emulator-scheme"]:"Emulator URL must start with a valid scheme (http:// or https://).",["invalid-api-key"]:"Your API key is invalid, please check you have copied it correctly.",["invalid-cert-hash"]:"The SHA-1 certificate hash provided is invalid.",["invalid-credential"]:"The supplied auth credential is malformed or has expired.",["invalid-message-payload"]:"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.",["invalid-multi-factor-session"]:"The request does not contain a valid proof of first factor successful sign-in.",["invalid-oauth-provider"]:"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.",["invalid-oauth-client-id"]:"The OAuth client ID provided is either invalid or does not match the specified API key.",["unauthorized-domain"]:"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.",["invalid-action-code"]:"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.",["wrong-password"]:"The password is invalid or the user does not have a password.",["invalid-persistence-type"]:"The specified persistence type is invalid. It can only be local, session or none.",["invalid-phone-number"]:"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].",["invalid-provider-id"]:"The specified provider ID is invalid.",["invalid-recipient-email"]:"The email corresponding to this action failed to send as the provided recipient email address is invalid.",["invalid-sender"]:"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.",["invalid-verification-id"]:"The verification ID used to create the phone auth credential is invalid.",["invalid-tenant-id"]:"The Auth instance's tenant ID is invalid.",["login-blocked"]:"Login blocked by user-provided method: {$originalMessage}",["missing-android-pkg-name"]:"An Android Package Name must be provided if the Android App is required to be installed.",["auth-domain-config-required"]:"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.",["missing-app-credential"]:"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.",["missing-verification-code"]:"The phone auth credential was created with an empty SMS verification code.",["missing-continue-uri"]:"A continue URL must be provided in the request.",["missing-iframe-start"]:"An internal AuthError has occurred.",["missing-ios-bundle-id"]:"An iOS Bundle ID must be provided if an App Store ID is provided.",["missing-or-invalid-nonce"]:"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.",["missing-multi-factor-info"]:"No second factor identifier is provided.",["missing-multi-factor-session"]:"The request is missing proof of first factor successful sign-in.",["missing-phone-number"]:"To send verification codes, provide a phone number for the recipient.",["missing-verification-id"]:"The phone auth credential was created with an empty verification ID.",["app-deleted"]:"This instance of FirebaseApp has been deleted.",["multi-factor-info-not-found"]:"The user does not have a second factor matching the identifier provided.",["multi-factor-auth-required"]:"Proof of ownership of a second factor is required to complete sign-in.",["account-exists-with-different-credential"]:"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.",["network-request-failed"]:"A network AuthError (such as timeout, interrupted connection or unreachable host) has occurred.",["no-auth-event"]:"An internal AuthError has occurred.",["no-such-provider"]:"User was not linked to an account with the given provider.",["null-user"]:"A null user object was provided as the argument for an operation which requires a non-null user object.",["operation-not-allowed"]:"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.",["operation-not-supported-in-this-environment"]:'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',["popup-blocked"]:"Unable to establish a connection with the popup. It may have been blocked by the browser.",["popup-closed-by-user"]:"The popup has been closed by the user before finalizing the operation.",["provider-already-linked"]:"User can only be linked to one identity for the given provider.",["quota-exceeded"]:"The project's quota for this operation has been exceeded.",["redirect-cancelled-by-user"]:"The redirect operation has been cancelled by the user before finalizing.",["redirect-operation-pending"]:"A redirect sign-in operation is already pending.",["rejected-credential"]:"The request contains malformed or mismatching credentials.",["second-factor-already-in-use"]:"The second factor is already enrolled on this account.",["maximum-second-factor-count-exceeded"]:"The maximum allowed number of second factors on a user has been exceeded.",["tenant-id-mismatch"]:"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.",["user-token-expired"]:"The user's credential is no longer valid. The user must sign in again.",["too-many-requests"]:"We have blocked all requests from this device due to unusual activity. Try again later.",["unauthorized-continue-uri"]:"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.",["unsupported-first-factor"]:"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.",["unsupported-persistence-type"]:"The current environment does not support the specified persistence type.",["unsupported-tenant-operation"]:"This operation is not supported in a multi-tenant context.",["unverified-email"]:"The operation requires a verified email.",["user-cancelled"]:"The user did not grant your application the permissions it requested.",["user-not-found"]:"There is no user record corresponding to this identifier. The user may have been deleted.",["user-disabled"]:"The user account has been disabled by an administrator.",["user-mismatch"]:"The supplied credentials do not correspond to the previously signed in user.",["user-signed-out"]:"",["weak-password"]:"The password must be 6 characters long or more.",["web-storage-unsupported"]:"This browser is not supported or 3rd party cookies and data may be disabled.",["already-initialized"]:"initializeAuth() has already been called with different options. To avoid this error, call initializeAuth() with the same options as when it was originally called, or call getAuth() to return the already initialized instance."}}function uA(){return{["dependent-sdk-initialized-before-auth"]:"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const vB=yB,wB=uA,hA=new gn("auth","Firebase",uA());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DI=new Qs("@firebase/auth");function $h(t,...e){DI.logLevel<=ge.ERROR&&DI.error(`Auth (${Ys}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zt(t,...e){throw Iy(t,...e)}function Kt(t,...e){return Iy(t,...e)}function dA(t,e,n){const s=Object.assign(Object.assign({},wB()),{[e]:n});return new gn("auth","Firebase",s).create(e,{appName:t.name})}function ac(t,e,n){const s=n;if(!(e instanceof s))throw s.name!==e.constructor.name&&zt(t,"argument-error"),dA(t,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function Iy(t,...e){if(typeof t!="string"){const n=e[0],s=[...e.slice(1)];return s[0]&&(s[0].appName=t.name),t._errorFactory.create(n,...s)}return hA.create(t,...e)}function D(t,e,...n){if(!t)throw Iy(e,...n)}function Ns(t){const e="INTERNAL ASSERTION FAILED: "+t;throw $h(e),new Error(e)}function _s(t,e){t||Ns(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OI=new Map;function Pn(t){_s(t instanceof Function,"Expected a class definition");let e=OI.get(t);return e?(_s(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,OI.set(t,e),e)}function bB(t,e){const n=(e==null?void 0:e.persistence)||[],s=(Array.isArray(n)?n:[n]).map(Pn);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(s,e==null?void 0:e.popupRedirectResolver)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $l(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function Ey(){return MI()==="http:"||MI()==="https:"}function MI(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function IB(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(Ey()||Iu()||"connection"in navigator)?navigator.onLine:!0}function EB(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cu{constructor(e,n){this.shortDelay=e,this.longDelay=n,_s(n>e,"Short delay should be less than long delay!"),this.isMobile=Af()||Eu()}get(){return IB()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ty(t,e){_s(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fA{static initialize(e,n,s){this.fetchImpl=e,n&&(this.headersImpl=n),s&&(this.responseImpl=s)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;Ns("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;Ns("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;Ns("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TB={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"internal-error",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SB=new Cu(3e4,6e4);function yt(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function Mt(t,e,n,s,r={}){return pA(t,r,async()=>{let i={},o={};s&&(e==="GET"?o=s:i={body:JSON.stringify(s)});const a=Lo(Object.assign({key:t.config.apiKey},o)).slice(1),c=await t._getAdditionalHeaders();return c["Content-Type"]="application/json",t.languageCode&&(c["X-Firebase-Locale"]=t.languageCode),fA.fetch()(gA(t,t.config.apiHost,n,a),Object.assign({method:e,headers:c,referrerPolicy:"no-referrer"},i))})}async function pA(t,e,n){t._canInitEmulator=!1;const s=Object.assign(Object.assign({},TB),e);try{const r=new CB(t),i=await Promise.race([n(),r.promise]);r.clearNetworkTimeout();const o=await i.json();if("needConfirmation"in o)throw zc(t,"account-exists-with-different-credential",o);if(i.ok&&!("errorMessage"in o))return o;{const a=i.ok?o.errorMessage:o.error.message,[c,l]=a.split(" : ");if(c==="FEDERATED_USER_ID_ALREADY_LINKED")throw zc(t,"credential-already-in-use",o);if(c==="EMAIL_EXISTS")throw zc(t,"email-already-in-use",o);if(c==="USER_DISABLED")throw zc(t,"user-disabled",o);const u=s[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(l)throw dA(t,u,l);zt(t,u)}}catch(r){if(r instanceof et)throw r;zt(t,"network-request-failed")}}async function br(t,e,n,s,r={}){const i=await Mt(t,e,n,s,r);return"mfaPendingCredential"in i&&zt(t,"multi-factor-auth-required",{_serverResponse:i}),i}function gA(t,e,n,s){const r=`${e}${n}?${s}`;return t.config.emulator?Ty(t.config,r):`${t.config.apiScheme}://${r}`}class CB{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,s)=>{this.timer=setTimeout(()=>s(Kt(this.auth,"network-request-failed")),SB.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function zc(t,e,n){const s={appName:t.name};n.email&&(s.email=n.email),n.phoneNumber&&(s.phoneNumber=n.phoneNumber);const r=Kt(t,e,s);return r.customData._tokenResponse=n,r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function AB(t,e){return Mt(t,"POST","/v1/accounts:delete",e)}async function kB(t,e){return Mt(t,"POST","/v1/accounts:update",e)}async function RB(t,e){return Mt(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function il(t){if(!!t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function NB(t,e=!1){const n=N(t),s=await n.getIdToken(e),r=Of(s);D(r&&r.exp&&r.auth_time&&r.iat,n.auth,"internal-error");const i=typeof r.firebase=="object"?r.firebase:void 0,o=i==null?void 0:i.sign_in_provider;return{claims:r,token:s,authTime:il(hg(r.auth_time)),issuedAtTime:il(hg(r.iat)),expirationTime:il(hg(r.exp)),signInProvider:o||null,signInSecondFactor:(i==null?void 0:i.sign_in_second_factor)||null}}function hg(t){return Number(t)*1e3}function Of(t){var e;const[n,s,r]=t.split(".");if(n===void 0||s===void 0||r===void 0)return $h("JWT malformed, contained fewer than 3 sections"),null;try{const i=vm(s);return i?JSON.parse(i):($h("Failed to decode base64 JWT payload"),null)}catch(i){return $h("Caught error parsing JWT payload as JSON",(e=i)===null||e===void 0?void 0:e.toString()),null}}function PB(t){const e=Of(t);return D(e,"internal-error"),D(typeof e.exp<"u","internal-error"),D(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function gr(t,e,n=!1){if(n)return e;try{return await e}catch(s){throw s instanceof et&&xB(s)&&t.auth.currentUser===t&&await t.auth.signOut(),s}}function xB({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DB{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){!this.isRunning||(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var n;if(e){const s=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),s}else{this.errorBackoff=3e4;const r=((n=this.user.stsTokenManager.expirationTime)!==null&&n!==void 0?n:0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){var e;try{await this.user.getIdToken(!0)}catch(n){((e=n)===null||e===void 0?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mA{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=il(this.lastLoginAt),this.creationTime=il(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Vl(t){var e;const n=t.auth,s=await t.getIdToken(),r=await gr(t,RB(n,{idToken:s}));D(r==null?void 0:r.users.length,n,"internal-error");const i=r.users[0];t._notifyReloadListener(i);const o=!((e=i.providerUserInfo)===null||e===void 0)&&e.length?LB(i.providerUserInfo):[],a=MB(t.providerData,o),c=t.isAnonymous,l=!(t.email&&i.passwordHash)&&!(a!=null&&a.length),u=c?l:!1,h={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:a,metadata:new mA(i.createdAt,i.lastLoginAt),isAnonymous:u};Object.assign(t,h)}async function OB(t){const e=N(t);await Vl(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function MB(t,e){return[...t.filter(s=>!e.some(r=>r.providerId===s.providerId)),...e]}function LB(t){return t.map(e=>{var{providerId:n}=e,s=by(e,["providerId"]);return{providerId:n,uid:s.rawId||"",displayName:s.displayName||null,email:s.email||null,phoneNumber:s.phoneNumber||null,photoURL:s.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function FB(t,e){const n=await pA(t,{},async()=>{const s=Lo({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:r,apiKey:i}=t.config,o=gA(t,r,"/v1/token",`key=${i}`),a=await t._getAdditionalHeaders();return a["Content-Type"]="application/x-www-form-urlencoded",fA.fetch()(o,{method:"POST",headers:a,body:s})});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bl{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){D(e.idToken,"internal-error"),D(typeof e.idToken<"u","internal-error"),D(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):PB(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}async getToken(e,n=!1){return D(!this.accessToken||this.refreshToken,e,"user-token-expired"),!n&&this.accessToken&&!this.isExpired?this.accessToken:this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:s,refreshToken:r,expiresIn:i}=await FB(e,n);this.updateTokensAndExpiration(s,r,Number(i))}updateTokensAndExpiration(e,n,s){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+s*1e3}static fromJSON(e,n){const{refreshToken:s,accessToken:r,expirationTime:i}=n,o=new Bl;return s&&(D(typeof s=="string","internal-error",{appName:e}),o.refreshToken=s),r&&(D(typeof r=="string","internal-error",{appName:e}),o.accessToken=r),i&&(D(typeof i=="number","internal-error",{appName:e}),o.expirationTime=i),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Bl,this.toJSON())}_performRefresh(){return Ns("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xr(t,e){D(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class to{constructor(e){var{uid:n,auth:s,stsTokenManager:r}=e,i=by(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new DB(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=n,this.auth=s,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new mA(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const n=await gr(this,this.stsTokenManager.getToken(this.auth,e));return D(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return NB(this,e)}reload(){return OB(this)}_assign(e){this!==e&&(D(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>Object.assign({},n)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){return new to(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}))}_onReload(e){D(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let s=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),s=!0),n&&await Vl(this),await this.auth._persistUserIfCurrent(this),s&&this.auth._notifyListenersIfCurrent(this)}async delete(){const e=await this.getIdToken();return await gr(this,AB(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){var s,r,i,o,a,c,l,u;const h=(s=n.displayName)!==null&&s!==void 0?s:void 0,d=(r=n.email)!==null&&r!==void 0?r:void 0,f=(i=n.phoneNumber)!==null&&i!==void 0?i:void 0,p=(o=n.photoURL)!==null&&o!==void 0?o:void 0,_=(a=n.tenantId)!==null&&a!==void 0?a:void 0,y=(c=n._redirectEventId)!==null&&c!==void 0?c:void 0,T=(l=n.createdAt)!==null&&l!==void 0?l:void 0,I=(u=n.lastLoginAt)!==null&&u!==void 0?u:void 0,{uid:E,emailVerified:S,isAnonymous:H,providerData:Y,stsTokenManager:M}=n;D(E&&M,e,"internal-error");const G=Bl.fromJSON(this.name,M);D(typeof E=="string",e,"internal-error"),xr(h,e.name),xr(d,e.name),D(typeof S=="boolean",e,"internal-error"),D(typeof H=="boolean",e,"internal-error"),xr(f,e.name),xr(p,e.name),xr(_,e.name),xr(y,e.name),xr(T,e.name),xr(I,e.name);const j=new to({uid:E,auth:e,email:d,emailVerified:S,displayName:h,isAnonymous:H,photoURL:p,phoneNumber:f,tenantId:_,stsTokenManager:G,createdAt:T,lastLoginAt:I});return Y&&Array.isArray(Y)&&(j.providerData=Y.map(F=>Object.assign({},F))),y&&(j._redirectEventId=y),j}static async _fromIdTokenResponse(e,n,s=!1){const r=new Bl;r.updateFromServerResponse(n);const i=new to({uid:n.localId,auth:e,stsTokenManager:r,isAnonymous:s});return await Vl(i),i}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _A{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}_A.type="NONE";const Ma=_A;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function no(t,e,n){return`firebase:${t}:${e}:${n}`}class ya{constructor(e,n,s){this.persistence=e,this.auth=n,this.userKey=s;const{config:r,name:i}=this.auth;this.fullUserKey=no(this.userKey,r.apiKey,i),this.fullPersistenceKey=no("persistence",r.apiKey,i),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?to._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,s="authUser"){if(!n.length)return new ya(Pn(Ma),e,s);const r=(await Promise.all(n.map(async l=>{if(await l._isAvailable())return l}))).filter(l=>l);let i=r[0]||Pn(Ma);const o=no(s,e.config.apiKey,e.name);let a=null;for(const l of n)try{const u=await l._get(o);if(u){const h=to._fromJSON(e,u);l!==i&&(a=h),i=l;break}}catch{}const c=r.filter(l=>l._shouldAllowMigration);return!i._shouldAllowMigration||!c.length?new ya(i,e,s):(i=c[0],a&&await i._set(o,a.toJSON()),await Promise.all(n.map(async l=>{if(l!==i)try{await l._remove(o)}catch{}})),new ya(i,e,s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function LI(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(wA(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(yA(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(bA(e))return"Blackberry";if(IA(e))return"Webos";if(Sy(e))return"Safari";if((e.includes("chrome/")||vA(e))&&!e.includes("edge/"))return"Chrome";if(Au(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,s=t.match(n);if((s==null?void 0:s.length)===2)return s[1]}return"Other"}function yA(t=Ge()){return/firefox\//i.test(t)}function Sy(t=Ge()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function vA(t=Ge()){return/crios\//i.test(t)}function wA(t=Ge()){return/iemobile/i.test(t)}function Au(t=Ge()){return/android/i.test(t)}function bA(t=Ge()){return/blackberry/i.test(t)}function IA(t=Ge()){return/webos/i.test(t)}function cc(t=Ge()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function UB(t=Ge()){return/(iPad|iPhone|iPod).*OS 7_\d/i.test(t)||/(iPad|iPhone|iPod).*OS 8_\d/i.test(t)}function $B(t=Ge()){var e;return cc(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function VB(){return cy()&&document.documentMode===10}function EA(t=Ge()){return cc(t)||Au(t)||IA(t)||bA(t)||/windows phone/i.test(t)||wA(t)}function BB(){try{return!!(window&&window!==window.top)}catch{return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function TA(t,e=[]){let n;switch(t){case"Browser":n=LI(Ge());break;case"Worker":n=`${LI(Ge())}-${t}`;break;default:n=t}const s=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${Ys}/${s}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jB{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const s=i=>new Promise((o,a)=>{try{const c=e(i);o(c)}catch(c){a(c)}});s.onAbort=n,this.queue.push(s);const r=this.queue.length-1;return()=>{this.queue[r]=()=>Promise.resolve()}}async runMiddleware(e){var n;if(this.auth.currentUser===e)return;const s=[];try{for(const r of this.queue)await r(e),r.onAbort&&s.push(r.onAbort)}catch(r){s.reverse();for(const i of s)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:(n=r)===null||n===void 0?void 0:n.message})}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qB{constructor(e,n,s){this.app=e,this.heartbeatServiceProvider=n,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new FI(this),this.idTokenSubscription=new FI(this),this.beforeStateQueue=new jB(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=hA,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=Pn(n)),this._initializationPromise=this.queue(async()=>{var s,r;if(!this._deleted&&(this.persistenceManager=await ya.create(this,e),!this._deleted)){if(!((s=this._popupRedirectResolver)===null||s===void 0)&&s._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((r=this.currentUser)===null||r===void 0?void 0:r.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUser(e){var n;const s=await this.assertedPersistence.getCurrentUser();let r=s,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId,a=r==null?void 0:r._redirectEventId,c=await this.tryRedirectSignIn(e);(!o||o===a)&&(c==null?void 0:c.user)&&(r=c.user,i=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(r)}catch(o){r=s,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return D(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){var n;try{await Vl(e)}catch(s){if(((n=s)===null||n===void 0?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=EB()}async _delete(){this._deleted=!0}async updateCurrentUser(e){const n=e?N(e):null;return n&&D(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&D(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0)}setPersistence(e){return this.queue(async()=>{await this.assertedPersistence.setPersistence(Pn(e))})}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new gn("auth","Firebase",e())}onAuthStateChanged(e,n,s){return this.registerStateListener(this.authStateSubscription,e,n,s)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,s){return this.registerStateListener(this.idTokenSubscription,e,n,s)}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,n){const s=await this.getOrInitRedirectPersistenceManager(n);return e===null?s.removeCurrentUser():s.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&Pn(e)||this._popupRedirectResolver;D(n,this,"argument-error"),this.redirectPersistenceManager=await ya.create(this,[Pn(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,s;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)===null||n===void 0?void 0:n._redirectEventId)===e?this._currentUser:((s=this.redirectUser)===null||s===void 0?void 0:s._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const s=(n=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&n!==void 0?n:null;this.lastNotifiedUid!==s&&(this.lastNotifiedUid=s,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,s,r){if(this._deleted)return()=>{};const i=typeof n=="function"?n:n.next.bind(n),o=this._isInitialized?Promise.resolve():this._initializationPromise;return D(o,this,"internal-error"),o.then(()=>i(this.currentUser)),typeof n=="function"?e.addObserver(n,s,r):e.addObserver(n)}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&(this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh()),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return D(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=TA(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const n={["X-Client-Version"]:this.clientVersion};this.app.options.appId&&(n["X-Firebase-gmpid"]=this.app.options.appId);const s=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());return s&&(n["X-Firebase-Client"]=s),n}}function xt(t){return N(t)}class FI{constructor(e){this.auth=e,this.observer=null,this.addObserver=uC(n=>this.observer=n)}get next(){return D(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}function KB(t,e,n){const s=xt(t);D(s._canInitEmulator,s,"emulator-config-failed"),D(/^https?:\/\//.test(e),s,"invalid-emulator-scheme");const r=!!(n!=null&&n.disableWarnings),i=SA(e),{host:o,port:a}=HB(e),c=a===null?"":`:${a}`;s.config.emulator={url:`${i}//${o}${c}/`},s.settings.appVerificationDisabledForTesting=!0,s.emulatorConfig=Object.freeze({host:o,port:a,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:r})}),r||WB()}function SA(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function HB(t){const e=SA(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const s=n[2].split("@").pop()||"",r=/^(\[[^\]]+\])(:|$)/.exec(s);if(r){const i=r[1];return{host:i,port:UI(s.substr(i.length+1))}}else{const[i,o]=s.split(":");return{host:i,port:UI(o)}}}function UI(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function WB(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lc{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return Ns("not implemented")}_getIdTokenResponse(e){return Ns("not implemented")}_linkToIdToken(e,n){return Ns("not implemented")}_getReauthenticationResolver(e){return Ns("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function CA(t,e){return Mt(t,"POST","/v1/accounts:resetPassword",yt(t,e))}async function AA(t,e){return Mt(t,"POST","/v1/accounts:update",e)}async function GB(t,e){return Mt(t,"POST","/v1/accounts:update",yt(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function zB(t,e){return br(t,"POST","/v1/accounts:signInWithPassword",yt(t,e))}async function Mf(t,e){return Mt(t,"POST","/v1/accounts:sendOobCode",yt(t,e))}async function QB(t,e){return Mf(t,e)}async function YB(t,e){return Mf(t,e)}async function JB(t,e){return Mf(t,e)}async function XB(t,e){return Mf(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ZB(t,e){return br(t,"POST","/v1/accounts:signInWithEmailLink",yt(t,e))}async function ej(t,e){return br(t,"POST","/v1/accounts:signInWithEmailLink",yt(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jl extends lc{constructor(e,n,s,r=null){super("password",s),this._email=e,this._password=n,this._tenantId=r}static _fromEmailAndPassword(e,n){return new jl(e,n,"password")}static _fromEmailAndCode(e,n,s=null){return new jl(e,n,"emailLink",s)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;if((n==null?void 0:n.email)&&(n==null?void 0:n.password)){if(n.signInMethod==="password")return this._fromEmailAndPassword(n.email,n.password);if(n.signInMethod==="emailLink")return this._fromEmailAndCode(n.email,n.password,n.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":return zB(e,{returnSecureToken:!0,email:this._email,password:this._password});case"emailLink":return ZB(e,{email:this._email,oobCode:this._password});default:zt(e,"internal-error")}}async _linkToIdToken(e,n){switch(this.signInMethod){case"password":return AA(e,{idToken:n,returnSecureToken:!0,email:this._email,password:this._password});case"emailLink":return ej(e,{idToken:n,email:this._email,oobCode:this._password});default:zt(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ur(t,e){return br(t,"POST","/v1/accounts:signInWithIdp",yt(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tj="http://localhost";class Bs extends lc{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new Bs(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):zt("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:s,signInMethod:r}=n,i=by(n,["providerId","signInMethod"]);if(!s||!r)return null;const o=new Bs(s,r);return o.idToken=i.idToken||void 0,o.accessToken=i.accessToken||void 0,o.secret=i.secret,o.nonce=i.nonce,o.pendingToken=i.pendingToken||null,o}_getIdTokenResponse(e){const n=this.buildRequest();return ur(e,n)}_linkToIdToken(e,n){const s=this.buildRequest();return s.idToken=n,ur(e,s)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,ur(e,n)}buildRequest(){const e={requestUri:tj,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=Lo(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function nj(t,e){return Mt(t,"POST","/v1/accounts:sendVerificationCode",yt(t,e))}async function sj(t,e){return br(t,"POST","/v1/accounts:signInWithPhoneNumber",yt(t,e))}async function rj(t,e){const n=await br(t,"POST","/v1/accounts:signInWithPhoneNumber",yt(t,e));if(n.temporaryProof)throw zc(t,"account-exists-with-different-credential",n);return n}const ij={USER_NOT_FOUND:"user-not-found"};async function oj(t,e){const n=Object.assign(Object.assign({},e),{operation:"REAUTH"});return br(t,"POST","/v1/accounts:signInWithPhoneNumber",yt(t,n),ij)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class so extends lc{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,n){return new so({verificationId:e,verificationCode:n})}static _fromTokenResponse(e,n){return new so({phoneNumber:e,temporaryProof:n})}_getIdTokenResponse(e){return sj(e,this._makeVerificationRequest())}_linkToIdToken(e,n){return rj(e,Object.assign({idToken:n},this._makeVerificationRequest()))}_getReauthenticationResolver(e){return oj(e,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:e,phoneNumber:n,verificationId:s,verificationCode:r}=this.params;return e&&n?{temporaryProof:e,phoneNumber:n}:{sessionInfo:s,code:r}}toJSON(){const e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){typeof e=="string"&&(e=JSON.parse(e));const{verificationId:n,verificationCode:s,phoneNumber:r,temporaryProof:i}=e;return!s&&!n&&!r&&!i?null:new so({verificationId:n,verificationCode:s,phoneNumber:r,temporaryProof:i})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aj(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function cj(t){const e=la(Gc(t)).link,n=e?la(Gc(e)).deep_link_id:null,s=la(Gc(t)).deep_link_id;return(s?la(Gc(s)).link:null)||s||n||e||t}class Lf{constructor(e){var n,s,r,i,o,a;const c=la(Gc(e)),l=(n=c.apiKey)!==null&&n!==void 0?n:null,u=(s=c.oobCode)!==null&&s!==void 0?s:null,h=aj((r=c.mode)!==null&&r!==void 0?r:null);D(l&&u&&h,"argument-error"),this.apiKey=l,this.operation=h,this.code=u,this.continueUrl=(i=c.continueUrl)!==null&&i!==void 0?i:null,this.languageCode=(o=c.languageCode)!==null&&o!==void 0?o:null,this.tenantId=(a=c.tenantId)!==null&&a!==void 0?a:null}static parseLink(e){const n=cj(e);try{return new Lf(n)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gi{constructor(){this.providerId=gi.PROVIDER_ID}static credential(e,n){return jl._fromEmailAndPassword(e,n)}static credentialWithLink(e,n){const s=Lf.parseLink(n);return D(s,"argument-error"),jl._fromEmailAndCode(e,s.code,s.tenantId)}}gi.PROVIDER_ID="password";gi.EMAIL_PASSWORD_SIGN_IN_METHOD="password";gi.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ir{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uc extends Ir{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class va extends uc{static credentialFromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;return D("providerId"in n&&"signInMethod"in n,"argument-error"),Bs._fromParams(n)}credential(e){return this._credential(Object.assign(Object.assign({},e),{nonce:e.rawNonce}))}_credential(e){return D(e.idToken||e.accessToken,"argument-error"),Bs._fromParams(Object.assign(Object.assign({},e),{providerId:this.providerId,signInMethod:this.providerId}))}static credentialFromResult(e){return va.oauthCredentialFromTaggedObject(e)}static credentialFromError(e){return va.oauthCredentialFromTaggedObject(e.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:s,oauthTokenSecret:r,pendingToken:i,nonce:o,providerId:a}=e;if(!s&&!r&&!n&&!i||!a)return null;try{return new va(a)._credential({idToken:n,accessToken:s,nonce:o,pendingToken:i})}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ts extends uc{constructor(){super("facebook.com")}static credential(e){return Bs._fromParams({providerId:Ts.PROVIDER_ID,signInMethod:Ts.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ts.credentialFromTaggedObject(e)}static credentialFromError(e){return Ts.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Ts.credential(e.oauthAccessToken)}catch{return null}}}Ts.FACEBOOK_SIGN_IN_METHOD="facebook.com";Ts.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ss extends uc{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return Bs._fromParams({providerId:Ss.PROVIDER_ID,signInMethod:Ss.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return Ss.credentialFromTaggedObject(e)}static credentialFromError(e){return Ss.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:s}=e;if(!n&&!s)return null;try{return Ss.credential(n,s)}catch{return null}}}Ss.GOOGLE_SIGN_IN_METHOD="google.com";Ss.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cs extends uc{constructor(){super("github.com")}static credential(e){return Bs._fromParams({providerId:Cs.PROVIDER_ID,signInMethod:Cs.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Cs.credentialFromTaggedObject(e)}static credentialFromError(e){return Cs.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Cs.credential(e.oauthAccessToken)}catch{return null}}}Cs.GITHUB_SIGN_IN_METHOD="github.com";Cs.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lj="http://localhost";class La extends lc{constructor(e,n){super(e,e),this.pendingToken=n}_getIdTokenResponse(e){const n=this.buildRequest();return ur(e,n)}_linkToIdToken(e,n){const s=this.buildRequest();return s.idToken=n,ur(e,s)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,ur(e,n)}toJSON(){return{signInMethod:this.signInMethod,providerId:this.providerId,pendingToken:this.pendingToken}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:s,signInMethod:r,pendingToken:i}=n;return!s||!r||!i||s!==r?null:new La(s,i)}static _create(e,n){return new La(e,n)}buildRequest(){return{requestUri:lj,returnSecureToken:!0,pendingToken:this.pendingToken}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uj="saml.";class _d extends Ir{constructor(e){D(e.startsWith(uj),"argument-error"),super(e)}static credentialFromResult(e){return _d.samlCredentialFromTaggedObject(e)}static credentialFromError(e){return _d.samlCredentialFromTaggedObject(e.customData||{})}static credentialFromJSON(e){const n=La.fromJSON(e);return D(n,"argument-error"),n}static samlCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{pendingToken:n,providerId:s}=e;if(!n||!s)return null;try{return La._create(s,n)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class As extends uc{constructor(){super("twitter.com")}static credential(e,n){return Bs._fromParams({providerId:As.PROVIDER_ID,signInMethod:As.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return As.credentialFromTaggedObject(e)}static credentialFromError(e){return As.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:s}=e;if(!n||!s)return null;try{return As.credential(n,s)}catch{return null}}}As.TWITTER_SIGN_IN_METHOD="twitter.com";As.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function kA(t,e){return br(t,"POST","/v1/accounts:signUp",yt(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yn{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,s,r=!1){const i=await to._fromIdTokenResponse(e,s,r),o=$I(s);return new Yn({user:i,providerId:o,_tokenResponse:s,operationType:n})}static async _forOperation(e,n,s){await e._updateTokensIfNecessary(s,!0);const r=$I(s);return new Yn({user:e,providerId:r,_tokenResponse:s,operationType:n})}}function $I(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function hj(t){var e;const n=xt(t);if(await n._initializationPromise,!((e=n.currentUser)===null||e===void 0)&&e.isAnonymous)return new Yn({user:n.currentUser,providerId:null,operationType:"signIn"});const s=await kA(n,{returnSecureToken:!0}),r=await Yn._fromIdTokenResponse(n,"signIn",s,!0);return await n._updateCurrentUser(r.user),r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yd extends et{constructor(e,n,s,r){var i;super(n.code,n.message),this.operationType=s,this.user=r,Object.setPrototypeOf(this,yd.prototype),this.customData={appName:e.name,tenantId:(i=e.tenantId)!==null&&i!==void 0?i:void 0,_serverResponse:n.customData._serverResponse,operationType:s}}static _fromErrorAndOperation(e,n,s,r){return new yd(e,n,s,r)}}function RA(t,e,n,s){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?yd._fromErrorAndOperation(t,i,e,s):i})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NA(t){return new Set(t.map(({providerId:e})=>e).filter(e=>!!e))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function dj(t,e){const n=N(t);await Ff(!0,n,e);const{providerUserInfo:s}=await kB(n.auth,{idToken:await n.getIdToken(),deleteProvider:[e]}),r=NA(s||[]);return n.providerData=n.providerData.filter(i=>r.has(i.providerId)),r.has("phone")||(n.phoneNumber=null),await n.auth._persistUserIfCurrent(n),n}async function Cy(t,e,n=!1){const s=await gr(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return Yn._forOperation(t,"link",s)}async function Ff(t,e,n){await Vl(e);const s=NA(e.providerData),r=t===!1?"provider-already-linked":"no-such-provider";D(s.has(n)===t,e.auth,r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function PA(t,e,n=!1){var s;const{auth:r}=t,i="reauthenticate";try{const o=await gr(t,RA(r,i,e,t),n);D(o.idToken,r,"internal-error");const a=Of(o.idToken);D(a,r,"internal-error");const{sub:c}=a;return D(t.uid===c,r,"user-mismatch"),Yn._forOperation(t,i,o)}catch(o){throw((s=o)===null||s===void 0?void 0:s.code)==="auth/user-not-found"&&zt(r,"user-mismatch"),o}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function xA(t,e,n=!1){const s="signIn",r=await RA(t,s,e),i=await Yn._fromIdTokenResponse(t,s,r);return n||await t._updateCurrentUser(i.user),i}async function Uf(t,e){return xA(xt(t),e)}async function DA(t,e){const n=N(t);return await Ff(!1,n,e.providerId),Cy(n,e)}async function OA(t,e){return PA(N(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function fj(t,e){return br(t,"POST","/v1/accounts:signInWithCustomToken",yt(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function pj(t,e){const n=xt(t),s=await fj(n,{token:e,returnSecureToken:!0}),r=await Yn._fromIdTokenResponse(n,"signIn",s);return await n._updateCurrentUser(r.user),r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $f{constructor(e,n){this.factorId=e,this.uid=n.mfaEnrollmentId,this.enrollmentTime=new Date(n.enrolledAt).toUTCString(),this.displayName=n.displayName}static _fromServerResponse(e,n){return"phoneInfo"in n?Ay._fromServerResponse(e,n):zt(e,"internal-error")}}class Ay extends $f{constructor(e){super("phone",e),this.phoneNumber=e.phoneInfo}static _fromServerResponse(e,n){return new Ay(n)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vf(t,e,n){var s;D(((s=n.url)===null||s===void 0?void 0:s.length)>0,t,"invalid-continue-uri"),D(typeof n.dynamicLinkDomain>"u"||n.dynamicLinkDomain.length>0,t,"invalid-dynamic-link-domain"),e.continueUrl=n.url,e.dynamicLinkDomain=n.dynamicLinkDomain,e.canHandleCodeInApp=n.handleCodeInApp,n.iOS&&(D(n.iOS.bundleId.length>0,t,"missing-ios-bundle-id"),e.iOSBundleId=n.iOS.bundleId),n.android&&(D(n.android.packageName.length>0,t,"missing-android-pkg-name"),e.androidInstallApp=n.android.installApp,e.androidMinimumVersionCode=n.android.minimumVersion,e.androidPackageName=n.android.packageName)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function gj(t,e,n){const s=N(t),r={requestType:"PASSWORD_RESET",email:e};n&&Vf(s,r,n),await YB(s,r)}async function mj(t,e,n){await CA(N(t),{oobCode:e,newPassword:n})}async function _j(t,e){await GB(N(t),{oobCode:e})}async function MA(t,e){const n=N(t),s=await CA(n,{oobCode:e}),r=s.requestType;switch(D(r,n,"internal-error"),r){case"EMAIL_SIGNIN":break;case"VERIFY_AND_CHANGE_EMAIL":D(s.newEmail,n,"internal-error");break;case"REVERT_SECOND_FACTOR_ADDITION":D(s.mfaInfo,n,"internal-error");default:D(s.email,n,"internal-error")}let i=null;return s.mfaInfo&&(i=$f._fromServerResponse(xt(n),s.mfaInfo)),{data:{email:(s.requestType==="VERIFY_AND_CHANGE_EMAIL"?s.newEmail:s.email)||null,previousEmail:(s.requestType==="VERIFY_AND_CHANGE_EMAIL"?s.email:s.newEmail)||null,multiFactorInfo:i},operation:r}}async function yj(t,e){const{data:n}=await MA(N(t),e);return n.email}async function vj(t,e,n){const s=xt(t),r=await kA(s,{returnSecureToken:!0,email:e,password:n}),i=await Yn._fromIdTokenResponse(s,"signIn",r);return await s._updateCurrentUser(i.user),i}function wj(t,e,n){return Uf(N(t),gi.credential(e,n))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function bj(t,e,n){const s=N(t),r={requestType:"EMAIL_SIGNIN",email:e};D(n.handleCodeInApp,s,"argument-error"),n&&Vf(s,r,n),await JB(s,r)}function Ij(t,e){const n=Lf.parseLink(e);return(n==null?void 0:n.operation)==="EMAIL_SIGNIN"}async function Ej(t,e,n){const s=N(t),r=gi.credentialWithLink(e,n||$l());return D(r._tenantId===(s.tenantId||null),s,"tenant-id-mismatch"),Uf(s,r)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Tj(t,e){return Mt(t,"POST","/v1/accounts:createAuthUri",yt(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Sj(t,e){const n=Ey()?$l():"http://localhost",s={identifier:e,continueUri:n},{signinMethods:r}=await Tj(N(t),s);return r||[]}async function Cj(t,e){const n=N(t),s=await t.getIdToken(),r={requestType:"VERIFY_EMAIL",idToken:s};e&&Vf(n.auth,r,e);const{email:i}=await QB(n.auth,r);i!==t.email&&await t.reload()}async function Aj(t,e,n){const s=N(t),r=await t.getIdToken(),i={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:r,newEmail:e};n&&Vf(s.auth,i,n);const{email:o}=await XB(s.auth,i);o!==t.email&&await t.reload()}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function kj(t,e){return Mt(t,"POST","/v1/accounts:update",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Rj(t,{displayName:e,photoURL:n}){if(e===void 0&&n===void 0)return;const s=N(t),i={idToken:await s.getIdToken(),displayName:e,photoUrl:n,returnSecureToken:!0},o=await gr(s,kj(s.auth,i));s.displayName=o.displayName||null,s.photoURL=o.photoUrl||null;const a=s.providerData.find(({providerId:c})=>c==="password");a&&(a.displayName=s.displayName,a.photoURL=s.photoURL),await s._updateTokensIfNecessary(o)}function Nj(t,e){return LA(N(t),e,null)}function Pj(t,e){return LA(N(t),null,e)}async function LA(t,e,n){const{auth:s}=t,i={idToken:await t.getIdToken(),returnSecureToken:!0};e&&(i.email=e),n&&(i.password=n);const o=await gr(t,AA(s,i));await t._updateTokensIfNecessary(o,!0)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xj(t){var e,n;if(!t)return null;const{providerId:s}=t,r=t.rawUserInfo?JSON.parse(t.rawUserInfo):{},i=t.isNewUser||t.kind==="identitytoolkit#SignupNewUserResponse";if(!s&&(t==null?void 0:t.idToken)){const o=(n=(e=Of(t.idToken))===null||e===void 0?void 0:e.firebase)===null||n===void 0?void 0:n.sign_in_provider;if(o){const a=o!=="anonymous"&&o!=="custom"?o:null;return new wa(i,a)}}if(!s)return null;switch(s){case"facebook.com":return new Dj(i,r);case"github.com":return new Oj(i,r);case"google.com":return new Mj(i,r);case"twitter.com":return new Lj(i,r,t.screenName||null);case"custom":case"anonymous":return new wa(i,null);default:return new wa(i,s,r)}}class wa{constructor(e,n,s={}){this.isNewUser=e,this.providerId=n,this.profile=s}}class FA extends wa{constructor(e,n,s,r){super(e,n,s),this.username=r}}class Dj extends wa{constructor(e,n){super(e,"facebook.com",n)}}class Oj extends FA{constructor(e,n){super(e,"github.com",n,typeof(n==null?void 0:n.login)=="string"?n==null?void 0:n.login:null)}}class Mj extends wa{constructor(e,n){super(e,"google.com",n)}}class Lj extends FA{constructor(e,n,s){super(e,"twitter.com",n,s)}}function Fj(t){const{user:e,_tokenResponse:n}=t;return e.isAnonymous&&!n?{providerId:null,isNewUser:!1,profile:null}:xj(n)}class Wi{constructor(e,n){this.type=e,this.credential=n}static _fromIdtoken(e){return new Wi("enroll",e)}static _fromMfaPendingCredential(e){return new Wi("signin",e)}toJSON(){return{multiFactorSession:{[this.type==="enroll"?"idToken":"pendingCredential"]:this.credential}}}static fromJSON(e){var n,s;if(e!=null&&e.multiFactorSession){if(!((n=e.multiFactorSession)===null||n===void 0)&&n.pendingCredential)return Wi._fromMfaPendingCredential(e.multiFactorSession.pendingCredential);if(!((s=e.multiFactorSession)===null||s===void 0)&&s.idToken)return Wi._fromIdtoken(e.multiFactorSession.idToken)}return null}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ky{constructor(e,n,s){this.session=e,this.hints=n,this.signInResolver=s}static _fromError(e,n){const s=xt(e),r=n.customData._serverResponse,i=(r.mfaInfo||[]).map(a=>$f._fromServerResponse(s,a));D(r.mfaPendingCredential,s,"internal-error");const o=Wi._fromMfaPendingCredential(r.mfaPendingCredential);return new ky(o,i,async a=>{const c=await a._process(s,o);delete r.mfaInfo,delete r.mfaPendingCredential;const l=Object.assign(Object.assign({},r),{idToken:c.idToken,refreshToken:c.refreshToken});switch(n.operationType){case"signIn":const u=await Yn._fromIdTokenResponse(s,n.operationType,l);return await s._updateCurrentUser(u.user),u;case"reauthenticate":return D(n.user,s,"internal-error"),Yn._forOperation(n.user,n.operationType,l);default:zt(s,"internal-error")}})}async resolveSignIn(e){const n=e;return this.signInResolver(n)}}function Uj(t,e){var n;const s=N(t),r=e;return D(e.customData.operationType,s,"argument-error"),D((n=r.customData._serverResponse)===null||n===void 0?void 0:n.mfaPendingCredential,s,"argument-error"),ky._fromError(s,r)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $j(t,e){return Mt(t,"POST","/v2/accounts/mfaEnrollment:start",yt(t,e))}function Vj(t,e){return Mt(t,"POST","/v2/accounts/mfaEnrollment:finalize",yt(t,e))}function Bj(t,e){return Mt(t,"POST","/v2/accounts/mfaEnrollment:withdraw",yt(t,e))}class Ry{constructor(e){this.user=e,this.enrolledFactors=[],e._onReload(n=>{n.mfaInfo&&(this.enrolledFactors=n.mfaInfo.map(s=>$f._fromServerResponse(e.auth,s)))})}static _fromUser(e){return new Ry(e)}async getSession(){return Wi._fromIdtoken(await this.user.getIdToken())}async enroll(e,n){const s=e,r=await this.getSession(),i=await gr(this.user,s._process(this.user.auth,r,n));return await this.user._updateTokensIfNecessary(i),this.user.reload()}async unenroll(e){var n;const s=typeof e=="string"?e:e.uid,r=await this.user.getIdToken(),i=await gr(this.user,Bj(this.user.auth,{idToken:r,mfaEnrollmentId:s}));this.enrolledFactors=this.enrolledFactors.filter(({uid:o})=>o!==s),await this.user._updateTokensIfNecessary(i);try{await this.user.reload()}catch(o){if(((n=o)===null||n===void 0?void 0:n.code)!=="auth/user-token-expired")throw o}}}const dg=new WeakMap;function jj(t){const e=N(t);return dg.has(e)||dg.set(e,Ry._fromUser(e)),dg.get(e)}const vd="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UA{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(vd,"1"),this.storage.removeItem(vd),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qj(){const t=Ge();return Sy(t)||cc(t)}const Kj=1e3,Hj=10;class $A extends UA{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=qj()&&BB(),this.fallbackToPolling=EA(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const s=this.storage.getItem(n),r=this.localCache[n];s!==r&&e(n,r,s)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((o,a,c)=>{this.notifyListeners(o,c)});return}const s=e.key;if(n?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const o=this.storage.getItem(s);if(e.newValue!==o)e.newValue!==null?this.storage.setItem(s,e.newValue):this.storage.removeItem(s);else if(this.localCache[s]===e.newValue&&!n)return}const r=()=>{const o=this.storage.getItem(s);!n&&this.localCache[s]===o||this.notifyListeners(s,o)},i=this.storage.getItem(s);VB()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(r,Hj):r()}notifyListeners(e,n){this.localCache[e]=n;const s=this.listeners[e];if(s)for(const r of Array.from(s))r(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,s)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:s}),!0)})},Kj)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}$A.type="LOCAL";const Ny=$A;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VA extends UA{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}VA.type="SESSION";const ho=VA;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wj(t){return Promise.all(t.map(async e=>{try{const n=await e;return{fulfilled:!0,value:n}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bf{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(r=>r.isListeningto(e));if(n)return n;const s=new Bf(e);return this.receivers.push(s),s}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:s,eventType:r,data:i}=n.data,o=this.handlersMap[r];if(!(o!=null&&o.size))return;n.ports[0].postMessage({status:"ack",eventId:s,eventType:r});const a=Array.from(o).map(async l=>l(n.origin,i)),c=await Wj(a);n.ports[0].postMessage({status:"done",eventId:s,eventType:r,response:c})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Bf.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ku(t="",e=10){let n="";for(let s=0;s<e;s++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gj{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,s=50){const r=typeof MessageChannel<"u"?new MessageChannel:null;if(!r)throw new Error("connection_unavailable");let i,o;return new Promise((a,c)=>{const l=ku("",20);r.port1.start();const u=setTimeout(()=>{c(new Error("unsupported_event"))},s);o={messageChannel:r,onMessage(h){const d=h;if(d.data.eventId===l)switch(d.data.status){case"ack":clearTimeout(u),i=setTimeout(()=>{c(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),a(d.data.response);break;default:clearTimeout(u),clearTimeout(i),c(new Error("invalid_response"));break}}},this.handlers.add(o),r.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:l,data:n},[r.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ft(){return window}function zj(t){ft().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Py(){return typeof ft().WorkerGlobalScope<"u"&&typeof ft().importScripts=="function"}async function Qj(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function Yj(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function Jj(){return Py()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BA="firebaseLocalStorageDb",Xj=1,wd="firebaseLocalStorage",jA="fbase_key";class Ru{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function jf(t,e){return t.transaction([wd],e?"readwrite":"readonly").objectStore(wd)}function Zj(){const t=indexedDB.deleteDatabase(BA);return new Ru(t).toPromise()}function Am(){const t=indexedDB.open(BA,Xj);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const s=t.result;try{s.createObjectStore(wd,{keyPath:jA})}catch(r){n(r)}}),t.addEventListener("success",async()=>{const s=t.result;s.objectStoreNames.contains(wd)?e(s):(s.close(),await Zj(),e(await Am()))})})}async function VI(t,e,n){const s=jf(t,!0).put({[jA]:e,value:n});return new Ru(s).toPromise()}async function eq(t,e){const n=jf(t,!1).get(e),s=await new Ru(n).toPromise();return s===void 0?null:s.value}function BI(t,e){const n=jf(t,!0).delete(e);return new Ru(n).toPromise()}const tq=800,nq=3;class qA{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Am(),this.db)}async _withRetries(e){let n=0;for(;;)try{const s=await this._openDb();return await e(s)}catch(s){if(n++>nq)throw s;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Py()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Bf._getInstance(Jj()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var e,n;if(this.activeServiceWorker=await Qj(),!this.activeServiceWorker)return;this.sender=new Gj(this.activeServiceWorker);const s=await this.sender._send("ping",{},800);!s||((e=s[0])===null||e===void 0?void 0:e.fulfilled)&&((n=s[0])===null||n===void 0?void 0:n.value.includes("keyChanged"))&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||Yj()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Am();return await VI(e,vd,"1"),await BI(e,vd),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(s=>VI(s,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(s=>eq(s,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>BI(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(r=>{const i=jf(r,!1).getAll();return new Ru(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],s=new Set;for(const{fbase_key:r,value:i}of e)s.add(r),JSON.stringify(this.localCache[r])!==JSON.stringify(i)&&(this.notifyListeners(r,i),n.push(r));for(const r of Object.keys(this.localCache))this.localCache[r]&&!s.has(r)&&(this.notifyListeners(r,null),n.push(r));return n}notifyListeners(e,n){this.localCache[e]=n;const s=this.listeners[e];if(s)for(const r of Array.from(s))r(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),tq)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}qA.type="LOCAL";const ql=qA;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sq(t,e){return Mt(t,"POST","/v2/accounts/mfaSignIn:start",yt(t,e))}function rq(t,e){return Mt(t,"POST","/v2/accounts/mfaSignIn:finalize",yt(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function iq(t){return(await Mt(t,"GET","/v1/recaptchaParams")).recaptchaSiteKey||""}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oq(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}function KA(t){return new Promise((e,n)=>{const s=document.createElement("script");s.setAttribute("src",t),s.onload=e,s.onerror=r=>{const i=Kt("internal-error");i.customData=r,n(i)},s.type="text/javascript",s.charset="UTF-8",oq().appendChild(s)})}function HA(t){return`__${t}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aq=500,cq=6e4,ph=1e12;class lq{constructor(e){this.auth=e,this.counter=ph,this._widgets=new Map}render(e,n){const s=this.counter;return this._widgets.set(s,new uq(e,this.auth.name,n||{})),this.counter++,s}reset(e){var n;const s=e||ph;(n=this._widgets.get(s))===null||n===void 0||n.delete(),this._widgets.delete(s)}getResponse(e){var n;const s=e||ph;return((n=this._widgets.get(s))===null||n===void 0?void 0:n.getResponse())||""}async execute(e){var n;const s=e||ph;return(n=this._widgets.get(s))===null||n===void 0||n.execute(),""}}class uq{constructor(e,n,s){this.params=s,this.timerId=null,this.deleted=!1,this.responseToken=null,this.clickHandler=()=>{this.execute()};const r=typeof e=="string"?document.getElementById(e):e;D(r,"argument-error",{appName:n}),this.container=r,this.isVisible=this.params.size!=="invisible",this.isVisible?this.execute():this.container.addEventListener("click",this.clickHandler)}getResponse(){return this.checkIfDeleted(),this.responseToken}delete(){this.checkIfDeleted(),this.deleted=!0,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.container.removeEventListener("click",this.clickHandler)}execute(){this.checkIfDeleted(),!this.timerId&&(this.timerId=window.setTimeout(()=>{this.responseToken=hq(50);const{callback:e,"expired-callback":n}=this.params;if(e)try{e(this.responseToken)}catch{}this.timerId=window.setTimeout(()=>{if(this.timerId=null,this.responseToken=null,n)try{n()}catch{}this.isVisible&&this.execute()},cq)},aq))}checkIfDeleted(){if(this.deleted)throw new Error("reCAPTCHA mock was already deleted!")}}function hq(t){const e=[],n="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let s=0;s<t;s++)e.push(n.charAt(Math.floor(Math.random()*n.length)));return e.join("")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fg=HA("rcb"),dq=new Cu(3e4,6e4),fq="https://www.google.com/recaptcha/api.js?";class pq{constructor(){var e;this.hostLanguage="",this.counter=0,this.librarySeparatelyLoaded=!!(!((e=ft().grecaptcha)===null||e===void 0)&&e.render)}load(e,n=""){return D(gq(n),e,"argument-error"),this.shouldResolveImmediately(n)?Promise.resolve(ft().grecaptcha):new Promise((s,r)=>{const i=ft().setTimeout(()=>{r(Kt(e,"network-request-failed"))},dq.get());ft()[fg]=()=>{ft().clearTimeout(i),delete ft()[fg];const a=ft().grecaptcha;if(!a){r(Kt(e,"internal-error"));return}const c=a.render;a.render=(l,u)=>{const h=c(l,u);return this.counter++,h},this.hostLanguage=n,s(a)};const o=`${fq}?${Lo({onload:fg,render:"explicit",hl:n})}`;KA(o).catch(()=>{clearTimeout(i),r(Kt(e,"internal-error"))})})}clearedOneInstance(){this.counter--}shouldResolveImmediately(e){var n;return!!(!((n=ft().grecaptcha)===null||n===void 0)&&n.render)&&(e===this.hostLanguage||this.counter>0||this.librarySeparatelyLoaded)}}function gq(t){return t.length<=6&&/^\s*[a-zA-Z0-9\-]*\s*$/.test(t)}class mq{async load(e){return new lq(e)}clearedOneInstance(){}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WA="recaptcha",_q={theme:"light",type:"image"};class yq{constructor(e,n=Object.assign({},_q),s){this.parameters=n,this.type=WA,this.destroyed=!1,this.widgetId=null,this.tokenChangeListeners=new Set,this.renderPromise=null,this.recaptcha=null,this.auth=xt(s),this.isInvisible=this.parameters.size==="invisible",D(typeof document<"u",this.auth,"operation-not-supported-in-this-environment");const r=typeof e=="string"?document.getElementById(e):e;D(r,this.auth,"argument-error"),this.container=r,this.parameters.callback=this.makeTokenCallback(this.parameters.callback),this._recaptchaLoader=this.auth.settings.appVerificationDisabledForTesting?new mq:new pq,this.validateStartingState()}async verify(){this.assertNotDestroyed();const e=await this.render(),n=this.getAssertedRecaptcha(),s=n.getResponse(e);return s||new Promise(r=>{const i=o=>{!o||(this.tokenChangeListeners.delete(i),r(o))};this.tokenChangeListeners.add(i),this.isInvisible&&n.execute(e)})}render(){try{this.assertNotDestroyed()}catch(e){return Promise.reject(e)}return this.renderPromise?this.renderPromise:(this.renderPromise=this.makeRenderPromise().catch(e=>{throw this.renderPromise=null,e}),this.renderPromise)}_reset(){this.assertNotDestroyed(),this.widgetId!==null&&this.getAssertedRecaptcha().reset(this.widgetId)}clear(){this.assertNotDestroyed(),this.destroyed=!0,this._recaptchaLoader.clearedOneInstance(),this.isInvisible||this.container.childNodes.forEach(e=>{this.container.removeChild(e)})}validateStartingState(){D(!this.parameters.sitekey,this.auth,"argument-error"),D(this.isInvisible||!this.container.hasChildNodes(),this.auth,"argument-error"),D(typeof document<"u",this.auth,"operation-not-supported-in-this-environment")}makeTokenCallback(e){return n=>{if(this.tokenChangeListeners.forEach(s=>s(n)),typeof e=="function")e(n);else if(typeof e=="string"){const s=ft()[e];typeof s=="function"&&s(n)}}}assertNotDestroyed(){D(!this.destroyed,this.auth,"internal-error")}async makeRenderPromise(){if(await this.init(),!this.widgetId){let e=this.container;if(!this.isInvisible){const n=document.createElement("div");e.appendChild(n),e=n}this.widgetId=this.getAssertedRecaptcha().render(e,this.parameters)}return this.widgetId}async init(){D(Ey()&&!Py(),this.auth,"internal-error"),await vq(),this.recaptcha=await this._recaptchaLoader.load(this.auth,this.auth.languageCode||void 0);const e=await iq(this.auth);D(e,this.auth,"internal-error"),this.parameters.sitekey=e}getAssertedRecaptcha(){return D(this.recaptcha,this.auth,"internal-error"),this.recaptcha}}function vq(){let t=null;return new Promise(e=>{if(document.readyState==="complete"){e();return}t=()=>e(),window.addEventListener("load",t)}).catch(e=>{throw t&&window.removeEventListener("load",t),e})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xy{constructor(e,n){this.verificationId=e,this.onConfirmation=n}confirm(e){const n=so._fromVerification(this.verificationId,e);return this.onConfirmation(n)}}async function wq(t,e,n){const s=xt(t),r=await qf(s,e,N(n));return new xy(r,i=>Uf(s,i))}async function bq(t,e,n){const s=N(t);await Ff(!1,s,"phone");const r=await qf(s.auth,e,N(n));return new xy(r,i=>DA(s,i))}async function Iq(t,e,n){const s=N(t),r=await qf(s.auth,e,N(n));return new xy(r,i=>OA(s,i))}async function qf(t,e,n){var s;const r=await n.verify();try{D(typeof r=="string",t,"argument-error"),D(n.type===WA,t,"argument-error");let i;if(typeof e=="string"?i={phoneNumber:e}:i=e,"session"in i){const o=i.session;if("phoneNumber"in i)return D(o.type==="enroll",t,"internal-error"),(await $j(t,{idToken:o.credential,phoneEnrollmentInfo:{phoneNumber:i.phoneNumber,recaptchaToken:r}})).phoneSessionInfo.sessionInfo;{D(o.type==="signin",t,"internal-error");const a=((s=i.multiFactorHint)===null||s===void 0?void 0:s.uid)||i.multiFactorUid;return D(a,t,"missing-multi-factor-info"),(await sq(t,{mfaPendingCredential:o.credential,mfaEnrollmentId:a,phoneSignInInfo:{recaptchaToken:r}})).phoneResponseInfo.sessionInfo}}else{const{sessionInfo:o}=await nj(t,{phoneNumber:i.phoneNumber,recaptchaToken:r});return o}}finally{n._reset()}}async function Eq(t,e){await Cy(N(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ps{constructor(e){this.providerId=ps.PROVIDER_ID,this.auth=xt(e)}verifyPhoneNumber(e,n){return qf(this.auth,e,N(n))}static credential(e,n){return so._fromVerification(e,n)}static credentialFromResult(e){const n=e;return ps.credentialFromTaggedObject(n)}static credentialFromError(e){return ps.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{phoneNumber:n,temporaryProof:s}=e;return n&&s?so._fromTokenResponse(n,s):null}}ps.PROVIDER_ID="phone";ps.PHONE_SIGN_IN_METHOD="phone";/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Uo(t,e){return e?Pn(e):(D(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dy extends lc{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return ur(e,this._buildIdpRequest())}_linkToIdToken(e,n){return ur(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return ur(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function Tq(t){return xA(t.auth,new Dy(t),t.bypassAuthState)}function Sq(t){const{auth:e,user:n}=t;return D(n,e,"internal-error"),PA(n,new Dy(t),t.bypassAuthState)}async function Cq(t){const{auth:e,user:n}=t;return D(n,e,"internal-error"),Cy(n,new Dy(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GA{constructor(e,n,s,r,i=!1){this.auth=e,this.resolver=s,this.user=r,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(s){this.reject(s)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:s,postBody:r,tenantId:i,error:o,type:a}=e;if(o){this.reject(o);return}const c={auth:this.auth,requestUri:n,sessionId:s,tenantId:i||void 0,postBody:r||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(c))}catch(l){this.reject(l)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return Tq;case"linkViaPopup":case"linkViaRedirect":return Cq;case"reauthViaPopup":case"reauthViaRedirect":return Sq;default:zt(this.auth,"internal-error")}}resolve(e){_s(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){_s(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Aq=new Cu(2e3,1e4);async function kq(t,e,n){const s=xt(t);ac(t,e,Ir);const r=Uo(s,n);return new sr(s,"signInViaPopup",e,r).executeNotNull()}async function Rq(t,e,n){const s=N(t);ac(s.auth,e,Ir);const r=Uo(s.auth,n);return new sr(s.auth,"reauthViaPopup",e,r,s).executeNotNull()}async function Nq(t,e,n){const s=N(t);ac(s.auth,e,Ir);const r=Uo(s.auth,n);return new sr(s.auth,"linkViaPopup",e,r,s).executeNotNull()}class sr extends GA{constructor(e,n,s,r,i){super(e,n,r,i),this.provider=s,this.authWindow=null,this.pollId=null,sr.currentPopupAction&&sr.currentPopupAction.cancel(),sr.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return D(e,this.auth,"internal-error"),e}async onExecution(){_s(this.filter.length===1,"Popup operations only handle one event");const e=ku();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(Kt(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(Kt(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,sr.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,s;if(!((s=(n=this.authWindow)===null||n===void 0?void 0:n.window)===null||s===void 0)&&s.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Kt(this.auth,"popup-closed-by-user"))},2e3);return}this.pollId=window.setTimeout(e,Aq.get())};e()}}sr.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pq="pendingRedirect",ol=new Map;class xq extends GA{constructor(e,n,s=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,s),this.eventId=null}async execute(){let e=ol.get(this.auth._key());if(!e){try{const s=await Dq(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(s)}catch(n){e=()=>Promise.reject(n)}ol.set(this.auth._key(),e)}return this.bypassAuthState||ol.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function Dq(t,e){const n=QA(e),s=zA(t);if(!await s._isAvailable())return!1;const r=await s._get(n)==="true";return await s._remove(n),r}async function Oy(t,e){return zA(t)._set(QA(e),"true")}function Oq(){ol.clear()}function My(t,e){ol.set(t._key(),e)}function zA(t){return Pn(t._redirectPersistence)}function QA(t){return no(Pq,t.config.apiKey,t.name)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mq(t,e,n){return Lq(t,e,n)}async function Lq(t,e,n){const s=xt(t);ac(t,e,Ir);const r=Uo(s,n);return await Oy(r,s),r._openRedirect(s,e,"signInViaRedirect")}function Fq(t,e,n){return Uq(t,e,n)}async function Uq(t,e,n){const s=N(t);ac(s.auth,e,Ir);const r=Uo(s.auth,n);await Oy(r,s.auth);const i=await YA(s);return r._openRedirect(s.auth,e,"reauthViaRedirect",i)}function $q(t,e,n){return Vq(t,e,n)}async function Vq(t,e,n){const s=N(t);ac(s.auth,e,Ir);const r=Uo(s.auth,n);await Ff(!1,s,e.providerId),await Oy(r,s.auth);const i=await YA(s);return r._openRedirect(s.auth,e,"linkViaRedirect",i)}async function Bq(t,e){return await xt(t)._initializationPromise,Kf(t,e,!1)}async function Kf(t,e,n=!1){const s=xt(t),r=Uo(s,e),o=await new xq(s,r,n).execute();return o&&!n&&(delete o.user._redirectEventId,await s._persistUserIfCurrent(o.user),await s._setRedirectUser(null,e)),o}async function YA(t){const e=ku(`${t.uid}:::`);return t._redirectEventId=e,await t.auth._setRedirectUser(t),await t.auth._persistUserIfCurrent(t),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jq=10*60*1e3;class JA{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(s=>{this.isEventForConsumer(e,s)&&(n=!0,this.sendToConsumer(e,s),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!qq(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var s;if(e.error&&!XA(e)){const r=((s=e.error.code)===null||s===void 0?void 0:s.split("auth/")[1])||"internal-error";n.onError(Kt(this.auth,r))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const s=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&s}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=jq&&this.cachedEventUids.clear(),this.cachedEventUids.has(jI(e))}saveEventToCache(e){this.cachedEventUids.add(jI(e)),this.lastProcessedEventTime=Date.now()}}function jI(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function XA({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function qq(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return XA(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ZA(t,e={}){return Mt(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kq=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Hq=/^https?/;async function Wq(t){if(t.config.emulator)return;const{authorizedDomains:e}=await ZA(t);for(const n of e)try{if(Gq(n))return}catch{}zt(t,"unauthorized-domain")}function Gq(t){const e=$l(),{protocol:n,hostname:s}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&s===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&o.hostname===s}if(!Hq.test(n))return!1;if(Kq.test(t))return s===t;const r=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+r+"|"+r+")$","i").test(s)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zq=new Cu(3e4,6e4);function qI(){const t=ft().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function Qq(t){return new Promise((e,n)=>{var s,r,i;function o(){qI(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{qI(),n(Kt(t,"network-request-failed"))},timeout:zq.get()})}if(!((r=(s=ft().gapi)===null||s===void 0?void 0:s.iframes)===null||r===void 0)&&r.Iframe)e(gapi.iframes.getContext());else if(!((i=ft().gapi)===null||i===void 0)&&i.load)o();else{const a=HA("iframefcb");return ft()[a]=()=>{gapi.load?o():n(Kt(t,"network-request-failed"))},KA(`https://apis.google.com/js/api.js?onload=${a}`).catch(c=>n(c))}}).catch(e=>{throw Vh=null,e})}let Vh=null;function Yq(t){return Vh=Vh||Qq(t),Vh}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jq=new Cu(5e3,15e3),Xq="__/auth/iframe",Zq="emulator/auth/iframe",eK={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},tK=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function nK(t){const e=t.config;D(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?Ty(e,Zq):`https://${t.config.authDomain}/${Xq}`,s={apiKey:e.apiKey,appName:t.name,v:Ys},r=tK.get(t.config.apiHost);r&&(s.eid=r);const i=t._getFrameworks();return i.length&&(s.fw=i.join(",")),`${n}?${Lo(s).slice(1)}`}async function sK(t){const e=await Yq(t),n=ft().gapi;return D(n,t,"internal-error"),e.open({where:document.body,url:nK(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:eK,dontclear:!0},s=>new Promise(async(r,i)=>{await s.restyle({setHideOnLeave:!1});const o=Kt(t,"network-request-failed"),a=ft().setTimeout(()=>{i(o)},Jq.get());function c(){ft().clearTimeout(a),r(s)}s.ping(c).then(c,()=>{i(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rK={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},iK=500,oK=600,aK="_blank",cK="http://localhost";class KI{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function lK(t,e,n,s=iK,r=oK){const i=Math.max((window.screen.availHeight-r)/2,0).toString(),o=Math.max((window.screen.availWidth-s)/2,0).toString();let a="";const c=Object.assign(Object.assign({},rK),{width:s.toString(),height:r.toString(),top:i,left:o}),l=Ge().toLowerCase();n&&(a=vA(l)?aK:n),yA(l)&&(e=e||cK,c.scrollbars="yes");const u=Object.entries(c).reduce((d,[f,p])=>`${d}${f}=${p},`,"");if($B(l)&&a!=="_self")return uK(e||"",a),new KI(null);const h=window.open(e||"",a,u);D(h,t,"popup-blocked");try{h.focus()}catch{}return new KI(h)}function uK(t,e){const n=document.createElement("a");n.href=t,n.target=e;const s=document.createEvent("MouseEvent");s.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(s)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hK="__/auth/handler",dK="emulator/auth/handler";function km(t,e,n,s,r,i){D(t.config.authDomain,t,"auth-domain-config-required"),D(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:s,v:Ys,eventId:r};if(e instanceof Ir){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",cd(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[c,l]of Object.entries(i||{}))o[c]=l}if(e instanceof uc){const c=e.getScopes().filter(l=>l!=="");c.length>0&&(o.scopes=c.join(","))}t.tenantId&&(o.tid=t.tenantId);const a=o;for(const c of Object.keys(a))a[c]===void 0&&delete a[c];return`${fK(t)}?${Lo(a).slice(1)}`}function fK({config:t}){return t.emulator?Ty(t,dK):`https://${t.authDomain}/${hK}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pg="webStorageSupport";class pK{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=ho,this._completeRedirectFn=Kf,this._overrideRedirectResult=My}async _openPopup(e,n,s,r){var i;_s((i=this.eventManagers[e._key()])===null||i===void 0?void 0:i.manager,"_initialize() not called before _openPopup()");const o=km(e,n,s,$l(),r);return lK(e,o,ku())}async _openRedirect(e,n,s,r){return await this._originValidation(e),zj(km(e,n,s,$l(),r)),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:r,promise:i}=this.eventManagers[n];return r?Promise.resolve(r):(_s(i,"If manager is not set, promise should be"),i)}const s=this.initAndGetManager(e);return this.eventManagers[n]={promise:s},s.catch(()=>{delete this.eventManagers[n]}),s}async initAndGetManager(e){const n=await sK(e),s=new JA(e);return n.register("authEvent",r=>(D(r==null?void 0:r.authEvent,e,"invalid-auth-event"),{status:s.onEvent(r.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:s},this.iframes[e._key()]=n,s}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(pg,{type:pg},r=>{var i;const o=(i=r==null?void 0:r[0])===null||i===void 0?void 0:i[pg];o!==void 0&&n(!!o),zt(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=Wq(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return EA()||Sy()||cc()}}const gK=pK;class mK{constructor(e){this.factorId=e}_process(e,n,s){switch(n.type){case"enroll":return this._finalizeEnroll(e,n.credential,s);case"signin":return this._finalizeSignIn(e,n.credential);default:return Ns("unexpected MultiFactorSessionType")}}}class Ly extends mK{constructor(e){super("phone"),this.credential=e}static _fromCredential(e){return new Ly(e)}_finalizeEnroll(e,n,s){return Vj(e,{idToken:n,displayName:s,phoneVerificationInfo:this.credential._makeVerificationRequest()})}_finalizeSignIn(e,n){return rq(e,{mfaPendingCredential:n,phoneVerificationInfo:this.credential._makeVerificationRequest()})}}class ek{constructor(){}static assertion(e){return Ly._fromCredential(e)}}ek.FACTOR_ID="phone";var HI="@firebase/auth",WI="0.20.5";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _K{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(s=>{var r;e(((r=s)===null||r===void 0?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);!n||(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){D(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yK(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";default:return}}function vK(t){rt(new Ae("auth",(e,{options:n})=>{const s=e.getProvider("app").getImmediate(),r=e.getProvider("heartbeat"),{apiKey:i,authDomain:o}=s.options;return((a,c)=>{D(i&&!i.includes(":"),"invalid-api-key",{appName:a.name}),D(!(o!=null&&o.includes(":")),"argument-error",{appName:a.name});const l={apiKey:i,authDomain:o,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:TA(t)},u=new qB(a,c,l);return bB(u,n),u})(s,r)},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,s)=>{e.getProvider("auth-internal").initialize()})),rt(new Ae("auth-internal",e=>{const n=xt(e.getProvider("auth").getImmediate());return(s=>new _K(s))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),$e(HI,WI,yK(t)),$e(HI,WI,"esm2017")}vK("Browser");/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fo(){return window}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wK=2e3;async function bK(t,e,n){var s;const{BuildInfo:r}=fo();_s(e.sessionId,"AuthEvent did not contain a session ID");const i=await CK(e.sessionId),o={};return cc()?o.ibi=r.packageName:Au()?o.apn=r.packageName:zt(t,"operation-not-supported-in-this-environment"),r.displayName&&(o.appDisplayName=r.displayName),o.sessionId=i,km(t,n,e.type,void 0,(s=e.eventId)!==null&&s!==void 0?s:void 0,o)}async function IK(t){const{BuildInfo:e}=fo(),n={};cc()?n.iosBundleId=e.packageName:Au()?n.androidPackageName=e.packageName:zt(t,"operation-not-supported-in-this-environment"),await ZA(t,n)}function EK(t){const{cordova:e}=fo();return new Promise(n=>{e.plugins.browsertab.isAvailable(s=>{let r=null;s?e.plugins.browsertab.openUrl(t):r=e.InAppBrowser.open(t,UB()?"_blank":"_system","location=yes"),n(r)})})}async function TK(t,e,n){const{cordova:s}=fo();let r=()=>{};try{await new Promise((i,o)=>{let a=null;function c(){var h;i();const d=(h=s.plugins.browsertab)===null||h===void 0?void 0:h.close;typeof d=="function"&&d(),typeof(n==null?void 0:n.close)=="function"&&n.close()}function l(){a||(a=window.setTimeout(()=>{o(Kt(t,"redirect-cancelled-by-user"))},wK))}function u(){(document==null?void 0:document.visibilityState)==="visible"&&l()}e.addPassiveListener(c),document.addEventListener("resume",l,!1),Au()&&document.addEventListener("visibilitychange",u,!1),r=()=>{e.removePassiveListener(c),document.removeEventListener("resume",l,!1),document.removeEventListener("visibilitychange",u,!1),a&&window.clearTimeout(a)}})}finally{r()}}function SK(t){var e,n,s,r,i,o,a,c,l,u;const h=fo();D(typeof((e=h==null?void 0:h.universalLinks)===null||e===void 0?void 0:e.subscribe)=="function",t,"invalid-cordova-configuration",{missingPlugin:"cordova-universal-links-plugin-fix"}),D(typeof((n=h==null?void 0:h.BuildInfo)===null||n===void 0?void 0:n.packageName)<"u",t,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-buildInfo"}),D(typeof((i=(r=(s=h==null?void 0:h.cordova)===null||s===void 0?void 0:s.plugins)===null||r===void 0?void 0:r.browsertab)===null||i===void 0?void 0:i.openUrl)=="function",t,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),D(typeof((c=(a=(o=h==null?void 0:h.cordova)===null||o===void 0?void 0:o.plugins)===null||a===void 0?void 0:a.browsertab)===null||c===void 0?void 0:c.isAvailable)=="function",t,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),D(typeof((u=(l=h==null?void 0:h.cordova)===null||l===void 0?void 0:l.InAppBrowser)===null||u===void 0?void 0:u.open)=="function",t,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-inappbrowser"})}async function CK(t){const e=AK(t),n=await crypto.subtle.digest("SHA-256",e);return Array.from(new Uint8Array(n)).map(r=>r.toString(16).padStart(2,"0")).join("")}function AK(t){if(_s(/[0-9a-zA-Z]+/.test(t),"Can only convert alpha-numeric strings"),typeof TextEncoder<"u")return new TextEncoder().encode(t);const e=new ArrayBuffer(t.length),n=new Uint8Array(e);for(let s=0;s<t.length;s++)n[s]=t.charCodeAt(s);return n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kK=20;class RK extends JA{constructor(){super(...arguments),this.passiveListeners=new Set,this.initPromise=new Promise(e=>{this.resolveInialized=e})}addPassiveListener(e){this.passiveListeners.add(e)}removePassiveListener(e){this.passiveListeners.delete(e)}resetRedirect(){this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1}onEvent(e){return this.resolveInialized(),this.passiveListeners.forEach(n=>n(e)),super.onEvent(e)}async initialized(){await this.initPromise}}function NK(t,e,n=null){return{type:e,eventId:n,urlResponse:null,sessionId:DK(),postBody:null,tenantId:t.tenantId,error:Kt(t,"no-auth-event")}}function PK(t,e){return Rm()._set(Nm(t),e)}async function GI(t){const e=await Rm()._get(Nm(t));return e&&await Rm()._remove(Nm(t)),e}function xK(t,e){var n,s;const r=MK(e);if(r.includes("/__/auth/callback")){const i=Bh(r),o=i.firebaseError?OK(decodeURIComponent(i.firebaseError)):null,a=(s=(n=o==null?void 0:o.code)===null||n===void 0?void 0:n.split("auth/"))===null||s===void 0?void 0:s[1],c=a?Kt(a):null;return c?{type:t.type,eventId:t.eventId,tenantId:t.tenantId,error:c,urlResponse:null,sessionId:null,postBody:null}:{type:t.type,eventId:t.eventId,tenantId:t.tenantId,sessionId:t.sessionId,urlResponse:r,postBody:null}}return null}function DK(){const t=[],e="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let n=0;n<kK;n++){const s=Math.floor(Math.random()*e.length);t.push(e.charAt(s))}return t.join("")}function Rm(){return Pn(Ny)}function Nm(t){return no("authEvent",t.config.apiKey,t.name)}function OK(t){try{return JSON.parse(t)}catch{return null}}function MK(t){const e=Bh(t),n=e.link?decodeURIComponent(e.link):void 0,s=Bh(n).link,r=e.deep_link_id?decodeURIComponent(e.deep_link_id):void 0;return Bh(r).link||r||s||n||t}function Bh(t){if(!(t!=null&&t.includes("?")))return{};const[e,...n]=t.split("?");return la(n.join("?"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LK=500;class FK{constructor(){this._redirectPersistence=ho,this._shouldInitProactively=!0,this.eventManagers=new Map,this.originValidationPromises={},this._completeRedirectFn=Kf,this._overrideRedirectResult=My}async _initialize(e){const n=e._key();let s=this.eventManagers.get(n);return s||(s=new RK(e),this.eventManagers.set(n,s),this.attachCallbackListeners(e,s)),s}_openPopup(e){zt(e,"operation-not-supported-in-this-environment")}async _openRedirect(e,n,s,r){SK(e);const i=await this._initialize(e);await i.initialized(),i.resetRedirect(),Oq(),await this._originValidation(e);const o=NK(e,s,r);await PK(e,o);const a=await bK(e,o,n),c=await EK(a);return TK(e,i,c)}_isIframeWebStorageSupported(e,n){throw new Error("Method not implemented.")}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=IK(e)),this.originValidationPromises[n]}attachCallbackListeners(e,n){const{universalLinks:s,handleOpenURL:r,BuildInfo:i}=fo(),o=setTimeout(async()=>{await GI(e),n.onEvent(zI())},LK),a=async u=>{clearTimeout(o);const h=await GI(e);let d=null;h&&(u==null?void 0:u.url)&&(d=xK(h,u.url)),n.onEvent(d||zI())};typeof s<"u"&&typeof s.subscribe=="function"&&s.subscribe(null,a);const c=r,l=`${i.packageName.toLowerCase()}://`;fo().handleOpenURL=async u=>{if(u.toLowerCase().startsWith(l)&&a({url:u}),typeof c=="function")try{c(u)}catch(h){console.error(h)}}}}const UK=FK;function zI(){return{type:"unknown",eventId:null,sessionId:null,urlResponse:null,postBody:null,tenantId:null,error:Kt("no-auth-event")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $K(t,e){xt(t)._logFramework(e)}var VK="@firebase/auth-compat",BK="0.2.18";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jK=1e3;function al(){var t;return((t=self==null?void 0:self.location)===null||t===void 0?void 0:t.protocol)||null}function qK(){return al()==="http:"||al()==="https:"}function tk(t=Ge()){return!!((al()==="file:"||al()==="ionic:"||al()==="capacitor:")&&t.toLowerCase().match(/iphone|ipad|ipod|android/))}function KK(){return Eu()||ay()}function HK(){return cy()&&(document==null?void 0:document.documentMode)===11}function WK(t=Ge()){return/Edge\/\d+/.test(t)}function GK(t=Ge()){return HK()||WK(t)}function nk(){try{const t=self.localStorage,e=ku();if(t)return t.setItem(e,"1"),t.removeItem(e),GK()?En():!0}catch{return Fy()&&En()}return!1}function Fy(){return typeof global<"u"&&"WorkerGlobalScope"in global&&"importScripts"in global}function gg(){return(qK()||Iu()||tk())&&!KK()&&nk()&&!Fy()}function sk(){return tk()&&typeof document<"u"}async function zK(){return sk()?new Promise(t=>{const e=setTimeout(()=>{t(!1)},jK);document.addEventListener("deviceready",()=>{clearTimeout(e),t(!0)})}):!1}function QK(){return typeof window<"u"?window:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kn={LOCAL:"local",NONE:"none",SESSION:"session"},Nc=D,rk="persistence";function YK(t,e){if(Nc(Object.values(kn).includes(e),t,"invalid-persistence-type"),Eu()){Nc(e!==kn.SESSION,t,"unsupported-persistence-type");return}if(ay()){Nc(e===kn.NONE,t,"unsupported-persistence-type");return}if(Fy()){Nc(e===kn.NONE||e===kn.LOCAL&&En(),t,"unsupported-persistence-type");return}Nc(e===kn.NONE||nk(),t,"unsupported-persistence-type")}async function Pm(t){await t._initializationPromise;const e=ik(),n=no(rk,t.config.apiKey,t.name);e&&e.setItem(n,t._getPersistence())}function JK(t,e){const n=ik();if(!n)return[];const s=no(rk,t,e);switch(n.getItem(s)){case kn.NONE:return[Ma];case kn.LOCAL:return[ql,ho];case kn.SESSION:return[ho];default:return[]}}function ik(){var t;try{return((t=QK())===null||t===void 0?void 0:t.sessionStorage)||null}catch{return null}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XK=D;class jr{constructor(){this.browserResolver=Pn(gK),this.cordovaResolver=Pn(UK),this.underlyingResolver=null,this._redirectPersistence=ho,this._completeRedirectFn=Kf,this._overrideRedirectResult=My}async _initialize(e){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._initialize(e)}async _openPopup(e,n,s,r){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._openPopup(e,n,s,r)}async _openRedirect(e,n,s,r){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._openRedirect(e,n,s,r)}_isIframeWebStorageSupported(e,n){this.assertedUnderlyingResolver._isIframeWebStorageSupported(e,n)}_originValidation(e){return this.assertedUnderlyingResolver._originValidation(e)}get _shouldInitProactively(){return sk()||this.browserResolver._shouldInitProactively}get assertedUnderlyingResolver(){return XK(this.underlyingResolver,"internal-error"),this.underlyingResolver}async selectUnderlyingResolver(){if(this.underlyingResolver)return;const e=await zK();this.underlyingResolver=e?this.cordovaResolver:this.browserResolver}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ok(t){return t.unwrap()}function ZK(t){return t.wrapped()}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eH(t){return ak(t)}function tH(t,e){var n,s;const r=(n=e.customData)===null||n===void 0?void 0:n._tokenResponse;if(((s=e)===null||s===void 0?void 0:s.code)==="auth/multi-factor-auth-required"){const i=e;i.resolver=new nH(t,Uj(t,e))}else if(r){const i=ak(e),o=e;i&&(o.credential=i,o.tenantId=r.tenantId||void 0,o.email=r.email||void 0,o.phoneNumber=r.phoneNumber||void 0)}}function ak(t){const{_tokenResponse:e}=t instanceof et?t.customData:t;if(!e)return null;if(!(t instanceof et)&&"temporaryProof"in e&&"phoneNumber"in e)return ps.credentialFromResult(t);const n=e.providerId;if(!n||n===Rc.PASSWORD)return null;let s;switch(n){case Rc.GOOGLE:s=Ss;break;case Rc.FACEBOOK:s=Ts;break;case Rc.GITHUB:s=Cs;break;case Rc.TWITTER:s=As;break;default:const{oauthIdToken:r,oauthAccessToken:i,oauthTokenSecret:o,pendingToken:a,nonce:c}=e;return!i&&!o&&!r&&!a?null:a?n.startsWith("saml.")?La._create(n,a):Bs._fromParams({providerId:n,signInMethod:n,pendingToken:a,idToken:r,accessToken:i}):new va(n).credential({idToken:r,accessToken:i,rawNonce:c})}return t instanceof et?s.credentialFromError(t):s.credentialFromResult(t)}function mn(t,e){return e.catch(n=>{throw n instanceof et&&tH(t,n),n}).then(n=>{const s=n.operationType,r=n.user;return{operationType:s,credential:eH(n),additionalUserInfo:Fj(n),user:rr.getOrCreate(r)}})}async function xm(t,e){const n=await e;return{verificationId:n.verificationId,confirm:s=>mn(t,n.confirm(s))}}class nH{constructor(e,n){this.resolver=n,this.auth=ZK(e)}get session(){return this.resolver.session}get hints(){return this.resolver.hints}resolveSignIn(e){return mn(ok(this.auth),this.resolver.resolveSignIn(e))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rr{constructor(e){this._delegate=e,this.multiFactor=jj(e)}static getOrCreate(e){return rr.USER_MAP.has(e)||rr.USER_MAP.set(e,new rr(e)),rr.USER_MAP.get(e)}delete(){return this._delegate.delete()}reload(){return this._delegate.reload()}toJSON(){return this._delegate.toJSON()}getIdTokenResult(e){return this._delegate.getIdTokenResult(e)}getIdToken(e){return this._delegate.getIdToken(e)}linkAndRetrieveDataWithCredential(e){return this.linkWithCredential(e)}async linkWithCredential(e){return mn(this.auth,DA(this._delegate,e))}async linkWithPhoneNumber(e,n){return xm(this.auth,bq(this._delegate,e,n))}async linkWithPopup(e){return mn(this.auth,Nq(this._delegate,e,jr))}async linkWithRedirect(e){return await Pm(xt(this.auth)),$q(this._delegate,e,jr)}reauthenticateAndRetrieveDataWithCredential(e){return this.reauthenticateWithCredential(e)}async reauthenticateWithCredential(e){return mn(this.auth,OA(this._delegate,e))}reauthenticateWithPhoneNumber(e,n){return xm(this.auth,Iq(this._delegate,e,n))}reauthenticateWithPopup(e){return mn(this.auth,Rq(this._delegate,e,jr))}async reauthenticateWithRedirect(e){return await Pm(xt(this.auth)),Fq(this._delegate,e,jr)}sendEmailVerification(e){return Cj(this._delegate,e)}async unlink(e){return await dj(this._delegate,e),this}updateEmail(e){return Nj(this._delegate,e)}updatePassword(e){return Pj(this._delegate,e)}updatePhoneNumber(e){return Eq(this._delegate,e)}updateProfile(e){return Rj(this._delegate,e)}verifyBeforeUpdateEmail(e,n){return Aj(this._delegate,e,n)}get emailVerified(){return this._delegate.emailVerified}get isAnonymous(){return this._delegate.isAnonymous}get metadata(){return this._delegate.metadata}get phoneNumber(){return this._delegate.phoneNumber}get providerData(){return this._delegate.providerData}get refreshToken(){return this._delegate.refreshToken}get tenantId(){return this._delegate.tenantId}get displayName(){return this._delegate.displayName}get email(){return this._delegate.email}get photoURL(){return this._delegate.photoURL}get providerId(){return this._delegate.providerId}get uid(){return this._delegate.uid}get auth(){return this._delegate.auth}}rr.USER_MAP=new WeakMap;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pc=D;class Dm{constructor(e,n){if(this.app=e,n.isInitialized()){this._delegate=n.getImmediate(),this.linkUnderlyingAuth();return}const{apiKey:s}=e.options;Pc(s,"invalid-api-key",{appName:e.name}),Pc(s,"invalid-api-key",{appName:e.name});const r=typeof window<"u"?jr:void 0;this._delegate=n.initialize({options:{persistence:sH(s,e.name),popupRedirectResolver:r}}),this._delegate._updateErrorMap(vB),this.linkUnderlyingAuth()}get emulatorConfig(){return this._delegate.emulatorConfig}get currentUser(){return this._delegate.currentUser?rr.getOrCreate(this._delegate.currentUser):null}get languageCode(){return this._delegate.languageCode}set languageCode(e){this._delegate.languageCode=e}get settings(){return this._delegate.settings}get tenantId(){return this._delegate.tenantId}set tenantId(e){this._delegate.tenantId=e}useDeviceLanguage(){this._delegate.useDeviceLanguage()}signOut(){return this._delegate.signOut()}useEmulator(e,n){KB(this._delegate,e,n)}applyActionCode(e){return _j(this._delegate,e)}checkActionCode(e){return MA(this._delegate,e)}confirmPasswordReset(e,n){return mj(this._delegate,e,n)}async createUserWithEmailAndPassword(e,n){return mn(this._delegate,vj(this._delegate,e,n))}fetchProvidersForEmail(e){return this.fetchSignInMethodsForEmail(e)}fetchSignInMethodsForEmail(e){return Sj(this._delegate,e)}isSignInWithEmailLink(e){return Ij(this._delegate,e)}async getRedirectResult(){Pc(gg(),this._delegate,"operation-not-supported-in-this-environment");const e=await Bq(this._delegate,jr);return e?mn(this._delegate,Promise.resolve(e)):{credential:null,user:null}}addFrameworkForLogging(e){$K(this._delegate,e)}onAuthStateChanged(e,n,s){const{next:r,error:i,complete:o}=QI(e,n,s);return this._delegate.onAuthStateChanged(r,i,o)}onIdTokenChanged(e,n,s){const{next:r,error:i,complete:o}=QI(e,n,s);return this._delegate.onIdTokenChanged(r,i,o)}sendSignInLinkToEmail(e,n){return bj(this._delegate,e,n)}sendPasswordResetEmail(e,n){return gj(this._delegate,e,n||void 0)}async setPersistence(e){YK(this._delegate,e);let n;switch(e){case kn.SESSION:n=ho;break;case kn.LOCAL:n=await Pn(ql)._isAvailable()?ql:Ny;break;case kn.NONE:n=Ma;break;default:return zt("argument-error",{appName:this._delegate.name})}return this._delegate.setPersistence(n)}signInAndRetrieveDataWithCredential(e){return this.signInWithCredential(e)}signInAnonymously(){return mn(this._delegate,hj(this._delegate))}signInWithCredential(e){return mn(this._delegate,Uf(this._delegate,e))}signInWithCustomToken(e){return mn(this._delegate,pj(this._delegate,e))}signInWithEmailAndPassword(e,n){return mn(this._delegate,wj(this._delegate,e,n))}signInWithEmailLink(e,n){return mn(this._delegate,Ej(this._delegate,e,n))}signInWithPhoneNumber(e,n){return xm(this._delegate,wq(this._delegate,e,n))}async signInWithPopup(e){return Pc(gg(),this._delegate,"operation-not-supported-in-this-environment"),mn(this._delegate,kq(this._delegate,e,jr))}async signInWithRedirect(e){return Pc(gg(),this._delegate,"operation-not-supported-in-this-environment"),await Pm(this._delegate),Mq(this._delegate,e,jr)}updateCurrentUser(e){return this._delegate.updateCurrentUser(e)}verifyPasswordResetCode(e){return yj(this._delegate,e)}unwrap(){return this._delegate}_delete(){return this._delegate._delete()}linkUnderlyingAuth(){this._delegate.wrapped=()=>this}}Dm.Persistence=kn;function QI(t,e,n){let s=t;typeof t!="function"&&({next:s,error:e,complete:n}=t);const r=s;return{next:o=>r(o&&rr.getOrCreate(o)),error:e,complete:n}}function sH(t,e){const n=JK(t,e);if(typeof self<"u"&&!n.includes(ql)&&n.push(ql),typeof window<"u")for(const s of[Ny,ho])n.includes(s)||n.push(s);return n.includes(Ma)||n.push(Ma),n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uy{constructor(){this.providerId="phone",this._delegate=new ps(ok(ut.auth()))}static credential(e,n){return ps.credential(e,n)}verifyPhoneNumber(e,n){return this._delegate.verifyPhoneNumber(e,n)}unwrap(){return this._delegate}}Uy.PHONE_SIGN_IN_METHOD=ps.PHONE_SIGN_IN_METHOD;Uy.PROVIDER_ID=ps.PROVIDER_ID;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rH=D;class iH{constructor(e,n,s=ut.app()){var r;rH((r=s.options)===null||r===void 0?void 0:r.apiKey,"invalid-api-key",{appName:s.name}),this._delegate=new yq(e,n,s.auth()),this.type=this._delegate.type}clear(){this._delegate.clear()}render(){return this._delegate.render()}verify(){return this._delegate.verify()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oH="auth-compat";function aH(t){t.INTERNAL.registerComponent(new Ae(oH,e=>{const n=e.getProvider("app-compat").getImmediate(),s=e.getProvider("auth");return new Dm(n,s)},"PUBLIC").setServiceProps({ActionCodeInfo:{Operation:{EMAIL_SIGNIN:Xo.EMAIL_SIGNIN,PASSWORD_RESET:Xo.PASSWORD_RESET,RECOVER_EMAIL:Xo.RECOVER_EMAIL,REVERT_SECOND_FACTOR_ADDITION:Xo.REVERT_SECOND_FACTOR_ADDITION,VERIFY_AND_CHANGE_EMAIL:Xo.VERIFY_AND_CHANGE_EMAIL,VERIFY_EMAIL:Xo.VERIFY_EMAIL}},EmailAuthProvider:gi,FacebookAuthProvider:Ts,GithubAuthProvider:Cs,GoogleAuthProvider:Ss,OAuthProvider:va,SAMLAuthProvider:_d,PhoneAuthProvider:Uy,PhoneMultiFactorGenerator:ek,RecaptchaVerifier:iH,TwitterAuthProvider:As,Auth:Dm,AuthCredential:lc,Error:et}).setInstantiationMode("LAZY").setMultipleInstances(!1)),t.registerVersion(VK,BK)}aH(ut);const YI="@firebase/database",JI="0.13.4";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ck="";function lk(t){ck=t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cH{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,n){n==null?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),gt(n))}get(e){const n=this.domStorage_.getItem(this.prefixedName_(e));return n==null?null:xl(n)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lH{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,n){n==null?delete this.cache_[e]:this.cache_[e]=n}get(e){return Mn(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uk=function(t){try{if(typeof window<"u"&&typeof window[t]<"u"){const e=window[t];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new cH(e)}}catch{}return new lH},Gi=uk("localStorage"),Om=uk("sessionStorage");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ba=new Qs("@firebase/database"),hk=function(){let t=1;return function(){return t++}}(),dk=function(t){const e=NF(t),n=new AF;n.update(e);const s=n.digest();return Cf.encodeByteArray(s)},Nu=function(...t){let e="";for(let n=0;n<t.length;n++){const s=t[n];Array.isArray(s)||s&&typeof s=="object"&&typeof s.length=="number"?e+=Nu.apply(null,s):typeof s=="object"?e+=gt(s):e+=s,e+=" "}return e};let ro=null,XI=!0;const fk=function(t,e){O(!e||t===!0||t===!1,"Can't turn on custom loggers persistently."),t===!0?(ba.logLevel=ge.VERBOSE,ro=ba.log.bind(ba),e&&Om.set("logging_enabled",!0)):typeof t=="function"?ro=t:(ro=null,Om.remove("logging_enabled"))},Ct=function(...t){if(XI===!0&&(XI=!1,ro===null&&Om.get("logging_enabled")===!0&&fk(!0)),ro){const e=Nu.apply(null,t);ro(e)}},Pu=function(t){return function(...e){Ct(t,...e)}},Mm=function(...t){const e="FIREBASE INTERNAL ERROR: "+Nu(...t);ba.error(e)},js=function(...t){const e=`FIREBASE FATAL ERROR: ${Nu(...t)}`;throw ba.error(e),new Error(e)},Zt=function(...t){const e="FIREBASE WARNING: "+Nu(...t);ba.warn(e)},uH=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&Zt("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},Hf=function(t){return typeof t=="number"&&(t!==t||t===Number.POSITIVE_INFINITY||t===Number.NEGATIVE_INFINITY)},hH=function(t){if(document.readyState==="complete")t();else{let e=!1;const n=function(){if(!document.body){setTimeout(n,Math.floor(10));return}e||(e=!0,t())};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&n()}),window.attachEvent("onload",n))}},mr="[MIN_NAME]",qs="[MAX_NAME]",$o=function(t,e){if(t===e)return 0;if(t===mr||e===qs)return-1;if(e===mr||t===qs)return 1;{const n=bd(t),s=bd(e);return n!==null?s!==null?n-s===0?t.length-e.length:n-s:-1:s!==null?1:t<e?-1:1}},dH=function(t,e){return t===e?0:t<e?-1:1},xc=function(t,e){if(e&&t in e)return e[t];throw new Error("Missing required key ("+t+") in object: "+gt(e))},$y=function(t){if(typeof t!="object"||t===null)return gt(t);const e=[];for(const s in t)e.push(s);e.sort();let n="{";for(let s=0;s<e.length;s++)s!==0&&(n+=","),n+=gt(e[s]),n+=":",n+=$y(t[e[s]]);return n+="}",n},pk=function(t,e){const n=t.length;if(n<=e)return[t];const s=[];for(let r=0;r<n;r+=e)r+e>n?s.push(t.substring(r,n)):s.push(t.substring(r,r+e));return s};function Dt(t,e){for(const n in t)t.hasOwnProperty(n)&&e(n,t[n])}const gk=function(t){O(!Hf(t),"Invalid JSON number");const e=11,n=52,s=(1<<e-1)-1;let r,i,o,a,c;t===0?(i=0,o=0,r=1/t===-1/0?1:0):(r=t<0,t=Math.abs(t),t>=Math.pow(2,1-s)?(a=Math.min(Math.floor(Math.log(t)/Math.LN2),s),i=a+s,o=Math.round(t*Math.pow(2,n-a)-Math.pow(2,n))):(i=0,o=Math.round(t/Math.pow(2,1-s-n))));const l=[];for(c=n;c;c-=1)l.push(o%2?1:0),o=Math.floor(o/2);for(c=e;c;c-=1)l.push(i%2?1:0),i=Math.floor(i/2);l.push(r?1:0),l.reverse();const u=l.join("");let h="";for(c=0;c<64;c+=8){let d=parseInt(u.substr(c,8),2).toString(16);d.length===1&&(d="0"+d),h=h+d}return h.toLowerCase()},fH=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},pH=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};function gH(t,e){let n="Unknown Error";t==="too_big"?n="The data requested exceeds the maximum size that can be accessed with a single request.":t==="permission_denied"?n="Client doesn't have permission to access the desired data.":t==="unavailable"&&(n="The service is unavailable");const s=new Error(t+" at "+e._path.toString()+": "+n);return s.code=t.toUpperCase(),s}const mH=new RegExp("^-?(0*)\\d{1,10}$"),mk=-2147483648,Vy=2147483647,bd=function(t){if(mH.test(t)){const e=Number(t);if(e>=mk&&e<=Vy)return e}return null},hc=function(t){try{t()}catch(e){setTimeout(()=>{const n=e.stack||"";throw Zt("Exception was thrown by user callback.",n),e},Math.floor(0))}},_H=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},cl=function(t,e){const n=setTimeout(t,e);return typeof n=="object"&&n.unref&&n.unref(),n};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yH{constructor(e,n){this.appName_=e,this.appCheckProvider=n,this.appCheck=n==null?void 0:n.getImmediate({optional:!0}),this.appCheck||n==null||n.get().then(s=>this.appCheck=s)}getToken(e){return this.appCheck?this.appCheck.getToken(e):new Promise((n,s)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(n,s):n(null)},0)})}addTokenChangeListener(e){var n;(n=this.appCheckProvider)===null||n===void 0||n.get().then(s=>s.addTokenListener(e))}notifyForInvalidToken(){Zt(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vH{constructor(e,n,s){this.appName_=e,this.firebaseOptions_=n,this.authProvider_=s,this.auth_=null,this.auth_=s.getImmediate({optional:!0}),this.auth_||s.onInit(r=>this.auth_=r)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(n=>n&&n.code==="auth/token-not-initialized"?(Ct("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(n)):new Promise((n,s)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(n,s):n(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(n=>n.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(n=>n.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',Zt(e)}}class Ia{constructor(e){this.accessToken=e}getToken(e){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(e){e(this.accessToken)}removeTokenChangeListener(e){}notifyForInvalidToken(){}}Ia.OWNER="owner";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const By="5",_k="v",yk="s",vk="r",wk="f",bk=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,Ik="ls",Ek="p",Lm="ac",Tk="websocket",Sk="long_polling";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ck{constructor(e,n,s,r,i=!1,o="",a=!1){this.secure=n,this.namespace=s,this.webSocketOnly=r,this.nodeAdmin=i,this.persistenceKey=o,this.includeNamespaceInQueryParams=a,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=Gi.get("host:"+e)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&Gi.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){const e=this.secure?"https://":"http://",n=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${n}`}}function wH(t){return t.host!==t.internalHost||t.isCustomHost()||t.includeNamespaceInQueryParams}function Ak(t,e,n){O(typeof e=="string","typeof type must == string"),O(typeof n=="object","typeof params must == object");let s;if(e===Tk)s=(t.secure?"wss://":"ws://")+t.internalHost+"/.ws?";else if(e===Sk)s=(t.secure?"https://":"http://")+t.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+e);wH(t)&&(n.ns=t.namespace);const r=[];return Dt(n,(i,o)=>{r.push(i+"="+o)}),s+r.join("&")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bH{constructor(){this.counters_={}}incrementCounter(e,n=1){Mn(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=n}get(){return pF(this.counters_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mg={},_g={};function jy(t){const e=t.toString();return mg[e]||(mg[e]=new bH),mg[e]}function IH(t,e){const n=t.toString();return _g[n]||(_g[n]=e()),_g[n]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EH{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,n){this.closeAfterResponse=e,this.onClose=n,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,n){for(this.pendingResponses[e]=n;this.pendingResponses[this.currentResponseNum];){const s=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let r=0;r<s.length;++r)s[r]&&hc(()=>{this.onMessage_(s[r])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZI="start",TH="close",SH="pLPCommand",CH="pRTLPCB",kk="id",Rk="pw",Nk="ser",AH="cb",kH="seg",RH="ts",NH="d",PH="dframe",Pk=1870,xk=30,xH=Pk-xk,DH=25e3,OH=3e4;class qr{constructor(e,n,s,r,i,o,a){this.connId=e,this.repoInfo=n,this.applicationId=s,this.appCheckToken=r,this.authToken=i,this.transportSessionId=o,this.lastSessionId=a,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=Pu(e),this.stats_=jy(n),this.urlFn=c=>(this.appCheckToken&&(c[Lm]=this.appCheckToken),Ak(n,Sk,c))}open(e,n){this.curSegmentNum=0,this.onDisconnect_=n,this.myPacketOrderer=new EH(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(OH)),hH(()=>{if(this.isClosed_)return;this.scriptTagHolder=new qy((...i)=>{const[o,a,c,l,u]=i;if(this.incrementIncomingBytes_(i),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,o===ZI)this.id=a,this.password=c;else if(o===TH)a?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(a,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+o)},(...i)=>{const[o,a]=i;this.incrementIncomingBytes_(i),this.myPacketOrderer.handleResponse(o,a)},()=>{this.onClosed_()},this.urlFn);const s={};s[ZI]="t",s[Nk]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(s[AH]=this.scriptTagHolder.uniqueCallbackIdentifier),s[_k]=By,this.transportSessionId&&(s[yk]=this.transportSessionId),this.lastSessionId&&(s[Ik]=this.lastSessionId),this.applicationId&&(s[Ek]=this.applicationId),this.appCheckToken&&(s[Lm]=this.appCheckToken),typeof location<"u"&&location.hostname&&bk.test(location.hostname)&&(s[vk]=wk);const r=this.urlFn(s);this.log_("Connecting via long-poll to "+r),this.scriptTagHolder.addTag(r,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){qr.forceAllow_=!0}static forceDisallow(){qr.forceDisallow_=!0}static isAvailable(){return qr.forceAllow_?!0:!qr.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!fH()&&!pH()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){const n=gt(e);this.bytesSent+=n.length,this.stats_.incrementCounter("bytes_sent",n.length);const s=cC(n),r=pk(s,xH);for(let i=0;i<r.length;i++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,r.length,r[i]),this.curSegmentNum++}addDisconnectPingFrame(e,n){this.myDisconnFrame=document.createElement("iframe");const s={};s[PH]="t",s[kk]=e,s[Rk]=n,this.myDisconnFrame.src=this.urlFn(s),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){const n=gt(e).length;this.bytesReceived+=n,this.stats_.incrementCounter("bytes_received",n)}}class qy{constructor(e,n,s,r){this.onDisconnect=s,this.urlFn=r,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0;{this.uniqueCallbackIdentifier=hk(),window[SH+this.uniqueCallbackIdentifier]=e,window[CH+this.uniqueCallbackIdentifier]=n,this.myIFrame=qy.createIFrame_();let i="";if(this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"){const a=document.domain;i='<script>document.domain="'+a+'";<\/script>'}const o="<html><body>"+i+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(o),this.myIFrame.doc.close()}catch(a){Ct("frame writing exception"),a.stack&&Ct(a.stack),Ct(a)}}}static createIFrame_(){const e=document.createElement("iframe");if(e.style.display="none",document.body){document.body.appendChild(e);try{e.contentWindow.document||Ct("No IE domain setting required")}catch{const s=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+s+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.innerHTML="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));const e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,n){for(this.myID=e,this.myPW=n,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const e={};e[kk]=this.myID,e[Rk]=this.myPW,e[Nk]=this.currentSerial;let n=this.urlFn(e),s="",r=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+xk+s.length<=Pk;){const o=this.pendingSegs.shift();s=s+"&"+kH+r+"="+o.seg+"&"+RH+r+"="+o.ts+"&"+NH+r+"="+o.d,r++}return n=n+s,this.addLongPollTag_(n,this.currentSerial),!0}else return!1}enqueueSegment(e,n,s){this.pendingSegs.push({seg:e,ts:n,d:s}),this.alive&&this.newRequest_()}addLongPollTag_(e,n){this.outstandingRequests.add(n);const s=()=>{this.outstandingRequests.delete(n),this.newRequest_()},r=setTimeout(s,Math.floor(DH)),i=()=>{clearTimeout(r),s()};this.addTag(e,i)}addTag(e,n){setTimeout(()=>{try{if(!this.sendNewPolls)return;const s=this.myIFrame.doc.createElement("script");s.type="text/javascript",s.async=!0,s.src=e,s.onload=s.onreadystatechange=function(){const r=s.readyState;(!r||r==="loaded"||r==="complete")&&(s.onload=s.onreadystatechange=null,s.parentNode&&s.parentNode.removeChild(s),n())},s.onerror=()=>{Ct("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(s)}catch{}},Math.floor(1))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MH=16384,LH=45e3;let Id=null;typeof MozWebSocket<"u"?Id=MozWebSocket:typeof WebSocket<"u"&&(Id=WebSocket);class jn{constructor(e,n,s,r,i,o,a){this.connId=e,this.applicationId=s,this.appCheckToken=r,this.authToken=i,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=Pu(this.connId),this.stats_=jy(n),this.connURL=jn.connectionURL_(n,o,a,r,s),this.nodeAdmin=n.nodeAdmin}static connectionURL_(e,n,s,r,i){const o={};return o[_k]=By,typeof location<"u"&&location.hostname&&bk.test(location.hostname)&&(o[vk]=wk),n&&(o[yk]=n),s&&(o[Ik]=s),r&&(o[Lm]=r),i&&(o[Ek]=i),Ak(e,Tk,o)}open(e,n){this.onDisconnect=n,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,Gi.set("previous_websocket_failure",!0);try{let s;lC(),this.mySock=new Id(this.connURL,[],s)}catch(s){this.log_("Error instantiating WebSocket.");const r=s.message||s.data;r&&this.log_(r),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=s=>{this.handleIncomingFrame(s)},this.mySock.onerror=s=>{this.log_("WebSocket error.  Closing connection.");const r=s.message||s.data;r&&this.log_(r),this.onClosed_()}}start(){}static forceDisallow(){jn.forceDisallow_=!0}static isAvailable(){let e=!1;if(typeof navigator<"u"&&navigator.userAgent){const n=/Android ([0-9]{0,}\.[0-9]{0,})/,s=navigator.userAgent.match(n);s&&s.length>1&&parseFloat(s[1])<4.4&&(e=!0)}return!e&&Id!==null&&!jn.forceDisallow_}static previouslyFailed(){return Gi.isInMemoryStorage||Gi.get("previous_websocket_failure")===!0}markConnectionHealthy(){Gi.remove("previous_websocket_failure")}appendFrame_(e){if(this.frames.push(e),this.frames.length===this.totalFrames){const n=this.frames.join("");this.frames=null;const s=xl(n);this.onMessage(s)}}handleNewFrameCount_(e){this.totalFrames=e,this.frames=[]}extractFrameCount_(e){if(O(this.frames===null,"We already have a frame buffer"),e.length<=6){const n=Number(e);if(!isNaN(n))return this.handleNewFrameCount_(n),null}return this.handleNewFrameCount_(1),e}handleIncomingFrame(e){if(this.mySock===null)return;const n=e.data;if(this.bytesReceived+=n.length,this.stats_.incrementCounter("bytes_received",n.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(n);else{const s=this.extractFrameCount_(n);s!==null&&this.appendFrame_(s)}}send(e){this.resetKeepAlive();const n=gt(e);this.bytesSent+=n.length,this.stats_.incrementCounter("bytes_sent",n.length);const s=pk(n,MH);s.length>1&&this.sendString_(String(s.length));for(let r=0;r<s.length;r++)this.sendString_(s[r])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(LH))}sendString_(e){try{this.mySock.send(e)}catch(n){this.log_("Exception thrown from WebSocket.send():",n.message||n.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}jn.responsesRequiredToBeHealthy=2;jn.healthyTimeout=3e4;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fa{constructor(e){this.initTransports_(e)}static get ALL_TRANSPORTS(){return[qr,jn]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(e){const n=jn&&jn.isAvailable();let s=n&&!jn.previouslyFailed();if(e.webSocketOnly&&(n||Zt("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),s=!0),s)this.transports_=[jn];else{const r=this.transports_=[];for(const i of Fa.ALL_TRANSPORTS)i&&i.isAvailable()&&r.push(i);Fa.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}Fa.globalTransportInitialized_=!1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FH=6e4,UH=5e3,$H=10*1024,VH=100*1024,yg="t",eE="d",BH="s",tE="r",jH="e",nE="o",sE="a",rE="n",iE="p",qH="h";class KH{constructor(e,n,s,r,i,o,a,c,l,u){this.id=e,this.repoInfo_=n,this.applicationId_=s,this.appCheckToken_=r,this.authToken_=i,this.onMessage_=o,this.onReady_=a,this.onDisconnect_=c,this.onKill_=l,this.lastSessionId=u,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=Pu("c:"+this.id+":"),this.transportManager_=new Fa(n),this.log_("Connection created"),this.start_()}start_(){const e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const n=this.connReceiver_(this.conn_),s=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(n,s)},Math.floor(0));const r=e.healthyTimeout||0;r>0&&(this.healthyTimeout_=cl(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>VH?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>$H?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(r)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return n=>{e===this.conn_?this.onConnectionLost_(n):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return n=>{this.state_!==2&&(e===this.rx_?this.onPrimaryMessageReceived_(n):e===this.secondaryConn_?this.onSecondaryMessageReceived_(n):this.log_("message on old connection"))}}sendRequest(e){const n={t:"d",d:e};this.sendData_(n)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if(yg in e){const n=e[yg];n===sE?this.upgradeIfSecondaryHealthy_():n===tE?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):n===nE&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){const n=xc("t",e),s=xc("d",e);if(n==="c")this.onSecondaryControl_(s);else if(n==="d")this.pendingDataMessages.push(s);else throw new Error("Unknown protocol layer: "+n)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:iE,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:sE,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:rE,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){const n=xc("t",e),s=xc("d",e);n==="c"?this.onControl_(s):n==="d"&&this.onDataMessage_(s)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){const n=xc(yg,e);if(eE in e){const s=e[eE];if(n===qH)this.onHandshake_(s);else if(n===rE){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let r=0;r<this.pendingDataMessages.length;++r)this.onDataMessage_(this.pendingDataMessages[r]);this.pendingDataMessages=[],this.tryCleanupConnection()}else n===BH?this.onConnectionShutdown_(s):n===tE?this.onReset_(s):n===jH?Mm("Server Error: "+s):n===nE?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):Mm("Unknown control packet command: "+n)}}onHandshake_(e){const n=e.ts,s=e.v,r=e.h;this.sessionId=e.s,this.repoInfo_.host=r,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,n),By!==s&&Zt("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const n=this.connReceiver_(this.secondaryConn_),s=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(n,s),cl(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(FH))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,n){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(n,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):cl(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(UH))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:iE,d:{}}}))}onSecondaryConnectionLost_(){const e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,!e&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(Gi.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(e)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dk{put(e,n,s,r){}merge(e,n,s,r){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,n,s){}onDisconnectMerge(e,n,s){}onDisconnectCancel(e,n){}reportStats(e){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ok{constructor(e){this.allowedEvents_=e,this.listeners_={},O(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...n){if(Array.isArray(this.listeners_[e])){const s=[...this.listeners_[e]];for(let r=0;r<s.length;r++)s[r].callback.apply(s[r].context,n)}}on(e,n,s){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:n,context:s});const r=this.getInitialEvent(e);r&&n.apply(s,r)}off(e,n,s){this.validateEventType_(e);const r=this.listeners_[e]||[];for(let i=0;i<r.length;i++)if(r[i].callback===n&&(!s||s===r[i].context)){r.splice(i,1);return}}validateEventType_(e){O(this.allowedEvents_.find(n=>n===e),"Unknown event: "+e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ed extends Ok{constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!Af()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}static getInstance(){return new Ed}getInitialEvent(e){return O(e==="online","Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oE=32,aE=768;class Re{constructor(e,n){if(n===void 0){this.pieces_=e.split("/");let s=0;for(let r=0;r<this.pieces_.length;r++)this.pieces_[r].length>0&&(this.pieces_[s]=this.pieces_[r],s++);this.pieces_.length=s,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=n}toString(){let e="";for(let n=this.pieceNum_;n<this.pieces_.length;n++)this.pieces_[n]!==""&&(e+="/"+this.pieces_[n]);return e||"/"}}function ke(){return new Re("")}function me(t){return t.pieceNum_>=t.pieces_.length?null:t.pieces_[t.pieceNum_]}function ri(t){return t.pieces_.length-t.pieceNum_}function Ue(t){let e=t.pieceNum_;return e<t.pieces_.length&&e++,new Re(t.pieces_,e)}function Ky(t){return t.pieceNum_<t.pieces_.length?t.pieces_[t.pieces_.length-1]:null}function HH(t){let e="";for(let n=t.pieceNum_;n<t.pieces_.length;n++)t.pieces_[n]!==""&&(e+="/"+encodeURIComponent(String(t.pieces_[n])));return e||"/"}function Kl(t,e=0){return t.pieces_.slice(t.pieceNum_+e)}function Mk(t){if(t.pieceNum_>=t.pieces_.length)return null;const e=[];for(let n=t.pieceNum_;n<t.pieces_.length-1;n++)e.push(t.pieces_[n]);return new Re(e,0)}function Qe(t,e){const n=[];for(let s=t.pieceNum_;s<t.pieces_.length;s++)n.push(t.pieces_[s]);if(e instanceof Re)for(let s=e.pieceNum_;s<e.pieces_.length;s++)n.push(e.pieces_[s]);else{const s=e.split("/");for(let r=0;r<s.length;r++)s[r].length>0&&n.push(s[r])}return new Re(n,0)}function _e(t){return t.pieceNum_>=t.pieces_.length}function hn(t,e){const n=me(t),s=me(e);if(n===null)return e;if(n===s)return hn(Ue(t),Ue(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+t+")")}function WH(t,e){const n=Kl(t,0),s=Kl(e,0);for(let r=0;r<n.length&&r<s.length;r++){const i=$o(n[r],s[r]);if(i!==0)return i}return n.length===s.length?0:n.length<s.length?-1:1}function Hy(t,e){if(ri(t)!==ri(e))return!1;for(let n=t.pieceNum_,s=e.pieceNum_;n<=t.pieces_.length;n++,s++)if(t.pieces_[n]!==e.pieces_[s])return!1;return!0}function Kn(t,e){let n=t.pieceNum_,s=e.pieceNum_;if(ri(t)>ri(e))return!1;for(;n<t.pieces_.length;){if(t.pieces_[n]!==e.pieces_[s])return!1;++n,++s}return!0}class GH{constructor(e,n){this.errorPrefix_=n,this.parts_=Kl(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let s=0;s<this.parts_.length;s++)this.byteLength_+=Rf(this.parts_[s]);Lk(this)}}function zH(t,e){t.parts_.length>0&&(t.byteLength_+=1),t.parts_.push(e),t.byteLength_+=Rf(e),Lk(t)}function QH(t){const e=t.parts_.pop();t.byteLength_-=Rf(e),t.parts_.length>0&&(t.byteLength_-=1)}function Lk(t){if(t.byteLength_>aE)throw new Error(t.errorPrefix_+"has a key path longer than "+aE+" bytes ("+t.byteLength_+").");if(t.parts_.length>oE)throw new Error(t.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+oE+") or object contains a cycle "+xi(t))}function xi(t){return t.parts_.length===0?"":"in property '"+t.parts_.join(".")+"'"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wy extends Ok{constructor(){super(["visible"]);let e,n;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(n="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(n="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(n="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(n="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,n&&document.addEventListener(n,()=>{const s=!document[e];s!==this.visible_&&(this.visible_=s,this.trigger("visible",s))},!1)}static getInstance(){return new Wy}getInitialEvent(e){return O(e==="visible","Unknown event type: "+e),[this.visible_]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dc=1e3,YH=60*5*1e3,cE=30*1e3,JH=1.3,XH=3e4,ZH="server_kill",lE=3;class hr extends Dk{constructor(e,n,s,r,i,o,a,c){if(super(),this.repoInfo_=e,this.applicationId_=n,this.onDataUpdate_=s,this.onConnectStatus_=r,this.onServerInfoUpdate_=i,this.authTokenProvider_=o,this.appCheckTokenProvider_=a,this.authOverride_=c,this.id=hr.nextPersistentConnectionId_++,this.log_=Pu("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=Dc,this.maxReconnectDelay_=YH,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,c&&!lC())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");Wy.getInstance().on("visible",this.onVisible_,this),e.host.indexOf("fblocal")===-1&&Ed.getInstance().on("online",this.onOnline_,this)}sendRequest(e,n,s){const r=++this.requestNumber_,i={r,a:e,b:n};this.log_(gt(i)),O(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(i),s&&(this.requestCBHash_[r]=s)}get(e){this.initConnection_();const n=new pt,s={p:e._path.toString(),q:e._queryObject},r={action:"g",request:s,onComplete:o=>{const a=o.d;o.s==="ok"?n.resolve(a):n.reject(a)}};this.outstandingGets_.push(r),this.outstandingGetCount_++;const i=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(i),n.promise}listen(e,n,s,r){this.initConnection_();const i=e._queryIdentifier,o=e._path.toString();this.log_("Listen called for "+o+" "+i),this.listens.has(o)||this.listens.set(o,new Map),O(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"listen() called for non-default but complete query"),O(!this.listens.get(o).has(i),"listen() called twice for same path/queryId.");const a={onComplete:r,hashFn:n,query:e,tag:s};this.listens.get(o).set(i,a),this.connected_&&this.sendListen_(a)}sendGet_(e){const n=this.outstandingGets_[e];this.sendRequest("g",n.request,s=>{delete this.outstandingGets_[e],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),n.onComplete&&n.onComplete(s)})}sendListen_(e){const n=e.query,s=n._path.toString(),r=n._queryIdentifier;this.log_("Listen on "+s+" for "+r);const i={p:s},o="q";e.tag&&(i.q=n._queryObject,i.t=e.tag),i.h=e.hashFn(),this.sendRequest(o,i,a=>{const c=a.d,l=a.s;hr.warnOnListenWarnings_(c,n),(this.listens.get(s)&&this.listens.get(s).get(r))===e&&(this.log_("listen response",a),l!=="ok"&&this.removeListen_(s,r),e.onComplete&&e.onComplete(l,c))})}static warnOnListenWarnings_(e,n){if(e&&typeof e=="object"&&Mn(e,"w")){const s=oo(e,"w");if(Array.isArray(s)&&~s.indexOf("no_index")){const r='".indexOn": "'+n._queryParams.getIndex().toString()+'"',i=n._path.toString();Zt(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${r} at ${i} to your security rules for better performance.`)}}}refreshAuthToken(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(e)}reduceReconnectDelayIfAdminCredential_(e){(e&&e.length===40||CF(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=cE)}refreshAppCheckToken(e){this.appCheckToken_=e,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){const e=this.authToken_,n=SF(e)?"auth":"gauth",s={cred:e};this.authOverride_===null?s.noauth=!0:typeof this.authOverride_=="object"&&(s.authvar=this.authOverride_),this.sendRequest(n,s,r=>{const i=r.s,o=r.d||"error";this.authToken_===e&&(i==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(i,o))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},e=>{const n=e.s,s=e.d||"error";n==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(n,s)})}unlisten(e,n){const s=e._path.toString(),r=e._queryIdentifier;this.log_("Unlisten called for "+s+" "+r),O(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(s,r)&&this.connected_&&this.sendUnlisten_(s,r,e._queryObject,n)}sendUnlisten_(e,n,s,r){this.log_("Unlisten on "+e+" for "+n);const i={p:e},o="n";r&&(i.q=s,i.t=r),this.sendRequest(o,i)}onDisconnectPut(e,n,s){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",e,n,s):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:n,onComplete:s})}onDisconnectMerge(e,n,s){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",e,n,s):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:n,onComplete:s})}onDisconnectCancel(e,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",e,null,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:n})}sendOnDisconnect_(e,n,s,r){const i={p:n,d:s};this.log_("onDisconnect "+e,i),this.sendRequest(e,i,o=>{r&&setTimeout(()=>{r(o.s,o.d)},Math.floor(0))})}put(e,n,s,r){this.putInternal("p",e,n,s,r)}merge(e,n,s,r){this.putInternal("m",e,n,s,r)}putInternal(e,n,s,r,i){this.initConnection_();const o={p:n,d:s};i!==void 0&&(o.h=i),this.outstandingPuts_.push({action:e,request:o,onComplete:r}),this.outstandingPutCount_++;const a=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(a):this.log_("Buffering put: "+n)}sendPut_(e){const n=this.outstandingPuts_[e].action,s=this.outstandingPuts_[e].request,r=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(n,s,i=>{this.log_(n+" response",i),delete this.outstandingPuts_[e],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),r&&r(i.s,i.d)})}reportStats(e){if(this.connected_){const n={c:e};this.log_("reportStats",n),this.sendRequest("s",n,s=>{if(s.s!=="ok"){const i=s.d;this.log_("reportStats","Error sending stats: "+i)}})}}onDataMessage_(e){if("r"in e){this.log_("from server: "+gt(e));const n=e.r,s=this.requestCBHash_[n];s&&(delete this.requestCBHash_[n],s(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}}onDataPush_(e,n){this.log_("handleServerMessage",e,n),e==="d"?this.onDataUpdate_(n.p,n.d,!1,n.t):e==="m"?this.onDataUpdate_(n.p,n.d,!0,n.t):e==="c"?this.onListenRevoked_(n.p,n.q):e==="ac"?this.onAuthRevoked_(n.s,n.d):e==="apc"?this.onAppCheckRevoked_(n.s,n.d):e==="sd"?this.onSecurityDebugPacket_(n):Mm("Unrecognized action received from server: "+gt(e)+`
Are you using the latest client?`)}onReady_(e,n){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(e),this.lastSessionId=n,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(e){O(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(e))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=Dc,this.realtime_||this.scheduleConnect_(0)),this.visible_=e}onOnline_(e){e?(this.log_("Browser went online."),this.reconnectDelay_=Dc,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>XH&&(this.reconnectDelay_=Dc),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());const e=new Date().getTime()-this.lastConnectionAttemptTime_;let n=Math.max(0,this.reconnectDelay_-e);n=Math.random()*n,this.log_("Trying to reconnect in "+n+"ms"),this.scheduleConnect_(n),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*JH)}this.onConnectStatus_(!1)}async establishConnection_(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;const e=this.onDataMessage_.bind(this),n=this.onReady_.bind(this),s=this.onRealtimeDisconnect_.bind(this),r=this.id+":"+hr.nextConnectionId_++,i=this.lastSessionId;let o=!1,a=null;const c=function(){a?a.close():(o=!0,s())},l=function(h){O(a,"sendRequest call when we're not connected not allowed."),a.sendRequest(h)};this.realtime_={close:c,sendRequest:l};const u=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{const[h,d]=await Promise.all([this.authTokenProvider_.getToken(u),this.appCheckTokenProvider_.getToken(u)]);o?Ct("getToken() completed but was canceled"):(Ct("getToken() completed. Creating connection."),this.authToken_=h&&h.accessToken,this.appCheckToken_=d&&d.token,a=new KH(r,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,e,n,s,f=>{Zt(f+" ("+this.repoInfo_.toString()+")"),this.interrupt(ZH)},i))}catch(h){this.log_("Failed to get token: "+h),o||(this.repoInfo_.nodeAdmin&&Zt(h),c())}}}interrupt(e){Ct("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(e){Ct("Resuming connection for reason: "+e),delete this.interruptReasons_[e],cd(this.interruptReasons_)&&(this.reconnectDelay_=Dc,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(e){const n=e-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:n})}cancelSentTransactions_(){for(let e=0;e<this.outstandingPuts_.length;e++){const n=this.outstandingPuts_[e];n&&"h"in n.request&&n.queued&&(n.onComplete&&n.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(e,n){let s;n?s=n.map(i=>$y(i)).join("$"):s="default";const r=this.removeListen_(e,s);r&&r.onComplete&&r.onComplete("permission_denied")}removeListen_(e,n){const s=new Re(e).toString();let r;if(this.listens.has(s)){const i=this.listens.get(s);r=i.get(n),i.delete(n),i.size===0&&this.listens.delete(s)}else r=void 0;return r}onAuthRevoked_(e,n){Ct("Auth token revoked: "+e+"/"+n),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(e==="invalid_token"||e==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=lE&&(this.reconnectDelay_=cE,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(e,n){Ct("App check token revoked: "+e+"/"+n),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(e==="invalid_token"||e==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=lE&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const e of this.listens.values())for(const n of e.values())this.sendListen_(n);for(let e=0;e<this.outstandingPuts_.length;e++)this.outstandingPuts_[e]&&this.sendPut_(e);for(;this.onDisconnectRequestQueue_.length;){const e=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(e.action,e.pathString,e.data,e.onComplete)}for(let e=0;e<this.outstandingGets_.length;e++)this.outstandingGets_[e]&&this.sendGet_(e)}sendConnectStats_(){const e={};let n="js";e["sdk."+n+"."+ck.replace(/\./g,"-")]=1,Af()?e["framework.cordova"]=1:Eu()&&(e["framework.reactnative"]=1),this.reportStats(e)}shouldReconnect_(){const e=Ed.getInstance().currentlyOnline();return cd(this.interruptReasons_)&&e}}hr.nextPersistentConnectionId_=0;hr.nextConnectionId_=0;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ye{constructor(e,n){this.name=e,this.node=n}static Wrap(e,n){return new ye(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wf{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,n){const s=new ye(mr,e),r=new ye(mr,n);return this.compare(s,r)!==0}minPost(){return ye.MIN}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let gh;class Fk extends Wf{static get __EMPTY_NODE(){return gh}static set __EMPTY_NODE(e){gh=e}compare(e,n){return $o(e.name,n.name)}isDefinedOn(e){throw ic("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,n){return!1}minPost(){return ye.MIN}maxPost(){return new ye(qs,gh)}makePost(e,n){return O(typeof e=="string","KeyIndex indexValue must always be a string."),new ye(e,gh)}toString(){return".key"}}const Os=new Fk;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mh{constructor(e,n,s,r,i=null){this.isReverse_=r,this.resultGenerator_=i,this.nodeStack_=[];let o=1;for(;!e.isEmpty();)if(e=e,o=n?s(e.key,n):1,r&&(o*=-1),o<0)this.isReverse_?e=e.left:e=e.right;else if(o===0){this.nodeStack_.push(e);break}else this.nodeStack_.push(e),this.isReverse_?e=e.right:e=e.left}getNext(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_.pop(),n;if(this.resultGenerator_?n=this.resultGenerator_(e.key,e.value):n={key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return n}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;const e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}}class Et{constructor(e,n,s,r,i){this.key=e,this.value=n,this.color=s!=null?s:Et.RED,this.left=r!=null?r:vn.EMPTY_NODE,this.right=i!=null?i:vn.EMPTY_NODE}copy(e,n,s,r,i){return new Et(e!=null?e:this.key,n!=null?n:this.value,s!=null?s:this.color,r!=null?r:this.left,i!=null?i:this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,s){let r=this;const i=s(e,r.key);return i<0?r=r.copy(null,null,null,r.left.insert(e,n,s),null):i===0?r=r.copy(null,n,null,null,null):r=r.copy(null,null,null,null,r.right.insert(e,n,s)),r.fixUp_()}removeMin_(){if(this.left.isEmpty())return vn.EMPTY_NODE;let e=this;return!e.left.isRed_()&&!e.left.left.isRed_()&&(e=e.moveRedLeft_()),e=e.copy(null,null,null,e.left.removeMin_(),null),e.fixUp_()}remove(e,n){let s,r;if(s=this,n(e,s.key)<0)!s.left.isEmpty()&&!s.left.isRed_()&&!s.left.left.isRed_()&&(s=s.moveRedLeft_()),s=s.copy(null,null,null,s.left.remove(e,n),null);else{if(s.left.isRed_()&&(s=s.rotateRight_()),!s.right.isEmpty()&&!s.right.isRed_()&&!s.right.left.isRed_()&&(s=s.moveRedRight_()),n(e,s.key)===0){if(s.right.isEmpty())return vn.EMPTY_NODE;r=s.right.min_(),s=s.copy(r.key,r.value,null,null,s.right.removeMin_())}s=s.copy(null,null,null,null,s.right.remove(e,n))}return s.fixUp_()}isRed_(){return this.color}fixUp_(){let e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e}moveRedLeft_(){let e=this.colorFlip_();return e.right.left.isRed_()&&(e=e.copy(null,null,null,null,e.right.rotateRight_()),e=e.rotateLeft_(),e=e.colorFlip_()),e}moveRedRight_(){let e=this.colorFlip_();return e.left.left.isRed_()&&(e=e.rotateRight_(),e=e.colorFlip_()),e}rotateLeft_(){const e=this.copy(null,null,Et.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight_(){const e=this.copy(null,null,Et.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip_(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth_(){const e=this.check_();return Math.pow(2,e)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)}}Et.RED=!0;Et.BLACK=!1;class eW{copy(e,n,s,r,i){return this}insert(e,n,s){return new Et(e,n,null)}remove(e,n){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}}class vn{constructor(e,n=vn.EMPTY_NODE){this.comparator_=e,this.root_=n}insert(e,n){return new vn(this.comparator_,this.root_.insert(e,n,this.comparator_).copy(null,null,Et.BLACK,null,null))}remove(e){return new vn(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,Et.BLACK,null,null))}get(e){let n,s=this.root_;for(;!s.isEmpty();){if(n=this.comparator_(e,s.key),n===0)return s.value;n<0?s=s.left:n>0&&(s=s.right)}return null}getPredecessorKey(e){let n,s=this.root_,r=null;for(;!s.isEmpty();)if(n=this.comparator_(e,s.key),n===0){if(s.left.isEmpty())return r?r.key:null;for(s=s.left;!s.right.isEmpty();)s=s.right;return s.key}else n<0?s=s.left:n>0&&(r=s,s=s.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new mh(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,n){return new mh(this.root_,e,this.comparator_,!1,n)}getReverseIteratorFrom(e,n){return new mh(this.root_,e,this.comparator_,!0,n)}getReverseIterator(e){return new mh(this.root_,null,this.comparator_,!0,e)}}vn.EMPTY_NODE=new eW;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tW(t,e){return $o(t.name,e.name)}function Gy(t,e){return $o(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Fm;function nW(t){Fm=t}const Uk=function(t){return typeof t=="number"?"number:"+gk(t):"string:"+t},$k=function(t){if(t.isLeafNode()){const e=t.val();O(typeof e=="string"||typeof e=="number"||typeof e=="object"&&Mn(e,".sv"),"Priority must be a string or number.")}else O(t===Fm||t.isEmpty(),"priority of unexpected type.");O(t===Fm||t.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let uE;class wt{constructor(e,n=wt.__childrenNodeConstructor.EMPTY_NODE){this.value_=e,this.priorityNode_=n,this.lazyHash_=null,O(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),$k(this.priorityNode_)}static set __childrenNodeConstructor(e){uE=e}static get __childrenNodeConstructor(){return uE}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(e){return new wt(this.value_,e)}getImmediateChild(e){return e===".priority"?this.priorityNode_:wt.__childrenNodeConstructor.EMPTY_NODE}getChild(e){return _e(e)?this:me(e)===".priority"?this.priorityNode_:wt.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(e,n){return null}updateImmediateChild(e,n){return e===".priority"?this.updatePriority(n):n.isEmpty()&&e!==".priority"?this:wt.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,n).updatePriority(this.priorityNode_)}updateChild(e,n){const s=me(e);return s===null?n:n.isEmpty()&&s!==".priority"?this:(O(s!==".priority"||ri(e)===1,".priority must be the last token in a path"),this.updateImmediateChild(s,wt.__childrenNodeConstructor.EMPTY_NODE.updateChild(Ue(e),n)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(e,n){return!1}val(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let e="";this.priorityNode_.isEmpty()||(e+="priority:"+Uk(this.priorityNode_.val())+":");const n=typeof this.value_;e+=n+":",n==="number"?e+=gk(this.value_):e+=this.value_,this.lazyHash_=dk(e)}return this.lazyHash_}getValue(){return this.value_}compareTo(e){return e===wt.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof wt.__childrenNodeConstructor?-1:(O(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))}compareToLeafNode_(e){const n=typeof e.value_,s=typeof this.value_,r=wt.VALUE_TYPE_ORDER.indexOf(n),i=wt.VALUE_TYPE_ORDER.indexOf(s);return O(r>=0,"Unknown leaf type: "+n),O(i>=0,"Unknown leaf type: "+s),r===i?s==="object"?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:i-r}withIndex(){return this}isIndexed(){return!0}equals(e){if(e===this)return!0;if(e.isLeafNode()){const n=e;return this.value_===n.value_&&this.priorityNode_.equals(n.priorityNode_)}else return!1}}wt.VALUE_TYPE_ORDER=["object","boolean","number","string"];/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Vk,Bk;function sW(t){Vk=t}function rW(t){Bk=t}class iW extends Wf{compare(e,n){const s=e.node.getPriority(),r=n.node.getPriority(),i=s.compareTo(r);return i===0?$o(e.name,n.name):i}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,n){return!e.getPriority().equals(n.getPriority())}minPost(){return ye.MIN}maxPost(){return new ye(qs,new wt("[PRIORITY-POST]",Bk))}makePost(e,n){const s=Vk(e);return new ye(n,new wt("[PRIORITY-POST]",s))}toString(){return".priority"}}const Ke=new iW;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oW=Math.log(2);class aW{constructor(e){const n=i=>parseInt(Math.log(i)/oW,10),s=i=>parseInt(Array(i+1).join("1"),2);this.count=n(e+1),this.current_=this.count-1;const r=s(this.count);this.bits_=e+1&r}nextBitIsOne(){const e=!(this.bits_&1<<this.current_);return this.current_--,e}}const Td=function(t,e,n,s){t.sort(e);const r=function(c,l){const u=l-c;let h,d;if(u===0)return null;if(u===1)return h=t[c],d=n?n(h):h,new Et(d,h.node,Et.BLACK,null,null);{const f=parseInt(u/2,10)+c,p=r(c,f),_=r(f+1,l);return h=t[f],d=n?n(h):h,new Et(d,h.node,Et.BLACK,p,_)}},i=function(c){let l=null,u=null,h=t.length;const d=function(p,_){const y=h-p,T=h;h-=p;const I=r(y+1,T),E=t[y],S=n?n(E):E;f(new Et(S,E.node,_,null,I))},f=function(p){l?(l.left=p,l=p):(u=p,l=p)};for(let p=0;p<c.count;++p){const _=c.nextBitIsOne(),y=Math.pow(2,c.count-(p+1));_?d(y,Et.BLACK):(d(y,Et.BLACK),d(y,Et.RED))}return u},o=new aW(t.length),a=i(o);return new vn(s||e,a)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let vg;const Zo={};class ir{constructor(e,n){this.indexes_=e,this.indexSet_=n}static get Default(){return O(Zo&&Ke,"ChildrenNode.ts has not been loaded"),vg=vg||new ir({".priority":Zo},{".priority":Ke}),vg}get(e){const n=oo(this.indexes_,e);if(!n)throw new Error("No index defined for "+e);return n instanceof vn?n:null}hasIndex(e){return Mn(this.indexSet_,e.toString())}addIndex(e,n){O(e!==Os,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const s=[];let r=!1;const i=n.getIterator(ye.Wrap);let o=i.getNext();for(;o;)r=r||e.isDefinedOn(o.node),s.push(o),o=i.getNext();let a;r?a=Td(s,e.getCompare()):a=Zo;const c=e.toString(),l=Object.assign({},this.indexSet_);l[c]=e;const u=Object.assign({},this.indexes_);return u[c]=a,new ir(u,l)}addToIndexes(e,n){const s=ld(this.indexes_,(r,i)=>{const o=oo(this.indexSet_,i);if(O(o,"Missing index implementation for "+i),r===Zo)if(o.isDefinedOn(e.node)){const a=[],c=n.getIterator(ye.Wrap);let l=c.getNext();for(;l;)l.name!==e.name&&a.push(l),l=c.getNext();return a.push(e),Td(a,o.getCompare())}else return Zo;else{const a=n.get(e.name);let c=r;return a&&(c=c.remove(new ye(e.name,a))),c.insert(e,e.node)}});return new ir(s,this.indexSet_)}removeFromIndexes(e,n){const s=ld(this.indexes_,r=>{if(r===Zo)return r;{const i=n.get(e.name);return i?r.remove(new ye(e.name,i)):r}});return new ir(s,this.indexSet_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Oc;class re{constructor(e,n,s){this.children_=e,this.priorityNode_=n,this.indexMap_=s,this.lazyHash_=null,this.priorityNode_&&$k(this.priorityNode_),this.children_.isEmpty()&&O(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return Oc||(Oc=new re(new vn(Gy),null,ir.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||Oc}updatePriority(e){return this.children_.isEmpty()?this:new re(this.children_,e,this.indexMap_)}getImmediateChild(e){if(e===".priority")return this.getPriority();{const n=this.children_.get(e);return n===null?Oc:n}}getChild(e){const n=me(e);return n===null?this:this.getImmediateChild(n).getChild(Ue(e))}hasChild(e){return this.children_.get(e)!==null}updateImmediateChild(e,n){if(O(n,"We should always be passing snapshot nodes"),e===".priority")return this.updatePriority(n);{const s=new ye(e,n);let r,i;n.isEmpty()?(r=this.children_.remove(e),i=this.indexMap_.removeFromIndexes(s,this.children_)):(r=this.children_.insert(e,n),i=this.indexMap_.addToIndexes(s,this.children_));const o=r.isEmpty()?Oc:this.priorityNode_;return new re(r,o,i)}}updateChild(e,n){const s=me(e);if(s===null)return n;{O(me(e)!==".priority"||ri(e)===1,".priority must be the last token in a path");const r=this.getImmediateChild(s).updateChild(Ue(e),n);return this.updateImmediateChild(s,r)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(e){if(this.isEmpty())return null;const n={};let s=0,r=0,i=!0;if(this.forEachChild(Ke,(o,a)=>{n[o]=a.val(e),s++,i&&re.INTEGER_REGEXP_.test(o)?r=Math.max(r,Number(o)):i=!1}),!e&&i&&r<2*s){const o=[];for(const a in n)o[a]=n[a];return o}else return e&&!this.getPriority().isEmpty()&&(n[".priority"]=this.getPriority().val()),n}hash(){if(this.lazyHash_===null){let e="";this.getPriority().isEmpty()||(e+="priority:"+Uk(this.getPriority().val())+":"),this.forEachChild(Ke,(n,s)=>{const r=s.hash();r!==""&&(e+=":"+n+":"+r)}),this.lazyHash_=e===""?"":dk(e)}return this.lazyHash_}getPredecessorChildName(e,n,s){const r=this.resolveIndex_(s);if(r){const i=r.getPredecessorKey(new ye(e,n));return i?i.name:null}else return this.children_.getPredecessorKey(e)}getFirstChildName(e){const n=this.resolveIndex_(e);if(n){const s=n.minKey();return s&&s.name}else return this.children_.minKey()}getFirstChild(e){const n=this.getFirstChildName(e);return n?new ye(n,this.children_.get(n)):null}getLastChildName(e){const n=this.resolveIndex_(e);if(n){const s=n.maxKey();return s&&s.name}else return this.children_.maxKey()}getLastChild(e){const n=this.getLastChildName(e);return n?new ye(n,this.children_.get(n)):null}forEachChild(e,n){const s=this.resolveIndex_(e);return s?s.inorderTraversal(r=>n(r.name,r.node)):this.children_.inorderTraversal(n)}getIterator(e){return this.getIteratorFrom(e.minPost(),e)}getIteratorFrom(e,n){const s=this.resolveIndex_(n);if(s)return s.getIteratorFrom(e,r=>r);{const r=this.children_.getIteratorFrom(e.name,ye.Wrap);let i=r.peek();for(;i!=null&&n.compare(i,e)<0;)r.getNext(),i=r.peek();return r}}getReverseIterator(e){return this.getReverseIteratorFrom(e.maxPost(),e)}getReverseIteratorFrom(e,n){const s=this.resolveIndex_(n);if(s)return s.getReverseIteratorFrom(e,r=>r);{const r=this.children_.getReverseIteratorFrom(e.name,ye.Wrap);let i=r.peek();for(;i!=null&&n.compare(i,e)>0;)r.getNext(),i=r.peek();return r}}compareTo(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===xu?-1:0}withIndex(e){if(e===Os||this.indexMap_.hasIndex(e))return this;{const n=this.indexMap_.addIndex(e,this.children_);return new re(this.children_,this.priorityNode_,n)}}isIndexed(e){return e===Os||this.indexMap_.hasIndex(e)}equals(e){if(e===this)return!0;if(e.isLeafNode())return!1;{const n=e;if(this.getPriority().equals(n.getPriority()))if(this.children_.count()===n.children_.count()){const s=this.getIterator(Ke),r=n.getIterator(Ke);let i=s.getNext(),o=r.getNext();for(;i&&o;){if(i.name!==o.name||!i.node.equals(o.node))return!1;i=s.getNext(),o=r.getNext()}return i===null&&o===null}else return!1;else return!1}}resolveIndex_(e){return e===Os?null:this.indexMap_.get(e.toString())}}re.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;class cW extends re{constructor(){super(new vn(Gy),re.EMPTY_NODE,ir.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return re.EMPTY_NODE}isEmpty(){return!1}}const xu=new cW;Object.defineProperties(ye,{MIN:{value:new ye(mr,re.EMPTY_NODE)},MAX:{value:new ye(qs,xu)}});Fk.__EMPTY_NODE=re.EMPTY_NODE;wt.__childrenNodeConstructor=re;nW(xu);rW(xu);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lW=!0;function Xe(t,e=null){if(t===null)return re.EMPTY_NODE;if(typeof t=="object"&&".priority"in t&&(e=t[".priority"]),O(e===null||typeof e=="string"||typeof e=="number"||typeof e=="object"&&".sv"in e,"Invalid priority type found: "+typeof e),typeof t=="object"&&".value"in t&&t[".value"]!==null&&(t=t[".value"]),typeof t!="object"||".sv"in t){const n=t;return new wt(n,Xe(e))}if(!(t instanceof Array)&&lW){const n=[];let s=!1;if(Dt(t,(o,a)=>{if(o.substring(0,1)!=="."){const c=Xe(a);c.isEmpty()||(s=s||!c.getPriority().isEmpty(),n.push(new ye(o,c)))}}),n.length===0)return re.EMPTY_NODE;const i=Td(n,tW,o=>o.name,Gy);if(s){const o=Td(n,Ke.getCompare());return new re(i,Xe(e),new ir({".priority":o},{".priority":Ke}))}else return new re(i,Xe(e),ir.Default)}else{let n=re.EMPTY_NODE;return Dt(t,(s,r)=>{if(Mn(t,s)&&s.substring(0,1)!=="."){const i=Xe(r);(i.isLeafNode()||!i.isEmpty())&&(n=n.updateImmediateChild(s,i))}}),n.updatePriority(Xe(e))}}sW(Xe);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zy extends Wf{constructor(e){super(),this.indexPath_=e,O(!_e(e)&&me(e)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,n){const s=this.extractChild(e.node),r=this.extractChild(n.node),i=s.compareTo(r);return i===0?$o(e.name,n.name):i}makePost(e,n){const s=Xe(e),r=re.EMPTY_NODE.updateChild(this.indexPath_,s);return new ye(n,r)}maxPost(){const e=re.EMPTY_NODE.updateChild(this.indexPath_,xu);return new ye(qs,e)}toString(){return Kl(this.indexPath_,0).join("/")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uW extends Wf{compare(e,n){const s=e.node.compareTo(n.node);return s===0?$o(e.name,n.name):s}isDefinedOn(e){return!0}indexedValueChanged(e,n){return!e.equals(n)}minPost(){return ye.MIN}maxPost(){return ye.MAX}makePost(e,n){const s=Xe(e);return new ye(n,s)}toString(){return".value"}}const Qy=new uW;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ua="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",Um="-",jk="z",qk=786,hW=function(){let t=0;const e=[];return function(n){const s=n===t;t=n;let r;const i=new Array(8);for(r=7;r>=0;r--)i[r]=Ua.charAt(n%64),n=Math.floor(n/64);O(n===0,"Cannot push at time == 0");let o=i.join("");if(s){for(r=11;r>=0&&e[r]===63;r--)e[r]=0;e[r]++}else for(r=0;r<12;r++)e[r]=Math.floor(Math.random()*64);for(r=0;r<12;r++)o+=Ua.charAt(e[r]);return O(o.length===20,"nextPushId: Length should be 20."),o}}(),hE=function(t){if(t===""+Vy)return Um;const e=bd(t);if(e!=null)return""+(e+1);const n=new Array(t.length);for(let o=0;o<n.length;o++)n[o]=t.charAt(o);if(n.length<qk)return n.push(Um),n.join("");let s=n.length-1;for(;s>=0&&n[s]===jk;)s--;if(s===-1)return qs;const r=n[s],i=Ua.charAt(Ua.indexOf(r)+1);return n[s]=i,n.slice(0,s+1).join("")},dE=function(t){if(t===""+mk)return mr;const e=bd(t);if(e!=null)return""+(e-1);const n=new Array(t.length);for(let s=0;s<n.length;s++)n[s]=t.charAt(s);return n[n.length-1]===Um?n.length===1?""+Vy:(delete n[n.length-1],n.join("")):(n[n.length-1]=Ua.charAt(Ua.indexOf(n[n.length-1])-1),n.join("")+jk.repeat(qk-n.length))};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kk(t){return{type:"value",snapshotNode:t}}function $a(t,e){return{type:"child_added",snapshotNode:e,childName:t}}function Hl(t,e){return{type:"child_removed",snapshotNode:e,childName:t}}function Wl(t,e,n){return{type:"child_changed",snapshotNode:e,childName:t,oldSnap:n}}function dW(t,e){return{type:"child_moved",snapshotNode:e,childName:t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yy{constructor(e){this.index_=e}updateChild(e,n,s,r,i,o){O(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");const a=e.getImmediateChild(n);return a.getChild(r).equals(s.getChild(r))&&a.isEmpty()===s.isEmpty()||(o!=null&&(s.isEmpty()?e.hasChild(n)?o.trackChildChange(Hl(n,a)):O(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):a.isEmpty()?o.trackChildChange($a(n,s)):o.trackChildChange(Wl(n,s,a))),e.isLeafNode()&&s.isEmpty())?e:e.updateImmediateChild(n,s).withIndex(this.index_)}updateFullNode(e,n,s){return s!=null&&(e.isLeafNode()||e.forEachChild(Ke,(r,i)=>{n.hasChild(r)||s.trackChildChange(Hl(r,i))}),n.isLeafNode()||n.forEachChild(Ke,(r,i)=>{if(e.hasChild(r)){const o=e.getImmediateChild(r);o.equals(i)||s.trackChildChange(Wl(r,i,o))}else s.trackChildChange($a(r,i))})),n.withIndex(this.index_)}updatePriority(e,n){return e.isEmpty()?re.EMPTY_NODE:e.updatePriority(n)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gl{constructor(e){this.indexedFilter_=new Yy(e.getIndex()),this.index_=e.getIndex(),this.startPost_=Gl.getStartPost_(e),this.endPost_=Gl.getEndPost_(e)}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){return this.index_.compare(this.getStartPost(),e)<=0&&this.index_.compare(e,this.getEndPost())<=0}updateChild(e,n,s,r,i,o){return this.matches(new ye(n,s))||(s=re.EMPTY_NODE),this.indexedFilter_.updateChild(e,n,s,r,i,o)}updateFullNode(e,n,s){n.isLeafNode()&&(n=re.EMPTY_NODE);let r=n.withIndex(this.index_);r=r.updatePriority(re.EMPTY_NODE);const i=this;return n.forEachChild(Ke,(o,a)=>{i.matches(new ye(o,a))||(r=r.updateImmediateChild(o,re.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,r,s)}updatePriority(e,n){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){const n=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),n)}else return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){const n=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),n)}else return e.getIndex().maxPost()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fW{constructor(e){this.rangedFilter_=new Gl(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft()}updateChild(e,n,s,r,i,o){return this.rangedFilter_.matches(new ye(n,s))||(s=re.EMPTY_NODE),e.getImmediateChild(n).equals(s)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,n,s,r,i,o):this.fullLimitUpdateChild_(e,n,s,i,o)}updateFullNode(e,n,s){let r;if(n.isLeafNode()||n.isEmpty())r=re.EMPTY_NODE.withIndex(this.index_);else if(this.limit_*2<n.numChildren()&&n.isIndexed(this.index_)){r=re.EMPTY_NODE.withIndex(this.index_);let i;this.reverse_?i=n.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):i=n.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let o=0;for(;i.hasNext()&&o<this.limit_;){const a=i.getNext();let c;if(this.reverse_?c=this.index_.compare(this.rangedFilter_.getStartPost(),a)<=0:c=this.index_.compare(a,this.rangedFilter_.getEndPost())<=0,c)r=r.updateImmediateChild(a.name,a.node),o++;else break}}else{r=n.withIndex(this.index_),r=r.updatePriority(re.EMPTY_NODE);let i,o,a,c;if(this.reverse_){c=r.getReverseIterator(this.index_),i=this.rangedFilter_.getEndPost(),o=this.rangedFilter_.getStartPost();const h=this.index_.getCompare();a=(d,f)=>h(f,d)}else c=r.getIterator(this.index_),i=this.rangedFilter_.getStartPost(),o=this.rangedFilter_.getEndPost(),a=this.index_.getCompare();let l=0,u=!1;for(;c.hasNext();){const h=c.getNext();!u&&a(i,h)<=0&&(u=!0),u&&l<this.limit_&&a(h,o)<=0?l++:r=r.updateImmediateChild(h.name,re.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,r,s)}updatePriority(e,n){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,n,s,r,i){let o;if(this.reverse_){const h=this.index_.getCompare();o=(d,f)=>h(f,d)}else o=this.index_.getCompare();const a=e;O(a.numChildren()===this.limit_,"");const c=new ye(n,s),l=this.reverse_?a.getFirstChild(this.index_):a.getLastChild(this.index_),u=this.rangedFilter_.matches(c);if(a.hasChild(n)){const h=a.getImmediateChild(n);let d=r.getChildAfterChild(this.index_,l,this.reverse_);for(;d!=null&&(d.name===n||a.hasChild(d.name));)d=r.getChildAfterChild(this.index_,d,this.reverse_);const f=d==null?1:o(d,c);if(u&&!s.isEmpty()&&f>=0)return i!=null&&i.trackChildChange(Wl(n,s,h)),a.updateImmediateChild(n,s);{i!=null&&i.trackChildChange(Hl(n,h));const _=a.updateImmediateChild(n,re.EMPTY_NODE);return d!=null&&this.rangedFilter_.matches(d)?(i!=null&&i.trackChildChange($a(d.name,d.node)),_.updateImmediateChild(d.name,d.node)):_}}else return s.isEmpty()?e:u&&o(l,c)>=0?(i!=null&&(i.trackChildChange(Hl(l.name,l.node)),i.trackChildChange($a(n,s))),a.updateImmediateChild(n,s).updateImmediateChild(l.name,re.EMPTY_NODE)):e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gf{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=Ke}hasStart(){return this.startSet_}hasStartAfter(){return this.startAfterSet_}hasEndBefore(){return this.endBeforeSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return O(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return O(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:mr}hasEnd(){return this.endSet_}getIndexEndValue(){return O(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return O(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:qs}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return O(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===Ke}copy(){const e=new Gf;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}}function pW(t){return t.loadsAllData()?new Yy(t.getIndex()):t.hasLimit()?new fW(t):new Gl(t)}function gW(t,e){const n=t.copy();return n.limitSet_=!0,n.limit_=e,n.viewFrom_="l",n}function mW(t,e){const n=t.copy();return n.limitSet_=!0,n.limit_=e,n.viewFrom_="r",n}function $m(t,e,n){const s=t.copy();return s.startSet_=!0,e===void 0&&(e=null),s.indexStartValue_=e,n!=null?(s.startNameSet_=!0,s.indexStartName_=n):(s.startNameSet_=!1,s.indexStartName_=""),s}function _W(t,e,n){let s;if(t.index_===Os)typeof e=="string"&&(e=hE(e)),s=$m(t,e,n);else{let r;n==null?r=qs:r=hE(n),s=$m(t,e,r)}return s.startAfterSet_=!0,s}function Vm(t,e,n){const s=t.copy();return s.endSet_=!0,e===void 0&&(e=null),s.indexEndValue_=e,n!==void 0?(s.endNameSet_=!0,s.indexEndName_=n):(s.endNameSet_=!1,s.indexEndName_=""),s}function yW(t,e,n){let s,r;return t.index_===Os?(typeof e=="string"&&(e=dE(e)),r=Vm(t,e,n)):(n==null?s=mr:s=dE(n),r=Vm(t,e,s)),r.endBeforeSet_=!0,r}function zf(t,e){const n=t.copy();return n.index_=e,n}function fE(t){const e={};if(t.isDefault())return e;let n;return t.index_===Ke?n="$priority":t.index_===Qy?n="$value":t.index_===Os?n="$key":(O(t.index_ instanceof zy,"Unrecognized index type!"),n=t.index_.toString()),e.orderBy=gt(n),t.startSet_&&(e.startAt=gt(t.indexStartValue_),t.startNameSet_&&(e.startAt+=","+gt(t.indexStartName_))),t.endSet_&&(e.endAt=gt(t.indexEndValue_),t.endNameSet_&&(e.endAt+=","+gt(t.indexEndName_))),t.limitSet_&&(t.isViewFromLeft()?e.limitToFirst=t.limit_:e.limitToLast=t.limit_),e}function pE(t){const e={};if(t.startSet_&&(e.sp=t.indexStartValue_,t.startNameSet_&&(e.sn=t.indexStartName_)),t.endSet_&&(e.ep=t.indexEndValue_,t.endNameSet_&&(e.en=t.indexEndName_)),t.limitSet_){e.l=t.limit_;let n=t.viewFrom_;n===""&&(t.isViewFromLeft()?n="l":n="r"),e.vf=n}return t.index_!==Ke&&(e.i=t.index_.toString()),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sd extends Dk{constructor(e,n,s,r){super(),this.repoInfo_=e,this.onDataUpdate_=n,this.authTokenProvider_=s,this.appCheckTokenProvider_=r,this.log_=Pu("p:rest:"),this.listens_={}}reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,n){return n!==void 0?"tag$"+n:(O(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}listen(e,n,s,r){const i=e._path.toString();this.log_("Listen called for "+i+" "+e._queryIdentifier);const o=Sd.getListenId_(e,s),a={};this.listens_[o]=a;const c=fE(e._queryParams);this.restRequest_(i+".json",c,(l,u)=>{let h=u;if(l===404&&(h=null,l=null),l===null&&this.onDataUpdate_(i,h,!1,s),oo(this.listens_,o)===a){let d;l?l===401?d="permission_denied":d="rest_error:"+l:d="ok",r(d,null)}})}unlisten(e,n){const s=Sd.getListenId_(e,n);delete this.listens_[s]}get(e){const n=fE(e._queryParams),s=e._path.toString(),r=new pt;return this.restRequest_(s+".json",n,(i,o)=>{let a=o;i===404&&(a=null,i=null),i===null?(this.onDataUpdate_(s,a,!1,null),r.resolve(a)):r.reject(new Error(a))}),r.promise}refreshAuthToken(e){}restRequest_(e,n={},s){return n.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([r,i])=>{r&&r.accessToken&&(n.auth=r.accessToken),i&&i.token&&(n.ac=i.token);const o=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+Lo(n);this.log_("Sending REST request for "+o);const a=new XMLHttpRequest;a.onreadystatechange=()=>{if(s&&a.readyState===4){this.log_("REST Response for "+o+" received. status:",a.status,"response:",a.responseText);let c=null;if(a.status>=200&&a.status<300){try{c=xl(a.responseText)}catch{Zt("Failed to parse JSON response for "+o+": "+a.responseText)}s(null,c)}else a.status!==401&&a.status!==404&&Zt("Got unsuccessful REST response for "+o+" Status: "+a.status),s(a.status);s=null}},a.open("GET",o,!0),a.send()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vW{constructor(){this.rootNode_=re.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,n){this.rootNode_=this.rootNode_.updateChild(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cd(){return{value:null,children:new Map}}function dc(t,e,n){if(_e(e))t.value=n,t.children.clear();else if(t.value!==null)t.value=t.value.updateChild(e,n);else{const s=me(e);t.children.has(s)||t.children.set(s,Cd());const r=t.children.get(s);e=Ue(e),dc(r,e,n)}}function Bm(t,e){if(_e(e))return t.value=null,t.children.clear(),!0;if(t.value!==null){if(t.value.isLeafNode())return!1;{const n=t.value;return t.value=null,n.forEachChild(Ke,(s,r)=>{dc(t,new Re(s),r)}),Bm(t,e)}}else if(t.children.size>0){const n=me(e);return e=Ue(e),t.children.has(n)&&Bm(t.children.get(n),e)&&t.children.delete(n),t.children.size===0}else return!0}function jm(t,e,n){t.value!==null?n(e,t.value):wW(t,(s,r)=>{const i=new Re(e.toString()+"/"+s);jm(r,i,n)})}function wW(t,e){t.children.forEach((n,s)=>{e(s,n)})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bW{constructor(e){this.collection_=e,this.last_=null}get(){const e=this.collection_.get(),n=Object.assign({},e);return this.last_&&Dt(this.last_,(s,r)=>{n[s]=n[s]-r}),this.last_=e,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gE=10*1e3,IW=30*1e3,EW=5*60*1e3;class TW{constructor(e,n){this.server_=n,this.statsToReport_={},this.statsListener_=new bW(e);const s=gE+(IW-gE)*Math.random();cl(this.reportStats_.bind(this),Math.floor(s))}reportStats_(){const e=this.statsListener_.get(),n={};let s=!1;Dt(e,(r,i)=>{i>0&&Mn(this.statsToReport_,r)&&(n[r]=i,s=!0)}),s&&this.server_.reportStats(n),cl(this.reportStats_.bind(this),Math.floor(Math.random()*2*EW))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var us;(function(t){t[t.OVERWRITE=0]="OVERWRITE",t[t.MERGE=1]="MERGE",t[t.ACK_USER_WRITE=2]="ACK_USER_WRITE",t[t.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"})(us||(us={}));function Jy(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function Xy(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function Zy(t){return{fromUser:!1,fromServer:!0,queryId:t,tagged:!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ad{constructor(e,n,s){this.path=e,this.affectedTree=n,this.revert=s,this.type=us.ACK_USER_WRITE,this.source=Jy()}operationForChild(e){if(_e(this.path)){if(this.affectedTree.value!=null)return O(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const n=this.affectedTree.subtree(new Re(e));return new Ad(ke(),n,this.revert)}}else return O(me(this.path)===e,"operationForChild called for unrelated child."),new Ad(Ue(this.path),this.affectedTree,this.revert)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zl{constructor(e,n){this.source=e,this.path=n,this.type=us.LISTEN_COMPLETE}operationForChild(e){return _e(this.path)?new zl(this.source,ke()):new zl(this.source,Ue(this.path))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class po{constructor(e,n,s){this.source=e,this.path=n,this.snap=s,this.type=us.OVERWRITE}operationForChild(e){return _e(this.path)?new po(this.source,ke(),this.snap.getImmediateChild(e)):new po(this.source,Ue(this.path),this.snap)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Va{constructor(e,n,s){this.source=e,this.path=n,this.children=s,this.type=us.MERGE}operationForChild(e){if(_e(this.path)){const n=this.children.subtree(new Re(e));return n.isEmpty()?null:n.value?new po(this.source,ke(),n.value):new Va(this.source,ke(),n)}else return O(me(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new Va(this.source,Ue(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ii{constructor(e,n,s){this.node_=e,this.fullyInitialized_=n,this.filtered_=s}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(_e(e))return this.isFullyInitialized()&&!this.filtered_;const n=me(e);return this.isCompleteForChild(n)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SW{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}}function CW(t,e,n,s){const r=[],i=[];return e.forEach(o=>{o.type==="child_changed"&&t.index_.indexedValueChanged(o.oldSnap,o.snapshotNode)&&i.push(dW(o.childName,o.snapshotNode))}),Mc(t,r,"child_removed",e,s,n),Mc(t,r,"child_added",e,s,n),Mc(t,r,"child_moved",i,s,n),Mc(t,r,"child_changed",e,s,n),Mc(t,r,"value",e,s,n),r}function Mc(t,e,n,s,r,i){const o=s.filter(a=>a.type===n);o.sort((a,c)=>kW(t,a,c)),o.forEach(a=>{const c=AW(t,a,i);r.forEach(l=>{l.respondsTo(a.type)&&e.push(l.createEvent(c,t.query_))})})}function AW(t,e,n){return e.type==="value"||e.type==="child_removed"||(e.prevName=n.getPredecessorChildName(e.childName,e.snapshotNode,t.index_)),e}function kW(t,e,n){if(e.childName==null||n.childName==null)throw ic("Should only compare child_ events.");const s=new ye(e.childName,e.snapshotNode),r=new ye(n.childName,n.snapshotNode);return t.index_.compare(s,r)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qf(t,e){return{eventCache:t,serverCache:e}}function ll(t,e,n,s){return Qf(new ii(e,n,s),t.serverCache)}function Hk(t,e,n,s){return Qf(t.eventCache,new ii(e,n,s))}function kd(t){return t.eventCache.isFullyInitialized()?t.eventCache.getNode():null}function go(t){return t.serverCache.isFullyInitialized()?t.serverCache.getNode():null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let wg;const RW=()=>(wg||(wg=new vn(dH)),wg);class Be{constructor(e,n=RW()){this.value=e,this.children=n}static fromObject(e){let n=new Be(null);return Dt(e,(s,r)=>{n=n.set(new Re(s),r)}),n}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,n){if(this.value!=null&&n(this.value))return{path:ke(),value:this.value};if(_e(e))return null;{const s=me(e),r=this.children.get(s);if(r!==null){const i=r.findRootMostMatchingPathAndValue(Ue(e),n);return i!=null?{path:Qe(new Re(s),i.path),value:i.value}:null}else return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(_e(e))return this;{const n=me(e),s=this.children.get(n);return s!==null?s.subtree(Ue(e)):new Be(null)}}set(e,n){if(_e(e))return new Be(n,this.children);{const s=me(e),i=(this.children.get(s)||new Be(null)).set(Ue(e),n),o=this.children.insert(s,i);return new Be(this.value,o)}}remove(e){if(_e(e))return this.children.isEmpty()?new Be(null):new Be(null,this.children);{const n=me(e),s=this.children.get(n);if(s){const r=s.remove(Ue(e));let i;return r.isEmpty()?i=this.children.remove(n):i=this.children.insert(n,r),this.value===null&&i.isEmpty()?new Be(null):new Be(this.value,i)}else return this}}get(e){if(_e(e))return this.value;{const n=me(e),s=this.children.get(n);return s?s.get(Ue(e)):null}}setTree(e,n){if(_e(e))return n;{const s=me(e),i=(this.children.get(s)||new Be(null)).setTree(Ue(e),n);let o;return i.isEmpty()?o=this.children.remove(s):o=this.children.insert(s,i),new Be(this.value,o)}}fold(e){return this.fold_(ke(),e)}fold_(e,n){const s={};return this.children.inorderTraversal((r,i)=>{s[r]=i.fold_(Qe(e,r),n)}),n(e,this.value,s)}findOnPath(e,n){return this.findOnPath_(e,ke(),n)}findOnPath_(e,n,s){const r=this.value?s(n,this.value):!1;if(r)return r;if(_e(e))return null;{const i=me(e),o=this.children.get(i);return o?o.findOnPath_(Ue(e),Qe(n,i),s):null}}foreachOnPath(e,n){return this.foreachOnPath_(e,ke(),n)}foreachOnPath_(e,n,s){if(_e(e))return this;{this.value&&s(n,this.value);const r=me(e),i=this.children.get(r);return i?i.foreachOnPath_(Ue(e),Qe(n,r),s):new Be(null)}}foreach(e){this.foreach_(ke(),e)}foreach_(e,n){this.children.inorderTraversal((s,r)=>{r.foreach_(Qe(e,s),n)}),this.value&&n(e,this.value)}foreachChild(e){this.children.inorderTraversal((n,s)=>{s.value&&e(n,s.value)})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gs{constructor(e){this.writeTree_=e}static empty(){return new gs(new Be(null))}}function ul(t,e,n){if(_e(e))return new gs(new Be(n));{const s=t.writeTree_.findRootMostValueAndPath(e);if(s!=null){const r=s.path;let i=s.value;const o=hn(r,e);return i=i.updateChild(o,n),new gs(t.writeTree_.set(r,i))}else{const r=new Be(n),i=t.writeTree_.setTree(e,r);return new gs(i)}}}function qm(t,e,n){let s=t;return Dt(n,(r,i)=>{s=ul(s,Qe(e,r),i)}),s}function mE(t,e){if(_e(e))return gs.empty();{const n=t.writeTree_.setTree(e,new Be(null));return new gs(n)}}function Km(t,e){return Vo(t,e)!=null}function Vo(t,e){const n=t.writeTree_.findRootMostValueAndPath(e);return n!=null?t.writeTree_.get(n.path).getChild(hn(n.path,e)):null}function _E(t){const e=[],n=t.writeTree_.value;return n!=null?n.isLeafNode()||n.forEachChild(Ke,(s,r)=>{e.push(new ye(s,r))}):t.writeTree_.children.inorderTraversal((s,r)=>{r.value!=null&&e.push(new ye(s,r.value))}),e}function Qr(t,e){if(_e(e))return t;{const n=Vo(t,e);return n!=null?new gs(new Be(n)):new gs(t.writeTree_.subtree(e))}}function Hm(t){return t.writeTree_.isEmpty()}function Ba(t,e){return Wk(ke(),t.writeTree_,e)}function Wk(t,e,n){if(e.value!=null)return n.updateChild(t,e.value);{let s=null;return e.children.inorderTraversal((r,i)=>{r===".priority"?(O(i.value!==null,"Priority writes must always be leaf nodes"),s=i.value):n=Wk(Qe(t,r),i,n)}),!n.getChild(t).isEmpty()&&s!==null&&(n=n.updateChild(Qe(t,".priority"),s)),n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yf(t,e){return Yk(e,t)}function NW(t,e,n,s,r){O(s>t.lastWriteId,"Stacking an older write on top of newer ones"),r===void 0&&(r=!0),t.allWrites.push({path:e,snap:n,writeId:s,visible:r}),r&&(t.visibleWrites=ul(t.visibleWrites,e,n)),t.lastWriteId=s}function PW(t,e,n,s){O(s>t.lastWriteId,"Stacking an older merge on top of newer ones"),t.allWrites.push({path:e,children:n,writeId:s,visible:!0}),t.visibleWrites=qm(t.visibleWrites,e,n),t.lastWriteId=s}function xW(t,e){for(let n=0;n<t.allWrites.length;n++){const s=t.allWrites[n];if(s.writeId===e)return s}return null}function DW(t,e){const n=t.allWrites.findIndex(a=>a.writeId===e);O(n>=0,"removeWrite called with nonexistent writeId.");const s=t.allWrites[n];t.allWrites.splice(n,1);let r=s.visible,i=!1,o=t.allWrites.length-1;for(;r&&o>=0;){const a=t.allWrites[o];a.visible&&(o>=n&&OW(a,s.path)?r=!1:Kn(s.path,a.path)&&(i=!0)),o--}if(r){if(i)return MW(t),!0;if(s.snap)t.visibleWrites=mE(t.visibleWrites,s.path);else{const a=s.children;Dt(a,c=>{t.visibleWrites=mE(t.visibleWrites,Qe(s.path,c))})}return!0}else return!1}function OW(t,e){if(t.snap)return Kn(t.path,e);for(const n in t.children)if(t.children.hasOwnProperty(n)&&Kn(Qe(t.path,n),e))return!0;return!1}function MW(t){t.visibleWrites=Gk(t.allWrites,LW,ke()),t.allWrites.length>0?t.lastWriteId=t.allWrites[t.allWrites.length-1].writeId:t.lastWriteId=-1}function LW(t){return t.visible}function Gk(t,e,n){let s=gs.empty();for(let r=0;r<t.length;++r){const i=t[r];if(e(i)){const o=i.path;let a;if(i.snap)Kn(n,o)?(a=hn(n,o),s=ul(s,a,i.snap)):Kn(o,n)&&(a=hn(o,n),s=ul(s,ke(),i.snap.getChild(a)));else if(i.children){if(Kn(n,o))a=hn(n,o),s=qm(s,a,i.children);else if(Kn(o,n))if(a=hn(o,n),_e(a))s=qm(s,ke(),i.children);else{const c=oo(i.children,me(a));if(c){const l=c.getChild(Ue(a));s=ul(s,ke(),l)}}}else throw ic("WriteRecord should have .snap or .children")}}return s}function zk(t,e,n,s,r){if(!s&&!r){const i=Vo(t.visibleWrites,e);if(i!=null)return i;{const o=Qr(t.visibleWrites,e);if(Hm(o))return n;if(n==null&&!Km(o,ke()))return null;{const a=n||re.EMPTY_NODE;return Ba(o,a)}}}else{const i=Qr(t.visibleWrites,e);if(!r&&Hm(i))return n;if(!r&&n==null&&!Km(i,ke()))return null;{const o=function(l){return(l.visible||r)&&(!s||!~s.indexOf(l.writeId))&&(Kn(l.path,e)||Kn(e,l.path))},a=Gk(t.allWrites,o,e),c=n||re.EMPTY_NODE;return Ba(a,c)}}}function FW(t,e,n){let s=re.EMPTY_NODE;const r=Vo(t.visibleWrites,e);if(r)return r.isLeafNode()||r.forEachChild(Ke,(i,o)=>{s=s.updateImmediateChild(i,o)}),s;if(n){const i=Qr(t.visibleWrites,e);return n.forEachChild(Ke,(o,a)=>{const c=Ba(Qr(i,new Re(o)),a);s=s.updateImmediateChild(o,c)}),_E(i).forEach(o=>{s=s.updateImmediateChild(o.name,o.node)}),s}else{const i=Qr(t.visibleWrites,e);return _E(i).forEach(o=>{s=s.updateImmediateChild(o.name,o.node)}),s}}function UW(t,e,n,s,r){O(s||r,"Either existingEventSnap or existingServerSnap must exist");const i=Qe(e,n);if(Km(t.visibleWrites,i))return null;{const o=Qr(t.visibleWrites,i);return Hm(o)?r.getChild(n):Ba(o,r.getChild(n))}}function $W(t,e,n,s){const r=Qe(e,n),i=Vo(t.visibleWrites,r);if(i!=null)return i;if(s.isCompleteForChild(n)){const o=Qr(t.visibleWrites,r);return Ba(o,s.getNode().getImmediateChild(n))}else return null}function VW(t,e){return Vo(t.visibleWrites,e)}function BW(t,e,n,s,r,i,o){let a;const c=Qr(t.visibleWrites,e),l=Vo(c,ke());if(l!=null)a=l;else if(n!=null)a=Ba(c,n);else return[];if(a=a.withIndex(o),!a.isEmpty()&&!a.isLeafNode()){const u=[],h=o.getCompare(),d=i?a.getReverseIteratorFrom(s,o):a.getIteratorFrom(s,o);let f=d.getNext();for(;f&&u.length<r;)h(f,s)!==0&&u.push(f),f=d.getNext();return u}else return[]}function jW(){return{visibleWrites:gs.empty(),allWrites:[],lastWriteId:-1}}function Rd(t,e,n,s){return zk(t.writeTree,t.treePath,e,n,s)}function ev(t,e){return FW(t.writeTree,t.treePath,e)}function yE(t,e,n,s){return UW(t.writeTree,t.treePath,e,n,s)}function Nd(t,e){return VW(t.writeTree,Qe(t.treePath,e))}function qW(t,e,n,s,r,i){return BW(t.writeTree,t.treePath,e,n,s,r,i)}function tv(t,e,n){return $W(t.writeTree,t.treePath,e,n)}function Qk(t,e){return Yk(Qe(t.treePath,e),t.writeTree)}function Yk(t,e){return{treePath:t,writeTree:e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KW{constructor(){this.changeMap=new Map}trackChildChange(e){const n=e.type,s=e.childName;O(n==="child_added"||n==="child_changed"||n==="child_removed","Only child changes supported for tracking"),O(s!==".priority","Only non-priority child changes can be tracked.");const r=this.changeMap.get(s);if(r){const i=r.type;if(n==="child_added"&&i==="child_removed")this.changeMap.set(s,Wl(s,e.snapshotNode,r.snapshotNode));else if(n==="child_removed"&&i==="child_added")this.changeMap.delete(s);else if(n==="child_removed"&&i==="child_changed")this.changeMap.set(s,Hl(s,r.oldSnap));else if(n==="child_changed"&&i==="child_added")this.changeMap.set(s,$a(s,e.snapshotNode));else if(n==="child_changed"&&i==="child_changed")this.changeMap.set(s,Wl(s,e.snapshotNode,r.oldSnap));else throw ic("Illegal combination of changes: "+e+" occurred after "+r)}else this.changeMap.set(s,e)}getChanges(){return Array.from(this.changeMap.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HW{getCompleteChild(e){return null}getChildAfterChild(e,n,s){return null}}const Jk=new HW;class nv{constructor(e,n,s=null){this.writes_=e,this.viewCache_=n,this.optCompleteServerCache_=s}getCompleteChild(e){const n=this.viewCache_.eventCache;if(n.isCompleteForChild(e))return n.getNode().getImmediateChild(e);{const s=this.optCompleteServerCache_!=null?new ii(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return tv(this.writes_,e,s)}}getChildAfterChild(e,n,s){const r=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:go(this.viewCache_),i=qW(this.writes_,r,n,1,s,e);return i.length===0?null:i[0]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function WW(t){return{filter:t}}function GW(t,e){O(e.eventCache.getNode().isIndexed(t.filter.getIndex()),"Event snap not indexed"),O(e.serverCache.getNode().isIndexed(t.filter.getIndex()),"Server snap not indexed")}function zW(t,e,n,s,r){const i=new KW;let o,a;if(n.type===us.OVERWRITE){const l=n;l.source.fromUser?o=Wm(t,e,l.path,l.snap,s,r,i):(O(l.source.fromServer,"Unknown source."),a=l.source.tagged||e.serverCache.isFiltered()&&!_e(l.path),o=Pd(t,e,l.path,l.snap,s,r,a,i))}else if(n.type===us.MERGE){const l=n;l.source.fromUser?o=YW(t,e,l.path,l.children,s,r,i):(O(l.source.fromServer,"Unknown source."),a=l.source.tagged||e.serverCache.isFiltered(),o=Gm(t,e,l.path,l.children,s,r,a,i))}else if(n.type===us.ACK_USER_WRITE){const l=n;l.revert?o=ZW(t,e,l.path,s,r,i):o=JW(t,e,l.path,l.affectedTree,s,r,i)}else if(n.type===us.LISTEN_COMPLETE)o=XW(t,e,n.path,s,i);else throw ic("Unknown operation type: "+n.type);const c=i.getChanges();return QW(e,o,c),{viewCache:o,changes:c}}function QW(t,e,n){const s=e.eventCache;if(s.isFullyInitialized()){const r=s.getNode().isLeafNode()||s.getNode().isEmpty(),i=kd(t);(n.length>0||!t.eventCache.isFullyInitialized()||r&&!s.getNode().equals(i)||!s.getNode().getPriority().equals(i.getPriority()))&&n.push(Kk(kd(e)))}}function Xk(t,e,n,s,r,i){const o=e.eventCache;if(Nd(s,n)!=null)return e;{let a,c;if(_e(n))if(O(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){const l=go(e),u=l instanceof re?l:re.EMPTY_NODE,h=ev(s,u);a=t.filter.updateFullNode(e.eventCache.getNode(),h,i)}else{const l=Rd(s,go(e));a=t.filter.updateFullNode(e.eventCache.getNode(),l,i)}else{const l=me(n);if(l===".priority"){O(ri(n)===1,"Can't have a priority with additional path components");const u=o.getNode();c=e.serverCache.getNode();const h=yE(s,n,u,c);h!=null?a=t.filter.updatePriority(u,h):a=o.getNode()}else{const u=Ue(n);let h;if(o.isCompleteForChild(l)){c=e.serverCache.getNode();const d=yE(s,n,o.getNode(),c);d!=null?h=o.getNode().getImmediateChild(l).updateChild(u,d):h=o.getNode().getImmediateChild(l)}else h=tv(s,l,e.serverCache);h!=null?a=t.filter.updateChild(o.getNode(),l,h,u,r,i):a=o.getNode()}}return ll(e,a,o.isFullyInitialized()||_e(n),t.filter.filtersNodes())}}function Pd(t,e,n,s,r,i,o,a){const c=e.serverCache;let l;const u=o?t.filter:t.filter.getIndexedFilter();if(_e(n))l=u.updateFullNode(c.getNode(),s,null);else if(u.filtersNodes()&&!c.isFiltered()){const f=c.getNode().updateChild(n,s);l=u.updateFullNode(c.getNode(),f,null)}else{const f=me(n);if(!c.isCompleteForPath(n)&&ri(n)>1)return e;const p=Ue(n),y=c.getNode().getImmediateChild(f).updateChild(p,s);f===".priority"?l=u.updatePriority(c.getNode(),y):l=u.updateChild(c.getNode(),f,y,p,Jk,null)}const h=Hk(e,l,c.isFullyInitialized()||_e(n),u.filtersNodes()),d=new nv(r,h,i);return Xk(t,h,n,r,d,a)}function Wm(t,e,n,s,r,i,o){const a=e.eventCache;let c,l;const u=new nv(r,e,i);if(_e(n))l=t.filter.updateFullNode(e.eventCache.getNode(),s,o),c=ll(e,l,!0,t.filter.filtersNodes());else{const h=me(n);if(h===".priority")l=t.filter.updatePriority(e.eventCache.getNode(),s),c=ll(e,l,a.isFullyInitialized(),a.isFiltered());else{const d=Ue(n),f=a.getNode().getImmediateChild(h);let p;if(_e(d))p=s;else{const _=u.getCompleteChild(h);_!=null?Ky(d)===".priority"&&_.getChild(Mk(d)).isEmpty()?p=_:p=_.updateChild(d,s):p=re.EMPTY_NODE}if(f.equals(p))c=e;else{const _=t.filter.updateChild(a.getNode(),h,p,d,u,o);c=ll(e,_,a.isFullyInitialized(),t.filter.filtersNodes())}}}return c}function vE(t,e){return t.eventCache.isCompleteForChild(e)}function YW(t,e,n,s,r,i,o){let a=e;return s.foreach((c,l)=>{const u=Qe(n,c);vE(e,me(u))&&(a=Wm(t,a,u,l,r,i,o))}),s.foreach((c,l)=>{const u=Qe(n,c);vE(e,me(u))||(a=Wm(t,a,u,l,r,i,o))}),a}function wE(t,e,n){return n.foreach((s,r)=>{e=e.updateChild(s,r)}),e}function Gm(t,e,n,s,r,i,o,a){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let c=e,l;_e(n)?l=s:l=new Be(null).setTree(n,s);const u=e.serverCache.getNode();return l.children.inorderTraversal((h,d)=>{if(u.hasChild(h)){const f=e.serverCache.getNode().getImmediateChild(h),p=wE(t,f,d);c=Pd(t,c,new Re(h),p,r,i,o,a)}}),l.children.inorderTraversal((h,d)=>{const f=!e.serverCache.isCompleteForChild(h)&&d.value===void 0;if(!u.hasChild(h)&&!f){const p=e.serverCache.getNode().getImmediateChild(h),_=wE(t,p,d);c=Pd(t,c,new Re(h),_,r,i,o,a)}}),c}function JW(t,e,n,s,r,i,o){if(Nd(r,n)!=null)return e;const a=e.serverCache.isFiltered(),c=e.serverCache;if(s.value!=null){if(_e(n)&&c.isFullyInitialized()||c.isCompleteForPath(n))return Pd(t,e,n,c.getNode().getChild(n),r,i,a,o);if(_e(n)){let l=new Be(null);return c.getNode().forEachChild(Os,(u,h)=>{l=l.set(new Re(u),h)}),Gm(t,e,n,l,r,i,a,o)}else return e}else{let l=new Be(null);return s.foreach((u,h)=>{const d=Qe(n,u);c.isCompleteForPath(d)&&(l=l.set(u,c.getNode().getChild(d)))}),Gm(t,e,n,l,r,i,a,o)}}function XW(t,e,n,s,r){const i=e.serverCache,o=Hk(e,i.getNode(),i.isFullyInitialized()||_e(n),i.isFiltered());return Xk(t,o,n,s,Jk,r)}function ZW(t,e,n,s,r,i){let o;if(Nd(s,n)!=null)return e;{const a=new nv(s,e,r),c=e.eventCache.getNode();let l;if(_e(n)||me(n)===".priority"){let u;if(e.serverCache.isFullyInitialized())u=Rd(s,go(e));else{const h=e.serverCache.getNode();O(h instanceof re,"serverChildren would be complete if leaf node"),u=ev(s,h)}u=u,l=t.filter.updateFullNode(c,u,i)}else{const u=me(n);let h=tv(s,u,e.serverCache);h==null&&e.serverCache.isCompleteForChild(u)&&(h=c.getImmediateChild(u)),h!=null?l=t.filter.updateChild(c,u,h,Ue(n),a,i):e.eventCache.getNode().hasChild(u)?l=t.filter.updateChild(c,u,re.EMPTY_NODE,Ue(n),a,i):l=c,l.isEmpty()&&e.serverCache.isFullyInitialized()&&(o=Rd(s,go(e)),o.isLeafNode()&&(l=t.filter.updateFullNode(l,o,i)))}return o=e.serverCache.isFullyInitialized()||Nd(s,ke())!=null,ll(e,l,o,t.filter.filtersNodes())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eG{constructor(e,n){this.query_=e,this.eventRegistrations_=[];const s=this.query_._queryParams,r=new Yy(s.getIndex()),i=pW(s);this.processor_=WW(i);const o=n.serverCache,a=n.eventCache,c=r.updateFullNode(re.EMPTY_NODE,o.getNode(),null),l=i.updateFullNode(re.EMPTY_NODE,a.getNode(),null),u=new ii(c,o.isFullyInitialized(),r.filtersNodes()),h=new ii(l,a.isFullyInitialized(),i.filtersNodes());this.viewCache_=Qf(h,u),this.eventGenerator_=new SW(this.query_)}get query(){return this.query_}}function tG(t){return t.viewCache_.serverCache.getNode()}function nG(t){return kd(t.viewCache_)}function sG(t,e){const n=go(t.viewCache_);return n&&(t.query._queryParams.loadsAllData()||!_e(e)&&!n.getImmediateChild(me(e)).isEmpty())?n.getChild(e):null}function bE(t){return t.eventRegistrations_.length===0}function rG(t,e){t.eventRegistrations_.push(e)}function IE(t,e,n){const s=[];if(n){O(e==null,"A cancel should cancel all event registrations.");const r=t.query._path;t.eventRegistrations_.forEach(i=>{const o=i.createCancelEvent(n,r);o&&s.push(o)})}if(e){let r=[];for(let i=0;i<t.eventRegistrations_.length;++i){const o=t.eventRegistrations_[i];if(!o.matches(e))r.push(o);else if(e.hasAnyCallback()){r=r.concat(t.eventRegistrations_.slice(i+1));break}}t.eventRegistrations_=r}else t.eventRegistrations_=[];return s}function EE(t,e,n,s){e.type===us.MERGE&&e.source.queryId!==null&&(O(go(t.viewCache_),"We should always have a full cache before handling merges"),O(kd(t.viewCache_),"Missing event cache, even though we have a server cache"));const r=t.viewCache_,i=zW(t.processor_,r,e,n,s);return GW(t.processor_,i.viewCache),O(i.viewCache.serverCache.isFullyInitialized()||!r.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),t.viewCache_=i.viewCache,Zk(t,i.changes,i.viewCache.eventCache.getNode(),null)}function iG(t,e){const n=t.viewCache_.eventCache,s=[];return n.getNode().isLeafNode()||n.getNode().forEachChild(Ke,(i,o)=>{s.push($a(i,o))}),n.isFullyInitialized()&&s.push(Kk(n.getNode())),Zk(t,s,n.getNode(),e)}function Zk(t,e,n,s){const r=s?[s]:t.eventRegistrations_;return CW(t.eventGenerator_,e,n,r)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let xd;class eR{constructor(){this.views=new Map}}function oG(t){O(!xd,"__referenceConstructor has already been defined"),xd=t}function aG(){return O(xd,"Reference.ts has not been loaded"),xd}function cG(t){return t.views.size===0}function sv(t,e,n,s){const r=e.source.queryId;if(r!==null){const i=t.views.get(r);return O(i!=null,"SyncTree gave us an op for an invalid query."),EE(i,e,n,s)}else{let i=[];for(const o of t.views.values())i=i.concat(EE(o,e,n,s));return i}}function rv(t,e,n,s,r){const i=e._queryIdentifier,o=t.views.get(i);if(!o){let a=Rd(n,r?s:null),c=!1;a?c=!0:s instanceof re?(a=ev(n,s),c=!1):(a=re.EMPTY_NODE,c=!1);const l=Qf(new ii(a,c,!1),new ii(s,r,!1));return new eG(e,l)}return o}function lG(t,e,n,s,r,i){const o=rv(t,e,s,r,i);return t.views.has(e._queryIdentifier)||t.views.set(e._queryIdentifier,o),rG(o,n),iG(o,n)}function uG(t,e,n,s){const r=e._queryIdentifier,i=[];let o=[];const a=oi(t);if(r==="default")for(const[c,l]of t.views.entries())o=o.concat(IE(l,n,s)),bE(l)&&(t.views.delete(c),l.query._queryParams.loadsAllData()||i.push(l.query));else{const c=t.views.get(r);c&&(o=o.concat(IE(c,n,s)),bE(c)&&(t.views.delete(r),c.query._queryParams.loadsAllData()||i.push(c.query)))}return a&&!oi(t)&&i.push(new(aG())(e._repo,e._path)),{removed:i,events:o}}function tR(t){const e=[];for(const n of t.views.values())n.query._queryParams.loadsAllData()||e.push(n);return e}function Yr(t,e){let n=null;for(const s of t.views.values())n=n||sG(s,e);return n}function nR(t,e){if(e._queryParams.loadsAllData())return Jf(t);{const s=e._queryIdentifier;return t.views.get(s)}}function sR(t,e){return nR(t,e)!=null}function oi(t){return Jf(t)!=null}function Jf(t){for(const e of t.views.values())if(e.query._queryParams.loadsAllData())return e;return null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Dd;function hG(t){O(!Dd,"__referenceConstructor has already been defined"),Dd=t}function dG(){return O(Dd,"Reference.ts has not been loaded"),Dd}let fG=1;class TE{constructor(e){this.listenProvider_=e,this.syncPointTree_=new Be(null),this.pendingWriteTree_=jW(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function iv(t,e,n,s,r){return NW(t.pendingWriteTree_,e,n,s,r),r?fc(t,new po(Jy(),e,n)):[]}function pG(t,e,n,s){PW(t.pendingWriteTree_,e,n,s);const r=Be.fromObject(n);return fc(t,new Va(Jy(),e,r))}function Kr(t,e,n=!1){const s=xW(t.pendingWriteTree_,e);if(DW(t.pendingWriteTree_,e)){let i=new Be(null);return s.snap!=null?i=i.set(ke(),!0):Dt(s.children,o=>{i=i.set(new Re(o),!0)}),fc(t,new Ad(s.path,i,n))}else return[]}function Du(t,e,n){return fc(t,new po(Xy(),e,n))}function gG(t,e,n){const s=Be.fromObject(n);return fc(t,new Va(Xy(),e,s))}function mG(t,e){return fc(t,new zl(Xy(),e))}function _G(t,e,n){const s=ov(t,n);if(s){const r=av(s),i=r.path,o=r.queryId,a=hn(i,e),c=new zl(Zy(o),a);return cv(t,i,c)}else return[]}function Od(t,e,n,s){const r=e._path,i=t.syncPointTree_.get(r);let o=[];if(i&&(e._queryIdentifier==="default"||sR(i,e))){const a=uG(i,e,n,s);cG(i)&&(t.syncPointTree_=t.syncPointTree_.remove(r));const c=a.removed;o=a.events;const l=c.findIndex(h=>h._queryParams.loadsAllData())!==-1,u=t.syncPointTree_.findOnPath(r,(h,d)=>oi(d));if(l&&!u){const h=t.syncPointTree_.subtree(r);if(!h.isEmpty()){const d=bG(h);for(let f=0;f<d.length;++f){const p=d[f],_=p.query,y=cR(t,p);t.listenProvider_.startListening(hl(_),Ql(t,_),y.hashFn,y.onComplete)}}}!u&&c.length>0&&!s&&(l?t.listenProvider_.stopListening(hl(e),null):c.forEach(h=>{const d=t.queryToTagMap.get(Zf(h));t.listenProvider_.stopListening(hl(h),d)})),IG(t,c)}return o}function yG(t,e){const{syncPoint:n,serverCache:s,writesCache:r,serverCacheComplete:i}=iR(e,t),o=rv(n,e,r,s,i);return n.views.has(e._queryIdentifier)||n.views.set(e._queryIdentifier,o),e._queryParams.loadsAllData()?null:Ql(t,e)}function rR(t,e,n,s){const r=ov(t,s);if(r!=null){const i=av(r),o=i.path,a=i.queryId,c=hn(o,e),l=new po(Zy(a),c,n);return cv(t,o,l)}else return[]}function vG(t,e,n,s){const r=ov(t,s);if(r){const i=av(r),o=i.path,a=i.queryId,c=hn(o,e),l=Be.fromObject(n),u=new Va(Zy(a),c,l);return cv(t,o,u)}else return[]}function iR(t,e){const n=t._path;let s=null,r=!1;e.syncPointTree_.foreachOnPath(n,(l,u)=>{const h=hn(l,n);s=s||Yr(u,h),r=r||oi(u)});let i=e.syncPointTree_.get(n);i?(r=r||oi(i),s=s||Yr(i,ke())):(i=new eR,e.syncPointTree_=e.syncPointTree_.set(n,i));let o;s!=null?o=!0:(o=!1,s=re.EMPTY_NODE,e.syncPointTree_.subtree(n).foreachChild((u,h)=>{const d=Yr(h,ke());d&&(s=s.updateImmediateChild(u,d))}));const a=sR(i,t);if(!a&&!t._queryParams.loadsAllData()){const l=Zf(t);O(!e.queryToTagMap.has(l),"View does not exist, but we have a tag");const u=EG();e.queryToTagMap.set(l,u),e.tagToQueryMap.set(u,l)}const c=Yf(e.pendingWriteTree_,n);return{syncPoint:i,writesCache:c,serverCache:s,serverCacheComplete:o,foundAncestorDefaultView:r,viewAlreadyExists:a}}function SE(t,e,n){const{syncPoint:s,serverCache:r,writesCache:i,serverCacheComplete:o,viewAlreadyExists:a,foundAncestorDefaultView:c}=iR(e,t);let l=lG(s,e,n,i,r,o);if(!a&&!c){const u=nR(s,e);l=l.concat(TG(t,e,u))}return l}function Xf(t,e,n){const r=t.pendingWriteTree_,i=t.syncPointTree_.findOnPath(e,(o,a)=>{const c=hn(o,e),l=Yr(a,c);if(l)return l});return zk(r,e,i,n,!0)}function wG(t,e){const n=e._path;let s=null;t.syncPointTree_.foreachOnPath(n,(l,u)=>{const h=hn(l,n);s=s||Yr(u,h)});let r=t.syncPointTree_.get(n);r?s=s||Yr(r,ke()):(r=new eR,t.syncPointTree_=t.syncPointTree_.set(n,r));const i=s!=null,o=i?new ii(s,!0,!1):null,a=Yf(t.pendingWriteTree_,e._path),c=rv(r,e,a,i?o.getNode():re.EMPTY_NODE,i);return nG(c)}function fc(t,e){return oR(e,t.syncPointTree_,null,Yf(t.pendingWriteTree_,ke()))}function oR(t,e,n,s){if(_e(t.path))return aR(t,e,n,s);{const r=e.get(ke());n==null&&r!=null&&(n=Yr(r,ke()));let i=[];const o=me(t.path),a=t.operationForChild(o),c=e.children.get(o);if(c&&a){const l=n?n.getImmediateChild(o):null,u=Qk(s,o);i=i.concat(oR(a,c,l,u))}return r&&(i=i.concat(sv(r,t,s,n))),i}}function aR(t,e,n,s){const r=e.get(ke());n==null&&r!=null&&(n=Yr(r,ke()));let i=[];return e.children.inorderTraversal((o,a)=>{const c=n?n.getImmediateChild(o):null,l=Qk(s,o),u=t.operationForChild(o);u&&(i=i.concat(aR(u,a,c,l)))}),r&&(i=i.concat(sv(r,t,s,n))),i}function cR(t,e){const n=e.query,s=Ql(t,n);return{hashFn:()=>(tG(e)||re.EMPTY_NODE).hash(),onComplete:r=>{if(r==="ok")return s?_G(t,n._path,s):mG(t,n._path);{const i=gH(r,n);return Od(t,n,null,i)}}}}function Ql(t,e){const n=Zf(e);return t.queryToTagMap.get(n)}function Zf(t){return t._path.toString()+"$"+t._queryIdentifier}function ov(t,e){return t.tagToQueryMap.get(e)}function av(t){const e=t.indexOf("$");return O(e!==-1&&e<t.length-1,"Bad queryKey."),{queryId:t.substr(e+1),path:new Re(t.substr(0,e))}}function cv(t,e,n){const s=t.syncPointTree_.get(e);O(s,"Missing sync point for query tag that we're tracking");const r=Yf(t.pendingWriteTree_,e);return sv(s,n,r,null)}function bG(t){return t.fold((e,n,s)=>{if(n&&oi(n))return[Jf(n)];{let r=[];return n&&(r=tR(n)),Dt(s,(i,o)=>{r=r.concat(o)}),r}})}function hl(t){return t._queryParams.loadsAllData()&&!t._queryParams.isDefault()?new(dG())(t._repo,t._path):t}function IG(t,e){for(let n=0;n<e.length;++n){const s=e[n];if(!s._queryParams.loadsAllData()){const r=Zf(s),i=t.queryToTagMap.get(r);t.queryToTagMap.delete(r),t.tagToQueryMap.delete(i)}}}function EG(){return fG++}function TG(t,e,n){const s=e._path,r=Ql(t,e),i=cR(t,n),o=t.listenProvider_.startListening(hl(e),r,i.hashFn,i.onComplete),a=t.syncPointTree_.subtree(s);if(r)O(!oi(a.value),"If we're adding a query, it shouldn't be shadowed");else{const c=a.fold((l,u,h)=>{if(!_e(l)&&u&&oi(u))return[Jf(u).query];{let d=[];return u&&(d=d.concat(tR(u).map(f=>f.query))),Dt(h,(f,p)=>{d=d.concat(p)}),d}});for(let l=0;l<c.length;++l){const u=c[l];t.listenProvider_.stopListening(hl(u),Ql(t,u))}}return o}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lv{constructor(e){this.node_=e}getImmediateChild(e){const n=this.node_.getImmediateChild(e);return new lv(n)}node(){return this.node_}}class uv{constructor(e,n){this.syncTree_=e,this.path_=n}getImmediateChild(e){const n=Qe(this.path_,e);return new uv(this.syncTree_,n)}node(){return Xf(this.syncTree_,this.path_)}}const SG=function(t){return t=t||{},t.timestamp=t.timestamp||new Date().getTime(),t},CE=function(t,e,n){if(!t||typeof t!="object")return t;if(O(".sv"in t,"Unexpected leaf node or priority contents"),typeof t[".sv"]=="string")return CG(t[".sv"],e,n);if(typeof t[".sv"]=="object")return AG(t[".sv"],e);O(!1,"Unexpected server value: "+JSON.stringify(t,null,2))},CG=function(t,e,n){switch(t){case"timestamp":return n.timestamp;default:O(!1,"Unexpected server value: "+t)}},AG=function(t,e,n){t.hasOwnProperty("increment")||O(!1,"Unexpected server value: "+JSON.stringify(t,null,2));const s=t.increment;typeof s!="number"&&O(!1,"Unexpected increment value: "+s);const r=e.node();if(O(r!==null&&typeof r<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!r.isLeafNode())return s;const o=r.getValue();return typeof o!="number"?s:o+s},lR=function(t,e,n,s){return dv(e,new uv(n,t),s)},hv=function(t,e,n){return dv(t,new lv(e),n)};function dv(t,e,n){const s=t.getPriority().val(),r=CE(s,e.getImmediateChild(".priority"),n);let i;if(t.isLeafNode()){const o=t,a=CE(o.getValue(),e,n);return a!==o.getValue()||r!==o.getPriority().val()?new wt(a,Xe(r)):t}else{const o=t;return i=o,r!==o.getPriority().val()&&(i=i.updatePriority(new wt(r))),o.forEachChild(Ke,(a,c)=>{const l=dv(c,e.getImmediateChild(a),n);l!==c&&(i=i.updateImmediateChild(a,l))}),i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fv{constructor(e="",n=null,s={children:{},childCount:0}){this.name=e,this.parent=n,this.node=s}}function ep(t,e){let n=e instanceof Re?e:new Re(e),s=t,r=me(n);for(;r!==null;){const i=oo(s.node.children,r)||{children:{},childCount:0};s=new fv(r,s,i),n=Ue(n),r=me(n)}return s}function Bo(t){return t.node.value}function pv(t,e){t.node.value=e,zm(t)}function uR(t){return t.node.childCount>0}function kG(t){return Bo(t)===void 0&&!uR(t)}function tp(t,e){Dt(t.node.children,(n,s)=>{e(new fv(n,t,s))})}function hR(t,e,n,s){n&&!s&&e(t),tp(t,r=>{hR(r,e,!0,s)}),n&&s&&e(t)}function RG(t,e,n){let s=n?t:t.parent;for(;s!==null;){if(e(s))return!0;s=s.parent}return!1}function Ou(t){return new Re(t.parent===null?t.name:Ou(t.parent)+"/"+t.name)}function zm(t){t.parent!==null&&NG(t.parent,t.name,t)}function NG(t,e,n){const s=kG(n),r=Mn(t.node.children,e);s&&r?(delete t.node.children[e],t.node.childCount--,zm(t)):!s&&!r&&(t.node.children[e]=n.node,t.node.childCount++,zm(t))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PG=/[\[\].#$\/\u0000-\u001F\u007F]/,xG=/[\[\].#$\u0000-\u001F\u007F]/,bg=10*1024*1024,np=function(t){return typeof t=="string"&&t.length!==0&&!PG.test(t)},dR=function(t){return typeof t=="string"&&t.length!==0&&!xG.test(t)},DG=function(t){return t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),dR(t)},Yl=function(t){return t===null||typeof t=="string"||typeof t=="number"&&!Hf(t)||t&&typeof t=="object"&&Mn(t,".sv")},Ks=function(t,e,n,s){s&&e===void 0||Mu(In(t,"value"),e,n)},Mu=function(t,e,n){const s=n instanceof Re?new GH(n,t):n;if(e===void 0)throw new Error(t+"contains undefined "+xi(s));if(typeof e=="function")throw new Error(t+"contains a function "+xi(s)+" with contents = "+e.toString());if(Hf(e))throw new Error(t+"contains "+e.toString()+" "+xi(s));if(typeof e=="string"&&e.length>bg/3&&Rf(e)>bg)throw new Error(t+"contains a string greater than "+bg+" utf8 bytes "+xi(s)+" ('"+e.substring(0,50)+"...')");if(e&&typeof e=="object"){let r=!1,i=!1;if(Dt(e,(o,a)=>{if(o===".value")r=!0;else if(o!==".priority"&&o!==".sv"&&(i=!0,!np(o)))throw new Error(t+" contains an invalid key ("+o+") "+xi(s)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);zH(s,o),Mu(t,a,s),QH(s)}),r&&i)throw new Error(t+' contains ".value" child '+xi(s)+" in addition to actual children.")}},OG=function(t,e){let n,s;for(n=0;n<e.length;n++){s=e[n];const i=Kl(s);for(let o=0;o<i.length;o++)if(!(i[o]===".priority"&&o===i.length-1)){if(!np(i[o]))throw new Error(t+"contains an invalid key ("+i[o]+") in path "+s.toString()+`. Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`)}}e.sort(WH);let r=null;for(n=0;n<e.length;n++){if(s=e[n],r!==null&&Kn(r,s))throw new Error(t+"contains a path "+r.toString()+" that is ancestor of another path "+s.toString());r=s}},fR=function(t,e,n,s){if(s&&e===void 0)return;const r=In(t,"values");if(!(e&&typeof e=="object")||Array.isArray(e))throw new Error(r+" must be an object containing the children to replace.");const i=[];Dt(e,(o,a)=>{const c=new Re(o);if(Mu(r,a,Qe(n,c)),Ky(c)===".priority"&&!Yl(a))throw new Error(r+"contains an invalid value for '"+c.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");i.push(c)}),OG(r,i)},gv=function(t,e,n){if(!(n&&e===void 0)){if(Hf(e))throw new Error(In(t,"priority")+"is "+e.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!Yl(e))throw new Error(In(t,"priority")+"must be a valid Firebase priority (a string, finite number, server value, or null).")}},Lu=function(t,e,n,s){if(!(s&&n===void 0)&&!np(n))throw new Error(In(t,e)+'was an invalid key = "'+n+`".  Firebase keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]").`)},Jl=function(t,e,n,s){if(!(s&&n===void 0)&&!dR(n))throw new Error(In(t,e)+'was an invalid path = "'+n+`". Paths must be non-empty strings and can't contain ".", "#", "$", "[", or "]"`)},MG=function(t,e,n,s){n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),Jl(t,e,n,s)},Hn=function(t,e){if(me(e)===".info")throw new Error(t+" failed = Can't modify data under /.info/")},pR=function(t,e){const n=e.path.toString();if(typeof e.repoInfo.host!="string"||e.repoInfo.host.length===0||!np(e.repoInfo.namespace)&&e.repoInfo.host.split(":")[0]!=="localhost"||n.length!==0&&!DG(n))throw new Error(In(t,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LG{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function sp(t,e){let n=null;for(let s=0;s<e.length;s++){const r=e[s],i=r.getPath();n!==null&&!Hy(i,n.path)&&(t.eventLists_.push(n),n=null),n===null&&(n={events:[],path:i}),n.events.push(r)}n&&t.eventLists_.push(n)}function gR(t,e,n){sp(t,n),mR(t,s=>Hy(s,e))}function Jn(t,e,n){sp(t,n),mR(t,s=>Kn(s,e)||Kn(e,s))}function mR(t,e){t.recursionDepth_++;let n=!0;for(let s=0;s<t.eventLists_.length;s++){const r=t.eventLists_[s];if(r){const i=r.path;e(i)?(FG(t.eventLists_[s]),t.eventLists_[s]=null):n=!1}}n&&(t.eventLists_=[]),t.recursionDepth_--}function FG(t){for(let e=0;e<t.events.length;e++){const n=t.events[e];if(n!==null){t.events[e]=null;const s=n.getEventRunner();ro&&Ct("event: "+n.toString()),hc(s)}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _R="repo_interrupt",UG=25;class $G{constructor(e,n,s,r){this.repoInfo_=e,this.forceRestClient_=n,this.authTokenProvider_=s,this.appCheckProvider_=r,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new LG,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=Cd(),this.transactionQueueTree_=new fv,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function VG(t,e,n){if(t.stats_=jy(t.repoInfo_),t.forceRestClient_||_H())t.server_=new Sd(t.repoInfo_,(s,r,i,o)=>{AE(t,s,r,i,o)},t.authTokenProvider_,t.appCheckProvider_),setTimeout(()=>kE(t,!0),0);else{if(typeof n<"u"&&n!==null){if(typeof n!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{gt(n)}catch(s){throw new Error("Invalid authOverride provided: "+s)}}t.persistentConnection_=new hr(t.repoInfo_,e,(s,r,i,o)=>{AE(t,s,r,i,o)},s=>{kE(t,s)},s=>{BG(t,s)},t.authTokenProvider_,t.appCheckProvider_,n),t.server_=t.persistentConnection_}t.authTokenProvider_.addTokenChangeListener(s=>{t.server_.refreshAuthToken(s)}),t.appCheckProvider_.addTokenChangeListener(s=>{t.server_.refreshAppCheckToken(s.token)}),t.statsReporter_=IH(t.repoInfo_,()=>new TW(t.stats_,t.server_)),t.infoData_=new vW,t.infoSyncTree_=new TE({startListening:(s,r,i,o)=>{let a=[];const c=t.infoData_.getNode(s._path);return c.isEmpty()||(a=Du(t.infoSyncTree_,s._path,c),setTimeout(()=>{o("ok")},0)),a},stopListening:()=>{}}),mv(t,"connected",!1),t.serverSyncTree_=new TE({startListening:(s,r,i,o)=>(t.server_.listen(s,i,r,(a,c)=>{const l=o(a,c);Jn(t.eventQueue_,s._path,l)}),[]),stopListening:(s,r)=>{t.server_.unlisten(s,r)}})}function yR(t){const n=t.infoData_.getNode(new Re(".info/serverTimeOffset")).val()||0;return new Date().getTime()+n}function Fu(t){return SG({timestamp:yR(t)})}function AE(t,e,n,s,r){t.dataUpdateCount++;const i=new Re(e);n=t.interceptServerDataCallback_?t.interceptServerDataCallback_(e,n):n;let o=[];if(r)if(s){const c=ld(n,l=>Xe(l));o=vG(t.serverSyncTree_,i,c,r)}else{const c=Xe(n);o=rR(t.serverSyncTree_,i,c,r)}else if(s){const c=ld(n,l=>Xe(l));o=gG(t.serverSyncTree_,i,c)}else{const c=Xe(n);o=Du(t.serverSyncTree_,i,c)}let a=i;o.length>0&&(a=ja(t,i)),Jn(t.eventQueue_,a,o)}function kE(t,e){mv(t,"connected",e),e===!1&&KG(t)}function BG(t,e){Dt(e,(n,s)=>{mv(t,n,s)})}function mv(t,e,n){const s=new Re("/.info/"+e),r=Xe(n);t.infoData_.updateSnapshot(s,r);const i=Du(t.infoSyncTree_,s,r);Jn(t.eventQueue_,s,i)}function rp(t){return t.nextWriteId_++}function jG(t,e){const n=wG(t.serverSyncTree_,e);return n!=null?Promise.resolve(n):t.server_.get(e).then(s=>{const r=Xe(s).withIndex(e._queryParams.getIndex());if(e._queryParams.loadsAllData())Du(t.serverSyncTree_,e._path,r);else{const o=yG(t.serverSyncTree_,e);rR(t.serverSyncTree_,e._path,r,o)}return Od(t.serverSyncTree_,e,null).length>0&&mo(t,"unexpected cancel events in repoGetValue"),r},s=>(mo(t,"get for query "+gt(e)+" failed: "+s),Promise.reject(new Error(s))))}function _v(t,e,n,s,r){mo(t,"set",{path:e.toString(),value:n,priority:s});const i=Fu(t),o=Xe(n,s),a=Xf(t.serverSyncTree_,e),c=hv(o,a,i),l=rp(t),u=iv(t.serverSyncTree_,e,c,l,!0);sp(t.eventQueue_,u),t.server_.put(e.toString(),o.val(!0),(d,f)=>{const p=d==="ok";p||Zt("set at "+e+" failed: "+d);const _=Kr(t.serverSyncTree_,l,!p);Jn(t.eventQueue_,e,_),ai(t,r,d,f)});const h=vv(t,e);ja(t,h),Jn(t.eventQueue_,h,[])}function qG(t,e,n,s){mo(t,"update",{path:e.toString(),value:n});let r=!0;const i=Fu(t),o={};if(Dt(n,(a,c)=>{r=!1,o[a]=lR(Qe(e,a),Xe(c),t.serverSyncTree_,i)}),r)Ct("update() called with empty data.  Don't do anything."),ai(t,s,"ok",void 0);else{const a=rp(t),c=pG(t.serverSyncTree_,e,o,a);sp(t.eventQueue_,c),t.server_.merge(e.toString(),n,(l,u)=>{const h=l==="ok";h||Zt("update at "+e+" failed: "+l);const d=Kr(t.serverSyncTree_,a,!h),f=d.length>0?ja(t,e):e;Jn(t.eventQueue_,f,d),ai(t,s,l,u)}),Dt(n,l=>{const u=vv(t,Qe(e,l));ja(t,u)}),Jn(t.eventQueue_,e,[])}}function KG(t){mo(t,"onDisconnectEvents");const e=Fu(t),n=Cd();jm(t.onDisconnect_,ke(),(r,i)=>{const o=lR(r,i,t.serverSyncTree_,e);dc(n,r,o)});let s=[];jm(n,ke(),(r,i)=>{s=s.concat(Du(t.serverSyncTree_,r,i));const o=vv(t,r);ja(t,o)}),t.onDisconnect_=Cd(),Jn(t.eventQueue_,ke(),s)}function HG(t,e,n){t.server_.onDisconnectCancel(e.toString(),(s,r)=>{s==="ok"&&Bm(t.onDisconnect_,e),ai(t,n,s,r)})}function RE(t,e,n,s){const r=Xe(n);t.server_.onDisconnectPut(e.toString(),r.val(!0),(i,o)=>{i==="ok"&&dc(t.onDisconnect_,e,r),ai(t,s,i,o)})}function WG(t,e,n,s,r){const i=Xe(n,s);t.server_.onDisconnectPut(e.toString(),i.val(!0),(o,a)=>{o==="ok"&&dc(t.onDisconnect_,e,i),ai(t,r,o,a)})}function GG(t,e,n,s){if(cd(n)){Ct("onDisconnect().update() called with empty data.  Don't do anything."),ai(t,s,"ok",void 0);return}t.server_.onDisconnectMerge(e.toString(),n,(r,i)=>{r==="ok"&&Dt(n,(o,a)=>{const c=Xe(a);dc(t.onDisconnect_,Qe(e,o),c)}),ai(t,s,r,i)})}function zG(t,e,n){let s;me(e._path)===".info"?s=SE(t.infoSyncTree_,e,n):s=SE(t.serverSyncTree_,e,n),gR(t.eventQueue_,e._path,s)}function Qm(t,e,n){let s;me(e._path)===".info"?s=Od(t.infoSyncTree_,e,n):s=Od(t.serverSyncTree_,e,n),gR(t.eventQueue_,e._path,s)}function vR(t){t.persistentConnection_&&t.persistentConnection_.interrupt(_R)}function QG(t){t.persistentConnection_&&t.persistentConnection_.resume(_R)}function mo(t,...e){let n="";t.persistentConnection_&&(n=t.persistentConnection_.id+":"),Ct(n,...e)}function ai(t,e,n,s){e&&hc(()=>{if(n==="ok")e(null);else{const r=(n||"error").toUpperCase();let i=r;s&&(i+=": "+s);const o=new Error(i);o.code=r,e(o)}})}function YG(t,e,n,s,r,i){mo(t,"transaction on "+e);const o={path:e,update:n,onComplete:s,status:null,order:hk(),applyLocally:i,retryCount:0,unwatcher:r,abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},a=yv(t,e,void 0);o.currentInputSnapshot=a;const c=o.update(a.val());if(c===void 0)o.unwatcher(),o.currentOutputSnapshotRaw=null,o.currentOutputSnapshotResolved=null,o.onComplete&&o.onComplete(null,!1,o.currentInputSnapshot);else{Mu("transaction failed: Data returned ",c,o.path),o.status=0;const l=ep(t.transactionQueueTree_,e),u=Bo(l)||[];u.push(o),pv(l,u);let h;typeof c=="object"&&c!==null&&Mn(c,".priority")?(h=oo(c,".priority"),O(Yl(h),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.")):h=(Xf(t.serverSyncTree_,e)||re.EMPTY_NODE).getPriority().val();const d=Fu(t),f=Xe(c,h),p=hv(f,a,d);o.currentOutputSnapshotRaw=f,o.currentOutputSnapshotResolved=p,o.currentWriteId=rp(t);const _=iv(t.serverSyncTree_,e,p,o.currentWriteId,o.applyLocally);Jn(t.eventQueue_,e,_),ip(t,t.transactionQueueTree_)}}function yv(t,e,n){return Xf(t.serverSyncTree_,e,n)||re.EMPTY_NODE}function ip(t,e=t.transactionQueueTree_){if(e||op(t,e),Bo(e)){const n=bR(t,e);O(n.length>0,"Sending zero length transaction queue"),n.every(r=>r.status===0)&&JG(t,Ou(e),n)}else uR(e)&&tp(e,n=>{ip(t,n)})}function JG(t,e,n){const s=n.map(l=>l.currentWriteId),r=yv(t,e,s);let i=r;const o=r.hash();for(let l=0;l<n.length;l++){const u=n[l];O(u.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),u.status=1,u.retryCount++;const h=hn(e,u.path);i=i.updateChild(h,u.currentOutputSnapshotRaw)}const a=i.val(!0),c=e;t.server_.put(c.toString(),a,l=>{mo(t,"transaction put response",{path:c.toString(),status:l});let u=[];if(l==="ok"){const h=[];for(let d=0;d<n.length;d++)n[d].status=2,u=u.concat(Kr(t.serverSyncTree_,n[d].currentWriteId)),n[d].onComplete&&h.push(()=>n[d].onComplete(null,!0,n[d].currentOutputSnapshotResolved)),n[d].unwatcher();op(t,ep(t.transactionQueueTree_,e)),ip(t,t.transactionQueueTree_),Jn(t.eventQueue_,e,u);for(let d=0;d<h.length;d++)hc(h[d])}else{if(l==="datastale")for(let h=0;h<n.length;h++)n[h].status===3?n[h].status=4:n[h].status=0;else{Zt("transaction at "+c.toString()+" failed: "+l);for(let h=0;h<n.length;h++)n[h].status=4,n[h].abortReason=l}ja(t,e)}},o)}function ja(t,e){const n=wR(t,e),s=Ou(n),r=bR(t,n);return XG(t,r,s),s}function XG(t,e,n){if(e.length===0)return;const s=[];let r=[];const o=e.filter(a=>a.status===0).map(a=>a.currentWriteId);for(let a=0;a<e.length;a++){const c=e[a],l=hn(n,c.path);let u=!1,h;if(O(l!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),c.status===4)u=!0,h=c.abortReason,r=r.concat(Kr(t.serverSyncTree_,c.currentWriteId,!0));else if(c.status===0)if(c.retryCount>=UG)u=!0,h="maxretry",r=r.concat(Kr(t.serverSyncTree_,c.currentWriteId,!0));else{const d=yv(t,c.path,o);c.currentInputSnapshot=d;const f=e[a].update(d.val());if(f!==void 0){Mu("transaction failed: Data returned ",f,c.path);let p=Xe(f);typeof f=="object"&&f!=null&&Mn(f,".priority")||(p=p.updatePriority(d.getPriority()));const y=c.currentWriteId,T=Fu(t),I=hv(p,d,T);c.currentOutputSnapshotRaw=p,c.currentOutputSnapshotResolved=I,c.currentWriteId=rp(t),o.splice(o.indexOf(y),1),r=r.concat(iv(t.serverSyncTree_,c.path,I,c.currentWriteId,c.applyLocally)),r=r.concat(Kr(t.serverSyncTree_,y,!0))}else u=!0,h="nodata",r=r.concat(Kr(t.serverSyncTree_,c.currentWriteId,!0))}Jn(t.eventQueue_,n,r),r=[],u&&(e[a].status=2,function(d){setTimeout(d,Math.floor(0))}(e[a].unwatcher),e[a].onComplete&&(h==="nodata"?s.push(()=>e[a].onComplete(null,!1,e[a].currentInputSnapshot)):s.push(()=>e[a].onComplete(new Error(h),!1,null))))}op(t,t.transactionQueueTree_);for(let a=0;a<s.length;a++)hc(s[a]);ip(t,t.transactionQueueTree_)}function wR(t,e){let n,s=t.transactionQueueTree_;for(n=me(e);n!==null&&Bo(s)===void 0;)s=ep(s,n),e=Ue(e),n=me(e);return s}function bR(t,e){const n=[];return IR(t,e,n),n.sort((s,r)=>s.order-r.order),n}function IR(t,e,n){const s=Bo(e);if(s)for(let r=0;r<s.length;r++)n.push(s[r]);tp(e,r=>{IR(t,r,n)})}function op(t,e){const n=Bo(e);if(n){let s=0;for(let r=0;r<n.length;r++)n[r].status!==2&&(n[s]=n[r],s++);n.length=s,pv(e,n.length>0?n:void 0)}tp(e,s=>{op(t,s)})}function vv(t,e){const n=Ou(wR(t,e)),s=ep(t.transactionQueueTree_,e);return RG(s,r=>{Ig(t,r)}),Ig(t,s),hR(s,r=>{Ig(t,r)}),n}function Ig(t,e){const n=Bo(e);if(n){const s=[];let r=[],i=-1;for(let o=0;o<n.length;o++)n[o].status===3||(n[o].status===1?(O(i===o-1,"All SENT items should be at beginning of queue."),i=o,n[o].status=3,n[o].abortReason="set"):(O(n[o].status===0,"Unexpected transaction status in abort"),n[o].unwatcher(),r=r.concat(Kr(t.serverSyncTree_,n[o].currentWriteId,!0)),n[o].onComplete&&s.push(n[o].onComplete.bind(null,new Error("set"),!1,null))));i===-1?pv(e,void 0):n.length=i+1,Jn(t.eventQueue_,Ou(e),r);for(let o=0;o<s.length;o++)hc(s[o])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ZG(t){let e="";const n=t.split("/");for(let s=0;s<n.length;s++)if(n[s].length>0){let r=n[s];try{r=decodeURIComponent(r.replace(/\+/g," "))}catch{}e+="/"+r}return e}function ez(t){const e={};t.charAt(0)==="?"&&(t=t.substring(1));for(const n of t.split("&")){if(n.length===0)continue;const s=n.split("=");s.length===2?e[decodeURIComponent(s[0])]=decodeURIComponent(s[1]):Zt(`Invalid query segment '${n}' in query '${t}'`)}return e}const Ym=function(t,e){const n=tz(t),s=n.namespace;n.domain==="firebase.com"&&js(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!s||s==="undefined")&&n.domain!=="localhost"&&js("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||uH();const r=n.scheme==="ws"||n.scheme==="wss";return{repoInfo:new Ck(n.host,n.secure,s,r,e,"",s!==n.subdomain),path:new Re(n.pathString)}},tz=function(t){let e="",n="",s="",r="",i="",o=!0,a="https",c=443;if(typeof t=="string"){let l=t.indexOf("//");l>=0&&(a=t.substring(0,l-1),t=t.substring(l+2));let u=t.indexOf("/");u===-1&&(u=t.length);let h=t.indexOf("?");h===-1&&(h=t.length),e=t.substring(0,Math.min(u,h)),u<h&&(r=ZG(t.substring(u,h)));const d=ez(t.substring(Math.min(t.length,h)));l=e.indexOf(":"),l>=0?(o=a==="https"||a==="wss",c=parseInt(e.substring(l+1),10)):l=e.length;const f=e.slice(0,l);if(f.toLowerCase()==="localhost")n="localhost";else if(f.split(".").length<=2)n=f;else{const p=e.indexOf(".");s=e.substring(0,p).toLowerCase(),n=e.substring(p+1),i=s}"ns"in d&&(i=d.ns)}return{host:e,port:c,domain:n,subdomain:s,secure:o,scheme:a,pathString:r,namespace:i}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ER{constructor(e,n,s,r){this.eventType=e,this.eventRegistration=n,this.snapshot=s,this.prevName=r}getPath(){const e=this.snapshot.ref;return this.eventType==="value"?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+gt(this.snapshot.exportVal())}}class TR{constructor(e,n,s){this.eventRegistration=e,this.error=n,this.path=s}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SR{constructor(e,n){this.snapshotCallback=e,this.cancelCallback=n}onValue(e,n){this.snapshotCallback.call(null,e,n)}onCancel(e){return O(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||this.snapshotCallback.userCallback!==void 0&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nz{constructor(e,n){this._repo=e,this._path=n}cancel(){const e=new pt;return HG(this._repo,this._path,e.wrapCallback(()=>{})),e.promise}remove(){Hn("OnDisconnect.remove",this._path);const e=new pt;return RE(this._repo,this._path,null,e.wrapCallback(()=>{})),e.promise}set(e){Hn("OnDisconnect.set",this._path),Ks("OnDisconnect.set",e,this._path,!1);const n=new pt;return RE(this._repo,this._path,e,n.wrapCallback(()=>{})),n.promise}setWithPriority(e,n){Hn("OnDisconnect.setWithPriority",this._path),Ks("OnDisconnect.setWithPriority",e,this._path,!1),gv("OnDisconnect.setWithPriority",n,!1);const s=new pt;return WG(this._repo,this._path,e,n,s.wrapCallback(()=>{})),s.promise}update(e){Hn("OnDisconnect.update",this._path),fR("OnDisconnect.update",e,this._path,!1);const n=new pt;return GG(this._repo,this._path,e,n.wrapCallback(()=>{})),n.promise}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sn{constructor(e,n,s,r){this._repo=e,this._path=n,this._queryParams=s,this._orderByCalled=r}get key(){return _e(this._path)?null:Ky(this._path)}get ref(){return new Xn(this._repo,this._path)}get _queryIdentifier(){const e=pE(this._queryParams),n=$y(e);return n==="{}"?"default":n}get _queryObject(){return pE(this._queryParams)}isEqual(e){if(e=N(e),!(e instanceof Sn))return!1;const n=this._repo===e._repo,s=Hy(this._path,e._path),r=this._queryIdentifier===e._queryIdentifier;return n&&s&&r}toJSON(){return this.toString()}toString(){return this._repo.toString()+HH(this._path)}}function ap(t,e){if(t._orderByCalled===!0)throw new Error(e+": You can't combine multiple orderBy calls.")}function mi(t){let e=null,n=null;if(t.hasStart()&&(e=t.getIndexStartValue()),t.hasEnd()&&(n=t.getIndexEndValue()),t.getIndex()===Os){const s="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",r="Query: When ordering by key, the argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() must be a string.";if(t.hasStart()){if(t.getIndexStartName()!==mr)throw new Error(s);if(typeof e!="string")throw new Error(r)}if(t.hasEnd()){if(t.getIndexEndName()!==qs)throw new Error(s);if(typeof n!="string")throw new Error(r)}}else if(t.getIndex()===Ke){if(e!=null&&!Yl(e)||n!=null&&!Yl(n))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), startAfter() endAt(), endBefore(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if(O(t.getIndex()instanceof zy||t.getIndex()===Qy,"unknown index type."),e!=null&&typeof e=="object"||n!=null&&typeof n=="object")throw new Error("Query: First argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() cannot be an object.")}function cp(t){if(t.hasStart()&&t.hasEnd()&&t.hasLimit()&&!t.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), startAfter(), endAt(), endBefore(), and limit(). Use limitToFirst() or limitToLast() instead.")}class Xn extends Sn{constructor(e,n){super(e,n,new Gf,!1)}get parent(){const e=Mk(this._path);return e===null?null:new Xn(this._repo,e)}get root(){let e=this;for(;e.parent!==null;)e=e.parent;return e}}class _o{constructor(e,n,s){this._node=e,this.ref=n,this._index=s}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){const n=new Re(e),s=yo(this.ref,e);return new _o(this._node.getChild(n),s,Ke)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return this._node.isLeafNode()?!1:!!this._node.forEachChild(this._index,(s,r)=>e(new _o(r,yo(this.ref,s),Ke)))}hasChild(e){const n=new Re(e);return!this._node.getChild(n).isEmpty()}hasChildren(){return this._node.isLeafNode()?!1:!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}}function CR(t,e){return t=N(t),t._checkNotDeleted("ref"),e!==void 0?yo(t._root,e):t._root}function NE(t,e){t=N(t),t._checkNotDeleted("refFromURL");const n=Ym(e,t._repo.repoInfo_.nodeAdmin);pR("refFromURL",n);const s=n.repoInfo;return!t._repo.repoInfo_.isCustomHost()&&s.host!==t._repo.repoInfo_.host&&js("refFromURL: Host name does not match the current database: (found "+s.host+" but expected "+t._repo.repoInfo_.host+")"),CR(t,n.path.toString())}function yo(t,e){return t=N(t),me(t._path)===null?MG("child","path",e,!1):Jl("child","path",e,!1),new Xn(t._repo,Qe(t._path,e))}function sz(t,e){t=N(t),Hn("push",t._path),Ks("push",e,t._path,!0);const n=yR(t._repo),s=hW(n),r=yo(t,s),i=yo(t,s);let o;return e!=null?o=wv(i,e).then(()=>i):o=Promise.resolve(i),r.then=o.then.bind(o),r.catch=o.then.bind(o,void 0),r}function rz(t){return Hn("remove",t._path),wv(t,null)}function wv(t,e){t=N(t),Hn("set",t._path),Ks("set",e,t._path,!1);const n=new pt;return _v(t._repo,t._path,e,null,n.wrapCallback(()=>{})),n.promise}function iz(t,e){t=N(t),Hn("setPriority",t._path),gv("setPriority",e,!1);const n=new pt;return _v(t._repo,Qe(t._path,".priority"),e,null,n.wrapCallback(()=>{})),n.promise}function oz(t,e,n){if(Hn("setWithPriority",t._path),Ks("setWithPriority",e,t._path,!1),gv("setWithPriority",n,!1),t.key===".length"||t.key===".keys")throw"setWithPriority failed: "+t.key+" is a read-only object.";const s=new pt;return _v(t._repo,t._path,e,n,s.wrapCallback(()=>{})),s.promise}function az(t,e){fR("update",e,t._path,!1);const n=new pt;return qG(t._repo,t._path,e,n.wrapCallback(()=>{})),n.promise}function cz(t){return t=N(t),jG(t._repo,t).then(e=>new _o(e,new Xn(t._repo,t._path),t._queryParams.getIndex()))}class lp{constructor(e){this.callbackContext=e}respondsTo(e){return e==="value"}createEvent(e,n){const s=n._queryParams.getIndex();return new ER("value",this,new _o(e.snapshotNode,new Xn(n._repo,n._path),s))}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,n){return this.callbackContext.hasCancelCallback?new TR(this,e,n):null}matches(e){return e instanceof lp?!e.callbackContext||!this.callbackContext?!0:e.callbackContext.matches(this.callbackContext):!1}hasAnyCallback(){return this.callbackContext!==null}}class up{constructor(e,n){this.eventType=e,this.callbackContext=n}respondsTo(e){let n=e==="children_added"?"child_added":e;return n=n==="children_removed"?"child_removed":n,this.eventType===n}createCancelEvent(e,n){return this.callbackContext.hasCancelCallback?new TR(this,e,n):null}createEvent(e,n){O(e.childName!=null,"Child events should have a childName.");const s=yo(new Xn(n._repo,n._path),e.childName),r=n._queryParams.getIndex();return new ER(e.type,this,new _o(e.snapshotNode,s,r),e.prevName)}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,e.prevName)}matches(e){return e instanceof up?this.eventType===e.eventType&&(!this.callbackContext||!e.callbackContext||this.callbackContext.matches(e.callbackContext)):!1}hasAnyCallback(){return!!this.callbackContext}}function Uu(t,e,n,s,r){let i;if(typeof s=="object"&&(i=void 0,r=s),typeof s=="function"&&(i=s),r&&r.onlyOnce){const c=n,l=(u,h)=>{Qm(t._repo,t,a),c(u,h)};l.userCallback=n.userCallback,l.context=n.context,n=l}const o=new SR(n,i||void 0),a=e==="value"?new lp(o):new up(e,o);return zG(t._repo,t,a),()=>Qm(t._repo,t,a)}function Jm(t,e,n,s){return Uu(t,"value",e,n,s)}function PE(t,e,n,s){return Uu(t,"child_added",e,n,s)}function xE(t,e,n,s){return Uu(t,"child_changed",e,n,s)}function DE(t,e,n,s){return Uu(t,"child_moved",e,n,s)}function OE(t,e,n,s){return Uu(t,"child_removed",e,n,s)}function ME(t,e,n){let s=null;const r=n?new SR(n):null;e==="value"?s=new lp(r):e&&(s=new up(e,r)),Qm(t._repo,t,s)}class ys{}class AR extends ys{constructor(e,n){super(),this._value=e,this._key=n}_apply(e){Ks("endAt",this._value,e._path,!0);const n=Vm(e._queryParams,this._value,this._key);if(cp(n),mi(n),e._queryParams.hasEnd())throw new Error("endAt: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new Sn(e._repo,e._path,n,e._orderByCalled)}}function lz(t,e){return Lu("endAt","key",e,!0),new AR(t,e)}class uz extends ys{constructor(e,n){super(),this._value=e,this._key=n}_apply(e){Ks("endBefore",this._value,e._path,!1);const n=yW(e._queryParams,this._value,this._key);if(cp(n),mi(n),e._queryParams.hasEnd())throw new Error("endBefore: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new Sn(e._repo,e._path,n,e._orderByCalled)}}function hz(t,e){return Lu("endBefore","key",e,!0),new uz(t,e)}class kR extends ys{constructor(e,n){super(),this._value=e,this._key=n}_apply(e){Ks("startAt",this._value,e._path,!0);const n=$m(e._queryParams,this._value,this._key);if(cp(n),mi(n),e._queryParams.hasStart())throw new Error("startAt: Starting point was already set (by another call to startAt, startBefore or equalTo).");return new Sn(e._repo,e._path,n,e._orderByCalled)}}function dz(t=null,e){return Lu("startAt","key",e,!0),new kR(t,e)}class fz extends ys{constructor(e,n){super(),this._value=e,this._key=n}_apply(e){Ks("startAfter",this._value,e._path,!1);const n=_W(e._queryParams,this._value,this._key);if(cp(n),mi(n),e._queryParams.hasStart())throw new Error("startAfter: Starting point was already set (by another call to startAt, startAfter, or equalTo).");return new Sn(e._repo,e._path,n,e._orderByCalled)}}function pz(t,e){return Lu("startAfter","key",e,!0),new fz(t,e)}class gz extends ys{constructor(e){super(),this._limit=e}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToFirst: Limit was already set (by another call to limitToFirst or limitToLast).");return new Sn(e._repo,e._path,gW(e._queryParams,this._limit),e._orderByCalled)}}function mz(t){if(typeof t!="number"||Math.floor(t)!==t||t<=0)throw new Error("limitToFirst: First argument must be a positive integer.");return new gz(t)}class _z extends ys{constructor(e){super(),this._limit=e}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToLast: Limit was already set (by another call to limitToFirst or limitToLast).");return new Sn(e._repo,e._path,mW(e._queryParams,this._limit),e._orderByCalled)}}function yz(t){if(typeof t!="number"||Math.floor(t)!==t||t<=0)throw new Error("limitToLast: First argument must be a positive integer.");return new _z(t)}class vz extends ys{constructor(e){super(),this._path=e}_apply(e){ap(e,"orderByChild");const n=new Re(this._path);if(_e(n))throw new Error("orderByChild: cannot pass in empty path. Use orderByValue() instead.");const s=new zy(n),r=zf(e._queryParams,s);return mi(r),new Sn(e._repo,e._path,r,!0)}}function wz(t){if(t==="$key")throw new Error('orderByChild: "$key" is invalid.  Use orderByKey() instead.');if(t==="$priority")throw new Error('orderByChild: "$priority" is invalid.  Use orderByPriority() instead.');if(t==="$value")throw new Error('orderByChild: "$value" is invalid.  Use orderByValue() instead.');return Jl("orderByChild","path",t,!1),new vz(t)}class bz extends ys{_apply(e){ap(e,"orderByKey");const n=zf(e._queryParams,Os);return mi(n),new Sn(e._repo,e._path,n,!0)}}function Iz(){return new bz}class Ez extends ys{_apply(e){ap(e,"orderByPriority");const n=zf(e._queryParams,Ke);return mi(n),new Sn(e._repo,e._path,n,!0)}}function Tz(){return new Ez}class Sz extends ys{_apply(e){ap(e,"orderByValue");const n=zf(e._queryParams,Qy);return mi(n),new Sn(e._repo,e._path,n,!0)}}function Cz(){return new Sz}class Az extends ys{constructor(e,n){super(),this._value=e,this._key=n}_apply(e){if(Ks("equalTo",this._value,e._path,!1),e._queryParams.hasStart())throw new Error("equalTo: Starting point was already set (by another call to startAt/startAfter or equalTo).");if(e._queryParams.hasEnd())throw new Error("equalTo: Ending point was already set (by another call to endAt/endBefore or equalTo).");return new AR(this._value,this._key)._apply(new kR(this._value,this._key)._apply(e))}}function kz(t,e){return Lu("equalTo","key",e,!0),new Az(t,e)}function ts(t,...e){let n=N(t);for(const s of e)n=s._apply(n);return n}oG(Xn);hG(Xn);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rz="FIREBASE_DATABASE_EMULATOR_HOST",Xm={};let Nz=!1;function Pz(t,e,n,s){t.repoInfo_=new Ck(`${e}:${n}`,!1,t.repoInfo_.namespace,t.repoInfo_.webSocketOnly,t.repoInfo_.nodeAdmin,t.repoInfo_.persistenceKey,t.repoInfo_.includeNamespaceInQueryParams),s&&(t.authTokenProvider_=s)}function RR(t,e,n,s,r){let i=s||t.options.databaseURL;i===void 0&&(t.options.projectId||js("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),Ct("Using default host for project ",t.options.projectId),i=`${t.options.projectId}-default-rtdb.firebaseio.com`);let o=Ym(i,r),a=o.repoInfo,c,l;typeof process<"u"&&process.env&&(l=process.env[Rz]),l?(c=!0,i=`http://${l}?ns=${a.namespace}`,o=Ym(i,r),a=o.repoInfo):c=!o.repoInfo.secure;const u=r&&c?new Ia(Ia.OWNER):new vH(t.name,t.options,e);pR("Invalid Firebase Database URL",o),_e(o.path)||js("Database URL must point to the root of a Firebase Database (not including a child path).");const h=Dz(a,t,u,new yH(t.name,n));return new Oz(h,t)}function xz(t,e){const n=Xm[e];(!n||n[t.key]!==t)&&js(`Database ${e}(${t.repoInfo_}) has already been deleted.`),vR(t),delete n[t.key]}function Dz(t,e,n,s){let r=Xm[e.name];r||(r={},Xm[e.name]=r);let i=r[t.toURLString()];return i&&js("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),i=new $G(t,Nz,n,s),r[t.toURLString()]=i,i}class Oz{constructor(e,n){this._repoInternal=e,this.app=n,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(VG(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new Xn(this._repo,ke())),this._rootInternal}_delete(){return this._rootInternal!==null&&(xz(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){this._rootInternal===null&&js("Cannot call "+e+" on a deleted database.")}}function NR(){Fa.IS_TRANSPORT_INITIALIZED&&Zt("Transport has already been initialized. Please call this function before calling ref or setting up a listener")}function Mz(){NR(),qr.forceDisallow()}function Lz(){NR(),jn.forceDisallow(),qr.forceAllow()}function Fz(t,e,n,s={}){t=N(t),t._checkNotDeleted("useEmulator"),t._instanceStarted&&js("Cannot call useEmulator() after instance has already been initialized.");const r=t._repoInternal;let i;if(r.repoInfo_.nodeAdmin)s.mockUserToken&&js('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),i=new Ia(Ia.OWNER);else if(s.mockUserToken){const o=typeof s.mockUserToken=="string"?s.mockUserToken:oy(s.mockUserToken,t.app.options.projectId);i=new Ia(o)}Pz(r,e,n,i)}function Uz(t){t=N(t),t._checkNotDeleted("goOffline"),vR(t._repo)}function $z(t){t=N(t),t._checkNotDeleted("goOnline"),QG(t._repo)}function Vz(t,e){fk(t,e)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bz(t){lk(Ys),rt(new Ae("database",(e,{instanceIdentifier:n})=>{const s=e.getProvider("app").getImmediate(),r=e.getProvider("auth-internal"),i=e.getProvider("app-check-internal");return RR(s,r,i,n)},"PUBLIC").setMultipleInstances(!0)),$e(YI,JI,t),$e(YI,JI,"esm2017")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jz={".sv":"timestamp"};function qz(){return jz}function Kz(t){return{".sv":{increment:t}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hz{constructor(e,n){this.committed=e,this.snapshot=n}toJSON(){return{committed:this.committed,snapshot:this.snapshot.toJSON()}}}function Wz(t,e,n){var s;if(t=N(t),Hn("Reference.transaction",t._path),t.key===".length"||t.key===".keys")throw"Reference.transaction failed: "+t.key+" is a read-only object.";const r=(s=n==null?void 0:n.applyLocally)!==null&&s!==void 0?s:!0,i=new pt,o=(c,l,u)=>{let h=null;c?i.reject(c):(h=new _o(u,new Xn(t._repo,t._path),Ke),i.resolve(new Hz(l,h)))},a=Jm(t,()=>{});return YG(t._repo,t._path,e,o,a,r),i.promise}hr.prototype.simpleListen=function(t,e){this.sendRequest("q",{p:t},e)};hr.prototype.echo=function(t,e){this.sendRequest("echo",{d:t},e)};Bz();const Gz="@firebase/database-compat",zz="0.2.4";/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qz=new Qs("@firebase/database-compat"),PR=function(t){const e="FIREBASE WARNING: "+t;Qz.warn(e)};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yz=function(t,e,n,s){if(!(s&&n===void 0)&&typeof n!="boolean")throw new Error(In(t,e)+"must be a boolean.")},Jz=function(t,e,n){if(!(n&&e===void 0))switch(e){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:throw new Error(In(t,"eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xz{constructor(e){this._delegate=e}cancel(e){ie("OnDisconnect.cancel",0,1,arguments.length),It("OnDisconnect.cancel","onComplete",e,!0);const n=this._delegate.cancel();return e&&n.then(()=>e(null),s=>e(s)),n}remove(e){ie("OnDisconnect.remove",0,1,arguments.length),It("OnDisconnect.remove","onComplete",e,!0);const n=this._delegate.remove();return e&&n.then(()=>e(null),s=>e(s)),n}set(e,n){ie("OnDisconnect.set",1,2,arguments.length),It("OnDisconnect.set","onComplete",n,!0);const s=this._delegate.set(e);return n&&s.then(()=>n(null),r=>n(r)),s}setWithPriority(e,n,s){ie("OnDisconnect.setWithPriority",2,3,arguments.length),It("OnDisconnect.setWithPriority","onComplete",s,!0);const r=this._delegate.setWithPriority(e,n);return s&&r.then(()=>s(null),i=>s(i)),r}update(e,n){if(ie("OnDisconnect.update",1,2,arguments.length),Array.isArray(e)){const r={};for(let i=0;i<e.length;++i)r[""+i]=e[i];e=r,PR("Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}It("OnDisconnect.update","onComplete",n,!0);const s=this._delegate.update(e);return n&&s.then(()=>n(null),r=>n(r)),s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zz{constructor(e,n){this.committed=e,this.snapshot=n}toJSON(){return ie("TransactionResult.toJSON",0,1,arguments.length),{committed:this.committed,snapshot:this.snapshot.toJSON()}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jr{constructor(e,n){this._database=e,this._delegate=n}val(){return ie("DataSnapshot.val",0,0,arguments.length),this._delegate.val()}exportVal(){return ie("DataSnapshot.exportVal",0,0,arguments.length),this._delegate.exportVal()}toJSON(){return ie("DataSnapshot.toJSON",0,1,arguments.length),this._delegate.toJSON()}exists(){return ie("DataSnapshot.exists",0,0,arguments.length),this._delegate.exists()}child(e){return ie("DataSnapshot.child",0,1,arguments.length),e=String(e),Jl("DataSnapshot.child","path",e,!1),new Jr(this._database,this._delegate.child(e))}hasChild(e){return ie("DataSnapshot.hasChild",1,1,arguments.length),Jl("DataSnapshot.hasChild","path",e,!1),this._delegate.hasChild(e)}getPriority(){return ie("DataSnapshot.getPriority",0,0,arguments.length),this._delegate.priority}forEach(e){return ie("DataSnapshot.forEach",1,1,arguments.length),It("DataSnapshot.forEach","action",e,!1),this._delegate.forEach(n=>e(new Jr(this._database,n)))}hasChildren(){return ie("DataSnapshot.hasChildren",0,0,arguments.length),this._delegate.hasChildren()}get key(){return this._delegate.key}numChildren(){return ie("DataSnapshot.numChildren",0,0,arguments.length),this._delegate.size}getRef(){return ie("DataSnapshot.ref",0,0,arguments.length),new Nn(this._database,this._delegate.ref)}get ref(){return this.getRef()}}class Ut{constructor(e,n){this.database=e,this._delegate=n}on(e,n,s,r){var i;ie("Query.on",2,4,arguments.length),It("Query.on","callback",n,!1);const o=Ut.getCancelAndContextArgs_("Query.on",s,r),a=(l,u)=>{n.call(o.context,new Jr(this.database,l),u)};a.userCallback=n,a.context=o.context;const c=(i=o.cancel)===null||i===void 0?void 0:i.bind(o.context);switch(e){case"value":return Jm(this._delegate,a,c),n;case"child_added":return PE(this._delegate,a,c),n;case"child_removed":return OE(this._delegate,a,c),n;case"child_changed":return xE(this._delegate,a,c),n;case"child_moved":return DE(this._delegate,a,c),n;default:throw new Error(In("Query.on","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}}off(e,n,s){if(ie("Query.off",0,3,arguments.length),Jz("Query.off",e,!0),It("Query.off","callback",n,!0),hI("Query.off","context",s,!0),n){const r=()=>{};r.userCallback=n,r.context=s,ME(this._delegate,e,r)}else ME(this._delegate,e)}get(){return cz(this._delegate).then(e=>new Jr(this.database,e))}once(e,n,s,r){ie("Query.once",1,4,arguments.length),It("Query.once","callback",n,!0);const i=Ut.getCancelAndContextArgs_("Query.once",s,r),o=new pt,a=(l,u)=>{const h=new Jr(this.database,l);n&&n.call(i.context,h,u),o.resolve(h)};a.userCallback=n,a.context=i.context;const c=l=>{i.cancel&&i.cancel.call(i.context,l),o.reject(l)};switch(e){case"value":Jm(this._delegate,a,c,{onlyOnce:!0});break;case"child_added":PE(this._delegate,a,c,{onlyOnce:!0});break;case"child_removed":OE(this._delegate,a,c,{onlyOnce:!0});break;case"child_changed":xE(this._delegate,a,c,{onlyOnce:!0});break;case"child_moved":DE(this._delegate,a,c,{onlyOnce:!0});break;default:throw new Error(In("Query.once","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}return o.promise}limitToFirst(e){return ie("Query.limitToFirst",1,1,arguments.length),new Ut(this.database,ts(this._delegate,mz(e)))}limitToLast(e){return ie("Query.limitToLast",1,1,arguments.length),new Ut(this.database,ts(this._delegate,yz(e)))}orderByChild(e){return ie("Query.orderByChild",1,1,arguments.length),new Ut(this.database,ts(this._delegate,wz(e)))}orderByKey(){return ie("Query.orderByKey",0,0,arguments.length),new Ut(this.database,ts(this._delegate,Iz()))}orderByPriority(){return ie("Query.orderByPriority",0,0,arguments.length),new Ut(this.database,ts(this._delegate,Tz()))}orderByValue(){return ie("Query.orderByValue",0,0,arguments.length),new Ut(this.database,ts(this._delegate,Cz()))}startAt(e=null,n){return ie("Query.startAt",0,2,arguments.length),new Ut(this.database,ts(this._delegate,dz(e,n)))}startAfter(e=null,n){return ie("Query.startAfter",0,2,arguments.length),new Ut(this.database,ts(this._delegate,pz(e,n)))}endAt(e=null,n){return ie("Query.endAt",0,2,arguments.length),new Ut(this.database,ts(this._delegate,lz(e,n)))}endBefore(e=null,n){return ie("Query.endBefore",0,2,arguments.length),new Ut(this.database,ts(this._delegate,hz(e,n)))}equalTo(e,n){return ie("Query.equalTo",1,2,arguments.length),new Ut(this.database,ts(this._delegate,kz(e,n)))}toString(){return ie("Query.toString",0,0,arguments.length),this._delegate.toString()}toJSON(){return ie("Query.toJSON",0,1,arguments.length),this._delegate.toJSON()}isEqual(e){if(ie("Query.isEqual",1,1,arguments.length),!(e instanceof Ut)){const n="Query.isEqual failed: First argument must be an instance of firebase.database.Query.";throw new Error(n)}return this._delegate.isEqual(e._delegate)}static getCancelAndContextArgs_(e,n,s){const r={cancel:void 0,context:void 0};if(n&&s)r.cancel=n,It(e,"cancel",r.cancel,!0),r.context=s,hI(e,"context",r.context,!0);else if(n)if(typeof n=="object"&&n!==null)r.context=n;else if(typeof n=="function")r.cancel=n;else throw new Error(In(e,"cancelOrContext")+" must either be a cancel callback or a context object.");return r}get ref(){return new Nn(this.database,new Xn(this._delegate._repo,this._delegate._path))}}class Nn extends Ut{constructor(e,n){super(e,new Sn(n._repo,n._path,new Gf,!1)),this.database=e,this._delegate=n}getKey(){return ie("Reference.key",0,0,arguments.length),this._delegate.key}child(e){return ie("Reference.child",1,1,arguments.length),typeof e=="number"&&(e=String(e)),new Nn(this.database,yo(this._delegate,e))}getParent(){ie("Reference.parent",0,0,arguments.length);const e=this._delegate.parent;return e?new Nn(this.database,e):null}getRoot(){return ie("Reference.root",0,0,arguments.length),new Nn(this.database,this._delegate.root)}set(e,n){ie("Reference.set",1,2,arguments.length),It("Reference.set","onComplete",n,!0);const s=wv(this._delegate,e);return n&&s.then(()=>n(null),r=>n(r)),s}update(e,n){if(ie("Reference.update",1,2,arguments.length),Array.isArray(e)){const r={};for(let i=0;i<e.length;++i)r[""+i]=e[i];e=r,PR("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}Hn("Reference.update",this._delegate._path),It("Reference.update","onComplete",n,!0);const s=az(this._delegate,e);return n&&s.then(()=>n(null),r=>n(r)),s}setWithPriority(e,n,s){ie("Reference.setWithPriority",2,3,arguments.length),It("Reference.setWithPriority","onComplete",s,!0);const r=oz(this._delegate,e,n);return s&&r.then(()=>s(null),i=>s(i)),r}remove(e){ie("Reference.remove",0,1,arguments.length),It("Reference.remove","onComplete",e,!0);const n=rz(this._delegate);return e&&n.then(()=>e(null),s=>e(s)),n}transaction(e,n,s){ie("Reference.transaction",1,3,arguments.length),It("Reference.transaction","transactionUpdate",e,!1),It("Reference.transaction","onComplete",n,!0),Yz("Reference.transaction","applyLocally",s,!0);const r=Wz(this._delegate,e,{applyLocally:s}).then(i=>new Zz(i.committed,new Jr(this.database,i.snapshot)));return n&&r.then(i=>n(null,i.committed,i.snapshot),i=>n(i,!1,null)),r}setPriority(e,n){ie("Reference.setPriority",1,2,arguments.length),It("Reference.setPriority","onComplete",n,!0);const s=iz(this._delegate,e);return n&&s.then(()=>n(null),r=>n(r)),s}push(e,n){ie("Reference.push",0,2,arguments.length),It("Reference.push","onComplete",n,!0);const s=sz(this._delegate,e),r=s.then(o=>new Nn(this.database,o));n&&r.then(()=>n(null),o=>n(o));const i=new Nn(this.database,s);return i.then=r.then.bind(r),i.catch=r.catch.bind(r,void 0),i}onDisconnect(){return Hn("Reference.onDisconnect",this._delegate._path),new Xz(new nz(this._delegate._repo,this._delegate._path))}get key(){return this.getKey()}get parent(){return this.getParent()}get root(){return this.getRoot()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xl{constructor(e,n){this._delegate=e,this.app=n,this.INTERNAL={delete:()=>this._delegate._delete(),forceWebSockets:Mz,forceLongPolling:Lz}}useEmulator(e,n,s={}){Fz(this._delegate,e,n,s)}ref(e){if(ie("database.ref",0,1,arguments.length),e instanceof Nn){const n=NE(this._delegate,e.toString());return new Nn(this,n)}else{const n=CR(this._delegate,e);return new Nn(this,n)}}refFromURL(e){ie("database.refFromURL",1,1,arguments.length);const s=NE(this._delegate,e);return new Nn(this,s)}goOffline(){return ie("database.goOffline",0,0,arguments.length),Uz(this._delegate)}goOnline(){return ie("database.goOnline",0,0,arguments.length),$z(this._delegate)}}Xl.ServerValue={TIMESTAMP:qz(),increment:t=>Kz(t)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function e2({app:t,url:e,version:n,customAuthImpl:s,namespace:r,nodeAdmin:i=!1}){lk(n);const o=new hC("auth-internal",new dC("database-standalone"));return o.setComponent(new Ae("auth-internal",()=>s,"PRIVATE")),{instance:new Xl(RR(t,o,void 0,e,i),t),namespace:r}}var t2=Object.freeze({__proto__:null,initStandalone:e2});/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const n2=Xl.ServerValue;function s2(t){t.INTERNAL.registerComponent(new Ae("database-compat",(e,{instanceIdentifier:n})=>{const s=e.getProvider("app-compat").getImmediate(),r=e.getProvider("database").getImmediate({identifier:n});return new Xl(r,s)},"PUBLIC").setServiceProps({Reference:Nn,Query:Ut,Database:Xl,DataSnapshot:Jr,enableLogging:Vz,INTERNAL:t2,ServerValue:n2}).setMultipleInstances(!0)),t.registerVersion(Gz,zz)}s2(ut);var r2=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},z,bv=bv||{},ce=r2||self;function Md(){}function Zm(t){var e=typeof t;return e=e!="object"?e:t?Array.isArray(t)?"array":e:"null",e=="array"||e=="object"&&typeof t.length=="number"}function $u(t){var e=typeof t;return e=="object"&&t!=null||e=="function"}function i2(t){return Object.prototype.hasOwnProperty.call(t,Eg)&&t[Eg]||(t[Eg]=++o2)}var Eg="closure_uid_"+(1e9*Math.random()>>>0),o2=0;function a2(t,e,n){return t.call.apply(t.bind,arguments)}function c2(t,e,n){if(!t)throw Error();if(2<arguments.length){var s=Array.prototype.slice.call(arguments,2);return function(){var r=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(r,s),t.apply(e,r)}}return function(){return t.apply(e,arguments)}}function Ht(t,e,n){return Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?Ht=a2:Ht=c2,Ht.apply(null,arguments)}function _h(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var s=n.slice();return s.push.apply(s,arguments),t.apply(this,s)}}function Qt(t,e){function n(){}n.prototype=e.prototype,t.Z=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.Vb=function(s,r,i){for(var o=Array(arguments.length-2),a=2;a<arguments.length;a++)o[a-2]=arguments[a];return e.prototype[r].apply(s,o)}}function _i(){this.s=this.s,this.o=this.o}var l2=0;_i.prototype.s=!1;_i.prototype.na=function(){!this.s&&(this.s=!0,this.M(),l2!=0)&&i2(this)};_i.prototype.M=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const xR=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if(typeof t=="string")return typeof e!="string"||e.length!=1?-1:t.indexOf(e,0);for(let n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},DR=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){const s=t.length,r=typeof t=="string"?t.split(""):t;for(let i=0;i<s;i++)i in r&&e.call(n,r[i],i,t)};function u2(t){e:{var e=t6;const n=t.length,s=typeof t=="string"?t.split(""):t;for(let r=0;r<n;r++)if(r in s&&e.call(void 0,s[r],r,t)){e=r;break e}e=-1}return 0>e?null:typeof t=="string"?t.charAt(e):t[e]}function LE(t){return Array.prototype.concat.apply([],arguments)}function Iv(t){const e=t.length;if(0<e){const n=Array(e);for(let s=0;s<e;s++)n[s]=t[s];return n}return[]}function Ld(t){return/^[\s\xa0]*$/.test(t)}var FE=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function cn(t,e){return t.indexOf(e)!=-1}function Tg(t,e){return t<e?-1:t>e?1:0}var ln;e:{var UE=ce.navigator;if(UE){var $E=UE.userAgent;if($E){ln=$E;break e}}ln=""}function Ev(t,e,n){for(const s in t)e.call(n,t[s],s,t)}function OR(t){const e={};for(const n in t)e[n]=t[n];return e}var VE="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function MR(t,e){let n,s;for(let r=1;r<arguments.length;r++){s=arguments[r];for(n in s)t[n]=s[n];for(let i=0;i<VE.length;i++)n=VE[i],Object.prototype.hasOwnProperty.call(s,n)&&(t[n]=s[n])}}function Tv(t){return Tv[" "](t),t}Tv[" "]=Md;function h2(t){var e=p2;return Object.prototype.hasOwnProperty.call(e,9)?e[9]:e[9]=t(9)}var d2=cn(ln,"Opera"),qa=cn(ln,"Trident")||cn(ln,"MSIE"),LR=cn(ln,"Edge"),e_=LR||qa,FR=cn(ln,"Gecko")&&!(cn(ln.toLowerCase(),"webkit")&&!cn(ln,"Edge"))&&!(cn(ln,"Trident")||cn(ln,"MSIE"))&&!cn(ln,"Edge"),f2=cn(ln.toLowerCase(),"webkit")&&!cn(ln,"Edge");function UR(){var t=ce.document;return t?t.documentMode:void 0}var Fd;e:{var Sg="",Cg=function(){var t=ln;if(FR)return/rv:([^\);]+)(\)|;)/.exec(t);if(LR)return/Edge\/([\d\.]+)/.exec(t);if(qa)return/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(t);if(f2)return/WebKit\/(\S+)/.exec(t);if(d2)return/(?:Version)[ \/]?(\S+)/.exec(t)}();if(Cg&&(Sg=Cg?Cg[1]:""),qa){var Ag=UR();if(Ag!=null&&Ag>parseFloat(Sg)){Fd=String(Ag);break e}}Fd=Sg}var p2={};function g2(){return h2(function(){let t=0;const e=FE(String(Fd)).split("."),n=FE("9").split("."),s=Math.max(e.length,n.length);for(let o=0;t==0&&o<s;o++){var r=e[o]||"",i=n[o]||"";do{if(r=/(\d*)(\D*)(.*)/.exec(r)||["","","",""],i=/(\d*)(\D*)(.*)/.exec(i)||["","","",""],r[0].length==0&&i[0].length==0)break;t=Tg(r[1].length==0?0:parseInt(r[1],10),i[1].length==0?0:parseInt(i[1],10))||Tg(r[2].length==0,i[2].length==0)||Tg(r[2],i[2]),r=r[3],i=i[3]}while(t==0)}return 0<=t})}var t_;if(ce.document&&qa){var BE=UR();t_=BE||parseInt(Fd,10)||void 0}else t_=void 0;var m2=t_,_2=function(){if(!ce.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{ce.addEventListener("test",Md,e),ce.removeEventListener("test",Md,e)}catch{}return t}();function en(t,e){this.type=t,this.g=this.target=e,this.defaultPrevented=!1}en.prototype.h=function(){this.defaultPrevented=!0};function Zl(t,e){if(en.call(this,t?t.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,t){var n=this.type=t.type,s=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.g=e,e=t.relatedTarget){if(FR){e:{try{Tv(e.nodeName);var r=!0;break e}catch{}r=!1}r||(e=null)}}else n=="mouseover"?e=t.fromElement:n=="mouseout"&&(e=t.toElement);this.relatedTarget=e,s?(this.clientX=s.clientX!==void 0?s.clientX:s.pageX,this.clientY=s.clientY!==void 0?s.clientY:s.pageY,this.screenX=s.screenX||0,this.screenY=s.screenY||0):(this.clientX=t.clientX!==void 0?t.clientX:t.pageX,this.clientY=t.clientY!==void 0?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType=typeof t.pointerType=="string"?t.pointerType:y2[t.pointerType]||"",this.state=t.state,this.i=t,t.defaultPrevented&&Zl.Z.h.call(this)}}Qt(Zl,en);var y2={2:"touch",3:"pen",4:"mouse"};Zl.prototype.h=function(){Zl.Z.h.call(this);var t=this.i;t.preventDefault?t.preventDefault():t.returnValue=!1};var Vu="closure_listenable_"+(1e6*Math.random()|0),v2=0;function w2(t,e,n,s,r){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!s,this.ia=r,this.key=++v2,this.ca=this.fa=!1}function hp(t){t.ca=!0,t.listener=null,t.proxy=null,t.src=null,t.ia=null}function dp(t){this.src=t,this.g={},this.h=0}dp.prototype.add=function(t,e,n,s,r){var i=t.toString();t=this.g[i],t||(t=this.g[i]=[],this.h++);var o=s_(t,e,s,r);return-1<o?(e=t[o],n||(e.fa=!1)):(e=new w2(e,this.src,i,!!s,r),e.fa=n,t.push(e)),e};function n_(t,e){var n=e.type;if(n in t.g){var s=t.g[n],r=xR(s,e),i;(i=0<=r)&&Array.prototype.splice.call(s,r,1),i&&(hp(e),t.g[n].length==0&&(delete t.g[n],t.h--))}}function s_(t,e,n,s){for(var r=0;r<t.length;++r){var i=t[r];if(!i.ca&&i.listener==e&&i.capture==!!n&&i.ia==s)return r}return-1}var Sv="closure_lm_"+(1e6*Math.random()|0),kg={};function $R(t,e,n,s,r){if(s&&s.once)return BR(t,e,n,s,r);if(Array.isArray(e)){for(var i=0;i<e.length;i++)$R(t,e[i],n,s,r);return null}return n=kv(n),t&&t[Vu]?t.N(e,n,$u(s)?!!s.capture:!!s,r):VR(t,e,n,!1,s,r)}function VR(t,e,n,s,r,i){if(!e)throw Error("Invalid event type");var o=$u(r)?!!r.capture:!!r,a=Av(t);if(a||(t[Sv]=a=new dp(t)),n=a.add(e,n,s,o,i),n.proxy)return n;if(s=b2(),n.proxy=s,s.src=t,s.listener=n,t.addEventListener)_2||(r=o),r===void 0&&(r=!1),t.addEventListener(e.toString(),s,r);else if(t.attachEvent)t.attachEvent(qR(e.toString()),s);else if(t.addListener&&t.removeListener)t.addListener(s);else throw Error("addEventListener and attachEvent are unavailable.");return n}function b2(){function t(n){return e.call(t.src,t.listener,n)}var e=I2;return t}function BR(t,e,n,s,r){if(Array.isArray(e)){for(var i=0;i<e.length;i++)BR(t,e[i],n,s,r);return null}return n=kv(n),t&&t[Vu]?t.O(e,n,$u(s)?!!s.capture:!!s,r):VR(t,e,n,!0,s,r)}function jR(t,e,n,s,r){if(Array.isArray(e))for(var i=0;i<e.length;i++)jR(t,e[i],n,s,r);else s=$u(s)?!!s.capture:!!s,n=kv(n),t&&t[Vu]?(t=t.i,e=String(e).toString(),e in t.g&&(i=t.g[e],n=s_(i,n,s,r),-1<n&&(hp(i[n]),Array.prototype.splice.call(i,n,1),i.length==0&&(delete t.g[e],t.h--)))):t&&(t=Av(t))&&(e=t.g[e.toString()],t=-1,e&&(t=s_(e,n,s,r)),(n=-1<t?e[t]:null)&&Cv(n))}function Cv(t){if(typeof t!="number"&&t&&!t.ca){var e=t.src;if(e&&e[Vu])n_(e.i,t);else{var n=t.type,s=t.proxy;e.removeEventListener?e.removeEventListener(n,s,t.capture):e.detachEvent?e.detachEvent(qR(n),s):e.addListener&&e.removeListener&&e.removeListener(s),(n=Av(e))?(n_(n,t),n.h==0&&(n.src=null,e[Sv]=null)):hp(t)}}}function qR(t){return t in kg?kg[t]:kg[t]="on"+t}function I2(t,e){if(t.ca)t=!0;else{e=new Zl(e,this);var n=t.listener,s=t.ia||t.src;t.fa&&Cv(t),t=n.call(s,e)}return t}function Av(t){return t=t[Sv],t instanceof dp?t:null}var Rg="__closure_events_fn_"+(1e9*Math.random()>>>0);function kv(t){return typeof t=="function"?t:(t[Rg]||(t[Rg]=function(e){return t.handleEvent(e)}),t[Rg])}function Ot(){_i.call(this),this.i=new dp(this),this.P=this,this.I=null}Qt(Ot,_i);Ot.prototype[Vu]=!0;Ot.prototype.removeEventListener=function(t,e,n,s){jR(this,t,e,n,s)};function Wt(t,e){var n,s=t.I;if(s)for(n=[];s;s=s.I)n.push(s);if(t=t.P,s=e.type||e,typeof e=="string")e=new en(e,t);else if(e instanceof en)e.target=e.target||t;else{var r=e;e=new en(s,t),MR(e,r)}if(r=!0,n)for(var i=n.length-1;0<=i;i--){var o=e.g=n[i];r=yh(o,s,!0,e)&&r}if(o=e.g=t,r=yh(o,s,!0,e)&&r,r=yh(o,s,!1,e)&&r,n)for(i=0;i<n.length;i++)o=e.g=n[i],r=yh(o,s,!1,e)&&r}Ot.prototype.M=function(){if(Ot.Z.M.call(this),this.i){var t=this.i,e;for(e in t.g){for(var n=t.g[e],s=0;s<n.length;s++)hp(n[s]);delete t.g[e],t.h--}}this.I=null};Ot.prototype.N=function(t,e,n,s){return this.i.add(String(t),e,!1,n,s)};Ot.prototype.O=function(t,e,n,s){return this.i.add(String(t),e,!0,n,s)};function yh(t,e,n,s){if(e=t.i.g[String(e)],!e)return!0;e=e.concat();for(var r=!0,i=0;i<e.length;++i){var o=e[i];if(o&&!o.ca&&o.capture==n){var a=o.listener,c=o.ia||o.src;o.fa&&n_(t.i,o),r=a.call(c,s)!==!1&&r}}return r&&!s.defaultPrevented}var Rv=ce.JSON.stringify;function E2(){var t=HR;let e=null;return t.g&&(e=t.g,t.g=t.g.next,t.g||(t.h=null),e.next=null),e}class T2{constructor(){this.h=this.g=null}add(e,n){const s=KR.get();s.set(e,n),this.h?this.h.next=s:this.g=s,this.h=s}}var KR=new class{constructor(t,e){this.i=t,this.j=e,this.h=0,this.g=null}get(){let t;return 0<this.h?(this.h--,t=this.g,this.g=t.next,t.next=null):t=this.i(),t}}(()=>new S2,t=>t.reset());class S2{constructor(){this.next=this.g=this.h=null}set(e,n){this.h=e,this.g=n,this.next=null}reset(){this.next=this.g=this.h=null}}function C2(t){ce.setTimeout(()=>{throw t},0)}function Nv(t,e){r_||A2(),i_||(r_(),i_=!0),HR.add(t,e)}var r_;function A2(){var t=ce.Promise.resolve(void 0);r_=function(){t.then(k2)}}var i_=!1,HR=new T2;function k2(){for(var t;t=E2();){try{t.h.call(t.g)}catch(n){C2(n)}var e=KR;e.j(t),100>e.h&&(e.h++,t.next=e.g,e.g=t)}i_=!1}function fp(t,e){Ot.call(this),this.h=t||1,this.g=e||ce,this.j=Ht(this.kb,this),this.l=Date.now()}Qt(fp,Ot);z=fp.prototype;z.da=!1;z.S=null;z.kb=function(){if(this.da){var t=Date.now()-this.l;0<t&&t<.8*this.h?this.S=this.g.setTimeout(this.j,this.h-t):(this.S&&(this.g.clearTimeout(this.S),this.S=null),Wt(this,"tick"),this.da&&(Pv(this),this.start()))}};z.start=function(){this.da=!0,this.S||(this.S=this.g.setTimeout(this.j,this.h),this.l=Date.now())};function Pv(t){t.da=!1,t.S&&(t.g.clearTimeout(t.S),t.S=null)}z.M=function(){fp.Z.M.call(this),Pv(this),delete this.g};function xv(t,e,n){if(typeof t=="function")n&&(t=Ht(t,n));else if(t&&typeof t.handleEvent=="function")t=Ht(t.handleEvent,t);else throw Error("Invalid listener argument");return 2147483647<Number(e)?-1:ce.setTimeout(t,e||0)}function WR(t){t.g=xv(()=>{t.g=null,t.i&&(t.i=!1,WR(t))},t.j);const e=t.h;t.h=null,t.m.apply(null,e)}class R2 extends _i{constructor(e,n){super(),this.m=e,this.j=n,this.h=null,this.i=!1,this.g=null}l(e){this.h=arguments,this.g?this.i=!0:WR(this)}M(){super.M(),this.g&&(ce.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function eu(t){_i.call(this),this.h=t,this.g={}}Qt(eu,_i);var jE=[];function GR(t,e,n,s){Array.isArray(n)||(n&&(jE[0]=n.toString()),n=jE);for(var r=0;r<n.length;r++){var i=$R(e,n[r],s||t.handleEvent,!1,t.h||t);if(!i)break;t.g[i.key]=i}}function zR(t){Ev(t.g,function(e,n){this.g.hasOwnProperty(n)&&Cv(e)},t),t.g={}}eu.prototype.M=function(){eu.Z.M.call(this),zR(this)};eu.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};function pp(){this.g=!0}pp.prototype.Aa=function(){this.g=!1};function N2(t,e,n,s,r,i){t.info(function(){if(t.g)if(i)for(var o="",a=i.split("&"),c=0;c<a.length;c++){var l=a[c].split("=");if(1<l.length){var u=l[0];l=l[1];var h=u.split("_");o=2<=h.length&&h[1]=="type"?o+(u+"="+l+"&"):o+(u+"=redacted&")}}else o=null;else o=i;return"XMLHTTP REQ ("+s+") [attempt "+r+"]: "+e+`
`+n+`
`+o})}function P2(t,e,n,s,r,i,o){t.info(function(){return"XMLHTTP RESP ("+s+") [ attempt "+r+"]: "+e+`
`+n+`
`+i+" "+o})}function ua(t,e,n,s){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+D2(t,n)+(s?" "+s:"")})}function x2(t,e){t.info(function(){return"TIMEOUT: "+e})}pp.prototype.info=function(){};function D2(t,e){if(!t.g)return e;if(!e)return null;try{var n=JSON.parse(e);if(n){for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var s=n[t];if(!(2>s.length)){var r=s[1];if(Array.isArray(r)&&!(1>r.length)){var i=r[0];if(i!="noop"&&i!="stop"&&i!="close")for(var o=1;o<r.length;o++)r[o]=""}}}}return Rv(n)}catch{return e}}var jo={},qE=null;function gp(){return qE=qE||new Ot}jo.Ma="serverreachability";function QR(t){en.call(this,jo.Ma,t)}Qt(QR,en);function tu(t){const e=gp();Wt(e,new QR(e))}jo.STAT_EVENT="statevent";function YR(t,e){en.call(this,jo.STAT_EVENT,t),this.stat=e}Qt(YR,en);function dn(t){const e=gp();Wt(e,new YR(e,t))}jo.Na="timingevent";function JR(t,e){en.call(this,jo.Na,t),this.size=e}Qt(JR,en);function Bu(t,e){if(typeof t!="function")throw Error("Fn must not be null and must be a function");return ce.setTimeout(function(){t()},e)}var mp={NO_ERROR:0,lb:1,yb:2,xb:3,sb:4,wb:5,zb:6,Ja:7,TIMEOUT:8,Cb:9},XR={qb:"complete",Mb:"success",Ka:"error",Ja:"abort",Eb:"ready",Fb:"readystatechange",TIMEOUT:"timeout",Ab:"incrementaldata",Db:"progress",tb:"downloadprogress",Ub:"uploadprogress"};function Dv(){}Dv.prototype.h=null;function KE(t){return t.h||(t.h=t.i())}function ZR(){}var ju={OPEN:"a",pb:"b",Ka:"c",Bb:"d"};function Ov(){en.call(this,"d")}Qt(Ov,en);function Mv(){en.call(this,"c")}Qt(Mv,en);var o_;function _p(){}Qt(_p,Dv);_p.prototype.g=function(){return new XMLHttpRequest};_p.prototype.i=function(){return{}};o_=new _p;function qu(t,e,n,s){this.l=t,this.j=e,this.m=n,this.X=s||1,this.V=new eu(this),this.P=O2,t=e_?125:void 0,this.W=new fp(t),this.H=null,this.i=!1,this.s=this.A=this.v=this.K=this.F=this.Y=this.B=null,this.D=[],this.g=null,this.C=0,this.o=this.u=null,this.N=-1,this.I=!1,this.O=0,this.L=null,this.aa=this.J=this.$=this.U=!1,this.h=new eN}function eN(){this.i=null,this.g="",this.h=!1}var O2=45e3,a_={},Ud={};z=qu.prototype;z.setTimeout=function(t){this.P=t};function c_(t,e,n){t.K=1,t.v=vp(_r(e)),t.s=n,t.U=!0,tN(t,null)}function tN(t,e){t.F=Date.now(),Ku(t),t.A=_r(t.v);var n=t.A,s=t.X;Array.isArray(s)||(s=[String(s)]),cN(n.h,"t",s),t.C=0,n=t.l.H,t.h=new eN,t.g=kN(t.l,n?e:null,!t.s),0<t.O&&(t.L=new R2(Ht(t.Ia,t,t.g),t.O)),GR(t.V,t.g,"readystatechange",t.gb),e=t.H?OR(t.H):{},t.s?(t.u||(t.u="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.g.ea(t.A,t.u,t.s,e)):(t.u="GET",t.g.ea(t.A,t.u,null,e)),tu(),N2(t.j,t.u,t.A,t.m,t.X,t.s)}z.gb=function(t){t=t.target;const e=this.L;e&&or(t)==3?e.l():this.Ia(t)};z.Ia=function(t){try{if(t==this.g)e:{const u=or(this.g);var e=this.g.Da();const h=this.g.ba();if(!(3>u)&&(u!=3||e_||this.g&&(this.h.h||this.g.ga()||zE(this.g)))){this.I||u!=4||e==7||(e==8||0>=h?tu(3):tu(2)),yp(this);var n=this.g.ba();this.N=n;t:if(nN(this)){var s=zE(this.g);t="";var r=s.length,i=or(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){zi(this),dl(this);var o="";break t}this.h.i=new ce.TextDecoder}for(e=0;e<r;e++)this.h.h=!0,t+=this.h.i.decode(s[e],{stream:i&&e==r-1});s.splice(0,r),this.h.g+=t,this.C=0,o=this.h.g}else o=this.g.ga();if(this.i=n==200,P2(this.j,this.u,this.A,this.m,this.X,u,n),this.i){if(this.$&&!this.J){t:{if(this.g){var a,c=this.g;if((a=c.g?c.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!Ld(a)){var l=a;break t}}l=null}if(n=l)ua(this.j,this.m,n,"Initial handshake response via X-HTTP-Initial-Response"),this.J=!0,l_(this,n);else{this.i=!1,this.o=3,dn(12),zi(this),dl(this);break e}}this.U?(sN(this,u,o),e_&&this.i&&u==3&&(GR(this.V,this.W,"tick",this.fb),this.W.start())):(ua(this.j,this.m,o,null),l_(this,o)),u==4&&zi(this),this.i&&!this.I&&(u==4?TN(this.l,this):(this.i=!1,Ku(this)))}else n==400&&0<o.indexOf("Unknown SID")?(this.o=3,dn(12)):(this.o=0,dn(13)),zi(this),dl(this)}}}catch{}finally{}};function nN(t){return t.g?t.u=="GET"&&t.K!=2&&t.l.Ba:!1}function sN(t,e,n){let s=!0,r;for(;!t.I&&t.C<n.length;)if(r=M2(t,n),r==Ud){e==4&&(t.o=4,dn(14),s=!1),ua(t.j,t.m,null,"[Incomplete Response]");break}else if(r==a_){t.o=4,dn(15),ua(t.j,t.m,n,"[Invalid Chunk]"),s=!1;break}else ua(t.j,t.m,r,null),l_(t,r);nN(t)&&r!=Ud&&r!=a_&&(t.h.g="",t.C=0),e!=4||n.length!=0||t.h.h||(t.o=1,dn(16),s=!1),t.i=t.i&&s,s?0<n.length&&!t.aa&&(t.aa=!0,e=t.l,e.g==t&&e.$&&!e.L&&(e.h.info("Great, no buffering proxy detected. Bytes received: "+n.length),Kv(e),e.L=!0,dn(11))):(ua(t.j,t.m,n,"[Invalid Chunked Response]"),zi(t),dl(t))}z.fb=function(){if(this.g){var t=or(this.g),e=this.g.ga();this.C<e.length&&(yp(this),sN(this,t,e),this.i&&t!=4&&Ku(this))}};function M2(t,e){var n=t.C,s=e.indexOf(`
`,n);return s==-1?Ud:(n=Number(e.substring(n,s)),isNaN(n)?a_:(s+=1,s+n>e.length?Ud:(e=e.substr(s,n),t.C=s+n,e)))}z.cancel=function(){this.I=!0,zi(this)};function Ku(t){t.Y=Date.now()+t.P,rN(t,t.P)}function rN(t,e){if(t.B!=null)throw Error("WatchDog timer not null");t.B=Bu(Ht(t.eb,t),e)}function yp(t){t.B&&(ce.clearTimeout(t.B),t.B=null)}z.eb=function(){this.B=null;const t=Date.now();0<=t-this.Y?(x2(this.j,this.A),this.K!=2&&(tu(),dn(17)),zi(this),this.o=2,dl(this)):rN(this,this.Y-t)};function dl(t){t.l.G==0||t.I||TN(t.l,t)}function zi(t){yp(t);var e=t.L;e&&typeof e.na=="function"&&e.na(),t.L=null,Pv(t.W),zR(t.V),t.g&&(e=t.g,t.g=null,e.abort(),e.na())}function l_(t,e){try{var n=t.l;if(n.G!=0&&(n.g==t||u_(n.i,t))){if(n.I=t.N,!t.J&&u_(n.i,t)&&n.G==3){try{var s=n.Ca.g.parse(e)}catch{s=null}if(Array.isArray(s)&&s.length==3){var r=s;if(r[0]==0){e:if(!n.u){if(n.g)if(n.g.F+3e3<t.F)jd(n),Ip(n);else break e;qv(n),dn(18)}}else n.ta=r[1],0<n.ta-n.U&&37500>r[2]&&n.N&&n.A==0&&!n.v&&(n.v=Bu(Ht(n.ab,n),6e3));if(1>=hN(n.i)&&n.ka){try{n.ka()}catch{}n.ka=void 0}}else Qi(n,11)}else if((t.J||n.g==t)&&jd(n),!Ld(e))for(r=n.Ca.g.parse(e),e=0;e<r.length;e++){let l=r[e];if(n.U=l[0],l=l[1],n.G==2)if(l[0]=="c"){n.J=l[1],n.la=l[2];const u=l[3];u!=null&&(n.ma=u,n.h.info("VER="+n.ma));const h=l[4];h!=null&&(n.za=h,n.h.info("SVER="+n.za));const d=l[5];d!=null&&typeof d=="number"&&0<d&&(s=1.5*d,n.K=s,n.h.info("backChannelRequestTimeoutMs_="+s)),s=n;const f=t.g;if(f){const p=f.g?f.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(p){var i=s.i;!i.g&&(cn(p,"spdy")||cn(p,"quic")||cn(p,"h2"))&&(i.j=i.l,i.g=new Set,i.h&&(Uv(i,i.h),i.h=null))}if(s.D){const _=f.g?f.g.getResponseHeader("X-HTTP-Session-Id"):null;_&&(s.sa=_,ze(s.F,s.D,_))}}n.G=3,n.j&&n.j.xa(),n.$&&(n.O=Date.now()-t.F,n.h.info("Handshake RTT: "+n.O+"ms")),s=n;var o=t;if(s.oa=AN(s,s.H?s.la:null,s.W),o.J){dN(s.i,o);var a=o,c=s.K;c&&a.setTimeout(c),a.B&&(yp(a),Ku(a)),s.g=o}else IN(s);0<n.l.length&&Ep(n)}else l[0]!="stop"&&l[0]!="close"||Qi(n,7);else n.G==3&&(l[0]=="stop"||l[0]=="close"?l[0]=="stop"?Qi(n,7):jv(n):l[0]!="noop"&&n.j&&n.j.wa(l),n.A=0)}}tu(4)}catch{}}function L2(t){if(t.R&&typeof t.R=="function")return t.R();if(typeof t=="string")return t.split("");if(Zm(t)){for(var e=[],n=t.length,s=0;s<n;s++)e.push(t[s]);return e}e=[],n=0;for(s in t)e[n++]=t[s];return e}function Lv(t,e){if(t.forEach&&typeof t.forEach=="function")t.forEach(e,void 0);else if(Zm(t)||typeof t=="string")DR(t,e,void 0);else{if(t.T&&typeof t.T=="function")var n=t.T();else if(t.R&&typeof t.R=="function")n=void 0;else if(Zm(t)||typeof t=="string"){n=[];for(var s=t.length,r=0;r<s;r++)n.push(r)}else for(r in n=[],s=0,t)n[s++]=r;s=L2(t),r=s.length;for(var i=0;i<r;i++)e.call(void 0,s[i],n&&n[i],t)}}function pc(t,e){this.h={},this.g=[],this.i=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var s=0;s<n;s+=2)this.set(arguments[s],arguments[s+1])}else if(t)if(t instanceof pc)for(n=t.T(),s=0;s<n.length;s++)this.set(n[s],t.get(n[s]));else for(s in t)this.set(s,t[s])}z=pc.prototype;z.R=function(){Fv(this);for(var t=[],e=0;e<this.g.length;e++)t.push(this.h[this.g[e]]);return t};z.T=function(){return Fv(this),this.g.concat()};function Fv(t){if(t.i!=t.g.length){for(var e=0,n=0;e<t.g.length;){var s=t.g[e];vo(t.h,s)&&(t.g[n++]=s),e++}t.g.length=n}if(t.i!=t.g.length){var r={};for(n=e=0;e<t.g.length;)s=t.g[e],vo(r,s)||(t.g[n++]=s,r[s]=1),e++;t.g.length=n}}z.get=function(t,e){return vo(this.h,t)?this.h[t]:e};z.set=function(t,e){vo(this.h,t)||(this.i++,this.g.push(t)),this.h[t]=e};z.forEach=function(t,e){for(var n=this.T(),s=0;s<n.length;s++){var r=n[s],i=this.get(r);t.call(e,i,r,this)}};function vo(t,e){return Object.prototype.hasOwnProperty.call(t,e)}var iN=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function F2(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var s=t[n].indexOf("="),r=null;if(0<=s){var i=t[n].substring(0,s);r=t[n].substring(s+1)}else i=t[n];e(i,r?decodeURIComponent(r.replace(/\+/g," ")):"")}}}function wo(t,e){if(this.i=this.s=this.j="",this.m=null,this.o=this.l="",this.g=!1,t instanceof wo){this.g=e!==void 0?e:t.g,$d(this,t.j),this.s=t.s,Vd(this,t.i),Bd(this,t.m),this.l=t.l,e=t.h;var n=new nu;n.i=e.i,e.g&&(n.g=new pc(e.g),n.h=e.h),HE(this,n),this.o=t.o}else t&&(n=String(t).match(iN))?(this.g=!!e,$d(this,n[1]||"",!0),this.s=fl(n[2]||""),Vd(this,n[3]||"",!0),Bd(this,n[4]),this.l=fl(n[5]||"",!0),HE(this,n[6]||"",!0),this.o=fl(n[7]||"")):(this.g=!!e,this.h=new nu(null,this.g))}wo.prototype.toString=function(){var t=[],e=this.j;e&&t.push(Qc(e,WE,!0),":");var n=this.i;return(n||e=="file")&&(t.push("//"),(e=this.s)&&t.push(Qc(e,WE,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),n=this.m,n!=null&&t.push(":",String(n))),(n=this.l)&&(this.i&&n.charAt(0)!="/"&&t.push("/"),t.push(Qc(n,n.charAt(0)=="/"?j2:B2,!0))),(n=this.h.toString())&&t.push("?",n),(n=this.o)&&t.push("#",Qc(n,K2)),t.join("")};function _r(t){return new wo(t)}function $d(t,e,n){t.j=n?fl(e,!0):e,t.j&&(t.j=t.j.replace(/:$/,""))}function Vd(t,e,n){t.i=n?fl(e,!0):e}function Bd(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.m=e}else t.m=null}function HE(t,e,n){e instanceof nu?(t.h=e,H2(t.h,t.g)):(n||(e=Qc(e,q2)),t.h=new nu(e,t.g))}function ze(t,e,n){t.h.set(e,n)}function vp(t){return ze(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),t}function U2(t){return t instanceof wo?_r(t):new wo(t,void 0)}function $2(t,e,n,s){var r=new wo(null,void 0);return t&&$d(r,t),e&&Vd(r,e),n&&Bd(r,n),s&&(r.l=s),r}function fl(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function Qc(t,e,n){return typeof t=="string"?(t=encodeURI(t).replace(e,V2),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function V2(t){return t=t.charCodeAt(0),"%"+(t>>4&15).toString(16)+(t&15).toString(16)}var WE=/[#\/\?@]/g,B2=/[#\?:]/g,j2=/[#\?]/g,q2=/[#\?@]/g,K2=/#/g;function nu(t,e){this.h=this.g=null,this.i=t||null,this.j=!!e}function yi(t){t.g||(t.g=new pc,t.h=0,t.i&&F2(t.i,function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)}))}z=nu.prototype;z.add=function(t,e){yi(this),this.i=null,t=gc(this,t);var n=this.g.get(t);return n||this.g.set(t,n=[]),n.push(e),this.h+=1,this};function oN(t,e){yi(t),e=gc(t,e),vo(t.g.h,e)&&(t.i=null,t.h-=t.g.get(e).length,t=t.g,vo(t.h,e)&&(delete t.h[e],t.i--,t.g.length>2*t.i&&Fv(t)))}function aN(t,e){return yi(t),e=gc(t,e),vo(t.g.h,e)}z.forEach=function(t,e){yi(this),this.g.forEach(function(n,s){DR(n,function(r){t.call(e,r,s,this)},this)},this)};z.T=function(){yi(this);for(var t=this.g.R(),e=this.g.T(),n=[],s=0;s<e.length;s++)for(var r=t[s],i=0;i<r.length;i++)n.push(e[s]);return n};z.R=function(t){yi(this);var e=[];if(typeof t=="string")aN(this,t)&&(e=LE(e,this.g.get(gc(this,t))));else{t=this.g.R();for(var n=0;n<t.length;n++)e=LE(e,t[n])}return e};z.set=function(t,e){return yi(this),this.i=null,t=gc(this,t),aN(this,t)&&(this.h-=this.g.get(t).length),this.g.set(t,[e]),this.h+=1,this};z.get=function(t,e){return t?(t=this.R(t),0<t.length?String(t[0]):e):e};function cN(t,e,n){oN(t,e),0<n.length&&(t.i=null,t.g.set(gc(t,e),Iv(n)),t.h+=n.length)}z.toString=function(){if(this.i)return this.i;if(!this.g)return"";for(var t=[],e=this.g.T(),n=0;n<e.length;n++){var s=e[n],r=encodeURIComponent(String(s));s=this.R(s);for(var i=0;i<s.length;i++){var o=r;s[i]!==""&&(o+="="+encodeURIComponent(String(s[i]))),t.push(o)}}return this.i=t.join("&")};function gc(t,e){return e=String(e),t.j&&(e=e.toLowerCase()),e}function H2(t,e){e&&!t.j&&(yi(t),t.i=null,t.g.forEach(function(n,s){var r=s.toLowerCase();s!=r&&(oN(this,s),cN(this,r,n))},t)),t.j=e}var W2=class{constructor(t,e){this.h=t,this.g=e}};function lN(t){this.l=t||G2,ce.PerformanceNavigationTiming?(t=ce.performance.getEntriesByType("navigation"),t=0<t.length&&(t[0].nextHopProtocol=="hq"||t[0].nextHopProtocol=="h2")):t=!!(ce.g&&ce.g.Ea&&ce.g.Ea()&&ce.g.Ea().Zb),this.j=t?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var G2=10;function uN(t){return t.h?!0:t.g?t.g.size>=t.j:!1}function hN(t){return t.h?1:t.g?t.g.size:0}function u_(t,e){return t.h?t.h==e:t.g?t.g.has(e):!1}function Uv(t,e){t.g?t.g.add(e):t.h=e}function dN(t,e){t.h&&t.h==e?t.h=null:t.g&&t.g.has(e)&&t.g.delete(e)}lN.prototype.cancel=function(){if(this.i=fN(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const t of this.g.values())t.cancel();this.g.clear()}};function fN(t){if(t.h!=null)return t.i.concat(t.h.D);if(t.g!=null&&t.g.size!==0){let e=t.i;for(const n of t.g.values())e=e.concat(n.D);return e}return Iv(t.i)}function $v(){}$v.prototype.stringify=function(t){return ce.JSON.stringify(t,void 0)};$v.prototype.parse=function(t){return ce.JSON.parse(t,void 0)};function z2(){this.g=new $v}function Q2(t,e,n){const s=n||"";try{Lv(t,function(r,i){let o=r;$u(r)&&(o=Rv(r)),e.push(s+i+"="+encodeURIComponent(o))})}catch(r){throw e.push(s+"type="+encodeURIComponent("_badmap")),r}}function Y2(t,e){const n=new pp;if(ce.Image){const s=new Image;s.onload=_h(vh,n,s,"TestLoadImage: loaded",!0,e),s.onerror=_h(vh,n,s,"TestLoadImage: error",!1,e),s.onabort=_h(vh,n,s,"TestLoadImage: abort",!1,e),s.ontimeout=_h(vh,n,s,"TestLoadImage: timeout",!1,e),ce.setTimeout(function(){s.ontimeout&&s.ontimeout()},1e4),s.src=t}else e(!1)}function vh(t,e,n,s,r){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,r(s)}catch{}}function Hu(t){this.l=t.$b||null,this.j=t.ib||!1}Qt(Hu,Dv);Hu.prototype.g=function(){return new wp(this.l,this.j)};Hu.prototype.i=function(t){return function(){return t}}({});function wp(t,e){Ot.call(this),this.D=t,this.u=e,this.m=void 0,this.readyState=Vv,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}Qt(wp,Ot);var Vv=0;z=wp.prototype;z.open=function(t,e){if(this.readyState!=Vv)throw this.abort(),Error("Error reopening a connection");this.C=t,this.B=e,this.readyState=1,su(this)};z.send=function(t){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};t&&(e.body=t),(this.D||ce).fetch(new Request(this.B,e)).then(this.Va.bind(this),this.ha.bind(this))};z.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted."),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Wu(this)),this.readyState=Vv};z.Va=function(t){if(this.g&&(this.l=t,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=t.headers,this.readyState=2,su(this)),this.g&&(this.readyState=3,su(this),this.g)))if(this.responseType==="arraybuffer")t.arrayBuffer().then(this.Ta.bind(this),this.ha.bind(this));else if(typeof ce.ReadableStream<"u"&&"body"in t){if(this.j=t.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;pN(this)}else t.text().then(this.Ua.bind(this),this.ha.bind(this))};function pN(t){t.j.read().then(t.Sa.bind(t)).catch(t.ha.bind(t))}z.Sa=function(t){if(this.g){if(this.u&&t.value)this.response.push(t.value);else if(!this.u){var e=t.value?t.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!t.done}))&&(this.response=this.responseText+=e)}t.done?Wu(this):su(this),this.readyState==3&&pN(this)}};z.Ua=function(t){this.g&&(this.response=this.responseText=t,Wu(this))};z.Ta=function(t){this.g&&(this.response=t,Wu(this))};z.ha=function(){this.g&&Wu(this)};function Wu(t){t.readyState=4,t.l=null,t.j=null,t.A=null,su(t)}z.setRequestHeader=function(t,e){this.v.append(t,e)};z.getResponseHeader=function(t){return this.h&&this.h.get(t.toLowerCase())||""};z.getAllResponseHeaders=function(){if(!this.h)return"";const t=[],e=this.h.entries();for(var n=e.next();!n.done;)n=n.value,t.push(n[0]+": "+n[1]),n=e.next();return t.join(`\r
`)};function su(t){t.onreadystatechange&&t.onreadystatechange.call(t)}Object.defineProperty(wp.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(t){this.m=t?"include":"same-origin"}});var J2=ce.JSON.parse;function dt(t){Ot.call(this),this.headers=new pc,this.u=t||null,this.h=!1,this.C=this.g=null,this.H="",this.m=0,this.j="",this.l=this.F=this.v=this.D=!1,this.B=0,this.A=null,this.J=gN,this.K=this.L=!1}Qt(dt,Ot);var gN="",X2=/^https?$/i,Z2=["POST","PUT"];z=dt.prototype;z.ea=function(t,e,n,s){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.H+"; newUri="+t);e=e?e.toUpperCase():"GET",this.H=t,this.j="",this.m=0,this.D=!1,this.h=!0,this.g=this.u?this.u.g():o_.g(),this.C=this.u?KE(this.u):KE(o_),this.g.onreadystatechange=Ht(this.Fa,this);try{this.F=!0,this.g.open(e,String(t),!0),this.F=!1}catch(i){GE(this,i);return}t=n||"";const r=new pc(this.headers);s&&Lv(s,function(i,o){r.set(o,i)}),s=u2(r.T()),n=ce.FormData&&t instanceof ce.FormData,!(0<=xR(Z2,e))||s||n||r.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),r.forEach(function(i,o){this.g.setRequestHeader(o,i)},this),this.J&&(this.g.responseType=this.J),"withCredentials"in this.g&&this.g.withCredentials!==this.L&&(this.g.withCredentials=this.L);try{yN(this),0<this.B&&((this.K=e6(this.g))?(this.g.timeout=this.B,this.g.ontimeout=Ht(this.pa,this)):this.A=xv(this.pa,this.B,this)),this.v=!0,this.g.send(t),this.v=!1}catch(i){GE(this,i)}};function e6(t){return qa&&g2()&&typeof t.timeout=="number"&&t.ontimeout!==void 0}function t6(t){return t.toLowerCase()=="content-type"}z.pa=function(){typeof bv<"u"&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,Wt(this,"timeout"),this.abort(8))};function GE(t,e){t.h=!1,t.g&&(t.l=!0,t.g.abort(),t.l=!1),t.j=e,t.m=5,mN(t),bp(t)}function mN(t){t.D||(t.D=!0,Wt(t,"complete"),Wt(t,"error"))}z.abort=function(t){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=t||7,Wt(this,"complete"),Wt(this,"abort"),bp(this))};z.M=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),bp(this,!0)),dt.Z.M.call(this)};z.Fa=function(){this.s||(this.F||this.v||this.l?_N(this):this.cb())};z.cb=function(){_N(this)};function _N(t){if(t.h&&typeof bv<"u"&&(!t.C[1]||or(t)!=4||t.ba()!=2)){if(t.v&&or(t)==4)xv(t.Fa,0,t);else if(Wt(t,"readystatechange"),or(t)==4){t.h=!1;try{const a=t.ba();e:switch(a){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break e;default:e=!1}var n;if(!(n=e)){var s;if(s=a===0){var r=String(t.H).match(iN)[1]||null;if(!r&&ce.self&&ce.self.location){var i=ce.self.location.protocol;r=i.substr(0,i.length-1)}s=!X2.test(r?r.toLowerCase():"")}n=s}if(n)Wt(t,"complete"),Wt(t,"success");else{t.m=6;try{var o=2<or(t)?t.g.statusText:""}catch{o=""}t.j=o+" ["+t.ba()+"]",mN(t)}}finally{bp(t)}}}}function bp(t,e){if(t.g){yN(t);const n=t.g,s=t.C[0]?Md:null;t.g=null,t.C=null,e||Wt(t,"ready");try{n.onreadystatechange=s}catch{}}}function yN(t){t.g&&t.K&&(t.g.ontimeout=null),t.A&&(ce.clearTimeout(t.A),t.A=null)}function or(t){return t.g?t.g.readyState:0}z.ba=function(){try{return 2<or(this)?this.g.status:-1}catch{return-1}};z.ga=function(){try{return this.g?this.g.responseText:""}catch{return""}};z.Qa=function(t){if(this.g){var e=this.g.responseText;return t&&e.indexOf(t)==0&&(e=e.substring(t.length)),J2(e)}};function zE(t){try{if(!t.g)return null;if("response"in t.g)return t.g.response;switch(t.J){case gN:case"text":return t.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in t.g)return t.g.mozResponseArrayBuffer}return null}catch{return null}}z.Da=function(){return this.m};z.La=function(){return typeof this.j=="string"?this.j:String(this.j)};function n6(t){let e="";return Ev(t,function(n,s){e+=s,e+=":",e+=n,e+=`\r
`}),e}function Bv(t,e,n){e:{for(s in n){var s=!1;break e}s=!0}s||(n=n6(n),typeof t=="string"?n!=null&&encodeURIComponent(String(n)):ze(t,e,n))}function Lc(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function vN(t){this.za=0,this.l=[],this.h=new pp,this.la=this.oa=this.F=this.W=this.g=this.sa=this.D=this.aa=this.o=this.P=this.s=null,this.Za=this.V=0,this.Xa=Lc("failFast",!1,t),this.N=this.v=this.u=this.m=this.j=null,this.X=!0,this.I=this.ta=this.U=-1,this.Y=this.A=this.C=0,this.Pa=Lc("baseRetryDelayMs",5e3,t),this.$a=Lc("retryDelaySeedMs",1e4,t),this.Ya=Lc("forwardChannelMaxRetries",2,t),this.ra=Lc("forwardChannelRequestTimeoutMs",2e4,t),this.qa=t&&t.xmlHttpFactory||void 0,this.Ba=t&&t.Yb||!1,this.K=void 0,this.H=t&&t.supportsCrossDomainXhr||!1,this.J="",this.i=new lN(t&&t.concurrentRequestLimit),this.Ca=new z2,this.ja=t&&t.fastHandshake||!1,this.Ra=t&&t.Wb||!1,t&&t.Aa&&this.h.Aa(),t&&t.forceLongPolling&&(this.X=!1),this.$=!this.ja&&this.X&&t&&t.detectBufferingProxy||!1,this.ka=void 0,this.O=0,this.L=!1,this.B=null,this.Wa=!t||t.Xb!==!1}z=vN.prototype;z.ma=8;z.G=1;function jv(t){if(wN(t),t.G==3){var e=t.V++,n=_r(t.F);ze(n,"SID",t.J),ze(n,"RID",e),ze(n,"TYPE","terminate"),Gu(t,n),e=new qu(t,t.h,e,void 0),e.K=2,e.v=vp(_r(n)),n=!1,ce.navigator&&ce.navigator.sendBeacon&&(n=ce.navigator.sendBeacon(e.v.toString(),"")),!n&&ce.Image&&(new Image().src=e.v,n=!0),n||(e.g=kN(e.l,null),e.g.ea(e.v)),e.F=Date.now(),Ku(e)}CN(t)}z.hb=function(t){try{this.h.info("Origin Trials invoked: "+t)}catch{}};function Ip(t){t.g&&(Kv(t),t.g.cancel(),t.g=null)}function wN(t){Ip(t),t.u&&(ce.clearTimeout(t.u),t.u=null),jd(t),t.i.cancel(),t.m&&(typeof t.m=="number"&&ce.clearTimeout(t.m),t.m=null)}function Ng(t,e){t.l.push(new W2(t.Za++,e)),t.G==3&&Ep(t)}function Ep(t){uN(t.i)||t.m||(t.m=!0,Nv(t.Ha,t),t.C=0)}function s6(t,e){return hN(t.i)>=t.i.j-(t.m?1:0)?!1:t.m?(t.l=e.D.concat(t.l),!0):t.G==1||t.G==2||t.C>=(t.Xa?0:t.Ya)?!1:(t.m=Bu(Ht(t.Ha,t,e),SN(t,t.C)),t.C++,!0)}z.Ha=function(t){if(this.m)if(this.m=null,this.G==1){if(!t){this.V=Math.floor(1e5*Math.random()),t=this.V++;const r=new qu(this,this.h,t,void 0);let i=this.s;if(this.P&&(i?(i=OR(i),MR(i,this.P)):i=this.P),this.o===null&&(r.H=i),this.ja)e:{for(var e=0,n=0;n<this.l.length;n++){t:{var s=this.l[n];if("__data__"in s.g&&(s=s.g.__data__,typeof s=="string")){s=s.length;break t}s=void 0}if(s===void 0)break;if(e+=s,4096<e){e=n;break e}if(e===4096||n===this.l.length-1){e=n+1;break e}}e=1e3}else e=1e3;e=bN(this,r,e),n=_r(this.F),ze(n,"RID",t),ze(n,"CVER",22),this.D&&ze(n,"X-HTTP-Session-Id",this.D),Gu(this,n),this.o&&i&&Bv(n,this.o,i),Uv(this.i,r),this.Ra&&ze(n,"TYPE","init"),this.ja?(ze(n,"$req",e),ze(n,"SID","null"),r.$=!0,c_(r,n,null)):c_(r,n,e),this.G=2}}else this.G==3&&(t?QE(this,t):this.l.length==0||uN(this.i)||QE(this))};function QE(t,e){var n;e?n=e.m:n=t.V++;const s=_r(t.F);ze(s,"SID",t.J),ze(s,"RID",n),ze(s,"AID",t.U),Gu(t,s),t.o&&t.s&&Bv(s,t.o,t.s),n=new qu(t,t.h,n,t.C+1),t.o===null&&(n.H=t.s),e&&(t.l=e.D.concat(t.l)),e=bN(t,n,1e3),n.setTimeout(Math.round(.5*t.ra)+Math.round(.5*t.ra*Math.random())),Uv(t.i,n),c_(n,s,e)}function Gu(t,e){t.j&&Lv({},function(n,s){ze(e,s,n)})}function bN(t,e,n){n=Math.min(t.l.length,n);var s=t.j?Ht(t.j.Oa,t.j,t):null;e:{var r=t.l;let i=-1;for(;;){const o=["count="+n];i==-1?0<n?(i=r[0].h,o.push("ofs="+i)):i=0:o.push("ofs="+i);let a=!0;for(let c=0;c<n;c++){let l=r[c].h;const u=r[c].g;if(l-=i,0>l)i=Math.max(0,r[c].h-100),a=!1;else try{Q2(u,o,"req"+l+"_")}catch{s&&s(u)}}if(a){s=o.join("&");break e}}}return t=t.l.splice(0,n),e.D=t,s}function IN(t){t.g||t.u||(t.Y=1,Nv(t.Ga,t),t.A=0)}function qv(t){return t.g||t.u||3<=t.A?!1:(t.Y++,t.u=Bu(Ht(t.Ga,t),SN(t,t.A)),t.A++,!0)}z.Ga=function(){if(this.u=null,EN(this),this.$&&!(this.L||this.g==null||0>=this.O)){var t=2*this.O;this.h.info("BP detection timer enabled: "+t),this.B=Bu(Ht(this.bb,this),t)}};z.bb=function(){this.B&&(this.B=null,this.h.info("BP detection timeout reached."),this.h.info("Buffering proxy detected and switch to long-polling!"),this.N=!1,this.L=!0,dn(10),Ip(this),EN(this))};function Kv(t){t.B!=null&&(ce.clearTimeout(t.B),t.B=null)}function EN(t){t.g=new qu(t,t.h,"rpc",t.Y),t.o===null&&(t.g.H=t.s),t.g.O=0;var e=_r(t.oa);ze(e,"RID","rpc"),ze(e,"SID",t.J),ze(e,"CI",t.N?"0":"1"),ze(e,"AID",t.U),Gu(t,e),ze(e,"TYPE","xmlhttp"),t.o&&t.s&&Bv(e,t.o,t.s),t.K&&t.g.setTimeout(t.K);var n=t.g;t=t.la,n.K=1,n.v=vp(_r(e)),n.s=null,n.U=!0,tN(n,t)}z.ab=function(){this.v!=null&&(this.v=null,Ip(this),qv(this),dn(19))};function jd(t){t.v!=null&&(ce.clearTimeout(t.v),t.v=null)}function TN(t,e){var n=null;if(t.g==e){jd(t),Kv(t),t.g=null;var s=2}else if(u_(t.i,e))n=e.D,dN(t.i,e),s=1;else return;if(t.I=e.N,t.G!=0){if(e.i)if(s==1){n=e.s?e.s.length:0,e=Date.now()-e.F;var r=t.C;s=gp(),Wt(s,new JR(s,n)),Ep(t)}else IN(t);else if(r=e.o,r==3||r==0&&0<t.I||!(s==1&&s6(t,e)||s==2&&qv(t)))switch(n&&0<n.length&&(e=t.i,e.i=e.i.concat(n)),r){case 1:Qi(t,5);break;case 4:Qi(t,10);break;case 3:Qi(t,6);break;default:Qi(t,2)}}}function SN(t,e){let n=t.Pa+Math.floor(Math.random()*t.$a);return t.j||(n*=2),n*e}function Qi(t,e){if(t.h.info("Error code "+e),e==2){var n=null;t.j&&(n=null);var s=Ht(t.jb,t);n||(n=new wo("//www.google.com/images/cleardot.gif"),ce.location&&ce.location.protocol=="http"||$d(n,"https"),vp(n)),Y2(n.toString(),s)}else dn(2);t.G=0,t.j&&t.j.va(e),CN(t),wN(t)}z.jb=function(t){t?(this.h.info("Successfully pinged google.com"),dn(2)):(this.h.info("Failed to ping google.com"),dn(1))};function CN(t){t.G=0,t.I=-1,t.j&&((fN(t.i).length!=0||t.l.length!=0)&&(t.i.i.length=0,Iv(t.l),t.l.length=0),t.j.ua())}function AN(t,e,n){let s=U2(n);if(s.i!="")e&&Vd(s,e+"."+s.i),Bd(s,s.m);else{const r=ce.location;s=$2(r.protocol,e?e+"."+r.hostname:r.hostname,+r.port,n)}return t.aa&&Ev(t.aa,function(r,i){ze(s,i,r)}),e=t.D,n=t.sa,e&&n&&ze(s,e,n),ze(s,"VER",t.ma),Gu(t,s),s}function kN(t,e,n){if(e&&!t.H)throw Error("Can't create secondary domain capable XhrIo object.");return e=n&&t.Ba&&!t.qa?new dt(new Hu({ib:!0})):new dt(t.qa),e.L=t.H,e}function RN(){}z=RN.prototype;z.xa=function(){};z.wa=function(){};z.va=function(){};z.ua=function(){};z.Oa=function(){};function qd(){if(qa&&!(10<=Number(m2)))throw Error("Environmental error: no available transport.")}qd.prototype.g=function(t,e){return new Ln(t,e)};function Ln(t,e){Ot.call(this),this.g=new vN(e),this.l=t,this.h=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.g.s=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.ya&&(t?t["X-WebChannel-Client-Profile"]=e.ya:t={"X-WebChannel-Client-Profile":e.ya}),this.g.P=t,(t=e&&e.httpHeadersOverwriteParam)&&!Ld(t)&&(this.g.o=t),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!Ld(e)&&(this.g.D=e,t=this.h,t!==null&&e in t&&(t=this.h,e in t&&delete t[e])),this.j=new mc(this)}Qt(Ln,Ot);Ln.prototype.m=function(){this.g.j=this.j,this.A&&(this.g.H=!0);var t=this.g,e=this.l,n=this.h||void 0;t.Wa&&(t.h.info("Origin Trials enabled."),Nv(Ht(t.hb,t,e))),dn(0),t.W=e,t.aa=n||{},t.N=t.X,t.F=AN(t,null,t.W),Ep(t)};Ln.prototype.close=function(){jv(this.g)};Ln.prototype.u=function(t){if(typeof t=="string"){var e={};e.__data__=t,Ng(this.g,e)}else this.v?(e={},e.__data__=Rv(t),Ng(this.g,e)):Ng(this.g,t)};Ln.prototype.M=function(){this.g.j=null,delete this.j,jv(this.g),delete this.g,Ln.Z.M.call(this)};function NN(t){Ov.call(this);var e=t.__sm__;if(e){e:{for(const n in e){t=n;break e}t=void 0}(this.i=t)&&(t=this.i,e=e!==null&&t in e?e[t]:void 0),this.data=e}else this.data=t}Qt(NN,Ov);function PN(){Mv.call(this),this.status=1}Qt(PN,Mv);function mc(t){this.g=t}Qt(mc,RN);mc.prototype.xa=function(){Wt(this.g,"a")};mc.prototype.wa=function(t){Wt(this.g,new NN(t))};mc.prototype.va=function(t){Wt(this.g,new PN)};mc.prototype.ua=function(){Wt(this.g,"b")};qd.prototype.createWebChannel=qd.prototype.g;Ln.prototype.send=Ln.prototype.u;Ln.prototype.open=Ln.prototype.m;Ln.prototype.close=Ln.prototype.close;mp.NO_ERROR=0;mp.TIMEOUT=8;mp.HTTP_ERROR=6;XR.COMPLETE="complete";ZR.EventType=ju;ju.OPEN="a";ju.CLOSE="b";ju.ERROR="c";ju.MESSAGE="d";Ot.prototype.listen=Ot.prototype.N;dt.prototype.listenOnce=dt.prototype.O;dt.prototype.getLastError=dt.prototype.La;dt.prototype.getLastErrorCode=dt.prototype.Da;dt.prototype.getStatus=dt.prototype.ba;dt.prototype.getResponseJson=dt.prototype.Qa;dt.prototype.getResponseText=dt.prototype.ga;dt.prototype.send=dt.prototype.ea;var r6=function(){return new qd},i6=function(){return gp()},Pg=mp,o6=XR,a6=jo,YE={rb:0,ub:1,vb:2,Ob:3,Tb:4,Qb:5,Rb:6,Pb:7,Nb:8,Sb:9,PROXY:10,NOPROXY:11,Lb:12,Hb:13,Ib:14,Gb:15,Jb:16,Kb:17,nb:18,mb:19,ob:20},c6=Hu,wh=ZR,l6=dt;const JE="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tt{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Tt.UNAUTHENTICATED=new Tt(null),Tt.GOOGLE_CREDENTIALS=new Tt("google-credentials-uid"),Tt.FIRST_PARTY=new Tt("first-party-uid"),Tt.MOCK_USER=new Tt("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let _c="9.9.2";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ci=new Qs("@firebase/firestore");function h_(){return ci.logLevel}function u6(t){ci.setLogLevel(t)}function P(t,...e){if(ci.logLevel<=ge.DEBUG){const n=e.map(Hv);ci.debug(`Firestore (${_c}): ${t}`,...n)}}function ct(t,...e){if(ci.logLevel<=ge.ERROR){const n=e.map(Hv);ci.error(`Firestore (${_c}): ${t}`,...n)}}function Ka(t,...e){if(ci.logLevel<=ge.WARN){const n=e.map(Hv);ci.warn(`Firestore (${_c}): ${t}`,...n)}}function Hv(t){if(typeof t=="string")return t;try{return e=t,JSON.stringify(e)}catch{return t}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/var e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Q(t="Unexpected state"){const e=`FIRESTORE (${_c}) INTERNAL ASSERTION FAILED: `+t;throw ct(e),new Error(e)}function ae(t,e){t||Q()}function h6(t,e){t||Q()}function q(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const w={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class k extends et{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kt{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xN{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class d6{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(Tt.UNAUTHENTICATED))}shutdown(){}}class f6{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class p6{constructor(e){this.t=e,this.currentUser=Tt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){let s=this.i;const r=c=>this.i!==s?(s=this.i,n(c)):Promise.resolve();let i=new kt;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new kt,e.enqueueRetryable(()=>r(this.currentUser))};const o=()=>{const c=i;e.enqueueRetryable(async()=>{await c.promise,await r(this.currentUser)})},a=c=>{P("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.auth.addAuthTokenListener(this.o),o()};this.t.onInit(c=>a(c)),setTimeout(()=>{if(!this.auth){const c=this.t.getImmediate({optional:!0});c?a(c):(P("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new kt)}},0),o()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(s=>this.i!==e?(P("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):s?(ae(typeof s.accessToken=="string"),new xN(s.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const e=this.auth&&this.auth.getUid();return ae(e===null||typeof e=="string"),new Tt(e)}}class g6{constructor(e,n,s){this.type="FirstParty",this.user=Tt.FIRST_PARTY,this.headers=new Map,this.headers.set("X-Goog-AuthUser",n);const r=e.auth.getAuthHeaderValueForFirstParty([]);r&&this.headers.set("Authorization",r),s&&this.headers.set("X-Goog-Iam-Authorization-Token",s)}}class m6{constructor(e,n,s){this.h=e,this.l=n,this.m=s}getToken(){return Promise.resolve(new g6(this.h,this.l,this.m))}start(e,n){e.enqueueRetryable(()=>n(Tt.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class _6{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class y6{constructor(e){this.g=e,this.forceRefresh=!1,this.appCheck=null,this.p=null}start(e,n){const s=i=>{i.error!=null&&P("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const o=i.token!==this.p;return this.p=i.token,P("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>s(i))};const r=i=>{P("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.appCheck.addTokenListener(this.o)};this.g.onInit(i=>r(i)),setTimeout(()=>{if(!this.appCheck){const i=this.g.getImmediate({optional:!0});i?r(i):P("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(ae(typeof n.token=="string"),this.p=n.token,new _6(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function v6(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let s=0;s<t;s++)n[s]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DN{static I(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=Math.floor(256/e.length)*e.length;let s="";for(;s.length<20;){const r=v6(40);for(let i=0;i<r.length;++i)s.length<20&&r[i]<n&&(s+=e.charAt(r[i]%e.length))}return s}}function ue(t,e){return t<e?-1:t>e?1:0}function Ha(t,e,n){return t.length===e.length&&t.every((s,r)=>n(s,e[r]))}function ON(t){return t+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ye{constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new k(w.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new k(w.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<-62135596800)throw new k(w.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new k(w.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return Ye.fromMillis(Date.now())}static fromDate(e){return Ye.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),s=Math.floor(1e6*(e-1e3*n));return new Ye(n,s)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?ue(this.nanoseconds,e.nanoseconds):ue(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oe{constructor(e){this.timestamp=e}static fromTimestamp(e){return new oe(e)}static min(){return new oe(new Ye(0,0))}static max(){return new oe(new Ye(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ru{constructor(e,n,s){n===void 0?n=0:n>e.length&&Q(),s===void 0?s=e.length-n:s>e.length-n&&Q(),this.segments=e,this.offset=n,this.len=s}get length(){return this.len}isEqual(e){return ru.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof ru?e.forEach(s=>{n.push(s)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,s=this.limit();n<s;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const s=Math.min(e.length,n.length);for(let r=0;r<s;r++){const i=e.get(r),o=n.get(r);if(i<o)return-1;if(i>o)return 1}return e.length<n.length?-1:e.length>n.length?1:0}}class Te extends ru{construct(e,n,s){return new Te(e,n,s)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...e){const n=[];for(const s of e){if(s.indexOf("//")>=0)throw new k(w.INVALID_ARGUMENT,`Invalid segment (${s}). Paths must not contain // in them.`);n.push(...s.split("/").filter(r=>r.length>0))}return new Te(n)}static emptyPath(){return new Te([])}}const w6=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class lt extends ru{construct(e,n,s){return new lt(e,n,s)}static isValidIdentifier(e){return w6.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),lt.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new lt(["__name__"])}static fromServerFormat(e){const n=[];let s="",r=0;const i=()=>{if(s.length===0)throw new k(w.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(s),s=""};let o=!1;for(;r<e.length;){const a=e[r];if(a==="\\"){if(r+1===e.length)throw new k(w.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const c=e[r+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new k(w.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);s+=c,r+=2}else a==="`"?(o=!o,r++):a!=="."||o?(s+=a,r++):(i(),r++)}if(i(),o)throw new k(w.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new lt(n)}static emptyPath(){return new lt([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ${constructor(e){this.path=e}static fromPath(e){return new $(Te.fromString(e))}static fromName(e){return new $(Te.fromString(e).popFirst(5))}static empty(){return new $(Te.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Te.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return Te.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new $(new Te(e.slice()))}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MN{constructor(e,n,s,r){this.indexId=e,this.collectionGroup=n,this.fields=s,this.indexState=r}}function d_(t){return t.fields.find(e=>e.kind===2)}function Di(t){return t.fields.filter(e=>e.kind!==2)}MN.UNKNOWN_ID=-1;class b6{constructor(e,n){this.fieldPath=e,this.kind=n}}class Kd{constructor(e,n){this.sequenceNumber=e,this.offset=n}static empty(){return new Kd(0,Fn.min())}}function LN(t,e){const n=t.toTimestamp().seconds,s=t.toTimestamp().nanoseconds+1,r=oe.fromTimestamp(s===1e9?new Ye(n+1,0):new Ye(n,s));return new Fn(r,$.empty(),e)}function FN(t){return new Fn(t.readTime,t.key,-1)}class Fn{constructor(e,n,s){this.readTime=e,this.documentKey=n,this.largestBatchId=s}static min(){return new Fn(oe.min(),$.empty(),-1)}static max(){return new Fn(oe.max(),$.empty(),-1)}}function Wv(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=$.comparator(t.documentKey,e.documentKey),n!==0?n:ue(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UN="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class $N{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function vi(t){if(t.code!==w.FAILED_PRECONDITION||t.message!==UN)throw t;P("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class v{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&Q(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new v((s,r)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(s,r)},this.catchCallback=i=>{this.wrapFailure(n,i).next(s,r)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof v?n:v.resolve(n)}catch(n){return v.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):v.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):v.reject(n)}static resolve(e){return new v((n,s)=>{n(e)})}static reject(e){return new v((n,s)=>{s(e)})}static waitFor(e){return new v((n,s)=>{let r=0,i=0,o=!1;e.forEach(a=>{++r,a.next(()=>{++i,o&&i===r&&n()},c=>s(c))}),o=!0,i===r&&n()})}static or(e){let n=v.resolve(!1);for(const s of e)n=n.next(r=>r?v.resolve(r):s());return n}static forEach(e,n){const s=[];return e.forEach((r,i)=>{s.push(n.call(this,r,i))}),this.waitFor(s)}static mapArray(e,n){return new v((s,r)=>{const i=e.length,o=new Array(i);let a=0;for(let c=0;c<i;c++){const l=c;n(e[l]).next(u=>{o[l]=u,++a,a===i&&s(o)},u=>r(u))}})}static doWhile(e,n){return new v((s,r)=>{const i=()=>{e()===!0?n().next(()=>{i()},r):s()};i()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tp{constructor(e,n){this.action=e,this.transaction=n,this.aborted=!1,this.T=new kt,this.transaction.oncomplete=()=>{this.T.resolve()},this.transaction.onabort=()=>{n.error?this.T.reject(new pl(e,n.error)):this.T.resolve()},this.transaction.onerror=s=>{const r=Gv(s.target.error);this.T.reject(new pl(e,r))}}static open(e,n,s,r){try{return new Tp(n,e.transaction(r,s))}catch(i){throw new pl(n,i)}}get A(){return this.T.promise}abort(e){e&&this.T.reject(e),this.aborted||(P("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}R(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const n=this.transaction.objectStore(e);return new E6(n)}}class hs{constructor(e,n,s){this.name=e,this.version=n,this.P=s,hs.v(Ge())===12.2&&ct("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return P("SimpleDb","Removing database:",e),Ui(window.indexedDB.deleteDatabase(e)).toPromise()}static V(){if(!En())return!1;if(hs.S())return!0;const e=Ge(),n=hs.v(e),s=0<n&&n<10,r=hs.D(e),i=0<r&&r<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||s||i)}static S(){var e;return typeof process<"u"&&((e=process.env)===null||e===void 0?void 0:e.C)==="YES"}static N(e,n){return e.store(n)}static v(e){const n=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),s=n?n[1].split("_").slice(0,2).join("."):"-1";return Number(s)}static D(e){const n=e.match(/Android ([\d.]+)/i),s=n?n[1].split(".").slice(0,2).join("."):"-1";return Number(s)}async k(e){return this.db||(P("SimpleDb","Opening database:",this.name),this.db=await new Promise((n,s)=>{const r=indexedDB.open(this.name,this.version);r.onsuccess=i=>{const o=i.target.result;n(o)},r.onblocked=()=>{s(new pl(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},r.onerror=i=>{const o=i.target.error;o.name==="VersionError"?s(new k(w.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?s(new k(w.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):s(new pl(e,o))},r.onupgradeneeded=i=>{P("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',i.oldVersion);const o=i.target.result;this.P.M(o,r.transaction,i.oldVersion,this.version).next(()=>{P("SimpleDb","Database upgrade to version "+this.version+" complete")})}})),this.O&&(this.db.onversionchange=n=>this.O(n)),this.db}F(e){this.O=e,this.db&&(this.db.onversionchange=n=>e(n))}async runTransaction(e,n,s,r){const i=n==="readonly";let o=0;for(;;){++o;try{this.db=await this.k(e);const a=Tp.open(this.db,e,i?"readonly":"readwrite",s),c=r(a).next(l=>(a.R(),l)).catch(l=>(a.abort(l),v.reject(l))).toPromise();return c.catch(()=>{}),await a.A,c}catch(a){const c=a,l=c.name!=="FirebaseError"&&o<3;if(P("SimpleDb","Transaction failed with error:",c.message,"Retrying:",l),this.close(),!l)return Promise.reject(c)}}}close(){this.db&&this.db.close(),this.db=void 0}}class I6{constructor(e){this.$=e,this.B=!1,this.L=null}get isDone(){return this.B}get U(){return this.L}set cursor(e){this.$=e}done(){this.B=!0}q(e){this.L=e}delete(){return Ui(this.$.delete())}}class pl extends k{constructor(e,n){super(w.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${n}`),this.name="IndexedDbTransactionError"}}function wi(t){return t.name==="IndexedDbTransactionError"}class E6{constructor(e){this.store=e}put(e,n){let s;return n!==void 0?(P("SimpleDb","PUT",this.store.name,e,n),s=this.store.put(n,e)):(P("SimpleDb","PUT",this.store.name,"<auto-key>",e),s=this.store.put(e)),Ui(s)}add(e){return P("SimpleDb","ADD",this.store.name,e,e),Ui(this.store.add(e))}get(e){return Ui(this.store.get(e)).next(n=>(n===void 0&&(n=null),P("SimpleDb","GET",this.store.name,e,n),n))}delete(e){return P("SimpleDb","DELETE",this.store.name,e),Ui(this.store.delete(e))}count(){return P("SimpleDb","COUNT",this.store.name),Ui(this.store.count())}K(e,n){const s=this.options(e,n);if(s.index||typeof this.store.getAll!="function"){const r=this.cursor(s),i=[];return this.G(r,(o,a)=>{i.push(a)}).next(()=>i)}{const r=this.store.getAll(s.range);return new v((i,o)=>{r.onerror=a=>{o(a.target.error)},r.onsuccess=a=>{i(a.target.result)}})}}j(e,n){const s=this.store.getAll(e,n===null?void 0:n);return new v((r,i)=>{s.onerror=o=>{i(o.target.error)},s.onsuccess=o=>{r(o.target.result)}})}W(e,n){P("SimpleDb","DELETE ALL",this.store.name);const s=this.options(e,n);s.H=!1;const r=this.cursor(s);return this.G(r,(i,o,a)=>a.delete())}J(e,n){let s;n?s=e:(s={},n=e);const r=this.cursor(s);return this.G(r,n)}Y(e){const n=this.cursor({});return new v((s,r)=>{n.onerror=i=>{const o=Gv(i.target.error);r(o)},n.onsuccess=i=>{const o=i.target.result;o?e(o.primaryKey,o.value).next(a=>{a?o.continue():s()}):s()}})}G(e,n){const s=[];return new v((r,i)=>{e.onerror=o=>{i(o.target.error)},e.onsuccess=o=>{const a=o.target.result;if(!a)return void r();const c=new I6(a),l=n(a.primaryKey,a.value,c);if(l instanceof v){const u=l.catch(h=>(c.done(),v.reject(h)));s.push(u)}c.isDone?r():c.U===null?a.continue():a.continue(c.U)}}).next(()=>v.waitFor(s))}options(e,n){let s;return e!==void 0&&(typeof e=="string"?s=e:n=e),{index:s,range:n}}cursor(e){let n="next";if(e.reverse&&(n="prev"),e.index){const s=this.store.index(e.index);return e.H?s.openKeyCursor(e.range,n):s.openCursor(e.range,n)}return this.store.openCursor(e.range,n)}}function Ui(t){return new v((e,n)=>{t.onsuccess=s=>{const r=s.target.result;e(r)},t.onerror=s=>{const r=Gv(s.target.error);n(r)}})}let XE=!1;function Gv(t){const e=hs.v(Ge());if(e>=12.2&&e<13){const n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){const s=new k("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${n}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return XE||(XE=!0,setTimeout(()=>{throw s},0)),s}}return t}class T6{constructor(e,n){this.asyncQueue=e,this.X=n,this.task=null}start(){this.Z(15)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}Z(e){P("IndexBackiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{P("IndexBackiller",`Documents written: ${await this.X.tt()}`)}catch(n){wi(n)?P("IndexBackiller","Ignoring IndexedDB error during index backfill: ",n):await vi(n)}await this.Z(1)})}}class S6{constructor(e,n){this.localStore=e,this.persistence=n}async tt(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",n=>this.et(n,e))}et(e,n){const s=new Set;let r=n,i=!0;return v.doWhile(()=>i===!0&&r>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(o!==null&&!s.has(o))return P("IndexBackiller",`Processing collection: ${o}`),this.nt(e,o,r).next(a=>{r-=a,s.add(o)});i=!1})).next(()=>n-r)}nt(e,n,s){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,n).next(r=>this.localStore.localDocuments.getNextDocuments(e,n,r,s).next(i=>{const o=i.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this.st(r,i)).next(a=>(P("IndexBackiller",`Updating offset: ${a}`),this.localStore.indexManager.updateCollectionGroup(e,n,a))).next(()=>o.size)}))}st(e,n){let s=e;return n.changes.forEach((r,i)=>{const o=FN(i);Wv(o,s)>0&&(s=o)}),new Fn(s.readTime,s.documentKey,Math.max(n.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wn{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=s=>this.it(s),this.rt=s=>n.writeSequenceNumber(s))}it(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.rt&&this.rt(e),e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ZE(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function qo(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function VN(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */wn.ot=-1;class it{constructor(e,n){this.comparator=e,this.root=n||Vt.EMPTY}insert(e,n){return new it(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,Vt.BLACK,null,null))}remove(e){return new it(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Vt.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const s=this.comparator(e,n.key);if(s===0)return n.value;s<0?n=n.left:s>0&&(n=n.right)}return null}indexOf(e){let n=0,s=this.root;for(;!s.isEmpty();){const r=this.comparator(e,s.key);if(r===0)return n+s.left.size;r<0?s=s.left:(n+=s.left.size+1,s=s.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,s)=>(e(n,s),!1))}toString(){const e=[];return this.inorderTraversal((n,s)=>(e.push(`${n}:${s}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new bh(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new bh(this.root,e,this.comparator,!1)}getReverseIterator(){return new bh(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new bh(this.root,e,this.comparator,!0)}}class bh{constructor(e,n,s,r){this.isReverse=r,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=n?s(e.key,n):1,n&&r&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Vt{constructor(e,n,s,r,i){this.key=e,this.value=n,this.color=s!=null?s:Vt.RED,this.left=r!=null?r:Vt.EMPTY,this.right=i!=null?i:Vt.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,s,r,i){return new Vt(e!=null?e:this.key,n!=null?n:this.value,s!=null?s:this.color,r!=null?r:this.left,i!=null?i:this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,s){let r=this;const i=s(e,r.key);return r=i<0?r.copy(null,null,null,r.left.insert(e,n,s),null):i===0?r.copy(null,n,null,null,null):r.copy(null,null,null,null,r.right.insert(e,n,s)),r.fixUp()}removeMin(){if(this.left.isEmpty())return Vt.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let s,r=this;if(n(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,n),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),n(e,r.key)===0){if(r.right.isEmpty())return Vt.EMPTY;s=r.right.min(),r=r.copy(s.key,s.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,n))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Vt.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Vt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw Q();const e=this.left.check();if(e!==this.right.check())throw Q();return e+(this.isRed()?0:1)}}Vt.EMPTY=null,Vt.RED=!0,Vt.BLACK=!1;Vt.EMPTY=new class{constructor(){this.size=0}get key(){throw Q()}get value(){throw Q()}get color(){throw Q()}get left(){throw Q()}get right(){throw Q()}copy(t,e,n,s,r){return this}insert(t,e,n){return new Vt(t,e)}remove(t,e){return this}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pe{constructor(e){this.comparator=e,this.data=new it(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,s)=>(e(n),!1))}forEachInRange(e,n){const s=this.data.getIteratorFrom(e[0]);for(;s.hasNext();){const r=s.getNext();if(this.comparator(r.key,e[1])>=0)return;n(r.key)}}forEachWhile(e,n){let s;for(s=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();s.hasNext();)if(!e(s.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new eT(this.data.getIterator())}getIteratorFrom(e){return new eT(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(s=>{n=n.add(s)}),n}isEqual(e){if(!(e instanceof Pe)||this.size!==e.size)return!1;const n=this.data.getIterator(),s=e.data.getIterator();for(;n.hasNext();){const r=n.getNext().key,i=s.getNext().key;if(this.comparator(r,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new Pe(this.comparator);return n.data=e,n}}class eT{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function ea(t){return t.hasNext()?t.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dn{constructor(e){this.fields=e,e.sort(lt.comparator)}static empty(){return new Dn([])}unionWith(e){let n=new Pe(lt.comparator);for(const s of this.fields)n=n.add(s);for(const s of e)n=n.add(s);return new Dn(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return Ha(this.fields,e.fields,(n,s)=>n.isEqual(s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function C6(){return typeof atob<"u"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _t{constructor(e){this.binaryString=e}static fromBase64String(e){const n=atob(e);return new _t(n)}static fromUint8Array(e){const n=function(s){let r="";for(let i=0;i<s.length;++i)r+=String.fromCharCode(s[i]);return r}(e);return new _t(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return e=this.binaryString,btoa(e);var e}toUint8Array(){return function(e){const n=new Uint8Array(e.length);for(let s=0;s<e.length;s++)n[s]=e.charCodeAt(s);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return ue(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}_t.EMPTY_BYTE_STRING=new _t("");const A6=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function li(t){if(ae(!!t),typeof t=="string"){let e=0;const n=A6.exec(t);if(ae(!!n),n[1]){let r=n[1];r=(r+"000000000").substr(0,9),e=Number(r)}const s=new Date(t);return{seconds:Math.floor(s.getTime()/1e3),nanos:e}}return{seconds:tt(t.seconds),nanos:tt(t.nanos)}}function tt(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function bo(t){return typeof t=="string"?_t.fromBase64String(t):_t.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zv(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="server_timestamp"}function BN(t){const e=t.mapValue.fields.__previous_value__;return zv(e)?BN(e):e}function iu(t){const e=li(t.mapValue.fields.__local_write_time__.timestampValue);return new Ye(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k6{constructor(e,n,s,r,i,o,a,c){this.databaseId=e,this.appId=n,this.persistenceKey=s,this.host=r,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.useFetchStreams=c}}class yr{constructor(e,n){this.projectId=e,this.database=n||"(default)"}static empty(){return new yr("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof yr&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zu(t){return t==null}function ou(t){return t===0&&1/t==-1/0}function jN(t){return typeof t=="number"&&Number.isInteger(t)&&!ou(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hr={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},jh={nullValue:"NULL_VALUE"};function Io(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?zv(t)?4:qN(t)?9007199254740991:10:Q()}function Hs(t,e){if(t===e)return!0;const n=Io(t);if(n!==Io(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return iu(t).isEqual(iu(e));case 3:return function(s,r){if(typeof s.timestampValue=="string"&&typeof r.timestampValue=="string"&&s.timestampValue.length===r.timestampValue.length)return s.timestampValue===r.timestampValue;const i=li(s.timestampValue),o=li(r.timestampValue);return i.seconds===o.seconds&&i.nanos===o.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(s,r){return bo(s.bytesValue).isEqual(bo(r.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(s,r){return tt(s.geoPointValue.latitude)===tt(r.geoPointValue.latitude)&&tt(s.geoPointValue.longitude)===tt(r.geoPointValue.longitude)}(t,e);case 2:return function(s,r){if("integerValue"in s&&"integerValue"in r)return tt(s.integerValue)===tt(r.integerValue);if("doubleValue"in s&&"doubleValue"in r){const i=tt(s.doubleValue),o=tt(r.doubleValue);return i===o?ou(i)===ou(o):isNaN(i)&&isNaN(o)}return!1}(t,e);case 9:return Ha(t.arrayValue.values||[],e.arrayValue.values||[],Hs);case 10:return function(s,r){const i=s.mapValue.fields||{},o=r.mapValue.fields||{};if(ZE(i)!==ZE(o))return!1;for(const a in i)if(i.hasOwnProperty(a)&&(o[a]===void 0||!Hs(i[a],o[a])))return!1;return!0}(t,e);default:return Q()}}function au(t,e){return(t.values||[]).find(n=>Hs(n,e))!==void 0}function ui(t,e){if(t===e)return 0;const n=Io(t),s=Io(e);if(n!==s)return ue(n,s);switch(n){case 0:case 9007199254740991:return 0;case 1:return ue(t.booleanValue,e.booleanValue);case 2:return function(r,i){const o=tt(r.integerValue||r.doubleValue),a=tt(i.integerValue||i.doubleValue);return o<a?-1:o>a?1:o===a?0:isNaN(o)?isNaN(a)?0:-1:1}(t,e);case 3:return tT(t.timestampValue,e.timestampValue);case 4:return tT(iu(t),iu(e));case 5:return ue(t.stringValue,e.stringValue);case 6:return function(r,i){const o=bo(r),a=bo(i);return o.compareTo(a)}(t.bytesValue,e.bytesValue);case 7:return function(r,i){const o=r.split("/"),a=i.split("/");for(let c=0;c<o.length&&c<a.length;c++){const l=ue(o[c],a[c]);if(l!==0)return l}return ue(o.length,a.length)}(t.referenceValue,e.referenceValue);case 8:return function(r,i){const o=ue(tt(r.latitude),tt(i.latitude));return o!==0?o:ue(tt(r.longitude),tt(i.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(r,i){const o=r.values||[],a=i.values||[];for(let c=0;c<o.length&&c<a.length;++c){const l=ui(o[c],a[c]);if(l)return l}return ue(o.length,a.length)}(t.arrayValue,e.arrayValue);case 10:return function(r,i){if(r===Hr.mapValue&&i===Hr.mapValue)return 0;if(r===Hr.mapValue)return 1;if(i===Hr.mapValue)return-1;const o=r.fields||{},a=Object.keys(o),c=i.fields||{},l=Object.keys(c);a.sort(),l.sort();for(let u=0;u<a.length&&u<l.length;++u){const h=ue(a[u],l[u]);if(h!==0)return h;const d=ui(o[a[u]],c[l[u]]);if(d!==0)return d}return ue(a.length,l.length)}(t.mapValue,e.mapValue);default:throw Q()}}function tT(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return ue(t,e);const n=li(t),s=li(e),r=ue(n.seconds,s.seconds);return r!==0?r:ue(n.nanos,s.nanos)}function Ea(t){return f_(t)}function f_(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(s){const r=li(s);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?bo(t.bytesValue).toBase64():"referenceValue"in t?(n=t.referenceValue,$.fromName(n).toString()):"geoPointValue"in t?`geo(${(e=t.geoPointValue).latitude},${e.longitude})`:"arrayValue"in t?function(s){let r="[",i=!0;for(const o of s.values||[])i?i=!1:r+=",",r+=f_(o);return r+"]"}(t.arrayValue):"mapValue"in t?function(s){const r=Object.keys(s.fields||{}).sort();let i="{",o=!0;for(const a of r)o?o=!1:i+=",",i+=`${a}:${f_(s.fields[a])}`;return i+"}"}(t.mapValue):Q();var e,n}function Eo(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function p_(t){return!!t&&"integerValue"in t}function cu(t){return!!t&&"arrayValue"in t}function nT(t){return!!t&&"nullValue"in t}function sT(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function qh(t){return!!t&&"mapValue"in t}function gl(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return qo(t.mapValue.fields,(n,s)=>e.mapValue.fields[n]=gl(s)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=gl(t.arrayValue.values[n]);return e}return Object.assign({},t)}function qN(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}function R6(t){return"nullValue"in t?jh:"booleanValue"in t?{booleanValue:!1}:"integerValue"in t||"doubleValue"in t?{doubleValue:NaN}:"timestampValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in t?{stringValue:""}:"bytesValue"in t?{bytesValue:""}:"referenceValue"in t?Eo(yr.empty(),$.empty()):"geoPointValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in t?{arrayValue:{}}:"mapValue"in t?{mapValue:{}}:Q()}function N6(t){return"nullValue"in t?{booleanValue:!1}:"booleanValue"in t?{doubleValue:NaN}:"integerValue"in t||"doubleValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in t?{stringValue:""}:"stringValue"in t?{bytesValue:""}:"bytesValue"in t?Eo(yr.empty(),$.empty()):"referenceValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in t?{arrayValue:{}}:"arrayValue"in t?{mapValue:{}}:"mapValue"in t?Hr:Q()}function rT(t,e){const n=ui(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?-1:!t.inclusive&&e.inclusive?1:0}function iT(t,e){const n=ui(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?1:!t.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bt{constructor(e){this.value=e}static empty(){return new Bt({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let s=0;s<e.length-1;++s)if(n=(n.mapValue.fields||{})[e.get(s)],!qh(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=gl(n)}setAll(e){let n=lt.emptyPath(),s={},r=[];e.forEach((o,a)=>{if(!n.isImmediateParentOf(a)){const c=this.getFieldsMap(n);this.applyChanges(c,s,r),s={},r=[],n=a.popLast()}o?s[a.lastSegment()]=gl(o):r.push(a.lastSegment())});const i=this.getFieldsMap(n);this.applyChanges(i,s,r)}delete(e){const n=this.field(e.popLast());qh(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return Hs(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let s=0;s<e.length;++s){let r=n.mapValue.fields[e.get(s)];qh(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},n.mapValue.fields[e.get(s)]=r),n=r}return n.mapValue.fields}applyChanges(e,n,s){qo(n,(r,i)=>e[r]=i);for(const r of s)delete e[r]}clone(){return new Bt(gl(this.value))}}function KN(t){const e=[];return qo(t.fields,(n,s)=>{const r=new lt([n]);if(qh(s)){const i=KN(s.mapValue).fields;if(i.length===0)e.push(r);else for(const o of i)e.push(r.child(o))}else e.push(r)}),new Dn(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class je{constructor(e,n,s,r,i,o){this.key=e,this.documentType=n,this.version=s,this.readTime=r,this.data=i,this.documentState=o}static newInvalidDocument(e){return new je(e,0,oe.min(),oe.min(),Bt.empty(),0)}static newFoundDocument(e,n,s){return new je(e,1,n,oe.min(),s,0)}static newNoDocument(e,n){return new je(e,2,n,oe.min(),Bt.empty(),0)}static newUnknownDocument(e,n){return new je(e,3,n,oe.min(),Bt.empty(),2)}convertToFoundDocument(e,n){return this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Bt.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Bt.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=oe.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof je&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new je(this.key,this.documentType,this.version,this.readTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P6{constructor(e,n=null,s=[],r=[],i=null,o=null,a=null){this.path=e,this.collectionGroup=n,this.orderBy=s,this.filters=r,this.limit=i,this.startAt=o,this.endAt=a,this.ut=null}}function oT(t,e=null,n=[],s=[],r=null,i=null,o=null){return new P6(t,e,n,s,r,i,o)}function To(t){const e=q(t);if(e.ut===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(s=>{return(r=s).field.canonicalString()+r.op.toString()+Ea(r.value);var r}).join(","),n+="|ob:",n+=e.orderBy.map(s=>function(r){return r.field.canonicalString()+r.dir}(s)).join(","),zu(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(s=>Ea(s)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(s=>Ea(s)).join(",")),e.ut=n}return e.ut}function x6(t){let e=t.path.canonicalString();return t.collectionGroup!==null&&(e+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(e+=`, filters: [${t.filters.map(n=>{return`${(s=n).field.canonicalString()} ${s.op} ${Ea(s.value)}`;var s}).join(", ")}]`),zu(t.limit)||(e+=", limit: "+t.limit),t.orderBy.length>0&&(e+=`, orderBy: [${t.orderBy.map(n=>function(s){return`${s.field.canonicalString()} (${s.dir})`}(n)).join(", ")}]`),t.startAt&&(e+=", startAt: ",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map(n=>Ea(n)).join(",")),t.endAt&&(e+=", endAt: ",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map(n=>Ea(n)).join(",")),`Target(${e})`}function Qu(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let r=0;r<t.orderBy.length;r++)if(!V6(t.orderBy[r],e.orderBy[r]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let r=0;r<t.filters.length;r++)if(n=t.filters[r],s=e.filters[r],n.op!==s.op||!n.field.isEqual(s.field)||!Hs(n.value,s.value))return!1;var n,s;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!uT(t.startAt,e.startAt)&&uT(t.endAt,e.endAt)}function Hd(t){return $.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}function Wd(t,e){return t.filters.filter(n=>n instanceof jt&&n.field.isEqual(e))}function aT(t,e,n){let s=jh,r=!0;for(const i of Wd(t,e)){let o=jh,a=!0;switch(i.op){case"<":case"<=":o=R6(i.value);break;case"==":case"in":case">=":o=i.value;break;case">":o=i.value,a=!1;break;case"!=":case"not-in":o=jh}rT({value:s,inclusive:r},{value:o,inclusive:a})<0&&(s=o,r=a)}if(n!==null){for(let i=0;i<t.orderBy.length;++i)if(t.orderBy[i].field.isEqual(e)){const o=n.position[i];rT({value:s,inclusive:r},{value:o,inclusive:n.inclusive})<0&&(s=o,r=n.inclusive);break}}return{value:s,inclusive:r}}function cT(t,e,n){let s=Hr,r=!0;for(const i of Wd(t,e)){let o=Hr,a=!0;switch(i.op){case">=":case">":o=N6(i.value),a=!1;break;case"==":case"in":case"<=":o=i.value;break;case"<":o=i.value,a=!1;break;case"!=":case"not-in":o=Hr}iT({value:s,inclusive:r},{value:o,inclusive:a})>0&&(s=o,r=a)}if(n!==null){for(let i=0;i<t.orderBy.length;++i)if(t.orderBy[i].field.isEqual(e)){const o=n.position[i];iT({value:s,inclusive:r},{value:o,inclusive:n.inclusive})>0&&(s=o,r=n.inclusive);break}}return{value:s,inclusive:r}}class jt extends class{}{constructor(e,n,s){super(),this.field=e,this.op=n,this.value=s}static create(e,n,s){return e.isKeyField()?n==="in"||n==="not-in"?this.ct(e,n,s):new D6(e,n,s):n==="array-contains"?new L6(e,s):n==="in"?new F6(e,s):n==="not-in"?new U6(e,s):n==="array-contains-any"?new $6(e,s):new jt(e,n,s)}static ct(e,n,s){return n==="in"?new O6(e,s):new M6(e,s)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&this.at(ui(n,this.value)):n!==null&&Io(this.value)===Io(n)&&this.at(ui(n,this.value))}at(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Q()}}ht(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}}class D6 extends jt{constructor(e,n,s){super(e,n,s),this.key=$.fromName(s.referenceValue)}matches(e){const n=$.comparator(e.key,this.key);return this.at(n)}}class O6 extends jt{constructor(e,n){super(e,"in",n),this.keys=HN("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class M6 extends jt{constructor(e,n){super(e,"not-in",n),this.keys=HN("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function HN(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(s=>$.fromName(s.referenceValue))}class L6 extends jt{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return cu(n)&&au(n.arrayValue,this.value)}}class F6 extends jt{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&au(this.value.arrayValue,n)}}class U6 extends jt{constructor(e,n){super(e,"not-in",n)}matches(e){if(au(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&!au(this.value.arrayValue,n)}}class $6 extends jt{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!cu(n)||!n.arrayValue.values)&&n.arrayValue.values.some(s=>au(this.value.arrayValue,s))}}class hi{constructor(e,n){this.position=e,this.inclusive=n}}class Ta{constructor(e,n="asc"){this.field=e,this.dir=n}}function V6(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}function lT(t,e,n){let s=0;for(let r=0;r<t.position.length;r++){const i=e[r],o=t.position[r];if(i.field.isKeyField()?s=$.comparator($.fromName(o.referenceValue),n.key):s=ui(o,n.data.field(i.field)),i.dir==="desc"&&(s*=-1),s!==0)break}return s}function uT(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!Hs(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Er{constructor(e,n=null,s=[],r=[],i=null,o="F",a=null,c=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=s,this.filters=r,this.limit=i,this.limitType=o,this.startAt=a,this.endAt=c,this.lt=null,this.ft=null,this.startAt,this.endAt}}function WN(t,e,n,s,r,i,o,a){return new Er(t,e,n,s,r,i,o,a)}function yc(t){return new Er(t)}function hT(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function Qv(t){return t.explicitOrderBy.length>0?t.explicitOrderBy[0].field:null}function Yv(t){for(const e of t.filters)if(e.ht())return e.field;return null}function Jv(t){return t.collectionGroup!==null}function Wa(t){const e=q(t);if(e.lt===null){e.lt=[];const n=Yv(e),s=Qv(e);if(n!==null&&s===null)n.isKeyField()||e.lt.push(new Ta(n)),e.lt.push(new Ta(lt.keyField(),"asc"));else{let r=!1;for(const i of e.explicitOrderBy)e.lt.push(i),i.field.isKeyField()&&(r=!0);if(!r){const i=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";e.lt.push(new Ta(lt.keyField(),i))}}}return e.lt}function Tn(t){const e=q(t);if(!e.ft)if(e.limitType==="F")e.ft=oT(e.path,e.collectionGroup,Wa(e),e.filters,e.limit,e.startAt,e.endAt);else{const n=[];for(const i of Wa(e)){const o=i.dir==="desc"?"asc":"desc";n.push(new Ta(i.field,o))}const s=e.endAt?new hi(e.endAt.position,e.endAt.inclusive):null,r=e.startAt?new hi(e.startAt.position,e.startAt.inclusive):null;e.ft=oT(e.path,e.collectionGroup,n,e.filters,e.limit,s,r)}return e.ft}function Gd(t,e,n){return new Er(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Yu(t,e){return Qu(Tn(t),Tn(e))&&t.limitType===e.limitType}function GN(t){return`${To(Tn(t))}|lt:${t.limitType}`}function g_(t){return`Query(target=${x6(Tn(t))}; limitType=${t.limitType})`}function Xv(t,e){return e.isFoundDocument()&&function(n,s){const r=s.key.path;return n.collectionGroup!==null?s.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(r):$.isDocumentKey(n.path)?n.path.isEqual(r):n.path.isImmediateParentOf(r)}(t,e)&&function(n,s){for(const r of n.explicitOrderBy)if(!r.field.isKeyField()&&s.data.field(r.field)===null)return!1;return!0}(t,e)&&function(n,s){for(const r of n.filters)if(!r.matches(s))return!1;return!0}(t,e)&&function(n,s){return!(n.startAt&&!function(r,i,o){const a=lT(r,i,o);return r.inclusive?a<=0:a<0}(n.startAt,Wa(n),s)||n.endAt&&!function(r,i,o){const a=lT(r,i,o);return r.inclusive?a>=0:a>0}(n.endAt,Wa(n),s))}(t,e)}function zN(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function QN(t){return(e,n)=>{let s=!1;for(const r of Wa(t)){const i=B6(r,e,n);if(i!==0)return i;s=s||r.field.isKeyField()}return 0}}function B6(t,e,n){const s=t.field.isKeyField()?$.comparator(e.key,n.key):function(r,i,o){const a=i.data.field(r),c=o.data.field(r);return a!==null&&c!==null?ui(a,c):Q()}(t.field,e,n);switch(t.dir){case"asc":return s;case"desc":return-1*s;default:return Q()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function YN(t,e){if(t.dt){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:ou(e)?"-0":e}}function JN(t){return{integerValue:""+t}}function XN(t,e){return jN(e)?JN(e):YN(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sp{constructor(){this._=void 0}}function j6(t,e,n){return t instanceof Ga?function(s,r){const i={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return r&&(i.fields.__previous_value__=r),{mapValue:i}}(n,e):t instanceof So?eP(t,e):t instanceof Co?tP(t,e):function(s,r){const i=ZN(s,r),o=dT(i)+dT(s._t);return p_(i)&&p_(s._t)?JN(o):YN(s.wt,o)}(t,e)}function q6(t,e,n){return t instanceof So?eP(t,e):t instanceof Co?tP(t,e):n}function ZN(t,e){return t instanceof za?p_(n=e)||function(s){return!!s&&"doubleValue"in s}(n)?e:{integerValue:0}:null;var n}class Ga extends Sp{}class So extends Sp{constructor(e){super(),this.elements=e}}function eP(t,e){const n=nP(e);for(const s of t.elements)n.some(r=>Hs(r,s))||n.push(s);return{arrayValue:{values:n}}}class Co extends Sp{constructor(e){super(),this.elements=e}}function tP(t,e){let n=nP(e);for(const s of t.elements)n=n.filter(r=>!Hs(r,s));return{arrayValue:{values:n}}}class za extends Sp{constructor(e,n){super(),this.wt=e,this._t=n}}function dT(t){return tt(t.integerValue||t.doubleValue)}function nP(t){return cu(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ju{constructor(e,n){this.field=e,this.transform=n}}function K6(t,e){return t.field.isEqual(e.field)&&function(n,s){return n instanceof So&&s instanceof So||n instanceof Co&&s instanceof Co?Ha(n.elements,s.elements,Hs):n instanceof za&&s instanceof za?Hs(n._t,s._t):n instanceof Ga&&s instanceof Ga}(t.transform,e.transform)}class H6{constructor(e,n){this.version=e,this.transformResults=n}}class Ze{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new Ze}static exists(e){return new Ze(void 0,e)}static updateTime(e){return new Ze(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Kh(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class Cp{}function sP(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new wc(t.key,Ze.none()):new vc(t.key,t.data,Ze.none());{const n=t.data,s=Bt.empty();let r=new Pe(lt.comparator);for(let i of e.fields)if(!r.has(i)){let o=n.field(i);o===null&&i.length>1&&(i=i.popLast(),o=n.field(i)),o===null?s.delete(i):s.set(i,o),r=r.add(i)}return new Tr(t.key,s,new Dn(r.toArray()),Ze.none())}}function W6(t,e,n){t instanceof vc?function(s,r,i){const o=s.value.clone(),a=pT(s.fieldTransforms,r,i.transformResults);o.setAll(a),r.convertToFoundDocument(i.version,o).setHasCommittedMutations()}(t,e,n):t instanceof Tr?function(s,r,i){if(!Kh(s.precondition,r))return void r.convertToUnknownDocument(i.version);const o=pT(s.fieldTransforms,r,i.transformResults),a=r.data;a.setAll(rP(s)),a.setAll(o),r.convertToFoundDocument(i.version,a).setHasCommittedMutations()}(t,e,n):function(s,r,i){r.convertToNoDocument(i.version).setHasCommittedMutations()}(0,e,n)}function ml(t,e,n,s){return t instanceof vc?function(r,i,o,a){if(!Kh(r.precondition,i))return o;const c=r.value.clone(),l=gT(r.fieldTransforms,a,i);return c.setAll(l),i.convertToFoundDocument(i.version,c).setHasLocalMutations(),null}(t,e,n,s):t instanceof Tr?function(r,i,o,a){if(!Kh(r.precondition,i))return o;const c=gT(r.fieldTransforms,a,i),l=i.data;return l.setAll(rP(r)),l.setAll(c),i.convertToFoundDocument(i.version,l).setHasLocalMutations(),o===null?null:o.unionWith(r.fieldMask.fields).unionWith(r.fieldTransforms.map(u=>u.field))}(t,e,n,s):function(r,i,o){return Kh(r.precondition,i)?(i.convertToNoDocument(i.version).setHasLocalMutations(),null):o}(t,e,n)}function G6(t,e){let n=null;for(const s of t.fieldTransforms){const r=e.data.field(s.field),i=ZN(s.transform,r||null);i!=null&&(n===null&&(n=Bt.empty()),n.set(s.field,i))}return n||null}function fT(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(n,s){return n===void 0&&s===void 0||!(!n||!s)&&Ha(n,s,(r,i)=>K6(r,i))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class vc extends Cp{constructor(e,n,s,r=[]){super(),this.key=e,this.value=n,this.precondition=s,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class Tr extends Cp{constructor(e,n,s,r,i=[]){super(),this.key=e,this.data=n,this.fieldMask=s,this.precondition=r,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function rP(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const s=t.data.field(n);e.set(n,s)}}),e}function pT(t,e,n){const s=new Map;ae(t.length===n.length);for(let r=0;r<n.length;r++){const i=t[r],o=i.transform,a=e.data.field(i.field);s.set(i.field,q6(o,a,n[r]))}return s}function gT(t,e,n){const s=new Map;for(const r of t){const i=r.transform,o=n.data.field(r.field);s.set(r.field,j6(i,o,e))}return s}class wc extends Cp{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Zv extends Cp{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z6{constructor(e){this.count=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ht,Ie;function iP(t){switch(t){default:return Q();case w.CANCELLED:case w.UNKNOWN:case w.DEADLINE_EXCEEDED:case w.RESOURCE_EXHAUSTED:case w.INTERNAL:case w.UNAVAILABLE:case w.UNAUTHENTICATED:return!1;case w.INVALID_ARGUMENT:case w.NOT_FOUND:case w.ALREADY_EXISTS:case w.PERMISSION_DENIED:case w.FAILED_PRECONDITION:case w.ABORTED:case w.OUT_OF_RANGE:case w.UNIMPLEMENTED:case w.DATA_LOSS:return!0}}function oP(t){if(t===void 0)return ct("GRPC error has no .code"),w.UNKNOWN;switch(t){case ht.OK:return w.OK;case ht.CANCELLED:return w.CANCELLED;case ht.UNKNOWN:return w.UNKNOWN;case ht.DEADLINE_EXCEEDED:return w.DEADLINE_EXCEEDED;case ht.RESOURCE_EXHAUSTED:return w.RESOURCE_EXHAUSTED;case ht.INTERNAL:return w.INTERNAL;case ht.UNAVAILABLE:return w.UNAVAILABLE;case ht.UNAUTHENTICATED:return w.UNAUTHENTICATED;case ht.INVALID_ARGUMENT:return w.INVALID_ARGUMENT;case ht.NOT_FOUND:return w.NOT_FOUND;case ht.ALREADY_EXISTS:return w.ALREADY_EXISTS;case ht.PERMISSION_DENIED:return w.PERMISSION_DENIED;case ht.FAILED_PRECONDITION:return w.FAILED_PRECONDITION;case ht.ABORTED:return w.ABORTED;case ht.OUT_OF_RANGE:return w.OUT_OF_RANGE;case ht.UNIMPLEMENTED:return w.UNIMPLEMENTED;case ht.DATA_LOSS:return w.DATA_LOSS;default:return Q()}}(Ie=ht||(ht={}))[Ie.OK=0]="OK",Ie[Ie.CANCELLED=1]="CANCELLED",Ie[Ie.UNKNOWN=2]="UNKNOWN",Ie[Ie.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ie[Ie.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ie[Ie.NOT_FOUND=5]="NOT_FOUND",Ie[Ie.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ie[Ie.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ie[Ie.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ie[Ie.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ie[Ie.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ie[Ie.ABORTED=10]="ABORTED",Ie[Ie.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ie[Ie.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ie[Ie.INTERNAL=13]="INTERNAL",Ie[Ie.UNAVAILABLE=14]="UNAVAILABLE",Ie[Ie.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bi{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),s=this.inner[n];if(s!==void 0){for(const[r,i]of s)if(this.equalsFn(r,e))return i}}has(e){return this.get(e)!==void 0}set(e,n){const s=this.mapKeyFn(e),r=this.inner[s];if(r===void 0)return this.inner[s]=[[e,n]],void this.innerSize++;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return void(r[i]=[e,n]);r.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),s=this.inner[n];if(s===void 0)return!1;for(let r=0;r<s.length;r++)if(this.equalsFn(s[r][0],e))return s.length===1?delete this.inner[n]:s.splice(r,1),this.innerSize--,!0;return!1}forEach(e){qo(this.inner,(n,s)=>{for(const[r,i]of s)e(r,i)})}isEmpty(){return VN(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Q6=new it($.comparator);function bn(){return Q6}const aP=new it($.comparator);function Yc(...t){let e=aP;for(const n of t)e=e.insert(n.key,n);return e}function cP(t){let e=aP;return t.forEach((n,s)=>e=e.insert(n,s.overlayedDocument)),e}function Ps(){return _l()}function lP(){return _l()}function _l(){return new bi(t=>t.toString(),(t,e)=>t.isEqual(e))}const Y6=new it($.comparator),J6=new Pe($.comparator);function he(...t){let e=J6;for(const n of t)e=e.add(n);return e}const X6=new Pe(ue);function Ap(){return X6}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xu{constructor(e,n,s,r,i){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=s,this.documentUpdates=r,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,n){const s=new Map;return s.set(e,Zu.createSynthesizedTargetChangeForCurrentChange(e,n)),new Xu(oe.min(),s,Ap(),bn(),he())}}class Zu{constructor(e,n,s,r,i){this.resumeToken=e,this.current=n,this.addedDocuments=s,this.modifiedDocuments=r,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,n){return new Zu(_t.EMPTY_BYTE_STRING,n,he(),he(),he())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hh{constructor(e,n,s,r){this.gt=e,this.removedTargetIds=n,this.key=s,this.yt=r}}class uP{constructor(e,n){this.targetId=e,this.It=n}}class hP{constructor(e,n,s=_t.EMPTY_BYTE_STRING,r=null){this.state=e,this.targetIds=n,this.resumeToken=s,this.cause=r}}class mT{constructor(){this.Tt=0,this.Et=yT(),this.At=_t.EMPTY_BYTE_STRING,this.Rt=!1,this.bt=!0}get current(){return this.Rt}get resumeToken(){return this.At}get Pt(){return this.Tt!==0}get vt(){return this.bt}Vt(e){e.approximateByteSize()>0&&(this.bt=!0,this.At=e)}St(){let e=he(),n=he(),s=he();return this.Et.forEach((r,i)=>{switch(i){case 0:e=e.add(r);break;case 2:n=n.add(r);break;case 1:s=s.add(r);break;default:Q()}}),new Zu(this.At,this.Rt,e,n,s)}Dt(){this.bt=!1,this.Et=yT()}Ct(e,n){this.bt=!0,this.Et=this.Et.insert(e,n)}xt(e){this.bt=!0,this.Et=this.Et.remove(e)}Nt(){this.Tt+=1}kt(){this.Tt-=1}Mt(){this.bt=!0,this.Rt=!0}}class Z6{constructor(e){this.Ot=e,this.Ft=new Map,this.$t=bn(),this.Bt=_T(),this.Lt=new Pe(ue)}Ut(e){for(const n of e.gt)e.yt&&e.yt.isFoundDocument()?this.qt(n,e.yt):this.Kt(n,e.key,e.yt);for(const n of e.removedTargetIds)this.Kt(n,e.key,e.yt)}Gt(e){this.forEachTarget(e,n=>{const s=this.Qt(n);switch(e.state){case 0:this.jt(n)&&s.Vt(e.resumeToken);break;case 1:s.kt(),s.Pt||s.Dt(),s.Vt(e.resumeToken);break;case 2:s.kt(),s.Pt||this.removeTarget(n);break;case 3:this.jt(n)&&(s.Mt(),s.Vt(e.resumeToken));break;case 4:this.jt(n)&&(this.Wt(n),s.Vt(e.resumeToken));break;default:Q()}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.Ft.forEach((s,r)=>{this.jt(r)&&n(r)})}zt(e){const n=e.targetId,s=e.It.count,r=this.Ht(n);if(r){const i=r.target;if(Hd(i))if(s===0){const o=new $(i.path);this.Kt(n,o,je.newNoDocument(o,oe.min()))}else ae(s===1);else this.Jt(n)!==s&&(this.Wt(n),this.Lt=this.Lt.add(n))}}Yt(e){const n=new Map;this.Ft.forEach((i,o)=>{const a=this.Ht(o);if(a){if(i.current&&Hd(a.target)){const c=new $(a.target.path);this.$t.get(c)!==null||this.Xt(o,c)||this.Kt(o,c,je.newNoDocument(c,e))}i.vt&&(n.set(o,i.St()),i.Dt())}});let s=he();this.Bt.forEach((i,o)=>{let a=!0;o.forEachWhile(c=>{const l=this.Ht(c);return!l||l.purpose===2||(a=!1,!1)}),a&&(s=s.add(i))}),this.$t.forEach((i,o)=>o.setReadTime(e));const r=new Xu(e,n,this.Lt,this.$t,s);return this.$t=bn(),this.Bt=_T(),this.Lt=new Pe(ue),r}qt(e,n){if(!this.jt(e))return;const s=this.Xt(e,n.key)?2:0;this.Qt(e).Ct(n.key,s),this.$t=this.$t.insert(n.key,n),this.Bt=this.Bt.insert(n.key,this.Zt(n.key).add(e))}Kt(e,n,s){if(!this.jt(e))return;const r=this.Qt(e);this.Xt(e,n)?r.Ct(n,1):r.xt(n),this.Bt=this.Bt.insert(n,this.Zt(n).delete(e)),s&&(this.$t=this.$t.insert(n,s))}removeTarget(e){this.Ft.delete(e)}Jt(e){const n=this.Qt(e).St();return this.Ot.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}Nt(e){this.Qt(e).Nt()}Qt(e){let n=this.Ft.get(e);return n||(n=new mT,this.Ft.set(e,n)),n}Zt(e){let n=this.Bt.get(e);return n||(n=new Pe(ue),this.Bt=this.Bt.insert(e,n)),n}jt(e){const n=this.Ht(e)!==null;return n||P("WatchChangeAggregator","Detected inactive target",e),n}Ht(e){const n=this.Ft.get(e);return n&&n.Pt?null:this.Ot.te(e)}Wt(e){this.Ft.set(e,new mT),this.Ot.getRemoteKeysForTarget(e).forEach(n=>{this.Kt(e,n,null)})}Xt(e,n){return this.Ot.getRemoteKeysForTarget(e).has(n)}}function _T(){return new it($.comparator)}function yT(){return new it($.comparator)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const e4=(()=>({asc:"ASCENDING",desc:"DESCENDING"}))(),t4=(()=>({"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"}))();class n4{constructor(e,n){this.databaseId=e,this.dt=n}}function lu(t,e){return t.dt?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function dP(t,e){return t.dt?e.toBase64():e.toUint8Array()}function s4(t,e){return lu(t,e.toTimestamp())}function Rt(t){return ae(!!t),oe.fromTimestamp(function(e){const n=li(e);return new Ye(n.seconds,n.nanos)}(t))}function ew(t,e){return function(n){return new Te(["projects",n.projectId,"databases",n.database])}(t).child("documents").child(e).canonicalString()}function fP(t){const e=Te.fromString(t);return ae(bP(e)),e}function uu(t,e){return ew(t.databaseId,e.path)}function Ms(t,e){const n=fP(e);if(n.get(1)!==t.databaseId.projectId)throw new k(w.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new k(w.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new $(gP(n))}function m_(t,e){return ew(t.databaseId,e)}function pP(t){const e=fP(t);return e.length===4?Te.emptyPath():gP(e)}function hu(t){return new Te(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function gP(t){return ae(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function vT(t,e,n){return{name:uu(t,e),fields:n.value.mapValue.fields}}function mP(t,e,n){const s=Ms(t,e.name),r=Rt(e.updateTime),i=new Bt({mapValue:{fields:e.fields}}),o=je.newFoundDocument(s,r,i);return n&&o.setHasCommittedMutations(),n?o.setHasCommittedMutations():o}function r4(t,e){return"found"in e?function(n,s){ae(!!s.found),s.found.name,s.found.updateTime;const r=Ms(n,s.found.name),i=Rt(s.found.updateTime),o=new Bt({mapValue:{fields:s.found.fields}});return je.newFoundDocument(r,i,o)}(t,e):"missing"in e?function(n,s){ae(!!s.missing),ae(!!s.readTime);const r=Ms(n,s.missing),i=Rt(s.readTime);return je.newNoDocument(r,i)}(t,e):Q()}function i4(t,e){let n;if("targetChange"in e){e.targetChange;const s=function(c){return c==="NO_CHANGE"?0:c==="ADD"?1:c==="REMOVE"?2:c==="CURRENT"?3:c==="RESET"?4:Q()}(e.targetChange.targetChangeType||"NO_CHANGE"),r=e.targetChange.targetIds||[],i=function(c,l){return c.dt?(ae(l===void 0||typeof l=="string"),_t.fromBase64String(l||"")):(ae(l===void 0||l instanceof Uint8Array),_t.fromUint8Array(l||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(c){const l=c.code===void 0?w.UNKNOWN:oP(c.code);return new k(l,c.message||"")}(o);n=new hP(s,r,i,a||null)}else if("documentChange"in e){e.documentChange;const s=e.documentChange;s.document,s.document.name,s.document.updateTime;const r=Ms(t,s.document.name),i=Rt(s.document.updateTime),o=new Bt({mapValue:{fields:s.document.fields}}),a=je.newFoundDocument(r,i,o),c=s.targetIds||[],l=s.removedTargetIds||[];n=new Hh(c,l,a.key,a)}else if("documentDelete"in e){e.documentDelete;const s=e.documentDelete;s.document;const r=Ms(t,s.document),i=s.readTime?Rt(s.readTime):oe.min(),o=je.newNoDocument(r,i),a=s.removedTargetIds||[];n=new Hh([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const s=e.documentRemove;s.document;const r=Ms(t,s.document),i=s.removedTargetIds||[];n=new Hh([],i,r,null)}else{if(!("filter"in e))return Q();{e.filter;const s=e.filter;s.targetId;const r=s.count||0,i=new z6(r),o=s.targetId;n=new uP(o,i)}}return n}function du(t,e){let n;if(e instanceof vc)n={update:vT(t,e.key,e.value)};else if(e instanceof wc)n={delete:uu(t,e.key)};else if(e instanceof Tr)n={update:vT(t,e.key,e.data),updateMask:d4(e.fieldMask)};else{if(!(e instanceof Zv))return Q();n={verify:uu(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(s=>function(r,i){const o=i.transform;if(o instanceof Ga)return{fieldPath:i.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(o instanceof So)return{fieldPath:i.field.canonicalString(),appendMissingElements:{values:o.elements}};if(o instanceof Co)return{fieldPath:i.field.canonicalString(),removeAllFromArray:{values:o.elements}};if(o instanceof za)return{fieldPath:i.field.canonicalString(),increment:o._t};throw Q()}(0,s))),e.precondition.isNone||(n.currentDocument=function(s,r){return r.updateTime!==void 0?{updateTime:s4(s,r.updateTime)}:r.exists!==void 0?{exists:r.exists}:Q()}(t,e.precondition)),n}function __(t,e){const n=e.currentDocument?function(r){return r.updateTime!==void 0?Ze.updateTime(Rt(r.updateTime)):r.exists!==void 0?Ze.exists(r.exists):Ze.none()}(e.currentDocument):Ze.none(),s=e.updateTransforms?e.updateTransforms.map(r=>function(i,o){let a=null;if("setToServerValue"in o)ae(o.setToServerValue==="REQUEST_TIME"),a=new Ga;else if("appendMissingElements"in o){const l=o.appendMissingElements.values||[];a=new So(l)}else if("removeAllFromArray"in o){const l=o.removeAllFromArray.values||[];a=new Co(l)}else"increment"in o?a=new za(i,o.increment):Q();const c=lt.fromServerFormat(o.fieldPath);return new Ju(c,a)}(t,r)):[];if(e.update){e.update.name;const r=Ms(t,e.update.name),i=new Bt({mapValue:{fields:e.update.fields}});if(e.updateMask){const o=function(a){const c=a.fieldPaths||[];return new Dn(c.map(l=>lt.fromServerFormat(l)))}(e.updateMask);return new Tr(r,i,o,n,s)}return new vc(r,i,n,s)}if(e.delete){const r=Ms(t,e.delete);return new wc(r,n)}if(e.verify){const r=Ms(t,e.verify);return new Zv(r,n)}return Q()}function o4(t,e){return t&&t.length>0?(ae(e!==void 0),t.map(n=>function(s,r){let i=s.updateTime?Rt(s.updateTime):Rt(r);return i.isEqual(oe.min())&&(i=Rt(r)),new H6(i,s.transformResults||[])}(n,e))):[]}function _P(t,e){return{documents:[m_(t,e.path)]}}function yP(t,e){const n={structuredQuery:{}},s=e.path;e.collectionGroup!==null?(n.parent=m_(t,s),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=m_(t,s.popLast()),n.structuredQuery.from=[{collectionId:s.lastSegment()}]);const r=function(c){if(c.length===0)return;const l=c.map(u=>function(h){if(h.op==="=="){if(sT(h.value))return{unaryFilter:{field:ta(h.field),op:"IS_NAN"}};if(nT(h.value))return{unaryFilter:{field:ta(h.field),op:"IS_NULL"}}}else if(h.op==="!="){if(sT(h.value))return{unaryFilter:{field:ta(h.field),op:"IS_NOT_NAN"}};if(nT(h.value))return{unaryFilter:{field:ta(h.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:ta(h.field),op:l4(h.op),value:h.value}}}(u));return l.length===1?l[0]:{compositeFilter:{op:"AND",filters:l}}}(e.filters);r&&(n.structuredQuery.where=r);const i=function(c){if(c.length!==0)return c.map(l=>function(u){return{field:ta(u.field),direction:c4(u.dir)}}(l))}(e.orderBy);i&&(n.structuredQuery.orderBy=i);const o=function(c,l){return c.dt||zu(l)?l:{value:l}}(t,e.limit);var a;return o!==null&&(n.structuredQuery.limit=o),e.startAt&&(n.structuredQuery.startAt={before:(a=e.startAt).inclusive,values:a.position}),e.endAt&&(n.structuredQuery.endAt=function(c){return{before:!c.inclusive,values:c.position}}(e.endAt)),n}function vP(t){let e=pP(t.parent);const n=t.structuredQuery,s=n.from?n.from.length:0;let r=null;if(s>0){ae(s===1);const u=n.from[0];u.allDescendants?r=u.collectionId:e=e.child(u.collectionId)}let i=[];n.where&&(i=wP(n.where));let o=[];n.orderBy&&(o=n.orderBy.map(u=>function(h){return new Ta(ha(h.field),function(d){switch(d){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(h.direction))}(u)));let a=null;n.limit&&(a=function(u){let h;return h=typeof u=="object"?u.value:u,zu(h)?null:h}(n.limit));let c=null;n.startAt&&(c=function(u){const h=!!u.before,d=u.values||[];return new hi(d,h)}(n.startAt));let l=null;return n.endAt&&(l=function(u){const h=!u.before,d=u.values||[];return new hi(d,h)}(n.endAt)),WN(e,r,o,i,a,"F",c,l)}function a4(t,e){const n=function(s,r){switch(r){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return Q()}}(0,e.purpose);return n==null?null:{"goog-listen-tags":n}}function wP(t){return t?t.unaryFilter!==void 0?[h4(t)]:t.fieldFilter!==void 0?[u4(t)]:t.compositeFilter!==void 0?t.compositeFilter.filters.map(e=>wP(e)).reduce((e,n)=>e.concat(n)):Q():[]}function c4(t){return e4[t]}function l4(t){return t4[t]}function ta(t){return{fieldPath:t.canonicalString()}}function ha(t){return lt.fromServerFormat(t.fieldPath)}function u4(t){return jt.create(ha(t.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return Q()}}(t.fieldFilter.op),t.fieldFilter.value)}function h4(t){switch(t.unaryFilter.op){case"IS_NAN":const e=ha(t.unaryFilter.field);return jt.create(e,"==",{doubleValue:NaN});case"IS_NULL":const n=ha(t.unaryFilter.field);return jt.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=ha(t.unaryFilter.field);return jt.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const r=ha(t.unaryFilter.field);return jt.create(r,"!=",{nullValue:"NULL_VALUE"});default:return Q()}}function d4(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function bP(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fn(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=wT(e)),e=f4(t.get(n),e);return wT(e)}function f4(t,e){let n=e;const s=t.length;for(let r=0;r<s;r++){const i=t.charAt(r);switch(i){case"\0":n+="";break;case"":n+="";break;default:n+=i}}return n}function wT(t){return t+""}function xs(t){const e=t.length;if(ae(e>=2),e===2)return ae(t.charAt(0)===""&&t.charAt(1)===""),Te.emptyPath();const n=e-2,s=[];let r="";for(let i=0;i<e;){const o=t.indexOf("",i);switch((o<0||o>n)&&Q(),t.charAt(o+1)){case"":const a=t.substring(i,o);let c;r.length===0?c=a:(r+=a,c=r,r=""),s.push(c);break;case"":r+=t.substring(i,o),r+="\0";break;case"":r+=t.substring(i,o+1);break;default:Q()}i=o+2}return new Te(s)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bT=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wh(t,e){return[t,fn(e)]}function IP(t,e,n){return[t,fn(e),n]}const p4={},g4=["prefixPath","collectionGroup","readTime","documentId"],m4=["prefixPath","collectionGroup","documentId"],_4=["collectionGroup","readTime","prefixPath","documentId"],y4=["canonicalId","targetId"],v4=["targetId","path"],w4=["path","targetId"],b4=["collectionId","parent"],I4=["indexId","uid"],E4=["uid","sequenceNumber"],T4=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],S4=["indexId","uid","orderedDocumentKey"],C4=["userId","collectionPath","documentId"],A4=["userId","collectionPath","largestBatchId"],k4=["userId","collectionGroup","largestBatchId"],EP=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],R4=[...EP,"documentOverlays"],TP=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],SP=TP,N4=[...SP,"indexConfiguration","indexState","indexEntries"];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y_ extends $N{constructor(e,n){super(),this.ee=e,this.currentSequenceNumber=n}}function Lt(t,e){const n=q(t);return hs.N(n.ee,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tw{constructor(e,n,s,r){this.batchId=e,this.localWriteTime=n,this.baseMutations=s,this.mutations=r}applyToRemoteDocument(e,n){const s=n.mutationResults;for(let r=0;r<this.mutations.length;r++){const i=this.mutations[r];i.key.isEqual(e.key)&&W6(i,e,s[r])}}applyToLocalView(e,n){for(const s of this.baseMutations)s.key.isEqual(e.key)&&(n=ml(s,e,n,this.localWriteTime));for(const s of this.mutations)s.key.isEqual(e.key)&&(n=ml(s,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const s=lP();return this.mutations.forEach(r=>{const i=e.get(r.key),o=i.overlayedDocument;let a=this.applyToLocalView(o,i.mutatedFields);a=n.has(r.key)?null:a;const c=sP(o,a);c!==null&&s.set(r.key,c),o.isValidDocument()||o.convertToNoDocument(oe.min())}),s}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),he())}isEqual(e){return this.batchId===e.batchId&&Ha(this.mutations,e.mutations,(n,s)=>fT(n,s))&&Ha(this.baseMutations,e.baseMutations,(n,s)=>fT(n,s))}}class nw{constructor(e,n,s,r){this.batch=e,this.commitVersion=n,this.mutationResults=s,this.docVersions=r}static from(e,n,s){ae(e.mutations.length===s.length);let r=Y6;const i=e.mutations;for(let o=0;o<i.length;o++)r=r.insert(i[o].key,s[o].version);return new nw(e,n,s,r)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sw{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xr{constructor(e,n,s,r,i=oe.min(),o=oe.min(),a=_t.EMPTY_BYTE_STRING){this.target=e,this.targetId=n,this.purpose=s,this.sequenceNumber=r,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a}withSequenceNumber(e){return new Xr(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)}withResumeToken(e,n){return new Xr(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e)}withLastLimboFreeSnapshotVersion(e){return new Xr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CP{constructor(e){this.ne=e}}function P4(t,e){let n;if(e.document)n=mP(t.ne,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const s=$.fromSegments(e.noDocument.path),r=ko(e.noDocument.readTime);n=je.newNoDocument(s,r),e.hasCommittedMutations&&n.setHasCommittedMutations()}else{if(!e.unknownDocument)return Q();{const s=$.fromSegments(e.unknownDocument.path),r=ko(e.unknownDocument.version);n=je.newUnknownDocument(s,r)}}return e.readTime&&n.setReadTime(function(s){const r=new Ye(s[0],s[1]);return oe.fromTimestamp(r)}(e.readTime)),n}function IT(t,e){const n=e.key,s={prefixPath:n.getCollectionPath().popLast().toArray(),collectionGroup:n.collectionGroup,documentId:n.path.lastSegment(),readTime:zd(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())s.document=function(r,i){return{name:uu(r,i.key),fields:i.data.value.mapValue.fields,updateTime:lu(r,i.version.toTimestamp())}}(t.ne,e);else if(e.isNoDocument())s.noDocument={path:n.path.toArray(),readTime:Ao(e.version)};else{if(!e.isUnknownDocument())return Q();s.unknownDocument={path:n.path.toArray(),version:Ao(e.version)}}return s}function zd(t){const e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function Ao(t){const e=t.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function ko(t){const e=new Ye(t.seconds,t.nanoseconds);return oe.fromTimestamp(e)}function $i(t,e){const n=(e.baseMutations||[]).map(i=>__(t.ne,i));for(let i=0;i<e.mutations.length-1;++i){const o=e.mutations[i];if(i+1<e.mutations.length&&e.mutations[i+1].transform!==void 0){const a=e.mutations[i+1];o.updateTransforms=a.transform.fieldTransforms,e.mutations.splice(i+1,1),++i}}const s=e.mutations.map(i=>__(t.ne,i)),r=Ye.fromMillis(e.localWriteTimeMs);return new tw(e.batchId,r,n,s)}function Jc(t){const e=ko(t.readTime),n=t.lastLimboFreeSnapshotVersion!==void 0?ko(t.lastLimboFreeSnapshotVersion):oe.min();let s;var r;return t.query.documents!==void 0?(ae((r=t.query).documents.length===1),s=Tn(yc(pP(r.documents[0])))):s=function(i){return Tn(vP(i))}(t.query),new Xr(s,t.targetId,0,t.lastListenSequenceNumber,e,n,_t.fromBase64String(t.resumeToken))}function AP(t,e){const n=Ao(e.snapshotVersion),s=Ao(e.lastLimboFreeSnapshotVersion);let r;r=Hd(e.target)?_P(t.ne,e.target):yP(t.ne,e.target);const i=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:To(e.target),readTime:n,resumeToken:i,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:s,query:r}}function rw(t){const e=vP({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?Gd(e,e.limit,"L"):e}function xg(t,e){return new sw(e.largestBatchId,__(t.ne,e.overlayMutation))}function ET(t,e){const n=e.path.lastSegment();return[t,fn(e.path.popLast()),n]}function TT(t,e,n,s){return{indexId:t,uid:e.uid||"",sequenceNumber:n,readTime:Ao(s.readTime),documentKey:fn(s.documentKey.path),largestBatchId:s.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x4{getBundleMetadata(e,n){return ST(e).get(n).next(s=>{if(s)return{id:(r=s).bundleId,createTime:ko(r.createTime),version:r.version};var r})}saveBundleMetadata(e,n){return ST(e).put({bundleId:(s=n).id,createTime:Ao(Rt(s.createTime)),version:s.version});var s}getNamedQuery(e,n){return CT(e).get(n).next(s=>{if(s)return{name:(r=s).name,query:rw(r.bundledQuery),readTime:ko(r.readTime)};var r})}saveNamedQuery(e,n){return CT(e).put(function(s){return{name:s.name,readTime:Ao(Rt(s.readTime)),bundledQuery:s.bundledQuery}}(n))}}function ST(t){return Lt(t,"bundles")}function CT(t){return Lt(t,"namedQueries")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kp{constructor(e,n){this.wt=e,this.userId=n}static se(e,n){const s=n.uid||"";return new kp(e,s)}getOverlay(e,n){return Fc(e).get(ET(this.userId,n)).next(s=>s?xg(this.wt,s):null)}getOverlays(e,n){const s=Ps();return v.forEach(n,r=>this.getOverlay(e,r).next(i=>{i!==null&&s.set(r,i)})).next(()=>s)}saveOverlays(e,n,s){const r=[];return s.forEach((i,o)=>{const a=new sw(n,o);r.push(this.ie(e,a))}),v.waitFor(r)}removeOverlaysForBatchId(e,n,s){const r=new Set;n.forEach(o=>r.add(fn(o.getCollectionPath())));const i=[];return r.forEach(o=>{const a=IDBKeyRange.bound([this.userId,o,s],[this.userId,o,s+1],!1,!0);i.push(Fc(e).W("collectionPathOverlayIndex",a))}),v.waitFor(i)}getOverlaysForCollection(e,n,s){const r=Ps(),i=fn(n),o=IDBKeyRange.bound([this.userId,i,s],[this.userId,i,Number.POSITIVE_INFINITY],!0);return Fc(e).K("collectionPathOverlayIndex",o).next(a=>{for(const c of a){const l=xg(this.wt,c);r.set(l.getKey(),l)}return r})}getOverlaysForCollectionGroup(e,n,s,r){const i=Ps();let o;const a=IDBKeyRange.bound([this.userId,n,s],[this.userId,n,Number.POSITIVE_INFINITY],!0);return Fc(e).J({index:"collectionGroupOverlayIndex",range:a},(c,l,u)=>{const h=xg(this.wt,l);i.size()<r||h.largestBatchId===o?(i.set(h.getKey(),h),o=h.largestBatchId):u.done()}).next(()=>i)}ie(e,n){return Fc(e).put(function(s,r,i){const[o,a,c]=ET(r,i.mutation.key);return{userId:r,collectionPath:a,documentId:c,collectionGroup:i.mutation.key.getCollectionGroup(),largestBatchId:i.largestBatchId,overlayMutation:du(s.ne,i.mutation)}}(this.wt,this.userId,n))}}function Fc(t){return Lt(t,"documentOverlays")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vi{constructor(){}re(e,n){this.oe(e,n),n.ue()}oe(e,n){if("nullValue"in e)this.ce(n,5);else if("booleanValue"in e)this.ce(n,10),n.ae(e.booleanValue?1:0);else if("integerValue"in e)this.ce(n,15),n.ae(tt(e.integerValue));else if("doubleValue"in e){const s=tt(e.doubleValue);isNaN(s)?this.ce(n,13):(this.ce(n,15),ou(s)?n.ae(0):n.ae(s))}else if("timestampValue"in e){const s=e.timestampValue;this.ce(n,20),typeof s=="string"?n.he(s):(n.he(`${s.seconds||""}`),n.ae(s.nanos||0))}else if("stringValue"in e)this.le(e.stringValue,n),this.fe(n);else if("bytesValue"in e)this.ce(n,30),n.de(bo(e.bytesValue)),this.fe(n);else if("referenceValue"in e)this._e(e.referenceValue,n);else if("geoPointValue"in e){const s=e.geoPointValue;this.ce(n,45),n.ae(s.latitude||0),n.ae(s.longitude||0)}else"mapValue"in e?qN(e)?this.ce(n,Number.MAX_SAFE_INTEGER):(this.we(e.mapValue,n),this.fe(n)):"arrayValue"in e?(this.me(e.arrayValue,n),this.fe(n)):Q()}le(e,n){this.ce(n,25),this.ge(e,n)}ge(e,n){n.he(e)}we(e,n){const s=e.fields||{};this.ce(n,55);for(const r of Object.keys(s))this.le(r,n),this.oe(s[r],n)}me(e,n){const s=e.values||[];this.ce(n,50);for(const r of s)this.oe(r,n)}_e(e,n){this.ce(n,37),$.fromName(e).path.forEach(s=>{this.ce(n,60),this.ge(s,n)})}ce(e,n){e.ae(n)}fe(e){e.ae(2)}}Vi.ye=new Vi;function D4(t){if(t===0)return 8;let e=0;return t>>4==0&&(e+=4,t<<=4),t>>6==0&&(e+=2,t<<=2),t>>7==0&&(e+=1),e}function AT(t){const e=64-function(n){let s=0;for(let r=0;r<8;++r){const i=D4(255&n[r]);if(s+=i,i!==8)break}return s}(t);return Math.ceil(e/8)}class O4{constructor(){this.buffer=new Uint8Array(1024),this.position=0}pe(e){const n=e[Symbol.iterator]();let s=n.next();for(;!s.done;)this.Ie(s.value),s=n.next();this.Te()}Ee(e){const n=e[Symbol.iterator]();let s=n.next();for(;!s.done;)this.Ae(s.value),s=n.next();this.Re()}be(e){for(const n of e){const s=n.charCodeAt(0);if(s<128)this.Ie(s);else if(s<2048)this.Ie(960|s>>>6),this.Ie(128|63&s);else if(n<"\uD800"||"\uDBFF"<n)this.Ie(480|s>>>12),this.Ie(128|63&s>>>6),this.Ie(128|63&s);else{const r=n.codePointAt(0);this.Ie(240|r>>>18),this.Ie(128|63&r>>>12),this.Ie(128|63&r>>>6),this.Ie(128|63&r)}}this.Te()}Pe(e){for(const n of e){const s=n.charCodeAt(0);if(s<128)this.Ae(s);else if(s<2048)this.Ae(960|s>>>6),this.Ae(128|63&s);else if(n<"\uD800"||"\uDBFF"<n)this.Ae(480|s>>>12),this.Ae(128|63&s>>>6),this.Ae(128|63&s);else{const r=n.codePointAt(0);this.Ae(240|r>>>18),this.Ae(128|63&r>>>12),this.Ae(128|63&r>>>6),this.Ae(128|63&r)}}this.Re()}ve(e){const n=this.Ve(e),s=AT(n);this.Se(1+s),this.buffer[this.position++]=255&s;for(let r=n.length-s;r<n.length;++r)this.buffer[this.position++]=255&n[r]}De(e){const n=this.Ve(e),s=AT(n);this.Se(1+s),this.buffer[this.position++]=~(255&s);for(let r=n.length-s;r<n.length;++r)this.buffer[this.position++]=~(255&n[r])}Ce(){this.xe(255),this.xe(255)}Ne(){this.ke(255),this.ke(255)}reset(){this.position=0}seed(e){this.Se(e.length),this.buffer.set(e,this.position),this.position+=e.length}Me(){return this.buffer.slice(0,this.position)}Ve(e){const n=function(r){const i=new DataView(new ArrayBuffer(8));return i.setFloat64(0,r,!1),new Uint8Array(i.buffer)}(e),s=(128&n[0])!=0;n[0]^=s?255:128;for(let r=1;r<n.length;++r)n[r]^=s?255:0;return n}Ie(e){const n=255&e;n===0?(this.xe(0),this.xe(255)):n===255?(this.xe(255),this.xe(0)):this.xe(n)}Ae(e){const n=255&e;n===0?(this.ke(0),this.ke(255)):n===255?(this.ke(255),this.ke(0)):this.ke(e)}Te(){this.xe(0),this.xe(1)}Re(){this.ke(0),this.ke(1)}xe(e){this.Se(1),this.buffer[this.position++]=e}ke(e){this.Se(1),this.buffer[this.position++]=~e}Se(e){const n=e+this.position;if(n<=this.buffer.length)return;let s=2*this.buffer.length;s<n&&(s=n);const r=new Uint8Array(s);r.set(this.buffer),this.buffer=r}}class M4{constructor(e){this.Oe=e}de(e){this.Oe.pe(e)}he(e){this.Oe.be(e)}ae(e){this.Oe.ve(e)}ue(){this.Oe.Ce()}}class L4{constructor(e){this.Oe=e}de(e){this.Oe.Ee(e)}he(e){this.Oe.Pe(e)}ae(e){this.Oe.De(e)}ue(){this.Oe.Ne()}}class Uc{constructor(){this.Oe=new O4,this.Fe=new M4(this.Oe),this.$e=new L4(this.Oe)}seed(e){this.Oe.seed(e)}Be(e){return e===0?this.Fe:this.$e}Me(){return this.Oe.Me()}reset(){this.Oe.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bi{constructor(e,n,s,r){this.indexId=e,this.documentKey=n,this.arrayValue=s,this.directionalValue=r}Le(){const e=this.directionalValue.length,n=e===0||this.directionalValue[e-1]===255?e+1:e,s=new Uint8Array(n);return s.set(this.directionalValue,0),n!==e?s.set([0],this.directionalValue.length):++s[s.length-1],new Bi(this.indexId,this.documentKey,this.arrayValue,s)}}function ki(t,e){let n=t.indexId-e.indexId;return n!==0?n:(n=kT(t.arrayValue,e.arrayValue),n!==0?n:(n=kT(t.directionalValue,e.directionalValue),n!==0?n:$.comparator(t.documentKey,e.documentKey)))}function kT(t,e){for(let n=0;n<t.length&&n<e.length;++n){const s=t[n]-e[n];if(s!==0)return s}return t.length-e.length}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F4{constructor(e){this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.Ue=e.orderBy,this.qe=[];for(const n of e.filters){const s=n;s.ht()?this.Ke=s:this.qe.push(s)}}Ge(e){const n=d_(e);if(n!==void 0&&!this.Qe(n))return!1;const s=Di(e);let r=0,i=0;for(;r<s.length&&this.Qe(s[r]);++r);if(r===s.length)return!0;if(this.Ke!==void 0){const o=s[r];if(!this.je(this.Ke,o)||!this.We(this.Ue[i++],o))return!1;++r}for(;r<s.length;++r){const o=s[r];if(i>=this.Ue.length||!this.We(this.Ue[i++],o))return!1}return!0}Qe(e){for(const n of this.qe)if(this.je(n,e))return!0;return!1}je(e,n){if(e===void 0||!e.field.isEqual(n.fieldPath))return!1;const s=e.op==="array-contains"||e.op==="array-contains-any";return n.kind===2===s}We(e,n){return!!e.field.isEqual(n.fieldPath)&&(n.kind===0&&e.dir==="asc"||n.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U4{constructor(){this.ze=new iw}addToCollectionParentIndex(e,n){return this.ze.add(n),v.resolve()}getCollectionParents(e,n){return v.resolve(this.ze.getEntries(n))}addFieldIndex(e,n){return v.resolve()}deleteFieldIndex(e,n){return v.resolve()}getDocumentsMatchingTarget(e,n){return v.resolve(null)}getIndexType(e,n){return v.resolve(0)}getFieldIndexes(e,n){return v.resolve([])}getNextCollectionGroupToUpdate(e){return v.resolve(null)}getMinOffset(e,n){return v.resolve(Fn.min())}getMinOffsetFromCollectionGroup(e,n){return v.resolve(Fn.min())}updateCollectionGroup(e,n,s){return v.resolve()}updateIndexEntries(e,n){return v.resolve()}}class iw{constructor(){this.index={}}add(e){const n=e.lastSegment(),s=e.popLast(),r=this.index[n]||new Pe(Te.comparator),i=!r.has(s);return this.index[n]=r.add(s),i}has(e){const n=e.lastSegment(),s=e.popLast(),r=this.index[n];return r&&r.has(s)}getEntries(e){return(this.index[e]||new Pe(Te.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ih=new Uint8Array(0);class $4{constructor(e,n){this.user=e,this.databaseId=n,this.He=new iw,this.Je=new bi(s=>To(s),(s,r)=>Qu(s,r)),this.uid=e.uid||""}addToCollectionParentIndex(e,n){if(!this.He.has(n)){const s=n.lastSegment(),r=n.popLast();e.addOnCommittedListener(()=>{this.He.add(n)});const i={collectionId:s,parent:fn(r)};return RT(e).put(i)}return v.resolve()}getCollectionParents(e,n){const s=[],r=IDBKeyRange.bound([n,""],[ON(n),""],!1,!0);return RT(e).K(r).next(i=>{for(const o of i){if(o.collectionId!==n)break;s.push(xs(o.parent))}return s})}addFieldIndex(e,n){const s=Eh(e),r=function(o){return{indexId:o.indexId,collectionGroup:o.collectionGroup,fields:o.fields.map(a=>[a.fieldPath.canonicalString(),a.kind])}}(n);delete r.indexId;const i=s.add(r);if(n.indexState){const o=Vc(e);return i.next(a=>{o.put(TT(a,this.user,n.indexState.sequenceNumber,n.indexState.offset))})}return i.next()}deleteFieldIndex(e,n){const s=Eh(e),r=Vc(e),i=$c(e);return s.delete(n.indexId).next(()=>r.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0))).next(()=>i.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0)))}getDocumentsMatchingTarget(e,n){const s=$c(e);let r=!0;const i=new Map;return v.forEach(this.Ye(n),o=>this.Xe(e,o).next(a=>{r&&(r=!!a),i.set(o,a)})).next(()=>{if(r){let o=he();const a=[];return v.forEach(i,(c,l)=>{var u;P("IndexedDbIndexManager",`Using index ${u=c,`id=${u.indexId}|cg=${u.collectionGroup}|f=${u.fields.map(E=>`${E.fieldPath}:${E.kind}`).join(",")}`} to execute ${To(n)}`);const h=function(E,S){const H=d_(S);if(H===void 0)return null;for(const Y of Wd(E,H.fieldPath))switch(Y.op){case"array-contains-any":return Y.value.arrayValue.values||[];case"array-contains":return[Y.value]}return null}(l,c),d=function(E,S){const H=new Map;for(const Y of Di(S))for(const M of Wd(E,Y.fieldPath))switch(M.op){case"==":case"in":H.set(Y.fieldPath.canonicalString(),M.value);break;case"not-in":case"!=":return H.set(Y.fieldPath.canonicalString(),M.value),Array.from(H.values())}return null}(l,c),f=function(E,S){const H=[];let Y=!0;for(const M of Di(S)){const G=M.kind===0?aT(E,M.fieldPath,E.startAt):cT(E,M.fieldPath,E.startAt);H.push(G.value),Y&&(Y=G.inclusive)}return new hi(H,Y)}(l,c),p=function(E,S){const H=[];let Y=!0;for(const M of Di(S)){const G=M.kind===0?cT(E,M.fieldPath,E.endAt):aT(E,M.fieldPath,E.endAt);H.push(G.value),Y&&(Y=G.inclusive)}return new hi(H,Y)}(l,c),_=this.Ze(c,l,f),y=this.Ze(c,l,p),T=this.tn(c,l,d),I=this.en(c.indexId,h,_,f.inclusive,y,p.inclusive,T);return v.forEach(I,E=>s.j(E,n.limit).next(S=>{S.forEach(H=>{const Y=$.fromSegments(H.documentKey);o.has(Y)||(o=o.add(Y),a.push(Y))})}))}).next(()=>a)}return v.resolve(null)})}Ye(e){let n=this.Je.get(e);return n||(n=[e],this.Je.set(e,n),n)}en(e,n,s,r,i,o,a){const c=(n!=null?n.length:1)*Math.max(s.length,i.length),l=c/(n!=null?n.length:1),u=[];for(let h=0;h<c;++h){const d=n?this.nn(n[h/l]):Ih,f=this.sn(e,d,s[h%l],r),p=this.rn(e,d,i[h%l],o),_=a.map(y=>this.sn(e,d,y,!0));u.push(...this.createRange(f,p,_))}return u}sn(e,n,s,r){const i=new Bi(e,$.empty(),n,s);return r?i:i.Le()}rn(e,n,s,r){const i=new Bi(e,$.empty(),n,s);return r?i.Le():i}Xe(e,n){const s=new F4(n),r=n.collectionGroup!=null?n.collectionGroup:n.path.lastSegment();return this.getFieldIndexes(e,r).next(i=>{let o=null;for(const a of i)s.Ge(a)&&(!o||a.fields.length>o.fields.length)&&(o=a);return o})}getIndexType(e,n){let s=2;return v.forEach(this.Ye(n),r=>this.Xe(e,r).next(i=>{i?s!==0&&i.fields.length<function(o){let a=new Pe(lt.comparator),c=!1;for(const l of o.filters){const u=l;u.field.isKeyField()||(u.op==="array-contains"||u.op==="array-contains-any"?c=!0:a=a.add(u.field))}for(const l of o.orderBy)l.field.isKeyField()||(a=a.add(l.field));return a.size+(c?1:0)}(r)&&(s=1):s=0})).next(()=>s)}on(e,n){const s=new Uc;for(const r of Di(e)){const i=n.data.field(r.fieldPath);if(i==null)return null;const o=s.Be(r.kind);Vi.ye.re(i,o)}return s.Me()}nn(e){const n=new Uc;return Vi.ye.re(e,n.Be(0)),n.Me()}un(e,n){const s=new Uc;return Vi.ye.re(Eo(this.databaseId,n),s.Be(function(r){const i=Di(r);return i.length===0?0:i[i.length-1].kind}(e))),s.Me()}tn(e,n,s){if(s===null)return[];let r=[];r.push(new Uc);let i=0;for(const o of Di(e)){const a=s[i++];for(const c of r)if(this.cn(n,o.fieldPath)&&cu(a))r=this.an(r,o,a);else{const l=c.Be(o.kind);Vi.ye.re(a,l)}}return this.hn(r)}Ze(e,n,s){return this.tn(e,n,s.position)}hn(e){const n=[];for(let s=0;s<e.length;++s)n[s]=e[s].Me();return n}an(e,n,s){const r=[...e],i=[];for(const o of s.arrayValue.values||[])for(const a of r){const c=new Uc;c.seed(a.Me()),Vi.ye.re(o,c.Be(n.kind)),i.push(c)}return i}cn(e,n){return!!e.filters.find(s=>s instanceof jt&&s.field.isEqual(n)&&(s.op==="in"||s.op==="not-in"))}getFieldIndexes(e,n){const s=Eh(e),r=Vc(e);return(n?s.K("collectionGroupIndex",IDBKeyRange.bound(n,n)):s.K()).next(i=>{const o=[];return v.forEach(i,a=>r.get([a.indexId,this.uid]).next(c=>{o.push(function(l,u){const h=u?new Kd(u.sequenceNumber,new Fn(ko(u.readTime),new $(xs(u.documentKey)),u.largestBatchId)):Kd.empty(),d=l.fields.map(([f,p])=>new b6(lt.fromServerFormat(f),p));return new MN(l.indexId,l.collectionGroup,d,h)}(a,c))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(n=>n.length===0?null:(n.sort((s,r)=>{const i=s.indexState.sequenceNumber-r.indexState.sequenceNumber;return i!==0?i:ue(s.collectionGroup,r.collectionGroup)}),n[0].collectionGroup))}updateCollectionGroup(e,n,s){const r=Eh(e),i=Vc(e);return this.ln(e).next(o=>r.K("collectionGroupIndex",IDBKeyRange.bound(n,n)).next(a=>v.forEach(a,c=>i.put(TT(c.indexId,this.user,o,s)))))}updateIndexEntries(e,n){const s=new Map;return v.forEach(n,(r,i)=>{const o=s.get(r.collectionGroup);return(o?v.resolve(o):this.getFieldIndexes(e,r.collectionGroup)).next(a=>(s.set(r.collectionGroup,a),v.forEach(a,c=>this.fn(e,r,c).next(l=>{const u=this.dn(i,c);return l.isEqual(u)?v.resolve():this._n(e,i,c,l,u)}))))})}wn(e,n,s,r){return $c(e).put({indexId:r.indexId,uid:this.uid,arrayValue:r.arrayValue,directionalValue:r.directionalValue,orderedDocumentKey:this.un(s,n.key),documentKey:n.key.path.toArray()})}mn(e,n,s,r){return $c(e).delete([r.indexId,this.uid,r.arrayValue,r.directionalValue,this.un(s,n.key),n.key.path.toArray()])}fn(e,n,s){const r=$c(e);let i=new Pe(ki);return r.J({index:"documentKeyIndex",range:IDBKeyRange.only([s.indexId,this.uid,this.un(s,n)])},(o,a)=>{i=i.add(new Bi(s.indexId,n,a.arrayValue,a.directionalValue))}).next(()=>i)}dn(e,n){let s=new Pe(ki);const r=this.on(n,e);if(r==null)return s;const i=d_(n);if(i!=null){const o=e.data.field(i.fieldPath);if(cu(o))for(const a of o.arrayValue.values||[])s=s.add(new Bi(n.indexId,e.key,this.nn(a),r))}else s=s.add(new Bi(n.indexId,e.key,Ih,r));return s}_n(e,n,s,r,i){P("IndexedDbIndexManager","Updating index entries for document '%s'",n.key);const o=[];return function(a,c,l,u,h){const d=a.getIterator(),f=c.getIterator();let p=ea(d),_=ea(f);for(;p||_;){let y=!1,T=!1;if(p&&_){const I=l(p,_);I<0?T=!0:I>0&&(y=!0)}else p!=null?T=!0:y=!0;y?(u(_),_=ea(f)):T?(h(p),p=ea(d)):(p=ea(d),_=ea(f))}}(r,i,ki,a=>{o.push(this.wn(e,n,s,a))},a=>{o.push(this.mn(e,n,s,a))}),v.waitFor(o)}ln(e){let n=1;return Vc(e).J({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(s,r,i)=>{i.done(),n=r.sequenceNumber+1}).next(()=>n)}createRange(e,n,s){s=s.sort((o,a)=>ki(o,a)).filter((o,a,c)=>!a||ki(o,c[a-1])!==0);const r=[];r.push(e);for(const o of s){const a=ki(o,e),c=ki(o,n);if(a===0)r[0]=e.Le();else if(a>0&&c<0)r.push(o),r.push(o.Le());else if(c>0)break}r.push(n);const i=[];for(let o=0;o<r.length;o+=2)i.push(IDBKeyRange.bound([r[o].indexId,this.uid,r[o].arrayValue,r[o].directionalValue,Ih,[]],[r[o+1].indexId,this.uid,r[o+1].arrayValue,r[o+1].directionalValue,Ih,[]]));return i}getMinOffsetFromCollectionGroup(e,n){return this.getFieldIndexes(e,n).next(NT)}getMinOffset(e,n){return v.mapArray(this.Ye(n),s=>this.Xe(e,s).next(r=>r||Q())).next(NT)}}function RT(t){return Lt(t,"collectionParents")}function $c(t){return Lt(t,"indexEntries")}function Eh(t){return Lt(t,"indexConfiguration")}function Vc(t){return Lt(t,"indexState")}function NT(t){ae(t.length!==0);let e=t[0].indexState.offset,n=e.largestBatchId;for(let s=1;s<t.length;s++){const r=t[s].indexState.offset;Wv(r,e)<0&&(e=r),n<r.largestBatchId&&(n=r.largestBatchId)}return new Fn(e.readTime,e.documentKey,n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PT={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class _n{constructor(e,n,s){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=s}static withCacheSize(e){return new _n(e,_n.DEFAULT_COLLECTION_PERCENTILE,_n.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kP(t,e,n){const s=t.store("mutations"),r=t.store("documentMutations"),i=[],o=IDBKeyRange.only(n.batchId);let a=0;const c=s.J({range:o},(u,h,d)=>(a++,d.delete()));i.push(c.next(()=>{ae(a===1)}));const l=[];for(const u of n.mutations){const h=IP(e,u.key.path,n.batchId);i.push(r.delete(h)),l.push(u.key)}return v.waitFor(i).next(()=>l)}function Qd(t){if(!t)return 0;let e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw Q();e=t.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */_n.DEFAULT_COLLECTION_PERCENTILE=10,_n.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,_n.DEFAULT=new _n(41943040,_n.DEFAULT_COLLECTION_PERCENTILE,_n.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),_n.DISABLED=new _n(-1,0,0);class Rp{constructor(e,n,s,r){this.userId=e,this.wt=n,this.indexManager=s,this.referenceDelegate=r,this.gn={}}static se(e,n,s,r){ae(e.uid!=="");const i=e.isAuthenticated()?e.uid:"";return new Rp(i,n,s,r)}checkEmpty(e){let n=!0;const s=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Dr(e).J({index:"userMutationsIndex",range:s},(r,i,o)=>{n=!1,o.done()}).next(()=>n)}addMutationBatch(e,n,s,r){const i=ca(e),o=Dr(e);return o.add({}).next(a=>{ae(typeof a=="number");const c=new tw(a,n,s,r),l=function(d,f,p){const _=p.baseMutations.map(T=>du(d.ne,T)),y=p.mutations.map(T=>du(d.ne,T));return{userId:f,batchId:p.batchId,localWriteTimeMs:p.localWriteTime.toMillis(),baseMutations:_,mutations:y}}(this.wt,this.userId,c),u=[];let h=new Pe((d,f)=>ue(d.canonicalString(),f.canonicalString()));for(const d of r){const f=IP(this.userId,d.key.path,a);h=h.add(d.key.path.popLast()),u.push(o.put(l)),u.push(i.put(f,p4))}return h.forEach(d=>{u.push(this.indexManager.addToCollectionParentIndex(e,d))}),e.addOnCommittedListener(()=>{this.gn[a]=c.keys()}),v.waitFor(u).next(()=>c)})}lookupMutationBatch(e,n){return Dr(e).get(n).next(s=>s?(ae(s.userId===this.userId),$i(this.wt,s)):null)}yn(e,n){return this.gn[n]?v.resolve(this.gn[n]):this.lookupMutationBatch(e,n).next(s=>{if(s){const r=s.keys();return this.gn[n]=r,r}return null})}getNextMutationBatchAfterBatchId(e,n){const s=n+1,r=IDBKeyRange.lowerBound([this.userId,s]);let i=null;return Dr(e).J({index:"userMutationsIndex",range:r},(o,a,c)=>{a.userId===this.userId&&(ae(a.batchId>=s),i=$i(this.wt,a)),c.done()}).next(()=>i)}getHighestUnacknowledgedBatchId(e){const n=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let s=-1;return Dr(e).J({index:"userMutationsIndex",range:n,reverse:!0},(r,i,o)=>{s=i.batchId,o.done()}).next(()=>s)}getAllMutationBatches(e){const n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Dr(e).K("userMutationsIndex",n).next(s=>s.map(r=>$i(this.wt,r)))}getAllMutationBatchesAffectingDocumentKey(e,n){const s=Wh(this.userId,n.path),r=IDBKeyRange.lowerBound(s),i=[];return ca(e).J({range:r},(o,a,c)=>{const[l,u,h]=o,d=xs(u);if(l===this.userId&&n.path.isEqual(d))return Dr(e).get(h).next(f=>{if(!f)throw Q();ae(f.userId===this.userId),i.push($i(this.wt,f))});c.done()}).next(()=>i)}getAllMutationBatchesAffectingDocumentKeys(e,n){let s=new Pe(ue);const r=[];return n.forEach(i=>{const o=Wh(this.userId,i.path),a=IDBKeyRange.lowerBound(o),c=ca(e).J({range:a},(l,u,h)=>{const[d,f,p]=l,_=xs(f);d===this.userId&&i.path.isEqual(_)?s=s.add(p):h.done()});r.push(c)}),v.waitFor(r).next(()=>this.pn(e,s))}getAllMutationBatchesAffectingQuery(e,n){const s=n.path,r=s.length+1,i=Wh(this.userId,s),o=IDBKeyRange.lowerBound(i);let a=new Pe(ue);return ca(e).J({range:o},(c,l,u)=>{const[h,d,f]=c,p=xs(d);h===this.userId&&s.isPrefixOf(p)?p.length===r&&(a=a.add(f)):u.done()}).next(()=>this.pn(e,a))}pn(e,n){const s=[],r=[];return n.forEach(i=>{r.push(Dr(e).get(i).next(o=>{if(o===null)throw Q();ae(o.userId===this.userId),s.push($i(this.wt,o))}))}),v.waitFor(r).next(()=>s)}removeMutationBatch(e,n){return kP(e.ee,this.userId,n).next(s=>(e.addOnCommittedListener(()=>{this.In(n.batchId)}),v.forEach(s,r=>this.referenceDelegate.markPotentiallyOrphaned(e,r))))}In(e){delete this.gn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(n=>{if(!n)return v.resolve();const s=IDBKeyRange.lowerBound([this.userId]),r=[];return ca(e).J({range:s},(i,o,a)=>{if(i[0]===this.userId){const c=xs(i[1]);r.push(c)}else a.done()}).next(()=>{ae(r.length===0)})})}containsKey(e,n){return RP(e,this.userId,n)}Tn(e){return NP(e).get(this.userId).next(n=>n||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}}function RP(t,e,n){const s=Wh(e,n.path),r=s[1],i=IDBKeyRange.lowerBound(s);let o=!1;return ca(t).J({range:i,H:!0},(a,c,l)=>{const[u,h,d]=a;u===e&&h===r&&(o=!0),l.done()}).next(()=>o)}function Dr(t){return Lt(t,"mutations")}function ca(t){return Lt(t,"documentMutations")}function NP(t){return Lt(t,"mutationQueues")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ro{constructor(e){this.En=e}next(){return this.En+=2,this.En}static An(){return new Ro(0)}static Rn(){return new Ro(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V4{constructor(e,n){this.referenceDelegate=e,this.wt=n}allocateTargetId(e){return this.bn(e).next(n=>{const s=new Ro(n.highestTargetId);return n.highestTargetId=s.next(),this.Pn(e,n).next(()=>n.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.bn(e).next(n=>oe.fromTimestamp(new Ye(n.lastRemoteSnapshotVersion.seconds,n.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.bn(e).next(n=>n.highestListenSequenceNumber)}setTargetsMetadata(e,n,s){return this.bn(e).next(r=>(r.highestListenSequenceNumber=n,s&&(r.lastRemoteSnapshotVersion=s.toTimestamp()),n>r.highestListenSequenceNumber&&(r.highestListenSequenceNumber=n),this.Pn(e,r)))}addTargetData(e,n){return this.vn(e,n).next(()=>this.bn(e).next(s=>(s.targetCount+=1,this.Vn(n,s),this.Pn(e,s))))}updateTargetData(e,n){return this.vn(e,n)}removeTargetData(e,n){return this.removeMatchingKeysForTargetId(e,n.targetId).next(()=>na(e).delete(n.targetId)).next(()=>this.bn(e)).next(s=>(ae(s.targetCount>0),s.targetCount-=1,this.Pn(e,s)))}removeTargets(e,n,s){let r=0;const i=[];return na(e).J((o,a)=>{const c=Jc(a);c.sequenceNumber<=n&&s.get(c.targetId)===null&&(r++,i.push(this.removeTargetData(e,c)))}).next(()=>v.waitFor(i)).next(()=>r)}forEachTarget(e,n){return na(e).J((s,r)=>{const i=Jc(r);n(i)})}bn(e){return xT(e).get("targetGlobalKey").next(n=>(ae(n!==null),n))}Pn(e,n){return xT(e).put("targetGlobalKey",n)}vn(e,n){return na(e).put(AP(this.wt,n))}Vn(e,n){let s=!1;return e.targetId>n.highestTargetId&&(n.highestTargetId=e.targetId,s=!0),e.sequenceNumber>n.highestListenSequenceNumber&&(n.highestListenSequenceNumber=e.sequenceNumber,s=!0),s}getTargetCount(e){return this.bn(e).next(n=>n.targetCount)}getTargetData(e,n){const s=To(n),r=IDBKeyRange.bound([s,Number.NEGATIVE_INFINITY],[s,Number.POSITIVE_INFINITY]);let i=null;return na(e).J({range:r,index:"queryTargetsIndex"},(o,a,c)=>{const l=Jc(a);Qu(n,l.target)&&(i=l,c.done())}).next(()=>i)}addMatchingKeys(e,n,s){const r=[],i=Vr(e);return n.forEach(o=>{const a=fn(o.path);r.push(i.put({targetId:s,path:a})),r.push(this.referenceDelegate.addReference(e,s,o))}),v.waitFor(r)}removeMatchingKeys(e,n,s){const r=Vr(e);return v.forEach(n,i=>{const o=fn(i.path);return v.waitFor([r.delete([s,o]),this.referenceDelegate.removeReference(e,s,i)])})}removeMatchingKeysForTargetId(e,n){const s=Vr(e),r=IDBKeyRange.bound([n],[n+1],!1,!0);return s.delete(r)}getMatchingKeysForTargetId(e,n){const s=IDBKeyRange.bound([n],[n+1],!1,!0),r=Vr(e);let i=he();return r.J({range:s,H:!0},(o,a,c)=>{const l=xs(o[1]),u=new $(l);i=i.add(u)}).next(()=>i)}containsKey(e,n){const s=fn(n.path),r=IDBKeyRange.bound([s],[ON(s)],!1,!0);let i=0;return Vr(e).J({index:"documentTargetsIndex",H:!0,range:r},([o,a],c,l)=>{o!==0&&(i++,l.done())}).next(()=>i>0)}te(e,n){return na(e).get(n).next(s=>s?Jc(s):null)}}function na(t){return Lt(t,"targets")}function xT(t){return Lt(t,"targetGlobal")}function Vr(t){return Lt(t,"targetDocuments")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DT([t,e],[n,s]){const r=ue(t,n);return r===0?ue(e,s):r}class B4{constructor(e){this.Sn=e,this.buffer=new Pe(DT),this.Dn=0}Cn(){return++this.Dn}xn(e){const n=[e,this.Cn()];if(this.buffer.size<this.Sn)this.buffer=this.buffer.add(n);else{const s=this.buffer.last();DT(n,s)<0&&(this.buffer=this.buffer.delete(s).add(n))}}get maxValue(){return this.buffer.last()[0]}}class j4{constructor(e,n,s){this.garbageCollector=e,this.asyncQueue=n,this.localStore=s,this.Nn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.kn(6e4)}stop(){this.Nn&&(this.Nn.cancel(),this.Nn=null)}get started(){return this.Nn!==null}kn(e){P("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.Nn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Nn=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){wi(n)?P("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",n):await vi(n)}await this.kn(3e5)})}}class q4{constructor(e,n){this.Mn=e,this.params=n}calculateTargetCount(e,n){return this.Mn.On(e).next(s=>Math.floor(n/100*s))}nthSequenceNumber(e,n){if(n===0)return v.resolve(wn.ot);const s=new B4(n);return this.Mn.forEachTarget(e,r=>s.xn(r.sequenceNumber)).next(()=>this.Mn.Fn(e,r=>s.xn(r))).next(()=>s.maxValue)}removeTargets(e,n,s){return this.Mn.removeTargets(e,n,s)}removeOrphanedDocuments(e,n){return this.Mn.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(P("LruGarbageCollector","Garbage collection skipped; disabled"),v.resolve(PT)):this.getCacheSize(e).next(s=>s<this.params.cacheSizeCollectionThreshold?(P("LruGarbageCollector",`Garbage collection skipped; Cache size ${s} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),PT):this.$n(e,n))}getCacheSize(e){return this.Mn.getCacheSize(e)}$n(e,n){let s,r,i,o,a,c,l;const u=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(h=>(h>this.params.maximumSequenceNumbersToCollect?(P("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${h}`),r=this.params.maximumSequenceNumbersToCollect):r=h,o=Date.now(),this.nthSequenceNumber(e,r))).next(h=>(s=h,a=Date.now(),this.removeTargets(e,s,n))).next(h=>(i=h,c=Date.now(),this.removeOrphanedDocuments(e,s))).next(h=>(l=Date.now(),h_()<=ge.DEBUG&&P("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-u}ms
	Determined least recently used ${r} in `+(a-o)+`ms
	Removed ${i} targets in `+(c-a)+`ms
	Removed ${h} documents in `+(l-c)+`ms
Total Duration: ${l-u}ms`),v.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:i,documentsRemoved:h})))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K4{constructor(e,n){this.db=e,this.garbageCollector=function(s,r){return new q4(s,r)}(this,n)}On(e){const n=this.Bn(e);return this.db.getTargetCache().getTargetCount(e).next(s=>n.next(r=>s+r))}Bn(e){let n=0;return this.Fn(e,s=>{n++}).next(()=>n)}forEachTarget(e,n){return this.db.getTargetCache().forEachTarget(e,n)}Fn(e,n){return this.Ln(e,(s,r)=>n(r))}addReference(e,n,s){return Th(e,s)}removeReference(e,n,s){return Th(e,s)}removeTargets(e,n,s){return this.db.getTargetCache().removeTargets(e,n,s)}markPotentiallyOrphaned(e,n){return Th(e,n)}Un(e,n){return function(s,r){let i=!1;return NP(s).Y(o=>RP(s,o,r).next(a=>(a&&(i=!0),v.resolve(!a)))).next(()=>i)}(e,n)}removeOrphanedDocuments(e,n){const s=this.db.getRemoteDocumentCache().newChangeBuffer(),r=[];let i=0;return this.Ln(e,(o,a)=>{if(a<=n){const c=this.Un(e,o).next(l=>{if(!l)return i++,s.getEntry(e,o).next(()=>(s.removeEntry(o,oe.min()),Vr(e).delete([0,fn(o.path)])))});r.push(c)}}).next(()=>v.waitFor(r)).next(()=>s.apply(e)).next(()=>i)}removeTarget(e,n){const s=n.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,s)}updateLimboDocument(e,n){return Th(e,n)}Ln(e,n){const s=Vr(e);let r,i=wn.ot;return s.J({index:"documentTargetsIndex"},([o,a],{path:c,sequenceNumber:l})=>{o===0?(i!==wn.ot&&n(new $(xs(r)),i),i=l,r=c):i=wn.ot}).next(()=>{i!==wn.ot&&n(new $(xs(r)),i)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function Th(t,e){return Vr(t).put(function(n,s){return{targetId:0,path:fn(n.path),sequenceNumber:s}}(e,t.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PP{constructor(){this.changes=new bi(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,je.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const s=this.changes.get(n);return s!==void 0?v.resolve(s):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H4{constructor(e){this.wt=e}setIndexManager(e){this.indexManager=e}addEntry(e,n,s){return Ri(e).put(s)}removeEntry(e,n,s){return Ri(e).delete(function(r,i){const o=r.path.toArray();return[o.slice(0,o.length-2),o[o.length-2],zd(i),o[o.length-1]]}(n,s))}updateMetadata(e,n){return this.getMetadata(e).next(s=>(s.byteSize+=n,this.qn(e,s)))}getEntry(e,n){let s=je.newInvalidDocument(n);return Ri(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(Bc(n))},(r,i)=>{s=this.Kn(n,i)}).next(()=>s)}Gn(e,n){let s={size:0,document:je.newInvalidDocument(n)};return Ri(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(Bc(n))},(r,i)=>{s={document:this.Kn(n,i),size:Qd(i)}}).next(()=>s)}getEntries(e,n){let s=bn();return this.Qn(e,n,(r,i)=>{const o=this.Kn(r,i);s=s.insert(r,o)}).next(()=>s)}jn(e,n){let s=bn(),r=new it($.comparator);return this.Qn(e,n,(i,o)=>{const a=this.Kn(i,o);s=s.insert(i,a),r=r.insert(i,Qd(o))}).next(()=>({documents:s,Wn:r}))}Qn(e,n,s){if(n.isEmpty())return v.resolve();let r=new Pe(LT);n.forEach(c=>r=r.add(c));const i=IDBKeyRange.bound(Bc(r.first()),Bc(r.last())),o=r.getIterator();let a=o.getNext();return Ri(e).J({index:"documentKeyIndex",range:i},(c,l,u)=>{const h=$.fromSegments([...l.prefixPath,l.collectionGroup,l.documentId]);for(;a&&LT(a,h)<0;)s(a,null),a=o.getNext();a&&a.isEqual(h)&&(s(a,l),a=o.hasNext()?o.getNext():null),a?u.q(Bc(a)):u.done()}).next(()=>{for(;a;)s(a,null),a=o.hasNext()?o.getNext():null})}getAllFromCollection(e,n,s){const r=[n.popLast().toArray(),n.lastSegment(),zd(s.readTime),s.documentKey.path.isEmpty()?"":s.documentKey.path.lastSegment()],i=[n.popLast().toArray(),n.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Ri(e).K(IDBKeyRange.bound(r,i,!0)).next(o=>{let a=bn();for(const c of o){const l=this.Kn($.fromSegments(c.prefixPath.concat(c.collectionGroup,c.documentId)),c);a=a.insert(l.key,l)}return a})}getAllFromCollectionGroup(e,n,s,r){let i=bn();const o=MT(n,s),a=MT(n,Fn.max());return Ri(e).J({index:"collectionGroupIndex",range:IDBKeyRange.bound(o,a,!0)},(c,l,u)=>{const h=this.Kn($.fromSegments(l.prefixPath.concat(l.collectionGroup,l.documentId)),l);i=i.insert(h.key,h),i.size===r&&u.done()}).next(()=>i)}newChangeBuffer(e){return new W4(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(n=>n.byteSize)}getMetadata(e){return OT(e).get("remoteDocumentGlobalKey").next(n=>(ae(!!n),n))}qn(e,n){return OT(e).put("remoteDocumentGlobalKey",n)}Kn(e,n){if(n){const s=P4(this.wt,n);if(!(s.isNoDocument()&&s.version.isEqual(oe.min())))return s}return je.newInvalidDocument(e)}}function xP(t){return new H4(t)}class W4 extends PP{constructor(e,n){super(),this.zn=e,this.trackRemovals=n,this.Hn=new bi(s=>s.toString(),(s,r)=>s.isEqual(r))}applyChanges(e){const n=[];let s=0,r=new Pe((i,o)=>ue(i.canonicalString(),o.canonicalString()));return this.changes.forEach((i,o)=>{const a=this.Hn.get(i);if(n.push(this.zn.removeEntry(e,i,a.readTime)),o.isValidDocument()){const c=IT(this.zn.wt,o);r=r.add(i.path.popLast()),s+=Qd(c)-a.size,n.push(this.zn.addEntry(e,i,c))}else if(s-=a.size,this.trackRemovals){const c=IT(this.zn.wt,o.convertToNoDocument(oe.min()));n.push(this.zn.addEntry(e,i,c))}}),r.forEach(i=>{n.push(this.zn.indexManager.addToCollectionParentIndex(e,i))}),n.push(this.zn.updateMetadata(e,s)),v.waitFor(n)}getFromCache(e,n){return this.zn.Gn(e,n).next(s=>(this.Hn.set(n,{size:s.size,readTime:s.document.readTime}),s.document))}getAllFromCache(e,n){return this.zn.jn(e,n).next(({documents:s,Wn:r})=>(r.forEach((i,o)=>{this.Hn.set(i,{size:o,readTime:s.get(i).readTime})}),s))}}function OT(t){return Lt(t,"remoteDocumentGlobal")}function Ri(t){return Lt(t,"remoteDocumentsV14")}function Bc(t){const e=t.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function MT(t,e){const n=e.documentKey.path.toArray();return[t,zd(e.readTime),n.slice(0,n.length-2),n.length>0?n[n.length-1]:""]}function LT(t,e){const n=t.path.toArray(),s=e.path.toArray();let r=0;for(let i=0;i<n.length-2&&i<s.length-2;++i)if(r=ue(n[i],s[i]),r)return r;return r=ue(n.length,s.length),r||(r=ue(n[n.length-2],s[s.length-2]),r||ue(n[n.length-1],s[s.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G4{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DP{constructor(e,n,s,r){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=s,this.indexManager=r}getDocument(e,n){let s=null;return this.documentOverlayCache.getOverlay(e,n).next(r=>(s=r,this.getBaseDocument(e,n,s))).next(r=>(s!==null&&ml(s.mutation,r,Dn.empty(),Ye.now()),r))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(s=>this.getLocalViewOfDocuments(e,s,he()).next(()=>s))}getLocalViewOfDocuments(e,n,s=he()){const r=Ps();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,s).next(i=>{let o=Yc();return i.forEach((a,c)=>{o=o.insert(a,c.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){const s=Ps();return this.populateOverlays(e,s,n).next(()=>this.computeViews(e,n,s,he()))}populateOverlays(e,n,s){const r=[];return s.forEach(i=>{n.has(i)||r.push(i)}),this.documentOverlayCache.getOverlays(e,r).next(i=>{i.forEach((o,a)=>{n.set(o,a)})})}computeViews(e,n,s,r){let i=bn();const o=_l(),a=_l();return n.forEach((c,l)=>{const u=s.get(l.key);r.has(l.key)&&(u===void 0||u.mutation instanceof Tr)?i=i.insert(l.key,l):u!==void 0&&(o.set(l.key,u.mutation.getFieldMask()),ml(u.mutation,l,u.mutation.getFieldMask(),Ye.now()))}),this.recalculateAndSaveOverlays(e,i).next(c=>(c.forEach((l,u)=>o.set(l,u)),n.forEach((l,u)=>{var h;return a.set(l,new G4(u,(h=o.get(l))!==null&&h!==void 0?h:null))}),a))}recalculateAndSaveOverlays(e,n){const s=_l();let r=new it((o,a)=>o-a),i=he();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(const a of o)a.keys().forEach(c=>{const l=n.get(c);if(l===null)return;let u=s.get(c)||Dn.empty();u=a.applyToLocalView(l,u),s.set(c,u);const h=(r.get(a.batchId)||he()).add(c);r=r.insert(a.batchId,h)})}).next(()=>{const o=[],a=r.getReverseIterator();for(;a.hasNext();){const c=a.getNext(),l=c.key,u=c.value,h=lP();u.forEach(d=>{if(!i.has(d)){const f=sP(n.get(d),s.get(d));f!==null&&h.set(d,f),i=i.add(d)}}),o.push(this.documentOverlayCache.saveOverlays(e,l,h))}return v.waitFor(o)}).next(()=>s)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(s=>this.recalculateAndSaveOverlays(e,s))}getDocumentsMatchingQuery(e,n,s){return function(r){return $.isDocumentKey(r.path)&&r.collectionGroup===null&&r.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):Jv(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,s):this.getDocumentsMatchingCollectionQuery(e,n,s)}getNextDocuments(e,n,s,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,s,r).next(i=>{const o=r-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,s.largestBatchId,r-i.size):v.resolve(Ps());let a=-1,c=i;return o.next(l=>v.forEach(l,(u,h)=>(a<h.largestBatchId&&(a=h.largestBatchId),i.get(u)?v.resolve():this.getBaseDocument(e,u,h).next(d=>{c=c.insert(u,d)}))).next(()=>this.populateOverlays(e,l,i)).next(()=>this.computeViews(e,c,l,he())).next(u=>({batchId:a,changes:cP(u)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new $(n)).next(s=>{let r=Yc();return s.isFoundDocument()&&(r=r.insert(s.key,s)),r})}getDocumentsMatchingCollectionGroupQuery(e,n,s){const r=n.collectionGroup;let i=Yc();return this.indexManager.getCollectionParents(e,r).next(o=>v.forEach(o,a=>{const c=function(l,u){return new Er(u,null,l.explicitOrderBy.slice(),l.filters.slice(),l.limit,l.limitType,l.startAt,l.endAt)}(n,a.child(r));return this.getDocumentsMatchingCollectionQuery(e,c,s).next(l=>{l.forEach((u,h)=>{i=i.insert(u,h)})})}).next(()=>i))}getDocumentsMatchingCollectionQuery(e,n,s){let r;return this.remoteDocumentCache.getAllFromCollection(e,n.path,s).next(i=>(r=i,this.documentOverlayCache.getOverlaysForCollection(e,n.path,s.largestBatchId))).next(i=>{i.forEach((a,c)=>{const l=c.getKey();r.get(l)===null&&(r=r.insert(l,je.newInvalidDocument(l)))});let o=Yc();return r.forEach((a,c)=>{const l=i.get(a);l!==void 0&&ml(l.mutation,c,Dn.empty(),Ye.now()),Xv(n,c)&&(o=o.insert(a,c))}),o})}getBaseDocument(e,n,s){return s===null||s.mutation.type===1?this.remoteDocumentCache.getEntry(e,n):v.resolve(je.newInvalidDocument(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z4{constructor(e){this.wt=e,this.Jn=new Map,this.Yn=new Map}getBundleMetadata(e,n){return v.resolve(this.Jn.get(n))}saveBundleMetadata(e,n){var s;return this.Jn.set(n.id,{id:(s=n).id,version:s.version,createTime:Rt(s.createTime)}),v.resolve()}getNamedQuery(e,n){return v.resolve(this.Yn.get(n))}saveNamedQuery(e,n){return this.Yn.set(n.name,function(s){return{name:s.name,query:rw(s.bundledQuery),readTime:Rt(s.readTime)}}(n)),v.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q4{constructor(){this.overlays=new it($.comparator),this.Xn=new Map}getOverlay(e,n){return v.resolve(this.overlays.get(n))}getOverlays(e,n){const s=Ps();return v.forEach(n,r=>this.getOverlay(e,r).next(i=>{i!==null&&s.set(r,i)})).next(()=>s)}saveOverlays(e,n,s){return s.forEach((r,i)=>{this.ie(e,n,i)}),v.resolve()}removeOverlaysForBatchId(e,n,s){const r=this.Xn.get(s);return r!==void 0&&(r.forEach(i=>this.overlays=this.overlays.remove(i)),this.Xn.delete(s)),v.resolve()}getOverlaysForCollection(e,n,s){const r=Ps(),i=n.length+1,o=new $(n.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const c=a.getNext().value,l=c.getKey();if(!n.isPrefixOf(l.path))break;l.path.length===i&&c.largestBatchId>s&&r.set(c.getKey(),c)}return v.resolve(r)}getOverlaysForCollectionGroup(e,n,s,r){let i=new it((l,u)=>l-u);const o=this.overlays.getIterator();for(;o.hasNext();){const l=o.getNext().value;if(l.getKey().getCollectionGroup()===n&&l.largestBatchId>s){let u=i.get(l.largestBatchId);u===null&&(u=Ps(),i=i.insert(l.largestBatchId,u)),u.set(l.getKey(),l)}}const a=Ps(),c=i.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((l,u)=>a.set(l,u)),!(a.size()>=r)););return v.resolve(a)}ie(e,n,s){const r=this.overlays.get(s.key);if(r!==null){const o=this.Xn.get(r.largestBatchId).delete(s.key);this.Xn.set(r.largestBatchId,o)}this.overlays=this.overlays.insert(s.key,new sw(n,s));let i=this.Xn.get(n);i===void 0&&(i=he(),this.Xn.set(n,i)),this.Xn.set(n,i.add(s.key))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ow{constructor(){this.Zn=new Pe(bt.ts),this.es=new Pe(bt.ns)}isEmpty(){return this.Zn.isEmpty()}addReference(e,n){const s=new bt(e,n);this.Zn=this.Zn.add(s),this.es=this.es.add(s)}ss(e,n){e.forEach(s=>this.addReference(s,n))}removeReference(e,n){this.rs(new bt(e,n))}os(e,n){e.forEach(s=>this.removeReference(s,n))}us(e){const n=new $(new Te([])),s=new bt(n,e),r=new bt(n,e+1),i=[];return this.es.forEachInRange([s,r],o=>{this.rs(o),i.push(o.key)}),i}cs(){this.Zn.forEach(e=>this.rs(e))}rs(e){this.Zn=this.Zn.delete(e),this.es=this.es.delete(e)}hs(e){const n=new $(new Te([])),s=new bt(n,e),r=new bt(n,e+1);let i=he();return this.es.forEachInRange([s,r],o=>{i=i.add(o.key)}),i}containsKey(e){const n=new bt(e,0),s=this.Zn.firstAfterOrEqual(n);return s!==null&&e.isEqual(s.key)}}class bt{constructor(e,n){this.key=e,this.ls=n}static ts(e,n){return $.comparator(e.key,n.key)||ue(e.ls,n.ls)}static ns(e,n){return ue(e.ls,n.ls)||$.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y4{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.fs=1,this.ds=new Pe(bt.ts)}checkEmpty(e){return v.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,s,r){const i=this.fs;this.fs++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new tw(i,n,s,r);this.mutationQueue.push(o);for(const a of r)this.ds=this.ds.add(new bt(a.key,i)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return v.resolve(o)}lookupMutationBatch(e,n){return v.resolve(this._s(n))}getNextMutationBatchAfterBatchId(e,n){const s=n+1,r=this.ws(s),i=r<0?0:r;return v.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return v.resolve(this.mutationQueue.length===0?-1:this.fs-1)}getAllMutationBatches(e){return v.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const s=new bt(n,0),r=new bt(n,Number.POSITIVE_INFINITY),i=[];return this.ds.forEachInRange([s,r],o=>{const a=this._s(o.ls);i.push(a)}),v.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,n){let s=new Pe(ue);return n.forEach(r=>{const i=new bt(r,0),o=new bt(r,Number.POSITIVE_INFINITY);this.ds.forEachInRange([i,o],a=>{s=s.add(a.ls)})}),v.resolve(this.gs(s))}getAllMutationBatchesAffectingQuery(e,n){const s=n.path,r=s.length+1;let i=s;$.isDocumentKey(i)||(i=i.child(""));const o=new bt(new $(i),0);let a=new Pe(ue);return this.ds.forEachWhile(c=>{const l=c.key.path;return!!s.isPrefixOf(l)&&(l.length===r&&(a=a.add(c.ls)),!0)},o),v.resolve(this.gs(a))}gs(e){const n=[];return e.forEach(s=>{const r=this._s(s);r!==null&&n.push(r)}),n}removeMutationBatch(e,n){ae(this.ys(n.batchId,"removed")===0),this.mutationQueue.shift();let s=this.ds;return v.forEach(n.mutations,r=>{const i=new bt(r.key,n.batchId);return s=s.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)}).next(()=>{this.ds=s})}In(e){}containsKey(e,n){const s=new bt(n,0),r=this.ds.firstAfterOrEqual(s);return v.resolve(n.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,v.resolve()}ys(e,n){return this.ws(e)}ws(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}_s(e){const n=this.ws(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J4{constructor(e){this.ps=e,this.docs=new it($.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const s=n.key,r=this.docs.get(s),i=r?r.size:0,o=this.ps(n);return this.docs=this.docs.insert(s,{document:n.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(e,s.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const s=this.docs.get(n);return v.resolve(s?s.document.mutableCopy():je.newInvalidDocument(n))}getEntries(e,n){let s=bn();return n.forEach(r=>{const i=this.docs.get(r);s=s.insert(r,i?i.document.mutableCopy():je.newInvalidDocument(r))}),v.resolve(s)}getAllFromCollection(e,n,s){let r=bn();const i=new $(n.child("")),o=this.docs.getIteratorFrom(i);for(;o.hasNext();){const{key:a,value:{document:c}}=o.getNext();if(!n.isPrefixOf(a.path))break;a.path.length>n.length+1||Wv(FN(c),s)<=0||(r=r.insert(c.key,c.mutableCopy()))}return v.resolve(r)}getAllFromCollectionGroup(e,n,s,r){Q()}Is(e,n){return v.forEach(this.docs,s=>n(s))}newChangeBuffer(e){return new X4(this)}getSize(e){return v.resolve(this.size)}}class X4 extends PP{constructor(e){super(),this.zn=e}applyChanges(e){const n=[];return this.changes.forEach((s,r)=>{r.isValidDocument()?n.push(this.zn.addEntry(e,r)):this.zn.removeEntry(s)}),v.waitFor(n)}getFromCache(e,n){return this.zn.getEntry(e,n)}getAllFromCache(e,n){return this.zn.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z4{constructor(e){this.persistence=e,this.Ts=new bi(n=>To(n),Qu),this.lastRemoteSnapshotVersion=oe.min(),this.highestTargetId=0,this.Es=0,this.As=new ow,this.targetCount=0,this.Rs=Ro.An()}forEachTarget(e,n){return this.Ts.forEach((s,r)=>n(r)),v.resolve()}getLastRemoteSnapshotVersion(e){return v.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return v.resolve(this.Es)}allocateTargetId(e){return this.highestTargetId=this.Rs.next(),v.resolve(this.highestTargetId)}setTargetsMetadata(e,n,s){return s&&(this.lastRemoteSnapshotVersion=s),n>this.Es&&(this.Es=n),v.resolve()}vn(e){this.Ts.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.Rs=new Ro(n),this.highestTargetId=n),e.sequenceNumber>this.Es&&(this.Es=e.sequenceNumber)}addTargetData(e,n){return this.vn(n),this.targetCount+=1,v.resolve()}updateTargetData(e,n){return this.vn(n),v.resolve()}removeTargetData(e,n){return this.Ts.delete(n.target),this.As.us(n.targetId),this.targetCount-=1,v.resolve()}removeTargets(e,n,s){let r=0;const i=[];return this.Ts.forEach((o,a)=>{a.sequenceNumber<=n&&s.get(a.targetId)===null&&(this.Ts.delete(o),i.push(this.removeMatchingKeysForTargetId(e,a.targetId)),r++)}),v.waitFor(i).next(()=>r)}getTargetCount(e){return v.resolve(this.targetCount)}getTargetData(e,n){const s=this.Ts.get(n)||null;return v.resolve(s)}addMatchingKeys(e,n,s){return this.As.ss(n,s),v.resolve()}removeMatchingKeys(e,n,s){this.As.os(n,s);const r=this.persistence.referenceDelegate,i=[];return r&&n.forEach(o=>{i.push(r.markPotentiallyOrphaned(e,o))}),v.waitFor(i)}removeMatchingKeysForTargetId(e,n){return this.As.us(n),v.resolve()}getMatchingKeysForTargetId(e,n){const s=this.As.hs(n);return v.resolve(s)}containsKey(e,n){return v.resolve(this.As.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OP{constructor(e,n){this.bs={},this.overlays={},this.Ps=new wn(0),this.vs=!1,this.vs=!0,this.referenceDelegate=e(this),this.Vs=new Z4(this),this.indexManager=new U4,this.remoteDocumentCache=function(s){return new J4(s)}(s=>this.referenceDelegate.Ss(s)),this.wt=new CP(n),this.Ds=new z4(this.wt)}start(){return Promise.resolve()}shutdown(){return this.vs=!1,Promise.resolve()}get started(){return this.vs}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new Q4,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let s=this.bs[e.toKey()];return s||(s=new Y4(n,this.referenceDelegate),this.bs[e.toKey()]=s),s}getTargetCache(){return this.Vs}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ds}runTransaction(e,n,s){P("MemoryPersistence","Starting transaction:",e);const r=new eQ(this.Ps.next());return this.referenceDelegate.Cs(),s(r).next(i=>this.referenceDelegate.xs(r).next(()=>i)).toPromise().then(i=>(r.raiseOnCommittedEvent(),i))}Ns(e,n){return v.or(Object.values(this.bs).map(s=>()=>s.containsKey(e,n)))}}class eQ extends $N{constructor(e){super(),this.currentSequenceNumber=e}}class Np{constructor(e){this.persistence=e,this.ks=new ow,this.Ms=null}static Os(e){return new Np(e)}get Fs(){if(this.Ms)return this.Ms;throw Q()}addReference(e,n,s){return this.ks.addReference(s,n),this.Fs.delete(s.toString()),v.resolve()}removeReference(e,n,s){return this.ks.removeReference(s,n),this.Fs.add(s.toString()),v.resolve()}markPotentiallyOrphaned(e,n){return this.Fs.add(n.toString()),v.resolve()}removeTarget(e,n){this.ks.us(n.targetId).forEach(r=>this.Fs.add(r.toString()));const s=this.persistence.getTargetCache();return s.getMatchingKeysForTargetId(e,n.targetId).next(r=>{r.forEach(i=>this.Fs.add(i.toString()))}).next(()=>s.removeTargetData(e,n))}Cs(){this.Ms=new Set}xs(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return v.forEach(this.Fs,s=>{const r=$.fromPath(s);return this.$s(e,r).next(i=>{i||n.removeEntry(r,oe.min())})}).next(()=>(this.Ms=null,n.apply(e)))}updateLimboDocument(e,n){return this.$s(e,n).next(s=>{s?this.Fs.delete(n.toString()):this.Fs.add(n.toString())})}Ss(e){return 0}$s(e,n){return v.or([()=>v.resolve(this.ks.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Ns(e,n)])}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tQ{constructor(e){this.wt=e}M(e,n,s,r){const i=new Tp("createOrUpgrade",n);s<1&&r>=1&&(function(a){a.createObjectStore("owner")}(e),function(a){a.createObjectStore("mutationQueues",{keyPath:"userId"}),a.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",bT,{unique:!0}),a.createObjectStore("documentMutations")}(e),FT(e),function(a){a.createObjectStore("remoteDocuments")}(e));let o=v.resolve();return s<3&&r>=3&&(s!==0&&(function(a){a.deleteObjectStore("targetDocuments"),a.deleteObjectStore("targets"),a.deleteObjectStore("targetGlobal")}(e),FT(e)),o=o.next(()=>function(a){const c=a.store("targetGlobal"),l={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:oe.min().toTimestamp(),targetCount:0};return c.put("targetGlobalKey",l)}(i))),s<4&&r>=4&&(s!==0&&(o=o.next(()=>function(a,c){return c.store("mutations").K().next(l=>{a.deleteObjectStore("mutations"),a.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",bT,{unique:!0});const u=c.store("mutations"),h=l.map(d=>u.put(d));return v.waitFor(h)})}(e,i))),o=o.next(()=>{(function(a){a.createObjectStore("clientMetadata",{keyPath:"clientId"})})(e)})),s<5&&r>=5&&(o=o.next(()=>this.Bs(i))),s<6&&r>=6&&(o=o.next(()=>(function(a){a.createObjectStore("remoteDocumentGlobal")}(e),this.Ls(i)))),s<7&&r>=7&&(o=o.next(()=>this.Us(i))),s<8&&r>=8&&(o=o.next(()=>this.qs(e,i))),s<9&&r>=9&&(o=o.next(()=>{(function(a){a.objectStoreNames.contains("remoteDocumentChanges")&&a.deleteObjectStore("remoteDocumentChanges")})(e)})),s<10&&r>=10&&(o=o.next(()=>this.Ks(i))),s<11&&r>=11&&(o=o.next(()=>{(function(a){a.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(a){a.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),s<12&&r>=12&&(o=o.next(()=>{(function(a){const c=a.createObjectStore("documentOverlays",{keyPath:C4});c.createIndex("collectionPathOverlayIndex",A4,{unique:!1}),c.createIndex("collectionGroupOverlayIndex",k4,{unique:!1})})(e)})),s<13&&r>=13&&(o=o.next(()=>function(a){const c=a.createObjectStore("remoteDocumentsV14",{keyPath:g4});c.createIndex("documentKeyIndex",m4),c.createIndex("collectionGroupIndex",_4)}(e)).next(()=>this.Gs(e,i)).next(()=>e.deleteObjectStore("remoteDocuments"))),s<14&&r>=14&&(o=o.next(()=>this.Qs(e,i))),s<15&&r>=15&&(o=o.next(()=>function(a){a.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),a.createObjectStore("indexState",{keyPath:I4}).createIndex("sequenceNumberIndex",E4,{unique:!1}),a.createObjectStore("indexEntries",{keyPath:T4}).createIndex("documentKeyIndex",S4,{unique:!1})}(e))),o}Ls(e){let n=0;return e.store("remoteDocuments").J((s,r)=>{n+=Qd(r)}).next(()=>{const s={byteSize:n};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",s)})}Bs(e){const n=e.store("mutationQueues"),s=e.store("mutations");return n.K().next(r=>v.forEach(r,i=>{const o=IDBKeyRange.bound([i.userId,-1],[i.userId,i.lastAcknowledgedBatchId]);return s.K("userMutationsIndex",o).next(a=>v.forEach(a,c=>{ae(c.userId===i.userId);const l=$i(this.wt,c);return kP(e,i.userId,l).next(()=>{})}))}))}Us(e){const n=e.store("targetDocuments"),s=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(r=>{const i=[];return s.J((o,a)=>{const c=new Te(o),l=function(u){return[0,fn(u)]}(c);i.push(n.get(l).next(u=>u?v.resolve():(h=>n.put({targetId:0,path:fn(h),sequenceNumber:r.highestListenSequenceNumber}))(c)))}).next(()=>v.waitFor(i))})}qs(e,n){e.createObjectStore("collectionParents",{keyPath:b4});const s=n.store("collectionParents"),r=new iw,i=o=>{if(r.add(o)){const a=o.lastSegment(),c=o.popLast();return s.put({collectionId:a,parent:fn(c)})}};return n.store("remoteDocuments").J({H:!0},(o,a)=>{const c=new Te(o);return i(c.popLast())}).next(()=>n.store("documentMutations").J({H:!0},([o,a,c],l)=>{const u=xs(a);return i(u.popLast())}))}Ks(e){const n=e.store("targets");return n.J((s,r)=>{const i=Jc(r),o=AP(this.wt,i);return n.put(o)})}Gs(e,n){const s=n.store("remoteDocuments"),r=[];return s.J((i,o)=>{const a=n.store("remoteDocumentsV14"),c=(l=o,l.document?new $(Te.fromString(l.document.name).popFirst(5)):l.noDocument?$.fromSegments(l.noDocument.path):l.unknownDocument?$.fromSegments(l.unknownDocument.path):Q()).path.toArray();var l;/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const u={prefixPath:c.slice(0,c.length-2),collectionGroup:c[c.length-2],documentId:c[c.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};r.push(a.put(u))}).next(()=>v.waitFor(r))}Qs(e,n){const s=n.store("mutations"),r=xP(this.wt),i=new OP(Np.Os,this.wt.ne);return s.K().next(o=>{const a=new Map;return o.forEach(c=>{var l;let u=(l=a.get(c.userId))!==null&&l!==void 0?l:he();$i(this.wt,c).keys().forEach(h=>u=u.add(h)),a.set(c.userId,u)}),v.forEach(a,(c,l)=>{const u=new Tt(l),h=kp.se(this.wt,u),d=i.getIndexManager(u),f=Rp.se(u,this.wt,d,i.referenceDelegate);return new DP(r,f,h,d).recalculateAndSaveOverlaysForDocumentKeys(new y_(n,wn.ot),c).next()})})}}function FT(t){t.createObjectStore("targetDocuments",{keyPath:v4}).createIndex("documentTargetsIndex",w4,{unique:!0}),t.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",y4,{unique:!0}),t.createObjectStore("targetGlobal")}const Dg="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class aw{constructor(e,n,s,r,i,o,a,c,l,u,h=15){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=s,this.js=i,this.window=o,this.document=a,this.Ws=l,this.zs=u,this.Hs=h,this.Ps=null,this.vs=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Js=null,this.inForeground=!1,this.Ys=null,this.Xs=null,this.Zs=Number.NEGATIVE_INFINITY,this.ti=d=>Promise.resolve(),!aw.V())throw new k(w.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new K4(this,r),this.ei=n+"main",this.wt=new CP(c),this.ni=new hs(this.ei,this.Hs,new tQ(this.wt)),this.Vs=new V4(this.referenceDelegate,this.wt),this.remoteDocumentCache=xP(this.wt),this.Ds=new x4,this.window&&this.window.localStorage?this.si=this.window.localStorage:(this.si=null,u===!1&&ct("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.ii().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new k(w.FAILED_PRECONDITION,Dg);return this.ri(),this.oi(),this.ui(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Vs.getHighestSequenceNumber(e))}).then(e=>{this.Ps=new wn(e,this.Ws)}).then(()=>{this.vs=!0}).catch(e=>(this.ni&&this.ni.close(),Promise.reject(e)))}ci(e){return this.ti=async n=>{if(this.started)return e(n)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.ni.F(async n=>{n.newVersion===null&&await e()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.js.enqueueAndForget(async()=>{this.started&&await this.ii()}))}ii(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>Sh(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.ai(e).next(n=>{n||(this.isPrimary=!1,this.js.enqueueRetryable(()=>this.ti(!1)))})}).next(()=>this.hi(e)).next(n=>this.isPrimary&&!n?this.li(e).next(()=>!1):!!n&&this.fi(e).next(()=>!0))).catch(e=>{if(wi(e))return P("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return P("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.js.enqueueRetryable(()=>this.ti(e)),this.isPrimary=e})}ai(e){return jc(e).get("owner").next(n=>v.resolve(this.di(n)))}_i(e){return Sh(e).delete(this.clientId)}async wi(){if(this.isPrimary&&!this.mi(this.Zs,18e5)){this.Zs=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",n=>{const s=Lt(n,"clientMetadata");return s.K().next(r=>{const i=this.gi(r,18e5),o=r.filter(a=>i.indexOf(a)===-1);return v.forEach(o,a=>s.delete(a.clientId)).next(()=>o)})}).catch(()=>[]);if(this.si)for(const n of e)this.si.removeItem(this.yi(n.clientId))}}ui(){this.Xs=this.js.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.ii().then(()=>this.wi()).then(()=>this.ui()))}di(e){return!!e&&e.ownerId===this.clientId}hi(e){return this.zs?v.resolve(!0):jc(e).get("owner").next(n=>{if(n!==null&&this.mi(n.leaseTimestampMs,5e3)&&!this.pi(n.ownerId)){if(this.di(n)&&this.networkEnabled)return!0;if(!this.di(n)){if(!n.allowTabSynchronization)throw new k(w.FAILED_PRECONDITION,Dg);return!1}}return!(!this.networkEnabled||!this.inForeground)||Sh(e).K().next(s=>this.gi(s,5e3).find(r=>{if(this.clientId!==r.clientId){const i=!this.networkEnabled&&r.networkEnabled,o=!this.inForeground&&r.inForeground,a=this.networkEnabled===r.networkEnabled;if(i||o&&a)return!0}return!1})===void 0)}).next(n=>(this.isPrimary!==n&&P("IndexedDbPersistence",`Client ${n?"is":"is not"} eligible for a primary lease.`),n))}async shutdown(){this.vs=!1,this.Ii(),this.Xs&&(this.Xs.cancel(),this.Xs=null),this.Ti(),this.Ei(),await this.ni.runTransaction("shutdown","readwrite",["owner","clientMetadata"],e=>{const n=new y_(e,wn.ot);return this.li(n).next(()=>this._i(n))}),this.ni.close(),this.Ai()}gi(e,n){return e.filter(s=>this.mi(s.updateTimeMs,n)&&!this.pi(s.clientId))}Ri(){return this.runTransaction("getActiveClients","readonly",e=>Sh(e).K().next(n=>this.gi(n,18e5).map(s=>s.clientId)))}get started(){return this.vs}getMutationQueue(e,n){return Rp.se(e,this.wt,n,this.referenceDelegate)}getTargetCache(){return this.Vs}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new $4(e,this.wt.ne.databaseId)}getDocumentOverlayCache(e){return kp.se(this.wt,e)}getBundleCache(){return this.Ds}runTransaction(e,n,s){P("IndexedDbPersistence","Starting transaction:",e);const r=n==="readonly"?"readonly":"readwrite",i=(o=this.Hs)===15?N4:o===14?SP:o===13?TP:o===12?R4:o===11?EP:void Q();var o;let a;return this.ni.runTransaction(e,r,i,c=>(a=new y_(c,this.Ps?this.Ps.next():wn.ot),n==="readwrite-primary"?this.ai(a).next(l=>!!l||this.hi(a)).next(l=>{if(!l)throw ct(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.js.enqueueRetryable(()=>this.ti(!1)),new k(w.FAILED_PRECONDITION,UN);return s(a)}).next(l=>this.fi(a).next(()=>l)):this.bi(a).next(()=>s(a)))).then(c=>(a.raiseOnCommittedEvent(),c))}bi(e){return jc(e).get("owner").next(n=>{if(n!==null&&this.mi(n.leaseTimestampMs,5e3)&&!this.pi(n.ownerId)&&!this.di(n)&&!(this.zs||this.allowTabSynchronization&&n.allowTabSynchronization))throw new k(w.FAILED_PRECONDITION,Dg)})}fi(e){const n={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return jc(e).put("owner",n)}static V(){return hs.V()}li(e){const n=jc(e);return n.get("owner").next(s=>this.di(s)?(P("IndexedDbPersistence","Releasing primary lease."),n.delete("owner")):v.resolve())}mi(e,n){const s=Date.now();return!(e<s-n)&&(!(e>s)||(ct(`Detected an update time that is in the future: ${e} > ${s}`),!1))}ri(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Ys=()=>{this.js.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.ii()))},this.document.addEventListener("visibilitychange",this.Ys),this.inForeground=this.document.visibilityState==="visible")}Ti(){this.Ys&&(this.document.removeEventListener("visibilitychange",this.Ys),this.Ys=null)}oi(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.Js=()=>{this.Ii(),vF()&&navigator.appVersion.match(/Version\/1[45]/)&&this.js.enterRestrictedMode(!0),this.js.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Js))}Ei(){this.Js&&(this.window.removeEventListener("pagehide",this.Js),this.Js=null)}pi(e){var n;try{const s=((n=this.si)===null||n===void 0?void 0:n.getItem(this.yi(e)))!==null;return P("IndexedDbPersistence",`Client '${e}' ${s?"is":"is not"} zombied in LocalStorage`),s}catch(s){return ct("IndexedDbPersistence","Failed to get zombied client id.",s),!1}}Ii(){if(this.si)try{this.si.setItem(this.yi(this.clientId),String(Date.now()))}catch(e){ct("Failed to set zombie client id.",e)}}Ai(){if(this.si)try{this.si.removeItem(this.yi(this.clientId))}catch{}}yi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function jc(t){return Lt(t,"owner")}function Sh(t){return Lt(t,"clientMetadata")}function cw(t,e){let n=t.projectId;return t.isDefaultDatabase||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lw{constructor(e,n,s,r){this.targetId=e,this.fromCache=n,this.Pi=s,this.vi=r}static Vi(e,n){let s=he(),r=he();for(const i of n.docChanges)switch(i.type){case 0:s=s.add(i.doc.key);break;case 1:r=r.add(i.doc.key)}return new lw(e,n.fromCache,s,r)}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MP{constructor(){this.Si=!1}initialize(e,n){this.Di=e,this.indexManager=n,this.Si=!0}getDocumentsMatchingQuery(e,n,s,r){return this.Ci(e,n).next(i=>i||this.xi(e,n,r,s)).next(i=>i||this.Ni(e,n))}Ci(e,n){if(hT(n))return v.resolve(null);let s=Tn(n);return this.indexManager.getIndexType(e,s).next(r=>r===0?null:(n.limit!==null&&r===1&&(n=Gd(n,null,"F"),s=Tn(n)),this.indexManager.getDocumentsMatchingTarget(e,s).next(i=>{const o=he(...i);return this.Di.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,s).next(c=>{const l=this.ki(n,a);return this.Mi(n,l,o,c.readTime)?this.Ci(e,Gd(n,null,"F")):this.Oi(e,l,n,c)}))})))}xi(e,n,s,r){return hT(n)||r.isEqual(oe.min())?this.Ni(e,n):this.Di.getDocuments(e,s).next(i=>{const o=this.ki(n,i);return this.Mi(n,o,s,r)?this.Ni(e,n):(h_()<=ge.DEBUG&&P("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),g_(n)),this.Oi(e,o,n,LN(r,-1)))})}ki(e,n){let s=new Pe(QN(e));return n.forEach((r,i)=>{Xv(e,i)&&(s=s.add(i))}),s}Mi(e,n,s,r){if(e.limit===null)return!1;if(s.size!==n.size)return!0;const i=e.limitType==="F"?n.last():n.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)}Ni(e,n){return h_()<=ge.DEBUG&&P("QueryEngine","Using full collection scan to execute query:",g_(n)),this.Di.getDocumentsMatchingQuery(e,n,Fn.min())}Oi(e,n,s,r){return this.Di.getDocumentsMatchingQuery(e,s,r).next(i=>(n.forEach(o=>{i=i.insert(o.key,o)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nQ{constructor(e,n,s,r){this.persistence=e,this.Fi=n,this.wt=r,this.$i=new it(ue),this.Bi=new bi(i=>To(i),Qu),this.Li=new Map,this.Ui=e.getRemoteDocumentCache(),this.Vs=e.getTargetCache(),this.Ds=e.getBundleCache(),this.qi(s)}qi(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new DP(this.Ui,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ui.setIndexManager(this.indexManager),this.Fi.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.$i))}}function LP(t,e,n,s){return new nQ(t,e,n,s)}async function FP(t,e){const n=q(t);return await n.persistence.runTransaction("Handle user change","readonly",s=>{let r;return n.mutationQueue.getAllMutationBatches(s).next(i=>(r=i,n.qi(e),n.mutationQueue.getAllMutationBatches(s))).next(i=>{const o=[],a=[];let c=he();for(const l of r){o.push(l.batchId);for(const u of l.mutations)c=c.add(u.key)}for(const l of i){a.push(l.batchId);for(const u of l.mutations)c=c.add(u.key)}return n.localDocuments.getDocuments(s,c).next(l=>({Ki:l,removedBatchIds:o,addedBatchIds:a}))})})}function sQ(t,e){const n=q(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",s=>{const r=e.batch.keys(),i=n.Ui.newChangeBuffer({trackRemovals:!0});return function(o,a,c,l){const u=c.batch,h=u.keys();let d=v.resolve();return h.forEach(f=>{d=d.next(()=>l.getEntry(a,f)).next(p=>{const _=c.docVersions.get(f);ae(_!==null),p.version.compareTo(_)<0&&(u.applyToRemoteDocument(p,c),p.isValidDocument()&&(p.setReadTime(c.commitVersion),l.addEntry(p)))})}),d.next(()=>o.mutationQueue.removeMutationBatch(a,u))}(n,s,e,i).next(()=>i.apply(s)).next(()=>n.mutationQueue.performConsistencyCheck(s)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(s,r,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(s,function(o){let a=he();for(let c=0;c<o.mutationResults.length;++c)o.mutationResults[c].transformResults.length>0&&(a=a.add(o.batch.mutations[c].key));return a}(e))).next(()=>n.localDocuments.getDocuments(s,r))})}function UP(t){const e=q(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Vs.getLastRemoteSnapshotVersion(n))}function rQ(t,e){const n=q(t),s=e.snapshotVersion;let r=n.$i;return n.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const o=n.Ui.newChangeBuffer({trackRemovals:!0});r=n.$i;const a=[];e.targetChanges.forEach((u,h)=>{const d=r.get(h);if(!d)return;a.push(n.Vs.removeMatchingKeys(i,u.removedDocuments,h).next(()=>n.Vs.addMatchingKeys(i,u.addedDocuments,h)));let f=d.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.has(h)?f=f.withResumeToken(_t.EMPTY_BYTE_STRING,oe.min()).withLastLimboFreeSnapshotVersion(oe.min()):u.resumeToken.approximateByteSize()>0&&(f=f.withResumeToken(u.resumeToken,s)),r=r.insert(h,f),function(p,_,y){return p.resumeToken.approximateByteSize()===0||_.snapshotVersion.toMicroseconds()-p.snapshotVersion.toMicroseconds()>=3e8?!0:y.addedDocuments.size+y.modifiedDocuments.size+y.removedDocuments.size>0}(d,f,u)&&a.push(n.Vs.updateTargetData(i,f))});let c=bn(),l=he();if(e.documentUpdates.forEach(u=>{e.resolvedLimboDocuments.has(u)&&a.push(n.persistence.referenceDelegate.updateLimboDocument(i,u))}),a.push($P(i,o,e.documentUpdates).next(u=>{c=u.Gi,l=u.Qi})),!s.isEqual(oe.min())){const u=n.Vs.getLastRemoteSnapshotVersion(i).next(h=>n.Vs.setTargetsMetadata(i,i.currentSequenceNumber,s));a.push(u)}return v.waitFor(a).next(()=>o.apply(i)).next(()=>n.localDocuments.getLocalViewOfDocuments(i,c,l)).next(()=>c)}).then(i=>(n.$i=r,i))}function $P(t,e,n){let s=he(),r=he();return n.forEach(i=>s=s.add(i)),e.getEntries(t,s).next(i=>{let o=bn();return n.forEach((a,c)=>{const l=i.get(a);c.isFoundDocument()!==l.isFoundDocument()&&(r=r.add(a)),c.isNoDocument()&&c.version.isEqual(oe.min())?(e.removeEntry(a,c.readTime),o=o.insert(a,c)):!l.isValidDocument()||c.version.compareTo(l.version)>0||c.version.compareTo(l.version)===0&&l.hasPendingWrites?(e.addEntry(c),o=o.insert(a,c)):P("LocalStore","Ignoring outdated watch update for ",a,". Current version:",l.version," Watch version:",c.version)}),{Gi:o,Qi:r}})}function iQ(t,e){const n=q(t);return n.persistence.runTransaction("Get next mutation batch","readonly",s=>(e===void 0&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(s,e)))}function Qa(t,e){const n=q(t);return n.persistence.runTransaction("Allocate target","readwrite",s=>{let r;return n.Vs.getTargetData(s,e).next(i=>i?(r=i,v.resolve(r)):n.Vs.allocateTargetId(s).next(o=>(r=new Xr(e,o,0,s.currentSequenceNumber),n.Vs.addTargetData(s,r).next(()=>r))))}).then(s=>{const r=n.$i.get(s.targetId);return(r===null||s.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.$i=n.$i.insert(s.targetId,s),n.Bi.set(e,s.targetId)),s})}async function Ya(t,e,n){const s=q(t),r=s.$i.get(e),i=n?"readwrite":"readwrite-primary";try{n||await s.persistence.runTransaction("Release target",i,o=>s.persistence.referenceDelegate.removeTarget(o,r))}catch(o){if(!wi(o))throw o;P("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}s.$i=s.$i.remove(e),s.Bi.delete(r.target)}function Yd(t,e,n){const s=q(t);let r=oe.min(),i=he();return s.persistence.runTransaction("Execute query","readonly",o=>function(a,c,l){const u=q(a),h=u.Bi.get(l);return h!==void 0?v.resolve(u.$i.get(h)):u.Vs.getTargetData(c,l)}(s,o,Tn(e)).next(a=>{if(a)return r=a.lastLimboFreeSnapshotVersion,s.Vs.getMatchingKeysForTargetId(o,a.targetId).next(c=>{i=c})}).next(()=>s.Fi.getDocumentsMatchingQuery(o,e,n?r:oe.min(),n?i:he())).next(a=>(jP(s,zN(e),a),{documents:a,ji:i})))}function VP(t,e){const n=q(t),s=q(n.Vs),r=n.$i.get(e);return r?Promise.resolve(r.target):n.persistence.runTransaction("Get target data","readonly",i=>s.te(i,e).next(o=>o?o.target:null))}function BP(t,e){const n=q(t),s=n.Li.get(e)||oe.min();return n.persistence.runTransaction("Get new document changes","readonly",r=>n.Ui.getAllFromCollectionGroup(r,e,LN(s,-1),Number.MAX_SAFE_INTEGER)).then(r=>(jP(n,e,r),r))}function jP(t,e,n){let s=oe.min();n.forEach((r,i)=>{i.readTime.compareTo(s)>0&&(s=i.readTime)}),t.Li.set(e,s)}async function oQ(t,e,n,s){const r=q(t);let i=he(),o=bn();for(const l of n){const u=e.Wi(l.metadata.name);l.document&&(i=i.add(u));const h=e.zi(l);h.setReadTime(e.Hi(l.metadata.readTime)),o=o.insert(u,h)}const a=r.Ui.newChangeBuffer({trackRemovals:!0}),c=await Qa(r,function(l){return Tn(yc(Te.fromString(`__bundle__/docs/${l}`)))}(s));return r.persistence.runTransaction("Apply bundle documents","readwrite",l=>$P(l,a,o).next(u=>(a.apply(l),u)).next(u=>r.Vs.removeMatchingKeysForTargetId(l,c.targetId).next(()=>r.Vs.addMatchingKeys(l,i,c.targetId)).next(()=>r.localDocuments.getLocalViewOfDocuments(l,u.Gi,u.Qi)).next(()=>u.Gi)))}async function aQ(t,e,n=he()){const s=await Qa(t,Tn(rw(e.bundledQuery))),r=q(t);return r.persistence.runTransaction("Save named query","readwrite",i=>{const o=Rt(e.readTime);if(s.snapshotVersion.compareTo(o)>=0)return r.Ds.saveNamedQuery(i,e);const a=s.withResumeToken(_t.EMPTY_BYTE_STRING,o);return r.$i=r.$i.insert(a.targetId,a),r.Vs.updateTargetData(i,a).next(()=>r.Vs.removeMatchingKeysForTargetId(i,s.targetId)).next(()=>r.Vs.addMatchingKeys(i,n,s.targetId)).next(()=>r.Ds.saveNamedQuery(i,e))})}function UT(t,e){return`firestore_clients_${t}_${e}`}function $T(t,e,n){let s=`firestore_mutations_${t}_${n}`;return e.isAuthenticated()&&(s+=`_${e.uid}`),s}function Og(t,e){return`firestore_targets_${t}_${e}`}class Jd{constructor(e,n,s,r){this.user=e,this.batchId=n,this.state=s,this.error=r}static Ji(e,n,s){const r=JSON.parse(s);let i,o=typeof r=="object"&&["pending","acknowledged","rejected"].indexOf(r.state)!==-1&&(r.error===void 0||typeof r.error=="object");return o&&r.error&&(o=typeof r.error.message=="string"&&typeof r.error.code=="string",o&&(i=new k(r.error.code,r.error.message))),o?new Jd(e,n,r.state,i):(ct("SharedClientState",`Failed to parse mutation state for ID '${n}': ${s}`),null)}Yi(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class yl{constructor(e,n,s){this.targetId=e,this.state=n,this.error=s}static Ji(e,n){const s=JSON.parse(n);let r,i=typeof s=="object"&&["not-current","current","rejected"].indexOf(s.state)!==-1&&(s.error===void 0||typeof s.error=="object");return i&&s.error&&(i=typeof s.error.message=="string"&&typeof s.error.code=="string",i&&(r=new k(s.error.code,s.error.message))),i?new yl(e,s.state,r):(ct("SharedClientState",`Failed to parse target state for ID '${e}': ${n}`),null)}Yi(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Xd{constructor(e,n){this.clientId=e,this.activeTargetIds=n}static Ji(e,n){const s=JSON.parse(n);let r=typeof s=="object"&&s.activeTargetIds instanceof Array,i=Ap();for(let o=0;r&&o<s.activeTargetIds.length;++o)r=jN(s.activeTargetIds[o]),i=i.add(s.activeTargetIds[o]);return r?new Xd(e,i):(ct("SharedClientState",`Failed to parse client data for instance '${e}': ${n}`),null)}}class uw{constructor(e,n){this.clientId=e,this.onlineState=n}static Ji(e){const n=JSON.parse(e);return typeof n=="object"&&["Unknown","Online","Offline"].indexOf(n.onlineState)!==-1&&typeof n.clientId=="string"?new uw(n.clientId,n.onlineState):(ct("SharedClientState",`Failed to parse online state: ${e}`),null)}}class v_{constructor(){this.activeTargetIds=Ap()}Xi(e){this.activeTargetIds=this.activeTargetIds.add(e)}Zi(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Yi(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class Mg{constructor(e,n,s,r,i){this.window=e,this.js=n,this.persistenceKey=s,this.tr=r,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.er=this.nr.bind(this),this.sr=new it(ue),this.started=!1,this.ir=[];const o=s.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.rr=UT(this.persistenceKey,this.tr),this.ur=function(a){return`firestore_sequence_number_${a}`}(this.persistenceKey),this.sr=this.sr.insert(this.tr,new v_),this.cr=new RegExp(`^firestore_clients_${o}_([^_]*)$`),this.ar=new RegExp(`^firestore_mutations_${o}_(\\d+)(?:_(.*))?$`),this.hr=new RegExp(`^firestore_targets_${o}_(\\d+)$`),this.lr=function(a){return`firestore_online_state_${a}`}(this.persistenceKey),this.dr=function(a){return`firestore_bundle_loaded_v2_${a}`}(this.persistenceKey),this.window.addEventListener("storage",this.er)}static V(e){return!(!e||!e.localStorage)}async start(){const e=await this.syncEngine.Ri();for(const s of e){if(s===this.tr)continue;const r=this.getItem(UT(this.persistenceKey,s));if(r){const i=Xd.Ji(s,r);i&&(this.sr=this.sr.insert(i.clientId,i))}}this._r();const n=this.storage.getItem(this.lr);if(n){const s=this.wr(n);s&&this.mr(s)}for(const s of this.ir)this.nr(s);this.ir=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0}writeSequenceNumber(e){this.setItem(this.ur,JSON.stringify(e))}getAllActiveQueryTargets(){return this.gr(this.sr)}isActiveQueryTarget(e){let n=!1;return this.sr.forEach((s,r)=>{r.activeTargetIds.has(e)&&(n=!0)}),n}addPendingMutation(e){this.yr(e,"pending")}updateMutationState(e,n,s){this.yr(e,n,s),this.pr(e)}addLocalQueryTarget(e){let n="not-current";if(this.isActiveQueryTarget(e)){const s=this.storage.getItem(Og(this.persistenceKey,e));if(s){const r=yl.Ji(e,s);r&&(n=r.state)}}return this.Ir.Xi(e),this._r(),n}removeLocalQueryTarget(e){this.Ir.Zi(e),this._r()}isLocalQueryTarget(e){return this.Ir.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(Og(this.persistenceKey,e))}updateQueryState(e,n,s){this.Tr(e,n,s)}handleUserChange(e,n,s){n.forEach(r=>{this.pr(r)}),this.currentUser=e,s.forEach(r=>{this.addPendingMutation(r)})}setOnlineState(e){this.Er(e)}notifyBundleLoaded(e){this.Ar(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.er),this.removeItem(this.rr),this.started=!1)}getItem(e){const n=this.storage.getItem(e);return P("SharedClientState","READ",e,n),n}setItem(e,n){P("SharedClientState","SET",e,n),this.storage.setItem(e,n)}removeItem(e){P("SharedClientState","REMOVE",e),this.storage.removeItem(e)}nr(e){const n=e;if(n.storageArea===this.storage){if(P("SharedClientState","EVENT",n.key,n.newValue),n.key===this.rr)return void ct("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.js.enqueueRetryable(async()=>{if(this.started){if(n.key!==null){if(this.cr.test(n.key)){if(n.newValue==null){const s=this.Rr(n.key);return this.br(s,null)}{const s=this.Pr(n.key,n.newValue);if(s)return this.br(s.clientId,s)}}else if(this.ar.test(n.key)){if(n.newValue!==null){const s=this.vr(n.key,n.newValue);if(s)return this.Vr(s)}}else if(this.hr.test(n.key)){if(n.newValue!==null){const s=this.Sr(n.key,n.newValue);if(s)return this.Dr(s)}}else if(n.key===this.lr){if(n.newValue!==null){const s=this.wr(n.newValue);if(s)return this.mr(s)}}else if(n.key===this.ur){const s=function(r){let i=wn.ot;if(r!=null)try{const o=JSON.parse(r);ae(typeof o=="number"),i=o}catch(o){ct("SharedClientState","Failed to read sequence number from WebStorage",o)}return i}(n.newValue);s!==wn.ot&&this.sequenceNumberHandler(s)}else if(n.key===this.dr){const s=this.Cr(n.newValue);await Promise.all(s.map(r=>this.syncEngine.Nr(r)))}}}else this.ir.push(n)})}}get Ir(){return this.sr.get(this.tr)}_r(){this.setItem(this.rr,this.Ir.Yi())}yr(e,n,s){const r=new Jd(this.currentUser,e,n,s),i=$T(this.persistenceKey,this.currentUser,e);this.setItem(i,r.Yi())}pr(e){const n=$T(this.persistenceKey,this.currentUser,e);this.removeItem(n)}Er(e){const n={clientId:this.tr,onlineState:e};this.storage.setItem(this.lr,JSON.stringify(n))}Tr(e,n,s){const r=Og(this.persistenceKey,e),i=new yl(e,n,s);this.setItem(r,i.Yi())}Ar(e){const n=JSON.stringify(Array.from(e));this.setItem(this.dr,n)}Rr(e){const n=this.cr.exec(e);return n?n[1]:null}Pr(e,n){const s=this.Rr(e);return Xd.Ji(s,n)}vr(e,n){const s=this.ar.exec(e),r=Number(s[1]),i=s[2]!==void 0?s[2]:null;return Jd.Ji(new Tt(i),r,n)}Sr(e,n){const s=this.hr.exec(e),r=Number(s[1]);return yl.Ji(r,n)}wr(e){return uw.Ji(e)}Cr(e){return JSON.parse(e)}async Vr(e){if(e.user.uid===this.currentUser.uid)return this.syncEngine.kr(e.batchId,e.state,e.error);P("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)}Dr(e){return this.syncEngine.Mr(e.targetId,e.state,e.error)}br(e,n){const s=n?this.sr.insert(e,n):this.sr.remove(e),r=this.gr(this.sr),i=this.gr(s),o=[],a=[];return i.forEach(c=>{r.has(c)||o.push(c)}),r.forEach(c=>{i.has(c)||a.push(c)}),this.syncEngine.Or(o,a).then(()=>{this.sr=s})}mr(e){this.sr.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}gr(e){let n=Ap();return e.forEach((s,r)=>{n=n.unionWith(r.activeTargetIds)}),n}}class qP{constructor(){this.Fr=new v_,this.$r={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,s){}addLocalQueryTarget(e){return this.Fr.Xi(e),this.$r[e]||"not-current"}updateQueryState(e,n,s){this.$r[e]=n}removeLocalQueryTarget(e){this.Fr.Zi(e)}isLocalQueryTarget(e){return this.Fr.activeTargetIds.has(e)}clearQueryState(e){delete this.$r[e]}getAllActiveQueryTargets(){return this.Fr.activeTargetIds}isActiveQueryTarget(e){return this.Fr.activeTargetIds.has(e)}start(){return this.Fr=new v_,Promise.resolve()}handleUserChange(e,n,s){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cQ{Br(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VT{constructor(){this.Lr=()=>this.Ur(),this.qr=()=>this.Kr(),this.Gr=[],this.Qr()}Br(e){this.Gr.push(e)}shutdown(){window.removeEventListener("online",this.Lr),window.removeEventListener("offline",this.qr)}Qr(){window.addEventListener("online",this.Lr),window.addEventListener("offline",this.qr)}Ur(){P("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.Gr)e(0)}Kr(){P("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.Gr)e(1)}static V(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lQ={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uQ{constructor(e){this.jr=e.jr,this.Wr=e.Wr}zr(e){this.Hr=e}Jr(e){this.Yr=e}onMessage(e){this.Xr=e}close(){this.Wr()}send(e){this.jr(e)}Zr(){this.Hr()}eo(e){this.Yr(e)}no(e){this.Xr(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hQ extends class{constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const n=e.ssl?"https":"http";this.so=n+"://"+e.host,this.io="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}ro(e,n,s,r,i){const o=this.oo(e,n);P("RestConnection","Sending: ",o,s);const a={};return this.uo(a,r,i),this.co(e,o,a,s).then(c=>(P("RestConnection","Received: ",c),c),c=>{throw Ka("RestConnection",`${e} failed with error: `,c,"url: ",o,"request:",s),c})}ao(e,n,s,r,i,o){return this.ro(e,n,s,r,i)}uo(e,n,s){e["X-Goog-Api-Client"]="gl-js/ fire/"+_c,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((r,i)=>e[i]=r),s&&s.headers.forEach((r,i)=>e[i]=r)}oo(e,n){const s=lQ[e];return`${this.so}/v1/${n}:${s}`}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams}co(e,n,s,r){return new Promise((i,o)=>{const a=new l6;a.listenOnce(o6.COMPLETE,()=>{try{switch(a.getLastErrorCode()){case Pg.NO_ERROR:const l=a.getResponseJson();P("Connection","XHR received:",JSON.stringify(l)),i(l);break;case Pg.TIMEOUT:P("Connection",'RPC "'+e+'" timed out'),o(new k(w.DEADLINE_EXCEEDED,"Request time out"));break;case Pg.HTTP_ERROR:const u=a.getStatus();if(P("Connection",'RPC "'+e+'" failed with status:',u,"response text:",a.getResponseText()),u>0){const h=a.getResponseJson().error;if(h&&h.status&&h.message){const d=function(f){const p=f.toLowerCase().replace(/_/g,"-");return Object.values(w).indexOf(p)>=0?p:w.UNKNOWN}(h.status);o(new k(d,h.message))}else o(new k(w.UNKNOWN,"Server responded with status "+a.getStatus()))}else o(new k(w.UNAVAILABLE,"Connection failed."));break;default:Q()}}finally{P("Connection",'RPC "'+e+'" completed.')}});const c=JSON.stringify(r);a.send(n,"POST",c,s,15)})}ho(e,n,s){const r=[this.so,"/","google.firestore.v1.Firestore","/",e,"/channel"],i=r6(),o=i6(),a={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.useFetchStreams&&(a.xmlHttpFactory=new c6({})),this.uo(a.initMessageHeaders,n,s),Af()||Eu()||_F()||cy()||yF()||Iu()||(a.httpHeadersOverwriteParam="$httpHeaders");const c=r.join("");P("Connection","Creating WebChannel: "+c,a);const l=i.createWebChannel(c,a);let u=!1,h=!1;const d=new uQ({jr:p=>{h?P("Connection","Not sending because WebChannel is closed:",p):(u||(P("Connection","Opening WebChannel transport."),l.open(),u=!0),P("Connection","WebChannel sending:",p),l.send(p))},Wr:()=>l.close()}),f=(p,_,y)=>{p.listen(_,T=>{try{y(T)}catch(I){setTimeout(()=>{throw I},0)}})};return f(l,wh.EventType.OPEN,()=>{h||P("Connection","WebChannel transport opened.")}),f(l,wh.EventType.CLOSE,()=>{h||(h=!0,P("Connection","WebChannel transport closed"),d.eo())}),f(l,wh.EventType.ERROR,p=>{h||(h=!0,Ka("Connection","WebChannel transport errored:",p),d.eo(new k(w.UNAVAILABLE,"The operation could not be completed")))}),f(l,wh.EventType.MESSAGE,p=>{var _;if(!h){const y=p.data[0];ae(!!y);const T=y,I=T.error||((_=T[0])===null||_===void 0?void 0:_.error);if(I){P("Connection","WebChannel received error:",I);const E=I.status;let S=function(Y){const M=ht[Y];if(M!==void 0)return oP(M)}(E),H=I.message;S===void 0&&(S=w.INTERNAL,H="Unknown error status: "+E+" with message "+I.message),h=!0,d.eo(new k(S,H)),l.close()}else P("Connection","WebChannel received:",y),d.no(y)}}),f(o,a6.STAT_EVENT,p=>{p.stat===YE.PROXY?P("Connection","Detected buffering proxy"):p.stat===YE.NOPROXY&&P("Connection","Detected no buffering proxy")}),setTimeout(()=>{d.Zr()},0),d}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function KP(){return typeof window<"u"?window:null}function Gh(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eh(t){return new n4(t,!0)}class hw{constructor(e,n,s=1e3,r=1.5,i=6e4){this.js=e,this.timerId=n,this.lo=s,this.fo=r,this._o=i,this.wo=0,this.mo=null,this.yo=Date.now(),this.reset()}reset(){this.wo=0}po(){this.wo=this._o}Io(e){this.cancel();const n=Math.floor(this.wo+this.To()),s=Math.max(0,Date.now()-this.yo),r=Math.max(0,n-s);r>0&&P("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.wo} ms, delay with jitter: ${n} ms, last attempt: ${s} ms ago)`),this.mo=this.js.enqueueAfterDelay(this.timerId,r,()=>(this.yo=Date.now(),e())),this.wo*=this.fo,this.wo<this.lo&&(this.wo=this.lo),this.wo>this._o&&(this.wo=this._o)}Eo(){this.mo!==null&&(this.mo.skipDelay(),this.mo=null)}cancel(){this.mo!==null&&(this.mo.cancel(),this.mo=null)}To(){return(Math.random()-.5)*this.wo}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HP{constructor(e,n,s,r,i,o,a,c){this.js=e,this.Ao=s,this.Ro=r,this.bo=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=c,this.state=0,this.Po=0,this.vo=null,this.Vo=null,this.stream=null,this.So=new hw(e,n)}Do(){return this.state===1||this.state===5||this.Co()}Co(){return this.state===2||this.state===3}start(){this.state!==4?this.auth():this.xo()}async stop(){this.Do()&&await this.close(0)}No(){this.state=0,this.So.reset()}ko(){this.Co()&&this.vo===null&&(this.vo=this.js.enqueueAfterDelay(this.Ao,6e4,()=>this.Mo()))}Oo(e){this.Fo(),this.stream.send(e)}async Mo(){if(this.Co())return this.close(0)}Fo(){this.vo&&(this.vo.cancel(),this.vo=null)}$o(){this.Vo&&(this.Vo.cancel(),this.Vo=null)}async close(e,n){this.Fo(),this.$o(),this.So.cancel(),this.Po++,e!==4?this.So.reset():n&&n.code===w.RESOURCE_EXHAUSTED?(ct(n.toString()),ct("Using maximum backoff delay to prevent overloading the backend."),this.So.po()):n&&n.code===w.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.Bo(),this.stream.close(),this.stream=null),this.state=e,await this.listener.Jr(n)}Bo(){}auth(){this.state=1;const e=this.Lo(this.Po),n=this.Po;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([s,r])=>{this.Po===n&&this.Uo(s,r)},s=>{e(()=>{const r=new k(w.UNKNOWN,"Fetching auth token failed: "+s.message);return this.qo(r)})})}Uo(e,n){const s=this.Lo(this.Po);this.stream=this.Ko(e,n),this.stream.zr(()=>{s(()=>(this.state=2,this.Vo=this.js.enqueueAfterDelay(this.Ro,1e4,()=>(this.Co()&&(this.state=3),Promise.resolve())),this.listener.zr()))}),this.stream.Jr(r=>{s(()=>this.qo(r))}),this.stream.onMessage(r=>{s(()=>this.onMessage(r))})}xo(){this.state=5,this.So.Io(async()=>{this.state=0,this.start()})}qo(e){return P("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}Lo(e){return n=>{this.js.enqueueAndForget(()=>this.Po===e?n():(P("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class dQ extends HP{constructor(e,n,s,r,i,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,s,r,o),this.wt=i}Ko(e,n){return this.bo.ho("Listen",e,n)}onMessage(e){this.So.reset();const n=i4(this.wt,e),s=function(r){if(!("targetChange"in r))return oe.min();const i=r.targetChange;return i.targetIds&&i.targetIds.length?oe.min():i.readTime?Rt(i.readTime):oe.min()}(e);return this.listener.Go(n,s)}Qo(e){const n={};n.database=hu(this.wt),n.addTarget=function(r,i){let o;const a=i.target;return o=Hd(a)?{documents:_P(r,a)}:{query:yP(r,a)},o.targetId=i.targetId,i.resumeToken.approximateByteSize()>0?o.resumeToken=dP(r,i.resumeToken):i.snapshotVersion.compareTo(oe.min())>0&&(o.readTime=lu(r,i.snapshotVersion.toTimestamp())),o}(this.wt,e);const s=a4(this.wt,e);s&&(n.labels=s),this.Oo(n)}jo(e){const n={};n.database=hu(this.wt),n.removeTarget=e,this.Oo(n)}}class fQ extends HP{constructor(e,n,s,r,i,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,s,r,o),this.wt=i,this.Wo=!1}get zo(){return this.Wo}start(){this.Wo=!1,this.lastStreamToken=void 0,super.start()}Bo(){this.Wo&&this.Ho([])}Ko(e,n){return this.bo.ho("Write",e,n)}onMessage(e){if(ae(!!e.streamToken),this.lastStreamToken=e.streamToken,this.Wo){this.So.reset();const n=o4(e.writeResults,e.commitTime),s=Rt(e.commitTime);return this.listener.Jo(s,n)}return ae(!e.writeResults||e.writeResults.length===0),this.Wo=!0,this.listener.Yo()}Xo(){const e={};e.database=hu(this.wt),this.Oo(e)}Ho(e){const n={streamToken:this.lastStreamToken,writes:e.map(s=>du(this.wt,s))};this.Oo(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pQ extends class{}{constructor(e,n,s,r){super(),this.authCredentials=e,this.appCheckCredentials=n,this.bo=s,this.wt=r,this.Zo=!1}tu(){if(this.Zo)throw new k(w.FAILED_PRECONDITION,"The client has already been terminated.")}ro(e,n,s){return this.tu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([r,i])=>this.bo.ro(e,n,s,r,i)).catch(r=>{throw r.name==="FirebaseError"?(r.code===w.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),r):new k(w.UNKNOWN,r.toString())})}ao(e,n,s,r){return this.tu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.bo.ao(e,n,s,i,o,r)).catch(i=>{throw i.name==="FirebaseError"?(i.code===w.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new k(w.UNKNOWN,i.toString())})}terminate(){this.Zo=!0}}class gQ{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.eu=0,this.nu=null,this.su=!0}iu(){this.eu===0&&(this.ru("Unknown"),this.nu=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.nu=null,this.ou("Backend didn't respond within 10 seconds."),this.ru("Offline"),Promise.resolve())))}uu(e){this.state==="Online"?this.ru("Unknown"):(this.eu++,this.eu>=1&&(this.cu(),this.ou(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ru("Offline")))}set(e){this.cu(),this.eu=0,e==="Online"&&(this.su=!1),this.ru(e)}ru(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}ou(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.su?(ct(n),this.su=!1):P("OnlineStateTracker",n)}cu(){this.nu!==null&&(this.nu.cancel(),this.nu=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mQ{constructor(e,n,s,r,i){this.localStore=e,this.datastore=n,this.asyncQueue=s,this.remoteSyncer={},this.au=[],this.hu=new Map,this.lu=new Set,this.fu=[],this.du=i,this.du.Br(o=>{s.enqueueAndForget(async()=>{Ii(this)&&(P("RemoteStore","Restarting streams for network reachability change."),await async function(a){const c=q(a);c.lu.add(4),await bc(c),c._u.set("Unknown"),c.lu.delete(4),await th(c)}(this))})}),this._u=new gQ(s,r)}}async function th(t){if(Ii(t))for(const e of t.fu)await e(!0)}async function bc(t){for(const e of t.fu)await e(!1)}function Pp(t,e){const n=q(t);n.hu.has(e.targetId)||(n.hu.set(e.targetId,e),pw(n)?fw(n):Ec(n).Co()&&dw(n,e))}function fu(t,e){const n=q(t),s=Ec(n);n.hu.delete(e),s.Co()&&WP(n,e),n.hu.size===0&&(s.Co()?s.ko():Ii(n)&&n._u.set("Unknown"))}function dw(t,e){t.wu.Nt(e.targetId),Ec(t).Qo(e)}function WP(t,e){t.wu.Nt(e),Ec(t).jo(e)}function fw(t){t.wu=new Z6({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),te:e=>t.hu.get(e)||null}),Ec(t).start(),t._u.iu()}function pw(t){return Ii(t)&&!Ec(t).Do()&&t.hu.size>0}function Ii(t){return q(t).lu.size===0}function GP(t){t.wu=void 0}async function _Q(t){t.hu.forEach((e,n)=>{dw(t,e)})}async function yQ(t,e){GP(t),pw(t)?(t._u.uu(e),fw(t)):t._u.set("Unknown")}async function vQ(t,e,n){if(t._u.set("Online"),e instanceof hP&&e.state===2&&e.cause)try{await async function(s,r){const i=r.cause;for(const o of r.targetIds)s.hu.has(o)&&(await s.remoteSyncer.rejectListen(o,i),s.hu.delete(o),s.wu.removeTarget(o))}(t,e)}catch(s){P("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),s),await Zd(t,s)}else if(e instanceof Hh?t.wu.Ut(e):e instanceof uP?t.wu.zt(e):t.wu.Gt(e),!n.isEqual(oe.min()))try{const s=await UP(t.localStore);n.compareTo(s)>=0&&await function(r,i){const o=r.wu.Yt(i);return o.targetChanges.forEach((a,c)=>{if(a.resumeToken.approximateByteSize()>0){const l=r.hu.get(c);l&&r.hu.set(c,l.withResumeToken(a.resumeToken,i))}}),o.targetMismatches.forEach(a=>{const c=r.hu.get(a);if(!c)return;r.hu.set(a,c.withResumeToken(_t.EMPTY_BYTE_STRING,c.snapshotVersion)),WP(r,a);const l=new Xr(c.target,a,1,c.sequenceNumber);dw(r,l)}),r.remoteSyncer.applyRemoteEvent(o)}(t,n)}catch(s){P("RemoteStore","Failed to raise snapshot:",s),await Zd(t,s)}}async function Zd(t,e,n){if(!wi(e))throw e;t.lu.add(1),await bc(t),t._u.set("Offline"),n||(n=()=>UP(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{P("RemoteStore","Retrying IndexedDB access"),await n(),t.lu.delete(1),await th(t)})}function zP(t,e){return e().catch(n=>Zd(t,n,e))}async function Ic(t){const e=q(t),n=di(e);let s=e.au.length>0?e.au[e.au.length-1].batchId:-1;for(;wQ(e);)try{const r=await iQ(e.localStore,s);if(r===null){e.au.length===0&&n.ko();break}s=r.batchId,bQ(e,r)}catch(r){await Zd(e,r)}QP(e)&&YP(e)}function wQ(t){return Ii(t)&&t.au.length<10}function bQ(t,e){t.au.push(e);const n=di(t);n.Co()&&n.zo&&n.Ho(e.mutations)}function QP(t){return Ii(t)&&!di(t).Do()&&t.au.length>0}function YP(t){di(t).start()}async function IQ(t){di(t).Xo()}async function EQ(t){const e=di(t);for(const n of t.au)e.Ho(n.mutations)}async function TQ(t,e,n){const s=t.au.shift(),r=nw.from(s,e,n);await zP(t,()=>t.remoteSyncer.applySuccessfulWrite(r)),await Ic(t)}async function SQ(t,e){e&&di(t).zo&&await async function(n,s){if(r=s.code,iP(r)&&r!==w.ABORTED){const i=n.au.shift();di(n).No(),await zP(n,()=>n.remoteSyncer.rejectFailedWrite(i.batchId,s)),await Ic(n)}var r}(t,e),QP(t)&&YP(t)}async function BT(t,e){const n=q(t);n.asyncQueue.verifyOperationInProgress(),P("RemoteStore","RemoteStore received new credentials");const s=Ii(n);n.lu.add(3),await bc(n),s&&n._u.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.lu.delete(3),await th(n)}async function w_(t,e){const n=q(t);e?(n.lu.delete(2),await th(n)):e||(n.lu.add(2),await bc(n),n._u.set("Unknown"))}function Ec(t){return t.mu||(t.mu=function(e,n,s){const r=q(e);return r.tu(),new dQ(n,r.bo,r.authCredentials,r.appCheckCredentials,r.wt,s)}(t.datastore,t.asyncQueue,{zr:_Q.bind(null,t),Jr:yQ.bind(null,t),Go:vQ.bind(null,t)}),t.fu.push(async e=>{e?(t.mu.No(),pw(t)?fw(t):t._u.set("Unknown")):(await t.mu.stop(),GP(t))})),t.mu}function di(t){return t.gu||(t.gu=function(e,n,s){const r=q(e);return r.tu(),new fQ(n,r.bo,r.authCredentials,r.appCheckCredentials,r.wt,s)}(t.datastore,t.asyncQueue,{zr:IQ.bind(null,t),Jr:SQ.bind(null,t),Yo:EQ.bind(null,t),Jo:TQ.bind(null,t)}),t.fu.push(async e=>{e?(t.gu.No(),await Ic(t)):(await t.gu.stop(),t.au.length>0&&(P("RemoteStore",`Stopping write stream with ${t.au.length} pending writes`),t.au=[]))})),t.gu}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gw{constructor(e,n,s,r,i){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=s,this.op=r,this.removalCallback=i,this.deferred=new kt,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}static createAndSchedule(e,n,s,r,i){const o=Date.now()+s,a=new gw(e,n,o,r,i);return a.start(s),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new k(w.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Tc(t,e){if(ct("AsyncQueue",`${e}: ${t}`),wi(t))return new k(w.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sa{constructor(e){this.comparator=e?(n,s)=>e(n,s)||$.comparator(n.key,s.key):(n,s)=>$.comparator(n.key,s.key),this.keyedMap=Yc(),this.sortedSet=new it(this.comparator)}static emptySet(e){return new Sa(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,s)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof Sa)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),s=e.sortedSet.getIterator();for(;n.hasNext();){const r=n.getNext().key,i=s.getNext().key;if(!r.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const s=new Sa;return s.comparator=this.comparator,s.keyedMap=e,s.sortedSet=n,s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jT{constructor(){this.yu=new it($.comparator)}track(e){const n=e.doc.key,s=this.yu.get(n);s?e.type!==0&&s.type===3?this.yu=this.yu.insert(n,e):e.type===3&&s.type!==1?this.yu=this.yu.insert(n,{type:s.type,doc:e.doc}):e.type===2&&s.type===2?this.yu=this.yu.insert(n,{type:2,doc:e.doc}):e.type===2&&s.type===0?this.yu=this.yu.insert(n,{type:0,doc:e.doc}):e.type===1&&s.type===0?this.yu=this.yu.remove(n):e.type===1&&s.type===2?this.yu=this.yu.insert(n,{type:1,doc:s.doc}):e.type===0&&s.type===1?this.yu=this.yu.insert(n,{type:2,doc:e.doc}):Q():this.yu=this.yu.insert(n,e)}pu(){const e=[];return this.yu.inorderTraversal((n,s)=>{e.push(s)}),e}}class Ja{constructor(e,n,s,r,i,o,a,c){this.query=e,this.docs=n,this.oldDocs=s,this.docChanges=r,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=c}static fromInitialDocuments(e,n,s,r){const i=[];return n.forEach(o=>{i.push({type:0,doc:o})}),new Ja(e,n,Sa.emptySet(n),i,s,r,!0,!1)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Yu(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,s=e.docChanges;if(n.length!==s.length)return!1;for(let r=0;r<n.length;r++)if(n[r].type!==s[r].type||!n[r].doc.isEqual(s[r].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CQ{constructor(){this.Iu=void 0,this.listeners=[]}}class AQ{constructor(){this.queries=new bi(e=>GN(e),Yu),this.onlineState="Unknown",this.Tu=new Set}}async function mw(t,e){const n=q(t),s=e.query;let r=!1,i=n.queries.get(s);if(i||(r=!0,i=new CQ),r)try{i.Iu=await n.onListen(s)}catch(o){const a=Tc(o,`Initialization of query '${g_(e.query)}' failed`);return void e.onError(a)}n.queries.set(s,i),i.listeners.push(e),e.Eu(n.onlineState),i.Iu&&e.Au(i.Iu)&&yw(n)}async function _w(t,e){const n=q(t),s=e.query;let r=!1;const i=n.queries.get(s);if(i){const o=i.listeners.indexOf(e);o>=0&&(i.listeners.splice(o,1),r=i.listeners.length===0)}if(r)return n.queries.delete(s),n.onUnlisten(s)}function kQ(t,e){const n=q(t);let s=!1;for(const r of e){const i=r.query,o=n.queries.get(i);if(o){for(const a of o.listeners)a.Au(r)&&(s=!0);o.Iu=r}}s&&yw(n)}function RQ(t,e,n){const s=q(t),r=s.queries.get(e);if(r)for(const i of r.listeners)i.onError(n);s.queries.delete(e)}function yw(t){t.Tu.forEach(e=>{e.next()})}class vw{constructor(e,n,s){this.query=e,this.Ru=n,this.bu=!1,this.Pu=null,this.onlineState="Unknown",this.options=s||{}}Au(e){if(!this.options.includeMetadataChanges){const s=[];for(const r of e.docChanges)r.type!==3&&s.push(r);e=new Ja(e.query,e.docs,e.oldDocs,s,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0)}let n=!1;return this.bu?this.vu(e)&&(this.Ru.next(e),n=!0):this.Vu(e,this.onlineState)&&(this.Su(e),n=!0),this.Pu=e,n}onError(e){this.Ru.error(e)}Eu(e){this.onlineState=e;let n=!1;return this.Pu&&!this.bu&&this.Vu(this.Pu,e)&&(this.Su(this.Pu),n=!0),n}Vu(e,n){if(!e.fromCache)return!0;const s=n!=="Offline";return(!this.options.Du||!s)&&(!e.docs.isEmpty()||n==="Offline")}vu(e){if(e.docChanges.length>0)return!0;const n=this.Pu&&this.Pu.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}Su(e){e=Ja.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache),this.bu=!0,this.Ru.next(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NQ{constructor(e,n){this.payload=e,this.byteLength=n}Cu(){return"metadata"in this.payload}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qT{constructor(e){this.wt=e}Wi(e){return Ms(this.wt,e)}zi(e){return e.metadata.exists?mP(this.wt,e.document,!1):je.newNoDocument(this.Wi(e.metadata.name),this.Hi(e.metadata.readTime))}Hi(e){return Rt(e)}}class PQ{constructor(e,n,s){this.xu=e,this.localStore=n,this.wt=s,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=JP(e)}Nu(e){this.progress.bytesLoaded+=e.byteLength;let n=this.progress.documentsLoaded;if(e.payload.namedQuery)this.queries.push(e.payload.namedQuery);else if(e.payload.documentMetadata){this.documents.push({metadata:e.payload.documentMetadata}),e.payload.documentMetadata.exists||++n;const s=Te.fromString(e.payload.documentMetadata.name);this.collectionGroups.add(s.get(s.length-2))}else e.payload.document&&(this.documents[this.documents.length-1].document=e.payload.document,++n);return n!==this.progress.documentsLoaded?(this.progress.documentsLoaded=n,Object.assign({},this.progress)):null}ku(e){const n=new Map,s=new qT(this.wt);for(const r of e)if(r.metadata.queries){const i=s.Wi(r.metadata.name);for(const o of r.metadata.queries){const a=(n.get(o)||he()).add(i);n.set(o,a)}}return n}async complete(){const e=await oQ(this.localStore,new qT(this.wt),this.documents,this.xu.id),n=this.ku(this.documents);for(const s of this.queries)await aQ(this.localStore,s,n.get(s.name));return this.progress.taskState="Success",{progress:this.progress,Mu:this.collectionGroups,Ou:e}}}function JP(t){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:t.totalDocuments,totalBytes:t.totalBytes}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XP{constructor(e){this.key=e}}class ZP{constructor(e){this.key=e}}class ex{constructor(e,n){this.query=e,this.Fu=n,this.$u=null,this.current=!1,this.Bu=he(),this.mutatedKeys=he(),this.Lu=QN(e),this.Uu=new Sa(this.Lu)}get qu(){return this.Fu}Ku(e,n){const s=n?n.Gu:new jT,r=n?n.Uu:this.Uu;let i=n?n.mutatedKeys:this.mutatedKeys,o=r,a=!1;const c=this.query.limitType==="F"&&r.size===this.query.limit?r.last():null,l=this.query.limitType==="L"&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal((u,h)=>{const d=r.get(u),f=Xv(this.query,h)?h:null,p=!!d&&this.mutatedKeys.has(d.key),_=!!f&&(f.hasLocalMutations||this.mutatedKeys.has(f.key)&&f.hasCommittedMutations);let y=!1;d&&f?d.data.isEqual(f.data)?p!==_&&(s.track({type:3,doc:f}),y=!0):this.Qu(d,f)||(s.track({type:2,doc:f}),y=!0,(c&&this.Lu(f,c)>0||l&&this.Lu(f,l)<0)&&(a=!0)):!d&&f?(s.track({type:0,doc:f}),y=!0):d&&!f&&(s.track({type:1,doc:d}),y=!0,(c||l)&&(a=!0)),y&&(f?(o=o.add(f),i=_?i.add(u):i.delete(u)):(o=o.delete(u),i=i.delete(u)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const u=this.query.limitType==="F"?o.last():o.first();o=o.delete(u.key),i=i.delete(u.key),s.track({type:1,doc:u})}return{Uu:o,Gu:s,Mi:a,mutatedKeys:i}}Qu(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,s){const r=this.Uu;this.Uu=e.Uu,this.mutatedKeys=e.mutatedKeys;const i=e.Gu.pu();i.sort((l,u)=>function(h,d){const f=p=>{switch(p){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Q()}};return f(h)-f(d)}(l.type,u.type)||this.Lu(l.doc,u.doc)),this.ju(s);const o=n?this.Wu():[],a=this.Bu.size===0&&this.current?1:0,c=a!==this.$u;return this.$u=a,i.length!==0||c?{snapshot:new Ja(this.query,e.Uu,r,i,e.mutatedKeys,a===0,c,!1),zu:o}:{zu:o}}Eu(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Uu:this.Uu,Gu:new jT,mutatedKeys:this.mutatedKeys,Mi:!1},!1)):{zu:[]}}Hu(e){return!this.Fu.has(e)&&!!this.Uu.has(e)&&!this.Uu.get(e).hasLocalMutations}ju(e){e&&(e.addedDocuments.forEach(n=>this.Fu=this.Fu.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Fu=this.Fu.delete(n)),this.current=e.current)}Wu(){if(!this.current)return[];const e=this.Bu;this.Bu=he(),this.Uu.forEach(s=>{this.Hu(s.key)&&(this.Bu=this.Bu.add(s.key))});const n=[];return e.forEach(s=>{this.Bu.has(s)||n.push(new ZP(s))}),this.Bu.forEach(s=>{e.has(s)||n.push(new XP(s))}),n}Ju(e){this.Fu=e.ji,this.Bu=he();const n=this.Ku(e.documents);return this.applyChanges(n,!0)}Yu(){return Ja.fromInitialDocuments(this.query,this.Uu,this.mutatedKeys,this.$u===0)}}class xQ{constructor(e,n,s){this.query=e,this.targetId=n,this.view=s}}class DQ{constructor(e){this.key=e,this.Xu=!1}}class OQ{constructor(e,n,s,r,i,o){this.localStore=e,this.remoteStore=n,this.eventManager=s,this.sharedClientState=r,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.Zu={},this.tc=new bi(a=>GN(a),Yu),this.ec=new Map,this.nc=new Set,this.sc=new it($.comparator),this.ic=new Map,this.rc=new ow,this.oc={},this.uc=new Map,this.cc=Ro.Rn(),this.onlineState="Unknown",this.ac=void 0}get isPrimaryClient(){return this.ac===!0}}async function MQ(t,e){const n=Tw(t);let s,r;const i=n.tc.get(e);if(i)s=i.targetId,n.sharedClientState.addLocalQueryTarget(s),r=i.view.Yu();else{const o=await Qa(n.localStore,Tn(e));n.isPrimaryClient&&Pp(n.remoteStore,o);const a=n.sharedClientState.addLocalQueryTarget(o.targetId);s=o.targetId,r=await ww(n,e,s,a==="current")}return r}async function ww(t,e,n,s){t.hc=(u,h,d)=>async function(f,p,_,y){let T=p.view.Ku(_);T.Mi&&(T=await Yd(f.localStore,p.query,!1).then(({documents:S})=>p.view.Ku(S,T)));const I=y&&y.targetChanges.get(p.targetId),E=p.view.applyChanges(T,f.isPrimaryClient,I);return b_(f,p.targetId,E.zu),E.snapshot}(t,u,h,d);const r=await Yd(t.localStore,e,!0),i=new ex(e,r.ji),o=i.Ku(r.documents),a=Zu.createSynthesizedTargetChangeForCurrentChange(n,s&&t.onlineState!=="Offline"),c=i.applyChanges(o,t.isPrimaryClient,a);b_(t,n,c.zu);const l=new xQ(e,n,i);return t.tc.set(e,l),t.ec.has(n)?t.ec.get(n).push(e):t.ec.set(n,[e]),c.snapshot}async function LQ(t,e){const n=q(t),s=n.tc.get(e),r=n.ec.get(s.targetId);if(r.length>1)return n.ec.set(s.targetId,r.filter(i=>!Yu(i,e))),void n.tc.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(s.targetId),n.sharedClientState.isActiveQueryTarget(s.targetId)||await Ya(n.localStore,s.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(s.targetId),fu(n.remoteStore,s.targetId),Xa(n,s.targetId)}).catch(vi)):(Xa(n,s.targetId),await Ya(n.localStore,s.targetId,!0))}async function FQ(t,e,n){const s=Sw(t);try{const r=await function(i,o){const a=q(i),c=Ye.now(),l=o.reduce((d,f)=>d.add(f.key),he());let u,h;return a.persistence.runTransaction("Locally write mutations","readwrite",d=>{let f=bn(),p=he();return a.Ui.getEntries(d,l).next(_=>{f=_,f.forEach((y,T)=>{T.isValidDocument()||(p=p.add(y))})}).next(()=>a.localDocuments.getOverlayedDocuments(d,f)).next(_=>{u=_;const y=[];for(const T of o){const I=G6(T,u.get(T.key).overlayedDocument);I!=null&&y.push(new Tr(T.key,I,KN(I.value.mapValue),Ze.exists(!0)))}return a.mutationQueue.addMutationBatch(d,c,y,o)}).next(_=>{h=_;const y=_.applyToLocalDocumentSet(u,p);return a.documentOverlayCache.saveOverlays(d,_.batchId,y)})}).then(()=>({batchId:h.batchId,changes:cP(u)}))}(s.localStore,e);s.sharedClientState.addPendingMutation(r.batchId),function(i,o,a){let c=i.oc[i.currentUser.toKey()];c||(c=new it(ue)),c=c.insert(o,a),i.oc[i.currentUser.toKey()]=c}(s,r.batchId,n),await Sr(s,r.changes),await Ic(s.remoteStore)}catch(r){const i=Tc(r,"Failed to persist write");n.reject(i)}}async function tx(t,e){const n=q(t);try{const s=await rQ(n.localStore,e);e.targetChanges.forEach((r,i)=>{const o=n.ic.get(i);o&&(ae(r.addedDocuments.size+r.modifiedDocuments.size+r.removedDocuments.size<=1),r.addedDocuments.size>0?o.Xu=!0:r.modifiedDocuments.size>0?ae(o.Xu):r.removedDocuments.size>0&&(ae(o.Xu),o.Xu=!1))}),await Sr(n,s,e)}catch(s){await vi(s)}}function KT(t,e,n){const s=q(t);if(s.isPrimaryClient&&n===0||!s.isPrimaryClient&&n===1){const r=[];s.tc.forEach((i,o)=>{const a=o.view.Eu(e);a.snapshot&&r.push(a.snapshot)}),function(i,o){const a=q(i);a.onlineState=o;let c=!1;a.queries.forEach((l,u)=>{for(const h of u.listeners)h.Eu(o)&&(c=!0)}),c&&yw(a)}(s.eventManager,e),r.length&&s.Zu.Go(r),s.onlineState=e,s.isPrimaryClient&&s.sharedClientState.setOnlineState(e)}}async function UQ(t,e,n){const s=q(t);s.sharedClientState.updateQueryState(e,"rejected",n);const r=s.ic.get(e),i=r&&r.key;if(i){let o=new it($.comparator);o=o.insert(i,je.newNoDocument(i,oe.min()));const a=he().add(i),c=new Xu(oe.min(),new Map,new Pe(ue),o,a);await tx(s,c),s.sc=s.sc.remove(i),s.ic.delete(e),Ew(s)}else await Ya(s.localStore,e,!1).then(()=>Xa(s,e,n)).catch(vi)}async function $Q(t,e){const n=q(t),s=e.batch.batchId;try{const r=await sQ(n.localStore,e);Iw(n,s,null),bw(n,s),n.sharedClientState.updateMutationState(s,"acknowledged"),await Sr(n,r)}catch(r){await vi(r)}}async function VQ(t,e,n){const s=q(t);try{const r=await function(i,o){const a=q(i);return a.persistence.runTransaction("Reject batch","readwrite-primary",c=>{let l;return a.mutationQueue.lookupMutationBatch(c,o).next(u=>(ae(u!==null),l=u.keys(),a.mutationQueue.removeMutationBatch(c,u))).next(()=>a.mutationQueue.performConsistencyCheck(c)).next(()=>a.documentOverlayCache.removeOverlaysForBatchId(c,l,o)).next(()=>a.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(c,l)).next(()=>a.localDocuments.getDocuments(c,l))})}(s.localStore,e);Iw(s,e,n),bw(s,e),s.sharedClientState.updateMutationState(e,"rejected",n),await Sr(s,r)}catch(r){await vi(r)}}async function BQ(t,e){const n=q(t);Ii(n.remoteStore)||P("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{const s=await function(i){const o=q(i);return o.persistence.runTransaction("Get highest unacknowledged batch id","readonly",a=>o.mutationQueue.getHighestUnacknowledgedBatchId(a))}(n.localStore);if(s===-1)return void e.resolve();const r=n.uc.get(s)||[];r.push(e),n.uc.set(s,r)}catch(s){const r=Tc(s,"Initialization of waitForPendingWrites() operation failed");e.reject(r)}}function bw(t,e){(t.uc.get(e)||[]).forEach(n=>{n.resolve()}),t.uc.delete(e)}function Iw(t,e,n){const s=q(t);let r=s.oc[s.currentUser.toKey()];if(r){const i=r.get(e);i&&(n?i.reject(n):i.resolve(),r=r.remove(e)),s.oc[s.currentUser.toKey()]=r}}function Xa(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const s of t.ec.get(e))t.tc.delete(s),n&&t.Zu.lc(s,n);t.ec.delete(e),t.isPrimaryClient&&t.rc.us(e).forEach(s=>{t.rc.containsKey(s)||nx(t,s)})}function nx(t,e){t.nc.delete(e.path.canonicalString());const n=t.sc.get(e);n!==null&&(fu(t.remoteStore,n),t.sc=t.sc.remove(e),t.ic.delete(n),Ew(t))}function b_(t,e,n){for(const s of n)s instanceof XP?(t.rc.addReference(s.key,e),jQ(t,s)):s instanceof ZP?(P("SyncEngine","Document no longer in limbo: "+s.key),t.rc.removeReference(s.key,e),t.rc.containsKey(s.key)||nx(t,s.key)):Q()}function jQ(t,e){const n=e.key,s=n.path.canonicalString();t.sc.get(n)||t.nc.has(s)||(P("SyncEngine","New document in limbo: "+n),t.nc.add(s),Ew(t))}function Ew(t){for(;t.nc.size>0&&t.sc.size<t.maxConcurrentLimboResolutions;){const e=t.nc.values().next().value;t.nc.delete(e);const n=new $(Te.fromString(e)),s=t.cc.next();t.ic.set(s,new DQ(n)),t.sc=t.sc.insert(n,s),Pp(t.remoteStore,new Xr(Tn(yc(n.path)),s,2,wn.ot))}}async function Sr(t,e,n){const s=q(t),r=[],i=[],o=[];s.tc.isEmpty()||(s.tc.forEach((a,c)=>{o.push(s.hc(c,e,n).then(l=>{if(l){s.isPrimaryClient&&s.sharedClientState.updateQueryState(c.targetId,l.fromCache?"not-current":"current"),r.push(l);const u=lw.Vi(c.targetId,l);i.push(u)}}))}),await Promise.all(o),s.Zu.Go(r),await async function(a,c){const l=q(a);try{await l.persistence.runTransaction("notifyLocalViewChanges","readwrite",u=>v.forEach(c,h=>v.forEach(h.Pi,d=>l.persistence.referenceDelegate.addReference(u,h.targetId,d)).next(()=>v.forEach(h.vi,d=>l.persistence.referenceDelegate.removeReference(u,h.targetId,d)))))}catch(u){if(!wi(u))throw u;P("LocalStore","Failed to update sequence numbers: "+u)}for(const u of c){const h=u.targetId;if(!u.fromCache){const d=l.$i.get(h),f=d.snapshotVersion,p=d.withLastLimboFreeSnapshotVersion(f);l.$i=l.$i.insert(h,p)}}}(s.localStore,i))}async function qQ(t,e){const n=q(t);if(!n.currentUser.isEqual(e)){P("SyncEngine","User change. New user:",e.toKey());const s=await FP(n.localStore,e);n.currentUser=e,function(r,i){r.uc.forEach(o=>{o.forEach(a=>{a.reject(new k(w.CANCELLED,i))})}),r.uc.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,s.removedBatchIds,s.addedBatchIds),await Sr(n,s.Ki)}}function KQ(t,e){const n=q(t),s=n.ic.get(e);if(s&&s.Xu)return he().add(s.key);{let r=he();const i=n.ec.get(e);if(!i)return r;for(const o of i){const a=n.tc.get(o);r=r.unionWith(a.view.qu)}return r}}async function HQ(t,e){const n=q(t),s=await Yd(n.localStore,e.query,!0),r=e.view.Ju(s);return n.isPrimaryClient&&b_(n,e.targetId,r.zu),r}async function WQ(t,e){const n=q(t);return BP(n.localStore,e).then(s=>Sr(n,s))}async function GQ(t,e,n,s){const r=q(t),i=await function(o,a){const c=q(o),l=q(c.mutationQueue);return c.persistence.runTransaction("Lookup mutation documents","readonly",u=>l.yn(u,a).next(h=>h?c.localDocuments.getDocuments(u,h):v.resolve(null)))}(r.localStore,e);i!==null?(n==="pending"?await Ic(r.remoteStore):n==="acknowledged"||n==="rejected"?(Iw(r,e,s||null),bw(r,e),function(o,a){q(q(o).mutationQueue).In(a)}(r.localStore,e)):Q(),await Sr(r,i)):P("SyncEngine","Cannot apply mutation batch with id: "+e)}async function zQ(t,e){const n=q(t);if(Tw(n),Sw(n),e===!0&&n.ac!==!0){const s=n.sharedClientState.getAllActiveQueryTargets(),r=await HT(n,s.toArray());n.ac=!0,await w_(n.remoteStore,!0);for(const i of r)Pp(n.remoteStore,i)}else if(e===!1&&n.ac!==!1){const s=[];let r=Promise.resolve();n.ec.forEach((i,o)=>{n.sharedClientState.isLocalQueryTarget(o)?s.push(o):r=r.then(()=>(Xa(n,o),Ya(n.localStore,o,!0))),fu(n.remoteStore,o)}),await r,await HT(n,s),function(i){const o=q(i);o.ic.forEach((a,c)=>{fu(o.remoteStore,c)}),o.rc.cs(),o.ic=new Map,o.sc=new it($.comparator)}(n),n.ac=!1,await w_(n.remoteStore,!1)}}async function HT(t,e,n){const s=q(t),r=[],i=[];for(const o of e){let a;const c=s.ec.get(o);if(c&&c.length!==0){a=await Qa(s.localStore,Tn(c[0]));for(const l of c){const u=s.tc.get(l),h=await HQ(s,u);h.snapshot&&i.push(h.snapshot)}}else{const l=await VP(s.localStore,o);a=await Qa(s.localStore,l),await ww(s,sx(l),o,!1)}r.push(a)}return s.Zu.Go(i),r}function sx(t){return WN(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function QQ(t){const e=q(t);return q(q(e.localStore).persistence).Ri()}async function YQ(t,e,n,s){const r=q(t);if(r.ac)return void P("SyncEngine","Ignoring unexpected query state notification.");const i=r.ec.get(e);if(i&&i.length>0)switch(n){case"current":case"not-current":{const o=await BP(r.localStore,zN(i[0])),a=Xu.createSynthesizedRemoteEventForCurrentChange(e,n==="current");await Sr(r,o,a);break}case"rejected":await Ya(r.localStore,e,!0),Xa(r,e,s);break;default:Q()}}async function JQ(t,e,n){const s=Tw(t);if(s.ac){for(const r of e){if(s.ec.has(r)){P("SyncEngine","Adding an already active target "+r);continue}const i=await VP(s.localStore,r),o=await Qa(s.localStore,i);await ww(s,sx(i),o.targetId,!1),Pp(s.remoteStore,o)}for(const r of n)s.ec.has(r)&&await Ya(s.localStore,r,!1).then(()=>{fu(s.remoteStore,r),Xa(s,r)}).catch(vi)}}function Tw(t){const e=q(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=tx.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=KQ.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=UQ.bind(null,e),e.Zu.Go=kQ.bind(null,e.eventManager),e.Zu.lc=RQ.bind(null,e.eventManager),e}function Sw(t){const e=q(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=$Q.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=VQ.bind(null,e),e}function XQ(t,e,n){const s=q(t);(async function(r,i,o){try{const a=await i.getMetadata();if(await function(h,d){const f=q(h),p=Rt(d.createTime);return f.persistence.runTransaction("hasNewerBundle","readonly",_=>f.Ds.getBundleMetadata(_,d.id)).then(_=>!!_&&_.createTime.compareTo(p)>=0)}(r.localStore,a))return await i.close(),o._completeWith(function(h){return{taskState:"Success",documentsLoaded:h.totalDocuments,bytesLoaded:h.totalBytes,totalDocuments:h.totalDocuments,totalBytes:h.totalBytes}}(a)),Promise.resolve(new Set);o._updateProgress(JP(a));const c=new PQ(a,r.localStore,i.wt);let l=await i.fc();for(;l;){const h=await c.Nu(l);h&&o._updateProgress(h),l=await i.fc()}const u=await c.complete();return await Sr(r,u.Ou,void 0),await function(h,d){const f=q(h);return f.persistence.runTransaction("Save bundle","readwrite",p=>f.Ds.saveBundleMetadata(p,d))}(r.localStore,a),o._completeWith(u.progress),Promise.resolve(u.Mu)}catch(a){return Ka("SyncEngine",`Loading bundle failed with ${a}`),o._failWith(a),Promise.resolve(new Set)}})(s,e,n).then(r=>{s.sharedClientState.notifyBundleLoaded(r)})}class rx{constructor(){this.synchronizeTabs=!1}async initialize(e){this.wt=eh(e.databaseInfo.databaseId),this.sharedClientState=this.dc(e),this.persistence=this._c(e),await this.persistence.start(),this.localStore=this.wc(e),this.gcScheduler=this.mc(e,this.localStore),this.indexBackfillerScheduler=this.gc(e,this.localStore)}mc(e,n){return null}gc(e,n){return null}wc(e){return LP(this.persistence,new MP,e.initialUser,this.wt)}_c(e){return new OP(Np.Os,this.wt)}dc(e){return new qP}async terminate(){this.gcScheduler&&this.gcScheduler.stop(),await this.sharedClientState.shutdown(),await this.persistence.shutdown()}}class ix extends rx{constructor(e,n,s){super(),this.yc=e,this.cacheSizeBytes=n,this.forceOwnership=s,this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.yc.initialize(this,e),await Sw(this.yc.syncEngine),await Ic(this.yc.remoteStore),await this.persistence.ci(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}wc(e){return LP(this.persistence,new MP,e.initialUser,this.wt)}mc(e,n){const s=this.persistence.referenceDelegate.garbageCollector;return new j4(s,e.asyncQueue,n)}gc(e,n){const s=new S6(n,this.persistence);return new T6(e.asyncQueue,s)}_c(e){const n=cw(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),s=this.cacheSizeBytes!==void 0?_n.withCacheSize(this.cacheSizeBytes):_n.DEFAULT;return new aw(this.synchronizeTabs,n,e.clientId,s,e.asyncQueue,KP(),Gh(),this.wt,this.sharedClientState,!!this.forceOwnership)}dc(e){return new qP}}class ZQ extends ix{constructor(e,n){super(e,n,!1),this.yc=e,this.cacheSizeBytes=n,this.synchronizeTabs=!0}async initialize(e){await super.initialize(e);const n=this.yc.syncEngine;this.sharedClientState instanceof Mg&&(this.sharedClientState.syncEngine={kr:GQ.bind(null,n),Mr:YQ.bind(null,n),Or:JQ.bind(null,n),Ri:QQ.bind(null,n),Nr:WQ.bind(null,n)},await this.sharedClientState.start()),await this.persistence.ci(async s=>{await zQ(this.yc.syncEngine,s),this.gcScheduler&&(s&&!this.gcScheduler.started?this.gcScheduler.start():s||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(s&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():s||this.indexBackfillerScheduler.stop())})}dc(e){const n=KP();if(!Mg.V(n))throw new k(w.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const s=cw(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new Mg(n,e.asyncQueue,s,e.clientId,e.initialUser)}}class Cw{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=s=>KT(this.syncEngine,s,1),this.remoteStore.remoteSyncer.handleCredentialChange=qQ.bind(null,this.syncEngine),await w_(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return new AQ}createDatastore(e){const n=eh(e.databaseInfo.databaseId),s=(r=e.databaseInfo,new hQ(r));var r;return function(i,o,a,c){return new pQ(i,o,a,c)}(e.authCredentials,e.appCheckCredentials,s,n)}createRemoteStore(e){return n=this.localStore,s=this.datastore,r=e.asyncQueue,i=a=>KT(this.syncEngine,a,0),o=VT.V()?new VT:new cQ,new mQ(n,s,r,i,o);var n,s,r,i,o}createSyncEngine(e,n){return function(s,r,i,o,a,c,l){const u=new OQ(s,r,i,o,a,c);return l&&(u.ac=!0),u}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}terminate(){return async function(e){const n=q(e);P("RemoteStore","RemoteStore shutting down."),n.lu.add(5),await bc(n),n.du.shutdown(),n._u.set("Unknown")}(this.remoteStore)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function WT(t,e=10240){let n=0;return{async read(){if(n<t.byteLength){const s={value:t.slice(n,n+e),done:!1};return n+=e,s}return{done:!0}},async cancel(){},releaseLock(){},closed:Promise.reject("unimplemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xp{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Ic(this.observer.next,e)}error(e){this.observer.error?this.Ic(this.observer.error,e):ct("Uncaught Error in snapshot listener:",e)}Tc(){this.muted=!0}Ic(e,n){this.muted||setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e3{constructor(e,n){this.Ec=e,this.wt=n,this.metadata=new kt,this.buffer=new Uint8Array,this.Ac=new TextDecoder("utf-8"),this.Rc().then(s=>{s&&s.Cu()?this.metadata.resolve(s.payload.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(s==null?void 0:s.payload)}`))},s=>this.metadata.reject(s))}close(){return this.Ec.cancel()}async getMetadata(){return this.metadata.promise}async fc(){return await this.getMetadata(),this.Rc()}async Rc(){const e=await this.bc();if(e===null)return null;const n=this.Ac.decode(e),s=Number(n);isNaN(s)&&this.Pc(`length string (${n}) is not valid number`);const r=await this.vc(s);return new NQ(JSON.parse(r),e.length+s)}Vc(){return this.buffer.findIndex(e=>e==="{".charCodeAt(0))}async bc(){for(;this.Vc()<0&&!await this.Sc(););if(this.buffer.length===0)return null;const e=this.Vc();e<0&&this.Pc("Reached the end of bundle when a length string is expected.");const n=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),n}async vc(e){for(;this.buffer.length<e;)await this.Sc()&&this.Pc("Reached the end of bundle when more is expected.");const n=this.Ac.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),n}Pc(e){throw this.Ec.cancel(),new Error(`Invalid bundle format: ${e}`)}async Sc(){const e=await this.Ec.read();if(!e.done){const n=new Uint8Array(this.buffer.length+e.value.length);n.set(this.buffer),n.set(e.value,this.buffer.length),this.buffer=n}return e.done}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class t3{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastWriteError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw new k(w.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");const n=await async function(s,r){const i=q(s),o=hu(i.wt)+"/documents",a={documents:r.map(h=>uu(i.wt,h))},c=await i.ao("BatchGetDocuments",o,a,r.length),l=new Map;c.forEach(h=>{const d=r4(i.wt,h);l.set(d.key.toString(),d)});const u=[];return r.forEach(h=>{const d=l.get(h.toString());ae(!!d),u.push(d)}),u}(this.datastore,e);return n.forEach(s=>this.recordVersion(s)),n}set(e,n){this.write(n.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,n){try{this.write(n.toMutation(e,this.preconditionForUpdate(e)))}catch(s){this.lastWriteError=s}this.writtenDocs.add(e.toString())}delete(e){this.write(new wc(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastWriteError)throw this.lastWriteError;const e=this.readVersions;this.mutations.forEach(n=>{e.delete(n.key.toString())}),e.forEach((n,s)=>{const r=$.fromPath(s);this.mutations.push(new Zv(r,this.precondition(r)))}),await async function(n,s){const r=q(n),i=hu(r.wt)+"/documents",o={writes:s.map(a=>du(r.wt,a))};await r.ro("Commit",i,o)}(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let n;if(e.isFoundDocument())n=e.version;else{if(!e.isNoDocument())throw Q();n=oe.min()}const s=this.readVersions.get(e.key.toString());if(s){if(!n.isEqual(s))throw new k(w.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),n)}precondition(e){const n=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&n?Ze.updateTime(n):Ze.none()}preconditionForUpdate(e){const n=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&n){if(n.isEqual(oe.min()))throw new k(w.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Ze.updateTime(n)}return Ze.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class n3{constructor(e,n,s,r,i){this.asyncQueue=e,this.datastore=n,this.options=s,this.updateFunction=r,this.deferred=i,this.Dc=s.maxAttempts,this.So=new hw(this.asyncQueue,"transaction_retry")}run(){this.Dc-=1,this.Cc()}Cc(){this.So.Io(async()=>{const e=new t3(this.datastore),n=this.xc(e);n&&n.then(s=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(s)}).catch(r=>{this.Nc(r)}))}).catch(s=>{this.Nc(s)})})}xc(e){try{const n=this.updateFunction(e);return!zu(n)&&n.catch&&n.then?n:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(n){return this.deferred.reject(n),null}}Nc(e){this.Dc>0&&this.kc(e)?(this.Dc-=1,this.asyncQueue.enqueueAndForget(()=>(this.Cc(),Promise.resolve()))):this.deferred.reject(e)}kc(e){if(e.name==="FirebaseError"){const n=e.code;return n==="aborted"||n==="failed-precondition"||!iP(n)}return!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s3{constructor(e,n,s,r){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=s,this.databaseInfo=r,this.user=Tt.UNAUTHENTICATED,this.clientId=DN.I(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(s,async i=>{P("FirestoreClient","Received user=",i.uid),await this.authCredentialListener(i),this.user=i}),this.appCheckCredentials.start(s,i=>(P("FirestoreClient","Received new app check token=",i),this.appCheckCredentialListener(i,this.user)))}async getConfiguration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new k(w.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();const e=new kt;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this.onlineComponents&&await this.onlineComponents.terminate(),this.offlineComponents&&await this.offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const s=Tc(n,"Failed to shutdown persistence");e.reject(s)}}),e.promise}}async function ox(t,e){t.asyncQueue.verifyOperationInProgress(),P("FirestoreClient","Initializing OfflineComponentProvider");const n=await t.getConfiguration();await e.initialize(n);let s=n.initialUser;t.setCredentialChangeListener(async r=>{s.isEqual(r)||(await FP(e.localStore,r),s=r)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t.offlineComponents=e}async function ax(t,e){t.asyncQueue.verifyOperationInProgress();const n=await Aw(t);P("FirestoreClient","Initializing OnlineComponentProvider");const s=await t.getConfiguration();await e.initialize(n,s),t.setCredentialChangeListener(r=>BT(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,i)=>BT(e.remoteStore,i)),t.onlineComponents=e}async function Aw(t){return t.offlineComponents||(P("FirestoreClient","Using default OfflineComponentProvider"),await ox(t,new rx)),t.offlineComponents}async function Dp(t){return t.onlineComponents||(P("FirestoreClient","Using default OnlineComponentProvider"),await ax(t,new Cw)),t.onlineComponents}function cx(t){return Aw(t).then(e=>e.persistence)}function kw(t){return Aw(t).then(e=>e.localStore)}function lx(t){return Dp(t).then(e=>e.remoteStore)}function Rw(t){return Dp(t).then(e=>e.syncEngine)}async function Za(t){const e=await Dp(t),n=e.eventManager;return n.onListen=MQ.bind(null,e.syncEngine),n.onUnlisten=LQ.bind(null,e.syncEngine),n}function r3(t){return t.asyncQueue.enqueue(async()=>{const e=await cx(t),n=await lx(t);return e.setNetworkEnabled(!0),function(s){const r=q(s);return r.lu.delete(0),th(r)}(n)})}function i3(t){return t.asyncQueue.enqueue(async()=>{const e=await cx(t),n=await lx(t);return e.setNetworkEnabled(!1),async function(s){const r=q(s);r.lu.add(0),await bc(r),r._u.set("Offline")}(n)})}function o3(t,e){const n=new kt;return t.asyncQueue.enqueueAndForget(async()=>async function(s,r,i){try{const o=await function(a,c){const l=q(a);return l.persistence.runTransaction("read document","readonly",u=>l.localDocuments.getDocument(u,c))}(s,r);o.isFoundDocument()?i.resolve(o):o.isNoDocument()?i.resolve(null):i.reject(new k(w.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(o){const a=Tc(o,`Failed to get document '${r} from cache`);i.reject(a)}}(await kw(t),e,n)),n.promise}function ux(t,e,n={}){const s=new kt;return t.asyncQueue.enqueueAndForget(async()=>function(r,i,o,a,c){const l=new xp({next:h=>{i.enqueueAndForget(()=>_w(r,u));const d=h.docs.has(o);!d&&h.fromCache?c.reject(new k(w.UNAVAILABLE,"Failed to get document because the client is offline.")):d&&h.fromCache&&a&&a.source==="server"?c.reject(new k(w.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):c.resolve(h)},error:h=>c.reject(h)}),u=new vw(yc(o.path),l,{includeMetadataChanges:!0,Du:!0});return mw(r,u)}(await Za(t),t.asyncQueue,e,n,s)),s.promise}function a3(t,e){const n=new kt;return t.asyncQueue.enqueueAndForget(async()=>async function(s,r,i){try{const o=await Yd(s,r,!0),a=new ex(r,o.ji),c=a.Ku(o.documents),l=a.applyChanges(c,!1);i.resolve(l.snapshot)}catch(o){const a=Tc(o,`Failed to execute query '${r} against cache`);i.reject(a)}}(await kw(t),e,n)),n.promise}function hx(t,e,n={}){const s=new kt;return t.asyncQueue.enqueueAndForget(async()=>function(r,i,o,a,c){const l=new xp({next:h=>{i.enqueueAndForget(()=>_w(r,u)),h.fromCache&&a.source==="server"?c.reject(new k(w.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):c.resolve(h)},error:h=>c.reject(h)}),u=new vw(o,l,{includeMetadataChanges:!0,Du:!0});return mw(r,u)}(await Za(t),t.asyncQueue,e,n,s)),s.promise}function c3(t,e){const n=new xp(e);return t.asyncQueue.enqueueAndForget(async()=>function(s,r){q(s).Tu.add(r),r.next()}(await Za(t),n)),()=>{n.Tc(),t.asyncQueue.enqueueAndForget(async()=>function(s,r){q(s).Tu.delete(r)}(await Za(t),n))}}function l3(t,e,n){const s=new kt;return t.asyncQueue.enqueueAndForget(async()=>{const r=await function(i){return Dp(i).then(o=>o.datastore)}(t);new n3(t.asyncQueue,r,n,e,s).run()}),s.promise}function u3(t,e,n,s){const r=function(i,o){let a;return a=typeof i=="string"?new TextEncoder().encode(i):i,function(c,l){return new e3(c,l)}(function(c,l){if(c instanceof Uint8Array)return WT(c,l);if(c instanceof ArrayBuffer)return WT(new Uint8Array(c),l);if(c instanceof ReadableStream)return c.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(a),o)}(n,eh(e));t.asyncQueue.enqueueAndForget(async()=>{XQ(await Rw(t),r,s)})}function h3(t,e){return t.asyncQueue.enqueue(async()=>function(n,s){const r=q(n);return r.persistence.runTransaction("Get named query","readonly",i=>r.Ds.getNamedQuery(i,s))}(await kw(t),e))}const GT=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nw(t,e,n){if(!n)throw new k(w.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function dx(t,e,n,s){if(e===!0&&s===!0)throw new k(w.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function zT(t){if(!$.isDocumentKey(t))throw new k(w.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function QT(t){if($.isDocumentKey(t))throw new k(w.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function Op(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(n){return n.constructor?n.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":Q()}function Ce(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new k(w.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=Op(t);throw new k(w.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}function fx(t,e){if(e<=0)throw new k(w.INVALID_ARGUMENT,`Function ${t}() requires a positive number, but it was: ${e}.`)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YT{constructor(e){var n;if(e.host===void 0){if(e.ssl!==void 0)throw new k(w.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(n=e.ssl)===null||n===void 0||n;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new k(w.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.useFetchStreams=!!e.useFetchStreams,dx("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling)}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nh{constructor(e,n,s){this._authCredentials=n,this._appCheckCredentials=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new YT({}),this._settingsFrozen=!1,e instanceof yr?this._databaseId=e:(this._app=e,this._databaseId=function(r){if(!Object.prototype.hasOwnProperty.apply(r.options,["projectId"]))throw new k(w.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new yr(r.options.projectId)}(e))}get app(){if(!this._app)throw new k(w.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!==void 0}_setSettings(e){if(this._settingsFrozen)throw new k(w.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new YT(e),e.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new d6;switch(n.type){case"gapi":const s=n.client;return ae(!(typeof s!="object"||s===null||!s.auth||!s.auth.getAuthHeaderValueForFirstParty)),new m6(s,n.sessionIndex||"0",n.iamToken||null);case"provider":return n.client;default:throw new k(w.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const n=GT.get(e);n&&(P("ComponentProvider","Removing Datastore"),GT.delete(e),n.terminate())}(this),Promise.resolve()}}function d3(t,e,n,s={}){var r;const i=(t=Ce(t,nh))._getSettings();if(i.host!=="firestore.googleapis.com"&&i.host!==e&&Ka("Host has been set in both settings() and useEmulator(), emulator host will be used"),t._setSettings(Object.assign(Object.assign({},i),{host:`${e}:${n}`,ssl:!1})),s.mockUserToken){let o,a;if(typeof s.mockUserToken=="string")o=s.mockUserToken,a=Tt.MOCK_USER;else{o=oy(s.mockUserToken,(r=t._app)===null||r===void 0?void 0:r.options.projectId);const c=s.mockUserToken.sub||s.mockUserToken.user_id;if(!c)throw new k(w.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");a=new Tt(c)}t._authCredentials=new f6(new xN(o,a))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class We{constructor(e,n,s){this.converter=n,this._key=s,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Ls(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new We(this.firestore,e,this._key)}}class tn{constructor(e,n,s){this.converter=n,this._query=s,this.type="query",this.firestore=e}withConverter(e){return new tn(this.firestore,e,this._query)}}class Ls extends tn{constructor(e,n,s){super(e,n,yc(s)),this._path=s,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new We(this.firestore,null,new $(e))}withConverter(e){return new Ls(this.firestore,e,this._path)}}function px(t,e,...n){if(t=N(t),Nw("collection","path",e),t instanceof nh){const s=Te.fromString(e,...n);return QT(s),new Ls(t,null,s)}{if(!(t instanceof We||t instanceof Ls))throw new k(w.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const s=t._path.child(Te.fromString(e,...n));return QT(s),new Ls(t.firestore,null,s)}}function f3(t,e){if(t=Ce(t,nh),Nw("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new k(w.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new tn(t,null,function(n){return new Er(Te.emptyPath(),n)}(e))}function ef(t,e,...n){if(t=N(t),arguments.length===1&&(e=DN.I()),Nw("doc","path",e),t instanceof nh){const s=Te.fromString(e,...n);return zT(s),new We(t,null,new $(s))}{if(!(t instanceof We||t instanceof Ls))throw new k(w.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const s=t._path.child(Te.fromString(e,...n));return zT(s),new We(t.firestore,t instanceof Ls?t.converter:null,new $(s))}}function gx(t,e){return t=N(t),e=N(e),(t instanceof We||t instanceof Ls)&&(e instanceof We||e instanceof Ls)&&t.firestore===e.firestore&&t.path===e.path&&t.converter===e.converter}function mx(t,e){return t=N(t),e=N(e),t instanceof tn&&e instanceof tn&&t.firestore===e.firestore&&Yu(t._query,e._query)&&t.converter===e.converter}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p3{constructor(){this.Mc=Promise.resolve(),this.Oc=[],this.Fc=!1,this.$c=[],this.Bc=null,this.Lc=!1,this.Uc=!1,this.qc=[],this.So=new hw(this,"async_queue_retry"),this.Kc=()=>{const n=Gh();n&&P("AsyncQueue","Visibility state changed to "+n.visibilityState),this.So.Eo()};const e=Gh();e&&typeof e.addEventListener=="function"&&e.addEventListener("visibilitychange",this.Kc)}get isShuttingDown(){return this.Fc}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.Gc(),this.Qc(e)}enterRestrictedMode(e){if(!this.Fc){this.Fc=!0,this.Uc=e||!1;const n=Gh();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.Kc)}}enqueue(e){if(this.Gc(),this.Fc)return new Promise(()=>{});const n=new kt;return this.Qc(()=>this.Fc&&this.Uc?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Oc.push(e),this.jc()))}async jc(){if(this.Oc.length!==0){try{await this.Oc[0](),this.Oc.shift(),this.So.reset()}catch(e){if(!wi(e))throw e;P("AsyncQueue","Operation failed with retryable error: "+e)}this.Oc.length>0&&this.So.Io(()=>this.jc())}}Qc(e){const n=this.Mc.then(()=>(this.Lc=!0,e().catch(s=>{this.Bc=s,this.Lc=!1;const r=function(i){let o=i.message||"";return i.stack&&(o=i.stack.includes(i.message)?i.stack:i.message+`
`+i.stack),o}(s);throw ct("INTERNAL UNHANDLED ERROR: ",r),s}).then(s=>(this.Lc=!1,s))));return this.Mc=n,n}enqueueAfterDelay(e,n,s){this.Gc(),this.qc.indexOf(e)>-1&&(n=0);const r=gw.createAndSchedule(this,e,n,s,i=>this.Wc(i));return this.$c.push(r),r}Gc(){this.Bc&&Q()}verifyOperationInProgress(){}async zc(){let e;do e=this.Mc,await e;while(e!==this.Mc)}Hc(e){for(const n of this.$c)if(n.timerId===e)return!0;return!1}Jc(e){return this.zc().then(()=>{this.$c.sort((n,s)=>n.targetTimeMs-s.targetTimeMs);for(const n of this.$c)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.zc()})}Yc(e){this.qc.push(e)}Wc(e){const n=this.$c.indexOf(e);this.$c.splice(n,1)}}function I_(t){return function(e,n){if(typeof e!="object"||e===null)return!1;const s=e;for(const r of n)if(r in s&&typeof s[r]=="function")return!0;return!1}(t,["next","error","complete"])}class g3{constructor(){this._progressObserver={},this._taskCompletionResolver=new kt,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,n,s){this._progressObserver={next:e,error:n,complete:s}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,n){return this._taskCompletionResolver.promise.then(e,n)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const m3=-1;class ot extends nh{constructor(e,n,s){super(e,n,s),this.type="firestore",this._queue=new p3,this._persistenceKey="name"in e?e.name:"[DEFAULT]"}_terminate(){return this._firestoreClient||_x(this),this._firestoreClient.terminate()}}function Ft(t){return t._firestoreClient||_x(t),t._firestoreClient.verifyNotTerminated(),t._firestoreClient}function _x(t){var e;const n=t._freezeSettings(),s=function(r,i,o,a){return new k6(r,i,o,a.host,a.ssl,a.experimentalForceLongPolling,a.experimentalAutoDetectLongPolling,a.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,n);t._firestoreClient=new s3(t._authCredentials,t._appCheckCredentials,t._queue,s)}function _3(t,e){vx(t=Ce(t,ot));const n=Ft(t),s=t._freezeSettings(),r=new Cw;return yx(n,r,new ix(r,s.cacheSizeBytes,e==null?void 0:e.forceOwnership))}function y3(t){vx(t=Ce(t,ot));const e=Ft(t),n=t._freezeSettings(),s=new Cw;return yx(e,s,new ZQ(s,n.cacheSizeBytes))}function yx(t,e,n){const s=new kt;return t.asyncQueue.enqueue(async()=>{try{await ox(t,n),await ax(t,e),s.resolve()}catch(r){const i=r;if(!function(o){return o.name==="FirebaseError"?o.code===w.FAILED_PRECONDITION||o.code===w.UNIMPLEMENTED:typeof DOMException<"u"&&o instanceof DOMException?o.code===22||o.code===20||o.code===11:!0}(i))throw i;Ka("Error enabling offline persistence. Falling back to persistence disabled: "+i),s.reject(i)}}).then(()=>s.promise)}function v3(t){if(t._initialized&&!t._terminated)throw new k(w.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");const e=new kt;return t._queue.enqueueAndForgetEvenWhileRestricted(async()=>{try{await async function(n){if(!hs.V())return Promise.resolve();const s=n+"main";await hs.delete(s)}(cw(t._databaseId,t._persistenceKey)),e.resolve()}catch(n){e.reject(n)}}),e.promise}function w3(t){return function(e){const n=new kt;return e.asyncQueue.enqueueAndForget(async()=>BQ(await Rw(e),n)),n.promise}(Ft(t=Ce(t,ot)))}function b3(t){return r3(Ft(t=Ce(t,ot)))}function I3(t){return i3(Ft(t=Ce(t,ot)))}function E3(t,e){const n=Ft(t=Ce(t,ot)),s=new g3;return u3(n,t._databaseId,e,s),s}function T3(t,e){return h3(Ft(t=Ce(t,ot)),e).then(n=>n?new tn(t,null,n.query):null)}function vx(t){if(t._initialized||t._terminated)throw new k(w.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fi{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new k(w.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new lt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ws{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Ws(_t.fromBase64String(e))}catch(n){throw new k(w.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new Ws(_t.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ko{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mp{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new k(w.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new k(w.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return ue(this._lat,e._lat)||ue(this._long,e._long)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const S3=/^__.*__$/;class C3{constructor(e,n,s){this.data=e,this.fieldMask=n,this.fieldTransforms=s}toMutation(e,n){return this.fieldMask!==null?new Tr(e,this.data,this.fieldMask,n,this.fieldTransforms):new vc(e,this.data,n,this.fieldTransforms)}}class wx{constructor(e,n,s){this.data=e,this.fieldMask=n,this.fieldTransforms=s}toMutation(e,n){return new Tr(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function bx(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Q()}}class Lp{constructor(e,n,s,r,i,o){this.settings=e,this.databaseId=n,this.wt=s,this.ignoreUndefinedProperties=r,i===void 0&&this.Xc(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Zc(){return this.settings.Zc}ta(e){return new Lp(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.wt,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}ea(e){var n;const s=(n=this.path)===null||n===void 0?void 0:n.child(e),r=this.ta({path:s,na:!1});return r.sa(e),r}ia(e){var n;const s=(n=this.path)===null||n===void 0?void 0:n.child(e),r=this.ta({path:s,na:!1});return r.Xc(),r}ra(e){return this.ta({path:void 0,na:!0})}oa(e){return tf(e,this.settings.methodName,this.settings.ua||!1,this.path,this.settings.ca)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}Xc(){if(this.path)for(let e=0;e<this.path.length;e++)this.sa(this.path.get(e))}sa(e){if(e.length===0)throw this.oa("Document fields must not be empty");if(bx(this.Zc)&&S3.test(e))throw this.oa('Document fields cannot begin and end with "__"')}}class A3{constructor(e,n,s){this.databaseId=e,this.ignoreUndefinedProperties=n,this.wt=s||eh(e)}aa(e,n,s,r=!1){return new Lp({Zc:e,methodName:n,ca:s,path:lt.emptyPath(),na:!1,ua:r},this.databaseId,this.wt,this.ignoreUndefinedProperties)}}function Ho(t){const e=t._freezeSettings(),n=eh(t._databaseId);return new A3(t._databaseId,!!e.ignoreUndefinedProperties,n)}function Fp(t,e,n,s,r,i={}){const o=t.aa(i.merge||i.mergeFields?2:0,e,n,r);Ow("Data must be an object, but it was:",o,s);const a=Tx(s,o);let c,l;if(i.merge)c=new Dn(o.fieldMask),l=o.fieldTransforms;else if(i.mergeFields){const u=[];for(const h of i.mergeFields){const d=E_(e,h,n);if(!o.contains(d))throw new k(w.INVALID_ARGUMENT,`Field '${d}' is specified in your field mask but missing from your input data.`);Cx(u,d)||u.push(d)}c=new Dn(u),l=o.fieldTransforms.filter(h=>c.covers(h.field))}else c=null,l=o.fieldTransforms;return new C3(new Bt(a),c,l)}class sh extends Ko{_toFieldTransform(e){if(e.Zc!==2)throw e.Zc===1?e.oa(`${this._methodName}() can only appear at the top level of your update data`):e.oa(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof sh}}function Ix(t,e,n){return new Lp({Zc:3,ca:e.settings.ca,methodName:t._methodName,na:n},e.databaseId,e.wt,e.ignoreUndefinedProperties)}class Pw extends Ko{_toFieldTransform(e){return new Ju(e.path,new Ga)}isEqual(e){return e instanceof Pw}}class k3 extends Ko{constructor(e,n){super(e),this.ha=n}_toFieldTransform(e){const n=Ix(this,e,!0),s=this.ha.map(i=>Wo(i,n)),r=new So(s);return new Ju(e.path,r)}isEqual(e){return this===e}}class R3 extends Ko{constructor(e,n){super(e),this.ha=n}_toFieldTransform(e){const n=Ix(this,e,!0),s=this.ha.map(i=>Wo(i,n)),r=new Co(s);return new Ju(e.path,r)}isEqual(e){return this===e}}class N3 extends Ko{constructor(e,n){super(e),this.la=n}_toFieldTransform(e){const n=new za(e.wt,XN(e.wt,this.la));return new Ju(e.path,n)}isEqual(e){return this===e}}function xw(t,e,n,s){const r=t.aa(1,e,n);Ow("Data must be an object, but it was:",r,s);const i=[],o=Bt.empty();qo(s,(c,l)=>{const u=Mw(e,c,n);l=N(l);const h=r.ia(u);if(l instanceof sh)i.push(u);else{const d=Wo(l,h);d!=null&&(i.push(u),o.set(u,d))}});const a=new Dn(i);return new wx(o,a,r.fieldTransforms)}function Dw(t,e,n,s,r,i){const o=t.aa(1,e,n),a=[E_(e,s,n)],c=[r];if(i.length%2!=0)throw new k(w.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let d=0;d<i.length;d+=2)a.push(E_(e,i[d])),c.push(i[d+1]);const l=[],u=Bt.empty();for(let d=a.length-1;d>=0;--d)if(!Cx(l,a[d])){const f=a[d];let p=c[d];p=N(p);const _=o.ia(f);if(p instanceof sh)l.push(f);else{const y=Wo(p,_);y!=null&&(l.push(f),u.set(f,y))}}const h=new Dn(l);return new wx(u,h,o.fieldTransforms)}function Ex(t,e,n,s=!1){return Wo(n,t.aa(s?4:3,e))}function Wo(t,e){if(Sx(t=N(t)))return Ow("Unsupported field value:",e,t),Tx(t,e);if(t instanceof Ko)return function(n,s){if(!bx(s.Zc))throw s.oa(`${n._methodName}() can only be used with update() and set()`);if(!s.path)throw s.oa(`${n._methodName}() is not currently supported inside arrays`);const r=n._toFieldTransform(s);r&&s.fieldTransforms.push(r)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.na&&e.Zc!==4)throw e.oa("Nested arrays are not supported");return function(n,s){const r=[];let i=0;for(const o of n){let a=Wo(o,s.ra(i));a==null&&(a={nullValue:"NULL_VALUE"}),r.push(a),i++}return{arrayValue:{values:r}}}(t,e)}return function(n,s){if((n=N(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return XN(s.wt,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const r=Ye.fromDate(n);return{timestampValue:lu(s.wt,r)}}if(n instanceof Ye){const r=new Ye(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:lu(s.wt,r)}}if(n instanceof Mp)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof Ws)return{bytesValue:dP(s.wt,n._byteString)};if(n instanceof We){const r=s.databaseId,i=n.firestore._databaseId;if(!i.isEqual(r))throw s.oa(`Document reference is for database ${i.projectId}/${i.database} but should be for database ${r.projectId}/${r.database}`);return{referenceValue:ew(n.firestore._databaseId||s.databaseId,n._key.path)}}throw s.oa(`Unsupported field value: ${Op(n)}`)}(t,e)}function Tx(t,e){const n={};return VN(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):qo(t,(s,r)=>{const i=Wo(r,e.ea(s));i!=null&&(n[s]=i)}),{mapValue:{fields:n}}}function Sx(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof Ye||t instanceof Mp||t instanceof Ws||t instanceof We||t instanceof Ko)}function Ow(t,e,n){if(!Sx(n)||!function(s){return typeof s=="object"&&s!==null&&(Object.getPrototypeOf(s)===Object.prototype||Object.getPrototypeOf(s)===null)}(n)){const s=Op(n);throw s==="an object"?e.oa(t+" a custom object"):e.oa(t+" "+s)}}function E_(t,e,n){if((e=N(e))instanceof fi)return e._internalPath;if(typeof e=="string")return Mw(t,e);throw tf("Field path arguments must be of type string or ",t,!1,void 0,n)}const P3=new RegExp("[~\\*/\\[\\]]");function Mw(t,e,n){if(e.search(P3)>=0)throw tf(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new fi(...e.split("."))._internalPath}catch{throw tf(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function tf(t,e,n,s,r){const i=s&&!s.isEmpty(),o=r!==void 0;let a=`Function ${e}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(i||o)&&(c+=" (found",i&&(c+=` in field ${s}`),o&&(c+=` in document ${r}`),c+=")"),new k(w.INVALID_ARGUMENT,a+t+c)}function Cx(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pu{constructor(e,n,s,r,i){this._firestore=e,this._userDataWriter=n,this._key=s,this._document=r,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new We(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new x3(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(Up("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class x3 extends pu{data(){return super.data()}}function Up(t,e){return typeof e=="string"?Mw(t,e):e instanceof fi?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yi{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class vr extends pu{constructor(e,n,s,r,i,o){super(e,n,s,r,o),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new vl(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const s=this._document.data.field(Up("DocumentSnapshot.get",e));if(s!==null)return this._userDataWriter.convertValue(s,n.serverTimestamps)}}}class vl extends vr{data(e={}){return super.data(e)}}class pi{constructor(e,n,s,r){this._firestore=e,this._userDataWriter=n,this._snapshot=r,this.metadata=new Yi(r.hasPendingWrites,r.fromCache),this.query=s}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(s=>{e.call(n,new vl(this._firestore,this._userDataWriter,s.key,s,new Yi(this._snapshot.mutatedKeys.has(s.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new k(w.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(s,r){if(s._snapshot.oldDocs.isEmpty()){let i=0;return s._snapshot.docChanges.map(o=>({type:"added",doc:new vl(s._firestore,s._userDataWriter,o.doc.key,o.doc,new Yi(s._snapshot.mutatedKeys.has(o.doc.key),s._snapshot.fromCache),s.query.converter),oldIndex:-1,newIndex:i++}))}{let i=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(o=>r||o.type!==3).map(o=>{const a=new vl(s._firestore,s._userDataWriter,o.doc.key,o.doc,new Yi(s._snapshot.mutatedKeys.has(o.doc.key),s._snapshot.fromCache),s.query.converter);let c=-1,l=-1;return o.type!==0&&(c=i.indexOf(o.doc.key),i=i.delete(o.doc.key)),o.type!==1&&(i=i.add(o.doc),l=i.indexOf(o.doc.key)),{type:D3(o.type),doc:a,oldIndex:c,newIndex:l}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}}function D3(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Q()}}function Ax(t,e){return t instanceof vr&&e instanceof vr?t._firestore===e._firestore&&t._key.isEqual(e._key)&&(t._document===null?e._document===null:t._document.isEqual(e._document))&&t._converter===e._converter:t instanceof pi&&e instanceof pi&&t._firestore===e._firestore&&mx(t.query,e.query)&&t.metadata.isEqual(e.metadata)&&t._snapshot.isEqual(e._snapshot)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kx(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new k(w.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class rh{}function Or(t,...e){for(const n of e)t=n._apply(t);return t}class O3 extends rh{constructor(e,n,s){super(),this.fa=e,this.da=n,this._a=s,this.type="where"}_apply(e){const n=Ho(e.firestore),s=function(r,i,o,a,c,l,u){let h;if(c.isKeyField()){if(l==="array-contains"||l==="array-contains-any")throw new k(w.INVALID_ARGUMENT,`Invalid Query. You can't perform '${l}' queries on documentId().`);if(l==="in"||l==="not-in"){XT(u,l);const f=[];for(const p of u)f.push(JT(a,r,p));h={arrayValue:{values:f}}}else h=JT(a,r,u)}else l!=="in"&&l!=="not-in"&&l!=="array-contains-any"||XT(u,l),h=Ex(o,i,u,l==="in"||l==="not-in");const d=jt.create(c,l,h);return function(f,p){if(p.ht()){const y=Yv(f);if(y!==null&&!y.isEqual(p.field))throw new k(w.INVALID_ARGUMENT,`Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '${y.toString()}' and '${p.field.toString()}'`);const T=Qv(f);T!==null&&Dx(f,p.field,T)}const _=function(y,T){for(const I of y.filters)if(T.indexOf(I.op)>=0)return I.op;return null}(f,function(y){switch(y){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}(p.op));if(_!==null)throw _===p.op?new k(w.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${p.op.toString()}' filter.`):new k(w.INVALID_ARGUMENT,`Invalid query. You cannot use '${p.op.toString()}' filters with '${_.toString()}' filters.`)}(r,d),d}(e._query,"where",n,e.firestore._databaseId,this.fa,this.da,this._a);return new tn(e.firestore,e.converter,function(r,i){const o=r.filters.concat([i]);return new Er(r.path,r.collectionGroup,r.explicitOrderBy.slice(),o,r.limit,r.limitType,r.startAt,r.endAt)}(e._query,s))}}function M3(t,e,n){const s=e,r=Up("where",t);return new O3(r,s,n)}class L3 extends rh{constructor(e,n){super(),this.fa=e,this.wa=n,this.type="orderBy"}_apply(e){const n=function(s,r,i){if(s.startAt!==null)throw new k(w.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(s.endAt!==null)throw new k(w.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");const o=new Ta(r,i);return function(a,c){if(Qv(a)===null){const l=Yv(a);l!==null&&Dx(a,l,c.field)}}(s,o),o}(e._query,this.fa,this.wa);return new tn(e.firestore,e.converter,function(s,r){const i=s.explicitOrderBy.concat([r]);return new Er(s.path,s.collectionGroup,i,s.filters.slice(),s.limit,s.limitType,s.startAt,s.endAt)}(e._query,n))}}function F3(t,e="asc"){const n=e,s=Up("orderBy",t);return new L3(s,n)}class Rx extends rh{constructor(e,n,s){super(),this.type=e,this.ma=n,this.ga=s}_apply(e){return new tn(e.firestore,e.converter,Gd(e._query,this.ma,this.ga))}}function U3(t){return fx("limit",t),new Rx("limit",t,"F")}function $3(t){return fx("limitToLast",t),new Rx("limitToLast",t,"L")}class Nx extends rh{constructor(e,n,s){super(),this.type=e,this.ya=n,this.pa=s}_apply(e){const n=xx(e,this.type,this.ya,this.pa);return new tn(e.firestore,e.converter,function(s,r){return new Er(s.path,s.collectionGroup,s.explicitOrderBy.slice(),s.filters.slice(),s.limit,s.limitType,r,s.endAt)}(e._query,n))}}function V3(...t){return new Nx("startAt",t,!0)}function B3(...t){return new Nx("startAfter",t,!1)}class Px extends rh{constructor(e,n,s){super(),this.type=e,this.ya=n,this.pa=s}_apply(e){const n=xx(e,this.type,this.ya,this.pa);return new tn(e.firestore,e.converter,function(s,r){return new Er(s.path,s.collectionGroup,s.explicitOrderBy.slice(),s.filters.slice(),s.limit,s.limitType,s.startAt,r)}(e._query,n))}}function j3(...t){return new Px("endBefore",t,!1)}function q3(...t){return new Px("endAt",t,!0)}function xx(t,e,n,s){if(n[0]=N(n[0]),n[0]instanceof pu)return function(r,i,o,a,c){if(!a)throw new k(w.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${o}().`);const l=[];for(const u of Wa(r))if(u.field.isKeyField())l.push(Eo(i,a.key));else{const h=a.data.field(u.field);if(zv(h))throw new k(w.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+u.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(h===null){const d=u.field.canonicalString();throw new k(w.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${d}' (used as the orderBy) does not exist.`)}l.push(h)}return new hi(l,c)}(t._query,t.firestore._databaseId,e,n[0]._document,s);{const r=Ho(t.firestore);return function(i,o,a,c,l,u){const h=i.explicitOrderBy;if(l.length>h.length)throw new k(w.INVALID_ARGUMENT,`Too many arguments provided to ${c}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const d=[];for(let f=0;f<l.length;f++){const p=l[f];if(h[f].field.isKeyField()){if(typeof p!="string")throw new k(w.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${c}(), but got a ${typeof p}`);if(!Jv(i)&&p.indexOf("/")!==-1)throw new k(w.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${c}() must be a plain document ID, but '${p}' contains a slash.`);const _=i.path.child(Te.fromString(p));if(!$.isDocumentKey(_))throw new k(w.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${c}() must result in a valid document path, but '${_}' is not because it contains an odd number of segments.`);const y=new $(_);d.push(Eo(o,y))}else{const _=Ex(a,c,p);d.push(_)}}return new hi(d,u)}(t._query,t.firestore._databaseId,r,e,n,s)}}function JT(t,e,n){if(typeof(n=N(n))=="string"){if(n==="")throw new k(w.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Jv(e)&&n.indexOf("/")!==-1)throw new k(w.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const s=e.path.child(Te.fromString(n));if(!$.isDocumentKey(s))throw new k(w.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${s}' is not because it has an odd number of segments (${s.length}).`);return Eo(t,new $(s))}if(n instanceof We)return Eo(t,n._key);throw new k(w.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Op(n)}.`)}function XT(t,e){if(!Array.isArray(t)||t.length===0)throw new k(w.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`);if(t.length>10)throw new k(w.INVALID_ARGUMENT,`Invalid Query. '${e.toString()}' filters support a maximum of 10 elements in the value array.`)}function Dx(t,e,n){if(!n.isEqual(e))throw new k(w.INVALID_ARGUMENT,`Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '${e.toString()}' and so you must also use '${e.toString()}' as your first argument to orderBy(), but your first orderBy() is on field '${n.toString()}' instead.`)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const K3={maxAttempts:5};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lw{convertValue(e,n="none"){switch(Io(e)){case 0:return null;case 1:return e.booleanValue;case 2:return tt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(bo(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 10:return this.convertObject(e.mapValue,n);default:throw Q()}}convertObject(e,n){const s={};return qo(e.fields,(r,i)=>{s[r]=this.convertValue(i,n)}),s}convertGeoPoint(e){return new Mp(tt(e.latitude),tt(e.longitude))}convertArray(e,n){return(e.values||[]).map(s=>this.convertValue(s,n))}convertServerTimestamp(e,n){switch(n){case"previous":const s=BN(e);return s==null?null:this.convertValue(s,n);case"estimate":return this.convertTimestamp(iu(e));default:return null}}convertTimestamp(e){const n=li(e);return new Ye(n.seconds,n.nanos)}convertDocumentKey(e,n){const s=Te.fromString(e);ae(bP(s));const r=new yr(s.get(1),s.get(3)),i=new $(s.popFirst(5));return r.isEqual(n)||ct(`Document ${i} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $p(t,e,n){let s;return s=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,s}class H3 extends Lw{constructor(e){super(),this.firestore=e}convertBytes(e){return new Ws(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new We(this.firestore,null,n)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W3{constructor(e,n){this._firestore=e,this._commitHandler=n,this._mutations=[],this._committed=!1,this._dataReader=Ho(e)}set(e,n,s){this._verifyNotCommitted();const r=Br(e,this._firestore),i=$p(r.converter,n,s),o=Fp(this._dataReader,"WriteBatch.set",r._key,i,r.converter!==null,s);return this._mutations.push(o.toMutation(r._key,Ze.none())),this}update(e,n,s,...r){this._verifyNotCommitted();const i=Br(e,this._firestore);let o;return o=typeof(n=N(n))=="string"||n instanceof fi?Dw(this._dataReader,"WriteBatch.update",i._key,n,s,r):xw(this._dataReader,"WriteBatch.update",i._key,n),this._mutations.push(o.toMutation(i._key,Ze.exists(!0))),this}delete(e){this._verifyNotCommitted();const n=Br(e,this._firestore);return this._mutations=this._mutations.concat(new wc(n._key,Ze.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new k(w.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function Br(t,e){if((t=N(t)).firestore!==e)throw new k(w.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function G3(t){t=Ce(t,We);const e=Ce(t.firestore,ot);return ux(Ft(e),t._key).then(n=>Fw(e,t,n))}class Go extends Lw{constructor(e){super(),this.firestore=e}convertBytes(e){return new Ws(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new We(this.firestore,null,n)}}function z3(t){t=Ce(t,We);const e=Ce(t.firestore,ot),n=Ft(e),s=new Go(e);return o3(n,t._key).then(r=>new vr(e,s,t._key,r,new Yi(r!==null&&r.hasLocalMutations,!0),t.converter))}function Q3(t){t=Ce(t,We);const e=Ce(t.firestore,ot);return ux(Ft(e),t._key,{source:"server"}).then(n=>Fw(e,t,n))}function Y3(t){t=Ce(t,tn);const e=Ce(t.firestore,ot),n=Ft(e),s=new Go(e);return kx(t._query),hx(n,t._query).then(r=>new pi(e,s,t,r))}function J3(t){t=Ce(t,tn);const e=Ce(t.firestore,ot),n=Ft(e),s=new Go(e);return a3(n,t._query).then(r=>new pi(e,s,t,r))}function X3(t){t=Ce(t,tn);const e=Ce(t.firestore,ot),n=Ft(e),s=new Go(e);return hx(n,t._query,{source:"server"}).then(r=>new pi(e,s,t,r))}function ZT(t,e,n){t=Ce(t,We);const s=Ce(t.firestore,ot),r=$p(t.converter,e,n);return ih(s,[Fp(Ho(s),"setDoc",t._key,r,t.converter!==null,n).toMutation(t._key,Ze.none())])}function eS(t,e,n,...s){t=Ce(t,We);const r=Ce(t.firestore,ot),i=Ho(r);let o;return o=typeof(e=N(e))=="string"||e instanceof fi?Dw(i,"updateDoc",t._key,e,n,s):xw(i,"updateDoc",t._key,e),ih(r,[o.toMutation(t._key,Ze.exists(!0))])}function Z3(t){return ih(Ce(t.firestore,ot),[new wc(t._key,Ze.none())])}function eY(t,e){const n=Ce(t.firestore,ot),s=ef(t),r=$p(t.converter,e);return ih(n,[Fp(Ho(t.firestore),"addDoc",s._key,r,t.converter!==null,{}).toMutation(s._key,Ze.exists(!1))]).then(()=>s)}function Ox(t,...e){var n,s,r;t=N(t);let i={includeMetadataChanges:!1},o=0;typeof e[o]!="object"||I_(e[o])||(i=e[o],o++);const a={includeMetadataChanges:i.includeMetadataChanges};if(I_(e[o])){const h=e[o];e[o]=(n=h.next)===null||n===void 0?void 0:n.bind(h),e[o+1]=(s=h.error)===null||s===void 0?void 0:s.bind(h),e[o+2]=(r=h.complete)===null||r===void 0?void 0:r.bind(h)}let c,l,u;if(t instanceof We)l=Ce(t.firestore,ot),u=yc(t._key.path),c={next:h=>{e[o]&&e[o](Fw(l,t,h))},error:e[o+1],complete:e[o+2]};else{const h=Ce(t,tn);l=Ce(h.firestore,ot),u=h._query;const d=new Go(l);c={next:f=>{e[o]&&e[o](new pi(l,d,h,f))},error:e[o+1],complete:e[o+2]},kx(t._query)}return function(h,d,f,p){const _=new xp(p),y=new vw(d,_,f);return h.asyncQueue.enqueueAndForget(async()=>mw(await Za(h),y)),()=>{_.Tc(),h.asyncQueue.enqueueAndForget(async()=>_w(await Za(h),y))}}(Ft(l),u,a,c)}function tY(t,e){return c3(Ft(t=Ce(t,ot)),I_(e)?e:{next:e})}function ih(t,e){return function(n,s){const r=new kt;return n.asyncQueue.enqueueAndForget(async()=>FQ(await Rw(n),s,r)),r.promise}(Ft(t),e)}function Fw(t,e,n){const s=n.docs.get(e._key),r=new Go(t);return new vr(t,r,e._key,s,new Yi(n.hasPendingWrites,n.fromCache),e.converter)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nY extends class{constructor(e,n){this._firestore=e,this._transaction=n,this._dataReader=Ho(e)}get(e){const n=Br(e,this._firestore),s=new H3(this._firestore);return this._transaction.lookup([n._key]).then(r=>{if(!r||r.length!==1)return Q();const i=r[0];if(i.isFoundDocument())return new pu(this._firestore,s,i.key,i,n.converter);if(i.isNoDocument())return new pu(this._firestore,s,n._key,null,n.converter);throw Q()})}set(e,n,s){const r=Br(e,this._firestore),i=$p(r.converter,n,s),o=Fp(this._dataReader,"Transaction.set",r._key,i,r.converter!==null,s);return this._transaction.set(r._key,o),this}update(e,n,s,...r){const i=Br(e,this._firestore);let o;return o=typeof(n=N(n))=="string"||n instanceof fi?Dw(this._dataReader,"Transaction.update",i._key,n,s,r):xw(this._dataReader,"Transaction.update",i._key,n),this._transaction.update(i._key,o),this}delete(e){const n=Br(e,this._firestore);return this._transaction.delete(n._key),this}}{constructor(e,n){super(e,n),this._firestore=e}get(e){const n=Br(e,this._firestore),s=new Go(this._firestore);return super.get(e).then(r=>new vr(this._firestore,s,n._key,r._document,new Yi(!1,!1),n.converter))}}function sY(t,e,n){t=Ce(t,ot);const s=Object.assign(Object.assign({},K3),n);return function(r){if(r.maxAttempts<1)throw new k(w.INVALID_ARGUMENT,"Max attempts must be at least 1")}(s),l3(Ft(t),r=>e(new nY(t,r)),s)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rY(){return new sh("deleteField")}function iY(){return new Pw("serverTimestamp")}function oY(...t){return new k3("arrayUnion",t)}function aY(...t){return new R3("arrayRemove",t)}function cY(t){return new N3("increment",t)}(function(t,e=!0){(function(n){_c=n})(Ys),rt(new Ae("firestore",(n,{options:s})=>{const r=n.getProvider("app").getImmediate(),i=new ot(r,new p6(n.getProvider("auth-internal")),new y6(n.getProvider("app-check-internal")));return s=Object.assign({useFetchStreams:e},s),i._setSettings(s),i},"PUBLIC")),$e(JE,"3.4.14",t),$e(JE,"3.4.14","esm2017")})();const lY="@firebase/firestore-compat",uY="0.1.23";/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Uw(t,e){if(e===void 0)return{merge:!1};if(e.mergeFields!==void 0&&e.merge!==void 0)throw new k("invalid-argument",`Invalid options passed to function ${t}(): You cannot specify both "merge" and "mergeFields".`);return e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tS(){if(typeof Uint8Array>"u")throw new k("unimplemented","Uint8Arrays are not available in this environment.")}function nS(){if(!C6())throw new k("unimplemented","Blobs are unavailable in Firestore in this environment.")}class gu{constructor(e){this._delegate=e}static fromBase64String(e){return nS(),new gu(Ws.fromBase64String(e))}static fromUint8Array(e){return tS(),new gu(Ws.fromUint8Array(e))}toBase64(){return nS(),this._delegate.toBase64()}toUint8Array(){return tS(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function T_(t){return hY(t,["next","error","complete"])}function hY(t,e){if(typeof t!="object"||t===null)return!1;const n=t;for(const s of e)if(s in n&&typeof n[s]=="function")return!0;return!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dY{enableIndexedDbPersistence(e,n){return _3(e._delegate,{forceOwnership:n})}enableMultiTabIndexedDbPersistence(e){return y3(e._delegate)}clearIndexedDbPersistence(e){return v3(e._delegate)}}class Mx{constructor(e,n,s){this._delegate=n,this._persistenceProvider=s,this.INTERNAL={delete:()=>this.terminate()},e instanceof yr||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){const n=this._delegate._getSettings();!e.merge&&n.host!==e.host&&Ka("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&(e=Object.assign(Object.assign({},n),e),delete e.merge),this._delegate._setSettings(e)}useEmulator(e,n,s={}){d3(this._delegate,e,n,s)}enableNetwork(){return b3(this._delegate)}disableNetwork(){return I3(this._delegate)}enablePersistence(e){let n=!1,s=!1;return e&&(n=!!e.synchronizeTabs,s=!!e.experimentalForceOwningTab,dx("synchronizeTabs",n,"experimentalForceOwningTab",s)),n?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,s)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return w3(this._delegate)}onSnapshotsInSync(e){return tY(this._delegate,e)}get app(){if(!this._appCompat)throw new k("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new ec(this,px(this._delegate,e))}catch(n){throw on(n,"collection()","Firestore.collection()")}}doc(e){try{return new Wn(this,ef(this._delegate,e))}catch(n){throw on(n,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new rn(this,f3(this._delegate,e))}catch(n){throw on(n,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return sY(this._delegate,n=>e(new Lx(this,n)))}batch(){return Ft(this._delegate),new Fx(new W3(this._delegate,e=>ih(this._delegate,e)))}loadBundle(e){return E3(this._delegate,e)}namedQuery(e){return T3(this._delegate,e).then(n=>n?new rn(this,n):null)}}class Vp extends Lw{constructor(e){super(),this.firestore=e}convertBytes(e){return new gu(new Ws(e))}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return Wn.forKey(n,this.firestore,null)}}function fY(t){u6(t)}class Lx{constructor(e,n){this._firestore=e,this._delegate=n,this._userDataWriter=new Vp(e)}get(e){const n=Ji(e);return this._delegate.get(n).then(s=>new mu(this._firestore,new vr(this._firestore._delegate,this._userDataWriter,s._key,s._document,s.metadata,n.converter)))}set(e,n,s){const r=Ji(e);return s?(Uw("Transaction.set",s),this._delegate.set(r,n,s)):this._delegate.set(r,n),this}update(e,n,s,...r){const i=Ji(e);return arguments.length===2?this._delegate.update(i,n):this._delegate.update(i,n,s,...r),this}delete(e){const n=Ji(e);return this._delegate.delete(n),this}}class Fx{constructor(e){this._delegate=e}set(e,n,s){const r=Ji(e);return s?(Uw("WriteBatch.set",s),this._delegate.set(r,n,s)):this._delegate.set(r,n),this}update(e,n,s,...r){const i=Ji(e);return arguments.length===2?this._delegate.update(i,n):this._delegate.update(i,n,s,...r),this}delete(e){const n=Ji(e);return this._delegate.delete(n),this}commit(){return this._delegate.commit()}}class No{constructor(e,n,s){this._firestore=e,this._userDataWriter=n,this._delegate=s}fromFirestore(e,n){const s=new vl(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new _u(this._firestore,s),n!=null?n:{})}toFirestore(e,n){return n?this._delegate.toFirestore(e,n):this._delegate.toFirestore(e)}static getInstance(e,n){const s=No.INSTANCES;let r=s.get(e);r||(r=new WeakMap,s.set(e,r));let i=r.get(n);return i||(i=new No(e,new Vp(e),n),r.set(n,i)),i}}No.INSTANCES=new WeakMap;class Wn{constructor(e,n){this.firestore=e,this._delegate=n,this._userDataWriter=new Vp(e)}static forPath(e,n,s){if(e.length%2!==0)throw new k("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new Wn(n,new We(n._delegate,s,new $(e)))}static forKey(e,n,s){return new Wn(n,new We(n._delegate,s,e))}get id(){return this._delegate.id}get parent(){return new ec(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new ec(this.firestore,px(this._delegate,e))}catch(n){throw on(n,"collection()","DocumentReference.collection()")}}isEqual(e){return e=N(e),e instanceof We?gx(this._delegate,e):!1}set(e,n){n=Uw("DocumentReference.set",n);try{return n?ZT(this._delegate,e,n):ZT(this._delegate,e)}catch(s){throw on(s,"setDoc()","DocumentReference.set()")}}update(e,n,...s){try{return arguments.length===1?eS(this._delegate,e):eS(this._delegate,e,n,...s)}catch(r){throw on(r,"updateDoc()","DocumentReference.update()")}}delete(){return Z3(this._delegate)}onSnapshot(...e){const n=Ux(e),s=$x(e,r=>new mu(this.firestore,new vr(this.firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,this._delegate.converter)));return Ox(this._delegate,n,s)}get(e){let n;return(e==null?void 0:e.source)==="cache"?n=z3(this._delegate):(e==null?void 0:e.source)==="server"?n=Q3(this._delegate):n=G3(this._delegate),n.then(s=>new mu(this.firestore,new vr(this.firestore._delegate,this._userDataWriter,s._key,s._document,s.metadata,this._delegate.converter)))}withConverter(e){return new Wn(this.firestore,e?this._delegate.withConverter(No.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}function on(t,e,n){return t.message=t.message.replace(e,n),t}function Ux(t){for(const e of t)if(typeof e=="object"&&!T_(e))return e;return{}}function $x(t,e){var n,s;let r;return T_(t[0])?r=t[0]:T_(t[1])?r=t[1]:typeof t[0]=="function"?r={next:t[0],error:t[1],complete:t[2]}:r={next:t[1],error:t[2],complete:t[3]},{next:i=>{r.next&&r.next(e(i))},error:(n=r.error)===null||n===void 0?void 0:n.bind(r),complete:(s=r.complete)===null||s===void 0?void 0:s.bind(r)}}class mu{constructor(e,n){this._firestore=e,this._delegate=n}get ref(){return new Wn(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,n){return this._delegate.get(e,n)}isEqual(e){return Ax(this._delegate,e._delegate)}}class _u extends mu{data(e){const n=this._delegate.data(e);return h6(n!==void 0),n}}class rn{constructor(e,n){this.firestore=e,this._delegate=n,this._userDataWriter=new Vp(e)}where(e,n,s){try{return new rn(this.firestore,Or(this._delegate,M3(e,n,s)))}catch(r){throw on(r,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,n){try{return new rn(this.firestore,Or(this._delegate,F3(e,n)))}catch(s){throw on(s,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new rn(this.firestore,Or(this._delegate,U3(e)))}catch(n){throw on(n,"limit()","Query.limit()")}}limitToLast(e){try{return new rn(this.firestore,Or(this._delegate,$3(e)))}catch(n){throw on(n,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new rn(this.firestore,Or(this._delegate,V3(...e)))}catch(n){throw on(n,"startAt()","Query.startAt()")}}startAfter(...e){try{return new rn(this.firestore,Or(this._delegate,B3(...e)))}catch(n){throw on(n,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new rn(this.firestore,Or(this._delegate,j3(...e)))}catch(n){throw on(n,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new rn(this.firestore,Or(this._delegate,q3(...e)))}catch(n){throw on(n,"endAt()","Query.endAt()")}}isEqual(e){return mx(this._delegate,e._delegate)}get(e){let n;return(e==null?void 0:e.source)==="cache"?n=J3(this._delegate):(e==null?void 0:e.source)==="server"?n=X3(this._delegate):n=Y3(this._delegate),n.then(s=>new S_(this.firestore,new pi(this.firestore._delegate,this._userDataWriter,this._delegate,s._snapshot)))}onSnapshot(...e){const n=Ux(e),s=$x(e,r=>new S_(this.firestore,new pi(this.firestore._delegate,this._userDataWriter,this._delegate,r._snapshot)));return Ox(this._delegate,n,s)}withConverter(e){return new rn(this.firestore,e?this._delegate.withConverter(No.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}class pY{constructor(e,n){this._firestore=e,this._delegate=n}get type(){return this._delegate.type}get doc(){return new _u(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}}class S_{constructor(e,n){this._firestore=e,this._delegate=n}get query(){return new rn(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(e=>new _u(this._firestore,e))}docChanges(e){return this._delegate.docChanges(e).map(n=>new pY(this._firestore,n))}forEach(e,n){this._delegate.forEach(s=>{e.call(n,new _u(this._firestore,s))})}isEqual(e){return Ax(this._delegate,e._delegate)}}class ec extends rn{constructor(e,n){super(e,n),this.firestore=e,this._delegate=n}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){const e=this._delegate.parent;return e?new Wn(this.firestore,e):null}doc(e){try{return e===void 0?new Wn(this.firestore,ef(this._delegate)):new Wn(this.firestore,ef(this._delegate,e))}catch(n){throw on(n,"doc()","CollectionReference.doc()")}}add(e){return eY(this._delegate,e).then(n=>new Wn(this.firestore,n))}isEqual(e){return gx(this._delegate,e._delegate)}withConverter(e){return new ec(this.firestore,e?this._delegate.withConverter(No.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}function Ji(t){return Ce(t,We)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $w{constructor(...e){this._delegate=new fi(...e)}static documentId(){return new $w(lt.keyField().canonicalString())}isEqual(e){return e=N(e),e instanceof fi?this._delegate._internalPath.isEqual(e._internalPath):!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ji{constructor(e){this._delegate=e}static serverTimestamp(){const e=iY();return e._methodName="FieldValue.serverTimestamp",new ji(e)}static delete(){const e=rY();return e._methodName="FieldValue.delete",new ji(e)}static arrayUnion(...e){const n=oY(...e);return n._methodName="FieldValue.arrayUnion",new ji(n)}static arrayRemove(...e){const n=aY(...e);return n._methodName="FieldValue.arrayRemove",new ji(n)}static increment(e){const n=cY(e);return n._methodName="FieldValue.increment",new ji(n)}isEqual(e){return this._delegate.isEqual(e._delegate)}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gY={Firestore:Mx,GeoPoint:Mp,Timestamp:Ye,Blob:gu,Transaction:Lx,WriteBatch:Fx,DocumentReference:Wn,DocumentSnapshot:mu,Query:rn,QueryDocumentSnapshot:_u,QuerySnapshot:S_,CollectionReference:ec,FieldPath:$w,FieldValue:ji,setLogLevel:fY,CACHE_SIZE_UNLIMITED:m3};function mY(t,e){t.INTERNAL.registerComponent(new Ae("firestore-compat",n=>{const s=n.getProvider("app-compat").getImmediate(),r=n.getProvider("firestore").getImmediate();return e(s,r)},"PUBLIC").setServiceProps(Object.assign({},gY)))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _Y(t){mY(t,(e,n)=>new Mx(e,n,new dY)),t.registerVersion(lY,uY)}_Y(ut);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yY="type.googleapis.com/google.protobuf.Int64Value",vY="type.googleapis.com/google.protobuf.UInt64Value";function Vx(t,e){const n={};for(const s in t)t.hasOwnProperty(s)&&(n[s]=e(t[s]));return n}function C_(t){if(t==null)return null;if(t instanceof Number&&(t=t.valueOf()),typeof t=="number"&&isFinite(t)||t===!0||t===!1||Object.prototype.toString.call(t)==="[object String]")return t;if(t instanceof Date)return t.toISOString();if(Array.isArray(t))return t.map(e=>C_(e));if(typeof t=="function"||typeof t=="object")return Vx(t,e=>C_(e));throw new Error("Data cannot be encoded in JSON: "+t)}function nf(t){if(t==null)return t;if(t["@type"])switch(t["@type"]){case yY:case vY:{const e=Number(t.value);if(isNaN(e))throw new Error("Data cannot be decoded from JSON: "+t);return e}default:throw new Error("Data cannot be decoded from JSON: "+t)}return Array.isArray(t)?t.map(e=>nf(e)):typeof t=="function"||typeof t=="object"?Vx(t,e=>nf(e)):t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bx="functions";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sS={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Ca extends et{constructor(e,n,s){super(`${Bx}/${e}`,n||""),this.details=s}}function wY(t){if(t>=200&&t<300)return"ok";switch(t){case 0:return"internal";case 400:return"invalid-argument";case 401:return"unauthenticated";case 403:return"permission-denied";case 404:return"not-found";case 409:return"aborted";case 429:return"resource-exhausted";case 499:return"cancelled";case 500:return"internal";case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline-exceeded"}return"unknown"}function bY(t,e){let n=wY(t),s=n,r;try{const i=e&&e.error;if(i){const o=i.status;if(typeof o=="string"){if(!sS[o])return new Ca("internal","internal");n=sS[o],s=o}const a=i.message;typeof a=="string"&&(s=a),r=i.details,r!==void 0&&(r=nf(r))}}catch{}return n==="ok"?null:new Ca(n,s,r)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IY{constructor(e,n,s){this.auth=null,this.messaging=null,this.appCheck=null,this.auth=e.getImmediate({optional:!0}),this.messaging=n.getImmediate({optional:!0}),this.auth||e.get().then(r=>this.auth=r,()=>{}),this.messaging||n.get().then(r=>this.messaging=r,()=>{}),this.appCheck||s.get().then(r=>this.appCheck=r,()=>{})}async getAuthToken(){if(!!this.auth)try{const e=await this.auth.getToken();return e==null?void 0:e.accessToken}catch{return}}async getMessagingToken(){if(!(!this.messaging||!("Notification"in self)||Notification.permission!=="granted"))try{return await this.messaging.getToken()}catch{return}}async getAppCheckToken(){if(this.appCheck){const e=await this.appCheck.getToken();return e.error?null:e.token}return null}async getContext(){const e=await this.getAuthToken(),n=await this.getMessagingToken(),s=await this.getAppCheckToken();return{authToken:e,messagingToken:n,appCheckToken:s}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rS="us-central1";function EY(t){let e=null;return{promise:new Promise((n,s)=>{e=setTimeout(()=>{s(new Ca("deadline-exceeded","deadline-exceeded"))},t)}),cancel:()=>{e&&clearTimeout(e)}}}class TY{constructor(e,n,s,r,i=rS,o){this.app=e,this.fetchImpl=o,this.emulatorOrigin=null,this.contextProvider=new IY(n,s,r),this.cancelAllRequests=new Promise(a=>{this.deleteService=()=>Promise.resolve(a())});try{const a=new URL(i);this.customDomain=a.origin,this.region=rS}catch{this.customDomain=null,this.region=i}}_delete(){return this.deleteService()}_url(e){const n=this.app.options.projectId;return this.emulatorOrigin!==null?`${this.emulatorOrigin}/${n}/${this.region}/${e}`:this.customDomain!==null?`${this.customDomain}/${e}`:`https://${this.region}-${n}.cloudfunctions.net/${e}`}}function SY(t,e,n){t.emulatorOrigin=`http://${e}:${n}`}function CY(t,e,n){return s=>RY(t,e,s,n||{})}function AY(t,e,n){return s=>jx(t,e,s,n||{})}async function kY(t,e,n,s){n["Content-Type"]="application/json";let r;try{r=await s(t,{method:"POST",body:JSON.stringify(e),headers:n})}catch{return{status:0,json:null}}let i=null;try{i=await r.json()}catch{}return{status:r.status,json:i}}function RY(t,e,n,s){const r=t._url(e);return jx(t,r,n,s)}async function jx(t,e,n,s){n=C_(n);const r={data:n},i={},o=await t.contextProvider.getContext();o.authToken&&(i.Authorization="Bearer "+o.authToken),o.messagingToken&&(i["Firebase-Instance-ID-Token"]=o.messagingToken),o.appCheckToken!==null&&(i["X-Firebase-AppCheck"]=o.appCheckToken);const a=s.timeout||7e4,c=EY(a),l=await Promise.race([kY(e,r,i,t.fetchImpl),c.promise,t.cancelAllRequests]);if(c.cancel(),!l)throw new Ca("cancelled","Firebase Functions instance was deleted.");const u=bY(l.status,l.json);if(u)throw u;if(!l.json)throw new Ca("internal","Response is not valid JSON object.");let h=l.json.data;if(typeof h>"u"&&(h=l.json.result),typeof h>"u")throw new Ca("internal","Response is missing data field.");return{data:nf(h)}}const iS="@firebase/functions",oS="0.8.4";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NY="auth-internal",PY="app-check-internal",xY="messaging-internal";function DY(t,e){const n=(s,{instanceIdentifier:r})=>{const i=s.getProvider("app").getImmediate(),o=s.getProvider(NY),a=s.getProvider(xY),c=s.getProvider(PY);return new TY(i,o,a,c,r,t)};rt(new Ae(Bx,n,"PUBLIC").setMultipleInstances(!0)),$e(iS,oS,e),$e(iS,oS,"esm2017")}function aS(t,e,n){SY(N(t),e,n)}function OY(t,e,n){return CY(N(t),e,n)}function MY(t,e,n){return AY(N(t),e,n)}DY(fetch.bind(self));const LY="@firebase/functions-compat",FY="0.2.4";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qx{constructor(e,n){this.app=e,this._delegate=n,this._region=this._delegate.region,this._customDomain=this._delegate.customDomain}httpsCallable(e,n){return OY(this._delegate,e,n)}httpsCallableFromURL(e,n){return MY(this._delegate,e,n)}useFunctionsEmulator(e){const n=e.match("[a-zA-Z]+://([a-zA-Z0-9.-]+)(?::([0-9]+))?");if(n==null)throw new et("functions","No origin provided to useFunctionsEmulator()");if(n[2]==null)throw new et("functions","Port missing in origin provided to useFunctionsEmulator()");return aS(this._delegate,n[1],Number(n[2]))}useEmulator(e,n){return aS(this._delegate,e,n)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UY="us-central1",$Y=(t,{instanceIdentifier:e})=>{const n=t.getProvider("app-compat").getImmediate(),s=t.getProvider("functions").getImmediate({identifier:e!=null?e:UY});return new qx(n,s)};function VY(){const t={Functions:qx};ut.INTERNAL.registerComponent(new Ae("functions-compat",$Y,"PUBLIC").setServiceProps(t).setMultipleInstances(!0))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */VY();ut.registerVersion(LY,FY);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BY="/firebase-messaging-sw.js",jY="/firebase-cloud-messaging-push-scope",Kx="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",qY="https://fcmregistrations.googleapis.com/v1",Hx="google.c.a.c_id",KY="google.c.a.c_l",HY="google.c.a.ts",WY="google.c.a.e";var cS;(function(t){t[t.DATA_MESSAGE=1]="DATA_MESSAGE",t[t.DISPLAY_NOTIFICATION=3]="DISPLAY_NOTIFICATION"})(cS||(cS={}));/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License"); you may not use this file except
 * in compliance with the License. You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software distributed under the License
 * is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express
 * or implied. See the License for the specific language governing permissions and limitations under
 * the License.
 */var yu;(function(t){t.PUSH_RECEIVED="push-received",t.NOTIFICATION_CLICKED="notification-clicked"})(yu||(yu={}));/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zs(t){const e=new Uint8Array(t);return btoa(String.fromCharCode(...e)).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function GY(t){const e="=".repeat((4-t.length%4)%4),n=(t+e).replace(/\-/g,"+").replace(/_/g,"/"),s=atob(n),r=new Uint8Array(s.length);for(let i=0;i<s.length;++i)r[i]=s.charCodeAt(i);return r}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lg="fcm_token_details_db",zY=5,lS="fcm_token_object_Store";async function QY(t){if("databases"in indexedDB&&!(await indexedDB.databases()).map(i=>i.name).includes(Lg))return null;let e=null;return(await oc(Lg,zY,{upgrade:async(s,r,i,o)=>{var a;if(r<2||!s.objectStoreNames.contains(lS))return;const c=o.objectStore(lS),l=await c.index("fcmSenderId").get(t);if(await c.clear(),!!l){if(r===2){const u=l;if(!u.auth||!u.p256dh||!u.endpoint)return;e={token:u.fcmToken,createTime:(a=u.createTime)!==null&&a!==void 0?a:Date.now(),subscriptionOptions:{auth:u.auth,p256dh:u.p256dh,endpoint:u.endpoint,swScope:u.swScope,vapidKey:typeof u.vapidKey=="string"?u.vapidKey:Zs(u.vapidKey)}}}else if(r===3){const u=l;e={token:u.fcmToken,createTime:u.createTime,subscriptionOptions:{auth:Zs(u.auth),p256dh:Zs(u.p256dh),endpoint:u.endpoint,swScope:u.swScope,vapidKey:Zs(u.vapidKey)}}}else if(r===4){const u=l;e={token:u.fcmToken,createTime:u.createTime,subscriptionOptions:{auth:Zs(u.auth),p256dh:Zs(u.p256dh),endpoint:u.endpoint,swScope:u.swScope,vapidKey:Zs(u.vapidKey)}}}}}})).close(),await _a(Lg),await _a("fcm_vapid_details_db"),await _a("undefined"),YY(e)?e:null}function YY(t){if(!t||!t.subscriptionOptions)return!1;const{subscriptionOptions:e}=t;return typeof t.createTime=="number"&&t.createTime>0&&typeof t.token=="string"&&t.token.length>0&&typeof e.auth=="string"&&e.auth.length>0&&typeof e.p256dh=="string"&&e.p256dh.length>0&&typeof e.endpoint=="string"&&e.endpoint.length>0&&typeof e.swScope=="string"&&e.swScope.length>0&&typeof e.vapidKey=="string"&&e.vapidKey.length>0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JY="firebase-messaging-database",XY=1,Po="firebase-messaging-store";let Fg=null;function Vw(){return Fg||(Fg=oc(JY,XY,{upgrade:(t,e)=>{switch(e){case 0:t.createObjectStore(Po)}}})),Fg}async function Wx(t){const e=jw(t),s=await(await Vw()).transaction(Po).objectStore(Po).get(e);if(s)return s;{const r=await QY(t.appConfig.senderId);if(r)return await Bw(t,r),r}}async function Bw(t,e){const n=jw(t),r=(await Vw()).transaction(Po,"readwrite");return await r.objectStore(Po).put(e,n),await r.done,e}async function ZY(t){const e=jw(t),s=(await Vw()).transaction(Po,"readwrite");await s.objectStore(Po).delete(e),await s.done}function jw({appConfig:t}){return t.appId}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const e5={["missing-app-config-values"]:'Missing App configuration value: "{$valueName}"',["only-available-in-window"]:"This method is available in a Window context.",["only-available-in-sw"]:"This method is available in a service worker context.",["permission-default"]:"The notification permission was not granted and dismissed instead.",["permission-blocked"]:"The notification permission was not granted and blocked instead.",["unsupported-browser"]:"This browser doesn't support the API's required to use the Firebase SDK.",["indexed-db-unsupported"]:"This browser doesn't support indexedDb.open() (ex. Safari iFrame, Firefox Private Browsing, etc)",["failed-service-worker-registration"]:"We are unable to register the default service worker. {$browserErrorMessage}",["token-subscribe-failed"]:"A problem occurred while subscribing the user to FCM: {$errorInfo}",["token-subscribe-no-token"]:"FCM returned no token when subscribing the user to push.",["token-unsubscribe-failed"]:"A problem occurred while unsubscribing the user from FCM: {$errorInfo}",["token-update-failed"]:"A problem occurred while updating the user from FCM: {$errorInfo}",["token-update-no-token"]:"FCM returned no token when updating the user to push.",["use-sw-after-get-token"]:"The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.",["invalid-sw-registration"]:"The input to useServiceWorker() must be a ServiceWorkerRegistration.",["invalid-bg-handler"]:"The input to setBackgroundMessageHandler() must be a function.",["invalid-vapid-key"]:"The public VAPID key must be a string.",["use-vapid-key-after-get-token"]:"The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used."},pn=new gn("messaging","Messaging",e5);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function t5(t,e){var n;const s=await Kw(t),r=zx(e),i={method:"POST",headers:s,body:JSON.stringify(r)};let o;try{o=await(await fetch(qw(t.appConfig),i)).json()}catch(a){throw pn.create("token-subscribe-failed",{errorInfo:(n=a)===null||n===void 0?void 0:n.toString()})}if(o.error){const a=o.error.message;throw pn.create("token-subscribe-failed",{errorInfo:a})}if(!o.token)throw pn.create("token-subscribe-no-token");return o.token}async function n5(t,e){var n;const s=await Kw(t),r=zx(e.subscriptionOptions),i={method:"PATCH",headers:s,body:JSON.stringify(r)};let o;try{o=await(await fetch(`${qw(t.appConfig)}/${e.token}`,i)).json()}catch(a){throw pn.create("token-update-failed",{errorInfo:(n=a)===null||n===void 0?void 0:n.toString()})}if(o.error){const a=o.error.message;throw pn.create("token-update-failed",{errorInfo:a})}if(!o.token)throw pn.create("token-update-no-token");return o.token}async function Gx(t,e){var n;const s=await Kw(t),r={method:"DELETE",headers:s};try{const o=await(await fetch(`${qw(t.appConfig)}/${e}`,r)).json();if(o.error){const a=o.error.message;throw pn.create("token-unsubscribe-failed",{errorInfo:a})}}catch(i){throw pn.create("token-unsubscribe-failed",{errorInfo:(n=i)===null||n===void 0?void 0:n.toString()})}}function qw({projectId:t}){return`${qY}/projects/${t}/registrations`}async function Kw({appConfig:t,installations:e}){const n=await e.getToken();return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t.apiKey,"x-goog-firebase-installations-auth":`FIS ${n}`})}function zx({p256dh:t,auth:e,endpoint:n,vapidKey:s}){const r={web:{endpoint:n,auth:e,p256dh:t}};return s!==Kx&&(r.web.applicationPubKey=s),r}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const s5=7*24*60*60*1e3;async function r5(t){const e=await o5(t.swRegistration,t.vapidKey),n={vapidKey:t.vapidKey,swScope:t.swRegistration.scope,endpoint:e.endpoint,auth:Zs(e.getKey("auth")),p256dh:Zs(e.getKey("p256dh"))},s=await Wx(t.firebaseDependencies);if(s){if(a5(s.subscriptionOptions,n))return Date.now()>=s.createTime+s5?i5(t,{token:s.token,createTime:Date.now(),subscriptionOptions:n}):s.token;try{await Gx(t.firebaseDependencies,s.token)}catch(r){console.warn(r)}return uS(t.firebaseDependencies,n)}else return uS(t.firebaseDependencies,n)}async function Qx(t){const e=await Wx(t.firebaseDependencies);e&&(await Gx(t.firebaseDependencies,e.token),await ZY(t.firebaseDependencies));const n=await t.swRegistration.pushManager.getSubscription();return n?n.unsubscribe():!0}async function i5(t,e){try{const n=await n5(t.firebaseDependencies,e),s=Object.assign(Object.assign({},e),{token:n,createTime:Date.now()});return await Bw(t.firebaseDependencies,s),n}catch(n){throw await Qx(t),n}}async function uS(t,e){const s={token:await t5(t,e),createTime:Date.now(),subscriptionOptions:e};return await Bw(t,s),s.token}async function o5(t,e){const n=await t.pushManager.getSubscription();return n||t.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:GY(e)})}function a5(t,e){const n=e.vapidKey===t.vapidKey,s=e.endpoint===t.endpoint,r=e.auth===t.auth,i=e.p256dh===t.p256dh;return n&&s&&r&&i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hS(t){const e={from:t.from,collapseKey:t.collapse_key,messageId:t.fcmMessageId};return c5(e,t),l5(e,t),u5(e,t),e}function c5(t,e){if(!e.notification)return;t.notification={};const n=e.notification.title;n&&(t.notification.title=n);const s=e.notification.body;s&&(t.notification.body=s);const r=e.notification.image;r&&(t.notification.image=r)}function l5(t,e){!e.data||(t.data=e.data)}function u5(t,e){var n,s,r,i,o;if(!e.fcmOptions&&!(!((n=e.notification)===null||n===void 0)&&n.click_action))return;t.fcmOptions={};const a=(r=(s=e.fcmOptions)===null||s===void 0?void 0:s.link)!==null&&r!==void 0?r:(i=e.notification)===null||i===void 0?void 0:i.click_action;a&&(t.fcmOptions.link=a);const c=(o=e.fcmOptions)===null||o===void 0?void 0:o.analytics_label;c&&(t.fcmOptions.analyticsLabel=c)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function h5(t){return typeof t=="object"&&!!t&&Hx in t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Yx("hts/frbslgigp.ogepscmv/ieo/eaylg","tp:/ieaeogn-agolai.o/1frlglgc/o");Yx("AzSCbw63g1R0nCw85jG8","Iaya3yLKwmgvh7cF0q4");function Yx(t,e){const n=[];for(let s=0;s<t.length;s++)n.push(t.charAt(s)),s<e.length&&n.push(e.charAt(s));return n.join("")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function d5(t){if(!t||!t.options)throw Ug("App Configuration Object");if(!t.name)throw Ug("App Name");const e=["projectId","apiKey","appId","messagingSenderId"],{options:n}=t;for(const s of e)if(!n[s])throw Ug(s);return{appName:t.name,projectId:n.projectId,apiKey:n.apiKey,appId:n.appId,senderId:n.messagingSenderId}}function Ug(t){return pn.create("missing-app-config-values",{valueName:t})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class f5{constructor(e,n,s){this.deliveryMetricsExportedToBigQueryEnabled=!1,this.onBackgroundMessageHandler=null,this.onMessageHandler=null,this.logEvents=[],this.isLogServiceStarted=!1;const r=d5(e);this.firebaseDependencies={app:e,appConfig:r,installations:n,analyticsProvider:s}}_delete(){return Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Jx(t){var e;try{t.swRegistration=await navigator.serviceWorker.register(BY,{scope:jY}),t.swRegistration.update().catch(()=>{})}catch(n){throw pn.create("failed-service-worker-registration",{browserErrorMessage:(e=n)===null||e===void 0?void 0:e.message})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function p5(t,e){if(!e&&!t.swRegistration&&await Jx(t),!(!e&&!!t.swRegistration)){if(!(e instanceof ServiceWorkerRegistration))throw pn.create("invalid-sw-registration");t.swRegistration=e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function g5(t,e){e?t.vapidKey=e:t.vapidKey||(t.vapidKey=Kx)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Xx(t,e){if(!navigator)throw pn.create("only-available-in-window");if(Notification.permission==="default"&&await Notification.requestPermission(),Notification.permission!=="granted")throw pn.create("permission-blocked");return await g5(t,e==null?void 0:e.vapidKey),await p5(t,e==null?void 0:e.serviceWorkerRegistration),r5(t)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function m5(t,e,n){const s=_5(e);(await t.firebaseDependencies.analyticsProvider.get()).logEvent(s,{message_id:n[Hx],message_name:n[KY],message_time:n[HY],message_device_time:Math.floor(Date.now()/1e3)})}function _5(t){switch(t){case yu.NOTIFICATION_CLICKED:return"notification_open";case yu.PUSH_RECEIVED:return"notification_foreground";default:throw new Error}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function y5(t,e){const n=e.data;if(!n.isFirebaseMessaging)return;t.onMessageHandler&&n.messageType===yu.PUSH_RECEIVED&&(typeof t.onMessageHandler=="function"?t.onMessageHandler(hS(n)):t.onMessageHandler.next(hS(n)));const s=n.data;h5(s)&&s[WY]==="1"&&await m5(t,n.messageType,s)}const dS="@firebase/messaging",fS="0.9.16";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const v5=t=>{const e=new f5(t.getProvider("app").getImmediate(),t.getProvider("installations-internal").getImmediate(),t.getProvider("analytics-internal"));return navigator.serviceWorker.addEventListener("message",n=>y5(e,n)),e},w5=t=>{const e=t.getProvider("messaging").getImmediate();return{getToken:s=>Xx(e,s)}};function b5(){rt(new Ae("messaging",v5,"PUBLIC")),rt(new Ae("messaging-internal",w5,"PRIVATE")),$e(dS,fS),$e(dS,fS,"esm2017")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function I5(t){if(!navigator)throw pn.create("only-available-in-window");return t.swRegistration||await Jx(t),Qx(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function E5(t,e){if(!navigator)throw pn.create("only-available-in-window");return t.onMessageHandler=e,()=>{t.onMessageHandler=null}}async function T5(t,e){return t=N(t),Xx(t,e)}function S5(t){return t=N(t),I5(t)}function C5(t,e){return t=N(t),E5(t,e)}b5();/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zx="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",A5="https://fcmregistrations.googleapis.com/v1",eD="FCM_MSG",k5="google.c.a.c_id",R5=3,N5=1;var sf;(function(t){t[t.DATA_MESSAGE=1]="DATA_MESSAGE",t[t.DISPLAY_NOTIFICATION=3]="DISPLAY_NOTIFICATION"})(sf||(sf={}));/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License"); you may not use this file except
 * in compliance with the License. You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software distributed under the License
 * is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express
 * or implied. See the License for the specific language governing permissions and limitations under
 * the License.
 */var rf;(function(t){t.PUSH_RECEIVED="push-received",t.NOTIFICATION_CLICKED="notification-clicked"})(rf||(rf={}));/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function er(t){const e=new Uint8Array(t);return btoa(String.fromCharCode(...e)).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function P5(t){const e="=".repeat((4-t.length%4)%4),n=(t+e).replace(/\-/g,"+").replace(/_/g,"/"),s=atob(n),r=new Uint8Array(s.length);for(let i=0;i<s.length;++i)r[i]=s.charCodeAt(i);return r}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $g="fcm_token_details_db",x5=5,pS="fcm_token_object_Store";async function D5(t){if("databases"in indexedDB&&!(await indexedDB.databases()).map(i=>i.name).includes($g))return null;let e=null;return(await oc($g,x5,{upgrade:async(s,r,i,o)=>{var a;if(r<2||!s.objectStoreNames.contains(pS))return;const c=o.objectStore(pS),l=await c.index("fcmSenderId").get(t);if(await c.clear(),!!l){if(r===2){const u=l;if(!u.auth||!u.p256dh||!u.endpoint)return;e={token:u.fcmToken,createTime:(a=u.createTime)!==null&&a!==void 0?a:Date.now(),subscriptionOptions:{auth:u.auth,p256dh:u.p256dh,endpoint:u.endpoint,swScope:u.swScope,vapidKey:typeof u.vapidKey=="string"?u.vapidKey:er(u.vapidKey)}}}else if(r===3){const u=l;e={token:u.fcmToken,createTime:u.createTime,subscriptionOptions:{auth:er(u.auth),p256dh:er(u.p256dh),endpoint:u.endpoint,swScope:u.swScope,vapidKey:er(u.vapidKey)}}}else if(r===4){const u=l;e={token:u.fcmToken,createTime:u.createTime,subscriptionOptions:{auth:er(u.auth),p256dh:er(u.p256dh),endpoint:u.endpoint,swScope:u.swScope,vapidKey:er(u.vapidKey)}}}}}})).close(),await _a($g),await _a("fcm_vapid_details_db"),await _a("undefined"),O5(e)?e:null}function O5(t){if(!t||!t.subscriptionOptions)return!1;const{subscriptionOptions:e}=t;return typeof t.createTime=="number"&&t.createTime>0&&typeof t.token=="string"&&t.token.length>0&&typeof e.auth=="string"&&e.auth.length>0&&typeof e.p256dh=="string"&&e.p256dh.length>0&&typeof e.endpoint=="string"&&e.endpoint.length>0&&typeof e.swScope=="string"&&e.swScope.length>0&&typeof e.vapidKey=="string"&&e.vapidKey.length>0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const M5="firebase-messaging-database",L5=1,xo="firebase-messaging-store";let Vg=null;function Hw(){return Vg||(Vg=oc(M5,L5,{upgrade:(t,e)=>{switch(e){case 0:t.createObjectStore(xo)}}})),Vg}async function Ww(t){const e=zw(t),s=await(await Hw()).transaction(xo).objectStore(xo).get(e);if(s)return s;{const r=await D5(t.appConfig.senderId);if(r)return await Gw(t,r),r}}async function Gw(t,e){const n=zw(t),r=(await Hw()).transaction(xo,"readwrite");return await r.objectStore(xo).put(e,n),await r.done,e}async function F5(t){const e=zw(t),s=(await Hw()).transaction(xo,"readwrite");await s.objectStore(xo).delete(e),await s.done}function zw({appConfig:t}){return t.appId}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const U5={["missing-app-config-values"]:'Missing App configuration value: "{$valueName}"',["only-available-in-window"]:"This method is available in a Window context.",["only-available-in-sw"]:"This method is available in a service worker context.",["permission-default"]:"The notification permission was not granted and dismissed instead.",["permission-blocked"]:"The notification permission was not granted and blocked instead.",["unsupported-browser"]:"This browser doesn't support the API's required to use the Firebase SDK.",["indexed-db-unsupported"]:"This browser doesn't support indexedDb.open() (ex. Safari iFrame, Firefox Private Browsing, etc)",["failed-service-worker-registration"]:"We are unable to register the default service worker. {$browserErrorMessage}",["token-subscribe-failed"]:"A problem occurred while subscribing the user to FCM: {$errorInfo}",["token-subscribe-no-token"]:"FCM returned no token when subscribing the user to push.",["token-unsubscribe-failed"]:"A problem occurred while unsubscribing the user from FCM: {$errorInfo}",["token-update-failed"]:"A problem occurred while updating the user from FCM: {$errorInfo}",["token-update-no-token"]:"FCM returned no token when updating the user to push.",["use-sw-after-get-token"]:"The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.",["invalid-sw-registration"]:"The input to useServiceWorker() must be a ServiceWorkerRegistration.",["invalid-bg-handler"]:"The input to setBackgroundMessageHandler() must be a function.",["invalid-vapid-key"]:"The public VAPID key must be a string.",["use-vapid-key-after-get-token"]:"The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used."},Fs=new gn("messaging","Messaging",U5);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function $5(t,e){var n;const s=await Yw(t),r=nD(e),i={method:"POST",headers:s,body:JSON.stringify(r)};let o;try{o=await(await fetch(Qw(t.appConfig),i)).json()}catch(a){throw Fs.create("token-subscribe-failed",{errorInfo:(n=a)===null||n===void 0?void 0:n.toString()})}if(o.error){const a=o.error.message;throw Fs.create("token-subscribe-failed",{errorInfo:a})}if(!o.token)throw Fs.create("token-subscribe-no-token");return o.token}async function V5(t,e){var n;const s=await Yw(t),r=nD(e.subscriptionOptions),i={method:"PATCH",headers:s,body:JSON.stringify(r)};let o;try{o=await(await fetch(`${Qw(t.appConfig)}/${e.token}`,i)).json()}catch(a){throw Fs.create("token-update-failed",{errorInfo:(n=a)===null||n===void 0?void 0:n.toString()})}if(o.error){const a=o.error.message;throw Fs.create("token-update-failed",{errorInfo:a})}if(!o.token)throw Fs.create("token-update-no-token");return o.token}async function tD(t,e){var n;const s=await Yw(t),r={method:"DELETE",headers:s};try{const o=await(await fetch(`${Qw(t.appConfig)}/${e}`,r)).json();if(o.error){const a=o.error.message;throw Fs.create("token-unsubscribe-failed",{errorInfo:a})}}catch(i){throw Fs.create("token-unsubscribe-failed",{errorInfo:(n=i)===null||n===void 0?void 0:n.toString()})}}function Qw({projectId:t}){return`${A5}/projects/${t}/registrations`}async function Yw({appConfig:t,installations:e}){const n=await e.getToken();return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t.apiKey,"x-goog-firebase-installations-auth":`FIS ${n}`})}function nD({p256dh:t,auth:e,endpoint:n,vapidKey:s}){const r={web:{endpoint:n,auth:e,p256dh:t}};return s!==Zx&&(r.web.applicationPubKey=s),r}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const B5=7*24*60*60*1e3;async function j5(t){const e=await K5(t.swRegistration,t.vapidKey),n={vapidKey:t.vapidKey,swScope:t.swRegistration.scope,endpoint:e.endpoint,auth:er(e.getKey("auth")),p256dh:er(e.getKey("p256dh"))},s=await Ww(t.firebaseDependencies);if(s){if(H5(s.subscriptionOptions,n))return Date.now()>=s.createTime+B5?q5(t,{token:s.token,createTime:Date.now(),subscriptionOptions:n}):s.token;try{await tD(t.firebaseDependencies,s.token)}catch(r){console.warn(r)}return gS(t.firebaseDependencies,n)}else return gS(t.firebaseDependencies,n)}async function A_(t){const e=await Ww(t.firebaseDependencies);e&&(await tD(t.firebaseDependencies,e.token),await F5(t.firebaseDependencies));const n=await t.swRegistration.pushManager.getSubscription();return n?n.unsubscribe():!0}async function q5(t,e){try{const n=await V5(t.firebaseDependencies,e),s=Object.assign(Object.assign({},e),{token:n,createTime:Date.now()});return await Gw(t.firebaseDependencies,s),n}catch(n){throw await A_(t),n}}async function gS(t,e){const s={token:await $5(t,e),createTime:Date.now(),subscriptionOptions:e};return await Gw(t,s),s.token}async function K5(t,e){const n=await t.pushManager.getSubscription();return n||t.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:P5(e)})}function H5(t,e){const n=e.vapidKey===t.vapidKey,s=e.endpoint===t.endpoint,r=e.auth===t.auth,i=e.p256dh===t.p256dh;return n&&s&&r&&i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function W5(t){const e={from:t.from,collapseKey:t.collapse_key,messageId:t.fcmMessageId};return G5(e,t),z5(e,t),Q5(e,t),e}function G5(t,e){if(!e.notification)return;t.notification={};const n=e.notification.title;n&&(t.notification.title=n);const s=e.notification.body;s&&(t.notification.body=s);const r=e.notification.image;r&&(t.notification.image=r)}function z5(t,e){!e.data||(t.data=e.data)}function Q5(t,e){var n,s,r,i,o;if(!e.fcmOptions&&!(!((n=e.notification)===null||n===void 0)&&n.click_action))return;t.fcmOptions={};const a=(r=(s=e.fcmOptions)===null||s===void 0?void 0:s.link)!==null&&r!==void 0?r:(i=e.notification)===null||i===void 0?void 0:i.click_action;a&&(t.fcmOptions.link=a);const c=(o=e.fcmOptions)===null||o===void 0?void 0:o.analytics_label;c&&(t.fcmOptions.analyticsLabel=c)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Y5(t){return typeof t=="object"&&!!t&&k5 in t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function J5(t){return new Promise(e=>{setTimeout(e,t)})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */sD("hts/frbslgigp.ogepscmv/ieo/eaylg","tp:/ieaeogn-agolai.o/1frlglgc/o");sD("AzSCbw63g1R0nCw85jG8","Iaya3yLKwmgvh7cF0q4");async function X5(t,e){const n=Z5(e,await t.firebaseDependencies.installations.getId());eJ(t,n)}function Z5(t,e){var n,s;const r={};return t.from&&(r.project_number=t.from),t.fcmMessageId&&(r.message_id=t.fcmMessageId),r.instance_id=e,t.notification?r.message_type=sf.DISPLAY_NOTIFICATION.toString():r.message_type=sf.DATA_MESSAGE.toString(),r.sdk_platform=R5.toString(),r.package_name=self.origin.replace(/(^\w+:|^)\/\//,""),t.collapse_key&&(r.collapse_key=t.collapse_key),r.event=N5.toString(),!((n=t.fcmOptions)===null||n===void 0)&&n.analytics_label&&(r.analytics_label=(s=t.fcmOptions)===null||s===void 0?void 0:s.analytics_label),r}function eJ(t,e){const n={};n.event_time_ms=Math.floor(Date.now()).toString(),n.source_extension_json_proto3=JSON.stringify(e),t.logEvents.push(n)}function sD(t,e){const n=[];for(let s=0;s<t.length;s++)n.push(t.charAt(s)),s<e.length&&n.push(e.charAt(s));return n.join("")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function tJ(t,e){var n,s;const{newSubscription:r}=t;if(!r){await A_(e);return}const i=await Ww(e.firebaseDependencies);await A_(e),e.vapidKey=(s=(n=i==null?void 0:i.subscriptionOptions)===null||n===void 0?void 0:n.vapidKey)!==null&&s!==void 0?s:Zx,await j5(e)}async function nJ(t,e){const n=iJ(t);if(!n)return;e.deliveryMetricsExportedToBigQueryEnabled&&await X5(e,n);const s=await rD();if(aJ(s))return cJ(s,n);if(n.notification&&await lJ(rJ(n)),!!e&&e.onBackgroundMessageHandler){const r=W5(n);typeof e.onBackgroundMessageHandler=="function"?await e.onBackgroundMessageHandler(r):e.onBackgroundMessageHandler.next(r)}}async function sJ(t){var e,n;const s=(n=(e=t.notification)===null||e===void 0?void 0:e.data)===null||n===void 0?void 0:n[eD];if(s){if(t.action)return}else return;t.stopImmediatePropagation(),t.notification.close();const r=uJ(s);if(!r)return;const i=new URL(r,self.location.href),o=new URL(self.location.origin);if(i.host!==o.host)return;let a=await oJ(i);if(a?a=await a.focus():(a=await self.clients.openWindow(r),await J5(3e3)),!!a)return s.messageType=rf.NOTIFICATION_CLICKED,s.isFirebaseMessaging=!0,a.postMessage(s)}function rJ(t){const e=Object.assign({},t.notification);return e.data={[eD]:t},e}function iJ({data:t}){if(!t)return null;try{return t.json()}catch{return null}}async function oJ(t){const e=await rD();for(const n of e){const s=new URL(n.url,self.location.href);if(t.host===s.host)return n}return null}function aJ(t){return t.some(e=>e.visibilityState==="visible"&&!e.url.startsWith("chrome-extension://"))}function cJ(t,e){e.isFirebaseMessaging=!0,e.messageType=rf.PUSH_RECEIVED;for(const n of t)n.postMessage(e)}function rD(){return self.clients.matchAll({type:"window",includeUncontrolled:!0})}function lJ(t){var e;const{actions:n}=t,{maxActions:s}=Notification;return n&&s&&n.length>s&&console.warn(`This browser only supports ${s} actions. The remaining actions will not be displayed.`),self.registration.showNotification((e=t.title)!==null&&e!==void 0?e:"",t)}function uJ(t){var e,n,s;const r=(n=(e=t.fcmOptions)===null||e===void 0?void 0:e.link)!==null&&n!==void 0?n:(s=t.notification)===null||s===void 0?void 0:s.click_action;return r||(Y5(t.data)?self.location.origin:null)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hJ(t){if(!t||!t.options)throw Bg("App Configuration Object");if(!t.name)throw Bg("App Name");const e=["projectId","apiKey","appId","messagingSenderId"],{options:n}=t;for(const s of e)if(!n[s])throw Bg(s);return{appName:t.name,projectId:n.projectId,apiKey:n.apiKey,appId:n.appId,senderId:n.messagingSenderId}}function Bg(t){return Fs.create("missing-app-config-values",{valueName:t})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dJ{constructor(e,n,s){this.deliveryMetricsExportedToBigQueryEnabled=!1,this.onBackgroundMessageHandler=null,this.onMessageHandler=null,this.logEvents=[],this.isLogServiceStarted=!1;const r=hJ(e);this.firebaseDependencies={app:e,appConfig:r,installations:n,analyticsProvider:s}}_delete(){return Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fJ=t=>{const e=new dJ(t.getProvider("app").getImmediate(),t.getProvider("installations-internal").getImmediate(),t.getProvider("analytics-internal"));return self.addEventListener("push",n=>{n.waitUntil(nJ(n,e))}),self.addEventListener("pushsubscriptionchange",n=>{n.waitUntil(tJ(n,e))}),self.addEventListener("notificationclick",n=>{n.waitUntil(sJ(n))}),e};function pJ(){rt(new Ae("messaging-sw",fJ,"PUBLIC"))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gJ(t,e){if(self.document!==void 0)throw Fs.create("only-available-in-sw");return t.onBackgroundMessageHandler=e,()=>{t.onBackgroundMessageHandler=null}}function mJ(t,e){return t=N(t),gJ(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */pJ();const _J="@firebase/messaging-compat",yJ="0.1.16";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vJ(){return self&&"ServiceWorkerGlobalScope"in self?bJ():wJ()}function wJ(){return typeof window<"u"&&En()&&kf()&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")}function bJ(){return En()&&"PushManager"in self&&"Notification"in self&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")}class mS{constructor(e,n){this.app=e,this._delegate=n,this.app=e,this._delegate=n}async getToken(e){return T5(this._delegate,e)}async deleteToken(){return S5(this._delegate)}onMessage(e){return C5(this._delegate,e)}onBackgroundMessage(e){return mJ(this._delegate,e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IJ=t=>self&&"ServiceWorkerGlobalScope"in self?new mS(t.getProvider("app-compat").getImmediate(),t.getProvider("messaging-sw").getImmediate()):new mS(t.getProvider("app-compat").getImmediate(),t.getProvider("messaging").getImmediate()),EJ={isSupported:vJ};function TJ(){ut.INTERNAL.registerComponent(new Ae("messaging-compat",IJ,"PUBLIC").setServiceProps(EJ))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */TJ();ut.registerVersion(_J,yJ);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iD="firebasestorage.googleapis.com",oD="storageBucket",SJ=2*60*1e3,CJ=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class at extends et{constructor(e,n){super(jg(e),`Firebase Storage: ${n} (${jg(e)})`),this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,at.prototype)}_codeEquals(e){return jg(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}function jg(t){return"storage/"+t}function Jw(){const t="An unknown error occurred, please check the error payload for server response.";return new at("unknown",t)}function AJ(t){return new at("object-not-found","Object '"+t+"' does not exist.")}function kJ(t){return new at("quota-exceeded","Quota for bucket '"+t+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function RJ(){const t="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new at("unauthenticated",t)}function NJ(){return new at("unauthorized-app","This app does not have permission to access Firebase Storage on this project.")}function PJ(t){return new at("unauthorized","User does not have permission to access '"+t+"'.")}function xJ(){return new at("retry-limit-exceeded","Max retry time for operation exceeded, please try again.")}function aD(){return new at("canceled","User canceled the upload/download.")}function DJ(t){return new at("invalid-url","Invalid URL '"+t+"'.")}function OJ(t){return new at("invalid-default-bucket","Invalid default bucket '"+t+"'.")}function MJ(){return new at("no-default-bucket","No default bucket found. Did you set the '"+oD+"' property when initializing the app?")}function cD(){return new at("cannot-slice-blob","Cannot slice blob for upload. Please retry the upload.")}function LJ(){return new at("server-file-wrong-size","Server recorded incorrect upload file size, please retry the upload.")}function FJ(){return new at("no-download-url","The given file does not have any download URLs.")}function Aa(t){return new at("invalid-argument",t)}function lD(){return new at("app-deleted","The Firebase app was deleted.")}function uD(t){return new at("invalid-root-operation","The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function wl(t,e){return new at("invalid-format","String does not match format '"+t+"': "+e)}function qc(t){throw new at("internal-error","Internal error: "+t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xt{constructor(e,n){this.bucket=e,this.path_=n}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,n){let s;try{s=Xt.makeFromUrl(e,n)}catch{return new Xt(e,"")}if(s.path==="")return s;throw OJ(e)}static makeFromUrl(e,n){let s=null;const r="([A-Za-z0-9.\\-_]+)";function i(S){S.path.charAt(S.path.length-1)==="/"&&(S.path_=S.path_.slice(0,-1))}const o="(/(.*))?$",a=new RegExp("^gs://"+r+o,"i"),c={bucket:1,path:3};function l(S){S.path_=decodeURIComponent(S.path)}const u="v[A-Za-z0-9_]+",h=n.replace(/[.]/g,"\\."),d="(/([^?#]*).*)?$",f=new RegExp(`^https?://${h}/${u}/b/${r}/o${d}`,"i"),p={bucket:1,path:3},_=n===iD?"(?:storage.googleapis.com|storage.cloud.google.com)":n,y="([^?#]*)",T=new RegExp(`^https?://${_}/${r}/${y}`,"i"),E=[{regex:a,indices:c,postModify:i},{regex:f,indices:p,postModify:l},{regex:T,indices:{bucket:1,path:2},postModify:l}];for(let S=0;S<E.length;S++){const H=E[S],Y=H.regex.exec(e);if(Y){const M=Y[H.indices.bucket];let G=Y[H.indices.path];G||(G=""),s=new Xt(M,G),H.postModify(s);break}}if(s==null)throw DJ(e);return s}}class UJ{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $J(t,e,n){let s=1,r=null,i=null,o=!1,a=0;function c(){return a===2}let l=!1;function u(...y){l||(l=!0,e.apply(null,y))}function h(y){r=setTimeout(()=>{r=null,t(f,c())},y)}function d(){i&&clearTimeout(i)}function f(y,...T){if(l){d();return}if(y){d(),u.call(null,y,...T);return}if(c()||o){d(),u.call(null,y,...T);return}s<64&&(s*=2);let E;a===1?(a=2,E=0):E=(s+Math.random())*1e3,h(E)}let p=!1;function _(y){p||(p=!0,d(),!l&&(r!==null?(y||(a=2),clearTimeout(r),h(0)):y||(a=1)))}return h(0),i=setTimeout(()=>{o=!0,_(!0)},n),_}function VJ(t){t(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function BJ(t){return t!==void 0}function jJ(t){return typeof t=="function"}function qJ(t){return typeof t=="object"&&!Array.isArray(t)}function Bp(t){return typeof t=="string"||t instanceof String}function _S(t){return Xw()&&t instanceof Blob}function Xw(){return typeof Blob<"u"}function k_(t,e,n,s){if(s<e)throw Aa(`Invalid value for '${t}'. Expected ${e} or greater.`);if(s>n)throw Aa(`Invalid value for '${t}'. Expected ${n} or less.`)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ei(t,e,n){let s=e;return n==null&&(s=`https://${e}`),`${n}://${s}/v0${t}`}function hD(t){const e=encodeURIComponent;let n="?";for(const s in t)if(t.hasOwnProperty(s)){const r=e(s)+"="+e(t[s]);n=n+r+"&"}return n=n.slice(0,-1),n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var io;(function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"})(io||(io={}));/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KJ{constructor(e,n,s,r,i,o,a,c,l,u,h){this.url_=e,this.method_=n,this.headers_=s,this.body_=r,this.successCodes_=i,this.additionalRetryCodes_=o,this.callback_=a,this.errorCallback_=c,this.timeout_=l,this.progressCallback_=u,this.connectionFactory_=h,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((d,f)=>{this.resolve_=d,this.reject_=f,this.start_()})}start_(){const e=(s,r)=>{if(r){s(!1,new Ch(!1,null,!0));return}const i=this.connectionFactory_();this.pendingConnection_=i;const o=a=>{const c=a.loaded,l=a.lengthComputable?a.total:-1;this.progressCallback_!==null&&this.progressCallback_(c,l)};this.progressCallback_!==null&&i.addUploadProgressListener(o),i.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&i.removeUploadProgressListener(o),this.pendingConnection_=null;const a=i.getErrorCode()===io.NO_ERROR,c=i.getStatus();if(!a||this.isRetryStatusCode_(c)){const u=i.getErrorCode()===io.ABORT;s(!1,new Ch(!1,null,u));return}const l=this.successCodes_.indexOf(c)!==-1;s(!0,new Ch(l,i))})},n=(s,r)=>{const i=this.resolve_,o=this.reject_,a=r.connection;if(r.wasSuccessCode)try{const c=this.callback_(a,a.getResponse());BJ(c)?i(c):i()}catch(c){o(c)}else if(a!==null){const c=Jw();c.serverResponse=a.getErrorText(),this.errorCallback_?o(this.errorCallback_(a,c)):o(c)}else if(r.canceled){const c=this.appDelete_?lD():aD();o(c)}else{const c=xJ();o(c)}};this.canceled_?n(!1,new Ch(!1,null,!0)):this.backoffId_=$J(e,n,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&VJ(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}isRetryStatusCode_(e){const n=e>=500&&e<600,r=[408,429].indexOf(e)!==-1,i=this.additionalRetryCodes_.indexOf(e)!==-1;return n||r||i}}class Ch{constructor(e,n,s){this.wasSuccessCode=e,this.connection=n,this.canceled=!!s}}function HJ(t,e){e!==null&&e.length>0&&(t.Authorization="Firebase "+e)}function WJ(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(e!=null?e:"AppManager")}function GJ(t,e){e&&(t["X-Firebase-GMPID"]=e)}function zJ(t,e){e!==null&&(t["X-Firebase-AppCheck"]=e)}function QJ(t,e,n,s,r,i){const o=hD(t.urlParams),a=t.url+o,c=Object.assign({},t.headers);return GJ(c,e),HJ(c,n),WJ(c,i),zJ(c,s),new KJ(a,t.method,c,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,r)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function YJ(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function JJ(...t){const e=YJ();if(e!==void 0){const n=new e;for(let s=0;s<t.length;s++)n.append(t[s]);return n.getBlob()}else{if(Xw())return new Blob(t);throw new at("unsupported-environment","This browser doesn't seem to support creating Blobs")}}function XJ(t,e,n){return t.webkitSlice?t.webkitSlice(e,n):t.mozSlice?t.mozSlice(e,n):t.slice?t.slice(e,n):null}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ZJ(t){return atob(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gn={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class qg{constructor(e,n){this.data=e,this.contentType=n||null}}function dD(t,e){switch(t){case Gn.RAW:return new qg(fD(e));case Gn.BASE64:case Gn.BASE64URL:return new qg(pD(t,e));case Gn.DATA_URL:return new qg(tX(e),nX(e))}throw Jw()}function fD(t){const e=[];for(let n=0;n<t.length;n++){let s=t.charCodeAt(n);if(s<=127)e.push(s);else if(s<=2047)e.push(192|s>>6,128|s&63);else if((s&64512)===55296)if(!(n<t.length-1&&(t.charCodeAt(n+1)&64512)===56320))e.push(239,191,189);else{const i=s,o=t.charCodeAt(++n);s=65536|(i&1023)<<10|o&1023,e.push(240|s>>18,128|s>>12&63,128|s>>6&63,128|s&63)}else(s&64512)===56320?e.push(239,191,189):e.push(224|s>>12,128|s>>6&63,128|s&63)}return new Uint8Array(e)}function eX(t){let e;try{e=decodeURIComponent(t)}catch{throw wl(Gn.DATA_URL,"Malformed data URL.")}return fD(e)}function pD(t,e){switch(t){case Gn.BASE64:{const r=e.indexOf("-")!==-1,i=e.indexOf("_")!==-1;if(r||i)throw wl(t,"Invalid character '"+(r?"-":"_")+"' found: is it base64url encoded?");break}case Gn.BASE64URL:{const r=e.indexOf("+")!==-1,i=e.indexOf("/")!==-1;if(r||i)throw wl(t,"Invalid character '"+(r?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let n;try{n=ZJ(e)}catch{throw wl(t,"Invalid character found")}const s=new Uint8Array(n.length);for(let r=0;r<n.length;r++)s[r]=n.charCodeAt(r);return s}class gD{constructor(e){this.base64=!1,this.contentType=null;const n=e.match(/^data:([^,]+)?,/);if(n===null)throw wl(Gn.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const s=n[1]||null;s!=null&&(this.base64=sX(s,";base64"),this.contentType=this.base64?s.substring(0,s.length-7):s),this.rest=e.substring(e.indexOf(",")+1)}}function tX(t){const e=new gD(t);return e.base64?pD(Gn.BASE64,e.rest):eX(e.rest)}function nX(t){return new gD(t).contentType}function sX(t,e){return t.length>=e.length?t.substring(t.length-e.length)===e:!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nr{constructor(e,n){let s=0,r="";_S(e)?(this.data_=e,s=e.size,r=e.type):e instanceof ArrayBuffer?(n?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),s=this.data_.length):e instanceof Uint8Array&&(n?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),s=e.length),this.size_=s,this.type_=r}size(){return this.size_}type(){return this.type_}slice(e,n){if(_S(this.data_)){const s=this.data_,r=XJ(s,e,n);return r===null?null:new nr(r)}else{const s=new Uint8Array(this.data_.buffer,e,n-e);return new nr(s,!0)}}static getBlob(...e){if(Xw()){const n=e.map(s=>s instanceof nr?s.data_:s);return new nr(JJ.apply(null,n))}else{const n=e.map(o=>Bp(o)?dD(Gn.RAW,o).data:o.data_);let s=0;n.forEach(o=>{s+=o.byteLength});const r=new Uint8Array(s);let i=0;return n.forEach(o=>{for(let a=0;a<o.length;a++)r[i++]=o[a]}),new nr(r,!0)}}uploadData(){return this.data_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zw(t){let e;try{e=JSON.parse(t)}catch{return null}return qJ(e)?e:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rX(t){if(t.length===0)return null;const e=t.lastIndexOf("/");return e===-1?"":t.slice(0,e)}function iX(t,e){const n=e.split("/").filter(s=>s.length>0).join("/");return t.length===0?n:t+"/"+n}function mD(t){const e=t.lastIndexOf("/",t.length-2);return e===-1?t:t.slice(e+1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oX(t,e){return e}class nn{constructor(e,n,s,r){this.server=e,this.local=n||e,this.writable=!!s,this.xform=r||oX}}let Ah=null;function aX(t){return!Bp(t)||t.length<2?t:mD(t)}function jp(){if(Ah)return Ah;const t=[];t.push(new nn("bucket")),t.push(new nn("generation")),t.push(new nn("metageneration")),t.push(new nn("name","fullPath",!0));function e(i,o){return aX(o)}const n=new nn("name");n.xform=e,t.push(n);function s(i,o){return o!==void 0?Number(o):o}const r=new nn("size");return r.xform=s,t.push(r),t.push(new nn("timeCreated")),t.push(new nn("updated")),t.push(new nn("md5Hash",null,!0)),t.push(new nn("cacheControl",null,!0)),t.push(new nn("contentDisposition",null,!0)),t.push(new nn("contentEncoding",null,!0)),t.push(new nn("contentLanguage",null,!0)),t.push(new nn("contentType",null,!0)),t.push(new nn("metadata","customMetadata",!0)),Ah=t,Ah}function cX(t,e){function n(){const s=t.bucket,r=t.fullPath,i=new Xt(s,r);return e._makeStorageReference(i)}Object.defineProperty(t,"ref",{get:n})}function lX(t,e,n){const s={};s.type="file";const r=n.length;for(let i=0;i<r;i++){const o=n[i];s[o.local]=o.xform(s,e[o.server])}return cX(s,t),s}function _D(t,e,n){const s=Zw(e);return s===null?null:lX(t,s,n)}function uX(t,e,n,s){const r=Zw(e);if(r===null||!Bp(r.downloadTokens))return null;const i=r.downloadTokens;if(i.length===0)return null;const o=encodeURIComponent;return i.split(",").map(l=>{const u=t.bucket,h=t.fullPath,d="/b/"+o(u)+"/o/"+o(h),f=Ei(d,n,s),p=hD({alt:"media",token:l});return f+p})[0]}function eb(t,e){const n={},s=e.length;for(let r=0;r<s;r++){const i=e[r];i.writable&&(n[i.server]=t[i.local])}return JSON.stringify(n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yS="prefixes",vS="items";function hX(t,e,n){const s={prefixes:[],items:[],nextPageToken:n.nextPageToken};if(n[yS])for(const r of n[yS]){const i=r.replace(/\/$/,""),o=t._makeStorageReference(new Xt(e,i));s.prefixes.push(o)}if(n[vS])for(const r of n[vS]){const i=t._makeStorageReference(new Xt(e,r.name));s.items.push(i)}return s}function dX(t,e,n){const s=Zw(n);return s===null?null:hX(t,e,s)}class Cr{constructor(e,n,s,r){this.url=e,this.method=n,this.handler=s,this.timeout=r,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Us(t){if(!t)throw Jw()}function qp(t,e){function n(s,r){const i=_D(t,r,e);return Us(i!==null),i}return n}function fX(t,e){function n(s,r){const i=dX(t,e,r);return Us(i!==null),i}return n}function pX(t,e){function n(s,r){const i=_D(t,r,e);return Us(i!==null),uX(i,r,t.host,t._protocol)}return n}function Sc(t){function e(n,s){let r;return n.getStatus()===401?n.getErrorText().includes("Firebase App Check token is invalid")?r=NJ():r=RJ():n.getStatus()===402?r=kJ(t.bucket):n.getStatus()===403?r=PJ(t.path):r=s,r.serverResponse=s.serverResponse,r}return e}function Kp(t){const e=Sc(t);function n(s,r){let i=e(s,r);return s.getStatus()===404&&(i=AJ(t.path)),i.serverResponse=r.serverResponse,i}return n}function yD(t,e,n){const s=e.fullServerUrl(),r=Ei(s,t.host,t._protocol),i="GET",o=t.maxOperationRetryTime,a=new Cr(r,i,qp(t,n),o);return a.errorHandler=Kp(e),a}function gX(t,e,n,s,r){const i={};e.isRoot?i.prefix="":i.prefix=e.path+"/",n&&n.length>0&&(i.delimiter=n),s&&(i.pageToken=s),r&&(i.maxResults=r);const o=e.bucketOnlyServerUrl(),a=Ei(o,t.host,t._protocol),c="GET",l=t.maxOperationRetryTime,u=new Cr(a,c,fX(t,e.bucket),l);return u.urlParams=i,u.errorHandler=Sc(e),u}function mX(t,e,n){const s=e.fullServerUrl(),r=Ei(s,t.host,t._protocol),i="GET",o=t.maxOperationRetryTime,a=new Cr(r,i,pX(t,n),o);return a.errorHandler=Kp(e),a}function _X(t,e,n,s){const r=e.fullServerUrl(),i=Ei(r,t.host,t._protocol),o="PATCH",a=eb(n,s),c={"Content-Type":"application/json; charset=utf-8"},l=t.maxOperationRetryTime,u=new Cr(i,o,qp(t,s),l);return u.headers=c,u.body=a,u.errorHandler=Kp(e),u}function yX(t,e){const n=e.fullServerUrl(),s=Ei(n,t.host,t._protocol),r="DELETE",i=t.maxOperationRetryTime;function o(c,l){}const a=new Cr(s,r,o,i);return a.successCodes=[200,204],a.errorHandler=Kp(e),a}function vX(t,e){return t&&t.contentType||e&&e.type()||"application/octet-stream"}function vD(t,e,n){const s=Object.assign({},n);return s.fullPath=t.path,s.size=e.size(),s.contentType||(s.contentType=vX(null,e)),s}function wX(t,e,n,s,r){const i=e.bucketOnlyServerUrl(),o={"X-Goog-Upload-Protocol":"multipart"};function a(){let E="";for(let S=0;S<2;S++)E=E+Math.random().toString().slice(2);return E}const c=a();o["Content-Type"]="multipart/related; boundary="+c;const l=vD(e,s,r),u=eb(l,n),h="--"+c+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+u+`\r
--`+c+`\r
Content-Type: `+l.contentType+`\r
\r
`,d=`\r
--`+c+"--",f=nr.getBlob(h,s,d);if(f===null)throw cD();const p={name:l.fullPath},_=Ei(i,t.host,t._protocol),y="POST",T=t.maxUploadRetryTime,I=new Cr(_,y,qp(t,n),T);return I.urlParams=p,I.headers=o,I.body=f.uploadData(),I.errorHandler=Sc(e),I}class of{constructor(e,n,s,r){this.current=e,this.total=n,this.finalized=!!s,this.metadata=r||null}}function tb(t,e){let n=null;try{n=t.getResponseHeader("X-Goog-Upload-Status")}catch{Us(!1)}return Us(!!n&&(e||["active"]).indexOf(n)!==-1),n}function bX(t,e,n,s,r){const i=e.bucketOnlyServerUrl(),o=vD(e,s,r),a={name:o.fullPath},c=Ei(i,t.host,t._protocol),l="POST",u={"X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${s.size()}`,"X-Goog-Upload-Header-Content-Type":o.contentType,"Content-Type":"application/json; charset=utf-8"},h=eb(o,n),d=t.maxUploadRetryTime;function f(_){tb(_);let y;try{y=_.getResponseHeader("X-Goog-Upload-URL")}catch{Us(!1)}return Us(Bp(y)),y}const p=new Cr(c,l,f,d);return p.urlParams=a,p.headers=u,p.body=h,p.errorHandler=Sc(e),p}function IX(t,e,n,s){const r={"X-Goog-Upload-Command":"query"};function i(l){const u=tb(l,["active","final"]);let h=null;try{h=l.getResponseHeader("X-Goog-Upload-Size-Received")}catch{Us(!1)}h||Us(!1);const d=Number(h);return Us(!isNaN(d)),new of(d,s.size(),u==="final")}const o="POST",a=t.maxUploadRetryTime,c=new Cr(n,o,i,a);return c.headers=r,c.errorHandler=Sc(e),c}const wS=256*1024;function EX(t,e,n,s,r,i,o,a){const c=new of(0,0);if(o?(c.current=o.current,c.total=o.total):(c.current=0,c.total=s.size()),s.size()!==c.total)throw LJ();const l=c.total-c.current;let u=l;r>0&&(u=Math.min(u,r));const h=c.current,d=h+u,p={"X-Goog-Upload-Command":u===l?"upload, finalize":"upload","X-Goog-Upload-Offset":`${c.current}`},_=s.slice(h,d);if(_===null)throw cD();function y(S,H){const Y=tb(S,["active","final"]),M=c.current+u,G=s.size();let j;return Y==="final"?j=qp(e,i)(S,H):j=null,new of(M,G,Y==="final",j)}const T="POST",I=e.maxUploadRetryTime,E=new Cr(n,T,y,I);return E.headers=p,E.body=_.uploadData(),E.progressCallback=a||null,E.errorHandler=Sc(t),E}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TX={STATE_CHANGED:"state_changed"},an={RUNNING:"running",PAUSED:"paused",SUCCESS:"success",CANCELED:"canceled",ERROR:"error"};function Kg(t){switch(t){case"running":case"pausing":case"canceling":return an.RUNNING;case"paused":return an.PAUSED;case"success":return an.SUCCESS;case"canceled":return an.CANCELED;case"error":return an.ERROR;default:return an.ERROR}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SX{constructor(e,n,s){if(jJ(e)||n!=null||s!=null)this.next=e,this.error=n!=null?n:void 0,this.complete=s!=null?s:void 0;else{const i=e;this.next=i.next,this.error=i.error,this.complete=i.complete}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sa(t){return(...e)=>{Promise.resolve().then(()=>t(...e))}}class CX{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=io.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=io.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=io.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,n,s,r){if(this.sent_)throw qc("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(n,e,!0),r!==void 0)for(const i in r)r.hasOwnProperty(i)&&this.xhr_.setRequestHeader(i,r[i].toString());return s!==void 0?this.xhr_.send(s):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw qc("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw qc("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw qc("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw qc("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class AX extends CX{initXhr(){this.xhr_.responseType="text"}}function ks(){return new AX}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wD{constructor(e,n,s=null){this._transferred=0,this._needToFetchStatus=!1,this._needToFetchMetadata=!1,this._observers=[],this._error=void 0,this._uploadUrl=void 0,this._request=void 0,this._chunkMultiplier=1,this._resolve=void 0,this._reject=void 0,this._ref=e,this._blob=n,this._metadata=s,this._mappings=jp(),this._resumable=this._shouldDoResumable(this._blob),this._state="running",this._errorHandler=r=>{this._request=void 0,this._chunkMultiplier=1,r._codeEquals("canceled")?(this._needToFetchStatus=!0,this.completeTransitions_()):(this._error=r,this._transition("error"))},this._metadataErrorHandler=r=>{this._request=void 0,r._codeEquals("canceled")?this.completeTransitions_():(this._error=r,this._transition("error"))},this._promise=new Promise((r,i)=>{this._resolve=r,this._reject=i,this._start()}),this._promise.then(null,()=>{})}_makeProgressCallback(){const e=this._transferred;return n=>this._updateProgress(e+n)}_shouldDoResumable(e){return e.size()>256*1024}_start(){this._state==="running"&&this._request===void 0&&(this._resumable?this._uploadUrl===void 0?this._createResumable():this._needToFetchStatus?this._fetchStatus():this._needToFetchMetadata?this._fetchMetadata():this._continueUpload():this._oneShotUpload())}_resolveToken(e){Promise.all([this._ref.storage._getAuthToken(),this._ref.storage._getAppCheckToken()]).then(([n,s])=>{switch(this._state){case"running":e(n,s);break;case"canceling":this._transition("canceled");break;case"pausing":this._transition("paused");break}})}_createResumable(){this._resolveToken((e,n)=>{const s=bX(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),r=this._ref.storage._makeRequest(s,ks,e,n);this._request=r,r.getPromise().then(i=>{this._request=void 0,this._uploadUrl=i,this._needToFetchStatus=!1,this.completeTransitions_()},this._errorHandler)})}_fetchStatus(){const e=this._uploadUrl;this._resolveToken((n,s)=>{const r=IX(this._ref.storage,this._ref._location,e,this._blob),i=this._ref.storage._makeRequest(r,ks,n,s);this._request=i,i.getPromise().then(o=>{o=o,this._request=void 0,this._updateProgress(o.current),this._needToFetchStatus=!1,o.finalized&&(this._needToFetchMetadata=!0),this.completeTransitions_()},this._errorHandler)})}_continueUpload(){const e=wS*this._chunkMultiplier,n=new of(this._transferred,this._blob.size()),s=this._uploadUrl;this._resolveToken((r,i)=>{let o;try{o=EX(this._ref._location,this._ref.storage,s,this._blob,e,this._mappings,n,this._makeProgressCallback())}catch(c){this._error=c,this._transition("error");return}const a=this._ref.storage._makeRequest(o,ks,r,i);this._request=a,a.getPromise().then(c=>{this._increaseMultiplier(),this._request=void 0,this._updateProgress(c.current),c.finalized?(this._metadata=c.metadata,this._transition("success")):this.completeTransitions_()},this._errorHandler)})}_increaseMultiplier(){wS*this._chunkMultiplier<32*1024*1024&&(this._chunkMultiplier*=2)}_fetchMetadata(){this._resolveToken((e,n)=>{const s=yD(this._ref.storage,this._ref._location,this._mappings),r=this._ref.storage._makeRequest(s,ks,e,n);this._request=r,r.getPromise().then(i=>{this._request=void 0,this._metadata=i,this._transition("success")},this._metadataErrorHandler)})}_oneShotUpload(){this._resolveToken((e,n)=>{const s=wX(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),r=this._ref.storage._makeRequest(s,ks,e,n);this._request=r,r.getPromise().then(i=>{this._request=void 0,this._metadata=i,this._updateProgress(this._blob.size()),this._transition("success")},this._errorHandler)})}_updateProgress(e){const n=this._transferred;this._transferred=e,this._transferred!==n&&this._notifyObservers()}_transition(e){if(this._state!==e)switch(e){case"canceling":this._state=e,this._request!==void 0&&this._request.cancel();break;case"pausing":this._state=e,this._request!==void 0&&this._request.cancel();break;case"running":const n=this._state==="paused";this._state=e,n&&(this._notifyObservers(),this._start());break;case"paused":this._state=e,this._notifyObservers();break;case"canceled":this._error=aD(),this._state=e,this._notifyObservers();break;case"error":this._state=e,this._notifyObservers();break;case"success":this._state=e,this._notifyObservers();break}}completeTransitions_(){switch(this._state){case"pausing":this._transition("paused");break;case"canceling":this._transition("canceled");break;case"running":this._start();break}}get snapshot(){const e=Kg(this._state);return{bytesTransferred:this._transferred,totalBytes:this._blob.size(),state:e,metadata:this._metadata,task:this,ref:this._ref}}on(e,n,s,r){const i=new SX(n||void 0,s||void 0,r||void 0);return this._addObserver(i),()=>{this._removeObserver(i)}}then(e,n){return this._promise.then(e,n)}catch(e){return this.then(null,e)}_addObserver(e){this._observers.push(e),this._notifyObserver(e)}_removeObserver(e){const n=this._observers.indexOf(e);n!==-1&&this._observers.splice(n,1)}_notifyObservers(){this._finishPromise(),this._observers.slice().forEach(n=>{this._notifyObserver(n)})}_finishPromise(){if(this._resolve!==void 0){let e=!0;switch(Kg(this._state)){case an.SUCCESS:sa(this._resolve.bind(null,this.snapshot))();break;case an.CANCELED:case an.ERROR:const n=this._reject;sa(n.bind(null,this._error))();break;default:e=!1;break}e&&(this._resolve=void 0,this._reject=void 0)}}_notifyObserver(e){switch(Kg(this._state)){case an.RUNNING:case an.PAUSED:e.next&&sa(e.next.bind(e,this.snapshot))();break;case an.SUCCESS:e.complete&&sa(e.complete.bind(e))();break;case an.CANCELED:case an.ERROR:e.error&&sa(e.error.bind(e,this._error))();break;default:e.error&&sa(e.error.bind(e,this._error))()}}resume(){const e=this._state==="paused"||this._state==="pausing";return e&&this._transition("running"),e}pause(){const e=this._state==="running";return e&&this._transition("pausing"),e}cancel(){const e=this._state==="running"||this._state==="pausing";return e&&this._transition("canceling"),e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Do{constructor(e,n){this._service=e,n instanceof Xt?this._location=n:this._location=Xt.makeFromUrl(n,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,n){return new Do(e,n)}get root(){const e=new Xt(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return mD(this._location.path)}get storage(){return this._service}get parent(){const e=rX(this._location.path);if(e===null)return null;const n=new Xt(this._location.bucket,e);return new Do(this._service,n)}_throwIfRoot(e){if(this._location.path==="")throw uD(e)}}function kX(t,e,n){return t._throwIfRoot("uploadBytesResumable"),new wD(t,new nr(e),n)}function RX(t){const e={prefixes:[],items:[]};return bD(t,e).then(()=>e)}async function bD(t,e,n){const r=await ID(t,{pageToken:n});e.prefixes.push(...r.prefixes),e.items.push(...r.items),r.nextPageToken!=null&&await bD(t,e,r.nextPageToken)}function ID(t,e){e!=null&&typeof e.maxResults=="number"&&k_("options.maxResults",1,1e3,e.maxResults);const n=e||{},s=gX(t.storage,t._location,"/",n.pageToken,n.maxResults);return t.storage.makeRequestWithTokens(s,ks)}function NX(t){t._throwIfRoot("getMetadata");const e=yD(t.storage,t._location,jp());return t.storage.makeRequestWithTokens(e,ks)}function PX(t,e){t._throwIfRoot("updateMetadata");const n=_X(t.storage,t._location,e,jp());return t.storage.makeRequestWithTokens(n,ks)}function xX(t){t._throwIfRoot("getDownloadURL");const e=mX(t.storage,t._location,jp());return t.storage.makeRequestWithTokens(e,ks).then(n=>{if(n===null)throw FJ();return n})}function DX(t){t._throwIfRoot("deleteObject");const e=yX(t.storage,t._location);return t.storage.makeRequestWithTokens(e,ks)}function ED(t,e){const n=iX(t._location.path,e),s=new Xt(t._location.bucket,n);return new Do(t.storage,s)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function OX(t){return/^[A-Za-z]+:\/\//.test(t)}function MX(t,e){return new Do(t,e)}function TD(t,e){if(t instanceof nb){const n=t;if(n._bucket==null)throw MJ();const s=new Do(n,n._bucket);return e!=null?TD(s,e):s}else return e!==void 0?ED(t,e):t}function LX(t,e){if(e&&OX(e)){if(t instanceof nb)return MX(t,e);throw Aa("To use ref(service, url), the first argument must be a Storage instance.")}else return TD(t,e)}function bS(t,e){const n=e==null?void 0:e[oD];return n==null?null:Xt.makeFromBucketSpec(n,t)}function FX(t,e,n,s={}){t.host=`${e}:${n}`,t._protocol="http";const{mockUserToken:r}=s;r&&(t._overrideAuthToken=typeof r=="string"?r:oy(r,t.app.options.projectId))}class nb{constructor(e,n,s,r,i){this.app=e,this._authProvider=n,this._appCheckProvider=s,this._url=r,this._firebaseVersion=i,this._bucket=null,this._host=iD,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=SJ,this._maxUploadRetryTime=CJ,this._requests=new Set,r!=null?this._bucket=Xt.makeFromBucketSpec(r,this._host):this._bucket=bS(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=Xt.makeFromBucketSpec(this._url,e):this._bucket=bS(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){k_("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){k_("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const n=await e.getToken();if(n!==null)return n.accessToken}return null}async _getAppCheckToken(){const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Do(this,e)}_makeRequest(e,n,s,r){if(this._deleted)return new UJ(lD());{const i=QJ(e,this._appId,s,r,n,this._firebaseVersion);return this._requests.add(i),i.getPromise().then(()=>this._requests.delete(i),()=>this._requests.delete(i)),i}}async makeRequestWithTokens(e,n){const[s,r]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,n,s,r).getPromise()}}const IS="@firebase/storage",ES="0.9.9";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UX="storage";function $X(t,e,n){return t=N(t),kX(t,e,n)}function VX(t){return t=N(t),NX(t)}function BX(t,e){return t=N(t),PX(t,e)}function jX(t,e){return t=N(t),ID(t,e)}function qX(t){return t=N(t),RX(t)}function KX(t){return t=N(t),xX(t)}function HX(t){return t=N(t),DX(t)}function TS(t,e){return t=N(t),LX(t,e)}function WX(t,e){return ED(t,e)}function GX(t,e,n,s={}){FX(t,e,n,s)}function zX(t,{instanceIdentifier:e}){const n=t.getProvider("app").getImmediate(),s=t.getProvider("auth-internal"),r=t.getProvider("app-check-internal");return new nb(n,s,r,e,Ys)}function QX(){rt(new Ae(UX,zX,"PUBLIC").setMultipleInstances(!0)),$e(IS,ES,""),$e(IS,ES,"esm2017")}QX();/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kh{constructor(e,n,s){this._delegate=e,this.task=n,this.ref=s}get bytesTransferred(){return this._delegate.bytesTransferred}get metadata(){return this._delegate.metadata}get state(){return this._delegate.state}get totalBytes(){return this._delegate.totalBytes}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SS{constructor(e,n){this._delegate=e,this._ref=n,this.cancel=this._delegate.cancel.bind(this._delegate),this.catch=this._delegate.catch.bind(this._delegate),this.pause=this._delegate.pause.bind(this._delegate),this.resume=this._delegate.resume.bind(this._delegate)}get snapshot(){return new kh(this._delegate.snapshot,this,this._ref)}then(e,n){return this._delegate.then(s=>{if(e)return e(new kh(s,this,this._ref))},n)}on(e,n,s,r){let i;return n&&(typeof n=="function"?i=o=>n(new kh(o,this,this._ref)):i={next:n.next?o=>n.next(new kh(o,this,this._ref)):void 0,complete:n.complete||void 0,error:n.error||void 0}),this._delegate.on(e,i,s||void 0,r||void 0)}}class CS{constructor(e,n){this._delegate=e,this._service=n}get prefixes(){return this._delegate.prefixes.map(e=>new dr(e,this._service))}get items(){return this._delegate.items.map(e=>new dr(e,this._service))}get nextPageToken(){return this._delegate.nextPageToken||null}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *  http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dr{constructor(e,n){this._delegate=e,this.storage=n}get name(){return this._delegate.name}get bucket(){return this._delegate.bucket}get fullPath(){return this._delegate.fullPath}toString(){return this._delegate.toString()}child(e){const n=WX(this._delegate,e);return new dr(n,this.storage)}get root(){return new dr(this._delegate.root,this.storage)}get parent(){const e=this._delegate.parent;return e==null?null:new dr(e,this.storage)}put(e,n){return this._throwIfRoot("put"),new SS($X(this._delegate,e,n),this)}putString(e,n=Gn.RAW,s){this._throwIfRoot("putString");const r=dD(n,e),i=Object.assign({},s);return i.contentType==null&&r.contentType!=null&&(i.contentType=r.contentType),new SS(new wD(this._delegate,new nr(r.data,!0),i),this)}listAll(){return qX(this._delegate).then(e=>new CS(e,this.storage))}list(e){return jX(this._delegate,e||void 0).then(n=>new CS(n,this.storage))}getMetadata(){return VX(this._delegate)}updateMetadata(e){return BX(this._delegate,e)}getDownloadURL(){return KX(this._delegate)}delete(){return this._throwIfRoot("delete"),HX(this._delegate)}_throwIfRoot(e){if(this._delegate._location.path==="")throw uD(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SD{constructor(e,n){this.app=e,this._delegate=n}get maxOperationRetryTime(){return this._delegate.maxOperationRetryTime}get maxUploadRetryTime(){return this._delegate.maxUploadRetryTime}ref(e){if(AS(e))throw Aa("ref() expected a child path but got a URL, use refFromURL instead.");return new dr(TS(this._delegate,e),this)}refFromURL(e){if(!AS(e))throw Aa("refFromURL() expected a full URL but got a child path, use ref() instead.");try{Xt.makeFromUrl(e,this._delegate.host)}catch{throw Aa("refFromUrl() expected a valid full URL but got an invalid one.")}return new dr(TS(this._delegate,e),this)}setMaxUploadRetryTime(e){this._delegate.maxUploadRetryTime=e}setMaxOperationRetryTime(e){this._delegate.maxOperationRetryTime=e}useEmulator(e,n,s={}){GX(this._delegate,e,n,s)}}function AS(t){return/^[A-Za-z]+:\/\//.test(t)}const YX="@firebase/storage-compat",JX="0.1.17";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XX="storage-compat";function ZX(t,{instanceIdentifier:e}){const n=t.getProvider("app-compat").getImmediate(),s=t.getProvider("storage").getImmediate({identifier:e});return new SD(n,s)}function e8(t){const e={TaskState:an,TaskEvent:TX,StringFormat:Gn,Storage:SD,Reference:dr};t.INTERNAL.registerComponent(new Ae(XX,ZX,"PUBLIC").setServiceProps(e).setMultipleInstances(!0)),t.registerVersion(YX,JX)}e8(ut);const kS="@firebase/performance",R_="0.5.12";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CD=R_,t8="FB-PERF-TRACE-START",n8="FB-PERF-TRACE-STOP",N_="FB-PERF-TRACE-MEASURE",AD="_wt_",kD="_fp",RD="_fcp",ND="_fid",PD="@firebase/performance/config",xD="@firebase/performance/configexpire",s8="performance",DD="Performance";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const r8={["trace started"]:"Trace {$traceName} was started before.",["trace stopped"]:"Trace {$traceName} is not running.",["nonpositive trace startTime"]:"Trace {$traceName} startTime should be positive.",["nonpositive trace duration"]:"Trace {$traceName} duration should be positive.",["no window"]:"Window is not available.",["no app id"]:"App id is not available.",["no project id"]:"Project id is not available.",["no api key"]:"Api key is not available.",["invalid cc log"]:"Attempted to queue invalid cc event",["FB not default"]:"Performance can only start when Firebase app instance is the default one.",["RC response not ok"]:"RC response is not ok",["invalid attribute name"]:"Attribute name {$attributeName} is invalid.",["invalid attribute value"]:"Attribute value {$attributeValue} is invalid.",["invalid custom metric name"]:"Custom metric name {$customMetricName} is invalid",["invalid String merger input"]:"Input for String merger is invalid, contact support team to resolve.",["already initialized"]:"initializePerformance() has already been called with different options. To avoid this error, call initializePerformance() with the same options as when it was originally called, or call getPerformance() to return the already initialized instance."},Jt=new gn(s8,DD,r8);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gs=new Qs(DD);Gs.logLevel=ge.INFO;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Hg,OD;class Nt{constructor(e){if(this.window=e,!e)throw Jt.create("no window");this.performance=e.performance,this.PerformanceObserver=e.PerformanceObserver,this.windowLocation=e.location,this.navigator=e.navigator,this.document=e.document,this.navigator&&this.navigator.cookieEnabled&&(this.localStorage=e.localStorage),e.perfMetrics&&e.perfMetrics.onFirstInputDelay&&(this.onFirstInputDelay=e.perfMetrics.onFirstInputDelay)}getUrl(){return this.windowLocation.href.split("?")[0]}mark(e){!this.performance||!this.performance.mark||this.performance.mark(e)}measure(e,n,s){!this.performance||!this.performance.measure||this.performance.measure(e,n,s)}getEntriesByType(e){return!this.performance||!this.performance.getEntriesByType?[]:this.performance.getEntriesByType(e)}getEntriesByName(e){return!this.performance||!this.performance.getEntriesByName?[]:this.performance.getEntriesByName(e)}getTimeOrigin(){return this.performance&&(this.performance.timeOrigin||this.performance.timing.navigationStart)}requiredApisAvailable(){return!fetch||!Promise||!kf()?(Gs.info("Firebase Performance cannot start if browser does not support fetch and Promise or cookie is disabled."),!1):En()?!0:(Gs.info("IndexedDB is not supported by current browswer"),!1)}setupObserver(e,n){if(!this.PerformanceObserver)return;new this.PerformanceObserver(r=>{for(const i of r.getEntries())n(i)}).observe({entryTypes:[e]})}static getInstance(){return Hg===void 0&&(Hg=new Nt(OD)),Hg}}function i8(t){OD=t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let MD;function o8(t){const e=t.getId();return e.then(n=>{MD=n}),e}function sb(){return MD}function a8(t){const e=t.getToken();return e.then(n=>{}),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function RS(t,e){const n=t.length-e.length;if(n<0||n>1)throw Jt.create("invalid String merger input");const s=[];for(let r=0;r<t.length;r++)s.push(t.charAt(r)),e.length>r&&s.push(e.charAt(r));return s.join("")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Wg;class xn{constructor(){this.instrumentationEnabled=!0,this.dataCollectionEnabled=!0,this.loggingEnabled=!1,this.tracesSamplingRate=1,this.networkRequestsSamplingRate=1,this.logEndPointUrl="https://firebaselogging.googleapis.com/v0cc/log?format=json_proto",this.flTransportEndpointUrl=RS("hts/frbslgigp.ogepscmv/ieo/eaylg","tp:/ieaeogn-agolai.o/1frlglgc/o"),this.transportKey=RS("AzSC8r6ReiGqFMyfvgow","Iayx0u-XT3vksVM-pIV"),this.logSource=462,this.logTraceAfterSampling=!1,this.logNetworkAfterSampling=!1,this.configTimeToLive=12}getFlTransportFullUrl(){return this.flTransportEndpointUrl.concat("?key=",this.transportKey)}static getInstance(){return Wg===void 0&&(Wg=new xn),Wg}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ka;(function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.VISIBLE=1]="VISIBLE",t[t.HIDDEN=2]="HIDDEN"})(ka||(ka={}));const c8=["firebase_","google_","ga_"],l8=new RegExp("^[a-zA-Z]\\w*$"),u8=40,h8=100;function d8(){const t=Nt.getInstance().navigator;return"serviceWorker"in t?t.serviceWorker.controller?2:3:1}function LD(){switch(Nt.getInstance().document.visibilityState){case"visible":return ka.VISIBLE;case"hidden":return ka.HIDDEN;default:return ka.UNKNOWN}}function f8(){const e=Nt.getInstance().navigator.connection;switch(e&&e.effectiveType){case"slow-2g":return 1;case"2g":return 2;case"3g":return 3;case"4g":return 4;default:return 0}}function p8(t){return t.length===0||t.length>u8?!1:!c8.some(n=>t.startsWith(n))&&!!t.match(l8)}function g8(t){return t.length!==0&&t.length<=h8}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function FD(t){var e;const n=(e=t.options)===null||e===void 0?void 0:e.appId;if(!n)throw Jt.create("no app id");return n}function m8(t){var e;const n=(e=t.options)===null||e===void 0?void 0:e.projectId;if(!n)throw Jt.create("no project id");return n}function _8(t){var e;const n=(e=t.options)===null||e===void 0?void 0:e.apiKey;if(!n)throw Jt.create("no api key");return n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const y8="0.0.1",ns={loggingEnabled:!0},v8="FIREBASE_INSTALLATIONS_AUTH";function w8(t,e){const n=b8();return n?(NS(n),Promise.resolve()):T8(t,e).then(NS).then(s=>I8(s),()=>{})}function b8(){const t=Nt.getInstance().localStorage;if(!t)return;const e=t.getItem(xD);if(!e||!S8(e))return;const n=t.getItem(PD);if(!!n)try{return JSON.parse(n)}catch{return}}function I8(t){const e=Nt.getInstance().localStorage;!t||!e||(e.setItem(PD,JSON.stringify(t)),e.setItem(xD,String(Date.now()+xn.getInstance().configTimeToLive*60*60*1e3)))}const E8="Could not fetch config, will use default configs";function T8(t,e){return a8(t.installations).then(n=>{const s=m8(t.app),r=_8(t.app),i=`https://firebaseremoteconfig.googleapis.com/v1/projects/${s}/namespaces/fireperf:fetch?key=${r}`,o=new Request(i,{method:"POST",headers:{Authorization:`${v8} ${n}`},body:JSON.stringify({app_instance_id:e,app_instance_id_token:n,app_id:FD(t.app),app_version:CD,sdk_version:y8})});return fetch(o).then(a=>{if(a.ok)return a.json();throw Jt.create("RC response not ok")})}).catch(()=>{Gs.info(E8)})}function NS(t){if(!t)return t;const e=xn.getInstance(),n=t.entries||{};return n.fpr_enabled!==void 0?e.loggingEnabled=String(n.fpr_enabled)==="true":e.loggingEnabled=ns.loggingEnabled,n.fpr_log_source?e.logSource=Number(n.fpr_log_source):ns.logSource&&(e.logSource=ns.logSource),n.fpr_log_endpoint_url?e.logEndPointUrl=n.fpr_log_endpoint_url:ns.logEndPointUrl&&(e.logEndPointUrl=ns.logEndPointUrl),n.fpr_log_transport_key?e.transportKey=n.fpr_log_transport_key:ns.transportKey&&(e.transportKey=ns.transportKey),n.fpr_vc_network_request_sampling_rate!==void 0?e.networkRequestsSamplingRate=Number(n.fpr_vc_network_request_sampling_rate):ns.networkRequestsSamplingRate!==void 0&&(e.networkRequestsSamplingRate=ns.networkRequestsSamplingRate),n.fpr_vc_trace_sampling_rate!==void 0?e.tracesSamplingRate=Number(n.fpr_vc_trace_sampling_rate):ns.tracesSamplingRate!==void 0&&(e.tracesSamplingRate=ns.tracesSamplingRate),e.logTraceAfterSampling=PS(e.tracesSamplingRate),e.logNetworkAfterSampling=PS(e.networkRequestsSamplingRate),t}function S8(t){return Number(t)>Date.now()}function PS(t){return Math.random()<=t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let rb=1,Gg;function UD(t){return rb=2,Gg=Gg||A8(t),Gg}function C8(){return rb===3}function A8(t){return k8().then(()=>o8(t.installations)).then(e=>w8(t,e)).then(()=>xS(),()=>xS())}function k8(){const t=Nt.getInstance().document;return new Promise(e=>{if(t&&t.readyState!=="complete"){const n=()=>{t.readyState==="complete"&&(t.removeEventListener("readystatechange",n),e())};t.addEventListener("readystatechange",n)}else e()})}function xS(){rb=3}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ib=10*1e3,R8=5.5*1e3,$D=3,N8=1e3;let af=$D,Zr=[],DS=!1;function P8(){DS||(Hp(R8),DS=!0)}function Hp(t){setTimeout(()=>{if(af!==0){if(!Zr.length)return Hp(ib);x8()}},t)}function x8(){const t=Zr.splice(0,N8),e=t.map(s=>({source_extension_json_proto3:s.message,event_time_ms:String(s.eventTime)})),n={request_time_ms:String(Date.now()),client_info:{client_type:1,js_client_info:{}},log_source:xn.getInstance().logSource,log_event:e};D8(n,t).catch(()=>{Zr=[...t,...Zr],af--,Gs.info(`Tries left: ${af}.`),Hp(ib)})}function D8(t,e){return O8(t).then(n=>(n.ok||Gs.info("Call to Firebase backend failed."),n.json())).then(n=>{const s=Number(n.nextRequestWaitMillis);let r=ib;isNaN(s)||(r=Math.max(s,r));const i=n.logResponseDetails;Array.isArray(i)&&i.length>0&&i[0].responseAction==="RETRY_REQUEST_LATER"&&(Zr=[...e,...Zr],Gs.info("Retry transport request later.")),af=$D,Hp(r)})}function O8(t){const e=xn.getInstance().getFlTransportFullUrl();return fetch(e,{method:"POST",body:JSON.stringify(t)})}function M8(t){if(!t.eventTime||!t.message)throw Jt.create("invalid cc log");Zr=[...Zr,t]}function L8(t){return(...e)=>{const n=t(...e);M8({message:n,eventTime:Date.now()})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let zg;function VD(t,e){zg||(zg=L8(U8)),zg(t,e)}function Rh(t){const e=xn.getInstance();!e.instrumentationEnabled&&t.isAuto||!e.dataCollectionEnabled&&!t.isAuto||!Nt.getInstance().requiredApisAvailable()||t.isAuto&&LD()!==ka.VISIBLE||(C8()?Qg(t):UD(t.performanceController).then(()=>Qg(t),()=>Qg(t)))}function Qg(t){if(!sb())return;const e=xn.getInstance();!e.loggingEnabled||!e.logTraceAfterSampling||setTimeout(()=>VD(t,1),0)}function F8(t){const e=xn.getInstance();if(!e.instrumentationEnabled)return;const n=t.url,s=e.logEndPointUrl.split("?")[0],r=e.flTransportEndpointUrl.split("?")[0];n===s||n===r||!e.loggingEnabled||!e.logNetworkAfterSampling||setTimeout(()=>VD(t,0),0)}function U8(t,e){return e===0?$8(t):V8(t)}function $8(t){const e={url:t.url,http_method:t.httpMethod||0,http_response_code:200,response_payload_bytes:t.responsePayloadBytes,client_start_time_us:t.startTimeUs,time_to_response_initiated_us:t.timeToResponseInitiatedUs,time_to_response_completed_us:t.timeToResponseCompletedUs},n={application_info:BD(t.performanceController.app),network_request_metric:e};return JSON.stringify(n)}function V8(t){const e={name:t.name,is_auto:t.isAuto,client_start_time_us:t.startTimeUs,duration_us:t.durationUs};Object.keys(t.counters).length!==0&&(e.counters=t.counters);const n=t.getAttributes();Object.keys(n).length!==0&&(e.custom_attributes=n);const s={application_info:BD(t.performanceController.app),trace_metric:e};return JSON.stringify(s)}function BD(t){return{google_app_id:FD(t),app_instance_id:sb(),web_app_info:{sdk_version:CD,page_url:Nt.getInstance().getUrl(),service_worker_status:d8(),visibility_state:LD(),effective_connection_type:f8()},application_process_state:0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const B8=100,j8="_",q8=[kD,RD,ND];function K8(t,e){return t.length===0||t.length>B8?!1:e&&e.startsWith(AD)&&q8.indexOf(t)>-1||!t.startsWith(j8)}function H8(t){const e=Math.floor(t);return e<t&&Gs.info(`Metric value should be an Integer, setting the value as : ${e}.`),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ei{constructor(e,n,s=!1,r){this.performanceController=e,this.name=n,this.isAuto=s,this.state=1,this.customAttributes={},this.counters={},this.api=Nt.getInstance(),this.randomId=Math.floor(Math.random()*1e6),this.isAuto||(this.traceStartMark=`${t8}-${this.randomId}-${this.name}`,this.traceStopMark=`${n8}-${this.randomId}-${this.name}`,this.traceMeasure=r||`${N_}-${this.randomId}-${this.name}`,r&&this.calculateTraceMetrics())}start(){if(this.state!==1)throw Jt.create("trace started",{traceName:this.name});this.api.mark(this.traceStartMark),this.state=2}stop(){if(this.state!==2)throw Jt.create("trace stopped",{traceName:this.name});this.state=3,this.api.mark(this.traceStopMark),this.api.measure(this.traceMeasure,this.traceStartMark,this.traceStopMark),this.calculateTraceMetrics(),Rh(this)}record(e,n,s){if(e<=0)throw Jt.create("nonpositive trace startTime",{traceName:this.name});if(n<=0)throw Jt.create("nonpositive trace duration",{traceName:this.name});if(this.durationUs=Math.floor(n*1e3),this.startTimeUs=Math.floor(e*1e3),s&&s.attributes&&(this.customAttributes=Object.assign({},s.attributes)),s&&s.metrics)for(const r of Object.keys(s.metrics))isNaN(Number(s.metrics[r]))||(this.counters[r]=Math.floor(Number(s.metrics[r])));Rh(this)}incrementMetric(e,n=1){this.counters[e]===void 0?this.putMetric(e,n):this.putMetric(e,this.counters[e]+n)}putMetric(e,n){if(K8(e,this.name))this.counters[e]=H8(n!=null?n:0);else throw Jt.create("invalid custom metric name",{customMetricName:e})}getMetric(e){return this.counters[e]||0}putAttribute(e,n){const s=p8(e),r=g8(n);if(s&&r){this.customAttributes[e]=n;return}if(!s)throw Jt.create("invalid attribute name",{attributeName:e});if(!r)throw Jt.create("invalid attribute value",{attributeValue:n})}getAttribute(e){return this.customAttributes[e]}removeAttribute(e){this.customAttributes[e]!==void 0&&delete this.customAttributes[e]}getAttributes(){return Object.assign({},this.customAttributes)}setStartTime(e){this.startTimeUs=e}setDuration(e){this.durationUs=e}calculateTraceMetrics(){const e=this.api.getEntriesByName(this.traceMeasure),n=e&&e[0];n&&(this.durationUs=Math.floor(n.duration*1e3),this.startTimeUs=Math.floor((n.startTime+this.api.getTimeOrigin())*1e3))}static createOobTrace(e,n,s,r){const i=Nt.getInstance().getUrl();if(!i)return;const o=new ei(e,AD+i,!0),a=Math.floor(Nt.getInstance().getTimeOrigin()*1e3);o.setStartTime(a),n&&n[0]&&(o.setDuration(Math.floor(n[0].duration*1e3)),o.putMetric("domInteractive",Math.floor(n[0].domInteractive*1e3)),o.putMetric("domContentLoadedEventEnd",Math.floor(n[0].domContentLoadedEventEnd*1e3)),o.putMetric("loadEventEnd",Math.floor(n[0].loadEventEnd*1e3)));const c="first-paint",l="first-contentful-paint";if(s){const u=s.find(d=>d.name===c);u&&u.startTime&&o.putMetric(kD,Math.floor(u.startTime*1e3));const h=s.find(d=>d.name===l);h&&h.startTime&&o.putMetric(RD,Math.floor(h.startTime*1e3)),r&&o.putMetric(ND,Math.floor(r*1e3))}Rh(o)}static createUserTimingTrace(e,n){const s=new ei(e,n,!1,n);Rh(s)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function OS(t,e){const n=e;if(!n||n.responseStart===void 0)return;const s=Nt.getInstance().getTimeOrigin(),r=Math.floor((n.startTime+s)*1e3),i=n.responseStart?Math.floor((n.responseStart-n.startTime)*1e3):void 0,o=Math.floor((n.responseEnd-n.startTime)*1e3),a=n.name&&n.name.split("?")[0],c={performanceController:t,url:a,responsePayloadBytes:n.transferSize,startTimeUs:r,timeToResponseInitiatedUs:i,timeToResponseCompletedUs:o};F8(c)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const W8=5e3;function MS(t){!sb()||(setTimeout(()=>z8(t),0),setTimeout(()=>G8(t),0),setTimeout(()=>Q8(t),0))}function G8(t){const e=Nt.getInstance(),n=e.getEntriesByType("resource");for(const s of n)OS(t,s);e.setupObserver("resource",s=>OS(t,s))}function z8(t){const e=Nt.getInstance(),n=e.getEntriesByType("navigation"),s=e.getEntriesByType("paint");if(e.onFirstInputDelay){let r=setTimeout(()=>{ei.createOobTrace(t,n,s),r=void 0},W8);e.onFirstInputDelay(i=>{r&&(clearTimeout(r),ei.createOobTrace(t,n,s,i))})}else ei.createOobTrace(t,n,s)}function Q8(t){const e=Nt.getInstance(),n=e.getEntriesByType("measure");for(const s of n)LS(t,s);e.setupObserver("measure",s=>LS(t,s))}function LS(t,e){const n=e.name;n.substring(0,N_.length)!==N_&&ei.createUserTimingTrace(t,n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y8{constructor(e,n){this.app=e,this.installations=n,this.initialized=!1}_init(e){this.initialized||((e==null?void 0:e.dataCollectionEnabled)!==void 0&&(this.dataCollectionEnabled=e.dataCollectionEnabled),(e==null?void 0:e.instrumentationEnabled)!==void 0&&(this.instrumentationEnabled=e.instrumentationEnabled),Nt.getInstance().requiredApisAvailable()?Tu().then(n=>{n&&(P8(),UD(this).then(()=>MS(this),()=>MS(this)),this.initialized=!0)}).catch(n=>{Gs.info(`Environment doesn't support IndexedDB: ${n}`)}):Gs.info('Firebase Performance cannot start if the browser does not support "Fetch" and "Promise", or cookies are disabled.'))}set instrumentationEnabled(e){xn.getInstance().instrumentationEnabled=e}get instrumentationEnabled(){return xn.getInstance().instrumentationEnabled}set dataCollectionEnabled(e){xn.getInstance().dataCollectionEnabled=e}get dataCollectionEnabled(){return xn.getInstance().dataCollectionEnabled}}const J8="[DEFAULT]";function X8(t,e){return t=N(t),new ei(t,e)}const Z8=(t,{options:e})=>{const n=t.getProvider("app").getImmediate(),s=t.getProvider("installations-internal").getImmediate();if(n.name!==J8)throw Jt.create("FB not default");if(typeof window>"u")throw Jt.create("no window");i8(window);const r=new Y8(n,s);return r._init(e),r};function e9(){rt(new Ae("performance",Z8,"PUBLIC")),$e(kS,R_),$e(kS,R_,"esm2017")}e9();/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class t9{constructor(e,n){this.app=e,this._delegate=n}get instrumentationEnabled(){return this._delegate.instrumentationEnabled}set instrumentationEnabled(e){this._delegate.instrumentationEnabled=e}get dataCollectionEnabled(){return this._delegate.dataCollectionEnabled}set dataCollectionEnabled(e){this._delegate.dataCollectionEnabled=e}trace(e){return X8(this._delegate,e)}}const n9="@firebase/performance-compat",s9="0.1.12";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function r9(t){t.INTERNAL.registerComponent(new Ae("performance-compat",i9,"PUBLIC")),t.registerVersion(n9,s9)}function i9(t){const e=t.getProvider("app-compat").getImmediate(),n=t.getProvider("performance").getImmediate();return new t9(e,n)}r9(ut);const Yg="@firebase/remote-config",FS="0.3.11";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class o9{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const a9="remote-config";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const c9={["registration-window"]:"Undefined window object. This SDK only supports usage in a browser environment.",["registration-project-id"]:"Undefined project identifier. Check Firebase app initialization.",["registration-api-key"]:"Undefined API key. Check Firebase app initialization.",["registration-app-id"]:"Undefined app identifier. Check Firebase app initialization.",["storage-open"]:"Error thrown when opening storage. Original error: {$originalErrorMessage}.",["storage-get"]:"Error thrown when reading from storage. Original error: {$originalErrorMessage}.",["storage-set"]:"Error thrown when writing to storage. Original error: {$originalErrorMessage}.",["storage-delete"]:"Error thrown when deleting from storage. Original error: {$originalErrorMessage}.",["fetch-client-network"]:"Fetch client failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.",["fetch-timeout"]:'The config fetch request timed out.  Configure timeout using "fetchTimeoutMillis" SDK setting.',["fetch-throttle"]:'The config fetch request timed out while in an exponential backoff state. Configure timeout using "fetchTimeoutMillis" SDK setting. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.',["fetch-client-parse"]:"Fetch client could not parse response. Original error: {$originalErrorMessage}.",["fetch-status"]:"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.",["indexed-db-unavailable"]:"Indexed DB is not supported by current browser"},yn=new gn("remoteconfig","Remote Config",c9);function l9(t,e){return t instanceof et&&t.code.indexOf(e)!==-1}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const u9=!1,h9="",US=0,d9=["1","true","t","yes","y","on"];class Jg{constructor(e,n=h9){this._source=e,this._value=n}asString(){return this._value}asBoolean(){return this._source==="static"?u9:d9.indexOf(this._value.toLowerCase())>=0}asNumber(){if(this._source==="static")return US;let e=Number(this._value);return isNaN(e)&&(e=US),e}getSource(){return this._source}}async function jD(t){const e=N(t),[n,s]=await Promise.all([e._storage.getLastSuccessfulFetchResponse(),e._storage.getActiveConfigEtag()]);return!n||!n.config||!n.eTag||n.eTag===s?!1:(await Promise.all([e._storageCache.setActiveConfig(n.config),e._storage.setActiveConfigEtag(n.eTag)]),!0)}function qD(t){const e=N(t);return e._initializePromise||(e._initializePromise=e._storageCache.loadFromStorage().then(()=>{e._isInitializationComplete=!0})),e._initializePromise}async function KD(t){const e=N(t),n=new o9;setTimeout(async()=>{n.abort()},e.settings.fetchTimeoutMillis);try{await e._client.fetch({cacheMaxAgeMillis:e.settings.minimumFetchIntervalMillis,signal:n}),await e._storageCache.setLastFetchStatus("success")}catch(s){const r=l9(s,"fetch-throttle")?"throttle":"failure";throw await e._storageCache.setLastFetchStatus(r),s}}function f9(t){const e=N(t);return y9(e._storageCache.getActiveConfig(),e.defaultConfig).reduce((n,s)=>(n[s]=oh(t,s),n),{})}function p9(t,e){return oh(N(t),e).asBoolean()}function g9(t,e){return oh(N(t),e).asNumber()}function m9(t,e){return oh(N(t),e).asString()}function oh(t,e){const n=N(t);n._isInitializationComplete||n._logger.debug(`A value was requested for key "${e}" before SDK initialization completed. Await on ensureInitialized if the intent was to get a previously activated value.`);const s=n._storageCache.getActiveConfig();return s&&s[e]!==void 0?new Jg("remote",s[e]):n.defaultConfig&&n.defaultConfig[e]!==void 0?new Jg("default",String(n.defaultConfig[e])):(n._logger.debug(`Returning static value for key "${e}". Define a default or remote value if this is unintentional.`),new Jg("static"))}function _9(t,e){const n=N(t);switch(e){case"debug":n._logger.logLevel=ge.DEBUG;break;case"silent":n._logger.logLevel=ge.SILENT;break;default:n._logger.logLevel=ge.ERROR}}function y9(t={},e={}){return Object.keys(Object.assign(Object.assign({},t),e))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class v9{constructor(e,n,s,r){this.client=e,this.storage=n,this.storageCache=s,this.logger=r}isCachedDataFresh(e,n){if(!n)return this.logger.debug("Config fetch cache check. Cache unpopulated."),!1;const s=Date.now()-n,r=s<=e;return this.logger.debug(`Config fetch cache check. Cache age millis: ${s}. Cache max age millis (minimumFetchIntervalMillis setting): ${e}. Is cache hit: ${r}.`),r}async fetch(e){const[n,s]=await Promise.all([this.storage.getLastSuccessfulFetchTimestampMillis(),this.storage.getLastSuccessfulFetchResponse()]);if(s&&this.isCachedDataFresh(e.cacheMaxAgeMillis,n))return s;e.eTag=s&&s.eTag;const r=await this.client.fetch(e),i=[this.storageCache.setLastSuccessfulFetchTimestampMillis(Date.now())];return r.status===200&&i.push(this.storage.setLastSuccessfulFetchResponse(r)),await Promise.all(i),r}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function w9(t=navigator){return t.languages&&t.languages[0]||t.language}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b9{constructor(e,n,s,r,i,o){this.firebaseInstallations=e,this.sdkVersion=n,this.namespace=s,this.projectId=r,this.apiKey=i,this.appId=o}async fetch(e){var n,s,r;const[i,o]=await Promise.all([this.firebaseInstallations.getId(),this.firebaseInstallations.getToken()]),c=`${window.FIREBASE_REMOTE_CONFIG_URL_BASE||"https://firebaseremoteconfig.googleapis.com"}/v1/projects/${this.projectId}/namespaces/${this.namespace}:fetch?key=${this.apiKey}`,l={"Content-Type":"application/json","Content-Encoding":"gzip","If-None-Match":e.eTag||"*"},u={sdk_version:this.sdkVersion,app_instance_id:i,app_instance_id_token:o,app_id:this.appId,language_code:w9()},h={method:"POST",headers:l,body:JSON.stringify(u)},d=fetch(c,h),f=new Promise((E,S)=>{e.signal.addEventListener(()=>{const H=new Error("The operation was aborted.");H.name="AbortError",S(H)})});let p;try{await Promise.race([d,f]),p=await d}catch(E){let S="fetch-client-network";throw((n=E)===null||n===void 0?void 0:n.name)==="AbortError"&&(S="fetch-timeout"),yn.create(S,{originalErrorMessage:(s=E)===null||s===void 0?void 0:s.message})}let _=p.status;const y=p.headers.get("ETag")||void 0;let T,I;if(p.status===200){let E;try{E=await p.json()}catch(S){throw yn.create("fetch-client-parse",{originalErrorMessage:(r=S)===null||r===void 0?void 0:r.message})}T=E.entries,I=E.state}if(I==="INSTANCE_STATE_UNSPECIFIED"?_=500:I==="NO_CHANGE"?_=304:(I==="NO_TEMPLATE"||I==="EMPTY_CONFIG")&&(T={}),_!==304&&_!==200)throw yn.create("fetch-status",{httpStatus:_});return{status:_,eTag:y,config:T}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function I9(t,e){return new Promise((n,s)=>{const r=Math.max(e-Date.now(),0),i=setTimeout(n,r);t.addEventListener(()=>{clearTimeout(i),s(yn.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}function E9(t){if(!(t instanceof et)||!t.customData)return!1;const e=Number(t.customData.httpStatus);return e===429||e===500||e===503||e===504}class T9{constructor(e,n){this.client=e,this.storage=n}async fetch(e){const n=await this.storage.getThrottleMetadata()||{backoffCount:0,throttleEndTimeMillis:Date.now()};return this.attemptFetch(e,n)}async attemptFetch(e,{throttleEndTimeMillis:n,backoffCount:s}){await I9(e.signal,n);try{const r=await this.client.fetch(e);return await this.storage.deleteThrottleMetadata(),r}catch(r){if(!E9(r))throw r;const i={throttleEndTimeMillis:Date.now()+ud(s),backoffCount:s+1};return await this.storage.setThrottleMetadata(i),this.attemptFetch(e,i)}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const S9=60*1e3,C9=12*60*60*1e3;class A9{constructor(e,n,s,r,i){this.app=e,this._client=n,this._storageCache=s,this._storage=r,this._logger=i,this._isInitializationComplete=!1,this.settings={fetchTimeoutMillis:S9,minimumFetchIntervalMillis:C9},this.defaultConfig={}}get fetchTimeMillis(){return this._storageCache.getLastSuccessfulFetchTimestampMillis()||-1}get lastFetchStatus(){return this._storageCache.getLastFetchStatus()||"no-fetch-yet"}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zh(t,e){var n;const s=t.target.error||void 0;return yn.create(e,{originalErrorMessage:s&&((n=s)===null||n===void 0?void 0:n.message)})}const Oi="app_namespace_store",k9="firebase_remote_config",R9=1;function N9(){return new Promise((t,e)=>{var n;try{const s=indexedDB.open(k9,R9);s.onerror=r=>{e(zh(r,"storage-open"))},s.onsuccess=r=>{t(r.target.result)},s.onupgradeneeded=r=>{const i=r.target.result;switch(r.oldVersion){case 0:i.createObjectStore(Oi,{keyPath:"compositeKey"})}}}catch(s){e(yn.create("storage-open",{originalErrorMessage:(n=s)===null||n===void 0?void 0:n.message}))}})}class P9{constructor(e,n,s,r=N9()){this.appId=e,this.appName=n,this.namespace=s,this.openDbPromise=r}getLastFetchStatus(){return this.get("last_fetch_status")}setLastFetchStatus(e){return this.set("last_fetch_status",e)}getLastSuccessfulFetchTimestampMillis(){return this.get("last_successful_fetch_timestamp_millis")}setLastSuccessfulFetchTimestampMillis(e){return this.set("last_successful_fetch_timestamp_millis",e)}getLastSuccessfulFetchResponse(){return this.get("last_successful_fetch_response")}setLastSuccessfulFetchResponse(e){return this.set("last_successful_fetch_response",e)}getActiveConfig(){return this.get("active_config")}setActiveConfig(e){return this.set("active_config",e)}getActiveConfigEtag(){return this.get("active_config_etag")}setActiveConfigEtag(e){return this.set("active_config_etag",e)}getThrottleMetadata(){return this.get("throttle_metadata")}setThrottleMetadata(e){return this.set("throttle_metadata",e)}deleteThrottleMetadata(){return this.delete("throttle_metadata")}async get(e){const n=await this.openDbPromise;return new Promise((s,r)=>{var i;const a=n.transaction([Oi],"readonly").objectStore(Oi),c=this.createCompositeKey(e);try{const l=a.get(c);l.onerror=u=>{r(zh(u,"storage-get"))},l.onsuccess=u=>{const h=u.target.result;s(h?h.value:void 0)}}catch(l){r(yn.create("storage-get",{originalErrorMessage:(i=l)===null||i===void 0?void 0:i.message}))}})}async set(e,n){const s=await this.openDbPromise;return new Promise((r,i)=>{var o;const c=s.transaction([Oi],"readwrite").objectStore(Oi),l=this.createCompositeKey(e);try{const u=c.put({compositeKey:l,value:n});u.onerror=h=>{i(zh(h,"storage-set"))},u.onsuccess=()=>{r()}}catch(u){i(yn.create("storage-set",{originalErrorMessage:(o=u)===null||o===void 0?void 0:o.message}))}})}async delete(e){const n=await this.openDbPromise;return new Promise((s,r)=>{var i;const a=n.transaction([Oi],"readwrite").objectStore(Oi),c=this.createCompositeKey(e);try{const l=a.delete(c);l.onerror=u=>{r(zh(u,"storage-delete"))},l.onsuccess=()=>{s()}}catch(l){r(yn.create("storage-delete",{originalErrorMessage:(i=l)===null||i===void 0?void 0:i.message}))}})}createCompositeKey(e){return[this.appId,this.appName,this.namespace,e].join()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x9{constructor(e){this.storage=e}getLastFetchStatus(){return this.lastFetchStatus}getLastSuccessfulFetchTimestampMillis(){return this.lastSuccessfulFetchTimestampMillis}getActiveConfig(){return this.activeConfig}async loadFromStorage(){const e=this.storage.getLastFetchStatus(),n=this.storage.getLastSuccessfulFetchTimestampMillis(),s=this.storage.getActiveConfig(),r=await e;r&&(this.lastFetchStatus=r);const i=await n;i&&(this.lastSuccessfulFetchTimestampMillis=i);const o=await s;o&&(this.activeConfig=o)}setLastFetchStatus(e){return this.lastFetchStatus=e,this.storage.setLastFetchStatus(e)}setLastSuccessfulFetchTimestampMillis(e){return this.lastSuccessfulFetchTimestampMillis=e,this.storage.setLastSuccessfulFetchTimestampMillis(e)}setActiveConfig(e){return this.activeConfig=e,this.storage.setActiveConfig(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function D9(){rt(new Ae(a9,t,"PUBLIC").setMultipleInstances(!0)),$e(Yg,FS),$e(Yg,FS,"esm2017");function t(e,{instanceIdentifier:n}){const s=e.getProvider("app").getImmediate(),r=e.getProvider("installations-internal").getImmediate();if(typeof window>"u")throw yn.create("registration-window");if(!En())throw yn.create("indexed-db-unavailable");const{projectId:i,apiKey:o,appId:a}=s.options;if(!i)throw yn.create("registration-project-id");if(!o)throw yn.create("registration-api-key");if(!a)throw yn.create("registration-app-id");n=n||"firebase";const c=new P9(a,s.name,n),l=new x9(c),u=new Qs(Yg);u.logLevel=ge.ERROR;const h=new b9(r,Ys,n,i,o,a),d=new T9(h,c),f=new v9(d,c,l,u),p=new A9(s,f,l,c,u);return qD(p),p}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function O9(t){return t=N(t),await KD(t),jD(t)}async function M9(){if(!En())return!1;try{return await Tu()}catch{return!1}}D9();/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L9{constructor(e,n){this.app=e,this._delegate=n}get defaultConfig(){return this._delegate.defaultConfig}set defaultConfig(e){this._delegate.defaultConfig=e}get fetchTimeMillis(){return this._delegate.fetchTimeMillis}get lastFetchStatus(){return this._delegate.lastFetchStatus}get settings(){return this._delegate.settings}set settings(e){this._delegate.settings=e}activate(){return jD(this._delegate)}ensureInitialized(){return qD(this._delegate)}fetch(){return KD(this._delegate)}fetchAndActivate(){return O9(this._delegate)}getAll(){return f9(this._delegate)}getBoolean(e){return p9(this._delegate,e)}getNumber(e){return g9(this._delegate,e)}getString(e){return m9(this._delegate,e)}getValue(e){return oh(this._delegate,e)}setLogLevel(e){_9(this._delegate,e)}}const F9="@firebase/remote-config-compat",U9="0.1.12";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $9(t){t.INTERNAL.registerComponent(new Ae("remoteConfig-compat",V9,"PUBLIC").setMultipleInstances(!0).setServiceProps({isSupported:M9})),t.registerVersion(F9,U9)}function V9(t,{instanceIdentifier:e}){const n=t.getProvider("app-compat").getImmediate(),s=t.getProvider("remote-config").getImmediate({identifier:e});return new L9(n,s)}$9(ut);var B9="firebase",j9="9.9.2";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ut.registerVersion(B9,j9,"app-compat");var q9="firebase",K9="9.9.2";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */console.warn(`
It looks like you're using the development build of the Firebase JS SDK.
When deploying Firebase apps to production, it is advisable to only import
the individual SDK components you intend to use.

For the module builds, these are available in the following manner
(replace <PACKAGE> with the name of a component - i.e. auth, database, etc):

CommonJS Modules:
const firebase = require('firebase/app');
require('firebase/<PACKAGE>');

ES Modules:
import firebase from 'firebase/app';
import 'firebase/<PACKAGE>';

Typescript:
import firebase from 'firebase/app';
import 'firebase/<PACKAGE>';
`);ut.registerVersion(q9,K9,"compat");var H9=!1;function Nh(t,e,n){return Array.isArray(t)?(t.length=Math.max(t.length,e),t.splice(e,1,n),n):(t[e]=n,n)}function Xg(t,e){if(Array.isArray(t)){t.splice(e,1);return}delete t[e]}/*!
  * pinia v2.0.18
  * (c) 2022 Eduardo San Martin Morote
  * @license MIT
  */let P_;const vu=t=>P_=t,HD=Symbol("pinia");function Oo(t){return t&&typeof t=="object"&&Object.prototype.toString.call(t)==="[object Object]"&&typeof t.toJSON!="function"}var $s;(function(t){t.direct="direct",t.patchObject="patch object",t.patchFunction="patch function"})($s||($s={}));const Wr=typeof window<"u",$S=(()=>typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof global=="object"&&global.global===global?global:typeof globalThis=="object"?globalThis:{HTMLElement:null})();function W9(t,{autoBom:e=!1}={}){return e&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(t.type)?new Blob([String.fromCharCode(65279),t],{type:t.type}):t}function ob(t,e,n){const s=new XMLHttpRequest;s.open("GET",t),s.responseType="blob",s.onload=function(){zD(s.response,e,n)},s.onerror=function(){console.error("could not download file")},s.send()}function WD(t){const e=new XMLHttpRequest;e.open("HEAD",t,!1);try{e.send()}catch{}return e.status>=200&&e.status<=299}function Qh(t){try{t.dispatchEvent(new MouseEvent("click"))}catch{const n=document.createEvent("MouseEvents");n.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),t.dispatchEvent(n)}}const Yh=typeof navigator=="object"?navigator:{userAgent:""},GD=(()=>/Macintosh/.test(Yh.userAgent)&&/AppleWebKit/.test(Yh.userAgent)&&!/Safari/.test(Yh.userAgent))(),zD=Wr?typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype&&!GD?G9:"msSaveOrOpenBlob"in Yh?z9:Q9:()=>{};function G9(t,e="download",n){const s=document.createElement("a");s.download=e,s.rel="noopener",typeof t=="string"?(s.href=t,s.origin!==location.origin?WD(s.href)?ob(t,e,n):(s.target="_blank",Qh(s)):Qh(s)):(s.href=URL.createObjectURL(t),setTimeout(function(){URL.revokeObjectURL(s.href)},4e4),setTimeout(function(){Qh(s)},0))}function z9(t,e="download",n){if(typeof t=="string")if(WD(t))ob(t,e,n);else{const s=document.createElement("a");s.href=t,s.target="_blank",setTimeout(function(){Qh(s)})}else navigator.msSaveOrOpenBlob(W9(t,n),e)}function Q9(t,e,n,s){if(s=s||open("","_blank"),s&&(s.document.title=s.document.body.innerText="downloading..."),typeof t=="string")return ob(t,e,n);const r=t.type==="application/octet-stream",i=/constructor/i.test(String($S.HTMLElement))||"safari"in $S,o=/CriOS\/[\d]+/.test(navigator.userAgent);if((o||r&&i||GD)&&typeof FileReader<"u"){const a=new FileReader;a.onloadend=function(){let c=a.result;if(typeof c!="string")throw s=null,new Error("Wrong reader.result type");c=o?c:c.replace(/^data:[^;]*;/,"data:attachment/file;"),s?s.location.href=c:location.assign(c),s=null},a.readAsDataURL(t)}else{const a=URL.createObjectURL(t);s?s.location.assign(a):location.href=a,s=null,setTimeout(function(){URL.revokeObjectURL(a)},4e4)}}function St(t,e){const n="\u{1F34D} "+t;typeof __VUE_DEVTOOLS_TOAST__=="function"?__VUE_DEVTOOLS_TOAST__(n,e):e==="error"?console.error(n):e==="warn"?console.warn(n):console.log(n)}function ab(t){return"_a"in t&&"install"in t}function QD(){if(!("clipboard"in navigator))return St("Your browser doesn't support the Clipboard API","error"),!0}function YD(t){return t instanceof Error&&t.message.toLowerCase().includes("document is not focused")?(St('You need to activate the "Emulate a focused page" setting in the "Rendering" panel of devtools.',"warn"),!0):!1}async function Y9(t){if(!QD())try{await navigator.clipboard.writeText(JSON.stringify(t.state.value)),St("Global state copied to clipboard.")}catch(e){if(YD(e))return;St("Failed to serialize the state. Check the console for more details.","error"),console.error(e)}}async function J9(t){if(!QD())try{t.state.value=JSON.parse(await navigator.clipboard.readText()),St("Global state pasted from clipboard.")}catch(e){if(YD(e))return;St("Failed to deserialize the state from clipboard. Check the console for more details.","error"),console.error(e)}}async function X9(t){try{zD(new Blob([JSON.stringify(t.state.value)],{type:"text/plain;charset=utf-8"}),"pinia-state.json")}catch(e){St("Failed to export the state as JSON. Check the console for more details.","error"),console.error(e)}}let Xs;function Z9(){Xs||(Xs=document.createElement("input"),Xs.type="file",Xs.accept=".json");function t(){return new Promise((e,n)=>{Xs.onchange=async()=>{const s=Xs.files;if(!s)return e(null);const r=s.item(0);return e(r?{text:await r.text(),file:r}:null)},Xs.oncancel=()=>e(null),Xs.onerror=n,Xs.click()})}return t}async function eZ(t){try{const n=await(await Z9())();if(!n)return;const{text:s,file:r}=n;t.state.value=JSON.parse(s),St(`Global state imported from "${r.name}".`)}catch(e){St("Failed to export the state as JSON. Check the console for more details.","error"),console.error(e)}}function ss(t){return{_custom:{display:t}}}const JD="\u{1F34D} Pinia (root)",x_="_root";function tZ(t){return ab(t)?{id:x_,label:JD}:{id:t.$id,label:t.$id}}function nZ(t){if(ab(t)){const n=Array.from(t._s.keys()),s=t._s;return{state:n.map(i=>({editable:!0,key:i,value:t.state.value[i]})),getters:n.filter(i=>s.get(i)._getters).map(i=>{const o=s.get(i);return{editable:!1,key:i,value:o._getters.reduce((a,c)=>(a[c]=o[c],a),{})}})}}const e={state:Object.keys(t.$state).map(n=>({editable:!0,key:n,value:t.$state[n]}))};return t._getters&&t._getters.length&&(e.getters=t._getters.map(n=>({editable:!1,key:n,value:t[n]}))),t._customProperties.size&&(e.customProperties=Array.from(t._customProperties).map(n=>({editable:!0,key:n,value:t[n]}))),e}function sZ(t){return t?Array.isArray(t)?t.reduce((e,n)=>(e.keys.push(n.key),e.operations.push(n.type),e.oldValue[n.key]=n.oldValue,e.newValue[n.key]=n.newValue,e),{oldValue:{},keys:[],operations:[],newValue:{}}):{operation:ss(t.type),key:ss(t.key),oldValue:t.oldValue,newValue:t.newValue}:{}}function rZ(t){switch(t){case $s.direct:return"mutation";case $s.patchFunction:return"$patch";case $s.patchObject:return"$patch";default:return"unknown"}}let da=!0;const Jh=[],Mi="pinia:mutations",Yt="pinia",cf=t=>"\u{1F34D} "+t;function iZ(t,e){W0({id:"dev.esm.pinia",label:"Pinia \u{1F34D}",logo:"https://pinia.vuejs.org/logo.svg",packageName:"pinia",homepage:"https://pinia.vuejs.org",componentStateTypes:Jh,app:t},n=>{typeof n.now!="function"&&St("You seem to be using an outdated version of Vue Devtools. Are you still using the Beta release instead of the stable one? You can find the links at https://devtools.vuejs.org/guide/installation.html."),n.addTimelineLayer({id:Mi,label:"Pinia \u{1F34D}",color:15064968}),n.addInspector({id:Yt,label:"Pinia \u{1F34D}",icon:"storage",treeFilterPlaceholder:"Search stores",actions:[{icon:"content_copy",action:()=>{Y9(e)},tooltip:"Serialize and copy the state"},{icon:"content_paste",action:async()=>{await J9(e),n.sendInspectorTree(Yt),n.sendInspectorState(Yt)},tooltip:"Replace the state with the content of your clipboard"},{icon:"save",action:()=>{X9(e)},tooltip:"Save the state as a JSON file"},{icon:"folder_open",action:async()=>{await eZ(e),n.sendInspectorTree(Yt),n.sendInspectorState(Yt)},tooltip:"Import the state from a JSON file"}],nodeActions:[{icon:"restore",tooltip:"Reset the state (option store only)",action:s=>{const r=e._s.get(s);r?r._isOptionsAPI?(r.$reset(),St(`Store "${s}" reset.`)):St(`Cannot reset "${s}" store because it's a setup store.`,"warn"):St(`Cannot reset "${s}" store because it wasn't found.`,"warn")}}]}),n.on.inspectComponent((s,r)=>{const i=s.componentInstance&&s.componentInstance.proxy;if(i&&i._pStores){const o=s.componentInstance.proxy._pStores;Object.values(o).forEach(a=>{s.instanceData.state.push({type:cf(a.$id),key:"state",editable:!0,value:a._isOptionsAPI?{_custom:{value:be(a.$state),actions:[{icon:"restore",tooltip:"Reset the state of this store",action:()=>a.$reset()}]}}:Object.keys(a.$state).reduce((c,l)=>(c[l]=a.$state[l],c),{})}),a._getters&&a._getters.length&&s.instanceData.state.push({type:cf(a.$id),key:"getters",editable:!1,value:a._getters.reduce((c,l)=>{try{c[l]=a[l]}catch(u){c[l]=u}return c},{})})})}}),n.on.getInspectorTree(s=>{if(s.app===t&&s.inspectorId===Yt){let r=[e];r=r.concat(Array.from(e._s.values())),s.rootNodes=(s.filter?r.filter(i=>"$id"in i?i.$id.toLowerCase().includes(s.filter.toLowerCase()):JD.toLowerCase().includes(s.filter.toLowerCase())):r).map(tZ)}}),n.on.getInspectorState(s=>{if(s.app===t&&s.inspectorId===Yt){const r=s.nodeId===x_?e:e._s.get(s.nodeId);if(!r)return;r&&(s.state=nZ(r))}}),n.on.editInspectorState((s,r)=>{if(s.app===t&&s.inspectorId===Yt){const i=s.nodeId===x_?e:e._s.get(s.nodeId);if(!i)return St(`store "${s.nodeId}" not found`,"error");const{path:o}=s;ab(i)?o.unshift("state"):(o.length!==1||!i._customProperties.has(o[0])||o[0]in i.$state)&&o.unshift("$state"),da=!1,s.set(i,o,s.state.value),da=!0}}),n.on.editComponentState(s=>{if(s.type.startsWith("\u{1F34D}")){const r=s.type.replace(/^\s*/,""),i=e._s.get(r);if(!i)return St(`store "${r}" not found`,"error");const{path:o}=s;if(o[0]!=="state")return St(`Invalid path for store "${r}":
${o}
Only state can be modified.`);o[0]="$state",da=!1,s.set(i,o,s.state.value),da=!0}})})}function oZ(t,e){Jh.includes(cf(e.$id))||Jh.push(cf(e.$id)),W0({id:"dev.esm.pinia",label:"Pinia \u{1F34D}",logo:"https://pinia.vuejs.org/logo.svg",packageName:"pinia",homepage:"https://pinia.vuejs.org",componentStateTypes:Jh,app:t,settings:{logStoreChanges:{label:"Notify about new/deleted stores",type:"boolean",defaultValue:!0}}},n=>{const s=typeof n.now=="function"?n.now.bind(n):Date.now;e.$onAction(({after:o,onError:a,name:c,args:l})=>{const u=XD++;n.addTimelineEvent({layerId:Mi,event:{time:s(),title:"\u{1F6EB} "+c,subtitle:"start",data:{store:ss(e.$id),action:ss(c),args:l},groupId:u}}),o(h=>{qi=void 0,n.addTimelineEvent({layerId:Mi,event:{time:s(),title:"\u{1F6EC} "+c,subtitle:"end",data:{store:ss(e.$id),action:ss(c),args:l,result:h},groupId:u}})}),a(h=>{qi=void 0,n.addTimelineEvent({layerId:Mi,event:{time:s(),logType:"error",title:"\u{1F4A5} "+c,subtitle:"end",data:{store:ss(e.$id),action:ss(c),args:l,error:h},groupId:u}})})},!0),e._customProperties.forEach(o=>{Zi(()=>ma(e[o]),(a,c)=>{n.notifyComponentUpdate(),n.sendInspectorState(Yt),da&&n.addTimelineEvent({layerId:Mi,event:{time:s(),title:"Change",subtitle:o,data:{newValue:a,oldValue:c},groupId:qi}})},{deep:!0})}),e.$subscribe(({events:o,type:a},c)=>{if(n.notifyComponentUpdate(),n.sendInspectorState(Yt),!da)return;const l={time:s(),title:rZ(a),data:{store:ss(e.$id),...sZ(o)},groupId:qi};qi=void 0,a===$s.patchFunction?l.subtitle="\u2935\uFE0F":a===$s.patchObject?l.subtitle="\u{1F9E9}":o&&!Array.isArray(o)&&(l.subtitle=o.type),o&&(l.data["rawEvent(s)"]={_custom:{display:"DebuggerEvent",type:"object",tooltip:"raw DebuggerEvent[]",value:o}}),n.addTimelineEvent({layerId:Mi,event:l})},{detached:!0,flush:"sync"});const r=e._hotUpdate;e._hotUpdate=is(o=>{r(o),n.addTimelineEvent({layerId:Mi,event:{time:s(),title:"\u{1F525} "+e.$id,subtitle:"HMR update",data:{store:ss(e.$id),info:ss("HMR update")}}}),n.notifyComponentUpdate(),n.sendInspectorTree(Yt),n.sendInspectorState(Yt)});const{$dispose:i}=e;e.$dispose=()=>{i(),n.notifyComponentUpdate(),n.sendInspectorTree(Yt),n.sendInspectorState(Yt),n.getSettings().logStoreChanges&&St(`Disposed "${e.$id}" store \u{1F5D1}`)},n.notifyComponentUpdate(),n.sendInspectorTree(Yt),n.sendInspectorState(Yt),n.getSettings().logStoreChanges&&St(`"${e.$id}" store installed \u{1F195}`)})}let XD=0,qi;function VS(t,e){const n=e.reduce((s,r)=>(s[r]=be(t)[r],s),{});for(const s in n)t[s]=function(){const r=XD,i=new Proxy(t,{get(...o){return qi=r,Reflect.get(...o)},set(...o){return qi=r,Reflect.set(...o)}});return n[s].apply(i,arguments)}}function aZ({app:t,store:e,options:n}){if(!e.$id.startsWith("__hot:")){if(n.state&&(e._isOptionsAPI=!0),typeof n.state=="function"){VS(e,Object.keys(n.actions));const s=e._hotUpdate;be(e)._hotUpdate=function(r){s.apply(this,arguments),VS(e,Object.keys(r._hmrPayload.actions))}}oZ(t,e)}}function cZ(){const t=YS(!0),e=t.run(()=>pf({}));let n=[],s=[];const r=is({install(i){vu(r),r._a=i,i.provide(HD,r),i.config.globalProperties.$pinia=r,Wr&&iZ(i,r),s.forEach(o=>n.push(o)),s=[]},use(i){return!this._a&&!H9?s.push(i):n.push(i),this},_p:n,_a:null,_e:t,_s:new Map,state:e});return Wr&&!0&&typeof Proxy<"u"&&r.use(aZ),r}function ZD(t,e){for(const n in e){const s=e[n];if(!(n in t))continue;const r=t[n];Oo(r)&&Oo(s)&&!nt(s)&&!ar(s)?t[n]=ZD(r,s):t[n]=s}return t}const lZ=()=>{};function BS(t,e,n,s=lZ){t.push(e);const r=()=>{const i=t.indexOf(e);i>-1&&(t.splice(i,1),s())};return!n&&If()&&Z_(r),r}function ra(t,...e){t.slice().forEach(n=>{n(...e)})}function D_(t,e){for(const n in e){if(!e.hasOwnProperty(n))continue;const s=e[n],r=t[n];Oo(r)&&Oo(s)&&t.hasOwnProperty(n)&&!nt(s)&&!ar(s)?t[n]=D_(r,s):t[n]=s}return t}const uZ=Symbol("pinia:skipHydration");function hZ(t){return!Oo(t)||!t.hasOwnProperty(uZ)}const{assign:rs}=Object;function jS(t){return!!(nt(t)&&t.effect)}function qS(t,e,n,s){const{state:r,actions:i,getters:o}=e,a=n.state.value[t];let c;function l(){!a&&!s&&(n.state.value[t]=r?r():{});const u=bb(s?pf(r?r():{}).value:n.state.value[t]);return rs(u,i,Object.keys(o||{}).reduce((h,d)=>(d in u&&console.warn(`[\u{1F34D}]: A getter cannot have the same name as another state property. Rename one of them. Found with "${d}" in store "${t}".`),h[d]=is(Bn(()=>{vu(n);const f=n._s.get(t);return o[d].call(f,f)})),h),{}))}return c=O_(t,l,e,n,s,!0),c.$reset=function(){const h=r?r():{};this.$patch(d=>{rs(d,h)})},c}function O_(t,e,n={},s,r,i){let o;const a=rs({actions:{}},n);if(!s._e.active)throw new Error("Pinia destroyed");const c={deep:!0};c.onTrigger=j=>{l?f=j:l==!1&&!M._hotUpdating&&(Array.isArray(f)?f.push(j):console.error("\u{1F34D} debuggerEvents should be an array. This is most likely an internal Pinia bug."))};let l,u,h=is([]),d=is([]),f;const p=s.state.value[t];!i&&!p&&!r&&(s.state.value[t]={});const _=pf({});let y;function T(j){let F;l=u=!1,f=[],typeof j=="function"?(j(s.state.value[t]),F={type:$s.patchFunction,storeId:t,events:f}):(D_(s.state.value[t],j),F={type:$s.patchObject,payload:j,storeId:t,events:f});const X=y=Symbol();ed().then(()=>{y===X&&(l=!0)}),u=!0,ra(h,F,s.state.value[t])}const I=()=>{throw new Error(`\u{1F34D}: Store "${t}" is built using the setup syntax and does not implement $reset().`)};function E(){o.stop(),h=[],d=[],s._s.delete(t)}function S(j,F){return function(){vu(s);const X=Array.from(arguments),K=[],ve=[];function vt(pe){K.push(pe)}function Zn(pe){ve.push(pe)}ra(d,{args:X,name:j,store:M,after:vt,onError:Zn});let Ne;try{Ne=F.apply(this&&this.$id===t?this:M,X)}catch(pe){throw ra(ve,pe),pe}return Ne instanceof Promise?Ne.then(pe=>(ra(K,pe),pe)).catch(pe=>(ra(ve,pe),Promise.reject(pe))):(ra(K,Ne),Ne)}}const H=is({actions:{},getters:{},state:[],hotState:_}),Y={_p:s,$id:t,$onAction:BS.bind(null,d),$patch:T,$reset:I,$subscribe(j,F={}){const X=BS(h,j,F.detached,()=>K()),K=o.run(()=>Zi(()=>s.state.value[t],ve=>{(F.flush==="sync"?u:l)&&j({storeId:t,type:$s.direct,events:f},ve)},rs({},c,F)));return X},$dispose:E},M=sc(rs(Wr?{_customProperties:is(new Set),_hmrPayload:H}:{},Y));s._s.set(t,M);const G=s._e.run(()=>(o=YS(),o.run(()=>e())));for(const j in G){const F=G[j];if(nt(F)&&!jS(F)||ar(F))r?Nh(_.value,j,Dh(G,j)):i||(p&&hZ(F)&&(nt(F)?F.value=p[j]:D_(F,p[j])),s.state.value[t][j]=F),H.state.push(j);else if(typeof F=="function"){const X=r?F:S(j,F);G[j]=X,H.actions[j]=F,a.actions[j]=F}else jS(F)&&(H.getters[j]=i?n.getters[j]:F,Wr&&(G._getters||(G._getters=is([]))).push(j))}rs(M,G),rs(be(M),G),Object.defineProperty(M,"$state",{get:()=>r?_.value:s.state.value[t],set:j=>{if(r)throw new Error("cannot set hotState");T(F=>{rs(F,j)})}});{M._hotUpdate=is(F=>{M._hotUpdating=!0,F._hmrPayload.state.forEach(X=>{if(X in M.$state){const K=F.$state[X],ve=M.$state[X];typeof K=="object"&&Oo(K)&&Oo(ve)?ZD(K,ve):F.$state[X]=ve}Nh(M,X,Dh(F.$state,X))}),Object.keys(M.$state).forEach(X=>{X in F.$state||Xg(M,X)}),l=!1,u=!1,s.state.value[t]=Dh(F._hmrPayload,"hotState"),u=!0,ed().then(()=>{l=!0});for(const X in F._hmrPayload.actions){const K=F[X];Nh(M,X,S(X,K))}for(const X in F._hmrPayload.getters){const K=F._hmrPayload.getters[X],ve=i?Bn(()=>(vu(s),K.call(M,M))):K;Nh(M,X,ve)}Object.keys(M._hmrPayload.getters).forEach(X=>{X in F._hmrPayload.getters||Xg(M,X)}),Object.keys(M._hmrPayload.actions).forEach(X=>{X in F._hmrPayload.actions||Xg(M,X)}),M._hmrPayload=F._hmrPayload,M._getters=F._getters,M._hotUpdating=!1});const j={writable:!0,configurable:!0,enumerable:!1};Wr&&["_p","_hmrPayload","_getters","_customProperties"].forEach(F=>{Object.defineProperty(M,F,{value:M[F],...j})})}return s._p.forEach(j=>{if(Wr){const F=o.run(()=>j({store:M,app:s._a,pinia:s,options:a}));Object.keys(F||{}).forEach(X=>M._customProperties.add(X)),rs(M,F)}else rs(M,o.run(()=>j({store:M,app:s._a,pinia:s,options:a})))}),M.$state&&typeof M.$state=="object"&&typeof M.$state.constructor=="function"&&!M.$state.constructor.toString().includes("[native code]")&&console.warn(`[\u{1F34D}]: The "state" must be a plain object. It cannot be
	state: () => new MyClass()
Found in store "${M.$id}".`),p&&i&&n.hydrate&&n.hydrate(M.$state,p),l=!0,u=!0,M}function dZ(t,e,n){let s,r;const i=typeof e=="function";typeof t=="string"?(s=t,r=i?n:e):(r=t,s=t.id);function o(a,c){const l=If();if(a=a||l&&Ds(HD),a&&vu(a),!P_)throw new Error(`[\u{1F34D}]: getActivePinia was called with no active Pinia. Did you forget to install pinia?
	const pinia = createPinia()
	app.use(pinia)
This will fail in production.`);a=P_,a._s.has(s)||(i?O_(s,e,r,a):qS(s,r,a),o._pinia=a);const u=a._s.get(s);if(c){const h="__hot:"+s,d=i?O_(h,e,r,a,!0):qS(h,rs({},r),a,!0);c._hotUpdate(d),delete a.state.value[h],a._s.delete(h)}if(Wr&&l&&l.proxy&&!c){const h=l.proxy,d="_pStores"in h?h._pStores:h._pStores={};d[s]=u}return u}return o.$id=s,o}const Ph=dZ({id:"university",state:()=>({univercities:[],key:[],loading:!1}),actions:{getData(){this.loading=!0,this.removeAll(this.univercities,this.univercities.length),ut.firestore().collection("Univercities").orderBy("name").get().then(e=>{e.forEach(s=>{const r=s.data();this.univercities.push(r),this.loading=!1});let n=Object.keys(this.univercities[0]);this.key=n})},removeAll(t,e){t.splice(0,e),this.univercities=t}}});const fZ={name:"ticker",data(){return{tickerData:[{headlines:"Admission open in Comsatas",link:"https://comstas.com"},{headlines:"Today Entry Test in BZU",link:"https://bzu.com"}],ticker:!0}},methods:{isTicker(){this.$route.name=="details"?this.ticker=!1:this.ticker=!0}}},pZ=t=>(Q_("data-v-71222ced"),t=t(),Y_(),t),gZ={key:0},mZ={class:"ticker-wrapper"},_Z=pZ(()=>Je("div",{class:"big-heading"},"News",-1)),yZ={class:"text-update"},vZ=zs("Today Is the Last Date of Admission In Government College University Faisalabad "),wZ=zs("Today Is Entry Test In Comstats University Islamabad"),bZ=zs("Admission Open In Ripah Internation University");function IZ(t,e,n,s,r,i){const o=Ur("router-link");return r.ticker?(Rs(),Na("section",gZ,[Je("div",mZ,[_Z,Je("div",yZ,[Je("ul",null,[Je("li",null,[qe(o,{to:{name:"details",params:{name:"Government-College-University-Faisalabad"}}},{default:cs(()=>[vZ]),_:1})]),Je("li",null,[qe(o,{to:{name:"details",params:{name:"COMSATS-University-Islamabad"}}},{default:cs(()=>[wZ]),_:1})]),Je("li",null,[qe(o,{to:{name:"details",params:{name:"Riphah-International-University"}}},{default:cs(()=>[bZ]),_:1})])])])])])):nl("",!0)}const EZ=bu(fZ,[["render",IZ],["__scopeId","data-v-71222ced"]]),TZ="/Educatia/footer-social/fb.svg",SZ="/Educatia/footer-social/vk.svg",CZ="/Educatia/footer-social/twitter.svg",AZ="/Educatia/footer-social/git.svg",kZ="/Educatia/footer-social/yt.svg",RZ="/Educatia/footer-social/instaa.svg";const NZ={name:"Footer"},PZ=$M('<h1 data-v-66010abe>EDUCATIA</h1><div class="footer-social" data-v-66010abe><a href="https://facebook.com/Dar.Ahmed0" target="_blank" data-v-66010abe><img src="'+TZ+'" alt="Facebook" data-v-66010abe></a><a href="https://vk.com/id548454513" target="_blank" data-v-66010abe><img src="'+SZ+'" alt="VK" data-v-66010abe></a><a href="https://twitter.com/AmmarAhmed961" target="_blank" data-v-66010abe><img src="'+CZ+'" alt="Twitter" data-v-66010abe></a><a href="https://github.com/AA961" target="_blank" data-v-66010abe><img src="'+AZ+'" alt="Github" data-v-66010abe></a><a href="https://www.youtube.com/channel/UCKZnPw6nQ9iag2uqB7vg-Yw" target="_blank" data-v-66010abe><img src="'+kZ+'" alt="Youtube" data-v-66010abe></a><a href="https://Instagram.com/aa961019" target="_blank" data-v-66010abe><img src="'+RZ+'" alt="Youtube" data-v-66010abe></a></div><div class="copyright" data-v-66010abe> Copyright 2022 \xA9 Educatia.Com . All Right <br data-v-66010abe> Reserved. </div>',3),xZ=[PZ];function DZ(t,e,n,s,r,i){return Rs(),Na("footer",null,xZ)}const OZ=bu(NZ,[["render",DZ],["__scopeId","data-v-66010abe"]]);const MZ={components:{NavVue:JL,tickerVue:EZ,mobileNav:dF,footerVue:OZ},data(){return{mainNav:!0,ticker:!0}},methods:{removeAll(){const t=Ph();t.removeAll(t.univercities,t.univercities.length)},getDataFromBase(){const t=Ph();t.univercities.length<1&&(this.removeAll(),t.getData())},checkingScreenSize(){window.innerWidth<760?this.mainNav=!1:this.mainNav=!0}},beforeMount(){this.checkingScreenSize()},mounted(){window.addEventListener("resize",()=>{this.checkingScreenSize()}),Ph().getData()},created(){const t=Ph(),e=setInterval(this.getDataFromBase,7e3);t.univercities.length>1&&clearInterval(e)}};function LZ(t,e,n,s,r,i){const o=Ur("tickerVue"),a=Ur("NavVue"),c=Ur("mobileNav"),l=Ur("router-view"),u=Ur("footerVue");return Rs(),Na(os,null,[r.ticker?(Rs(),Lh(o,{key:0})):nl("",!0),r.mainNav?(Rs(),Lh(a,{key:1})):nl("",!0),r.mainNav?nl("",!0):(Rs(),Lh(c,{key:2})),qe(l),qe(u)],64)}const FZ=bu(MZ,[["render",LZ]]);var UZ="firebase",$Z="9.9.2";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ut.registerVersion(UZ,$Z,"app-compat");const VZ={apiKey:"AIzaSyD2b62AFYQbjcAHQKD_sndun59ZC72lb8E",authDomain:"educatia-170f3.firebaseapp.com",projectId:"educatia-170f3",storageBucket:"educatia-170f3.appspot.com",messagingSenderId:"111445876419",appId:"1:111445876419:web:8c6ca1e04409a7ddf6cc76",measurementId:"G-5KM7Z5KJ8R"};ut.initializeApp(VZ);const cb=E1(FZ),BZ=cZ();cb.use(BZ);cb.use(VL);cb.mount("#app");export{os as F,qZ as K,ry as T,bu as _,Y_ as a,Je as b,Na as c,nl as d,zZ as e,qe as f,Lh as g,HZ as h,cs as i,zs as j,ut as k,YZ as l,QZ as m,GZ as n,Rs as o,Q_ as p,$M as q,Ur as r,jZ as t,Ph as u,WZ as v,KZ as w};
