const hO=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerpolicy&&(s.referrerPolicy=i.referrerpolicy),i.crossorigin==="use-credentials"?s.credentials="include":i.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}};hO();function t_(t,e){const n=Object.create(null),r=t.split(",");for(let i=0;i<r.length;i++)n[r[i]]=!0;return e?i=>!!n[i.toLowerCase()]:i=>!!n[i]}const dO="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",fO=t_(dO);function sS(t){return!!t||t===""}function n_(t){if(ne(t)){const e={};for(let n=0;n<t.length;n++){const r=t[n],i=kt(r)?mO(r):n_(r);if(i)for(const s in i)e[s]=i[s]}return e}else{if(kt(t))return t;if(tt(t))return t}}const pO=/;(?![^(]*\))/g,gO=/:(.+)/;function mO(t){const e={};return t.split(pO).forEach(n=>{if(n){const r=n.split(gO);r.length>1&&(e[r[0].trim()]=r[1].trim())}}),e}function r_(t){let e="";if(kt(t))e=t;else if(ne(t))for(let n=0;n<t.length;n++){const r=r_(t[n]);r&&(e+=r+" ")}else if(tt(t))for(const n in t)t[n]&&(e+=n+" ");return e.trim()}function _O(t,e){if(t.length!==e.length)return!1;let n=!0;for(let r=0;n&&r<t.length;r++)n=la(t[r],e[r]);return n}function la(t,e){if(t===e)return!0;let n=Ow(t),r=Ow(e);if(n||r)return n&&r?t.getTime()===e.getTime():!1;if(n=el(t),r=el(e),n||r)return t===e;if(n=ne(t),r=ne(e),n||r)return n&&r?_O(t,e):!1;if(n=tt(t),r=tt(e),n||r){if(!n||!r)return!1;const i=Object.keys(t).length,s=Object.keys(e).length;if(i!==s)return!1;for(const o in t){const a=t.hasOwnProperty(o),c=e.hasOwnProperty(o);if(a&&!c||!a&&c||!la(t[o],e[o]))return!1}}return String(t)===String(e)}function yO(t,e){return t.findIndex(n=>la(n,e))}const c9=t=>kt(t)?t:t==null?"":ne(t)||tt(t)&&(t.toString===cS||!de(t.toString))?JSON.stringify(t,oS,2):String(t),oS=(t,e)=>e&&e.__v_isRef?oS(t,e.value):Yo(e)?{[`Map(${e.size})`]:[...e.entries()].reduce((n,[r,i])=>(n[`${r} =>`]=i,n),{})}:Od(e)?{[`Set(${e.size})`]:[...e.values()]}:tt(e)&&!ne(e)&&!lS(e)?String(e):e,Fe={},Qo=[],sr=()=>{},vO=()=>!1,wO=/^on[^a-z]/,Dd=t=>wO.test(t),i_=t=>t.startsWith("onUpdate:"),Kt=Object.assign,s_=(t,e)=>{const n=t.indexOf(e);n>-1&&t.splice(n,1)},bO=Object.prototype.hasOwnProperty,Ie=(t,e)=>bO.call(t,e),ne=Array.isArray,Yo=t=>eu(t)==="[object Map]",Od=t=>eu(t)==="[object Set]",Ow=t=>eu(t)==="[object Date]",de=t=>typeof t=="function",kt=t=>typeof t=="string",el=t=>typeof t=="symbol",tt=t=>t!==null&&typeof t=="object",aS=t=>tt(t)&&de(t.then)&&de(t.catch),cS=Object.prototype.toString,eu=t=>cS.call(t),IO=t=>eu(t).slice(8,-1),lS=t=>eu(t)==="[object Object]",o_=t=>kt(t)&&t!=="NaN"&&t[0]!=="-"&&""+parseInt(t,10)===t,uh=t_(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),xd=t=>{const e=Object.create(null);return n=>e[n]||(e[n]=t(n))},EO=/-(\w)/g,Dr=xd(t=>t.replace(EO,(e,n)=>n?n.toUpperCase():"")),TO=/\B([A-Z])/g,vo=xd(t=>t.replace(TO,"-$1").toLowerCase()),Md=xd(t=>t.charAt(0).toUpperCase()+t.slice(1)),mp=xd(t=>t?`on${Md(t)}`:""),tl=(t,e)=>!Object.is(t,e),hh=(t,e)=>{for(let n=0;n<t.length;n++)t[n](e)},Ah=(t,e,n)=>{Object.defineProperty(t,e,{configurable:!0,enumerable:!1,value:n})},nl=t=>{const e=parseFloat(t);return isNaN(e)?t:e};let xw;const SO=()=>xw||(xw=typeof globalThis!="undefined"?globalThis:typeof self!="undefined"?self:typeof window!="undefined"?window:typeof global!="undefined"?global:{});let mr;class uS{constructor(e=!1){this.active=!0,this.effects=[],this.cleanups=[],!e&&mr&&(this.parent=mr,this.index=(mr.scopes||(mr.scopes=[])).push(this)-1)}run(e){if(this.active){const n=mr;try{return mr=this,e()}finally{mr=n}}}on(){mr=this}off(){mr=this.parent}stop(e){if(this.active){let n,r;for(n=0,r=this.effects.length;n<r;n++)this.effects[n].stop();for(n=0,r=this.cleanups.length;n<r;n++)this.cleanups[n]();if(this.scopes)for(n=0,r=this.scopes.length;n<r;n++)this.scopes[n].stop(!0);if(this.parent&&!e){const i=this.parent.scopes.pop();i&&i!==this&&(this.parent.scopes[this.index]=i,i.index=this.index)}this.active=!1}}}function hS(t){return new uS(t)}function CO(t,e=mr){e&&e.active&&e.effects.push(t)}const a_=t=>{const e=new Set(t);return e.w=0,e.n=0,e},dS=t=>(t.w&qi)>0,fS=t=>(t.n&qi)>0,AO=({deps:t})=>{if(t.length)for(let e=0;e<t.length;e++)t[e].w|=qi},kO=t=>{const{deps:e}=t;if(e.length){let n=0;for(let r=0;r<e.length;r++){const i=e[r];dS(i)&&!fS(i)?i.delete(t):e[n++]=i,i.w&=~qi,i.n&=~qi}e.length=n}},vg=new WeakMap;let Ec=0,qi=1;const wg=30;let er;const Vs=Symbol(""),bg=Symbol("");class c_{constructor(e,n=null,r){this.fn=e,this.scheduler=n,this.active=!0,this.deps=[],this.parent=void 0,CO(this,r)}run(){if(!this.active)return this.fn();let e=er,n=xi;for(;e;){if(e===this)return;e=e.parent}try{return this.parent=er,er=this,xi=!0,qi=1<<++Ec,Ec<=wg?AO(this):Mw(this),this.fn()}finally{Ec<=wg&&kO(this),qi=1<<--Ec,er=this.parent,xi=n,this.parent=void 0,this.deferStop&&this.stop()}}stop(){er===this?this.deferStop=!0:this.active&&(Mw(this),this.onStop&&this.onStop(),this.active=!1)}}function Mw(t){const{deps:e}=t;if(e.length){for(let n=0;n<e.length;n++)e[n].delete(t);e.length=0}}let xi=!0;const pS=[];function xa(){pS.push(xi),xi=!1}function Ma(){const t=pS.pop();xi=t===void 0?!0:t}function Pn(t,e,n){if(xi&&er){let r=vg.get(t);r||vg.set(t,r=new Map);let i=r.get(n);i||r.set(n,i=a_()),gS(i)}}function gS(t,e){let n=!1;Ec<=wg?fS(t)||(t.n|=qi,n=!dS(t)):n=!t.has(er),n&&(t.add(er),er.deps.push(t))}function ri(t,e,n,r,i,s){const o=vg.get(t);if(!o)return;let a=[];if(e==="clear")a=[...o.values()];else if(n==="length"&&ne(t))o.forEach((c,l)=>{(l==="length"||l>=r)&&a.push(c)});else switch(n!==void 0&&a.push(o.get(n)),e){case"add":ne(t)?o_(n)&&a.push(o.get("length")):(a.push(o.get(Vs)),Yo(t)&&a.push(o.get(bg)));break;case"delete":ne(t)||(a.push(o.get(Vs)),Yo(t)&&a.push(o.get(bg)));break;case"set":Yo(t)&&a.push(o.get(Vs));break}if(a.length===1)a[0]&&Ig(a[0]);else{const c=[];for(const l of a)l&&c.push(...l);Ig(a_(c))}}function Ig(t,e){const n=ne(t)?t:[...t];for(const r of n)r.computed&&Lw(r);for(const r of n)r.computed||Lw(r)}function Lw(t,e){(t!==er||t.allowRecurse)&&(t.scheduler?t.scheduler():t.run())}const RO=t_("__proto__,__v_isRef,__isVue"),mS=new Set(Object.getOwnPropertyNames(Symbol).filter(t=>t!=="arguments"&&t!=="caller").map(t=>Symbol[t]).filter(el)),NO=l_(),PO=l_(!1,!0),DO=l_(!0),Fw=OO();function OO(){const t={};return["includes","indexOf","lastIndexOf"].forEach(e=>{t[e]=function(...n){const r=ke(this);for(let s=0,o=this.length;s<o;s++)Pn(r,"get",s+"");const i=r[e](...n);return i===-1||i===!1?r[e](...n.map(ke)):i}}),["push","pop","shift","unshift","splice"].forEach(e=>{t[e]=function(...n){xa();const r=ke(this)[e].apply(this,n);return Ma(),r}}),t}function l_(t=!1,e=!1){return function(r,i,s){if(i==="__v_isReactive")return!t;if(i==="__v_isReadonly")return t;if(i==="__v_isShallow")return e;if(i==="__v_raw"&&s===(t?e?QO:bS:e?wS:vS).get(r))return r;const o=ne(r);if(!t&&o&&Ie(Fw,i))return Reflect.get(Fw,i,s);const a=Reflect.get(r,i,s);return(el(i)?mS.has(i):RO(i))||(t||Pn(r,"get",i),e)?a:at(a)?o&&o_(i)?a:a.value:tt(a)?t?IS(a):La(a):a}}const xO=_S(),MO=_S(!0);function _S(t=!1){return function(n,r,i,s){let o=n[r];if(rl(o)&&at(o)&&!at(i))return!1;if(!t&&!rl(i)&&(Eg(i)||(i=ke(i),o=ke(o)),!ne(n)&&at(o)&&!at(i)))return o.value=i,!0;const a=ne(n)&&o_(r)?Number(r)<n.length:Ie(n,r),c=Reflect.set(n,r,i,s);return n===ke(s)&&(a?tl(i,o)&&ri(n,"set",r,i):ri(n,"add",r,i)),c}}function LO(t,e){const n=Ie(t,e);t[e];const r=Reflect.deleteProperty(t,e);return r&&n&&ri(t,"delete",e,void 0),r}function FO(t,e){const n=Reflect.has(t,e);return(!el(e)||!mS.has(e))&&Pn(t,"has",e),n}function UO(t){return Pn(t,"iterate",ne(t)?"length":Vs),Reflect.ownKeys(t)}const yS={get:NO,set:xO,deleteProperty:LO,has:FO,ownKeys:UO},VO={get:DO,set(t,e){return!0},deleteProperty(t,e){return!0}},$O=Kt({},yS,{get:PO,set:MO}),u_=t=>t,Ld=t=>Reflect.getPrototypeOf(t);function $u(t,e,n=!1,r=!1){t=t.__v_raw;const i=ke(t),s=ke(e);n||(e!==s&&Pn(i,"get",e),Pn(i,"get",s));const{has:o}=Ld(i),a=r?u_:n?f_:il;if(o.call(i,e))return a(t.get(e));if(o.call(i,s))return a(t.get(s));t!==i&&t.get(e)}function Bu(t,e=!1){const n=this.__v_raw,r=ke(n),i=ke(t);return e||(t!==i&&Pn(r,"has",t),Pn(r,"has",i)),t===i?n.has(t):n.has(t)||n.has(i)}function ju(t,e=!1){return t=t.__v_raw,!e&&Pn(ke(t),"iterate",Vs),Reflect.get(t,"size",t)}function Uw(t){t=ke(t);const e=ke(this);return Ld(e).has.call(e,t)||(e.add(t),ri(e,"add",t,t)),this}function Vw(t,e){e=ke(e);const n=ke(this),{has:r,get:i}=Ld(n);let s=r.call(n,t);s||(t=ke(t),s=r.call(n,t));const o=i.call(n,t);return n.set(t,e),s?tl(e,o)&&ri(n,"set",t,e):ri(n,"add",t,e),this}function $w(t){const e=ke(this),{has:n,get:r}=Ld(e);let i=n.call(e,t);i||(t=ke(t),i=n.call(e,t)),r&&r.call(e,t);const s=e.delete(t);return i&&ri(e,"delete",t,void 0),s}function Bw(){const t=ke(this),e=t.size!==0,n=t.clear();return e&&ri(t,"clear",void 0,void 0),n}function qu(t,e){return function(r,i){const s=this,o=s.__v_raw,a=ke(o),c=e?u_:t?f_:il;return!t&&Pn(a,"iterate",Vs),o.forEach((l,u)=>r.call(i,c(l),c(u),s))}}function Wu(t,e,n){return function(...r){const i=this.__v_raw,s=ke(i),o=Yo(s),a=t==="entries"||t===Symbol.iterator&&o,c=t==="keys"&&o,l=i[t](...r),u=n?u_:e?f_:il;return!e&&Pn(s,"iterate",c?bg:Vs),{next(){const{value:h,done:d}=l.next();return d?{value:h,done:d}:{value:a?[u(h[0]),u(h[1])]:u(h),done:d}},[Symbol.iterator](){return this}}}}function mi(t){return function(...e){return t==="delete"?!1:this}}function BO(){const t={get(s){return $u(this,s)},get size(){return ju(this)},has:Bu,add:Uw,set:Vw,delete:$w,clear:Bw,forEach:qu(!1,!1)},e={get(s){return $u(this,s,!1,!0)},get size(){return ju(this)},has:Bu,add:Uw,set:Vw,delete:$w,clear:Bw,forEach:qu(!1,!0)},n={get(s){return $u(this,s,!0)},get size(){return ju(this,!0)},has(s){return Bu.call(this,s,!0)},add:mi("add"),set:mi("set"),delete:mi("delete"),clear:mi("clear"),forEach:qu(!0,!1)},r={get(s){return $u(this,s,!0,!0)},get size(){return ju(this,!0)},has(s){return Bu.call(this,s,!0)},add:mi("add"),set:mi("set"),delete:mi("delete"),clear:mi("clear"),forEach:qu(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(s=>{t[s]=Wu(s,!1,!1),n[s]=Wu(s,!0,!1),e[s]=Wu(s,!1,!0),r[s]=Wu(s,!0,!0)}),[t,n,e,r]}const[jO,qO,WO,KO]=BO();function h_(t,e){const n=e?t?KO:WO:t?qO:jO;return(r,i,s)=>i==="__v_isReactive"?!t:i==="__v_isReadonly"?t:i==="__v_raw"?r:Reflect.get(Ie(n,i)&&i in r?n:r,i,s)}const HO={get:h_(!1,!1)},GO={get:h_(!1,!0)},zO={get:h_(!0,!1)},vS=new WeakMap,wS=new WeakMap,bS=new WeakMap,QO=new WeakMap;function YO(t){switch(t){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function JO(t){return t.__v_skip||!Object.isExtensible(t)?0:YO(IO(t))}function La(t){return rl(t)?t:d_(t,!1,yS,HO,vS)}function XO(t){return d_(t,!1,$O,GO,wS)}function IS(t){return d_(t,!0,VO,zO,bS)}function d_(t,e,n,r,i){if(!tt(t)||t.__v_raw&&!(e&&t.__v_isReactive))return t;const s=i.get(t);if(s)return s;const o=JO(t);if(o===0)return t;const a=new Proxy(t,o===2?r:n);return i.set(t,a),a}function Mi(t){return rl(t)?Mi(t.__v_raw):!!(t&&t.__v_isReactive)}function rl(t){return!!(t&&t.__v_isReadonly)}function Eg(t){return!!(t&&t.__v_isShallow)}function ES(t){return Mi(t)||rl(t)}function ke(t){const e=t&&t.__v_raw;return e?ke(e):t}function ua(t){return Ah(t,"__v_skip",!0),t}const il=t=>tt(t)?La(t):t,f_=t=>tt(t)?IS(t):t;function TS(t){xi&&er&&(t=ke(t),gS(t.dep||(t.dep=a_())))}function SS(t,e){t=ke(t),t.dep&&Ig(t.dep)}function at(t){return!!(t&&t.__v_isRef===!0)}function p_(t){return CS(t,!1)}function ZO(t){return CS(t,!0)}function CS(t,e){return at(t)?t:new ex(t,e)}class ex{constructor(e,n){this.__v_isShallow=n,this.dep=void 0,this.__v_isRef=!0,this._rawValue=n?e:ke(e),this._value=n?e:il(e)}get value(){return TS(this),this._value}set value(e){e=this.__v_isShallow?e:ke(e),tl(e,this._rawValue)&&(this._rawValue=e,this._value=this.__v_isShallow?e:il(e),SS(this))}}function Nc(t){return at(t)?t.value:t}const tx={get:(t,e,n)=>Nc(Reflect.get(t,e,n)),set:(t,e,n,r)=>{const i=t[e];return at(i)&&!at(n)?(i.value=n,!0):Reflect.set(t,e,n,r)}};function AS(t){return Mi(t)?t:new Proxy(t,tx)}function nx(t){const e=ne(t)?new Array(t.length):{};for(const n in t)e[n]=ix(t,n);return e}class rx{constructor(e,n,r){this._object=e,this._key=n,this._defaultValue=r,this.__v_isRef=!0}get value(){const e=this._object[this._key];return e===void 0?this._defaultValue:e}set value(e){this._object[this._key]=e}}function ix(t,e,n){const r=t[e];return at(r)?r:new rx(t,e,n)}class sx{constructor(e,n,r,i){this._setter=n,this.dep=void 0,this.__v_isRef=!0,this._dirty=!0,this.effect=new c_(e,()=>{this._dirty||(this._dirty=!0,SS(this))}),this.effect.computed=this,this.effect.active=this._cacheable=!i,this.__v_isReadonly=r}get value(){const e=ke(this);return TS(e),(e._dirty||!e._cacheable)&&(e._dirty=!1,e._value=e.effect.run()),e._value}set value(e){this._setter(e)}}function ox(t,e,n=!1){let r,i;const s=de(t);return s?(r=t,i=sr):(r=t.get,i=t.set),new sx(r,i,s||!i,n)}function Li(t,e,n,r){let i;try{i=r?t(...r):t()}catch(s){Fd(s,e,n)}return i}function qn(t,e,n,r){if(de(t)){const s=Li(t,e,n,r);return s&&aS(s)&&s.catch(o=>{Fd(o,e,n)}),s}const i=[];for(let s=0;s<t.length;s++)i.push(qn(t[s],e,n,r));return i}function Fd(t,e,n,r=!0){const i=e?e.vnode:null;if(e){let s=e.parent;const o=e.proxy,a=n;for(;s;){const l=s.ec;if(l){for(let u=0;u<l.length;u++)if(l[u](t,o,a)===!1)return}s=s.parent}const c=e.appContext.config.errorHandler;if(c){Li(c,null,10,[t,o,a]);return}}ax(t,n,i,r)}function ax(t,e,n,r=!0){console.error(t)}let kh=!1,Tg=!1;const Cn=[];let Hr=0;const Pc=[];let Tc=null,jo=0;const Dc=[];let Ti=null,qo=0;const kS=Promise.resolve();let g_=null,Sg=null;function m_(t){const e=g_||kS;return t?e.then(this?t.bind(this):t):e}function cx(t){let e=Hr+1,n=Cn.length;for(;e<n;){const r=e+n>>>1;sl(Cn[r])<t?e=r+1:n=r}return e}function RS(t){(!Cn.length||!Cn.includes(t,kh&&t.allowRecurse?Hr+1:Hr))&&t!==Sg&&(t.id==null?Cn.push(t):Cn.splice(cx(t.id),0,t),NS())}function NS(){!kh&&!Tg&&(Tg=!0,g_=kS.then(OS))}function lx(t){const e=Cn.indexOf(t);e>Hr&&Cn.splice(e,1)}function PS(t,e,n,r){ne(t)?n.push(...t):(!e||!e.includes(t,t.allowRecurse?r+1:r))&&n.push(t),NS()}function ux(t){PS(t,Tc,Pc,jo)}function hx(t){PS(t,Ti,Dc,qo)}function Ud(t,e=null){if(Pc.length){for(Sg=e,Tc=[...new Set(Pc)],Pc.length=0,jo=0;jo<Tc.length;jo++)Tc[jo]();Tc=null,jo=0,Sg=null,Ud(t,e)}}function DS(t){if(Ud(),Dc.length){const e=[...new Set(Dc)];if(Dc.length=0,Ti){Ti.push(...e);return}for(Ti=e,Ti.sort((n,r)=>sl(n)-sl(r)),qo=0;qo<Ti.length;qo++)Ti[qo]();Ti=null,qo=0}}const sl=t=>t.id==null?1/0:t.id;function OS(t){Tg=!1,kh=!0,Ud(t),Cn.sort((n,r)=>sl(n)-sl(r));const e=sr;try{for(Hr=0;Hr<Cn.length;Hr++){const n=Cn[Hr];n&&n.active!==!1&&Li(n,null,14)}}finally{Hr=0,Cn.length=0,DS(),kh=!1,g_=null,(Cn.length||Pc.length||Dc.length)&&OS(t)}}function dx(t,e,...n){if(t.isUnmounted)return;const r=t.vnode.props||Fe;let i=n;const s=e.startsWith("update:"),o=s&&e.slice(7);if(o&&o in r){const u=`${o==="modelValue"?"model":o}Modifiers`,{number:h,trim:d}=r[u]||Fe;d&&(i=n.map(f=>f.trim())),h&&(i=n.map(nl))}let a,c=r[a=mp(e)]||r[a=mp(Dr(e))];!c&&s&&(c=r[a=mp(vo(e))]),c&&qn(c,t,6,i);const l=r[a+"Once"];if(l){if(!t.emitted)t.emitted={};else if(t.emitted[a])return;t.emitted[a]=!0,qn(l,t,6,i)}}function xS(t,e,n=!1){const r=e.emitsCache,i=r.get(t);if(i!==void 0)return i;const s=t.emits;let o={},a=!1;if(!de(t)){const c=l=>{const u=xS(l,e,!0);u&&(a=!0,Kt(o,u))};!n&&e.mixins.length&&e.mixins.forEach(c),t.extends&&c(t.extends),t.mixins&&t.mixins.forEach(c)}return!s&&!a?(r.set(t,null),null):(ne(s)?s.forEach(c=>o[c]=null):Kt(o,s),r.set(t,o),o)}function Vd(t,e){return!t||!Dd(e)?!1:(e=e.slice(2).replace(/Once$/,""),Ie(t,e[0].toLowerCase()+e.slice(1))||Ie(t,vo(e))||Ie(t,e))}let Un=null,$d=null;function Rh(t){const e=Un;return Un=t,$d=t&&t.type.__scopeId||null,e}function fx(t){$d=t}function px(){$d=null}function Cg(t,e=Un,n){if(!e||t._n)return t;const r=(...i)=>{r._d&&Xw(-1);const s=Rh(e),o=t(...i);return Rh(s),r._d&&Xw(1),o};return r._n=!0,r._c=!0,r._d=!0,r}function _p(t){const{type:e,vnode:n,proxy:r,withProxy:i,props:s,propsOptions:[o],slots:a,attrs:c,emit:l,render:u,renderCache:h,data:d,setupState:f,ctx:g,inheritAttrs:v}=t;let I,S;const k=Rh(t);try{if(n.shapeFlag&4){const E=i||r;I=_r(u.call(E,E,h,s,f,d,g)),S=c}else{const E=e;I=_r(E.length>1?E(s,{attrs:c,slots:a,emit:l}):E(s,null)),S=e.props?c:gx(c)}}catch(E){xc.length=0,Fd(E,t,1),I=Vt(or)}let R=I;if(S&&v!==!1){const E=Object.keys(S),{shapeFlag:p}=R;E.length&&p&7&&(o&&E.some(i_)&&(S=mx(S,o)),R=Wi(R,S))}return n.dirs&&(R=Wi(R),R.dirs=R.dirs?R.dirs.concat(n.dirs):n.dirs),n.transition&&(R.transition=n.transition),I=R,Rh(k),I}const gx=t=>{let e;for(const n in t)(n==="class"||n==="style"||Dd(n))&&((e||(e={}))[n]=t[n]);return e},mx=(t,e)=>{const n={};for(const r in t)(!i_(r)||!(r.slice(9)in e))&&(n[r]=t[r]);return n};function _x(t,e,n){const{props:r,children:i,component:s}=t,{props:o,children:a,patchFlag:c}=e,l=s.emitsOptions;if(e.dirs||e.transition)return!0;if(n&&c>=0){if(c&1024)return!0;if(c&16)return r?jw(r,o,l):!!o;if(c&8){const u=e.dynamicProps;for(let h=0;h<u.length;h++){const d=u[h];if(o[d]!==r[d]&&!Vd(l,d))return!0}}}else return(i||a)&&(!a||!a.$stable)?!0:r===o?!1:r?o?jw(r,o,l):!0:!!o;return!1}function jw(t,e,n){const r=Object.keys(e);if(r.length!==Object.keys(t).length)return!0;for(let i=0;i<r.length;i++){const s=r[i];if(e[s]!==t[s]&&!Vd(n,s))return!0}return!1}function yx({vnode:t,parent:e},n){for(;e&&e.subTree===t;)(t=e.vnode).el=n,e=e.parent}const vx=t=>t.__isSuspense;function wx(t,e){e&&e.pendingBranch?ne(t)?e.effects.push(...t):e.effects.push(t):hx(t)}function dh(t,e){if(Tt){let n=Tt.provides;const r=Tt.parent&&Tt.parent.provides;r===n&&(n=Tt.provides=Object.create(r)),n[t]=e}}function Cr(t,e,n=!1){const r=Tt||Un;if(r){const i=r.parent==null?r.vnode.appContext&&r.vnode.appContext.provides:r.parent.provides;if(i&&t in i)return i[t];if(arguments.length>1)return n&&de(e)?e.call(r.proxy):e}}const qw={};function Oc(t,e,n){return MS(t,e,n)}function MS(t,e,{immediate:n,deep:r,flush:i,onTrack:s,onTrigger:o}=Fe){const a=Tt;let c,l=!1,u=!1;if(at(t)?(c=()=>t.value,l=Eg(t)):Mi(t)?(c=()=>t,r=!0):ne(t)?(u=!0,l=t.some(S=>Mi(S)||Eg(S)),c=()=>t.map(S=>{if(at(S))return S.value;if(Mi(S))return Ps(S);if(de(S))return Li(S,a,2)})):de(t)?e?c=()=>Li(t,a,2):c=()=>{if(!(a&&a.isUnmounted))return h&&h(),qn(t,a,3,[d])}:c=sr,e&&r){const S=c;c=()=>Ps(S())}let h,d=S=>{h=I.onStop=()=>{Li(S,a,4)}};if(cl)return d=sr,e?n&&qn(e,a,3,[c(),u?[]:void 0,d]):c(),sr;let f=u?[]:qw;const g=()=>{if(!!I.active)if(e){const S=I.run();(r||l||(u?S.some((k,R)=>tl(k,f[R])):tl(S,f)))&&(h&&h(),qn(e,a,3,[S,f===qw?void 0:f,d]),f=S)}else I.run()};g.allowRecurse=!!e;let v;i==="sync"?v=g:i==="post"?v=()=>fn(g,a&&a.suspense):v=()=>ux(g);const I=new c_(c,v);return e?n?g():f=I.run():i==="post"?fn(I.run.bind(I),a&&a.suspense):I.run(),()=>{I.stop(),a&&a.scope&&s_(a.scope.effects,I)}}function bx(t,e,n){const r=this.proxy,i=kt(t)?t.includes(".")?LS(r,t):()=>r[t]:t.bind(r,r);let s;de(e)?s=e:(s=e.handler,n=e);const o=Tt;ha(this);const a=MS(i,s.bind(r),n);return o?ha(o):$s(),a}function LS(t,e){const n=e.split(".");return()=>{let r=t;for(let i=0;i<n.length&&r;i++)r=r[n[i]];return r}}function Ps(t,e){if(!tt(t)||t.__v_skip||(e=e||new Set,e.has(t)))return t;if(e.add(t),at(t))Ps(t.value,e);else if(ne(t))for(let n=0;n<t.length;n++)Ps(t[n],e);else if(Od(t)||Yo(t))t.forEach(n=>{Ps(n,e)});else if(lS(t))for(const n in t)Ps(t[n],e);return t}function Ix(){const t={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return jS(()=>{t.isMounted=!0}),qS(()=>{t.isUnmounting=!0}),t}const Ln=[Function,Array],Ex={name:"BaseTransition",props:{mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:Ln,onEnter:Ln,onAfterEnter:Ln,onEnterCancelled:Ln,onBeforeLeave:Ln,onLeave:Ln,onAfterLeave:Ln,onLeaveCancelled:Ln,onBeforeAppear:Ln,onAppear:Ln,onAfterAppear:Ln,onAppearCancelled:Ln},setup(t,{slots:e}){const n=E_(),r=Ix();let i;return()=>{const s=e.default&&VS(e.default(),!0);if(!s||!s.length)return;let o=s[0];if(s.length>1){for(const v of s)if(v.type!==or){o=v;break}}const a=ke(t),{mode:c}=a;if(r.isLeaving)return yp(o);const l=Ww(o);if(!l)return yp(o);const u=Ag(l,a,r,n);kg(l,u);const h=n.subTree,d=h&&Ww(h);let f=!1;const{getTransitionKey:g}=l.type;if(g){const v=g();i===void 0?i=v:v!==i&&(i=v,f=!0)}if(d&&d.type!==or&&(!Ts(l,d)||f)){const v=Ag(d,a,r,n);if(kg(d,v),c==="out-in")return r.isLeaving=!0,v.afterLeave=()=>{r.isLeaving=!1,n.update()},yp(o);c==="in-out"&&l.type!==or&&(v.delayLeave=(I,S,k)=>{const R=US(r,d);R[String(d.key)]=d,I._leaveCb=()=>{S(),I._leaveCb=void 0,delete u.delayedLeave},u.delayedLeave=k})}return o}}},FS=Ex;function US(t,e){const{leavingVNodes:n}=t;let r=n.get(e.type);return r||(r=Object.create(null),n.set(e.type,r)),r}function Ag(t,e,n,r){const{appear:i,mode:s,persisted:o=!1,onBeforeEnter:a,onEnter:c,onAfterEnter:l,onEnterCancelled:u,onBeforeLeave:h,onLeave:d,onAfterLeave:f,onLeaveCancelled:g,onBeforeAppear:v,onAppear:I,onAfterAppear:S,onAppearCancelled:k}=e,R=String(t.key),E=US(n,t),p=(m,U)=>{m&&qn(m,r,9,U)},w=(m,U)=>{const N=U[1];p(m,U),ne(m)?m.every(oe=>oe.length<=1)&&N():m.length<=1&&N()},y={mode:s,persisted:o,beforeEnter(m){let U=a;if(!n.isMounted)if(i)U=v||a;else return;m._leaveCb&&m._leaveCb(!0);const N=E[R];N&&Ts(t,N)&&N.el._leaveCb&&N.el._leaveCb(),p(U,[m])},enter(m){let U=c,N=l,oe=u;if(!n.isMounted)if(i)U=I||c,N=S||l,oe=k||u;else return;let B=!1;const he=m._enterCb=we=>{B||(B=!0,we?p(oe,[m]):p(N,[m]),y.delayedLeave&&y.delayedLeave(),m._enterCb=void 0)};U?w(U,[m,he]):he()},leave(m,U){const N=String(t.key);if(m._enterCb&&m._enterCb(!0),n.isUnmounting)return U();p(h,[m]);let oe=!1;const B=m._leaveCb=he=>{oe||(oe=!0,U(),he?p(g,[m]):p(f,[m]),m._leaveCb=void 0,E[N]===t&&delete E[N])};E[N]=t,d?w(d,[m,B]):B()},clone(m){return Ag(m,e,n,r)}};return y}function yp(t){if(Bd(t))return t=Wi(t),t.children=null,t}function Ww(t){return Bd(t)?t.children?t.children[0]:void 0:t}function kg(t,e){t.shapeFlag&6&&t.component?kg(t.component.subTree,e):t.shapeFlag&128?(t.ssContent.transition=e.clone(t.ssContent),t.ssFallback.transition=e.clone(t.ssFallback)):t.transition=e}function VS(t,e=!1,n){let r=[],i=0;for(let s=0;s<t.length;s++){let o=t[s];const a=n==null?o.key:String(n)+String(o.key!=null?o.key:s);o.type===Zn?(o.patchFlag&128&&i++,r=r.concat(VS(o.children,e,a))):(e||o.type!==or)&&r.push(a!=null?Wi(o,{key:a}):o)}if(i>1)for(let s=0;s<r.length;s++)r[s].patchFlag=-2;return r}function $S(t){return de(t)?{setup:t,name:t.name}:t}const fh=t=>!!t.type.__asyncLoader,Bd=t=>t.type.__isKeepAlive;function Tx(t,e){BS(t,"a",e)}function Sx(t,e){BS(t,"da",e)}function BS(t,e,n=Tt){const r=t.__wdc||(t.__wdc=()=>{let i=n;for(;i;){if(i.isDeactivated)return;i=i.parent}return t()});if(jd(e,r,n),n){let i=n.parent;for(;i&&i.parent;)Bd(i.parent.vnode)&&Cx(r,e,n,i),i=i.parent}}function Cx(t,e,n,r){const i=jd(e,t,r,!0);__(()=>{s_(r[e],i)},n)}function jd(t,e,n=Tt,r=!1){if(n){const i=n[t]||(n[t]=[]),s=e.__weh||(e.__weh=(...o)=>{if(n.isUnmounted)return;xa(),ha(n);const a=qn(e,n,t,o);return $s(),Ma(),a});return r?i.unshift(s):i.push(s),s}}const li=t=>(e,n=Tt)=>(!cl||t==="sp")&&jd(t,e,n),Ax=li("bm"),jS=li("m"),kx=li("bu"),Rx=li("u"),qS=li("bum"),__=li("um"),Nx=li("sp"),Px=li("rtg"),Dx=li("rtc");function Ox(t,e=Tt){jd("ec",t,e)}function l9(t,e){const n=Un;if(n===null)return t;const r=Wd(n)||n.proxy,i=t.dirs||(t.dirs=[]);for(let s=0;s<e.length;s++){let[o,a,c,l=Fe]=e[s];de(o)&&(o={mounted:o,updated:o}),o.deep&&Ps(a),i.push({dir:o,instance:r,value:a,oldValue:void 0,arg:c,modifiers:l})}return t}function fs(t,e,n,r){const i=t.dirs,s=e&&e.dirs;for(let o=0;o<i.length;o++){const a=i[o];s&&(a.oldValue=s[o].value);let c=a.dir[r];c&&(xa(),qn(c,n,8,[t.el,a,t,e]),Ma())}}const WS="components";function Rg(t,e){return Mx(WS,t,!0,e)||t}const xx=Symbol();function Mx(t,e,n=!0,r=!1){const i=Un||Tt;if(i){const s=i.type;if(t===WS){const a=hM(s,!1);if(a&&(a===e||a===Dr(e)||a===Md(Dr(e))))return s}const o=Kw(i[t]||s[t],e)||Kw(i.appContext[t],e);return!o&&r?s:o}}function Kw(t,e){return t&&(t[e]||t[Dr(e)]||t[Md(Dr(e))])}function u9(t,e,n,r){let i;const s=n&&n[r];if(ne(t)||kt(t)){i=new Array(t.length);for(let o=0,a=t.length;o<a;o++)i[o]=e(t[o],o,void 0,s&&s[o])}else if(typeof t=="number"){i=new Array(t);for(let o=0;o<t;o++)i[o]=e(o+1,o,void 0,s&&s[o])}else if(tt(t))if(t[Symbol.iterator])i=Array.from(t,(o,a)=>e(o,a,void 0,s&&s[a]));else{const o=Object.keys(t);i=new Array(o.length);for(let a=0,c=o.length;a<c;a++){const l=o[a];i[a]=e(t[l],l,a,s&&s[a])}}else i=[];return n&&(n[r]=i),i}const Ng=t=>t?r0(t)?Wd(t)||t.proxy:Ng(t.parent):null,Nh=Kt(Object.create(null),{$:t=>t,$el:t=>t.vnode.el,$data:t=>t.data,$props:t=>t.props,$attrs:t=>t.attrs,$slots:t=>t.slots,$refs:t=>t.refs,$parent:t=>Ng(t.parent),$root:t=>Ng(t.root),$emit:t=>t.emit,$options:t=>HS(t),$forceUpdate:t=>t.f||(t.f=()=>RS(t.update)),$nextTick:t=>t.n||(t.n=m_.bind(t.proxy)),$watch:t=>bx.bind(t)}),Lx={get({_:t},e){const{ctx:n,setupState:r,data:i,props:s,accessCache:o,type:a,appContext:c}=t;let l;if(e[0]!=="$"){const f=o[e];if(f!==void 0)switch(f){case 1:return r[e];case 2:return i[e];case 4:return n[e];case 3:return s[e]}else{if(r!==Fe&&Ie(r,e))return o[e]=1,r[e];if(i!==Fe&&Ie(i,e))return o[e]=2,i[e];if((l=t.propsOptions[0])&&Ie(l,e))return o[e]=3,s[e];if(n!==Fe&&Ie(n,e))return o[e]=4,n[e];Pg&&(o[e]=0)}}const u=Nh[e];let h,d;if(u)return e==="$attrs"&&Pn(t,"get",e),u(t);if((h=a.__cssModules)&&(h=h[e]))return h;if(n!==Fe&&Ie(n,e))return o[e]=4,n[e];if(d=c.config.globalProperties,Ie(d,e))return d[e]},set({_:t},e,n){const{data:r,setupState:i,ctx:s}=t;return i!==Fe&&Ie(i,e)?(i[e]=n,!0):r!==Fe&&Ie(r,e)?(r[e]=n,!0):Ie(t.props,e)||e[0]==="$"&&e.slice(1)in t?!1:(s[e]=n,!0)},has({_:{data:t,setupState:e,accessCache:n,ctx:r,appContext:i,propsOptions:s}},o){let a;return!!n[o]||t!==Fe&&Ie(t,o)||e!==Fe&&Ie(e,o)||(a=s[0])&&Ie(a,o)||Ie(r,o)||Ie(Nh,o)||Ie(i.config.globalProperties,o)},defineProperty(t,e,n){return n.get!=null?t._.accessCache[e]=0:Ie(n,"value")&&this.set(t,e,n.value,null),Reflect.defineProperty(t,e,n)}};let Pg=!0;function Fx(t){const e=HS(t),n=t.proxy,r=t.ctx;Pg=!1,e.beforeCreate&&Hw(e.beforeCreate,t,"bc");const{data:i,computed:s,methods:o,watch:a,provide:c,inject:l,created:u,beforeMount:h,mounted:d,beforeUpdate:f,updated:g,activated:v,deactivated:I,beforeDestroy:S,beforeUnmount:k,destroyed:R,unmounted:E,render:p,renderTracked:w,renderTriggered:y,errorCaptured:m,serverPrefetch:U,expose:N,inheritAttrs:oe,components:B,directives:he,filters:we}=e;if(l&&Ux(l,r,null,t.appContext.config.unwrapInjectedRef),o)for(const Pe in o){const De=o[Pe];de(De)&&(r[Pe]=De.bind(n))}if(i){const Pe=i.call(n,n);tt(Pe)&&(t.data=La(Pe))}if(Pg=!0,s)for(const Pe in s){const De=s[Pe],En=de(De)?De.bind(n,n):de(De.get)?De.get.bind(n,n):sr,Do=!de(De)&&de(De.set)?De.set.bind(n):sr,jr=tr({get:En,set:Do});Object.defineProperty(r,Pe,{enumerable:!0,configurable:!0,get:()=>jr.value,set:dr=>jr.value=dr})}if(a)for(const Pe in a)KS(a[Pe],r,n,Pe);if(c){const Pe=de(c)?c.call(n):c;Reflect.ownKeys(Pe).forEach(De=>{dh(De,Pe[De])})}u&&Hw(u,t,"c");function Ke(Pe,De){ne(De)?De.forEach(En=>Pe(En.bind(n))):De&&Pe(De.bind(n))}if(Ke(Ax,h),Ke(jS,d),Ke(kx,f),Ke(Rx,g),Ke(Tx,v),Ke(Sx,I),Ke(Ox,m),Ke(Dx,w),Ke(Px,y),Ke(qS,k),Ke(__,E),Ke(Nx,U),ne(N))if(N.length){const Pe=t.exposed||(t.exposed={});N.forEach(De=>{Object.defineProperty(Pe,De,{get:()=>n[De],set:En=>n[De]=En})})}else t.exposed||(t.exposed={});p&&t.render===sr&&(t.render=p),oe!=null&&(t.inheritAttrs=oe),B&&(t.components=B),he&&(t.directives=he)}function Ux(t,e,n=sr,r=!1){ne(t)&&(t=Dg(t));for(const i in t){const s=t[i];let o;tt(s)?"default"in s?o=Cr(s.from||i,s.default,!0):o=Cr(s.from||i):o=Cr(s),at(o)&&r?Object.defineProperty(e,i,{enumerable:!0,configurable:!0,get:()=>o.value,set:a=>o.value=a}):e[i]=o}}function Hw(t,e,n){qn(ne(t)?t.map(r=>r.bind(e.proxy)):t.bind(e.proxy),e,n)}function KS(t,e,n,r){const i=r.includes(".")?LS(n,r):()=>n[r];if(kt(t)){const s=e[t];de(s)&&Oc(i,s)}else if(de(t))Oc(i,t.bind(n));else if(tt(t))if(ne(t))t.forEach(s=>KS(s,e,n,r));else{const s=de(t.handler)?t.handler.bind(n):e[t.handler];de(s)&&Oc(i,s,t)}}function HS(t){const e=t.type,{mixins:n,extends:r}=e,{mixins:i,optionsCache:s,config:{optionMergeStrategies:o}}=t.appContext,a=s.get(e);let c;return a?c=a:!i.length&&!n&&!r?c=e:(c={},i.length&&i.forEach(l=>Ph(c,l,o,!0)),Ph(c,e,o)),s.set(e,c),c}function Ph(t,e,n,r=!1){const{mixins:i,extends:s}=e;s&&Ph(t,s,n,!0),i&&i.forEach(o=>Ph(t,o,n,!0));for(const o in e)if(!(r&&o==="expose")){const a=Vx[o]||n&&n[o];t[o]=a?a(t[o],e[o]):e[o]}return t}const Vx={data:Gw,props:vs,emits:vs,methods:vs,computed:vs,beforeCreate:en,created:en,beforeMount:en,mounted:en,beforeUpdate:en,updated:en,beforeDestroy:en,beforeUnmount:en,destroyed:en,unmounted:en,activated:en,deactivated:en,errorCaptured:en,serverPrefetch:en,components:vs,directives:vs,watch:Bx,provide:Gw,inject:$x};function Gw(t,e){return e?t?function(){return Kt(de(t)?t.call(this,this):t,de(e)?e.call(this,this):e)}:e:t}function $x(t,e){return vs(Dg(t),Dg(e))}function Dg(t){if(ne(t)){const e={};for(let n=0;n<t.length;n++)e[t[n]]=t[n];return e}return t}function en(t,e){return t?[...new Set([].concat(t,e))]:e}function vs(t,e){return t?Kt(Kt(Object.create(null),t),e):e}function Bx(t,e){if(!t)return e;if(!e)return t;const n=Kt(Object.create(null),t);for(const r in e)n[r]=en(t[r],e[r]);return n}function jx(t,e,n,r=!1){const i={},s={};Ah(s,qd,1),t.propsDefaults=Object.create(null),GS(t,e,i,s);for(const o in t.propsOptions[0])o in i||(i[o]=void 0);n?t.props=r?i:XO(i):t.type.props?t.props=i:t.props=s,t.attrs=s}function qx(t,e,n,r){const{props:i,attrs:s,vnode:{patchFlag:o}}=t,a=ke(i),[c]=t.propsOptions;let l=!1;if((r||o>0)&&!(o&16)){if(o&8){const u=t.vnode.dynamicProps;for(let h=0;h<u.length;h++){let d=u[h];if(Vd(t.emitsOptions,d))continue;const f=e[d];if(c)if(Ie(s,d))f!==s[d]&&(s[d]=f,l=!0);else{const g=Dr(d);i[g]=Og(c,a,g,f,t,!1)}else f!==s[d]&&(s[d]=f,l=!0)}}}else{GS(t,e,i,s)&&(l=!0);let u;for(const h in a)(!e||!Ie(e,h)&&((u=vo(h))===h||!Ie(e,u)))&&(c?n&&(n[h]!==void 0||n[u]!==void 0)&&(i[h]=Og(c,a,h,void 0,t,!0)):delete i[h]);if(s!==a)for(const h in s)(!e||!Ie(e,h)&&!0)&&(delete s[h],l=!0)}l&&ri(t,"set","$attrs")}function GS(t,e,n,r){const[i,s]=t.propsOptions;let o=!1,a;if(e)for(let c in e){if(uh(c))continue;const l=e[c];let u;i&&Ie(i,u=Dr(c))?!s||!s.includes(u)?n[u]=l:(a||(a={}))[u]=l:Vd(t.emitsOptions,c)||(!(c in r)||l!==r[c])&&(r[c]=l,o=!0)}if(s){const c=ke(n),l=a||Fe;for(let u=0;u<s.length;u++){const h=s[u];n[h]=Og(i,c,h,l[h],t,!Ie(l,h))}}return o}function Og(t,e,n,r,i,s){const o=t[n];if(o!=null){const a=Ie(o,"default");if(a&&r===void 0){const c=o.default;if(o.type!==Function&&de(c)){const{propsDefaults:l}=i;n in l?r=l[n]:(ha(i),r=l[n]=c.call(null,e),$s())}else r=c}o[0]&&(s&&!a?r=!1:o[1]&&(r===""||r===vo(n))&&(r=!0))}return r}function zS(t,e,n=!1){const r=e.propsCache,i=r.get(t);if(i)return i;const s=t.props,o={},a=[];let c=!1;if(!de(t)){const u=h=>{c=!0;const[d,f]=zS(h,e,!0);Kt(o,d),f&&a.push(...f)};!n&&e.mixins.length&&e.mixins.forEach(u),t.extends&&u(t.extends),t.mixins&&t.mixins.forEach(u)}if(!s&&!c)return r.set(t,Qo),Qo;if(ne(s))for(let u=0;u<s.length;u++){const h=Dr(s[u]);zw(h)&&(o[h]=Fe)}else if(s)for(const u in s){const h=Dr(u);if(zw(h)){const d=s[u],f=o[h]=ne(d)||de(d)?{type:d}:d;if(f){const g=Jw(Boolean,f.type),v=Jw(String,f.type);f[0]=g>-1,f[1]=v<0||g<v,(g>-1||Ie(f,"default"))&&a.push(h)}}}const l=[o,a];return r.set(t,l),l}function zw(t){return t[0]!=="$"}function Qw(t){const e=t&&t.toString().match(/^\s*function (\w+)/);return e?e[1]:t===null?"null":""}function Yw(t,e){return Qw(t)===Qw(e)}function Jw(t,e){return ne(e)?e.findIndex(n=>Yw(n,t)):de(e)&&Yw(e,t)?0:-1}const QS=t=>t[0]==="_"||t==="$stable",y_=t=>ne(t)?t.map(_r):[_r(t)],Wx=(t,e,n)=>{if(e._n)return e;const r=Cg((...i)=>y_(e(...i)),n);return r._c=!1,r},YS=(t,e,n)=>{const r=t._ctx;for(const i in t){if(QS(i))continue;const s=t[i];if(de(s))e[i]=Wx(i,s,r);else if(s!=null){const o=y_(s);e[i]=()=>o}}},JS=(t,e)=>{const n=y_(e);t.slots.default=()=>n},Kx=(t,e)=>{if(t.vnode.shapeFlag&32){const n=e._;n?(t.slots=ke(e),Ah(e,"_",n)):YS(e,t.slots={})}else t.slots={},e&&JS(t,e);Ah(t.slots,qd,1)},Hx=(t,e,n)=>{const{vnode:r,slots:i}=t;let s=!0,o=Fe;if(r.shapeFlag&32){const a=e._;a?n&&a===1?s=!1:(Kt(i,e),!n&&a===1&&delete i._):(s=!e.$stable,YS(e,i)),o=e}else e&&(JS(t,e),o={default:1});if(s)for(const a in i)!QS(a)&&!(a in o)&&delete i[a]};function XS(){return{app:null,config:{isNativeTag:vO,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let Gx=0;function zx(t,e){return function(r,i=null){de(r)||(r=Object.assign({},r)),i!=null&&!tt(i)&&(i=null);const s=XS(),o=new Set;let a=!1;const c=s.app={_uid:Gx++,_component:r,_props:i,_container:null,_context:s,_instance:null,version:fM,get config(){return s.config},set config(l){},use(l,...u){return o.has(l)||(l&&de(l.install)?(o.add(l),l.install(c,...u)):de(l)&&(o.add(l),l(c,...u))),c},mixin(l){return s.mixins.includes(l)||s.mixins.push(l),c},component(l,u){return u?(s.components[l]=u,c):s.components[l]},directive(l,u){return u?(s.directives[l]=u,c):s.directives[l]},mount(l,u,h){if(!a){const d=Vt(r,i);return d.appContext=s,u&&e?e(d,l):t(d,l,h),a=!0,c._container=l,l.__vue_app__=c,Wd(d.component)||d.component.proxy}},unmount(){a&&(t(null,c._container),delete c._container.__vue_app__)},provide(l,u){return s.provides[l]=u,c}};return c}}function xg(t,e,n,r,i=!1){if(ne(t)){t.forEach((d,f)=>xg(d,e&&(ne(e)?e[f]:e),n,r,i));return}if(fh(r)&&!i)return;const s=r.shapeFlag&4?Wd(r.component)||r.component.proxy:r.el,o=i?null:s,{i:a,r:c}=t,l=e&&e.r,u=a.refs===Fe?a.refs={}:a.refs,h=a.setupState;if(l!=null&&l!==c&&(kt(l)?(u[l]=null,Ie(h,l)&&(h[l]=null)):at(l)&&(l.value=null)),de(c))Li(c,a,12,[o,u]);else{const d=kt(c),f=at(c);if(d||f){const g=()=>{if(t.f){const v=d?u[c]:c.value;i?ne(v)&&s_(v,s):ne(v)?v.includes(s)||v.push(s):d?(u[c]=[s],Ie(h,c)&&(h[c]=u[c])):(c.value=[s],t.k&&(u[t.k]=c.value))}else d?(u[c]=o,Ie(h,c)&&(h[c]=o)):f&&(c.value=o,t.k&&(u[t.k]=o))};o?(g.id=-1,fn(g,n)):g()}}}const fn=wx;function Qx(t){return Yx(t)}function Yx(t,e){const n=SO();n.__VUE__=!0;const{insert:r,remove:i,patchProp:s,createElement:o,createText:a,createComment:c,setText:l,setElementText:u,parentNode:h,nextSibling:d,setScopeId:f=sr,cloneNode:g,insertStaticContent:v}=t,I=(_,b,A,x=null,D=null,q=null,z=!1,j=null,K=!!b.dynamicChildren)=>{if(_===b)return;_&&!Ts(_,b)&&(x=Z(_),Mn(_,D,q,!0),_=null),b.patchFlag===-2&&(K=!1,b.dynamicChildren=null);const{type:F,ref:ee,shapeFlag:J}=b;switch(F){case v_:S(_,b,A,x);break;case or:k(_,b,A,x);break;case ph:_==null&&R(b,A,x,z);break;case Zn:he(_,b,A,x,D,q,z,j,K);break;default:J&1?w(_,b,A,x,D,q,z,j,K):J&6?we(_,b,A,x,D,q,z,j,K):(J&64||J&128)&&F.process(_,b,A,x,D,q,z,j,K,$e)}ee!=null&&D&&xg(ee,_&&_.ref,q,b||_,!b)},S=(_,b,A,x)=>{if(_==null)r(b.el=a(b.children),A,x);else{const D=b.el=_.el;b.children!==_.children&&l(D,b.children)}},k=(_,b,A,x)=>{_==null?r(b.el=c(b.children||""),A,x):b.el=_.el},R=(_,b,A,x)=>{[_.el,_.anchor]=v(_.children,b,A,x,_.el,_.anchor)},E=({el:_,anchor:b},A,x)=>{let D;for(;_&&_!==b;)D=d(_),r(_,A,x),_=D;r(b,A,x)},p=({el:_,anchor:b})=>{let A;for(;_&&_!==b;)A=d(_),i(_),_=A;i(b)},w=(_,b,A,x,D,q,z,j,K)=>{z=z||b.type==="svg",_==null?y(b,A,x,D,q,z,j,K):N(_,b,D,q,z,j,K)},y=(_,b,A,x,D,q,z,j)=>{let K,F;const{type:ee,props:J,shapeFlag:te,transition:le,patchFlag:Te,dirs:xe}=_;if(_.el&&g!==void 0&&Te===-1)K=_.el=g(_.el);else{if(K=_.el=o(_.type,q,J&&J.is,J),te&8?u(K,_.children):te&16&&U(_.children,K,null,x,D,q&&ee!=="foreignObject",z,j),xe&&fs(_,null,x,"created"),J){for(const He in J)He!=="value"&&!uh(He)&&s(K,He,null,J[He],q,_.children,x,D,H);"value"in J&&s(K,"value",null,J.value),(F=J.onVnodeBeforeMount)&&pr(F,x,_)}m(K,_,_.scopeId,z,x)}xe&&fs(_,null,x,"beforeMount");const Me=(!D||D&&!D.pendingBranch)&&le&&!le.persisted;Me&&le.beforeEnter(K),r(K,b,A),((F=J&&J.onVnodeMounted)||Me||xe)&&fn(()=>{F&&pr(F,x,_),Me&&le.enter(K),xe&&fs(_,null,x,"mounted")},D)},m=(_,b,A,x,D)=>{if(A&&f(_,A),x)for(let q=0;q<x.length;q++)f(_,x[q]);if(D){let q=D.subTree;if(b===q){const z=D.vnode;m(_,z,z.scopeId,z.slotScopeIds,D.parent)}}},U=(_,b,A,x,D,q,z,j,K=0)=>{for(let F=K;F<_.length;F++){const ee=_[F]=j?Si(_[F]):_r(_[F]);I(null,ee,b,A,x,D,q,z,j)}},N=(_,b,A,x,D,q,z)=>{const j=b.el=_.el;let{patchFlag:K,dynamicChildren:F,dirs:ee}=b;K|=_.patchFlag&16;const J=_.props||Fe,te=b.props||Fe;let le;A&&ps(A,!1),(le=te.onVnodeBeforeUpdate)&&pr(le,A,b,_),ee&&fs(b,_,A,"beforeUpdate"),A&&ps(A,!0);const Te=D&&b.type!=="foreignObject";if(F?oe(_.dynamicChildren,F,j,A,x,Te,q):z||En(_,b,j,null,A,x,Te,q,!1),K>0){if(K&16)B(j,b,J,te,A,x,D);else if(K&2&&J.class!==te.class&&s(j,"class",null,te.class,D),K&4&&s(j,"style",J.style,te.style,D),K&8){const xe=b.dynamicProps;for(let Me=0;Me<xe.length;Me++){const He=xe[Me],Yn=J[He],Oo=te[He];(Oo!==Yn||He==="value")&&s(j,He,Yn,Oo,D,_.children,A,x,H)}}K&1&&_.children!==b.children&&u(j,b.children)}else!z&&F==null&&B(j,b,J,te,A,x,D);((le=te.onVnodeUpdated)||ee)&&fn(()=>{le&&pr(le,A,b,_),ee&&fs(b,_,A,"updated")},x)},oe=(_,b,A,x,D,q,z)=>{for(let j=0;j<b.length;j++){const K=_[j],F=b[j],ee=K.el&&(K.type===Zn||!Ts(K,F)||K.shapeFlag&70)?h(K.el):A;I(K,F,ee,null,x,D,q,z,!0)}},B=(_,b,A,x,D,q,z)=>{if(A!==x){for(const j in x){if(uh(j))continue;const K=x[j],F=A[j];K!==F&&j!=="value"&&s(_,j,F,K,z,b.children,D,q,H)}if(A!==Fe)for(const j in A)!uh(j)&&!(j in x)&&s(_,j,A[j],null,z,b.children,D,q,H);"value"in x&&s(_,"value",A.value,x.value)}},he=(_,b,A,x,D,q,z,j,K)=>{const F=b.el=_?_.el:a(""),ee=b.anchor=_?_.anchor:a("");let{patchFlag:J,dynamicChildren:te,slotScopeIds:le}=b;le&&(j=j?j.concat(le):le),_==null?(r(F,A,x),r(ee,A,x),U(b.children,A,ee,D,q,z,j,K)):J>0&&J&64&&te&&_.dynamicChildren?(oe(_.dynamicChildren,te,A,D,q,z,j),(b.key!=null||D&&b===D.subTree)&&ZS(_,b,!0)):En(_,b,A,ee,D,q,z,j,K)},we=(_,b,A,x,D,q,z,j,K)=>{b.slotScopeIds=j,_==null?b.shapeFlag&512?D.ctx.activate(b,A,x,z,K):We(b,A,x,D,q,z,K):Ke(_,b,K)},We=(_,b,A,x,D,q,z)=>{const j=_.component=oM(_,x,D);if(Bd(_)&&(j.ctx.renderer=$e),aM(j),j.asyncDep){if(D&&D.registerDep(j,Pe),!_.el){const K=j.subTree=Vt(or);k(null,K,b,A)}return}Pe(j,_,b,A,D,q,z)},Ke=(_,b,A)=>{const x=b.component=_.component;if(_x(_,b,A))if(x.asyncDep&&!x.asyncResolved){De(x,b,A);return}else x.next=b,lx(x.update),x.update();else b.el=_.el,x.vnode=b},Pe=(_,b,A,x,D,q,z)=>{const j=()=>{if(_.isMounted){let{next:ee,bu:J,u:te,parent:le,vnode:Te}=_,xe=ee,Me;ps(_,!1),ee?(ee.el=Te.el,De(_,ee,z)):ee=Te,J&&hh(J),(Me=ee.props&&ee.props.onVnodeBeforeUpdate)&&pr(Me,le,ee,Te),ps(_,!0);const He=_p(_),Yn=_.subTree;_.subTree=He,I(Yn,He,h(Yn.el),Z(Yn),_,D,q),ee.el=He.el,xe===null&&yx(_,He.el),te&&fn(te,D),(Me=ee.props&&ee.props.onVnodeUpdated)&&fn(()=>pr(Me,le,ee,Te),D)}else{let ee;const{el:J,props:te}=b,{bm:le,m:Te,parent:xe}=_,Me=fh(b);if(ps(_,!1),le&&hh(le),!Me&&(ee=te&&te.onVnodeBeforeMount)&&pr(ee,xe,b),ps(_,!0),J&&pe){const He=()=>{_.subTree=_p(_),pe(J,_.subTree,_,D,null)};Me?b.type.__asyncLoader().then(()=>!_.isUnmounted&&He()):He()}else{const He=_.subTree=_p(_);I(null,He,A,x,_,D,q),b.el=He.el}if(Te&&fn(Te,D),!Me&&(ee=te&&te.onVnodeMounted)){const He=b;fn(()=>pr(ee,xe,He),D)}(b.shapeFlag&256||xe&&fh(xe.vnode)&&xe.vnode.shapeFlag&256)&&_.a&&fn(_.a,D),_.isMounted=!0,b=A=x=null}},K=_.effect=new c_(j,()=>RS(F),_.scope),F=_.update=()=>K.run();F.id=_.uid,ps(_,!0),F()},De=(_,b,A)=>{b.component=_;const x=_.vnode.props;_.vnode=b,_.next=null,qx(_,b.props,x,A),Hx(_,b.children,A),xa(),Ud(void 0,_.update),Ma()},En=(_,b,A,x,D,q,z,j,K=!1)=>{const F=_&&_.children,ee=_?_.shapeFlag:0,J=b.children,{patchFlag:te,shapeFlag:le}=b;if(te>0){if(te&128){jr(F,J,A,x,D,q,z,j,K);return}else if(te&256){Do(F,J,A,x,D,q,z,j,K);return}}le&8?(ee&16&&H(F,D,q),J!==F&&u(A,J)):ee&16?le&16?jr(F,J,A,x,D,q,z,j,K):H(F,D,q,!0):(ee&8&&u(A,""),le&16&&U(J,A,x,D,q,z,j,K))},Do=(_,b,A,x,D,q,z,j,K)=>{_=_||Qo,b=b||Qo;const F=_.length,ee=b.length,J=Math.min(F,ee);let te;for(te=0;te<J;te++){const le=b[te]=K?Si(b[te]):_r(b[te]);I(_[te],le,A,null,D,q,z,j,K)}F>ee?H(_,D,q,!0,!1,J):U(b,A,x,D,q,z,j,K,J)},jr=(_,b,A,x,D,q,z,j,K)=>{let F=0;const ee=b.length;let J=_.length-1,te=ee-1;for(;F<=J&&F<=te;){const le=_[F],Te=b[F]=K?Si(b[F]):_r(b[F]);if(Ts(le,Te))I(le,Te,A,null,D,q,z,j,K);else break;F++}for(;F<=J&&F<=te;){const le=_[J],Te=b[te]=K?Si(b[te]):_r(b[te]);if(Ts(le,Te))I(le,Te,A,null,D,q,z,j,K);else break;J--,te--}if(F>J){if(F<=te){const le=te+1,Te=le<ee?b[le].el:x;for(;F<=te;)I(null,b[F]=K?Si(b[F]):_r(b[F]),A,Te,D,q,z,j,K),F++}}else if(F>te)for(;F<=J;)Mn(_[F],D,q,!0),F++;else{const le=F,Te=F,xe=new Map;for(F=Te;F<=te;F++){const Tn=b[F]=K?Si(b[F]):_r(b[F]);Tn.key!=null&&xe.set(Tn.key,F)}let Me,He=0;const Yn=te-Te+1;let Oo=!1,Nw=0;const sc=new Array(Yn);for(F=0;F<Yn;F++)sc[F]=0;for(F=le;F<=J;F++){const Tn=_[F];if(He>=Yn){Mn(Tn,D,q,!0);continue}let fr;if(Tn.key!=null)fr=xe.get(Tn.key);else for(Me=Te;Me<=te;Me++)if(sc[Me-Te]===0&&Ts(Tn,b[Me])){fr=Me;break}fr===void 0?Mn(Tn,D,q,!0):(sc[fr-Te]=F+1,fr>=Nw?Nw=fr:Oo=!0,I(Tn,b[fr],A,null,D,q,z,j,K),He++)}const Pw=Oo?Jx(sc):Qo;for(Me=Pw.length-1,F=Yn-1;F>=0;F--){const Tn=Te+F,fr=b[Tn],Dw=Tn+1<ee?b[Tn+1].el:x;sc[F]===0?I(null,fr,A,Dw,D,q,z,j,K):Oo&&(Me<0||F!==Pw[Me]?dr(fr,A,Dw,2):Me--)}}},dr=(_,b,A,x,D=null)=>{const{el:q,type:z,transition:j,children:K,shapeFlag:F}=_;if(F&6){dr(_.component.subTree,b,A,x);return}if(F&128){_.suspense.move(b,A,x);return}if(F&64){z.move(_,b,A,$e);return}if(z===Zn){r(q,b,A);for(let J=0;J<K.length;J++)dr(K[J],b,A,x);r(_.anchor,b,A);return}if(z===ph){E(_,b,A);return}if(x!==2&&F&1&&j)if(x===0)j.beforeEnter(q),r(q,b,A),fn(()=>j.enter(q),D);else{const{leave:J,delayLeave:te,afterLeave:le}=j,Te=()=>r(q,b,A),xe=()=>{J(q,()=>{Te(),le&&le()})};te?te(q,Te,xe):xe()}else r(q,b,A)},Mn=(_,b,A,x=!1,D=!1)=>{const{type:q,props:z,ref:j,children:K,dynamicChildren:F,shapeFlag:ee,patchFlag:J,dirs:te}=_;if(j!=null&&xg(j,null,A,_,!0),ee&256){b.ctx.deactivate(_);return}const le=ee&1&&te,Te=!fh(_);let xe;if(Te&&(xe=z&&z.onVnodeBeforeUnmount)&&pr(xe,b,_),ee&6)X(_.component,A,x);else{if(ee&128){_.suspense.unmount(A,x);return}le&&fs(_,null,b,"beforeUnmount"),ee&64?_.type.remove(_,b,A,D,$e,x):F&&(q!==Zn||J>0&&J&64)?H(F,b,A,!1,!0):(q===Zn&&J&384||!D&&ee&16)&&H(K,b,A),x&&gp(_)}(Te&&(xe=z&&z.onVnodeUnmounted)||le)&&fn(()=>{xe&&pr(xe,b,_),le&&fs(_,null,b,"unmounted")},A)},gp=_=>{const{type:b,el:A,anchor:x,transition:D}=_;if(b===Zn){P(A,x);return}if(b===ph){p(_);return}const q=()=>{i(A),D&&!D.persisted&&D.afterLeave&&D.afterLeave()};if(_.shapeFlag&1&&D&&!D.persisted){const{leave:z,delayLeave:j}=D,K=()=>z(A,q);j?j(_.el,q,K):K()}else q()},P=(_,b)=>{let A;for(;_!==b;)A=d(_),i(_),_=A;i(b)},X=(_,b,A)=>{const{bum:x,scope:D,update:q,subTree:z,um:j}=_;x&&hh(x),D.stop(),q&&(q.active=!1,Mn(z,_,b,A)),j&&fn(j,b),fn(()=>{_.isUnmounted=!0},b),b&&b.pendingBranch&&!b.isUnmounted&&_.asyncDep&&!_.asyncResolved&&_.suspenseId===b.pendingId&&(b.deps--,b.deps===0&&b.resolve())},H=(_,b,A,x=!1,D=!1,q=0)=>{for(let z=q;z<_.length;z++)Mn(_[z],b,A,x,D)},Z=_=>_.shapeFlag&6?Z(_.component.subTree):_.shapeFlag&128?_.suspense.next():d(_.anchor||_.el),Oe=(_,b,A)=>{_==null?b._vnode&&Mn(b._vnode,null,null,!0):I(b._vnode||null,_,b,null,null,null,A),DS(),b._vnode=_},$e={p:I,um:Mn,m:dr,r:gp,mt:We,mc:U,pc:En,pbc:oe,n:Z,o:t};let ve,pe;return e&&([ve,pe]=e($e)),{render:Oe,hydrate:ve,createApp:zx(Oe,ve)}}function ps({effect:t,update:e},n){t.allowRecurse=e.allowRecurse=n}function ZS(t,e,n=!1){const r=t.children,i=e.children;if(ne(r)&&ne(i))for(let s=0;s<r.length;s++){const o=r[s];let a=i[s];a.shapeFlag&1&&!a.dynamicChildren&&((a.patchFlag<=0||a.patchFlag===32)&&(a=i[s]=Si(i[s]),a.el=o.el),n||ZS(o,a))}}function Jx(t){const e=t.slice(),n=[0];let r,i,s,o,a;const c=t.length;for(r=0;r<c;r++){const l=t[r];if(l!==0){if(i=n[n.length-1],t[i]<l){e[r]=i,n.push(r);continue}for(s=0,o=n.length-1;s<o;)a=s+o>>1,t[n[a]]<l?s=a+1:o=a;l<t[n[s]]&&(s>0&&(e[r]=n[s-1]),n[s]=r)}}for(s=n.length,o=n[s-1];s-- >0;)n[s]=o,o=e[o];return n}const Xx=t=>t.__isTeleport,Zn=Symbol(void 0),v_=Symbol(void 0),or=Symbol(void 0),ph=Symbol(void 0),xc=[];let nr=null;function ol(t=!1){xc.push(nr=t?null:[])}function Zx(){xc.pop(),nr=xc[xc.length-1]||null}let al=1;function Xw(t){al+=t}function e0(t){return t.dynamicChildren=al>0?nr||Qo:null,Zx(),al>0&&nr&&nr.push(t),t}function w_(t,e,n,r,i,s){return e0(Wn(t,e,n,r,i,s,!0))}function t0(t,e,n,r,i){return e0(Vt(t,e,n,r,i,!0))}function Mg(t){return t?t.__v_isVNode===!0:!1}function Ts(t,e){return t.type===e.type&&t.key===e.key}const qd="__vInternal",n0=({key:t})=>t!=null?t:null,gh=({ref:t,ref_key:e,ref_for:n})=>t!=null?kt(t)||at(t)||de(t)?{i:Un,r:t,k:e,f:!!n}:t:null;function Wn(t,e=null,n=null,r=0,i=null,s=t===Zn?0:1,o=!1,a=!1){const c={__v_isVNode:!0,__v_skip:!0,type:t,props:e,key:e&&n0(e),ref:e&&gh(e),scopeId:$d,slotScopeIds:null,children:n,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:s,patchFlag:r,dynamicProps:i,dynamicChildren:null,appContext:null};return a?(I_(c,n),s&128&&t.normalize(c)):n&&(c.shapeFlag|=kt(n)?8:16),al>0&&!o&&nr&&(c.patchFlag>0||s&6)&&c.patchFlag!==32&&nr.push(c),c}const Vt=eM;function eM(t,e=null,n=null,r=0,i=null,s=!1){if((!t||t===xx)&&(t=or),Mg(t)){const a=Wi(t,e,!0);return n&&I_(a,n),al>0&&!s&&nr&&(a.shapeFlag&6?nr[nr.indexOf(t)]=a:nr.push(a)),a.patchFlag|=-2,a}if(dM(t)&&(t=t.__vccOpts),e){e=tM(e);let{class:a,style:c}=e;a&&!kt(a)&&(e.class=r_(a)),tt(c)&&(ES(c)&&!ne(c)&&(c=Kt({},c)),e.style=n_(c))}const o=kt(t)?1:vx(t)?128:Xx(t)?64:tt(t)?4:de(t)?2:0;return Wn(t,e,n,r,i,o,s,!0)}function tM(t){return t?ES(t)||qd in t?Kt({},t):t:null}function Wi(t,e,n=!1){const{props:r,ref:i,patchFlag:s,children:o}=t,a=e?rM(r||{},e):r;return{__v_isVNode:!0,__v_skip:!0,type:t.type,props:a,key:a&&n0(a),ref:e&&e.ref?n&&i?ne(i)?i.concat(gh(e)):[i,gh(e)]:gh(e):i,scopeId:t.scopeId,slotScopeIds:t.slotScopeIds,children:o,target:t.target,targetAnchor:t.targetAnchor,staticCount:t.staticCount,shapeFlag:t.shapeFlag,patchFlag:e&&t.type!==Zn?s===-1?16:s|16:s,dynamicProps:t.dynamicProps,dynamicChildren:t.dynamicChildren,appContext:t.appContext,dirs:t.dirs,transition:t.transition,component:t.component,suspense:t.suspense,ssContent:t.ssContent&&Wi(t.ssContent),ssFallback:t.ssFallback&&Wi(t.ssFallback),el:t.el,anchor:t.anchor}}function b_(t=" ",e=0){return Vt(v_,null,t,e)}function h9(t,e){const n=Vt(ph,null,t);return n.staticCount=e,n}function nM(t="",e=!1){return e?(ol(),t0(or,null,t)):Vt(or,null,t)}function _r(t){return t==null||typeof t=="boolean"?Vt(or):ne(t)?Vt(Zn,null,t.slice()):typeof t=="object"?Si(t):Vt(v_,null,String(t))}function Si(t){return t.el===null||t.memo?t:Wi(t)}function I_(t,e){let n=0;const{shapeFlag:r}=t;if(e==null)e=null;else if(ne(e))n=16;else if(typeof e=="object")if(r&65){const i=e.default;i&&(i._c&&(i._d=!1),I_(t,i()),i._c&&(i._d=!0));return}else{n=32;const i=e._;!i&&!(qd in e)?e._ctx=Un:i===3&&Un&&(Un.slots._===1?e._=1:(e._=2,t.patchFlag|=1024))}else de(e)?(e={default:e,_ctx:Un},n=32):(e=String(e),r&64?(n=16,e=[b_(e)]):n=8);t.children=e,t.shapeFlag|=n}function rM(...t){const e={};for(let n=0;n<t.length;n++){const r=t[n];for(const i in r)if(i==="class")e.class!==r.class&&(e.class=r_([e.class,r.class]));else if(i==="style")e.style=n_([e.style,r.style]);else if(Dd(i)){const s=e[i],o=r[i];o&&s!==o&&!(ne(s)&&s.includes(o))&&(e[i]=s?[].concat(s,o):o)}else i!==""&&(e[i]=r[i])}return e}function pr(t,e,n,r=null){qn(t,e,7,[n,r])}const iM=XS();let sM=0;function oM(t,e,n){const r=t.type,i=(e?e.appContext:t.appContext)||iM,s={uid:sM++,vnode:t,type:r,parent:e,appContext:i,root:null,next:null,subTree:null,effect:null,update:null,scope:new uS(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:e?e.provides:Object.create(i.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:zS(r,i),emitsOptions:xS(r,i),emit:null,emitted:null,propsDefaults:Fe,inheritAttrs:r.inheritAttrs,ctx:Fe,data:Fe,props:Fe,attrs:Fe,slots:Fe,refs:Fe,setupState:Fe,setupContext:null,suspense:n,suspenseId:n?n.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return s.ctx={_:s},s.root=e?e.root:s,s.emit=dx.bind(null,s),t.ce&&t.ce(s),s}let Tt=null;const E_=()=>Tt||Un,ha=t=>{Tt=t,t.scope.on()},$s=()=>{Tt&&Tt.scope.off(),Tt=null};function r0(t){return t.vnode.shapeFlag&4}let cl=!1;function aM(t,e=!1){cl=e;const{props:n,children:r}=t.vnode,i=r0(t);jx(t,n,i,e),Kx(t,r);const s=i?cM(t,e):void 0;return cl=!1,s}function cM(t,e){const n=t.type;t.accessCache=Object.create(null),t.proxy=ua(new Proxy(t.ctx,Lx));const{setup:r}=n;if(r){const i=t.setupContext=r.length>1?uM(t):null;ha(t),xa();const s=Li(r,t,0,[t.props,i]);if(Ma(),$s(),aS(s)){if(s.then($s,$s),e)return s.then(o=>{Zw(t,o,e)}).catch(o=>{Fd(o,t,0)});t.asyncDep=s}else Zw(t,s,e)}else i0(t,e)}function Zw(t,e,n){de(e)?t.type.__ssrInlineRender?t.ssrRender=e:t.render=e:tt(e)&&(t.setupState=AS(e)),i0(t,n)}let eb;function i0(t,e,n){const r=t.type;if(!t.render){if(!e&&eb&&!r.render){const i=r.template;if(i){const{isCustomElement:s,compilerOptions:o}=t.appContext.config,{delimiters:a,compilerOptions:c}=r,l=Kt(Kt({isCustomElement:s,delimiters:a},o),c);r.render=eb(i,l)}}t.render=r.render||sr}ha(t),xa(),Fx(t),Ma(),$s()}function lM(t){return new Proxy(t.attrs,{get(e,n){return Pn(t,"get","$attrs"),e[n]}})}function uM(t){const e=r=>{t.exposed=r||{}};let n;return{get attrs(){return n||(n=lM(t))},slots:t.slots,emit:t.emit,expose:e}}function Wd(t){if(t.exposed)return t.exposeProxy||(t.exposeProxy=new Proxy(AS(ua(t.exposed)),{get(e,n){if(n in e)return e[n];if(n in Nh)return Nh[n](t)}}))}function hM(t,e=!0){return de(t)?t.displayName||t.name:t.name||e&&t.__name}function dM(t){return de(t)&&"__vccOpts"in t}const tr=(t,e)=>ox(t,e,cl);function T_(t,e,n){const r=arguments.length;return r===2?tt(e)&&!ne(e)?Mg(e)?Vt(t,null,[e]):Vt(t,e):Vt(t,null,e):(r>3?n=Array.prototype.slice.call(arguments,2):r===3&&Mg(n)&&(n=[n]),Vt(t,e,n))}const fM="3.2.37",pM="http://www.w3.org/2000/svg",Ss=typeof document!="undefined"?document:null,tb=Ss&&Ss.createElement("template"),gM={insert:(t,e,n)=>{e.insertBefore(t,n||null)},remove:t=>{const e=t.parentNode;e&&e.removeChild(t)},createElement:(t,e,n,r)=>{const i=e?Ss.createElementNS(pM,t):Ss.createElement(t,n?{is:n}:void 0);return t==="select"&&r&&r.multiple!=null&&i.setAttribute("multiple",r.multiple),i},createText:t=>Ss.createTextNode(t),createComment:t=>Ss.createComment(t),setText:(t,e)=>{t.nodeValue=e},setElementText:(t,e)=>{t.textContent=e},parentNode:t=>t.parentNode,nextSibling:t=>t.nextSibling,querySelector:t=>Ss.querySelector(t),setScopeId(t,e){t.setAttribute(e,"")},cloneNode(t){const e=t.cloneNode(!0);return"_value"in t&&(e._value=t._value),e},insertStaticContent(t,e,n,r,i,s){const o=n?n.previousSibling:e.lastChild;if(i&&(i===s||i.nextSibling))for(;e.insertBefore(i.cloneNode(!0),n),!(i===s||!(i=i.nextSibling)););else{tb.innerHTML=r?`<svg>${t}</svg>`:t;const a=tb.content;if(r){const c=a.firstChild;for(;c.firstChild;)a.appendChild(c.firstChild);a.removeChild(c)}e.insertBefore(a,n)}return[o?o.nextSibling:e.firstChild,n?n.previousSibling:e.lastChild]}};function mM(t,e,n){const r=t._vtc;r&&(e=(e?[e,...r]:[...r]).join(" ")),e==null?t.removeAttribute("class"):n?t.setAttribute("class",e):t.className=e}function _M(t,e,n){const r=t.style,i=kt(n);if(n&&!i){for(const s in n)Lg(r,s,n[s]);if(e&&!kt(e))for(const s in e)n[s]==null&&Lg(r,s,"")}else{const s=r.display;i?e!==n&&(r.cssText=n):e&&t.removeAttribute("style"),"_vod"in t&&(r.display=s)}}const nb=/\s*!important$/;function Lg(t,e,n){if(ne(n))n.forEach(r=>Lg(t,e,r));else if(n==null&&(n=""),e.startsWith("--"))t.setProperty(e,n);else{const r=yM(t,e);nb.test(n)?t.setProperty(vo(r),n.replace(nb,""),"important"):t[r]=n}}const rb=["Webkit","Moz","ms"],vp={};function yM(t,e){const n=vp[e];if(n)return n;let r=Dr(e);if(r!=="filter"&&r in t)return vp[e]=r;r=Md(r);for(let i=0;i<rb.length;i++){const s=rb[i]+r;if(s in t)return vp[e]=s}return e}const ib="http://www.w3.org/1999/xlink";function vM(t,e,n,r,i){if(r&&e.startsWith("xlink:"))n==null?t.removeAttributeNS(ib,e.slice(6,e.length)):t.setAttributeNS(ib,e,n);else{const s=fO(e);n==null||s&&!sS(n)?t.removeAttribute(e):t.setAttribute(e,s?"":n)}}function wM(t,e,n,r,i,s,o){if(e==="innerHTML"||e==="textContent"){r&&o(r,i,s),t[e]=n==null?"":n;return}if(e==="value"&&t.tagName!=="PROGRESS"&&!t.tagName.includes("-")){t._value=n;const c=n==null?"":n;(t.value!==c||t.tagName==="OPTION")&&(t.value=c),n==null&&t.removeAttribute(e);return}let a=!1;if(n===""||n==null){const c=typeof t[e];c==="boolean"?n=sS(n):n==null&&c==="string"?(n="",a=!0):c==="number"&&(n=0,a=!0)}try{t[e]=n}catch{}a&&t.removeAttribute(e)}const[s0,bM]=(()=>{let t=Date.now,e=!1;if(typeof window!="undefined"){Date.now()>document.createEvent("Event").timeStamp&&(t=performance.now.bind(performance));const n=navigator.userAgent.match(/firefox\/(\d+)/i);e=!!(n&&Number(n[1])<=53)}return[t,e]})();let Fg=0;const IM=Promise.resolve(),EM=()=>{Fg=0},TM=()=>Fg||(IM.then(EM),Fg=s0());function Ai(t,e,n,r){t.addEventListener(e,n,r)}function SM(t,e,n,r){t.removeEventListener(e,n,r)}function CM(t,e,n,r,i=null){const s=t._vei||(t._vei={}),o=s[e];if(r&&o)o.value=r;else{const[a,c]=AM(e);if(r){const l=s[e]=kM(r,i);Ai(t,a,l,c)}else o&&(SM(t,a,o,c),s[e]=void 0)}}const sb=/(?:Once|Passive|Capture)$/;function AM(t){let e;if(sb.test(t)){e={};let n;for(;n=t.match(sb);)t=t.slice(0,t.length-n[0].length),e[n[0].toLowerCase()]=!0}return[vo(t.slice(2)),e]}function kM(t,e){const n=r=>{const i=r.timeStamp||s0();(bM||i>=n.attached-1)&&qn(RM(r,n.value),e,5,[r])};return n.value=t,n.attached=TM(),n}function RM(t,e){if(ne(e)){const n=t.stopImmediatePropagation;return t.stopImmediatePropagation=()=>{n.call(t),t._stopped=!0},e.map(r=>i=>!i._stopped&&r&&r(i))}else return e}const ob=/^on[a-z]/,NM=(t,e,n,r,i=!1,s,o,a,c)=>{e==="class"?mM(t,r,i):e==="style"?_M(t,n,r):Dd(e)?i_(e)||CM(t,e,n,r,o):(e[0]==="."?(e=e.slice(1),!0):e[0]==="^"?(e=e.slice(1),!1):PM(t,e,r,i))?wM(t,e,r,s,o,a,c):(e==="true-value"?t._trueValue=r:e==="false-value"&&(t._falseValue=r),vM(t,e,r,i))};function PM(t,e,n,r){return r?!!(e==="innerHTML"||e==="textContent"||e in t&&ob.test(e)&&de(n)):e==="spellcheck"||e==="draggable"||e==="translate"||e==="form"||e==="list"&&t.tagName==="INPUT"||e==="type"&&t.tagName==="TEXTAREA"||ob.test(e)&&kt(n)?!1:e in t}const _i="transition",oc="animation",o0=(t,{slots:e})=>T_(FS,DM(t),e);o0.displayName="Transition";const a0={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String};o0.props=Kt({},FS.props,a0);const gs=(t,e=[])=>{ne(t)?t.forEach(n=>n(...e)):t&&t(...e)},ab=t=>t?ne(t)?t.some(e=>e.length>1):t.length>1:!1;function DM(t){const e={};for(const B in t)B in a0||(e[B]=t[B]);if(t.css===!1)return e;const{name:n="v",type:r,duration:i,enterFromClass:s=`${n}-enter-from`,enterActiveClass:o=`${n}-enter-active`,enterToClass:a=`${n}-enter-to`,appearFromClass:c=s,appearActiveClass:l=o,appearToClass:u=a,leaveFromClass:h=`${n}-leave-from`,leaveActiveClass:d=`${n}-leave-active`,leaveToClass:f=`${n}-leave-to`}=t,g=OM(i),v=g&&g[0],I=g&&g[1],{onBeforeEnter:S,onEnter:k,onEnterCancelled:R,onLeave:E,onLeaveCancelled:p,onBeforeAppear:w=S,onAppear:y=k,onAppearCancelled:m=R}=e,U=(B,he,we)=>{ms(B,he?u:a),ms(B,he?l:o),we&&we()},N=(B,he)=>{B._isLeaving=!1,ms(B,h),ms(B,f),ms(B,d),he&&he()},oe=B=>(he,we)=>{const We=B?y:k,Ke=()=>U(he,B,we);gs(We,[he,Ke]),cb(()=>{ms(he,B?c:s),yi(he,B?u:a),ab(We)||lb(he,r,v,Ke)})};return Kt(e,{onBeforeEnter(B){gs(S,[B]),yi(B,s),yi(B,o)},onBeforeAppear(B){gs(w,[B]),yi(B,c),yi(B,l)},onEnter:oe(!1),onAppear:oe(!0),onLeave(B,he){B._isLeaving=!0;const we=()=>N(B,he);yi(B,h),LM(),yi(B,d),cb(()=>{!B._isLeaving||(ms(B,h),yi(B,f),ab(E)||lb(B,r,I,we))}),gs(E,[B,we])},onEnterCancelled(B){U(B,!1),gs(R,[B])},onAppearCancelled(B){U(B,!0),gs(m,[B])},onLeaveCancelled(B){N(B),gs(p,[B])}})}function OM(t){if(t==null)return null;if(tt(t))return[wp(t.enter),wp(t.leave)];{const e=wp(t);return[e,e]}}function wp(t){return nl(t)}function yi(t,e){e.split(/\s+/).forEach(n=>n&&t.classList.add(n)),(t._vtc||(t._vtc=new Set)).add(e)}function ms(t,e){e.split(/\s+/).forEach(r=>r&&t.classList.remove(r));const{_vtc:n}=t;n&&(n.delete(e),n.size||(t._vtc=void 0))}function cb(t){requestAnimationFrame(()=>{requestAnimationFrame(t)})}let xM=0;function lb(t,e,n,r){const i=t._endId=++xM,s=()=>{i===t._endId&&r()};if(n)return setTimeout(s,n);const{type:o,timeout:a,propCount:c}=MM(t,e);if(!o)return r();const l=o+"end";let u=0;const h=()=>{t.removeEventListener(l,d),s()},d=f=>{f.target===t&&++u>=c&&h()};setTimeout(()=>{u<c&&h()},a+1),t.addEventListener(l,d)}function MM(t,e){const n=window.getComputedStyle(t),r=g=>(n[g]||"").split(", "),i=r(_i+"Delay"),s=r(_i+"Duration"),o=ub(i,s),a=r(oc+"Delay"),c=r(oc+"Duration"),l=ub(a,c);let u=null,h=0,d=0;e===_i?o>0&&(u=_i,h=o,d=s.length):e===oc?l>0&&(u=oc,h=l,d=c.length):(h=Math.max(o,l),u=h>0?o>l?_i:oc:null,d=u?u===_i?s.length:c.length:0);const f=u===_i&&/\b(transform|all)(,|$)/.test(n[_i+"Property"]);return{type:u,timeout:h,propCount:d,hasTransform:f}}function ub(t,e){for(;t.length<e.length;)t=t.concat(t);return Math.max(...e.map((n,r)=>hb(n)+hb(t[r])))}function hb(t){return Number(t.slice(0,-1).replace(",","."))*1e3}function LM(){return document.body.offsetHeight}const da=t=>{const e=t.props["onUpdate:modelValue"]||!1;return ne(e)?n=>hh(e,n):e};function FM(t){t.target.composing=!0}function db(t){const e=t.target;e.composing&&(e.composing=!1,e.dispatchEvent(new Event("input")))}const d9={created(t,{modifiers:{lazy:e,trim:n,number:r}},i){t._assign=da(i);const s=r||i.props&&i.props.type==="number";Ai(t,e?"change":"input",o=>{if(o.target.composing)return;let a=t.value;n&&(a=a.trim()),s&&(a=nl(a)),t._assign(a)}),n&&Ai(t,"change",()=>{t.value=t.value.trim()}),e||(Ai(t,"compositionstart",FM),Ai(t,"compositionend",db),Ai(t,"change",db))},mounted(t,{value:e}){t.value=e==null?"":e},beforeUpdate(t,{value:e,modifiers:{lazy:n,trim:r,number:i}},s){if(t._assign=da(s),t.composing||document.activeElement===t&&t.type!=="range"&&(n||r&&t.value.trim()===e||(i||t.type==="number")&&nl(t.value)===e))return;const o=e==null?"":e;t.value!==o&&(t.value=o)}},f9={created(t,{value:e},n){t.checked=la(e,n.props.value),t._assign=da(n),Ai(t,"change",()=>{t._assign(ll(t))})},beforeUpdate(t,{value:e,oldValue:n},r){t._assign=da(r),e!==n&&(t.checked=la(e,r.props.value))}},p9={deep:!0,created(t,{value:e,modifiers:{number:n}},r){const i=Od(e);Ai(t,"change",()=>{const s=Array.prototype.filter.call(t.options,o=>o.selected).map(o=>n?nl(ll(o)):ll(o));t._assign(t.multiple?i?new Set(s):s:s[0])}),t._assign=da(r)},mounted(t,{value:e}){fb(t,e)},beforeUpdate(t,e,n){t._assign=da(n)},updated(t,{value:e}){fb(t,e)}};function fb(t,e){const n=t.multiple;if(!(n&&!ne(e)&&!Od(e))){for(let r=0,i=t.options.length;r<i;r++){const s=t.options[r],o=ll(s);if(n)ne(e)?s.selected=yO(e,o)>-1:s.selected=e.has(o);else if(la(ll(s),e)){t.selectedIndex!==r&&(t.selectedIndex=r);return}}!n&&t.selectedIndex!==-1&&(t.selectedIndex=-1)}}function ll(t){return"_value"in t?t._value:t.value}const UM={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},g9=(t,e)=>n=>{if(!("key"in n))return;const r=vo(n.key);if(e.some(i=>i===r||UM[i]===r))return t(n)},VM=Kt({patchProp:NM},gM);let pb;function $M(){return pb||(pb=Qx(VM))}const BM=(...t)=>{const e=$M().createApp(...t),{mount:n}=e;return e.mount=r=>{const i=jM(r);if(!i)return;const s=e._component;!de(s)&&!s.render&&!s.template&&(s.template=i.innerHTML),i.innerHTML="";const o=n(i,!1,i instanceof SVGElement);return i instanceof Element&&(i.removeAttribute("v-cloak"),i.setAttribute("data-v-app","")),o},e};function jM(t){return kt(t)?document.querySelector(t):t}const qM="modulepreload",gb={},WM="/Educatia/",gr=function(e,n){return!n||n.length===0?e():Promise.all(n.map(r=>{if(r=`${WM}${r}`,r in gb)return;gb[r]=!0;const i=r.endsWith(".css"),s=i?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${r}"]${s}`))return;const o=document.createElement("link");if(o.rel=i?"stylesheet":qM,i||(o.as="script",o.crossOrigin=""),o.href=r,document.head.appendChild(o),i)return new Promise((a,c)=>{o.addEventListener("load",a),o.addEventListener("error",()=>c(new Error(`Unable to preload CSS for ${r}`)))})})).then(()=>e())};/*!
  * vue-router v4.0.13
  * (c) 2022 Eduardo San Martin Morote
  * @license MIT
  */const c0=typeof Symbol=="function"&&typeof Symbol.toStringTag=="symbol",Fa=t=>c0?Symbol(t):"_vr_"+t,KM=Fa("rvlm"),mb=Fa("rvd"),Kd=Fa("r"),l0=Fa("rl"),Ug=Fa("rvl"),Wo=typeof window!="undefined";function HM(t){return t.__esModule||c0&&t[Symbol.toStringTag]==="Module"}const Le=Object.assign;function bp(t,e){const n={};for(const r in e){const i=e[r];n[r]=Array.isArray(i)?i.map(t):t(i)}return n}const Mc=()=>{},GM=/\/$/,zM=t=>t.replace(GM,"");function Ip(t,e,n="/"){let r,i={},s="",o="";const a=e.indexOf("?"),c=e.indexOf("#",a>-1?a:0);return a>-1&&(r=e.slice(0,a),s=e.slice(a+1,c>-1?c:e.length),i=t(s)),c>-1&&(r=r||e.slice(0,c),o=e.slice(c,e.length)),r=XM(r!=null?r:e,n),{fullPath:r+(s&&"?")+s+o,path:r,query:i,hash:o}}function QM(t,e){const n=e.query?t(e.query):"";return e.path+(n&&"?")+n+(e.hash||"")}function _b(t,e){return!e||!t.toLowerCase().startsWith(e.toLowerCase())?t:t.slice(e.length)||"/"}function YM(t,e,n){const r=e.matched.length-1,i=n.matched.length-1;return r>-1&&r===i&&fa(e.matched[r],n.matched[i])&&u0(e.params,n.params)&&t(e.query)===t(n.query)&&e.hash===n.hash}function fa(t,e){return(t.aliasOf||t)===(e.aliasOf||e)}function u0(t,e){if(Object.keys(t).length!==Object.keys(e).length)return!1;for(const n in t)if(!JM(t[n],e[n]))return!1;return!0}function JM(t,e){return Array.isArray(t)?yb(t,e):Array.isArray(e)?yb(e,t):t===e}function yb(t,e){return Array.isArray(e)?t.length===e.length&&t.every((n,r)=>n===e[r]):t.length===1&&t[0]===e}function XM(t,e){if(t.startsWith("/"))return t;if(!t)return e;const n=e.split("/"),r=t.split("/");let i=n.length-1,s,o;for(s=0;s<r.length;s++)if(o=r[s],!(i===1||o==="."))if(o==="..")i--;else break;return n.slice(0,i).join("/")+"/"+r.slice(s-(s===r.length?1:0)).join("/")}var ul;(function(t){t.pop="pop",t.push="push"})(ul||(ul={}));var Lc;(function(t){t.back="back",t.forward="forward",t.unknown=""})(Lc||(Lc={}));function ZM(t){if(!t)if(Wo){const e=document.querySelector("base");t=e&&e.getAttribute("href")||"/",t=t.replace(/^\w+:\/\/[^\/]+/,"")}else t="/";return t[0]!=="/"&&t[0]!=="#"&&(t="/"+t),zM(t)}const e1=/^[^#]+#/;function t1(t,e){return t.replace(e1,"#")+e}function n1(t,e){const n=document.documentElement.getBoundingClientRect(),r=t.getBoundingClientRect();return{behavior:e.behavior,left:r.left-n.left-(e.left||0),top:r.top-n.top-(e.top||0)}}const Hd=()=>({left:window.pageXOffset,top:window.pageYOffset});function r1(t){let e;if("el"in t){const n=t.el,r=typeof n=="string"&&n.startsWith("#"),i=typeof n=="string"?r?document.getElementById(n.slice(1)):document.querySelector(n):n;if(!i)return;e=n1(i,t)}else e=t;"scrollBehavior"in document.documentElement.style?window.scrollTo(e):window.scrollTo(e.left!=null?e.left:window.pageXOffset,e.top!=null?e.top:window.pageYOffset)}function vb(t,e){return(history.state?history.state.position-e:-1)+t}const Vg=new Map;function i1(t,e){Vg.set(t,e)}function s1(t){const e=Vg.get(t);return Vg.delete(t),e}let o1=()=>location.protocol+"//"+location.host;function h0(t,e){const{pathname:n,search:r,hash:i}=e,s=t.indexOf("#");if(s>-1){let a=i.includes(t.slice(s))?t.slice(s).length:1,c=i.slice(a);return c[0]!=="/"&&(c="/"+c),_b(c,"")}return _b(n,t)+r+i}function a1(t,e,n,r){let i=[],s=[],o=null;const a=({state:d})=>{const f=h0(t,location),g=n.value,v=e.value;let I=0;if(d){if(n.value=f,e.value=d,o&&o===g){o=null;return}I=v?d.position-v.position:0}else r(f);i.forEach(S=>{S(n.value,g,{delta:I,type:ul.pop,direction:I?I>0?Lc.forward:Lc.back:Lc.unknown})})};function c(){o=n.value}function l(d){i.push(d);const f=()=>{const g=i.indexOf(d);g>-1&&i.splice(g,1)};return s.push(f),f}function u(){const{history:d}=window;!d.state||d.replaceState(Le({},d.state,{scroll:Hd()}),"")}function h(){for(const d of s)d();s=[],window.removeEventListener("popstate",a),window.removeEventListener("beforeunload",u)}return window.addEventListener("popstate",a),window.addEventListener("beforeunload",u),{pauseListeners:c,listen:l,destroy:h}}function wb(t,e,n,r=!1,i=!1){return{back:t,current:e,forward:n,replaced:r,position:window.history.length,scroll:i?Hd():null}}function c1(t){const{history:e,location:n}=window,r={value:h0(t,n)},i={value:e.state};i.value||s(r.value,{back:null,current:r.value,forward:null,position:e.length-1,replaced:!0,scroll:null},!0);function s(c,l,u){const h=t.indexOf("#"),d=h>-1?(n.host&&document.querySelector("base")?t:t.slice(h))+c:o1()+t+c;try{e[u?"replaceState":"pushState"](l,"",d),i.value=l}catch(f){console.error(f),n[u?"replace":"assign"](d)}}function o(c,l){const u=Le({},e.state,wb(i.value.back,c,i.value.forward,!0),l,{position:i.value.position});s(c,u,!0),r.value=c}function a(c,l){const u=Le({},i.value,e.state,{forward:c,scroll:Hd()});s(u.current,u,!0);const h=Le({},wb(r.value,c,null),{position:u.position+1},l);s(c,h,!1),r.value=c}return{location:r,state:i,push:a,replace:o}}function l1(t){t=ZM(t);const e=c1(t),n=a1(t,e.state,e.location,e.replace);function r(s,o=!0){o||n.pauseListeners(),history.go(s)}const i=Le({location:"",base:t,go:r,createHref:t1.bind(null,t)},e,n);return Object.defineProperty(i,"location",{enumerable:!0,get:()=>e.location.value}),Object.defineProperty(i,"state",{enumerable:!0,get:()=>e.state.value}),i}function u1(t){return t=location.host?t||location.pathname+location.search:"",t.includes("#")||(t+="#"),l1(t)}function h1(t){return typeof t=="string"||t&&typeof t=="object"}function d0(t){return typeof t=="string"||typeof t=="symbol"}const vi={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0},f0=Fa("nf");var bb;(function(t){t[t.aborted=4]="aborted",t[t.cancelled=8]="cancelled",t[t.duplicated=16]="duplicated"})(bb||(bb={}));function pa(t,e){return Le(new Error,{type:t,[f0]:!0},e)}function wi(t,e){return t instanceof Error&&f0 in t&&(e==null||!!(t.type&e))}const Ib="[^/]+?",d1={sensitive:!1,strict:!1,start:!0,end:!0},f1=/[.+*?^${}()[\]/\\]/g;function p1(t,e){const n=Le({},d1,e),r=[];let i=n.start?"^":"";const s=[];for(const l of t){const u=l.length?[]:[90];n.strict&&!l.length&&(i+="/");for(let h=0;h<l.length;h++){const d=l[h];let f=40+(n.sensitive?.25:0);if(d.type===0)h||(i+="/"),i+=d.value.replace(f1,"\\$&"),f+=40;else if(d.type===1){const{value:g,repeatable:v,optional:I,regexp:S}=d;s.push({name:g,repeatable:v,optional:I});const k=S||Ib;if(k!==Ib){f+=10;try{new RegExp(`(${k})`)}catch(E){throw new Error(`Invalid custom RegExp for param "${g}" (${k}): `+E.message)}}let R=v?`((?:${k})(?:/(?:${k}))*)`:`(${k})`;h||(R=I&&l.length<2?`(?:/${R})`:"/"+R),I&&(R+="?"),i+=R,f+=20,I&&(f+=-8),v&&(f+=-20),k===".*"&&(f+=-50)}u.push(f)}r.push(u)}if(n.strict&&n.end){const l=r.length-1;r[l][r[l].length-1]+=.7000000000000001}n.strict||(i+="/?"),n.end?i+="$":n.strict&&(i+="(?:/|$)");const o=new RegExp(i,n.sensitive?"":"i");function a(l){const u=l.match(o),h={};if(!u)return null;for(let d=1;d<u.length;d++){const f=u[d]||"",g=s[d-1];h[g.name]=f&&g.repeatable?f.split("/"):f}return h}function c(l){let u="",h=!1;for(const d of t){(!h||!u.endsWith("/"))&&(u+="/"),h=!1;for(const f of d)if(f.type===0)u+=f.value;else if(f.type===1){const{value:g,repeatable:v,optional:I}=f,S=g in l?l[g]:"";if(Array.isArray(S)&&!v)throw new Error(`Provided param "${g}" is an array but it is not repeatable (* or + modifiers)`);const k=Array.isArray(S)?S.join("/"):S;if(!k)if(I)d.length<2&&(u.endsWith("/")?u=u.slice(0,-1):h=!0);else throw new Error(`Missing required param "${g}"`);u+=k}}return u}return{re:o,score:r,keys:s,parse:a,stringify:c}}function g1(t,e){let n=0;for(;n<t.length&&n<e.length;){const r=e[n]-t[n];if(r)return r;n++}return t.length<e.length?t.length===1&&t[0]===40+40?-1:1:t.length>e.length?e.length===1&&e[0]===40+40?1:-1:0}function m1(t,e){let n=0;const r=t.score,i=e.score;for(;n<r.length&&n<i.length;){const s=g1(r[n],i[n]);if(s)return s;n++}return i.length-r.length}const _1={type:0,value:""},y1=/[a-zA-Z0-9_]/;function v1(t){if(!t)return[[]];if(t==="/")return[[_1]];if(!t.startsWith("/"))throw new Error(`Invalid path "${t}"`);function e(f){throw new Error(`ERR (${n})/"${l}": ${f}`)}let n=0,r=n;const i=[];let s;function o(){s&&i.push(s),s=[]}let a=0,c,l="",u="";function h(){!l||(n===0?s.push({type:0,value:l}):n===1||n===2||n===3?(s.length>1&&(c==="*"||c==="+")&&e(`A repeatable param (${l}) must be alone in its segment. eg: '/:ids+.`),s.push({type:1,value:l,regexp:u,repeatable:c==="*"||c==="+",optional:c==="*"||c==="?"})):e("Invalid state to consume buffer"),l="")}function d(){l+=c}for(;a<t.length;){if(c=t[a++],c==="\\"&&n!==2){r=n,n=4;continue}switch(n){case 0:c==="/"?(l&&h(),o()):c===":"?(h(),n=1):d();break;case 4:d(),n=r;break;case 1:c==="("?n=2:y1.test(c)?d():(h(),n=0,c!=="*"&&c!=="?"&&c!=="+"&&a--);break;case 2:c===")"?u[u.length-1]=="\\"?u=u.slice(0,-1)+c:n=3:u+=c;break;case 3:h(),n=0,c!=="*"&&c!=="?"&&c!=="+"&&a--,u="";break;default:e("Unknown state");break}}return n===2&&e(`Unfinished custom RegExp for param "${l}"`),h(),o(),i}function w1(t,e,n){const r=p1(v1(t.path),n),i=Le(r,{record:t,parent:e,children:[],alias:[]});return e&&!i.record.aliasOf==!e.record.aliasOf&&e.children.push(i),i}function b1(t,e){const n=[],r=new Map;e=Tb({strict:!1,end:!0,sensitive:!1},e);function i(u){return r.get(u)}function s(u,h,d){const f=!d,g=E1(u);g.aliasOf=d&&d.record;const v=Tb(e,u),I=[g];if("alias"in u){const R=typeof u.alias=="string"?[u.alias]:u.alias;for(const E of R)I.push(Le({},g,{components:d?d.record.components:g.components,path:E,aliasOf:d?d.record:g}))}let S,k;for(const R of I){const{path:E}=R;if(h&&E[0]!=="/"){const p=h.record.path,w=p[p.length-1]==="/"?"":"/";R.path=h.record.path+(E&&w+E)}if(S=w1(R,h,v),d?d.alias.push(S):(k=k||S,k!==S&&k.alias.push(S),f&&u.name&&!Eb(S)&&o(u.name)),"children"in g){const p=g.children;for(let w=0;w<p.length;w++)s(p[w],S,d&&d.children[w])}d=d||S,c(S)}return k?()=>{o(k)}:Mc}function o(u){if(d0(u)){const h=r.get(u);h&&(r.delete(u),n.splice(n.indexOf(h),1),h.children.forEach(o),h.alias.forEach(o))}else{const h=n.indexOf(u);h>-1&&(n.splice(h,1),u.record.name&&r.delete(u.record.name),u.children.forEach(o),u.alias.forEach(o))}}function a(){return n}function c(u){let h=0;for(;h<n.length&&m1(u,n[h])>=0&&(u.record.path!==n[h].record.path||!p0(u,n[h]));)h++;n.splice(h,0,u),u.record.name&&!Eb(u)&&r.set(u.record.name,u)}function l(u,h){let d,f={},g,v;if("name"in u&&u.name){if(d=r.get(u.name),!d)throw pa(1,{location:u});v=d.record.name,f=Le(I1(h.params,d.keys.filter(k=>!k.optional).map(k=>k.name)),u.params),g=d.stringify(f)}else if("path"in u)g=u.path,d=n.find(k=>k.re.test(g)),d&&(f=d.parse(g),v=d.record.name);else{if(d=h.name?r.get(h.name):n.find(k=>k.re.test(h.path)),!d)throw pa(1,{location:u,currentLocation:h});v=d.record.name,f=Le({},h.params,u.params),g=d.stringify(f)}const I=[];let S=d;for(;S;)I.unshift(S.record),S=S.parent;return{name:v,path:g,params:f,matched:I,meta:S1(I)}}return t.forEach(u=>s(u)),{addRoute:s,resolve:l,removeRoute:o,getRoutes:a,getRecordMatcher:i}}function I1(t,e){const n={};for(const r of e)r in t&&(n[r]=t[r]);return n}function E1(t){return{path:t.path,redirect:t.redirect,name:t.name,meta:t.meta||{},aliasOf:void 0,beforeEnter:t.beforeEnter,props:T1(t),children:t.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in t?t.components||{}:{default:t.component}}}function T1(t){const e={},n=t.props||!1;if("component"in t)e.default=n;else for(const r in t.components)e[r]=typeof n=="boolean"?n:n[r];return e}function Eb(t){for(;t;){if(t.record.aliasOf)return!0;t=t.parent}return!1}function S1(t){return t.reduce((e,n)=>Le(e,n.meta),{})}function Tb(t,e){const n={};for(const r in t)n[r]=r in e?e[r]:t[r];return n}function p0(t,e){return e.children.some(n=>n===t||p0(t,n))}const g0=/#/g,C1=/&/g,A1=/\//g,k1=/=/g,R1=/\?/g,m0=/\+/g,N1=/%5B/g,P1=/%5D/g,_0=/%5E/g,D1=/%60/g,y0=/%7B/g,O1=/%7C/g,v0=/%7D/g,x1=/%20/g;function S_(t){return encodeURI(""+t).replace(O1,"|").replace(N1,"[").replace(P1,"]")}function M1(t){return S_(t).replace(y0,"{").replace(v0,"}").replace(_0,"^")}function $g(t){return S_(t).replace(m0,"%2B").replace(x1,"+").replace(g0,"%23").replace(C1,"%26").replace(D1,"`").replace(y0,"{").replace(v0,"}").replace(_0,"^")}function L1(t){return $g(t).replace(k1,"%3D")}function F1(t){return S_(t).replace(g0,"%23").replace(R1,"%3F")}function U1(t){return t==null?"":F1(t).replace(A1,"%2F")}function Dh(t){try{return decodeURIComponent(""+t)}catch{}return""+t}function V1(t){const e={};if(t===""||t==="?")return e;const r=(t[0]==="?"?t.slice(1):t).split("&");for(let i=0;i<r.length;++i){const s=r[i].replace(m0," "),o=s.indexOf("="),a=Dh(o<0?s:s.slice(0,o)),c=o<0?null:Dh(s.slice(o+1));if(a in e){let l=e[a];Array.isArray(l)||(l=e[a]=[l]),l.push(c)}else e[a]=c}return e}function Sb(t){let e="";for(let n in t){const r=t[n];if(n=L1(n),r==null){r!==void 0&&(e+=(e.length?"&":"")+n);continue}(Array.isArray(r)?r.map(s=>s&&$g(s)):[r&&$g(r)]).forEach(s=>{s!==void 0&&(e+=(e.length?"&":"")+n,s!=null&&(e+="="+s))})}return e}function $1(t){const e={};for(const n in t){const r=t[n];r!==void 0&&(e[n]=Array.isArray(r)?r.map(i=>i==null?null:""+i):r==null?r:""+r)}return e}function ac(){let t=[];function e(r){return t.push(r),()=>{const i=t.indexOf(r);i>-1&&t.splice(i,1)}}function n(){t=[]}return{add:e,list:()=>t,reset:n}}function Ci(t,e,n,r,i){const s=r&&(r.enterCallbacks[i]=r.enterCallbacks[i]||[]);return()=>new Promise((o,a)=>{const c=h=>{h===!1?a(pa(4,{from:n,to:e})):h instanceof Error?a(h):h1(h)?a(pa(2,{from:e,to:h})):(s&&r.enterCallbacks[i]===s&&typeof h=="function"&&s.push(h),o())},l=t.call(r&&r.instances[i],e,n,c);let u=Promise.resolve(l);t.length<3&&(u=u.then(c)),u.catch(h=>a(h))})}function Ep(t,e,n,r){const i=[];for(const s of t)for(const o in s.components){let a=s.components[o];if(!(e!=="beforeRouteEnter"&&!s.instances[o]))if(B1(a)){const l=(a.__vccOpts||a)[e];l&&i.push(Ci(l,n,r,s,o))}else{let c=a();i.push(()=>c.then(l=>{if(!l)return Promise.reject(new Error(`Couldn't resolve component "${o}" at "${s.path}"`));const u=HM(l)?l.default:l;s.components[o]=u;const d=(u.__vccOpts||u)[e];return d&&Ci(d,n,r,s,o)()}))}}return i}function B1(t){return typeof t=="object"||"displayName"in t||"props"in t||"__vccOpts"in t}function Cb(t){const e=Cr(Kd),n=Cr(l0),r=tr(()=>e.resolve(Nc(t.to))),i=tr(()=>{const{matched:c}=r.value,{length:l}=c,u=c[l-1],h=n.matched;if(!u||!h.length)return-1;const d=h.findIndex(fa.bind(null,u));if(d>-1)return d;const f=Ab(c[l-2]);return l>1&&Ab(u)===f&&h[h.length-1].path!==f?h.findIndex(fa.bind(null,c[l-2])):d}),s=tr(()=>i.value>-1&&K1(n.params,r.value.params)),o=tr(()=>i.value>-1&&i.value===n.matched.length-1&&u0(n.params,r.value.params));function a(c={}){return W1(c)?e[Nc(t.replace)?"replace":"push"](Nc(t.to)).catch(Mc):Promise.resolve()}return{route:r,href:tr(()=>r.value.href),isActive:s,isExactActive:o,navigate:a}}const j1=$S({name:"RouterLink",props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"}},useLink:Cb,setup(t,{slots:e}){const n=La(Cb(t)),{options:r}=Cr(Kd),i=tr(()=>({[kb(t.activeClass,r.linkActiveClass,"router-link-active")]:n.isActive,[kb(t.exactActiveClass,r.linkExactActiveClass,"router-link-exact-active")]:n.isExactActive}));return()=>{const s=e.default&&e.default(n);return t.custom?s:T_("a",{"aria-current":n.isExactActive?t.ariaCurrentValue:null,href:n.href,onClick:n.navigate,class:i.value},s)}}}),q1=j1;function W1(t){if(!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)&&!t.defaultPrevented&&!(t.button!==void 0&&t.button!==0)){if(t.currentTarget&&t.currentTarget.getAttribute){const e=t.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(e))return}return t.preventDefault&&t.preventDefault(),!0}}function K1(t,e){for(const n in e){const r=e[n],i=t[n];if(typeof r=="string"){if(r!==i)return!1}else if(!Array.isArray(i)||i.length!==r.length||r.some((s,o)=>s!==i[o]))return!1}return!0}function Ab(t){return t?t.aliasOf?t.aliasOf.path:t.path:""}const kb=(t,e,n)=>t!=null?t:e!=null?e:n,H1=$S({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},setup(t,{attrs:e,slots:n}){const r=Cr(Ug),i=tr(()=>t.route||r.value),s=Cr(mb,0),o=tr(()=>i.value.matched[s]);dh(mb,s+1),dh(KM,o),dh(Ug,i);const a=p_();return Oc(()=>[a.value,o.value,t.name],([c,l,u],[h,d,f])=>{l&&(l.instances[u]=c,d&&d!==l&&c&&c===h&&(l.leaveGuards.size||(l.leaveGuards=d.leaveGuards),l.updateGuards.size||(l.updateGuards=d.updateGuards))),c&&l&&(!d||!fa(l,d)||!h)&&(l.enterCallbacks[u]||[]).forEach(g=>g(c))},{flush:"post"}),()=>{const c=i.value,l=o.value,u=l&&l.components[t.name],h=t.name;if(!u)return Rb(n.default,{Component:u,route:c});const d=l.props[t.name],f=d?d===!0?c.params:typeof d=="function"?d(c):d:null,v=T_(u,Le({},f,e,{onVnodeUnmounted:I=>{I.component.isUnmounted&&(l.instances[h]=null)},ref:a}));return Rb(n.default,{Component:v,route:c})||v}}});function Rb(t,e){if(!t)return null;const n=t(e);return n.length===1?n[0]:n}const G1=H1;function z1(t){const e=b1(t.routes,t),n=t.parseQuery||V1,r=t.stringifyQuery||Sb,i=t.history,s=ac(),o=ac(),a=ac(),c=ZO(vi);let l=vi;Wo&&t.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const u=bp.bind(null,P=>""+P),h=bp.bind(null,U1),d=bp.bind(null,Dh);function f(P,X){let H,Z;return d0(P)?(H=e.getRecordMatcher(P),Z=X):Z=P,e.addRoute(Z,H)}function g(P){const X=e.getRecordMatcher(P);X&&e.removeRoute(X)}function v(){return e.getRoutes().map(P=>P.record)}function I(P){return!!e.getRecordMatcher(P)}function S(P,X){if(X=Le({},X||c.value),typeof P=="string"){const pe=Ip(n,P,X.path),_=e.resolve({path:pe.path},X),b=i.createHref(pe.fullPath);return Le(pe,_,{params:d(_.params),hash:Dh(pe.hash),redirectedFrom:void 0,href:b})}let H;if("path"in P)H=Le({},P,{path:Ip(n,P.path,X.path).path});else{const pe=Le({},P.params);for(const _ in pe)pe[_]==null&&delete pe[_];H=Le({},P,{params:h(P.params)}),X.params=h(X.params)}const Z=e.resolve(H,X),Oe=P.hash||"";Z.params=u(d(Z.params));const $e=QM(r,Le({},P,{hash:M1(Oe),path:Z.path})),ve=i.createHref($e);return Le({fullPath:$e,hash:Oe,query:r===Sb?$1(P.query):P.query||{}},Z,{redirectedFrom:void 0,href:ve})}function k(P){return typeof P=="string"?Ip(n,P,c.value.path):Le({},P)}function R(P,X){if(l!==P)return pa(8,{from:X,to:P})}function E(P){return y(P)}function p(P){return E(Le(k(P),{replace:!0}))}function w(P){const X=P.matched[P.matched.length-1];if(X&&X.redirect){const{redirect:H}=X;let Z=typeof H=="function"?H(P):H;return typeof Z=="string"&&(Z=Z.includes("?")||Z.includes("#")?Z=k(Z):{path:Z},Z.params={}),Le({query:P.query,hash:P.hash,params:P.params},Z)}}function y(P,X){const H=l=S(P),Z=c.value,Oe=P.state,$e=P.force,ve=P.replace===!0,pe=w(H);if(pe)return y(Le(k(pe),{state:Oe,force:$e,replace:ve}),X||H);const _=H;_.redirectedFrom=X;let b;return!$e&&YM(r,Z,H)&&(b=pa(16,{to:_,from:Z}),Do(Z,Z,!0,!1)),(b?Promise.resolve(b):U(_,Z)).catch(A=>wi(A)?wi(A,2)?A:En(A):Pe(A,_,Z)).then(A=>{if(A){if(wi(A,2))return y(Le(k(A.to),{state:Oe,force:$e,replace:ve}),X||_)}else A=oe(_,Z,!0,ve,Oe);return N(_,Z,A),A})}function m(P,X){const H=R(P,X);return H?Promise.reject(H):Promise.resolve()}function U(P,X){let H;const[Z,Oe,$e]=Q1(P,X);H=Ep(Z.reverse(),"beforeRouteLeave",P,X);for(const pe of Z)pe.leaveGuards.forEach(_=>{H.push(Ci(_,P,X))});const ve=m.bind(null,P,X);return H.push(ve),xo(H).then(()=>{H=[];for(const pe of s.list())H.push(Ci(pe,P,X));return H.push(ve),xo(H)}).then(()=>{H=Ep(Oe,"beforeRouteUpdate",P,X);for(const pe of Oe)pe.updateGuards.forEach(_=>{H.push(Ci(_,P,X))});return H.push(ve),xo(H)}).then(()=>{H=[];for(const pe of P.matched)if(pe.beforeEnter&&!X.matched.includes(pe))if(Array.isArray(pe.beforeEnter))for(const _ of pe.beforeEnter)H.push(Ci(_,P,X));else H.push(Ci(pe.beforeEnter,P,X));return H.push(ve),xo(H)}).then(()=>(P.matched.forEach(pe=>pe.enterCallbacks={}),H=Ep($e,"beforeRouteEnter",P,X),H.push(ve),xo(H))).then(()=>{H=[];for(const pe of o.list())H.push(Ci(pe,P,X));return H.push(ve),xo(H)}).catch(pe=>wi(pe,8)?pe:Promise.reject(pe))}function N(P,X,H){for(const Z of a.list())Z(P,X,H)}function oe(P,X,H,Z,Oe){const $e=R(P,X);if($e)return $e;const ve=X===vi,pe=Wo?history.state:{};H&&(Z||ve?i.replace(P.fullPath,Le({scroll:ve&&pe&&pe.scroll},Oe)):i.push(P.fullPath,Oe)),c.value=P,Do(P,X,H,ve),En()}let B;function he(){B=i.listen((P,X,H)=>{const Z=S(P),Oe=w(Z);if(Oe){y(Le(Oe,{replace:!0}),Z).catch(Mc);return}l=Z;const $e=c.value;Wo&&i1(vb($e.fullPath,H.delta),Hd()),U(Z,$e).catch(ve=>wi(ve,12)?ve:wi(ve,2)?(y(ve.to,Z).then(pe=>{wi(pe,20)&&!H.delta&&H.type===ul.pop&&i.go(-1,!1)}).catch(Mc),Promise.reject()):(H.delta&&i.go(-H.delta,!1),Pe(ve,Z,$e))).then(ve=>{ve=ve||oe(Z,$e,!1),ve&&(H.delta?i.go(-H.delta,!1):H.type===ul.pop&&wi(ve,20)&&i.go(-1,!1)),N(Z,$e,ve)}).catch(Mc)})}let we=ac(),We=ac(),Ke;function Pe(P,X,H){En(P);const Z=We.list();return Z.length?Z.forEach(Oe=>Oe(P,X,H)):console.error(P),Promise.reject(P)}function De(){return Ke&&c.value!==vi?Promise.resolve():new Promise((P,X)=>{we.add([P,X])})}function En(P){return Ke||(Ke=!P,he(),we.list().forEach(([X,H])=>P?H(P):X()),we.reset()),P}function Do(P,X,H,Z){const{scrollBehavior:Oe}=t;if(!Wo||!Oe)return Promise.resolve();const $e=!H&&s1(vb(P.fullPath,0))||(Z||!H)&&history.state&&history.state.scroll||null;return m_().then(()=>Oe(P,X,$e)).then(ve=>ve&&r1(ve)).catch(ve=>Pe(ve,P,X))}const jr=P=>i.go(P);let dr;const Mn=new Set;return{currentRoute:c,addRoute:f,removeRoute:g,hasRoute:I,getRoutes:v,resolve:S,options:t,push:E,replace:p,go:jr,back:()=>jr(-1),forward:()=>jr(1),beforeEach:s.add,beforeResolve:o.add,afterEach:a.add,onError:We.add,isReady:De,install(P){const X=this;P.component("RouterLink",q1),P.component("RouterView",G1),P.config.globalProperties.$router=X,Object.defineProperty(P.config.globalProperties,"$route",{enumerable:!0,get:()=>Nc(c)}),Wo&&!dr&&c.value===vi&&(dr=!0,E(i.location).catch(Oe=>{}));const H={};for(const Oe in vi)H[Oe]=tr(()=>c.value[Oe]);P.provide(Kd,X),P.provide(l0,La(H)),P.provide(Ug,c);const Z=P.unmount;Mn.add(P),P.unmount=function(){Mn.delete(P),Mn.size<1&&(l=vi,B&&B(),c.value=vi,dr=!1,Ke=!1),Z()}}}}function xo(t){return t.reduce((e,n)=>e.then(()=>n()),Promise.resolve())}function Q1(t,e){const n=[],r=[],i=[],s=Math.max(e.matched.length,t.matched.length);for(let o=0;o<s;o++){const a=e.matched[o];a&&(t.matched.find(l=>fa(l,a))?r.push(a):n.push(a));const c=t.matched[o];c&&(e.matched.find(l=>fa(l,c))||i.push(c))}return[n,r,i]}function m9(){return Cr(Kd)}const Y1=[{name:"Home",component:()=>gr(()=>import("./Home.6bbaaee4.js"),["assets/Home.6bbaaee4.js","assets/Home.31eea606.css","assets/loader.c8919ab6.js","assets/loader.3b2bd4b3.css"]),path:"/"},{name:"Add",component:()=>gr(()=>import("./Add.452793ff.js"),["assets/Add.452793ff.js","assets/Add.734cd8a9.css","assets/level.19f89a9b.js","assets/types.7d33b1ee.js","assets/loader.c8919ab6.js","assets/loader.3b2bd4b3.css"]),path:"/add"},{name:"Admin",component:()=>gr(()=>import("./admin.2df18b9b.js"),["assets/admin.2df18b9b.js","assets/admin.1da9aa51.css","assets/loader.c8919ab6.js","assets/loader.3b2bd4b3.css"]),path:"/admin"},{name:"Univercities",component:()=>gr(()=>import("./Uni.e3c2c9bf.js"),["assets/Uni.e3c2c9bf.js","assets/Uni.ff0c6bdd.css","assets/loader.c8919ab6.js","assets/loader.3b2bd4b3.css"]),path:"/Univercities"},{name:"loader",component:()=>gr(()=>import("./loader.c8919ab6.js"),["assets/loader.c8919ab6.js","assets/loader.3b2bd4b3.css"]),path:"/loader"},{name:"details",component:()=>gr(()=>import("./details.e82db0d0.js"),["assets/details.e82db0d0.js","assets/details.511e542e.css","assets/loader.c8919ab6.js","assets/loader.3b2bd4b3.css"]),path:"/University/:name"},{name:"mobileNav",component:()=>gr(()=>import("./mobileNav.4f8663cf.js"),["assets/mobileNav.4f8663cf.js","assets/mobileNav.7521cf29.css"]),path:"/nav"},{name:"Dashboard",component:()=>gr(()=>import("./Dashboard.26f996e7.js"),["assets/Dashboard.26f996e7.js","assets/Dashboard.bc87434d.css","assets/loader.c8919ab6.js","assets/loader.3b2bd4b3.css"]),path:"/admin/dashboard"},{name:"Edit",component:()=>gr(()=>import("./Edit.0d11d20c.js"),["assets/Edit.0d11d20c.js","assets/Edit.65fbaaa0.css","assets/loader.c8919ab6.js","assets/loader.3b2bd4b3.css","assets/level.19f89a9b.js","assets/types.7d33b1ee.js"]),path:"/admin/dashboard/edit/:name"},{name:"Testing",component:()=>gr(()=>import("./teting.245ae20a.js"),["assets/teting.245ae20a.js","assets/types.7d33b1ee.js"]),path:"/Testing"}],J1=z1({history:u1(),routes:Y1});var C_=(t,e)=>{const n=t.__vccOpts||t;for(const[r,i]of e)n[r]=i;return n};const X1={},A_=t=>(fx("data-v-a551ee56"),t=t(),px(),t),Z1={class:"container"},eL={class:"flex center between",id:"main-nav"},tL=A_(()=>Wn("div",{class:"flex center"},[Wn("div",{class:"logo"},[Wn("h1",null,"EDUCATIA")])],-1)),nL={class:"li"},rL=b_("Home"),iL=b_("Universities"),sL=A_(()=>Wn("a",{href:"#"},"Degrees",-1)),oL=A_(()=>Wn("div",{class:"nav-button"},[Wn("a",{href:"#contact-form"},[Wn("button",{class:"btn btn-primary"},"Conatact")])],-1));function aL(t,e,n,r,i,s){const o=Rg("router-link");return ol(),w_("header",null,[Wn("div",Z1,[Wn("nav",eL,[tL,Wn("div",nL,[Vt(o,{to:"/"},{default:Cg(()=>[rL]),_:1}),Vt(o,{to:"/Univercities"},{default:Cg(()=>[iL]),_:1}),sL]),oL])])])}var cL=C_(X1,[["render",aL],["__scopeId","data-v-a551ee56"]]);function lL(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var w0={exports:{}};(function(t,e){(function(n,r){t.exports=r()})(window,function(){return function(n){var r={};function i(s){if(r[s])return r[s].exports;var o=r[s]={i:s,l:!1,exports:{}};return n[s].call(o.exports,o,o.exports,i),o.l=!0,o.exports}return i.m=n,i.c=r,i.d=function(s,o,a){i.o(s,o)||Object.defineProperty(s,o,{enumerable:!0,get:a})},i.r=function(s){typeof Symbol!="undefined"&&Symbol.toStringTag&&Object.defineProperty(s,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(s,"__esModule",{value:!0})},i.t=function(s,o){if(1&o&&(s=i(s)),8&o||4&o&&typeof s=="object"&&s&&s.__esModule)return s;var a=Object.create(null);if(i.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:s}),2&o&&typeof s!="string")for(var c in s)i.d(a,c,function(l){return s[l]}.bind(null,c));return a},i.n=function(s){var o=s&&s.__esModule?function(){return s.default}:function(){return s};return i.d(o,"a",o),o},i.o=function(s,o){return Object.prototype.hasOwnProperty.call(s,o)},i.p="/",i(i.s=1)}([function(n,r){var i;i=function(){return this}();try{i=i||new Function("return this")()}catch{typeof window=="object"&&(i=window)}n.exports=i},function(n,r,i){i(2),n.exports=i(6)},function(n,r,i){(function(s,o){var a,c;function l(u){return(l=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(h){return typeof h}:function(h){return h&&typeof Symbol=="function"&&h.constructor===Symbol&&h!==Symbol.prototype?"symbol":typeof h})(u)}(function(u,h){l(r)=="object"&&n!==void 0?h():(c=typeof(a=h)=="function"?a.call(r,i,r,n):a)===void 0||(n.exports=c)})(0,function(){function u(E){var p=this.constructor;return this.then(function(w){return p.resolve(E()).then(function(){return w})},function(w){return p.resolve(E()).then(function(){return p.reject(w)})})}function h(){}function d(E){if(!(this instanceof d))throw new TypeError("Promises must be constructed via new");if(typeof E!="function")throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],S(E,this)}function f(E,p){for(;E._state===3;)E=E._value;E._state!==0?(E._handled=!0,d._immediateFn(function(){var w=E._state===1?p.onFulfilled:p.onRejected;if(w!==null){var y;try{y=w(E._value)}catch(m){return void v(p.promise,m)}g(p.promise,y)}else(E._state===1?g:v)(p.promise,E._value)})):E._deferreds.push(p)}function g(E,p){try{if(p===E)throw new TypeError("A promise cannot be resolved with itself.");if(p&&(l(p)=="object"||typeof p=="function")){var w=p.then;if(p instanceof d)return E._state=3,E._value=p,void I(E);if(typeof w=="function")return void S(function(y,m){return function(){y.apply(m,arguments)}}(w,p),E)}E._state=1,E._value=p,I(E)}catch(y){v(E,y)}}function v(E,p){E._state=2,E._value=p,I(E)}function I(E){E._state===2&&E._deferreds.length===0&&d._immediateFn(function(){E._handled||d._unhandledRejectionFn(E._value)});for(var p=0,w=E._deferreds.length;w>p;p++)f(E,E._deferreds[p]);E._deferreds=null}function S(E,p){var w=!1;try{E(function(y){w||(w=!0,g(p,y))},function(y){w||(w=!0,v(p,y))})}catch(y){if(w)return;w=!0,v(p,y)}}var k=setTimeout;d.prototype.catch=function(E){return this.then(null,E)},d.prototype.then=function(E,p){var w=new this.constructor(h);return f(this,new function(y,m,U){this.onFulfilled=typeof y=="function"?y:null,this.onRejected=typeof m=="function"?m:null,this.promise=U}(E,p,w)),w},d.prototype.finally=u,d.all=function(E){return new d(function(p,w){function y(oe,B){try{if(B&&(l(B)=="object"||typeof B=="function")){var he=B.then;if(typeof he=="function")return void he.call(B,function(we){y(oe,we)},w)}m[oe]=B,--U==0&&p(m)}catch(we){w(we)}}if(!E||E.length===void 0)throw new TypeError("Promise.all accepts an array");var m=Array.prototype.slice.call(E);if(m.length===0)return p([]);for(var U=m.length,N=0;m.length>N;N++)y(N,m[N])})},d.resolve=function(E){return E&&l(E)=="object"&&E.constructor===d?E:new d(function(p){p(E)})},d.reject=function(E){return new d(function(p,w){w(E)})},d.race=function(E){return new d(function(p,w){for(var y=0,m=E.length;m>y;y++)E[y].then(p,w)})},d._immediateFn=typeof s=="function"&&function(E){s(E)}||function(E){k(E,0)},d._unhandledRejectionFn=function(E){console!==void 0&&console&&console.warn("Possible Unhandled Promise Rejection:",E)};var R=function(){if(typeof self!="undefined")return self;if(typeof window!="undefined")return window;if(o!==void 0)return o;throw Error("unable to locate global object")}();"Promise"in R?R.Promise.prototype.finally||(R.Promise.prototype.finally=u):R.Promise=d})}).call(this,i(3).setImmediate,i(0))},function(n,r,i){(function(s){var o=s!==void 0&&s||typeof self!="undefined"&&self||window,a=Function.prototype.apply;function c(l,u){this._id=l,this._clearFn=u}r.setTimeout=function(){return new c(a.call(setTimeout,o,arguments),clearTimeout)},r.setInterval=function(){return new c(a.call(setInterval,o,arguments),clearInterval)},r.clearTimeout=r.clearInterval=function(l){l&&l.close()},c.prototype.unref=c.prototype.ref=function(){},c.prototype.close=function(){this._clearFn.call(o,this._id)},r.enroll=function(l,u){clearTimeout(l._idleTimeoutId),l._idleTimeout=u},r.unenroll=function(l){clearTimeout(l._idleTimeoutId),l._idleTimeout=-1},r._unrefActive=r.active=function(l){clearTimeout(l._idleTimeoutId);var u=l._idleTimeout;u>=0&&(l._idleTimeoutId=setTimeout(function(){l._onTimeout&&l._onTimeout()},u))},i(4),r.setImmediate=typeof self!="undefined"&&self.setImmediate||s!==void 0&&s.setImmediate||this&&this.setImmediate,r.clearImmediate=typeof self!="undefined"&&self.clearImmediate||s!==void 0&&s.clearImmediate||this&&this.clearImmediate}).call(this,i(0))},function(n,r,i){(function(s,o){(function(a,c){if(!a.setImmediate){var l,u,h,d,f,g=1,v={},I=!1,S=a.document,k=Object.getPrototypeOf&&Object.getPrototypeOf(a);k=k&&k.setTimeout?k:a,{}.toString.call(a.process)==="[object process]"?l=function(p){o.nextTick(function(){E(p)})}:function(){if(a.postMessage&&!a.importScripts){var p=!0,w=a.onmessage;return a.onmessage=function(){p=!1},a.postMessage("","*"),a.onmessage=w,p}}()?(d="setImmediate$"+Math.random()+"$",f=function(p){p.source===a&&typeof p.data=="string"&&p.data.indexOf(d)===0&&E(+p.data.slice(d.length))},a.addEventListener?a.addEventListener("message",f,!1):a.attachEvent("onmessage",f),l=function(p){a.postMessage(d+p,"*")}):a.MessageChannel?((h=new MessageChannel).port1.onmessage=function(p){E(p.data)},l=function(p){h.port2.postMessage(p)}):S&&"onreadystatechange"in S.createElement("script")?(u=S.documentElement,l=function(p){var w=S.createElement("script");w.onreadystatechange=function(){E(p),w.onreadystatechange=null,u.removeChild(w),w=null},u.appendChild(w)}):l=function(p){setTimeout(E,0,p)},k.setImmediate=function(p){typeof p!="function"&&(p=new Function(""+p));for(var w=new Array(arguments.length-1),y=0;y<w.length;y++)w[y]=arguments[y+1];var m={callback:p,args:w};return v[g]=m,l(g),g++},k.clearImmediate=R}function R(p){delete v[p]}function E(p){if(I)setTimeout(E,0,p);else{var w=v[p];if(w){I=!0;try{(function(y){var m=y.callback,U=y.args;switch(U.length){case 0:m();break;case 1:m(U[0]);break;case 2:m(U[0],U[1]);break;case 3:m(U[0],U[1],U[2]);break;default:m.apply(void 0,U)}})(w)}finally{R(p),I=!1}}}}})(typeof self=="undefined"?s===void 0?this:s:self)}).call(this,i(0),i(5))},function(n,r){var i,s,o=n.exports={};function a(){throw new Error("setTimeout has not been defined")}function c(){throw new Error("clearTimeout has not been defined")}function l(k){if(i===setTimeout)return setTimeout(k,0);if((i===a||!i)&&setTimeout)return i=setTimeout,setTimeout(k,0);try{return i(k,0)}catch{try{return i.call(null,k,0)}catch{return i.call(this,k,0)}}}(function(){try{i=typeof setTimeout=="function"?setTimeout:a}catch{i=a}try{s=typeof clearTimeout=="function"?clearTimeout:c}catch{s=c}})();var u,h=[],d=!1,f=-1;function g(){d&&u&&(d=!1,u.length?h=u.concat(h):f=-1,h.length&&v())}function v(){if(!d){var k=l(g);d=!0;for(var R=h.length;R;){for(u=h,h=[];++f<R;)u&&u[f].run();f=-1,R=h.length}u=null,d=!1,function(E){if(s===clearTimeout)return clearTimeout(E);if((s===c||!s)&&clearTimeout)return s=clearTimeout,clearTimeout(E);try{s(E)}catch{try{return s.call(null,E)}catch{return s.call(this,E)}}}(k)}}function I(k,R){this.fun=k,this.array=R}function S(){}o.nextTick=function(k){var R=new Array(arguments.length-1);if(arguments.length>1)for(var E=1;E<arguments.length;E++)R[E-1]=arguments[E];h.push(new I(k,R)),h.length!==1||d||l(v)},I.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=S,o.addListener=S,o.once=S,o.off=S,o.removeListener=S,o.removeAllListeners=S,o.emit=S,o.prependListener=S,o.prependOnceListener=S,o.listeners=function(k){return[]},o.binding=function(k){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(k){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}},function(n,r,i){i.r(r),i.d(r,"getInstance",function(){return E});var s={ASM:"asm",WASM:"ems",JS_WORKER:"jsworker",THREADED_WASM:"wasm-threads"};function o(p,w){if(typeof p!="string"||!w)return p;var y=w.substr(0,w.lastIndexOf("/"));return/^(\/|%2F|[a-z0-9-]+:)/i.test(p)?p:y+"/"+p}function a(p,w){var y=Object.keys(p);if(Object.getOwnPropertySymbols){var m=Object.getOwnPropertySymbols(p);w&&(m=m.filter(function(U){return Object.getOwnPropertyDescriptor(p,U).enumerable})),y.push.apply(y,m)}return y}function c(p){for(var w=1;w<arguments.length;w++){var y=arguments[w]!=null?arguments[w]:{};w%2?a(Object(y),!0).forEach(function(m){l(p,m,y[m])}):Object.getOwnPropertyDescriptors?Object.defineProperties(p,Object.getOwnPropertyDescriptors(y)):a(Object(y)).forEach(function(m){Object.defineProperty(p,m,Object.getOwnPropertyDescriptor(y,m))})}return p}function l(p,w,y){return w in p?Object.defineProperty(p,w,{value:y,enumerable:!0,configurable:!0,writable:!0}):p[w]=y,p}var u={},h=0;window.isPdfjs=!0,typeof console=="undefined"&&(window.console={log:function(){},warn:function(){},error:function(){}});var d=function(){for(var p=1;p<arguments.length;p++)for(var w=Object.keys(arguments[p]),y=0;y<w.length;y++)arguments[0][w[y]]=arguments[p][w[y]];return arguments[0]},f=function(p){var w=[];return p.forEach(function(y){w.push(y)}),w},g=function(p,w){var y;try{y=new CustomEvent(p,{detail:w,bubbles:!0,cancelable:!0})}catch{(y=document.createEvent("Event")).initEvent(p,!0,!0),y.detail=w}return y};window.PDFNet&&!u.skipPDFNetWebViewerWarning&&console.warn("PDFNet.js and WebViewer.js have been included in the same context. See https://www.pdftron.com/kb_same_context for an explanation of why this could be an error in your application.");var v=new Map,I=new Map;u.WebViewer=function(p,w){var y=this;if(I.get(w))throw new Error("Two instances of WebViewer were created on the same HTML element. Please create a new element for each instance of WebViewer");I.set(w,!0),w.addEventListener("ready",function oe(){v.get(w).instance=y.getCompleteInstance(),w.removeEventListener("ready",oe)}),this._validateOptions(p);var m=p.webviewerServerURL||p.pdftronServer;p.fullAPI&&m&&(p.forceClientSideInit||console.warn("The fullAPI and webviewerServerURL options have both been set so the forceClientSideInit option is now enabled. This means that WebViewer will switch to client side rendering and processing to allow use of the full API."),p.forceClientSideInit=!0),this.options=d({},u.WebViewer.Options,p);var U=this.options.path.length-1;U>0&&this.options.path[U]!=="/"&&(this.options.path+="/"),this.options.uiPath=this.options.path+this.options.uiPath,w||console.error("ViewerElement is not defined. This may be caused by calling the WebViewer constructor before the DOM is loaded, or an invalid selector. Please see http://r.pdftron.com/guides/quick-start for an example."),this.element=w,this.element.style.overflow="hidden";var N=this;this.messageHandler=function(oe){if(oe.data==="requestl"&&oe.source&&oe.source.postMessage({type:"responsel",value:p.l||p.licenseKey},"*"),oe.data.type==="requestConfig"&&oe.data.id===N.id&&oe.source){var B=p.config?N._correctRelativePath(p.config):"";oe.source.postMessage({type:"responseConfig",value:B},"*")}},window.addEventListener("message",this.messageHandler,!1),this.options.autoCreate&&this.create()};var S={licenseKey:void 0,enableAzureWorkaround:!1,isAdminUser:!1,isReadOnly:!1};u.WebViewer.prototype={version:"8.7.0",create:function(){if(this.options.initialDoc){var p=this._correctRelativePath(this.options.initialDoc);p=encodeURIComponent(JSON.stringify(p)),this.options.initialDoc=p}this._create()},_create:function(){this.id=++h,this._trigger===void 0&&(this._trigger=function(w,y){var m=g(w,y);this.element.dispatchEvent(m)});var p=this.options.type.replace(" ","").split(",");p.length<1&&(p[0]="html5"),this._createViewer(p)},_validateOptions:function(p){for(var w=Object.keys(p),y=0;y<w.length;y++){var m=w[y];m in d({},S,u.WebViewer.Options)||console.warn("".concat(m," is not a valid option name. See http://r.pdftron.com/api/options_anchor for all available options."))}var U=p.webviewerServerURL||p.pdftronServer;!p.enableRedaction||p.fullAPI||U||console.warn("FullAPI or WebViewer Server is needed to apply redactions")},_notSupportedMobile:function(){var p=document.createElement("div");p.id="webviewer-browser-unsupported",p.textContent="PDF document viewing is not supported by this browser.",this.element.appendChild(p)},_createViewer:function(p){var w,y=this;if(y.selectedType=null,this.isMobileDevice()){if(this.options.documentType&&this.options.documentType!=="xod"&&!this._testWebAssembly())return void this._notSupportedMobile();if(p=Array("html5Mobile"),y.selectedType="html5Mobile",this.options.mobileRedirect)return w=this.options.uiPath+this._getHTML5OptionsURL(),void(window.location=w)}for(var m=!1,U=!1,N=0;N<p.length;N++){if(p[N].toLowerCase()==="html5mobile"){if(this.options.documentType&&this.options.documentType!=="xod"&&!this._testWebAssembly())continue;if(m=!0,y._testHTML5()){if(this.options.mobileRedirect)return y.selectedType="html5Mobile",w=this.options.uiPath+this._getHTML5OptionsURL(),void(window.location=w);if(this.options.xdomainProxyUrl||y.isSameOrigin(decodeURIComponent(y.options.initialDoc))||y._testCORS()){y.selectedType="html5Mobile";break}U=!0}}if(p[N].toLowerCase()==="html5"&&(m=!0,y._testHTML5())){var oe=y.isSameOrigin(decodeURIComponent(y.options.initialDoc));if(this.options.xdomainProxyUrl||oe||y._testCORS()){y.selectedType="html5";break}U=!0}}if(y.selectedType==="html5")y._createHTML5();else if(y.selectedType==="html5Mobile")y._createHTML5Mobile();else{var B;if(U?B="This browser does not support cross origin requests. Please configure xdomain to support CORS.":m&&(B="Please use an HTML5 compatible browser."),B){var he=document.createElement("div");he.id="webviewer-browser-unsupported",he.textContent=B,y.element.appendChild(he)}}},_viewerLoaded:function(p){this._trigger("ready");try{var w=p.contentWindow;if(w.postMessage({type:"viewerLoaded"},"*"),this.options.encryption!==void 0){var y=decodeURIComponent(this.options.initialDoc);this.options.initialDoc&&(y=JSON.parse(y));var m={decrypt:w.Core.Encryption.decrypt,decryptOptions:this.options.encryption,documentId:this.options.documentId,extension:"xod"};this.getInstance().loadDocument(y,m)}}catch{console.warn("Viewer is on a different domain, the promise from WebViewer function is rejected and API functions will not work because of cross domain permissions. See http://r.pdftron.com/kb_cross_origin for more information.")}},_getHTML5OptionsURL:function(){var p,w,y,m=this.options,U=m.webviewerServerURL||m.pdftronServer,N="";if(m.initialDoc&&(N+="#d=".concat(m.initialDoc)),m.backendType===void 0&&(m.backendType=m.pdfBackend),m.documentType&&m.documentType==="xod"&&(p=m.documentType),m.preloadWorker&&m.preloadWorker==="xod"&&(p=m.preloadWorker),m.extension&&(p=m.extension),p&&(N+="&extension=".concat(p)),m.documentType&&m.documentType!=="xod"&&(w=m.documentType),m.preloadWorker&&m.preloadWorker!=="xod"&&(w=m.preloadWorker),w&&(N+="&preloadWorker=".concat(w)),m.backendType&&(N+="&pdf=".concat(m.backendType,"&office=").concat(m.backendType,"&legacyOffice=").concat(m.backendType)),m.filename&&(N+="&filename=".concat(m.filename)),m.streaming!==void 0&&(N+="&streaming=".concat(m.streaming)),m.externalPath){var oe=this._correctRelativePath(m.externalPath);oe=encodeURIComponent(oe),N+="&p=".concat(oe)}if(m.encryption&&(N+="&auto_load=false"),m.enableAnnotations&&(N+="&a=1"),m.disabledElements){var B=encodeURIComponent(m.disabledElements.join(","));N+="&disabledElements=".concat(B)}if(m.serverUrl){var he=this._correctRelativePath(m.serverUrl);he=encodeURIComponent(he),N+="&server_url=".concat(he)}if(m.serverUrlHeaders&&(N+="&serverUrlHeaders=".concat(JSON.stringify(m.serverUrlHeaders))),m.documentId&&(N+="&did=".concat(m.documentId)),m.css){var we=this._correctRelativePath(m.css);we=encodeURIComponent(we),N+="&css=".concat(we)}if(m.disableI18n&&(N+="&disableI18n=1"),m.enableOfflineMode&&(N+="&offline=1"),m.startOffline&&(N+="&startOffline=1"),(m.enableReadOnlyMode||m.isReadOnly)&&(N+="&readonly=1"),m.hideAnnotationPanel&&(N+="&hideAnnotationPanel=1"),m.disableToolGroupReordering&&(N+="&disableToolGroupReordering=1"),m.annotationUser!==void 0&&(N+="&user=".concat(m.annotationUser)),m.annotationAdmin===void 0&&m.isAdminUser===void 0||(N+="&admin=".concat(m.annotationAdmin||m.isAdminUser?1:0)),m.custom!==void 0&&(N+="&custom=".concat(encodeURIComponent(m.custom))),m.showLocalFilePicker===void 0&&m.enableFilePicker===void 0||(N+="&filepicker=".concat(m.showLocalFilePicker||m.enableFilePicker?1:0)),m.fullAPI!==void 0){if(m.fullAPI)throw new Error('"fullAPI" is not a valid constuctor option for PDF.js Express. Please make sure you are referring to the proper documentation (https://pdfjs.express/documentation)');N+="&pdfnet=".concat(m.fullAPI?1:0)}return m.enableRedaction!==void 0&&(N+="&enableRedaction=".concat(m.enableRedaction?1:0)),m.disableVirtualDisplayMode!==void 0&&(N+="&disableVirtualDisplayMode=".concat(m.disableVirtualDisplayMode?1:0)),m.enableMeasurement!==void 0&&(N+="&enableMeasurement=".concat(m.enableMeasurement?1:0)),m.showToolbarControl!==void 0&&(N+="&toolbar=".concat(m.showToolbarControl?"true":"false")),m.showPageHistoryButtons!==void 0&&(N+="&pageHistory=".concat(m.showPageHistoryButtons?1:0)),m.notesInLeftPanel!==void 0&&(N+="&notesInLeftPanel=".concat(m.notesInLeftPanel?1:0)),m.xdomainProxyUrl!==void 0&&(y=typeof m.xdomainProxyUrl=="string"?{url:m.xdomainProxyUrl}:m.xdomainProxyUrl,N+="&xdomain_urls=".concat(encodeURIComponent(JSON.stringify(y)))),(m.azureWorkaround||m.enableAzureWorkaround)&&(N+="&azureWorkaround=1"),m.enableOptimizedWorkers||(N+="&enableOptimizedWorkers=0"),m.useDownloader||(N+="&useDownloader=0"),m.disableWebsockets&&(N+="&disableWebsockets=1"),m.disableStreaming&&(N+="&disableStreaming=1"),m.forceClientSideInit&&(N+="&forceClientSideInit=1"),m.loadAsPDF&&(N+="&loadAsPDF=1"),m.workerTransportPromise!==void 0&&(N+="&useSharedWorker=".concat(m.workerTransportPromise?"true":"false")),U!==void 0&&U&&(N+="&webviewerServerURL=".concat(encodeURIComponent(U))),m.fallbackToClientSide&&(N+="&fallbackToClientSide=1"),m.singleServerMode!==void 0&&(N+="&singleServerMode=".concat(m.singleServerMode?"true":"false")),m.accessibleMode!==void 0&&(N+="&accessibleMode=".concat(m.accessibleMode?1:0)),m.disableLogs&&(N+="&disableLogs=1"),m.enableViewStateAnnotations&&(N+="&enableViewStateAnnotations=1"),m.disableFlattenedAnnotations&&(N+="&disableFlattenedAnnotations=1"),m.highContrastMode&&(N+="&highContrastMode=1"),m.selectAnnotationOnCreation!==void 0&&(N+="&selectAnnotationOnCreation=".concat(m.selectAnnotationOnCreation?1:0)),m.autoFocusNoteOnAnnotationSelection!==void 0&&(N+="&autoFocusNoteOnAnnotationSelection=".concat(m.autoFocusNoteOnAnnotationSelection?1:0)),N+="&id=".concat(this.id),(N+="&basePath=".concat(encodeURIComponent(window.location.pathname))).length>0&&N[0]==="&"&&(N="#".concat(N.slice(1))),N+="&webViewerJSVersion=".concat(this.version)},setInstanceData:function(p){v.set(this.element,{iframe:p,l:this.options.l||this.options.licenseKey,workerTransportPromise:this.options.workerTransportPromise})},_createHTML5:function(){var p=this,w=this.options.uiPath+this._getHTML5OptionsURL(),y=document.createElement("iframe");this.setInstanceData(y),y.id="webviewer-".concat(this.id),y.src=w,y.title="webviewer",y.frameBorder=0,y.width="100%",y.height="100%",y.setAttribute("allowfullscreen",!0),y.setAttribute("webkitallowfullscreen",!0),y.setAttribute("mozallowfullscreen",!0),this.iframe=y,this.options.backgroundColor&&y.setAttribute("data-bgcolor",this.options.backgroundColor),this.options.assetPath&&y.setAttribute("data-assetpath",encodeURIComponent(this.options.assetPath)),this.element.appendChild(y),window.addEventListener("message",function m(U){if(U.data.type==="viewerLoaded"&&U.data.id===p.id)try{p.instance=p.iframe.contentWindow.instance}catch{}finally{window.removeEventListener("message",m),p._viewerLoaded(p.iframe)}})},_createHTML5Mobile:function(){var p=this,w=this.options.uiPath+this._getHTML5OptionsURL(),y=document.createElement("iframe");this.setInstanceData(y),y.id="webviewer-".concat(this.id),y.src=w,y.frameborder=0,this.options.assetPath&&y.setAttribute("data-assetpath",encodeURIComponent(this.options.assetPath)),y.style.width="100%",y.style.height="100%",this.iframe=y,this.element.appendChild(y),window.addEventListener("message",function m(U){if(U.data.type==="viewerLoaded"&&U.data.id===p.id)try{p.instance=p.iframe.contentWindow.instance}catch{}finally{window.removeEventListener("message",m),p._viewerLoaded(p.iframe)}})},dispose:function(){v.delete(this.element),I.delete(this.element),this.instance.closeDocument(),window.removeEventListener("message",this.messageHandler),this.iframe.removeEventListener("load",this.loadListener),this.iframe=null},getInstance:function(){return this.instance},setCompleteInstance:function(p){this.completeInstance=p},getCompleteInstance:function(){return this.completeInstance},_correctRelativePath:function(p){var w=window.location.pathname;return Array.isArray(p)?p.map(function(y){return o(y,w)}):o(p,w)},_testHTML5:function(){try{var p=document.createElement("canvas");return p&&p.getContext("2d")}catch{return!1}},_testWebAssembly:function(){return!(!window.WebAssembly||!window.WebAssembly.validate)},_testCORS:function(){return"XMLHttpRequest"in window&&"withCredentials"in new XMLHttpRequest},isIE:function(){var p=navigator.userAgent.toLowerCase(),w=/(msie) ([\w.]+)/.exec(p)||/(trident)(?:.*? rv:([\w.]+)|)/.exec(p);return w&&parseInt(w[2],10)},isMobileDevice:function(){return!this.isIE()&&(this.scrollbarWidth()===0&&navigator.userAgent.match(/Edge/i)||navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/webOS/i)||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/Touch/i)||navigator.userAgent.match(/IEMobile/i)||navigator.userAgent.match(/Silk/i))},scrollbarWidth:function(){var p=document.createElement("div");p.style.cssText="width:100px;height:100px;overflow:scroll !important;position:absolute;top:-9999px",document.body.appendChild(p);var w=p.offsetWidth-p.clientWidth;return document.body.removeChild(p),w},isSameOrigin:function(p){var w=window.location,y=document.createElement("a");y.href=p,y.host===""&&(y.href=y.href);var m=window.location.port,U=y.port;return y.protocol==="http:"?(U=U||"80",m=m||"80"):y.protocol==="https:"&&(U=U||"443",m=m||"443"),y.hostname===w.hostname&&y.protocol===w.protocol&&U===m}},u.WebViewer.Options={initialDoc:void 0,annotationAdmin:void 0,isAdminUser:void 0,annotationUser:void 0,assetPath:void 0,autoCreate:!0,autoFocusNoteOnAnnotationSelection:!0,azureWorkaround:!1,additionalTranslations:void 0,enableAzureWorkaround:!1,enableOptimizedWorkers:!0,backgroundColor:void 0,backendType:void 0,css:void 0,config:void 0,custom:void 0,documentId:void 0,documentType:void 0,preloadWorker:void 0,extension:void 0,enableAnnotations:!0,filename:void 0,disableI18n:!1,disabledElements:void 0,disableWebsockets:!1,enableOfflineMode:!1,enableReadOnlyMode:!1,isReadOnly:!1,enableRedaction:!1,disableVirtualDisplayMode:!1,enableMeasurement:!1,encryption:void 0,externalPath:void 0,hideAnnotationPanel:!1,disableToolGroupReordering:!1,uiPath:"./ui/index.html",l:void 0,licenseKey:void 0,mobileRedirect:!1,path:"",pdfBackend:void 0,webviewerServerURL:void 0,fallbackToClientSide:!1,singleServerMode:!1,fullAPI:!1,preloadPDFWorker:!0,serverUrl:void 0,serverUrlHeaders:void 0,showLocalFilePicker:!1,enableFilePicker:!1,showPageHistoryButtons:!0,showToolbarControl:void 0,startOffline:!1,streaming:void 0,type:"html5",useDownloader:!0,workerTransportPromise:void 0,xdomainProxyUrl:void 0,ui:void 0,forceClientSideInit:!1,loadAsPDF:!1,accessibleMode:void 0,disableLogs:!1,enableViewStateAnnotations:!1,highContrastMode:!1,selectAnnotationOnCreation:!1,notesInLeftPanel:!1,documentXFDFRetriever:void 0,disableFlattenedAnnotations:!1,disableStreaming:!1};var k=function(p,w){return new Promise(function(y,m){p.l=p.l||p.licenseKey,p.azureWorkaround=p.azureWorkaround||p.enableAzureWorkaround,p.annotationAdmin=p.annotationAdmin||p.isAdminUser,p.enableReadOnlyMode=p.enableReadOnlyMode||p.isReadOnly,p.showLocalFilePicker=p.showLocalFilePicker||p.enableFilePicker,w.addEventListener("ready",function N(){w.removeEventListener("ready",N);try{var oe=w.querySelector("iframe").contentWindow;if(oe.Tools===void 0)throw new Error("Viewer isn't instantiated correctly. It could be caused by the 'path' option in the WebViewer constructor not being defined correctly. The 'path' option should be relative to the HTML file you're loading the script on and the lib folder needs to be publicly accessible.");var B=U.getInstance(),he={iframeWindow:oe,dispose:U.dispose.bind(U)},we=d({},B,c(l({},B.UI_NAMESPACE_KEY,c(c({},B[B.UI_NAMESPACE_KEY]),he)),he));U.setCompleteInstance(we);var We=Promise.resolve();if(p.documentXFDFRetriever&&(We=we[B.CORE_NAMESPACE_KEY].documentViewer.setDocumentXFDFRetriever(p.documentXFDFRetriever)),p.additionalTranslations){var Ke=p.additionalTranslations;we[B.UI_NAMESPACE_KEY].setTranslations(Ke.language,Ke.translations)}We.then(function(){y(we)})}catch{if("config"in p&&p.config!=="")return y();m("Viewer is on a different domain, the promise from WebViewer function is rejected and API functions will not work because of cross domain permissions. See https://www.pdftron.com/kb_cross_origin for more information.")}});var U=new u.WebViewer(p,w)})},R=function(p){for(var w=f(v),y=0;y<w.length;y++){var m=w[y];if(m.iframe===p)return m}return null};k.l=function(p){var w=R(p);return w&&w.l},k.workerTransportPromise=function(p){var w=R(p);return w&&w.workerTransportPromise},k.WorkerTypes={ALL:"all",OFFICE:"office",LEGACY_OFFICE:"legacyOffice",PDF:"pdf",CONTENT_EDIT:"contentEdit"},k.BackendTypes=s;var E=function(p){var w=f(v);if(!w.length||!w.filter(function(y){return y.instance}).length)return console.warn("WebViewer.getInstance() was called before any instances were available"),null;if(w.length>1&&!p)throw new Error("More than one instance of WebViewer was found, and no element was passed into getInstance(). Please specify which instance you want to get.");return p?(v.get(p)||{}).instance:(w[0]||{}).instance};k.getInstance=E,window.WebViewer=k,r.default=k}])})})(w0);var uL=lL(w0.exports);const hL={name:"WebViewer",props:{path:String},mounted:function(){uL({path:"http://localhost:3000/Educatia/#/index.html",initialDoc:"/Educatia/#/public/files/demo.pdf",licenseKey:"VMeLR5MsW5lX3X9YfqQF"},this.$refs.viewer).then(t=>{const{Core:e,UI:n}=t;e.documentViewer.addEventListener("documentLoaded",()=>{console.log("document loaded")}),e.documentViewer.addEventListener("pageNumberUpdated",r=>{console.log(`Page number is: ${r}`)}),n.setHeaderItems(r=>{r.push({type:"actionButton",img:"https://icons.getbootstrap.com/assets/icons/caret-right-fill.svg",onClick:()=>{const i=e.documentViewer.getCurrentPage(),s=e.documentViewer.getPageCount();i===s?e.documentViewer.setCurrentPage(1):e.documentViewer.setCurrentPage(i+1)}})})})}},dL={ref:"viewer"};function fL(t,e,n,r,i,s){return ol(),w_("div",dL,null,512)}var pL=C_(hL,[["render",fL],["__scopeId","data-v-17e39235"]]);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const b0={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $=function(t,e){if(!t)throw Ua(e)},Ua=function(t){return new Error("Firebase Database ("+b0.SDK_VERSION+") INTERNAL ASSERT FAILED: "+t)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const I0=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let i=t.charCodeAt(r);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=i&63|128):(i&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=i&63|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=i&63|128)}return e},gL=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const i=t[n++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){const s=t[n++];e[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){const s=t[n++],o=t[n++],a=t[n++],c=((i&7)<<18|(s&63)<<12|(o&63)<<6|a&63)-65536;e[r++]=String.fromCharCode(55296+(c>>10)),e[r++]=String.fromCharCode(56320+(c&1023))}else{const s=t[n++],o=t[n++];e[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|o&63)}}return e.join("")},Gd={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<t.length;i+=3){const s=t[i],o=i+1<t.length,a=o?t[i+1]:0,c=i+2<t.length,l=c?t[i+2]:0,u=s>>2,h=(s&3)<<4|a>>4;let d=(a&15)<<2|l>>6,f=l&63;c||(f=64,o||(d=64)),r.push(n[u],n[h],n[d],n[f])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(I0(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):gL(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<t.length;){const s=n[t.charAt(i++)],a=i<t.length?n[t.charAt(i)]:0;++i;const l=i<t.length?n[t.charAt(i)]:64;++i;const h=i<t.length?n[t.charAt(i)]:64;if(++i,s==null||a==null||l==null||h==null)throw Error();const d=s<<2|a>>4;if(r.push(d),l!==64){const f=a<<4&240|l>>2;if(r.push(f),h!==64){const g=l<<6&192|h;r.push(g)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}},E0=function(t){const e=I0(t);return Gd.encodeByteArray(e,!0)},Oh=function(t){return E0(t).replace(/\./g,"")},Bg=function(t){try{return Gd.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mL(t){return hl(void 0,t)}function hl(t,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:const n=e;return new Date(n.getTime());case Object:t===void 0&&(t={});break;case Array:t=[];break;default:return e}for(const n in e)!e.hasOwnProperty(n)||!_L(n)||(t[n]=hl(t[n],e[n]));return t}function _L(t){return t!=="__proto__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pt{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function k_(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",i=t.iat||0,s=t.sub||t.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},t),a="";return[Oh(JSON.stringify(n)),Oh(JSON.stringify(o)),a].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ze(){return typeof navigator!="undefined"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function zd(){return typeof window!="undefined"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(ze())}function R_(){try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function yL(){return typeof self=="object"&&self.self===self}function tu(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function nu(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function vL(){return ze().indexOf("Electron/")>=0}function N_(){const t=ze();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function wL(){return ze().indexOf("MSAppHost/")>=0}function T0(){return b0.NODE_ADMIN===!0}function bL(){return!R_()&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function bn(){return typeof indexedDB=="object"}function ru(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var s;e(((s=i.error)===null||s===void 0?void 0:s.message)||"")}}catch(n){e(n)}})}function Qd(){return!(typeof navigator=="undefined"||!navigator.cookieEnabled)}function IL(){if(typeof self!="undefined")return self;if(typeof window!="undefined")return window;if(typeof global!="undefined")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const EL="FirebaseError";class ct extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=EL,Object.setPrototypeOf(this,ct.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,dn.prototype.create)}}class dn{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},i=`${this.service}/${e}`,s=this.errors[e],o=s?TL(s,r):"Error",a=`${this.serviceName}: ${o} (${i}).`;return new ct(i,a,r)}}function TL(t,e){return t.replace(SL,(n,r)=>{const i=e[r];return i!=null?String(i):`<${r}?>`})}const SL=/\{\$([^}]+)}/g;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dl(t){return JSON.parse(t)}function gt(t){return JSON.stringify(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const P_=function(t){let e={},n={},r={},i="";try{const s=t.split(".");e=dl(Bg(s[0])||""),n=dl(Bg(s[1])||""),i=s[2],r=n.d||{},delete n.d}catch{}return{header:e,claims:n,data:r,signature:i}},CL=function(t){const e=P_(t).claims;return typeof e=="object"&&e.hasOwnProperty("iat")?e.iat:null},AL=function(t){const e=P_(t),n=e.claims;return!!n&&typeof n=="object"&&n.hasOwnProperty("iat")},kL=function(t){const e=P_(t).claims;return typeof e=="object"&&e.admin===!0};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dn(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function Hs(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]}function xh(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Mh(t,e,n){const r={};for(const i in t)Object.prototype.hasOwnProperty.call(t,i)&&(r[i]=e.call(n,t[i],i,t));return r}function jg(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const i of n){if(!r.includes(i))return!1;const s=t[i],o=e[i];if(Nb(s)&&Nb(o)){if(!jg(s,o))return!1}else if(s!==o)return!1}for(const i of r)if(!n.includes(i))return!1;return!0}function Nb(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wo(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function Ho(t){const e={};return t.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[i,s]=r.split("=");e[decodeURIComponent(i)]=decodeURIComponent(s)}}),e}function Sc(t){const e=t.indexOf("?");if(!e)return"";const n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RL{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=512/8,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(e,n){n||(n=0);const r=this.W_;if(typeof e=="string")for(let h=0;h<16;h++)r[h]=e.charCodeAt(n)<<24|e.charCodeAt(n+1)<<16|e.charCodeAt(n+2)<<8|e.charCodeAt(n+3),n+=4;else for(let h=0;h<16;h++)r[h]=e[n]<<24|e[n+1]<<16|e[n+2]<<8|e[n+3],n+=4;for(let h=16;h<80;h++){const d=r[h-3]^r[h-8]^r[h-14]^r[h-16];r[h]=(d<<1|d>>>31)&4294967295}let i=this.chain_[0],s=this.chain_[1],o=this.chain_[2],a=this.chain_[3],c=this.chain_[4],l,u;for(let h=0;h<80;h++){h<40?h<20?(l=a^s&(o^a),u=1518500249):(l=s^o^a,u=1859775393):h<60?(l=s&o|a&(s|o),u=2400959708):(l=s^o^a,u=3395469782);const d=(i<<5|i>>>27)+l+c+u+r[h]&4294967295;c=a,a=o,o=(s<<30|s>>>2)&4294967295,s=i,i=d}this.chain_[0]=this.chain_[0]+i&4294967295,this.chain_[1]=this.chain_[1]+s&4294967295,this.chain_[2]=this.chain_[2]+o&4294967295,this.chain_[3]=this.chain_[3]+a&4294967295,this.chain_[4]=this.chain_[4]+c&4294967295}update(e,n){if(e==null)return;n===void 0&&(n=e.length);const r=n-this.blockSize;let i=0;const s=this.buf_;let o=this.inbuf_;for(;i<n;){if(o===0)for(;i<=r;)this.compress_(e,i),i+=this.blockSize;if(typeof e=="string"){for(;i<n;)if(s[o]=e.charCodeAt(i),++o,++i,o===this.blockSize){this.compress_(s),o=0;break}}else for(;i<n;)if(s[o]=e[i],++o,++i,o===this.blockSize){this.compress_(s),o=0;break}}this.inbuf_=o,this.total_+=n}digest(){const e=[];let n=this.total_*8;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let i=this.blockSize-1;i>=56;i--)this.buf_[i]=n&255,n/=256;this.compress_(this.buf_);let r=0;for(let i=0;i<5;i++)for(let s=24;s>=0;s-=8)e[r]=this.chain_[i]>>s&255,++r;return e}}function S0(t,e){const n=new NL(t,e);return n.subscribe.bind(n)}class NL{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let i;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");PL(e,["next","error","complete"])?i=e:i={next:e,error:n,complete:r},i.next===void 0&&(i.next=Tp),i.error===void 0&&(i.error=Tp),i.complete===void 0&&(i.complete=Tp);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console!="undefined"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function PL(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function Tp(){}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ie=function(t,e,n,r){let i;if(r<e?i="at least "+e:r>n&&(i=n===0?"none":"no more than "+n),i){const s=t+" failed: Was called with "+r+(r===1?" argument.":" arguments.")+" Expects "+i+".";throw new Error(s)}};function wn(t,e){return`${t} failed: ${e} argument `}function wt(t,e,n,r){if(!(r&&!n)&&typeof n!="function")throw new Error(wn(t,e)+"must be a valid function.")}function Pb(t,e,n,r){if(!(r&&!n)&&(typeof n!="object"||n===null))throw new Error(wn(t,e)+"must be a valid context object.")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DL=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let i=t.charCodeAt(r);if(i>=55296&&i<=56319){const s=i-55296;r++,$(r<t.length,"Surrogate pair missing trail surrogate.");const o=t.charCodeAt(r)-56320;i=65536+(s<<10)+o}i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=i&63|128):i<65536?(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=i&63|128):(e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=i&63|128)}return e},Yd=function(t){let e=0;for(let n=0;n<t.length;n++){const r=t.charCodeAt(n);r<128?e++:r<2048?e+=2:r>=55296&&r<=56319?(e+=4,n++):e+=3}return e};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OL=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,t=>{const e=Math.random()*16|0;return(t==="x"?e:e&3|8).toString(16)})};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xL=1e3,ML=2,LL=4*60*60*1e3,FL=.5;function Lh(t,e=xL,n=ML){const r=e*Math.pow(n,t),i=Math.round(FL*r*(Math.random()-.5)*2);return Math.min(LL,r+i)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function M(t){return t&&t._delegate?t._delegate:t}class Ce{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ws="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C0{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new pt;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:n});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),i=(n=e==null?void 0:e.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(s){if(i)return null;throw s}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(VL(e))try{this.getOrInitializeService({instanceIdentifier:ws})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(n);try{const s=this.getOrInitializeService({instanceIdentifier:i});r.resolve(s)}catch{}}}}clearInstance(e=ws){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=ws){return this.instances.has(e)}getOptions(e=ws){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[s,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(s);r===a&&o.resolve(i)}return i}onInit(e,n){var r;const i=this.normalizeInstanceIdentifier(n),s=(r=this.onInitCallbacks.get(i))!==null&&r!==void 0?r:new Set;s.add(e),this.onInitCallbacks.set(i,s);const o=this.instances.get(i);return o&&e(o,i),()=>{s.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(!!r)for(const i of r)try{i(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:UL(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=ws){return this.component?this.component.multipleInstances?e:ws:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function UL(t){return t===ws?void 0:t}function VL(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A0{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new C0(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const D_=[];var ge;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(ge||(ge={}));const k0={debug:ge.DEBUG,verbose:ge.VERBOSE,info:ge.INFO,warn:ge.WARN,error:ge.ERROR,silent:ge.SILENT},$L=ge.INFO,BL={[ge.DEBUG]:"log",[ge.VERBOSE]:"log",[ge.INFO]:"info",[ge.WARN]:"warn",[ge.ERROR]:"error"},jL=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),i=BL[e];if(i)console[i](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class $r{constructor(e){this.name=e,this._logLevel=$L,this._logHandler=jL,this._userLogHandler=null,D_.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in ge))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?k0[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,ge.DEBUG,...e),this._logHandler(this,ge.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,ge.VERBOSE,...e),this._logHandler(this,ge.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,ge.INFO,...e),this._logHandler(this,ge.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,ge.WARN,...e),this._logHandler(this,ge.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,ge.ERROR,...e),this._logHandler(this,ge.ERROR,...e)}}function qL(t){D_.forEach(e=>{e.setLogLevel(t)})}function WL(t,e){for(const n of D_){let r=null;e&&e.level&&(r=k0[e.level]),t===null?n.userLogHandler=null:n.userLogHandler=(i,s,...o)=>{const a=o.map(c=>{if(c==null)return null;if(typeof c=="string")return c;if(typeof c=="number"||typeof c=="boolean")return c.toString();if(c instanceof Error)return c.message;try{return JSON.stringify(c)}catch{return null}}).filter(c=>c).join(" ");s>=(r!=null?r:i.logLevel)&&t({level:ge[s].toLowerCase(),message:a,args:o,type:i.name})}}}const KL=(t,e)=>e.some(n=>t instanceof n);let Db,Ob;function HL(){return Db||(Db=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function GL(){return Ob||(Ob=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const R0=new WeakMap,qg=new WeakMap,N0=new WeakMap,Sp=new WeakMap,O_=new WeakMap;function zL(t){const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("success",s),t.removeEventListener("error",o)},s=()=>{n(Xr(t.result)),i()},o=()=>{r(t.error),i()};t.addEventListener("success",s),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&R0.set(n,t)}).catch(()=>{}),O_.set(e,t),e}function QL(t){if(qg.has(t))return;const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("complete",s),t.removeEventListener("error",o),t.removeEventListener("abort",o)},s=()=>{n(),i()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",s),t.addEventListener("error",o),t.addEventListener("abort",o)});qg.set(t,e)}let Wg={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return qg.get(t);if(e==="objectStoreNames")return t.objectStoreNames||N0.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Xr(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function YL(t){Wg=t(Wg)}function JL(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(Cp(this),e,...n);return N0.set(r,e.sort?e.sort():[e]),Xr(r)}:GL().includes(t)?function(...e){return t.apply(Cp(this),e),Xr(R0.get(this))}:function(...e){return Xr(t.apply(Cp(this),e))}}function XL(t){return typeof t=="function"?JL(t):(t instanceof IDBTransaction&&QL(t),KL(t,HL())?new Proxy(t,Wg):t)}function Xr(t){if(t instanceof IDBRequest)return zL(t);if(Sp.has(t))return Sp.get(t);const e=XL(t);return e!==t&&(Sp.set(t,e),O_.set(e,t)),e}const Cp=t=>O_.get(t);function Va(t,e,{blocked:n,upgrade:r,blocking:i,terminated:s}={}){const o=indexedDB.open(t,e),a=Xr(o);return r&&o.addEventListener("upgradeneeded",c=>{r(Xr(o.result),c.oldVersion,c.newVersion,Xr(o.transaction))}),n&&o.addEventListener("blocked",()=>n()),a.then(c=>{s&&c.addEventListener("close",()=>s()),i&&c.addEventListener("versionchange",()=>i())}).catch(()=>{}),a}function Jo(t,{blocked:e}={}){const n=indexedDB.deleteDatabase(t);return e&&n.addEventListener("blocked",()=>e()),Xr(n).then(()=>{})}const ZL=["get","getKey","getAll","getAllKeys","count"],eF=["put","add","delete","clear"],Ap=new Map;function xb(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(Ap.get(e))return Ap.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,i=eF.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(i||ZL.includes(n)))return;const s=async function(o,...a){const c=this.transaction(o,i?"readwrite":"readonly");let l=c.store;return r&&(l=l.index(a.shift())),(await Promise.all([l[n](...a),i&&c.done]))[0]};return Ap.set(e,s),s}YL(t=>({...t,get:(e,n,r)=>xb(e,n)||t.get(e,n,r),has:(e,n)=>!!xb(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tF{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(nF(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function nF(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Kg="@firebase/app",Mb="0.7.28";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const x_=new $r("@firebase/app"),rF="@firebase/app-compat",iF="@firebase/analytics-compat",sF="@firebase/analytics",oF="@firebase/app-check-compat",aF="@firebase/app-check",cF="@firebase/auth",lF="@firebase/auth-compat",uF="@firebase/database",hF="@firebase/database-compat",dF="@firebase/functions",fF="@firebase/functions-compat",pF="@firebase/installations",gF="@firebase/installations-compat",mF="@firebase/messaging",_F="@firebase/messaging-compat",yF="@firebase/performance",vF="@firebase/performance-compat",wF="@firebase/remote-config",bF="@firebase/remote-config-compat",IF="@firebase/storage",EF="@firebase/storage-compat",TF="@firebase/firestore",SF="@firebase/firestore-compat",CF="firebase",AF="9.9.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gs="[DEFAULT]",kF={[Kg]:"fire-core",[rF]:"fire-core-compat",[sF]:"fire-analytics",[iF]:"fire-analytics-compat",[aF]:"fire-app-check",[oF]:"fire-app-check-compat",[cF]:"fire-auth",[lF]:"fire-auth-compat",[uF]:"fire-rtdb",[hF]:"fire-rtdb-compat",[dF]:"fire-fn",[fF]:"fire-fn-compat",[pF]:"fire-iid",[gF]:"fire-iid-compat",[mF]:"fire-fcm",[_F]:"fire-fcm-compat",[yF]:"fire-perf",[vF]:"fire-perf-compat",[wF]:"fire-rc",[bF]:"fire-rc-compat",[IF]:"fire-gcs",[EF]:"fire-gcs-compat",[TF]:"fire-fst",[SF]:"fire-fst-compat","fire-js":"fire-js",[CF]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ki=new Map,fl=new Map;function Fh(t,e){try{t.container.addComponent(e)}catch(n){x_.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function P0(t,e){t.container.addOrOverwriteComponent(e)}function nt(t){const e=t.name;if(fl.has(e))return x_.debug(`There were multiple attempts to register component ${e}.`),!1;fl.set(e,t);for(const n of Ki.values())Fh(n,t);return!0}function bo(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function RF(t,e,n=Gs){bo(t,e).clearInstance(n)}function NF(){fl.clear()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PF={["no-app"]:"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()",["bad-app-name"]:"Illegal App name: '{$appName}",["duplicate-app"]:"Firebase App named '{$appName}' already exists with different options or config",["app-deleted"]:"Firebase App named '{$appName}' already deleted",["invalid-app-argument"]:"firebase.{$appName}() takes either no argument or a Firebase App instance.",["invalid-log-argument"]:"First argument to `onLog` must be null or a function.",["storage-open"]:"Error thrown when opening storage. Original error: {$originalErrorMessage}.",["storage-get"]:"Error thrown when reading from storage. Original error: {$originalErrorMessage}.",["storage-set"]:"Error thrown when writing to storage. Original error: {$originalErrorMessage}.",["storage-delete"]:"Error thrown when deleting from storage. Original error: {$originalErrorMessage}."},Hi=new dn("app","Firebase",PF);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DF{constructor(e,n,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Ce("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Hi.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Br=AF;function D0(t,e={}){typeof e!="object"&&(e={name:e});const n=Object.assign({name:Gs,automaticDataCollectionEnabled:!1},e),r=n.name;if(typeof r!="string"||!r)throw Hi.create("bad-app-name",{appName:String(r)});const i=Ki.get(r);if(i){if(jg(t,i.options)&&jg(n,i.config))return i;throw Hi.create("duplicate-app",{appName:r})}const s=new A0(r);for(const a of fl.values())s.addComponent(a);const o=new DF(t,n,s);return Ki.set(r,o),o}function O0(t=Gs){const e=Ki.get(t);if(!e)throw Hi.create("no-app",{appName:t});return e}function OF(){return Array.from(Ki.values())}async function x0(t){const e=t.name;Ki.has(e)&&(Ki.delete(e),await Promise.all(t.container.getProviders().map(n=>n.delete())),t.isDeleted=!0)}function Ve(t,e,n){var r;let i=(r=kF[t])!==null&&r!==void 0?r:t;n&&(i+=`-${n}`);const s=i.match(/\s|\//),o=e.match(/\s|\//);if(s||o){const a=[`Unable to register library "${i}" with version "${e}":`];s&&a.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&o&&a.push("and"),o&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),x_.warn(a.join(" "));return}nt(new Ce(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}function M0(t,e){if(t!==null&&typeof t!="function")throw Hi.create("invalid-log-argument");WL(t,e)}function L0(t){qL(t)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xF="firebase-heartbeat-database",MF=1,pl="firebase-heartbeat-store";let kp=null;function F0(){return kp||(kp=Va(xF,MF,{upgrade:(t,e)=>{switch(e){case 0:t.createObjectStore(pl)}}}).catch(t=>{throw Hi.create("storage-open",{originalErrorMessage:t.message})})),kp}async function LF(t){var e;try{return(await F0()).transaction(pl).objectStore(pl).get(U0(t))}catch(n){throw Hi.create("storage-get",{originalErrorMessage:(e=n)===null||e===void 0?void 0:e.message})}}async function Lb(t,e){var n;try{const i=(await F0()).transaction(pl,"readwrite");return await i.objectStore(pl).put(e,U0(t)),i.done}catch(r){throw Hi.create("storage-set",{originalErrorMessage:(n=r)===null||n===void 0?void 0:n.message})}}function U0(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FF=1024,UF=30*24*60*60*1e3;class VF{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new BF(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=Fb();if(this._heartbeatsCache===null&&(this._heartbeatsCache=await this._heartbeatsCachePromise),!(this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(i=>i.date===r)))return this._heartbeatsCache.heartbeats.push({date:r,agent:n}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(i=>{const s=new Date(i.date).valueOf();return Date.now()-s<=UF}),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache===null||this._heartbeatsCache.heartbeats.length===0)return"";const e=Fb(),{heartbeatsToSend:n,unsentEntries:r}=$F(this._heartbeatsCache.heartbeats),i=Oh(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=e,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}}function Fb(){return new Date().toISOString().substring(0,10)}function $F(t,e=FF){const n=[];let r=t.slice();for(const i of t){const s=n.find(o=>o.agent===i.agent);if(s){if(s.dates.push(i.date),Ub(n)>e){s.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),Ub(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class BF{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return bn()?ru().then(()=>!0).catch(()=>!1):!1}async read(){return await this._canUseIndexedDBPromise?await LF(this.app)||{heartbeats:[]}:{heartbeats:[]}}async overwrite(e){var n;if(await this._canUseIndexedDBPromise){const i=await this.read();return Lb(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var n;if(await this._canUseIndexedDBPromise){const i=await this.read();return Lb(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function Ub(t){return Oh(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jF(t){nt(new Ce("platform-logger",e=>new tF(e),"PRIVATE")),nt(new Ce("heartbeat",e=>new VF(e),"PRIVATE")),Ve(Kg,Mb,t),Ve(Kg,Mb,"esm2017"),Ve("fire-js","")}jF("");var qF=Object.freeze(Object.defineProperty({__proto__:null,SDK_VERSION:Br,_DEFAULT_ENTRY_NAME:Gs,_addComponent:Fh,_addOrOverwriteComponent:P0,_apps:Ki,_clearComponents:NF,_components:fl,_getProvider:bo,_registerComponent:nt,_removeServiceInstance:RF,deleteApp:x0,getApp:O0,getApps:OF,initializeApp:D0,onLog:M0,registerVersion:Ve,setLogLevel:L0,FirebaseError:ct},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WF{constructor(e,n){this._delegate=e,this.firebase=n,Fh(e,new Ce("app-compat",()=>this,"PUBLIC")),this.container=e.container}get automaticDataCollectionEnabled(){return this._delegate.automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this._delegate.automaticDataCollectionEnabled=e}get name(){return this._delegate.name}get options(){return this._delegate.options}delete(){return new Promise(e=>{this._delegate.checkDestroyed(),e()}).then(()=>(this.firebase.INTERNAL.removeApp(this.name),x0(this._delegate)))}_getService(e,n=Gs){var r;this._delegate.checkDestroyed();const i=this._delegate.container.getProvider(e);return!i.isInitialized()&&((r=i.getComponent())===null||r===void 0?void 0:r.instantiationMode)==="EXPLICIT"&&i.initialize(),i.getImmediate({identifier:n})}_removeServiceInstance(e,n=Gs){this._delegate.container.getProvider(e).clearInstance(n)}_addComponent(e){Fh(this._delegate,e)}_addOrOverwriteComponent(e){P0(this._delegate,e)}toJSON(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KF={["no-app"]:"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()",["invalid-app-argument"]:"firebase.{$appName}() takes either no argument or a Firebase App instance."},Vb=new dn("app-compat","Firebase",KF);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function HF(t){const e={},n={__esModule:!0,initializeApp:s,app:i,registerVersion:Ve,setLogLevel:L0,onLog:M0,apps:null,SDK_VERSION:Br,INTERNAL:{registerComponent:a,removeApp:r,useAsService:c,modularAPIs:qF}};n.default=n,Object.defineProperty(n,"apps",{get:o});function r(l){delete e[l]}function i(l){if(l=l||Gs,!Dn(e,l))throw Vb.create("no-app",{appName:l});return e[l]}i.App=t;function s(l,u={}){const h=D0(l,u);if(Dn(e,h.name))return e[h.name];const d=new t(h,n);return e[h.name]=d,d}function o(){return Object.keys(e).map(l=>e[l])}function a(l){const u=l.name,h=u.replace("-compat","");if(nt(l)&&l.type==="PUBLIC"){const d=(f=i())=>{if(typeof f[h]!="function")throw Vb.create("invalid-app-argument",{appName:u});return f[h]()};l.serviceProps!==void 0&&hl(d,l.serviceProps),n[h]=d,t.prototype[h]=function(...f){return this._getService.bind(this,u).apply(this,l.multipleInstances?f:[])}}return l.type==="PUBLIC"?n[h]:null}function c(l,u){return u==="serverAuth"?null:u}return n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function V0(){const t=HF(WF);t.INTERNAL=Object.assign(Object.assign({},t.INTERNAL),{createFirebaseNamespace:V0,extendNamespace:e,createSubscribe:S0,ErrorFactory:dn,deepExtend:hl});function e(n){hl(t,n)}return t}const GF=V0();/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $b=new $r("@firebase/app-compat"),zF="@firebase/app-compat",QF="0.1.29";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function YF(t){Ve(zF,QF,t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */if(yL()&&self.firebase!==void 0){$b.warn(`
    Warning: Firebase is already defined in the global scope. Please make sure
    Firebase library is only loaded once.
  `);const t=self.firebase.SDK_VERSION;t&&t.indexOf("LITE")>=0&&$b.warn(`
    Warning: You are trying to load Firebase while using Firebase Performance standalone script.
    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.
    `)}const lt=GF;YF();const $0="@firebase/installations",M_="0.5.12";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const B0=1e4,j0=`w:${M_}`,q0="FIS_v2",JF="https://firebaseinstallations.googleapis.com/v1",XF=60*60*1e3,ZF="installations",eU="Installations";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tU={["missing-app-config-values"]:'Missing App configuration value: "{$valueName}"',["not-registered"]:"Firebase Installation is not registered.",["installation-not-found"]:"Firebase Installation not found.",["request-failed"]:'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',["app-offline"]:"Could not process request. Application offline.",["delete-pending-registration"]:"Can't delete installation while there is a pending registration request."},zs=new dn(ZF,eU,tU);function W0(t){return t instanceof ct&&t.code.includes("request-failed")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function K0({projectId:t}){return`${JF}/projects/${t}/installations`}function H0(t){return{token:t.token,requestStatus:2,expiresIn:rU(t.expiresIn),creationTime:Date.now()}}async function G0(t,e){const r=(await e.json()).error;return zs.create("request-failed",{requestName:t,serverCode:r.code,serverMessage:r.message,serverStatus:r.status})}function z0({apiKey:t}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t})}function nU(t,{refreshToken:e}){const n=z0(t);return n.append("Authorization",iU(e)),n}async function Q0(t){const e=await t();return e.status>=500&&e.status<600?t():e}function rU(t){return Number(t.replace("s","000"))}function iU(t){return`${q0} ${t}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function sU({appConfig:t,heartbeatServiceProvider:e},{fid:n}){const r=K0(t),i=z0(t),s=e.getImmediate({optional:!0});if(s){const l=await s.getHeartbeatsHeader();l&&i.append("x-firebase-client",l)}const o={fid:n,authVersion:q0,appId:t.appId,sdkVersion:j0},a={method:"POST",headers:i,body:JSON.stringify(o)},c=await Q0(()=>fetch(r,a));if(c.ok){const l=await c.json();return{fid:l.fid||n,registrationStatus:2,refreshToken:l.refreshToken,authToken:H0(l.authToken)}}else throw await G0("Create Installation",c)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Y0(t){return new Promise(e=>{setTimeout(e,t)})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oU(t){return btoa(String.fromCharCode(...t)).replace(/\+/g,"-").replace(/\//g,"_")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aU=/^[cdef][\w-]{21}$/,Hg="";function cU(){try{const t=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(t),t[0]=112+t[0]%16;const n=lU(t);return aU.test(n)?n:Hg}catch{return Hg}}function lU(t){return oU(t).substr(0,22)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Jd(t){return`${t.appName}!${t.appId}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const J0=new Map;function X0(t,e){const n=Jd(t);Z0(n,e),uU(n,e)}function Z0(t,e){const n=J0.get(t);if(!!n)for(const r of n)r(e)}function uU(t,e){const n=hU();n&&n.postMessage({key:t,fid:e}),dU()}let Ds=null;function hU(){return!Ds&&"BroadcastChannel"in self&&(Ds=new BroadcastChannel("[Firebase] FID Change"),Ds.onmessage=t=>{Z0(t.data.key,t.data.fid)}),Ds}function dU(){J0.size===0&&Ds&&(Ds.close(),Ds=null)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fU="firebase-installations-database",pU=1,Qs="firebase-installations-store";let Rp=null;function L_(){return Rp||(Rp=Va(fU,pU,{upgrade:(t,e)=>{switch(e){case 0:t.createObjectStore(Qs)}}})),Rp}async function Uh(t,e){const n=Jd(t),i=(await L_()).transaction(Qs,"readwrite"),s=i.objectStore(Qs),o=await s.get(n);return await s.put(e,n),await i.done,(!o||o.fid!==e.fid)&&X0(t,e.fid),e}async function eC(t){const e=Jd(t),r=(await L_()).transaction(Qs,"readwrite");await r.objectStore(Qs).delete(e),await r.done}async function Xd(t,e){const n=Jd(t),i=(await L_()).transaction(Qs,"readwrite"),s=i.objectStore(Qs),o=await s.get(n),a=e(o);return a===void 0?await s.delete(n):await s.put(a,n),await i.done,a&&(!o||o.fid!==a.fid)&&X0(t,a.fid),a}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function F_(t){let e;const n=await Xd(t.appConfig,r=>{const i=gU(r),s=mU(t,i);return e=s.registrationPromise,s.installationEntry});return n.fid===Hg?{installationEntry:await e}:{installationEntry:n,registrationPromise:e}}function gU(t){const e=t||{fid:cU(),registrationStatus:0};return tC(e)}function mU(t,e){if(e.registrationStatus===0){if(!navigator.onLine){const i=Promise.reject(zs.create("app-offline"));return{installationEntry:e,registrationPromise:i}}const n={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},r=_U(t,n);return{installationEntry:n,registrationPromise:r}}else return e.registrationStatus===1?{installationEntry:e,registrationPromise:yU(t)}:{installationEntry:e}}async function _U(t,e){try{const n=await sU(t,e);return Uh(t.appConfig,n)}catch(n){throw W0(n)&&n.customData.serverCode===409?await eC(t.appConfig):await Uh(t.appConfig,{fid:e.fid,registrationStatus:0}),n}}async function yU(t){let e=await Bb(t.appConfig);for(;e.registrationStatus===1;)await Y0(100),e=await Bb(t.appConfig);if(e.registrationStatus===0){const{installationEntry:n,registrationPromise:r}=await F_(t);return r||n}return e}function Bb(t){return Xd(t,e=>{if(!e)throw zs.create("installation-not-found");return tC(e)})}function tC(t){return vU(t)?{fid:t.fid,registrationStatus:0}:t}function vU(t){return t.registrationStatus===1&&t.registrationTime+B0<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function wU({appConfig:t,heartbeatServiceProvider:e},n){const r=bU(t,n),i=nU(t,n),s=e.getImmediate({optional:!0});if(s){const l=await s.getHeartbeatsHeader();l&&i.append("x-firebase-client",l)}const o={installation:{sdkVersion:j0,appId:t.appId}},a={method:"POST",headers:i,body:JSON.stringify(o)},c=await Q0(()=>fetch(r,a));if(c.ok){const l=await c.json();return H0(l)}else throw await G0("Generate Auth Token",c)}function bU(t,{fid:e}){return`${K0(t)}/${e}/authTokens:generate`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function U_(t,e=!1){let n;const r=await Xd(t.appConfig,s=>{if(!nC(s))throw zs.create("not-registered");const o=s.authToken;if(!e&&TU(o))return s;if(o.requestStatus===1)return n=IU(t,e),s;{if(!navigator.onLine)throw zs.create("app-offline");const a=CU(s);return n=EU(t,a),a}});return n?await n:r.authToken}async function IU(t,e){let n=await jb(t.appConfig);for(;n.authToken.requestStatus===1;)await Y0(100),n=await jb(t.appConfig);const r=n.authToken;return r.requestStatus===0?U_(t,e):r}function jb(t){return Xd(t,e=>{if(!nC(e))throw zs.create("not-registered");const n=e.authToken;return AU(n)?Object.assign(Object.assign({},e),{authToken:{requestStatus:0}}):e})}async function EU(t,e){try{const n=await wU(t,e),r=Object.assign(Object.assign({},e),{authToken:n});return await Uh(t.appConfig,r),n}catch(n){if(W0(n)&&(n.customData.serverCode===401||n.customData.serverCode===404))await eC(t.appConfig);else{const r=Object.assign(Object.assign({},e),{authToken:{requestStatus:0}});await Uh(t.appConfig,r)}throw n}}function nC(t){return t!==void 0&&t.registrationStatus===2}function TU(t){return t.requestStatus===2&&!SU(t)}function SU(t){const e=Date.now();return e<t.creationTime||t.creationTime+t.expiresIn<e+XF}function CU(t){const e={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},t),{authToken:e})}function AU(t){return t.requestStatus===1&&t.requestTime+B0<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function kU(t){const e=t,{installationEntry:n,registrationPromise:r}=await F_(e);return r?r.catch(console.error):U_(e).catch(console.error),n.fid}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function RU(t,e=!1){const n=t;return await NU(n),(await U_(n,e)).token}async function NU(t){const{registrationPromise:e}=await F_(t);e&&await e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PU(t){if(!t||!t.options)throw Np("App Configuration");if(!t.name)throw Np("App Name");const e=["projectId","apiKey","appId"];for(const n of e)if(!t.options[n])throw Np(n);return{appName:t.name,projectId:t.options.projectId,apiKey:t.options.apiKey,appId:t.options.appId}}function Np(t){return zs.create("missing-app-config-values",{valueName:t})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rC="installations",DU="installations-internal",OU=t=>{const e=t.getProvider("app").getImmediate(),n=PU(e),r=bo(e,"heartbeat");return{app:e,appConfig:n,heartbeatServiceProvider:r,_delete:()=>Promise.resolve()}},xU=t=>{const e=t.getProvider("app").getImmediate(),n=bo(e,rC).getImmediate();return{getId:()=>kU(n),getToken:i=>RU(n,i)}};function MU(){nt(new Ce(rC,OU,"PUBLIC")),nt(new Ce(DU,xU,"PRIVATE"))}MU();Ve($0,M_);Ve($0,M_,"esm2017");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qb="analytics",LU="firebase_id",FU="origin",UU=60*1e3,VU="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",iC="https://www.googletagmanager.com/gtag/js";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bt=new $r("@firebase/analytics");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sC(t){return Promise.all(t.map(e=>e.catch(n=>n)))}function $U(t,e){const n=document.createElement("script");n.src=`${iC}?l=${t}&id=${e}`,n.async=!0,document.head.appendChild(n)}function BU(t){let e=[];return Array.isArray(window[t])?e=window[t]:window[t]=e,e}async function jU(t,e,n,r,i,s){const o=r[i];try{if(o)await e[o];else{const c=(await sC(n)).find(l=>l.measurementId===i);c&&await e[c.appId]}}catch(a){Bt.error(a)}t("config",i,s)}async function qU(t,e,n,r,i){try{let s=[];if(i&&i.send_to){let o=i.send_to;Array.isArray(o)||(o=[o]);const a=await sC(n);for(const c of o){const l=a.find(h=>h.measurementId===c),u=l&&e[l.appId];if(u)s.push(u);else{s=[];break}}}s.length===0&&(s=Object.values(e)),await Promise.all(s),t("event",r,i||{})}catch(s){Bt.error(s)}}function WU(t,e,n,r){async function i(s,o,a){try{s==="event"?await qU(t,e,n,o,a):s==="config"?await jU(t,e,n,r,o,a):s==="consent"?t("consent","update",a):t("set",o)}catch(c){Bt.error(c)}}return i}function KU(t,e,n,r,i){let s=function(...o){window[r].push(arguments)};return window[i]&&typeof window[i]=="function"&&(s=window[i]),window[i]=WU(s,t,e,n),{gtagCore:s,wrappedGtag:window[i]}}function HU(){const t=window.document.getElementsByTagName("script");for(const e of Object.values(t))if(e.src&&e.src.includes(iC))return e;return null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GU={["already-exists"]:"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.",["already-initialized"]:"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-intialized instance.",["already-initialized-settings"]:"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.",["interop-component-reg-failed"]:"Firebase Analytics Interop Component failed to instantiate: {$reason}",["invalid-analytics-context"]:"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}",["indexeddb-unavailable"]:"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}",["fetch-throttle"]:"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.",["config-fetch-failed"]:"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}",["no-api-key"]:'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',["no-app-id"]:'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.'},Kn=new dn("analytics","Analytics",GU);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zU=30,QU=1e3;class YU{constructor(e={},n=QU){this.throttleMetadata=e,this.intervalMillis=n}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,n){this.throttleMetadata[e]=n}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}}const oC=new YU;function JU(t){return new Headers({Accept:"application/json","x-goog-api-key":t})}async function XU(t){var e;const{appId:n,apiKey:r}=t,i={method:"GET",headers:JU(r)},s=VU.replace("{app-id}",n),o=await fetch(s,i);if(o.status!==200&&o.status!==304){let a="";try{const c=await o.json();!((e=c.error)===null||e===void 0)&&e.message&&(a=c.error.message)}catch{}throw Kn.create("config-fetch-failed",{httpStatus:o.status,responseMessage:a})}return o.json()}async function ZU(t,e=oC,n){const{appId:r,apiKey:i,measurementId:s}=t.options;if(!r)throw Kn.create("no-app-id");if(!i){if(s)return{measurementId:s,appId:r};throw Kn.create("no-api-key")}const o=e.getThrottleMetadata(r)||{backoffCount:0,throttleEndTimeMillis:Date.now()},a=new nV;return setTimeout(async()=>{a.abort()},n!==void 0?n:UU),aC({appId:r,apiKey:i,measurementId:s},o,a,e)}async function aC(t,{throttleEndTimeMillis:e,backoffCount:n},r,i=oC){var s,o;const{appId:a,measurementId:c}=t;try{await eV(r,e)}catch(l){if(c)return Bt.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${c} provided in the "measurementId" field in the local Firebase config. [${(s=l)===null||s===void 0?void 0:s.message}]`),{appId:a,measurementId:c};throw l}try{const l=await XU(t);return i.deleteThrottleMetadata(a),l}catch(l){const u=l;if(!tV(u)){if(i.deleteThrottleMetadata(a),c)return Bt.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${c} provided in the "measurementId" field in the local Firebase config. [${u==null?void 0:u.message}]`),{appId:a,measurementId:c};throw l}const h=Number((o=u==null?void 0:u.customData)===null||o===void 0?void 0:o.httpStatus)===503?Lh(n,i.intervalMillis,zU):Lh(n,i.intervalMillis),d={throttleEndTimeMillis:Date.now()+h,backoffCount:n+1};return i.setThrottleMetadata(a,d),Bt.debug(`Calling attemptFetch again in ${h} millis`),aC(t,d,r,i)}}function eV(t,e){return new Promise((n,r)=>{const i=Math.max(e-Date.now(),0),s=setTimeout(n,i);t.addEventListener(()=>{clearTimeout(s),r(Kn.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}function tV(t){if(!(t instanceof ct)||!t.customData)return!1;const e=Number(t.customData.httpStatus);return e===429||e===500||e===503||e===504}class nV{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach(e=>e())}}async function rV(t,e,n,r,i){if(i&&i.global){t("event",n,r);return}else{const s=await e,o=Object.assign(Object.assign({},r),{send_to:s});t("event",n,o)}}async function iV(t,e,n,r){if(r&&r.global)return t("set",{screen_name:n}),Promise.resolve();{const i=await e;t("config",i,{update:!0,screen_name:n})}}async function sV(t,e,n,r){if(r&&r.global)return t("set",{user_id:n}),Promise.resolve();{const i=await e;t("config",i,{update:!0,user_id:n})}}async function oV(t,e,n,r){if(r&&r.global){const i={};for(const s of Object.keys(n))i[`user_properties.${s}`]=n[s];return t("set",i),Promise.resolve()}else{const i=await e;t("config",i,{update:!0,user_properties:n})}}async function aV(t,e){const n=await t;window[`ga-disable-${n}`]=!e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function cV(){var t;if(bn())try{await ru()}catch(e){return Bt.warn(Kn.create("indexeddb-unavailable",{errorInfo:(t=e)===null||t===void 0?void 0:t.toString()}).message),!1}else return Bt.warn(Kn.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;return!0}async function lV(t,e,n,r,i,s,o){var a;const c=ZU(t);c.then(f=>{n[f.measurementId]=f.appId,t.options.measurementId&&f.measurementId!==t.options.measurementId&&Bt.warn(`The measurement ID in the local Firebase config (${t.options.measurementId}) does not match the measurement ID fetched from the server (${f.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(f=>Bt.error(f)),e.push(c);const l=cV().then(f=>{if(f)return r.getId()}),[u,h]=await Promise.all([c,l]);HU()||$U(s,u.measurementId),i("js",new Date);const d=(a=o==null?void 0:o.config)!==null&&a!==void 0?a:{};return d[FU]="firebase",d.update=!0,h!=null&&(d[LU]=h),i("config",u.measurementId,d),u.measurementId}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uV{constructor(e){this.app=e}_delete(){return delete Zr[this.app.options.appId],Promise.resolve()}}let Zr={},Wb=[];const Kb={};let mh="dataLayer",cC="gtag",Hb,iu,Gg=!1;function hV(t){if(Gg)throw Kn.create("already-initialized");t.dataLayerName&&(mh=t.dataLayerName),t.gtagName&&(cC=t.gtagName)}function dV(){const t=[];if(tu()&&t.push("This is a browser extension environment."),Qd()||t.push("Cookies are not available."),t.length>0){const e=t.map((r,i)=>`(${i+1}) ${r}`).join(" "),n=Kn.create("invalid-analytics-context",{errorInfo:e});Bt.warn(n.message)}}function fV(t,e,n){dV();const r=t.options.appId;if(!r)throw Kn.create("no-app-id");if(!t.options.apiKey)if(t.options.measurementId)Bt.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${t.options.measurementId} provided in the "measurementId" field in the local Firebase config.`);else throw Kn.create("no-api-key");if(Zr[r]!=null)throw Kn.create("already-exists",{id:r});if(!Gg){BU(mh);const{wrappedGtag:s,gtagCore:o}=KU(Zr,Wb,Kb,mh,cC);iu=s,Hb=o,Gg=!0}return Zr[r]=lV(t,Wb,Kb,e,Hb,mh,n),new uV(t)}async function pV(){if(tu()||!Qd()||!bn())return!1;try{return await ru()}catch{return!1}}function gV(t,e,n){t=M(t),iV(iu,Zr[t.app.options.appId],e,n).catch(r=>Bt.error(r))}function mV(t,e,n){t=M(t),sV(iu,Zr[t.app.options.appId],e,n).catch(r=>Bt.error(r))}function _V(t,e,n){t=M(t),oV(iu,Zr[t.app.options.appId],e,n).catch(r=>Bt.error(r))}function yV(t,e){t=M(t),aV(Zr[t.app.options.appId],e).catch(n=>Bt.error(n))}function lC(t,e,n,r){t=M(t),rV(iu,Zr[t.app.options.appId],e,n,r).catch(i=>Bt.error(i))}const Gb="@firebase/analytics",zb="0.8.0";function vV(){nt(new Ce(qb,(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),i=e.getProvider("installations-internal").getImmediate();return fV(r,i,n)},"PUBLIC")),nt(new Ce("analytics-internal",t,"PRIVATE")),Ve(Gb,zb),Ve(Gb,zb,"esm2017");function t(e){try{const n=e.getProvider(qb).getImmediate();return{logEvent:(r,i,s)=>lC(n,r,i,s)}}catch(n){throw Kn.create("interop-component-reg-failed",{reason:n})}}}vV();const wV="@firebase/analytics-compat",bV="0.1.13";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uC{constructor(e,n){this.app=e,this._delegate=n}logEvent(e,n,r){lC(this._delegate,e,n,r)}setCurrentScreen(e,n){gV(this._delegate,e,n)}setUserId(e,n){mV(this._delegate,e,n)}setUserProperties(e,n){_V(this._delegate,e,n)}setAnalyticsCollectionEnabled(e){yV(this._delegate,e)}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var zg;(function(t){t.ADD_SHIPPING_INFO="add_shipping_info",t.ADD_PAYMENT_INFO="add_payment_info",t.ADD_TO_CART="add_to_cart",t.ADD_TO_WISHLIST="add_to_wishlist",t.BEGIN_CHECKOUT="begin_checkout",t.CHECKOUT_PROGRESS="checkout_progress",t.EXCEPTION="exception",t.GENERATE_LEAD="generate_lead",t.LOGIN="login",t.PAGE_VIEW="page_view",t.PURCHASE="purchase",t.REFUND="refund",t.REMOVE_FROM_CART="remove_from_cart",t.SCREEN_VIEW="screen_view",t.SEARCH="search",t.SELECT_CONTENT="select_content",t.SELECT_ITEM="select_item",t.SELECT_PROMOTION="select_promotion",t.SET_CHECKOUT_OPTION="set_checkout_option",t.SHARE="share",t.SIGN_UP="sign_up",t.TIMING_COMPLETE="timing_complete",t.VIEW_CART="view_cart",t.VIEW_ITEM="view_item",t.VIEW_ITEM_LIST="view_item_list",t.VIEW_PROMOTION="view_promotion",t.VIEW_SEARCH_RESULTS="view_search_results"})(zg||(zg={}));/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IV=t=>{const e=t.getProvider("app-compat").getImmediate(),n=t.getProvider("analytics").getImmediate();return new uC(e,n)};function EV(){const t={Analytics:uC,settings:hV,isSupported:pV,EventName:zg};lt.INTERNAL.registerComponent(new Ce("analytics-compat",IV,"PUBLIC").setServiceProps(t).setMultipleInstances(!0))}EV();lt.registerVersion(wV,bV);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hC=new Map,TV={activated:!1,tokenObservers:[]},SV={initialized:!1,enabled:!1};function Rt(t){return hC.get(t)||TV}function lr(t,e){hC.set(t,e)}function Zd(){return SV}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const V_="https://content-firebaseappcheck.googleapis.com/v1",CV="exchangeRecaptchaV3Token",AV="exchangeRecaptchaEnterpriseToken",kV="exchangeDebugToken",Qb={OFFSET_DURATION:5*60*1e3,RETRIAL_MIN_WAIT:30*1e3,RETRIAL_MAX_WAIT:16*60*1e3},RV=24*60*60*1e3;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NV{constructor(e,n,r,i,s){if(this.operation=e,this.retryPolicy=n,this.getWaitDuration=r,this.lowerBound=i,this.upperBound=s,this.pending=null,this.nextErrorWaitInterval=i,i>s)throw new Error("Proactive refresh lower bound greater than upper bound!")}start(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch(()=>{})}stop(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)}isRunning(){return!!this.pending}async process(e){this.stop();try{this.pending=new pt,await PV(this.getNextRun(e)),this.pending.resolve(),await this.pending.promise,this.pending=new pt,await this.operation(),this.pending.resolve(),await this.pending.promise,this.process(!0).catch(()=>{})}catch(n){this.retryPolicy(n)?this.process(!1).catch(()=>{}):this.stop()}}getNextRun(e){if(e)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();{const n=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),n}}}function PV(t){return new Promise(e=>{setTimeout(e,t)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DV={["already-initialized"]:"You have already called initializeAppCheck() for FirebaseApp {$appName} with different options. To avoid this error, call initializeAppCheck() with the same options as when it was originally called. This will return the already initialized instance.",["use-before-activation"]:"App Check is being used before initializeAppCheck() is called for FirebaseApp {$appName}. Call initializeAppCheck() before instantiating other Firebase services.",["fetch-network-error"]:"Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.",["fetch-parse-error"]:"Fetch client could not parse response. Original error: {$originalErrorMessage}.",["fetch-status-error"]:"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.",["storage-open"]:"Error thrown when opening storage. Original error: {$originalErrorMessage}.",["storage-get"]:"Error thrown when reading from storage. Original error: {$originalErrorMessage}.",["storage-set"]:"Error thrown when writing to storage. Original error: {$originalErrorMessage}.",["recaptcha-error"]:"ReCAPTCHA error.",throttled:"Requests throttled due to {$httpStatus} error. Attempts allowed again after {$time}"},an=new dn("appCheck","AppCheck",DV);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vh(t=!1){var e;return t?(e=self.grecaptcha)===null||e===void 0?void 0:e.enterprise:self.grecaptcha}function dC(t){if(!Rt(t).activated)throw an.create("use-before-activation",{appName:t.name})}function $_(t){const e=Math.round(t/1e3),n=Math.floor(e/(3600*24)),r=Math.floor((e-n*3600*24)/3600),i=Math.floor((e-n*3600*24-r*3600)/60),s=e-n*3600*24-r*3600-i*60;let o="";return n&&(o+=Ku(n)+"d:"),r&&(o+=Ku(r)+"h:"),o+=Ku(i)+"m:"+Ku(s)+"s",o}function Ku(t){return t===0?"00":t>=10?t.toString():"0"+t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function B_({url:t,body:e},n){var r,i;const s={"Content-Type":"application/json"},o=n.getImmediate({optional:!0});if(o){const f=await o.getHeartbeatsHeader();f&&(s["X-Firebase-Client"]=f)}const a={method:"POST",body:JSON.stringify(e),headers:s};let c;try{c=await fetch(t,a)}catch(f){throw an.create("fetch-network-error",{originalErrorMessage:(r=f)===null||r===void 0?void 0:r.message})}if(c.status!==200)throw an.create("fetch-status-error",{httpStatus:c.status});let l;try{l=await c.json()}catch(f){throw an.create("fetch-parse-error",{originalErrorMessage:(i=f)===null||i===void 0?void 0:i.message})}const u=l.ttl.match(/^([\d.]+)(s)$/);if(!u||!u[2]||isNaN(Number(u[1])))throw an.create("fetch-parse-error",{originalErrorMessage:`ttl field (timeToLive) is not in standard Protobuf Duration format: ${l.ttl}`});const h=Number(u[1])*1e3,d=Date.now();return{token:l.token,expireTimeMillis:d+h,issuedAtTimeMillis:d}}function OV(t,e){const{projectId:n,appId:r,apiKey:i}=t.options;return{url:`${V_}/projects/${n}/apps/${r}:${CV}?key=${i}`,body:{recaptcha_v3_token:e}}}function xV(t,e){const{projectId:n,appId:r,apiKey:i}=t.options;return{url:`${V_}/projects/${n}/apps/${r}:${AV}?key=${i}`,body:{recaptcha_enterprise_token:e}}}function MV(t,e){const{projectId:n,appId:r,apiKey:i}=t.options;return{url:`${V_}/projects/${n}/apps/${r}:${kV}?key=${i}`,body:{debug_token:e}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LV="firebase-app-check-database",FV=1,gl="firebase-app-check-store",fC="debug-token";let Hu=null;function pC(){return Hu||(Hu=new Promise((t,e)=>{var n;try{const r=indexedDB.open(LV,FV);r.onsuccess=i=>{t(i.target.result)},r.onerror=i=>{var s;e(an.create("storage-open",{originalErrorMessage:(s=i.target.error)===null||s===void 0?void 0:s.message}))},r.onupgradeneeded=i=>{const s=i.target.result;switch(i.oldVersion){case 0:s.createObjectStore(gl,{keyPath:"compositeKey"})}}}catch(r){e(an.create("storage-open",{originalErrorMessage:(n=r)===null||n===void 0?void 0:n.message}))}}),Hu)}function UV(t){return mC(_C(t))}function VV(t,e){return gC(_C(t),e)}function $V(t){return gC(fC,t)}function BV(){return mC(fC)}async function gC(t,e){const r=(await pC()).transaction(gl,"readwrite"),s=r.objectStore(gl).put({compositeKey:t,value:e});return new Promise((o,a)=>{s.onsuccess=c=>{o()},r.onerror=c=>{var l;a(an.create("storage-set",{originalErrorMessage:(l=c.target.error)===null||l===void 0?void 0:l.message}))}})}async function mC(t){const n=(await pC()).transaction(gl,"readonly"),i=n.objectStore(gl).get(t);return new Promise((s,o)=>{i.onsuccess=a=>{const c=a.target.result;s(c?c.value:void 0)},n.onerror=a=>{var c;o(an.create("storage-get",{originalErrorMessage:(c=a.target.error)===null||c===void 0?void 0:c.message}))}})}function _C(t){return`${t.options.appId}-${t.name}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ml=new $r("@firebase/app-check");/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function jV(t){if(bn()){let e;try{e=await UV(t)}catch(n){ml.warn(`Failed to read token from IndexedDB. Error: ${n}`)}return e}}function Yb(t,e){return bn()?VV(t,e).catch(n=>{ml.warn(`Failed to write token to IndexedDB. Error: ${n}`)}):Promise.resolve()}async function qV(){let t;try{t=await BV()}catch{}if(t)return t;{const e=OL();return $V(e).catch(n=>ml.warn(`Failed to persist debug token to IndexedDB. Error: ${n}`)),e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yC(){return Zd().enabled}async function vC(){const t=Zd();if(t.enabled&&t.token)return t.token.promise;throw Error(`
            Can't get debug token in production mode.
        `)}function WV(){const t=IL(),e=Zd();if(e.initialized=!0,typeof t.FIREBASE_APPCHECK_DEBUG_TOKEN!="string"&&t.FIREBASE_APPCHECK_DEBUG_TOKEN!==!0)return;e.enabled=!0;const n=new pt;e.token=n,typeof t.FIREBASE_APPCHECK_DEBUG_TOKEN=="string"?n.resolve(t.FIREBASE_APPCHECK_DEBUG_TOKEN):n.resolve(qV())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KV={error:"UNKNOWN_ERROR"};function HV(t){return Gd.encodeString(JSON.stringify(t),!1)}async function $h(t,e=!1){const n=t.app;dC(n);const r=Rt(n);let i=r.token,s;if(!i){const c=await r.cachedTokenPromise;c&&Bh(c)&&(i=c)}if(!e&&i&&Bh(i))return{token:i.token};let o=!1;if(yC()){r.exchangeTokenPromise||(r.exchangeTokenPromise=B_(MV(n,await vC()),t.heartbeatServiceProvider).then(l=>(r.exchangeTokenPromise=void 0,l)),o=!0);const c=await r.exchangeTokenPromise;return await Yb(n,c),lr(n,Object.assign(Object.assign({},r),{token:c})),{token:c.token}}try{r.exchangeTokenPromise||(r.exchangeTokenPromise=r.provider.getToken().then(c=>(r.exchangeTokenPromise=void 0,c)),o=!0),i=await r.exchangeTokenPromise}catch(c){c.code==="appCheck/throttled"?ml.warn(c.message):ml.error(c),s=c}let a;return i?(a={token:i.token},lr(n,Object.assign(Object.assign({},r),{token:i})),await Yb(n,i)):a=zV(s),o&&wC(n,a),a}function j_(t,e,n,r){const{app:i}=t,s=Rt(i),o={next:n,error:r,type:e};if(lr(i,Object.assign(Object.assign({},s),{tokenObservers:[...s.tokenObservers,o]})),s.token&&Bh(s.token)){const a=s.token;Promise.resolve().then(()=>{n({token:a.token}),Jb(t)}).catch(()=>{})}s.cachedTokenPromise.then(()=>Jb(t))}function q_(t,e){const n=Rt(t),r=n.tokenObservers.filter(i=>i.next!==e);r.length===0&&n.tokenRefresher&&n.tokenRefresher.isRunning()&&n.tokenRefresher.stop(),lr(t,Object.assign(Object.assign({},n),{tokenObservers:r}))}function Jb(t){const{app:e}=t,n=Rt(e);let r=n.tokenRefresher;r||(r=GV(t),lr(e,Object.assign(Object.assign({},n),{tokenRefresher:r}))),!r.isRunning()&&n.isTokenAutoRefreshEnabled&&r.start()}function GV(t){const{app:e}=t;return new NV(async()=>{const n=Rt(e);let r;if(n.token?r=await $h(t,!0):r=await $h(t),r.error)throw r.error},()=>!0,()=>{const n=Rt(e);if(n.token){let r=n.token.issuedAtTimeMillis+(n.token.expireTimeMillis-n.token.issuedAtTimeMillis)*.5+3e5;const i=n.token.expireTimeMillis-5*60*1e3;return r=Math.min(r,i),Math.max(0,r-Date.now())}else return 0},Qb.RETRIAL_MIN_WAIT,Qb.RETRIAL_MAX_WAIT)}function wC(t,e){const n=Rt(t).tokenObservers;for(const r of n)try{r.type==="EXTERNAL"&&e.error!=null?r.error(e.error):r.next(e)}catch{}}function Bh(t){return t.expireTimeMillis-Date.now()>0}function zV(t){return{token:HV(KV),error:t}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QV{constructor(e,n){this.app=e,this.heartbeatServiceProvider=n}_delete(){const{tokenObservers:e}=Rt(this.app);for(const n of e)q_(this.app,n.next);return Promise.resolve()}}function YV(t,e){return new QV(t,e)}function JV(t){return{getToken:e=>$h(t,e),addTokenListener:e=>j_(t,"INTERNAL",e),removeTokenListener:e=>q_(t.app,e)}}const XV="@firebase/app-check",ZV="0.5.11";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const e$="https://www.google.com/recaptcha/api.js",t$="https://www.google.com/recaptcha/enterprise.js";function n$(t,e){const n=Rt(t),r=new pt;lr(t,Object.assign(Object.assign({},n),{reCAPTCHAState:{initialized:r}}));const i=bC(t),s=Vh(!1);return s?jh(t,e,s,i,r):s$(()=>{const o=Vh(!1);if(!o)throw new Error("no recaptcha");jh(t,e,o,i,r)}),r.promise}function r$(t,e){const n=Rt(t),r=new pt;lr(t,Object.assign(Object.assign({},n),{reCAPTCHAState:{initialized:r}}));const i=bC(t),s=Vh(!0);return s?jh(t,e,s,i,r):o$(()=>{const o=Vh(!0);if(!o)throw new Error("no recaptcha");jh(t,e,o,i,r)}),r.promise}function jh(t,e,n,r,i){n.ready(()=>{i$(t,e,n,r),i.resolve(n)})}function bC(t){const e=`fire_app_check_${t.name}`,n=document.createElement("div");return n.id=e,n.style.display="none",document.body.appendChild(n),e}async function IC(t){dC(t);const n=await Rt(t).reCAPTCHAState.initialized.promise;return new Promise((r,i)=>{const s=Rt(t).reCAPTCHAState;n.ready(()=>{r(n.execute(s.widgetId,{action:"fire_app_check"}))})})}function i$(t,e,n,r){const i=n.render(r,{sitekey:e,size:"invisible"}),s=Rt(t);lr(t,Object.assign(Object.assign({},s),{reCAPTCHAState:Object.assign(Object.assign({},s.reCAPTCHAState),{widgetId:i})}))}function s$(t){const e=document.createElement("script");e.src=e$,e.onload=t,document.head.appendChild(e)}function o$(t){const e=document.createElement("script");e.src=t$,e.onload=t,document.head.appendChild(e)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _l{constructor(e){this._siteKey=e,this._throttleData=null}async getToken(){var e;TC(this._throttleData);const n=await IC(this._app).catch(i=>{throw an.create("recaptcha-error")});let r;try{r=await B_(OV(this._app,n),this._heartbeatServiceProvider)}catch(i){throw i.code==="fetch-status-error"?(this._throttleData=EC(Number((e=i.customData)===null||e===void 0?void 0:e.httpStatus),this._throttleData),an.create("throttled",{time:$_(this._throttleData.allowRequestsAfter-Date.now()),httpStatus:this._throttleData.httpStatus})):i}return this._throttleData=null,r}initialize(e){this._app=e,this._heartbeatServiceProvider=bo(e,"heartbeat"),n$(e,this._siteKey).catch(()=>{})}isEqual(e){return e instanceof _l?this._siteKey===e._siteKey:!1}}class ef{constructor(e){this._siteKey=e,this._throttleData=null}async getToken(){var e;TC(this._throttleData);const n=await IC(this._app).catch(i=>{throw an.create("recaptcha-error")});let r;try{r=await B_(xV(this._app,n),this._heartbeatServiceProvider)}catch(i){throw i.code==="fetch-status-error"?(this._throttleData=EC(Number((e=i.customData)===null||e===void 0?void 0:e.httpStatus),this._throttleData),an.create("throttled",{time:$_(this._throttleData.allowRequestsAfter-Date.now()),httpStatus:this._throttleData.httpStatus})):i}return this._throttleData=null,r}initialize(e){this._app=e,this._heartbeatServiceProvider=bo(e,"heartbeat"),r$(e,this._siteKey).catch(()=>{})}isEqual(e){return e instanceof ef?this._siteKey===e._siteKey:!1}}class yl{constructor(e){this._customProviderOptions=e}async getToken(){const e=await this._customProviderOptions.getToken(),n=CL(e.token),r=n!==null&&n<Date.now()&&n>0?n*1e3:Date.now();return Object.assign(Object.assign({},e),{issuedAtTimeMillis:r})}initialize(e){this._app=e}isEqual(e){return e instanceof yl?this._customProviderOptions.getToken.toString()===e._customProviderOptions.getToken.toString():!1}}function EC(t,e){if(t===404||t===403)return{backoffCount:1,allowRequestsAfter:Date.now()+RV,httpStatus:t};{const n=e?e.backoffCount:0,r=Lh(n,1e3,2);return{backoffCount:n+1,allowRequestsAfter:Date.now()+r,httpStatus:t}}}function TC(t){if(t&&Date.now()-t.allowRequestsAfter<=0)throw an.create("throttled",{time:$_(t.allowRequestsAfter-Date.now()),httpStatus:t.httpStatus})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function a$(t=O0(),e){t=M(t);const n=bo(t,"app-check");if(Zd().initialized||WV(),yC()&&vC().then(i=>console.log(`App Check debug token: ${i}. You will need to add it to your app's App Check settings in the Firebase console for it to work.`)),n.isInitialized()){const i=n.getImmediate(),s=n.getOptions();if(s.isTokenAutoRefreshEnabled===e.isTokenAutoRefreshEnabled&&s.provider.isEqual(e.provider))return i;throw an.create("already-initialized",{appName:t.name})}const r=n.initialize({options:e});return c$(t,e.provider,e.isTokenAutoRefreshEnabled),Rt(t).isTokenAutoRefreshEnabled&&j_(r,"INTERNAL",()=>{}),r}function c$(t,e,n){const r=Rt(t),i=Object.assign(Object.assign({},r),{activated:!0});i.provider=e,i.cachedTokenPromise=jV(t).then(s=>(s&&Bh(s)&&(lr(t,Object.assign(Object.assign({},Rt(t)),{token:s})),wC(t,{token:s.token})),s)),i.isTokenAutoRefreshEnabled=n===void 0?t.automaticDataCollectionEnabled:n,lr(t,i),i.provider.initialize(t)}function l$(t,e){const n=t.app,r=Rt(n);r.tokenRefresher&&(e===!0?r.tokenRefresher.start():r.tokenRefresher.stop()),lr(n,Object.assign(Object.assign({},r),{isTokenAutoRefreshEnabled:e}))}async function u$(t,e){const n=await $h(t,e);if(n.error)throw n.error;return{token:n.token}}function h$(t,e,n,r){let i=()=>{},s=()=>{};return e.next!=null?i=e.next.bind(e):i=e,e.error!=null?s=e.error.bind(e):n&&(s=n),j_(t,"EXTERNAL",i,s),()=>q_(t.app,i)}const d$="app-check",Xb="app-check-internal";function f$(){nt(new Ce(d$,t=>{const e=t.getProvider("app").getImmediate(),n=t.getProvider("heartbeat");return YV(e,n)},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((t,e,n)=>{t.getProvider(Xb).initialize()})),nt(new Ce(Xb,t=>{const e=t.getProvider("app-check").getImmediate();return JV(e)},"PUBLIC").setInstantiationMode("EXPLICIT")),Ve(XV,ZV)}f$();const p$="@firebase/app-check-compat",g$="0.2.11";/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const m$={["use-before-activation"]:"App Check is being used before activate() is called for FirebaseApp {$appName}. Call activate() before instantiating other Firebase services."},Pp=new dn("appCheck","AppCheck",m$);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _${constructor(e){this.app=e}activate(e,n){let r;typeof e=="string"?r=new _l(e):e instanceof ef||e instanceof _l||e instanceof yl?r=e:r=new yl({getToken:e.getToken}),this._delegate=a$(this.app,{provider:r,isTokenAutoRefreshEnabled:n})}setTokenAutoRefreshEnabled(e){if(!this._delegate)throw Pp.create("use-before-activation",{appName:this.app.name});l$(this._delegate,e)}getToken(e){if(!this._delegate)throw Pp.create("use-before-activation",{appName:this.app.name});return u$(this._delegate,e)}onTokenChanged(e,n,r){if(!this._delegate)throw Pp.create("use-before-activation",{appName:this.app.name});return h$(this._delegate,e,n)}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const y$=t=>{const e=t.getProvider("app-compat").getImmediate();return new _$(e)};function v$(){lt.INTERNAL.registerComponent(new Ce("appCheck-compat",y$,"PUBLIC").setServiceProps({ReCaptchaEnterpriseProvider:ef,ReCaptchaV3Provider:_l,CustomProvider:yl}))}v$();lt.registerVersion(p$,g$);function W_(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n}const cc={FACEBOOK:"facebook.com",GITHUB:"github.com",GOOGLE:"google.com",PASSWORD:"password",PHONE:"phone",TWITTER:"twitter.com"},Mo={EMAIL_SIGNIN:"EMAIL_SIGNIN",PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:"REVERT_SECOND_FACTOR_ADDITION",VERIFY_AND_CHANGE_EMAIL:"VERIFY_AND_CHANGE_EMAIL",VERIFY_EMAIL:"VERIFY_EMAIL"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function w$(){return{["admin-restricted-operation"]:"This operation is restricted to administrators only.",["argument-error"]:"",["app-not-authorized"]:"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.",["app-not-installed"]:"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.",["captcha-check-failed"]:"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.",["code-expired"]:"The SMS code has expired. Please re-send the verification code to try again.",["cordova-not-ready"]:"Cordova framework is not ready.",["cors-unsupported"]:"This browser is not supported.",["credential-already-in-use"]:"This credential is already associated with a different user account.",["custom-token-mismatch"]:"The custom token corresponds to a different audience.",["requires-recent-login"]:"This operation is sensitive and requires recent authentication. Log in again before retrying this request.",["dependent-sdk-initialized-before-auth"]:"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK.",["dynamic-link-not-activated"]:"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.",["email-change-needs-verification"]:"Multi-factor users must always have a verified email.",["email-already-in-use"]:"The email address is already in use by another account.",["emulator-config-failed"]:'Auth instance has already been used to make a network call. Auth can no longer be configured to use the emulator. Try calling "connectAuthEmulator()" sooner.',["expired-action-code"]:"The action code has expired.",["cancelled-popup-request"]:"This operation has been cancelled due to another conflicting popup being opened.",["internal-error"]:"An internal AuthError has occurred.",["invalid-app-credential"]:"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.",["invalid-app-id"]:"The mobile app identifier is not registed for the current project.",["invalid-user-token"]:"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.",["invalid-auth-event"]:"An internal AuthError has occurred.",["invalid-verification-code"]:"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure to use the verification code provided by the user.",["invalid-continue-uri"]:"The continue URL provided in the request is invalid.",["invalid-cordova-configuration"]:"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.",["invalid-custom-token"]:"The custom token format is incorrect. Please check the documentation.",["invalid-dynamic-link-domain"]:"The provided dynamic link domain is not configured or authorized for the current project.",["invalid-email"]:"The email address is badly formatted.",["invalid-emulator-scheme"]:"Emulator URL must start with a valid scheme (http:// or https://).",["invalid-api-key"]:"Your API key is invalid, please check you have copied it correctly.",["invalid-cert-hash"]:"The SHA-1 certificate hash provided is invalid.",["invalid-credential"]:"The supplied auth credential is malformed or has expired.",["invalid-message-payload"]:"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.",["invalid-multi-factor-session"]:"The request does not contain a valid proof of first factor successful sign-in.",["invalid-oauth-provider"]:"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.",["invalid-oauth-client-id"]:"The OAuth client ID provided is either invalid or does not match the specified API key.",["unauthorized-domain"]:"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.",["invalid-action-code"]:"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.",["wrong-password"]:"The password is invalid or the user does not have a password.",["invalid-persistence-type"]:"The specified persistence type is invalid. It can only be local, session or none.",["invalid-phone-number"]:"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].",["invalid-provider-id"]:"The specified provider ID is invalid.",["invalid-recipient-email"]:"The email corresponding to this action failed to send as the provided recipient email address is invalid.",["invalid-sender"]:"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.",["invalid-verification-id"]:"The verification ID used to create the phone auth credential is invalid.",["invalid-tenant-id"]:"The Auth instance's tenant ID is invalid.",["login-blocked"]:"Login blocked by user-provided method: {$originalMessage}",["missing-android-pkg-name"]:"An Android Package Name must be provided if the Android App is required to be installed.",["auth-domain-config-required"]:"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.",["missing-app-credential"]:"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.",["missing-verification-code"]:"The phone auth credential was created with an empty SMS verification code.",["missing-continue-uri"]:"A continue URL must be provided in the request.",["missing-iframe-start"]:"An internal AuthError has occurred.",["missing-ios-bundle-id"]:"An iOS Bundle ID must be provided if an App Store ID is provided.",["missing-or-invalid-nonce"]:"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.",["missing-multi-factor-info"]:"No second factor identifier is provided.",["missing-multi-factor-session"]:"The request is missing proof of first factor successful sign-in.",["missing-phone-number"]:"To send verification codes, provide a phone number for the recipient.",["missing-verification-id"]:"The phone auth credential was created with an empty verification ID.",["app-deleted"]:"This instance of FirebaseApp has been deleted.",["multi-factor-info-not-found"]:"The user does not have a second factor matching the identifier provided.",["multi-factor-auth-required"]:"Proof of ownership of a second factor is required to complete sign-in.",["account-exists-with-different-credential"]:"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.",["network-request-failed"]:"A network AuthError (such as timeout, interrupted connection or unreachable host) has occurred.",["no-auth-event"]:"An internal AuthError has occurred.",["no-such-provider"]:"User was not linked to an account with the given provider.",["null-user"]:"A null user object was provided as the argument for an operation which requires a non-null user object.",["operation-not-allowed"]:"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.",["operation-not-supported-in-this-environment"]:'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',["popup-blocked"]:"Unable to establish a connection with the popup. It may have been blocked by the browser.",["popup-closed-by-user"]:"The popup has been closed by the user before finalizing the operation.",["provider-already-linked"]:"User can only be linked to one identity for the given provider.",["quota-exceeded"]:"The project's quota for this operation has been exceeded.",["redirect-cancelled-by-user"]:"The redirect operation has been cancelled by the user before finalizing.",["redirect-operation-pending"]:"A redirect sign-in operation is already pending.",["rejected-credential"]:"The request contains malformed or mismatching credentials.",["second-factor-already-in-use"]:"The second factor is already enrolled on this account.",["maximum-second-factor-count-exceeded"]:"The maximum allowed number of second factors on a user has been exceeded.",["tenant-id-mismatch"]:"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.",["user-token-expired"]:"The user's credential is no longer valid. The user must sign in again.",["too-many-requests"]:"We have blocked all requests from this device due to unusual activity. Try again later.",["unauthorized-continue-uri"]:"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.",["unsupported-first-factor"]:"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.",["unsupported-persistence-type"]:"The current environment does not support the specified persistence type.",["unsupported-tenant-operation"]:"This operation is not supported in a multi-tenant context.",["unverified-email"]:"The operation requires a verified email.",["user-cancelled"]:"The user did not grant your application the permissions it requested.",["user-not-found"]:"There is no user record corresponding to this identifier. The user may have been deleted.",["user-disabled"]:"The user account has been disabled by an administrator.",["user-mismatch"]:"The supplied credentials do not correspond to the previously signed in user.",["user-signed-out"]:"",["weak-password"]:"The password must be 6 characters long or more.",["web-storage-unsupported"]:"This browser is not supported or 3rd party cookies and data may be disabled.",["already-initialized"]:"initializeAuth() has already been called with different options. To avoid this error, call initializeAuth() with the same options as when it was originally called, or call getAuth() to return the already initialized instance."}}function SC(){return{["dependent-sdk-initialized-before-auth"]:"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const b$=w$,I$=SC,CC=new dn("auth","Firebase",SC());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zb=new $r("@firebase/auth");function _h(t,...e){Zb.logLevel<=ge.ERROR&&Zb.error(`Auth (${Br}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ht(t,...e){throw K_(t,...e)}function jt(t,...e){return K_(t,...e)}function AC(t,e,n){const r=Object.assign(Object.assign({},I$()),{[e]:n});return new dn("auth","Firebase",r).create(e,{appName:t.name})}function $a(t,e,n){const r=n;if(!(e instanceof r))throw r.name!==e.constructor.name&&Ht(t,"argument-error"),AC(t,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function K_(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return CC.create(t,...e)}function V(t,e,...n){if(!t)throw K_(e,...n)}function Er(t){const e="INTERNAL ASSERTION FAILED: "+t;throw _h(e),new Error(e)}function ur(t,e){t||Er(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eI=new Map;function kn(t){ur(t instanceof Function,"Expected a class definition");let e=eI.get(t);return e?(ur(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,eI.set(t,e),e)}function E$(t,e){const n=(e==null?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map(kn);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vl(){var t;return typeof self!="undefined"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function H_(){return tI()==="http:"||tI()==="https:"}function tI(){var t;return typeof self!="undefined"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function T$(){return typeof navigator!="undefined"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(H_()||tu()||"connection"in navigator)?navigator.onLine:!0}function S$(){if(typeof navigator=="undefined")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class su{constructor(e,n){this.shortDelay=e,this.longDelay=n,ur(n>e,"Short delay should be less than long delay!"),this.isMobile=zd()||nu()}get(){return T$()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function G_(t,e){ur(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kC{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self!="undefined"&&"fetch"in self)return self.fetch;Er("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self!="undefined"&&"Headers"in self)return self.Headers;Er("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self!="undefined"&&"Response"in self)return self.Response;Er("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const C$={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"internal-error",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const A$=new su(3e4,6e4);function _t(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function Ot(t,e,n,r,i={}){return RC(t,i,async()=>{let s={},o={};r&&(e==="GET"?o=r:s={body:JSON.stringify(r)});const a=wo(Object.assign({key:t.config.apiKey},o)).slice(1),c=await t._getAdditionalHeaders();return c["Content-Type"]="application/json",t.languageCode&&(c["X-Firebase-Locale"]=t.languageCode),kC.fetch()(NC(t,t.config.apiHost,n,a),Object.assign({method:e,headers:c,referrerPolicy:"no-referrer"},s))})}async function RC(t,e,n){t._canInitEmulator=!1;const r=Object.assign(Object.assign({},C$),e);try{const i=new k$(t),s=await Promise.race([n(),i.promise]);i.clearNetworkTimeout();const o=await s.json();if("needConfirmation"in o)throw Cc(t,"account-exists-with-different-credential",o);if(s.ok&&!("errorMessage"in o))return o;{const a=s.ok?o.errorMessage:o.error.message,[c,l]=a.split(" : ");if(c==="FEDERATED_USER_ID_ALREADY_LINKED")throw Cc(t,"credential-already-in-use",o);if(c==="EMAIL_EXISTS")throw Cc(t,"email-already-in-use",o);if(c==="USER_DISABLED")throw Cc(t,"user-disabled",o);const u=r[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(l)throw AC(t,u,l);Ht(t,u)}}catch(i){if(i instanceof ct)throw i;Ht(t,"network-request-failed")}}async function ui(t,e,n,r,i={}){const s=await Ot(t,e,n,r,i);return"mfaPendingCredential"in s&&Ht(t,"multi-factor-auth-required",{_serverResponse:s}),s}function NC(t,e,n,r){const i=`${e}${n}?${r}`;return t.config.emulator?G_(t.config,i):`${t.config.apiScheme}://${i}`}class k${constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(jt(this.auth,"network-request-failed")),A$.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function Cc(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const i=jt(t,e,r);return i.customData._tokenResponse=n,i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function R$(t,e){return Ot(t,"POST","/v1/accounts:delete",e)}async function N$(t,e){return Ot(t,"POST","/v1/accounts:update",e)}async function P$(t,e){return Ot(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fc(t){if(!!t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function D$(t,e=!1){const n=M(t),r=await n.getIdToken(e),i=tf(r);V(i&&i.exp&&i.auth_time&&i.iat,n.auth,"internal-error");const s=typeof i.firebase=="object"?i.firebase:void 0,o=s==null?void 0:s.sign_in_provider;return{claims:i,token:r,authTime:Fc(Dp(i.auth_time)),issuedAtTime:Fc(Dp(i.iat)),expirationTime:Fc(Dp(i.exp)),signInProvider:o||null,signInSecondFactor:(s==null?void 0:s.sign_in_second_factor)||null}}function Dp(t){return Number(t)*1e3}function tf(t){var e;const[n,r,i]=t.split(".");if(n===void 0||r===void 0||i===void 0)return _h("JWT malformed, contained fewer than 3 sections"),null;try{const s=Bg(r);return s?JSON.parse(s):(_h("Failed to decode base64 JWT payload"),null)}catch(s){return _h("Caught error parsing JWT payload as JSON",(e=s)===null||e===void 0?void 0:e.toString()),null}}function O$(t){const e=tf(t);return V(e,"internal-error"),V(typeof e.exp!="undefined","internal-error"),V(typeof e.iat!="undefined","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ii(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof ct&&x$(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function x$({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M${constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){!this.isRunning||(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var n;if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const i=((n=this.user.stsTokenManager.expirationTime)!==null&&n!==void 0?n:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){var e;try{await this.user.getIdToken(!0)}catch(n){((e=n)===null||e===void 0?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PC{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=Fc(this.lastLoginAt),this.creationTime=Fc(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function wl(t){var e;const n=t.auth,r=await t.getIdToken(),i=await ii(t,P$(n,{idToken:r}));V(i==null?void 0:i.users.length,n,"internal-error");const s=i.users[0];t._notifyReloadListener(s);const o=!((e=s.providerUserInfo)===null||e===void 0)&&e.length?U$(s.providerUserInfo):[],a=F$(t.providerData,o),c=t.isAnonymous,l=!(t.email&&s.passwordHash)&&!(a!=null&&a.length),u=c?l:!1,h={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new PC(s.createdAt,s.lastLoginAt),isAnonymous:u};Object.assign(t,h)}async function L$(t){const e=M(t);await wl(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function F$(t,e){return[...t.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function U$(t){return t.map(e=>{var{providerId:n}=e,r=W_(e,["providerId"]);return{providerId:n,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function V$(t,e){const n=await RC(t,{},async()=>{const r=wo({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=t.config,o=NC(t,i,"/v1/token",`key=${s}`),a=await t._getAdditionalHeaders();return a["Content-Type"]="application/x-www-form-urlencoded",kC.fetch()(o,{method:"POST",headers:a,body:r})});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bl{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){V(e.idToken,"internal-error"),V(typeof e.idToken!="undefined","internal-error"),V(typeof e.refreshToken!="undefined","internal-error");const n="expiresIn"in e&&typeof e.expiresIn!="undefined"?Number(e.expiresIn):O$(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}async getToken(e,n=!1){return V(!this.accessToken||this.refreshToken,e,"user-token-expired"),!n&&this.accessToken&&!this.isExpired?this.accessToken:this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:i,expiresIn:s}=await V$(e,n);this.updateTokensAndExpiration(r,i,Number(s))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:i,expirationTime:s}=n,o=new bl;return r&&(V(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),i&&(V(typeof i=="string","internal-error",{appName:e}),o.accessToken=i),s&&(V(typeof s=="number","internal-error",{appName:e}),o.expirationTime=s),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new bl,this.toJSON())}_performRefresh(){return Er("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bi(t,e){V(typeof t=="string"||typeof t=="undefined","internal-error",{appName:e})}class Bs{constructor(e){var{uid:n,auth:r,stsTokenManager:i}=e,s=W_(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new M$(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=n,this.auth=r,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new PC(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const n=await ii(this,this.stsTokenManager.getToken(this.auth,e));return V(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return D$(this,e)}reload(){return L$(this)}_assign(e){this!==e&&(V(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>Object.assign({},n)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){return new Bs(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}))}_onReload(e){V(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await wl(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){const e=await this.getIdToken();return await ii(this,R$(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){var r,i,s,o,a,c,l,u;const h=(r=n.displayName)!==null&&r!==void 0?r:void 0,d=(i=n.email)!==null&&i!==void 0?i:void 0,f=(s=n.phoneNumber)!==null&&s!==void 0?s:void 0,g=(o=n.photoURL)!==null&&o!==void 0?o:void 0,v=(a=n.tenantId)!==null&&a!==void 0?a:void 0,I=(c=n._redirectEventId)!==null&&c!==void 0?c:void 0,S=(l=n.createdAt)!==null&&l!==void 0?l:void 0,k=(u=n.lastLoginAt)!==null&&u!==void 0?u:void 0,{uid:R,emailVerified:E,isAnonymous:p,providerData:w,stsTokenManager:y}=n;V(R&&y,e,"internal-error");const m=bl.fromJSON(this.name,y);V(typeof R=="string",e,"internal-error"),bi(h,e.name),bi(d,e.name),V(typeof E=="boolean",e,"internal-error"),V(typeof p=="boolean",e,"internal-error"),bi(f,e.name),bi(g,e.name),bi(v,e.name),bi(I,e.name),bi(S,e.name),bi(k,e.name);const U=new Bs({uid:R,auth:e,email:d,emailVerified:E,displayName:h,isAnonymous:p,photoURL:g,phoneNumber:f,tenantId:v,stsTokenManager:m,createdAt:S,lastLoginAt:k});return w&&Array.isArray(w)&&(U.providerData=w.map(N=>Object.assign({},N))),I&&(U._redirectEventId=I),U}static async _fromIdTokenResponse(e,n,r=!1){const i=new bl;i.updateFromServerResponse(n);const s=new Bs({uid:n.localId,auth:e,stsTokenManager:i,isAnonymous:r});return await wl(s),s}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DC{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}DC.type="NONE";const ga=DC;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function js(t,e,n){return`firebase:${t}:${e}:${n}`}class Xo{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:i,name:s}=this.auth;this.fullUserKey=js(this.userKey,i.apiKey,s),this.fullPersistenceKey=js("persistence",i.apiKey,s),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?Bs._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new Xo(kn(ga),e,r);const i=(await Promise.all(n.map(async l=>{if(await l._isAvailable())return l}))).filter(l=>l);let s=i[0]||kn(ga);const o=js(r,e.config.apiKey,e.name);let a=null;for(const l of n)try{const u=await l._get(o);if(u){const h=Bs._fromJSON(e,u);l!==s&&(a=h),s=l;break}}catch{}const c=i.filter(l=>l._shouldAllowMigration);return!s._shouldAllowMigration||!c.length?new Xo(s,e,r):(s=c[0],a&&await s._set(o,a.toJSON()),await Promise.all(n.map(async l=>{if(l!==s)try{await l._remove(o)}catch{}})),new Xo(s,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nI(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(MC(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(OC(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(LC(e))return"Blackberry";if(FC(e))return"Webos";if(z_(e))return"Safari";if((e.includes("chrome/")||xC(e))&&!e.includes("edge/"))return"Chrome";if(ou(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function OC(t=ze()){return/firefox\//i.test(t)}function z_(t=ze()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function xC(t=ze()){return/crios\//i.test(t)}function MC(t=ze()){return/iemobile/i.test(t)}function ou(t=ze()){return/android/i.test(t)}function LC(t=ze()){return/blackberry/i.test(t)}function FC(t=ze()){return/webos/i.test(t)}function Ba(t=ze()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function $$(t=ze()){return/(iPad|iPhone|iPod).*OS 7_\d/i.test(t)||/(iPad|iPhone|iPod).*OS 8_\d/i.test(t)}function B$(t=ze()){var e;return Ba(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function j$(){return N_()&&document.documentMode===10}function UC(t=ze()){return Ba(t)||ou(t)||FC(t)||LC(t)||/windows phone/i.test(t)||MC(t)}function q$(){try{return!!(window&&window!==window.top)}catch{return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VC(t,e=[]){let n;switch(t){case"Browser":n=nI(ze());break;case"Worker":n=`${nI(ze())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${Br}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W${constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=s=>new Promise((o,a)=>{try{const c=e(s);o(c)}catch(c){a(c)}});r.onAbort=n,this.queue.push(r);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){var n;if(this.auth.currentUser===e)return;const r=[];try{for(const i of this.queue)await i(e),i.onAbort&&r.push(i.onAbort)}catch(i){r.reverse();for(const s of r)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:(n=i)===null||n===void 0?void 0:n.message})}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K${constructor(e,n,r){this.app=e,this.heartbeatServiceProvider=n,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new rI(this),this.idTokenSubscription=new rI(this),this.beforeStateQueue=new W$(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=CC,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=r.sdkClientVersion}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=kn(n)),this._initializationPromise=this.queue(async()=>{var r,i;if(!this._deleted&&(this.persistenceManager=await Xo.create(this,e),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((i=this.currentUser)===null||i===void 0?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUser(e){var n;const r=await this.assertedPersistence.getCurrentUser();let i=r,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId,a=i==null?void 0:i._redirectEventId,c=await this.tryRedirectSignIn(e);(!o||o===a)&&(c==null?void 0:c.user)&&(i=c.user,s=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(i)}catch(o){i=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return V(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){var n;try{await wl(e)}catch(r){if(((n=r)===null||n===void 0?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=S$()}async _delete(){this._deleted=!0}async updateCurrentUser(e){const n=e?M(e):null;return n&&V(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&V(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0)}setPersistence(e){return this.queue(async()=>{await this.assertedPersistence.setPersistence(kn(e))})}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new dn("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&kn(e)||this._popupRedirectResolver;V(n,this,"argument-error"),this.redirectPersistenceManager=await Xo.create(this,[kn(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,r;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)===null||n===void 0?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const r=(n=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&n!==void 0?n:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,i){if(this._deleted)return()=>{};const s=typeof n=="function"?n:n.next.bind(n),o=this._isInitialized?Promise.resolve():this._initializationPromise;return V(o,this,"internal-error"),o.then(()=>s(this.currentUser)),typeof n=="function"?e.addObserver(n,r,i):e.addObserver(n)}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&(this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh()),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return V(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=VC(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const n={["X-Client-Version"]:this.clientVersion};this.app.options.appId&&(n["X-Firebase-gmpid"]=this.app.options.appId);const r=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());return r&&(n["X-Firebase-Client"]=r),n}}function Nt(t){return M(t)}class rI{constructor(e){this.auth=e,this.observer=null,this.addObserver=S0(n=>this.observer=n)}get next(){return V(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}function H$(t,e,n){const r=Nt(t);V(r._canInitEmulator,r,"emulator-config-failed"),V(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const i=!!(n!=null&&n.disableWarnings),s=$C(e),{host:o,port:a}=G$(e),c=a===null?"":`:${a}`;r.config.emulator={url:`${s}//${o}${c}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:o,port:a,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})}),i||z$()}function $C(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function G$(t){const e=$C(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const s=i[1];return{host:s,port:iI(r.substr(s.length+1))}}else{const[s,o]=r.split(":");return{host:s,port:iI(o)}}}function iI(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function z$(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console!="undefined"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window!="undefined"&&typeof document!="undefined"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ja{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return Er("not implemented")}_getIdTokenResponse(e){return Er("not implemented")}_linkToIdToken(e,n){return Er("not implemented")}_getReauthenticationResolver(e){return Er("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function BC(t,e){return Ot(t,"POST","/v1/accounts:resetPassword",_t(t,e))}async function jC(t,e){return Ot(t,"POST","/v1/accounts:update",e)}async function Q$(t,e){return Ot(t,"POST","/v1/accounts:update",_t(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Y$(t,e){return ui(t,"POST","/v1/accounts:signInWithPassword",_t(t,e))}async function nf(t,e){return Ot(t,"POST","/v1/accounts:sendOobCode",_t(t,e))}async function J$(t,e){return nf(t,e)}async function X$(t,e){return nf(t,e)}async function Z$(t,e){return nf(t,e)}async function eB(t,e){return nf(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function tB(t,e){return ui(t,"POST","/v1/accounts:signInWithEmailLink",_t(t,e))}async function nB(t,e){return ui(t,"POST","/v1/accounts:signInWithEmailLink",_t(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Il extends ja{constructor(e,n,r,i=null){super("password",r),this._email=e,this._password=n,this._tenantId=i}static _fromEmailAndPassword(e,n){return new Il(e,n,"password")}static _fromEmailAndCode(e,n,r=null){return new Il(e,n,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;if((n==null?void 0:n.email)&&(n==null?void 0:n.password)){if(n.signInMethod==="password")return this._fromEmailAndPassword(n.email,n.password);if(n.signInMethod==="emailLink")return this._fromEmailAndCode(n.email,n.password,n.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":return Y$(e,{returnSecureToken:!0,email:this._email,password:this._password});case"emailLink":return tB(e,{email:this._email,oobCode:this._password});default:Ht(e,"internal-error")}}async _linkToIdToken(e,n){switch(this.signInMethod){case"password":return jC(e,{idToken:n,returnSecureToken:!0,email:this._email,password:this._password});case"emailLink":return nB(e,{idToken:n,email:this._email,oobCode:this._password});default:Ht(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ei(t,e){return ui(t,"POST","/v1/accounts:signInWithIdp",_t(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rB="http://localhost";class Or extends ja{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new Or(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):Ht("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i}=n,s=W_(n,["providerId","signInMethod"]);if(!r||!i)return null;const o=new Or(r,i);return o.idToken=s.idToken||void 0,o.accessToken=s.accessToken||void 0,o.secret=s.secret,o.nonce=s.nonce,o.pendingToken=s.pendingToken||null,o}_getIdTokenResponse(e){const n=this.buildRequest();return ei(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,ei(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,ei(e,n)}buildRequest(){const e={requestUri:rB,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=wo(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function iB(t,e){return Ot(t,"POST","/v1/accounts:sendVerificationCode",_t(t,e))}async function sB(t,e){return ui(t,"POST","/v1/accounts:signInWithPhoneNumber",_t(t,e))}async function oB(t,e){const n=await ui(t,"POST","/v1/accounts:signInWithPhoneNumber",_t(t,e));if(n.temporaryProof)throw Cc(t,"account-exists-with-different-credential",n);return n}const aB={USER_NOT_FOUND:"user-not-found"};async function cB(t,e){const n=Object.assign(Object.assign({},e),{operation:"REAUTH"});return ui(t,"POST","/v1/accounts:signInWithPhoneNumber",_t(t,n),aB)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qs extends ja{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,n){return new qs({verificationId:e,verificationCode:n})}static _fromTokenResponse(e,n){return new qs({phoneNumber:e,temporaryProof:n})}_getIdTokenResponse(e){return sB(e,this._makeVerificationRequest())}_linkToIdToken(e,n){return oB(e,Object.assign({idToken:n},this._makeVerificationRequest()))}_getReauthenticationResolver(e){return cB(e,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:e,phoneNumber:n,verificationId:r,verificationCode:i}=this.params;return e&&n?{temporaryProof:e,phoneNumber:n}:{sessionInfo:r,code:i}}toJSON(){const e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){typeof e=="string"&&(e=JSON.parse(e));const{verificationId:n,verificationCode:r,phoneNumber:i,temporaryProof:s}=e;return!r&&!n&&!i&&!s?null:new qs({verificationId:n,verificationCode:r,phoneNumber:i,temporaryProof:s})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lB(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function uB(t){const e=Ho(Sc(t)).link,n=e?Ho(Sc(e)).deep_link_id:null,r=Ho(Sc(t)).deep_link_id;return(r?Ho(Sc(r)).link:null)||r||n||e||t}class rf{constructor(e){var n,r,i,s,o,a;const c=Ho(Sc(e)),l=(n=c.apiKey)!==null&&n!==void 0?n:null,u=(r=c.oobCode)!==null&&r!==void 0?r:null,h=lB((i=c.mode)!==null&&i!==void 0?i:null);V(l&&u&&h,"argument-error"),this.apiKey=l,this.operation=h,this.code=u,this.continueUrl=(s=c.continueUrl)!==null&&s!==void 0?s:null,this.languageCode=(o=c.languageCode)!==null&&o!==void 0?o:null,this.tenantId=(a=c.tenantId)!==null&&a!==void 0?a:null}static parseLink(e){const n=uB(e);try{return new rf(n)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class is{constructor(){this.providerId=is.PROVIDER_ID}static credential(e,n){return Il._fromEmailAndPassword(e,n)}static credentialWithLink(e,n){const r=rf.parseLink(n);return V(r,"argument-error"),Il._fromEmailAndCode(e,r.code,r.tenantId)}}is.PROVIDER_ID="password";is.EMAIL_PASSWORD_SIGN_IN_METHOD="password";is.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hi{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qa extends hi{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class Zo extends qa{static credentialFromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;return V("providerId"in n&&"signInMethod"in n,"argument-error"),Or._fromParams(n)}credential(e){return this._credential(Object.assign(Object.assign({},e),{nonce:e.rawNonce}))}_credential(e){return V(e.idToken||e.accessToken,"argument-error"),Or._fromParams(Object.assign(Object.assign({},e),{providerId:this.providerId,signInMethod:this.providerId}))}static credentialFromResult(e){return Zo.oauthCredentialFromTaggedObject(e)}static credentialFromError(e){return Zo.oauthCredentialFromTaggedObject(e.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r,oauthTokenSecret:i,pendingToken:s,nonce:o,providerId:a}=e;if(!r&&!i&&!n&&!s||!a)return null;try{return new Zo(a)._credential({idToken:n,accessToken:r,nonce:o,pendingToken:s})}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yr extends qa{constructor(){super("facebook.com")}static credential(e){return Or._fromParams({providerId:yr.PROVIDER_ID,signInMethod:yr.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return yr.credentialFromTaggedObject(e)}static credentialFromError(e){return yr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return yr.credential(e.oauthAccessToken)}catch{return null}}}yr.FACEBOOK_SIGN_IN_METHOD="facebook.com";yr.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vr extends qa{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return Or._fromParams({providerId:vr.PROVIDER_ID,signInMethod:vr.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return vr.credentialFromTaggedObject(e)}static credentialFromError(e){return vr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return vr.credential(n,r)}catch{return null}}}vr.GOOGLE_SIGN_IN_METHOD="google.com";vr.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wr extends qa{constructor(){super("github.com")}static credential(e){return Or._fromParams({providerId:wr.PROVIDER_ID,signInMethod:wr.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return wr.credentialFromTaggedObject(e)}static credentialFromError(e){return wr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return wr.credential(e.oauthAccessToken)}catch{return null}}}wr.GITHUB_SIGN_IN_METHOD="github.com";wr.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hB="http://localhost";class ma extends ja{constructor(e,n){super(e,e),this.pendingToken=n}_getIdTokenResponse(e){const n=this.buildRequest();return ei(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,ei(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,ei(e,n)}toJSON(){return{signInMethod:this.signInMethod,providerId:this.providerId,pendingToken:this.pendingToken}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i,pendingToken:s}=n;return!r||!i||!s||r!==i?null:new ma(r,s)}static _create(e,n){return new ma(e,n)}buildRequest(){return{requestUri:hB,returnSecureToken:!0,pendingToken:this.pendingToken}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dB="saml.";class qh extends hi{constructor(e){V(e.startsWith(dB),"argument-error"),super(e)}static credentialFromResult(e){return qh.samlCredentialFromTaggedObject(e)}static credentialFromError(e){return qh.samlCredentialFromTaggedObject(e.customData||{})}static credentialFromJSON(e){const n=ma.fromJSON(e);return V(n,"argument-error"),n}static samlCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{pendingToken:n,providerId:r}=e;if(!n||!r)return null;try{return ma._create(r,n)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class br extends qa{constructor(){super("twitter.com")}static credential(e,n){return Or._fromParams({providerId:br.PROVIDER_ID,signInMethod:br.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return br.credentialFromTaggedObject(e)}static credentialFromError(e){return br.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return br.credential(n,r)}catch{return null}}}br.TWITTER_SIGN_IN_METHOD="twitter.com";br.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function qC(t,e){return ui(t,"POST","/v1/accounts:signUp",_t(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hn{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,i=!1){const s=await Bs._fromIdTokenResponse(e,r,i),o=sI(r);return new Hn({user:s,providerId:o,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const i=sI(r);return new Hn({user:e,providerId:i,_tokenResponse:r,operationType:n})}}function sI(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function fB(t){var e;const n=Nt(t);if(await n._initializationPromise,!((e=n.currentUser)===null||e===void 0)&&e.isAnonymous)return new Hn({user:n.currentUser,providerId:null,operationType:"signIn"});const r=await qC(n,{returnSecureToken:!0}),i=await Hn._fromIdTokenResponse(n,"signIn",r,!0);return await n._updateCurrentUser(i.user),i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wh extends ct{constructor(e,n,r,i){var s;super(n.code,n.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,Wh.prototype),this.customData={appName:e.name,tenantId:(s=e.tenantId)!==null&&s!==void 0?s:void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,i){return new Wh(e,n,r,i)}}function WC(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?Wh._fromErrorAndOperation(t,s,e,r):s})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function KC(t){return new Set(t.map(({providerId:e})=>e).filter(e=>!!e))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function pB(t,e){const n=M(t);await sf(!0,n,e);const{providerUserInfo:r}=await N$(n.auth,{idToken:await n.getIdToken(),deleteProvider:[e]}),i=KC(r||[]);return n.providerData=n.providerData.filter(s=>i.has(s.providerId)),i.has("phone")||(n.phoneNumber=null),await n.auth._persistUserIfCurrent(n),n}async function Q_(t,e,n=!1){const r=await ii(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return Hn._forOperation(t,"link",r)}async function sf(t,e,n){await wl(e);const r=KC(e.providerData),i=t===!1?"provider-already-linked":"no-such-provider";V(r.has(n)===t,e.auth,i)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function HC(t,e,n=!1){var r;const{auth:i}=t,s="reauthenticate";try{const o=await ii(t,WC(i,s,e,t),n);V(o.idToken,i,"internal-error");const a=tf(o.idToken);V(a,i,"internal-error");const{sub:c}=a;return V(t.uid===c,i,"user-mismatch"),Hn._forOperation(t,s,o)}catch(o){throw((r=o)===null||r===void 0?void 0:r.code)==="auth/user-not-found"&&Ht(i,"user-mismatch"),o}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function GC(t,e,n=!1){const r="signIn",i=await WC(t,r,e),s=await Hn._fromIdTokenResponse(t,r,i);return n||await t._updateCurrentUser(s.user),s}async function of(t,e){return GC(Nt(t),e)}async function zC(t,e){const n=M(t);return await sf(!1,n,e.providerId),Q_(n,e)}async function QC(t,e){return HC(M(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function gB(t,e){return ui(t,"POST","/v1/accounts:signInWithCustomToken",_t(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function mB(t,e){const n=Nt(t),r=await gB(n,{token:e,returnSecureToken:!0}),i=await Hn._fromIdTokenResponse(n,"signIn",r);return await n._updateCurrentUser(i.user),i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class af{constructor(e,n){this.factorId=e,this.uid=n.mfaEnrollmentId,this.enrollmentTime=new Date(n.enrolledAt).toUTCString(),this.displayName=n.displayName}static _fromServerResponse(e,n){return"phoneInfo"in n?Y_._fromServerResponse(e,n):Ht(e,"internal-error")}}class Y_ extends af{constructor(e){super("phone",e),this.phoneNumber=e.phoneInfo}static _fromServerResponse(e,n){return new Y_(n)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cf(t,e,n){var r;V(((r=n.url)===null||r===void 0?void 0:r.length)>0,t,"invalid-continue-uri"),V(typeof n.dynamicLinkDomain=="undefined"||n.dynamicLinkDomain.length>0,t,"invalid-dynamic-link-domain"),e.continueUrl=n.url,e.dynamicLinkDomain=n.dynamicLinkDomain,e.canHandleCodeInApp=n.handleCodeInApp,n.iOS&&(V(n.iOS.bundleId.length>0,t,"missing-ios-bundle-id"),e.iOSBundleId=n.iOS.bundleId),n.android&&(V(n.android.packageName.length>0,t,"missing-android-pkg-name"),e.androidInstallApp=n.android.installApp,e.androidMinimumVersionCode=n.android.minimumVersion,e.androidPackageName=n.android.packageName)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _B(t,e,n){const r=M(t),i={requestType:"PASSWORD_RESET",email:e};n&&cf(r,i,n),await X$(r,i)}async function yB(t,e,n){await BC(M(t),{oobCode:e,newPassword:n})}async function vB(t,e){await Q$(M(t),{oobCode:e})}async function YC(t,e){const n=M(t),r=await BC(n,{oobCode:e}),i=r.requestType;switch(V(i,n,"internal-error"),i){case"EMAIL_SIGNIN":break;case"VERIFY_AND_CHANGE_EMAIL":V(r.newEmail,n,"internal-error");break;case"REVERT_SECOND_FACTOR_ADDITION":V(r.mfaInfo,n,"internal-error");default:V(r.email,n,"internal-error")}let s=null;return r.mfaInfo&&(s=af._fromServerResponse(Nt(n),r.mfaInfo)),{data:{email:(r.requestType==="VERIFY_AND_CHANGE_EMAIL"?r.newEmail:r.email)||null,previousEmail:(r.requestType==="VERIFY_AND_CHANGE_EMAIL"?r.email:r.newEmail)||null,multiFactorInfo:s},operation:i}}async function wB(t,e){const{data:n}=await YC(M(t),e);return n.email}async function bB(t,e,n){const r=Nt(t),i=await qC(r,{returnSecureToken:!0,email:e,password:n}),s=await Hn._fromIdTokenResponse(r,"signIn",i);return await r._updateCurrentUser(s.user),s}function IB(t,e,n){return of(M(t),is.credential(e,n))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function EB(t,e,n){const r=M(t),i={requestType:"EMAIL_SIGNIN",email:e};V(n.handleCodeInApp,r,"argument-error"),n&&cf(r,i,n),await Z$(r,i)}function TB(t,e){const n=rf.parseLink(e);return(n==null?void 0:n.operation)==="EMAIL_SIGNIN"}async function SB(t,e,n){const r=M(t),i=is.credentialWithLink(e,n||vl());return V(i._tenantId===(r.tenantId||null),r,"tenant-id-mismatch"),of(r,i)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function CB(t,e){return Ot(t,"POST","/v1/accounts:createAuthUri",_t(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function AB(t,e){const n=H_()?vl():"http://localhost",r={identifier:e,continueUri:n},{signinMethods:i}=await CB(M(t),r);return i||[]}async function kB(t,e){const n=M(t),r=await t.getIdToken(),i={requestType:"VERIFY_EMAIL",idToken:r};e&&cf(n.auth,i,e);const{email:s}=await J$(n.auth,i);s!==t.email&&await t.reload()}async function RB(t,e,n){const r=M(t),i=await t.getIdToken(),s={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:i,newEmail:e};n&&cf(r.auth,s,n);const{email:o}=await eB(r.auth,s);o!==t.email&&await t.reload()}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function NB(t,e){return Ot(t,"POST","/v1/accounts:update",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function PB(t,{displayName:e,photoURL:n}){if(e===void 0&&n===void 0)return;const r=M(t),s={idToken:await r.getIdToken(),displayName:e,photoUrl:n,returnSecureToken:!0},o=await ii(r,NB(r.auth,s));r.displayName=o.displayName||null,r.photoURL=o.photoUrl||null;const a=r.providerData.find(({providerId:c})=>c==="password");a&&(a.displayName=r.displayName,a.photoURL=r.photoURL),await r._updateTokensIfNecessary(o)}function DB(t,e){return JC(M(t),e,null)}function OB(t,e){return JC(M(t),null,e)}async function JC(t,e,n){const{auth:r}=t,s={idToken:await t.getIdToken(),returnSecureToken:!0};e&&(s.email=e),n&&(s.password=n);const o=await ii(t,jC(r,s));await t._updateTokensIfNecessary(o,!0)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xB(t){var e,n;if(!t)return null;const{providerId:r}=t,i=t.rawUserInfo?JSON.parse(t.rawUserInfo):{},s=t.isNewUser||t.kind==="identitytoolkit#SignupNewUserResponse";if(!r&&(t==null?void 0:t.idToken)){const o=(n=(e=tf(t.idToken))===null||e===void 0?void 0:e.firebase)===null||n===void 0?void 0:n.sign_in_provider;if(o){const a=o!=="anonymous"&&o!=="custom"?o:null;return new ea(s,a)}}if(!r)return null;switch(r){case"facebook.com":return new MB(s,i);case"github.com":return new LB(s,i);case"google.com":return new FB(s,i);case"twitter.com":return new UB(s,i,t.screenName||null);case"custom":case"anonymous":return new ea(s,null);default:return new ea(s,r,i)}}class ea{constructor(e,n,r={}){this.isNewUser=e,this.providerId=n,this.profile=r}}class XC extends ea{constructor(e,n,r,i){super(e,n,r),this.username=i}}class MB extends ea{constructor(e,n){super(e,"facebook.com",n)}}class LB extends XC{constructor(e,n){super(e,"github.com",n,typeof(n==null?void 0:n.login)=="string"?n==null?void 0:n.login:null)}}class FB extends ea{constructor(e,n){super(e,"google.com",n)}}class UB extends XC{constructor(e,n,r){super(e,"twitter.com",n,r)}}function VB(t){const{user:e,_tokenResponse:n}=t;return e.isAnonymous&&!n?{providerId:null,isNewUser:!1,profile:null}:xB(n)}class Os{constructor(e,n){this.type=e,this.credential=n}static _fromIdtoken(e){return new Os("enroll",e)}static _fromMfaPendingCredential(e){return new Os("signin",e)}toJSON(){return{multiFactorSession:{[this.type==="enroll"?"idToken":"pendingCredential"]:this.credential}}}static fromJSON(e){var n,r;if(e!=null&&e.multiFactorSession){if(!((n=e.multiFactorSession)===null||n===void 0)&&n.pendingCredential)return Os._fromMfaPendingCredential(e.multiFactorSession.pendingCredential);if(!((r=e.multiFactorSession)===null||r===void 0)&&r.idToken)return Os._fromIdtoken(e.multiFactorSession.idToken)}return null}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J_{constructor(e,n,r){this.session=e,this.hints=n,this.signInResolver=r}static _fromError(e,n){const r=Nt(e),i=n.customData._serverResponse,s=(i.mfaInfo||[]).map(a=>af._fromServerResponse(r,a));V(i.mfaPendingCredential,r,"internal-error");const o=Os._fromMfaPendingCredential(i.mfaPendingCredential);return new J_(o,s,async a=>{const c=await a._process(r,o);delete i.mfaInfo,delete i.mfaPendingCredential;const l=Object.assign(Object.assign({},i),{idToken:c.idToken,refreshToken:c.refreshToken});switch(n.operationType){case"signIn":const u=await Hn._fromIdTokenResponse(r,n.operationType,l);return await r._updateCurrentUser(u.user),u;case"reauthenticate":return V(n.user,r,"internal-error"),Hn._forOperation(n.user,n.operationType,l);default:Ht(r,"internal-error")}})}async resolveSignIn(e){const n=e;return this.signInResolver(n)}}function $B(t,e){var n;const r=M(t),i=e;return V(e.customData.operationType,r,"argument-error"),V((n=i.customData._serverResponse)===null||n===void 0?void 0:n.mfaPendingCredential,r,"argument-error"),J_._fromError(r,i)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function BB(t,e){return Ot(t,"POST","/v2/accounts/mfaEnrollment:start",_t(t,e))}function jB(t,e){return Ot(t,"POST","/v2/accounts/mfaEnrollment:finalize",_t(t,e))}function qB(t,e){return Ot(t,"POST","/v2/accounts/mfaEnrollment:withdraw",_t(t,e))}class X_{constructor(e){this.user=e,this.enrolledFactors=[],e._onReload(n=>{n.mfaInfo&&(this.enrolledFactors=n.mfaInfo.map(r=>af._fromServerResponse(e.auth,r)))})}static _fromUser(e){return new X_(e)}async getSession(){return Os._fromIdtoken(await this.user.getIdToken())}async enroll(e,n){const r=e,i=await this.getSession(),s=await ii(this.user,r._process(this.user.auth,i,n));return await this.user._updateTokensIfNecessary(s),this.user.reload()}async unenroll(e){var n;const r=typeof e=="string"?e:e.uid,i=await this.user.getIdToken(),s=await ii(this.user,qB(this.user.auth,{idToken:i,mfaEnrollmentId:r}));this.enrolledFactors=this.enrolledFactors.filter(({uid:o})=>o!==r),await this.user._updateTokensIfNecessary(s);try{await this.user.reload()}catch(o){if(((n=o)===null||n===void 0?void 0:n.code)!=="auth/user-token-expired")throw o}}}const Op=new WeakMap;function WB(t){const e=M(t);return Op.has(e)||Op.set(e,X_._fromUser(e)),Op.get(e)}const Kh="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZC{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(Kh,"1"),this.storage.removeItem(Kh),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function KB(){const t=ze();return z_(t)||Ba(t)}const HB=1e3,GB=10;class eA extends ZC{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=KB()&&q$(),this.fallbackToPolling=UC(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),i=this.localCache[n];r!==i&&e(n,i,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((o,a,c)=>{this.notifyListeners(o,c)});return}const r=e.key;if(n?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const o=this.storage.getItem(r);if(e.newValue!==o)e.newValue!==null?this.storage.setItem(r,e.newValue):this.storage.removeItem(r);else if(this.localCache[r]===e.newValue&&!n)return}const i=()=>{const o=this.storage.getItem(r);!n&&this.localCache[r]===o||this.notifyListeners(r,o)},s=this.storage.getItem(r);j$()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,GB):i()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},HB)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}eA.type="LOCAL";const Z_=eA;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tA extends ZC{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}tA.type="SESSION";const Ys=tA;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zB(t){return Promise.all(t.map(async e=>{try{const n=await e;return{fulfilled:!0,value:n}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lf{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(i=>i.isListeningto(e));if(n)return n;const r=new lf(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:i,data:s}=n.data,o=this.handlersMap[i];if(!(o!=null&&o.size))return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:i});const a=Array.from(o).map(async l=>l(n.origin,s)),c=await zB(a);n.ports[0].postMessage({status:"done",eventId:r,eventType:i,response:c})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}lf.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function au(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QB{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const i=typeof MessageChannel!="undefined"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,o;return new Promise((a,c)=>{const l=au("",20);i.port1.start();const u=setTimeout(()=>{c(new Error("unsupported_event"))},r);o={messageChannel:i,onMessage(h){const d=h;if(d.data.eventId===l)switch(d.data.status){case"ack":clearTimeout(u),s=setTimeout(()=>{c(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),a(d.data.response);break;default:clearTimeout(u),clearTimeout(s),c(new Error("invalid_response"));break}}},this.handlers.add(o),i.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:l,data:n},[i.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ft(){return window}function YB(t){ft().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ey(){return typeof ft().WorkerGlobalScope!="undefined"&&typeof ft().importScripts=="function"}async function JB(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function XB(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function ZB(){return ey()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nA="firebaseLocalStorageDb",ej=1,Hh="firebaseLocalStorage",rA="fbase_key";class cu{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function uf(t,e){return t.transaction([Hh],e?"readwrite":"readonly").objectStore(Hh)}function tj(){const t=indexedDB.deleteDatabase(nA);return new cu(t).toPromise()}function Qg(){const t=indexedDB.open(nA,ej);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(Hh,{keyPath:rA})}catch(i){n(i)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains(Hh)?e(r):(r.close(),await tj(),e(await Qg()))})})}async function oI(t,e,n){const r=uf(t,!0).put({[rA]:e,value:n});return new cu(r).toPromise()}async function nj(t,e){const n=uf(t,!1).get(e),r=await new cu(n).toPromise();return r===void 0?null:r.value}function aI(t,e){const n=uf(t,!0).delete(e);return new cu(n).toPromise()}const rj=800,ij=3;class iA{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Qg(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>ij)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return ey()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=lf._getInstance(ZB()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var e,n;if(this.activeServiceWorker=await JB(),!this.activeServiceWorker)return;this.sender=new QB(this.activeServiceWorker);const r=await this.sender._send("ping",{},800);!r||((e=r[0])===null||e===void 0?void 0:e.fulfilled)&&((n=r[0])===null||n===void 0?void 0:n.value.includes("keyChanged"))&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||XB()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Qg();return await oI(e,Kh,"1"),await aI(e,Kh),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>oI(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>nj(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>aI(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const s=uf(i,!1).getAll();return new cu(s).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;for(const{fbase_key:i,value:s}of e)r.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(s)&&(this.notifyListeners(i,s),n.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!r.has(i)&&(this.notifyListeners(i,null),n.push(i));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),rj)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}iA.type="LOCAL";const El=iA;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sj(t,e){return Ot(t,"POST","/v2/accounts/mfaSignIn:start",_t(t,e))}function oj(t,e){return Ot(t,"POST","/v2/accounts/mfaSignIn:finalize",_t(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function aj(t){return(await Ot(t,"GET","/v1/recaptchaParams")).recaptchaSiteKey||""}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cj(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}function sA(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=i=>{const s=jt("internal-error");s.customData=i,n(s)},r.type="text/javascript",r.charset="UTF-8",cj().appendChild(r)})}function oA(t){return`__${t}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lj=500,uj=6e4,Gu=1e12;class hj{constructor(e){this.auth=e,this.counter=Gu,this._widgets=new Map}render(e,n){const r=this.counter;return this._widgets.set(r,new dj(e,this.auth.name,n||{})),this.counter++,r}reset(e){var n;const r=e||Gu;(n=this._widgets.get(r))===null||n===void 0||n.delete(),this._widgets.delete(r)}getResponse(e){var n;const r=e||Gu;return((n=this._widgets.get(r))===null||n===void 0?void 0:n.getResponse())||""}async execute(e){var n;const r=e||Gu;return(n=this._widgets.get(r))===null||n===void 0||n.execute(),""}}class dj{constructor(e,n,r){this.params=r,this.timerId=null,this.deleted=!1,this.responseToken=null,this.clickHandler=()=>{this.execute()};const i=typeof e=="string"?document.getElementById(e):e;V(i,"argument-error",{appName:n}),this.container=i,this.isVisible=this.params.size!=="invisible",this.isVisible?this.execute():this.container.addEventListener("click",this.clickHandler)}getResponse(){return this.checkIfDeleted(),this.responseToken}delete(){this.checkIfDeleted(),this.deleted=!0,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.container.removeEventListener("click",this.clickHandler)}execute(){this.checkIfDeleted(),!this.timerId&&(this.timerId=window.setTimeout(()=>{this.responseToken=fj(50);const{callback:e,"expired-callback":n}=this.params;if(e)try{e(this.responseToken)}catch{}this.timerId=window.setTimeout(()=>{if(this.timerId=null,this.responseToken=null,n)try{n()}catch{}this.isVisible&&this.execute()},uj)},lj))}checkIfDeleted(){if(this.deleted)throw new Error("reCAPTCHA mock was already deleted!")}}function fj(t){const e=[],n="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let r=0;r<t;r++)e.push(n.charAt(Math.floor(Math.random()*n.length)));return e.join("")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xp=oA("rcb"),pj=new su(3e4,6e4),gj="https://www.google.com/recaptcha/api.js?";class mj{constructor(){var e;this.hostLanguage="",this.counter=0,this.librarySeparatelyLoaded=!!(!((e=ft().grecaptcha)===null||e===void 0)&&e.render)}load(e,n=""){return V(_j(n),e,"argument-error"),this.shouldResolveImmediately(n)?Promise.resolve(ft().grecaptcha):new Promise((r,i)=>{const s=ft().setTimeout(()=>{i(jt(e,"network-request-failed"))},pj.get());ft()[xp]=()=>{ft().clearTimeout(s),delete ft()[xp];const a=ft().grecaptcha;if(!a){i(jt(e,"internal-error"));return}const c=a.render;a.render=(l,u)=>{const h=c(l,u);return this.counter++,h},this.hostLanguage=n,r(a)};const o=`${gj}?${wo({onload:xp,render:"explicit",hl:n})}`;sA(o).catch(()=>{clearTimeout(s),i(jt(e,"internal-error"))})})}clearedOneInstance(){this.counter--}shouldResolveImmediately(e){var n;return!!(!((n=ft().grecaptcha)===null||n===void 0)&&n.render)&&(e===this.hostLanguage||this.counter>0||this.librarySeparatelyLoaded)}}function _j(t){return t.length<=6&&/^\s*[a-zA-Z0-9\-]*\s*$/.test(t)}class yj{async load(e){return new hj(e)}clearedOneInstance(){}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aA="recaptcha",vj={theme:"light",type:"image"};class wj{constructor(e,n=Object.assign({},vj),r){this.parameters=n,this.type=aA,this.destroyed=!1,this.widgetId=null,this.tokenChangeListeners=new Set,this.renderPromise=null,this.recaptcha=null,this.auth=Nt(r),this.isInvisible=this.parameters.size==="invisible",V(typeof document!="undefined",this.auth,"operation-not-supported-in-this-environment");const i=typeof e=="string"?document.getElementById(e):e;V(i,this.auth,"argument-error"),this.container=i,this.parameters.callback=this.makeTokenCallback(this.parameters.callback),this._recaptchaLoader=this.auth.settings.appVerificationDisabledForTesting?new yj:new mj,this.validateStartingState()}async verify(){this.assertNotDestroyed();const e=await this.render(),n=this.getAssertedRecaptcha(),r=n.getResponse(e);return r||new Promise(i=>{const s=o=>{!o||(this.tokenChangeListeners.delete(s),i(o))};this.tokenChangeListeners.add(s),this.isInvisible&&n.execute(e)})}render(){try{this.assertNotDestroyed()}catch(e){return Promise.reject(e)}return this.renderPromise?this.renderPromise:(this.renderPromise=this.makeRenderPromise().catch(e=>{throw this.renderPromise=null,e}),this.renderPromise)}_reset(){this.assertNotDestroyed(),this.widgetId!==null&&this.getAssertedRecaptcha().reset(this.widgetId)}clear(){this.assertNotDestroyed(),this.destroyed=!0,this._recaptchaLoader.clearedOneInstance(),this.isInvisible||this.container.childNodes.forEach(e=>{this.container.removeChild(e)})}validateStartingState(){V(!this.parameters.sitekey,this.auth,"argument-error"),V(this.isInvisible||!this.container.hasChildNodes(),this.auth,"argument-error"),V(typeof document!="undefined",this.auth,"operation-not-supported-in-this-environment")}makeTokenCallback(e){return n=>{if(this.tokenChangeListeners.forEach(r=>r(n)),typeof e=="function")e(n);else if(typeof e=="string"){const r=ft()[e];typeof r=="function"&&r(n)}}}assertNotDestroyed(){V(!this.destroyed,this.auth,"internal-error")}async makeRenderPromise(){if(await this.init(),!this.widgetId){let e=this.container;if(!this.isInvisible){const n=document.createElement("div");e.appendChild(n),e=n}this.widgetId=this.getAssertedRecaptcha().render(e,this.parameters)}return this.widgetId}async init(){V(H_()&&!ey(),this.auth,"internal-error"),await bj(),this.recaptcha=await this._recaptchaLoader.load(this.auth,this.auth.languageCode||void 0);const e=await aj(this.auth);V(e,this.auth,"internal-error"),this.parameters.sitekey=e}getAssertedRecaptcha(){return V(this.recaptcha,this.auth,"internal-error"),this.recaptcha}}function bj(){let t=null;return new Promise(e=>{if(document.readyState==="complete"){e();return}t=()=>e(),window.addEventListener("load",t)}).catch(e=>{throw t&&window.removeEventListener("load",t),e})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ty{constructor(e,n){this.verificationId=e,this.onConfirmation=n}confirm(e){const n=qs._fromVerification(this.verificationId,e);return this.onConfirmation(n)}}async function Ij(t,e,n){const r=Nt(t),i=await hf(r,e,M(n));return new ty(i,s=>of(r,s))}async function Ej(t,e,n){const r=M(t);await sf(!1,r,"phone");const i=await hf(r.auth,e,M(n));return new ty(i,s=>zC(r,s))}async function Tj(t,e,n){const r=M(t),i=await hf(r.auth,e,M(n));return new ty(i,s=>QC(r,s))}async function hf(t,e,n){var r;const i=await n.verify();try{V(typeof i=="string",t,"argument-error"),V(n.type===aA,t,"argument-error");let s;if(typeof e=="string"?s={phoneNumber:e}:s=e,"session"in s){const o=s.session;if("phoneNumber"in s)return V(o.type==="enroll",t,"internal-error"),(await BB(t,{idToken:o.credential,phoneEnrollmentInfo:{phoneNumber:s.phoneNumber,recaptchaToken:i}})).phoneSessionInfo.sessionInfo;{V(o.type==="signin",t,"internal-error");const a=((r=s.multiFactorHint)===null||r===void 0?void 0:r.uid)||s.multiFactorUid;return V(a,t,"missing-multi-factor-info"),(await sj(t,{mfaPendingCredential:o.credential,mfaEnrollmentId:a,phoneSignInInfo:{recaptchaToken:i}})).phoneResponseInfo.sessionInfo}}else{const{sessionInfo:o}=await iB(t,{phoneNumber:s.phoneNumber,recaptchaToken:i});return o}}finally{n._reset()}}async function Sj(t,e){await Q_(M(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ar{constructor(e){this.providerId=ar.PROVIDER_ID,this.auth=Nt(e)}verifyPhoneNumber(e,n){return hf(this.auth,e,M(n))}static credential(e,n){return qs._fromVerification(e,n)}static credentialFromResult(e){const n=e;return ar.credentialFromTaggedObject(n)}static credentialFromError(e){return ar.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{phoneNumber:n,temporaryProof:r}=e;return n&&r?qs._fromTokenResponse(n,r):null}}ar.PROVIDER_ID="phone";ar.PHONE_SIGN_IN_METHOD="phone";/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Io(t,e){return e?kn(e):(V(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ny extends ja{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return ei(e,this._buildIdpRequest())}_linkToIdToken(e,n){return ei(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return ei(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function Cj(t){return GC(t.auth,new ny(t),t.bypassAuthState)}function Aj(t){const{auth:e,user:n}=t;return V(n,e,"internal-error"),HC(n,new ny(t),t.bypassAuthState)}async function kj(t){const{auth:e,user:n}=t;return V(n,e,"internal-error"),Q_(n,new ny(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cA{constructor(e,n,r,i,s=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:i,tenantId:s,error:o,type:a}=e;if(o){this.reject(o);return}const c={auth:this.auth,requestUri:n,sessionId:r,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(c))}catch(l){this.reject(l)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return Cj;case"linkViaPopup":case"linkViaRedirect":return kj;case"reauthViaPopup":case"reauthViaRedirect":return Aj;default:Ht(this.auth,"internal-error")}}resolve(e){ur(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){ur(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rj=new su(2e3,1e4);async function Nj(t,e,n){const r=Nt(t);$a(t,e,hi);const i=Io(r,n);return new zr(r,"signInViaPopup",e,i).executeNotNull()}async function Pj(t,e,n){const r=M(t);$a(r.auth,e,hi);const i=Io(r.auth,n);return new zr(r.auth,"reauthViaPopup",e,i,r).executeNotNull()}async function Dj(t,e,n){const r=M(t);$a(r.auth,e,hi);const i=Io(r.auth,n);return new zr(r.auth,"linkViaPopup",e,i,r).executeNotNull()}class zr extends cA{constructor(e,n,r,i,s){super(e,n,i,s),this.provider=r,this.authWindow=null,this.pollId=null,zr.currentPopupAction&&zr.currentPopupAction.cancel(),zr.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return V(e,this.auth,"internal-error"),e}async onExecution(){ur(this.filter.length===1,"Popup operations only handle one event");const e=au();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(jt(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(jt(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,zr.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,r;if(!((r=(n=this.authWindow)===null||n===void 0?void 0:n.window)===null||r===void 0)&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(jt(this.auth,"popup-closed-by-user"))},2e3);return}this.pollId=window.setTimeout(e,Rj.get())};e()}}zr.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Oj="pendingRedirect",Uc=new Map;class xj extends cA{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=Uc.get(this.auth._key());if(!e){try{const r=await Mj(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}Uc.set(this.auth._key(),e)}return this.bypassAuthState||Uc.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function Mj(t,e){const n=uA(e),r=lA(t);if(!await r._isAvailable())return!1;const i=await r._get(n)==="true";return await r._remove(n),i}async function ry(t,e){return lA(t)._set(uA(e),"true")}function Lj(){Uc.clear()}function iy(t,e){Uc.set(t._key(),e)}function lA(t){return kn(t._redirectPersistence)}function uA(t){return js(Oj,t.config.apiKey,t.name)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fj(t,e,n){return Uj(t,e,n)}async function Uj(t,e,n){const r=Nt(t);$a(t,e,hi);const i=Io(r,n);return await ry(i,r),i._openRedirect(r,e,"signInViaRedirect")}function Vj(t,e,n){return $j(t,e,n)}async function $j(t,e,n){const r=M(t);$a(r.auth,e,hi);const i=Io(r.auth,n);await ry(i,r.auth);const s=await hA(r);return i._openRedirect(r.auth,e,"reauthViaRedirect",s)}function Bj(t,e,n){return jj(t,e,n)}async function jj(t,e,n){const r=M(t);$a(r.auth,e,hi);const i=Io(r.auth,n);await sf(!1,r,e.providerId),await ry(i,r.auth);const s=await hA(r);return i._openRedirect(r.auth,e,"linkViaRedirect",s)}async function qj(t,e){return await Nt(t)._initializationPromise,df(t,e,!1)}async function df(t,e,n=!1){const r=Nt(t),i=Io(r,e),o=await new xj(r,i,n).execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}async function hA(t){const e=au(`${t.uid}:::`);return t._redirectEventId=e,await t.auth._setRedirectUser(t),await t.auth._persistUserIfCurrent(t),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wj=10*60*1e3;class dA{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!Kj(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var r;if(e.error&&!fA(e)){const i=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";n.onError(jt(this.auth,i))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=Wj&&this.cachedEventUids.clear(),this.cachedEventUids.has(cI(e))}saveEventToCache(e){this.cachedEventUids.add(cI(e)),this.lastProcessedEventTime=Date.now()}}function cI(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function fA({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function Kj(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return fA(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function pA(t,e={}){return Ot(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hj=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Gj=/^https?/;async function zj(t){if(t.config.emulator)return;const{authorizedDomains:e}=await pA(t);for(const n of e)try{if(Qj(n))return}catch{}Ht(t,"unauthorized-domain")}function Qj(t){const e=vl(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&o.hostname===r}if(!Gj.test(n))return!1;if(Hj.test(t))return r===t;const i=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yj=new su(3e4,6e4);function lI(){const t=ft().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function Jj(t){return new Promise((e,n)=>{var r,i,s;function o(){lI(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{lI(),n(jt(t,"network-request-failed"))},timeout:Yj.get()})}if(!((i=(r=ft().gapi)===null||r===void 0?void 0:r.iframes)===null||i===void 0)&&i.Iframe)e(gapi.iframes.getContext());else if(!((s=ft().gapi)===null||s===void 0)&&s.load)o();else{const a=oA("iframefcb");return ft()[a]=()=>{gapi.load?o():n(jt(t,"network-request-failed"))},sA(`https://apis.google.com/js/api.js?onload=${a}`).catch(c=>n(c))}}).catch(e=>{throw yh=null,e})}let yh=null;function Xj(t){return yh=yh||Jj(t),yh}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zj=new su(5e3,15e3),eq="__/auth/iframe",tq="emulator/auth/iframe",nq={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},rq=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function iq(t){const e=t.config;V(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?G_(e,tq):`https://${t.config.authDomain}/${eq}`,r={apiKey:e.apiKey,appName:t.name,v:Br},i=rq.get(t.config.apiHost);i&&(r.eid=i);const s=t._getFrameworks();return s.length&&(r.fw=s.join(",")),`${n}?${wo(r).slice(1)}`}async function sq(t){const e=await Xj(t),n=ft().gapi;return V(n,t,"internal-error"),e.open({where:document.body,url:iq(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:nq,dontclear:!0},r=>new Promise(async(i,s)=>{await r.restyle({setHideOnLeave:!1});const o=jt(t,"network-request-failed"),a=ft().setTimeout(()=>{s(o)},Zj.get());function c(){ft().clearTimeout(a),i(r)}r.ping(c).then(c,()=>{s(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oq={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},aq=500,cq=600,lq="_blank",uq="http://localhost";class uI{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function hq(t,e,n,r=aq,i=cq){const s=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let a="";const c=Object.assign(Object.assign({},oq),{width:r.toString(),height:i.toString(),top:s,left:o}),l=ze().toLowerCase();n&&(a=xC(l)?lq:n),OC(l)&&(e=e||uq,c.scrollbars="yes");const u=Object.entries(c).reduce((d,[f,g])=>`${d}${f}=${g},`,"");if(B$(l)&&a!=="_self")return dq(e||"",a),new uI(null);const h=window.open(e||"",a,u);V(h,t,"popup-blocked");try{h.focus()}catch{}return new uI(h)}function dq(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fq="__/auth/handler",pq="emulator/auth/handler";function Yg(t,e,n,r,i,s){V(t.config.authDomain,t,"auth-domain-config-required"),V(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:Br,eventId:i};if(e instanceof hi){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",xh(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[c,l]of Object.entries(s||{}))o[c]=l}if(e instanceof qa){const c=e.getScopes().filter(l=>l!=="");c.length>0&&(o.scopes=c.join(","))}t.tenantId&&(o.tid=t.tenantId);const a=o;for(const c of Object.keys(a))a[c]===void 0&&delete a[c];return`${gq(t)}?${wo(a).slice(1)}`}function gq({config:t}){return t.emulator?G_(t,pq):`https://${t.authDomain}/${fq}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mp="webStorageSupport";class mq{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Ys,this._completeRedirectFn=df,this._overrideRedirectResult=iy}async _openPopup(e,n,r,i){var s;ur((s=this.eventManagers[e._key()])===null||s===void 0?void 0:s.manager,"_initialize() not called before _openPopup()");const o=Yg(e,n,r,vl(),i);return hq(e,o,au())}async _openRedirect(e,n,r,i){return await this._originValidation(e),YB(Yg(e,n,r,vl(),i)),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:i,promise:s}=this.eventManagers[n];return i?Promise.resolve(i):(ur(s,"If manager is not set, promise should be"),s)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await sq(e),r=new dA(e);return n.register("authEvent",i=>(V(i==null?void 0:i.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(Mp,{type:Mp},i=>{var s;const o=(s=i==null?void 0:i[0])===null||s===void 0?void 0:s[Mp];o!==void 0&&n(!!o),Ht(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=zj(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return UC()||z_()||Ba()}}const _q=mq;class yq{constructor(e){this.factorId=e}_process(e,n,r){switch(n.type){case"enroll":return this._finalizeEnroll(e,n.credential,r);case"signin":return this._finalizeSignIn(e,n.credential);default:return Er("unexpected MultiFactorSessionType")}}}class sy extends yq{constructor(e){super("phone"),this.credential=e}static _fromCredential(e){return new sy(e)}_finalizeEnroll(e,n,r){return jB(e,{idToken:n,displayName:r,phoneVerificationInfo:this.credential._makeVerificationRequest()})}_finalizeSignIn(e,n){return oj(e,{mfaPendingCredential:n,phoneVerificationInfo:this.credential._makeVerificationRequest()})}}class gA{constructor(){}static assertion(e){return sy._fromCredential(e)}}gA.FACTOR_ID="phone";var hI="@firebase/auth",dI="0.20.5";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vq{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{var i;e(((i=r)===null||i===void 0?void 0:i.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);!n||(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){V(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wq(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";default:return}}function bq(t){nt(new Ce("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),{apiKey:s,authDomain:o}=r.options;return((a,c)=>{V(s&&!s.includes(":"),"invalid-api-key",{appName:a.name}),V(!(o!=null&&o.includes(":")),"argument-error",{appName:a.name});const l={apiKey:s,authDomain:o,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:VC(t)},u=new K$(a,c,l);return E$(u,n),u})(r,i)},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),nt(new Ce("auth-internal",e=>{const n=Nt(e.getProvider("auth").getImmediate());return(r=>new vq(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),Ve(hI,dI,wq(t)),Ve(hI,dI,"esm2017")}bq("Browser");/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Js(){return window}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Iq=2e3;async function Eq(t,e,n){var r;const{BuildInfo:i}=Js();ur(e.sessionId,"AuthEvent did not contain a session ID");const s=await kq(e.sessionId),o={};return Ba()?o.ibi=i.packageName:ou()?o.apn=i.packageName:Ht(t,"operation-not-supported-in-this-environment"),i.displayName&&(o.appDisplayName=i.displayName),o.sessionId=s,Yg(t,n,e.type,void 0,(r=e.eventId)!==null&&r!==void 0?r:void 0,o)}async function Tq(t){const{BuildInfo:e}=Js(),n={};Ba()?n.iosBundleId=e.packageName:ou()?n.androidPackageName=e.packageName:Ht(t,"operation-not-supported-in-this-environment"),await pA(t,n)}function Sq(t){const{cordova:e}=Js();return new Promise(n=>{e.plugins.browsertab.isAvailable(r=>{let i=null;r?e.plugins.browsertab.openUrl(t):i=e.InAppBrowser.open(t,$$()?"_blank":"_system","location=yes"),n(i)})})}async function Cq(t,e,n){const{cordova:r}=Js();let i=()=>{};try{await new Promise((s,o)=>{let a=null;function c(){var h;s();const d=(h=r.plugins.browsertab)===null||h===void 0?void 0:h.close;typeof d=="function"&&d(),typeof(n==null?void 0:n.close)=="function"&&n.close()}function l(){a||(a=window.setTimeout(()=>{o(jt(t,"redirect-cancelled-by-user"))},Iq))}function u(){(document==null?void 0:document.visibilityState)==="visible"&&l()}e.addPassiveListener(c),document.addEventListener("resume",l,!1),ou()&&document.addEventListener("visibilitychange",u,!1),i=()=>{e.removePassiveListener(c),document.removeEventListener("resume",l,!1),document.removeEventListener("visibilitychange",u,!1),a&&window.clearTimeout(a)}})}finally{i()}}function Aq(t){var e,n,r,i,s,o,a,c,l,u;const h=Js();V(typeof((e=h==null?void 0:h.universalLinks)===null||e===void 0?void 0:e.subscribe)=="function",t,"invalid-cordova-configuration",{missingPlugin:"cordova-universal-links-plugin-fix"}),V(typeof((n=h==null?void 0:h.BuildInfo)===null||n===void 0?void 0:n.packageName)!="undefined",t,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-buildInfo"}),V(typeof((s=(i=(r=h==null?void 0:h.cordova)===null||r===void 0?void 0:r.plugins)===null||i===void 0?void 0:i.browsertab)===null||s===void 0?void 0:s.openUrl)=="function",t,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),V(typeof((c=(a=(o=h==null?void 0:h.cordova)===null||o===void 0?void 0:o.plugins)===null||a===void 0?void 0:a.browsertab)===null||c===void 0?void 0:c.isAvailable)=="function",t,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),V(typeof((u=(l=h==null?void 0:h.cordova)===null||l===void 0?void 0:l.InAppBrowser)===null||u===void 0?void 0:u.open)=="function",t,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-inappbrowser"})}async function kq(t){const e=Rq(t),n=await crypto.subtle.digest("SHA-256",e);return Array.from(new Uint8Array(n)).map(i=>i.toString(16).padStart(2,"0")).join("")}function Rq(t){if(ur(/[0-9a-zA-Z]+/.test(t),"Can only convert alpha-numeric strings"),typeof TextEncoder!="undefined")return new TextEncoder().encode(t);const e=new ArrayBuffer(t.length),n=new Uint8Array(e);for(let r=0;r<t.length;r++)n[r]=t.charCodeAt(r);return n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nq=20;class Pq extends dA{constructor(){super(...arguments),this.passiveListeners=new Set,this.initPromise=new Promise(e=>{this.resolveInialized=e})}addPassiveListener(e){this.passiveListeners.add(e)}removePassiveListener(e){this.passiveListeners.delete(e)}resetRedirect(){this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1}onEvent(e){return this.resolveInialized(),this.passiveListeners.forEach(n=>n(e)),super.onEvent(e)}async initialized(){await this.initPromise}}function Dq(t,e,n=null){return{type:e,eventId:n,urlResponse:null,sessionId:Mq(),postBody:null,tenantId:t.tenantId,error:jt(t,"no-auth-event")}}function Oq(t,e){return Jg()._set(Xg(t),e)}async function fI(t){const e=await Jg()._get(Xg(t));return e&&await Jg()._remove(Xg(t)),e}function xq(t,e){var n,r;const i=Fq(e);if(i.includes("/__/auth/callback")){const s=vh(i),o=s.firebaseError?Lq(decodeURIComponent(s.firebaseError)):null,a=(r=(n=o==null?void 0:o.code)===null||n===void 0?void 0:n.split("auth/"))===null||r===void 0?void 0:r[1],c=a?jt(a):null;return c?{type:t.type,eventId:t.eventId,tenantId:t.tenantId,error:c,urlResponse:null,sessionId:null,postBody:null}:{type:t.type,eventId:t.eventId,tenantId:t.tenantId,sessionId:t.sessionId,urlResponse:i,postBody:null}}return null}function Mq(){const t=[],e="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let n=0;n<Nq;n++){const r=Math.floor(Math.random()*e.length);t.push(e.charAt(r))}return t.join("")}function Jg(){return kn(Z_)}function Xg(t){return js("authEvent",t.config.apiKey,t.name)}function Lq(t){try{return JSON.parse(t)}catch{return null}}function Fq(t){const e=vh(t),n=e.link?decodeURIComponent(e.link):void 0,r=vh(n).link,i=e.deep_link_id?decodeURIComponent(e.deep_link_id):void 0;return vh(i).link||i||r||n||t}function vh(t){if(!(t!=null&&t.includes("?")))return{};const[e,...n]=t.split("?");return Ho(n.join("?"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Uq=500;class Vq{constructor(){this._redirectPersistence=Ys,this._shouldInitProactively=!0,this.eventManagers=new Map,this.originValidationPromises={},this._completeRedirectFn=df,this._overrideRedirectResult=iy}async _initialize(e){const n=e._key();let r=this.eventManagers.get(n);return r||(r=new Pq(e),this.eventManagers.set(n,r),this.attachCallbackListeners(e,r)),r}_openPopup(e){Ht(e,"operation-not-supported-in-this-environment")}async _openRedirect(e,n,r,i){Aq(e);const s=await this._initialize(e);await s.initialized(),s.resetRedirect(),Lj(),await this._originValidation(e);const o=Dq(e,r,i);await Oq(e,o);const a=await Eq(e,o,n),c=await Sq(a);return Cq(e,s,c)}_isIframeWebStorageSupported(e,n){throw new Error("Method not implemented.")}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=Tq(e)),this.originValidationPromises[n]}attachCallbackListeners(e,n){const{universalLinks:r,handleOpenURL:i,BuildInfo:s}=Js(),o=setTimeout(async()=>{await fI(e),n.onEvent(pI())},Uq),a=async u=>{clearTimeout(o);const h=await fI(e);let d=null;h&&(u==null?void 0:u.url)&&(d=xq(h,u.url)),n.onEvent(d||pI())};typeof r!="undefined"&&typeof r.subscribe=="function"&&r.subscribe(null,a);const c=i,l=`${s.packageName.toLowerCase()}://`;Js().handleOpenURL=async u=>{if(u.toLowerCase().startsWith(l)&&a({url:u}),typeof c=="function")try{c(u)}catch(h){console.error(h)}}}}const $q=Vq;function pI(){return{type:"unknown",eventId:null,sessionId:null,urlResponse:null,postBody:null,tenantId:null,error:jt("no-auth-event")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bq(t,e){Nt(t)._logFramework(e)}var jq="@firebase/auth-compat",qq="0.2.18";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wq=1e3;function Vc(){var t;return((t=self==null?void 0:self.location)===null||t===void 0?void 0:t.protocol)||null}function Kq(){return Vc()==="http:"||Vc()==="https:"}function mA(t=ze()){return!!((Vc()==="file:"||Vc()==="ionic:"||Vc()==="capacitor:")&&t.toLowerCase().match(/iphone|ipad|ipod|android/))}function Hq(){return nu()||R_()}function Gq(){return N_()&&(document==null?void 0:document.documentMode)===11}function zq(t=ze()){return/Edge\/\d+/.test(t)}function Qq(t=ze()){return Gq()||zq(t)}function _A(){try{const t=self.localStorage,e=au();if(t)return t.setItem(e,"1"),t.removeItem(e),Qq()?bn():!0}catch{return oy()&&bn()}return!1}function oy(){return typeof global!="undefined"&&"WorkerGlobalScope"in global&&"importScripts"in global}function Lp(){return(Kq()||tu()||mA())&&!Hq()&&_A()&&!oy()}function yA(){return mA()&&typeof document!="undefined"}async function Yq(){return yA()?new Promise(t=>{const e=setTimeout(()=>{t(!1)},Wq);document.addEventListener("deviceready",()=>{clearTimeout(e),t(!0)})}):!1}function Jq(){return typeof window!="undefined"?window:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sn={LOCAL:"local",NONE:"none",SESSION:"session"},lc=V,vA="persistence";function Xq(t,e){if(lc(Object.values(Sn).includes(e),t,"invalid-persistence-type"),nu()){lc(e!==Sn.SESSION,t,"unsupported-persistence-type");return}if(R_()){lc(e===Sn.NONE,t,"unsupported-persistence-type");return}if(oy()){lc(e===Sn.NONE||e===Sn.LOCAL&&bn(),t,"unsupported-persistence-type");return}lc(e===Sn.NONE||_A(),t,"unsupported-persistence-type")}async function Zg(t){await t._initializationPromise;const e=wA(),n=js(vA,t.config.apiKey,t.name);e&&e.setItem(n,t._getPersistence())}function Zq(t,e){const n=wA();if(!n)return[];const r=js(vA,t,e);switch(n.getItem(r)){case Sn.NONE:return[ga];case Sn.LOCAL:return[El,Ys];case Sn.SESSION:return[Ys];default:return[]}}function wA(){var t;try{return((t=Jq())===null||t===void 0?void 0:t.sessionStorage)||null}catch{return null}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eW=V;class Ni{constructor(){this.browserResolver=kn(_q),this.cordovaResolver=kn($q),this.underlyingResolver=null,this._redirectPersistence=Ys,this._completeRedirectFn=df,this._overrideRedirectResult=iy}async _initialize(e){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._initialize(e)}async _openPopup(e,n,r,i){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._openPopup(e,n,r,i)}async _openRedirect(e,n,r,i){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._openRedirect(e,n,r,i)}_isIframeWebStorageSupported(e,n){this.assertedUnderlyingResolver._isIframeWebStorageSupported(e,n)}_originValidation(e){return this.assertedUnderlyingResolver._originValidation(e)}get _shouldInitProactively(){return yA()||this.browserResolver._shouldInitProactively}get assertedUnderlyingResolver(){return eW(this.underlyingResolver,"internal-error"),this.underlyingResolver}async selectUnderlyingResolver(){if(this.underlyingResolver)return;const e=await Yq();this.underlyingResolver=e?this.cordovaResolver:this.browserResolver}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bA(t){return t.unwrap()}function tW(t){return t.wrapped()}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nW(t){return IA(t)}function rW(t,e){var n,r;const i=(n=e.customData)===null||n===void 0?void 0:n._tokenResponse;if(((r=e)===null||r===void 0?void 0:r.code)==="auth/multi-factor-auth-required"){const s=e;s.resolver=new iW(t,$B(t,e))}else if(i){const s=IA(e),o=e;s&&(o.credential=s,o.tenantId=i.tenantId||void 0,o.email=i.email||void 0,o.phoneNumber=i.phoneNumber||void 0)}}function IA(t){const{_tokenResponse:e}=t instanceof ct?t.customData:t;if(!e)return null;if(!(t instanceof ct)&&"temporaryProof"in e&&"phoneNumber"in e)return ar.credentialFromResult(t);const n=e.providerId;if(!n||n===cc.PASSWORD)return null;let r;switch(n){case cc.GOOGLE:r=vr;break;case cc.FACEBOOK:r=yr;break;case cc.GITHUB:r=wr;break;case cc.TWITTER:r=br;break;default:const{oauthIdToken:i,oauthAccessToken:s,oauthTokenSecret:o,pendingToken:a,nonce:c}=e;return!s&&!o&&!i&&!a?null:a?n.startsWith("saml.")?ma._create(n,a):Or._fromParams({providerId:n,signInMethod:n,pendingToken:a,idToken:i,accessToken:s}):new Zo(n).credential({idToken:i,accessToken:s,rawNonce:c})}return t instanceof ct?r.credentialFromError(t):r.credentialFromResult(t)}function pn(t,e){return e.catch(n=>{throw n instanceof ct&&rW(t,n),n}).then(n=>{const r=n.operationType,i=n.user;return{operationType:r,credential:nW(n),additionalUserInfo:VB(n),user:Qr.getOrCreate(i)}})}async function em(t,e){const n=await e;return{verificationId:n.verificationId,confirm:r=>pn(t,n.confirm(r))}}class iW{constructor(e,n){this.resolver=n,this.auth=tW(e)}get session(){return this.resolver.session}get hints(){return this.resolver.hints}resolveSignIn(e){return pn(bA(this.auth),this.resolver.resolveSignIn(e))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qr{constructor(e){this._delegate=e,this.multiFactor=WB(e)}static getOrCreate(e){return Qr.USER_MAP.has(e)||Qr.USER_MAP.set(e,new Qr(e)),Qr.USER_MAP.get(e)}delete(){return this._delegate.delete()}reload(){return this._delegate.reload()}toJSON(){return this._delegate.toJSON()}getIdTokenResult(e){return this._delegate.getIdTokenResult(e)}getIdToken(e){return this._delegate.getIdToken(e)}linkAndRetrieveDataWithCredential(e){return this.linkWithCredential(e)}async linkWithCredential(e){return pn(this.auth,zC(this._delegate,e))}async linkWithPhoneNumber(e,n){return em(this.auth,Ej(this._delegate,e,n))}async linkWithPopup(e){return pn(this.auth,Dj(this._delegate,e,Ni))}async linkWithRedirect(e){return await Zg(Nt(this.auth)),Bj(this._delegate,e,Ni)}reauthenticateAndRetrieveDataWithCredential(e){return this.reauthenticateWithCredential(e)}async reauthenticateWithCredential(e){return pn(this.auth,QC(this._delegate,e))}reauthenticateWithPhoneNumber(e,n){return em(this.auth,Tj(this._delegate,e,n))}reauthenticateWithPopup(e){return pn(this.auth,Pj(this._delegate,e,Ni))}async reauthenticateWithRedirect(e){return await Zg(Nt(this.auth)),Vj(this._delegate,e,Ni)}sendEmailVerification(e){return kB(this._delegate,e)}async unlink(e){return await pB(this._delegate,e),this}updateEmail(e){return DB(this._delegate,e)}updatePassword(e){return OB(this._delegate,e)}updatePhoneNumber(e){return Sj(this._delegate,e)}updateProfile(e){return PB(this._delegate,e)}verifyBeforeUpdateEmail(e,n){return RB(this._delegate,e,n)}get emailVerified(){return this._delegate.emailVerified}get isAnonymous(){return this._delegate.isAnonymous}get metadata(){return this._delegate.metadata}get phoneNumber(){return this._delegate.phoneNumber}get providerData(){return this._delegate.providerData}get refreshToken(){return this._delegate.refreshToken}get tenantId(){return this._delegate.tenantId}get displayName(){return this._delegate.displayName}get email(){return this._delegate.email}get photoURL(){return this._delegate.photoURL}get providerId(){return this._delegate.providerId}get uid(){return this._delegate.uid}get auth(){return this._delegate.auth}}Qr.USER_MAP=new WeakMap;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uc=V;class tm{constructor(e,n){if(this.app=e,n.isInitialized()){this._delegate=n.getImmediate(),this.linkUnderlyingAuth();return}const{apiKey:r}=e.options;uc(r,"invalid-api-key",{appName:e.name}),uc(r,"invalid-api-key",{appName:e.name});const i=typeof window!="undefined"?Ni:void 0;this._delegate=n.initialize({options:{persistence:sW(r,e.name),popupRedirectResolver:i}}),this._delegate._updateErrorMap(b$),this.linkUnderlyingAuth()}get emulatorConfig(){return this._delegate.emulatorConfig}get currentUser(){return this._delegate.currentUser?Qr.getOrCreate(this._delegate.currentUser):null}get languageCode(){return this._delegate.languageCode}set languageCode(e){this._delegate.languageCode=e}get settings(){return this._delegate.settings}get tenantId(){return this._delegate.tenantId}set tenantId(e){this._delegate.tenantId=e}useDeviceLanguage(){this._delegate.useDeviceLanguage()}signOut(){return this._delegate.signOut()}useEmulator(e,n){H$(this._delegate,e,n)}applyActionCode(e){return vB(this._delegate,e)}checkActionCode(e){return YC(this._delegate,e)}confirmPasswordReset(e,n){return yB(this._delegate,e,n)}async createUserWithEmailAndPassword(e,n){return pn(this._delegate,bB(this._delegate,e,n))}fetchProvidersForEmail(e){return this.fetchSignInMethodsForEmail(e)}fetchSignInMethodsForEmail(e){return AB(this._delegate,e)}isSignInWithEmailLink(e){return TB(this._delegate,e)}async getRedirectResult(){uc(Lp(),this._delegate,"operation-not-supported-in-this-environment");const e=await qj(this._delegate,Ni);return e?pn(this._delegate,Promise.resolve(e)):{credential:null,user:null}}addFrameworkForLogging(e){Bq(this._delegate,e)}onAuthStateChanged(e,n,r){const{next:i,error:s,complete:o}=gI(e,n,r);return this._delegate.onAuthStateChanged(i,s,o)}onIdTokenChanged(e,n,r){const{next:i,error:s,complete:o}=gI(e,n,r);return this._delegate.onIdTokenChanged(i,s,o)}sendSignInLinkToEmail(e,n){return EB(this._delegate,e,n)}sendPasswordResetEmail(e,n){return _B(this._delegate,e,n||void 0)}async setPersistence(e){Xq(this._delegate,e);let n;switch(e){case Sn.SESSION:n=Ys;break;case Sn.LOCAL:n=await kn(El)._isAvailable()?El:Z_;break;case Sn.NONE:n=ga;break;default:return Ht("argument-error",{appName:this._delegate.name})}return this._delegate.setPersistence(n)}signInAndRetrieveDataWithCredential(e){return this.signInWithCredential(e)}signInAnonymously(){return pn(this._delegate,fB(this._delegate))}signInWithCredential(e){return pn(this._delegate,of(this._delegate,e))}signInWithCustomToken(e){return pn(this._delegate,mB(this._delegate,e))}signInWithEmailAndPassword(e,n){return pn(this._delegate,IB(this._delegate,e,n))}signInWithEmailLink(e,n){return pn(this._delegate,SB(this._delegate,e,n))}signInWithPhoneNumber(e,n){return em(this._delegate,Ij(this._delegate,e,n))}async signInWithPopup(e){return uc(Lp(),this._delegate,"operation-not-supported-in-this-environment"),pn(this._delegate,Nj(this._delegate,e,Ni))}async signInWithRedirect(e){return uc(Lp(),this._delegate,"operation-not-supported-in-this-environment"),await Zg(this._delegate),Fj(this._delegate,e,Ni)}updateCurrentUser(e){return this._delegate.updateCurrentUser(e)}verifyPasswordResetCode(e){return wB(this._delegate,e)}unwrap(){return this._delegate}_delete(){return this._delegate._delete()}linkUnderlyingAuth(){this._delegate.wrapped=()=>this}}tm.Persistence=Sn;function gI(t,e,n){let r=t;typeof t!="function"&&({next:r,error:e,complete:n}=t);const i=r;return{next:o=>i(o&&Qr.getOrCreate(o)),error:e,complete:n}}function sW(t,e){const n=Zq(t,e);if(typeof self!="undefined"&&!n.includes(El)&&n.push(El),typeof window!="undefined")for(const r of[Z_,Ys])n.includes(r)||n.push(r);return n.includes(ga)||n.push(ga),n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ay{constructor(){this.providerId="phone",this._delegate=new ar(bA(lt.auth()))}static credential(e,n){return ar.credential(e,n)}verifyPhoneNumber(e,n){return this._delegate.verifyPhoneNumber(e,n)}unwrap(){return this._delegate}}ay.PHONE_SIGN_IN_METHOD=ar.PHONE_SIGN_IN_METHOD;ay.PROVIDER_ID=ar.PROVIDER_ID;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oW=V;class aW{constructor(e,n,r=lt.app()){var i;oW((i=r.options)===null||i===void 0?void 0:i.apiKey,"invalid-api-key",{appName:r.name}),this._delegate=new wj(e,n,r.auth()),this.type=this._delegate.type}clear(){this._delegate.clear()}render(){return this._delegate.render()}verify(){return this._delegate.verify()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cW="auth-compat";function lW(t){t.INTERNAL.registerComponent(new Ce(cW,e=>{const n=e.getProvider("app-compat").getImmediate(),r=e.getProvider("auth");return new tm(n,r)},"PUBLIC").setServiceProps({ActionCodeInfo:{Operation:{EMAIL_SIGNIN:Mo.EMAIL_SIGNIN,PASSWORD_RESET:Mo.PASSWORD_RESET,RECOVER_EMAIL:Mo.RECOVER_EMAIL,REVERT_SECOND_FACTOR_ADDITION:Mo.REVERT_SECOND_FACTOR_ADDITION,VERIFY_AND_CHANGE_EMAIL:Mo.VERIFY_AND_CHANGE_EMAIL,VERIFY_EMAIL:Mo.VERIFY_EMAIL}},EmailAuthProvider:is,FacebookAuthProvider:yr,GithubAuthProvider:wr,GoogleAuthProvider:vr,OAuthProvider:Zo,SAMLAuthProvider:qh,PhoneAuthProvider:ay,PhoneMultiFactorGenerator:gA,RecaptchaVerifier:aW,TwitterAuthProvider:br,Auth:tm,AuthCredential:ja,Error:ct}).setInstantiationMode("LAZY").setMultipleInstances(!1)),t.registerVersion(jq,qq)}lW(lt);const mI="@firebase/database",_I="0.13.3";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let EA="";function TA(t){EA=t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uW{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,n){n==null?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),gt(n))}get(e){const n=this.domStorage_.getItem(this.prefixedName_(e));return n==null?null:dl(n)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hW{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,n){n==null?delete this.cache_[e]:this.cache_[e]=n}get(e){return Dn(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SA=function(t){try{if(typeof window!="undefined"&&typeof window[t]!="undefined"){const e=window[t];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new uW(e)}}catch{}return new hW},xs=SA("localStorage"),nm=SA("sessionStorage");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ta=new $r("@firebase/database"),CA=function(){let t=1;return function(){return t++}}(),AA=function(t){const e=DL(t),n=new RL;n.update(e);const r=n.digest();return Gd.encodeByteArray(r)},lu=function(...t){let e="";for(let n=0;n<t.length;n++){const r=t[n];Array.isArray(r)||r&&typeof r=="object"&&typeof r.length=="number"?e+=lu.apply(null,r):typeof r=="object"?e+=gt(r):e+=r,e+=" "}return e};let Ws=null,yI=!0;const kA=function(t,e){$(!e||t===!0||t===!1,"Can't turn on custom loggers persistently."),t===!0?(ta.logLevel=ge.VERBOSE,Ws=ta.log.bind(ta),e&&nm.set("logging_enabled",!0)):typeof t=="function"?Ws=t:(Ws=null,nm.remove("logging_enabled"))},Et=function(...t){if(yI===!0&&(yI=!1,Ws===null&&nm.get("logging_enabled")===!0&&kA(!0)),Ws){const e=lu.apply(null,t);Ws(e)}},uu=function(t){return function(...e){Et(t,...e)}},rm=function(...t){const e="FIREBASE INTERNAL ERROR: "+lu(...t);ta.error(e)},xr=function(...t){const e=`FIREBASE FATAL ERROR: ${lu(...t)}`;throw ta.error(e),new Error(e)},Yt=function(...t){const e="FIREBASE WARNING: "+lu(...t);ta.warn(e)},dW=function(){typeof window!="undefined"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&Yt("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},ff=function(t){return typeof t=="number"&&(t!==t||t===Number.POSITIVE_INFINITY||t===Number.NEGATIVE_INFINITY)},fW=function(t){if(document.readyState==="complete")t();else{let e=!1;const n=function(){if(!document.body){setTimeout(n,Math.floor(10));return}e||(e=!0,t())};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&n()}),window.attachEvent("onload",n))}},si="[MIN_NAME]",Mr="[MAX_NAME]",Eo=function(t,e){if(t===e)return 0;if(t===si||e===Mr)return-1;if(e===si||t===Mr)return 1;{const n=Gh(t),r=Gh(e);return n!==null?r!==null?n-r===0?t.length-e.length:n-r:-1:r!==null?1:t<e?-1:1}},pW=function(t,e){return t===e?0:t<e?-1:1},hc=function(t,e){if(e&&t in e)return e[t];throw new Error("Missing required key ("+t+") in object: "+gt(e))},cy=function(t){if(typeof t!="object"||t===null)return gt(t);const e=[];for(const r in t)e.push(r);e.sort();let n="{";for(let r=0;r<e.length;r++)r!==0&&(n+=","),n+=gt(e[r]),n+=":",n+=cy(t[e[r]]);return n+="}",n},RA=function(t,e){const n=t.length;if(n<=e)return[t];const r=[];for(let i=0;i<n;i+=e)i+e>n?r.push(t.substring(i,n)):r.push(t.substring(i,i+e));return r};function Pt(t,e){for(const n in t)t.hasOwnProperty(n)&&e(n,t[n])}const NA=function(t){$(!ff(t),"Invalid JSON number");const e=11,n=52,r=(1<<e-1)-1;let i,s,o,a,c;t===0?(s=0,o=0,i=1/t===-1/0?1:0):(i=t<0,t=Math.abs(t),t>=Math.pow(2,1-r)?(a=Math.min(Math.floor(Math.log(t)/Math.LN2),r),s=a+r,o=Math.round(t*Math.pow(2,n-a)-Math.pow(2,n))):(s=0,o=Math.round(t/Math.pow(2,1-r-n))));const l=[];for(c=n;c;c-=1)l.push(o%2?1:0),o=Math.floor(o/2);for(c=e;c;c-=1)l.push(s%2?1:0),s=Math.floor(s/2);l.push(i?1:0),l.reverse();const u=l.join("");let h="";for(c=0;c<64;c+=8){let d=parseInt(u.substr(c,8),2).toString(16);d.length===1&&(d="0"+d),h=h+d}return h.toLowerCase()},gW=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},mW=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};function _W(t,e){let n="Unknown Error";t==="too_big"?n="The data requested exceeds the maximum size that can be accessed with a single request.":t==="permission_denied"?n="Client doesn't have permission to access the desired data.":t==="unavailable"&&(n="The service is unavailable");const r=new Error(t+" at "+e._path.toString()+": "+n);return r.code=t.toUpperCase(),r}const yW=new RegExp("^-?(0*)\\d{1,10}$"),PA=-2147483648,ly=2147483647,Gh=function(t){if(yW.test(t)){const e=Number(t);if(e>=PA&&e<=ly)return e}return null},Wa=function(t){try{t()}catch(e){setTimeout(()=>{const n=e.stack||"";throw Yt("Exception was thrown by user callback.",n),e},Math.floor(0))}},vW=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},$c=function(t,e){const n=setTimeout(t,e);return typeof n=="object"&&n.unref&&n.unref(),n};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wW{constructor(e,n){this.appName_=e,this.appCheckProvider=n,this.appCheck=n==null?void 0:n.getImmediate({optional:!0}),this.appCheck||n==null||n.get().then(r=>this.appCheck=r)}getToken(e){return this.appCheck?this.appCheck.getToken(e):new Promise((n,r)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(n,r):n(null)},0)})}addTokenChangeListener(e){var n;(n=this.appCheckProvider)===null||n===void 0||n.get().then(r=>r.addTokenListener(e))}notifyForInvalidToken(){Yt(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bW{constructor(e,n,r){this.appName_=e,this.firebaseOptions_=n,this.authProvider_=r,this.auth_=null,this.auth_=r.getImmediate({optional:!0}),this.auth_||r.onInit(i=>this.auth_=i)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(n=>n&&n.code==="auth/token-not-initialized"?(Et("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(n)):new Promise((n,r)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(n,r):n(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(n=>n.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(n=>n.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',Yt(e)}}class na{constructor(e){this.accessToken=e}getToken(e){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(e){e(this.accessToken)}removeTokenChangeListener(e){}notifyForInvalidToken(){}}na.OWNER="owner";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uy="5",DA="v",OA="s",xA="r",MA="f",LA=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,FA="ls",UA="p",im="ac",VA="websocket",$A="long_polling";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BA{constructor(e,n,r,i,s=!1,o="",a=!1){this.secure=n,this.namespace=r,this.webSocketOnly=i,this.nodeAdmin=s,this.persistenceKey=o,this.includeNamespaceInQueryParams=a,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=xs.get("host:"+e)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&xs.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){const e=this.secure?"https://":"http://",n=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${n}`}}function IW(t){return t.host!==t.internalHost||t.isCustomHost()||t.includeNamespaceInQueryParams}function jA(t,e,n){$(typeof e=="string","typeof type must == string"),$(typeof n=="object","typeof params must == object");let r;if(e===VA)r=(t.secure?"wss://":"ws://")+t.internalHost+"/.ws?";else if(e===$A)r=(t.secure?"https://":"http://")+t.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+e);IW(t)&&(n.ns=t.namespace);const i=[];return Pt(n,(s,o)=>{i.push(s+"="+o)}),r+i.join("&")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EW{constructor(){this.counters_={}}incrementCounter(e,n=1){Dn(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=n}get(){return mL(this.counters_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fp={},Up={};function hy(t){const e=t.toString();return Fp[e]||(Fp[e]=new EW),Fp[e]}function TW(t,e){const n=t.toString();return Up[n]||(Up[n]=e()),Up[n]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SW{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,n){this.closeAfterResponse=e,this.onClose=n,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,n){for(this.pendingResponses[e]=n;this.pendingResponses[this.currentResponseNum];){const r=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let i=0;i<r.length;++i)r[i]&&Wa(()=>{this.onMessage_(r[i])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vI="start",CW="close",AW="pLPCommand",kW="pRTLPCB",qA="id",WA="pw",KA="ser",RW="cb",NW="seg",PW="ts",DW="d",OW="dframe",HA=1870,GA=30,xW=HA-GA,MW=25e3,LW=3e4;class Pi{constructor(e,n,r,i,s,o,a){this.connId=e,this.repoInfo=n,this.applicationId=r,this.appCheckToken=i,this.authToken=s,this.transportSessionId=o,this.lastSessionId=a,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=uu(e),this.stats_=hy(n),this.urlFn=c=>(this.appCheckToken&&(c[im]=this.appCheckToken),jA(n,$A,c))}open(e,n){this.curSegmentNum=0,this.onDisconnect_=n,this.myPacketOrderer=new SW(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(LW)),fW(()=>{if(this.isClosed_)return;this.scriptTagHolder=new dy((...s)=>{const[o,a,c,l,u]=s;if(this.incrementIncomingBytes_(s),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,o===vI)this.id=a,this.password=c;else if(o===CW)a?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(a,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+o)},(...s)=>{const[o,a]=s;this.incrementIncomingBytes_(s),this.myPacketOrderer.handleResponse(o,a)},()=>{this.onClosed_()},this.urlFn);const r={};r[vI]="t",r[KA]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(r[RW]=this.scriptTagHolder.uniqueCallbackIdentifier),r[DA]=uy,this.transportSessionId&&(r[OA]=this.transportSessionId),this.lastSessionId&&(r[FA]=this.lastSessionId),this.applicationId&&(r[UA]=this.applicationId),this.appCheckToken&&(r[im]=this.appCheckToken),typeof location!="undefined"&&location.hostname&&LA.test(location.hostname)&&(r[xA]=MA);const i=this.urlFn(r);this.log_("Connecting via long-poll to "+i),this.scriptTagHolder.addTag(i,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){Pi.forceAllow_=!0}static forceDisallow(){Pi.forceDisallow_=!0}static isAvailable(){return Pi.forceAllow_?!0:!Pi.forceDisallow_&&typeof document!="undefined"&&document.createElement!=null&&!gW()&&!mW()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){const n=gt(e);this.bytesSent+=n.length,this.stats_.incrementCounter("bytes_sent",n.length);const r=E0(n),i=RA(r,xW);for(let s=0;s<i.length;s++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,i.length,i[s]),this.curSegmentNum++}addDisconnectPingFrame(e,n){this.myDisconnFrame=document.createElement("iframe");const r={};r[OW]="t",r[qA]=e,r[WA]=n,this.myDisconnFrame.src=this.urlFn(r),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){const n=gt(e).length;this.bytesReceived+=n,this.stats_.incrementCounter("bytes_received",n)}}class dy{constructor(e,n,r,i){this.onDisconnect=r,this.urlFn=i,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0;{this.uniqueCallbackIdentifier=CA(),window[AW+this.uniqueCallbackIdentifier]=e,window[kW+this.uniqueCallbackIdentifier]=n,this.myIFrame=dy.createIFrame_();let s="";if(this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"){const a=document.domain;s='<script>document.domain="'+a+'";<\/script>'}const o="<html><body>"+s+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(o),this.myIFrame.doc.close()}catch(a){Et("frame writing exception"),a.stack&&Et(a.stack),Et(a)}}}static createIFrame_(){const e=document.createElement("iframe");if(e.style.display="none",document.body){document.body.appendChild(e);try{e.contentWindow.document||Et("No IE domain setting required")}catch{const r=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+r+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.innerHTML="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));const e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,n){for(this.myID=e,this.myPW=n,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const e={};e[qA]=this.myID,e[WA]=this.myPW,e[KA]=this.currentSerial;let n=this.urlFn(e),r="",i=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+GA+r.length<=HA;){const o=this.pendingSegs.shift();r=r+"&"+NW+i+"="+o.seg+"&"+PW+i+"="+o.ts+"&"+DW+i+"="+o.d,i++}return n=n+r,this.addLongPollTag_(n,this.currentSerial),!0}else return!1}enqueueSegment(e,n,r){this.pendingSegs.push({seg:e,ts:n,d:r}),this.alive&&this.newRequest_()}addLongPollTag_(e,n){this.outstandingRequests.add(n);const r=()=>{this.outstandingRequests.delete(n),this.newRequest_()},i=setTimeout(r,Math.floor(MW)),s=()=>{clearTimeout(i),r()};this.addTag(e,s)}addTag(e,n){setTimeout(()=>{try{if(!this.sendNewPolls)return;const r=this.myIFrame.doc.createElement("script");r.type="text/javascript",r.async=!0,r.src=e,r.onload=r.onreadystatechange=function(){const i=r.readyState;(!i||i==="loaded"||i==="complete")&&(r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),n())},r.onerror=()=>{Et("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(r)}catch{}},Math.floor(1))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FW=16384,UW=45e3;let zh=null;typeof MozWebSocket!="undefined"?zh=MozWebSocket:typeof WebSocket!="undefined"&&(zh=WebSocket);class Fn{constructor(e,n,r,i,s,o,a){this.connId=e,this.applicationId=r,this.appCheckToken=i,this.authToken=s,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=uu(this.connId),this.stats_=hy(n),this.connURL=Fn.connectionURL_(n,o,a,i,r),this.nodeAdmin=n.nodeAdmin}static connectionURL_(e,n,r,i,s){const o={};return o[DA]=uy,typeof location!="undefined"&&location.hostname&&LA.test(location.hostname)&&(o[xA]=MA),n&&(o[OA]=n),r&&(o[FA]=r),i&&(o[im]=i),s&&(o[UA]=s),jA(e,VA,o)}open(e,n){this.onDisconnect=n,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,xs.set("previous_websocket_failure",!0);try{let r;T0(),this.mySock=new zh(this.connURL,[],r)}catch(r){this.log_("Error instantiating WebSocket.");const i=r.message||r.data;i&&this.log_(i),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=r=>{this.handleIncomingFrame(r)},this.mySock.onerror=r=>{this.log_("WebSocket error.  Closing connection.");const i=r.message||r.data;i&&this.log_(i),this.onClosed_()}}start(){}static forceDisallow(){Fn.forceDisallow_=!0}static isAvailable(){let e=!1;if(typeof navigator!="undefined"&&navigator.userAgent){const n=/Android ([0-9]{0,}\.[0-9]{0,})/,r=navigator.userAgent.match(n);r&&r.length>1&&parseFloat(r[1])<4.4&&(e=!0)}return!e&&zh!==null&&!Fn.forceDisallow_}static previouslyFailed(){return xs.isInMemoryStorage||xs.get("previous_websocket_failure")===!0}markConnectionHealthy(){xs.remove("previous_websocket_failure")}appendFrame_(e){if(this.frames.push(e),this.frames.length===this.totalFrames){const n=this.frames.join("");this.frames=null;const r=dl(n);this.onMessage(r)}}handleNewFrameCount_(e){this.totalFrames=e,this.frames=[]}extractFrameCount_(e){if($(this.frames===null,"We already have a frame buffer"),e.length<=6){const n=Number(e);if(!isNaN(n))return this.handleNewFrameCount_(n),null}return this.handleNewFrameCount_(1),e}handleIncomingFrame(e){if(this.mySock===null)return;const n=e.data;if(this.bytesReceived+=n.length,this.stats_.incrementCounter("bytes_received",n.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(n);else{const r=this.extractFrameCount_(n);r!==null&&this.appendFrame_(r)}}send(e){this.resetKeepAlive();const n=gt(e);this.bytesSent+=n.length,this.stats_.incrementCounter("bytes_sent",n.length);const r=RA(n,FW);r.length>1&&this.sendString_(String(r.length));for(let i=0;i<r.length;i++)this.sendString_(r[i])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(UW))}sendString_(e){try{this.mySock.send(e)}catch(n){this.log_("Exception thrown from WebSocket.send():",n.message||n.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}Fn.responsesRequiredToBeHealthy=2;Fn.healthyTimeout=3e4;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _a{constructor(e){this.initTransports_(e)}static get ALL_TRANSPORTS(){return[Pi,Fn]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(e){const n=Fn&&Fn.isAvailable();let r=n&&!Fn.previouslyFailed();if(e.webSocketOnly&&(n||Yt("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),r=!0),r)this.transports_=[Fn];else{const i=this.transports_=[];for(const s of _a.ALL_TRANSPORTS)s&&s.isAvailable()&&i.push(s);_a.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}_a.globalTransportInitialized_=!1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VW=6e4,$W=5e3,BW=10*1024,jW=100*1024,Vp="t",wI="d",qW="s",bI="r",WW="e",II="o",EI="a",TI="n",SI="p",KW="h";class HW{constructor(e,n,r,i,s,o,a,c,l,u){this.id=e,this.repoInfo_=n,this.applicationId_=r,this.appCheckToken_=i,this.authToken_=s,this.onMessage_=o,this.onReady_=a,this.onDisconnect_=c,this.onKill_=l,this.lastSessionId=u,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=uu("c:"+this.id+":"),this.transportManager_=new _a(n),this.log_("Connection created"),this.start_()}start_(){const e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const n=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(n,r)},Math.floor(0));const i=e.healthyTimeout||0;i>0&&(this.healthyTimeout_=$c(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>jW?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>BW?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(i)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return n=>{e===this.conn_?this.onConnectionLost_(n):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return n=>{this.state_!==2&&(e===this.rx_?this.onPrimaryMessageReceived_(n):e===this.secondaryConn_?this.onSecondaryMessageReceived_(n):this.log_("message on old connection"))}}sendRequest(e){const n={t:"d",d:e};this.sendData_(n)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if(Vp in e){const n=e[Vp];n===EI?this.upgradeIfSecondaryHealthy_():n===bI?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):n===II&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){const n=hc("t",e),r=hc("d",e);if(n==="c")this.onSecondaryControl_(r);else if(n==="d")this.pendingDataMessages.push(r);else throw new Error("Unknown protocol layer: "+n)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:SI,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:EI,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:TI,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){const n=hc("t",e),r=hc("d",e);n==="c"?this.onControl_(r):n==="d"&&this.onDataMessage_(r)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){const n=hc(Vp,e);if(wI in e){const r=e[wI];if(n===KW)this.onHandshake_(r);else if(n===TI){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let i=0;i<this.pendingDataMessages.length;++i)this.onDataMessage_(this.pendingDataMessages[i]);this.pendingDataMessages=[],this.tryCleanupConnection()}else n===qW?this.onConnectionShutdown_(r):n===bI?this.onReset_(r):n===WW?rm("Server Error: "+r):n===II?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):rm("Unknown control packet command: "+n)}}onHandshake_(e){const n=e.ts,r=e.v,i=e.h;this.sessionId=e.s,this.repoInfo_.host=i,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,n),uy!==r&&Yt("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const n=this.connReceiver_(this.secondaryConn_),r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(n,r),$c(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(VW))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,n){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(n,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):$c(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor($W))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:SI,d:{}}}))}onSecondaryConnectionLost_(){const e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,!e&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(xs.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(e)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zA{put(e,n,r,i){}merge(e,n,r,i){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,n,r){}onDisconnectMerge(e,n,r){}onDisconnectCancel(e,n){}reportStats(e){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QA{constructor(e){this.allowedEvents_=e,this.listeners_={},$(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...n){if(Array.isArray(this.listeners_[e])){const r=[...this.listeners_[e]];for(let i=0;i<r.length;i++)r[i].callback.apply(r[i].context,n)}}on(e,n,r){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:n,context:r});const i=this.getInitialEvent(e);i&&n.apply(r,i)}off(e,n,r){this.validateEventType_(e);const i=this.listeners_[e]||[];for(let s=0;s<i.length;s++)if(i[s].callback===n&&(!r||r===i[s].context)){i.splice(s,1);return}}validateEventType_(e){$(this.allowedEvents_.find(n=>n===e),"Unknown event: "+e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qh extends QA{constructor(){super(["online"]),this.online_=!0,typeof window!="undefined"&&typeof window.addEventListener!="undefined"&&!zd()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}static getInstance(){return new Qh}getInitialEvent(e){return $(e==="online","Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CI=32,AI=768;class Re{constructor(e,n){if(n===void 0){this.pieces_=e.split("/");let r=0;for(let i=0;i<this.pieces_.length;i++)this.pieces_[i].length>0&&(this.pieces_[r]=this.pieces_[i],r++);this.pieces_.length=r,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=n}toString(){let e="";for(let n=this.pieceNum_;n<this.pieces_.length;n++)this.pieces_[n]!==""&&(e+="/"+this.pieces_[n]);return e||"/"}}function Ae(){return new Re("")}function me(t){return t.pieceNum_>=t.pieces_.length?null:t.pieces_[t.pieceNum_]}function Gi(t){return t.pieces_.length-t.pieceNum_}function Ue(t){let e=t.pieceNum_;return e<t.pieces_.length&&e++,new Re(t.pieces_,e)}function fy(t){return t.pieceNum_<t.pieces_.length?t.pieces_[t.pieces_.length-1]:null}function GW(t){let e="";for(let n=t.pieceNum_;n<t.pieces_.length;n++)t.pieces_[n]!==""&&(e+="/"+encodeURIComponent(String(t.pieces_[n])));return e||"/"}function Tl(t,e=0){return t.pieces_.slice(t.pieceNum_+e)}function YA(t){if(t.pieceNum_>=t.pieces_.length)return null;const e=[];for(let n=t.pieceNum_;n<t.pieces_.length-1;n++)e.push(t.pieces_[n]);return new Re(e,0)}function Ye(t,e){const n=[];for(let r=t.pieceNum_;r<t.pieces_.length;r++)n.push(t.pieces_[r]);if(e instanceof Re)for(let r=e.pieceNum_;r<e.pieces_.length;r++)n.push(e.pieces_[r]);else{const r=e.split("/");for(let i=0;i<r.length;i++)r[i].length>0&&n.push(r[i])}return new Re(n,0)}function _e(t){return t.pieceNum_>=t.pieces_.length}function cn(t,e){const n=me(t),r=me(e);if(n===null)return e;if(n===r)return cn(Ue(t),Ue(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+t+")")}function zW(t,e){const n=Tl(t,0),r=Tl(e,0);for(let i=0;i<n.length&&i<r.length;i++){const s=Eo(n[i],r[i]);if(s!==0)return s}return n.length===r.length?0:n.length<r.length?-1:1}function py(t,e){if(Gi(t)!==Gi(e))return!1;for(let n=t.pieceNum_,r=e.pieceNum_;n<=t.pieces_.length;n++,r++)if(t.pieces_[n]!==e.pieces_[r])return!1;return!0}function Vn(t,e){let n=t.pieceNum_,r=e.pieceNum_;if(Gi(t)>Gi(e))return!1;for(;n<t.pieces_.length;){if(t.pieces_[n]!==e.pieces_[r])return!1;++n,++r}return!0}class QW{constructor(e,n){this.errorPrefix_=n,this.parts_=Tl(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let r=0;r<this.parts_.length;r++)this.byteLength_+=Yd(this.parts_[r]);JA(this)}}function YW(t,e){t.parts_.length>0&&(t.byteLength_+=1),t.parts_.push(e),t.byteLength_+=Yd(e),JA(t)}function JW(t){const e=t.parts_.pop();t.byteLength_-=Yd(e),t.parts_.length>0&&(t.byteLength_-=1)}function JA(t){if(t.byteLength_>AI)throw new Error(t.errorPrefix_+"has a key path longer than "+AI+" bytes ("+t.byteLength_+").");if(t.parts_.length>CI)throw new Error(t.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+CI+") or object contains a cycle "+bs(t))}function bs(t){return t.parts_.length===0?"":"in property '"+t.parts_.join(".")+"'"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gy extends QA{constructor(){super(["visible"]);let e,n;typeof document!="undefined"&&typeof document.addEventListener!="undefined"&&(typeof document.hidden!="undefined"?(n="visibilitychange",e="hidden"):typeof document.mozHidden!="undefined"?(n="mozvisibilitychange",e="mozHidden"):typeof document.msHidden!="undefined"?(n="msvisibilitychange",e="msHidden"):typeof document.webkitHidden!="undefined"&&(n="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,n&&document.addEventListener(n,()=>{const r=!document[e];r!==this.visible_&&(this.visible_=r,this.trigger("visible",r))},!1)}static getInstance(){return new gy}getInitialEvent(e){return $(e==="visible","Unknown event type: "+e),[this.visible_]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dc=1e3,XW=60*5*1e3,kI=30*1e3,ZW=1.3,eK=3e4,tK="server_kill",RI=3;class ti extends zA{constructor(e,n,r,i,s,o,a,c){if(super(),this.repoInfo_=e,this.applicationId_=n,this.onDataUpdate_=r,this.onConnectStatus_=i,this.onServerInfoUpdate_=s,this.authTokenProvider_=o,this.appCheckTokenProvider_=a,this.authOverride_=c,this.id=ti.nextPersistentConnectionId_++,this.log_=uu("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=dc,this.maxReconnectDelay_=XW,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,c&&!T0())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");gy.getInstance().on("visible",this.onVisible_,this),e.host.indexOf("fblocal")===-1&&Qh.getInstance().on("online",this.onOnline_,this)}sendRequest(e,n,r){const i=++this.requestNumber_,s={r:i,a:e,b:n};this.log_(gt(s)),$(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(s),r&&(this.requestCBHash_[i]=r)}get(e){this.initConnection_();const n=new pt,r={p:e._path.toString(),q:e._queryObject},i={action:"g",request:r,onComplete:o=>{const a=o.d;o.s==="ok"?n.resolve(a):n.reject(a)}};this.outstandingGets_.push(i),this.outstandingGetCount_++;const s=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(s),n.promise}listen(e,n,r,i){this.initConnection_();const s=e._queryIdentifier,o=e._path.toString();this.log_("Listen called for "+o+" "+s),this.listens.has(o)||this.listens.set(o,new Map),$(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"listen() called for non-default but complete query"),$(!this.listens.get(o).has(s),"listen() called twice for same path/queryId.");const a={onComplete:i,hashFn:n,query:e,tag:r};this.listens.get(o).set(s,a),this.connected_&&this.sendListen_(a)}sendGet_(e){const n=this.outstandingGets_[e];this.sendRequest("g",n.request,r=>{delete this.outstandingGets_[e],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),n.onComplete&&n.onComplete(r)})}sendListen_(e){const n=e.query,r=n._path.toString(),i=n._queryIdentifier;this.log_("Listen on "+r+" for "+i);const s={p:r},o="q";e.tag&&(s.q=n._queryObject,s.t=e.tag),s.h=e.hashFn(),this.sendRequest(o,s,a=>{const c=a.d,l=a.s;ti.warnOnListenWarnings_(c,n),(this.listens.get(r)&&this.listens.get(r).get(i))===e&&(this.log_("listen response",a),l!=="ok"&&this.removeListen_(r,i),e.onComplete&&e.onComplete(l,c))})}static warnOnListenWarnings_(e,n){if(e&&typeof e=="object"&&Dn(e,"w")){const r=Hs(e,"w");if(Array.isArray(r)&&~r.indexOf("no_index")){const i='".indexOn": "'+n._queryParams.getIndex().toString()+'"',s=n._path.toString();Yt(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${i} at ${s} to your security rules for better performance.`)}}}refreshAuthToken(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(e)}reduceReconnectDelayIfAdminCredential_(e){(e&&e.length===40||kL(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=kI)}refreshAppCheckToken(e){this.appCheckToken_=e,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){const e=this.authToken_,n=AL(e)?"auth":"gauth",r={cred:e};this.authOverride_===null?r.noauth=!0:typeof this.authOverride_=="object"&&(r.authvar=this.authOverride_),this.sendRequest(n,r,i=>{const s=i.s,o=i.d||"error";this.authToken_===e&&(s==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(s,o))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},e=>{const n=e.s,r=e.d||"error";n==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(n,r)})}unlisten(e,n){const r=e._path.toString(),i=e._queryIdentifier;this.log_("Unlisten called for "+r+" "+i),$(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(r,i)&&this.connected_&&this.sendUnlisten_(r,i,e._queryObject,n)}sendUnlisten_(e,n,r,i){this.log_("Unlisten on "+e+" for "+n);const s={p:e},o="n";i&&(s.q=r,s.t=i),this.sendRequest(o,s)}onDisconnectPut(e,n,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",e,n,r):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:n,onComplete:r})}onDisconnectMerge(e,n,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",e,n,r):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:n,onComplete:r})}onDisconnectCancel(e,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",e,null,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:n})}sendOnDisconnect_(e,n,r,i){const s={p:n,d:r};this.log_("onDisconnect "+e,s),this.sendRequest(e,s,o=>{i&&setTimeout(()=>{i(o.s,o.d)},Math.floor(0))})}put(e,n,r,i){this.putInternal("p",e,n,r,i)}merge(e,n,r,i){this.putInternal("m",e,n,r,i)}putInternal(e,n,r,i,s){this.initConnection_();const o={p:n,d:r};s!==void 0&&(o.h=s),this.outstandingPuts_.push({action:e,request:o,onComplete:i}),this.outstandingPutCount_++;const a=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(a):this.log_("Buffering put: "+n)}sendPut_(e){const n=this.outstandingPuts_[e].action,r=this.outstandingPuts_[e].request,i=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(n,r,s=>{this.log_(n+" response",s),delete this.outstandingPuts_[e],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),i&&i(s.s,s.d)})}reportStats(e){if(this.connected_){const n={c:e};this.log_("reportStats",n),this.sendRequest("s",n,r=>{if(r.s!=="ok"){const s=r.d;this.log_("reportStats","Error sending stats: "+s)}})}}onDataMessage_(e){if("r"in e){this.log_("from server: "+gt(e));const n=e.r,r=this.requestCBHash_[n];r&&(delete this.requestCBHash_[n],r(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}}onDataPush_(e,n){this.log_("handleServerMessage",e,n),e==="d"?this.onDataUpdate_(n.p,n.d,!1,n.t):e==="m"?this.onDataUpdate_(n.p,n.d,!0,n.t):e==="c"?this.onListenRevoked_(n.p,n.q):e==="ac"?this.onAuthRevoked_(n.s,n.d):e==="apc"?this.onAppCheckRevoked_(n.s,n.d):e==="sd"?this.onSecurityDebugPacket_(n):rm("Unrecognized action received from server: "+gt(e)+`
Are you using the latest client?`)}onReady_(e,n){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(e),this.lastSessionId=n,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(e){$(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(e))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=dc,this.realtime_||this.scheduleConnect_(0)),this.visible_=e}onOnline_(e){e?(this.log_("Browser went online."),this.reconnectDelay_=dc,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>eK&&(this.reconnectDelay_=dc),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());const e=new Date().getTime()-this.lastConnectionAttemptTime_;let n=Math.max(0,this.reconnectDelay_-e);n=Math.random()*n,this.log_("Trying to reconnect in "+n+"ms"),this.scheduleConnect_(n),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*ZW)}this.onConnectStatus_(!1)}async establishConnection_(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;const e=this.onDataMessage_.bind(this),n=this.onReady_.bind(this),r=this.onRealtimeDisconnect_.bind(this),i=this.id+":"+ti.nextConnectionId_++,s=this.lastSessionId;let o=!1,a=null;const c=function(){a?a.close():(o=!0,r())},l=function(h){$(a,"sendRequest call when we're not connected not allowed."),a.sendRequest(h)};this.realtime_={close:c,sendRequest:l};const u=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{const[h,d]=await Promise.all([this.authTokenProvider_.getToken(u),this.appCheckTokenProvider_.getToken(u)]);o?Et("getToken() completed but was canceled"):(Et("getToken() completed. Creating connection."),this.authToken_=h&&h.accessToken,this.appCheckToken_=d&&d.token,a=new HW(i,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,e,n,r,f=>{Yt(f+" ("+this.repoInfo_.toString()+")"),this.interrupt(tK)},s))}catch(h){this.log_("Failed to get token: "+h),o||(this.repoInfo_.nodeAdmin&&Yt(h),c())}}}interrupt(e){Et("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(e){Et("Resuming connection for reason: "+e),delete this.interruptReasons_[e],xh(this.interruptReasons_)&&(this.reconnectDelay_=dc,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(e){const n=e-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:n})}cancelSentTransactions_(){for(let e=0;e<this.outstandingPuts_.length;e++){const n=this.outstandingPuts_[e];n&&"h"in n.request&&n.queued&&(n.onComplete&&n.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(e,n){let r;n?r=n.map(s=>cy(s)).join("$"):r="default";const i=this.removeListen_(e,r);i&&i.onComplete&&i.onComplete("permission_denied")}removeListen_(e,n){const r=new Re(e).toString();let i;if(this.listens.has(r)){const s=this.listens.get(r);i=s.get(n),s.delete(n),s.size===0&&this.listens.delete(r)}else i=void 0;return i}onAuthRevoked_(e,n){Et("Auth token revoked: "+e+"/"+n),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(e==="invalid_token"||e==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=RI&&(this.reconnectDelay_=kI,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(e,n){Et("App check token revoked: "+e+"/"+n),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(e==="invalid_token"||e==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=RI&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const e of this.listens.values())for(const n of e.values())this.sendListen_(n);for(let e=0;e<this.outstandingPuts_.length;e++)this.outstandingPuts_[e]&&this.sendPut_(e);for(;this.onDisconnectRequestQueue_.length;){const e=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(e.action,e.pathString,e.data,e.onComplete)}for(let e=0;e<this.outstandingGets_.length;e++)this.outstandingGets_[e]&&this.sendGet_(e)}sendConnectStats_(){const e={};let n="js";e["sdk."+n+"."+EA.replace(/\./g,"-")]=1,zd()?e["framework.cordova"]=1:nu()&&(e["framework.reactnative"]=1),this.reportStats(e)}shouldReconnect_(){const e=Qh.getInstance().currentlyOnline();return xh(this.interruptReasons_)&&e}}ti.nextPersistentConnectionId_=0;ti.nextConnectionId_=0;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ye{constructor(e,n){this.name=e,this.node=n}static Wrap(e,n){return new ye(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pf{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,n){const r=new ye(si,e),i=new ye(si,n);return this.compare(r,i)!==0}minPost(){return ye.MIN}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let zu;class XA extends pf{static get __EMPTY_NODE(){return zu}static set __EMPTY_NODE(e){zu=e}compare(e,n){return Eo(e.name,n.name)}isDefinedOn(e){throw Ua("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,n){return!1}minPost(){return ye.MIN}maxPost(){return new ye(Mr,zu)}makePost(e,n){return $(typeof e=="string","KeyIndex indexValue must always be a string."),new ye(e,zu)}toString(){return".key"}}const Ar=new XA;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qu{constructor(e,n,r,i,s=null){this.isReverse_=i,this.resultGenerator_=s,this.nodeStack_=[];let o=1;for(;!e.isEmpty();)if(e=e,o=n?r(e.key,n):1,i&&(o*=-1),o<0)this.isReverse_?e=e.left:e=e.right;else if(o===0){this.nodeStack_.push(e);break}else this.nodeStack_.push(e),this.isReverse_?e=e.right:e=e.left}getNext(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_.pop(),n;if(this.resultGenerator_?n=this.resultGenerator_(e.key,e.value):n={key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return n}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;const e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}}class bt{constructor(e,n,r,i,s){this.key=e,this.value=n,this.color=r!=null?r:bt.RED,this.left=i!=null?i:_n.EMPTY_NODE,this.right=s!=null?s:_n.EMPTY_NODE}copy(e,n,r,i,s){return new bt(e!=null?e:this.key,n!=null?n:this.value,r!=null?r:this.color,i!=null?i:this.left,s!=null?s:this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let i=this;const s=r(e,i.key);return s<0?i=i.copy(null,null,null,i.left.insert(e,n,r),null):s===0?i=i.copy(null,n,null,null,null):i=i.copy(null,null,null,null,i.right.insert(e,n,r)),i.fixUp_()}removeMin_(){if(this.left.isEmpty())return _n.EMPTY_NODE;let e=this;return!e.left.isRed_()&&!e.left.left.isRed_()&&(e=e.moveRedLeft_()),e=e.copy(null,null,null,e.left.removeMin_(),null),e.fixUp_()}remove(e,n){let r,i;if(r=this,n(e,r.key)<0)!r.left.isEmpty()&&!r.left.isRed_()&&!r.left.left.isRed_()&&(r=r.moveRedLeft_()),r=r.copy(null,null,null,r.left.remove(e,n),null);else{if(r.left.isRed_()&&(r=r.rotateRight_()),!r.right.isEmpty()&&!r.right.isRed_()&&!r.right.left.isRed_()&&(r=r.moveRedRight_()),n(e,r.key)===0){if(r.right.isEmpty())return _n.EMPTY_NODE;i=r.right.min_(),r=r.copy(i.key,i.value,null,null,r.right.removeMin_())}r=r.copy(null,null,null,null,r.right.remove(e,n))}return r.fixUp_()}isRed_(){return this.color}fixUp_(){let e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e}moveRedLeft_(){let e=this.colorFlip_();return e.right.left.isRed_()&&(e=e.copy(null,null,null,null,e.right.rotateRight_()),e=e.rotateLeft_(),e=e.colorFlip_()),e}moveRedRight_(){let e=this.colorFlip_();return e.left.left.isRed_()&&(e=e.rotateRight_(),e=e.colorFlip_()),e}rotateLeft_(){const e=this.copy(null,null,bt.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight_(){const e=this.copy(null,null,bt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip_(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth_(){const e=this.check_();return Math.pow(2,e)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)}}bt.RED=!0;bt.BLACK=!1;class nK{copy(e,n,r,i,s){return this}insert(e,n,r){return new bt(e,n,null)}remove(e,n){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}}class _n{constructor(e,n=_n.EMPTY_NODE){this.comparator_=e,this.root_=n}insert(e,n){return new _n(this.comparator_,this.root_.insert(e,n,this.comparator_).copy(null,null,bt.BLACK,null,null))}remove(e){return new _n(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,bt.BLACK,null,null))}get(e){let n,r=this.root_;for(;!r.isEmpty();){if(n=this.comparator_(e,r.key),n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}getPredecessorKey(e){let n,r=this.root_,i=null;for(;!r.isEmpty();)if(n=this.comparator_(e,r.key),n===0){if(r.left.isEmpty())return i?i.key:null;for(r=r.left;!r.right.isEmpty();)r=r.right;return r.key}else n<0?r=r.left:n>0&&(i=r,r=r.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new Qu(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,n){return new Qu(this.root_,e,this.comparator_,!1,n)}getReverseIteratorFrom(e,n){return new Qu(this.root_,e,this.comparator_,!0,n)}getReverseIterator(e){return new Qu(this.root_,null,this.comparator_,!0,e)}}_n.EMPTY_NODE=new nK;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rK(t,e){return Eo(t.name,e.name)}function my(t,e){return Eo(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let sm;function iK(t){sm=t}const ZA=function(t){return typeof t=="number"?"number:"+NA(t):"string:"+t},ek=function(t){if(t.isLeafNode()){const e=t.val();$(typeof e=="string"||typeof e=="number"||typeof e=="object"&&Dn(e,".sv"),"Priority must be a string or number.")}else $(t===sm||t.isEmpty(),"priority of unexpected type.");$(t===sm||t.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let NI;class yt{constructor(e,n=yt.__childrenNodeConstructor.EMPTY_NODE){this.value_=e,this.priorityNode_=n,this.lazyHash_=null,$(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),ek(this.priorityNode_)}static set __childrenNodeConstructor(e){NI=e}static get __childrenNodeConstructor(){return NI}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(e){return new yt(this.value_,e)}getImmediateChild(e){return e===".priority"?this.priorityNode_:yt.__childrenNodeConstructor.EMPTY_NODE}getChild(e){return _e(e)?this:me(e)===".priority"?this.priorityNode_:yt.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(e,n){return null}updateImmediateChild(e,n){return e===".priority"?this.updatePriority(n):n.isEmpty()&&e!==".priority"?this:yt.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,n).updatePriority(this.priorityNode_)}updateChild(e,n){const r=me(e);return r===null?n:n.isEmpty()&&r!==".priority"?this:($(r!==".priority"||Gi(e)===1,".priority must be the last token in a path"),this.updateImmediateChild(r,yt.__childrenNodeConstructor.EMPTY_NODE.updateChild(Ue(e),n)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(e,n){return!1}val(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let e="";this.priorityNode_.isEmpty()||(e+="priority:"+ZA(this.priorityNode_.val())+":");const n=typeof this.value_;e+=n+":",n==="number"?e+=NA(this.value_):e+=this.value_,this.lazyHash_=AA(e)}return this.lazyHash_}getValue(){return this.value_}compareTo(e){return e===yt.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof yt.__childrenNodeConstructor?-1:($(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))}compareToLeafNode_(e){const n=typeof e.value_,r=typeof this.value_,i=yt.VALUE_TYPE_ORDER.indexOf(n),s=yt.VALUE_TYPE_ORDER.indexOf(r);return $(i>=0,"Unknown leaf type: "+n),$(s>=0,"Unknown leaf type: "+r),i===s?r==="object"?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:s-i}withIndex(){return this}isIndexed(){return!0}equals(e){if(e===this)return!0;if(e.isLeafNode()){const n=e;return this.value_===n.value_&&this.priorityNode_.equals(n.priorityNode_)}else return!1}}yt.VALUE_TYPE_ORDER=["object","boolean","number","string"];/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let tk,nk;function sK(t){tk=t}function oK(t){nk=t}class aK extends pf{compare(e,n){const r=e.node.getPriority(),i=n.node.getPriority(),s=r.compareTo(i);return s===0?Eo(e.name,n.name):s}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,n){return!e.getPriority().equals(n.getPriority())}minPost(){return ye.MIN}maxPost(){return new ye(Mr,new yt("[PRIORITY-POST]",nk))}makePost(e,n){const r=tk(e);return new ye(n,new yt("[PRIORITY-POST]",r))}toString(){return".priority"}}const qe=new aK;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cK=Math.log(2);class lK{constructor(e){const n=s=>parseInt(Math.log(s)/cK,10),r=s=>parseInt(Array(s+1).join("1"),2);this.count=n(e+1),this.current_=this.count-1;const i=r(this.count);this.bits_=e+1&i}nextBitIsOne(){const e=!(this.bits_&1<<this.current_);return this.current_--,e}}const Yh=function(t,e,n,r){t.sort(e);const i=function(c,l){const u=l-c;let h,d;if(u===0)return null;if(u===1)return h=t[c],d=n?n(h):h,new bt(d,h.node,bt.BLACK,null,null);{const f=parseInt(u/2,10)+c,g=i(c,f),v=i(f+1,l);return h=t[f],d=n?n(h):h,new bt(d,h.node,bt.BLACK,g,v)}},s=function(c){let l=null,u=null,h=t.length;const d=function(g,v){const I=h-g,S=h;h-=g;const k=i(I+1,S),R=t[I],E=n?n(R):R;f(new bt(E,R.node,v,null,k))},f=function(g){l?(l.left=g,l=g):(u=g,l=g)};for(let g=0;g<c.count;++g){const v=c.nextBitIsOne(),I=Math.pow(2,c.count-(g+1));v?d(I,bt.BLACK):(d(I,bt.BLACK),d(I,bt.RED))}return u},o=new lK(t.length),a=s(o);return new _n(r||e,a)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let $p;const Lo={};class Yr{constructor(e,n){this.indexes_=e,this.indexSet_=n}static get Default(){return $(Lo&&qe,"ChildrenNode.ts has not been loaded"),$p=$p||new Yr({".priority":Lo},{".priority":qe}),$p}get(e){const n=Hs(this.indexes_,e);if(!n)throw new Error("No index defined for "+e);return n instanceof _n?n:null}hasIndex(e){return Dn(this.indexSet_,e.toString())}addIndex(e,n){$(e!==Ar,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const r=[];let i=!1;const s=n.getIterator(ye.Wrap);let o=s.getNext();for(;o;)i=i||e.isDefinedOn(o.node),r.push(o),o=s.getNext();let a;i?a=Yh(r,e.getCompare()):a=Lo;const c=e.toString(),l=Object.assign({},this.indexSet_);l[c]=e;const u=Object.assign({},this.indexes_);return u[c]=a,new Yr(u,l)}addToIndexes(e,n){const r=Mh(this.indexes_,(i,s)=>{const o=Hs(this.indexSet_,s);if($(o,"Missing index implementation for "+s),i===Lo)if(o.isDefinedOn(e.node)){const a=[],c=n.getIterator(ye.Wrap);let l=c.getNext();for(;l;)l.name!==e.name&&a.push(l),l=c.getNext();return a.push(e),Yh(a,o.getCompare())}else return Lo;else{const a=n.get(e.name);let c=i;return a&&(c=c.remove(new ye(e.name,a))),c.insert(e,e.node)}});return new Yr(r,this.indexSet_)}removeFromIndexes(e,n){const r=Mh(this.indexes_,i=>{if(i===Lo)return i;{const s=n.get(e.name);return s?i.remove(new ye(e.name,s)):i}});return new Yr(r,this.indexSet_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let fc;class re{constructor(e,n,r){this.children_=e,this.priorityNode_=n,this.indexMap_=r,this.lazyHash_=null,this.priorityNode_&&ek(this.priorityNode_),this.children_.isEmpty()&&$(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return fc||(fc=new re(new _n(my),null,Yr.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||fc}updatePriority(e){return this.children_.isEmpty()?this:new re(this.children_,e,this.indexMap_)}getImmediateChild(e){if(e===".priority")return this.getPriority();{const n=this.children_.get(e);return n===null?fc:n}}getChild(e){const n=me(e);return n===null?this:this.getImmediateChild(n).getChild(Ue(e))}hasChild(e){return this.children_.get(e)!==null}updateImmediateChild(e,n){if($(n,"We should always be passing snapshot nodes"),e===".priority")return this.updatePriority(n);{const r=new ye(e,n);let i,s;n.isEmpty()?(i=this.children_.remove(e),s=this.indexMap_.removeFromIndexes(r,this.children_)):(i=this.children_.insert(e,n),s=this.indexMap_.addToIndexes(r,this.children_));const o=i.isEmpty()?fc:this.priorityNode_;return new re(i,o,s)}}updateChild(e,n){const r=me(e);if(r===null)return n;{$(me(e)!==".priority"||Gi(e)===1,".priority must be the last token in a path");const i=this.getImmediateChild(r).updateChild(Ue(e),n);return this.updateImmediateChild(r,i)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(e){if(this.isEmpty())return null;const n={};let r=0,i=0,s=!0;if(this.forEachChild(qe,(o,a)=>{n[o]=a.val(e),r++,s&&re.INTEGER_REGEXP_.test(o)?i=Math.max(i,Number(o)):s=!1}),!e&&s&&i<2*r){const o=[];for(const a in n)o[a]=n[a];return o}else return e&&!this.getPriority().isEmpty()&&(n[".priority"]=this.getPriority().val()),n}hash(){if(this.lazyHash_===null){let e="";this.getPriority().isEmpty()||(e+="priority:"+ZA(this.getPriority().val())+":"),this.forEachChild(qe,(n,r)=>{const i=r.hash();i!==""&&(e+=":"+n+":"+i)}),this.lazyHash_=e===""?"":AA(e)}return this.lazyHash_}getPredecessorChildName(e,n,r){const i=this.resolveIndex_(r);if(i){const s=i.getPredecessorKey(new ye(e,n));return s?s.name:null}else return this.children_.getPredecessorKey(e)}getFirstChildName(e){const n=this.resolveIndex_(e);if(n){const r=n.minKey();return r&&r.name}else return this.children_.minKey()}getFirstChild(e){const n=this.getFirstChildName(e);return n?new ye(n,this.children_.get(n)):null}getLastChildName(e){const n=this.resolveIndex_(e);if(n){const r=n.maxKey();return r&&r.name}else return this.children_.maxKey()}getLastChild(e){const n=this.getLastChildName(e);return n?new ye(n,this.children_.get(n)):null}forEachChild(e,n){const r=this.resolveIndex_(e);return r?r.inorderTraversal(i=>n(i.name,i.node)):this.children_.inorderTraversal(n)}getIterator(e){return this.getIteratorFrom(e.minPost(),e)}getIteratorFrom(e,n){const r=this.resolveIndex_(n);if(r)return r.getIteratorFrom(e,i=>i);{const i=this.children_.getIteratorFrom(e.name,ye.Wrap);let s=i.peek();for(;s!=null&&n.compare(s,e)<0;)i.getNext(),s=i.peek();return i}}getReverseIterator(e){return this.getReverseIteratorFrom(e.maxPost(),e)}getReverseIteratorFrom(e,n){const r=this.resolveIndex_(n);if(r)return r.getReverseIteratorFrom(e,i=>i);{const i=this.children_.getReverseIteratorFrom(e.name,ye.Wrap);let s=i.peek();for(;s!=null&&n.compare(s,e)>0;)i.getNext(),s=i.peek();return i}}compareTo(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===hu?-1:0}withIndex(e){if(e===Ar||this.indexMap_.hasIndex(e))return this;{const n=this.indexMap_.addIndex(e,this.children_);return new re(this.children_,this.priorityNode_,n)}}isIndexed(e){return e===Ar||this.indexMap_.hasIndex(e)}equals(e){if(e===this)return!0;if(e.isLeafNode())return!1;{const n=e;if(this.getPriority().equals(n.getPriority()))if(this.children_.count()===n.children_.count()){const r=this.getIterator(qe),i=n.getIterator(qe);let s=r.getNext(),o=i.getNext();for(;s&&o;){if(s.name!==o.name||!s.node.equals(o.node))return!1;s=r.getNext(),o=i.getNext()}return s===null&&o===null}else return!1;else return!1}}resolveIndex_(e){return e===Ar?null:this.indexMap_.get(e.toString())}}re.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;class uK extends re{constructor(){super(new _n(my),re.EMPTY_NODE,Yr.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return re.EMPTY_NODE}isEmpty(){return!1}}const hu=new uK;Object.defineProperties(ye,{MIN:{value:new ye(si,re.EMPTY_NODE)},MAX:{value:new ye(Mr,hu)}});XA.__EMPTY_NODE=re.EMPTY_NODE;yt.__childrenNodeConstructor=re;iK(hu);oK(hu);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hK=!0;function Xe(t,e=null){if(t===null)return re.EMPTY_NODE;if(typeof t=="object"&&".priority"in t&&(e=t[".priority"]),$(e===null||typeof e=="string"||typeof e=="number"||typeof e=="object"&&".sv"in e,"Invalid priority type found: "+typeof e),typeof t=="object"&&".value"in t&&t[".value"]!==null&&(t=t[".value"]),typeof t!="object"||".sv"in t){const n=t;return new yt(n,Xe(e))}if(!(t instanceof Array)&&hK){const n=[];let r=!1;if(Pt(t,(o,a)=>{if(o.substring(0,1)!=="."){const c=Xe(a);c.isEmpty()||(r=r||!c.getPriority().isEmpty(),n.push(new ye(o,c)))}}),n.length===0)return re.EMPTY_NODE;const s=Yh(n,rK,o=>o.name,my);if(r){const o=Yh(n,qe.getCompare());return new re(s,Xe(e),new Yr({".priority":o},{".priority":qe}))}else return new re(s,Xe(e),Yr.Default)}else{let n=re.EMPTY_NODE;return Pt(t,(r,i)=>{if(Dn(t,r)&&r.substring(0,1)!=="."){const s=Xe(i);(s.isLeafNode()||!s.isEmpty())&&(n=n.updateImmediateChild(r,s))}}),n.updatePriority(Xe(e))}}sK(Xe);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _y extends pf{constructor(e){super(),this.indexPath_=e,$(!_e(e)&&me(e)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,n){const r=this.extractChild(e.node),i=this.extractChild(n.node),s=r.compareTo(i);return s===0?Eo(e.name,n.name):s}makePost(e,n){const r=Xe(e),i=re.EMPTY_NODE.updateChild(this.indexPath_,r);return new ye(n,i)}maxPost(){const e=re.EMPTY_NODE.updateChild(this.indexPath_,hu);return new ye(Mr,e)}toString(){return Tl(this.indexPath_,0).join("/")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dK extends pf{compare(e,n){const r=e.node.compareTo(n.node);return r===0?Eo(e.name,n.name):r}isDefinedOn(e){return!0}indexedValueChanged(e,n){return!e.equals(n)}minPost(){return ye.MIN}maxPost(){return ye.MAX}makePost(e,n){const r=Xe(e);return new ye(n,r)}toString(){return".value"}}const yy=new dK;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ya="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",om="-",rk="z",ik=786,fK=function(){let t=0;const e=[];return function(n){const r=n===t;t=n;let i;const s=new Array(8);for(i=7;i>=0;i--)s[i]=ya.charAt(n%64),n=Math.floor(n/64);$(n===0,"Cannot push at time == 0");let o=s.join("");if(r){for(i=11;i>=0&&e[i]===63;i--)e[i]=0;e[i]++}else for(i=0;i<12;i++)e[i]=Math.floor(Math.random()*64);for(i=0;i<12;i++)o+=ya.charAt(e[i]);return $(o.length===20,"nextPushId: Length should be 20."),o}}(),PI=function(t){if(t===""+ly)return om;const e=Gh(t);if(e!=null)return""+(e+1);const n=new Array(t.length);for(let o=0;o<n.length;o++)n[o]=t.charAt(o);if(n.length<ik)return n.push(om),n.join("");let r=n.length-1;for(;r>=0&&n[r]===rk;)r--;if(r===-1)return Mr;const i=n[r],s=ya.charAt(ya.indexOf(i)+1);return n[r]=s,n.slice(0,r+1).join("")},DI=function(t){if(t===""+PA)return si;const e=Gh(t);if(e!=null)return""+(e-1);const n=new Array(t.length);for(let r=0;r<n.length;r++)n[r]=t.charAt(r);return n[n.length-1]===om?n.length===1?""+ly:(delete n[n.length-1],n.join("")):(n[n.length-1]=ya.charAt(ya.indexOf(n[n.length-1])-1),n.join("")+rk.repeat(ik-n.length))};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sk(t){return{type:"value",snapshotNode:t}}function va(t,e){return{type:"child_added",snapshotNode:e,childName:t}}function Sl(t,e){return{type:"child_removed",snapshotNode:e,childName:t}}function Cl(t,e,n){return{type:"child_changed",snapshotNode:e,childName:t,oldSnap:n}}function pK(t,e){return{type:"child_moved",snapshotNode:e,childName:t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vy{constructor(e){this.index_=e}updateChild(e,n,r,i,s,o){$(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");const a=e.getImmediateChild(n);return a.getChild(i).equals(r.getChild(i))&&a.isEmpty()===r.isEmpty()||(o!=null&&(r.isEmpty()?e.hasChild(n)?o.trackChildChange(Sl(n,a)):$(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):a.isEmpty()?o.trackChildChange(va(n,r)):o.trackChildChange(Cl(n,r,a))),e.isLeafNode()&&r.isEmpty())?e:e.updateImmediateChild(n,r).withIndex(this.index_)}updateFullNode(e,n,r){return r!=null&&(e.isLeafNode()||e.forEachChild(qe,(i,s)=>{n.hasChild(i)||r.trackChildChange(Sl(i,s))}),n.isLeafNode()||n.forEachChild(qe,(i,s)=>{if(e.hasChild(i)){const o=e.getImmediateChild(i);o.equals(s)||r.trackChildChange(Cl(i,s,o))}else r.trackChildChange(va(i,s))})),n.withIndex(this.index_)}updatePriority(e,n){return e.isEmpty()?re.EMPTY_NODE:e.updatePriority(n)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Al{constructor(e){this.indexedFilter_=new vy(e.getIndex()),this.index_=e.getIndex(),this.startPost_=Al.getStartPost_(e),this.endPost_=Al.getEndPost_(e)}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){return this.index_.compare(this.getStartPost(),e)<=0&&this.index_.compare(e,this.getEndPost())<=0}updateChild(e,n,r,i,s,o){return this.matches(new ye(n,r))||(r=re.EMPTY_NODE),this.indexedFilter_.updateChild(e,n,r,i,s,o)}updateFullNode(e,n,r){n.isLeafNode()&&(n=re.EMPTY_NODE);let i=n.withIndex(this.index_);i=i.updatePriority(re.EMPTY_NODE);const s=this;return n.forEachChild(qe,(o,a)=>{s.matches(new ye(o,a))||(i=i.updateImmediateChild(o,re.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,i,r)}updatePriority(e,n){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){const n=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),n)}else return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){const n=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),n)}else return e.getIndex().maxPost()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gK{constructor(e){this.rangedFilter_=new Al(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft()}updateChild(e,n,r,i,s,o){return this.rangedFilter_.matches(new ye(n,r))||(r=re.EMPTY_NODE),e.getImmediateChild(n).equals(r)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,n,r,i,s,o):this.fullLimitUpdateChild_(e,n,r,s,o)}updateFullNode(e,n,r){let i;if(n.isLeafNode()||n.isEmpty())i=re.EMPTY_NODE.withIndex(this.index_);else if(this.limit_*2<n.numChildren()&&n.isIndexed(this.index_)){i=re.EMPTY_NODE.withIndex(this.index_);let s;this.reverse_?s=n.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):s=n.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let o=0;for(;s.hasNext()&&o<this.limit_;){const a=s.getNext();let c;if(this.reverse_?c=this.index_.compare(this.rangedFilter_.getStartPost(),a)<=0:c=this.index_.compare(a,this.rangedFilter_.getEndPost())<=0,c)i=i.updateImmediateChild(a.name,a.node),o++;else break}}else{i=n.withIndex(this.index_),i=i.updatePriority(re.EMPTY_NODE);let s,o,a,c;if(this.reverse_){c=i.getReverseIterator(this.index_),s=this.rangedFilter_.getEndPost(),o=this.rangedFilter_.getStartPost();const h=this.index_.getCompare();a=(d,f)=>h(f,d)}else c=i.getIterator(this.index_),s=this.rangedFilter_.getStartPost(),o=this.rangedFilter_.getEndPost(),a=this.index_.getCompare();let l=0,u=!1;for(;c.hasNext();){const h=c.getNext();!u&&a(s,h)<=0&&(u=!0),u&&l<this.limit_&&a(h,o)<=0?l++:i=i.updateImmediateChild(h.name,re.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,i,r)}updatePriority(e,n){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,n,r,i,s){let o;if(this.reverse_){const h=this.index_.getCompare();o=(d,f)=>h(f,d)}else o=this.index_.getCompare();const a=e;$(a.numChildren()===this.limit_,"");const c=new ye(n,r),l=this.reverse_?a.getFirstChild(this.index_):a.getLastChild(this.index_),u=this.rangedFilter_.matches(c);if(a.hasChild(n)){const h=a.getImmediateChild(n);let d=i.getChildAfterChild(this.index_,l,this.reverse_);for(;d!=null&&(d.name===n||a.hasChild(d.name));)d=i.getChildAfterChild(this.index_,d,this.reverse_);const f=d==null?1:o(d,c);if(u&&!r.isEmpty()&&f>=0)return s!=null&&s.trackChildChange(Cl(n,r,h)),a.updateImmediateChild(n,r);{s!=null&&s.trackChildChange(Sl(n,h));const v=a.updateImmediateChild(n,re.EMPTY_NODE);return d!=null&&this.rangedFilter_.matches(d)?(s!=null&&s.trackChildChange(va(d.name,d.node)),v.updateImmediateChild(d.name,d.node)):v}}else return r.isEmpty()?e:u&&o(l,c)>=0?(s!=null&&(s.trackChildChange(Sl(l.name,l.node)),s.trackChildChange(va(n,r))),a.updateImmediateChild(n,r).updateImmediateChild(l.name,re.EMPTY_NODE)):e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gf{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=qe}hasStart(){return this.startSet_}hasStartAfter(){return this.startAfterSet_}hasEndBefore(){return this.endBeforeSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return $(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return $(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:si}hasEnd(){return this.endSet_}getIndexEndValue(){return $(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return $(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:Mr}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return $(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===qe}copy(){const e=new gf;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}}function mK(t){return t.loadsAllData()?new vy(t.getIndex()):t.hasLimit()?new gK(t):new Al(t)}function _K(t,e){const n=t.copy();return n.limitSet_=!0,n.limit_=e,n.viewFrom_="l",n}function yK(t,e){const n=t.copy();return n.limitSet_=!0,n.limit_=e,n.viewFrom_="r",n}function am(t,e,n){const r=t.copy();return r.startSet_=!0,e===void 0&&(e=null),r.indexStartValue_=e,n!=null?(r.startNameSet_=!0,r.indexStartName_=n):(r.startNameSet_=!1,r.indexStartName_=""),r}function vK(t,e,n){let r;if(t.index_===Ar)typeof e=="string"&&(e=PI(e)),r=am(t,e,n);else{let i;n==null?i=Mr:i=PI(n),r=am(t,e,i)}return r.startAfterSet_=!0,r}function cm(t,e,n){const r=t.copy();return r.endSet_=!0,e===void 0&&(e=null),r.indexEndValue_=e,n!==void 0?(r.endNameSet_=!0,r.indexEndName_=n):(r.endNameSet_=!1,r.indexEndName_=""),r}function wK(t,e,n){let r,i;return t.index_===Ar?(typeof e=="string"&&(e=DI(e)),i=cm(t,e,n)):(n==null?r=si:r=DI(n),i=cm(t,e,r)),i.endBeforeSet_=!0,i}function mf(t,e){const n=t.copy();return n.index_=e,n}function OI(t){const e={};if(t.isDefault())return e;let n;return t.index_===qe?n="$priority":t.index_===yy?n="$value":t.index_===Ar?n="$key":($(t.index_ instanceof _y,"Unrecognized index type!"),n=t.index_.toString()),e.orderBy=gt(n),t.startSet_&&(e.startAt=gt(t.indexStartValue_),t.startNameSet_&&(e.startAt+=","+gt(t.indexStartName_))),t.endSet_&&(e.endAt=gt(t.indexEndValue_),t.endNameSet_&&(e.endAt+=","+gt(t.indexEndName_))),t.limitSet_&&(t.isViewFromLeft()?e.limitToFirst=t.limit_:e.limitToLast=t.limit_),e}function xI(t){const e={};if(t.startSet_&&(e.sp=t.indexStartValue_,t.startNameSet_&&(e.sn=t.indexStartName_)),t.endSet_&&(e.ep=t.indexEndValue_,t.endNameSet_&&(e.en=t.indexEndName_)),t.limitSet_){e.l=t.limit_;let n=t.viewFrom_;n===""&&(t.isViewFromLeft()?n="l":n="r"),e.vf=n}return t.index_!==qe&&(e.i=t.index_.toString()),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jh extends zA{constructor(e,n,r,i){super(),this.repoInfo_=e,this.onDataUpdate_=n,this.authTokenProvider_=r,this.appCheckTokenProvider_=i,this.log_=uu("p:rest:"),this.listens_={}}reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,n){return n!==void 0?"tag$"+n:($(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}listen(e,n,r,i){const s=e._path.toString();this.log_("Listen called for "+s+" "+e._queryIdentifier);const o=Jh.getListenId_(e,r),a={};this.listens_[o]=a;const c=OI(e._queryParams);this.restRequest_(s+".json",c,(l,u)=>{let h=u;if(l===404&&(h=null,l=null),l===null&&this.onDataUpdate_(s,h,!1,r),Hs(this.listens_,o)===a){let d;l?l===401?d="permission_denied":d="rest_error:"+l:d="ok",i(d,null)}})}unlisten(e,n){const r=Jh.getListenId_(e,n);delete this.listens_[r]}get(e){const n=OI(e._queryParams),r=e._path.toString(),i=new pt;return this.restRequest_(r+".json",n,(s,o)=>{let a=o;s===404&&(a=null,s=null),s===null?(this.onDataUpdate_(r,a,!1,null),i.resolve(a)):i.reject(new Error(a))}),i.promise}refreshAuthToken(e){}restRequest_(e,n={},r){return n.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([i,s])=>{i&&i.accessToken&&(n.auth=i.accessToken),s&&s.token&&(n.ac=s.token);const o=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+wo(n);this.log_("Sending REST request for "+o);const a=new XMLHttpRequest;a.onreadystatechange=()=>{if(r&&a.readyState===4){this.log_("REST Response for "+o+" received. status:",a.status,"response:",a.responseText);let c=null;if(a.status>=200&&a.status<300){try{c=dl(a.responseText)}catch{Yt("Failed to parse JSON response for "+o+": "+a.responseText)}r(null,c)}else a.status!==401&&a.status!==404&&Yt("Got unsuccessful REST response for "+o+" Status: "+a.status),r(a.status);r=null}},a.open("GET",o,!0),a.send()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bK{constructor(){this.rootNode_=re.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,n){this.rootNode_=this.rootNode_.updateChild(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xh(){return{value:null,children:new Map}}function Ka(t,e,n){if(_e(e))t.value=n,t.children.clear();else if(t.value!==null)t.value=t.value.updateChild(e,n);else{const r=me(e);t.children.has(r)||t.children.set(r,Xh());const i=t.children.get(r);e=Ue(e),Ka(i,e,n)}}function lm(t,e){if(_e(e))return t.value=null,t.children.clear(),!0;if(t.value!==null){if(t.value.isLeafNode())return!1;{const n=t.value;return t.value=null,n.forEachChild(qe,(r,i)=>{Ka(t,new Re(r),i)}),lm(t,e)}}else if(t.children.size>0){const n=me(e);return e=Ue(e),t.children.has(n)&&lm(t.children.get(n),e)&&t.children.delete(n),t.children.size===0}else return!0}function um(t,e,n){t.value!==null?n(e,t.value):IK(t,(r,i)=>{const s=new Re(e.toString()+"/"+r);um(i,s,n)})}function IK(t,e){t.children.forEach((n,r)=>{e(r,n)})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EK{constructor(e){this.collection_=e,this.last_=null}get(){const e=this.collection_.get(),n=Object.assign({},e);return this.last_&&Pt(this.last_,(r,i)=>{n[r]=n[r]-i}),this.last_=e,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MI=10*1e3,TK=30*1e3,SK=5*60*1e3;class CK{constructor(e,n){this.server_=n,this.statsToReport_={},this.statsListener_=new EK(e);const r=MI+(TK-MI)*Math.random();$c(this.reportStats_.bind(this),Math.floor(r))}reportStats_(){const e=this.statsListener_.get(),n={};let r=!1;Pt(e,(i,s)=>{s>0&&Dn(this.statsToReport_,i)&&(n[i]=s,r=!0)}),r&&this.server_.reportStats(n),$c(this.reportStats_.bind(this),Math.floor(Math.random()*2*SK))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var rr;(function(t){t[t.OVERWRITE=0]="OVERWRITE",t[t.MERGE=1]="MERGE",t[t.ACK_USER_WRITE=2]="ACK_USER_WRITE",t[t.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"})(rr||(rr={}));function wy(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function by(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function Iy(t){return{fromUser:!1,fromServer:!0,queryId:t,tagged:!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zh{constructor(e,n,r){this.path=e,this.affectedTree=n,this.revert=r,this.type=rr.ACK_USER_WRITE,this.source=wy()}operationForChild(e){if(_e(this.path)){if(this.affectedTree.value!=null)return $(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const n=this.affectedTree.subtree(new Re(e));return new Zh(Ae(),n,this.revert)}}else return $(me(this.path)===e,"operationForChild called for unrelated child."),new Zh(Ue(this.path),this.affectedTree,this.revert)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kl{constructor(e,n){this.source=e,this.path=n,this.type=rr.LISTEN_COMPLETE}operationForChild(e){return _e(this.path)?new kl(this.source,Ae()):new kl(this.source,Ue(this.path))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xs{constructor(e,n,r){this.source=e,this.path=n,this.snap=r,this.type=rr.OVERWRITE}operationForChild(e){return _e(this.path)?new Xs(this.source,Ae(),this.snap.getImmediateChild(e)):new Xs(this.source,Ue(this.path),this.snap)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wa{constructor(e,n,r){this.source=e,this.path=n,this.children=r,this.type=rr.MERGE}operationForChild(e){if(_e(this.path)){const n=this.children.subtree(new Re(e));return n.isEmpty()?null:n.value?new Xs(this.source,Ae(),n.value):new wa(this.source,Ae(),n)}else return $(me(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new wa(this.source,Ue(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zi{constructor(e,n,r){this.node_=e,this.fullyInitialized_=n,this.filtered_=r}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(_e(e))return this.isFullyInitialized()&&!this.filtered_;const n=me(e);return this.isCompleteForChild(n)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AK{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}}function kK(t,e,n,r){const i=[],s=[];return e.forEach(o=>{o.type==="child_changed"&&t.index_.indexedValueChanged(o.oldSnap,o.snapshotNode)&&s.push(pK(o.childName,o.snapshotNode))}),pc(t,i,"child_removed",e,r,n),pc(t,i,"child_added",e,r,n),pc(t,i,"child_moved",s,r,n),pc(t,i,"child_changed",e,r,n),pc(t,i,"value",e,r,n),i}function pc(t,e,n,r,i,s){const o=r.filter(a=>a.type===n);o.sort((a,c)=>NK(t,a,c)),o.forEach(a=>{const c=RK(t,a,s);i.forEach(l=>{l.respondsTo(a.type)&&e.push(l.createEvent(c,t.query_))})})}function RK(t,e,n){return e.type==="value"||e.type==="child_removed"||(e.prevName=n.getPredecessorChildName(e.childName,e.snapshotNode,t.index_)),e}function NK(t,e,n){if(e.childName==null||n.childName==null)throw Ua("Should only compare child_ events.");const r=new ye(e.childName,e.snapshotNode),i=new ye(n.childName,n.snapshotNode);return t.index_.compare(r,i)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _f(t,e){return{eventCache:t,serverCache:e}}function Bc(t,e,n,r){return _f(new zi(e,n,r),t.serverCache)}function ok(t,e,n,r){return _f(t.eventCache,new zi(e,n,r))}function ed(t){return t.eventCache.isFullyInitialized()?t.eventCache.getNode():null}function Zs(t){return t.serverCache.isFullyInitialized()?t.serverCache.getNode():null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Bp;const PK=()=>(Bp||(Bp=new _n(pW)),Bp);class Be{constructor(e,n=PK()){this.value=e,this.children=n}static fromObject(e){let n=new Be(null);return Pt(e,(r,i)=>{n=n.set(new Re(r),i)}),n}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,n){if(this.value!=null&&n(this.value))return{path:Ae(),value:this.value};if(_e(e))return null;{const r=me(e),i=this.children.get(r);if(i!==null){const s=i.findRootMostMatchingPathAndValue(Ue(e),n);return s!=null?{path:Ye(new Re(r),s.path),value:s.value}:null}else return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(_e(e))return this;{const n=me(e),r=this.children.get(n);return r!==null?r.subtree(Ue(e)):new Be(null)}}set(e,n){if(_e(e))return new Be(n,this.children);{const r=me(e),s=(this.children.get(r)||new Be(null)).set(Ue(e),n),o=this.children.insert(r,s);return new Be(this.value,o)}}remove(e){if(_e(e))return this.children.isEmpty()?new Be(null):new Be(null,this.children);{const n=me(e),r=this.children.get(n);if(r){const i=r.remove(Ue(e));let s;return i.isEmpty()?s=this.children.remove(n):s=this.children.insert(n,i),this.value===null&&s.isEmpty()?new Be(null):new Be(this.value,s)}else return this}}get(e){if(_e(e))return this.value;{const n=me(e),r=this.children.get(n);return r?r.get(Ue(e)):null}}setTree(e,n){if(_e(e))return n;{const r=me(e),s=(this.children.get(r)||new Be(null)).setTree(Ue(e),n);let o;return s.isEmpty()?o=this.children.remove(r):o=this.children.insert(r,s),new Be(this.value,o)}}fold(e){return this.fold_(Ae(),e)}fold_(e,n){const r={};return this.children.inorderTraversal((i,s)=>{r[i]=s.fold_(Ye(e,i),n)}),n(e,this.value,r)}findOnPath(e,n){return this.findOnPath_(e,Ae(),n)}findOnPath_(e,n,r){const i=this.value?r(n,this.value):!1;if(i)return i;if(_e(e))return null;{const s=me(e),o=this.children.get(s);return o?o.findOnPath_(Ue(e),Ye(n,s),r):null}}foreachOnPath(e,n){return this.foreachOnPath_(e,Ae(),n)}foreachOnPath_(e,n,r){if(_e(e))return this;{this.value&&r(n,this.value);const i=me(e),s=this.children.get(i);return s?s.foreachOnPath_(Ue(e),Ye(n,i),r):new Be(null)}}foreach(e){this.foreach_(Ae(),e)}foreach_(e,n){this.children.inorderTraversal((r,i)=>{i.foreach_(Ye(e,r),n)}),this.value&&n(e,this.value)}foreachChild(e){this.children.inorderTraversal((n,r)=>{r.value&&e(n,r.value)})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cr{constructor(e){this.writeTree_=e}static empty(){return new cr(new Be(null))}}function jc(t,e,n){if(_e(e))return new cr(new Be(n));{const r=t.writeTree_.findRootMostValueAndPath(e);if(r!=null){const i=r.path;let s=r.value;const o=cn(i,e);return s=s.updateChild(o,n),new cr(t.writeTree_.set(i,s))}else{const i=new Be(n),s=t.writeTree_.setTree(e,i);return new cr(s)}}}function hm(t,e,n){let r=t;return Pt(n,(i,s)=>{r=jc(r,Ye(e,i),s)}),r}function LI(t,e){if(_e(e))return cr.empty();{const n=t.writeTree_.setTree(e,new Be(null));return new cr(n)}}function dm(t,e){return To(t,e)!=null}function To(t,e){const n=t.writeTree_.findRootMostValueAndPath(e);return n!=null?t.writeTree_.get(n.path).getChild(cn(n.path,e)):null}function FI(t){const e=[],n=t.writeTree_.value;return n!=null?n.isLeafNode()||n.forEachChild(qe,(r,i)=>{e.push(new ye(r,i))}):t.writeTree_.children.inorderTraversal((r,i)=>{i.value!=null&&e.push(new ye(r,i.value))}),e}function Fi(t,e){if(_e(e))return t;{const n=To(t,e);return n!=null?new cr(new Be(n)):new cr(t.writeTree_.subtree(e))}}function fm(t){return t.writeTree_.isEmpty()}function ba(t,e){return ak(Ae(),t.writeTree_,e)}function ak(t,e,n){if(e.value!=null)return n.updateChild(t,e.value);{let r=null;return e.children.inorderTraversal((i,s)=>{i===".priority"?($(s.value!==null,"Priority writes must always be leaf nodes"),r=s.value):n=ak(Ye(t,i),s,n)}),!n.getChild(t).isEmpty()&&r!==null&&(n=n.updateChild(Ye(t,".priority"),r)),n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yf(t,e){return hk(e,t)}function DK(t,e,n,r,i){$(r>t.lastWriteId,"Stacking an older write on top of newer ones"),i===void 0&&(i=!0),t.allWrites.push({path:e,snap:n,writeId:r,visible:i}),i&&(t.visibleWrites=jc(t.visibleWrites,e,n)),t.lastWriteId=r}function OK(t,e,n,r){$(r>t.lastWriteId,"Stacking an older merge on top of newer ones"),t.allWrites.push({path:e,children:n,writeId:r,visible:!0}),t.visibleWrites=hm(t.visibleWrites,e,n),t.lastWriteId=r}function xK(t,e){for(let n=0;n<t.allWrites.length;n++){const r=t.allWrites[n];if(r.writeId===e)return r}return null}function MK(t,e){const n=t.allWrites.findIndex(a=>a.writeId===e);$(n>=0,"removeWrite called with nonexistent writeId.");const r=t.allWrites[n];t.allWrites.splice(n,1);let i=r.visible,s=!1,o=t.allWrites.length-1;for(;i&&o>=0;){const a=t.allWrites[o];a.visible&&(o>=n&&LK(a,r.path)?i=!1:Vn(r.path,a.path)&&(s=!0)),o--}if(i){if(s)return FK(t),!0;if(r.snap)t.visibleWrites=LI(t.visibleWrites,r.path);else{const a=r.children;Pt(a,c=>{t.visibleWrites=LI(t.visibleWrites,Ye(r.path,c))})}return!0}else return!1}function LK(t,e){if(t.snap)return Vn(t.path,e);for(const n in t.children)if(t.children.hasOwnProperty(n)&&Vn(Ye(t.path,n),e))return!0;return!1}function FK(t){t.visibleWrites=ck(t.allWrites,UK,Ae()),t.allWrites.length>0?t.lastWriteId=t.allWrites[t.allWrites.length-1].writeId:t.lastWriteId=-1}function UK(t){return t.visible}function ck(t,e,n){let r=cr.empty();for(let i=0;i<t.length;++i){const s=t[i];if(e(s)){const o=s.path;let a;if(s.snap)Vn(n,o)?(a=cn(n,o),r=jc(r,a,s.snap)):Vn(o,n)&&(a=cn(o,n),r=jc(r,Ae(),s.snap.getChild(a)));else if(s.children){if(Vn(n,o))a=cn(n,o),r=hm(r,a,s.children);else if(Vn(o,n))if(a=cn(o,n),_e(a))r=hm(r,Ae(),s.children);else{const c=Hs(s.children,me(a));if(c){const l=c.getChild(Ue(a));r=jc(r,Ae(),l)}}}else throw Ua("WriteRecord should have .snap or .children")}}return r}function lk(t,e,n,r,i){if(!r&&!i){const s=To(t.visibleWrites,e);if(s!=null)return s;{const o=Fi(t.visibleWrites,e);if(fm(o))return n;if(n==null&&!dm(o,Ae()))return null;{const a=n||re.EMPTY_NODE;return ba(o,a)}}}else{const s=Fi(t.visibleWrites,e);if(!i&&fm(s))return n;if(!i&&n==null&&!dm(s,Ae()))return null;{const o=function(l){return(l.visible||i)&&(!r||!~r.indexOf(l.writeId))&&(Vn(l.path,e)||Vn(e,l.path))},a=ck(t.allWrites,o,e),c=n||re.EMPTY_NODE;return ba(a,c)}}}function VK(t,e,n){let r=re.EMPTY_NODE;const i=To(t.visibleWrites,e);if(i)return i.isLeafNode()||i.forEachChild(qe,(s,o)=>{r=r.updateImmediateChild(s,o)}),r;if(n){const s=Fi(t.visibleWrites,e);return n.forEachChild(qe,(o,a)=>{const c=ba(Fi(s,new Re(o)),a);r=r.updateImmediateChild(o,c)}),FI(s).forEach(o=>{r=r.updateImmediateChild(o.name,o.node)}),r}else{const s=Fi(t.visibleWrites,e);return FI(s).forEach(o=>{r=r.updateImmediateChild(o.name,o.node)}),r}}function $K(t,e,n,r,i){$(r||i,"Either existingEventSnap or existingServerSnap must exist");const s=Ye(e,n);if(dm(t.visibleWrites,s))return null;{const o=Fi(t.visibleWrites,s);return fm(o)?i.getChild(n):ba(o,i.getChild(n))}}function BK(t,e,n,r){const i=Ye(e,n),s=To(t.visibleWrites,i);if(s!=null)return s;if(r.isCompleteForChild(n)){const o=Fi(t.visibleWrites,i);return ba(o,r.getNode().getImmediateChild(n))}else return null}function jK(t,e){return To(t.visibleWrites,e)}function qK(t,e,n,r,i,s,o){let a;const c=Fi(t.visibleWrites,e),l=To(c,Ae());if(l!=null)a=l;else if(n!=null)a=ba(c,n);else return[];if(a=a.withIndex(o),!a.isEmpty()&&!a.isLeafNode()){const u=[],h=o.getCompare(),d=s?a.getReverseIteratorFrom(r,o):a.getIteratorFrom(r,o);let f=d.getNext();for(;f&&u.length<i;)h(f,r)!==0&&u.push(f),f=d.getNext();return u}else return[]}function WK(){return{visibleWrites:cr.empty(),allWrites:[],lastWriteId:-1}}function td(t,e,n,r){return lk(t.writeTree,t.treePath,e,n,r)}function Ey(t,e){return VK(t.writeTree,t.treePath,e)}function UI(t,e,n,r){return $K(t.writeTree,t.treePath,e,n,r)}function nd(t,e){return jK(t.writeTree,Ye(t.treePath,e))}function KK(t,e,n,r,i,s){return qK(t.writeTree,t.treePath,e,n,r,i,s)}function Ty(t,e,n){return BK(t.writeTree,t.treePath,e,n)}function uk(t,e){return hk(Ye(t.treePath,e),t.writeTree)}function hk(t,e){return{treePath:t,writeTree:e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HK{constructor(){this.changeMap=new Map}trackChildChange(e){const n=e.type,r=e.childName;$(n==="child_added"||n==="child_changed"||n==="child_removed","Only child changes supported for tracking"),$(r!==".priority","Only non-priority child changes can be tracked.");const i=this.changeMap.get(r);if(i){const s=i.type;if(n==="child_added"&&s==="child_removed")this.changeMap.set(r,Cl(r,e.snapshotNode,i.snapshotNode));else if(n==="child_removed"&&s==="child_added")this.changeMap.delete(r);else if(n==="child_removed"&&s==="child_changed")this.changeMap.set(r,Sl(r,i.oldSnap));else if(n==="child_changed"&&s==="child_added")this.changeMap.set(r,va(r,e.snapshotNode));else if(n==="child_changed"&&s==="child_changed")this.changeMap.set(r,Cl(r,e.snapshotNode,i.oldSnap));else throw Ua("Illegal combination of changes: "+e+" occurred after "+i)}else this.changeMap.set(r,e)}getChanges(){return Array.from(this.changeMap.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GK{getCompleteChild(e){return null}getChildAfterChild(e,n,r){return null}}const dk=new GK;class Sy{constructor(e,n,r=null){this.writes_=e,this.viewCache_=n,this.optCompleteServerCache_=r}getCompleteChild(e){const n=this.viewCache_.eventCache;if(n.isCompleteForChild(e))return n.getNode().getImmediateChild(e);{const r=this.optCompleteServerCache_!=null?new zi(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return Ty(this.writes_,e,r)}}getChildAfterChild(e,n,r){const i=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:Zs(this.viewCache_),s=KK(this.writes_,i,n,1,r,e);return s.length===0?null:s[0]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zK(t){return{filter:t}}function QK(t,e){$(e.eventCache.getNode().isIndexed(t.filter.getIndex()),"Event snap not indexed"),$(e.serverCache.getNode().isIndexed(t.filter.getIndex()),"Server snap not indexed")}function YK(t,e,n,r,i){const s=new HK;let o,a;if(n.type===rr.OVERWRITE){const l=n;l.source.fromUser?o=pm(t,e,l.path,l.snap,r,i,s):($(l.source.fromServer,"Unknown source."),a=l.source.tagged||e.serverCache.isFiltered()&&!_e(l.path),o=rd(t,e,l.path,l.snap,r,i,a,s))}else if(n.type===rr.MERGE){const l=n;l.source.fromUser?o=XK(t,e,l.path,l.children,r,i,s):($(l.source.fromServer,"Unknown source."),a=l.source.tagged||e.serverCache.isFiltered(),o=gm(t,e,l.path,l.children,r,i,a,s))}else if(n.type===rr.ACK_USER_WRITE){const l=n;l.revert?o=tH(t,e,l.path,r,i,s):o=ZK(t,e,l.path,l.affectedTree,r,i,s)}else if(n.type===rr.LISTEN_COMPLETE)o=eH(t,e,n.path,r,s);else throw Ua("Unknown operation type: "+n.type);const c=s.getChanges();return JK(e,o,c),{viewCache:o,changes:c}}function JK(t,e,n){const r=e.eventCache;if(r.isFullyInitialized()){const i=r.getNode().isLeafNode()||r.getNode().isEmpty(),s=ed(t);(n.length>0||!t.eventCache.isFullyInitialized()||i&&!r.getNode().equals(s)||!r.getNode().getPriority().equals(s.getPriority()))&&n.push(sk(ed(e)))}}function fk(t,e,n,r,i,s){const o=e.eventCache;if(nd(r,n)!=null)return e;{let a,c;if(_e(n))if($(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){const l=Zs(e),u=l instanceof re?l:re.EMPTY_NODE,h=Ey(r,u);a=t.filter.updateFullNode(e.eventCache.getNode(),h,s)}else{const l=td(r,Zs(e));a=t.filter.updateFullNode(e.eventCache.getNode(),l,s)}else{const l=me(n);if(l===".priority"){$(Gi(n)===1,"Can't have a priority with additional path components");const u=o.getNode();c=e.serverCache.getNode();const h=UI(r,n,u,c);h!=null?a=t.filter.updatePriority(u,h):a=o.getNode()}else{const u=Ue(n);let h;if(o.isCompleteForChild(l)){c=e.serverCache.getNode();const d=UI(r,n,o.getNode(),c);d!=null?h=o.getNode().getImmediateChild(l).updateChild(u,d):h=o.getNode().getImmediateChild(l)}else h=Ty(r,l,e.serverCache);h!=null?a=t.filter.updateChild(o.getNode(),l,h,u,i,s):a=o.getNode()}}return Bc(e,a,o.isFullyInitialized()||_e(n),t.filter.filtersNodes())}}function rd(t,e,n,r,i,s,o,a){const c=e.serverCache;let l;const u=o?t.filter:t.filter.getIndexedFilter();if(_e(n))l=u.updateFullNode(c.getNode(),r,null);else if(u.filtersNodes()&&!c.isFiltered()){const f=c.getNode().updateChild(n,r);l=u.updateFullNode(c.getNode(),f,null)}else{const f=me(n);if(!c.isCompleteForPath(n)&&Gi(n)>1)return e;const g=Ue(n),I=c.getNode().getImmediateChild(f).updateChild(g,r);f===".priority"?l=u.updatePriority(c.getNode(),I):l=u.updateChild(c.getNode(),f,I,g,dk,null)}const h=ok(e,l,c.isFullyInitialized()||_e(n),u.filtersNodes()),d=new Sy(i,h,s);return fk(t,h,n,i,d,a)}function pm(t,e,n,r,i,s,o){const a=e.eventCache;let c,l;const u=new Sy(i,e,s);if(_e(n))l=t.filter.updateFullNode(e.eventCache.getNode(),r,o),c=Bc(e,l,!0,t.filter.filtersNodes());else{const h=me(n);if(h===".priority")l=t.filter.updatePriority(e.eventCache.getNode(),r),c=Bc(e,l,a.isFullyInitialized(),a.isFiltered());else{const d=Ue(n),f=a.getNode().getImmediateChild(h);let g;if(_e(d))g=r;else{const v=u.getCompleteChild(h);v!=null?fy(d)===".priority"&&v.getChild(YA(d)).isEmpty()?g=v:g=v.updateChild(d,r):g=re.EMPTY_NODE}if(f.equals(g))c=e;else{const v=t.filter.updateChild(a.getNode(),h,g,d,u,o);c=Bc(e,v,a.isFullyInitialized(),t.filter.filtersNodes())}}}return c}function VI(t,e){return t.eventCache.isCompleteForChild(e)}function XK(t,e,n,r,i,s,o){let a=e;return r.foreach((c,l)=>{const u=Ye(n,c);VI(e,me(u))&&(a=pm(t,a,u,l,i,s,o))}),r.foreach((c,l)=>{const u=Ye(n,c);VI(e,me(u))||(a=pm(t,a,u,l,i,s,o))}),a}function $I(t,e,n){return n.foreach((r,i)=>{e=e.updateChild(r,i)}),e}function gm(t,e,n,r,i,s,o,a){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let c=e,l;_e(n)?l=r:l=new Be(null).setTree(n,r);const u=e.serverCache.getNode();return l.children.inorderTraversal((h,d)=>{if(u.hasChild(h)){const f=e.serverCache.getNode().getImmediateChild(h),g=$I(t,f,d);c=rd(t,c,new Re(h),g,i,s,o,a)}}),l.children.inorderTraversal((h,d)=>{const f=!e.serverCache.isCompleteForChild(h)&&d.value===void 0;if(!u.hasChild(h)&&!f){const g=e.serverCache.getNode().getImmediateChild(h),v=$I(t,g,d);c=rd(t,c,new Re(h),v,i,s,o,a)}}),c}function ZK(t,e,n,r,i,s,o){if(nd(i,n)!=null)return e;const a=e.serverCache.isFiltered(),c=e.serverCache;if(r.value!=null){if(_e(n)&&c.isFullyInitialized()||c.isCompleteForPath(n))return rd(t,e,n,c.getNode().getChild(n),i,s,a,o);if(_e(n)){let l=new Be(null);return c.getNode().forEachChild(Ar,(u,h)=>{l=l.set(new Re(u),h)}),gm(t,e,n,l,i,s,a,o)}else return e}else{let l=new Be(null);return r.foreach((u,h)=>{const d=Ye(n,u);c.isCompleteForPath(d)&&(l=l.set(u,c.getNode().getChild(d)))}),gm(t,e,n,l,i,s,a,o)}}function eH(t,e,n,r,i){const s=e.serverCache,o=ok(e,s.getNode(),s.isFullyInitialized()||_e(n),s.isFiltered());return fk(t,o,n,r,dk,i)}function tH(t,e,n,r,i,s){let o;if(nd(r,n)!=null)return e;{const a=new Sy(r,e,i),c=e.eventCache.getNode();let l;if(_e(n)||me(n)===".priority"){let u;if(e.serverCache.isFullyInitialized())u=td(r,Zs(e));else{const h=e.serverCache.getNode();$(h instanceof re,"serverChildren would be complete if leaf node"),u=Ey(r,h)}u=u,l=t.filter.updateFullNode(c,u,s)}else{const u=me(n);let h=Ty(r,u,e.serverCache);h==null&&e.serverCache.isCompleteForChild(u)&&(h=c.getImmediateChild(u)),h!=null?l=t.filter.updateChild(c,u,h,Ue(n),a,s):e.eventCache.getNode().hasChild(u)?l=t.filter.updateChild(c,u,re.EMPTY_NODE,Ue(n),a,s):l=c,l.isEmpty()&&e.serverCache.isFullyInitialized()&&(o=td(r,Zs(e)),o.isLeafNode()&&(l=t.filter.updateFullNode(l,o,s)))}return o=e.serverCache.isFullyInitialized()||nd(r,Ae())!=null,Bc(e,l,o,t.filter.filtersNodes())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nH{constructor(e,n){this.query_=e,this.eventRegistrations_=[];const r=this.query_._queryParams,i=new vy(r.getIndex()),s=mK(r);this.processor_=zK(s);const o=n.serverCache,a=n.eventCache,c=i.updateFullNode(re.EMPTY_NODE,o.getNode(),null),l=s.updateFullNode(re.EMPTY_NODE,a.getNode(),null),u=new zi(c,o.isFullyInitialized(),i.filtersNodes()),h=new zi(l,a.isFullyInitialized(),s.filtersNodes());this.viewCache_=_f(h,u),this.eventGenerator_=new AK(this.query_)}get query(){return this.query_}}function rH(t){return t.viewCache_.serverCache.getNode()}function iH(t){return ed(t.viewCache_)}function sH(t,e){const n=Zs(t.viewCache_);return n&&(t.query._queryParams.loadsAllData()||!_e(e)&&!n.getImmediateChild(me(e)).isEmpty())?n.getChild(e):null}function BI(t){return t.eventRegistrations_.length===0}function oH(t,e){t.eventRegistrations_.push(e)}function jI(t,e,n){const r=[];if(n){$(e==null,"A cancel should cancel all event registrations.");const i=t.query._path;t.eventRegistrations_.forEach(s=>{const o=s.createCancelEvent(n,i);o&&r.push(o)})}if(e){let i=[];for(let s=0;s<t.eventRegistrations_.length;++s){const o=t.eventRegistrations_[s];if(!o.matches(e))i.push(o);else if(e.hasAnyCallback()){i=i.concat(t.eventRegistrations_.slice(s+1));break}}t.eventRegistrations_=i}else t.eventRegistrations_=[];return r}function qI(t,e,n,r){e.type===rr.MERGE&&e.source.queryId!==null&&($(Zs(t.viewCache_),"We should always have a full cache before handling merges"),$(ed(t.viewCache_),"Missing event cache, even though we have a server cache"));const i=t.viewCache_,s=YK(t.processor_,i,e,n,r);return QK(t.processor_,s.viewCache),$(s.viewCache.serverCache.isFullyInitialized()||!i.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),t.viewCache_=s.viewCache,pk(t,s.changes,s.viewCache.eventCache.getNode(),null)}function aH(t,e){const n=t.viewCache_.eventCache,r=[];return n.getNode().isLeafNode()||n.getNode().forEachChild(qe,(s,o)=>{r.push(va(s,o))}),n.isFullyInitialized()&&r.push(sk(n.getNode())),pk(t,r,n.getNode(),e)}function pk(t,e,n,r){const i=r?[r]:t.eventRegistrations_;return kK(t.eventGenerator_,e,n,i)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let id;class gk{constructor(){this.views=new Map}}function cH(t){$(!id,"__referenceConstructor has already been defined"),id=t}function lH(){return $(id,"Reference.ts has not been loaded"),id}function uH(t){return t.views.size===0}function Cy(t,e,n,r){const i=e.source.queryId;if(i!==null){const s=t.views.get(i);return $(s!=null,"SyncTree gave us an op for an invalid query."),qI(s,e,n,r)}else{let s=[];for(const o of t.views.values())s=s.concat(qI(o,e,n,r));return s}}function Ay(t,e,n,r,i){const s=e._queryIdentifier,o=t.views.get(s);if(!o){let a=td(n,i?r:null),c=!1;a?c=!0:r instanceof re?(a=Ey(n,r),c=!1):(a=re.EMPTY_NODE,c=!1);const l=_f(new zi(a,c,!1),new zi(r,i,!1));return new nH(e,l)}return o}function hH(t,e,n,r,i,s){const o=Ay(t,e,r,i,s);return t.views.has(e._queryIdentifier)||t.views.set(e._queryIdentifier,o),oH(o,n),aH(o,n)}function dH(t,e,n,r){const i=e._queryIdentifier,s=[];let o=[];const a=Qi(t);if(i==="default")for(const[c,l]of t.views.entries())o=o.concat(jI(l,n,r)),BI(l)&&(t.views.delete(c),l.query._queryParams.loadsAllData()||s.push(l.query));else{const c=t.views.get(i);c&&(o=o.concat(jI(c,n,r)),BI(c)&&(t.views.delete(i),c.query._queryParams.loadsAllData()||s.push(c.query)))}return a&&!Qi(t)&&s.push(new(lH())(e._repo,e._path)),{removed:s,events:o}}function mk(t){const e=[];for(const n of t.views.values())n.query._queryParams.loadsAllData()||e.push(n);return e}function Ui(t,e){let n=null;for(const r of t.views.values())n=n||sH(r,e);return n}function _k(t,e){if(e._queryParams.loadsAllData())return vf(t);{const r=e._queryIdentifier;return t.views.get(r)}}function yk(t,e){return _k(t,e)!=null}function Qi(t){return vf(t)!=null}function vf(t){for(const e of t.views.values())if(e.query._queryParams.loadsAllData())return e;return null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let sd;function fH(t){$(!sd,"__referenceConstructor has already been defined"),sd=t}function pH(){return $(sd,"Reference.ts has not been loaded"),sd}let gH=1;class WI{constructor(e){this.listenProvider_=e,this.syncPointTree_=new Be(null),this.pendingWriteTree_=WK(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function ky(t,e,n,r,i){return DK(t.pendingWriteTree_,e,n,r,i),i?Ha(t,new Xs(wy(),e,n)):[]}function mH(t,e,n,r){OK(t.pendingWriteTree_,e,n,r);const i=Be.fromObject(n);return Ha(t,new wa(wy(),e,i))}function Di(t,e,n=!1){const r=xK(t.pendingWriteTree_,e);if(MK(t.pendingWriteTree_,e)){let s=new Be(null);return r.snap!=null?s=s.set(Ae(),!0):Pt(r.children,o=>{s=s.set(new Re(o),!0)}),Ha(t,new Zh(r.path,s,n))}else return[]}function du(t,e,n){return Ha(t,new Xs(by(),e,n))}function _H(t,e,n){const r=Be.fromObject(n);return Ha(t,new wa(by(),e,r))}function yH(t,e){return Ha(t,new kl(by(),e))}function vH(t,e,n){const r=Ry(t,n);if(r){const i=Ny(r),s=i.path,o=i.queryId,a=cn(s,e),c=new kl(Iy(o),a);return Py(t,s,c)}else return[]}function od(t,e,n,r){const i=e._path,s=t.syncPointTree_.get(i);let o=[];if(s&&(e._queryIdentifier==="default"||yk(s,e))){const a=dH(s,e,n,r);uH(s)&&(t.syncPointTree_=t.syncPointTree_.remove(i));const c=a.removed;o=a.events;const l=c.findIndex(h=>h._queryParams.loadsAllData())!==-1,u=t.syncPointTree_.findOnPath(i,(h,d)=>Qi(d));if(l&&!u){const h=t.syncPointTree_.subtree(i);if(!h.isEmpty()){const d=EH(h);for(let f=0;f<d.length;++f){const g=d[f],v=g.query,I=Ek(t,g);t.listenProvider_.startListening(qc(v),Rl(t,v),I.hashFn,I.onComplete)}}}!u&&c.length>0&&!r&&(l?t.listenProvider_.stopListening(qc(e),null):c.forEach(h=>{const d=t.queryToTagMap.get(bf(h));t.listenProvider_.stopListening(qc(h),d)})),TH(t,c)}return o}function wH(t,e){const{syncPoint:n,serverCache:r,writesCache:i,serverCacheComplete:s}=wk(e,t),o=Ay(n,e,i,r,s);return n.views.has(e._queryIdentifier)||n.views.set(e._queryIdentifier,o),e._queryParams.loadsAllData()?null:Rl(t,e)}function vk(t,e,n,r){const i=Ry(t,r);if(i!=null){const s=Ny(i),o=s.path,a=s.queryId,c=cn(o,e),l=new Xs(Iy(a),c,n);return Py(t,o,l)}else return[]}function bH(t,e,n,r){const i=Ry(t,r);if(i){const s=Ny(i),o=s.path,a=s.queryId,c=cn(o,e),l=Be.fromObject(n),u=new wa(Iy(a),c,l);return Py(t,o,u)}else return[]}function wk(t,e){const n=t._path;let r=null,i=!1;e.syncPointTree_.foreachOnPath(n,(l,u)=>{const h=cn(l,n);r=r||Ui(u,h),i=i||Qi(u)});let s=e.syncPointTree_.get(n);s?(i=i||Qi(s),r=r||Ui(s,Ae())):(s=new gk,e.syncPointTree_=e.syncPointTree_.set(n,s));let o;r!=null?o=!0:(o=!1,r=re.EMPTY_NODE,e.syncPointTree_.subtree(n).foreachChild((u,h)=>{const d=Ui(h,Ae());d&&(r=r.updateImmediateChild(u,d))}));const a=yk(s,t);if(!a&&!t._queryParams.loadsAllData()){const l=bf(t);$(!e.queryToTagMap.has(l),"View does not exist, but we have a tag");const u=SH();e.queryToTagMap.set(l,u),e.tagToQueryMap.set(u,l)}const c=yf(e.pendingWriteTree_,n);return{syncPoint:s,writesCache:c,serverCache:r,serverCacheComplete:o,foundAncestorDefaultView:i,viewAlreadyExists:a}}function KI(t,e,n){const{syncPoint:r,serverCache:i,writesCache:s,serverCacheComplete:o,viewAlreadyExists:a,foundAncestorDefaultView:c}=wk(e,t);let l=hH(r,e,n,s,i,o);if(!a&&!c){const u=_k(r,e);l=l.concat(CH(t,e,u))}return l}function wf(t,e,n){const i=t.pendingWriteTree_,s=t.syncPointTree_.findOnPath(e,(o,a)=>{const c=cn(o,e),l=Ui(a,c);if(l)return l});return lk(i,e,s,n,!0)}function IH(t,e){const n=e._path;let r=null;t.syncPointTree_.foreachOnPath(n,(l,u)=>{const h=cn(l,n);r=r||Ui(u,h)});let i=t.syncPointTree_.get(n);i?r=r||Ui(i,Ae()):(i=new gk,t.syncPointTree_=t.syncPointTree_.set(n,i));const s=r!=null,o=s?new zi(r,!0,!1):null,a=yf(t.pendingWriteTree_,e._path),c=Ay(i,e,a,s?o.getNode():re.EMPTY_NODE,s);return iH(c)}function Ha(t,e){return bk(e,t.syncPointTree_,null,yf(t.pendingWriteTree_,Ae()))}function bk(t,e,n,r){if(_e(t.path))return Ik(t,e,n,r);{const i=e.get(Ae());n==null&&i!=null&&(n=Ui(i,Ae()));let s=[];const o=me(t.path),a=t.operationForChild(o),c=e.children.get(o);if(c&&a){const l=n?n.getImmediateChild(o):null,u=uk(r,o);s=s.concat(bk(a,c,l,u))}return i&&(s=s.concat(Cy(i,t,r,n))),s}}function Ik(t,e,n,r){const i=e.get(Ae());n==null&&i!=null&&(n=Ui(i,Ae()));let s=[];return e.children.inorderTraversal((o,a)=>{const c=n?n.getImmediateChild(o):null,l=uk(r,o),u=t.operationForChild(o);u&&(s=s.concat(Ik(u,a,c,l)))}),i&&(s=s.concat(Cy(i,t,r,n))),s}function Ek(t,e){const n=e.query,r=Rl(t,n);return{hashFn:()=>(rH(e)||re.EMPTY_NODE).hash(),onComplete:i=>{if(i==="ok")return r?vH(t,n._path,r):yH(t,n._path);{const s=_W(i,n);return od(t,n,null,s)}}}}function Rl(t,e){const n=bf(e);return t.queryToTagMap.get(n)}function bf(t){return t._path.toString()+"$"+t._queryIdentifier}function Ry(t,e){return t.tagToQueryMap.get(e)}function Ny(t){const e=t.indexOf("$");return $(e!==-1&&e<t.length-1,"Bad queryKey."),{queryId:t.substr(e+1),path:new Re(t.substr(0,e))}}function Py(t,e,n){const r=t.syncPointTree_.get(e);$(r,"Missing sync point for query tag that we're tracking");const i=yf(t.pendingWriteTree_,e);return Cy(r,n,i,null)}function EH(t){return t.fold((e,n,r)=>{if(n&&Qi(n))return[vf(n)];{let i=[];return n&&(i=mk(n)),Pt(r,(s,o)=>{i=i.concat(o)}),i}})}function qc(t){return t._queryParams.loadsAllData()&&!t._queryParams.isDefault()?new(pH())(t._repo,t._path):t}function TH(t,e){for(let n=0;n<e.length;++n){const r=e[n];if(!r._queryParams.loadsAllData()){const i=bf(r),s=t.queryToTagMap.get(i);t.queryToTagMap.delete(i),t.tagToQueryMap.delete(s)}}}function SH(){return gH++}function CH(t,e,n){const r=e._path,i=Rl(t,e),s=Ek(t,n),o=t.listenProvider_.startListening(qc(e),i,s.hashFn,s.onComplete),a=t.syncPointTree_.subtree(r);if(i)$(!Qi(a.value),"If we're adding a query, it shouldn't be shadowed");else{const c=a.fold((l,u,h)=>{if(!_e(l)&&u&&Qi(u))return[vf(u).query];{let d=[];return u&&(d=d.concat(mk(u).map(f=>f.query))),Pt(h,(f,g)=>{d=d.concat(g)}),d}});for(let l=0;l<c.length;++l){const u=c[l];t.listenProvider_.stopListening(qc(u),Rl(t,u))}}return o}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dy{constructor(e){this.node_=e}getImmediateChild(e){const n=this.node_.getImmediateChild(e);return new Dy(n)}node(){return this.node_}}class Oy{constructor(e,n){this.syncTree_=e,this.path_=n}getImmediateChild(e){const n=Ye(this.path_,e);return new Oy(this.syncTree_,n)}node(){return wf(this.syncTree_,this.path_)}}const AH=function(t){return t=t||{},t.timestamp=t.timestamp||new Date().getTime(),t},HI=function(t,e,n){if(!t||typeof t!="object")return t;if($(".sv"in t,"Unexpected leaf node or priority contents"),typeof t[".sv"]=="string")return kH(t[".sv"],e,n);if(typeof t[".sv"]=="object")return RH(t[".sv"],e);$(!1,"Unexpected server value: "+JSON.stringify(t,null,2))},kH=function(t,e,n){switch(t){case"timestamp":return n.timestamp;default:$(!1,"Unexpected server value: "+t)}},RH=function(t,e,n){t.hasOwnProperty("increment")||$(!1,"Unexpected server value: "+JSON.stringify(t,null,2));const r=t.increment;typeof r!="number"&&$(!1,"Unexpected increment value: "+r);const i=e.node();if($(i!==null&&typeof i!="undefined","Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return r;const o=i.getValue();return typeof o!="number"?r:o+r},Tk=function(t,e,n,r){return My(e,new Oy(n,t),r)},xy=function(t,e,n){return My(t,new Dy(e),n)};function My(t,e,n){const r=t.getPriority().val(),i=HI(r,e.getImmediateChild(".priority"),n);let s;if(t.isLeafNode()){const o=t,a=HI(o.getValue(),e,n);return a!==o.getValue()||i!==o.getPriority().val()?new yt(a,Xe(i)):t}else{const o=t;return s=o,i!==o.getPriority().val()&&(s=s.updatePriority(new yt(i))),o.forEachChild(qe,(a,c)=>{const l=My(c,e.getImmediateChild(a),n);l!==c&&(s=s.updateImmediateChild(a,l))}),s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ly{constructor(e="",n=null,r={children:{},childCount:0}){this.name=e,this.parent=n,this.node=r}}function If(t,e){let n=e instanceof Re?e:new Re(e),r=t,i=me(n);for(;i!==null;){const s=Hs(r.node.children,i)||{children:{},childCount:0};r=new Ly(i,r,s),n=Ue(n),i=me(n)}return r}function So(t){return t.node.value}function Fy(t,e){t.node.value=e,mm(t)}function Sk(t){return t.node.childCount>0}function NH(t){return So(t)===void 0&&!Sk(t)}function Ef(t,e){Pt(t.node.children,(n,r)=>{e(new Ly(n,t,r))})}function Ck(t,e,n,r){n&&!r&&e(t),Ef(t,i=>{Ck(i,e,!0,r)}),n&&r&&e(t)}function PH(t,e,n){let r=n?t:t.parent;for(;r!==null;){if(e(r))return!0;r=r.parent}return!1}function fu(t){return new Re(t.parent===null?t.name:fu(t.parent)+"/"+t.name)}function mm(t){t.parent!==null&&DH(t.parent,t.name,t)}function DH(t,e,n){const r=NH(n),i=Dn(t.node.children,e);r&&i?(delete t.node.children[e],t.node.childCount--,mm(t)):!r&&!i&&(t.node.children[e]=n.node,t.node.childCount++,mm(t))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OH=/[\[\].#$\/\u0000-\u001F\u007F]/,xH=/[\[\].#$\u0000-\u001F\u007F]/,jp=10*1024*1024,Tf=function(t){return typeof t=="string"&&t.length!==0&&!OH.test(t)},Ak=function(t){return typeof t=="string"&&t.length!==0&&!xH.test(t)},MH=function(t){return t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),Ak(t)},Nl=function(t){return t===null||typeof t=="string"||typeof t=="number"&&!ff(t)||t&&typeof t=="object"&&Dn(t,".sv")},Lr=function(t,e,n,r){r&&e===void 0||pu(wn(t,"value"),e,n)},pu=function(t,e,n){const r=n instanceof Re?new QW(n,t):n;if(e===void 0)throw new Error(t+"contains undefined "+bs(r));if(typeof e=="function")throw new Error(t+"contains a function "+bs(r)+" with contents = "+e.toString());if(ff(e))throw new Error(t+"contains "+e.toString()+" "+bs(r));if(typeof e=="string"&&e.length>jp/3&&Yd(e)>jp)throw new Error(t+"contains a string greater than "+jp+" utf8 bytes "+bs(r)+" ('"+e.substring(0,50)+"...')");if(e&&typeof e=="object"){let i=!1,s=!1;if(Pt(e,(o,a)=>{if(o===".value")i=!0;else if(o!==".priority"&&o!==".sv"&&(s=!0,!Tf(o)))throw new Error(t+" contains an invalid key ("+o+") "+bs(r)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);YW(r,o),pu(t,a,r),JW(r)}),i&&s)throw new Error(t+' contains ".value" child '+bs(r)+" in addition to actual children.")}},LH=function(t,e){let n,r;for(n=0;n<e.length;n++){r=e[n];const s=Tl(r);for(let o=0;o<s.length;o++)if(!(s[o]===".priority"&&o===s.length-1)){if(!Tf(s[o]))throw new Error(t+"contains an invalid key ("+s[o]+") in path "+r.toString()+`. Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`)}}e.sort(zW);let i=null;for(n=0;n<e.length;n++){if(r=e[n],i!==null&&Vn(i,r))throw new Error(t+"contains a path "+i.toString()+" that is ancestor of another path "+r.toString());i=r}},kk=function(t,e,n,r){if(r&&e===void 0)return;const i=wn(t,"values");if(!(e&&typeof e=="object")||Array.isArray(e))throw new Error(i+" must be an object containing the children to replace.");const s=[];Pt(e,(o,a)=>{const c=new Re(o);if(pu(i,a,Ye(n,c)),fy(c)===".priority"&&!Nl(a))throw new Error(i+"contains an invalid value for '"+c.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");s.push(c)}),LH(i,s)},Uy=function(t,e,n){if(!(n&&e===void 0)){if(ff(e))throw new Error(wn(t,"priority")+"is "+e.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!Nl(e))throw new Error(wn(t,"priority")+"must be a valid Firebase priority (a string, finite number, server value, or null).")}},gu=function(t,e,n,r){if(!(r&&n===void 0)&&!Tf(n))throw new Error(wn(t,e)+'was an invalid key = "'+n+`".  Firebase keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]").`)},Pl=function(t,e,n,r){if(!(r&&n===void 0)&&!Ak(n))throw new Error(wn(t,e)+'was an invalid path = "'+n+`". Paths must be non-empty strings and can't contain ".", "#", "$", "[", or "]"`)},FH=function(t,e,n,r){n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),Pl(t,e,n,r)},$n=function(t,e){if(me(e)===".info")throw new Error(t+" failed = Can't modify data under /.info/")},Rk=function(t,e){const n=e.path.toString();if(typeof e.repoInfo.host!="string"||e.repoInfo.host.length===0||!Tf(e.repoInfo.namespace)&&e.repoInfo.host.split(":")[0]!=="localhost"||n.length!==0&&!MH(n))throw new Error(wn(t,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UH{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function Sf(t,e){let n=null;for(let r=0;r<e.length;r++){const i=e[r],s=i.getPath();n!==null&&!py(s,n.path)&&(t.eventLists_.push(n),n=null),n===null&&(n={events:[],path:s}),n.events.push(i)}n&&t.eventLists_.push(n)}function Nk(t,e,n){Sf(t,n),Pk(t,r=>py(r,e))}function Gn(t,e,n){Sf(t,n),Pk(t,r=>Vn(r,e)||Vn(e,r))}function Pk(t,e){t.recursionDepth_++;let n=!0;for(let r=0;r<t.eventLists_.length;r++){const i=t.eventLists_[r];if(i){const s=i.path;e(s)?(VH(t.eventLists_[r]),t.eventLists_[r]=null):n=!1}}n&&(t.eventLists_=[]),t.recursionDepth_--}function VH(t){for(let e=0;e<t.events.length;e++){const n=t.events[e];if(n!==null){t.events[e]=null;const r=n.getEventRunner();Ws&&Et("event: "+n.toString()),Wa(r)}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dk="repo_interrupt",$H=25;class BH{constructor(e,n,r,i){this.repoInfo_=e,this.forceRestClient_=n,this.authTokenProvider_=r,this.appCheckProvider_=i,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new UH,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=Xh(),this.transactionQueueTree_=new Ly,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function jH(t,e,n){if(t.stats_=hy(t.repoInfo_),t.forceRestClient_||vW())t.server_=new Jh(t.repoInfo_,(r,i,s,o)=>{GI(t,r,i,s,o)},t.authTokenProvider_,t.appCheckProvider_),setTimeout(()=>zI(t,!0),0);else{if(typeof n!="undefined"&&n!==null){if(typeof n!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{gt(n)}catch(r){throw new Error("Invalid authOverride provided: "+r)}}t.persistentConnection_=new ti(t.repoInfo_,e,(r,i,s,o)=>{GI(t,r,i,s,o)},r=>{zI(t,r)},r=>{qH(t,r)},t.authTokenProvider_,t.appCheckProvider_,n),t.server_=t.persistentConnection_}t.authTokenProvider_.addTokenChangeListener(r=>{t.server_.refreshAuthToken(r)}),t.appCheckProvider_.addTokenChangeListener(r=>{t.server_.refreshAppCheckToken(r.token)}),t.statsReporter_=TW(t.repoInfo_,()=>new CK(t.stats_,t.server_)),t.infoData_=new bK,t.infoSyncTree_=new WI({startListening:(r,i,s,o)=>{let a=[];const c=t.infoData_.getNode(r._path);return c.isEmpty()||(a=du(t.infoSyncTree_,r._path,c),setTimeout(()=>{o("ok")},0)),a},stopListening:()=>{}}),Vy(t,"connected",!1),t.serverSyncTree_=new WI({startListening:(r,i,s,o)=>(t.server_.listen(r,s,i,(a,c)=>{const l=o(a,c);Gn(t.eventQueue_,r._path,l)}),[]),stopListening:(r,i)=>{t.server_.unlisten(r,i)}})}function Ok(t){const n=t.infoData_.getNode(new Re(".info/serverTimeOffset")).val()||0;return new Date().getTime()+n}function mu(t){return AH({timestamp:Ok(t)})}function GI(t,e,n,r,i){t.dataUpdateCount++;const s=new Re(e);n=t.interceptServerDataCallback_?t.interceptServerDataCallback_(e,n):n;let o=[];if(i)if(r){const c=Mh(n,l=>Xe(l));o=bH(t.serverSyncTree_,s,c,i)}else{const c=Xe(n);o=vk(t.serverSyncTree_,s,c,i)}else if(r){const c=Mh(n,l=>Xe(l));o=_H(t.serverSyncTree_,s,c)}else{const c=Xe(n);o=du(t.serverSyncTree_,s,c)}let a=s;o.length>0&&(a=Ia(t,s)),Gn(t.eventQueue_,a,o)}function zI(t,e){Vy(t,"connected",e),e===!1&&HH(t)}function qH(t,e){Pt(e,(n,r)=>{Vy(t,n,r)})}function Vy(t,e,n){const r=new Re("/.info/"+e),i=Xe(n);t.infoData_.updateSnapshot(r,i);const s=du(t.infoSyncTree_,r,i);Gn(t.eventQueue_,r,s)}function Cf(t){return t.nextWriteId_++}function WH(t,e){const n=IH(t.serverSyncTree_,e);return n!=null?Promise.resolve(n):t.server_.get(e).then(r=>{const i=Xe(r).withIndex(e._queryParams.getIndex());if(e._queryParams.loadsAllData())du(t.serverSyncTree_,e._path,i);else{const o=wH(t.serverSyncTree_,e);vk(t.serverSyncTree_,e._path,i,o)}return od(t.serverSyncTree_,e,null).length>0&&eo(t,"unexpected cancel events in repoGetValue"),i},r=>(eo(t,"get for query "+gt(e)+" failed: "+r),Promise.reject(new Error(r))))}function $y(t,e,n,r,i){eo(t,"set",{path:e.toString(),value:n,priority:r});const s=mu(t),o=Xe(n,r),a=wf(t.serverSyncTree_,e),c=xy(o,a,s),l=Cf(t),u=ky(t.serverSyncTree_,e,c,l,!0);Sf(t.eventQueue_,u),t.server_.put(e.toString(),o.val(!0),(d,f)=>{const g=d==="ok";g||Yt("set at "+e+" failed: "+d);const v=Di(t.serverSyncTree_,l,!g);Gn(t.eventQueue_,e,v),Yi(t,i,d,f)});const h=jy(t,e);Ia(t,h),Gn(t.eventQueue_,h,[])}function KH(t,e,n,r){eo(t,"update",{path:e.toString(),value:n});let i=!0;const s=mu(t),o={};if(Pt(n,(a,c)=>{i=!1,o[a]=Tk(Ye(e,a),Xe(c),t.serverSyncTree_,s)}),i)Et("update() called with empty data.  Don't do anything."),Yi(t,r,"ok",void 0);else{const a=Cf(t),c=mH(t.serverSyncTree_,e,o,a);Sf(t.eventQueue_,c),t.server_.merge(e.toString(),n,(l,u)=>{const h=l==="ok";h||Yt("update at "+e+" failed: "+l);const d=Di(t.serverSyncTree_,a,!h),f=d.length>0?Ia(t,e):e;Gn(t.eventQueue_,f,d),Yi(t,r,l,u)}),Pt(n,l=>{const u=jy(t,Ye(e,l));Ia(t,u)}),Gn(t.eventQueue_,e,[])}}function HH(t){eo(t,"onDisconnectEvents");const e=mu(t),n=Xh();um(t.onDisconnect_,Ae(),(i,s)=>{const o=Tk(i,s,t.serverSyncTree_,e);Ka(n,i,o)});let r=[];um(n,Ae(),(i,s)=>{r=r.concat(du(t.serverSyncTree_,i,s));const o=jy(t,i);Ia(t,o)}),t.onDisconnect_=Xh(),Gn(t.eventQueue_,Ae(),r)}function GH(t,e,n){t.server_.onDisconnectCancel(e.toString(),(r,i)=>{r==="ok"&&lm(t.onDisconnect_,e),Yi(t,n,r,i)})}function QI(t,e,n,r){const i=Xe(n);t.server_.onDisconnectPut(e.toString(),i.val(!0),(s,o)=>{s==="ok"&&Ka(t.onDisconnect_,e,i),Yi(t,r,s,o)})}function zH(t,e,n,r,i){const s=Xe(n,r);t.server_.onDisconnectPut(e.toString(),s.val(!0),(o,a)=>{o==="ok"&&Ka(t.onDisconnect_,e,s),Yi(t,i,o,a)})}function QH(t,e,n,r){if(xh(n)){Et("onDisconnect().update() called with empty data.  Don't do anything."),Yi(t,r,"ok",void 0);return}t.server_.onDisconnectMerge(e.toString(),n,(i,s)=>{i==="ok"&&Pt(n,(o,a)=>{const c=Xe(a);Ka(t.onDisconnect_,Ye(e,o),c)}),Yi(t,r,i,s)})}function YH(t,e,n){let r;me(e._path)===".info"?r=KI(t.infoSyncTree_,e,n):r=KI(t.serverSyncTree_,e,n),Nk(t.eventQueue_,e._path,r)}function _m(t,e,n){let r;me(e._path)===".info"?r=od(t.infoSyncTree_,e,n):r=od(t.serverSyncTree_,e,n),Nk(t.eventQueue_,e._path,r)}function xk(t){t.persistentConnection_&&t.persistentConnection_.interrupt(Dk)}function JH(t){t.persistentConnection_&&t.persistentConnection_.resume(Dk)}function eo(t,...e){let n="";t.persistentConnection_&&(n=t.persistentConnection_.id+":"),Et(n,...e)}function Yi(t,e,n,r){e&&Wa(()=>{if(n==="ok")e(null);else{const i=(n||"error").toUpperCase();let s=i;r&&(s+=": "+r);const o=new Error(s);o.code=i,e(o)}})}function XH(t,e,n,r,i,s){eo(t,"transaction on "+e);const o={path:e,update:n,onComplete:r,status:null,order:CA(),applyLocally:s,retryCount:0,unwatcher:i,abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},a=By(t,e,void 0);o.currentInputSnapshot=a;const c=o.update(a.val());if(c===void 0)o.unwatcher(),o.currentOutputSnapshotRaw=null,o.currentOutputSnapshotResolved=null,o.onComplete&&o.onComplete(null,!1,o.currentInputSnapshot);else{pu("transaction failed: Data returned ",c,o.path),o.status=0;const l=If(t.transactionQueueTree_,e),u=So(l)||[];u.push(o),Fy(l,u);let h;typeof c=="object"&&c!==null&&Dn(c,".priority")?(h=Hs(c,".priority"),$(Nl(h),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.")):h=(wf(t.serverSyncTree_,e)||re.EMPTY_NODE).getPriority().val();const d=mu(t),f=Xe(c,h),g=xy(f,a,d);o.currentOutputSnapshotRaw=f,o.currentOutputSnapshotResolved=g,o.currentWriteId=Cf(t);const v=ky(t.serverSyncTree_,e,g,o.currentWriteId,o.applyLocally);Gn(t.eventQueue_,e,v),Af(t,t.transactionQueueTree_)}}function By(t,e,n){return wf(t.serverSyncTree_,e,n)||re.EMPTY_NODE}function Af(t,e=t.transactionQueueTree_){if(e||kf(t,e),So(e)){const n=Lk(t,e);$(n.length>0,"Sending zero length transaction queue"),n.every(i=>i.status===0)&&ZH(t,fu(e),n)}else Sk(e)&&Ef(e,n=>{Af(t,n)})}function ZH(t,e,n){const r=n.map(l=>l.currentWriteId),i=By(t,e,r);let s=i;const o=i.hash();for(let l=0;l<n.length;l++){const u=n[l];$(u.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),u.status=1,u.retryCount++;const h=cn(e,u.path);s=s.updateChild(h,u.currentOutputSnapshotRaw)}const a=s.val(!0),c=e;t.server_.put(c.toString(),a,l=>{eo(t,"transaction put response",{path:c.toString(),status:l});let u=[];if(l==="ok"){const h=[];for(let d=0;d<n.length;d++)n[d].status=2,u=u.concat(Di(t.serverSyncTree_,n[d].currentWriteId)),n[d].onComplete&&h.push(()=>n[d].onComplete(null,!0,n[d].currentOutputSnapshotResolved)),n[d].unwatcher();kf(t,If(t.transactionQueueTree_,e)),Af(t,t.transactionQueueTree_),Gn(t.eventQueue_,e,u);for(let d=0;d<h.length;d++)Wa(h[d])}else{if(l==="datastale")for(let h=0;h<n.length;h++)n[h].status===3?n[h].status=4:n[h].status=0;else{Yt("transaction at "+c.toString()+" failed: "+l);for(let h=0;h<n.length;h++)n[h].status=4,n[h].abortReason=l}Ia(t,e)}},o)}function Ia(t,e){const n=Mk(t,e),r=fu(n),i=Lk(t,n);return eG(t,i,r),r}function eG(t,e,n){if(e.length===0)return;const r=[];let i=[];const o=e.filter(a=>a.status===0).map(a=>a.currentWriteId);for(let a=0;a<e.length;a++){const c=e[a],l=cn(n,c.path);let u=!1,h;if($(l!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),c.status===4)u=!0,h=c.abortReason,i=i.concat(Di(t.serverSyncTree_,c.currentWriteId,!0));else if(c.status===0)if(c.retryCount>=$H)u=!0,h="maxretry",i=i.concat(Di(t.serverSyncTree_,c.currentWriteId,!0));else{const d=By(t,c.path,o);c.currentInputSnapshot=d;const f=e[a].update(d.val());if(f!==void 0){pu("transaction failed: Data returned ",f,c.path);let g=Xe(f);typeof f=="object"&&f!=null&&Dn(f,".priority")||(g=g.updatePriority(d.getPriority()));const I=c.currentWriteId,S=mu(t),k=xy(g,d,S);c.currentOutputSnapshotRaw=g,c.currentOutputSnapshotResolved=k,c.currentWriteId=Cf(t),o.splice(o.indexOf(I),1),i=i.concat(ky(t.serverSyncTree_,c.path,k,c.currentWriteId,c.applyLocally)),i=i.concat(Di(t.serverSyncTree_,I,!0))}else u=!0,h="nodata",i=i.concat(Di(t.serverSyncTree_,c.currentWriteId,!0))}Gn(t.eventQueue_,n,i),i=[],u&&(e[a].status=2,function(d){setTimeout(d,Math.floor(0))}(e[a].unwatcher),e[a].onComplete&&(h==="nodata"?r.push(()=>e[a].onComplete(null,!1,e[a].currentInputSnapshot)):r.push(()=>e[a].onComplete(new Error(h),!1,null))))}kf(t,t.transactionQueueTree_);for(let a=0;a<r.length;a++)Wa(r[a]);Af(t,t.transactionQueueTree_)}function Mk(t,e){let n,r=t.transactionQueueTree_;for(n=me(e);n!==null&&So(r)===void 0;)r=If(r,n),e=Ue(e),n=me(e);return r}function Lk(t,e){const n=[];return Fk(t,e,n),n.sort((r,i)=>r.order-i.order),n}function Fk(t,e,n){const r=So(e);if(r)for(let i=0;i<r.length;i++)n.push(r[i]);Ef(e,i=>{Fk(t,i,n)})}function kf(t,e){const n=So(e);if(n){let r=0;for(let i=0;i<n.length;i++)n[i].status!==2&&(n[r]=n[i],r++);n.length=r,Fy(e,n.length>0?n:void 0)}Ef(e,r=>{kf(t,r)})}function jy(t,e){const n=fu(Mk(t,e)),r=If(t.transactionQueueTree_,e);return PH(r,i=>{qp(t,i)}),qp(t,r),Ck(r,i=>{qp(t,i)}),n}function qp(t,e){const n=So(e);if(n){const r=[];let i=[],s=-1;for(let o=0;o<n.length;o++)n[o].status===3||(n[o].status===1?($(s===o-1,"All SENT items should be at beginning of queue."),s=o,n[o].status=3,n[o].abortReason="set"):($(n[o].status===0,"Unexpected transaction status in abort"),n[o].unwatcher(),i=i.concat(Di(t.serverSyncTree_,n[o].currentWriteId,!0)),n[o].onComplete&&r.push(n[o].onComplete.bind(null,new Error("set"),!1,null))));s===-1?Fy(e,void 0):n.length=s+1,Gn(t.eventQueue_,fu(e),i);for(let o=0;o<r.length;o++)Wa(r[o])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tG(t){let e="";const n=t.split("/");for(let r=0;r<n.length;r++)if(n[r].length>0){let i=n[r];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch{}e+="/"+i}return e}function nG(t){const e={};t.charAt(0)==="?"&&(t=t.substring(1));for(const n of t.split("&")){if(n.length===0)continue;const r=n.split("=");r.length===2?e[decodeURIComponent(r[0])]=decodeURIComponent(r[1]):Yt(`Invalid query segment '${n}' in query '${t}'`)}return e}const ym=function(t,e){const n=rG(t),r=n.namespace;n.domain==="firebase.com"&&xr(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!r||r==="undefined")&&n.domain!=="localhost"&&xr("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||dW();const i=n.scheme==="ws"||n.scheme==="wss";return{repoInfo:new BA(n.host,n.secure,r,i,e,"",r!==n.subdomain),path:new Re(n.pathString)}},rG=function(t){let e="",n="",r="",i="",s="",o=!0,a="https",c=443;if(typeof t=="string"){let l=t.indexOf("//");l>=0&&(a=t.substring(0,l-1),t=t.substring(l+2));let u=t.indexOf("/");u===-1&&(u=t.length);let h=t.indexOf("?");h===-1&&(h=t.length),e=t.substring(0,Math.min(u,h)),u<h&&(i=tG(t.substring(u,h)));const d=nG(t.substring(Math.min(t.length,h)));l=e.indexOf(":"),l>=0?(o=a==="https"||a==="wss",c=parseInt(e.substring(l+1),10)):l=e.length;const f=e.slice(0,l);if(f.toLowerCase()==="localhost")n="localhost";else if(f.split(".").length<=2)n=f;else{const g=e.indexOf(".");r=e.substring(0,g).toLowerCase(),n=e.substring(g+1),s=r}"ns"in d&&(s=d.ns)}return{host:e,port:c,domain:n,subdomain:r,secure:o,scheme:a,pathString:i,namespace:s}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uk{constructor(e,n,r,i){this.eventType=e,this.eventRegistration=n,this.snapshot=r,this.prevName=i}getPath(){const e=this.snapshot.ref;return this.eventType==="value"?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+gt(this.snapshot.exportVal())}}class Vk{constructor(e,n,r){this.eventRegistration=e,this.error=n,this.path=r}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $k{constructor(e,n){this.snapshotCallback=e,this.cancelCallback=n}onValue(e,n){this.snapshotCallback.call(null,e,n)}onCancel(e){return $(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||this.snapshotCallback.userCallback!==void 0&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iG{constructor(e,n){this._repo=e,this._path=n}cancel(){const e=new pt;return GH(this._repo,this._path,e.wrapCallback(()=>{})),e.promise}remove(){$n("OnDisconnect.remove",this._path);const e=new pt;return QI(this._repo,this._path,null,e.wrapCallback(()=>{})),e.promise}set(e){$n("OnDisconnect.set",this._path),Lr("OnDisconnect.set",e,this._path,!1);const n=new pt;return QI(this._repo,this._path,e,n.wrapCallback(()=>{})),n.promise}setWithPriority(e,n){$n("OnDisconnect.setWithPriority",this._path),Lr("OnDisconnect.setWithPriority",e,this._path,!1),Uy("OnDisconnect.setWithPriority",n,!1);const r=new pt;return zH(this._repo,this._path,e,n,r.wrapCallback(()=>{})),r.promise}update(e){$n("OnDisconnect.update",this._path),kk("OnDisconnect.update",e,this._path,!1);const n=new pt;return QH(this._repo,this._path,e,n.wrapCallback(()=>{})),n.promise}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class In{constructor(e,n,r,i){this._repo=e,this._path=n,this._queryParams=r,this._orderByCalled=i}get key(){return _e(this._path)?null:fy(this._path)}get ref(){return new Qn(this._repo,this._path)}get _queryIdentifier(){const e=xI(this._queryParams),n=cy(e);return n==="{}"?"default":n}get _queryObject(){return xI(this._queryParams)}isEqual(e){if(e=M(e),!(e instanceof In))return!1;const n=this._repo===e._repo,r=py(this._path,e._path),i=this._queryIdentifier===e._queryIdentifier;return n&&r&&i}toJSON(){return this.toString()}toString(){return this._repo.toString()+GW(this._path)}}function Rf(t,e){if(t._orderByCalled===!0)throw new Error(e+": You can't combine multiple orderBy calls.")}function ss(t){let e=null,n=null;if(t.hasStart()&&(e=t.getIndexStartValue()),t.hasEnd()&&(n=t.getIndexEndValue()),t.getIndex()===Ar){const r="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",i="Query: When ordering by key, the argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() must be a string.";if(t.hasStart()){if(t.getIndexStartName()!==si)throw new Error(r);if(typeof e!="string")throw new Error(i)}if(t.hasEnd()){if(t.getIndexEndName()!==Mr)throw new Error(r);if(typeof n!="string")throw new Error(i)}}else if(t.getIndex()===qe){if(e!=null&&!Nl(e)||n!=null&&!Nl(n))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), startAfter() endAt(), endBefore(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if($(t.getIndex()instanceof _y||t.getIndex()===yy,"unknown index type."),e!=null&&typeof e=="object"||n!=null&&typeof n=="object")throw new Error("Query: First argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() cannot be an object.")}function Nf(t){if(t.hasStart()&&t.hasEnd()&&t.hasLimit()&&!t.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), startAfter(), endAt(), endBefore(), and limit(). Use limitToFirst() or limitToLast() instead.")}class Qn extends In{constructor(e,n){super(e,n,new gf,!1)}get parent(){const e=YA(this._path);return e===null?null:new Qn(this._repo,e)}get root(){let e=this;for(;e.parent!==null;)e=e.parent;return e}}class to{constructor(e,n,r){this._node=e,this.ref=n,this._index=r}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){const n=new Re(e),r=no(this.ref,e);return new to(this._node.getChild(n),r,qe)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return this._node.isLeafNode()?!1:!!this._node.forEachChild(this._index,(r,i)=>e(new to(i,no(this.ref,r),qe)))}hasChild(e){const n=new Re(e);return!this._node.getChild(n).isEmpty()}hasChildren(){return this._node.isLeafNode()?!1:!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}}function Bk(t,e){return t=M(t),t._checkNotDeleted("ref"),e!==void 0?no(t._root,e):t._root}function YI(t,e){t=M(t),t._checkNotDeleted("refFromURL");const n=ym(e,t._repo.repoInfo_.nodeAdmin);Rk("refFromURL",n);const r=n.repoInfo;return!t._repo.repoInfo_.isCustomHost()&&r.host!==t._repo.repoInfo_.host&&xr("refFromURL: Host name does not match the current database: (found "+r.host+" but expected "+t._repo.repoInfo_.host+")"),Bk(t,n.path.toString())}function no(t,e){return t=M(t),me(t._path)===null?FH("child","path",e,!1):Pl("child","path",e,!1),new Qn(t._repo,Ye(t._path,e))}function sG(t,e){t=M(t),$n("push",t._path),Lr("push",e,t._path,!0);const n=Ok(t._repo),r=fK(n),i=no(t,r),s=no(t,r);let o;return e!=null?o=qy(s,e).then(()=>s):o=Promise.resolve(s),i.then=o.then.bind(o),i.catch=o.then.bind(o,void 0),i}function oG(t){return $n("remove",t._path),qy(t,null)}function qy(t,e){t=M(t),$n("set",t._path),Lr("set",e,t._path,!1);const n=new pt;return $y(t._repo,t._path,e,null,n.wrapCallback(()=>{})),n.promise}function aG(t,e){t=M(t),$n("setPriority",t._path),Uy("setPriority",e,!1);const n=new pt;return $y(t._repo,Ye(t._path,".priority"),e,null,n.wrapCallback(()=>{})),n.promise}function cG(t,e,n){if($n("setWithPriority",t._path),Lr("setWithPriority",e,t._path,!1),Uy("setWithPriority",n,!1),t.key===".length"||t.key===".keys")throw"setWithPriority failed: "+t.key+" is a read-only object.";const r=new pt;return $y(t._repo,t._path,e,n,r.wrapCallback(()=>{})),r.promise}function lG(t,e){kk("update",e,t._path,!1);const n=new pt;return KH(t._repo,t._path,e,n.wrapCallback(()=>{})),n.promise}function uG(t){return t=M(t),WH(t._repo,t).then(e=>new to(e,new Qn(t._repo,t._path),t._queryParams.getIndex()))}class Pf{constructor(e){this.callbackContext=e}respondsTo(e){return e==="value"}createEvent(e,n){const r=n._queryParams.getIndex();return new Uk("value",this,new to(e.snapshotNode,new Qn(n._repo,n._path),r))}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,n){return this.callbackContext.hasCancelCallback?new Vk(this,e,n):null}matches(e){return e instanceof Pf?!e.callbackContext||!this.callbackContext?!0:e.callbackContext.matches(this.callbackContext):!1}hasAnyCallback(){return this.callbackContext!==null}}class Df{constructor(e,n){this.eventType=e,this.callbackContext=n}respondsTo(e){let n=e==="children_added"?"child_added":e;return n=n==="children_removed"?"child_removed":n,this.eventType===n}createCancelEvent(e,n){return this.callbackContext.hasCancelCallback?new Vk(this,e,n):null}createEvent(e,n){$(e.childName!=null,"Child events should have a childName.");const r=no(new Qn(n._repo,n._path),e.childName),i=n._queryParams.getIndex();return new Uk(e.type,this,new to(e.snapshotNode,r,i),e.prevName)}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,e.prevName)}matches(e){return e instanceof Df?this.eventType===e.eventType&&(!this.callbackContext||!e.callbackContext||this.callbackContext.matches(e.callbackContext)):!1}hasAnyCallback(){return!!this.callbackContext}}function _u(t,e,n,r,i){let s;if(typeof r=="object"&&(s=void 0,i=r),typeof r=="function"&&(s=r),i&&i.onlyOnce){const c=n,l=(u,h)=>{_m(t._repo,t,a),c(u,h)};l.userCallback=n.userCallback,l.context=n.context,n=l}const o=new $k(n,s||void 0),a=e==="value"?new Pf(o):new Df(e,o);return YH(t._repo,t,a),()=>_m(t._repo,t,a)}function vm(t,e,n,r){return _u(t,"value",e,n,r)}function JI(t,e,n,r){return _u(t,"child_added",e,n,r)}function XI(t,e,n,r){return _u(t,"child_changed",e,n,r)}function ZI(t,e,n,r){return _u(t,"child_moved",e,n,r)}function eE(t,e,n,r){return _u(t,"child_removed",e,n,r)}function tE(t,e,n){let r=null;const i=n?new $k(n):null;e==="value"?r=new Pf(i):e&&(r=new Df(e,i)),_m(t._repo,t,r)}class hr{}class jk extends hr{constructor(e,n){super(),this._value=e,this._key=n}_apply(e){Lr("endAt",this._value,e._path,!0);const n=cm(e._queryParams,this._value,this._key);if(Nf(n),ss(n),e._queryParams.hasEnd())throw new Error("endAt: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new In(e._repo,e._path,n,e._orderByCalled)}}function hG(t,e){return gu("endAt","key",e,!0),new jk(t,e)}class dG extends hr{constructor(e,n){super(),this._value=e,this._key=n}_apply(e){Lr("endBefore",this._value,e._path,!1);const n=wK(e._queryParams,this._value,this._key);if(Nf(n),ss(n),e._queryParams.hasEnd())throw new Error("endBefore: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new In(e._repo,e._path,n,e._orderByCalled)}}function fG(t,e){return gu("endBefore","key",e,!0),new dG(t,e)}class qk extends hr{constructor(e,n){super(),this._value=e,this._key=n}_apply(e){Lr("startAt",this._value,e._path,!0);const n=am(e._queryParams,this._value,this._key);if(Nf(n),ss(n),e._queryParams.hasStart())throw new Error("startAt: Starting point was already set (by another call to startAt, startBefore or equalTo).");return new In(e._repo,e._path,n,e._orderByCalled)}}function pG(t=null,e){return gu("startAt","key",e,!0),new qk(t,e)}class gG extends hr{constructor(e,n){super(),this._value=e,this._key=n}_apply(e){Lr("startAfter",this._value,e._path,!1);const n=vK(e._queryParams,this._value,this._key);if(Nf(n),ss(n),e._queryParams.hasStart())throw new Error("startAfter: Starting point was already set (by another call to startAt, startAfter, or equalTo).");return new In(e._repo,e._path,n,e._orderByCalled)}}function mG(t,e){return gu("startAfter","key",e,!0),new gG(t,e)}class _G extends hr{constructor(e){super(),this._limit=e}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToFirst: Limit was already set (by another call to limitToFirst or limitToLast).");return new In(e._repo,e._path,_K(e._queryParams,this._limit),e._orderByCalled)}}function yG(t){if(typeof t!="number"||Math.floor(t)!==t||t<=0)throw new Error("limitToFirst: First argument must be a positive integer.");return new _G(t)}class vG extends hr{constructor(e){super(),this._limit=e}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToLast: Limit was already set (by another call to limitToFirst or limitToLast).");return new In(e._repo,e._path,yK(e._queryParams,this._limit),e._orderByCalled)}}function wG(t){if(typeof t!="number"||Math.floor(t)!==t||t<=0)throw new Error("limitToLast: First argument must be a positive integer.");return new vG(t)}class bG extends hr{constructor(e){super(),this._path=e}_apply(e){Rf(e,"orderByChild");const n=new Re(this._path);if(_e(n))throw new Error("orderByChild: cannot pass in empty path. Use orderByValue() instead.");const r=new _y(n),i=mf(e._queryParams,r);return ss(i),new In(e._repo,e._path,i,!0)}}function IG(t){if(t==="$key")throw new Error('orderByChild: "$key" is invalid.  Use orderByKey() instead.');if(t==="$priority")throw new Error('orderByChild: "$priority" is invalid.  Use orderByPriority() instead.');if(t==="$value")throw new Error('orderByChild: "$value" is invalid.  Use orderByValue() instead.');return Pl("orderByChild","path",t,!1),new bG(t)}class EG extends hr{_apply(e){Rf(e,"orderByKey");const n=mf(e._queryParams,Ar);return ss(n),new In(e._repo,e._path,n,!0)}}function TG(){return new EG}class SG extends hr{_apply(e){Rf(e,"orderByPriority");const n=mf(e._queryParams,qe);return ss(n),new In(e._repo,e._path,n,!0)}}function CG(){return new SG}class AG extends hr{_apply(e){Rf(e,"orderByValue");const n=mf(e._queryParams,yy);return ss(n),new In(e._repo,e._path,n,!0)}}function kG(){return new AG}class RG extends hr{constructor(e,n){super(),this._value=e,this._key=n}_apply(e){if(Lr("equalTo",this._value,e._path,!1),e._queryParams.hasStart())throw new Error("equalTo: Starting point was already set (by another call to startAt/startAfter or equalTo).");if(e._queryParams.hasEnd())throw new Error("equalTo: Ending point was already set (by another call to endAt/endBefore or equalTo).");return new jk(this._value,this._key)._apply(new qk(this._value,this._key)._apply(e))}}function NG(t,e){return gu("equalTo","key",e,!0),new RG(t,e)}function Jn(t,...e){let n=M(t);for(const r of e)n=r._apply(n);return n}cH(Qn);fH(Qn);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PG="FIREBASE_DATABASE_EMULATOR_HOST",wm={};let DG=!1;function OG(t,e,n,r){t.repoInfo_=new BA(`${e}:${n}`,!1,t.repoInfo_.namespace,t.repoInfo_.webSocketOnly,t.repoInfo_.nodeAdmin,t.repoInfo_.persistenceKey,t.repoInfo_.includeNamespaceInQueryParams),r&&(t.authTokenProvider_=r)}function Wk(t,e,n,r,i){let s=r||t.options.databaseURL;s===void 0&&(t.options.projectId||xr("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),Et("Using default host for project ",t.options.projectId),s=`${t.options.projectId}-default-rtdb.firebaseio.com`);let o=ym(s,i),a=o.repoInfo,c,l;typeof process!="undefined"&&process.env&&(l=process.env[PG]),l?(c=!0,s=`http://${l}?ns=${a.namespace}`,o=ym(s,i),a=o.repoInfo):c=!o.repoInfo.secure;const u=i&&c?new na(na.OWNER):new bW(t.name,t.options,e);Rk("Invalid Firebase Database URL",o),_e(o.path)||xr("Database URL must point to the root of a Firebase Database (not including a child path).");const h=MG(a,t,u,new wW(t.name,n));return new LG(h,t)}function xG(t,e){const n=wm[e];(!n||n[t.key]!==t)&&xr(`Database ${e}(${t.repoInfo_}) has already been deleted.`),xk(t),delete n[t.key]}function MG(t,e,n,r){let i=wm[e.name];i||(i={},wm[e.name]=i);let s=i[t.toURLString()];return s&&xr("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),s=new BH(t,DG,n,r),i[t.toURLString()]=s,s}class LG{constructor(e,n){this._repoInternal=e,this.app=n,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(jH(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new Qn(this._repo,Ae())),this._rootInternal}_delete(){return this._rootInternal!==null&&(xG(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){this._rootInternal===null&&xr("Cannot call "+e+" on a deleted database.")}}function Kk(){_a.IS_TRANSPORT_INITIALIZED&&Yt("Transport has already been initialized. Please call this function before calling ref or setting up a listener")}function FG(){Kk(),Pi.forceDisallow()}function UG(){Kk(),Fn.forceDisallow(),Pi.forceAllow()}function VG(t,e,n,r={}){t=M(t),t._checkNotDeleted("useEmulator"),t._instanceStarted&&xr("Cannot call useEmulator() after instance has already been initialized.");const i=t._repoInternal;let s;if(i.repoInfo_.nodeAdmin)r.mockUserToken&&xr('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),s=new na(na.OWNER);else if(r.mockUserToken){const o=typeof r.mockUserToken=="string"?r.mockUserToken:k_(r.mockUserToken,t.app.options.projectId);s=new na(o)}OG(i,e,n,s)}function $G(t){t=M(t),t._checkNotDeleted("goOffline"),xk(t._repo)}function BG(t){t=M(t),t._checkNotDeleted("goOnline"),JH(t._repo)}function jG(t,e){kA(t,e)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qG(t){TA(Br),nt(new Ce("database",(e,{instanceIdentifier:n})=>{const r=e.getProvider("app").getImmediate(),i=e.getProvider("auth-internal"),s=e.getProvider("app-check-internal");return Wk(r,i,s,n)},"PUBLIC").setMultipleInstances(!0)),Ve(mI,_I,t),Ve(mI,_I,"esm2017")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WG={".sv":"timestamp"};function KG(){return WG}function HG(t){return{".sv":{increment:t}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GG{constructor(e,n){this.committed=e,this.snapshot=n}toJSON(){return{committed:this.committed,snapshot:this.snapshot.toJSON()}}}function zG(t,e,n){var r;if(t=M(t),$n("Reference.transaction",t._path),t.key===".length"||t.key===".keys")throw"Reference.transaction failed: "+t.key+" is a read-only object.";const i=(r=n==null?void 0:n.applyLocally)!==null&&r!==void 0?r:!0,s=new pt,o=(c,l,u)=>{let h=null;c?s.reject(c):(h=new to(u,new Qn(t._repo,t._path),qe),s.resolve(new GG(l,h)))},a=vm(t,()=>{});return XH(t._repo,t._path,e,o,a,i),s.promise}ti.prototype.simpleListen=function(t,e){this.sendRequest("q",{p:t},e)};ti.prototype.echo=function(t,e){this.sendRequest("echo",{d:t},e)};qG();const QG="@firebase/database-compat",YG="0.2.3";/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JG=new $r("@firebase/database-compat"),Hk=function(t){const e="FIREBASE WARNING: "+t;JG.warn(e)};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XG=function(t,e,n,r){if(!(r&&n===void 0)&&typeof n!="boolean")throw new Error(wn(t,e)+"must be a boolean.")},ZG=function(t,e,n){if(!(n&&e===void 0))switch(e){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:throw new Error(wn(t,"eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ez{constructor(e){this._delegate=e}cancel(e){ie("OnDisconnect.cancel",0,1,arguments.length),wt("OnDisconnect.cancel","onComplete",e,!0);const n=this._delegate.cancel();return e&&n.then(()=>e(null),r=>e(r)),n}remove(e){ie("OnDisconnect.remove",0,1,arguments.length),wt("OnDisconnect.remove","onComplete",e,!0);const n=this._delegate.remove();return e&&n.then(()=>e(null),r=>e(r)),n}set(e,n){ie("OnDisconnect.set",1,2,arguments.length),wt("OnDisconnect.set","onComplete",n,!0);const r=this._delegate.set(e);return n&&r.then(()=>n(null),i=>n(i)),r}setWithPriority(e,n,r){ie("OnDisconnect.setWithPriority",2,3,arguments.length),wt("OnDisconnect.setWithPriority","onComplete",r,!0);const i=this._delegate.setWithPriority(e,n);return r&&i.then(()=>r(null),s=>r(s)),i}update(e,n){if(ie("OnDisconnect.update",1,2,arguments.length),Array.isArray(e)){const i={};for(let s=0;s<e.length;++s)i[""+s]=e[s];e=i,Hk("Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}wt("OnDisconnect.update","onComplete",n,!0);const r=this._delegate.update(e);return n&&r.then(()=>n(null),i=>n(i)),r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tz{constructor(e,n){this.committed=e,this.snapshot=n}toJSON(){return ie("TransactionResult.toJSON",0,1,arguments.length),{committed:this.committed,snapshot:this.snapshot.toJSON()}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vi{constructor(e,n){this._database=e,this._delegate=n}val(){return ie("DataSnapshot.val",0,0,arguments.length),this._delegate.val()}exportVal(){return ie("DataSnapshot.exportVal",0,0,arguments.length),this._delegate.exportVal()}toJSON(){return ie("DataSnapshot.toJSON",0,1,arguments.length),this._delegate.toJSON()}exists(){return ie("DataSnapshot.exists",0,0,arguments.length),this._delegate.exists()}child(e){return ie("DataSnapshot.child",0,1,arguments.length),e=String(e),Pl("DataSnapshot.child","path",e,!1),new Vi(this._database,this._delegate.child(e))}hasChild(e){return ie("DataSnapshot.hasChild",1,1,arguments.length),Pl("DataSnapshot.hasChild","path",e,!1),this._delegate.hasChild(e)}getPriority(){return ie("DataSnapshot.getPriority",0,0,arguments.length),this._delegate.priority}forEach(e){return ie("DataSnapshot.forEach",1,1,arguments.length),wt("DataSnapshot.forEach","action",e,!1),this._delegate.forEach(n=>e(new Vi(this._database,n)))}hasChildren(){return ie("DataSnapshot.hasChildren",0,0,arguments.length),this._delegate.hasChildren()}get key(){return this._delegate.key}numChildren(){return ie("DataSnapshot.numChildren",0,0,arguments.length),this._delegate.size}getRef(){return ie("DataSnapshot.ref",0,0,arguments.length),new An(this._database,this._delegate.ref)}get ref(){return this.getRef()}}class Lt{constructor(e,n){this.database=e,this._delegate=n}on(e,n,r,i){var s;ie("Query.on",2,4,arguments.length),wt("Query.on","callback",n,!1);const o=Lt.getCancelAndContextArgs_("Query.on",r,i),a=(l,u)=>{n.call(o.context,new Vi(this.database,l),u)};a.userCallback=n,a.context=o.context;const c=(s=o.cancel)===null||s===void 0?void 0:s.bind(o.context);switch(e){case"value":return vm(this._delegate,a,c),n;case"child_added":return JI(this._delegate,a,c),n;case"child_removed":return eE(this._delegate,a,c),n;case"child_changed":return XI(this._delegate,a,c),n;case"child_moved":return ZI(this._delegate,a,c),n;default:throw new Error(wn("Query.on","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}}off(e,n,r){if(ie("Query.off",0,3,arguments.length),ZG("Query.off",e,!0),wt("Query.off","callback",n,!0),Pb("Query.off","context",r,!0),n){const i=()=>{};i.userCallback=n,i.context=r,tE(this._delegate,e,i)}else tE(this._delegate,e)}get(){return uG(this._delegate).then(e=>new Vi(this.database,e))}once(e,n,r,i){ie("Query.once",1,4,arguments.length),wt("Query.once","callback",n,!0);const s=Lt.getCancelAndContextArgs_("Query.once",r,i),o=new pt,a=(l,u)=>{const h=new Vi(this.database,l);n&&n.call(s.context,h,u),o.resolve(h)};a.userCallback=n,a.context=s.context;const c=l=>{s.cancel&&s.cancel.call(s.context,l),o.reject(l)};switch(e){case"value":vm(this._delegate,a,c,{onlyOnce:!0});break;case"child_added":JI(this._delegate,a,c,{onlyOnce:!0});break;case"child_removed":eE(this._delegate,a,c,{onlyOnce:!0});break;case"child_changed":XI(this._delegate,a,c,{onlyOnce:!0});break;case"child_moved":ZI(this._delegate,a,c,{onlyOnce:!0});break;default:throw new Error(wn("Query.once","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}return o.promise}limitToFirst(e){return ie("Query.limitToFirst",1,1,arguments.length),new Lt(this.database,Jn(this._delegate,yG(e)))}limitToLast(e){return ie("Query.limitToLast",1,1,arguments.length),new Lt(this.database,Jn(this._delegate,wG(e)))}orderByChild(e){return ie("Query.orderByChild",1,1,arguments.length),new Lt(this.database,Jn(this._delegate,IG(e)))}orderByKey(){return ie("Query.orderByKey",0,0,arguments.length),new Lt(this.database,Jn(this._delegate,TG()))}orderByPriority(){return ie("Query.orderByPriority",0,0,arguments.length),new Lt(this.database,Jn(this._delegate,CG()))}orderByValue(){return ie("Query.orderByValue",0,0,arguments.length),new Lt(this.database,Jn(this._delegate,kG()))}startAt(e=null,n){return ie("Query.startAt",0,2,arguments.length),new Lt(this.database,Jn(this._delegate,pG(e,n)))}startAfter(e=null,n){return ie("Query.startAfter",0,2,arguments.length),new Lt(this.database,Jn(this._delegate,mG(e,n)))}endAt(e=null,n){return ie("Query.endAt",0,2,arguments.length),new Lt(this.database,Jn(this._delegate,hG(e,n)))}endBefore(e=null,n){return ie("Query.endBefore",0,2,arguments.length),new Lt(this.database,Jn(this._delegate,fG(e,n)))}equalTo(e,n){return ie("Query.equalTo",1,2,arguments.length),new Lt(this.database,Jn(this._delegate,NG(e,n)))}toString(){return ie("Query.toString",0,0,arguments.length),this._delegate.toString()}toJSON(){return ie("Query.toJSON",0,1,arguments.length),this._delegate.toJSON()}isEqual(e){if(ie("Query.isEqual",1,1,arguments.length),!(e instanceof Lt)){const n="Query.isEqual failed: First argument must be an instance of firebase.database.Query.";throw new Error(n)}return this._delegate.isEqual(e._delegate)}static getCancelAndContextArgs_(e,n,r){const i={cancel:void 0,context:void 0};if(n&&r)i.cancel=n,wt(e,"cancel",i.cancel,!0),i.context=r,Pb(e,"context",i.context,!0);else if(n)if(typeof n=="object"&&n!==null)i.context=n;else if(typeof n=="function")i.cancel=n;else throw new Error(wn(e,"cancelOrContext")+" must either be a cancel callback or a context object.");return i}get ref(){return new An(this.database,new Qn(this._delegate._repo,this._delegate._path))}}class An extends Lt{constructor(e,n){super(e,new In(n._repo,n._path,new gf,!1)),this.database=e,this._delegate=n}getKey(){return ie("Reference.key",0,0,arguments.length),this._delegate.key}child(e){return ie("Reference.child",1,1,arguments.length),typeof e=="number"&&(e=String(e)),new An(this.database,no(this._delegate,e))}getParent(){ie("Reference.parent",0,0,arguments.length);const e=this._delegate.parent;return e?new An(this.database,e):null}getRoot(){return ie("Reference.root",0,0,arguments.length),new An(this.database,this._delegate.root)}set(e,n){ie("Reference.set",1,2,arguments.length),wt("Reference.set","onComplete",n,!0);const r=qy(this._delegate,e);return n&&r.then(()=>n(null),i=>n(i)),r}update(e,n){if(ie("Reference.update",1,2,arguments.length),Array.isArray(e)){const i={};for(let s=0;s<e.length;++s)i[""+s]=e[s];e=i,Hk("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}$n("Reference.update",this._delegate._path),wt("Reference.update","onComplete",n,!0);const r=lG(this._delegate,e);return n&&r.then(()=>n(null),i=>n(i)),r}setWithPriority(e,n,r){ie("Reference.setWithPriority",2,3,arguments.length),wt("Reference.setWithPriority","onComplete",r,!0);const i=cG(this._delegate,e,n);return r&&i.then(()=>r(null),s=>r(s)),i}remove(e){ie("Reference.remove",0,1,arguments.length),wt("Reference.remove","onComplete",e,!0);const n=oG(this._delegate);return e&&n.then(()=>e(null),r=>e(r)),n}transaction(e,n,r){ie("Reference.transaction",1,3,arguments.length),wt("Reference.transaction","transactionUpdate",e,!1),wt("Reference.transaction","onComplete",n,!0),XG("Reference.transaction","applyLocally",r,!0);const i=zG(this._delegate,e,{applyLocally:r}).then(s=>new tz(s.committed,new Vi(this.database,s.snapshot)));return n&&i.then(s=>n(null,s.committed,s.snapshot),s=>n(s,!1,null)),i}setPriority(e,n){ie("Reference.setPriority",1,2,arguments.length),wt("Reference.setPriority","onComplete",n,!0);const r=aG(this._delegate,e);return n&&r.then(()=>n(null),i=>n(i)),r}push(e,n){ie("Reference.push",0,2,arguments.length),wt("Reference.push","onComplete",n,!0);const r=sG(this._delegate,e),i=r.then(o=>new An(this.database,o));n&&i.then(()=>n(null),o=>n(o));const s=new An(this.database,r);return s.then=i.then.bind(i),s.catch=i.catch.bind(i,void 0),s}onDisconnect(){return $n("Reference.onDisconnect",this._delegate._path),new ez(new iG(this._delegate._repo,this._delegate._path))}get key(){return this.getKey()}get parent(){return this.getParent()}get root(){return this.getRoot()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dl{constructor(e,n){this._delegate=e,this.app=n,this.INTERNAL={delete:()=>this._delegate._delete(),forceWebSockets:FG,forceLongPolling:UG}}useEmulator(e,n,r={}){VG(this._delegate,e,n,r)}ref(e){if(ie("database.ref",0,1,arguments.length),e instanceof An){const n=YI(this._delegate,e.toString());return new An(this,n)}else{const n=Bk(this._delegate,e);return new An(this,n)}}refFromURL(e){ie("database.refFromURL",1,1,arguments.length);const r=YI(this._delegate,e);return new An(this,r)}goOffline(){return ie("database.goOffline",0,0,arguments.length),$G(this._delegate)}goOnline(){return ie("database.goOnline",0,0,arguments.length),BG(this._delegate)}}Dl.ServerValue={TIMESTAMP:KG(),increment:t=>HG(t)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nz({app:t,url:e,version:n,customAuthImpl:r,namespace:i,nodeAdmin:s=!1}){TA(n);const o=new C0("auth-internal",new A0("database-standalone"));return o.setComponent(new Ce("auth-internal",()=>r,"PRIVATE")),{instance:new Dl(Wk(t,o,void 0,e,s),t),namespace:i}}var rz=Object.freeze({__proto__:null,initStandalone:nz});/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iz=Dl.ServerValue;function sz(t){t.INTERNAL.registerComponent(new Ce("database-compat",(e,{instanceIdentifier:n})=>{const r=e.getProvider("app-compat").getImmediate(),i=e.getProvider("database").getImmediate({identifier:n});return new Dl(i,r)},"PUBLIC").setServiceProps({Reference:An,Query:Lt,Database:Dl,DataSnapshot:Vi,enableLogging:jG,INTERNAL:rz,ServerValue:iz}).setMultipleInstances(!0)),t.registerVersion(QG,YG)}sz(lt);var oz=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{},Q,Wy=Wy||{},ce=oz||self;function ad(){}function bm(t){var e=typeof t;return e=e!="object"?e:t?Array.isArray(t)?"array":e:"null",e=="array"||e=="object"&&typeof t.length=="number"}function yu(t){var e=typeof t;return e=="object"&&t!=null||e=="function"}function az(t){return Object.prototype.hasOwnProperty.call(t,Wp)&&t[Wp]||(t[Wp]=++cz)}var Wp="closure_uid_"+(1e9*Math.random()>>>0),cz=0;function lz(t,e,n){return t.call.apply(t.bind,arguments)}function uz(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var i=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(i,r),t.apply(e,i)}}return function(){return t.apply(e,arguments)}}function qt(t,e,n){return Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?qt=lz:qt=uz,qt.apply(null,arguments)}function Yu(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var r=n.slice();return r.push.apply(r,arguments),t.apply(this,r)}}function Gt(t,e){function n(){}n.prototype=e.prototype,t.Z=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.Vb=function(r,i,s){for(var o=Array(arguments.length-2),a=2;a<arguments.length;a++)o[a-2]=arguments[a];return e.prototype[i].apply(r,o)}}function os(){this.s=this.s,this.o=this.o}var hz=0;os.prototype.s=!1;os.prototype.na=function(){!this.s&&(this.s=!0,this.M(),hz!=0)&&az(this)};os.prototype.M=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const Gk=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if(typeof t=="string")return typeof e!="string"||e.length!=1?-1:t.indexOf(e,0);for(let n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},zk=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){const r=t.length,i=typeof t=="string"?t.split(""):t;for(let s=0;s<r;s++)s in i&&e.call(n,i[s],s,t)};function dz(t){e:{var e=r2;const n=t.length,r=typeof t=="string"?t.split(""):t;for(let i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break e}e=-1}return 0>e?null:typeof t=="string"?t.charAt(e):t[e]}function nE(t){return Array.prototype.concat.apply([],arguments)}function Ky(t){const e=t.length;if(0<e){const n=Array(e);for(let r=0;r<e;r++)n[r]=t[r];return n}return[]}function cd(t){return/^[\s\xa0]*$/.test(t)}var rE=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function sn(t,e){return t.indexOf(e)!=-1}function Kp(t,e){return t<e?-1:t>e?1:0}var on;e:{var iE=ce.navigator;if(iE){var sE=iE.userAgent;if(sE){on=sE;break e}}on=""}function Hy(t,e,n){for(const r in t)e.call(n,t[r],r,t)}function Qk(t){const e={};for(const n in t)e[n]=t[n];return e}var oE="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Yk(t,e){let n,r;for(let i=1;i<arguments.length;i++){r=arguments[i];for(n in r)t[n]=r[n];for(let s=0;s<oE.length;s++)n=oE[s],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function Gy(t){return Gy[" "](t),t}Gy[" "]=ad;function fz(t){var e=mz;return Object.prototype.hasOwnProperty.call(e,9)?e[9]:e[9]=t(9)}var pz=sn(on,"Opera"),Ea=sn(on,"Trident")||sn(on,"MSIE"),Jk=sn(on,"Edge"),Im=Jk||Ea,Xk=sn(on,"Gecko")&&!(sn(on.toLowerCase(),"webkit")&&!sn(on,"Edge"))&&!(sn(on,"Trident")||sn(on,"MSIE"))&&!sn(on,"Edge"),gz=sn(on.toLowerCase(),"webkit")&&!sn(on,"Edge");function Zk(){var t=ce.document;return t?t.documentMode:void 0}var ld;e:{var Hp="",Gp=function(){var t=on;if(Xk)return/rv:([^\);]+)(\)|;)/.exec(t);if(Jk)return/Edge\/([\d\.]+)/.exec(t);if(Ea)return/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(t);if(gz)return/WebKit\/(\S+)/.exec(t);if(pz)return/(?:Version)[ \/]?(\S+)/.exec(t)}();if(Gp&&(Hp=Gp?Gp[1]:""),Ea){var zp=Zk();if(zp!=null&&zp>parseFloat(Hp)){ld=String(zp);break e}}ld=Hp}var mz={};function _z(){return fz(function(){let t=0;const e=rE(String(ld)).split("."),n=rE("9").split("."),r=Math.max(e.length,n.length);for(let o=0;t==0&&o<r;o++){var i=e[o]||"",s=n[o]||"";do{if(i=/(\d*)(\D*)(.*)/.exec(i)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],i[0].length==0&&s[0].length==0)break;t=Kp(i[1].length==0?0:parseInt(i[1],10),s[1].length==0?0:parseInt(s[1],10))||Kp(i[2].length==0,s[2].length==0)||Kp(i[2],s[2]),i=i[3],s=s[3]}while(t==0)}return 0<=t})}var Em;if(ce.document&&Ea){var aE=Zk();Em=aE||parseInt(ld,10)||void 0}else Em=void 0;var yz=Em,vz=function(){if(!ce.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{ce.addEventListener("test",ad,e),ce.removeEventListener("test",ad,e)}catch{}return t}();function Jt(t,e){this.type=t,this.g=this.target=e,this.defaultPrevented=!1}Jt.prototype.h=function(){this.defaultPrevented=!0};function Ol(t,e){if(Jt.call(this,t?t.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.g=e,e=t.relatedTarget){if(Xk){e:{try{Gy(e.nodeName);var i=!0;break e}catch{}i=!1}i||(e=null)}}else n=="mouseover"?e=t.fromElement:n=="mouseout"&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=r.clientX!==void 0?r.clientX:r.pageX,this.clientY=r.clientY!==void 0?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=t.clientX!==void 0?t.clientX:t.pageX,this.clientY=t.clientY!==void 0?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType=typeof t.pointerType=="string"?t.pointerType:wz[t.pointerType]||"",this.state=t.state,this.i=t,t.defaultPrevented&&Ol.Z.h.call(this)}}Gt(Ol,Jt);var wz={2:"touch",3:"pen",4:"mouse"};Ol.prototype.h=function(){Ol.Z.h.call(this);var t=this.i;t.preventDefault?t.preventDefault():t.returnValue=!1};var vu="closure_listenable_"+(1e6*Math.random()|0),bz=0;function Iz(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ia=i,this.key=++bz,this.ca=this.fa=!1}function Of(t){t.ca=!0,t.listener=null,t.proxy=null,t.src=null,t.ia=null}function xf(t){this.src=t,this.g={},this.h=0}xf.prototype.add=function(t,e,n,r,i){var s=t.toString();t=this.g[s],t||(t=this.g[s]=[],this.h++);var o=Sm(t,e,r,i);return-1<o?(e=t[o],n||(e.fa=!1)):(e=new Iz(e,this.src,s,!!r,i),e.fa=n,t.push(e)),e};function Tm(t,e){var n=e.type;if(n in t.g){var r=t.g[n],i=Gk(r,e),s;(s=0<=i)&&Array.prototype.splice.call(r,i,1),s&&(Of(e),t.g[n].length==0&&(delete t.g[n],t.h--))}}function Sm(t,e,n,r){for(var i=0;i<t.length;++i){var s=t[i];if(!s.ca&&s.listener==e&&s.capture==!!n&&s.ia==r)return i}return-1}var zy="closure_lm_"+(1e6*Math.random()|0),Qp={};function eR(t,e,n,r,i){if(r&&r.once)return nR(t,e,n,r,i);if(Array.isArray(e)){for(var s=0;s<e.length;s++)eR(t,e[s],n,r,i);return null}return n=Jy(n),t&&t[vu]?t.N(e,n,yu(r)?!!r.capture:!!r,i):tR(t,e,n,!1,r,i)}function tR(t,e,n,r,i,s){if(!e)throw Error("Invalid event type");var o=yu(i)?!!i.capture:!!i,a=Yy(t);if(a||(t[zy]=a=new xf(t)),n=a.add(e,n,r,o,s),n.proxy)return n;if(r=Ez(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)vz||(i=o),i===void 0&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(iR(e.toString()),r);else if(t.addListener&&t.removeListener)t.addListener(r);else throw Error("addEventListener and attachEvent are unavailable.");return n}function Ez(){function t(n){return e.call(t.src,t.listener,n)}var e=Tz;return t}function nR(t,e,n,r,i){if(Array.isArray(e)){for(var s=0;s<e.length;s++)nR(t,e[s],n,r,i);return null}return n=Jy(n),t&&t[vu]?t.O(e,n,yu(r)?!!r.capture:!!r,i):tR(t,e,n,!0,r,i)}function rR(t,e,n,r,i){if(Array.isArray(e))for(var s=0;s<e.length;s++)rR(t,e[s],n,r,i);else r=yu(r)?!!r.capture:!!r,n=Jy(n),t&&t[vu]?(t=t.i,e=String(e).toString(),e in t.g&&(s=t.g[e],n=Sm(s,n,r,i),-1<n&&(Of(s[n]),Array.prototype.splice.call(s,n,1),s.length==0&&(delete t.g[e],t.h--)))):t&&(t=Yy(t))&&(e=t.g[e.toString()],t=-1,e&&(t=Sm(e,n,r,i)),(n=-1<t?e[t]:null)&&Qy(n))}function Qy(t){if(typeof t!="number"&&t&&!t.ca){var e=t.src;if(e&&e[vu])Tm(e.i,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(iR(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=Yy(e))?(Tm(n,t),n.h==0&&(n.src=null,e[zy]=null)):Of(t)}}}function iR(t){return t in Qp?Qp[t]:Qp[t]="on"+t}function Tz(t,e){if(t.ca)t=!0;else{e=new Ol(e,this);var n=t.listener,r=t.ia||t.src;t.fa&&Qy(t),t=n.call(r,e)}return t}function Yy(t){return t=t[zy],t instanceof xf?t:null}var Yp="__closure_events_fn_"+(1e9*Math.random()>>>0);function Jy(t){return typeof t=="function"?t:(t[Yp]||(t[Yp]=function(e){return t.handleEvent(e)}),t[Yp])}function Dt(){os.call(this),this.i=new xf(this),this.P=this,this.I=null}Gt(Dt,os);Dt.prototype[vu]=!0;Dt.prototype.removeEventListener=function(t,e,n,r){rR(this,t,e,n,r)};function Wt(t,e){var n,r=t.I;if(r)for(n=[];r;r=r.I)n.push(r);if(t=t.P,r=e.type||e,typeof e=="string")e=new Jt(e,t);else if(e instanceof Jt)e.target=e.target||t;else{var i=e;e=new Jt(r,t),Yk(e,i)}if(i=!0,n)for(var s=n.length-1;0<=s;s--){var o=e.g=n[s];i=Ju(o,r,!0,e)&&i}if(o=e.g=t,i=Ju(o,r,!0,e)&&i,i=Ju(o,r,!1,e)&&i,n)for(s=0;s<n.length;s++)o=e.g=n[s],i=Ju(o,r,!1,e)&&i}Dt.prototype.M=function(){if(Dt.Z.M.call(this),this.i){var t=this.i,e;for(e in t.g){for(var n=t.g[e],r=0;r<n.length;r++)Of(n[r]);delete t.g[e],t.h--}}this.I=null};Dt.prototype.N=function(t,e,n,r){return this.i.add(String(t),e,!1,n,r)};Dt.prototype.O=function(t,e,n,r){return this.i.add(String(t),e,!0,n,r)};function Ju(t,e,n,r){if(e=t.i.g[String(e)],!e)return!0;e=e.concat();for(var i=!0,s=0;s<e.length;++s){var o=e[s];if(o&&!o.ca&&o.capture==n){var a=o.listener,c=o.ia||o.src;o.fa&&Tm(t.i,o),i=a.call(c,r)!==!1&&i}}return i&&!r.defaultPrevented}var Xy=ce.JSON.stringify;function Sz(){var t=oR;let e=null;return t.g&&(e=t.g,t.g=t.g.next,t.g||(t.h=null),e.next=null),e}class Cz{constructor(){this.h=this.g=null}add(e,n){const r=sR.get();r.set(e,n),this.h?this.h.next=r:this.g=r,this.h=r}}var sR=new class{constructor(t,e){this.i=t,this.j=e,this.h=0,this.g=null}get(){let t;return 0<this.h?(this.h--,t=this.g,this.g=t.next,t.next=null):t=this.i(),t}}(()=>new Az,t=>t.reset());class Az{constructor(){this.next=this.g=this.h=null}set(e,n){this.h=e,this.g=n,this.next=null}reset(){this.next=this.g=this.h=null}}function kz(t){ce.setTimeout(()=>{throw t},0)}function Zy(t,e){Cm||Rz(),Am||(Cm(),Am=!0),oR.add(t,e)}var Cm;function Rz(){var t=ce.Promise.resolve(void 0);Cm=function(){t.then(Nz)}}var Am=!1,oR=new Cz;function Nz(){for(var t;t=Sz();){try{t.h.call(t.g)}catch(n){kz(n)}var e=sR;e.j(t),100>e.h&&(e.h++,t.next=e.g,e.g=t)}Am=!1}function Mf(t,e){Dt.call(this),this.h=t||1,this.g=e||ce,this.j=qt(this.kb,this),this.l=Date.now()}Gt(Mf,Dt);Q=Mf.prototype;Q.da=!1;Q.S=null;Q.kb=function(){if(this.da){var t=Date.now()-this.l;0<t&&t<.8*this.h?this.S=this.g.setTimeout(this.j,this.h-t):(this.S&&(this.g.clearTimeout(this.S),this.S=null),Wt(this,"tick"),this.da&&(ev(this),this.start()))}};Q.start=function(){this.da=!0,this.S||(this.S=this.g.setTimeout(this.j,this.h),this.l=Date.now())};function ev(t){t.da=!1,t.S&&(t.g.clearTimeout(t.S),t.S=null)}Q.M=function(){Mf.Z.M.call(this),ev(this),delete this.g};function tv(t,e,n){if(typeof t=="function")n&&(t=qt(t,n));else if(t&&typeof t.handleEvent=="function")t=qt(t.handleEvent,t);else throw Error("Invalid listener argument");return 2147483647<Number(e)?-1:ce.setTimeout(t,e||0)}function aR(t){t.g=tv(()=>{t.g=null,t.i&&(t.i=!1,aR(t))},t.j);const e=t.h;t.h=null,t.m.apply(null,e)}class Pz extends os{constructor(e,n){super(),this.m=e,this.j=n,this.h=null,this.i=!1,this.g=null}l(e){this.h=arguments,this.g?this.i=!0:aR(this)}M(){super.M(),this.g&&(ce.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function xl(t){os.call(this),this.h=t,this.g={}}Gt(xl,os);var cE=[];function cR(t,e,n,r){Array.isArray(n)||(n&&(cE[0]=n.toString()),n=cE);for(var i=0;i<n.length;i++){var s=eR(e,n[i],r||t.handleEvent,!1,t.h||t);if(!s)break;t.g[s.key]=s}}function lR(t){Hy(t.g,function(e,n){this.g.hasOwnProperty(n)&&Qy(e)},t),t.g={}}xl.prototype.M=function(){xl.Z.M.call(this),lR(this)};xl.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};function Lf(){this.g=!0}Lf.prototype.Aa=function(){this.g=!1};function Dz(t,e,n,r,i,s){t.info(function(){if(t.g)if(s)for(var o="",a=s.split("&"),c=0;c<a.length;c++){var l=a[c].split("=");if(1<l.length){var u=l[0];l=l[1];var h=u.split("_");o=2<=h.length&&h[1]=="type"?o+(u+"="+l+"&"):o+(u+"=redacted&")}}else o=null;else o=s;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+e+`
`+n+`
`+o})}function Oz(t,e,n,r,i,s,o){t.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+e+`
`+n+`
`+s+" "+o})}function Go(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+Mz(t,n)+(r?" "+r:"")})}function xz(t,e){t.info(function(){return"TIMEOUT: "+e})}Lf.prototype.info=function(){};function Mz(t,e){if(!t.g)return e;if(!e)return null;try{var n=JSON.parse(e);if(n){for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var s=i[0];if(s!="noop"&&s!="stop"&&s!="close")for(var o=1;o<i.length;o++)i[o]=""}}}}return Xy(n)}catch{return e}}var Co={},lE=null;function Ff(){return lE=lE||new Dt}Co.Ma="serverreachability";function uR(t){Jt.call(this,Co.Ma,t)}Gt(uR,Jt);function Ml(t){const e=Ff();Wt(e,new uR(e))}Co.STAT_EVENT="statevent";function hR(t,e){Jt.call(this,Co.STAT_EVENT,t),this.stat=e}Gt(hR,Jt);function ln(t){const e=Ff();Wt(e,new hR(e,t))}Co.Na="timingevent";function dR(t,e){Jt.call(this,Co.Na,t),this.size=e}Gt(dR,Jt);function wu(t,e){if(typeof t!="function")throw Error("Fn must not be null and must be a function");return ce.setTimeout(function(){t()},e)}var Uf={NO_ERROR:0,lb:1,yb:2,xb:3,sb:4,wb:5,zb:6,Ja:7,TIMEOUT:8,Cb:9},fR={qb:"complete",Mb:"success",Ka:"error",Ja:"abort",Eb:"ready",Fb:"readystatechange",TIMEOUT:"timeout",Ab:"incrementaldata",Db:"progress",tb:"downloadprogress",Ub:"uploadprogress"};function nv(){}nv.prototype.h=null;function uE(t){return t.h||(t.h=t.i())}function pR(){}var bu={OPEN:"a",pb:"b",Ka:"c",Bb:"d"};function rv(){Jt.call(this,"d")}Gt(rv,Jt);function iv(){Jt.call(this,"c")}Gt(iv,Jt);var km;function Vf(){}Gt(Vf,nv);Vf.prototype.g=function(){return new XMLHttpRequest};Vf.prototype.i=function(){return{}};km=new Vf;function Iu(t,e,n,r){this.l=t,this.j=e,this.m=n,this.X=r||1,this.V=new xl(this),this.P=Lz,t=Im?125:void 0,this.W=new Mf(t),this.H=null,this.i=!1,this.s=this.A=this.v=this.K=this.F=this.Y=this.B=null,this.D=[],this.g=null,this.C=0,this.o=this.u=null,this.N=-1,this.I=!1,this.O=0,this.L=null,this.aa=this.J=this.$=this.U=!1,this.h=new gR}function gR(){this.i=null,this.g="",this.h=!1}var Lz=45e3,Rm={},ud={};Q=Iu.prototype;Q.setTimeout=function(t){this.P=t};function Nm(t,e,n){t.K=1,t.v=Bf(oi(e)),t.s=n,t.U=!0,mR(t,null)}function mR(t,e){t.F=Date.now(),Eu(t),t.A=oi(t.v);var n=t.A,r=t.X;Array.isArray(r)||(r=[String(r)]),ER(n.h,"t",r),t.C=0,n=t.l.H,t.h=new gR,t.g=qR(t.l,n?e:null,!t.s),0<t.O&&(t.L=new Pz(qt(t.Ia,t,t.g),t.O)),cR(t.V,t.g,"readystatechange",t.gb),e=t.H?Qk(t.H):{},t.s?(t.u||(t.u="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.g.ea(t.A,t.u,t.s,e)):(t.u="GET",t.g.ea(t.A,t.u,null,e)),Ml(),Dz(t.j,t.u,t.A,t.m,t.X,t.s)}Q.gb=function(t){t=t.target;const e=this.L;e&&Jr(t)==3?e.l():this.Ia(t)};Q.Ia=function(t){try{if(t==this.g)e:{const u=Jr(this.g);var e=this.g.Da();const h=this.g.ba();if(!(3>u)&&(u!=3||Im||this.g&&(this.h.h||this.g.ga()||pE(this.g)))){this.I||u!=4||e==7||(e==8||0>=h?Ml(3):Ml(2)),$f(this);var n=this.g.ba();this.N=n;t:if(_R(this)){var r=pE(this.g);t="";var i=r.length,s=Jr(this.g)==4;if(!this.h.i){if(typeof TextDecoder=="undefined"){Ms(this),Wc(this);var o="";break t}this.h.i=new ce.TextDecoder}for(e=0;e<i;e++)this.h.h=!0,t+=this.h.i.decode(r[e],{stream:s&&e==i-1});r.splice(0,i),this.h.g+=t,this.C=0,o=this.h.g}else o=this.g.ga();if(this.i=n==200,Oz(this.j,this.u,this.A,this.m,this.X,u,n),this.i){if(this.$&&!this.J){t:{if(this.g){var a,c=this.g;if((a=c.g?c.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!cd(a)){var l=a;break t}}l=null}if(n=l)Go(this.j,this.m,n,"Initial handshake response via X-HTTP-Initial-Response"),this.J=!0,Pm(this,n);else{this.i=!1,this.o=3,ln(12),Ms(this),Wc(this);break e}}this.U?(yR(this,u,o),Im&&this.i&&u==3&&(cR(this.V,this.W,"tick",this.fb),this.W.start())):(Go(this.j,this.m,o,null),Pm(this,o)),u==4&&Ms(this),this.i&&!this.I&&(u==4?VR(this.l,this):(this.i=!1,Eu(this)))}else n==400&&0<o.indexOf("Unknown SID")?(this.o=3,ln(12)):(this.o=0,ln(13)),Ms(this),Wc(this)}}}catch{}finally{}};function _R(t){return t.g?t.u=="GET"&&t.K!=2&&t.l.Ba:!1}function yR(t,e,n){let r=!0,i;for(;!t.I&&t.C<n.length;)if(i=Fz(t,n),i==ud){e==4&&(t.o=4,ln(14),r=!1),Go(t.j,t.m,null,"[Incomplete Response]");break}else if(i==Rm){t.o=4,ln(15),Go(t.j,t.m,n,"[Invalid Chunk]"),r=!1;break}else Go(t.j,t.m,i,null),Pm(t,i);_R(t)&&i!=ud&&i!=Rm&&(t.h.g="",t.C=0),e!=4||n.length!=0||t.h.h||(t.o=1,ln(16),r=!1),t.i=t.i&&r,r?0<n.length&&!t.aa&&(t.aa=!0,e=t.l,e.g==t&&e.$&&!e.L&&(e.h.info("Great, no buffering proxy detected. Bytes received: "+n.length),fv(e),e.L=!0,ln(11))):(Go(t.j,t.m,n,"[Invalid Chunked Response]"),Ms(t),Wc(t))}Q.fb=function(){if(this.g){var t=Jr(this.g),e=this.g.ga();this.C<e.length&&($f(this),yR(this,t,e),this.i&&t!=4&&Eu(this))}};function Fz(t,e){var n=t.C,r=e.indexOf(`
`,n);return r==-1?ud:(n=Number(e.substring(n,r)),isNaN(n)?Rm:(r+=1,r+n>e.length?ud:(e=e.substr(r,n),t.C=r+n,e)))}Q.cancel=function(){this.I=!0,Ms(this)};function Eu(t){t.Y=Date.now()+t.P,vR(t,t.P)}function vR(t,e){if(t.B!=null)throw Error("WatchDog timer not null");t.B=wu(qt(t.eb,t),e)}function $f(t){t.B&&(ce.clearTimeout(t.B),t.B=null)}Q.eb=function(){this.B=null;const t=Date.now();0<=t-this.Y?(xz(this.j,this.A),this.K!=2&&(Ml(),ln(17)),Ms(this),this.o=2,Wc(this)):vR(this,this.Y-t)};function Wc(t){t.l.G==0||t.I||VR(t.l,t)}function Ms(t){$f(t);var e=t.L;e&&typeof e.na=="function"&&e.na(),t.L=null,ev(t.W),lR(t.V),t.g&&(e=t.g,t.g=null,e.abort(),e.na())}function Pm(t,e){try{var n=t.l;if(n.G!=0&&(n.g==t||Dm(n.i,t))){if(n.I=t.N,!t.J&&Dm(n.i,t)&&n.G==3){try{var r=n.Ca.g.parse(e)}catch{r=null}if(Array.isArray(r)&&r.length==3){var i=r;if(i[0]==0){e:if(!n.u){if(n.g)if(n.g.F+3e3<t.F)pd(n),Wf(n);else break e;dv(n),ln(18)}}else n.ta=i[1],0<n.ta-n.U&&37500>i[2]&&n.N&&n.A==0&&!n.v&&(n.v=wu(qt(n.ab,n),6e3));if(1>=CR(n.i)&&n.ka){try{n.ka()}catch{}n.ka=void 0}}else Ls(n,11)}else if((t.J||n.g==t)&&pd(n),!cd(e))for(i=n.Ca.g.parse(e),e=0;e<i.length;e++){let l=i[e];if(n.U=l[0],l=l[1],n.G==2)if(l[0]=="c"){n.J=l[1],n.la=l[2];const u=l[3];u!=null&&(n.ma=u,n.h.info("VER="+n.ma));const h=l[4];h!=null&&(n.za=h,n.h.info("SVER="+n.za));const d=l[5];d!=null&&typeof d=="number"&&0<d&&(r=1.5*d,n.K=r,n.h.info("backChannelRequestTimeoutMs_="+r)),r=n;const f=t.g;if(f){const g=f.g?f.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(g){var s=r.i;!s.g&&(sn(g,"spdy")||sn(g,"quic")||sn(g,"h2"))&&(s.j=s.l,s.g=new Set,s.h&&(av(s,s.h),s.h=null))}if(r.D){const v=f.g?f.g.getResponseHeader("X-HTTP-Session-Id"):null;v&&(r.sa=v,Qe(r.F,r.D,v))}}n.G=3,n.j&&n.j.xa(),n.$&&(n.O=Date.now()-t.F,n.h.info("Handshake RTT: "+n.O+"ms")),r=n;var o=t;if(r.oa=jR(r,r.H?r.la:null,r.W),o.J){AR(r.i,o);var a=o,c=r.K;c&&a.setTimeout(c),a.B&&($f(a),Eu(a)),r.g=o}else FR(r);0<n.l.length&&Kf(n)}else l[0]!="stop"&&l[0]!="close"||Ls(n,7);else n.G==3&&(l[0]=="stop"||l[0]=="close"?l[0]=="stop"?Ls(n,7):hv(n):l[0]!="noop"&&n.j&&n.j.wa(l),n.A=0)}}Ml(4)}catch{}}function Uz(t){if(t.R&&typeof t.R=="function")return t.R();if(typeof t=="string")return t.split("");if(bm(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}e=[],n=0;for(r in t)e[n++]=t[r];return e}function sv(t,e){if(t.forEach&&typeof t.forEach=="function")t.forEach(e,void 0);else if(bm(t)||typeof t=="string")zk(t,e,void 0);else{if(t.T&&typeof t.T=="function")var n=t.T();else if(t.R&&typeof t.R=="function")n=void 0;else if(bm(t)||typeof t=="string"){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;r=Uz(t),i=r.length;for(var s=0;s<i;s++)e.call(void 0,r[s],n&&n[s],t)}}function Ga(t,e){this.h={},this.g=[],this.i=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof Ga)for(n=t.T(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}Q=Ga.prototype;Q.R=function(){ov(this);for(var t=[],e=0;e<this.g.length;e++)t.push(this.h[this.g[e]]);return t};Q.T=function(){return ov(this),this.g.concat()};function ov(t){if(t.i!=t.g.length){for(var e=0,n=0;e<t.g.length;){var r=t.g[e];ro(t.h,r)&&(t.g[n++]=r),e++}t.g.length=n}if(t.i!=t.g.length){var i={};for(n=e=0;e<t.g.length;)r=t.g[e],ro(i,r)||(t.g[n++]=r,i[r]=1),e++;t.g.length=n}}Q.get=function(t,e){return ro(this.h,t)?this.h[t]:e};Q.set=function(t,e){ro(this.h,t)||(this.i++,this.g.push(t)),this.h[t]=e};Q.forEach=function(t,e){for(var n=this.T(),r=0;r<n.length;r++){var i=n[r],s=this.get(i);t.call(e,s,i,this)}};function ro(t,e){return Object.prototype.hasOwnProperty.call(t,e)}var wR=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Vz(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var s=t[n].substring(0,r);i=t[n].substring(r+1)}else s=t[n];e(s,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}function io(t,e){if(this.i=this.s=this.j="",this.m=null,this.o=this.l="",this.g=!1,t instanceof io){this.g=e!==void 0?e:t.g,hd(this,t.j),this.s=t.s,dd(this,t.i),fd(this,t.m),this.l=t.l,e=t.h;var n=new Ll;n.i=e.i,e.g&&(n.g=new Ga(e.g),n.h=e.h),hE(this,n),this.o=t.o}else t&&(n=String(t).match(wR))?(this.g=!!e,hd(this,n[1]||"",!0),this.s=Kc(n[2]||""),dd(this,n[3]||"",!0),fd(this,n[4]),this.l=Kc(n[5]||"",!0),hE(this,n[6]||"",!0),this.o=Kc(n[7]||"")):(this.g=!!e,this.h=new Ll(null,this.g))}io.prototype.toString=function(){var t=[],e=this.j;e&&t.push(Ac(e,dE,!0),":");var n=this.i;return(n||e=="file")&&(t.push("//"),(e=this.s)&&t.push(Ac(e,dE,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),n=this.m,n!=null&&t.push(":",String(n))),(n=this.l)&&(this.i&&n.charAt(0)!="/"&&t.push("/"),t.push(Ac(n,n.charAt(0)=="/"?Wz:qz,!0))),(n=this.h.toString())&&t.push("?",n),(n=this.o)&&t.push("#",Ac(n,Hz)),t.join("")};function oi(t){return new io(t)}function hd(t,e,n){t.j=n?Kc(e,!0):e,t.j&&(t.j=t.j.replace(/:$/,""))}function dd(t,e,n){t.i=n?Kc(e,!0):e}function fd(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.m=e}else t.m=null}function hE(t,e,n){e instanceof Ll?(t.h=e,Gz(t.h,t.g)):(n||(e=Ac(e,Kz)),t.h=new Ll(e,t.g))}function Qe(t,e,n){t.h.set(e,n)}function Bf(t){return Qe(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),t}function $z(t){return t instanceof io?oi(t):new io(t,void 0)}function Bz(t,e,n,r){var i=new io(null,void 0);return t&&hd(i,t),e&&dd(i,e),n&&fd(i,n),r&&(i.l=r),i}function Kc(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function Ac(t,e,n){return typeof t=="string"?(t=encodeURI(t).replace(e,jz),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function jz(t){return t=t.charCodeAt(0),"%"+(t>>4&15).toString(16)+(t&15).toString(16)}var dE=/[#\/\?@]/g,qz=/[#\?:]/g,Wz=/[#\?]/g,Kz=/[#\?@]/g,Hz=/#/g;function Ll(t,e){this.h=this.g=null,this.i=t||null,this.j=!!e}function as(t){t.g||(t.g=new Ga,t.h=0,t.i&&Vz(t.i,function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)}))}Q=Ll.prototype;Q.add=function(t,e){as(this),this.i=null,t=za(this,t);var n=this.g.get(t);return n||this.g.set(t,n=[]),n.push(e),this.h+=1,this};function bR(t,e){as(t),e=za(t,e),ro(t.g.h,e)&&(t.i=null,t.h-=t.g.get(e).length,t=t.g,ro(t.h,e)&&(delete t.h[e],t.i--,t.g.length>2*t.i&&ov(t)))}function IR(t,e){return as(t),e=za(t,e),ro(t.g.h,e)}Q.forEach=function(t,e){as(this),this.g.forEach(function(n,r){zk(n,function(i){t.call(e,i,r,this)},this)},this)};Q.T=function(){as(this);for(var t=this.g.R(),e=this.g.T(),n=[],r=0;r<e.length;r++)for(var i=t[r],s=0;s<i.length;s++)n.push(e[r]);return n};Q.R=function(t){as(this);var e=[];if(typeof t=="string")IR(this,t)&&(e=nE(e,this.g.get(za(this,t))));else{t=this.g.R();for(var n=0;n<t.length;n++)e=nE(e,t[n])}return e};Q.set=function(t,e){return as(this),this.i=null,t=za(this,t),IR(this,t)&&(this.h-=this.g.get(t).length),this.g.set(t,[e]),this.h+=1,this};Q.get=function(t,e){return t?(t=this.R(t),0<t.length?String(t[0]):e):e};function ER(t,e,n){bR(t,e),0<n.length&&(t.i=null,t.g.set(za(t,e),Ky(n)),t.h+=n.length)}Q.toString=function(){if(this.i)return this.i;if(!this.g)return"";for(var t=[],e=this.g.T(),n=0;n<e.length;n++){var r=e[n],i=encodeURIComponent(String(r));r=this.R(r);for(var s=0;s<r.length;s++){var o=i;r[s]!==""&&(o+="="+encodeURIComponent(String(r[s]))),t.push(o)}}return this.i=t.join("&")};function za(t,e){return e=String(e),t.j&&(e=e.toLowerCase()),e}function Gz(t,e){e&&!t.j&&(as(t),t.i=null,t.g.forEach(function(n,r){var i=r.toLowerCase();r!=i&&(bR(this,r),ER(this,i,n))},t)),t.j=e}var zz=class{constructor(t,e){this.h=t,this.g=e}};function TR(t){this.l=t||Qz,ce.PerformanceNavigationTiming?(t=ce.performance.getEntriesByType("navigation"),t=0<t.length&&(t[0].nextHopProtocol=="hq"||t[0].nextHopProtocol=="h2")):t=!!(ce.g&&ce.g.Ea&&ce.g.Ea()&&ce.g.Ea().Zb),this.j=t?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var Qz=10;function SR(t){return t.h?!0:t.g?t.g.size>=t.j:!1}function CR(t){return t.h?1:t.g?t.g.size:0}function Dm(t,e){return t.h?t.h==e:t.g?t.g.has(e):!1}function av(t,e){t.g?t.g.add(e):t.h=e}function AR(t,e){t.h&&t.h==e?t.h=null:t.g&&t.g.has(e)&&t.g.delete(e)}TR.prototype.cancel=function(){if(this.i=kR(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const t of this.g.values())t.cancel();this.g.clear()}};function kR(t){if(t.h!=null)return t.i.concat(t.h.D);if(t.g!=null&&t.g.size!==0){let e=t.i;for(const n of t.g.values())e=e.concat(n.D);return e}return Ky(t.i)}function cv(){}cv.prototype.stringify=function(t){return ce.JSON.stringify(t,void 0)};cv.prototype.parse=function(t){return ce.JSON.parse(t,void 0)};function Yz(){this.g=new cv}function Jz(t,e,n){const r=n||"";try{sv(t,function(i,s){let o=i;yu(i)&&(o=Xy(i)),e.push(r+s+"="+encodeURIComponent(o))})}catch(i){throw e.push(r+"type="+encodeURIComponent("_badmap")),i}}function Xz(t,e){const n=new Lf;if(ce.Image){const r=new Image;r.onload=Yu(Xu,n,r,"TestLoadImage: loaded",!0,e),r.onerror=Yu(Xu,n,r,"TestLoadImage: error",!1,e),r.onabort=Yu(Xu,n,r,"TestLoadImage: abort",!1,e),r.ontimeout=Yu(Xu,n,r,"TestLoadImage: timeout",!1,e),ce.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=t}else e(!1)}function Xu(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch{}}function Tu(t){this.l=t.$b||null,this.j=t.ib||!1}Gt(Tu,nv);Tu.prototype.g=function(){return new jf(this.l,this.j)};Tu.prototype.i=function(t){return function(){return t}}({});function jf(t,e){Dt.call(this),this.D=t,this.u=e,this.m=void 0,this.readyState=lv,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}Gt(jf,Dt);var lv=0;Q=jf.prototype;Q.open=function(t,e){if(this.readyState!=lv)throw this.abort(),Error("Error reopening a connection");this.C=t,this.B=e,this.readyState=1,Fl(this)};Q.send=function(t){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};t&&(e.body=t),(this.D||ce).fetch(new Request(this.B,e)).then(this.Va.bind(this),this.ha.bind(this))};Q.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted."),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Su(this)),this.readyState=lv};Q.Va=function(t){if(this.g&&(this.l=t,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=t.headers,this.readyState=2,Fl(this)),this.g&&(this.readyState=3,Fl(this),this.g)))if(this.responseType==="arraybuffer")t.arrayBuffer().then(this.Ta.bind(this),this.ha.bind(this));else if(typeof ce.ReadableStream!="undefined"&&"body"in t){if(this.j=t.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;RR(this)}else t.text().then(this.Ua.bind(this),this.ha.bind(this))};function RR(t){t.j.read().then(t.Sa.bind(t)).catch(t.ha.bind(t))}Q.Sa=function(t){if(this.g){if(this.u&&t.value)this.response.push(t.value);else if(!this.u){var e=t.value?t.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!t.done}))&&(this.response=this.responseText+=e)}t.done?Su(this):Fl(this),this.readyState==3&&RR(this)}};Q.Ua=function(t){this.g&&(this.response=this.responseText=t,Su(this))};Q.Ta=function(t){this.g&&(this.response=t,Su(this))};Q.ha=function(){this.g&&Su(this)};function Su(t){t.readyState=4,t.l=null,t.j=null,t.A=null,Fl(t)}Q.setRequestHeader=function(t,e){this.v.append(t,e)};Q.getResponseHeader=function(t){return this.h&&this.h.get(t.toLowerCase())||""};Q.getAllResponseHeaders=function(){if(!this.h)return"";const t=[],e=this.h.entries();for(var n=e.next();!n.done;)n=n.value,t.push(n[0]+": "+n[1]),n=e.next();return t.join(`\r
`)};function Fl(t){t.onreadystatechange&&t.onreadystatechange.call(t)}Object.defineProperty(jf.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(t){this.m=t?"include":"same-origin"}});var Zz=ce.JSON.parse;function dt(t){Dt.call(this),this.headers=new Ga,this.u=t||null,this.h=!1,this.C=this.g=null,this.H="",this.m=0,this.j="",this.l=this.F=this.v=this.D=!1,this.B=0,this.A=null,this.J=NR,this.K=this.L=!1}Gt(dt,Dt);var NR="",e2=/^https?$/i,t2=["POST","PUT"];Q=dt.prototype;Q.ea=function(t,e,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.H+"; newUri="+t);e=e?e.toUpperCase():"GET",this.H=t,this.j="",this.m=0,this.D=!1,this.h=!0,this.g=this.u?this.u.g():km.g(),this.C=this.u?uE(this.u):uE(km),this.g.onreadystatechange=qt(this.Fa,this);try{this.F=!0,this.g.open(e,String(t),!0),this.F=!1}catch(s){fE(this,s);return}t=n||"";const i=new Ga(this.headers);r&&sv(r,function(s,o){i.set(o,s)}),r=dz(i.T()),n=ce.FormData&&t instanceof ce.FormData,!(0<=Gk(t2,e))||r||n||i.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),i.forEach(function(s,o){this.g.setRequestHeader(o,s)},this),this.J&&(this.g.responseType=this.J),"withCredentials"in this.g&&this.g.withCredentials!==this.L&&(this.g.withCredentials=this.L);try{OR(this),0<this.B&&((this.K=n2(this.g))?(this.g.timeout=this.B,this.g.ontimeout=qt(this.pa,this)):this.A=tv(this.pa,this.B,this)),this.v=!0,this.g.send(t),this.v=!1}catch(s){fE(this,s)}};function n2(t){return Ea&&_z()&&typeof t.timeout=="number"&&t.ontimeout!==void 0}function r2(t){return t.toLowerCase()=="content-type"}Q.pa=function(){typeof Wy!="undefined"&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,Wt(this,"timeout"),this.abort(8))};function fE(t,e){t.h=!1,t.g&&(t.l=!0,t.g.abort(),t.l=!1),t.j=e,t.m=5,PR(t),qf(t)}function PR(t){t.D||(t.D=!0,Wt(t,"complete"),Wt(t,"error"))}Q.abort=function(t){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=t||7,Wt(this,"complete"),Wt(this,"abort"),qf(this))};Q.M=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),qf(this,!0)),dt.Z.M.call(this)};Q.Fa=function(){this.s||(this.F||this.v||this.l?DR(this):this.cb())};Q.cb=function(){DR(this)};function DR(t){if(t.h&&typeof Wy!="undefined"&&(!t.C[1]||Jr(t)!=4||t.ba()!=2)){if(t.v&&Jr(t)==4)tv(t.Fa,0,t);else if(Wt(t,"readystatechange"),Jr(t)==4){t.h=!1;try{const a=t.ba();e:switch(a){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break e;default:e=!1}var n;if(!(n=e)){var r;if(r=a===0){var i=String(t.H).match(wR)[1]||null;if(!i&&ce.self&&ce.self.location){var s=ce.self.location.protocol;i=s.substr(0,s.length-1)}r=!e2.test(i?i.toLowerCase():"")}n=r}if(n)Wt(t,"complete"),Wt(t,"success");else{t.m=6;try{var o=2<Jr(t)?t.g.statusText:""}catch{o=""}t.j=o+" ["+t.ba()+"]",PR(t)}}finally{qf(t)}}}}function qf(t,e){if(t.g){OR(t);const n=t.g,r=t.C[0]?ad:null;t.g=null,t.C=null,e||Wt(t,"ready");try{n.onreadystatechange=r}catch{}}}function OR(t){t.g&&t.K&&(t.g.ontimeout=null),t.A&&(ce.clearTimeout(t.A),t.A=null)}function Jr(t){return t.g?t.g.readyState:0}Q.ba=function(){try{return 2<Jr(this)?this.g.status:-1}catch{return-1}};Q.ga=function(){try{return this.g?this.g.responseText:""}catch{return""}};Q.Qa=function(t){if(this.g){var e=this.g.responseText;return t&&e.indexOf(t)==0&&(e=e.substring(t.length)),Zz(e)}};function pE(t){try{if(!t.g)return null;if("response"in t.g)return t.g.response;switch(t.J){case NR:case"text":return t.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in t.g)return t.g.mozResponseArrayBuffer}return null}catch{return null}}Q.Da=function(){return this.m};Q.La=function(){return typeof this.j=="string"?this.j:String(this.j)};function i2(t){let e="";return Hy(t,function(n,r){e+=r,e+=":",e+=n,e+=`\r
`}),e}function uv(t,e,n){e:{for(r in n){var r=!1;break e}r=!0}r||(n=i2(n),typeof t=="string"?n!=null&&encodeURIComponent(String(n)):Qe(t,e,n))}function gc(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function xR(t){this.za=0,this.l=[],this.h=new Lf,this.la=this.oa=this.F=this.W=this.g=this.sa=this.D=this.aa=this.o=this.P=this.s=null,this.Za=this.V=0,this.Xa=gc("failFast",!1,t),this.N=this.v=this.u=this.m=this.j=null,this.X=!0,this.I=this.ta=this.U=-1,this.Y=this.A=this.C=0,this.Pa=gc("baseRetryDelayMs",5e3,t),this.$a=gc("retryDelaySeedMs",1e4,t),this.Ya=gc("forwardChannelMaxRetries",2,t),this.ra=gc("forwardChannelRequestTimeoutMs",2e4,t),this.qa=t&&t.xmlHttpFactory||void 0,this.Ba=t&&t.Yb||!1,this.K=void 0,this.H=t&&t.supportsCrossDomainXhr||!1,this.J="",this.i=new TR(t&&t.concurrentRequestLimit),this.Ca=new Yz,this.ja=t&&t.fastHandshake||!1,this.Ra=t&&t.Wb||!1,t&&t.Aa&&this.h.Aa(),t&&t.forceLongPolling&&(this.X=!1),this.$=!this.ja&&this.X&&t&&t.detectBufferingProxy||!1,this.ka=void 0,this.O=0,this.L=!1,this.B=null,this.Wa=!t||t.Xb!==!1}Q=xR.prototype;Q.ma=8;Q.G=1;function hv(t){if(MR(t),t.G==3){var e=t.V++,n=oi(t.F);Qe(n,"SID",t.J),Qe(n,"RID",e),Qe(n,"TYPE","terminate"),Cu(t,n),e=new Iu(t,t.h,e,void 0),e.K=2,e.v=Bf(oi(n)),n=!1,ce.navigator&&ce.navigator.sendBeacon&&(n=ce.navigator.sendBeacon(e.v.toString(),"")),!n&&ce.Image&&(new Image().src=e.v,n=!0),n||(e.g=qR(e.l,null),e.g.ea(e.v)),e.F=Date.now(),Eu(e)}BR(t)}Q.hb=function(t){try{this.h.info("Origin Trials invoked: "+t)}catch{}};function Wf(t){t.g&&(fv(t),t.g.cancel(),t.g=null)}function MR(t){Wf(t),t.u&&(ce.clearTimeout(t.u),t.u=null),pd(t),t.i.cancel(),t.m&&(typeof t.m=="number"&&ce.clearTimeout(t.m),t.m=null)}function Jp(t,e){t.l.push(new zz(t.Za++,e)),t.G==3&&Kf(t)}function Kf(t){SR(t.i)||t.m||(t.m=!0,Zy(t.Ha,t),t.C=0)}function s2(t,e){return CR(t.i)>=t.i.j-(t.m?1:0)?!1:t.m?(t.l=e.D.concat(t.l),!0):t.G==1||t.G==2||t.C>=(t.Xa?0:t.Ya)?!1:(t.m=wu(qt(t.Ha,t,e),$R(t,t.C)),t.C++,!0)}Q.Ha=function(t){if(this.m)if(this.m=null,this.G==1){if(!t){this.V=Math.floor(1e5*Math.random()),t=this.V++;const i=new Iu(this,this.h,t,void 0);let s=this.s;if(this.P&&(s?(s=Qk(s),Yk(s,this.P)):s=this.P),this.o===null&&(i.H=s),this.ja)e:{for(var e=0,n=0;n<this.l.length;n++){t:{var r=this.l[n];if("__data__"in r.g&&(r=r.g.__data__,typeof r=="string")){r=r.length;break t}r=void 0}if(r===void 0)break;if(e+=r,4096<e){e=n;break e}if(e===4096||n===this.l.length-1){e=n+1;break e}}e=1e3}else e=1e3;e=LR(this,i,e),n=oi(this.F),Qe(n,"RID",t),Qe(n,"CVER",22),this.D&&Qe(n,"X-HTTP-Session-Id",this.D),Cu(this,n),this.o&&s&&uv(n,this.o,s),av(this.i,i),this.Ra&&Qe(n,"TYPE","init"),this.ja?(Qe(n,"$req",e),Qe(n,"SID","null"),i.$=!0,Nm(i,n,null)):Nm(i,n,e),this.G=2}}else this.G==3&&(t?gE(this,t):this.l.length==0||SR(this.i)||gE(this))};function gE(t,e){var n;e?n=e.m:n=t.V++;const r=oi(t.F);Qe(r,"SID",t.J),Qe(r,"RID",n),Qe(r,"AID",t.U),Cu(t,r),t.o&&t.s&&uv(r,t.o,t.s),n=new Iu(t,t.h,n,t.C+1),t.o===null&&(n.H=t.s),e&&(t.l=e.D.concat(t.l)),e=LR(t,n,1e3),n.setTimeout(Math.round(.5*t.ra)+Math.round(.5*t.ra*Math.random())),av(t.i,n),Nm(n,r,e)}function Cu(t,e){t.j&&sv({},function(n,r){Qe(e,r,n)})}function LR(t,e,n){n=Math.min(t.l.length,n);var r=t.j?qt(t.j.Oa,t.j,t):null;e:{var i=t.l;let s=-1;for(;;){const o=["count="+n];s==-1?0<n?(s=i[0].h,o.push("ofs="+s)):s=0:o.push("ofs="+s);let a=!0;for(let c=0;c<n;c++){let l=i[c].h;const u=i[c].g;if(l-=s,0>l)s=Math.max(0,i[c].h-100),a=!1;else try{Jz(u,o,"req"+l+"_")}catch{r&&r(u)}}if(a){r=o.join("&");break e}}}return t=t.l.splice(0,n),e.D=t,r}function FR(t){t.g||t.u||(t.Y=1,Zy(t.Ga,t),t.A=0)}function dv(t){return t.g||t.u||3<=t.A?!1:(t.Y++,t.u=wu(qt(t.Ga,t),$R(t,t.A)),t.A++,!0)}Q.Ga=function(){if(this.u=null,UR(this),this.$&&!(this.L||this.g==null||0>=this.O)){var t=2*this.O;this.h.info("BP detection timer enabled: "+t),this.B=wu(qt(this.bb,this),t)}};Q.bb=function(){this.B&&(this.B=null,this.h.info("BP detection timeout reached."),this.h.info("Buffering proxy detected and switch to long-polling!"),this.N=!1,this.L=!0,ln(10),Wf(this),UR(this))};function fv(t){t.B!=null&&(ce.clearTimeout(t.B),t.B=null)}function UR(t){t.g=new Iu(t,t.h,"rpc",t.Y),t.o===null&&(t.g.H=t.s),t.g.O=0;var e=oi(t.oa);Qe(e,"RID","rpc"),Qe(e,"SID",t.J),Qe(e,"CI",t.N?"0":"1"),Qe(e,"AID",t.U),Cu(t,e),Qe(e,"TYPE","xmlhttp"),t.o&&t.s&&uv(e,t.o,t.s),t.K&&t.g.setTimeout(t.K);var n=t.g;t=t.la,n.K=1,n.v=Bf(oi(e)),n.s=null,n.U=!0,mR(n,t)}Q.ab=function(){this.v!=null&&(this.v=null,Wf(this),dv(this),ln(19))};function pd(t){t.v!=null&&(ce.clearTimeout(t.v),t.v=null)}function VR(t,e){var n=null;if(t.g==e){pd(t),fv(t),t.g=null;var r=2}else if(Dm(t.i,e))n=e.D,AR(t.i,e),r=1;else return;if(t.I=e.N,t.G!=0){if(e.i)if(r==1){n=e.s?e.s.length:0,e=Date.now()-e.F;var i=t.C;r=Ff(),Wt(r,new dR(r,n)),Kf(t)}else FR(t);else if(i=e.o,i==3||i==0&&0<t.I||!(r==1&&s2(t,e)||r==2&&dv(t)))switch(n&&0<n.length&&(e=t.i,e.i=e.i.concat(n)),i){case 1:Ls(t,5);break;case 4:Ls(t,10);break;case 3:Ls(t,6);break;default:Ls(t,2)}}}function $R(t,e){let n=t.Pa+Math.floor(Math.random()*t.$a);return t.j||(n*=2),n*e}function Ls(t,e){if(t.h.info("Error code "+e),e==2){var n=null;t.j&&(n=null);var r=qt(t.jb,t);n||(n=new io("//www.google.com/images/cleardot.gif"),ce.location&&ce.location.protocol=="http"||hd(n,"https"),Bf(n)),Xz(n.toString(),r)}else ln(2);t.G=0,t.j&&t.j.va(e),BR(t),MR(t)}Q.jb=function(t){t?(this.h.info("Successfully pinged google.com"),ln(2)):(this.h.info("Failed to ping google.com"),ln(1))};function BR(t){t.G=0,t.I=-1,t.j&&((kR(t.i).length!=0||t.l.length!=0)&&(t.i.i.length=0,Ky(t.l),t.l.length=0),t.j.ua())}function jR(t,e,n){let r=$z(n);if(r.i!="")e&&dd(r,e+"."+r.i),fd(r,r.m);else{const i=ce.location;r=Bz(i.protocol,e?e+"."+i.hostname:i.hostname,+i.port,n)}return t.aa&&Hy(t.aa,function(i,s){Qe(r,s,i)}),e=t.D,n=t.sa,e&&n&&Qe(r,e,n),Qe(r,"VER",t.ma),Cu(t,r),r}function qR(t,e,n){if(e&&!t.H)throw Error("Can't create secondary domain capable XhrIo object.");return e=n&&t.Ba&&!t.qa?new dt(new Tu({ib:!0})):new dt(t.qa),e.L=t.H,e}function WR(){}Q=WR.prototype;Q.xa=function(){};Q.wa=function(){};Q.va=function(){};Q.ua=function(){};Q.Oa=function(){};function gd(){if(Ea&&!(10<=Number(yz)))throw Error("Environmental error: no available transport.")}gd.prototype.g=function(t,e){return new On(t,e)};function On(t,e){Dt.call(this),this.g=new xR(e),this.l=t,this.h=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.g.s=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.ya&&(t?t["X-WebChannel-Client-Profile"]=e.ya:t={"X-WebChannel-Client-Profile":e.ya}),this.g.P=t,(t=e&&e.httpHeadersOverwriteParam)&&!cd(t)&&(this.g.o=t),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!cd(e)&&(this.g.D=e,t=this.h,t!==null&&e in t&&(t=this.h,e in t&&delete t[e])),this.j=new Qa(this)}Gt(On,Dt);On.prototype.m=function(){this.g.j=this.j,this.A&&(this.g.H=!0);var t=this.g,e=this.l,n=this.h||void 0;t.Wa&&(t.h.info("Origin Trials enabled."),Zy(qt(t.hb,t,e))),ln(0),t.W=e,t.aa=n||{},t.N=t.X,t.F=jR(t,null,t.W),Kf(t)};On.prototype.close=function(){hv(this.g)};On.prototype.u=function(t){if(typeof t=="string"){var e={};e.__data__=t,Jp(this.g,e)}else this.v?(e={},e.__data__=Xy(t),Jp(this.g,e)):Jp(this.g,t)};On.prototype.M=function(){this.g.j=null,delete this.j,hv(this.g),delete this.g,On.Z.M.call(this)};function KR(t){rv.call(this);var e=t.__sm__;if(e){e:{for(const n in e){t=n;break e}t=void 0}(this.i=t)&&(t=this.i,e=e!==null&&t in e?e[t]:void 0),this.data=e}else this.data=t}Gt(KR,rv);function HR(){iv.call(this),this.status=1}Gt(HR,iv);function Qa(t){this.g=t}Gt(Qa,WR);Qa.prototype.xa=function(){Wt(this.g,"a")};Qa.prototype.wa=function(t){Wt(this.g,new KR(t))};Qa.prototype.va=function(t){Wt(this.g,new HR)};Qa.prototype.ua=function(){Wt(this.g,"b")};gd.prototype.createWebChannel=gd.prototype.g;On.prototype.send=On.prototype.u;On.prototype.open=On.prototype.m;On.prototype.close=On.prototype.close;Uf.NO_ERROR=0;Uf.TIMEOUT=8;Uf.HTTP_ERROR=6;fR.COMPLETE="complete";pR.EventType=bu;bu.OPEN="a";bu.CLOSE="b";bu.ERROR="c";bu.MESSAGE="d";Dt.prototype.listen=Dt.prototype.N;dt.prototype.listenOnce=dt.prototype.O;dt.prototype.getLastError=dt.prototype.La;dt.prototype.getLastErrorCode=dt.prototype.Da;dt.prototype.getStatus=dt.prototype.ba;dt.prototype.getResponseJson=dt.prototype.Qa;dt.prototype.getResponseText=dt.prototype.ga;dt.prototype.send=dt.prototype.ea;var o2=function(){return new gd},a2=function(){return Ff()},Xp=Uf,c2=fR,l2=Co,mE={rb:0,ub:1,vb:2,Ob:3,Tb:4,Qb:5,Rb:6,Pb:7,Nb:8,Sb:9,PROXY:10,NOPROXY:11,Lb:12,Hb:13,Ib:14,Gb:15,Jb:16,Kb:17,nb:18,mb:19,ob:20},u2=Tu,Zu=pR,h2=dt;const _E="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class It{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}It.UNAUTHENTICATED=new It(null),It.GOOGLE_CREDENTIALS=new It("google-credentials-uid"),It.FIRST_PARTY=new It("first-party-uid"),It.MOCK_USER=new It("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ya="9.9.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ji=new $r("@firebase/firestore");function Om(){return Ji.logLevel}function d2(t){Ji.setLogLevel(t)}function L(t,...e){if(Ji.logLevel<=ge.DEBUG){const n=e.map(pv);Ji.debug(`Firestore (${Ya}): ${t}`,...n)}}function ht(t,...e){if(Ji.logLevel<=ge.ERROR){const n=e.map(pv);Ji.error(`Firestore (${Ya}): ${t}`,...n)}}function Ul(t,...e){if(Ji.logLevel<=ge.WARN){const n=e.map(pv);Ji.warn(`Firestore (${Ya}): ${t}`,...n)}}function pv(t){if(typeof t=="string")return t;try{return e=t,JSON.stringify(e)}catch{return t}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/var e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Y(t="Unexpected state"){const e=`FIRESTORE (${Ya}) INTERNAL ASSERTION FAILED: `+t;throw ht(e),new Error(e)}function ae(t,e){t||Y()}function f2(t,e){t||Y()}function G(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const C={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class O extends ct{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class St{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GR{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class p2{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(It.UNAUTHENTICATED))}shutdown(){}}class g2{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class m2{constructor(e){this.t=e,this.currentUser=It.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){let r=this.i;const i=c=>this.i!==r?(r=this.i,n(c)):Promise.resolve();let s=new St;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new St,e.enqueueRetryable(()=>i(this.currentUser))};const o=()=>{const c=s;e.enqueueRetryable(async()=>{await c.promise,await i(this.currentUser)})},a=c=>{L("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.auth.addAuthTokenListener(this.o),o()};this.t.onInit(c=>a(c)),setTimeout(()=>{if(!this.auth){const c=this.t.getImmediate({optional:!0});c?a(c):(L("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new St)}},0),o()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(L("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(ae(typeof r.accessToken=="string"),new GR(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const e=this.auth&&this.auth.getUid();return ae(e===null||typeof e=="string"),new It(e)}}class _2{constructor(e,n,r){this.type="FirstParty",this.user=It.FIRST_PARTY,this.headers=new Map,this.headers.set("X-Goog-AuthUser",n);const i=e.auth.getAuthHeaderValueForFirstParty([]);i&&this.headers.set("Authorization",i),r&&this.headers.set("X-Goog-Iam-Authorization-Token",r)}}class y2{constructor(e,n,r){this.h=e,this.l=n,this.m=r}getToken(){return Promise.resolve(new _2(this.h,this.l,this.m))}start(e,n){e.enqueueRetryable(()=>n(It.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class v2{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class w2{constructor(e){this.g=e,this.forceRefresh=!1,this.appCheck=null,this.p=null}start(e,n){const r=s=>{s.error!=null&&L("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const o=s.token!==this.p;return this.p=s.token,L("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};const i=s=>{L("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.appCheck.addTokenListener(this.o)};this.g.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){const s=this.g.getImmediate({optional:!0});s?i(s):L("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(ae(typeof n.token=="string"),this.p=n.token,new v2(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function b2(t){const e=typeof self!="undefined"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zR{static I(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=Math.floor(256/e.length)*e.length;let r="";for(;r.length<20;){const i=b2(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<n&&(r+=e.charAt(i[s]%e.length))}return r}}function ue(t,e){return t<e?-1:t>e?1:0}function Ta(t,e,n){return t.length===e.length&&t.every((r,i)=>n(r,e[i]))}function QR(t){return t+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Je{constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new O(C.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new O(C.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<-62135596800)throw new O(C.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new O(C.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return Je.fromMillis(Date.now())}static fromDate(e){return Je.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*n));return new Je(n,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?ue(this.nanoseconds,e.nanoseconds):ue(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class se{constructor(e){this.timestamp=e}static fromTimestamp(e){return new se(e)}static min(){return new se(new Je(0,0))}static max(){return new se(new Je(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vl{constructor(e,n,r){n===void 0?n=0:n>e.length&&Y(),r===void 0?r=e.length-n:r>e.length-n&&Y(),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return Vl.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof Vl?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let i=0;i<r;i++){const s=e.get(i),o=n.get(i);if(s<o)return-1;if(s>o)return 1}return e.length<n.length?-1:e.length>n.length?1:0}}class Ee extends Vl{construct(e,n,r){return new Ee(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new O(C.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(i=>i.length>0))}return new Ee(n)}static emptyPath(){return new Ee([])}}const I2=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class ot extends Vl{construct(e,n,r){return new ot(e,n,r)}static isValidIdentifier(e){return I2.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),ot.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new ot(["__name__"])}static fromServerFormat(e){const n=[];let r="",i=0;const s=()=>{if(r.length===0)throw new O(C.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let o=!1;for(;i<e.length;){const a=e[i];if(a==="\\"){if(i+1===e.length)throw new O(C.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const c=e[i+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new O(C.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=c,i+=2}else a==="`"?(o=!o,i++):a!=="."||o?(r+=a,i++):(s(),i++)}if(s(),o)throw new O(C.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new ot(n)}static emptyPath(){return new ot([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W{constructor(e){this.path=e}static fromPath(e){return new W(Ee.fromString(e))}static fromName(e){return new W(Ee.fromString(e).popFirst(5))}static empty(){return new W(Ee.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Ee.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return Ee.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new W(new Ee(e.slice()))}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YR{constructor(e,n,r,i){this.indexId=e,this.collectionGroup=n,this.fields=r,this.indexState=i}}function xm(t){return t.fields.find(e=>e.kind===2)}function Is(t){return t.fields.filter(e=>e.kind!==2)}YR.UNKNOWN_ID=-1;class E2{constructor(e,n){this.fieldPath=e,this.kind=n}}class md{constructor(e,n){this.sequenceNumber=e,this.offset=n}static empty(){return new md(0,xn.min())}}function JR(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,i=se.fromTimestamp(r===1e9?new Je(n+1,0):new Je(n,r));return new xn(i,W.empty(),e)}function XR(t){return new xn(t.readTime,t.key,-1)}class xn{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new xn(se.min(),W.empty(),-1)}static max(){return new xn(se.max(),W.empty(),-1)}}function gv(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=W.comparator(t.documentKey,e.documentKey),n!==0?n:ue(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZR="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class eN{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function cs(t){if(t.code!==C.FAILED_PRECONDITION||t.message!==ZR)throw t;L("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&Y(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new T((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(n,s).next(r,i)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof T?n:T.resolve(n)}catch(n){return T.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):T.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):T.reject(n)}static resolve(e){return new T((n,r)=>{n(e)})}static reject(e){return new T((n,r)=>{r(e)})}static waitFor(e){return new T((n,r)=>{let i=0,s=0,o=!1;e.forEach(a=>{++i,a.next(()=>{++s,o&&s===i&&n()},c=>r(c))}),o=!0,s===i&&n()})}static or(e){let n=T.resolve(!1);for(const r of e)n=n.next(i=>i?T.resolve(i):r());return n}static forEach(e,n){const r=[];return e.forEach((i,s)=>{r.push(n.call(this,i,s))}),this.waitFor(r)}static mapArray(e,n){return new T((r,i)=>{const s=e.length,o=new Array(s);let a=0;for(let c=0;c<s;c++){const l=c;n(e[l]).next(u=>{o[l]=u,++a,a===s&&r(o)},u=>i(u))}})}static doWhile(e,n){return new T((r,i)=>{const s=()=>{e()===!0?n().next(()=>{s()},i):r()};s()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hf{constructor(e,n){this.action=e,this.transaction=n,this.aborted=!1,this.T=new St,this.transaction.oncomplete=()=>{this.T.resolve()},this.transaction.onabort=()=>{n.error?this.T.reject(new Hc(e,n.error)):this.T.resolve()},this.transaction.onerror=r=>{const i=mv(r.target.error);this.T.reject(new Hc(e,i))}}static open(e,n,r,i){try{return new Hf(n,e.transaction(i,r))}catch(s){throw new Hc(n,s)}}get A(){return this.T.promise}abort(e){e&&this.T.reject(e),this.aborted||(L("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}R(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const n=this.transaction.objectStore(e);return new S2(n)}}class ir{constructor(e,n,r){this.name=e,this.version=n,this.P=r,ir.v(ze())===12.2&&ht("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return L("SimpleDb","Removing database:",e),Cs(window.indexedDB.deleteDatabase(e)).toPromise()}static V(){if(!bn())return!1;if(ir.S())return!0;const e=ze(),n=ir.v(e),r=0<n&&n<10,i=ir.D(e),s=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||s)}static S(){var e;return typeof process!="undefined"&&((e=process.env)===null||e===void 0?void 0:e.C)==="YES"}static N(e,n){return e.store(n)}static v(e){const n=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=n?n[1].split("_").slice(0,2).join("."):"-1";return Number(r)}static D(e){const n=e.match(/Android ([\d.]+)/i),r=n?n[1].split(".").slice(0,2).join("."):"-1";return Number(r)}async k(e){return this.db||(L("SimpleDb","Opening database:",this.name),this.db=await new Promise((n,r)=>{const i=indexedDB.open(this.name,this.version);i.onsuccess=s=>{const o=s.target.result;n(o)},i.onblocked=()=>{r(new Hc(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=s=>{const o=s.target.error;o.name==="VersionError"?r(new O(C.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?r(new O(C.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):r(new Hc(e,o))},i.onupgradeneeded=s=>{L("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',s.oldVersion);const o=s.target.result;this.P.O(o,i.transaction,s.oldVersion,this.version).next(()=>{L("SimpleDb","Database upgrade to version "+this.version+" complete")})}})),this.M&&(this.db.onversionchange=n=>this.M(n)),this.db}F(e){this.M=e,this.db&&(this.db.onversionchange=n=>e(n))}async runTransaction(e,n,r,i){const s=n==="readonly";let o=0;for(;;){++o;try{this.db=await this.k(e);const a=Hf.open(this.db,e,s?"readonly":"readwrite",r),c=i(a).next(l=>(a.R(),l)).catch(l=>(a.abort(l),T.reject(l))).toPromise();return c.catch(()=>{}),await a.A,c}catch(a){const c=a,l=c.name!=="FirebaseError"&&o<3;if(L("SimpleDb","Transaction failed with error:",c.message,"Retrying:",l),this.close(),!l)return Promise.reject(c)}}}close(){this.db&&this.db.close(),this.db=void 0}}class T2{constructor(e){this.$=e,this.B=!1,this.L=null}get isDone(){return this.B}get U(){return this.L}set cursor(e){this.$=e}done(){this.B=!0}q(e){this.L=e}delete(){return Cs(this.$.delete())}}class Hc extends O{constructor(e,n){super(C.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${n}`),this.name="IndexedDbTransactionError"}}function ls(t){return t.name==="IndexedDbTransactionError"}class S2{constructor(e){this.store=e}put(e,n){let r;return n!==void 0?(L("SimpleDb","PUT",this.store.name,e,n),r=this.store.put(n,e)):(L("SimpleDb","PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),Cs(r)}add(e){return L("SimpleDb","ADD",this.store.name,e,e),Cs(this.store.add(e))}get(e){return Cs(this.store.get(e)).next(n=>(n===void 0&&(n=null),L("SimpleDb","GET",this.store.name,e,n),n))}delete(e){return L("SimpleDb","DELETE",this.store.name,e),Cs(this.store.delete(e))}count(){return L("SimpleDb","COUNT",this.store.name),Cs(this.store.count())}K(e,n){const r=this.options(e,n);if(r.index||typeof this.store.getAll!="function"){const i=this.cursor(r),s=[];return this.G(i,(o,a)=>{s.push(a)}).next(()=>s)}{const i=this.store.getAll(r.range);return new T((s,o)=>{i.onerror=a=>{o(a.target.error)},i.onsuccess=a=>{s(a.target.result)}})}}j(e,n){const r=this.store.getAll(e,n===null?void 0:n);return new T((i,s)=>{r.onerror=o=>{s(o.target.error)},r.onsuccess=o=>{i(o.target.result)}})}W(e,n){L("SimpleDb","DELETE ALL",this.store.name);const r=this.options(e,n);r.H=!1;const i=this.cursor(r);return this.G(i,(s,o,a)=>a.delete())}J(e,n){let r;n?r=e:(r={},n=e);const i=this.cursor(r);return this.G(i,n)}Y(e){const n=this.cursor({});return new T((r,i)=>{n.onerror=s=>{const o=mv(s.target.error);i(o)},n.onsuccess=s=>{const o=s.target.result;o?e(o.primaryKey,o.value).next(a=>{a?o.continue():r()}):r()}})}G(e,n){const r=[];return new T((i,s)=>{e.onerror=o=>{s(o.target.error)},e.onsuccess=o=>{const a=o.target.result;if(!a)return void i();const c=new T2(a),l=n(a.primaryKey,a.value,c);if(l instanceof T){const u=l.catch(h=>(c.done(),T.reject(h)));r.push(u)}c.isDone?i():c.U===null?a.continue():a.continue(c.U)}}).next(()=>T.waitFor(r))}options(e,n){let r;return e!==void 0&&(typeof e=="string"?r=e:n=e),{index:r,range:n}}cursor(e){let n="next";if(e.reverse&&(n="prev"),e.index){const r=this.store.index(e.index);return e.H?r.openKeyCursor(e.range,n):r.openCursor(e.range,n)}return this.store.openCursor(e.range,n)}}function Cs(t){return new T((e,n)=>{t.onsuccess=r=>{const i=r.target.result;e(i)},t.onerror=r=>{const i=mv(r.target.error);n(i)}})}let yE=!1;function mv(t){const e=ir.v(ze());if(e>=12.2&&e<13){const n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){const r=new O("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${n}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return yE||(yE=!0,setTimeout(()=>{throw r},0)),r}}return t}class C2{constructor(e,n){this.asyncQueue=e,this.X=n,this.task=null}start(){}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}Z(e){L("IndexBackiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{L("IndexBackiller",`Documents written: ${await this.X.tt()}`)}catch(n){ls(n)?L("IndexBackiller","Ignoring IndexedDB error during index backfill: ",n):await cs(n)}await this.Z(1)})}}class A2{constructor(e,n){this.localStore=e,this.persistence=n}async tt(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",n=>this.et(n,e))}et(e,n){const r=new Set;let i=n,s=!0;return T.doWhile(()=>s===!0&&i>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(o!==null&&!r.has(o))return L("IndexBackiller",`Processing collection: ${o}`),this.nt(e,o,i).next(a=>{i-=a,r.add(o)});s=!1})).next(()=>n-i)}nt(e,n,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,n).next(i=>this.localStore.localDocuments.getNextDocuments(e,n,i,r).next(s=>{const o=s.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this.st(i,s)).next(a=>(L("IndexBackiller",`Updating offset: ${a}`),this.localStore.indexManager.updateCollectionGroup(e,n,a))).next(()=>o.size)}))}st(e,n){let r=e;return n.changes.forEach((i,s)=>{const o=XR(s);gv(o,r)>0&&(r=o)}),new xn(r.readTime,r.documentKey,Math.max(n.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yn{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.it(r),this.rt=r=>n.writeSequenceNumber(r))}it(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.rt&&this.rt(e),e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vE(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Ao(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function tN(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */yn.ot=-1;class rt{constructor(e,n){this.comparator=e,this.root=n||Ft.EMPTY}insert(e,n){return new rt(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,Ft.BLACK,null,null))}remove(e){return new rt(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Ft.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(e,r.key);if(i===0)return n+r.left.size;i<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new eh(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new eh(this.root,e,this.comparator,!1)}getReverseIterator(){return new eh(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new eh(this.root,e,this.comparator,!0)}}class eh{constructor(e,n,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=n?r(e.key,n):1,n&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Ft{constructor(e,n,r,i,s){this.key=e,this.value=n,this.color=r!=null?r:Ft.RED,this.left=i!=null?i:Ft.EMPTY,this.right=s!=null?s:Ft.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,i,s){return new Ft(e!=null?e:this.key,n!=null?n:this.value,r!=null?r:this.color,i!=null?i:this.left,s!=null?s:this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let i=this;const s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,n,r),null):s===0?i.copy(null,n,null,null,null):i.copy(null,null,null,null,i.right.insert(e,n,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return Ft.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,i=this;if(n(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),n(e,i.key)===0){if(i.right.isEmpty())return Ft.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Ft.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Ft.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw Y();const e=this.left.check();if(e!==this.right.check())throw Y();return e+(this.isRed()?0:1)}}Ft.EMPTY=null,Ft.RED=!0,Ft.BLACK=!1;Ft.EMPTY=new class{constructor(){this.size=0}get key(){throw Y()}get value(){throw Y()}get color(){throw Y()}get left(){throw Y()}get right(){throw Y()}copy(t,e,n,r,i){return this}insert(t,e,n){return new Ft(t,e)}remove(t,e){return this}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ne{constructor(e){this.comparator=e,this.data=new rt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;n(i.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new wE(this.data.getIterator())}getIteratorFrom(e){return new wE(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof Ne)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const i=n.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new Ne(this.comparator);return n.data=e,n}}class wE{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function Fo(t){return t.hasNext()?t.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nn{constructor(e){this.fields=e,e.sort(ot.comparator)}static empty(){return new Nn([])}unionWith(e){let n=new Ne(ot.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new Nn(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return Ta(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function k2(){return typeof atob!="undefined"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mt{constructor(e){this.binaryString=e}static fromBase64String(e){const n=atob(e);return new mt(n)}static fromUint8Array(e){const n=function(r){let i="";for(let s=0;s<r.length;++s)i+=String.fromCharCode(r[s]);return i}(e);return new mt(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return e=this.binaryString,btoa(e);var e}toUint8Array(){return function(e){const n=new Uint8Array(e.length);for(let r=0;r<e.length;r++)n[r]=e.charCodeAt(r);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return ue(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}mt.EMPTY_BYTE_STRING=new mt("");const R2=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Xi(t){if(ae(!!t),typeof t=="string"){let e=0;const n=R2.exec(t);if(ae(!!n),n[1]){let i=n[1];i=(i+"000000000").substr(0,9),e=Number(i)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:et(t.seconds),nanos:et(t.nanos)}}function et(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function so(t){return typeof t=="string"?mt.fromBase64String(t):mt.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _v(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="server_timestamp"}function nN(t){const e=t.mapValue.fields.__previous_value__;return _v(e)?nN(e):e}function $l(t){const e=Xi(t.mapValue.fields.__local_write_time__.timestampValue);return new Je(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N2{constructor(e,n,r,i,s,o,a,c){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.useFetchStreams=c}}class ai{constructor(e,n){this.projectId=e,this.database=n||"(default)"}static empty(){return new ai("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof ai&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Au(t){return t==null}function Bl(t){return t===0&&1/t==-1/0}function rN(t){return typeof t=="number"&&Number.isInteger(t)&&!Bl(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Oi={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},wh={nullValue:"NULL_VALUE"};function oo(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?_v(t)?4:iN(t)?9007199254740991:10:Y()}function Fr(t,e){if(t===e)return!0;const n=oo(t);if(n!==oo(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return $l(t).isEqual($l(e));case 3:return function(r,i){if(typeof r.timestampValue=="string"&&typeof i.timestampValue=="string"&&r.timestampValue.length===i.timestampValue.length)return r.timestampValue===i.timestampValue;const s=Xi(r.timestampValue),o=Xi(i.timestampValue);return s.seconds===o.seconds&&s.nanos===o.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(r,i){return so(r.bytesValue).isEqual(so(i.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(r,i){return et(r.geoPointValue.latitude)===et(i.geoPointValue.latitude)&&et(r.geoPointValue.longitude)===et(i.geoPointValue.longitude)}(t,e);case 2:return function(r,i){if("integerValue"in r&&"integerValue"in i)return et(r.integerValue)===et(i.integerValue);if("doubleValue"in r&&"doubleValue"in i){const s=et(r.doubleValue),o=et(i.doubleValue);return s===o?Bl(s)===Bl(o):isNaN(s)&&isNaN(o)}return!1}(t,e);case 9:return Ta(t.arrayValue.values||[],e.arrayValue.values||[],Fr);case 10:return function(r,i){const s=r.mapValue.fields||{},o=i.mapValue.fields||{};if(vE(s)!==vE(o))return!1;for(const a in s)if(s.hasOwnProperty(a)&&(o[a]===void 0||!Fr(s[a],o[a])))return!1;return!0}(t,e);default:return Y()}}function jl(t,e){return(t.values||[]).find(n=>Fr(n,e))!==void 0}function Zi(t,e){if(t===e)return 0;const n=oo(t),r=oo(e);if(n!==r)return ue(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return ue(t.booleanValue,e.booleanValue);case 2:return function(i,s){const o=et(i.integerValue||i.doubleValue),a=et(s.integerValue||s.doubleValue);return o<a?-1:o>a?1:o===a?0:isNaN(o)?isNaN(a)?0:-1:1}(t,e);case 3:return bE(t.timestampValue,e.timestampValue);case 4:return bE($l(t),$l(e));case 5:return ue(t.stringValue,e.stringValue);case 6:return function(i,s){const o=so(i),a=so(s);return o.compareTo(a)}(t.bytesValue,e.bytesValue);case 7:return function(i,s){const o=i.split("/"),a=s.split("/");for(let c=0;c<o.length&&c<a.length;c++){const l=ue(o[c],a[c]);if(l!==0)return l}return ue(o.length,a.length)}(t.referenceValue,e.referenceValue);case 8:return function(i,s){const o=ue(et(i.latitude),et(s.latitude));return o!==0?o:ue(et(i.longitude),et(s.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(i,s){const o=i.values||[],a=s.values||[];for(let c=0;c<o.length&&c<a.length;++c){const l=Zi(o[c],a[c]);if(l)return l}return ue(o.length,a.length)}(t.arrayValue,e.arrayValue);case 10:return function(i,s){if(i===Oi.mapValue&&s===Oi.mapValue)return 0;if(i===Oi.mapValue)return 1;if(s===Oi.mapValue)return-1;const o=i.fields||{},a=Object.keys(o),c=s.fields||{},l=Object.keys(c);a.sort(),l.sort();for(let u=0;u<a.length&&u<l.length;++u){const h=ue(a[u],l[u]);if(h!==0)return h;const d=Zi(o[a[u]],c[l[u]]);if(d!==0)return d}return ue(a.length,l.length)}(t.mapValue,e.mapValue);default:throw Y()}}function bE(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return ue(t,e);const n=Xi(t),r=Xi(e),i=ue(n.seconds,r.seconds);return i!==0?i:ue(n.nanos,r.nanos)}function ra(t){return Mm(t)}function Mm(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(r){const i=Xi(r);return`time(${i.seconds},${i.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?so(t.bytesValue).toBase64():"referenceValue"in t?(n=t.referenceValue,W.fromName(n).toString()):"geoPointValue"in t?`geo(${(e=t.geoPointValue).latitude},${e.longitude})`:"arrayValue"in t?function(r){let i="[",s=!0;for(const o of r.values||[])s?s=!1:i+=",",i+=Mm(o);return i+"]"}(t.arrayValue):"mapValue"in t?function(r){const i=Object.keys(r.fields||{}).sort();let s="{",o=!0;for(const a of i)o?o=!1:s+=",",s+=`${a}:${Mm(r.fields[a])}`;return s+"}"}(t.mapValue):Y();var e,n}function ao(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function Lm(t){return!!t&&"integerValue"in t}function ql(t){return!!t&&"arrayValue"in t}function IE(t){return!!t&&"nullValue"in t}function EE(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function bh(t){return!!t&&"mapValue"in t}function Gc(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return Ao(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=Gc(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=Gc(t.arrayValue.values[n]);return e}return Object.assign({},t)}function iN(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}function P2(t){return"nullValue"in t?wh:"booleanValue"in t?{booleanValue:!1}:"integerValue"in t||"doubleValue"in t?{doubleValue:NaN}:"timestampValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in t?{stringValue:""}:"bytesValue"in t?{bytesValue:""}:"referenceValue"in t?ao(ai.empty(),W.empty()):"geoPointValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in t?{arrayValue:{}}:"mapValue"in t?{mapValue:{}}:Y()}function D2(t){return"nullValue"in t?{booleanValue:!1}:"booleanValue"in t?{doubleValue:NaN}:"integerValue"in t||"doubleValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in t?{stringValue:""}:"stringValue"in t?{bytesValue:""}:"bytesValue"in t?ao(ai.empty(),W.empty()):"referenceValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in t?{arrayValue:{}}:"arrayValue"in t?{mapValue:{}}:"mapValue"in t?Oi:Y()}function TE(t,e){const n=Zi(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?-1:!t.inclusive&&e.inclusive?1:0}function SE(t,e){const n=Zi(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?1:!t.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ut{constructor(e){this.value=e}static empty(){return new Ut({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!bh(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=Gc(n)}setAll(e){let n=ot.emptyPath(),r={},i=[];e.forEach((o,a)=>{if(!n.isImmediateParentOf(a)){const c=this.getFieldsMap(n);this.applyChanges(c,r,i),r={},i=[],n=a.popLast()}o?r[a.lastSegment()]=Gc(o):i.push(a.lastSegment())});const s=this.getFieldsMap(n);this.applyChanges(s,r,i)}delete(e){const n=this.field(e.popLast());bh(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return Fr(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=n.mapValue.fields[e.get(r)];bh(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=i),n=i}return n.mapValue.fields}applyChanges(e,n,r){Ao(n,(i,s)=>e[i]=s);for(const i of r)delete e[i]}clone(){return new Ut(Gc(this.value))}}function sN(t){const e=[];return Ao(t.fields,(n,r)=>{const i=new ot([n]);if(bh(r)){const s=sN(r.mapValue).fields;if(s.length===0)e.push(i);else for(const o of s)e.push(i.child(o))}else e.push(i)}),new Nn(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class je{constructor(e,n,r,i,s,o){this.key=e,this.documentType=n,this.version=r,this.readTime=i,this.data=s,this.documentState=o}static newInvalidDocument(e){return new je(e,0,se.min(),se.min(),Ut.empty(),0)}static newFoundDocument(e,n,r){return new je(e,1,n,se.min(),r,0)}static newNoDocument(e,n){return new je(e,2,n,se.min(),Ut.empty(),0)}static newUnknownDocument(e,n){return new je(e,3,n,se.min(),Ut.empty(),2)}convertToFoundDocument(e,n){return this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Ut.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Ut.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=se.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof je&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new je(this.key,this.documentType,this.version,this.readTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O2{constructor(e,n=null,r=[],i=[],s=null,o=null,a=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=o,this.endAt=a,this.ut=null}}function CE(t,e=null,n=[],r=[],i=null,s=null,o=null){return new O2(t,e,n,r,i,s,o)}function co(t){const e=G(t);if(e.ut===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>{return(i=r).field.canonicalString()+i.op.toString()+ra(i.value);var i}).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(i){return i.field.canonicalString()+i.dir}(r)).join(","),Au(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>ra(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>ra(r)).join(",")),e.ut=n}return e.ut}function x2(t){let e=t.path.canonicalString();return t.collectionGroup!==null&&(e+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(e+=`, filters: [${t.filters.map(n=>{return`${(r=n).field.canonicalString()} ${r.op} ${ra(r.value)}`;var r}).join(", ")}]`),Au(t.limit)||(e+=", limit: "+t.limit),t.orderBy.length>0&&(e+=`, orderBy: [${t.orderBy.map(n=>function(r){return`${r.field.canonicalString()} (${r.dir})`}(n)).join(", ")}]`),t.startAt&&(e+=", startAt: ",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map(n=>ra(n)).join(",")),t.endAt&&(e+=", endAt: ",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map(n=>ra(n)).join(",")),`Target(${e})`}function ku(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let i=0;i<t.orderBy.length;i++)if(!j2(t.orderBy[i],e.orderBy[i]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let i=0;i<t.filters.length;i++)if(n=t.filters[i],r=e.filters[i],n.op!==r.op||!n.field.isEqual(r.field)||!Fr(n.value,r.value))return!1;var n,r;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!NE(t.startAt,e.startAt)&&NE(t.endAt,e.endAt)}function _d(t){return W.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}function yd(t,e){return t.filters.filter(n=>n instanceof $t&&n.field.isEqual(e))}function AE(t,e,n){let r=wh,i=!0;for(const s of yd(t,e)){let o=wh,a=!0;switch(s.op){case"<":case"<=":o=P2(s.value);break;case"==":case"in":case">=":o=s.value;break;case">":o=s.value,a=!1;break;case"!=":case"not-in":o=wh}TE({value:r,inclusive:i},{value:o,inclusive:a})<0&&(r=o,i=a)}if(n!==null){for(let s=0;s<t.orderBy.length;++s)if(t.orderBy[s].field.isEqual(e)){const o=n.position[s];TE({value:r,inclusive:i},{value:o,inclusive:n.inclusive})<0&&(r=o,i=n.inclusive);break}}return{value:r,inclusive:i}}function kE(t,e,n){let r=Oi,i=!0;for(const s of yd(t,e)){let o=Oi,a=!0;switch(s.op){case">=":case">":o=D2(s.value),a=!1;break;case"==":case"in":case"<=":o=s.value;break;case"<":o=s.value,a=!1;break;case"!=":case"not-in":o=Oi}SE({value:r,inclusive:i},{value:o,inclusive:a})>0&&(r=o,i=a)}if(n!==null){for(let s=0;s<t.orderBy.length;++s)if(t.orderBy[s].field.isEqual(e)){const o=n.position[s];SE({value:r,inclusive:i},{value:o,inclusive:n.inclusive})>0&&(r=o,i=n.inclusive);break}}return{value:r,inclusive:i}}class $t extends class{}{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.ct(e,n,r):new M2(e,n,r):n==="array-contains"?new U2(e,r):n==="in"?new V2(e,r):n==="not-in"?new $2(e,r):n==="array-contains-any"?new B2(e,r):new $t(e,n,r)}static ct(e,n,r){return n==="in"?new L2(e,r):new F2(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&this.at(Zi(n,this.value)):n!==null&&oo(this.value)===oo(n)&&this.at(Zi(n,this.value))}at(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Y()}}ht(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}}class M2 extends $t{constructor(e,n,r){super(e,n,r),this.key=W.fromName(r.referenceValue)}matches(e){const n=W.comparator(e.key,this.key);return this.at(n)}}class L2 extends $t{constructor(e,n){super(e,"in",n),this.keys=oN("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class F2 extends $t{constructor(e,n){super(e,"not-in",n),this.keys=oN("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function oN(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(r=>W.fromName(r.referenceValue))}class U2 extends $t{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return ql(n)&&jl(n.arrayValue,this.value)}}class V2 extends $t{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&jl(this.value.arrayValue,n)}}class $2 extends $t{constructor(e,n){super(e,"not-in",n)}matches(e){if(jl(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&!jl(this.value.arrayValue,n)}}class B2 extends $t{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!ql(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>jl(this.value.arrayValue,r))}}class es{constructor(e,n){this.position=e,this.inclusive=n}}class ia{constructor(e,n="asc"){this.field=e,this.dir=n}}function j2(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}function RE(t,e,n){let r=0;for(let i=0;i<t.position.length;i++){const s=e[i],o=t.position[i];if(s.field.isKeyField()?r=W.comparator(W.fromName(o.referenceValue),n.key):r=Zi(o,n.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function NE(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!Fr(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class di{constructor(e,n=null,r=[],i=[],s=null,o="F",a=null,c=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=o,this.startAt=a,this.endAt=c,this.lt=null,this.ft=null,this.startAt,this.endAt}}function aN(t,e,n,r,i,s,o,a){return new di(t,e,n,r,i,s,o,a)}function Ja(t){return new di(t)}function q2(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function yv(t){return t.explicitOrderBy.length>0?t.explicitOrderBy[0].field:null}function vv(t){for(const e of t.filters)if(e.ht())return e.field;return null}function wv(t){return t.collectionGroup!==null}function Sa(t){const e=G(t);if(e.lt===null){e.lt=[];const n=vv(e),r=yv(e);if(n!==null&&r===null)n.isKeyField()||e.lt.push(new ia(n)),e.lt.push(new ia(ot.keyField(),"asc"));else{let i=!1;for(const s of e.explicitOrderBy)e.lt.push(s),s.field.isKeyField()&&(i=!0);if(!i){const s=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";e.lt.push(new ia(ot.keyField(),s))}}}return e.lt}function zn(t){const e=G(t);if(!e.ft)if(e.limitType==="F")e.ft=CE(e.path,e.collectionGroup,Sa(e),e.filters,e.limit,e.startAt,e.endAt);else{const n=[];for(const s of Sa(e)){const o=s.dir==="desc"?"asc":"desc";n.push(new ia(s.field,o))}const r=e.endAt?new es(e.endAt.position,e.endAt.inclusive):null,i=e.startAt?new es(e.startAt.position,e.startAt.inclusive):null;e.ft=CE(e.path,e.collectionGroup,n,e.filters,e.limit,r,i)}return e.ft}function cN(t,e,n){return new di(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Ru(t,e){return ku(zn(t),zn(e))&&t.limitType===e.limitType}function lN(t){return`${co(zn(t))}|lt:${t.limitType}`}function Fm(t){return`Query(target=${x2(zn(t))}; limitType=${t.limitType})`}function bv(t,e){return e.isFoundDocument()&&function(n,r){const i=r.key.path;return n.collectionGroup!==null?r.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(i):W.isDocumentKey(n.path)?n.path.isEqual(i):n.path.isImmediateParentOf(i)}(t,e)&&function(n,r){for(const i of n.explicitOrderBy)if(!i.field.isKeyField()&&r.data.field(i.field)===null)return!1;return!0}(t,e)&&function(n,r){for(const i of n.filters)if(!i.matches(r))return!1;return!0}(t,e)&&function(n,r){return!(n.startAt&&!function(i,s,o){const a=RE(i,s,o);return i.inclusive?a<=0:a<0}(n.startAt,Sa(n),r)||n.endAt&&!function(i,s,o){const a=RE(i,s,o);return i.inclusive?a>=0:a>0}(n.endAt,Sa(n),r))}(t,e)}function uN(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function hN(t){return(e,n)=>{let r=!1;for(const i of Sa(t)){const s=W2(i,e,n);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function W2(t,e,n){const r=t.field.isKeyField()?W.comparator(e.key,n.key):function(i,s,o){const a=s.data.field(i),c=o.data.field(i);return a!==null&&c!==null?Zi(a,c):Y()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return Y()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dN(t,e){if(t.dt){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Bl(e)?"-0":e}}function fN(t){return{integerValue:""+t}}function pN(t,e){return rN(e)?fN(e):dN(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gf{constructor(){this._=void 0}}function K2(t,e,n){return t instanceof Ca?function(r,i){const s={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:r.seconds,nanos:r.nanoseconds}}}};return i&&(s.fields.__previous_value__=i),{mapValue:s}}(n,e):t instanceof lo?mN(t,e):t instanceof uo?_N(t,e):function(r,i){const s=gN(r,i),o=PE(s)+PE(r._t);return Lm(s)&&Lm(r._t)?fN(o):dN(r.wt,o)}(t,e)}function H2(t,e,n){return t instanceof lo?mN(t,e):t instanceof uo?_N(t,e):n}function gN(t,e){return t instanceof Aa?Lm(n=e)||function(r){return!!r&&"doubleValue"in r}(n)?e:{integerValue:0}:null;var n}class Ca extends Gf{}class lo extends Gf{constructor(e){super(),this.elements=e}}function mN(t,e){const n=yN(e);for(const r of t.elements)n.some(i=>Fr(i,r))||n.push(r);return{arrayValue:{values:n}}}class uo extends Gf{constructor(e){super(),this.elements=e}}function _N(t,e){let n=yN(e);for(const r of t.elements)n=n.filter(i=>!Fr(i,r));return{arrayValue:{values:n}}}class Aa extends Gf{constructor(e,n){super(),this.wt=e,this._t=n}}function PE(t){return et(t.integerValue||t.doubleValue)}function yN(t){return ql(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nu{constructor(e,n){this.field=e,this.transform=n}}function G2(t,e){return t.field.isEqual(e.field)&&function(n,r){return n instanceof lo&&r instanceof lo||n instanceof uo&&r instanceof uo?Ta(n.elements,r.elements,Fr):n instanceof Aa&&r instanceof Aa?Fr(n._t,r._t):n instanceof Ca&&r instanceof Ca}(t.transform,e.transform)}class z2{constructor(e,n){this.version=e,this.transformResults=n}}class Ze{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new Ze}static exists(e){return new Ze(void 0,e)}static updateTime(e){return new Ze(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Ih(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class zf{}function vN(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new Za(t.key,Ze.none()):new Xa(t.key,t.data,Ze.none());{const n=t.data,r=Ut.empty();let i=new Ne(ot.comparator);for(let s of e.fields)if(!i.has(s)){let o=n.field(s);o===null&&s.length>1&&(s=s.popLast(),o=n.field(s)),o===null?r.delete(s):r.set(s,o),i=i.add(s)}return new fi(t.key,r,new Nn(i.toArray()),Ze.none())}}function Q2(t,e,n){t instanceof Xa?function(r,i,s){const o=r.value.clone(),a=OE(r.fieldTransforms,i,s.transformResults);o.setAll(a),i.convertToFoundDocument(s.version,o).setHasCommittedMutations()}(t,e,n):t instanceof fi?function(r,i,s){if(!Ih(r.precondition,i))return void i.convertToUnknownDocument(s.version);const o=OE(r.fieldTransforms,i,s.transformResults),a=i.data;a.setAll(wN(r)),a.setAll(o),i.convertToFoundDocument(s.version,a).setHasCommittedMutations()}(t,e,n):function(r,i,s){i.convertToNoDocument(s.version).setHasCommittedMutations()}(0,e,n)}function zc(t,e,n,r){return t instanceof Xa?function(i,s,o,a){if(!Ih(i.precondition,s))return o;const c=i.value.clone(),l=xE(i.fieldTransforms,a,s);return c.setAll(l),s.convertToFoundDocument(s.version,c).setHasLocalMutations(),null}(t,e,n,r):t instanceof fi?function(i,s,o,a){if(!Ih(i.precondition,s))return o;const c=xE(i.fieldTransforms,a,s),l=s.data;return l.setAll(wN(i)),l.setAll(c),s.convertToFoundDocument(s.version,l).setHasLocalMutations(),o===null?null:o.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(u=>u.field))}(t,e,n,r):function(i,s,o){return Ih(i.precondition,s)?(s.convertToNoDocument(s.version).setHasLocalMutations(),null):o}(t,e,n)}function Y2(t,e){let n=null;for(const r of t.fieldTransforms){const i=e.data.field(r.field),s=gN(r.transform,i||null);s!=null&&(n===null&&(n=Ut.empty()),n.set(r.field,s))}return n||null}function DE(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(n,r){return n===void 0&&r===void 0||!(!n||!r)&&Ta(n,r,(i,s)=>G2(i,s))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class Xa extends zf{constructor(e,n,r,i=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class fi extends zf{constructor(e,n,r,i,s=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function wN(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function OE(t,e,n){const r=new Map;ae(t.length===n.length);for(let i=0;i<n.length;i++){const s=t[i],o=s.transform,a=e.data.field(s.field);r.set(s.field,H2(o,a,n[i]))}return r}function xE(t,e,n){const r=new Map;for(const i of t){const s=i.transform,o=n.data.field(i.field);r.set(i.field,K2(s,o,e))}return r}class Za extends zf{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Iv extends zf{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J2{constructor(e){this.count=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ut,be;function bN(t){switch(t){default:return Y();case C.CANCELLED:case C.UNKNOWN:case C.DEADLINE_EXCEEDED:case C.RESOURCE_EXHAUSTED:case C.INTERNAL:case C.UNAVAILABLE:case C.UNAUTHENTICATED:return!1;case C.INVALID_ARGUMENT:case C.NOT_FOUND:case C.ALREADY_EXISTS:case C.PERMISSION_DENIED:case C.FAILED_PRECONDITION:case C.ABORTED:case C.OUT_OF_RANGE:case C.UNIMPLEMENTED:case C.DATA_LOSS:return!0}}function IN(t){if(t===void 0)return ht("GRPC error has no .code"),C.UNKNOWN;switch(t){case ut.OK:return C.OK;case ut.CANCELLED:return C.CANCELLED;case ut.UNKNOWN:return C.UNKNOWN;case ut.DEADLINE_EXCEEDED:return C.DEADLINE_EXCEEDED;case ut.RESOURCE_EXHAUSTED:return C.RESOURCE_EXHAUSTED;case ut.INTERNAL:return C.INTERNAL;case ut.UNAVAILABLE:return C.UNAVAILABLE;case ut.UNAUTHENTICATED:return C.UNAUTHENTICATED;case ut.INVALID_ARGUMENT:return C.INVALID_ARGUMENT;case ut.NOT_FOUND:return C.NOT_FOUND;case ut.ALREADY_EXISTS:return C.ALREADY_EXISTS;case ut.PERMISSION_DENIED:return C.PERMISSION_DENIED;case ut.FAILED_PRECONDITION:return C.FAILED_PRECONDITION;case ut.ABORTED:return C.ABORTED;case ut.OUT_OF_RANGE:return C.OUT_OF_RANGE;case ut.UNIMPLEMENTED:return C.UNIMPLEMENTED;case ut.DATA_LOSS:return C.DATA_LOSS;default:return Y()}}(be=ut||(ut={}))[be.OK=0]="OK",be[be.CANCELLED=1]="CANCELLED",be[be.UNKNOWN=2]="UNKNOWN",be[be.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",be[be.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",be[be.NOT_FOUND=5]="NOT_FOUND",be[be.ALREADY_EXISTS=6]="ALREADY_EXISTS",be[be.PERMISSION_DENIED=7]="PERMISSION_DENIED",be[be.UNAUTHENTICATED=16]="UNAUTHENTICATED",be[be.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",be[be.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",be[be.ABORTED=10]="ABORTED",be[be.OUT_OF_RANGE=11]="OUT_OF_RANGE",be[be.UNIMPLEMENTED=12]="UNIMPLEMENTED",be[be.INTERNAL=13]="INTERNAL",be[be.UNAVAILABLE=14]="UNAVAILABLE",be[be.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class us{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,n]);i.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[n]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){Ao(this.inner,(n,r)=>{for(const[i,s]of r)e(i,s)})}isEmpty(){return tN(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const X2=new rt(W.comparator);function vn(){return X2}const EN=new rt(W.comparator);function kc(...t){let e=EN;for(const n of t)e=e.insert(n.key,n);return e}function TN(t){let e=EN;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function Tr(){return Qc()}function SN(){return Qc()}function Qc(){return new us(t=>t.toString(),(t,e)=>t.isEqual(e))}const Z2=new rt(W.comparator),e4=new Ne(W.comparator);function fe(...t){let e=e4;for(const n of t)e=e.add(n);return e}const t4=new Ne(ue);function Qf(){return t4}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pu{constructor(e,n,r,i,s){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,n){const r=new Map;return r.set(e,Du.createSynthesizedTargetChangeForCurrentChange(e,n)),new Pu(se.min(),r,Qf(),vn(),fe())}}class Du{constructor(e,n,r,i,s){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,n){return new Du(mt.EMPTY_BYTE_STRING,n,fe(),fe(),fe())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Eh{constructor(e,n,r,i){this.gt=e,this.removedTargetIds=n,this.key=r,this.yt=i}}class CN{constructor(e,n){this.targetId=e,this.It=n}}class AN{constructor(e,n,r=mt.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=i}}class ME{constructor(){this.Tt=0,this.Et=FE(),this.At=mt.EMPTY_BYTE_STRING,this.Rt=!1,this.bt=!0}get current(){return this.Rt}get resumeToken(){return this.At}get Pt(){return this.Tt!==0}get vt(){return this.bt}Vt(e){e.approximateByteSize()>0&&(this.bt=!0,this.At=e)}St(){let e=fe(),n=fe(),r=fe();return this.Et.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:n=n.add(i);break;case 1:r=r.add(i);break;default:Y()}}),new Du(this.At,this.Rt,e,n,r)}Dt(){this.bt=!1,this.Et=FE()}Ct(e,n){this.bt=!0,this.Et=this.Et.insert(e,n)}xt(e){this.bt=!0,this.Et=this.Et.remove(e)}Nt(){this.Tt+=1}kt(){this.Tt-=1}Ot(){this.bt=!0,this.Rt=!0}}class n4{constructor(e){this.Mt=e,this.Ft=new Map,this.$t=vn(),this.Bt=LE(),this.Lt=new Ne(ue)}Ut(e){for(const n of e.gt)e.yt&&e.yt.isFoundDocument()?this.qt(n,e.yt):this.Kt(n,e.key,e.yt);for(const n of e.removedTargetIds)this.Kt(n,e.key,e.yt)}Gt(e){this.forEachTarget(e,n=>{const r=this.Qt(n);switch(e.state){case 0:this.jt(n)&&r.Vt(e.resumeToken);break;case 1:r.kt(),r.Pt||r.Dt(),r.Vt(e.resumeToken);break;case 2:r.kt(),r.Pt||this.removeTarget(n);break;case 3:this.jt(n)&&(r.Ot(),r.Vt(e.resumeToken));break;case 4:this.jt(n)&&(this.Wt(n),r.Vt(e.resumeToken));break;default:Y()}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.Ft.forEach((r,i)=>{this.jt(i)&&n(i)})}zt(e){const n=e.targetId,r=e.It.count,i=this.Ht(n);if(i){const s=i.target;if(_d(s))if(r===0){const o=new W(s.path);this.Kt(n,o,je.newNoDocument(o,se.min()))}else ae(r===1);else this.Jt(n)!==r&&(this.Wt(n),this.Lt=this.Lt.add(n))}}Yt(e){const n=new Map;this.Ft.forEach((s,o)=>{const a=this.Ht(o);if(a){if(s.current&&_d(a.target)){const c=new W(a.target.path);this.$t.get(c)!==null||this.Xt(o,c)||this.Kt(o,c,je.newNoDocument(c,e))}s.vt&&(n.set(o,s.St()),s.Dt())}});let r=fe();this.Bt.forEach((s,o)=>{let a=!0;o.forEachWhile(c=>{const l=this.Ht(c);return!l||l.purpose===2||(a=!1,!1)}),a&&(r=r.add(s))}),this.$t.forEach((s,o)=>o.setReadTime(e));const i=new Pu(e,n,this.Lt,this.$t,r);return this.$t=vn(),this.Bt=LE(),this.Lt=new Ne(ue),i}qt(e,n){if(!this.jt(e))return;const r=this.Xt(e,n.key)?2:0;this.Qt(e).Ct(n.key,r),this.$t=this.$t.insert(n.key,n),this.Bt=this.Bt.insert(n.key,this.Zt(n.key).add(e))}Kt(e,n,r){if(!this.jt(e))return;const i=this.Qt(e);this.Xt(e,n)?i.Ct(n,1):i.xt(n),this.Bt=this.Bt.insert(n,this.Zt(n).delete(e)),r&&(this.$t=this.$t.insert(n,r))}removeTarget(e){this.Ft.delete(e)}Jt(e){const n=this.Qt(e).St();return this.Mt.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}Nt(e){this.Qt(e).Nt()}Qt(e){let n=this.Ft.get(e);return n||(n=new ME,this.Ft.set(e,n)),n}Zt(e){let n=this.Bt.get(e);return n||(n=new Ne(ue),this.Bt=this.Bt.insert(e,n)),n}jt(e){const n=this.Ht(e)!==null;return n||L("WatchChangeAggregator","Detected inactive target",e),n}Ht(e){const n=this.Ft.get(e);return n&&n.Pt?null:this.Mt.te(e)}Wt(e){this.Ft.set(e,new ME),this.Mt.getRemoteKeysForTarget(e).forEach(n=>{this.Kt(e,n,null)})}Xt(e,n){return this.Mt.getRemoteKeysForTarget(e).has(n)}}function LE(){return new rt(W.comparator)}function FE(){return new rt(W.comparator)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const r4=(()=>({asc:"ASCENDING",desc:"DESCENDING"}))(),i4=(()=>({"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"}))();class s4{constructor(e,n){this.databaseId=e,this.dt=n}}function Wl(t,e){return t.dt?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function kN(t,e){return t.dt?e.toBase64():e.toUint8Array()}function o4(t,e){return Wl(t,e.toTimestamp())}function Ct(t){return ae(!!t),se.fromTimestamp(function(e){const n=Xi(e);return new Je(n.seconds,n.nanos)}(t))}function Ev(t,e){return function(n){return new Ee(["projects",n.projectId,"databases",n.database])}(t).child("documents").child(e).canonicalString()}function RN(t){const e=Ee.fromString(t);return ae(FN(e)),e}function Kl(t,e){return Ev(t.databaseId,e.path)}function kr(t,e){const n=RN(e);if(n.get(1)!==t.databaseId.projectId)throw new O(C.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new O(C.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new W(PN(n))}function Um(t,e){return Ev(t.databaseId,e)}function NN(t){const e=RN(t);return e.length===4?Ee.emptyPath():PN(e)}function Hl(t){return new Ee(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function PN(t){return ae(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function UE(t,e,n){return{name:Kl(t,e),fields:n.value.mapValue.fields}}function DN(t,e,n){const r=kr(t,e.name),i=Ct(e.updateTime),s=new Ut({mapValue:{fields:e.fields}}),o=je.newFoundDocument(r,i,s);return n&&o.setHasCommittedMutations(),n?o.setHasCommittedMutations():o}function a4(t,e){return"found"in e?function(n,r){ae(!!r.found),r.found.name,r.found.updateTime;const i=kr(n,r.found.name),s=Ct(r.found.updateTime),o=new Ut({mapValue:{fields:r.found.fields}});return je.newFoundDocument(i,s,o)}(t,e):"missing"in e?function(n,r){ae(!!r.missing),ae(!!r.readTime);const i=kr(n,r.missing),s=Ct(r.readTime);return je.newNoDocument(i,s)}(t,e):Y()}function c4(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(c){return c==="NO_CHANGE"?0:c==="ADD"?1:c==="REMOVE"?2:c==="CURRENT"?3:c==="RESET"?4:Y()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(c,l){return c.dt?(ae(l===void 0||typeof l=="string"),mt.fromBase64String(l||"")):(ae(l===void 0||l instanceof Uint8Array),mt.fromUint8Array(l||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(c){const l=c.code===void 0?C.UNKNOWN:IN(c.code);return new O(l,c.message||"")}(o);n=new AN(r,i,s,a||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const i=kr(t,r.document.name),s=Ct(r.document.updateTime),o=new Ut({mapValue:{fields:r.document.fields}}),a=je.newFoundDocument(i,s,o),c=r.targetIds||[],l=r.removedTargetIds||[];n=new Eh(c,l,a.key,a)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const i=kr(t,r.document),s=r.readTime?Ct(r.readTime):se.min(),o=je.newNoDocument(i,s),a=r.removedTargetIds||[];n=new Eh([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const i=kr(t,r.document),s=r.removedTargetIds||[];n=new Eh([],s,i,null)}else{if(!("filter"in e))return Y();{e.filter;const r=e.filter;r.targetId;const i=r.count||0,s=new J2(i),o=r.targetId;n=new CN(o,s)}}return n}function Gl(t,e){let n;if(e instanceof Xa)n={update:UE(t,e.key,e.value)};else if(e instanceof Za)n={delete:Kl(t,e.key)};else if(e instanceof fi)n={update:UE(t,e.key,e.data),updateMask:g4(e.fieldMask)};else{if(!(e instanceof Iv))return Y();n={verify:Kl(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(i,s){const o=s.transform;if(o instanceof Ca)return{fieldPath:s.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(o instanceof lo)return{fieldPath:s.field.canonicalString(),appendMissingElements:{values:o.elements}};if(o instanceof uo)return{fieldPath:s.field.canonicalString(),removeAllFromArray:{values:o.elements}};if(o instanceof Aa)return{fieldPath:s.field.canonicalString(),increment:o._t};throw Y()}(0,r))),e.precondition.isNone||(n.currentDocument=function(r,i){return i.updateTime!==void 0?{updateTime:o4(r,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:Y()}(t,e.precondition)),n}function Vm(t,e){const n=e.currentDocument?function(i){return i.updateTime!==void 0?Ze.updateTime(Ct(i.updateTime)):i.exists!==void 0?Ze.exists(i.exists):Ze.none()}(e.currentDocument):Ze.none(),r=e.updateTransforms?e.updateTransforms.map(i=>function(s,o){let a=null;if("setToServerValue"in o)ae(o.setToServerValue==="REQUEST_TIME"),a=new Ca;else if("appendMissingElements"in o){const l=o.appendMissingElements.values||[];a=new lo(l)}else if("removeAllFromArray"in o){const l=o.removeAllFromArray.values||[];a=new uo(l)}else"increment"in o?a=new Aa(s,o.increment):Y();const c=ot.fromServerFormat(o.fieldPath);return new Nu(c,a)}(t,i)):[];if(e.update){e.update.name;const i=kr(t,e.update.name),s=new Ut({mapValue:{fields:e.update.fields}});if(e.updateMask){const o=function(a){const c=a.fieldPaths||[];return new Nn(c.map(l=>ot.fromServerFormat(l)))}(e.updateMask);return new fi(i,s,o,n,r)}return new Xa(i,s,n,r)}if(e.delete){const i=kr(t,e.delete);return new Za(i,n)}if(e.verify){const i=kr(t,e.verify);return new Iv(i,n)}return Y()}function l4(t,e){return t&&t.length>0?(ae(e!==void 0),t.map(n=>function(r,i){let s=r.updateTime?Ct(r.updateTime):Ct(i);return s.isEqual(se.min())&&(s=Ct(i)),new z2(s,r.transformResults||[])}(n,e))):[]}function ON(t,e){return{documents:[Um(t,e.path)]}}function xN(t,e){const n={structuredQuery:{}},r=e.path;e.collectionGroup!==null?(n.parent=Um(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=Um(t,r.popLast()),n.structuredQuery.from=[{collectionId:r.lastSegment()}]);const i=function(c){if(c.length===0)return;const l=c.map(u=>function(h){if(h.op==="=="){if(EE(h.value))return{unaryFilter:{field:Uo(h.field),op:"IS_NAN"}};if(IE(h.value))return{unaryFilter:{field:Uo(h.field),op:"IS_NULL"}}}else if(h.op==="!="){if(EE(h.value))return{unaryFilter:{field:Uo(h.field),op:"IS_NOT_NAN"}};if(IE(h.value))return{unaryFilter:{field:Uo(h.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Uo(h.field),op:d4(h.op),value:h.value}}}(u));return l.length===1?l[0]:{compositeFilter:{op:"AND",filters:l}}}(e.filters);i&&(n.structuredQuery.where=i);const s=function(c){if(c.length!==0)return c.map(l=>function(u){return{field:Uo(u.field),direction:h4(u.dir)}}(l))}(e.orderBy);s&&(n.structuredQuery.orderBy=s);const o=function(c,l){return c.dt||Au(l)?l:{value:l}}(t,e.limit);var a;return o!==null&&(n.structuredQuery.limit=o),e.startAt&&(n.structuredQuery.startAt={before:(a=e.startAt).inclusive,values:a.position}),e.endAt&&(n.structuredQuery.endAt=function(c){return{before:!c.inclusive,values:c.position}}(e.endAt)),n}function MN(t){let e=NN(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let i=null;if(r>0){ae(r===1);const u=n.from[0];u.allDescendants?i=u.collectionId:e=e.child(u.collectionId)}let s=[];n.where&&(s=LN(n.where));let o=[];n.orderBy&&(o=n.orderBy.map(u=>function(h){return new ia(zo(h.field),function(d){switch(d){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(h.direction))}(u)));let a=null;n.limit&&(a=function(u){let h;return h=typeof u=="object"?u.value:u,Au(h)?null:h}(n.limit));let c=null;n.startAt&&(c=function(u){const h=!!u.before,d=u.values||[];return new es(d,h)}(n.startAt));let l=null;return n.endAt&&(l=function(u){const h=!u.before,d=u.values||[];return new es(d,h)}(n.endAt)),aN(e,i,o,s,a,"F",c,l)}function u4(t,e){const n=function(r,i){switch(i){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return Y()}}(0,e.purpose);return n==null?null:{"goog-listen-tags":n}}function LN(t){return t?t.unaryFilter!==void 0?[p4(t)]:t.fieldFilter!==void 0?[f4(t)]:t.compositeFilter!==void 0?t.compositeFilter.filters.map(e=>LN(e)).reduce((e,n)=>e.concat(n)):Y():[]}function h4(t){return r4[t]}function d4(t){return i4[t]}function Uo(t){return{fieldPath:t.canonicalString()}}function zo(t){return ot.fromServerFormat(t.fieldPath)}function f4(t){return $t.create(zo(t.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return Y()}}(t.fieldFilter.op),t.fieldFilter.value)}function p4(t){switch(t.unaryFilter.op){case"IS_NAN":const e=zo(t.unaryFilter.field);return $t.create(e,"==",{doubleValue:NaN});case"IS_NULL":const n=zo(t.unaryFilter.field);return $t.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const r=zo(t.unaryFilter.field);return $t.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const i=zo(t.unaryFilter.field);return $t.create(i,"!=",{nullValue:"NULL_VALUE"});default:return Y()}}function g4(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function FN(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function un(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=VE(e)),e=m4(t.get(n),e);return VE(e)}function m4(t,e){let n=e;const r=t.length;for(let i=0;i<r;i++){const s=t.charAt(i);switch(s){case"\0":n+="";break;case"":n+="";break;default:n+=s}}return n}function VE(t){return t+""}function Sr(t){const e=t.length;if(ae(e>=2),e===2)return ae(t.charAt(0)===""&&t.charAt(1)===""),Ee.emptyPath();const n=e-2,r=[];let i="";for(let s=0;s<e;){const o=t.indexOf("",s);switch((o<0||o>n)&&Y(),t.charAt(o+1)){case"":const a=t.substring(s,o);let c;i.length===0?c=a:(i+=a,c=i,i=""),r.push(c);break;case"":i+=t.substring(s,o),i+="\0";break;case"":i+=t.substring(s,o+1);break;default:Y()}s=o+2}return new Ee(r)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $E=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Th(t,e){return[t,un(e)]}function UN(t,e,n){return[t,un(e),n]}const _4={},y4=["prefixPath","collectionGroup","readTime","documentId"],v4=["prefixPath","collectionGroup","documentId"],w4=["collectionGroup","readTime","prefixPath","documentId"],b4=["canonicalId","targetId"],I4=["targetId","path"],E4=["path","targetId"],T4=["collectionId","parent"],S4=["indexId","uid"],C4=["uid","sequenceNumber"],A4=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],k4=["indexId","uid","orderedDocumentKey"],R4=["userId","collectionPath","documentId"],N4=["userId","collectionPath","largestBatchId"],P4=["userId","collectionGroup","largestBatchId"],VN=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],D4=[...VN,"documentOverlays"],$N=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],BN=$N,O4=[...BN,"indexConfiguration","indexState","indexEntries"];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $m extends eN{constructor(e,n){super(),this.ee=e,this.currentSequenceNumber=n}}function xt(t,e){const n=G(t);return ir.N(n.ee,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tv{constructor(e,n,r,i){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(e.key)&&Q2(s,e,r[i])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=zc(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=zc(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=SN();return this.mutations.forEach(i=>{const s=e.get(i.key),o=s.overlayedDocument;let a=this.applyToLocalView(o,s.mutatedFields);a=n.has(i.key)?null:a;const c=vN(o,a);c!==null&&r.set(i.key,c),o.isValidDocument()||o.convertToNoDocument(se.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),fe())}isEqual(e){return this.batchId===e.batchId&&Ta(this.mutations,e.mutations,(n,r)=>DE(n,r))&&Ta(this.baseMutations,e.baseMutations,(n,r)=>DE(n,r))}}class Sv{constructor(e,n,r,i){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=i}static from(e,n,r){ae(e.mutations.length===r.length);let i=Z2;const s=e.mutations;for(let o=0;o<s.length;o++)i=i.insert(s[o].key,r[o].version);return new Sv(e,n,r,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cv{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $i{constructor(e,n,r,i,s=se.min(),o=se.min(),a=mt.EMPTY_BYTE_STRING){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a}withSequenceNumber(e){return new $i(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)}withResumeToken(e,n){return new $i(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e)}withLastLimboFreeSnapshotVersion(e){return new $i(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jN{constructor(e){this.ne=e}}function x4(t,e){let n;if(e.document)n=DN(t.ne,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=W.fromSegments(e.noDocument.path),i=fo(e.noDocument.readTime);n=je.newNoDocument(r,i),e.hasCommittedMutations&&n.setHasCommittedMutations()}else{if(!e.unknownDocument)return Y();{const r=W.fromSegments(e.unknownDocument.path),i=fo(e.unknownDocument.version);n=je.newUnknownDocument(r,i)}}return e.readTime&&n.setReadTime(function(r){const i=new Je(r[0],r[1]);return se.fromTimestamp(i)}(e.readTime)),n}function BE(t,e){const n=e.key,r={prefixPath:n.getCollectionPath().popLast().toArray(),collectionGroup:n.collectionGroup,documentId:n.path.lastSegment(),readTime:vd(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=function(i,s){return{name:Kl(i,s.key),fields:s.data.value.mapValue.fields,updateTime:Wl(i,s.version.toTimestamp())}}(t.ne,e);else if(e.isNoDocument())r.noDocument={path:n.path.toArray(),readTime:ho(e.version)};else{if(!e.isUnknownDocument())return Y();r.unknownDocument={path:n.path.toArray(),version:ho(e.version)}}return r}function vd(t){const e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function ho(t){const e=t.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function fo(t){const e=new Je(t.seconds,t.nanoseconds);return se.fromTimestamp(e)}function As(t,e){const n=(e.baseMutations||[]).map(s=>Vm(t.ne,s));for(let s=0;s<e.mutations.length-1;++s){const o=e.mutations[s];if(s+1<e.mutations.length&&e.mutations[s+1].transform!==void 0){const a=e.mutations[s+1];o.updateTransforms=a.transform.fieldTransforms,e.mutations.splice(s+1,1),++s}}const r=e.mutations.map(s=>Vm(t.ne,s)),i=Je.fromMillis(e.localWriteTimeMs);return new Tv(e.batchId,i,n,r)}function Rc(t){const e=fo(t.readTime),n=t.lastLimboFreeSnapshotVersion!==void 0?fo(t.lastLimboFreeSnapshotVersion):se.min();let r;var i;return t.query.documents!==void 0?(ae((i=t.query).documents.length===1),r=zn(Ja(NN(i.documents[0])))):r=function(s){return zn(MN(s))}(t.query),new $i(r,t.targetId,0,t.lastListenSequenceNumber,e,n,mt.fromBase64String(t.resumeToken))}function qN(t,e){const n=ho(e.snapshotVersion),r=ho(e.lastLimboFreeSnapshotVersion);let i;i=_d(e.target)?ON(t.ne,e.target):xN(t.ne,e.target);const s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:co(e.target),readTime:n,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function Av(t){const e=MN({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?cN(e,e.limit,"L"):e}function Zp(t,e){return new Cv(e.largestBatchId,Vm(t.ne,e.overlayMutation))}function jE(t,e){const n=e.path.lastSegment();return[t,un(e.path.popLast()),n]}function qE(t,e,n,r){return{indexId:t,uid:e.uid||"",sequenceNumber:n,readTime:ho(r.readTime),documentKey:un(r.documentKey.path),largestBatchId:r.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M4{getBundleMetadata(e,n){return WE(e).get(n).next(r=>{if(r)return{id:(i=r).bundleId,createTime:fo(i.createTime),version:i.version};var i})}saveBundleMetadata(e,n){return WE(e).put({bundleId:(r=n).id,createTime:ho(Ct(r.createTime)),version:r.version});var r}getNamedQuery(e,n){return KE(e).get(n).next(r=>{if(r)return{name:(i=r).name,query:Av(i.bundledQuery),readTime:fo(i.readTime)};var i})}saveNamedQuery(e,n){return KE(e).put(function(r){return{name:r.name,readTime:ho(Ct(r.readTime)),bundledQuery:r.bundledQuery}}(n))}}function WE(t){return xt(t,"bundles")}function KE(t){return xt(t,"namedQueries")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yf{constructor(e,n){this.wt=e,this.userId=n}static se(e,n){const r=n.uid||"";return new Yf(e,r)}getOverlay(e,n){return mc(e).get(jE(this.userId,n)).next(r=>r?Zp(this.wt,r):null)}getOverlays(e,n){const r=Tr();return T.forEach(n,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,n,r){const i=[];return r.forEach((s,o)=>{const a=new Cv(n,o);i.push(this.ie(e,a))}),T.waitFor(i)}removeOverlaysForBatchId(e,n,r){const i=new Set;n.forEach(o=>i.add(un(o.getCollectionPath())));const s=[];return i.forEach(o=>{const a=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,r+1],!1,!0);s.push(mc(e).W("collectionPathOverlayIndex",a))}),T.waitFor(s)}getOverlaysForCollection(e,n,r){const i=Tr(),s=un(n),o=IDBKeyRange.bound([this.userId,s,r],[this.userId,s,Number.POSITIVE_INFINITY],!0);return mc(e).K("collectionPathOverlayIndex",o).next(a=>{for(const c of a){const l=Zp(this.wt,c);i.set(l.getKey(),l)}return i})}getOverlaysForCollectionGroup(e,n,r,i){const s=Tr();let o;const a=IDBKeyRange.bound([this.userId,n,r],[this.userId,n,Number.POSITIVE_INFINITY],!0);return mc(e).J({index:"collectionGroupOverlayIndex",range:a},(c,l,u)=>{const h=Zp(this.wt,l);s.size()<i||h.largestBatchId===o?(s.set(h.getKey(),h),o=h.largestBatchId):u.done()}).next(()=>s)}ie(e,n){return mc(e).put(function(r,i,s){const[o,a,c]=jE(i,s.mutation.key);return{userId:i,collectionPath:a,documentId:c,collectionGroup:s.mutation.key.getCollectionGroup(),largestBatchId:s.largestBatchId,overlayMutation:Gl(r.ne,s.mutation)}}(this.wt,this.userId,n))}}function mc(t){return xt(t,"documentOverlays")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ks{constructor(){}re(e,n){this.oe(e,n),n.ue()}oe(e,n){if("nullValue"in e)this.ce(n,5);else if("booleanValue"in e)this.ce(n,10),n.ae(e.booleanValue?1:0);else if("integerValue"in e)this.ce(n,15),n.ae(et(e.integerValue));else if("doubleValue"in e){const r=et(e.doubleValue);isNaN(r)?this.ce(n,13):(this.ce(n,15),Bl(r)?n.ae(0):n.ae(r))}else if("timestampValue"in e){const r=e.timestampValue;this.ce(n,20),typeof r=="string"?n.he(r):(n.he(`${r.seconds||""}`),n.ae(r.nanos||0))}else if("stringValue"in e)this.le(e.stringValue,n),this.fe(n);else if("bytesValue"in e)this.ce(n,30),n.de(so(e.bytesValue)),this.fe(n);else if("referenceValue"in e)this._e(e.referenceValue,n);else if("geoPointValue"in e){const r=e.geoPointValue;this.ce(n,45),n.ae(r.latitude||0),n.ae(r.longitude||0)}else"mapValue"in e?iN(e)?this.ce(n,Number.MAX_SAFE_INTEGER):(this.we(e.mapValue,n),this.fe(n)):"arrayValue"in e?(this.me(e.arrayValue,n),this.fe(n)):Y()}le(e,n){this.ce(n,25),this.ge(e,n)}ge(e,n){n.he(e)}we(e,n){const r=e.fields||{};this.ce(n,55);for(const i of Object.keys(r))this.le(i,n),this.oe(r[i],n)}me(e,n){const r=e.values||[];this.ce(n,50);for(const i of r)this.oe(i,n)}_e(e,n){this.ce(n,37),W.fromName(e).path.forEach(r=>{this.ce(n,60),this.ge(r,n)})}ce(e,n){e.ae(n)}fe(e){e.ae(2)}}ks.ye=new ks;function L4(t){if(t===0)return 8;let e=0;return t>>4==0&&(e+=4,t<<=4),t>>6==0&&(e+=2,t<<=2),t>>7==0&&(e+=1),e}function HE(t){const e=64-function(n){let r=0;for(let i=0;i<8;++i){const s=L4(255&n[i]);if(r+=s,s!==8)break}return r}(t);return Math.ceil(e/8)}class F4{constructor(){this.buffer=new Uint8Array(1024),this.position=0}pe(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.Ie(r.value),r=n.next();this.Te()}Ee(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.Ae(r.value),r=n.next();this.Re()}be(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.Ie(r);else if(r<2048)this.Ie(960|r>>>6),this.Ie(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Ie(480|r>>>12),this.Ie(128|63&r>>>6),this.Ie(128|63&r);else{const i=n.codePointAt(0);this.Ie(240|i>>>18),this.Ie(128|63&i>>>12),this.Ie(128|63&i>>>6),this.Ie(128|63&i)}}this.Te()}Pe(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.Ae(r);else if(r<2048)this.Ae(960|r>>>6),this.Ae(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Ae(480|r>>>12),this.Ae(128|63&r>>>6),this.Ae(128|63&r);else{const i=n.codePointAt(0);this.Ae(240|i>>>18),this.Ae(128|63&i>>>12),this.Ae(128|63&i>>>6),this.Ae(128|63&i)}}this.Re()}ve(e){const n=this.Ve(e),r=HE(n);this.Se(1+r),this.buffer[this.position++]=255&r;for(let i=n.length-r;i<n.length;++i)this.buffer[this.position++]=255&n[i]}De(e){const n=this.Ve(e),r=HE(n);this.Se(1+r),this.buffer[this.position++]=~(255&r);for(let i=n.length-r;i<n.length;++i)this.buffer[this.position++]=~(255&n[i])}Ce(){this.xe(255),this.xe(255)}Ne(){this.ke(255),this.ke(255)}reset(){this.position=0}seed(e){this.Se(e.length),this.buffer.set(e,this.position),this.position+=e.length}Oe(){return this.buffer.slice(0,this.position)}Ve(e){const n=function(i){const s=new DataView(new ArrayBuffer(8));return s.setFloat64(0,i,!1),new Uint8Array(s.buffer)}(e),r=(128&n[0])!=0;n[0]^=r?255:128;for(let i=1;i<n.length;++i)n[i]^=r?255:0;return n}Ie(e){const n=255&e;n===0?(this.xe(0),this.xe(255)):n===255?(this.xe(255),this.xe(0)):this.xe(n)}Ae(e){const n=255&e;n===0?(this.ke(0),this.ke(255)):n===255?(this.ke(255),this.ke(0)):this.ke(e)}Te(){this.xe(0),this.xe(1)}Re(){this.ke(0),this.ke(1)}xe(e){this.Se(1),this.buffer[this.position++]=e}ke(e){this.Se(1),this.buffer[this.position++]=~e}Se(e){const n=e+this.position;if(n<=this.buffer.length)return;let r=2*this.buffer.length;r<n&&(r=n);const i=new Uint8Array(r);i.set(this.buffer),this.buffer=i}}class U4{constructor(e){this.Me=e}de(e){this.Me.pe(e)}he(e){this.Me.be(e)}ae(e){this.Me.ve(e)}ue(){this.Me.Ce()}}class V4{constructor(e){this.Me=e}de(e){this.Me.Ee(e)}he(e){this.Me.Pe(e)}ae(e){this.Me.De(e)}ue(){this.Me.Ne()}}class _c{constructor(){this.Me=new F4,this.Fe=new U4(this.Me),this.$e=new V4(this.Me)}seed(e){this.Me.seed(e)}Be(e){return e===0?this.Fe:this.$e}Oe(){return this.Me.Oe()}reset(){this.Me.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rs{constructor(e,n,r,i){this.indexId=e,this.documentKey=n,this.arrayValue=r,this.directionalValue=i}Le(){const e=this.directionalValue.length,n=e===0||this.directionalValue[e-1]===255?e+1:e,r=new Uint8Array(n);return r.set(this.directionalValue,0),n!==e?r.set([0],this.directionalValue.length):++r[r.length-1],new Rs(this.indexId,this.documentKey,this.arrayValue,r)}}function _s(t,e){let n=t.indexId-e.indexId;return n!==0?n:(n=GE(t.arrayValue,e.arrayValue),n!==0?n:(n=GE(t.directionalValue,e.directionalValue),n!==0?n:W.comparator(t.documentKey,e.documentKey)))}function GE(t,e){for(let n=0;n<t.length&&n<e.length;++n){const r=t[n]-e[n];if(r!==0)return r}return t.length-e.length}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $4{constructor(e){this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.Ue=e.orderBy,this.qe=[];for(const n of e.filters){const r=n;r.ht()?this.Ke=r:this.qe.push(r)}}Ge(e){const n=xm(e);if(n!==void 0&&!this.Qe(n))return!1;const r=Is(e);let i=0,s=0;for(;i<r.length&&this.Qe(r[i]);++i);if(i===r.length)return!0;if(this.Ke!==void 0){const o=r[i];if(!this.je(this.Ke,o)||!this.We(this.Ue[s++],o))return!1;++i}for(;i<r.length;++i){const o=r[i];if(s>=this.Ue.length||!this.We(this.Ue[s++],o))return!1}return!0}Qe(e){for(const n of this.qe)if(this.je(n,e))return!0;return!1}je(e,n){if(e===void 0||!e.field.isEqual(n.fieldPath))return!1;const r=e.op==="array-contains"||e.op==="array-contains-any";return n.kind===2===r}We(e,n){return!!e.field.isEqual(n.fieldPath)&&(n.kind===0&&e.dir==="asc"||n.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class B4{constructor(){this.ze=new kv}addToCollectionParentIndex(e,n){return this.ze.add(n),T.resolve()}getCollectionParents(e,n){return T.resolve(this.ze.getEntries(n))}addFieldIndex(e,n){return T.resolve()}deleteFieldIndex(e,n){return T.resolve()}getDocumentsMatchingTarget(e,n){return T.resolve(null)}getIndexType(e,n){return T.resolve(0)}getFieldIndexes(e,n){return T.resolve([])}getNextCollectionGroupToUpdate(e){return T.resolve(null)}getMinOffset(e,n){return T.resolve(xn.min())}getMinOffsetFromCollectionGroup(e,n){return T.resolve(xn.min())}updateCollectionGroup(e,n,r){return T.resolve()}updateIndexEntries(e,n){return T.resolve()}}class kv{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),i=this.index[n]||new Ne(Ee.comparator),s=!i.has(r);return this.index[n]=i.add(r),s}has(e){const n=e.lastSegment(),r=e.popLast(),i=this.index[n];return i&&i.has(r)}getEntries(e){return(this.index[e]||new Ne(Ee.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const th=new Uint8Array(0);class j4{constructor(e,n){this.user=e,this.databaseId=n,this.He=new kv,this.Je=new us(r=>co(r),(r,i)=>ku(r,i)),this.uid=e.uid||""}addToCollectionParentIndex(e,n){if(!this.He.has(n)){const r=n.lastSegment(),i=n.popLast();e.addOnCommittedListener(()=>{this.He.add(n)});const s={collectionId:r,parent:un(i)};return zE(e).put(s)}return T.resolve()}getCollectionParents(e,n){const r=[],i=IDBKeyRange.bound([n,""],[QR(n),""],!1,!0);return zE(e).K(i).next(s=>{for(const o of s){if(o.collectionId!==n)break;r.push(Sr(o.parent))}return r})}addFieldIndex(e,n){const r=nh(e),i=function(o){return{indexId:o.indexId,collectionGroup:o.collectionGroup,fields:o.fields.map(a=>[a.fieldPath.canonicalString(),a.kind])}}(n);delete i.indexId;const s=r.add(i);if(n.indexState){const o=vc(e);return s.next(a=>{o.put(qE(a,this.user,n.indexState.sequenceNumber,n.indexState.offset))})}return s.next()}deleteFieldIndex(e,n){const r=nh(e),i=vc(e),s=yc(e);return r.delete(n.indexId).next(()=>i.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0))).next(()=>s.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0)))}getDocumentsMatchingTarget(e,n){const r=yc(e);let i=!0;const s=new Map;return T.forEach(this.Ye(n),o=>this.Xe(e,o).next(a=>{i&&(i=!!a),s.set(o,a)})).next(()=>{if(i){let o=fe();const a=[];return T.forEach(s,(c,l)=>{var u;L("IndexedDbIndexManager",`Using index ${u=c,`id=${u.indexId}|cg=${u.collectionGroup}|f=${u.fields.map(R=>`${R.fieldPath}:${R.kind}`).join(",")}`} to execute ${co(n)}`);const h=function(R,E){const p=xm(E);if(p===void 0)return null;for(const w of yd(R,p.fieldPath))switch(w.op){case"array-contains-any":return w.value.arrayValue.values||[];case"array-contains":return[w.value]}return null}(l,c),d=function(R,E){const p=new Map;for(const w of Is(E))for(const y of yd(R,w.fieldPath))switch(y.op){case"==":case"in":p.set(w.fieldPath.canonicalString(),y.value);break;case"not-in":case"!=":return p.set(w.fieldPath.canonicalString(),y.value),Array.from(p.values())}return null}(l,c),f=function(R,E){const p=[];let w=!0;for(const y of Is(E)){const m=y.kind===0?AE(R,y.fieldPath,R.startAt):kE(R,y.fieldPath,R.startAt);p.push(m.value),w&&(w=m.inclusive)}return new es(p,w)}(l,c),g=function(R,E){const p=[];let w=!0;for(const y of Is(E)){const m=y.kind===0?kE(R,y.fieldPath,R.endAt):AE(R,y.fieldPath,R.endAt);p.push(m.value),w&&(w=m.inclusive)}return new es(p,w)}(l,c),v=this.Ze(c,l,f),I=this.Ze(c,l,g),S=this.tn(c,l,d),k=this.en(c.indexId,h,v,f.inclusive,I,g.inclusive,S);return T.forEach(k,R=>r.j(R,n.limit).next(E=>{E.forEach(p=>{const w=W.fromSegments(p.documentKey);o.has(w)||(o=o.add(w),a.push(w))})}))}).next(()=>a)}return T.resolve(null)})}Ye(e){let n=this.Je.get(e);return n||(n=[e],this.Je.set(e,n),n)}en(e,n,r,i,s,o,a){const c=(n!=null?n.length:1)*Math.max(r.length,s.length),l=c/(n!=null?n.length:1),u=[];for(let h=0;h<c;++h){const d=n?this.nn(n[h/l]):th,f=this.sn(e,d,r[h%l],i),g=this.rn(e,d,s[h%l],o),v=a.map(I=>this.sn(e,d,I,!0));u.push(...this.createRange(f,g,v))}return u}sn(e,n,r,i){const s=new Rs(e,W.empty(),n,r);return i?s:s.Le()}rn(e,n,r,i){const s=new Rs(e,W.empty(),n,r);return i?s.Le():s}Xe(e,n){const r=new $4(n),i=n.collectionGroup!=null?n.collectionGroup:n.path.lastSegment();return this.getFieldIndexes(e,i).next(s=>{let o=null;for(const a of s)r.Ge(a)&&(!o||a.fields.length>o.fields.length)&&(o=a);return o})}getIndexType(e,n){let r=2;return T.forEach(this.Ye(n),i=>this.Xe(e,i).next(s=>{s?r!==0&&s.fields.length<function(o){let a=new Ne(ot.comparator),c=!1;for(const l of o.filters){const u=l;u.field.isKeyField()||(u.op==="array-contains"||u.op==="array-contains-any"?c=!0:a=a.add(u.field))}for(const l of o.orderBy)l.field.isKeyField()||(a=a.add(l.field));return a.size+(c?1:0)}(i)&&(r=1):r=0})).next(()=>r)}on(e,n){const r=new _c;for(const i of Is(e)){const s=n.data.field(i.fieldPath);if(s==null)return null;const o=r.Be(i.kind);ks.ye.re(s,o)}return r.Oe()}nn(e){const n=new _c;return ks.ye.re(e,n.Be(0)),n.Oe()}un(e,n){const r=new _c;return ks.ye.re(ao(this.databaseId,n),r.Be(function(i){const s=Is(i);return s.length===0?0:s[s.length-1].kind}(e))),r.Oe()}tn(e,n,r){if(r===null)return[];let i=[];i.push(new _c);let s=0;for(const o of Is(e)){const a=r[s++];for(const c of i)if(this.cn(n,o.fieldPath)&&ql(a))i=this.an(i,o,a);else{const l=c.Be(o.kind);ks.ye.re(a,l)}}return this.hn(i)}Ze(e,n,r){return this.tn(e,n,r.position)}hn(e){const n=[];for(let r=0;r<e.length;++r)n[r]=e[r].Oe();return n}an(e,n,r){const i=[...e],s=[];for(const o of r.arrayValue.values||[])for(const a of i){const c=new _c;c.seed(a.Oe()),ks.ye.re(o,c.Be(n.kind)),s.push(c)}return s}cn(e,n){return!!e.filters.find(r=>r instanceof $t&&r.field.isEqual(n)&&(r.op==="in"||r.op==="not-in"))}getFieldIndexes(e,n){const r=nh(e),i=vc(e);return(n?r.K("collectionGroupIndex",IDBKeyRange.bound(n,n)):r.K()).next(s=>{const o=[];return T.forEach(s,a=>i.get([a.indexId,this.uid]).next(c=>{o.push(function(l,u){const h=u?new md(u.sequenceNumber,new xn(fo(u.readTime),new W(Sr(u.documentKey)),u.largestBatchId)):md.empty(),d=l.fields.map(([f,g])=>new E2(ot.fromServerFormat(f),g));return new YR(l.indexId,l.collectionGroup,d,h)}(a,c))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(n=>n.length===0?null:(n.sort((r,i)=>{const s=r.indexState.sequenceNumber-i.indexState.sequenceNumber;return s!==0?s:ue(r.collectionGroup,i.collectionGroup)}),n[0].collectionGroup))}updateCollectionGroup(e,n,r){const i=nh(e),s=vc(e);return this.ln(e).next(o=>i.K("collectionGroupIndex",IDBKeyRange.bound(n,n)).next(a=>T.forEach(a,c=>s.put(qE(c.indexId,this.user,o,r)))))}updateIndexEntries(e,n){const r=new Map;return T.forEach(n,(i,s)=>{const o=r.get(i.collectionGroup);return(o?T.resolve(o):this.getFieldIndexes(e,i.collectionGroup)).next(a=>(r.set(i.collectionGroup,a),T.forEach(a,c=>this.fn(e,i,c).next(l=>{const u=this.dn(s,c);return l.isEqual(u)?T.resolve():this._n(e,s,c,l,u)}))))})}wn(e,n,r,i){return yc(e).put({indexId:i.indexId,uid:this.uid,arrayValue:i.arrayValue,directionalValue:i.directionalValue,orderedDocumentKey:this.un(r,n.key),documentKey:n.key.path.toArray()})}mn(e,n,r,i){return yc(e).delete([i.indexId,this.uid,i.arrayValue,i.directionalValue,this.un(r,n.key),n.key.path.toArray()])}fn(e,n,r){const i=yc(e);let s=new Ne(_s);return i.J({index:"documentKeyIndex",range:IDBKeyRange.only([r.indexId,this.uid,this.un(r,n)])},(o,a)=>{s=s.add(new Rs(r.indexId,n,a.arrayValue,a.directionalValue))}).next(()=>s)}dn(e,n){let r=new Ne(_s);const i=this.on(n,e);if(i==null)return r;const s=xm(n);if(s!=null){const o=e.data.field(s.fieldPath);if(ql(o))for(const a of o.arrayValue.values||[])r=r.add(new Rs(n.indexId,e.key,this.nn(a),i))}else r=r.add(new Rs(n.indexId,e.key,th,i));return r}_n(e,n,r,i,s){L("IndexedDbIndexManager","Updating index entries for document '%s'",n.key);const o=[];return function(a,c,l,u,h){const d=a.getIterator(),f=c.getIterator();let g=Fo(d),v=Fo(f);for(;g||v;){let I=!1,S=!1;if(g&&v){const k=l(g,v);k<0?S=!0:k>0&&(I=!0)}else g!=null?S=!0:I=!0;I?(u(v),v=Fo(f)):S?(h(g),g=Fo(d)):(g=Fo(d),v=Fo(f))}}(i,s,_s,a=>{o.push(this.wn(e,n,r,a))},a=>{o.push(this.mn(e,n,r,a))}),T.waitFor(o)}ln(e){let n=1;return vc(e).J({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,i,s)=>{s.done(),n=i.sequenceNumber+1}).next(()=>n)}createRange(e,n,r){r=r.sort((o,a)=>_s(o,a)).filter((o,a,c)=>!a||_s(o,c[a-1])!==0);const i=[];i.push(e);for(const o of r){const a=_s(o,e),c=_s(o,n);if(a===0)i[0]=e.Le();else if(a>0&&c<0)i.push(o),i.push(o.Le());else if(c>0)break}i.push(n);const s=[];for(let o=0;o<i.length;o+=2)s.push(IDBKeyRange.bound([i[o].indexId,this.uid,i[o].arrayValue,i[o].directionalValue,th,[]],[i[o+1].indexId,this.uid,i[o+1].arrayValue,i[o+1].directionalValue,th,[]]));return s}getMinOffsetFromCollectionGroup(e,n){return this.getFieldIndexes(e,n).next(QE)}getMinOffset(e,n){return T.mapArray(this.Ye(n),r=>this.Xe(e,r).next(i=>i||Y())).next(QE)}}function zE(t){return xt(t,"collectionParents")}function yc(t){return xt(t,"indexEntries")}function nh(t){return xt(t,"indexConfiguration")}function vc(t){return xt(t,"indexState")}function QE(t){ae(t.length!==0);let e=t[0].indexState.offset,n=e.largestBatchId;for(let r=1;r<t.length;r++){const i=t[r].indexState.offset;gv(i,e)<0&&(e=i),n<i.largestBatchId&&(n=i.largestBatchId)}return new xn(e.readTime,e.documentKey,n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YE={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class gn{constructor(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new gn(e,gn.DEFAULT_COLLECTION_PERCENTILE,gn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function WN(t,e,n){const r=t.store("mutations"),i=t.store("documentMutations"),s=[],o=IDBKeyRange.only(n.batchId);let a=0;const c=r.J({range:o},(u,h,d)=>(a++,d.delete()));s.push(c.next(()=>{ae(a===1)}));const l=[];for(const u of n.mutations){const h=UN(e,u.key.path,n.batchId);s.push(i.delete(h)),l.push(u.key)}return T.waitFor(s).next(()=>l)}function wd(t){if(!t)return 0;let e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw Y();e=t.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */gn.DEFAULT_COLLECTION_PERCENTILE=10,gn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,gn.DEFAULT=new gn(41943040,gn.DEFAULT_COLLECTION_PERCENTILE,gn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),gn.DISABLED=new gn(-1,0,0);class Jf{constructor(e,n,r,i){this.userId=e,this.wt=n,this.indexManager=r,this.referenceDelegate=i,this.gn={}}static se(e,n,r,i){ae(e.uid!=="");const s=e.isAuthenticated()?e.uid:"";return new Jf(s,n,r,i)}checkEmpty(e){let n=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Ii(e).J({index:"userMutationsIndex",range:r},(i,s,o)=>{n=!1,o.done()}).next(()=>n)}addMutationBatch(e,n,r,i){const s=Ko(e),o=Ii(e);return o.add({}).next(a=>{ae(typeof a=="number");const c=new Tv(a,n,r,i),l=function(d,f,g){const v=g.baseMutations.map(S=>Gl(d.ne,S)),I=g.mutations.map(S=>Gl(d.ne,S));return{userId:f,batchId:g.batchId,localWriteTimeMs:g.localWriteTime.toMillis(),baseMutations:v,mutations:I}}(this.wt,this.userId,c),u=[];let h=new Ne((d,f)=>ue(d.canonicalString(),f.canonicalString()));for(const d of i){const f=UN(this.userId,d.key.path,a);h=h.add(d.key.path.popLast()),u.push(o.put(l)),u.push(s.put(f,_4))}return h.forEach(d=>{u.push(this.indexManager.addToCollectionParentIndex(e,d))}),e.addOnCommittedListener(()=>{this.gn[a]=c.keys()}),T.waitFor(u).next(()=>c)})}lookupMutationBatch(e,n){return Ii(e).get(n).next(r=>r?(ae(r.userId===this.userId),As(this.wt,r)):null)}yn(e,n){return this.gn[n]?T.resolve(this.gn[n]):this.lookupMutationBatch(e,n).next(r=>{if(r){const i=r.keys();return this.gn[n]=i,i}return null})}getNextMutationBatchAfterBatchId(e,n){const r=n+1,i=IDBKeyRange.lowerBound([this.userId,r]);let s=null;return Ii(e).J({index:"userMutationsIndex",range:i},(o,a,c)=>{a.userId===this.userId&&(ae(a.batchId>=r),s=As(this.wt,a)),c.done()}).next(()=>s)}getHighestUnacknowledgedBatchId(e){const n=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=-1;return Ii(e).J({index:"userMutationsIndex",range:n,reverse:!0},(i,s,o)=>{r=s.batchId,o.done()}).next(()=>r)}getAllMutationBatches(e){const n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Ii(e).K("userMutationsIndex",n).next(r=>r.map(i=>As(this.wt,i)))}getAllMutationBatchesAffectingDocumentKey(e,n){const r=Th(this.userId,n.path),i=IDBKeyRange.lowerBound(r),s=[];return Ko(e).J({range:i},(o,a,c)=>{const[l,u,h]=o,d=Sr(u);if(l===this.userId&&n.path.isEqual(d))return Ii(e).get(h).next(f=>{if(!f)throw Y();ae(f.userId===this.userId),s.push(As(this.wt,f))});c.done()}).next(()=>s)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Ne(ue);const i=[];return n.forEach(s=>{const o=Th(this.userId,s.path),a=IDBKeyRange.lowerBound(o),c=Ko(e).J({range:a},(l,u,h)=>{const[d,f,g]=l,v=Sr(f);d===this.userId&&s.path.isEqual(v)?r=r.add(g):h.done()});i.push(c)}),T.waitFor(i).next(()=>this.pn(e,r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,i=r.length+1,s=Th(this.userId,r),o=IDBKeyRange.lowerBound(s);let a=new Ne(ue);return Ko(e).J({range:o},(c,l,u)=>{const[h,d,f]=c,g=Sr(d);h===this.userId&&r.isPrefixOf(g)?g.length===i&&(a=a.add(f)):u.done()}).next(()=>this.pn(e,a))}pn(e,n){const r=[],i=[];return n.forEach(s=>{i.push(Ii(e).get(s).next(o=>{if(o===null)throw Y();ae(o.userId===this.userId),r.push(As(this.wt,o))}))}),T.waitFor(i).next(()=>r)}removeMutationBatch(e,n){return WN(e.ee,this.userId,n).next(r=>(e.addOnCommittedListener(()=>{this.In(n.batchId)}),T.forEach(r,i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))}In(e){delete this.gn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(n=>{if(!n)return T.resolve();const r=IDBKeyRange.lowerBound([this.userId]),i=[];return Ko(e).J({range:r},(s,o,a)=>{if(s[0]===this.userId){const c=Sr(s[1]);i.push(c)}else a.done()}).next(()=>{ae(i.length===0)})})}containsKey(e,n){return KN(e,this.userId,n)}Tn(e){return HN(e).get(this.userId).next(n=>n||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}}function KN(t,e,n){const r=Th(e,n.path),i=r[1],s=IDBKeyRange.lowerBound(r);let o=!1;return Ko(t).J({range:s,H:!0},(a,c,l)=>{const[u,h,d]=a;u===e&&h===i&&(o=!0),l.done()}).next(()=>o)}function Ii(t){return xt(t,"mutations")}function Ko(t){return xt(t,"documentMutations")}function HN(t){return xt(t,"mutationQueues")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class po{constructor(e){this.En=e}next(){return this.En+=2,this.En}static An(){return new po(0)}static Rn(){return new po(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q4{constructor(e,n){this.referenceDelegate=e,this.wt=n}allocateTargetId(e){return this.bn(e).next(n=>{const r=new po(n.highestTargetId);return n.highestTargetId=r.next(),this.Pn(e,n).next(()=>n.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.bn(e).next(n=>se.fromTimestamp(new Je(n.lastRemoteSnapshotVersion.seconds,n.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.bn(e).next(n=>n.highestListenSequenceNumber)}setTargetsMetadata(e,n,r){return this.bn(e).next(i=>(i.highestListenSequenceNumber=n,r&&(i.lastRemoteSnapshotVersion=r.toTimestamp()),n>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=n),this.Pn(e,i)))}addTargetData(e,n){return this.vn(e,n).next(()=>this.bn(e).next(r=>(r.targetCount+=1,this.Vn(n,r),this.Pn(e,r))))}updateTargetData(e,n){return this.vn(e,n)}removeTargetData(e,n){return this.removeMatchingKeysForTargetId(e,n.targetId).next(()=>Vo(e).delete(n.targetId)).next(()=>this.bn(e)).next(r=>(ae(r.targetCount>0),r.targetCount-=1,this.Pn(e,r)))}removeTargets(e,n,r){let i=0;const s=[];return Vo(e).J((o,a)=>{const c=Rc(a);c.sequenceNumber<=n&&r.get(c.targetId)===null&&(i++,s.push(this.removeTargetData(e,c)))}).next(()=>T.waitFor(s)).next(()=>i)}forEachTarget(e,n){return Vo(e).J((r,i)=>{const s=Rc(i);n(s)})}bn(e){return JE(e).get("targetGlobalKey").next(n=>(ae(n!==null),n))}Pn(e,n){return JE(e).put("targetGlobalKey",n)}vn(e,n){return Vo(e).put(qN(this.wt,n))}Vn(e,n){let r=!1;return e.targetId>n.highestTargetId&&(n.highestTargetId=e.targetId,r=!0),e.sequenceNumber>n.highestListenSequenceNumber&&(n.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.bn(e).next(n=>n.targetCount)}getTargetData(e,n){const r=co(n),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let s=null;return Vo(e).J({range:i,index:"queryTargetsIndex"},(o,a,c)=>{const l=Rc(a);ku(n,l.target)&&(s=l,c.done())}).next(()=>s)}addMatchingKeys(e,n,r){const i=[],s=ki(e);return n.forEach(o=>{const a=un(o.path);i.push(s.put({targetId:r,path:a})),i.push(this.referenceDelegate.addReference(e,r,o))}),T.waitFor(i)}removeMatchingKeys(e,n,r){const i=ki(e);return T.forEach(n,s=>{const o=un(s.path);return T.waitFor([i.delete([r,o]),this.referenceDelegate.removeReference(e,r,s)])})}removeMatchingKeysForTargetId(e,n){const r=ki(e),i=IDBKeyRange.bound([n],[n+1],!1,!0);return r.delete(i)}getMatchingKeysForTargetId(e,n){const r=IDBKeyRange.bound([n],[n+1],!1,!0),i=ki(e);let s=fe();return i.J({range:r,H:!0},(o,a,c)=>{const l=Sr(o[1]),u=new W(l);s=s.add(u)}).next(()=>s)}containsKey(e,n){const r=un(n.path),i=IDBKeyRange.bound([r],[QR(r)],!1,!0);let s=0;return ki(e).J({index:"documentTargetsIndex",H:!0,range:i},([o,a],c,l)=>{o!==0&&(s++,l.done())}).next(()=>s>0)}te(e,n){return Vo(e).get(n).next(r=>r?Rc(r):null)}}function Vo(t){return xt(t,"targets")}function JE(t){return xt(t,"targetGlobal")}function ki(t){return xt(t,"targetDocuments")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function XE([t,e],[n,r]){const i=ue(t,n);return i===0?ue(e,r):i}class W4{constructor(e){this.Sn=e,this.buffer=new Ne(XE),this.Dn=0}Cn(){return++this.Dn}xn(e){const n=[e,this.Cn()];if(this.buffer.size<this.Sn)this.buffer=this.buffer.add(n);else{const r=this.buffer.last();XE(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}}class K4{constructor(e,n,r){this.garbageCollector=e,this.asyncQueue=n,this.localStore=r,this.Nn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.kn(6e4)}stop(){this.Nn&&(this.Nn.cancel(),this.Nn=null)}get started(){return this.Nn!==null}kn(e){L("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.Nn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Nn=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){ls(n)?L("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",n):await cs(n)}await this.kn(3e5)})}}class H4{constructor(e,n){this.On=e,this.params=n}calculateTargetCount(e,n){return this.On.Mn(e).next(r=>Math.floor(n/100*r))}nthSequenceNumber(e,n){if(n===0)return T.resolve(yn.ot);const r=new W4(n);return this.On.forEachTarget(e,i=>r.xn(i.sequenceNumber)).next(()=>this.On.Fn(e,i=>r.xn(i))).next(()=>r.maxValue)}removeTargets(e,n,r){return this.On.removeTargets(e,n,r)}removeOrphanedDocuments(e,n){return this.On.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(L("LruGarbageCollector","Garbage collection skipped; disabled"),T.resolve(YE)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(L("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),YE):this.$n(e,n))}getCacheSize(e){return this.On.getCacheSize(e)}$n(e,n){let r,i,s,o,a,c,l;const u=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(h=>(h>this.params.maximumSequenceNumbersToCollect?(L("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${h}`),i=this.params.maximumSequenceNumbersToCollect):i=h,o=Date.now(),this.nthSequenceNumber(e,i))).next(h=>(r=h,a=Date.now(),this.removeTargets(e,r,n))).next(h=>(s=h,c=Date.now(),this.removeOrphanedDocuments(e,r))).next(h=>(l=Date.now(),Om()<=ge.DEBUG&&L("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-u}ms
	Determined least recently used ${i} in `+(a-o)+`ms
	Removed ${s} targets in `+(c-a)+`ms
	Removed ${h} documents in `+(l-c)+`ms
Total Duration: ${l-u}ms`),T.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:h})))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G4{constructor(e,n){this.db=e,this.garbageCollector=function(r,i){return new H4(r,i)}(this,n)}Mn(e){const n=this.Bn(e);return this.db.getTargetCache().getTargetCount(e).next(r=>n.next(i=>r+i))}Bn(e){let n=0;return this.Fn(e,r=>{n++}).next(()=>n)}forEachTarget(e,n){return this.db.getTargetCache().forEachTarget(e,n)}Fn(e,n){return this.Ln(e,(r,i)=>n(i))}addReference(e,n,r){return rh(e,r)}removeReference(e,n,r){return rh(e,r)}removeTargets(e,n,r){return this.db.getTargetCache().removeTargets(e,n,r)}markPotentiallyOrphaned(e,n){return rh(e,n)}Un(e,n){return function(r,i){let s=!1;return HN(r).Y(o=>KN(r,o,i).next(a=>(a&&(s=!0),T.resolve(!a)))).next(()=>s)}(e,n)}removeOrphanedDocuments(e,n){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[];let s=0;return this.Ln(e,(o,a)=>{if(a<=n){const c=this.Un(e,o).next(l=>{if(!l)return s++,r.getEntry(e,o).next(()=>(r.removeEntry(o,se.min()),ki(e).delete([0,un(o.path)])))});i.push(c)}}).next(()=>T.waitFor(i)).next(()=>r.apply(e)).next(()=>s)}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,n){return rh(e,n)}Ln(e,n){const r=ki(e);let i,s=yn.ot;return r.J({index:"documentTargetsIndex"},([o,a],{path:c,sequenceNumber:l})=>{o===0?(s!==yn.ot&&n(new W(Sr(i)),s),s=l,i=c):s=yn.ot}).next(()=>{s!==yn.ot&&n(new W(Sr(i)),s)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function rh(t,e){return ki(t).put(function(n,r){return{targetId:0,path:un(n.path),sequenceNumber:r}}(e,t.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GN{constructor(){this.changes=new us(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,je.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?T.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z4{constructor(e){this.wt=e}setIndexManager(e){this.indexManager=e}addEntry(e,n,r){return ys(e).put(r)}removeEntry(e,n,r){return ys(e).delete(function(i,s){const o=i.path.toArray();return[o.slice(0,o.length-2),o[o.length-2],vd(s),o[o.length-1]]}(n,r))}updateMetadata(e,n){return this.getMetadata(e).next(r=>(r.byteSize+=n,this.qn(e,r)))}getEntry(e,n){let r=je.newInvalidDocument(n);return ys(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(wc(n))},(i,s)=>{r=this.Kn(n,s)}).next(()=>r)}Gn(e,n){let r={size:0,document:je.newInvalidDocument(n)};return ys(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(wc(n))},(i,s)=>{r={document:this.Kn(n,s),size:wd(s)}}).next(()=>r)}getEntries(e,n){let r=vn();return this.Qn(e,n,(i,s)=>{const o=this.Kn(i,s);r=r.insert(i,o)}).next(()=>r)}jn(e,n){let r=vn(),i=new rt(W.comparator);return this.Qn(e,n,(s,o)=>{const a=this.Kn(s,o);r=r.insert(s,a),i=i.insert(s,wd(o))}).next(()=>({documents:r,Wn:i}))}Qn(e,n,r){if(n.isEmpty())return T.resolve();let i=new Ne(tT);n.forEach(c=>i=i.add(c));const s=IDBKeyRange.bound(wc(i.first()),wc(i.last())),o=i.getIterator();let a=o.getNext();return ys(e).J({index:"documentKeyIndex",range:s},(c,l,u)=>{const h=W.fromSegments([...l.prefixPath,l.collectionGroup,l.documentId]);for(;a&&tT(a,h)<0;)r(a,null),a=o.getNext();a&&a.isEqual(h)&&(r(a,l),a=o.hasNext()?o.getNext():null),a?u.q(wc(a)):u.done()}).next(()=>{for(;a;)r(a,null),a=o.hasNext()?o.getNext():null})}getAllFromCollection(e,n,r){const i=[n.popLast().toArray(),n.lastSegment(),vd(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],s=[n.popLast().toArray(),n.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return ys(e).K(IDBKeyRange.bound(i,s,!0)).next(o=>{let a=vn();for(const c of o){const l=this.Kn(W.fromSegments(c.prefixPath.concat(c.collectionGroup,c.documentId)),c);a=a.insert(l.key,l)}return a})}getAllFromCollectionGroup(e,n,r,i){let s=vn();const o=eT(n,r),a=eT(n,xn.max());return ys(e).J({index:"collectionGroupIndex",range:IDBKeyRange.bound(o,a,!0)},(c,l,u)=>{const h=this.Kn(W.fromSegments(l.prefixPath.concat(l.collectionGroup,l.documentId)),l);s=s.insert(h.key,h),s.size===i&&u.done()}).next(()=>s)}newChangeBuffer(e){return new Q4(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(n=>n.byteSize)}getMetadata(e){return ZE(e).get("remoteDocumentGlobalKey").next(n=>(ae(!!n),n))}qn(e,n){return ZE(e).put("remoteDocumentGlobalKey",n)}Kn(e,n){if(n){const r=x4(this.wt,n);if(!(r.isNoDocument()&&r.version.isEqual(se.min())))return r}return je.newInvalidDocument(e)}}function zN(t){return new z4(t)}class Q4 extends GN{constructor(e,n){super(),this.zn=e,this.trackRemovals=n,this.Hn=new us(r=>r.toString(),(r,i)=>r.isEqual(i))}applyChanges(e){const n=[];let r=0,i=new Ne((s,o)=>ue(s.canonicalString(),o.canonicalString()));return this.changes.forEach((s,o)=>{const a=this.Hn.get(s);if(n.push(this.zn.removeEntry(e,s,a.readTime)),o.isValidDocument()){const c=BE(this.zn.wt,o);i=i.add(s.path.popLast()),r+=wd(c)-a.size,n.push(this.zn.addEntry(e,s,c))}else if(r-=a.size,this.trackRemovals){const c=BE(this.zn.wt,o.convertToNoDocument(se.min()));n.push(this.zn.addEntry(e,s,c))}}),i.forEach(s=>{n.push(this.zn.indexManager.addToCollectionParentIndex(e,s))}),n.push(this.zn.updateMetadata(e,r)),T.waitFor(n)}getFromCache(e,n){return this.zn.Gn(e,n).next(r=>(this.Hn.set(n,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,n){return this.zn.jn(e,n).next(({documents:r,Wn:i})=>(i.forEach((s,o)=>{this.Hn.set(s,{size:o,readTime:r.get(s).readTime})}),r))}}function ZE(t){return xt(t,"remoteDocumentGlobal")}function ys(t){return xt(t,"remoteDocumentsV14")}function wc(t){const e=t.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function eT(t,e){const n=e.documentKey.path.toArray();return[t,vd(e.readTime),n.slice(0,n.length-2),n.length>0?n[n.length-1]:""]}function tT(t,e){const n=t.path.toArray(),r=e.path.toArray();let i=0;for(let s=0;s<n.length-2&&s<r.length-2;++s)if(i=ue(n[s],r[s]),i)return i;return i=ue(n.length,r.length),i||(i=ue(n[n.length-2],r[r.length-2]),i||ue(n[n.length-1],r[r.length-1]))}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y4{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QN{constructor(e,n,r,i){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(i=>(r=i,this.getBaseDocument(e,n,r))).next(i=>(r!==null&&zc(r.mutation,i,Nn.empty(),Je.now()),i))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,fe()).next(()=>r))}getLocalViewOfDocuments(e,n,r=fe()){const i=Tr();return this.populateOverlays(e,i,n).next(()=>this.computeViews(e,n,i,r).next(s=>{let o=kc();return s.forEach((a,c)=>{o=o.insert(a,c.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){const r=Tr();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,fe()))}populateOverlays(e,n,r){const i=[];return r.forEach(s=>{n.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((o,a)=>{n.set(o,a)})})}computeViews(e,n,r,i){let s=vn();const o=Qc(),a=Qc();return n.forEach((c,l)=>{const u=r.get(l.key);i.has(l.key)&&(u===void 0||u.mutation instanceof fi)?s=s.insert(l.key,l):u!==void 0&&(o.set(l.key,u.mutation.getFieldMask()),zc(u.mutation,l,u.mutation.getFieldMask(),Je.now()))}),this.recalculateAndSaveOverlays(e,s).next(c=>(c.forEach((l,u)=>o.set(l,u)),n.forEach((l,u)=>{var h;return a.set(l,new Y4(u,(h=o.get(l))!==null&&h!==void 0?h:null))}),a))}recalculateAndSaveOverlays(e,n){const r=Qc();let i=new rt((o,a)=>o-a),s=fe();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(const a of o)a.keys().forEach(c=>{const l=n.get(c);if(l===null)return;let u=r.get(c)||Nn.empty();u=a.applyToLocalView(l,u),r.set(c,u);const h=(i.get(a.batchId)||fe()).add(c);i=i.insert(a.batchId,h)})}).next(()=>{const o=[],a=i.getReverseIterator();for(;a.hasNext();){const c=a.getNext(),l=c.key,u=c.value,h=SN();u.forEach(d=>{if(!s.has(d)){const f=vN(n.get(d),r.get(d));f!==null&&h.set(d,f),s=s.add(d)}}),o.push(this.documentOverlayCache.saveOverlays(e,l,h))}return T.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r){return function(i){return W.isDocumentKey(i.path)&&i.collectionGroup===null&&i.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):wv(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r):this.getDocumentsMatchingCollectionQuery(e,n,r)}getNextDocuments(e,n,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,i).next(s=>{const o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,i-s.size):T.resolve(Tr());let a=-1,c=s;return o.next(l=>T.forEach(l,(u,h)=>(a<h.largestBatchId&&(a=h.largestBatchId),s.get(u)?T.resolve():this.getBaseDocument(e,u,h).next(d=>{c=c.insert(u,d)}))).next(()=>this.populateOverlays(e,l,s)).next(()=>this.computeViews(e,c,l,fe())).next(u=>({batchId:a,changes:TN(u)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new W(n)).next(r=>{let i=kc();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,n,r){const i=n.collectionGroup;let s=kc();return this.indexManager.getCollectionParents(e,i).next(o=>T.forEach(o,a=>{const c=function(l,u){return new di(u,null,l.explicitOrderBy.slice(),l.filters.slice(),l.limit,l.limitType,l.startAt,l.endAt)}(n,a.child(i));return this.getDocumentsMatchingCollectionQuery(e,c,r).next(l=>{l.forEach((u,h)=>{s=s.insert(u,h)})})}).next(()=>s))}getDocumentsMatchingCollectionQuery(e,n,r){let i;return this.remoteDocumentCache.getAllFromCollection(e,n.path,r).next(s=>(i=s,this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId))).next(s=>{s.forEach((a,c)=>{const l=c.getKey();i.get(l)===null&&(i=i.insert(l,je.newInvalidDocument(l)))});let o=kc();return i.forEach((a,c)=>{const l=s.get(a);l!==void 0&&zc(l.mutation,c,Nn.empty(),Je.now()),bv(n,c)&&(o=o.insert(a,c))}),o})}getBaseDocument(e,n,r){return r===null||r.mutation.type===1?this.remoteDocumentCache.getEntry(e,n):T.resolve(je.newInvalidDocument(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J4{constructor(e){this.wt=e,this.Jn=new Map,this.Yn=new Map}getBundleMetadata(e,n){return T.resolve(this.Jn.get(n))}saveBundleMetadata(e,n){var r;return this.Jn.set(n.id,{id:(r=n).id,version:r.version,createTime:Ct(r.createTime)}),T.resolve()}getNamedQuery(e,n){return T.resolve(this.Yn.get(n))}saveNamedQuery(e,n){return this.Yn.set(n.name,function(r){return{name:r.name,query:Av(r.bundledQuery),readTime:Ct(r.readTime)}}(n)),T.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X4{constructor(){this.overlays=new rt(W.comparator),this.Xn=new Map}getOverlay(e,n){return T.resolve(this.overlays.get(n))}getOverlays(e,n){const r=Tr();return T.forEach(n,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((i,s)=>{this.ie(e,n,s)}),T.resolve()}removeOverlaysForBatchId(e,n,r){const i=this.Xn.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.Xn.delete(r)),T.resolve()}getOverlaysForCollection(e,n,r){const i=Tr(),s=n.length+1,o=new W(n.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const c=a.getNext().value,l=c.getKey();if(!n.isPrefixOf(l.path))break;l.path.length===s&&c.largestBatchId>r&&i.set(c.getKey(),c)}return T.resolve(i)}getOverlaysForCollectionGroup(e,n,r,i){let s=new rt((l,u)=>l-u);const o=this.overlays.getIterator();for(;o.hasNext();){const l=o.getNext().value;if(l.getKey().getCollectionGroup()===n&&l.largestBatchId>r){let u=s.get(l.largestBatchId);u===null&&(u=Tr(),s=s.insert(l.largestBatchId,u)),u.set(l.getKey(),l)}}const a=Tr(),c=s.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((l,u)=>a.set(l,u)),!(a.size()>=i)););return T.resolve(a)}ie(e,n,r){const i=this.overlays.get(r.key);if(i!==null){const o=this.Xn.get(i.largestBatchId).delete(r.key);this.Xn.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new Cv(n,r));let s=this.Xn.get(n);s===void 0&&(s=fe(),this.Xn.set(n,s)),this.Xn.set(n,s.add(r.key))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rv{constructor(){this.Zn=new Ne(vt.ts),this.es=new Ne(vt.ns)}isEmpty(){return this.Zn.isEmpty()}addReference(e,n){const r=new vt(e,n);this.Zn=this.Zn.add(r),this.es=this.es.add(r)}ss(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.rs(new vt(e,n))}os(e,n){e.forEach(r=>this.removeReference(r,n))}us(e){const n=new W(new Ee([])),r=new vt(n,e),i=new vt(n,e+1),s=[];return this.es.forEachInRange([r,i],o=>{this.rs(o),s.push(o.key)}),s}cs(){this.Zn.forEach(e=>this.rs(e))}rs(e){this.Zn=this.Zn.delete(e),this.es=this.es.delete(e)}hs(e){const n=new W(new Ee([])),r=new vt(n,e),i=new vt(n,e+1);let s=fe();return this.es.forEachInRange([r,i],o=>{s=s.add(o.key)}),s}containsKey(e){const n=new vt(e,0),r=this.Zn.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class vt{constructor(e,n){this.key=e,this.ls=n}static ts(e,n){return W.comparator(e.key,n.key)||ue(e.ls,n.ls)}static ns(e,n){return ue(e.ls,n.ls)||W.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z4{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.fs=1,this.ds=new Ne(vt.ts)}checkEmpty(e){return T.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,i){const s=this.fs;this.fs++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new Tv(s,n,r,i);this.mutationQueue.push(o);for(const a of i)this.ds=this.ds.add(new vt(a.key,s)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return T.resolve(o)}lookupMutationBatch(e,n){return T.resolve(this._s(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,i=this.ws(r),s=i<0?0:i;return T.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return T.resolve(this.mutationQueue.length===0?-1:this.fs-1)}getAllMutationBatches(e){return T.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new vt(n,0),i=new vt(n,Number.POSITIVE_INFINITY),s=[];return this.ds.forEachInRange([r,i],o=>{const a=this._s(o.ls);s.push(a)}),T.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Ne(ue);return n.forEach(i=>{const s=new vt(i,0),o=new vt(i,Number.POSITIVE_INFINITY);this.ds.forEachInRange([s,o],a=>{r=r.add(a.ls)})}),T.resolve(this.gs(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,i=r.length+1;let s=r;W.isDocumentKey(s)||(s=s.child(""));const o=new vt(new W(s),0);let a=new Ne(ue);return this.ds.forEachWhile(c=>{const l=c.key.path;return!!r.isPrefixOf(l)&&(l.length===i&&(a=a.add(c.ls)),!0)},o),T.resolve(this.gs(a))}gs(e){const n=[];return e.forEach(r=>{const i=this._s(r);i!==null&&n.push(i)}),n}removeMutationBatch(e,n){ae(this.ys(n.batchId,"removed")===0),this.mutationQueue.shift();let r=this.ds;return T.forEach(n.mutations,i=>{const s=new vt(i.key,n.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.ds=r})}In(e){}containsKey(e,n){const r=new vt(n,0),i=this.ds.firstAfterOrEqual(r);return T.resolve(n.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,T.resolve()}ys(e,n){return this.ws(e)}ws(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}_s(e){const n=this.ws(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e6{constructor(e){this.ps=e,this.docs=new rt(W.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,i=this.docs.get(r),s=i?i.size:0,o=this.ps(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return T.resolve(r?r.document.mutableCopy():je.newInvalidDocument(n))}getEntries(e,n){let r=vn();return n.forEach(i=>{const s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():je.newInvalidDocument(i))}),T.resolve(r)}getAllFromCollection(e,n,r){let i=vn();const s=new W(n.child("")),o=this.docs.getIteratorFrom(s);for(;o.hasNext();){const{key:a,value:{document:c}}=o.getNext();if(!n.isPrefixOf(a.path))break;a.path.length>n.length+1||gv(XR(c),r)<=0||(i=i.insert(c.key,c.mutableCopy()))}return T.resolve(i)}getAllFromCollectionGroup(e,n,r,i){Y()}Is(e,n){return T.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new t6(this)}getSize(e){return T.resolve(this.size)}}class t6 extends GN{constructor(e){super(),this.zn=e}applyChanges(e){const n=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?n.push(this.zn.addEntry(e,i)):this.zn.removeEntry(r)}),T.waitFor(n)}getFromCache(e,n){return this.zn.getEntry(e,n)}getAllFromCache(e,n){return this.zn.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class n6{constructor(e){this.persistence=e,this.Ts=new us(n=>co(n),ku),this.lastRemoteSnapshotVersion=se.min(),this.highestTargetId=0,this.Es=0,this.As=new Rv,this.targetCount=0,this.Rs=po.An()}forEachTarget(e,n){return this.Ts.forEach((r,i)=>n(i)),T.resolve()}getLastRemoteSnapshotVersion(e){return T.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return T.resolve(this.Es)}allocateTargetId(e){return this.highestTargetId=this.Rs.next(),T.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.Es&&(this.Es=n),T.resolve()}vn(e){this.Ts.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.Rs=new po(n),this.highestTargetId=n),e.sequenceNumber>this.Es&&(this.Es=e.sequenceNumber)}addTargetData(e,n){return this.vn(n),this.targetCount+=1,T.resolve()}updateTargetData(e,n){return this.vn(n),T.resolve()}removeTargetData(e,n){return this.Ts.delete(n.target),this.As.us(n.targetId),this.targetCount-=1,T.resolve()}removeTargets(e,n,r){let i=0;const s=[];return this.Ts.forEach((o,a)=>{a.sequenceNumber<=n&&r.get(a.targetId)===null&&(this.Ts.delete(o),s.push(this.removeMatchingKeysForTargetId(e,a.targetId)),i++)}),T.waitFor(s).next(()=>i)}getTargetCount(e){return T.resolve(this.targetCount)}getTargetData(e,n){const r=this.Ts.get(n)||null;return T.resolve(r)}addMatchingKeys(e,n,r){return this.As.ss(n,r),T.resolve()}removeMatchingKeys(e,n,r){this.As.os(n,r);const i=this.persistence.referenceDelegate,s=[];return i&&n.forEach(o=>{s.push(i.markPotentiallyOrphaned(e,o))}),T.waitFor(s)}removeMatchingKeysForTargetId(e,n){return this.As.us(n),T.resolve()}getMatchingKeysForTargetId(e,n){const r=this.As.hs(n);return T.resolve(r)}containsKey(e,n){return T.resolve(this.As.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YN{constructor(e,n){this.bs={},this.overlays={},this.Ps=new yn(0),this.vs=!1,this.vs=!0,this.referenceDelegate=e(this),this.Vs=new n6(this),this.indexManager=new B4,this.remoteDocumentCache=function(r){return new e6(r)}(r=>this.referenceDelegate.Ss(r)),this.wt=new jN(n),this.Ds=new J4(this.wt)}start(){return Promise.resolve()}shutdown(){return this.vs=!1,Promise.resolve()}get started(){return this.vs}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new X4,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.bs[e.toKey()];return r||(r=new Z4(n,this.referenceDelegate),this.bs[e.toKey()]=r),r}getTargetCache(){return this.Vs}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ds}runTransaction(e,n,r){L("MemoryPersistence","Starting transaction:",e);const i=new r6(this.Ps.next());return this.referenceDelegate.Cs(),r(i).next(s=>this.referenceDelegate.xs(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Ns(e,n){return T.or(Object.values(this.bs).map(r=>()=>r.containsKey(e,n)))}}class r6 extends eN{constructor(e){super(),this.currentSequenceNumber=e}}class Xf{constructor(e){this.persistence=e,this.ks=new Rv,this.Os=null}static Ms(e){return new Xf(e)}get Fs(){if(this.Os)return this.Os;throw Y()}addReference(e,n,r){return this.ks.addReference(r,n),this.Fs.delete(r.toString()),T.resolve()}removeReference(e,n,r){return this.ks.removeReference(r,n),this.Fs.add(r.toString()),T.resolve()}markPotentiallyOrphaned(e,n){return this.Fs.add(n.toString()),T.resolve()}removeTarget(e,n){this.ks.us(n.targetId).forEach(i=>this.Fs.add(i.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(i=>{i.forEach(s=>this.Fs.add(s.toString()))}).next(()=>r.removeTargetData(e,n))}Cs(){this.Os=new Set}xs(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return T.forEach(this.Fs,r=>{const i=W.fromPath(r);return this.$s(e,i).next(s=>{s||n.removeEntry(i,se.min())})}).next(()=>(this.Os=null,n.apply(e)))}updateLimboDocument(e,n){return this.$s(e,n).next(r=>{r?this.Fs.delete(n.toString()):this.Fs.add(n.toString())})}Ss(e){return 0}$s(e,n){return T.or([()=>T.resolve(this.ks.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Ns(e,n)])}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class i6{constructor(e){this.wt=e}O(e,n,r,i){const s=new Hf("createOrUpgrade",n);r<1&&i>=1&&(function(a){a.createObjectStore("owner")}(e),function(a){a.createObjectStore("mutationQueues",{keyPath:"userId"}),a.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",$E,{unique:!0}),a.createObjectStore("documentMutations")}(e),nT(e),function(a){a.createObjectStore("remoteDocuments")}(e));let o=T.resolve();return r<3&&i>=3&&(r!==0&&(function(a){a.deleteObjectStore("targetDocuments"),a.deleteObjectStore("targets"),a.deleteObjectStore("targetGlobal")}(e),nT(e)),o=o.next(()=>function(a){const c=a.store("targetGlobal"),l={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:se.min().toTimestamp(),targetCount:0};return c.put("targetGlobalKey",l)}(s))),r<4&&i>=4&&(r!==0&&(o=o.next(()=>function(a,c){return c.store("mutations").K().next(l=>{a.deleteObjectStore("mutations"),a.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",$E,{unique:!0});const u=c.store("mutations"),h=l.map(d=>u.put(d));return T.waitFor(h)})}(e,s))),o=o.next(()=>{(function(a){a.createObjectStore("clientMetadata",{keyPath:"clientId"})})(e)})),r<5&&i>=5&&(o=o.next(()=>this.Bs(s))),r<6&&i>=6&&(o=o.next(()=>(function(a){a.createObjectStore("remoteDocumentGlobal")}(e),this.Ls(s)))),r<7&&i>=7&&(o=o.next(()=>this.Us(s))),r<8&&i>=8&&(o=o.next(()=>this.qs(e,s))),r<9&&i>=9&&(o=o.next(()=>{(function(a){a.objectStoreNames.contains("remoteDocumentChanges")&&a.deleteObjectStore("remoteDocumentChanges")})(e)})),r<10&&i>=10&&(o=o.next(()=>this.Ks(s))),r<11&&i>=11&&(o=o.next(()=>{(function(a){a.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(a){a.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),r<12&&i>=12&&(o=o.next(()=>{(function(a){const c=a.createObjectStore("documentOverlays",{keyPath:R4});c.createIndex("collectionPathOverlayIndex",N4,{unique:!1}),c.createIndex("collectionGroupOverlayIndex",P4,{unique:!1})})(e)})),r<13&&i>=13&&(o=o.next(()=>function(a){const c=a.createObjectStore("remoteDocumentsV14",{keyPath:y4});c.createIndex("documentKeyIndex",v4),c.createIndex("collectionGroupIndex",w4)}(e)).next(()=>this.Gs(e,s)).next(()=>e.deleteObjectStore("remoteDocuments"))),r<14&&i>=14&&(o=o.next(()=>this.Qs(e,s))),r<15&&i>=15&&(o=o.next(()=>function(a){a.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),a.createObjectStore("indexState",{keyPath:S4}).createIndex("sequenceNumberIndex",C4,{unique:!1}),a.createObjectStore("indexEntries",{keyPath:A4}).createIndex("documentKeyIndex",k4,{unique:!1})}(e))),o}Ls(e){let n=0;return e.store("remoteDocuments").J((r,i)=>{n+=wd(i)}).next(()=>{const r={byteSize:n};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",r)})}Bs(e){const n=e.store("mutationQueues"),r=e.store("mutations");return n.K().next(i=>T.forEach(i,s=>{const o=IDBKeyRange.bound([s.userId,-1],[s.userId,s.lastAcknowledgedBatchId]);return r.K("userMutationsIndex",o).next(a=>T.forEach(a,c=>{ae(c.userId===s.userId);const l=As(this.wt,c);return WN(e,s.userId,l).next(()=>{})}))}))}Us(e){const n=e.store("targetDocuments"),r=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(i=>{const s=[];return r.J((o,a)=>{const c=new Ee(o),l=function(u){return[0,un(u)]}(c);s.push(n.get(l).next(u=>u?T.resolve():(h=>n.put({targetId:0,path:un(h),sequenceNumber:i.highestListenSequenceNumber}))(c)))}).next(()=>T.waitFor(s))})}qs(e,n){e.createObjectStore("collectionParents",{keyPath:T4});const r=n.store("collectionParents"),i=new kv,s=o=>{if(i.add(o)){const a=o.lastSegment(),c=o.popLast();return r.put({collectionId:a,parent:un(c)})}};return n.store("remoteDocuments").J({H:!0},(o,a)=>{const c=new Ee(o);return s(c.popLast())}).next(()=>n.store("documentMutations").J({H:!0},([o,a,c],l)=>{const u=Sr(a);return s(u.popLast())}))}Ks(e){const n=e.store("targets");return n.J((r,i)=>{const s=Rc(i),o=qN(this.wt,s);return n.put(o)})}Gs(e,n){const r=n.store("remoteDocuments"),i=[];return r.J((s,o)=>{const a=n.store("remoteDocumentsV14"),c=(l=o,l.document?new W(Ee.fromString(l.document.name).popFirst(5)):l.noDocument?W.fromSegments(l.noDocument.path):l.unknownDocument?W.fromSegments(l.unknownDocument.path):Y()).path.toArray();var l;/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const u={prefixPath:c.slice(0,c.length-2),collectionGroup:c[c.length-2],documentId:c[c.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};i.push(a.put(u))}).next(()=>T.waitFor(i))}Qs(e,n){const r=n.store("mutations"),i=zN(this.wt),s=new YN(Xf.Ms,this.wt.ne);return r.K().next(o=>{const a=new Map;return o.forEach(c=>{var l;let u=(l=a.get(c.userId))!==null&&l!==void 0?l:fe();As(this.wt,c).keys().forEach(h=>u=u.add(h)),a.set(c.userId,u)}),T.forEach(a,(c,l)=>{const u=new It(l),h=Yf.se(this.wt,u),d=s.getIndexManager(u),f=Jf.se(u,this.wt,d,s.referenceDelegate);return new QN(i,f,h,d).recalculateAndSaveOverlaysForDocumentKeys(new $m(n,yn.ot),c).next()})})}}function nT(t){t.createObjectStore("targetDocuments",{keyPath:I4}).createIndex("documentTargetsIndex",E4,{unique:!0}),t.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",b4,{unique:!0}),t.createObjectStore("targetGlobal")}const eg="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class Nv{constructor(e,n,r,i,s,o,a,c,l,u,h=14){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.js=s,this.window=o,this.document=a,this.Ws=l,this.zs=u,this.Hs=h,this.Ps=null,this.vs=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Js=null,this.inForeground=!1,this.Ys=null,this.Xs=null,this.Zs=Number.NEGATIVE_INFINITY,this.ti=d=>Promise.resolve(),!Nv.V())throw new O(C.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new G4(this,i),this.ei=n+"main",this.wt=new jN(c),this.ni=new ir(this.ei,this.Hs,new i6(this.wt)),this.Vs=new q4(this.referenceDelegate,this.wt),this.remoteDocumentCache=zN(this.wt),this.Ds=new M4,this.window&&this.window.localStorage?this.si=this.window.localStorage:(this.si=null,u===!1&&ht("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.ii().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new O(C.FAILED_PRECONDITION,eg);return this.ri(),this.oi(),this.ui(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Vs.getHighestSequenceNumber(e))}).then(e=>{this.Ps=new yn(e,this.Ws)}).then(()=>{this.vs=!0}).catch(e=>(this.ni&&this.ni.close(),Promise.reject(e)))}ci(e){return this.ti=async n=>{if(this.started)return e(n)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.ni.F(async n=>{n.newVersion===null&&await e()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.js.enqueueAndForget(async()=>{this.started&&await this.ii()}))}ii(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>ih(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.ai(e).next(n=>{n||(this.isPrimary=!1,this.js.enqueueRetryable(()=>this.ti(!1)))})}).next(()=>this.hi(e)).next(n=>this.isPrimary&&!n?this.li(e).next(()=>!1):!!n&&this.fi(e).next(()=>!0))).catch(e=>{if(ls(e))return L("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return L("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.js.enqueueRetryable(()=>this.ti(e)),this.isPrimary=e})}ai(e){return bc(e).get("owner").next(n=>T.resolve(this.di(n)))}_i(e){return ih(e).delete(this.clientId)}async wi(){if(this.isPrimary&&!this.mi(this.Zs,18e5)){this.Zs=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",n=>{const r=xt(n,"clientMetadata");return r.K().next(i=>{const s=this.gi(i,18e5),o=i.filter(a=>s.indexOf(a)===-1);return T.forEach(o,a=>r.delete(a.clientId)).next(()=>o)})}).catch(()=>[]);if(this.si)for(const n of e)this.si.removeItem(this.yi(n.clientId))}}ui(){this.Xs=this.js.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.ii().then(()=>this.wi()).then(()=>this.ui()))}di(e){return!!e&&e.ownerId===this.clientId}hi(e){return this.zs?T.resolve(!0):bc(e).get("owner").next(n=>{if(n!==null&&this.mi(n.leaseTimestampMs,5e3)&&!this.pi(n.ownerId)){if(this.di(n)&&this.networkEnabled)return!0;if(!this.di(n)){if(!n.allowTabSynchronization)throw new O(C.FAILED_PRECONDITION,eg);return!1}}return!(!this.networkEnabled||!this.inForeground)||ih(e).K().next(r=>this.gi(r,5e3).find(i=>{if(this.clientId!==i.clientId){const s=!this.networkEnabled&&i.networkEnabled,o=!this.inForeground&&i.inForeground,a=this.networkEnabled===i.networkEnabled;if(s||o&&a)return!0}return!1})===void 0)}).next(n=>(this.isPrimary!==n&&L("IndexedDbPersistence",`Client ${n?"is":"is not"} eligible for a primary lease.`),n))}async shutdown(){this.vs=!1,this.Ii(),this.Xs&&(this.Xs.cancel(),this.Xs=null),this.Ti(),this.Ei(),await this.ni.runTransaction("shutdown","readwrite",["owner","clientMetadata"],e=>{const n=new $m(e,yn.ot);return this.li(n).next(()=>this._i(n))}),this.ni.close(),this.Ai()}gi(e,n){return e.filter(r=>this.mi(r.updateTimeMs,n)&&!this.pi(r.clientId))}Ri(){return this.runTransaction("getActiveClients","readonly",e=>ih(e).K().next(n=>this.gi(n,18e5).map(r=>r.clientId)))}get started(){return this.vs}getMutationQueue(e,n){return Jf.se(e,this.wt,n,this.referenceDelegate)}getTargetCache(){return this.Vs}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new j4(e,this.wt.ne.databaseId)}getDocumentOverlayCache(e){return Yf.se(this.wt,e)}getBundleCache(){return this.Ds}runTransaction(e,n,r){L("IndexedDbPersistence","Starting transaction:",e);const i=n==="readonly"?"readonly":"readwrite",s=(o=this.Hs)===15?O4:o===14?BN:o===13?$N:o===12?D4:o===11?VN:void Y();var o;let a;return this.ni.runTransaction(e,i,s,c=>(a=new $m(c,this.Ps?this.Ps.next():yn.ot),n==="readwrite-primary"?this.ai(a).next(l=>!!l||this.hi(a)).next(l=>{if(!l)throw ht(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.js.enqueueRetryable(()=>this.ti(!1)),new O(C.FAILED_PRECONDITION,ZR);return r(a)}).next(l=>this.fi(a).next(()=>l)):this.bi(a).next(()=>r(a)))).then(c=>(a.raiseOnCommittedEvent(),c))}bi(e){return bc(e).get("owner").next(n=>{if(n!==null&&this.mi(n.leaseTimestampMs,5e3)&&!this.pi(n.ownerId)&&!this.di(n)&&!(this.zs||this.allowTabSynchronization&&n.allowTabSynchronization))throw new O(C.FAILED_PRECONDITION,eg)})}fi(e){const n={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return bc(e).put("owner",n)}static V(){return ir.V()}li(e){const n=bc(e);return n.get("owner").next(r=>this.di(r)?(L("IndexedDbPersistence","Releasing primary lease."),n.delete("owner")):T.resolve())}mi(e,n){const r=Date.now();return!(e<r-n)&&(!(e>r)||(ht(`Detected an update time that is in the future: ${e} > ${r}`),!1))}ri(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Ys=()=>{this.js.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.ii()))},this.document.addEventListener("visibilitychange",this.Ys),this.inForeground=this.document.visibilityState==="visible")}Ti(){this.Ys&&(this.document.removeEventListener("visibilitychange",this.Ys),this.Ys=null)}oi(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.Js=()=>{this.Ii(),bL()&&navigator.appVersion.match(/Version\/1[45]/)&&this.js.enterRestrictedMode(!0),this.js.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Js))}Ei(){this.Js&&(this.window.removeEventListener("pagehide",this.Js),this.Js=null)}pi(e){var n;try{const r=((n=this.si)===null||n===void 0?void 0:n.getItem(this.yi(e)))!==null;return L("IndexedDbPersistence",`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return ht("IndexedDbPersistence","Failed to get zombied client id.",r),!1}}Ii(){if(this.si)try{this.si.setItem(this.yi(this.clientId),String(Date.now()))}catch(e){ht("Failed to set zombie client id.",e)}}Ai(){if(this.si)try{this.si.removeItem(this.yi(this.clientId))}catch{}}yi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function bc(t){return xt(t,"owner")}function ih(t){return xt(t,"clientMetadata")}function Pv(t,e){let n=t.projectId;return t.isDefaultDatabase||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dv{constructor(e,n,r,i){this.targetId=e,this.fromCache=n,this.Pi=r,this.vi=i}static Vi(e,n){let r=fe(),i=fe();for(const s of n.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new Dv(e,n.fromCache,r,i)}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JN{constructor(){this.Si=!1}initialize(e,n){this.Di=e,this.indexManager=n,this.Si=!0}getDocumentsMatchingQuery(e,n,r,i){return this.Ci(e,n).next(s=>s||this.xi(e,n,i,r)).next(s=>s||this.Ni(e,n))}Ci(e,n){return T.resolve(null)}xi(e,n,r,i){return q2(n)||i.isEqual(se.min())?this.Ni(e,n):this.Di.getDocuments(e,r).next(s=>{const o=this.ki(n,s);return this.Oi(n,o,r,i)?this.Ni(e,n):(Om()<=ge.DEBUG&&L("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Fm(n)),this.Mi(e,o,n,JR(i,-1)))})}ki(e,n){let r=new Ne(hN(e));return n.forEach((i,s)=>{bv(e,s)&&(r=r.add(s))}),r}Oi(e,n,r,i){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const s=e.limitType==="F"?n.last():n.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Ni(e,n){return Om()<=ge.DEBUG&&L("QueryEngine","Using full collection scan to execute query:",Fm(n)),this.Di.getDocumentsMatchingQuery(e,n,xn.min())}Mi(e,n,r,i){return this.Di.getDocumentsMatchingQuery(e,r,i).next(s=>(n.forEach(o=>{s=s.insert(o.key,o)}),s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s6{constructor(e,n,r,i){this.persistence=e,this.Fi=n,this.wt=i,this.$i=new rt(ue),this.Bi=new us(s=>co(s),ku),this.Li=new Map,this.Ui=e.getRemoteDocumentCache(),this.Vs=e.getTargetCache(),this.Ds=e.getBundleCache(),this.qi(r)}qi(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new QN(this.Ui,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ui.setIndexManager(this.indexManager),this.Fi.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.$i))}}function XN(t,e,n,r){return new s6(t,e,n,r)}async function ZN(t,e){const n=G(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let i;return n.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,n.qi(e),n.mutationQueue.getAllMutationBatches(r))).next(s=>{const o=[],a=[];let c=fe();for(const l of i){o.push(l.batchId);for(const u of l.mutations)c=c.add(u.key)}for(const l of s){a.push(l.batchId);for(const u of l.mutations)c=c.add(u.key)}return n.localDocuments.getDocuments(r,c).next(l=>({Ki:l,removedBatchIds:o,addedBatchIds:a}))})})}function o6(t,e){const n=G(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const i=e.batch.keys(),s=n.Ui.newChangeBuffer({trackRemovals:!0});return function(o,a,c,l){const u=c.batch,h=u.keys();let d=T.resolve();return h.forEach(f=>{d=d.next(()=>l.getEntry(a,f)).next(g=>{const v=c.docVersions.get(f);ae(v!==null),g.version.compareTo(v)<0&&(u.applyToRemoteDocument(g,c),g.isValidDocument()&&(g.setReadTime(c.commitVersion),l.addEntry(g)))})}),d.next(()=>o.mutationQueue.removeMutationBatch(a,u))}(n,r,e,s).next(()=>s.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(o){let a=fe();for(let c=0;c<o.mutationResults.length;++c)o.mutationResults[c].transformResults.length>0&&(a=a.add(o.batch.mutations[c].key));return a}(e))).next(()=>n.localDocuments.getDocuments(r,i))})}function eP(t){const e=G(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Vs.getLastRemoteSnapshotVersion(n))}function a6(t,e){const n=G(t),r=e.snapshotVersion;let i=n.$i;return n.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const o=n.Ui.newChangeBuffer({trackRemovals:!0});i=n.$i;const a=[];e.targetChanges.forEach((u,h)=>{const d=i.get(h);if(!d)return;a.push(n.Vs.removeMatchingKeys(s,u.removedDocuments,h).next(()=>n.Vs.addMatchingKeys(s,u.addedDocuments,h)));let f=d.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.has(h)?f=f.withResumeToken(mt.EMPTY_BYTE_STRING,se.min()).withLastLimboFreeSnapshotVersion(se.min()):u.resumeToken.approximateByteSize()>0&&(f=f.withResumeToken(u.resumeToken,r)),i=i.insert(h,f),function(g,v,I){return g.resumeToken.approximateByteSize()===0||v.snapshotVersion.toMicroseconds()-g.snapshotVersion.toMicroseconds()>=3e8?!0:I.addedDocuments.size+I.modifiedDocuments.size+I.removedDocuments.size>0}(d,f,u)&&a.push(n.Vs.updateTargetData(s,f))});let c=vn(),l=fe();if(e.documentUpdates.forEach(u=>{e.resolvedLimboDocuments.has(u)&&a.push(n.persistence.referenceDelegate.updateLimboDocument(s,u))}),a.push(tP(s,o,e.documentUpdates).next(u=>{c=u.Gi,l=u.Qi})),!r.isEqual(se.min())){const u=n.Vs.getLastRemoteSnapshotVersion(s).next(h=>n.Vs.setTargetsMetadata(s,s.currentSequenceNumber,r));a.push(u)}return T.waitFor(a).next(()=>o.apply(s)).next(()=>n.localDocuments.getLocalViewOfDocuments(s,c,l)).next(()=>c)}).then(s=>(n.$i=i,s))}function tP(t,e,n){let r=fe(),i=fe();return n.forEach(s=>r=r.add(s)),e.getEntries(t,r).next(s=>{let o=vn();return n.forEach((a,c)=>{const l=s.get(a);c.isFoundDocument()!==l.isFoundDocument()&&(i=i.add(a)),c.isNoDocument()&&c.version.isEqual(se.min())?(e.removeEntry(a,c.readTime),o=o.insert(a,c)):!l.isValidDocument()||c.version.compareTo(l.version)>0||c.version.compareTo(l.version)===0&&l.hasPendingWrites?(e.addEntry(c),o=o.insert(a,c)):L("LocalStore","Ignoring outdated watch update for ",a,". Current version:",l.version," Watch version:",c.version)}),{Gi:o,Qi:i}})}function c6(t,e){const n=G(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function ka(t,e){const n=G(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return n.Vs.getTargetData(r,e).next(s=>s?(i=s,T.resolve(i)):n.Vs.allocateTargetId(r).next(o=>(i=new $i(e,o,0,r.currentSequenceNumber),n.Vs.addTargetData(r,i).next(()=>i))))}).then(r=>{const i=n.$i.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(n.$i=n.$i.insert(r.targetId,r),n.Bi.set(e,r.targetId)),r})}async function Ra(t,e,n){const r=G(t),i=r.$i.get(e),s=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",s,o=>r.persistence.referenceDelegate.removeTarget(o,i))}catch(o){if(!ls(o))throw o;L("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}r.$i=r.$i.remove(e),r.Bi.delete(i.target)}function bd(t,e,n){const r=G(t);let i=se.min(),s=fe();return r.persistence.runTransaction("Execute query","readonly",o=>function(a,c,l){const u=G(a),h=u.Bi.get(l);return h!==void 0?T.resolve(u.$i.get(h)):u.Vs.getTargetData(c,l)}(r,o,zn(e)).next(a=>{if(a)return i=a.lastLimboFreeSnapshotVersion,r.Vs.getMatchingKeysForTargetId(o,a.targetId).next(c=>{s=c})}).next(()=>r.Fi.getDocumentsMatchingQuery(o,e,n?i:se.min(),n?s:fe())).next(a=>(iP(r,uN(e),a),{documents:a,ji:s})))}function nP(t,e){const n=G(t),r=G(n.Vs),i=n.$i.get(e);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",s=>r.te(s,e).next(o=>o?o.target:null))}function rP(t,e){const n=G(t),r=n.Li.get(e)||se.min();return n.persistence.runTransaction("Get new document changes","readonly",i=>n.Ui.getAllFromCollectionGroup(i,e,JR(r,-1),Number.MAX_SAFE_INTEGER)).then(i=>(iP(n,e,i),i))}function iP(t,e,n){let r=se.min();n.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),t.Li.set(e,r)}async function l6(t,e,n,r){const i=G(t);let s=fe(),o=vn();for(const l of n){const u=e.Wi(l.metadata.name);l.document&&(s=s.add(u));const h=e.zi(l);h.setReadTime(e.Hi(l.metadata.readTime)),o=o.insert(u,h)}const a=i.Ui.newChangeBuffer({trackRemovals:!0}),c=await ka(i,function(l){return zn(Ja(Ee.fromString(`__bundle__/docs/${l}`)))}(r));return i.persistence.runTransaction("Apply bundle documents","readwrite",l=>tP(l,a,o).next(u=>(a.apply(l),u)).next(u=>i.Vs.removeMatchingKeysForTargetId(l,c.targetId).next(()=>i.Vs.addMatchingKeys(l,s,c.targetId)).next(()=>i.localDocuments.getLocalViewOfDocuments(l,u.Gi,u.Qi)).next(()=>u.Gi)))}async function u6(t,e,n=fe()){const r=await ka(t,zn(Av(e.bundledQuery))),i=G(t);return i.persistence.runTransaction("Save named query","readwrite",s=>{const o=Ct(e.readTime);if(r.snapshotVersion.compareTo(o)>=0)return i.Ds.saveNamedQuery(s,e);const a=r.withResumeToken(mt.EMPTY_BYTE_STRING,o);return i.$i=i.$i.insert(a.targetId,a),i.Vs.updateTargetData(s,a).next(()=>i.Vs.removeMatchingKeysForTargetId(s,r.targetId)).next(()=>i.Vs.addMatchingKeys(s,n,r.targetId)).next(()=>i.Ds.saveNamedQuery(s,e))})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rT(t,e){return`firestore_clients_${t}_${e}`}function iT(t,e,n){let r=`firestore_mutations_${t}_${n}`;return e.isAuthenticated()&&(r+=`_${e.uid}`),r}function tg(t,e){return`firestore_targets_${t}_${e}`}class Id{constructor(e,n,r,i){this.user=e,this.batchId=n,this.state=r,this.error=i}static Ji(e,n,r){const i=JSON.parse(r);let s,o=typeof i=="object"&&["pending","acknowledged","rejected"].indexOf(i.state)!==-1&&(i.error===void 0||typeof i.error=="object");return o&&i.error&&(o=typeof i.error.message=="string"&&typeof i.error.code=="string",o&&(s=new O(i.error.code,i.error.message))),o?new Id(e,n,i.state,s):(ht("SharedClientState",`Failed to parse mutation state for ID '${n}': ${r}`),null)}Yi(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Yc{constructor(e,n,r){this.targetId=e,this.state=n,this.error=r}static Ji(e,n){const r=JSON.parse(n);let i,s=typeof r=="object"&&["not-current","current","rejected"].indexOf(r.state)!==-1&&(r.error===void 0||typeof r.error=="object");return s&&r.error&&(s=typeof r.error.message=="string"&&typeof r.error.code=="string",s&&(i=new O(r.error.code,r.error.message))),s?new Yc(e,r.state,i):(ht("SharedClientState",`Failed to parse target state for ID '${e}': ${n}`),null)}Yi(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Ed{constructor(e,n){this.clientId=e,this.activeTargetIds=n}static Ji(e,n){const r=JSON.parse(n);let i=typeof r=="object"&&r.activeTargetIds instanceof Array,s=Qf();for(let o=0;i&&o<r.activeTargetIds.length;++o)i=rN(r.activeTargetIds[o]),s=s.add(r.activeTargetIds[o]);return i?new Ed(e,s):(ht("SharedClientState",`Failed to parse client data for instance '${e}': ${n}`),null)}}class Ov{constructor(e,n){this.clientId=e,this.onlineState=n}static Ji(e){const n=JSON.parse(e);return typeof n=="object"&&["Unknown","Online","Offline"].indexOf(n.onlineState)!==-1&&typeof n.clientId=="string"?new Ov(n.clientId,n.onlineState):(ht("SharedClientState",`Failed to parse online state: ${e}`),null)}}class Bm{constructor(){this.activeTargetIds=Qf()}Xi(e){this.activeTargetIds=this.activeTargetIds.add(e)}Zi(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Yi(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class ng{constructor(e,n,r,i,s){this.window=e,this.js=n,this.persistenceKey=r,this.tr=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.er=this.nr.bind(this),this.sr=new rt(ue),this.started=!1,this.ir=[];const o=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=s,this.rr=rT(this.persistenceKey,this.tr),this.ur=function(a){return`firestore_sequence_number_${a}`}(this.persistenceKey),this.sr=this.sr.insert(this.tr,new Bm),this.cr=new RegExp(`^firestore_clients_${o}_([^_]*)$`),this.ar=new RegExp(`^firestore_mutations_${o}_(\\d+)(?:_(.*))?$`),this.hr=new RegExp(`^firestore_targets_${o}_(\\d+)$`),this.lr=function(a){return`firestore_online_state_${a}`}(this.persistenceKey),this.dr=function(a){return`firestore_bundle_loaded_v2_${a}`}(this.persistenceKey),this.window.addEventListener("storage",this.er)}static V(e){return!(!e||!e.localStorage)}async start(){const e=await this.syncEngine.Ri();for(const r of e){if(r===this.tr)continue;const i=this.getItem(rT(this.persistenceKey,r));if(i){const s=Ed.Ji(r,i);s&&(this.sr=this.sr.insert(s.clientId,s))}}this._r();const n=this.storage.getItem(this.lr);if(n){const r=this.wr(n);r&&this.mr(r)}for(const r of this.ir)this.nr(r);this.ir=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0}writeSequenceNumber(e){this.setItem(this.ur,JSON.stringify(e))}getAllActiveQueryTargets(){return this.gr(this.sr)}isActiveQueryTarget(e){let n=!1;return this.sr.forEach((r,i)=>{i.activeTargetIds.has(e)&&(n=!0)}),n}addPendingMutation(e){this.yr(e,"pending")}updateMutationState(e,n,r){this.yr(e,n,r),this.pr(e)}addLocalQueryTarget(e){let n="not-current";if(this.isActiveQueryTarget(e)){const r=this.storage.getItem(tg(this.persistenceKey,e));if(r){const i=Yc.Ji(e,r);i&&(n=i.state)}}return this.Ir.Xi(e),this._r(),n}removeLocalQueryTarget(e){this.Ir.Zi(e),this._r()}isLocalQueryTarget(e){return this.Ir.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(tg(this.persistenceKey,e))}updateQueryState(e,n,r){this.Tr(e,n,r)}handleUserChange(e,n,r){n.forEach(i=>{this.pr(i)}),this.currentUser=e,r.forEach(i=>{this.addPendingMutation(i)})}setOnlineState(e){this.Er(e)}notifyBundleLoaded(e){this.Ar(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.er),this.removeItem(this.rr),this.started=!1)}getItem(e){const n=this.storage.getItem(e);return L("SharedClientState","READ",e,n),n}setItem(e,n){L("SharedClientState","SET",e,n),this.storage.setItem(e,n)}removeItem(e){L("SharedClientState","REMOVE",e),this.storage.removeItem(e)}nr(e){const n=e;if(n.storageArea===this.storage){if(L("SharedClientState","EVENT",n.key,n.newValue),n.key===this.rr)return void ht("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.js.enqueueRetryable(async()=>{if(this.started){if(n.key!==null){if(this.cr.test(n.key)){if(n.newValue==null){const r=this.Rr(n.key);return this.br(r,null)}{const r=this.Pr(n.key,n.newValue);if(r)return this.br(r.clientId,r)}}else if(this.ar.test(n.key)){if(n.newValue!==null){const r=this.vr(n.key,n.newValue);if(r)return this.Vr(r)}}else if(this.hr.test(n.key)){if(n.newValue!==null){const r=this.Sr(n.key,n.newValue);if(r)return this.Dr(r)}}else if(n.key===this.lr){if(n.newValue!==null){const r=this.wr(n.newValue);if(r)return this.mr(r)}}else if(n.key===this.ur){const r=function(i){let s=yn.ot;if(i!=null)try{const o=JSON.parse(i);ae(typeof o=="number"),s=o}catch(o){ht("SharedClientState","Failed to read sequence number from WebStorage",o)}return s}(n.newValue);r!==yn.ot&&this.sequenceNumberHandler(r)}else if(n.key===this.dr){const r=this.Cr(n.newValue);await Promise.all(r.map(i=>this.syncEngine.Nr(i)))}}}else this.ir.push(n)})}}get Ir(){return this.sr.get(this.tr)}_r(){this.setItem(this.rr,this.Ir.Yi())}yr(e,n,r){const i=new Id(this.currentUser,e,n,r),s=iT(this.persistenceKey,this.currentUser,e);this.setItem(s,i.Yi())}pr(e){const n=iT(this.persistenceKey,this.currentUser,e);this.removeItem(n)}Er(e){const n={clientId:this.tr,onlineState:e};this.storage.setItem(this.lr,JSON.stringify(n))}Tr(e,n,r){const i=tg(this.persistenceKey,e),s=new Yc(e,n,r);this.setItem(i,s.Yi())}Ar(e){const n=JSON.stringify(Array.from(e));this.setItem(this.dr,n)}Rr(e){const n=this.cr.exec(e);return n?n[1]:null}Pr(e,n){const r=this.Rr(e);return Ed.Ji(r,n)}vr(e,n){const r=this.ar.exec(e),i=Number(r[1]),s=r[2]!==void 0?r[2]:null;return Id.Ji(new It(s),i,n)}Sr(e,n){const r=this.hr.exec(e),i=Number(r[1]);return Yc.Ji(i,n)}wr(e){return Ov.Ji(e)}Cr(e){return JSON.parse(e)}async Vr(e){if(e.user.uid===this.currentUser.uid)return this.syncEngine.kr(e.batchId,e.state,e.error);L("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)}Dr(e){return this.syncEngine.Or(e.targetId,e.state,e.error)}br(e,n){const r=n?this.sr.insert(e,n):this.sr.remove(e),i=this.gr(this.sr),s=this.gr(r),o=[],a=[];return s.forEach(c=>{i.has(c)||o.push(c)}),i.forEach(c=>{s.has(c)||a.push(c)}),this.syncEngine.Mr(o,a).then(()=>{this.sr=r})}mr(e){this.sr.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}gr(e){let n=Qf();return e.forEach((r,i)=>{n=n.unionWith(i.activeTargetIds)}),n}}class sP{constructor(){this.Fr=new Bm,this.$r={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e){return this.Fr.Xi(e),this.$r[e]||"not-current"}updateQueryState(e,n,r){this.$r[e]=n}removeLocalQueryTarget(e){this.Fr.Zi(e)}isLocalQueryTarget(e){return this.Fr.activeTargetIds.has(e)}clearQueryState(e){delete this.$r[e]}getAllActiveQueryTargets(){return this.Fr.activeTargetIds}isActiveQueryTarget(e){return this.Fr.activeTargetIds.has(e)}start(){return this.Fr=new Bm,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h6{Br(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sT{constructor(){this.Lr=()=>this.Ur(),this.qr=()=>this.Kr(),this.Gr=[],this.Qr()}Br(e){this.Gr.push(e)}shutdown(){window.removeEventListener("online",this.Lr),window.removeEventListener("offline",this.qr)}Qr(){window.addEventListener("online",this.Lr),window.addEventListener("offline",this.qr)}Ur(){L("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.Gr)e(0)}Kr(){L("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.Gr)e(1)}static V(){return typeof window!="undefined"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const d6={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class f6{constructor(e){this.jr=e.jr,this.Wr=e.Wr}zr(e){this.Hr=e}Jr(e){this.Yr=e}onMessage(e){this.Xr=e}close(){this.Wr()}send(e){this.jr(e)}Zr(){this.Hr()}eo(e){this.Yr(e)}no(e){this.Xr(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p6 extends class{constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const n=e.ssl?"https":"http";this.so=n+"://"+e.host,this.io="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}ro(e,n,r,i,s){const o=this.oo(e,n);L("RestConnection","Sending: ",o,r);const a={};return this.uo(a,i,s),this.co(e,o,a,r).then(c=>(L("RestConnection","Received: ",c),c),c=>{throw Ul("RestConnection",`${e} failed with error: `,c,"url: ",o,"request:",r),c})}ao(e,n,r,i,s,o){return this.ro(e,n,r,i,s)}uo(e,n,r){e["X-Goog-Api-Client"]="gl-js/ fire/"+Ya,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((i,s)=>e[s]=i),r&&r.headers.forEach((i,s)=>e[s]=i)}oo(e,n){const r=d6[e];return`${this.so}/v1/${n}:${r}`}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams}co(e,n,r,i){return new Promise((s,o)=>{const a=new h2;a.listenOnce(c2.COMPLETE,()=>{try{switch(a.getLastErrorCode()){case Xp.NO_ERROR:const l=a.getResponseJson();L("Connection","XHR received:",JSON.stringify(l)),s(l);break;case Xp.TIMEOUT:L("Connection",'RPC "'+e+'" timed out'),o(new O(C.DEADLINE_EXCEEDED,"Request time out"));break;case Xp.HTTP_ERROR:const u=a.getStatus();if(L("Connection",'RPC "'+e+'" failed with status:',u,"response text:",a.getResponseText()),u>0){const h=a.getResponseJson().error;if(h&&h.status&&h.message){const d=function(f){const g=f.toLowerCase().replace(/_/g,"-");return Object.values(C).indexOf(g)>=0?g:C.UNKNOWN}(h.status);o(new O(d,h.message))}else o(new O(C.UNKNOWN,"Server responded with status "+a.getStatus()))}else o(new O(C.UNAVAILABLE,"Connection failed."));break;default:Y()}}finally{L("Connection",'RPC "'+e+'" completed.')}});const c=JSON.stringify(i);a.send(n,"POST",c,r,15)})}ho(e,n,r){const i=[this.so,"/","google.firestore.v1.Firestore","/",e,"/channel"],s=o2(),o=a2(),a={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.useFetchStreams&&(a.xmlHttpFactory=new u2({})),this.uo(a.initMessageHeaders,n,r),zd()||nu()||vL()||N_()||wL()||tu()||(a.httpHeadersOverwriteParam="$httpHeaders");const c=i.join("");L("Connection","Creating WebChannel: "+c,a);const l=s.createWebChannel(c,a);let u=!1,h=!1;const d=new f6({jr:g=>{h?L("Connection","Not sending because WebChannel is closed:",g):(u||(L("Connection","Opening WebChannel transport."),l.open(),u=!0),L("Connection","WebChannel sending:",g),l.send(g))},Wr:()=>l.close()}),f=(g,v,I)=>{g.listen(v,S=>{try{I(S)}catch(k){setTimeout(()=>{throw k},0)}})};return f(l,Zu.EventType.OPEN,()=>{h||L("Connection","WebChannel transport opened.")}),f(l,Zu.EventType.CLOSE,()=>{h||(h=!0,L("Connection","WebChannel transport closed"),d.eo())}),f(l,Zu.EventType.ERROR,g=>{h||(h=!0,Ul("Connection","WebChannel transport errored:",g),d.eo(new O(C.UNAVAILABLE,"The operation could not be completed")))}),f(l,Zu.EventType.MESSAGE,g=>{var v;if(!h){const I=g.data[0];ae(!!I);const S=I,k=S.error||((v=S[0])===null||v===void 0?void 0:v.error);if(k){L("Connection","WebChannel received error:",k);const R=k.status;let E=function(w){const y=ut[w];if(y!==void 0)return IN(y)}(R),p=k.message;E===void 0&&(E=C.INTERNAL,p="Unknown error status: "+R+" with message "+k.message),h=!0,d.eo(new O(E,p)),l.close()}else L("Connection","WebChannel received:",I),d.no(I)}}),f(o,l2.STAT_EVENT,g=>{g.stat===mE.PROXY?L("Connection","Detected buffering proxy"):g.stat===mE.NOPROXY&&L("Connection","Detected no buffering proxy")}),setTimeout(()=>{d.Zr()},0),d}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oP(){return typeof window!="undefined"?window:null}function Sh(){return typeof document!="undefined"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ou(t){return new s4(t,!0)}class xv{constructor(e,n,r=1e3,i=1.5,s=6e4){this.js=e,this.timerId=n,this.lo=r,this.fo=i,this._o=s,this.wo=0,this.mo=null,this.yo=Date.now(),this.reset()}reset(){this.wo=0}po(){this.wo=this._o}Io(e){this.cancel();const n=Math.floor(this.wo+this.To()),r=Math.max(0,Date.now()-this.yo),i=Math.max(0,n-r);i>0&&L("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.wo} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.mo=this.js.enqueueAfterDelay(this.timerId,i,()=>(this.yo=Date.now(),e())),this.wo*=this.fo,this.wo<this.lo&&(this.wo=this.lo),this.wo>this._o&&(this.wo=this._o)}Eo(){this.mo!==null&&(this.mo.skipDelay(),this.mo=null)}cancel(){this.mo!==null&&(this.mo.cancel(),this.mo=null)}To(){return(Math.random()-.5)*this.wo}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aP{constructor(e,n,r,i,s,o,a,c){this.js=e,this.Ao=r,this.Ro=i,this.bo=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=c,this.state=0,this.Po=0,this.vo=null,this.Vo=null,this.stream=null,this.So=new xv(e,n)}Do(){return this.state===1||this.state===5||this.Co()}Co(){return this.state===2||this.state===3}start(){this.state!==4?this.auth():this.xo()}async stop(){this.Do()&&await this.close(0)}No(){this.state=0,this.So.reset()}ko(){this.Co()&&this.vo===null&&(this.vo=this.js.enqueueAfterDelay(this.Ao,6e4,()=>this.Oo()))}Mo(e){this.Fo(),this.stream.send(e)}async Oo(){if(this.Co())return this.close(0)}Fo(){this.vo&&(this.vo.cancel(),this.vo=null)}$o(){this.Vo&&(this.Vo.cancel(),this.Vo=null)}async close(e,n){this.Fo(),this.$o(),this.So.cancel(),this.Po++,e!==4?this.So.reset():n&&n.code===C.RESOURCE_EXHAUSTED?(ht(n.toString()),ht("Using maximum backoff delay to prevent overloading the backend."),this.So.po()):n&&n.code===C.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.Bo(),this.stream.close(),this.stream=null),this.state=e,await this.listener.Jr(n)}Bo(){}auth(){this.state=1;const e=this.Lo(this.Po),n=this.Po;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.Po===n&&this.Uo(r,i)},r=>{e(()=>{const i=new O(C.UNKNOWN,"Fetching auth token failed: "+r.message);return this.qo(i)})})}Uo(e,n){const r=this.Lo(this.Po);this.stream=this.Ko(e,n),this.stream.zr(()=>{r(()=>(this.state=2,this.Vo=this.js.enqueueAfterDelay(this.Ro,1e4,()=>(this.Co()&&(this.state=3),Promise.resolve())),this.listener.zr()))}),this.stream.Jr(i=>{r(()=>this.qo(i))}),this.stream.onMessage(i=>{r(()=>this.onMessage(i))})}xo(){this.state=5,this.So.Io(async()=>{this.state=0,this.start()})}qo(e){return L("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}Lo(e){return n=>{this.js.enqueueAndForget(()=>this.Po===e?n():(L("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class g6 extends aP{constructor(e,n,r,i,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,i,o),this.wt=s}Ko(e,n){return this.bo.ho("Listen",e,n)}onMessage(e){this.So.reset();const n=c4(this.wt,e),r=function(i){if(!("targetChange"in i))return se.min();const s=i.targetChange;return s.targetIds&&s.targetIds.length?se.min():s.readTime?Ct(s.readTime):se.min()}(e);return this.listener.Go(n,r)}Qo(e){const n={};n.database=Hl(this.wt),n.addTarget=function(i,s){let o;const a=s.target;return o=_d(a)?{documents:ON(i,a)}:{query:xN(i,a)},o.targetId=s.targetId,s.resumeToken.approximateByteSize()>0?o.resumeToken=kN(i,s.resumeToken):s.snapshotVersion.compareTo(se.min())>0&&(o.readTime=Wl(i,s.snapshotVersion.toTimestamp())),o}(this.wt,e);const r=u4(this.wt,e);r&&(n.labels=r),this.Mo(n)}jo(e){const n={};n.database=Hl(this.wt),n.removeTarget=e,this.Mo(n)}}class m6 extends aP{constructor(e,n,r,i,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,i,o),this.wt=s,this.Wo=!1}get zo(){return this.Wo}start(){this.Wo=!1,this.lastStreamToken=void 0,super.start()}Bo(){this.Wo&&this.Ho([])}Ko(e,n){return this.bo.ho("Write",e,n)}onMessage(e){if(ae(!!e.streamToken),this.lastStreamToken=e.streamToken,this.Wo){this.So.reset();const n=l4(e.writeResults,e.commitTime),r=Ct(e.commitTime);return this.listener.Jo(r,n)}return ae(!e.writeResults||e.writeResults.length===0),this.Wo=!0,this.listener.Yo()}Xo(){const e={};e.database=Hl(this.wt),this.Mo(e)}Ho(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>Gl(this.wt,r))};this.Mo(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _6 extends class{}{constructor(e,n,r,i){super(),this.authCredentials=e,this.appCheckCredentials=n,this.bo=r,this.wt=i,this.Zo=!1}tu(){if(this.Zo)throw new O(C.FAILED_PRECONDITION,"The client has already been terminated.")}ro(e,n,r){return this.tu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,s])=>this.bo.ro(e,n,r,i,s)).catch(i=>{throw i.name==="FirebaseError"?(i.code===C.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new O(C.UNKNOWN,i.toString())})}ao(e,n,r,i){return this.tu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.bo.ao(e,n,r,s,o,i)).catch(s=>{throw s.name==="FirebaseError"?(s.code===C.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new O(C.UNKNOWN,s.toString())})}terminate(){this.Zo=!0}}class y6{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.eu=0,this.nu=null,this.su=!0}iu(){this.eu===0&&(this.ru("Unknown"),this.nu=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.nu=null,this.ou("Backend didn't respond within 10 seconds."),this.ru("Offline"),Promise.resolve())))}uu(e){this.state==="Online"?this.ru("Unknown"):(this.eu++,this.eu>=1&&(this.cu(),this.ou(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ru("Offline")))}set(e){this.cu(),this.eu=0,e==="Online"&&(this.su=!1),this.ru(e)}ru(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}ou(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.su?(ht(n),this.su=!1):L("OnlineStateTracker",n)}cu(){this.nu!==null&&(this.nu.cancel(),this.nu=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class v6{constructor(e,n,r,i,s){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.au=[],this.hu=new Map,this.lu=new Set,this.fu=[],this.du=s,this.du.Br(o=>{r.enqueueAndForget(async()=>{hs(this)&&(L("RemoteStore","Restarting streams for network reachability change."),await async function(a){const c=G(a);c.lu.add(4),await ec(c),c._u.set("Unknown"),c.lu.delete(4),await xu(c)}(this))})}),this._u=new y6(r,i)}}async function xu(t){if(hs(t))for(const e of t.fu)await e(!0)}async function ec(t){for(const e of t.fu)await e(!1)}function Zf(t,e){const n=G(t);n.hu.has(e.targetId)||(n.hu.set(e.targetId,e),Fv(n)?Lv(n):nc(n).Co()&&Mv(n,e))}function zl(t,e){const n=G(t),r=nc(n);n.hu.delete(e),r.Co()&&cP(n,e),n.hu.size===0&&(r.Co()?r.ko():hs(n)&&n._u.set("Unknown"))}function Mv(t,e){t.wu.Nt(e.targetId),nc(t).Qo(e)}function cP(t,e){t.wu.Nt(e),nc(t).jo(e)}function Lv(t){t.wu=new n4({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),te:e=>t.hu.get(e)||null}),nc(t).start(),t._u.iu()}function Fv(t){return hs(t)&&!nc(t).Do()&&t.hu.size>0}function hs(t){return G(t).lu.size===0}function lP(t){t.wu=void 0}async function w6(t){t.hu.forEach((e,n)=>{Mv(t,e)})}async function b6(t,e){lP(t),Fv(t)?(t._u.uu(e),Lv(t)):t._u.set("Unknown")}async function I6(t,e,n){if(t._u.set("Online"),e instanceof AN&&e.state===2&&e.cause)try{await async function(r,i){const s=i.cause;for(const o of i.targetIds)r.hu.has(o)&&(await r.remoteSyncer.rejectListen(o,s),r.hu.delete(o),r.wu.removeTarget(o))}(t,e)}catch(r){L("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),await Td(t,r)}else if(e instanceof Eh?t.wu.Ut(e):e instanceof CN?t.wu.zt(e):t.wu.Gt(e),!n.isEqual(se.min()))try{const r=await eP(t.localStore);n.compareTo(r)>=0&&await function(i,s){const o=i.wu.Yt(s);return o.targetChanges.forEach((a,c)=>{if(a.resumeToken.approximateByteSize()>0){const l=i.hu.get(c);l&&i.hu.set(c,l.withResumeToken(a.resumeToken,s))}}),o.targetMismatches.forEach(a=>{const c=i.hu.get(a);if(!c)return;i.hu.set(a,c.withResumeToken(mt.EMPTY_BYTE_STRING,c.snapshotVersion)),cP(i,a);const l=new $i(c.target,a,1,c.sequenceNumber);Mv(i,l)}),i.remoteSyncer.applyRemoteEvent(o)}(t,n)}catch(r){L("RemoteStore","Failed to raise snapshot:",r),await Td(t,r)}}async function Td(t,e,n){if(!ls(e))throw e;t.lu.add(1),await ec(t),t._u.set("Offline"),n||(n=()=>eP(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{L("RemoteStore","Retrying IndexedDB access"),await n(),t.lu.delete(1),await xu(t)})}function uP(t,e){return e().catch(n=>Td(t,n,e))}async function tc(t){const e=G(t),n=ts(e);let r=e.au.length>0?e.au[e.au.length-1].batchId:-1;for(;E6(e);)try{const i=await c6(e.localStore,r);if(i===null){e.au.length===0&&n.ko();break}r=i.batchId,T6(e,i)}catch(i){await Td(e,i)}hP(e)&&dP(e)}function E6(t){return hs(t)&&t.au.length<10}function T6(t,e){t.au.push(e);const n=ts(t);n.Co()&&n.zo&&n.Ho(e.mutations)}function hP(t){return hs(t)&&!ts(t).Do()&&t.au.length>0}function dP(t){ts(t).start()}async function S6(t){ts(t).Xo()}async function C6(t){const e=ts(t);for(const n of t.au)e.Ho(n.mutations)}async function A6(t,e,n){const r=t.au.shift(),i=Sv.from(r,e,n);await uP(t,()=>t.remoteSyncer.applySuccessfulWrite(i)),await tc(t)}async function k6(t,e){e&&ts(t).zo&&await async function(n,r){if(i=r.code,bN(i)&&i!==C.ABORTED){const s=n.au.shift();ts(n).No(),await uP(n,()=>n.remoteSyncer.rejectFailedWrite(s.batchId,r)),await tc(n)}var i}(t,e),hP(t)&&dP(t)}async function oT(t,e){const n=G(t);n.asyncQueue.verifyOperationInProgress(),L("RemoteStore","RemoteStore received new credentials");const r=hs(n);n.lu.add(3),await ec(n),r&&n._u.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.lu.delete(3),await xu(n)}async function jm(t,e){const n=G(t);e?(n.lu.delete(2),await xu(n)):e||(n.lu.add(2),await ec(n),n._u.set("Unknown"))}function nc(t){return t.mu||(t.mu=function(e,n,r){const i=G(e);return i.tu(),new g6(n,i.bo,i.authCredentials,i.appCheckCredentials,i.wt,r)}(t.datastore,t.asyncQueue,{zr:w6.bind(null,t),Jr:b6.bind(null,t),Go:I6.bind(null,t)}),t.fu.push(async e=>{e?(t.mu.No(),Fv(t)?Lv(t):t._u.set("Unknown")):(await t.mu.stop(),lP(t))})),t.mu}function ts(t){return t.gu||(t.gu=function(e,n,r){const i=G(e);return i.tu(),new m6(n,i.bo,i.authCredentials,i.appCheckCredentials,i.wt,r)}(t.datastore,t.asyncQueue,{zr:S6.bind(null,t),Jr:k6.bind(null,t),Yo:C6.bind(null,t),Jo:A6.bind(null,t)}),t.fu.push(async e=>{e?(t.gu.No(),await tc(t)):(await t.gu.stop(),t.au.length>0&&(L("RemoteStore",`Stopping write stream with ${t.au.length} pending writes`),t.au=[]))})),t.gu}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uv{constructor(e,n,r,i,s){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new St,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}static createAndSchedule(e,n,r,i,s){const o=Date.now()+r,a=new Uv(e,n,o,i,s);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new O(C.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function rc(t,e){if(ht("AsyncQueue",`${e}: ${t}`),ls(t))return new O(C.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sa{constructor(e){this.comparator=e?(n,r)=>e(n,r)||W.comparator(n.key,r.key):(n,r)=>W.comparator(n.key,r.key),this.keyedMap=kc(),this.sortedSet=new rt(this.comparator)}static emptySet(e){return new sa(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof sa)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const i=n.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new sa;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aT{constructor(){this.yu=new rt(W.comparator)}track(e){const n=e.doc.key,r=this.yu.get(n);r?e.type!==0&&r.type===3?this.yu=this.yu.insert(n,e):e.type===3&&r.type!==1?this.yu=this.yu.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.yu=this.yu.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.yu=this.yu.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.yu=this.yu.remove(n):e.type===1&&r.type===2?this.yu=this.yu.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.yu=this.yu.insert(n,{type:2,doc:e.doc}):Y():this.yu=this.yu.insert(n,e)}pu(){const e=[];return this.yu.inorderTraversal((n,r)=>{e.push(r)}),e}}class Na{constructor(e,n,r,i,s,o,a,c){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=c}static fromInitialDocuments(e,n,r,i){const s=[];return n.forEach(o=>{s.push({type:0,doc:o})}),new Na(e,n,sa.emptySet(n),s,r,i,!0,!1)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Ru(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let i=0;i<n.length;i++)if(n[i].type!==r[i].type||!n[i].doc.isEqual(r[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R6{constructor(){this.Iu=void 0,this.listeners=[]}}class N6{constructor(){this.queries=new us(e=>lN(e),Ru),this.onlineState="Unknown",this.Tu=new Set}}async function Vv(t,e){const n=G(t),r=e.query;let i=!1,s=n.queries.get(r);if(s||(i=!0,s=new R6),i)try{s.Iu=await n.onListen(r)}catch(o){const a=rc(o,`Initialization of query '${Fm(e.query)}' failed`);return void e.onError(a)}n.queries.set(r,s),s.listeners.push(e),e.Eu(n.onlineState),s.Iu&&e.Au(s.Iu)&&Bv(n)}async function $v(t,e){const n=G(t),r=e.query;let i=!1;const s=n.queries.get(r);if(s){const o=s.listeners.indexOf(e);o>=0&&(s.listeners.splice(o,1),i=s.listeners.length===0)}if(i)return n.queries.delete(r),n.onUnlisten(r)}function P6(t,e){const n=G(t);let r=!1;for(const i of e){const s=i.query,o=n.queries.get(s);if(o){for(const a of o.listeners)a.Au(i)&&(r=!0);o.Iu=i}}r&&Bv(n)}function D6(t,e,n){const r=G(t),i=r.queries.get(e);if(i)for(const s of i.listeners)s.onError(n);r.queries.delete(e)}function Bv(t){t.Tu.forEach(e=>{e.next()})}class jv{constructor(e,n,r){this.query=e,this.Ru=n,this.bu=!1,this.Pu=null,this.onlineState="Unknown",this.options=r||{}}Au(e){if(!this.options.includeMetadataChanges){const r=[];for(const i of e.docChanges)i.type!==3&&r.push(i);e=new Na(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0)}let n=!1;return this.bu?this.vu(e)&&(this.Ru.next(e),n=!0):this.Vu(e,this.onlineState)&&(this.Su(e),n=!0),this.Pu=e,n}onError(e){this.Ru.error(e)}Eu(e){this.onlineState=e;let n=!1;return this.Pu&&!this.bu&&this.Vu(this.Pu,e)&&(this.Su(this.Pu),n=!0),n}Vu(e,n){if(!e.fromCache)return!0;const r=n!=="Offline";return(!this.options.Du||!r)&&(!e.docs.isEmpty()||n==="Offline")}vu(e){if(e.docChanges.length>0)return!0;const n=this.Pu&&this.Pu.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}Su(e){e=Na.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache),this.bu=!0,this.Ru.next(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O6{constructor(e,n){this.payload=e,this.byteLength=n}Cu(){return"metadata"in this.payload}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cT{constructor(e){this.wt=e}Wi(e){return kr(this.wt,e)}zi(e){return e.metadata.exists?DN(this.wt,e.document,!1):je.newNoDocument(this.Wi(e.metadata.name),this.Hi(e.metadata.readTime))}Hi(e){return Ct(e)}}class x6{constructor(e,n,r){this.xu=e,this.localStore=n,this.wt=r,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=fP(e)}Nu(e){this.progress.bytesLoaded+=e.byteLength;let n=this.progress.documentsLoaded;if(e.payload.namedQuery)this.queries.push(e.payload.namedQuery);else if(e.payload.documentMetadata){this.documents.push({metadata:e.payload.documentMetadata}),e.payload.documentMetadata.exists||++n;const r=Ee.fromString(e.payload.documentMetadata.name);this.collectionGroups.add(r.get(r.length-2))}else e.payload.document&&(this.documents[this.documents.length-1].document=e.payload.document,++n);return n!==this.progress.documentsLoaded?(this.progress.documentsLoaded=n,Object.assign({},this.progress)):null}ku(e){const n=new Map,r=new cT(this.wt);for(const i of e)if(i.metadata.queries){const s=r.Wi(i.metadata.name);for(const o of i.metadata.queries){const a=(n.get(o)||fe()).add(s);n.set(o,a)}}return n}async complete(){const e=await l6(this.localStore,new cT(this.wt),this.documents,this.xu.id),n=this.ku(this.documents);for(const r of this.queries)await u6(this.localStore,r,n.get(r.name));return this.progress.taskState="Success",{progress:this.progress,Ou:this.collectionGroups,Mu:e}}}function fP(t){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:t.totalDocuments,totalBytes:t.totalBytes}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pP{constructor(e){this.key=e}}class gP{constructor(e){this.key=e}}class mP{constructor(e,n){this.query=e,this.Fu=n,this.$u=null,this.current=!1,this.Bu=fe(),this.mutatedKeys=fe(),this.Lu=hN(e),this.Uu=new sa(this.Lu)}get qu(){return this.Fu}Ku(e,n){const r=n?n.Gu:new aT,i=n?n.Uu:this.Uu;let s=n?n.mutatedKeys:this.mutatedKeys,o=i,a=!1;const c=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,l=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((u,h)=>{const d=i.get(u),f=bv(this.query,h)?h:null,g=!!d&&this.mutatedKeys.has(d.key),v=!!f&&(f.hasLocalMutations||this.mutatedKeys.has(f.key)&&f.hasCommittedMutations);let I=!1;d&&f?d.data.isEqual(f.data)?g!==v&&(r.track({type:3,doc:f}),I=!0):this.Qu(d,f)||(r.track({type:2,doc:f}),I=!0,(c&&this.Lu(f,c)>0||l&&this.Lu(f,l)<0)&&(a=!0)):!d&&f?(r.track({type:0,doc:f}),I=!0):d&&!f&&(r.track({type:1,doc:d}),I=!0,(c||l)&&(a=!0)),I&&(f?(o=o.add(f),s=v?s.add(u):s.delete(u)):(o=o.delete(u),s=s.delete(u)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const u=this.query.limitType==="F"?o.last():o.first();o=o.delete(u.key),s=s.delete(u.key),r.track({type:1,doc:u})}return{Uu:o,Gu:r,Oi:a,mutatedKeys:s}}Qu(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r){const i=this.Uu;this.Uu=e.Uu,this.mutatedKeys=e.mutatedKeys;const s=e.Gu.pu();s.sort((l,u)=>function(h,d){const f=g=>{switch(g){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Y()}};return f(h)-f(d)}(l.type,u.type)||this.Lu(l.doc,u.doc)),this.ju(r);const o=n?this.Wu():[],a=this.Bu.size===0&&this.current?1:0,c=a!==this.$u;return this.$u=a,s.length!==0||c?{snapshot:new Na(this.query,e.Uu,i,s,e.mutatedKeys,a===0,c,!1),zu:o}:{zu:o}}Eu(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Uu:this.Uu,Gu:new aT,mutatedKeys:this.mutatedKeys,Oi:!1},!1)):{zu:[]}}Hu(e){return!this.Fu.has(e)&&!!this.Uu.has(e)&&!this.Uu.get(e).hasLocalMutations}ju(e){e&&(e.addedDocuments.forEach(n=>this.Fu=this.Fu.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Fu=this.Fu.delete(n)),this.current=e.current)}Wu(){if(!this.current)return[];const e=this.Bu;this.Bu=fe(),this.Uu.forEach(r=>{this.Hu(r.key)&&(this.Bu=this.Bu.add(r.key))});const n=[];return e.forEach(r=>{this.Bu.has(r)||n.push(new gP(r))}),this.Bu.forEach(r=>{e.has(r)||n.push(new pP(r))}),n}Ju(e){this.Fu=e.ji,this.Bu=fe();const n=this.Ku(e.documents);return this.applyChanges(n,!0)}Yu(){return Na.fromInitialDocuments(this.query,this.Uu,this.mutatedKeys,this.$u===0)}}class M6{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class L6{constructor(e){this.key=e,this.Xu=!1}}class F6{constructor(e,n,r,i,s,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.Zu={},this.tc=new us(a=>lN(a),Ru),this.ec=new Map,this.nc=new Set,this.sc=new rt(W.comparator),this.ic=new Map,this.rc=new Rv,this.oc={},this.uc=new Map,this.cc=po.Rn(),this.onlineState="Unknown",this.ac=void 0}get isPrimaryClient(){return this.ac===!0}}async function U6(t,e){const n=Gv(t);let r,i;const s=n.tc.get(e);if(s)r=s.targetId,n.sharedClientState.addLocalQueryTarget(r),i=s.view.Yu();else{const o=await ka(n.localStore,zn(e));n.isPrimaryClient&&Zf(n.remoteStore,o);const a=n.sharedClientState.addLocalQueryTarget(o.targetId);r=o.targetId,i=await qv(n,e,r,a==="current")}return i}async function qv(t,e,n,r){t.hc=(u,h,d)=>async function(f,g,v,I){let S=g.view.Ku(v);S.Oi&&(S=await bd(f.localStore,g.query,!1).then(({documents:E})=>g.view.Ku(E,S)));const k=I&&I.targetChanges.get(g.targetId),R=g.view.applyChanges(S,f.isPrimaryClient,k);return qm(f,g.targetId,R.zu),R.snapshot}(t,u,h,d);const i=await bd(t.localStore,e,!0),s=new mP(e,i.ji),o=s.Ku(i.documents),a=Du.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline"),c=s.applyChanges(o,t.isPrimaryClient,a);qm(t,n,c.zu);const l=new M6(e,n,s);return t.tc.set(e,l),t.ec.has(n)?t.ec.get(n).push(e):t.ec.set(n,[e]),c.snapshot}async function V6(t,e){const n=G(t),r=n.tc.get(e),i=n.ec.get(r.targetId);if(i.length>1)return n.ec.set(r.targetId,i.filter(s=>!Ru(s,e))),void n.tc.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(r.targetId),n.sharedClientState.isActiveQueryTarget(r.targetId)||await Ra(n.localStore,r.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(r.targetId),zl(n.remoteStore,r.targetId),Pa(n,r.targetId)}).catch(cs)):(Pa(n,r.targetId),await Ra(n.localStore,r.targetId,!0))}async function $6(t,e,n){const r=zv(t);try{const i=await function(s,o){const a=G(s),c=Je.now(),l=o.reduce((d,f)=>d.add(f.key),fe());let u,h;return a.persistence.runTransaction("Locally write mutations","readwrite",d=>{let f=vn(),g=fe();return a.Ui.getEntries(d,l).next(v=>{f=v,f.forEach((I,S)=>{S.isValidDocument()||(g=g.add(I))})}).next(()=>a.localDocuments.getOverlayedDocuments(d,f)).next(v=>{u=v;const I=[];for(const S of o){const k=Y2(S,u.get(S.key).overlayedDocument);k!=null&&I.push(new fi(S.key,k,sN(k.value.mapValue),Ze.exists(!0)))}return a.mutationQueue.addMutationBatch(d,c,I,o)}).next(v=>{h=v;const I=v.applyToLocalDocumentSet(u,g);return a.documentOverlayCache.saveOverlays(d,v.batchId,I)})}).then(()=>({batchId:h.batchId,changes:TN(u)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(s,o,a){let c=s.oc[s.currentUser.toKey()];c||(c=new rt(ue)),c=c.insert(o,a),s.oc[s.currentUser.toKey()]=c}(r,i.batchId,n),await pi(r,i.changes),await tc(r.remoteStore)}catch(i){const s=rc(i,"Failed to persist write");n.reject(s)}}async function _P(t,e){const n=G(t);try{const r=await a6(n.localStore,e);e.targetChanges.forEach((i,s)=>{const o=n.ic.get(s);o&&(ae(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?o.Xu=!0:i.modifiedDocuments.size>0?ae(o.Xu):i.removedDocuments.size>0&&(ae(o.Xu),o.Xu=!1))}),await pi(n,r,e)}catch(r){await cs(r)}}function lT(t,e,n){const r=G(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const i=[];r.tc.forEach((s,o)=>{const a=o.view.Eu(e);a.snapshot&&i.push(a.snapshot)}),function(s,o){const a=G(s);a.onlineState=o;let c=!1;a.queries.forEach((l,u)=>{for(const h of u.listeners)h.Eu(o)&&(c=!0)}),c&&Bv(a)}(r.eventManager,e),i.length&&r.Zu.Go(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function B6(t,e,n){const r=G(t);r.sharedClientState.updateQueryState(e,"rejected",n);const i=r.ic.get(e),s=i&&i.key;if(s){let o=new rt(W.comparator);o=o.insert(s,je.newNoDocument(s,se.min()));const a=fe().add(s),c=new Pu(se.min(),new Map,new Ne(ue),o,a);await _P(r,c),r.sc=r.sc.remove(s),r.ic.delete(e),Hv(r)}else await Ra(r.localStore,e,!1).then(()=>Pa(r,e,n)).catch(cs)}async function j6(t,e){const n=G(t),r=e.batch.batchId;try{const i=await o6(n.localStore,e);Kv(n,r,null),Wv(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await pi(n,i)}catch(i){await cs(i)}}async function q6(t,e,n){const r=G(t);try{const i=await function(s,o){const a=G(s);return a.persistence.runTransaction("Reject batch","readwrite-primary",c=>{let l;return a.mutationQueue.lookupMutationBatch(c,o).next(u=>(ae(u!==null),l=u.keys(),a.mutationQueue.removeMutationBatch(c,u))).next(()=>a.mutationQueue.performConsistencyCheck(c)).next(()=>a.documentOverlayCache.removeOverlaysForBatchId(c,l,o)).next(()=>a.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(c,l)).next(()=>a.localDocuments.getDocuments(c,l))})}(r.localStore,e);Kv(r,e,n),Wv(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await pi(r,i)}catch(i){await cs(i)}}async function W6(t,e){const n=G(t);hs(n.remoteStore)||L("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{const r=await function(s){const o=G(s);return o.persistence.runTransaction("Get highest unacknowledged batch id","readonly",a=>o.mutationQueue.getHighestUnacknowledgedBatchId(a))}(n.localStore);if(r===-1)return void e.resolve();const i=n.uc.get(r)||[];i.push(e),n.uc.set(r,i)}catch(r){const i=rc(r,"Initialization of waitForPendingWrites() operation failed");e.reject(i)}}function Wv(t,e){(t.uc.get(e)||[]).forEach(n=>{n.resolve()}),t.uc.delete(e)}function Kv(t,e,n){const r=G(t);let i=r.oc[r.currentUser.toKey()];if(i){const s=i.get(e);s&&(n?s.reject(n):s.resolve(),i=i.remove(e)),r.oc[r.currentUser.toKey()]=i}}function Pa(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.ec.get(e))t.tc.delete(r),n&&t.Zu.lc(r,n);t.ec.delete(e),t.isPrimaryClient&&t.rc.us(e).forEach(r=>{t.rc.containsKey(r)||yP(t,r)})}function yP(t,e){t.nc.delete(e.path.canonicalString());const n=t.sc.get(e);n!==null&&(zl(t.remoteStore,n),t.sc=t.sc.remove(e),t.ic.delete(n),Hv(t))}function qm(t,e,n){for(const r of n)r instanceof pP?(t.rc.addReference(r.key,e),K6(t,r)):r instanceof gP?(L("SyncEngine","Document no longer in limbo: "+r.key),t.rc.removeReference(r.key,e),t.rc.containsKey(r.key)||yP(t,r.key)):Y()}function K6(t,e){const n=e.key,r=n.path.canonicalString();t.sc.get(n)||t.nc.has(r)||(L("SyncEngine","New document in limbo: "+n),t.nc.add(r),Hv(t))}function Hv(t){for(;t.nc.size>0&&t.sc.size<t.maxConcurrentLimboResolutions;){const e=t.nc.values().next().value;t.nc.delete(e);const n=new W(Ee.fromString(e)),r=t.cc.next();t.ic.set(r,new L6(n)),t.sc=t.sc.insert(n,r),Zf(t.remoteStore,new $i(zn(Ja(n.path)),r,2,yn.ot))}}async function pi(t,e,n){const r=G(t),i=[],s=[],o=[];r.tc.isEmpty()||(r.tc.forEach((a,c)=>{o.push(r.hc(c,e,n).then(l=>{if(l){r.isPrimaryClient&&r.sharedClientState.updateQueryState(c.targetId,l.fromCache?"not-current":"current"),i.push(l);const u=Dv.Vi(c.targetId,l);s.push(u)}}))}),await Promise.all(o),r.Zu.Go(i),await async function(a,c){const l=G(a);try{await l.persistence.runTransaction("notifyLocalViewChanges","readwrite",u=>T.forEach(c,h=>T.forEach(h.Pi,d=>l.persistence.referenceDelegate.addReference(u,h.targetId,d)).next(()=>T.forEach(h.vi,d=>l.persistence.referenceDelegate.removeReference(u,h.targetId,d)))))}catch(u){if(!ls(u))throw u;L("LocalStore","Failed to update sequence numbers: "+u)}for(const u of c){const h=u.targetId;if(!u.fromCache){const d=l.$i.get(h),f=d.snapshotVersion,g=d.withLastLimboFreeSnapshotVersion(f);l.$i=l.$i.insert(h,g)}}}(r.localStore,s))}async function H6(t,e){const n=G(t);if(!n.currentUser.isEqual(e)){L("SyncEngine","User change. New user:",e.toKey());const r=await ZN(n.localStore,e);n.currentUser=e,function(i,s){i.uc.forEach(o=>{o.forEach(a=>{a.reject(new O(C.CANCELLED,s))})}),i.uc.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await pi(n,r.Ki)}}function G6(t,e){const n=G(t),r=n.ic.get(e);if(r&&r.Xu)return fe().add(r.key);{let i=fe();const s=n.ec.get(e);if(!s)return i;for(const o of s){const a=n.tc.get(o);i=i.unionWith(a.view.qu)}return i}}async function z6(t,e){const n=G(t),r=await bd(n.localStore,e.query,!0),i=e.view.Ju(r);return n.isPrimaryClient&&qm(n,e.targetId,i.zu),i}async function Q6(t,e){const n=G(t);return rP(n.localStore,e).then(r=>pi(n,r))}async function Y6(t,e,n,r){const i=G(t),s=await function(o,a){const c=G(o),l=G(c.mutationQueue);return c.persistence.runTransaction("Lookup mutation documents","readonly",u=>l.yn(u,a).next(h=>h?c.localDocuments.getDocuments(u,h):T.resolve(null)))}(i.localStore,e);s!==null?(n==="pending"?await tc(i.remoteStore):n==="acknowledged"||n==="rejected"?(Kv(i,e,r||null),Wv(i,e),function(o,a){G(G(o).mutationQueue).In(a)}(i.localStore,e)):Y(),await pi(i,s)):L("SyncEngine","Cannot apply mutation batch with id: "+e)}async function J6(t,e){const n=G(t);if(Gv(n),zv(n),e===!0&&n.ac!==!0){const r=n.sharedClientState.getAllActiveQueryTargets(),i=await uT(n,r.toArray());n.ac=!0,await jm(n.remoteStore,!0);for(const s of i)Zf(n.remoteStore,s)}else if(e===!1&&n.ac!==!1){const r=[];let i=Promise.resolve();n.ec.forEach((s,o)=>{n.sharedClientState.isLocalQueryTarget(o)?r.push(o):i=i.then(()=>(Pa(n,o),Ra(n.localStore,o,!0))),zl(n.remoteStore,o)}),await i,await uT(n,r),function(s){const o=G(s);o.ic.forEach((a,c)=>{zl(o.remoteStore,c)}),o.rc.cs(),o.ic=new Map,o.sc=new rt(W.comparator)}(n),n.ac=!1,await jm(n.remoteStore,!1)}}async function uT(t,e,n){const r=G(t),i=[],s=[];for(const o of e){let a;const c=r.ec.get(o);if(c&&c.length!==0){a=await ka(r.localStore,zn(c[0]));for(const l of c){const u=r.tc.get(l),h=await z6(r,u);h.snapshot&&s.push(h.snapshot)}}else{const l=await nP(r.localStore,o);a=await ka(r.localStore,l),await qv(r,vP(l),o,!1)}i.push(a)}return r.Zu.Go(s),i}function vP(t){return aN(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function X6(t){const e=G(t);return G(G(e.localStore).persistence).Ri()}async function Z6(t,e,n,r){const i=G(t);if(i.ac)return void L("SyncEngine","Ignoring unexpected query state notification.");const s=i.ec.get(e);if(s&&s.length>0)switch(n){case"current":case"not-current":{const o=await rP(i.localStore,uN(s[0])),a=Pu.createSynthesizedRemoteEventForCurrentChange(e,n==="current");await pi(i,o,a);break}case"rejected":await Ra(i.localStore,e,!0),Pa(i,e,r);break;default:Y()}}async function eQ(t,e,n){const r=Gv(t);if(r.ac){for(const i of e){if(r.ec.has(i)){L("SyncEngine","Adding an already active target "+i);continue}const s=await nP(r.localStore,i),o=await ka(r.localStore,s);await qv(r,vP(s),o.targetId,!1),Zf(r.remoteStore,o)}for(const i of n)r.ec.has(i)&&await Ra(r.localStore,i,!1).then(()=>{zl(r.remoteStore,i),Pa(r,i)}).catch(cs)}}function Gv(t){const e=G(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=_P.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=G6.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=B6.bind(null,e),e.Zu.Go=P6.bind(null,e.eventManager),e.Zu.lc=D6.bind(null,e.eventManager),e}function zv(t){const e=G(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=j6.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=q6.bind(null,e),e}function tQ(t,e,n){const r=G(t);(async function(i,s,o){try{const a=await s.getMetadata();if(await function(h,d){const f=G(h),g=Ct(d.createTime);return f.persistence.runTransaction("hasNewerBundle","readonly",v=>f.Ds.getBundleMetadata(v,d.id)).then(v=>!!v&&v.createTime.compareTo(g)>=0)}(i.localStore,a))return await s.close(),o._completeWith(function(h){return{taskState:"Success",documentsLoaded:h.totalDocuments,bytesLoaded:h.totalBytes,totalDocuments:h.totalDocuments,totalBytes:h.totalBytes}}(a)),Promise.resolve(new Set);o._updateProgress(fP(a));const c=new x6(a,i.localStore,s.wt);let l=await s.fc();for(;l;){const h=await c.Nu(l);h&&o._updateProgress(h),l=await s.fc()}const u=await c.complete();return await pi(i,u.Mu,void 0),await function(h,d){const f=G(h);return f.persistence.runTransaction("Save bundle","readwrite",g=>f.Ds.saveBundleMetadata(g,d))}(i.localStore,a),o._completeWith(u.progress),Promise.resolve(u.Ou)}catch(a){return Ul("SyncEngine",`Loading bundle failed with ${a}`),o._failWith(a),Promise.resolve(new Set)}})(r,e,n).then(i=>{r.sharedClientState.notifyBundleLoaded(i)})}class wP{constructor(){this.synchronizeTabs=!1}async initialize(e){this.wt=Ou(e.databaseInfo.databaseId),this.sharedClientState=this.dc(e),this.persistence=this._c(e),await this.persistence.start(),this.localStore=this.wc(e),this.gcScheduler=this.mc(e,this.localStore),this.indexBackfillerScheduler=this.gc(e,this.localStore)}mc(e,n){return null}gc(e,n){return null}wc(e){return XN(this.persistence,new JN,e.initialUser,this.wt)}_c(e){return new YN(Xf.Ms,this.wt)}dc(e){return new sP}async terminate(){this.gcScheduler&&this.gcScheduler.stop(),await this.sharedClientState.shutdown(),await this.persistence.shutdown()}}class bP extends wP{constructor(e,n,r){super(),this.yc=e,this.cacheSizeBytes=n,this.forceOwnership=r,this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.yc.initialize(this,e),await zv(this.yc.syncEngine),await tc(this.yc.remoteStore),await this.persistence.ci(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}wc(e){return XN(this.persistence,new JN,e.initialUser,this.wt)}mc(e,n){const r=this.persistence.referenceDelegate.garbageCollector;return new K4(r,e.asyncQueue,n)}gc(e,n){const r=new A2(n,this.persistence);return new C2(e.asyncQueue,r)}_c(e){const n=Pv(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?gn.withCacheSize(this.cacheSizeBytes):gn.DEFAULT;return new Nv(this.synchronizeTabs,n,e.clientId,r,e.asyncQueue,oP(),Sh(),this.wt,this.sharedClientState,!!this.forceOwnership)}dc(e){return new sP}}class nQ extends bP{constructor(e,n){super(e,n,!1),this.yc=e,this.cacheSizeBytes=n,this.synchronizeTabs=!0}async initialize(e){await super.initialize(e);const n=this.yc.syncEngine;this.sharedClientState instanceof ng&&(this.sharedClientState.syncEngine={kr:Y6.bind(null,n),Or:Z6.bind(null,n),Mr:eQ.bind(null,n),Ri:X6.bind(null,n),Nr:Q6.bind(null,n)},await this.sharedClientState.start()),await this.persistence.ci(async r=>{await J6(this.yc.syncEngine,r),this.gcScheduler&&(r&&!this.gcScheduler.started?this.gcScheduler.start():r||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(r&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():r||this.indexBackfillerScheduler.stop())})}dc(e){const n=oP();if(!ng.V(n))throw new O(C.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const r=Pv(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new ng(n,e.asyncQueue,r,e.clientId,e.initialUser)}}class Qv{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>lT(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=H6.bind(null,this.syncEngine),await jm(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return new N6}createDatastore(e){const n=Ou(e.databaseInfo.databaseId),r=(i=e.databaseInfo,new p6(i));var i;return function(s,o,a,c){return new _6(s,o,a,c)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return n=this.localStore,r=this.datastore,i=e.asyncQueue,s=a=>lT(this.syncEngine,a,0),o=sT.V()?new sT:new h6,new v6(n,r,i,s,o);var n,r,i,s,o}createSyncEngine(e,n){return function(r,i,s,o,a,c,l){const u=new F6(r,i,s,o,a,c);return l&&(u.ac=!0),u}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}terminate(){return async function(e){const n=G(e);L("RemoteStore","RemoteStore shutting down."),n.lu.add(5),await ec(n),n.du.shutdown(),n._u.set("Unknown")}(this.remoteStore)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hT(t,e=10240){let n=0;return{async read(){if(n<t.byteLength){const r={value:t.slice(n,n+e),done:!1};return n+=e,r}return{done:!0}},async cancel(){},releaseLock(){},closed:Promise.reject("unimplemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ep{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Ic(this.observer.next,e)}error(e){this.observer.error?this.Ic(this.observer.error,e):console.error("Uncaught Error in snapshot listener:",e)}Tc(){this.muted=!0}Ic(e,n){this.muted||setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rQ{constructor(e,n){this.Ec=e,this.wt=n,this.metadata=new St,this.buffer=new Uint8Array,this.Ac=new TextDecoder("utf-8"),this.Rc().then(r=>{r&&r.Cu()?this.metadata.resolve(r.payload.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(r==null?void 0:r.payload)}`))},r=>this.metadata.reject(r))}close(){return this.Ec.cancel()}async getMetadata(){return this.metadata.promise}async fc(){return await this.getMetadata(),this.Rc()}async Rc(){const e=await this.bc();if(e===null)return null;const n=this.Ac.decode(e),r=Number(n);isNaN(r)&&this.Pc(`length string (${n}) is not valid number`);const i=await this.vc(r);return new O6(JSON.parse(i),e.length+r)}Vc(){return this.buffer.findIndex(e=>e==="{".charCodeAt(0))}async bc(){for(;this.Vc()<0&&!await this.Sc(););if(this.buffer.length===0)return null;const e=this.Vc();e<0&&this.Pc("Reached the end of bundle when a length string is expected.");const n=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),n}async vc(e){for(;this.buffer.length<e;)await this.Sc()&&this.Pc("Reached the end of bundle when more is expected.");const n=this.Ac.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),n}Pc(e){throw this.Ec.cancel(),new Error(`Invalid bundle format: ${e}`)}async Sc(){const e=await this.Ec.read();if(!e.done){const n=new Uint8Array(this.buffer.length+e.value.length);n.set(this.buffer),n.set(e.value,this.buffer.length),this.buffer=n}return e.done}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iQ{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastWriteError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw new O(C.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");const n=await async function(r,i){const s=G(r),o=Hl(s.wt)+"/documents",a={documents:i.map(h=>Kl(s.wt,h))},c=await s.ao("BatchGetDocuments",o,a,i.length),l=new Map;c.forEach(h=>{const d=a4(s.wt,h);l.set(d.key.toString(),d)});const u=[];return i.forEach(h=>{const d=l.get(h.toString());ae(!!d),u.push(d)}),u}(this.datastore,e);return n.forEach(r=>this.recordVersion(r)),n}set(e,n){this.write(n.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,n){try{this.write(n.toMutation(e,this.preconditionForUpdate(e)))}catch(r){this.lastWriteError=r}this.writtenDocs.add(e.toString())}delete(e){this.write(new Za(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastWriteError)throw this.lastWriteError;const e=this.readVersions;this.mutations.forEach(n=>{e.delete(n.key.toString())}),e.forEach((n,r)=>{const i=W.fromPath(r);this.mutations.push(new Iv(i,this.precondition(i)))}),await async function(n,r){const i=G(n),s=Hl(i.wt)+"/documents",o={writes:r.map(a=>Gl(i.wt,a))};await i.ro("Commit",s,o)}(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let n;if(e.isFoundDocument())n=e.version;else{if(!e.isNoDocument())throw Y();n=se.min()}const r=this.readVersions.get(e.key.toString());if(r){if(!n.isEqual(r))throw new O(C.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),n)}precondition(e){const n=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&n?Ze.updateTime(n):Ze.none()}preconditionForUpdate(e){const n=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&n){if(n.isEqual(se.min()))throw new O(C.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Ze.updateTime(n)}return Ze.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sQ{constructor(e,n,r,i,s){this.asyncQueue=e,this.datastore=n,this.options=r,this.updateFunction=i,this.deferred=s,this.Dc=r.maxAttempts,this.So=new xv(this.asyncQueue,"transaction_retry")}run(){this.Dc-=1,this.Cc()}Cc(){this.So.Io(async()=>{const e=new iQ(this.datastore),n=this.xc(e);n&&n.then(r=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(r)}).catch(i=>{this.Nc(i)}))}).catch(r=>{this.Nc(r)})})}xc(e){try{const n=this.updateFunction(e);return!Au(n)&&n.catch&&n.then?n:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(n){return this.deferred.reject(n),null}}Nc(e){this.Dc>0&&this.kc(e)?(this.Dc-=1,this.asyncQueue.enqueueAndForget(()=>(this.Cc(),Promise.resolve()))):this.deferred.reject(e)}kc(e){if(e.name==="FirebaseError"){const n=e.code;return n==="aborted"||n==="failed-precondition"||!bN(n)}return!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oQ{constructor(e,n,r,i){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=i,this.user=It.UNAUTHENTICATED,this.clientId=zR.I(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(r,async s=>{L("FirestoreClient","Received user=",s.uid),await this.authCredentialListener(s),this.user=s}),this.appCheckCredentials.start(r,s=>(L("FirestoreClient","Received new app check token=",s),this.appCheckCredentialListener(s,this.user)))}async getConfiguration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new O(C.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();const e=new St;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this.onlineComponents&&await this.onlineComponents.terminate(),this.offlineComponents&&await this.offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=rc(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function IP(t,e){t.asyncQueue.verifyOperationInProgress(),L("FirestoreClient","Initializing OfflineComponentProvider");const n=await t.getConfiguration();await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async i=>{r.isEqual(i)||(await ZN(e.localStore,i),r=i)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t.offlineComponents=e}async function EP(t,e){t.asyncQueue.verifyOperationInProgress();const n=await Yv(t);L("FirestoreClient","Initializing OnlineComponentProvider");const r=await t.getConfiguration();await e.initialize(n,r),t.setCredentialChangeListener(i=>oT(e.remoteStore,i)),t.setAppCheckTokenChangeListener((i,s)=>oT(e.remoteStore,s)),t.onlineComponents=e}async function Yv(t){return t.offlineComponents||(L("FirestoreClient","Using default OfflineComponentProvider"),await IP(t,new wP)),t.offlineComponents}async function tp(t){return t.onlineComponents||(L("FirestoreClient","Using default OnlineComponentProvider"),await EP(t,new Qv)),t.onlineComponents}function TP(t){return Yv(t).then(e=>e.persistence)}function Jv(t){return Yv(t).then(e=>e.localStore)}function SP(t){return tp(t).then(e=>e.remoteStore)}function Xv(t){return tp(t).then(e=>e.syncEngine)}async function Da(t){const e=await tp(t),n=e.eventManager;return n.onListen=U6.bind(null,e.syncEngine),n.onUnlisten=V6.bind(null,e.syncEngine),n}function aQ(t){return t.asyncQueue.enqueue(async()=>{const e=await TP(t),n=await SP(t);return e.setNetworkEnabled(!0),function(r){const i=G(r);return i.lu.delete(0),xu(i)}(n)})}function cQ(t){return t.asyncQueue.enqueue(async()=>{const e=await TP(t),n=await SP(t);return e.setNetworkEnabled(!1),async function(r){const i=G(r);i.lu.add(0),await ec(i),i._u.set("Offline")}(n)})}function lQ(t,e){const n=new St;return t.asyncQueue.enqueueAndForget(async()=>async function(r,i,s){try{const o=await function(a,c){const l=G(a);return l.persistence.runTransaction("read document","readonly",u=>l.localDocuments.getDocument(u,c))}(r,i);o.isFoundDocument()?s.resolve(o):o.isNoDocument()?s.resolve(null):s.reject(new O(C.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(o){const a=rc(o,`Failed to get document '${i} from cache`);s.reject(a)}}(await Jv(t),e,n)),n.promise}function CP(t,e,n={}){const r=new St;return t.asyncQueue.enqueueAndForget(async()=>function(i,s,o,a,c){const l=new ep({next:h=>{s.enqueueAndForget(()=>$v(i,u));const d=h.docs.has(o);!d&&h.fromCache?c.reject(new O(C.UNAVAILABLE,"Failed to get document because the client is offline.")):d&&h.fromCache&&a&&a.source==="server"?c.reject(new O(C.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):c.resolve(h)},error:h=>c.reject(h)}),u=new jv(Ja(o.path),l,{includeMetadataChanges:!0,Du:!0});return Vv(i,u)}(await Da(t),t.asyncQueue,e,n,r)),r.promise}function uQ(t,e){const n=new St;return t.asyncQueue.enqueueAndForget(async()=>async function(r,i,s){try{const o=await bd(r,i,!0),a=new mP(i,o.ji),c=a.Ku(o.documents),l=a.applyChanges(c,!1);s.resolve(l.snapshot)}catch(o){const a=rc(o,`Failed to execute query '${i} against cache`);s.reject(a)}}(await Jv(t),e,n)),n.promise}function AP(t,e,n={}){const r=new St;return t.asyncQueue.enqueueAndForget(async()=>function(i,s,o,a,c){const l=new ep({next:h=>{s.enqueueAndForget(()=>$v(i,u)),h.fromCache&&a.source==="server"?c.reject(new O(C.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):c.resolve(h)},error:h=>c.reject(h)}),u=new jv(o,l,{includeMetadataChanges:!0,Du:!0});return Vv(i,u)}(await Da(t),t.asyncQueue,e,n,r)),r.promise}function hQ(t,e){const n=new ep(e);return t.asyncQueue.enqueueAndForget(async()=>function(r,i){G(r).Tu.add(i),i.next()}(await Da(t),n)),()=>{n.Tc(),t.asyncQueue.enqueueAndForget(async()=>function(r,i){G(r).Tu.delete(i)}(await Da(t),n))}}function dQ(t,e,n){const r=new St;return t.asyncQueue.enqueueAndForget(async()=>{const i=await function(s){return tp(s).then(o=>o.datastore)}(t);new sQ(t.asyncQueue,i,n,e,r).run()}),r.promise}function fQ(t,e,n,r){const i=function(s,o){let a;return a=typeof s=="string"?new TextEncoder().encode(s):s,function(c,l){return new rQ(c,l)}(function(c,l){if(c instanceof Uint8Array)return hT(c,l);if(c instanceof ArrayBuffer)return hT(new Uint8Array(c),l);if(c instanceof ReadableStream)return c.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(a),o)}(n,Ou(e));t.asyncQueue.enqueueAndForget(async()=>{tQ(await Xv(t),i,r)})}function pQ(t,e){return t.asyncQueue.enqueue(async()=>function(n,r){const i=G(n);return i.persistence.runTransaction("Get named query","readonly",s=>i.Ds.getNamedQuery(s,r))}(await Jv(t),e))}const dT=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zv(t,e,n){if(!n)throw new O(C.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function kP(t,e,n,r){if(e===!0&&r===!0)throw new O(C.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function fT(t){if(!W.isDocumentKey(t))throw new O(C.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function pT(t){if(W.isDocumentKey(t))throw new O(C.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function np(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(n){return n.constructor?n.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":Y()}function Se(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new O(C.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=np(t);throw new O(C.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}function RP(t,e){if(e<=0)throw new O(C.INVALID_ARGUMENT,`Function ${t}() requires a positive number, but it was: ${e}.`)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gT{constructor(e){var n;if(e.host===void 0){if(e.ssl!==void 0)throw new O(C.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(n=e.ssl)===null||n===void 0||n;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new O(C.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.useFetchStreams=!!e.useFetchStreams,kP("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling)}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mu{constructor(e,n,r){this._authCredentials=n,this._appCheckCredentials=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new gT({}),this._settingsFrozen=!1,e instanceof ai?this._databaseId=e:(this._app=e,this._databaseId=function(i){if(!Object.prototype.hasOwnProperty.apply(i.options,["projectId"]))throw new O(C.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new ai(i.options.projectId)}(e))}get app(){if(!this._app)throw new O(C.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!==void 0}_setSettings(e){if(this._settingsFrozen)throw new O(C.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new gT(e),e.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new p2;switch(n.type){case"gapi":const r=n.client;return ae(!(typeof r!="object"||r===null||!r.auth||!r.auth.getAuthHeaderValueForFirstParty)),new y2(r,n.sessionIndex||"0",n.iamToken||null);case"provider":return n.client;default:throw new O(C.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const n=dT.get(e);n&&(L("ComponentProvider","Removing Datastore"),dT.delete(e),n.terminate())}(this),Promise.resolve()}}function gQ(t,e,n,r={}){var i;const s=(t=Se(t,Mu))._getSettings();if(s.host!=="firestore.googleapis.com"&&s.host!==e&&Ul("Host has been set in both settings() and useEmulator(), emulator host will be used"),t._setSettings(Object.assign(Object.assign({},s),{host:`${e}:${n}`,ssl:!1})),r.mockUserToken){let o,a;if(typeof r.mockUserToken=="string")o=r.mockUserToken,a=It.MOCK_USER;else{o=k_(r.mockUserToken,(i=t._app)===null||i===void 0?void 0:i.options.projectId);const c=r.mockUserToken.sub||r.mockUserToken.user_id;if(!c)throw new O(C.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");a=new It(c)}t._authCredentials=new g2(new GR(o,a))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ge{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Rr(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Ge(this.firestore,e,this._key)}}class Xt{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new Xt(this.firestore,e,this._query)}}class Rr extends Xt{constructor(e,n,r){super(e,n,Ja(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Ge(this.firestore,null,new W(e))}withConverter(e){return new Rr(this.firestore,e,this._path)}}function NP(t,e,...n){if(t=M(t),Zv("collection","path",e),t instanceof Mu){const r=Ee.fromString(e,...n);return pT(r),new Rr(t,null,r)}{if(!(t instanceof Ge||t instanceof Rr))throw new O(C.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(Ee.fromString(e,...n));return pT(r),new Rr(t.firestore,null,r)}}function mQ(t,e){if(t=Se(t,Mu),Zv("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new O(C.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new Xt(t,null,function(n){return new di(Ee.emptyPath(),n)}(e))}function Sd(t,e,...n){if(t=M(t),arguments.length===1&&(e=zR.I()),Zv("doc","path",e),t instanceof Mu){const r=Ee.fromString(e,...n);return fT(r),new Ge(t,null,new W(r))}{if(!(t instanceof Ge||t instanceof Rr))throw new O(C.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(Ee.fromString(e,...n));return fT(r),new Ge(t.firestore,t instanceof Rr?t.converter:null,new W(r))}}function PP(t,e){return t=M(t),e=M(e),(t instanceof Ge||t instanceof Rr)&&(e instanceof Ge||e instanceof Rr)&&t.firestore===e.firestore&&t.path===e.path&&t.converter===e.converter}function DP(t,e){return t=M(t),e=M(e),t instanceof Xt&&e instanceof Xt&&t.firestore===e.firestore&&Ru(t._query,e._query)&&t.converter===e.converter}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _Q{constructor(){this.Oc=Promise.resolve(),this.Mc=[],this.Fc=!1,this.$c=[],this.Bc=null,this.Lc=!1,this.Uc=!1,this.qc=[],this.So=new xv(this,"async_queue_retry"),this.Kc=()=>{const n=Sh();n&&L("AsyncQueue","Visibility state changed to "+n.visibilityState),this.So.Eo()};const e=Sh();e&&typeof e.addEventListener=="function"&&e.addEventListener("visibilitychange",this.Kc)}get isShuttingDown(){return this.Fc}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.Gc(),this.Qc(e)}enterRestrictedMode(e){if(!this.Fc){this.Fc=!0,this.Uc=e||!1;const n=Sh();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.Kc)}}enqueue(e){if(this.Gc(),this.Fc)return new Promise(()=>{});const n=new St;return this.Qc(()=>this.Fc&&this.Uc?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Mc.push(e),this.jc()))}async jc(){if(this.Mc.length!==0){try{await this.Mc[0](),this.Mc.shift(),this.So.reset()}catch(e){if(!ls(e))throw e;L("AsyncQueue","Operation failed with retryable error: "+e)}this.Mc.length>0&&this.So.Io(()=>this.jc())}}Qc(e){const n=this.Oc.then(()=>(this.Lc=!0,e().catch(r=>{this.Bc=r,this.Lc=!1;const i=function(s){let o=s.message||"";return s.stack&&(o=s.stack.includes(s.message)?s.stack:s.message+`
`+s.stack),o}(r);throw ht("INTERNAL UNHANDLED ERROR: ",i),r}).then(r=>(this.Lc=!1,r))));return this.Oc=n,n}enqueueAfterDelay(e,n,r){this.Gc(),this.qc.indexOf(e)>-1&&(n=0);const i=Uv.createAndSchedule(this,e,n,r,s=>this.Wc(s));return this.$c.push(i),i}Gc(){this.Bc&&Y()}verifyOperationInProgress(){}async zc(){let e;do e=this.Oc,await e;while(e!==this.Oc)}Hc(e){for(const n of this.$c)if(n.timerId===e)return!0;return!1}Jc(e){return this.zc().then(()=>{this.$c.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.$c)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.zc()})}Yc(e){this.qc.push(e)}Wc(e){const n=this.$c.indexOf(e);this.$c.splice(n,1)}}function Wm(t){return function(e,n){if(typeof e!="object"||e===null)return!1;const r=e;for(const i of n)if(i in r&&typeof r[i]=="function")return!0;return!1}(t,["next","error","complete"])}class yQ{constructor(){this._progressObserver={},this._taskCompletionResolver=new St,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,n,r){this._progressObserver={next:e,error:n,complete:r}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,n){return this._taskCompletionResolver.promise.then(e,n)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vQ=-1;class it extends Mu{constructor(e,n,r){super(e,n,r),this.type="firestore",this._queue=new _Q,this._persistenceKey="name"in e?e.name:"[DEFAULT]"}_terminate(){return this._firestoreClient||OP(this),this._firestoreClient.terminate()}}function Mt(t){return t._firestoreClient||OP(t),t._firestoreClient.verifyNotTerminated(),t._firestoreClient}function OP(t){var e;const n=t._freezeSettings(),r=function(i,s,o,a){return new N2(i,s,o,a.host,a.ssl,a.experimentalForceLongPolling,a.experimentalAutoDetectLongPolling,a.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,n);t._firestoreClient=new oQ(t._authCredentials,t._appCheckCredentials,t._queue,r)}function wQ(t,e){MP(t=Se(t,it));const n=Mt(t),r=t._freezeSettings(),i=new Qv;return xP(n,i,new bP(i,r.cacheSizeBytes,e==null?void 0:e.forceOwnership))}function bQ(t){MP(t=Se(t,it));const e=Mt(t),n=t._freezeSettings(),r=new Qv;return xP(e,r,new nQ(r,n.cacheSizeBytes))}function xP(t,e,n){const r=new St;return t.asyncQueue.enqueue(async()=>{try{await IP(t,n),await EP(t,e),r.resolve()}catch(i){const s=i;if(!function(o){return o.name==="FirebaseError"?o.code===C.FAILED_PRECONDITION||o.code===C.UNIMPLEMENTED:typeof DOMException!="undefined"&&o instanceof DOMException?o.code===22||o.code===20||o.code===11:!0}(s))throw s;console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+s),r.reject(s)}}).then(()=>r.promise)}function IQ(t){if(t._initialized&&!t._terminated)throw new O(C.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");const e=new St;return t._queue.enqueueAndForgetEvenWhileRestricted(async()=>{try{await async function(n){if(!ir.V())return Promise.resolve();const r=n+"main";await ir.delete(r)}(Pv(t._databaseId,t._persistenceKey)),e.resolve()}catch(n){e.reject(n)}}),e.promise}function EQ(t){return function(e){const n=new St;return e.asyncQueue.enqueueAndForget(async()=>W6(await Xv(e),n)),n.promise}(Mt(t=Se(t,it)))}function TQ(t){return aQ(Mt(t=Se(t,it)))}function SQ(t){return cQ(Mt(t=Se(t,it)))}function CQ(t,e){const n=Mt(t=Se(t,it)),r=new yQ;return fQ(n,t._databaseId,e,r),r}function AQ(t,e){return pQ(Mt(t=Se(t,it)),e).then(n=>n?new Xt(t,null,n.query):null)}function MP(t){if(t._initialized||t._terminated)throw new O(C.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ns{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new O(C.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new ot(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ur{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Ur(mt.fromBase64String(e))}catch(n){throw new O(C.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new Ur(mt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ko{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rp{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new O(C.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new O(C.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return ue(this._lat,e._lat)||ue(this._long,e._long)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kQ=/^__.*__$/;class RQ{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new fi(e,this.data,this.fieldMask,n,this.fieldTransforms):new Xa(e,this.data,n,this.fieldTransforms)}}class LP{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new fi(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function FP(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Y()}}class ip{constructor(e,n,r,i,s,o){this.settings=e,this.databaseId=n,this.wt=r,this.ignoreUndefinedProperties=i,s===void 0&&this.Xc(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Zc(){return this.settings.Zc}ta(e){return new ip(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.wt,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}ea(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),i=this.ta({path:r,na:!1});return i.sa(e),i}ia(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),i=this.ta({path:r,na:!1});return i.Xc(),i}ra(e){return this.ta({path:void 0,na:!0})}oa(e){return Cd(e,this.settings.methodName,this.settings.ua||!1,this.path,this.settings.ca)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}Xc(){if(this.path)for(let e=0;e<this.path.length;e++)this.sa(this.path.get(e))}sa(e){if(e.length===0)throw this.oa("Document fields must not be empty");if(FP(this.Zc)&&kQ.test(e))throw this.oa('Document fields cannot begin and end with "__"')}}class NQ{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.wt=r||Ou(e)}aa(e,n,r,i=!1){return new ip({Zc:e,methodName:n,ca:r,path:ot.emptyPath(),na:!1,ua:i},this.databaseId,this.wt,this.ignoreUndefinedProperties)}}function Ro(t){const e=t._freezeSettings(),n=Ou(t._databaseId);return new NQ(t._databaseId,!!e.ignoreUndefinedProperties,n)}function sp(t,e,n,r,i,s={}){const o=t.aa(s.merge||s.mergeFields?2:0,e,n,i);rw("Data must be an object, but it was:",o,r);const a=$P(r,o);let c,l;if(s.merge)c=new Nn(o.fieldMask),l=o.fieldTransforms;else if(s.mergeFields){const u=[];for(const h of s.mergeFields){const d=Km(e,h,n);if(!o.contains(d))throw new O(C.INVALID_ARGUMENT,`Field '${d}' is specified in your field mask but missing from your input data.`);jP(u,d)||u.push(d)}c=new Nn(u),l=o.fieldTransforms.filter(h=>c.covers(h.field))}else c=null,l=o.fieldTransforms;return new RQ(new Ut(a),c,l)}class Lu extends ko{_toFieldTransform(e){if(e.Zc!==2)throw e.Zc===1?e.oa(`${this._methodName}() can only appear at the top level of your update data`):e.oa(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Lu}}function UP(t,e,n){return new ip({Zc:3,ca:e.settings.ca,methodName:t._methodName,na:n},e.databaseId,e.wt,e.ignoreUndefinedProperties)}class ew extends ko{_toFieldTransform(e){return new Nu(e.path,new Ca)}isEqual(e){return e instanceof ew}}class PQ extends ko{constructor(e,n){super(e),this.ha=n}_toFieldTransform(e){const n=UP(this,e,!0),r=this.ha.map(s=>No(s,n)),i=new lo(r);return new Nu(e.path,i)}isEqual(e){return this===e}}class DQ extends ko{constructor(e,n){super(e),this.ha=n}_toFieldTransform(e){const n=UP(this,e,!0),r=this.ha.map(s=>No(s,n)),i=new uo(r);return new Nu(e.path,i)}isEqual(e){return this===e}}class OQ extends ko{constructor(e,n){super(e),this.la=n}_toFieldTransform(e){const n=new Aa(e.wt,pN(e.wt,this.la));return new Nu(e.path,n)}isEqual(e){return this===e}}function tw(t,e,n,r){const i=t.aa(1,e,n);rw("Data must be an object, but it was:",i,r);const s=[],o=Ut.empty();Ao(r,(c,l)=>{const u=iw(e,c,n);l=M(l);const h=i.ia(u);if(l instanceof Lu)s.push(u);else{const d=No(l,h);d!=null&&(s.push(u),o.set(u,d))}});const a=new Nn(s);return new LP(o,a,i.fieldTransforms)}function nw(t,e,n,r,i,s){const o=t.aa(1,e,n),a=[Km(e,r,n)],c=[i];if(s.length%2!=0)throw new O(C.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let d=0;d<s.length;d+=2)a.push(Km(e,s[d])),c.push(s[d+1]);const l=[],u=Ut.empty();for(let d=a.length-1;d>=0;--d)if(!jP(l,a[d])){const f=a[d];let g=c[d];g=M(g);const v=o.ia(f);if(g instanceof Lu)l.push(f);else{const I=No(g,v);I!=null&&(l.push(f),u.set(f,I))}}const h=new Nn(l);return new LP(u,h,o.fieldTransforms)}function VP(t,e,n,r=!1){return No(n,t.aa(r?4:3,e))}function No(t,e){if(BP(t=M(t)))return rw("Unsupported field value:",e,t),$P(t,e);if(t instanceof ko)return function(n,r){if(!FP(r.Zc))throw r.oa(`${n._methodName}() can only be used with update() and set()`);if(!r.path)throw r.oa(`${n._methodName}() is not currently supported inside arrays`);const i=n._toFieldTransform(r);i&&r.fieldTransforms.push(i)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.na&&e.Zc!==4)throw e.oa("Nested arrays are not supported");return function(n,r){const i=[];let s=0;for(const o of n){let a=No(o,r.ra(s));a==null&&(a={nullValue:"NULL_VALUE"}),i.push(a),s++}return{arrayValue:{values:i}}}(t,e)}return function(n,r){if((n=M(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return pN(r.wt,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const i=Je.fromDate(n);return{timestampValue:Wl(r.wt,i)}}if(n instanceof Je){const i=new Je(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:Wl(r.wt,i)}}if(n instanceof rp)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof Ur)return{bytesValue:kN(r.wt,n._byteString)};if(n instanceof Ge){const i=r.databaseId,s=n.firestore._databaseId;if(!s.isEqual(i))throw r.oa(`Document reference is for database ${s.projectId}/${s.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:Ev(n.firestore._databaseId||r.databaseId,n._key.path)}}throw r.oa(`Unsupported field value: ${np(n)}`)}(t,e)}function $P(t,e){const n={};return tN(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Ao(t,(r,i)=>{const s=No(i,e.ea(r));s!=null&&(n[r]=s)}),{mapValue:{fields:n}}}function BP(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof Je||t instanceof rp||t instanceof Ur||t instanceof Ge||t instanceof ko)}function rw(t,e,n){if(!BP(n)||!function(r){return typeof r=="object"&&r!==null&&(Object.getPrototypeOf(r)===Object.prototype||Object.getPrototypeOf(r)===null)}(n)){const r=np(n);throw r==="an object"?e.oa(t+" a custom object"):e.oa(t+" "+r)}}function Km(t,e,n){if((e=M(e))instanceof ns)return e._internalPath;if(typeof e=="string")return iw(t,e);throw Cd("Field path arguments must be of type string or ",t,!1,void 0,n)}const xQ=new RegExp("[~\\*/\\[\\]]");function iw(t,e,n){if(e.search(xQ)>=0)throw Cd(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new ns(...e.split("."))._internalPath}catch{throw Cd(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function Cd(t,e,n,r,i){const s=r&&!r.isEmpty(),o=i!==void 0;let a=`Function ${e}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(s||o)&&(c+=" (found",s&&(c+=` in field ${r}`),o&&(c+=` in document ${i}`),c+=")"),new O(C.INVALID_ARGUMENT,a+t+c)}function jP(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ql{constructor(e,n,r,i,s){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new Ge(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new MQ(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(op("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class MQ extends Ql{data(){return super.data()}}function op(t,e){return typeof e=="string"?iw(t,e):e instanceof ns?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fs{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class ci extends Ql{constructor(e,n,r,i,s,o){super(e,n,r,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new Jc(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(op("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}}class Jc extends ci{data(e={}){return super.data(e)}}class rs{constructor(e,n,r,i){this._firestore=e,this._userDataWriter=n,this._snapshot=i,this.metadata=new Fs(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new Jc(this._firestore,this._userDataWriter,r.key,r,new Fs(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new O(C.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(r,i){if(r._snapshot.oldDocs.isEmpty()){let s=0;return r._snapshot.docChanges.map(o=>({type:"added",doc:new Jc(r._firestore,r._userDataWriter,o.doc.key,o.doc,new Fs(r._snapshot.mutatedKeys.has(o.doc.key),r._snapshot.fromCache),r.query.converter),oldIndex:-1,newIndex:s++}))}{let s=r._snapshot.oldDocs;return r._snapshot.docChanges.filter(o=>i||o.type!==3).map(o=>{const a=new Jc(r._firestore,r._userDataWriter,o.doc.key,o.doc,new Fs(r._snapshot.mutatedKeys.has(o.doc.key),r._snapshot.fromCache),r.query.converter);let c=-1,l=-1;return o.type!==0&&(c=s.indexOf(o.doc.key),s=s.delete(o.doc.key)),o.type!==1&&(s=s.add(o.doc),l=s.indexOf(o.doc.key)),{type:LQ(o.type),doc:a,oldIndex:c,newIndex:l}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}}function LQ(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Y()}}function qP(t,e){return t instanceof ci&&e instanceof ci?t._firestore===e._firestore&&t._key.isEqual(e._key)&&(t._document===null?e._document===null:t._document.isEqual(e._document))&&t._converter===e._converter:t instanceof rs&&e instanceof rs&&t._firestore===e._firestore&&DP(t.query,e.query)&&t.metadata.isEqual(e.metadata)&&t._snapshot.isEqual(e._snapshot)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function WP(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new O(C.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Fu{}function Ei(t,...e){for(const n of e)t=n._apply(t);return t}class FQ extends Fu{constructor(e,n,r){super(),this.fa=e,this.da=n,this._a=r,this.type="where"}_apply(e){const n=Ro(e.firestore),r=function(i,s,o,a,c,l,u){let h;if(c.isKeyField()){if(l==="array-contains"||l==="array-contains-any")throw new O(C.INVALID_ARGUMENT,`Invalid Query. You can't perform '${l}' queries on documentId().`);if(l==="in"||l==="not-in"){_T(u,l);const f=[];for(const g of u)f.push(mT(a,i,g));h={arrayValue:{values:f}}}else h=mT(a,i,u)}else l!=="in"&&l!=="not-in"&&l!=="array-contains-any"||_T(u,l),h=VP(o,s,u,l==="in"||l==="not-in");const d=$t.create(c,l,h);return function(f,g){if(g.ht()){const I=vv(f);if(I!==null&&!I.isEqual(g.field))throw new O(C.INVALID_ARGUMENT,`Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '${I.toString()}' and '${g.field.toString()}'`);const S=yv(f);S!==null&&QP(f,g.field,S)}const v=function(I,S){for(const k of I.filters)if(S.indexOf(k.op)>=0)return k.op;return null}(f,function(I){switch(I){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}(g.op));if(v!==null)throw v===g.op?new O(C.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${g.op.toString()}' filter.`):new O(C.INVALID_ARGUMENT,`Invalid query. You cannot use '${g.op.toString()}' filters with '${v.toString()}' filters.`)}(i,d),d}(e._query,"where",n,e.firestore._databaseId,this.fa,this.da,this._a);return new Xt(e.firestore,e.converter,function(i,s){const o=i.filters.concat([s]);return new di(i.path,i.collectionGroup,i.explicitOrderBy.slice(),o,i.limit,i.limitType,i.startAt,i.endAt)}(e._query,r))}}function UQ(t,e,n){const r=e,i=op("where",t);return new FQ(i,r,n)}class VQ extends Fu{constructor(e,n){super(),this.fa=e,this.wa=n,this.type="orderBy"}_apply(e){const n=function(r,i,s){if(r.startAt!==null)throw new O(C.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(r.endAt!==null)throw new O(C.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");const o=new ia(i,s);return function(a,c){if(yv(a)===null){const l=vv(a);l!==null&&QP(a,l,c.field)}}(r,o),o}(e._query,this.fa,this.wa);return new Xt(e.firestore,e.converter,function(r,i){const s=r.explicitOrderBy.concat([i]);return new di(r.path,r.collectionGroup,s,r.filters.slice(),r.limit,r.limitType,r.startAt,r.endAt)}(e._query,n))}}function $Q(t,e="asc"){const n=e,r=op("orderBy",t);return new VQ(r,n)}class KP extends Fu{constructor(e,n,r){super(),this.type=e,this.ma=n,this.ga=r}_apply(e){return new Xt(e.firestore,e.converter,cN(e._query,this.ma,this.ga))}}function BQ(t){return RP("limit",t),new KP("limit",t,"F")}function jQ(t){return RP("limitToLast",t),new KP("limitToLast",t,"L")}class HP extends Fu{constructor(e,n,r){super(),this.type=e,this.ya=n,this.pa=r}_apply(e){const n=zP(e,this.type,this.ya,this.pa);return new Xt(e.firestore,e.converter,function(r,i){return new di(r.path,r.collectionGroup,r.explicitOrderBy.slice(),r.filters.slice(),r.limit,r.limitType,i,r.endAt)}(e._query,n))}}function qQ(...t){return new HP("startAt",t,!0)}function WQ(...t){return new HP("startAfter",t,!1)}class GP extends Fu{constructor(e,n,r){super(),this.type=e,this.ya=n,this.pa=r}_apply(e){const n=zP(e,this.type,this.ya,this.pa);return new Xt(e.firestore,e.converter,function(r,i){return new di(r.path,r.collectionGroup,r.explicitOrderBy.slice(),r.filters.slice(),r.limit,r.limitType,r.startAt,i)}(e._query,n))}}function KQ(...t){return new GP("endBefore",t,!1)}function HQ(...t){return new GP("endAt",t,!0)}function zP(t,e,n,r){if(n[0]=M(n[0]),n[0]instanceof Ql)return function(i,s,o,a,c){if(!a)throw new O(C.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${o}().`);const l=[];for(const u of Sa(i))if(u.field.isKeyField())l.push(ao(s,a.key));else{const h=a.data.field(u.field);if(_v(h))throw new O(C.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+u.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(h===null){const d=u.field.canonicalString();throw new O(C.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${d}' (used as the orderBy) does not exist.`)}l.push(h)}return new es(l,c)}(t._query,t.firestore._databaseId,e,n[0]._document,r);{const i=Ro(t.firestore);return function(s,o,a,c,l,u){const h=s.explicitOrderBy;if(l.length>h.length)throw new O(C.INVALID_ARGUMENT,`Too many arguments provided to ${c}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const d=[];for(let f=0;f<l.length;f++){const g=l[f];if(h[f].field.isKeyField()){if(typeof g!="string")throw new O(C.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${c}(), but got a ${typeof g}`);if(!wv(s)&&g.indexOf("/")!==-1)throw new O(C.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${c}() must be a plain document ID, but '${g}' contains a slash.`);const v=s.path.child(Ee.fromString(g));if(!W.isDocumentKey(v))throw new O(C.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${c}() must result in a valid document path, but '${v}' is not because it contains an odd number of segments.`);const I=new W(v);d.push(ao(o,I))}else{const v=VP(a,c,g);d.push(v)}}return new es(d,u)}(t._query,t.firestore._databaseId,i,e,n,r)}}function mT(t,e,n){if(typeof(n=M(n))=="string"){if(n==="")throw new O(C.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!wv(e)&&n.indexOf("/")!==-1)throw new O(C.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(Ee.fromString(n));if(!W.isDocumentKey(r))throw new O(C.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return ao(t,new W(r))}if(n instanceof Ge)return ao(t,n._key);throw new O(C.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${np(n)}.`)}function _T(t,e){if(!Array.isArray(t)||t.length===0)throw new O(C.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`);if(t.length>10)throw new O(C.INVALID_ARGUMENT,`Invalid Query. '${e.toString()}' filters support a maximum of 10 elements in the value array.`)}function QP(t,e,n){if(!n.isEqual(e))throw new O(C.INVALID_ARGUMENT,`Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '${e.toString()}' and so you must also use '${e.toString()}' as your first argument to orderBy(), but your first orderBy() is on field '${n.toString()}' instead.`)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GQ={maxAttempts:5};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sw{convertValue(e,n="none"){switch(oo(e)){case 0:return null;case 1:return e.booleanValue;case 2:return et(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(so(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 10:return this.convertObject(e.mapValue,n);default:throw Y()}}convertObject(e,n){const r={};return Ao(e.fields,(i,s)=>{r[i]=this.convertValue(s,n)}),r}convertGeoPoint(e){return new rp(et(e.latitude),et(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=nN(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp($l(e));default:return null}}convertTimestamp(e){const n=Xi(e);return new Je(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=Ee.fromString(e);ae(FN(r));const i=new ai(r.get(1),r.get(3)),s=new W(r.popFirst(5));return i.isEqual(n)||ht(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ap(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}class zQ extends sw{constructor(e){super(),this.firestore=e}convertBytes(e){return new Ur(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new Ge(this.firestore,null,n)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QQ{constructor(e,n){this._firestore=e,this._commitHandler=n,this._mutations=[],this._committed=!1,this._dataReader=Ro(e)}set(e,n,r){this._verifyNotCommitted();const i=Ri(e,this._firestore),s=ap(i.converter,n,r),o=sp(this._dataReader,"WriteBatch.set",i._key,s,i.converter!==null,r);return this._mutations.push(o.toMutation(i._key,Ze.none())),this}update(e,n,r,...i){this._verifyNotCommitted();const s=Ri(e,this._firestore);let o;return o=typeof(n=M(n))=="string"||n instanceof ns?nw(this._dataReader,"WriteBatch.update",s._key,n,r,i):tw(this._dataReader,"WriteBatch.update",s._key,n),this._mutations.push(o.toMutation(s._key,Ze.exists(!0))),this}delete(e){this._verifyNotCommitted();const n=Ri(e,this._firestore);return this._mutations=this._mutations.concat(new Za(n._key,Ze.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new O(C.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function Ri(t,e){if((t=M(t)).firestore!==e)throw new O(C.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function YQ(t){t=Se(t,Ge);const e=Se(t.firestore,it);return CP(Mt(e),t._key).then(n=>ow(e,t,n))}class Po extends sw{constructor(e){super(),this.firestore=e}convertBytes(e){return new Ur(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new Ge(this.firestore,null,n)}}function JQ(t){t=Se(t,Ge);const e=Se(t.firestore,it),n=Mt(e),r=new Po(e);return lQ(n,t._key).then(i=>new ci(e,r,t._key,i,new Fs(i!==null&&i.hasLocalMutations,!0),t.converter))}function XQ(t){t=Se(t,Ge);const e=Se(t.firestore,it);return CP(Mt(e),t._key,{source:"server"}).then(n=>ow(e,t,n))}function ZQ(t){t=Se(t,Xt);const e=Se(t.firestore,it),n=Mt(e),r=new Po(e);return WP(t._query),AP(n,t._query).then(i=>new rs(e,r,t,i))}function e3(t){t=Se(t,Xt);const e=Se(t.firestore,it),n=Mt(e),r=new Po(e);return uQ(n,t._query).then(i=>new rs(e,r,t,i))}function t3(t){t=Se(t,Xt);const e=Se(t.firestore,it),n=Mt(e),r=new Po(e);return AP(n,t._query,{source:"server"}).then(i=>new rs(e,r,t,i))}function yT(t,e,n){t=Se(t,Ge);const r=Se(t.firestore,it),i=ap(t.converter,e,n);return Uu(r,[sp(Ro(r),"setDoc",t._key,i,t.converter!==null,n).toMutation(t._key,Ze.none())])}function vT(t,e,n,...r){t=Se(t,Ge);const i=Se(t.firestore,it),s=Ro(i);let o;return o=typeof(e=M(e))=="string"||e instanceof ns?nw(s,"updateDoc",t._key,e,n,r):tw(s,"updateDoc",t._key,e),Uu(i,[o.toMutation(t._key,Ze.exists(!0))])}function n3(t){return Uu(Se(t.firestore,it),[new Za(t._key,Ze.none())])}function r3(t,e){const n=Se(t.firestore,it),r=Sd(t),i=ap(t.converter,e);return Uu(n,[sp(Ro(t.firestore),"addDoc",r._key,i,t.converter!==null,{}).toMutation(r._key,Ze.exists(!1))]).then(()=>r)}function YP(t,...e){var n,r,i;t=M(t);let s={includeMetadataChanges:!1},o=0;typeof e[o]!="object"||Wm(e[o])||(s=e[o],o++);const a={includeMetadataChanges:s.includeMetadataChanges};if(Wm(e[o])){const h=e[o];e[o]=(n=h.next)===null||n===void 0?void 0:n.bind(h),e[o+1]=(r=h.error)===null||r===void 0?void 0:r.bind(h),e[o+2]=(i=h.complete)===null||i===void 0?void 0:i.bind(h)}let c,l,u;if(t instanceof Ge)l=Se(t.firestore,it),u=Ja(t._key.path),c={next:h=>{e[o]&&e[o](ow(l,t,h))},error:e[o+1],complete:e[o+2]};else{const h=Se(t,Xt);l=Se(h.firestore,it),u=h._query;const d=new Po(l);c={next:f=>{e[o]&&e[o](new rs(l,d,h,f))},error:e[o+1],complete:e[o+2]},WP(t._query)}return function(h,d,f,g){const v=new ep(g),I=new jv(d,v,f);return h.asyncQueue.enqueueAndForget(async()=>Vv(await Da(h),I)),()=>{v.Tc(),h.asyncQueue.enqueueAndForget(async()=>$v(await Da(h),I))}}(Mt(l),u,a,c)}function i3(t,e){return hQ(Mt(t=Se(t,it)),Wm(e)?e:{next:e})}function Uu(t,e){return function(n,r){const i=new St;return n.asyncQueue.enqueueAndForget(async()=>$6(await Xv(n),r,i)),i.promise}(Mt(t),e)}function ow(t,e,n){const r=n.docs.get(e._key),i=new Po(t);return new ci(t,i,e._key,r,new Fs(n.hasPendingWrites,n.fromCache),e.converter)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s3 extends class{constructor(e,n){this._firestore=e,this._transaction=n,this._dataReader=Ro(e)}get(e){const n=Ri(e,this._firestore),r=new zQ(this._firestore);return this._transaction.lookup([n._key]).then(i=>{if(!i||i.length!==1)return Y();const s=i[0];if(s.isFoundDocument())return new Ql(this._firestore,r,s.key,s,n.converter);if(s.isNoDocument())return new Ql(this._firestore,r,n._key,null,n.converter);throw Y()})}set(e,n,r){const i=Ri(e,this._firestore),s=ap(i.converter,n,r),o=sp(this._dataReader,"Transaction.set",i._key,s,i.converter!==null,r);return this._transaction.set(i._key,o),this}update(e,n,r,...i){const s=Ri(e,this._firestore);let o;return o=typeof(n=M(n))=="string"||n instanceof ns?nw(this._dataReader,"Transaction.update",s._key,n,r,i):tw(this._dataReader,"Transaction.update",s._key,n),this._transaction.update(s._key,o),this}delete(e){const n=Ri(e,this._firestore);return this._transaction.delete(n._key),this}}{constructor(e,n){super(e,n),this._firestore=e}get(e){const n=Ri(e,this._firestore),r=new Po(this._firestore);return super.get(e).then(i=>new ci(this._firestore,r,n._key,i._document,new Fs(!1,!1),n.converter))}}function o3(t,e,n){t=Se(t,it);const r=Object.assign(Object.assign({},GQ),n);return function(i){if(i.maxAttempts<1)throw new O(C.INVALID_ARGUMENT,"Max attempts must be at least 1")}(r),dQ(Mt(t),i=>e(new s3(t,i)),r)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function a3(){return new Lu("deleteField")}function c3(){return new ew("serverTimestamp")}function l3(...t){return new PQ("arrayUnion",t)}function u3(...t){return new DQ("arrayRemove",t)}function h3(t){return new OQ("increment",t)}(function(t,e=!0){(function(n){Ya=n})(Br),nt(new Ce("firestore",(n,{options:r})=>{const i=n.getProvider("app").getImmediate(),s=new it(i,new m2(n.getProvider("auth-internal")),new w2(n.getProvider("app-check-internal")));return r=Object.assign({useFetchStreams:e},r),s._setSettings(r),s},"PUBLIC")),Ve(_E,"3.4.12",t),Ve(_E,"3.4.12","esm2017")})();const d3="@firebase/firestore-compat",f3="0.1.21";/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aw(t,e){if(e===void 0)return{merge:!1};if(e.mergeFields!==void 0&&e.merge!==void 0)throw new O("invalid-argument",`Invalid options passed to function ${t}(): You cannot specify both "merge" and "mergeFields".`);return e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wT(){if(typeof Uint8Array=="undefined")throw new O("unimplemented","Uint8Arrays are not available in this environment.")}function bT(){if(!k2())throw new O("unimplemented","Blobs are unavailable in Firestore in this environment.")}class Yl{constructor(e){this._delegate=e}static fromBase64String(e){return bT(),new Yl(Ur.fromBase64String(e))}static fromUint8Array(e){return wT(),new Yl(Ur.fromUint8Array(e))}toBase64(){return bT(),this._delegate.toBase64()}toUint8Array(){return wT(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hm(t){return p3(t,["next","error","complete"])}function p3(t,e){if(typeof t!="object"||t===null)return!1;const n=t;for(const r of e)if(r in n&&typeof n[r]=="function")return!0;return!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g3{enableIndexedDbPersistence(e,n){return wQ(e._delegate,{forceOwnership:n})}enableMultiTabIndexedDbPersistence(e){return bQ(e._delegate)}clearIndexedDbPersistence(e){return IQ(e._delegate)}}class JP{constructor(e,n,r){this._delegate=n,this._persistenceProvider=r,this.INTERNAL={delete:()=>this.terminate()},e instanceof ai||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){const n=this._delegate._getSettings();!e.merge&&n.host!==e.host&&Ul("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&(e=Object.assign(Object.assign({},n),e),delete e.merge),this._delegate._setSettings(e)}useEmulator(e,n,r={}){gQ(this._delegate,e,n,r)}enableNetwork(){return TQ(this._delegate)}disableNetwork(){return SQ(this._delegate)}enablePersistence(e){let n=!1,r=!1;return e&&(n=!!e.synchronizeTabs,r=!!e.experimentalForceOwningTab,kP("synchronizeTabs",n,"experimentalForceOwningTab",r)),n?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,r)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return EQ(this._delegate)}onSnapshotsInSync(e){return i3(this._delegate,e)}get app(){if(!this._appCompat)throw new O("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new Oa(this,NP(this._delegate,e))}catch(n){throw nn(n,"collection()","Firestore.collection()")}}doc(e){try{return new Bn(this,Sd(this._delegate,e))}catch(n){throw nn(n,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new tn(this,mQ(this._delegate,e))}catch(n){throw nn(n,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return o3(this._delegate,n=>e(new XP(this,n)))}batch(){return Mt(this._delegate),new ZP(new QQ(this._delegate,e=>Uu(this._delegate,e)))}loadBundle(e){return CQ(this._delegate,e)}namedQuery(e){return AQ(this._delegate,e).then(n=>n?new tn(this,n):null)}}class cp extends sw{constructor(e){super(),this.firestore=e}convertBytes(e){return new Yl(new Ur(e))}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return Bn.forKey(n,this.firestore,null)}}function m3(t){d2(t)}class XP{constructor(e,n){this._firestore=e,this._delegate=n,this._userDataWriter=new cp(e)}get(e){const n=Us(e);return this._delegate.get(n).then(r=>new Jl(this._firestore,new ci(this._firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,n.converter)))}set(e,n,r){const i=Us(e);return r?(aw("Transaction.set",r),this._delegate.set(i,n,r)):this._delegate.set(i,n),this}update(e,n,r,...i){const s=Us(e);return arguments.length===2?this._delegate.update(s,n):this._delegate.update(s,n,r,...i),this}delete(e){const n=Us(e);return this._delegate.delete(n),this}}class ZP{constructor(e){this._delegate=e}set(e,n,r){const i=Us(e);return r?(aw("WriteBatch.set",r),this._delegate.set(i,n,r)):this._delegate.set(i,n),this}update(e,n,r,...i){const s=Us(e);return arguments.length===2?this._delegate.update(s,n):this._delegate.update(s,n,r,...i),this}delete(e){const n=Us(e);return this._delegate.delete(n),this}commit(){return this._delegate.commit()}}class go{constructor(e,n,r){this._firestore=e,this._userDataWriter=n,this._delegate=r}fromFirestore(e,n){const r=new Jc(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new Xl(this._firestore,r),n!=null?n:{})}toFirestore(e,n){return n?this._delegate.toFirestore(e,n):this._delegate.toFirestore(e)}static getInstance(e,n){const r=go.INSTANCES;let i=r.get(e);i||(i=new WeakMap,r.set(e,i));let s=i.get(n);return s||(s=new go(e,new cp(e),n),i.set(n,s)),s}}go.INSTANCES=new WeakMap;class Bn{constructor(e,n){this.firestore=e,this._delegate=n,this._userDataWriter=new cp(e)}static forPath(e,n,r){if(e.length%2!==0)throw new O("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new Bn(n,new Ge(n._delegate,r,new W(e)))}static forKey(e,n,r){return new Bn(n,new Ge(n._delegate,r,e))}get id(){return this._delegate.id}get parent(){return new Oa(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new Oa(this.firestore,NP(this._delegate,e))}catch(n){throw nn(n,"collection()","DocumentReference.collection()")}}isEqual(e){return e=M(e),e instanceof Ge?PP(this._delegate,e):!1}set(e,n){n=aw("DocumentReference.set",n);try{return n?yT(this._delegate,e,n):yT(this._delegate,e)}catch(r){throw nn(r,"setDoc()","DocumentReference.set()")}}update(e,n,...r){try{return arguments.length===1?vT(this._delegate,e):vT(this._delegate,e,n,...r)}catch(i){throw nn(i,"updateDoc()","DocumentReference.update()")}}delete(){return n3(this._delegate)}onSnapshot(...e){const n=eD(e),r=tD(e,i=>new Jl(this.firestore,new ci(this.firestore._delegate,this._userDataWriter,i._key,i._document,i.metadata,this._delegate.converter)));return YP(this._delegate,n,r)}get(e){let n;return(e==null?void 0:e.source)==="cache"?n=JQ(this._delegate):(e==null?void 0:e.source)==="server"?n=XQ(this._delegate):n=YQ(this._delegate),n.then(r=>new Jl(this.firestore,new ci(this.firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,this._delegate.converter)))}withConverter(e){return new Bn(this.firestore,e?this._delegate.withConverter(go.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}function nn(t,e,n){return t.message=t.message.replace(e,n),t}function eD(t){for(const e of t)if(typeof e=="object"&&!Hm(e))return e;return{}}function tD(t,e){var n,r;let i;return Hm(t[0])?i=t[0]:Hm(t[1])?i=t[1]:typeof t[0]=="function"?i={next:t[0],error:t[1],complete:t[2]}:i={next:t[1],error:t[2],complete:t[3]},{next:s=>{i.next&&i.next(e(s))},error:(n=i.error)===null||n===void 0?void 0:n.bind(i),complete:(r=i.complete)===null||r===void 0?void 0:r.bind(i)}}class Jl{constructor(e,n){this._firestore=e,this._delegate=n}get ref(){return new Bn(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,n){return this._delegate.get(e,n)}isEqual(e){return qP(this._delegate,e._delegate)}}class Xl extends Jl{data(e){const n=this._delegate.data(e);return f2(n!==void 0),n}}class tn{constructor(e,n){this.firestore=e,this._delegate=n,this._userDataWriter=new cp(e)}where(e,n,r){try{return new tn(this.firestore,Ei(this._delegate,UQ(e,n,r)))}catch(i){throw nn(i,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,n){try{return new tn(this.firestore,Ei(this._delegate,$Q(e,n)))}catch(r){throw nn(r,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new tn(this.firestore,Ei(this._delegate,BQ(e)))}catch(n){throw nn(n,"limit()","Query.limit()")}}limitToLast(e){try{return new tn(this.firestore,Ei(this._delegate,jQ(e)))}catch(n){throw nn(n,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new tn(this.firestore,Ei(this._delegate,qQ(...e)))}catch(n){throw nn(n,"startAt()","Query.startAt()")}}startAfter(...e){try{return new tn(this.firestore,Ei(this._delegate,WQ(...e)))}catch(n){throw nn(n,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new tn(this.firestore,Ei(this._delegate,KQ(...e)))}catch(n){throw nn(n,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new tn(this.firestore,Ei(this._delegate,HQ(...e)))}catch(n){throw nn(n,"endAt()","Query.endAt()")}}isEqual(e){return DP(this._delegate,e._delegate)}get(e){let n;return(e==null?void 0:e.source)==="cache"?n=e3(this._delegate):(e==null?void 0:e.source)==="server"?n=t3(this._delegate):n=ZQ(this._delegate),n.then(r=>new Gm(this.firestore,new rs(this.firestore._delegate,this._userDataWriter,this._delegate,r._snapshot)))}onSnapshot(...e){const n=eD(e),r=tD(e,i=>new Gm(this.firestore,new rs(this.firestore._delegate,this._userDataWriter,this._delegate,i._snapshot)));return YP(this._delegate,n,r)}withConverter(e){return new tn(this.firestore,e?this._delegate.withConverter(go.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}class _3{constructor(e,n){this._firestore=e,this._delegate=n}get type(){return this._delegate.type}get doc(){return new Xl(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}}class Gm{constructor(e,n){this._firestore=e,this._delegate=n}get query(){return new tn(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(e=>new Xl(this._firestore,e))}docChanges(e){return this._delegate.docChanges(e).map(n=>new _3(this._firestore,n))}forEach(e,n){this._delegate.forEach(r=>{e.call(n,new Xl(this._firestore,r))})}isEqual(e){return qP(this._delegate,e._delegate)}}class Oa extends tn{constructor(e,n){super(e,n),this.firestore=e,this._delegate=n}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){const e=this._delegate.parent;return e?new Bn(this.firestore,e):null}doc(e){try{return e===void 0?new Bn(this.firestore,Sd(this._delegate)):new Bn(this.firestore,Sd(this._delegate,e))}catch(n){throw nn(n,"doc()","CollectionReference.doc()")}}add(e){return r3(this._delegate,e).then(n=>new Bn(this.firestore,n))}isEqual(e){return PP(this._delegate,e._delegate)}withConverter(e){return new Oa(this.firestore,e?this._delegate.withConverter(go.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}function Us(t){return Se(t,Ge)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cw{constructor(...e){this._delegate=new ns(...e)}static documentId(){return new cw(ot.keyField().canonicalString())}isEqual(e){return e=M(e),e instanceof ns?this._delegate._internalPath.isEqual(e._internalPath):!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ns{constructor(e){this._delegate=e}static serverTimestamp(){const e=c3();return e._methodName="FieldValue.serverTimestamp",new Ns(e)}static delete(){const e=a3();return e._methodName="FieldValue.delete",new Ns(e)}static arrayUnion(...e){const n=l3(...e);return n._methodName="FieldValue.arrayUnion",new Ns(n)}static arrayRemove(...e){const n=u3(...e);return n._methodName="FieldValue.arrayRemove",new Ns(n)}static increment(e){const n=h3(e);return n._methodName="FieldValue.increment",new Ns(n)}isEqual(e){return this._delegate.isEqual(e._delegate)}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const y3={Firestore:JP,GeoPoint:rp,Timestamp:Je,Blob:Yl,Transaction:XP,WriteBatch:ZP,DocumentReference:Bn,DocumentSnapshot:Jl,Query:tn,QueryDocumentSnapshot:Xl,QuerySnapshot:Gm,CollectionReference:Oa,FieldPath:cw,FieldValue:Ns,setLogLevel:m3,CACHE_SIZE_UNLIMITED:vQ};function v3(t,e){t.INTERNAL.registerComponent(new Ce("firestore-compat",n=>{const r=n.getProvider("app-compat").getImmediate(),i=n.getProvider("firestore").getImmediate();return e(r,i)},"PUBLIC").setServiceProps(Object.assign({},y3)))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function w3(t){v3(t,(e,n)=>new JP(e,n,new g3)),t.registerVersion(d3,f3)}w3(lt);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const b3="type.googleapis.com/google.protobuf.Int64Value",I3="type.googleapis.com/google.protobuf.UInt64Value";function nD(t,e){const n={};for(const r in t)t.hasOwnProperty(r)&&(n[r]=e(t[r]));return n}function zm(t){if(t==null)return null;if(t instanceof Number&&(t=t.valueOf()),typeof t=="number"&&isFinite(t)||t===!0||t===!1||Object.prototype.toString.call(t)==="[object String]")return t;if(t instanceof Date)return t.toISOString();if(Array.isArray(t))return t.map(e=>zm(e));if(typeof t=="function"||typeof t=="object")return nD(t,e=>zm(e));throw new Error("Data cannot be encoded in JSON: "+t)}function Ad(t){if(t==null)return t;if(t["@type"])switch(t["@type"]){case b3:case I3:{const e=Number(t.value);if(isNaN(e))throw new Error("Data cannot be decoded from JSON: "+t);return e}default:throw new Error("Data cannot be decoded from JSON: "+t)}return Array.isArray(t)?t.map(e=>Ad(e)):typeof t=="function"||typeof t=="object"?nD(t,e=>Ad(e)):t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rD="functions";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IT={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class oa extends ct{constructor(e,n,r){super(`${rD}/${e}`,n||""),this.details=r}}function E3(t){if(t>=200&&t<300)return"ok";switch(t){case 0:return"internal";case 400:return"invalid-argument";case 401:return"unauthenticated";case 403:return"permission-denied";case 404:return"not-found";case 409:return"aborted";case 429:return"resource-exhausted";case 499:return"cancelled";case 500:return"internal";case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline-exceeded"}return"unknown"}function T3(t,e){let n=E3(t),r=n,i;try{const s=e&&e.error;if(s){const o=s.status;if(typeof o=="string"){if(!IT[o])return new oa("internal","internal");n=IT[o],r=o}const a=s.message;typeof a=="string"&&(r=a),i=s.details,i!==void 0&&(i=Ad(i))}}catch{}return n==="ok"?null:new oa(n,r,i)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S3{constructor(e,n,r){this.auth=null,this.messaging=null,this.appCheck=null,this.auth=e.getImmediate({optional:!0}),this.messaging=n.getImmediate({optional:!0}),this.auth||e.get().then(i=>this.auth=i,()=>{}),this.messaging||n.get().then(i=>this.messaging=i,()=>{}),this.appCheck||r.get().then(i=>this.appCheck=i,()=>{})}async getAuthToken(){if(!!this.auth)try{const e=await this.auth.getToken();return e==null?void 0:e.accessToken}catch{return}}async getMessagingToken(){if(!(!this.messaging||!("Notification"in self)||Notification.permission!=="granted"))try{return await this.messaging.getToken()}catch{return}}async getAppCheckToken(){if(this.appCheck){const e=await this.appCheck.getToken();return e.error?null:e.token}return null}async getContext(){const e=await this.getAuthToken(),n=await this.getMessagingToken(),r=await this.getAppCheckToken();return{authToken:e,messagingToken:n,appCheckToken:r}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ET="us-central1";function C3(t){let e=null;return{promise:new Promise((n,r)=>{e=setTimeout(()=>{r(new oa("deadline-exceeded","deadline-exceeded"))},t)}),cancel:()=>{e&&clearTimeout(e)}}}class A3{constructor(e,n,r,i,s=ET,o){this.app=e,this.fetchImpl=o,this.emulatorOrigin=null,this.contextProvider=new S3(n,r,i),this.cancelAllRequests=new Promise(a=>{this.deleteService=()=>Promise.resolve(a())});try{const a=new URL(s);this.customDomain=a.origin,this.region=ET}catch{this.customDomain=null,this.region=s}}_delete(){return this.deleteService()}_url(e){const n=this.app.options.projectId;return this.emulatorOrigin!==null?`${this.emulatorOrigin}/${n}/${this.region}/${e}`:this.customDomain!==null?`${this.customDomain}/${e}`:`https://${this.region}-${n}.cloudfunctions.net/${e}`}}function k3(t,e,n){t.emulatorOrigin=`http://${e}:${n}`}function R3(t,e,n){return r=>D3(t,e,r,n||{})}function N3(t,e,n){return r=>iD(t,e,r,n||{})}async function P3(t,e,n,r){n["Content-Type"]="application/json";let i;try{i=await r(t,{method:"POST",body:JSON.stringify(e),headers:n})}catch{return{status:0,json:null}}let s=null;try{s=await i.json()}catch{}return{status:i.status,json:s}}function D3(t,e,n,r){const i=t._url(e);return iD(t,i,n,r)}async function iD(t,e,n,r){n=zm(n);const i={data:n},s={},o=await t.contextProvider.getContext();o.authToken&&(s.Authorization="Bearer "+o.authToken),o.messagingToken&&(s["Firebase-Instance-ID-Token"]=o.messagingToken),o.appCheckToken!==null&&(s["X-Firebase-AppCheck"]=o.appCheckToken);const a=r.timeout||7e4,c=C3(a),l=await Promise.race([P3(e,i,s,t.fetchImpl),c.promise,t.cancelAllRequests]);if(c.cancel(),!l)throw new oa("cancelled","Firebase Functions instance was deleted.");const u=T3(l.status,l.json);if(u)throw u;if(!l.json)throw new oa("internal","Response is not valid JSON object.");let h=l.json.data;if(typeof h=="undefined"&&(h=l.json.result),typeof h=="undefined")throw new oa("internal","Response is missing data field.");return{data:Ad(h)}}const TT="@firebase/functions",ST="0.8.4";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const O3="auth-internal",x3="app-check-internal",M3="messaging-internal";function L3(t,e){const n=(r,{instanceIdentifier:i})=>{const s=r.getProvider("app").getImmediate(),o=r.getProvider(O3),a=r.getProvider(M3),c=r.getProvider(x3);return new A3(s,o,a,c,i,t)};nt(new Ce(rD,n,"PUBLIC").setMultipleInstances(!0)),Ve(TT,ST,e),Ve(TT,ST,"esm2017")}function CT(t,e,n){k3(M(t),e,n)}function F3(t,e,n){return R3(M(t),e,n)}function U3(t,e,n){return N3(M(t),e,n)}L3(fetch.bind(self));const V3="@firebase/functions-compat",$3="0.2.4";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sD{constructor(e,n){this.app=e,this._delegate=n,this._region=this._delegate.region,this._customDomain=this._delegate.customDomain}httpsCallable(e,n){return F3(this._delegate,e,n)}httpsCallableFromURL(e,n){return U3(this._delegate,e,n)}useFunctionsEmulator(e){const n=e.match("[a-zA-Z]+://([a-zA-Z0-9.-]+)(?::([0-9]+))?");if(n==null)throw new ct("functions","No origin provided to useFunctionsEmulator()");if(n[2]==null)throw new ct("functions","Port missing in origin provided to useFunctionsEmulator()");return CT(this._delegate,n[1],Number(n[2]))}useEmulator(e,n){return CT(this._delegate,e,n)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const B3="us-central1",j3=(t,{instanceIdentifier:e})=>{const n=t.getProvider("app-compat").getImmediate(),r=t.getProvider("functions").getImmediate({identifier:e!=null?e:B3});return new sD(n,r)};function q3(){const t={Functions:sD};lt.INTERNAL.registerComponent(new Ce("functions-compat",j3,"PUBLIC").setServiceProps(t).setMultipleInstances(!0))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */q3();lt.registerVersion(V3,$3);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const W3="/firebase-messaging-sw.js",K3="/firebase-cloud-messaging-push-scope",oD="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",H3="https://fcmregistrations.googleapis.com/v1",aD="google.c.a.c_id",G3="google.c.a.c_l",z3="google.c.a.ts",Q3="google.c.a.e";var AT;(function(t){t[t.DATA_MESSAGE=1]="DATA_MESSAGE",t[t.DISPLAY_NOTIFICATION=3]="DISPLAY_NOTIFICATION"})(AT||(AT={}));/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License"); you may not use this file except
 * in compliance with the License. You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software distributed under the License
 * is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express
 * or implied. See the License for the specific language governing permissions and limitations under
 * the License.
 */var Zl;(function(t){t.PUSH_RECEIVED="push-received",t.NOTIFICATION_CLICKED="notification-clicked"})(Zl||(Zl={}));/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qr(t){const e=new Uint8Array(t);return btoa(String.fromCharCode(...e)).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function Y3(t){const e="=".repeat((4-t.length%4)%4),n=(t+e).replace(/\-/g,"+").replace(/_/g,"/"),r=atob(n),i=new Uint8Array(r.length);for(let s=0;s<r.length;++s)i[s]=r.charCodeAt(s);return i}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rg="fcm_token_details_db",J3=5,kT="fcm_token_object_Store";async function X3(t){if("databases"in indexedDB&&!(await indexedDB.databases()).map(s=>s.name).includes(rg))return null;let e=null;return(await Va(rg,J3,{upgrade:async(r,i,s,o)=>{var a;if(i<2||!r.objectStoreNames.contains(kT))return;const c=o.objectStore(kT),l=await c.index("fcmSenderId").get(t);if(await c.clear(),!!l){if(i===2){const u=l;if(!u.auth||!u.p256dh||!u.endpoint)return;e={token:u.fcmToken,createTime:(a=u.createTime)!==null&&a!==void 0?a:Date.now(),subscriptionOptions:{auth:u.auth,p256dh:u.p256dh,endpoint:u.endpoint,swScope:u.swScope,vapidKey:typeof u.vapidKey=="string"?u.vapidKey:qr(u.vapidKey)}}}else if(i===3){const u=l;e={token:u.fcmToken,createTime:u.createTime,subscriptionOptions:{auth:qr(u.auth),p256dh:qr(u.p256dh),endpoint:u.endpoint,swScope:u.swScope,vapidKey:qr(u.vapidKey)}}}else if(i===4){const u=l;e={token:u.fcmToken,createTime:u.createTime,subscriptionOptions:{auth:qr(u.auth),p256dh:qr(u.p256dh),endpoint:u.endpoint,swScope:u.swScope,vapidKey:qr(u.vapidKey)}}}}}})).close(),await Jo(rg),await Jo("fcm_vapid_details_db"),await Jo("undefined"),Z3(e)?e:null}function Z3(t){if(!t||!t.subscriptionOptions)return!1;const{subscriptionOptions:e}=t;return typeof t.createTime=="number"&&t.createTime>0&&typeof t.token=="string"&&t.token.length>0&&typeof e.auth=="string"&&e.auth.length>0&&typeof e.p256dh=="string"&&e.p256dh.length>0&&typeof e.endpoint=="string"&&e.endpoint.length>0&&typeof e.swScope=="string"&&e.swScope.length>0&&typeof e.vapidKey=="string"&&e.vapidKey.length>0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eY="firebase-messaging-database",tY=1,mo="firebase-messaging-store";let ig=null;function lw(){return ig||(ig=Va(eY,tY,{upgrade:(t,e)=>{switch(e){case 0:t.createObjectStore(mo)}}})),ig}async function cD(t){const e=hw(t),r=await(await lw()).transaction(mo).objectStore(mo).get(e);if(r)return r;{const i=await X3(t.appConfig.senderId);if(i)return await uw(t,i),i}}async function uw(t,e){const n=hw(t),i=(await lw()).transaction(mo,"readwrite");return await i.objectStore(mo).put(e,n),await i.done,e}async function nY(t){const e=hw(t),r=(await lw()).transaction(mo,"readwrite");await r.objectStore(mo).delete(e),await r.done}function hw({appConfig:t}){return t.appId}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rY={["missing-app-config-values"]:'Missing App configuration value: "{$valueName}"',["only-available-in-window"]:"This method is available in a Window context.",["only-available-in-sw"]:"This method is available in a service worker context.",["permission-default"]:"The notification permission was not granted and dismissed instead.",["permission-blocked"]:"The notification permission was not granted and blocked instead.",["unsupported-browser"]:"This browser doesn't support the API's required to use the Firebase SDK.",["indexed-db-unsupported"]:"This browser doesn't support indexedDb.open() (ex. Safari iFrame, Firefox Private Browsing, etc)",["failed-service-worker-registration"]:"We are unable to register the default service worker. {$browserErrorMessage}",["token-subscribe-failed"]:"A problem occurred while subscribing the user to FCM: {$errorInfo}",["token-subscribe-no-token"]:"FCM returned no token when subscribing the user to push.",["token-unsubscribe-failed"]:"A problem occurred while unsubscribing the user from FCM: {$errorInfo}",["token-update-failed"]:"A problem occurred while updating the user from FCM: {$errorInfo}",["token-update-no-token"]:"FCM returned no token when updating the user to push.",["use-sw-after-get-token"]:"The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.",["invalid-sw-registration"]:"The input to useServiceWorker() must be a ServiceWorkerRegistration.",["invalid-bg-handler"]:"The input to setBackgroundMessageHandler() must be a function.",["invalid-vapid-key"]:"The public VAPID key must be a string.",["use-vapid-key-after-get-token"]:"The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used."},hn=new dn("messaging","Messaging",rY);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function iY(t,e){var n;const r=await fw(t),i=uD(e),s={method:"POST",headers:r,body:JSON.stringify(i)};let o;try{o=await(await fetch(dw(t.appConfig),s)).json()}catch(a){throw hn.create("token-subscribe-failed",{errorInfo:(n=a)===null||n===void 0?void 0:n.toString()})}if(o.error){const a=o.error.message;throw hn.create("token-subscribe-failed",{errorInfo:a})}if(!o.token)throw hn.create("token-subscribe-no-token");return o.token}async function sY(t,e){var n;const r=await fw(t),i=uD(e.subscriptionOptions),s={method:"PATCH",headers:r,body:JSON.stringify(i)};let o;try{o=await(await fetch(`${dw(t.appConfig)}/${e.token}`,s)).json()}catch(a){throw hn.create("token-update-failed",{errorInfo:(n=a)===null||n===void 0?void 0:n.toString()})}if(o.error){const a=o.error.message;throw hn.create("token-update-failed",{errorInfo:a})}if(!o.token)throw hn.create("token-update-no-token");return o.token}async function lD(t,e){var n;const r=await fw(t),i={method:"DELETE",headers:r};try{const o=await(await fetch(`${dw(t.appConfig)}/${e}`,i)).json();if(o.error){const a=o.error.message;throw hn.create("token-unsubscribe-failed",{errorInfo:a})}}catch(s){throw hn.create("token-unsubscribe-failed",{errorInfo:(n=s)===null||n===void 0?void 0:n.toString()})}}function dw({projectId:t}){return`${H3}/projects/${t}/registrations`}async function fw({appConfig:t,installations:e}){const n=await e.getToken();return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t.apiKey,"x-goog-firebase-installations-auth":`FIS ${n}`})}function uD({p256dh:t,auth:e,endpoint:n,vapidKey:r}){const i={web:{endpoint:n,auth:e,p256dh:t}};return r!==oD&&(i.web.applicationPubKey=r),i}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oY=7*24*60*60*1e3;async function aY(t){const e=await lY(t.swRegistration,t.vapidKey),n={vapidKey:t.vapidKey,swScope:t.swRegistration.scope,endpoint:e.endpoint,auth:qr(e.getKey("auth")),p256dh:qr(e.getKey("p256dh"))},r=await cD(t.firebaseDependencies);if(r){if(uY(r.subscriptionOptions,n))return Date.now()>=r.createTime+oY?cY(t,{token:r.token,createTime:Date.now(),subscriptionOptions:n}):r.token;try{await lD(t.firebaseDependencies,r.token)}catch(i){console.warn(i)}return RT(t.firebaseDependencies,n)}else return RT(t.firebaseDependencies,n)}async function hD(t){const e=await cD(t.firebaseDependencies);e&&(await lD(t.firebaseDependencies,e.token),await nY(t.firebaseDependencies));const n=await t.swRegistration.pushManager.getSubscription();return n?n.unsubscribe():!0}async function cY(t,e){try{const n=await sY(t.firebaseDependencies,e),r=Object.assign(Object.assign({},e),{token:n,createTime:Date.now()});return await uw(t.firebaseDependencies,r),n}catch(n){throw await hD(t),n}}async function RT(t,e){const r={token:await iY(t,e),createTime:Date.now(),subscriptionOptions:e};return await uw(t,r),r.token}async function lY(t,e){const n=await t.pushManager.getSubscription();return n||t.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:Y3(e)})}function uY(t,e){const n=e.vapidKey===t.vapidKey,r=e.endpoint===t.endpoint,i=e.auth===t.auth,s=e.p256dh===t.p256dh;return n&&r&&i&&s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NT(t){const e={from:t.from,collapseKey:t.collapse_key,messageId:t.fcmMessageId};return hY(e,t),dY(e,t),fY(e,t),e}function hY(t,e){if(!e.notification)return;t.notification={};const n=e.notification.title;n&&(t.notification.title=n);const r=e.notification.body;r&&(t.notification.body=r);const i=e.notification.image;i&&(t.notification.image=i)}function dY(t,e){!e.data||(t.data=e.data)}function fY(t,e){var n,r,i,s,o;if(!e.fcmOptions&&!(!((n=e.notification)===null||n===void 0)&&n.click_action))return;t.fcmOptions={};const a=(i=(r=e.fcmOptions)===null||r===void 0?void 0:r.link)!==null&&i!==void 0?i:(s=e.notification)===null||s===void 0?void 0:s.click_action;a&&(t.fcmOptions.link=a);const c=(o=e.fcmOptions)===null||o===void 0?void 0:o.analytics_label;c&&(t.fcmOptions.analyticsLabel=c)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pY(t){return typeof t=="object"&&!!t&&aD in t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */dD("hts/frbslgigp.ogepscmv/ieo/eaylg","tp:/ieaeogn-agolai.o/1frlglgc/o");dD("AzSCbw63g1R0nCw85jG8","Iaya3yLKwmgvh7cF0q4");function dD(t,e){const n=[];for(let r=0;r<t.length;r++)n.push(t.charAt(r)),r<e.length&&n.push(e.charAt(r));return n.join("")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gY(t){if(!t||!t.options)throw sg("App Configuration Object");if(!t.name)throw sg("App Name");const e=["projectId","apiKey","appId","messagingSenderId"],{options:n}=t;for(const r of e)if(!n[r])throw sg(r);return{appName:t.name,projectId:n.projectId,apiKey:n.apiKey,appId:n.appId,senderId:n.messagingSenderId}}function sg(t){return hn.create("missing-app-config-values",{valueName:t})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mY{constructor(e,n,r){this.deliveryMetricsExportedToBigQueryEnabled=!1,this.onBackgroundMessageHandler=null,this.onMessageHandler=null,this.logEvents=[],this.isLogServiceStarted=!1;const i=gY(e);this.firebaseDependencies={app:e,appConfig:i,installations:n,analyticsProvider:r}}_delete(){return Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function fD(t){var e;try{t.swRegistration=await navigator.serviceWorker.register(W3,{scope:K3}),t.swRegistration.update().catch(()=>{})}catch(n){throw hn.create("failed-service-worker-registration",{browserErrorMessage:(e=n)===null||e===void 0?void 0:e.message})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _Y(t,e){if(!e&&!t.swRegistration&&await fD(t),!(!e&&!!t.swRegistration)){if(!(e instanceof ServiceWorkerRegistration))throw hn.create("invalid-sw-registration");t.swRegistration=e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function yY(t,e){e?t.vapidKey=e:t.vapidKey||(t.vapidKey=oD)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function pD(t,e){if(!navigator)throw hn.create("only-available-in-window");if(Notification.permission==="default"&&await Notification.requestPermission(),Notification.permission!=="granted")throw hn.create("permission-blocked");return await yY(t,e==null?void 0:e.vapidKey),await _Y(t,e==null?void 0:e.serviceWorkerRegistration),aY(t)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function vY(t,e,n){const r=wY(e);(await t.firebaseDependencies.analyticsProvider.get()).logEvent(r,{message_id:n[aD],message_name:n[G3],message_time:n[z3],message_device_time:Math.floor(Date.now()/1e3)})}function wY(t){switch(t){case Zl.NOTIFICATION_CLICKED:return"notification_open";case Zl.PUSH_RECEIVED:return"notification_foreground";default:throw new Error}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function bY(t,e){const n=e.data;if(!n.isFirebaseMessaging)return;t.onMessageHandler&&n.messageType===Zl.PUSH_RECEIVED&&(typeof t.onMessageHandler=="function"?t.onMessageHandler(NT(n)):t.onMessageHandler.next(NT(n)));const r=n.data;pY(r)&&r[Q3]==="1"&&await vY(t,n.messageType,r)}const PT="@firebase/messaging",DT="0.9.16";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IY=t=>{const e=new mY(t.getProvider("app").getImmediate(),t.getProvider("installations-internal").getImmediate(),t.getProvider("analytics-internal"));return navigator.serviceWorker.addEventListener("message",n=>bY(e,n)),e},EY=t=>{const e=t.getProvider("messaging").getImmediate();return{getToken:r=>pD(e,r)}};function TY(){nt(new Ce("messaging",IY,"PUBLIC")),nt(new Ce("messaging-internal",EY,"PRIVATE")),Ve(PT,DT),Ve(PT,DT,"esm2017")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function SY(t){if(!navigator)throw hn.create("only-available-in-window");return t.swRegistration||await fD(t),hD(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function CY(t,e){if(!navigator)throw hn.create("only-available-in-window");return t.onMessageHandler=e,()=>{t.onMessageHandler=null}}async function AY(t,e){return t=M(t),pD(t,e)}function kY(t){return t=M(t),SY(t)}function RY(t,e){return t=M(t),CY(t,e)}TY();/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gD="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",NY="https://fcmregistrations.googleapis.com/v1",mD="FCM_MSG",PY="google.c.a.c_id",DY=3,OY=1;var kd;(function(t){t[t.DATA_MESSAGE=1]="DATA_MESSAGE",t[t.DISPLAY_NOTIFICATION=3]="DISPLAY_NOTIFICATION"})(kd||(kd={}));/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License"); you may not use this file except
 * in compliance with the License. You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software distributed under the License
 * is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express
 * or implied. See the License for the specific language governing permissions and limitations under
 * the License.
 */var Rd;(function(t){t.PUSH_RECEIVED="push-received",t.NOTIFICATION_CLICKED="notification-clicked"})(Rd||(Rd={}));/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wr(t){const e=new Uint8Array(t);return btoa(String.fromCharCode(...e)).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function xY(t){const e="=".repeat((4-t.length%4)%4),n=(t+e).replace(/\-/g,"+").replace(/_/g,"/"),r=atob(n),i=new Uint8Array(r.length);for(let s=0;s<r.length;++s)i[s]=r.charCodeAt(s);return i}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const og="fcm_token_details_db",MY=5,OT="fcm_token_object_Store";async function LY(t){if("databases"in indexedDB&&!(await indexedDB.databases()).map(s=>s.name).includes(og))return null;let e=null;return(await Va(og,MY,{upgrade:async(r,i,s,o)=>{var a;if(i<2||!r.objectStoreNames.contains(OT))return;const c=o.objectStore(OT),l=await c.index("fcmSenderId").get(t);if(await c.clear(),!!l){if(i===2){const u=l;if(!u.auth||!u.p256dh||!u.endpoint)return;e={token:u.fcmToken,createTime:(a=u.createTime)!==null&&a!==void 0?a:Date.now(),subscriptionOptions:{auth:u.auth,p256dh:u.p256dh,endpoint:u.endpoint,swScope:u.swScope,vapidKey:typeof u.vapidKey=="string"?u.vapidKey:Wr(u.vapidKey)}}}else if(i===3){const u=l;e={token:u.fcmToken,createTime:u.createTime,subscriptionOptions:{auth:Wr(u.auth),p256dh:Wr(u.p256dh),endpoint:u.endpoint,swScope:u.swScope,vapidKey:Wr(u.vapidKey)}}}else if(i===4){const u=l;e={token:u.fcmToken,createTime:u.createTime,subscriptionOptions:{auth:Wr(u.auth),p256dh:Wr(u.p256dh),endpoint:u.endpoint,swScope:u.swScope,vapidKey:Wr(u.vapidKey)}}}}}})).close(),await Jo(og),await Jo("fcm_vapid_details_db"),await Jo("undefined"),FY(e)?e:null}function FY(t){if(!t||!t.subscriptionOptions)return!1;const{subscriptionOptions:e}=t;return typeof t.createTime=="number"&&t.createTime>0&&typeof t.token=="string"&&t.token.length>0&&typeof e.auth=="string"&&e.auth.length>0&&typeof e.p256dh=="string"&&e.p256dh.length>0&&typeof e.endpoint=="string"&&e.endpoint.length>0&&typeof e.swScope=="string"&&e.swScope.length>0&&typeof e.vapidKey=="string"&&e.vapidKey.length>0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UY="firebase-messaging-database",VY=1,_o="firebase-messaging-store";let ag=null;function pw(){return ag||(ag=Va(UY,VY,{upgrade:(t,e)=>{switch(e){case 0:t.createObjectStore(_o)}}})),ag}async function gw(t){const e=_w(t),r=await(await pw()).transaction(_o).objectStore(_o).get(e);if(r)return r;{const i=await LY(t.appConfig.senderId);if(i)return await mw(t,i),i}}async function mw(t,e){const n=_w(t),i=(await pw()).transaction(_o,"readwrite");return await i.objectStore(_o).put(e,n),await i.done,e}async function $Y(t){const e=_w(t),r=(await pw()).transaction(_o,"readwrite");await r.objectStore(_o).delete(e),await r.done}function _w({appConfig:t}){return t.appId}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BY={["missing-app-config-values"]:'Missing App configuration value: "{$valueName}"',["only-available-in-window"]:"This method is available in a Window context.",["only-available-in-sw"]:"This method is available in a service worker context.",["permission-default"]:"The notification permission was not granted and dismissed instead.",["permission-blocked"]:"The notification permission was not granted and blocked instead.",["unsupported-browser"]:"This browser doesn't support the API's required to use the Firebase SDK.",["indexed-db-unsupported"]:"This browser doesn't support indexedDb.open() (ex. Safari iFrame, Firefox Private Browsing, etc)",["failed-service-worker-registration"]:"We are unable to register the default service worker. {$browserErrorMessage}",["token-subscribe-failed"]:"A problem occurred while subscribing the user to FCM: {$errorInfo}",["token-subscribe-no-token"]:"FCM returned no token when subscribing the user to push.",["token-unsubscribe-failed"]:"A problem occurred while unsubscribing the user from FCM: {$errorInfo}",["token-update-failed"]:"A problem occurred while updating the user from FCM: {$errorInfo}",["token-update-no-token"]:"FCM returned no token when updating the user to push.",["use-sw-after-get-token"]:"The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.",["invalid-sw-registration"]:"The input to useServiceWorker() must be a ServiceWorkerRegistration.",["invalid-bg-handler"]:"The input to setBackgroundMessageHandler() must be a function.",["invalid-vapid-key"]:"The public VAPID key must be a string.",["use-vapid-key-after-get-token"]:"The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used."},Nr=new dn("messaging","Messaging",BY);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function jY(t,e){var n;const r=await vw(t),i=yD(e),s={method:"POST",headers:r,body:JSON.stringify(i)};let o;try{o=await(await fetch(yw(t.appConfig),s)).json()}catch(a){throw Nr.create("token-subscribe-failed",{errorInfo:(n=a)===null||n===void 0?void 0:n.toString()})}if(o.error){const a=o.error.message;throw Nr.create("token-subscribe-failed",{errorInfo:a})}if(!o.token)throw Nr.create("token-subscribe-no-token");return o.token}async function qY(t,e){var n;const r=await vw(t),i=yD(e.subscriptionOptions),s={method:"PATCH",headers:r,body:JSON.stringify(i)};let o;try{o=await(await fetch(`${yw(t.appConfig)}/${e.token}`,s)).json()}catch(a){throw Nr.create("token-update-failed",{errorInfo:(n=a)===null||n===void 0?void 0:n.toString()})}if(o.error){const a=o.error.message;throw Nr.create("token-update-failed",{errorInfo:a})}if(!o.token)throw Nr.create("token-update-no-token");return o.token}async function _D(t,e){var n;const r=await vw(t),i={method:"DELETE",headers:r};try{const o=await(await fetch(`${yw(t.appConfig)}/${e}`,i)).json();if(o.error){const a=o.error.message;throw Nr.create("token-unsubscribe-failed",{errorInfo:a})}}catch(s){throw Nr.create("token-unsubscribe-failed",{errorInfo:(n=s)===null||n===void 0?void 0:n.toString()})}}function yw({projectId:t}){return`${NY}/projects/${t}/registrations`}async function vw({appConfig:t,installations:e}){const n=await e.getToken();return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t.apiKey,"x-goog-firebase-installations-auth":`FIS ${n}`})}function yD({p256dh:t,auth:e,endpoint:n,vapidKey:r}){const i={web:{endpoint:n,auth:e,p256dh:t}};return r!==gD&&(i.web.applicationPubKey=r),i}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WY=7*24*60*60*1e3;async function KY(t){const e=await GY(t.swRegistration,t.vapidKey),n={vapidKey:t.vapidKey,swScope:t.swRegistration.scope,endpoint:e.endpoint,auth:Wr(e.getKey("auth")),p256dh:Wr(e.getKey("p256dh"))},r=await gw(t.firebaseDependencies);if(r){if(zY(r.subscriptionOptions,n))return Date.now()>=r.createTime+WY?HY(t,{token:r.token,createTime:Date.now(),subscriptionOptions:n}):r.token;try{await _D(t.firebaseDependencies,r.token)}catch(i){console.warn(i)}return xT(t.firebaseDependencies,n)}else return xT(t.firebaseDependencies,n)}async function Qm(t){const e=await gw(t.firebaseDependencies);e&&(await _D(t.firebaseDependencies,e.token),await $Y(t.firebaseDependencies));const n=await t.swRegistration.pushManager.getSubscription();return n?n.unsubscribe():!0}async function HY(t,e){try{const n=await qY(t.firebaseDependencies,e),r=Object.assign(Object.assign({},e),{token:n,createTime:Date.now()});return await mw(t.firebaseDependencies,r),n}catch(n){throw await Qm(t),n}}async function xT(t,e){const r={token:await jY(t,e),createTime:Date.now(),subscriptionOptions:e};return await mw(t,r),r.token}async function GY(t,e){const n=await t.pushManager.getSubscription();return n||t.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:xY(e)})}function zY(t,e){const n=e.vapidKey===t.vapidKey,r=e.endpoint===t.endpoint,i=e.auth===t.auth,s=e.p256dh===t.p256dh;return n&&r&&i&&s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function QY(t){const e={from:t.from,collapseKey:t.collapse_key,messageId:t.fcmMessageId};return YY(e,t),JY(e,t),XY(e,t),e}function YY(t,e){if(!e.notification)return;t.notification={};const n=e.notification.title;n&&(t.notification.title=n);const r=e.notification.body;r&&(t.notification.body=r);const i=e.notification.image;i&&(t.notification.image=i)}function JY(t,e){!e.data||(t.data=e.data)}function XY(t,e){var n,r,i,s,o;if(!e.fcmOptions&&!(!((n=e.notification)===null||n===void 0)&&n.click_action))return;t.fcmOptions={};const a=(i=(r=e.fcmOptions)===null||r===void 0?void 0:r.link)!==null&&i!==void 0?i:(s=e.notification)===null||s===void 0?void 0:s.click_action;a&&(t.fcmOptions.link=a);const c=(o=e.fcmOptions)===null||o===void 0?void 0:o.analytics_label;c&&(t.fcmOptions.analyticsLabel=c)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ZY(t){return typeof t=="object"&&!!t&&PY in t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function e5(t){return new Promise(e=>{setTimeout(e,t)})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */vD("hts/frbslgigp.ogepscmv/ieo/eaylg","tp:/ieaeogn-agolai.o/1frlglgc/o");vD("AzSCbw63g1R0nCw85jG8","Iaya3yLKwmgvh7cF0q4");async function t5(t,e){const n=n5(e,await t.firebaseDependencies.installations.getId());r5(t,n)}function n5(t,e){var n,r;const i={};return t.from&&(i.project_number=t.from),t.fcmMessageId&&(i.message_id=t.fcmMessageId),i.instance_id=e,t.notification?i.message_type=kd.DISPLAY_NOTIFICATION.toString():i.message_type=kd.DATA_MESSAGE.toString(),i.sdk_platform=DY.toString(),i.package_name=self.origin.replace(/(^\w+:|^)\/\//,""),t.collapse_key&&(i.collapse_key=t.collapse_key),i.event=OY.toString(),!((n=t.fcmOptions)===null||n===void 0)&&n.analytics_label&&(i.analytics_label=(r=t.fcmOptions)===null||r===void 0?void 0:r.analytics_label),i}function r5(t,e){const n={};n.event_time_ms=Math.floor(Date.now()).toString(),n.source_extension_json_proto3=JSON.stringify(e),t.logEvents.push(n)}function vD(t,e){const n=[];for(let r=0;r<t.length;r++)n.push(t.charAt(r)),r<e.length&&n.push(e.charAt(r));return n.join("")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function i5(t,e){var n,r;const{newSubscription:i}=t;if(!i){await Qm(e);return}const s=await gw(e.firebaseDependencies);await Qm(e),e.vapidKey=(r=(n=s==null?void 0:s.subscriptionOptions)===null||n===void 0?void 0:n.vapidKey)!==null&&r!==void 0?r:gD,await KY(e)}async function s5(t,e){const n=c5(t);if(!n)return;e.deliveryMetricsExportedToBigQueryEnabled&&await t5(e,n);const r=await wD();if(u5(r))return h5(r,n);if(n.notification&&await d5(a5(n)),!!e&&e.onBackgroundMessageHandler){const i=QY(n);typeof e.onBackgroundMessageHandler=="function"?await e.onBackgroundMessageHandler(i):e.onBackgroundMessageHandler.next(i)}}async function o5(t){var e,n;const r=(n=(e=t.notification)===null||e===void 0?void 0:e.data)===null||n===void 0?void 0:n[mD];if(r){if(t.action)return}else return;t.stopImmediatePropagation(),t.notification.close();const i=f5(r);if(!i)return;const s=new URL(i,self.location.href),o=new URL(self.location.origin);if(s.host!==o.host)return;let a=await l5(s);if(a?a=await a.focus():(a=await self.clients.openWindow(i),await e5(3e3)),!!a)return r.messageType=Rd.NOTIFICATION_CLICKED,r.isFirebaseMessaging=!0,a.postMessage(r)}function a5(t){const e=Object.assign({},t.notification);return e.data={[mD]:t},e}function c5({data:t}){if(!t)return null;try{return t.json()}catch{return null}}async function l5(t){const e=await wD();for(const n of e){const r=new URL(n.url,self.location.href);if(t.host===r.host)return n}return null}function u5(t){return t.some(e=>e.visibilityState==="visible"&&!e.url.startsWith("chrome-extension://"))}function h5(t,e){e.isFirebaseMessaging=!0,e.messageType=Rd.PUSH_RECEIVED;for(const n of t)n.postMessage(e)}function wD(){return self.clients.matchAll({type:"window",includeUncontrolled:!0})}function d5(t){var e;const{actions:n}=t,{maxActions:r}=Notification;return n&&r&&n.length>r&&console.warn(`This browser only supports ${r} actions. The remaining actions will not be displayed.`),self.registration.showNotification((e=t.title)!==null&&e!==void 0?e:"",t)}function f5(t){var e,n,r;const i=(n=(e=t.fcmOptions)===null||e===void 0?void 0:e.link)!==null&&n!==void 0?n:(r=t.notification)===null||r===void 0?void 0:r.click_action;return i||(ZY(t.data)?self.location.origin:null)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function p5(t){if(!t||!t.options)throw cg("App Configuration Object");if(!t.name)throw cg("App Name");const e=["projectId","apiKey","appId","messagingSenderId"],{options:n}=t;for(const r of e)if(!n[r])throw cg(r);return{appName:t.name,projectId:n.projectId,apiKey:n.apiKey,appId:n.appId,senderId:n.messagingSenderId}}function cg(t){return Nr.create("missing-app-config-values",{valueName:t})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g5{constructor(e,n,r){this.deliveryMetricsExportedToBigQueryEnabled=!1,this.onBackgroundMessageHandler=null,this.onMessageHandler=null,this.logEvents=[],this.isLogServiceStarted=!1;const i=p5(e);this.firebaseDependencies={app:e,appConfig:i,installations:n,analyticsProvider:r}}_delete(){return Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const m5=t=>{const e=new g5(t.getProvider("app").getImmediate(),t.getProvider("installations-internal").getImmediate(),t.getProvider("analytics-internal"));return self.addEventListener("push",n=>{n.waitUntil(s5(n,e))}),self.addEventListener("pushsubscriptionchange",n=>{n.waitUntil(i5(n,e))}),self.addEventListener("notificationclick",n=>{n.waitUntil(o5(n))}),e};function _5(){nt(new Ce("messaging-sw",m5,"PUBLIC"))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function y5(t,e){if(self.document!==void 0)throw Nr.create("only-available-in-sw");return t.onBackgroundMessageHandler=e,()=>{t.onBackgroundMessageHandler=null}}function v5(t,e){return t=M(t),y5(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */_5();const w5="@firebase/messaging-compat",b5="0.1.16";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function I5(){return self&&"ServiceWorkerGlobalScope"in self?T5():E5()}function E5(){return typeof window!="undefined"&&bn()&&Qd()&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")}function T5(){return bn()&&"PushManager"in self&&"Notification"in self&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")}class MT{constructor(e,n){this.app=e,this._delegate=n,this.app=e,this._delegate=n}async getToken(e){return AY(this._delegate,e)}async deleteToken(){return kY(this._delegate)}onMessage(e){return RY(this._delegate,e)}onBackgroundMessage(e){return v5(this._delegate,e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const S5=t=>self&&"ServiceWorkerGlobalScope"in self?new MT(t.getProvider("app-compat").getImmediate(),t.getProvider("messaging-sw").getImmediate()):new MT(t.getProvider("app-compat").getImmediate(),t.getProvider("messaging").getImmediate()),C5={isSupported:I5};function A5(){lt.INTERNAL.registerComponent(new Ce("messaging-compat",S5,"PUBLIC").setServiceProps(C5))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */A5();lt.registerVersion(w5,b5);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bD="firebasestorage.googleapis.com",ID="storageBucket",k5=2*60*1e3,R5=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class st extends ct{constructor(e,n){super(lg(e),`Firebase Storage: ${n} (${lg(e)})`),this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,st.prototype)}_codeEquals(e){return lg(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}function lg(t){return"storage/"+t}function ww(){const t="An unknown error occurred, please check the error payload for server response.";return new st("unknown",t)}function N5(t){return new st("object-not-found","Object '"+t+"' does not exist.")}function P5(t){return new st("quota-exceeded","Quota for bucket '"+t+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function D5(){const t="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new st("unauthenticated",t)}function O5(){return new st("unauthorized-app","This app does not have permission to access Firebase Storage on this project.")}function x5(t){return new st("unauthorized","User does not have permission to access '"+t+"'.")}function M5(){return new st("retry-limit-exceeded","Max retry time for operation exceeded, please try again.")}function ED(){return new st("canceled","User canceled the upload/download.")}function L5(t){return new st("invalid-url","Invalid URL '"+t+"'.")}function F5(t){return new st("invalid-default-bucket","Invalid default bucket '"+t+"'.")}function U5(){return new st("no-default-bucket","No default bucket found. Did you set the '"+ID+"' property when initializing the app?")}function TD(){return new st("cannot-slice-blob","Cannot slice blob for upload. Please retry the upload.")}function V5(){return new st("server-file-wrong-size","Server recorded incorrect upload file size, please retry the upload.")}function $5(){return new st("no-download-url","The given file does not have any download URLs.")}function aa(t){return new st("invalid-argument",t)}function SD(){return new st("app-deleted","The Firebase app was deleted.")}function CD(t){return new st("invalid-root-operation","The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function Xc(t,e){return new st("invalid-format","String does not match format '"+t+"': "+e)}function Ic(t){throw new st("internal-error","Internal error: "+t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qt{constructor(e,n){this.bucket=e,this.path_=n}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,n){let r;try{r=Qt.makeFromUrl(e,n)}catch{return new Qt(e,"")}if(r.path==="")return r;throw F5(e)}static makeFromUrl(e,n){let r=null;const i="([A-Za-z0-9.\\-_]+)";function s(E){E.path.charAt(E.path.length-1)==="/"&&(E.path_=E.path_.slice(0,-1))}const o="(/(.*))?$",a=new RegExp("^gs://"+i+o,"i"),c={bucket:1,path:3};function l(E){E.path_=decodeURIComponent(E.path)}const u="v[A-Za-z0-9_]+",h=n.replace(/[.]/g,"\\."),d="(/([^?#]*).*)?$",f=new RegExp(`^https?://${h}/${u}/b/${i}/o${d}`,"i"),g={bucket:1,path:3},v=n===bD?"(?:storage.googleapis.com|storage.cloud.google.com)":n,I="([^?#]*)",S=new RegExp(`^https?://${v}/${i}/${I}`,"i"),R=[{regex:a,indices:c,postModify:s},{regex:f,indices:g,postModify:l},{regex:S,indices:{bucket:1,path:2},postModify:l}];for(let E=0;E<R.length;E++){const p=R[E],w=p.regex.exec(e);if(w){const y=w[p.indices.bucket];let m=w[p.indices.path];m||(m=""),r=new Qt(y,m),p.postModify(r);break}}if(r==null)throw L5(e);return r}}class B5{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function j5(t,e,n){let r=1,i=null,s=null,o=!1,a=0;function c(){return a===2}let l=!1;function u(...I){l||(l=!0,e.apply(null,I))}function h(I){i=setTimeout(()=>{i=null,t(f,c())},I)}function d(){s&&clearTimeout(s)}function f(I,...S){if(l){d();return}if(I){d(),u.call(null,I,...S);return}if(c()||o){d(),u.call(null,I,...S);return}r<64&&(r*=2);let R;a===1?(a=2,R=0):R=(r+Math.random())*1e3,h(R)}let g=!1;function v(I){g||(g=!0,d(),!l&&(i!==null?(I||(a=2),clearTimeout(i),h(0)):I||(a=1)))}return h(0),s=setTimeout(()=>{o=!0,v(!0)},n),v}function q5(t){t(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function W5(t){return t!==void 0}function K5(t){return typeof t=="function"}function H5(t){return typeof t=="object"&&!Array.isArray(t)}function lp(t){return typeof t=="string"||t instanceof String}function LT(t){return bw()&&t instanceof Blob}function bw(){return typeof Blob!="undefined"}function Ym(t,e,n,r){if(r<e)throw aa(`Invalid value for '${t}'. Expected ${e} or greater.`);if(r>n)throw aa(`Invalid value for '${t}'. Expected ${n} or less.`)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ds(t,e,n){let r=e;return n==null&&(r=`https://${e}`),`${n}://${r}/v0${t}`}function AD(t){const e=encodeURIComponent;let n="?";for(const r in t)if(t.hasOwnProperty(r)){const i=e(r)+"="+e(t[r]);n=n+i+"&"}return n=n.slice(0,-1),n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ks;(function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"})(Ks||(Ks={}));/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G5{constructor(e,n,r,i,s,o,a,c,l,u,h){this.url_=e,this.method_=n,this.headers_=r,this.body_=i,this.successCodes_=s,this.additionalRetryCodes_=o,this.callback_=a,this.errorCallback_=c,this.timeout_=l,this.progressCallback_=u,this.connectionFactory_=h,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((d,f)=>{this.resolve_=d,this.reject_=f,this.start_()})}start_(){const e=(r,i)=>{if(i){r(!1,new sh(!1,null,!0));return}const s=this.connectionFactory_();this.pendingConnection_=s;const o=a=>{const c=a.loaded,l=a.lengthComputable?a.total:-1;this.progressCallback_!==null&&this.progressCallback_(c,l)};this.progressCallback_!==null&&s.addUploadProgressListener(o),s.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&s.removeUploadProgressListener(o),this.pendingConnection_=null;const a=s.getErrorCode()===Ks.NO_ERROR,c=s.getStatus();if(!a||this.isRetryStatusCode_(c)){const u=s.getErrorCode()===Ks.ABORT;r(!1,new sh(!1,null,u));return}const l=this.successCodes_.indexOf(c)!==-1;r(!0,new sh(l,s))})},n=(r,i)=>{const s=this.resolve_,o=this.reject_,a=i.connection;if(i.wasSuccessCode)try{const c=this.callback_(a,a.getResponse());W5(c)?s(c):s()}catch(c){o(c)}else if(a!==null){const c=ww();c.serverResponse=a.getErrorText(),this.errorCallback_?o(this.errorCallback_(a,c)):o(c)}else if(i.canceled){const c=this.appDelete_?SD():ED();o(c)}else{const c=M5();o(c)}};this.canceled_?n(!1,new sh(!1,null,!0)):this.backoffId_=j5(e,n,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&q5(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}isRetryStatusCode_(e){const n=e>=500&&e<600,i=[408,429].indexOf(e)!==-1,s=this.additionalRetryCodes_.indexOf(e)!==-1;return n||i||s}}class sh{constructor(e,n,r){this.wasSuccessCode=e,this.connection=n,this.canceled=!!r}}function z5(t,e){e!==null&&e.length>0&&(t.Authorization="Firebase "+e)}function Q5(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(e!=null?e:"AppManager")}function Y5(t,e){e&&(t["X-Firebase-GMPID"]=e)}function J5(t,e){e!==null&&(t["X-Firebase-AppCheck"]=e)}function X5(t,e,n,r,i,s){const o=AD(t.urlParams),a=t.url+o,c=Object.assign({},t.headers);return Y5(c,e),z5(c,n),Q5(c,s),J5(c,r),new G5(a,t.method,c,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,i)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Z5(){return typeof BlobBuilder!="undefined"?BlobBuilder:typeof WebKitBlobBuilder!="undefined"?WebKitBlobBuilder:void 0}function eJ(...t){const e=Z5();if(e!==void 0){const n=new e;for(let r=0;r<t.length;r++)n.append(t[r]);return n.getBlob()}else{if(bw())return new Blob(t);throw new st("unsupported-environment","This browser doesn't seem to support creating Blobs")}}function tJ(t,e,n){return t.webkitSlice?t.webkitSlice(e,n):t.mozSlice?t.mozSlice(e,n):t.slice?t.slice(e,n):null}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nJ(t){return atob(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jn={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class ug{constructor(e,n){this.data=e,this.contentType=n||null}}function kD(t,e){switch(t){case jn.RAW:return new ug(RD(e));case jn.BASE64:case jn.BASE64URL:return new ug(ND(t,e));case jn.DATA_URL:return new ug(iJ(e),sJ(e))}throw ww()}function RD(t){const e=[];for(let n=0;n<t.length;n++){let r=t.charCodeAt(n);if(r<=127)e.push(r);else if(r<=2047)e.push(192|r>>6,128|r&63);else if((r&64512)===55296)if(!(n<t.length-1&&(t.charCodeAt(n+1)&64512)===56320))e.push(239,191,189);else{const s=r,o=t.charCodeAt(++n);r=65536|(s&1023)<<10|o&1023,e.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|r&63)}else(r&64512)===56320?e.push(239,191,189):e.push(224|r>>12,128|r>>6&63,128|r&63)}return new Uint8Array(e)}function rJ(t){let e;try{e=decodeURIComponent(t)}catch{throw Xc(jn.DATA_URL,"Malformed data URL.")}return RD(e)}function ND(t,e){switch(t){case jn.BASE64:{const i=e.indexOf("-")!==-1,s=e.indexOf("_")!==-1;if(i||s)throw Xc(t,"Invalid character '"+(i?"-":"_")+"' found: is it base64url encoded?");break}case jn.BASE64URL:{const i=e.indexOf("+")!==-1,s=e.indexOf("/")!==-1;if(i||s)throw Xc(t,"Invalid character '"+(i?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let n;try{n=nJ(e)}catch{throw Xc(t,"Invalid character found")}const r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r}class PD{constructor(e){this.base64=!1,this.contentType=null;const n=e.match(/^data:([^,]+)?,/);if(n===null)throw Xc(jn.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const r=n[1]||null;r!=null&&(this.base64=oJ(r,";base64"),this.contentType=this.base64?r.substring(0,r.length-7):r),this.rest=e.substring(e.indexOf(",")+1)}}function iJ(t){const e=new PD(t);return e.base64?ND(jn.BASE64,e.rest):rJ(e.rest)}function sJ(t){return new PD(t).contentType}function oJ(t,e){return t.length>=e.length?t.substring(t.length-e.length)===e:!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gr{constructor(e,n){let r=0,i="";LT(e)?(this.data_=e,r=e.size,i=e.type):e instanceof ArrayBuffer?(n?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),r=this.data_.length):e instanceof Uint8Array&&(n?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),r=e.length),this.size_=r,this.type_=i}size(){return this.size_}type(){return this.type_}slice(e,n){if(LT(this.data_)){const r=this.data_,i=tJ(r,e,n);return i===null?null:new Gr(i)}else{const r=new Uint8Array(this.data_.buffer,e,n-e);return new Gr(r,!0)}}static getBlob(...e){if(bw()){const n=e.map(r=>r instanceof Gr?r.data_:r);return new Gr(eJ.apply(null,n))}else{const n=e.map(o=>lp(o)?kD(jn.RAW,o).data:o.data_);let r=0;n.forEach(o=>{r+=o.byteLength});const i=new Uint8Array(r);let s=0;return n.forEach(o=>{for(let a=0;a<o.length;a++)i[s++]=o[a]}),new Gr(i,!0)}}uploadData(){return this.data_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Iw(t){let e;try{e=JSON.parse(t)}catch{return null}return H5(e)?e:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aJ(t){if(t.length===0)return null;const e=t.lastIndexOf("/");return e===-1?"":t.slice(0,e)}function cJ(t,e){const n=e.split("/").filter(r=>r.length>0).join("/");return t.length===0?n:t+"/"+n}function DD(t){const e=t.lastIndexOf("/",t.length-2);return e===-1?t:t.slice(e+1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lJ(t,e){return e}class Zt{constructor(e,n,r,i){this.server=e,this.local=n||e,this.writable=!!r,this.xform=i||lJ}}let oh=null;function uJ(t){return!lp(t)||t.length<2?t:DD(t)}function up(){if(oh)return oh;const t=[];t.push(new Zt("bucket")),t.push(new Zt("generation")),t.push(new Zt("metageneration")),t.push(new Zt("name","fullPath",!0));function e(s,o){return uJ(o)}const n=new Zt("name");n.xform=e,t.push(n);function r(s,o){return o!==void 0?Number(o):o}const i=new Zt("size");return i.xform=r,t.push(i),t.push(new Zt("timeCreated")),t.push(new Zt("updated")),t.push(new Zt("md5Hash",null,!0)),t.push(new Zt("cacheControl",null,!0)),t.push(new Zt("contentDisposition",null,!0)),t.push(new Zt("contentEncoding",null,!0)),t.push(new Zt("contentLanguage",null,!0)),t.push(new Zt("contentType",null,!0)),t.push(new Zt("metadata","customMetadata",!0)),oh=t,oh}function hJ(t,e){function n(){const r=t.bucket,i=t.fullPath,s=new Qt(r,i);return e._makeStorageReference(s)}Object.defineProperty(t,"ref",{get:n})}function dJ(t,e,n){const r={};r.type="file";const i=n.length;for(let s=0;s<i;s++){const o=n[s];r[o.local]=o.xform(r,e[o.server])}return hJ(r,t),r}function OD(t,e,n){const r=Iw(e);return r===null?null:dJ(t,r,n)}function fJ(t,e,n,r){const i=Iw(e);if(i===null||!lp(i.downloadTokens))return null;const s=i.downloadTokens;if(s.length===0)return null;const o=encodeURIComponent;return s.split(",").map(l=>{const u=t.bucket,h=t.fullPath,d="/b/"+o(u)+"/o/"+o(h),f=ds(d,n,r),g=AD({alt:"media",token:l});return f+g})[0]}function Ew(t,e){const n={},r=e.length;for(let i=0;i<r;i++){const s=e[i];s.writable&&(n[s.server]=t[s.local])}return JSON.stringify(n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FT="prefixes",UT="items";function pJ(t,e,n){const r={prefixes:[],items:[],nextPageToken:n.nextPageToken};if(n[FT])for(const i of n[FT]){const s=i.replace(/\/$/,""),o=t._makeStorageReference(new Qt(e,s));r.prefixes.push(o)}if(n[UT])for(const i of n[UT]){const s=t._makeStorageReference(new Qt(e,i.name));r.items.push(s)}return r}function gJ(t,e,n){const r=Iw(n);return r===null?null:pJ(t,e,r)}class gi{constructor(e,n,r,i){this.url=e,this.method=n,this.handler=r,this.timeout=i,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pr(t){if(!t)throw ww()}function hp(t,e){function n(r,i){const s=OD(t,i,e);return Pr(s!==null),s}return n}function mJ(t,e){function n(r,i){const s=gJ(t,e,i);return Pr(s!==null),s}return n}function _J(t,e){function n(r,i){const s=OD(t,i,e);return Pr(s!==null),fJ(s,i,t.host,t._protocol)}return n}function ic(t){function e(n,r){let i;return n.getStatus()===401?n.getErrorText().includes("Firebase App Check token is invalid")?i=O5():i=D5():n.getStatus()===402?i=P5(t.bucket):n.getStatus()===403?i=x5(t.path):i=r,i.serverResponse=r.serverResponse,i}return e}function dp(t){const e=ic(t);function n(r,i){let s=e(r,i);return r.getStatus()===404&&(s=N5(t.path)),s.serverResponse=i.serverResponse,s}return n}function xD(t,e,n){const r=e.fullServerUrl(),i=ds(r,t.host,t._protocol),s="GET",o=t.maxOperationRetryTime,a=new gi(i,s,hp(t,n),o);return a.errorHandler=dp(e),a}function yJ(t,e,n,r,i){const s={};e.isRoot?s.prefix="":s.prefix=e.path+"/",n&&n.length>0&&(s.delimiter=n),r&&(s.pageToken=r),i&&(s.maxResults=i);const o=e.bucketOnlyServerUrl(),a=ds(o,t.host,t._protocol),c="GET",l=t.maxOperationRetryTime,u=new gi(a,c,mJ(t,e.bucket),l);return u.urlParams=s,u.errorHandler=ic(e),u}function vJ(t,e,n){const r=e.fullServerUrl(),i=ds(r,t.host,t._protocol),s="GET",o=t.maxOperationRetryTime,a=new gi(i,s,_J(t,n),o);return a.errorHandler=dp(e),a}function wJ(t,e,n,r){const i=e.fullServerUrl(),s=ds(i,t.host,t._protocol),o="PATCH",a=Ew(n,r),c={"Content-Type":"application/json; charset=utf-8"},l=t.maxOperationRetryTime,u=new gi(s,o,hp(t,r),l);return u.headers=c,u.body=a,u.errorHandler=dp(e),u}function bJ(t,e){const n=e.fullServerUrl(),r=ds(n,t.host,t._protocol),i="DELETE",s=t.maxOperationRetryTime;function o(c,l){}const a=new gi(r,i,o,s);return a.successCodes=[200,204],a.errorHandler=dp(e),a}function IJ(t,e){return t&&t.contentType||e&&e.type()||"application/octet-stream"}function MD(t,e,n){const r=Object.assign({},n);return r.fullPath=t.path,r.size=e.size(),r.contentType||(r.contentType=IJ(null,e)),r}function EJ(t,e,n,r,i){const s=e.bucketOnlyServerUrl(),o={"X-Goog-Upload-Protocol":"multipart"};function a(){let R="";for(let E=0;E<2;E++)R=R+Math.random().toString().slice(2);return R}const c=a();o["Content-Type"]="multipart/related; boundary="+c;const l=MD(e,r,i),u=Ew(l,n),h="--"+c+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+u+`\r
--`+c+`\r
Content-Type: `+l.contentType+`\r
\r
`,d=`\r
--`+c+"--",f=Gr.getBlob(h,r,d);if(f===null)throw TD();const g={name:l.fullPath},v=ds(s,t.host,t._protocol),I="POST",S=t.maxUploadRetryTime,k=new gi(v,I,hp(t,n),S);return k.urlParams=g,k.headers=o,k.body=f.uploadData(),k.errorHandler=ic(e),k}class Nd{constructor(e,n,r,i){this.current=e,this.total=n,this.finalized=!!r,this.metadata=i||null}}function Tw(t,e){let n=null;try{n=t.getResponseHeader("X-Goog-Upload-Status")}catch{Pr(!1)}return Pr(!!n&&(e||["active"]).indexOf(n)!==-1),n}function TJ(t,e,n,r,i){const s=e.bucketOnlyServerUrl(),o=MD(e,r,i),a={name:o.fullPath},c=ds(s,t.host,t._protocol),l="POST",u={"X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${r.size()}`,"X-Goog-Upload-Header-Content-Type":o.contentType,"Content-Type":"application/json; charset=utf-8"},h=Ew(o,n),d=t.maxUploadRetryTime;function f(v){Tw(v);let I;try{I=v.getResponseHeader("X-Goog-Upload-URL")}catch{Pr(!1)}return Pr(lp(I)),I}const g=new gi(c,l,f,d);return g.urlParams=a,g.headers=u,g.body=h,g.errorHandler=ic(e),g}function SJ(t,e,n,r){const i={"X-Goog-Upload-Command":"query"};function s(l){const u=Tw(l,["active","final"]);let h=null;try{h=l.getResponseHeader("X-Goog-Upload-Size-Received")}catch{Pr(!1)}h||Pr(!1);const d=Number(h);return Pr(!isNaN(d)),new Nd(d,r.size(),u==="final")}const o="POST",a=t.maxUploadRetryTime,c=new gi(n,o,s,a);return c.headers=i,c.errorHandler=ic(e),c}const VT=256*1024;function CJ(t,e,n,r,i,s,o,a){const c=new Nd(0,0);if(o?(c.current=o.current,c.total=o.total):(c.current=0,c.total=r.size()),r.size()!==c.total)throw V5();const l=c.total-c.current;let u=l;i>0&&(u=Math.min(u,i));const h=c.current,d=h+u,g={"X-Goog-Upload-Command":u===l?"upload, finalize":"upload","X-Goog-Upload-Offset":`${c.current}`},v=r.slice(h,d);if(v===null)throw TD();function I(E,p){const w=Tw(E,["active","final"]),y=c.current+u,m=r.size();let U;return w==="final"?U=hp(e,s)(E,p):U=null,new Nd(y,m,w==="final",U)}const S="POST",k=e.maxUploadRetryTime,R=new gi(n,S,I,k);return R.headers=g,R.body=v.uploadData(),R.progressCallback=a||null,R.errorHandler=ic(t),R}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AJ={STATE_CHANGED:"state_changed"},rn={RUNNING:"running",PAUSED:"paused",SUCCESS:"success",CANCELED:"canceled",ERROR:"error"};function hg(t){switch(t){case"running":case"pausing":case"canceling":return rn.RUNNING;case"paused":return rn.PAUSED;case"success":return rn.SUCCESS;case"canceled":return rn.CANCELED;case"error":return rn.ERROR;default:return rn.ERROR}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kJ{constructor(e,n,r){if(K5(e)||n!=null||r!=null)this.next=e,this.error=n!=null?n:void 0,this.complete=r!=null?r:void 0;else{const s=e;this.next=s.next,this.error=s.error,this.complete=s.complete}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $o(t){return(...e)=>{Promise.resolve().then(()=>t(...e))}}class RJ{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=Ks.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=Ks.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=Ks.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,n,r,i){if(this.sent_)throw Ic("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(n,e,!0),i!==void 0)for(const s in i)i.hasOwnProperty(s)&&this.xhr_.setRequestHeader(s,i[s].toString());return r!==void 0?this.xhr_.send(r):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw Ic("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw Ic("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw Ic("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw Ic("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class NJ extends RJ{initXhr(){this.xhr_.responseType="text"}}function Ir(){return new NJ}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LD{constructor(e,n,r=null){this._transferred=0,this._needToFetchStatus=!1,this._needToFetchMetadata=!1,this._observers=[],this._error=void 0,this._uploadUrl=void 0,this._request=void 0,this._chunkMultiplier=1,this._resolve=void 0,this._reject=void 0,this._ref=e,this._blob=n,this._metadata=r,this._mappings=up(),this._resumable=this._shouldDoResumable(this._blob),this._state="running",this._errorHandler=i=>{this._request=void 0,this._chunkMultiplier=1,i._codeEquals("canceled")?(this._needToFetchStatus=!0,this.completeTransitions_()):(this._error=i,this._transition("error"))},this._metadataErrorHandler=i=>{this._request=void 0,i._codeEquals("canceled")?this.completeTransitions_():(this._error=i,this._transition("error"))},this._promise=new Promise((i,s)=>{this._resolve=i,this._reject=s,this._start()}),this._promise.then(null,()=>{})}_makeProgressCallback(){const e=this._transferred;return n=>this._updateProgress(e+n)}_shouldDoResumable(e){return e.size()>256*1024}_start(){this._state==="running"&&this._request===void 0&&(this._resumable?this._uploadUrl===void 0?this._createResumable():this._needToFetchStatus?this._fetchStatus():this._needToFetchMetadata?this._fetchMetadata():this._continueUpload():this._oneShotUpload())}_resolveToken(e){Promise.all([this._ref.storage._getAuthToken(),this._ref.storage._getAppCheckToken()]).then(([n,r])=>{switch(this._state){case"running":e(n,r);break;case"canceling":this._transition("canceled");break;case"pausing":this._transition("paused");break}})}_createResumable(){this._resolveToken((e,n)=>{const r=TJ(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),i=this._ref.storage._makeRequest(r,Ir,e,n);this._request=i,i.getPromise().then(s=>{this._request=void 0,this._uploadUrl=s,this._needToFetchStatus=!1,this.completeTransitions_()},this._errorHandler)})}_fetchStatus(){const e=this._uploadUrl;this._resolveToken((n,r)=>{const i=SJ(this._ref.storage,this._ref._location,e,this._blob),s=this._ref.storage._makeRequest(i,Ir,n,r);this._request=s,s.getPromise().then(o=>{o=o,this._request=void 0,this._updateProgress(o.current),this._needToFetchStatus=!1,o.finalized&&(this._needToFetchMetadata=!0),this.completeTransitions_()},this._errorHandler)})}_continueUpload(){const e=VT*this._chunkMultiplier,n=new Nd(this._transferred,this._blob.size()),r=this._uploadUrl;this._resolveToken((i,s)=>{let o;try{o=CJ(this._ref._location,this._ref.storage,r,this._blob,e,this._mappings,n,this._makeProgressCallback())}catch(c){this._error=c,this._transition("error");return}const a=this._ref.storage._makeRequest(o,Ir,i,s);this._request=a,a.getPromise().then(c=>{this._increaseMultiplier(),this._request=void 0,this._updateProgress(c.current),c.finalized?(this._metadata=c.metadata,this._transition("success")):this.completeTransitions_()},this._errorHandler)})}_increaseMultiplier(){VT*this._chunkMultiplier<32*1024*1024&&(this._chunkMultiplier*=2)}_fetchMetadata(){this._resolveToken((e,n)=>{const r=xD(this._ref.storage,this._ref._location,this._mappings),i=this._ref.storage._makeRequest(r,Ir,e,n);this._request=i,i.getPromise().then(s=>{this._request=void 0,this._metadata=s,this._transition("success")},this._metadataErrorHandler)})}_oneShotUpload(){this._resolveToken((e,n)=>{const r=EJ(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),i=this._ref.storage._makeRequest(r,Ir,e,n);this._request=i,i.getPromise().then(s=>{this._request=void 0,this._metadata=s,this._updateProgress(this._blob.size()),this._transition("success")},this._errorHandler)})}_updateProgress(e){const n=this._transferred;this._transferred=e,this._transferred!==n&&this._notifyObservers()}_transition(e){if(this._state!==e)switch(e){case"canceling":this._state=e,this._request!==void 0&&this._request.cancel();break;case"pausing":this._state=e,this._request!==void 0&&this._request.cancel();break;case"running":const n=this._state==="paused";this._state=e,n&&(this._notifyObservers(),this._start());break;case"paused":this._state=e,this._notifyObservers();break;case"canceled":this._error=ED(),this._state=e,this._notifyObservers();break;case"error":this._state=e,this._notifyObservers();break;case"success":this._state=e,this._notifyObservers();break}}completeTransitions_(){switch(this._state){case"pausing":this._transition("paused");break;case"canceling":this._transition("canceled");break;case"running":this._start();break}}get snapshot(){const e=hg(this._state);return{bytesTransferred:this._transferred,totalBytes:this._blob.size(),state:e,metadata:this._metadata,task:this,ref:this._ref}}on(e,n,r,i){const s=new kJ(n||void 0,r||void 0,i||void 0);return this._addObserver(s),()=>{this._removeObserver(s)}}then(e,n){return this._promise.then(e,n)}catch(e){return this.then(null,e)}_addObserver(e){this._observers.push(e),this._notifyObserver(e)}_removeObserver(e){const n=this._observers.indexOf(e);n!==-1&&this._observers.splice(n,1)}_notifyObservers(){this._finishPromise(),this._observers.slice().forEach(n=>{this._notifyObserver(n)})}_finishPromise(){if(this._resolve!==void 0){let e=!0;switch(hg(this._state)){case rn.SUCCESS:$o(this._resolve.bind(null,this.snapshot))();break;case rn.CANCELED:case rn.ERROR:const n=this._reject;$o(n.bind(null,this._error))();break;default:e=!1;break}e&&(this._resolve=void 0,this._reject=void 0)}}_notifyObserver(e){switch(hg(this._state)){case rn.RUNNING:case rn.PAUSED:e.next&&$o(e.next.bind(e,this.snapshot))();break;case rn.SUCCESS:e.complete&&$o(e.complete.bind(e))();break;case rn.CANCELED:case rn.ERROR:e.error&&$o(e.error.bind(e,this._error))();break;default:e.error&&$o(e.error.bind(e,this._error))()}}resume(){const e=this._state==="paused"||this._state==="pausing";return e&&this._transition("running"),e}pause(){const e=this._state==="running";return e&&this._transition("pausing"),e}cancel(){const e=this._state==="running"||this._state==="pausing";return e&&this._transition("canceling"),e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yo{constructor(e,n){this._service=e,n instanceof Qt?this._location=n:this._location=Qt.makeFromUrl(n,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,n){return new yo(e,n)}get root(){const e=new Qt(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return DD(this._location.path)}get storage(){return this._service}get parent(){const e=aJ(this._location.path);if(e===null)return null;const n=new Qt(this._location.bucket,e);return new yo(this._service,n)}_throwIfRoot(e){if(this._location.path==="")throw CD(e)}}function PJ(t,e,n){return t._throwIfRoot("uploadBytesResumable"),new LD(t,new Gr(e),n)}function DJ(t){const e={prefixes:[],items:[]};return FD(t,e).then(()=>e)}async function FD(t,e,n){const i=await UD(t,{pageToken:n});e.prefixes.push(...i.prefixes),e.items.push(...i.items),i.nextPageToken!=null&&await FD(t,e,i.nextPageToken)}function UD(t,e){e!=null&&typeof e.maxResults=="number"&&Ym("options.maxResults",1,1e3,e.maxResults);const n=e||{},r=yJ(t.storage,t._location,"/",n.pageToken,n.maxResults);return t.storage.makeRequestWithTokens(r,Ir)}function OJ(t){t._throwIfRoot("getMetadata");const e=xD(t.storage,t._location,up());return t.storage.makeRequestWithTokens(e,Ir)}function xJ(t,e){t._throwIfRoot("updateMetadata");const n=wJ(t.storage,t._location,e,up());return t.storage.makeRequestWithTokens(n,Ir)}function MJ(t){t._throwIfRoot("getDownloadURL");const e=vJ(t.storage,t._location,up());return t.storage.makeRequestWithTokens(e,Ir).then(n=>{if(n===null)throw $5();return n})}function LJ(t){t._throwIfRoot("deleteObject");const e=bJ(t.storage,t._location);return t.storage.makeRequestWithTokens(e,Ir)}function VD(t,e){const n=cJ(t._location.path,e),r=new Qt(t._location.bucket,n);return new yo(t.storage,r)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function FJ(t){return/^[A-Za-z]+:\/\//.test(t)}function UJ(t,e){return new yo(t,e)}function $D(t,e){if(t instanceof Sw){const n=t;if(n._bucket==null)throw U5();const r=new yo(n,n._bucket);return e!=null?$D(r,e):r}else return e!==void 0?VD(t,e):t}function VJ(t,e){if(e&&FJ(e)){if(t instanceof Sw)return UJ(t,e);throw aa("To use ref(service, url), the first argument must be a Storage instance.")}else return $D(t,e)}function $T(t,e){const n=e==null?void 0:e[ID];return n==null?null:Qt.makeFromBucketSpec(n,t)}function $J(t,e,n,r={}){t.host=`${e}:${n}`,t._protocol="http";const{mockUserToken:i}=r;i&&(t._overrideAuthToken=typeof i=="string"?i:k_(i,t.app.options.projectId))}class Sw{constructor(e,n,r,i,s){this.app=e,this._authProvider=n,this._appCheckProvider=r,this._url=i,this._firebaseVersion=s,this._bucket=null,this._host=bD,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=k5,this._maxUploadRetryTime=R5,this._requests=new Set,i!=null?this._bucket=Qt.makeFromBucketSpec(i,this._host):this._bucket=$T(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=Qt.makeFromBucketSpec(this._url,e):this._bucket=$T(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){Ym("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){Ym("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const n=await e.getToken();if(n!==null)return n.accessToken}return null}async _getAppCheckToken(){const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new yo(this,e)}_makeRequest(e,n,r,i){if(this._deleted)return new B5(SD());{const s=X5(e,this._appId,r,i,n,this._firebaseVersion);return this._requests.add(s),s.getPromise().then(()=>this._requests.delete(s),()=>this._requests.delete(s)),s}}async makeRequestWithTokens(e,n){const[r,i]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,n,r,i).getPromise()}}const BT="@firebase/storage",jT="0.9.9";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BJ="storage";function jJ(t,e,n){return t=M(t),PJ(t,e,n)}function qJ(t){return t=M(t),OJ(t)}function WJ(t,e){return t=M(t),xJ(t,e)}function KJ(t,e){return t=M(t),UD(t,e)}function HJ(t){return t=M(t),DJ(t)}function GJ(t){return t=M(t),MJ(t)}function zJ(t){return t=M(t),LJ(t)}function qT(t,e){return t=M(t),VJ(t,e)}function QJ(t,e){return VD(t,e)}function YJ(t,e,n,r={}){$J(t,e,n,r)}function JJ(t,{instanceIdentifier:e}){const n=t.getProvider("app").getImmediate(),r=t.getProvider("auth-internal"),i=t.getProvider("app-check-internal");return new Sw(n,r,i,e,Br)}function XJ(){nt(new Ce(BJ,JJ,"PUBLIC").setMultipleInstances(!0)),Ve(BT,jT,""),Ve(BT,jT,"esm2017")}XJ();/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ah{constructor(e,n,r){this._delegate=e,this.task=n,this.ref=r}get bytesTransferred(){return this._delegate.bytesTransferred}get metadata(){return this._delegate.metadata}get state(){return this._delegate.state}get totalBytes(){return this._delegate.totalBytes}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WT{constructor(e,n){this._delegate=e,this._ref=n,this.cancel=this._delegate.cancel.bind(this._delegate),this.catch=this._delegate.catch.bind(this._delegate),this.pause=this._delegate.pause.bind(this._delegate),this.resume=this._delegate.resume.bind(this._delegate)}get snapshot(){return new ah(this._delegate.snapshot,this,this._ref)}then(e,n){return this._delegate.then(r=>{if(e)return e(new ah(r,this,this._ref))},n)}on(e,n,r,i){let s;return n&&(typeof n=="function"?s=o=>n(new ah(o,this,this._ref)):s={next:n.next?o=>n.next(new ah(o,this,this._ref)):void 0,complete:n.complete||void 0,error:n.error||void 0}),this._delegate.on(e,s,r||void 0,i||void 0)}}class KT{constructor(e,n){this._delegate=e,this._service=n}get prefixes(){return this._delegate.prefixes.map(e=>new ni(e,this._service))}get items(){return this._delegate.items.map(e=>new ni(e,this._service))}get nextPageToken(){return this._delegate.nextPageToken||null}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *  http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ni{constructor(e,n){this._delegate=e,this.storage=n}get name(){return this._delegate.name}get bucket(){return this._delegate.bucket}get fullPath(){return this._delegate.fullPath}toString(){return this._delegate.toString()}child(e){const n=QJ(this._delegate,e);return new ni(n,this.storage)}get root(){return new ni(this._delegate.root,this.storage)}get parent(){const e=this._delegate.parent;return e==null?null:new ni(e,this.storage)}put(e,n){return this._throwIfRoot("put"),new WT(jJ(this._delegate,e,n),this)}putString(e,n=jn.RAW,r){this._throwIfRoot("putString");const i=kD(n,e),s=Object.assign({},r);return s.contentType==null&&i.contentType!=null&&(s.contentType=i.contentType),new WT(new LD(this._delegate,new Gr(i.data,!0),s),this)}listAll(){return HJ(this._delegate).then(e=>new KT(e,this.storage))}list(e){return KJ(this._delegate,e||void 0).then(n=>new KT(n,this.storage))}getMetadata(){return qJ(this._delegate)}updateMetadata(e){return WJ(this._delegate,e)}getDownloadURL(){return GJ(this._delegate)}delete(){return this._throwIfRoot("delete"),zJ(this._delegate)}_throwIfRoot(e){if(this._delegate._location.path==="")throw CD(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BD{constructor(e,n){this.app=e,this._delegate=n}get maxOperationRetryTime(){return this._delegate.maxOperationRetryTime}get maxUploadRetryTime(){return this._delegate.maxUploadRetryTime}ref(e){if(HT(e))throw aa("ref() expected a child path but got a URL, use refFromURL instead.");return new ni(qT(this._delegate,e),this)}refFromURL(e){if(!HT(e))throw aa("refFromURL() expected a full URL but got a child path, use ref() instead.");try{Qt.makeFromUrl(e,this._delegate.host)}catch{throw aa("refFromUrl() expected a valid full URL but got an invalid one.")}return new ni(qT(this._delegate,e),this)}setMaxUploadRetryTime(e){this._delegate.maxUploadRetryTime=e}setMaxOperationRetryTime(e){this._delegate.maxOperationRetryTime=e}useEmulator(e,n,r={}){YJ(this._delegate,e,n,r)}}function HT(t){return/^[A-Za-z]+:\/\//.test(t)}const ZJ="@firebase/storage-compat",eX="0.1.17";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tX="storage-compat";function nX(t,{instanceIdentifier:e}){const n=t.getProvider("app-compat").getImmediate(),r=t.getProvider("storage").getImmediate({identifier:e});return new BD(n,r)}function rX(t){const e={TaskState:rn,TaskEvent:AJ,StringFormat:jn,Storage:BD,Reference:ni};t.INTERNAL.registerComponent(new Ce(tX,nX,"PUBLIC").setServiceProps(e).setMultipleInstances(!0)),t.registerVersion(ZJ,eX)}rX(lt);const GT="@firebase/performance",Jm="0.5.12";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jD=Jm,iX="FB-PERF-TRACE-START",sX="FB-PERF-TRACE-STOP",Xm="FB-PERF-TRACE-MEASURE",qD="_wt_",WD="_fp",KD="_fcp",HD="_fid",GD="@firebase/performance/config",zD="@firebase/performance/configexpire",oX="performance",QD="Performance";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aX={["trace started"]:"Trace {$traceName} was started before.",["trace stopped"]:"Trace {$traceName} is not running.",["nonpositive trace startTime"]:"Trace {$traceName} startTime should be positive.",["nonpositive trace duration"]:"Trace {$traceName} duration should be positive.",["no window"]:"Window is not available.",["no app id"]:"App id is not available.",["no project id"]:"Project id is not available.",["no api key"]:"Api key is not available.",["invalid cc log"]:"Attempted to queue invalid cc event",["FB not default"]:"Performance can only start when Firebase app instance is the default one.",["RC response not ok"]:"RC response is not ok",["invalid attribute name"]:"Attribute name {$attributeName} is invalid.",["invalid attribute value"]:"Attribute value {$attributeValue} is invalid.",["invalid custom metric name"]:"Custom metric name {$customMetricName} is invalid",["invalid String merger input"]:"Input for String merger is invalid, contact support team to resolve.",["already initialized"]:"initializePerformance() has already been called with different options. To avoid this error, call initializePerformance() with the same options as when it was originally called, or call getPerformance() to return the already initialized instance."},zt=new dn(oX,QD,aX);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vr=new $r(QD);Vr.logLevel=ge.INFO;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let dg,YD;class At{constructor(e){if(this.window=e,!e)throw zt.create("no window");this.performance=e.performance,this.PerformanceObserver=e.PerformanceObserver,this.windowLocation=e.location,this.navigator=e.navigator,this.document=e.document,this.navigator&&this.navigator.cookieEnabled&&(this.localStorage=e.localStorage),e.perfMetrics&&e.perfMetrics.onFirstInputDelay&&(this.onFirstInputDelay=e.perfMetrics.onFirstInputDelay)}getUrl(){return this.windowLocation.href.split("?")[0]}mark(e){!this.performance||!this.performance.mark||this.performance.mark(e)}measure(e,n,r){!this.performance||!this.performance.measure||this.performance.measure(e,n,r)}getEntriesByType(e){return!this.performance||!this.performance.getEntriesByType?[]:this.performance.getEntriesByType(e)}getEntriesByName(e){return!this.performance||!this.performance.getEntriesByName?[]:this.performance.getEntriesByName(e)}getTimeOrigin(){return this.performance&&(this.performance.timeOrigin||this.performance.timing.navigationStart)}requiredApisAvailable(){return!fetch||!Promise||!Qd()?(Vr.info("Firebase Performance cannot start if browser does not support fetch and Promise or cookie is disabled."),!1):bn()?!0:(Vr.info("IndexedDB is not supported by current browswer"),!1)}setupObserver(e,n){if(!this.PerformanceObserver)return;new this.PerformanceObserver(i=>{for(const s of i.getEntries())n(s)}).observe({entryTypes:[e]})}static getInstance(){return dg===void 0&&(dg=new At(YD)),dg}}function cX(t){YD=t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let JD;function lX(t){const e=t.getId();return e.then(n=>{JD=n}),e}function Cw(){return JD}function uX(t){const e=t.getToken();return e.then(n=>{}),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zT(t,e){const n=t.length-e.length;if(n<0||n>1)throw zt.create("invalid String merger input");const r=[];for(let i=0;i<t.length;i++)r.push(t.charAt(i)),e.length>i&&r.push(e.charAt(i));return r.join("")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let fg;class Rn{constructor(){this.instrumentationEnabled=!0,this.dataCollectionEnabled=!0,this.loggingEnabled=!1,this.tracesSamplingRate=1,this.networkRequestsSamplingRate=1,this.logEndPointUrl="https://firebaselogging.googleapis.com/v0cc/log?format=json_proto",this.flTransportEndpointUrl=zT("hts/frbslgigp.ogepscmv/ieo/eaylg","tp:/ieaeogn-agolai.o/1frlglgc/o"),this.transportKey=zT("AzSC8r6ReiGqFMyfvgow","Iayx0u-XT3vksVM-pIV"),this.logSource=462,this.logTraceAfterSampling=!1,this.logNetworkAfterSampling=!1,this.configTimeToLive=12}getFlTransportFullUrl(){return this.flTransportEndpointUrl.concat("?key=",this.transportKey)}static getInstance(){return fg===void 0&&(fg=new Rn),fg}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ca;(function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.VISIBLE=1]="VISIBLE",t[t.HIDDEN=2]="HIDDEN"})(ca||(ca={}));const hX=["firebase_","google_","ga_"],dX=new RegExp("^[a-zA-Z]\\w*$"),fX=40,pX=100;function gX(){const t=At.getInstance().navigator;return"serviceWorker"in t?t.serviceWorker.controller?2:3:1}function XD(){switch(At.getInstance().document.visibilityState){case"visible":return ca.VISIBLE;case"hidden":return ca.HIDDEN;default:return ca.UNKNOWN}}function mX(){const e=At.getInstance().navigator.connection;switch(e&&e.effectiveType){case"slow-2g":return 1;case"2g":return 2;case"3g":return 3;case"4g":return 4;default:return 0}}function _X(t){return t.length===0||t.length>fX?!1:!hX.some(n=>t.startsWith(n))&&!!t.match(dX)}function yX(t){return t.length!==0&&t.length<=pX}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ZD(t){var e;const n=(e=t.options)===null||e===void 0?void 0:e.appId;if(!n)throw zt.create("no app id");return n}function vX(t){var e;const n=(e=t.options)===null||e===void 0?void 0:e.projectId;if(!n)throw zt.create("no project id");return n}function wX(t){var e;const n=(e=t.options)===null||e===void 0?void 0:e.apiKey;if(!n)throw zt.create("no api key");return n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bX="0.0.1",Xn={loggingEnabled:!0},IX="FIREBASE_INSTALLATIONS_AUTH";function EX(t,e){const n=TX();return n?(QT(n),Promise.resolve()):AX(t,e).then(QT).then(r=>SX(r),()=>{})}function TX(){const t=At.getInstance().localStorage;if(!t)return;const e=t.getItem(zD);if(!e||!kX(e))return;const n=t.getItem(GD);if(!!n)try{return JSON.parse(n)}catch{return}}function SX(t){const e=At.getInstance().localStorage;!t||!e||(e.setItem(GD,JSON.stringify(t)),e.setItem(zD,String(Date.now()+Rn.getInstance().configTimeToLive*60*60*1e3)))}const CX="Could not fetch config, will use default configs";function AX(t,e){return uX(t.installations).then(n=>{const r=vX(t.app),i=wX(t.app),s=`https://firebaseremoteconfig.googleapis.com/v1/projects/${r}/namespaces/fireperf:fetch?key=${i}`,o=new Request(s,{method:"POST",headers:{Authorization:`${IX} ${n}`},body:JSON.stringify({app_instance_id:e,app_instance_id_token:n,app_id:ZD(t.app),app_version:jD,sdk_version:bX})});return fetch(o).then(a=>{if(a.ok)return a.json();throw zt.create("RC response not ok")})}).catch(()=>{Vr.info(CX)})}function QT(t){if(!t)return t;const e=Rn.getInstance(),n=t.entries||{};return n.fpr_enabled!==void 0?e.loggingEnabled=String(n.fpr_enabled)==="true":e.loggingEnabled=Xn.loggingEnabled,n.fpr_log_source?e.logSource=Number(n.fpr_log_source):Xn.logSource&&(e.logSource=Xn.logSource),n.fpr_log_endpoint_url?e.logEndPointUrl=n.fpr_log_endpoint_url:Xn.logEndPointUrl&&(e.logEndPointUrl=Xn.logEndPointUrl),n.fpr_log_transport_key?e.transportKey=n.fpr_log_transport_key:Xn.transportKey&&(e.transportKey=Xn.transportKey),n.fpr_vc_network_request_sampling_rate!==void 0?e.networkRequestsSamplingRate=Number(n.fpr_vc_network_request_sampling_rate):Xn.networkRequestsSamplingRate!==void 0&&(e.networkRequestsSamplingRate=Xn.networkRequestsSamplingRate),n.fpr_vc_trace_sampling_rate!==void 0?e.tracesSamplingRate=Number(n.fpr_vc_trace_sampling_rate):Xn.tracesSamplingRate!==void 0&&(e.tracesSamplingRate=Xn.tracesSamplingRate),e.logTraceAfterSampling=YT(e.tracesSamplingRate),e.logNetworkAfterSampling=YT(e.networkRequestsSamplingRate),t}function kX(t){return Number(t)>Date.now()}function YT(t){return Math.random()<=t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Aw=1,pg;function eO(t){return Aw=2,pg=pg||NX(t),pg}function RX(){return Aw===3}function NX(t){return PX().then(()=>lX(t.installations)).then(e=>EX(t,e)).then(()=>JT(),()=>JT())}function PX(){const t=At.getInstance().document;return new Promise(e=>{if(t&&t.readyState!=="complete"){const n=()=>{t.readyState==="complete"&&(t.removeEventListener("readystatechange",n),e())};t.addEventListener("readystatechange",n)}else e()})}function JT(){Aw=3}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kw=10*1e3,DX=5.5*1e3,tO=3,OX=1e3;let Pd=tO,Bi=[],XT=!1;function xX(){XT||(fp(DX),XT=!0)}function fp(t){setTimeout(()=>{if(Pd!==0){if(!Bi.length)return fp(kw);MX()}},t)}function MX(){const t=Bi.splice(0,OX),e=t.map(r=>({source_extension_json_proto3:r.message,event_time_ms:String(r.eventTime)})),n={request_time_ms:String(Date.now()),client_info:{client_type:1,js_client_info:{}},log_source:Rn.getInstance().logSource,log_event:e};LX(n,t).catch(()=>{Bi=[...t,...Bi],Pd--,Vr.info(`Tries left: ${Pd}.`),fp(kw)})}function LX(t,e){return FX(t).then(n=>(n.ok||Vr.info("Call to Firebase backend failed."),n.json())).then(n=>{const r=Number(n.nextRequestWaitMillis);let i=kw;isNaN(r)||(i=Math.max(r,i));const s=n.logResponseDetails;Array.isArray(s)&&s.length>0&&s[0].responseAction==="RETRY_REQUEST_LATER"&&(Bi=[...e,...Bi],Vr.info("Retry transport request later.")),Pd=tO,fp(i)})}function FX(t){const e=Rn.getInstance().getFlTransportFullUrl();return fetch(e,{method:"POST",body:JSON.stringify(t)})}function UX(t){if(!t.eventTime||!t.message)throw zt.create("invalid cc log");Bi=[...Bi,t]}function VX(t){return(...e)=>{const n=t(...e);UX({message:n,eventTime:Date.now()})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let gg;function nO(t,e){gg||(gg=VX(BX)),gg(t,e)}function ch(t){const e=Rn.getInstance();!e.instrumentationEnabled&&t.isAuto||!e.dataCollectionEnabled&&!t.isAuto||!At.getInstance().requiredApisAvailable()||t.isAuto&&XD()!==ca.VISIBLE||(RX()?mg(t):eO(t.performanceController).then(()=>mg(t),()=>mg(t)))}function mg(t){if(!Cw())return;const e=Rn.getInstance();!e.loggingEnabled||!e.logTraceAfterSampling||setTimeout(()=>nO(t,1),0)}function $X(t){const e=Rn.getInstance();if(!e.instrumentationEnabled)return;const n=t.url,r=e.logEndPointUrl.split("?")[0],i=e.flTransportEndpointUrl.split("?")[0];n===r||n===i||!e.loggingEnabled||!e.logNetworkAfterSampling||setTimeout(()=>nO(t,0),0)}function BX(t,e){return e===0?jX(t):qX(t)}function jX(t){const e={url:t.url,http_method:t.httpMethod||0,http_response_code:200,response_payload_bytes:t.responsePayloadBytes,client_start_time_us:t.startTimeUs,time_to_response_initiated_us:t.timeToResponseInitiatedUs,time_to_response_completed_us:t.timeToResponseCompletedUs},n={application_info:rO(t.performanceController.app),network_request_metric:e};return JSON.stringify(n)}function qX(t){const e={name:t.name,is_auto:t.isAuto,client_start_time_us:t.startTimeUs,duration_us:t.durationUs};Object.keys(t.counters).length!==0&&(e.counters=t.counters);const n=t.getAttributes();Object.keys(n).length!==0&&(e.custom_attributes=n);const r={application_info:rO(t.performanceController.app),trace_metric:e};return JSON.stringify(r)}function rO(t){return{google_app_id:ZD(t),app_instance_id:Cw(),web_app_info:{sdk_version:jD,page_url:At.getInstance().getUrl(),service_worker_status:gX(),visibility_state:XD(),effective_connection_type:mX()},application_process_state:0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WX=100,KX="_",HX=[WD,KD,HD];function GX(t,e){return t.length===0||t.length>WX?!1:e&&e.startsWith(qD)&&HX.indexOf(t)>-1||!t.startsWith(KX)}function zX(t){const e=Math.floor(t);return e<t&&Vr.info(`Metric value should be an Integer, setting the value as : ${e}.`),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ji{constructor(e,n,r=!1,i){this.performanceController=e,this.name=n,this.isAuto=r,this.state=1,this.customAttributes={},this.counters={},this.api=At.getInstance(),this.randomId=Math.floor(Math.random()*1e6),this.isAuto||(this.traceStartMark=`${iX}-${this.randomId}-${this.name}`,this.traceStopMark=`${sX}-${this.randomId}-${this.name}`,this.traceMeasure=i||`${Xm}-${this.randomId}-${this.name}`,i&&this.calculateTraceMetrics())}start(){if(this.state!==1)throw zt.create("trace started",{traceName:this.name});this.api.mark(this.traceStartMark),this.state=2}stop(){if(this.state!==2)throw zt.create("trace stopped",{traceName:this.name});this.state=3,this.api.mark(this.traceStopMark),this.api.measure(this.traceMeasure,this.traceStartMark,this.traceStopMark),this.calculateTraceMetrics(),ch(this)}record(e,n,r){if(e<=0)throw zt.create("nonpositive trace startTime",{traceName:this.name});if(n<=0)throw zt.create("nonpositive trace duration",{traceName:this.name});if(this.durationUs=Math.floor(n*1e3),this.startTimeUs=Math.floor(e*1e3),r&&r.attributes&&(this.customAttributes=Object.assign({},r.attributes)),r&&r.metrics)for(const i of Object.keys(r.metrics))isNaN(Number(r.metrics[i]))||(this.counters[i]=Math.floor(Number(r.metrics[i])));ch(this)}incrementMetric(e,n=1){this.counters[e]===void 0?this.putMetric(e,n):this.putMetric(e,this.counters[e]+n)}putMetric(e,n){if(GX(e,this.name))this.counters[e]=zX(n!=null?n:0);else throw zt.create("invalid custom metric name",{customMetricName:e})}getMetric(e){return this.counters[e]||0}putAttribute(e,n){const r=_X(e),i=yX(n);if(r&&i){this.customAttributes[e]=n;return}if(!r)throw zt.create("invalid attribute name",{attributeName:e});if(!i)throw zt.create("invalid attribute value",{attributeValue:n})}getAttribute(e){return this.customAttributes[e]}removeAttribute(e){this.customAttributes[e]!==void 0&&delete this.customAttributes[e]}getAttributes(){return Object.assign({},this.customAttributes)}setStartTime(e){this.startTimeUs=e}setDuration(e){this.durationUs=e}calculateTraceMetrics(){const e=this.api.getEntriesByName(this.traceMeasure),n=e&&e[0];n&&(this.durationUs=Math.floor(n.duration*1e3),this.startTimeUs=Math.floor((n.startTime+this.api.getTimeOrigin())*1e3))}static createOobTrace(e,n,r,i){const s=At.getInstance().getUrl();if(!s)return;const o=new ji(e,qD+s,!0),a=Math.floor(At.getInstance().getTimeOrigin()*1e3);o.setStartTime(a),n&&n[0]&&(o.setDuration(Math.floor(n[0].duration*1e3)),o.putMetric("domInteractive",Math.floor(n[0].domInteractive*1e3)),o.putMetric("domContentLoadedEventEnd",Math.floor(n[0].domContentLoadedEventEnd*1e3)),o.putMetric("loadEventEnd",Math.floor(n[0].loadEventEnd*1e3)));const c="first-paint",l="first-contentful-paint";if(r){const u=r.find(d=>d.name===c);u&&u.startTime&&o.putMetric(WD,Math.floor(u.startTime*1e3));const h=r.find(d=>d.name===l);h&&h.startTime&&o.putMetric(KD,Math.floor(h.startTime*1e3)),i&&o.putMetric(HD,Math.floor(i*1e3))}ch(o)}static createUserTimingTrace(e,n){const r=new ji(e,n,!1,n);ch(r)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ZT(t,e){const n=e;if(!n||n.responseStart===void 0)return;const r=At.getInstance().getTimeOrigin(),i=Math.floor((n.startTime+r)*1e3),s=n.responseStart?Math.floor((n.responseStart-n.startTime)*1e3):void 0,o=Math.floor((n.responseEnd-n.startTime)*1e3),a=n.name&&n.name.split("?")[0],c={performanceController:t,url:a,responsePayloadBytes:n.transferSize,startTimeUs:i,timeToResponseInitiatedUs:s,timeToResponseCompletedUs:o};$X(c)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QX=5e3;function eS(t){!Cw()||(setTimeout(()=>JX(t),0),setTimeout(()=>YX(t),0),setTimeout(()=>XX(t),0))}function YX(t){const e=At.getInstance(),n=e.getEntriesByType("resource");for(const r of n)ZT(t,r);e.setupObserver("resource",r=>ZT(t,r))}function JX(t){const e=At.getInstance(),n=e.getEntriesByType("navigation"),r=e.getEntriesByType("paint");if(e.onFirstInputDelay){let i=setTimeout(()=>{ji.createOobTrace(t,n,r),i=void 0},QX);e.onFirstInputDelay(s=>{i&&(clearTimeout(i),ji.createOobTrace(t,n,r,s))})}else ji.createOobTrace(t,n,r)}function XX(t){const e=At.getInstance(),n=e.getEntriesByType("measure");for(const r of n)tS(t,r);e.setupObserver("measure",r=>tS(t,r))}function tS(t,e){const n=e.name;n.substring(0,Xm.length)!==Xm&&ji.createUserTimingTrace(t,n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZX{constructor(e,n){this.app=e,this.installations=n,this.initialized=!1}_init(e){this.initialized||((e==null?void 0:e.dataCollectionEnabled)!==void 0&&(this.dataCollectionEnabled=e.dataCollectionEnabled),(e==null?void 0:e.instrumentationEnabled)!==void 0&&(this.instrumentationEnabled=e.instrumentationEnabled),At.getInstance().requiredApisAvailable()?ru().then(n=>{n&&(xX(),eO(this).then(()=>eS(this),()=>eS(this)),this.initialized=!0)}).catch(n=>{Vr.info(`Environment doesn't support IndexedDB: ${n}`)}):Vr.info('Firebase Performance cannot start if the browser does not support "Fetch" and "Promise", or cookies are disabled.'))}set instrumentationEnabled(e){Rn.getInstance().instrumentationEnabled=e}get instrumentationEnabled(){return Rn.getInstance().instrumentationEnabled}set dataCollectionEnabled(e){Rn.getInstance().dataCollectionEnabled=e}get dataCollectionEnabled(){return Rn.getInstance().dataCollectionEnabled}}const e8="[DEFAULT]";function t8(t,e){return t=M(t),new ji(t,e)}const n8=(t,{options:e})=>{const n=t.getProvider("app").getImmediate(),r=t.getProvider("installations-internal").getImmediate();if(n.name!==e8)throw zt.create("FB not default");if(typeof window=="undefined")throw zt.create("no window");cX(window);const i=new ZX(n,r);return i._init(e),i};function r8(){nt(new Ce("performance",n8,"PUBLIC")),Ve(GT,Jm),Ve(GT,Jm,"esm2017")}r8();/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class i8{constructor(e,n){this.app=e,this._delegate=n}get instrumentationEnabled(){return this._delegate.instrumentationEnabled}set instrumentationEnabled(e){this._delegate.instrumentationEnabled=e}get dataCollectionEnabled(){return this._delegate.dataCollectionEnabled}set dataCollectionEnabled(e){this._delegate.dataCollectionEnabled=e}trace(e){return t8(this._delegate,e)}}const s8="@firebase/performance-compat",o8="0.1.12";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function a8(t){t.INTERNAL.registerComponent(new Ce("performance-compat",c8,"PUBLIC")),t.registerVersion(s8,o8)}function c8(t){const e=t.getProvider("app-compat").getImmediate(),n=t.getProvider("performance").getImmediate();return new i8(e,n)}a8(lt);const _g="@firebase/remote-config",nS="0.3.11";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l8{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const u8="remote-config";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const h8={["registration-window"]:"Undefined window object. This SDK only supports usage in a browser environment.",["registration-project-id"]:"Undefined project identifier. Check Firebase app initialization.",["registration-api-key"]:"Undefined API key. Check Firebase app initialization.",["registration-app-id"]:"Undefined app identifier. Check Firebase app initialization.",["storage-open"]:"Error thrown when opening storage. Original error: {$originalErrorMessage}.",["storage-get"]:"Error thrown when reading from storage. Original error: {$originalErrorMessage}.",["storage-set"]:"Error thrown when writing to storage. Original error: {$originalErrorMessage}.",["storage-delete"]:"Error thrown when deleting from storage. Original error: {$originalErrorMessage}.",["fetch-client-network"]:"Fetch client failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.",["fetch-timeout"]:'The config fetch request timed out.  Configure timeout using "fetchTimeoutMillis" SDK setting.',["fetch-throttle"]:'The config fetch request timed out while in an exponential backoff state. Configure timeout using "fetchTimeoutMillis" SDK setting. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.',["fetch-client-parse"]:"Fetch client could not parse response. Original error: {$originalErrorMessage}.",["fetch-status"]:"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.",["indexed-db-unavailable"]:"Indexed DB is not supported by current browser"},mn=new dn("remoteconfig","Remote Config",h8);function d8(t,e){return t instanceof ct&&t.code.indexOf(e)!==-1}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const f8=!1,p8="",rS=0,g8=["1","true","t","yes","y","on"];class yg{constructor(e,n=p8){this._source=e,this._value=n}asString(){return this._value}asBoolean(){return this._source==="static"?f8:g8.indexOf(this._value.toLowerCase())>=0}asNumber(){if(this._source==="static")return rS;let e=Number(this._value);return isNaN(e)&&(e=rS),e}getSource(){return this._source}}async function iO(t){const e=M(t),[n,r]=await Promise.all([e._storage.getLastSuccessfulFetchResponse(),e._storage.getActiveConfigEtag()]);return!n||!n.config||!n.eTag||n.eTag===r?!1:(await Promise.all([e._storageCache.setActiveConfig(n.config),e._storage.setActiveConfigEtag(n.eTag)]),!0)}function sO(t){const e=M(t);return e._initializePromise||(e._initializePromise=e._storageCache.loadFromStorage().then(()=>{e._isInitializationComplete=!0})),e._initializePromise}async function oO(t){const e=M(t),n=new l8;setTimeout(async()=>{n.abort()},e.settings.fetchTimeoutMillis);try{await e._client.fetch({cacheMaxAgeMillis:e.settings.minimumFetchIntervalMillis,signal:n}),await e._storageCache.setLastFetchStatus("success")}catch(r){const i=d8(r,"fetch-throttle")?"throttle":"failure";throw await e._storageCache.setLastFetchStatus(i),r}}function m8(t){const e=M(t);return b8(e._storageCache.getActiveConfig(),e.defaultConfig).reduce((n,r)=>(n[r]=Vu(t,r),n),{})}function _8(t,e){return Vu(M(t),e).asBoolean()}function y8(t,e){return Vu(M(t),e).asNumber()}function v8(t,e){return Vu(M(t),e).asString()}function Vu(t,e){const n=M(t);n._isInitializationComplete||n._logger.debug(`A value was requested for key "${e}" before SDK initialization completed. Await on ensureInitialized if the intent was to get a previously activated value.`);const r=n._storageCache.getActiveConfig();return r&&r[e]!==void 0?new yg("remote",r[e]):n.defaultConfig&&n.defaultConfig[e]!==void 0?new yg("default",String(n.defaultConfig[e])):(n._logger.debug(`Returning static value for key "${e}". Define a default or remote value if this is unintentional.`),new yg("static"))}function w8(t,e){const n=M(t);switch(e){case"debug":n._logger.logLevel=ge.DEBUG;break;case"silent":n._logger.logLevel=ge.SILENT;break;default:n._logger.logLevel=ge.ERROR}}function b8(t={},e={}){return Object.keys(Object.assign(Object.assign({},t),e))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class I8{constructor(e,n,r,i){this.client=e,this.storage=n,this.storageCache=r,this.logger=i}isCachedDataFresh(e,n){if(!n)return this.logger.debug("Config fetch cache check. Cache unpopulated."),!1;const r=Date.now()-n,i=r<=e;return this.logger.debug(`Config fetch cache check. Cache age millis: ${r}. Cache max age millis (minimumFetchIntervalMillis setting): ${e}. Is cache hit: ${i}.`),i}async fetch(e){const[n,r]=await Promise.all([this.storage.getLastSuccessfulFetchTimestampMillis(),this.storage.getLastSuccessfulFetchResponse()]);if(r&&this.isCachedDataFresh(e.cacheMaxAgeMillis,n))return r;e.eTag=r&&r.eTag;const i=await this.client.fetch(e),s=[this.storageCache.setLastSuccessfulFetchTimestampMillis(Date.now())];return i.status===200&&s.push(this.storage.setLastSuccessfulFetchResponse(i)),await Promise.all(s),i}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function E8(t=navigator){return t.languages&&t.languages[0]||t.language}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T8{constructor(e,n,r,i,s,o){this.firebaseInstallations=e,this.sdkVersion=n,this.namespace=r,this.projectId=i,this.apiKey=s,this.appId=o}async fetch(e){var n,r,i;const[s,o]=await Promise.all([this.firebaseInstallations.getId(),this.firebaseInstallations.getToken()]),c=`${window.FIREBASE_REMOTE_CONFIG_URL_BASE||"https://firebaseremoteconfig.googleapis.com"}/v1/projects/${this.projectId}/namespaces/${this.namespace}:fetch?key=${this.apiKey}`,l={"Content-Type":"application/json","Content-Encoding":"gzip","If-None-Match":e.eTag||"*"},u={sdk_version:this.sdkVersion,app_instance_id:s,app_instance_id_token:o,app_id:this.appId,language_code:E8()},h={method:"POST",headers:l,body:JSON.stringify(u)},d=fetch(c,h),f=new Promise((R,E)=>{e.signal.addEventListener(()=>{const p=new Error("The operation was aborted.");p.name="AbortError",E(p)})});let g;try{await Promise.race([d,f]),g=await d}catch(R){let E="fetch-client-network";throw((n=R)===null||n===void 0?void 0:n.name)==="AbortError"&&(E="fetch-timeout"),mn.create(E,{originalErrorMessage:(r=R)===null||r===void 0?void 0:r.message})}let v=g.status;const I=g.headers.get("ETag")||void 0;let S,k;if(g.status===200){let R;try{R=await g.json()}catch(E){throw mn.create("fetch-client-parse",{originalErrorMessage:(i=E)===null||i===void 0?void 0:i.message})}S=R.entries,k=R.state}if(k==="INSTANCE_STATE_UNSPECIFIED"?v=500:k==="NO_CHANGE"?v=304:(k==="NO_TEMPLATE"||k==="EMPTY_CONFIG")&&(S={}),v!==304&&v!==200)throw mn.create("fetch-status",{httpStatus:v});return{status:v,eTag:I,config:S}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function S8(t,e){return new Promise((n,r)=>{const i=Math.max(e-Date.now(),0),s=setTimeout(n,i);t.addEventListener(()=>{clearTimeout(s),r(mn.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}function C8(t){if(!(t instanceof ct)||!t.customData)return!1;const e=Number(t.customData.httpStatus);return e===429||e===500||e===503||e===504}class A8{constructor(e,n){this.client=e,this.storage=n}async fetch(e){const n=await this.storage.getThrottleMetadata()||{backoffCount:0,throttleEndTimeMillis:Date.now()};return this.attemptFetch(e,n)}async attemptFetch(e,{throttleEndTimeMillis:n,backoffCount:r}){await S8(e.signal,n);try{const i=await this.client.fetch(e);return await this.storage.deleteThrottleMetadata(),i}catch(i){if(!C8(i))throw i;const s={throttleEndTimeMillis:Date.now()+Lh(r),backoffCount:r+1};return await this.storage.setThrottleMetadata(s),this.attemptFetch(e,s)}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const k8=60*1e3,R8=12*60*60*1e3;class N8{constructor(e,n,r,i,s){this.app=e,this._client=n,this._storageCache=r,this._storage=i,this._logger=s,this._isInitializationComplete=!1,this.settings={fetchTimeoutMillis:k8,minimumFetchIntervalMillis:R8},this.defaultConfig={}}get fetchTimeMillis(){return this._storageCache.getLastSuccessfulFetchTimestampMillis()||-1}get lastFetchStatus(){return this._storageCache.getLastFetchStatus()||"no-fetch-yet"}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ch(t,e){var n;const r=t.target.error||void 0;return mn.create(e,{originalErrorMessage:r&&((n=r)===null||n===void 0?void 0:n.message)})}const Es="app_namespace_store",P8="firebase_remote_config",D8=1;function O8(){return new Promise((t,e)=>{var n;try{const r=indexedDB.open(P8,D8);r.onerror=i=>{e(Ch(i,"storage-open"))},r.onsuccess=i=>{t(i.target.result)},r.onupgradeneeded=i=>{const s=i.target.result;switch(i.oldVersion){case 0:s.createObjectStore(Es,{keyPath:"compositeKey"})}}}catch(r){e(mn.create("storage-open",{originalErrorMessage:(n=r)===null||n===void 0?void 0:n.message}))}})}class x8{constructor(e,n,r,i=O8()){this.appId=e,this.appName=n,this.namespace=r,this.openDbPromise=i}getLastFetchStatus(){return this.get("last_fetch_status")}setLastFetchStatus(e){return this.set("last_fetch_status",e)}getLastSuccessfulFetchTimestampMillis(){return this.get("last_successful_fetch_timestamp_millis")}setLastSuccessfulFetchTimestampMillis(e){return this.set("last_successful_fetch_timestamp_millis",e)}getLastSuccessfulFetchResponse(){return this.get("last_successful_fetch_response")}setLastSuccessfulFetchResponse(e){return this.set("last_successful_fetch_response",e)}getActiveConfig(){return this.get("active_config")}setActiveConfig(e){return this.set("active_config",e)}getActiveConfigEtag(){return this.get("active_config_etag")}setActiveConfigEtag(e){return this.set("active_config_etag",e)}getThrottleMetadata(){return this.get("throttle_metadata")}setThrottleMetadata(e){return this.set("throttle_metadata",e)}deleteThrottleMetadata(){return this.delete("throttle_metadata")}async get(e){const n=await this.openDbPromise;return new Promise((r,i)=>{var s;const a=n.transaction([Es],"readonly").objectStore(Es),c=this.createCompositeKey(e);try{const l=a.get(c);l.onerror=u=>{i(Ch(u,"storage-get"))},l.onsuccess=u=>{const h=u.target.result;r(h?h.value:void 0)}}catch(l){i(mn.create("storage-get",{originalErrorMessage:(s=l)===null||s===void 0?void 0:s.message}))}})}async set(e,n){const r=await this.openDbPromise;return new Promise((i,s)=>{var o;const c=r.transaction([Es],"readwrite").objectStore(Es),l=this.createCompositeKey(e);try{const u=c.put({compositeKey:l,value:n});u.onerror=h=>{s(Ch(h,"storage-set"))},u.onsuccess=()=>{i()}}catch(u){s(mn.create("storage-set",{originalErrorMessage:(o=u)===null||o===void 0?void 0:o.message}))}})}async delete(e){const n=await this.openDbPromise;return new Promise((r,i)=>{var s;const a=n.transaction([Es],"readwrite").objectStore(Es),c=this.createCompositeKey(e);try{const l=a.delete(c);l.onerror=u=>{i(Ch(u,"storage-delete"))},l.onsuccess=()=>{r()}}catch(l){i(mn.create("storage-delete",{originalErrorMessage:(s=l)===null||s===void 0?void 0:s.message}))}})}createCompositeKey(e){return[this.appId,this.appName,this.namespace,e].join()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M8{constructor(e){this.storage=e}getLastFetchStatus(){return this.lastFetchStatus}getLastSuccessfulFetchTimestampMillis(){return this.lastSuccessfulFetchTimestampMillis}getActiveConfig(){return this.activeConfig}async loadFromStorage(){const e=this.storage.getLastFetchStatus(),n=this.storage.getLastSuccessfulFetchTimestampMillis(),r=this.storage.getActiveConfig(),i=await e;i&&(this.lastFetchStatus=i);const s=await n;s&&(this.lastSuccessfulFetchTimestampMillis=s);const o=await r;o&&(this.activeConfig=o)}setLastFetchStatus(e){return this.lastFetchStatus=e,this.storage.setLastFetchStatus(e)}setLastSuccessfulFetchTimestampMillis(e){return this.lastSuccessfulFetchTimestampMillis=e,this.storage.setLastSuccessfulFetchTimestampMillis(e)}setActiveConfig(e){return this.activeConfig=e,this.storage.setActiveConfig(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function L8(){nt(new Ce(u8,t,"PUBLIC").setMultipleInstances(!0)),Ve(_g,nS),Ve(_g,nS,"esm2017");function t(e,{instanceIdentifier:n}){const r=e.getProvider("app").getImmediate(),i=e.getProvider("installations-internal").getImmediate();if(typeof window=="undefined")throw mn.create("registration-window");if(!bn())throw mn.create("indexed-db-unavailable");const{projectId:s,apiKey:o,appId:a}=r.options;if(!s)throw mn.create("registration-project-id");if(!o)throw mn.create("registration-api-key");if(!a)throw mn.create("registration-app-id");n=n||"firebase";const c=new x8(a,r.name,n),l=new M8(c),u=new $r(_g);u.logLevel=ge.ERROR;const h=new T8(i,Br,n,s,o,a),d=new A8(h,c),f=new I8(d,c,l,u),g=new N8(r,f,l,c,u);return sO(g),g}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function F8(t){return t=M(t),await oO(t),iO(t)}async function U8(){if(!bn())return!1;try{return await ru()}catch{return!1}}L8();/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V8{constructor(e,n){this.app=e,this._delegate=n}get defaultConfig(){return this._delegate.defaultConfig}set defaultConfig(e){this._delegate.defaultConfig=e}get fetchTimeMillis(){return this._delegate.fetchTimeMillis}get lastFetchStatus(){return this._delegate.lastFetchStatus}get settings(){return this._delegate.settings}set settings(e){this._delegate.settings=e}activate(){return iO(this._delegate)}ensureInitialized(){return sO(this._delegate)}fetch(){return oO(this._delegate)}fetchAndActivate(){return F8(this._delegate)}getAll(){return m8(this._delegate)}getBoolean(e){return _8(this._delegate,e)}getNumber(e){return y8(this._delegate,e)}getString(e){return v8(this._delegate,e)}getValue(e){return Vu(this._delegate,e)}setLogLevel(e){w8(this._delegate,e)}}const $8="@firebase/remote-config-compat",B8="0.1.12";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function j8(t){t.INTERNAL.registerComponent(new Ce("remoteConfig-compat",q8,"PUBLIC").setMultipleInstances(!0).setServiceProps({isSupported:U8})),t.registerVersion($8,B8)}function q8(t,{instanceIdentifier:e}){const n=t.getProvider("app-compat").getImmediate(),r=t.getProvider("remote-config").getImmediate({identifier:e});return new V8(n,r)}j8(lt);var W8="firebase",K8="9.9.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */lt.registerVersion(W8,K8,"app-compat");var H8="firebase",G8="9.9.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */console.warn(`
It looks like you're using the development build of the Firebase JS SDK.
When deploying Firebase apps to production, it is advisable to only import
the individual SDK components you intend to use.

For the module builds, these are available in the following manner
(replace <PACKAGE> with the name of a component - i.e. auth, database, etc):

CommonJS Modules:
const firebase = require('firebase/app');
require('firebase/<PACKAGE>');

ES Modules:
import firebase from 'firebase/app';
import 'firebase/<PACKAGE>';

Typescript:
import firebase from 'firebase/app';
import 'firebase/<PACKAGE>';
`);lt.registerVersion(H8,G8,"compat");var z8=!1;/*!
  * pinia v2.0.16
  * (c) 2022 Eduardo San Martin Morote
  * @license MIT
  */let aO;const pp=t=>aO=t,cO=Symbol();function Zm(t){return t&&typeof t=="object"&&Object.prototype.toString.call(t)==="[object Object]"&&typeof t.toJSON!="function"}var Zc;(function(t){t.direct="direct",t.patchObject="patch object",t.patchFunction="patch function"})(Zc||(Zc={}));function Q8(){const t=hS(!0),e=t.run(()=>p_({}));let n=[],r=[];const i=ua({install(s){pp(i),i._a=s,s.provide(cO,i),s.config.globalProperties.$pinia=i,r.forEach(o=>n.push(o)),r=[]},use(s){return!this._a&&!z8?r.push(s):n.push(s),this},_p:n,_a:null,_e:t,_s:new Map,state:e});return i}const lO=()=>{};function iS(t,e,n,r=lO){t.push(e);const i=()=>{const s=t.indexOf(e);s>-1&&(t.splice(s,1),r())};return!n&&E_()&&__(i),i}function Bo(t,...e){t.slice().forEach(n=>{n(...e)})}function e_(t,e){for(const n in e){if(!e.hasOwnProperty(n))continue;const r=e[n],i=t[n];Zm(i)&&Zm(r)&&t.hasOwnProperty(n)&&!at(r)&&!Mi(r)?t[n]=e_(i,r):t[n]=r}return t}const Y8=Symbol();function J8(t){return!Zm(t)||!t.hasOwnProperty(Y8)}const{assign:Kr}=Object;function X8(t){return!!(at(t)&&t.effect)}function Z8(t,e,n,r){const{state:i,actions:s,getters:o}=e,a=n.state.value[t];let c;function l(){a||(n.state.value[t]=i?i():{});const u=nx(n.state.value[t]);return Kr(u,s,Object.keys(o||{}).reduce((h,d)=>(h[d]=ua(tr(()=>{pp(n);const f=n._s.get(t);return o[d].call(f,f)})),h),{}))}return c=uO(t,l,e,n,r,!0),c.$reset=function(){const h=i?i():{};this.$patch(d=>{Kr(d,h)})},c}function uO(t,e,n={},r,i,s){let o;const a=Kr({actions:{}},n),c={deep:!0};let l,u,h=ua([]),d=ua([]),f;const g=r.state.value[t];!s&&!g&&(r.state.value[t]={}),p_({});let v;function I(y){let m;l=u=!1,typeof y=="function"?(y(r.state.value[t]),m={type:Zc.patchFunction,storeId:t,events:f}):(e_(r.state.value[t],y),m={type:Zc.patchObject,payload:y,storeId:t,events:f});const U=v=Symbol();m_().then(()=>{v===U&&(l=!0)}),u=!0,Bo(h,m,r.state.value[t])}const S=lO;function k(){o.stop(),h=[],d=[],r._s.delete(t)}function R(y,m){return function(){pp(r);const U=Array.from(arguments),N=[],oe=[];function B(We){N.push(We)}function he(We){oe.push(We)}Bo(d,{args:U,name:y,store:p,after:B,onError:he});let we;try{we=m.apply(this&&this.$id===t?this:p,U)}catch(We){throw Bo(oe,We),We}return we instanceof Promise?we.then(We=>(Bo(N,We),We)).catch(We=>(Bo(oe,We),Promise.reject(We))):(Bo(N,we),we)}}const E={_p:r,$id:t,$onAction:iS.bind(null,d),$patch:I,$reset:S,$subscribe(y,m={}){const U=iS(h,y,m.detached,()=>N()),N=o.run(()=>Oc(()=>r.state.value[t],oe=>{(m.flush==="sync"?u:l)&&y({storeId:t,type:Zc.direct,events:f},oe)},Kr({},c,m)));return U},$dispose:k},p=La(Kr({},E));r._s.set(t,p);const w=r._e.run(()=>(o=hS(),o.run(()=>e())));for(const y in w){const m=w[y];if(at(m)&&!X8(m)||Mi(m))s||(g&&J8(m)&&(at(m)?m.value=g[y]:e_(m,g[y])),r.state.value[t][y]=m);else if(typeof m=="function"){const U=R(y,m);w[y]=U,a.actions[y]=m}}return Kr(p,w),Kr(ke(p),w),Object.defineProperty(p,"$state",{get:()=>r.state.value[t],set:y=>{I(m=>{Kr(m,y)})}}),r._p.forEach(y=>{Kr(p,o.run(()=>y({store:p,app:r._a,pinia:r,options:a})))}),g&&s&&n.hydrate&&n.hydrate(p.$state,g),l=!0,u=!0,p}function e9(t,e,n){let r,i;const s=typeof e=="function";typeof t=="string"?(r=t,i=s?n:e):(i=t,r=t.id);function o(a,c){const l=E_();return a=a||l&&Cr(cO),a&&pp(a),a=aO,a._s.has(r)||(s?uO(r,e,i,a):Z8(r,i,a)),a._s.get(r)}return o.$id=r,o}const lh=e9({id:"university",state:()=>({univercities:[]}),actions:{getData(){this.removeAll(this.univercities,this.univercities.length),lt.firestore().collection("Univercities").orderBy("name").get().then(e=>{e.forEach(n=>{const r=n.data();this.univercities.push(r)})})},removeAll(t,e){t.splice(0,e),this.univercities=t}}});const t9={components:{NavVue:cL,WebViewer:pL},data(){return{mainNav:!0,publicPath:"/Educatia/"}},methods:{removeAll(){const t=lh();t.removeAll(t.univercities,t.univercities.length),console.log(t.univercities)},getDataFromBase(){const t=lh();t.univercities.length<1&&(this.removeAll(),t.getData())}},beforeMount(){window.addEventListener("resize",()=>{window.innerWidth<760?this.mainNav=!1:this.mainNav=!0}),lh().getData()},created(){const t=lh(),e=setInterval(this.getDataFromBase,7e3);t.univercities.length>1&&clearInterval(e)}};function n9(t,e,n,r,i,s){const o=Rg("NavVue"),a=Rg("router-view");return ol(),w_(Zn,null,[i.mainNav?(ol(),t0(o,{key:0})):nM("",!0),Vt(a)],64)}var r9=C_(t9,[["render",n9]]),i9="firebase",s9="9.9.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */lt.registerVersion(i9,s9,"app-compat");const o9={apiKey:"AIzaSyD2b62AFYQbjcAHQKD_sndun59ZC72lb8E",authDomain:"educatia-170f3.firebaseapp.com",projectId:"educatia-170f3",storageBucket:"educatia-170f3.appspot.com",messagingSenderId:"111445876419",appId:"1:111445876419:web:8c6ca1e04409a7ddf6cc76",measurementId:"G-5KM7Z5KJ8R"};lt.initializeApp(o9);const Rw=BM(r9),a9=Q8();Rw.use(a9);Rw.use(J1);Rw.mount("#app");export{Zn as F,o0 as T,C_ as _,px as a,Wn as b,w_ as c,h9 as d,t0 as e,nM as f,p9 as g,Vt as h,u9 as i,Cg as j,b_ as k,lt as l,m9 as m,f9 as n,ol as o,fx as p,g9 as q,Rg as r,c9 as t,lh as u,d9 as v,l9 as w};
