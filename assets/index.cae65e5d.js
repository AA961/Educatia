const vx=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function n(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerpolicy&&(i.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?i.credentials="include":r.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(r){if(r.ep)return;r.ep=!0;const i=n(r);fetch(r.href,i)}};vx();function h_(t,e){const n=Object.create(null),s=t.split(",");for(let r=0;r<s.length;r++)n[s[r]]=!0;return e?r=>!!n[r.toLowerCase()]:r=>!!n[r]}const wx="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",bx=h_(wx);function gS(t){return!!t||t===""}function d_(t){if(ee(t)){const e={};for(let n=0;n<t.length;n++){const s=t[n],r=yt(s)?Tx(s):d_(s);if(r)for(const i in r)e[i]=r[i]}return e}else{if(yt(t))return t;if(st(t))return t}}const Ix=/;(?![^(]*\))/g,Ex=/:(.+)/;function Tx(t){const e={};return t.split(Ix).forEach(n=>{if(n){const s=n.split(Ex);s.length>1&&(e[s[0].trim()]=s[1].trim())}}),e}function f_(t){let e="";if(yt(t))e=t;else if(ee(t))for(let n=0;n<t.length;n++){const s=f_(t[n]);s&&(e+=s+" ")}else if(st(t))for(const n in t)t[n]&&(e+=n+" ");return e.trim()}function Sx(t,e){if(t.length!==e.length)return!1;let n=!0;for(let s=0;n&&s<t.length;s++)n=ga(t[s],e[s]);return n}function ga(t,e){if(t===e)return!0;let n=jw(t),s=jw(e);if(n||s)return n&&s?t.getTime()===e.getTime():!1;if(n=ll(t),s=ll(e),n||s)return t===e;if(n=ee(t),s=ee(e),n||s)return n&&s?Sx(t,e):!1;if(n=st(t),s=st(e),n||s){if(!n||!s)return!1;const r=Object.keys(t).length,i=Object.keys(e).length;if(r!==i)return!1;for(const o in t){const a=t.hasOwnProperty(o),c=e.hasOwnProperty(o);if(a&&!c||!a&&c||!ga(t[o],e[o]))return!1}}return String(t)===String(e)}function Cx(t,e){return t.findIndex(n=>ga(n,e))}const j9=t=>yt(t)?t:t==null?"":ee(t)||st(t)&&(t.toString===yS||!le(t.toString))?JSON.stringify(t,mS,2):String(t),mS=(t,e)=>e&&e.__v_isRef?mS(t,e.value):ea(e)?{[`Map(${e.size})`]:[...e.entries()].reduce((n,[s,r])=>(n[`${s} =>`]=r,n),{})}:jd(e)?{[`Set(${e.size})`]:[...e.values()]}:st(e)&&!ee(e)&&!vS(e)?String(e):e,Me={},Zo=[],as=()=>{},Ax=()=>!1,kx=/^on[^a-z]/,qd=t=>kx.test(t),p_=t=>t.startsWith("onUpdate:"),Gt=Object.assign,g_=(t,e)=>{const n=t.indexOf(e);n>-1&&t.splice(n,1)},Rx=Object.prototype.hasOwnProperty,ve=(t,e)=>Rx.call(t,e),ee=Array.isArray,ea=t=>cu(t)==="[object Map]",jd=t=>cu(t)==="[object Set]",jw=t=>cu(t)==="[object Date]",le=t=>typeof t=="function",yt=t=>typeof t=="string",ll=t=>typeof t=="symbol",st=t=>t!==null&&typeof t=="object",_S=t=>st(t)&&le(t.then)&&le(t.catch),yS=Object.prototype.toString,cu=t=>yS.call(t),Nx=t=>cu(t).slice(8,-1),vS=t=>cu(t)==="[object Object]",m_=t=>yt(t)&&t!=="NaN"&&t[0]!=="-"&&""+parseInt(t,10)===t,vh=h_(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),Kd=t=>{const e=Object.create(null);return n=>e[n]||(e[n]=t(n))},Px=/-(\w)/g,Os=Kd(t=>t.replace(Px,(e,n)=>n?n.toUpperCase():"")),Dx=/\B([A-Z])/g,Eo=Kd(t=>t.replace(Dx,"-$1").toLowerCase()),Hd=Kd(t=>t.charAt(0).toUpperCase()+t.slice(1)),Ap=Kd(t=>t?`on${Hd(t)}`:""),ul=(t,e)=>!Object.is(t,e),ta=(t,e)=>{for(let n=0;n<t.length;n++)t[n](e)},Mh=(t,e,n)=>{Object.defineProperty(t,e,{configurable:!0,enumerable:!1,value:n})},hl=t=>{const e=parseFloat(t);return isNaN(e)?t:e};let Kw;const xx=()=>Kw||(Kw=typeof globalThis!="undefined"?globalThis:typeof self!="undefined"?self:typeof window!="undefined"?window:typeof global!="undefined"?global:{});let _s;class wS{constructor(e=!1){this.active=!0,this.effects=[],this.cleanups=[],!e&&_s&&(this.parent=_s,this.index=(_s.scopes||(_s.scopes=[])).push(this)-1)}run(e){if(this.active){const n=_s;try{return _s=this,e()}finally{_s=n}}}on(){_s=this}off(){_s=this.parent}stop(e){if(this.active){let n,s;for(n=0,s=this.effects.length;n<s;n++)this.effects[n].stop();for(n=0,s=this.cleanups.length;n<s;n++)this.cleanups[n]();if(this.scopes)for(n=0,s=this.scopes.length;n<s;n++)this.scopes[n].stop(!0);if(this.parent&&!e){const r=this.parent.scopes.pop();r&&r!==this&&(this.parent.scopes[this.index]=r,r.index=this.index)}this.active=!1}}}function bS(t){return new wS(t)}function Ox(t,e=_s){e&&e.active&&e.effects.push(t)}const __=t=>{const e=new Set(t);return e.w=0,e.n=0,e},IS=t=>(t.w&zr)>0,ES=t=>(t.n&zr)>0,Mx=({deps:t})=>{if(t.length)for(let e=0;e<t.length;e++)t[e].w|=zr},Lx=t=>{const{deps:e}=t;if(e.length){let n=0;for(let s=0;s<e.length;s++){const r=e[s];IS(r)&&!ES(r)?r.delete(t):e[n++]=r,r.w&=~zr,r.n&=~zr}e.length=n}},Dg=new WeakMap;let Nc=0,zr=1;const xg=30;let ts;const ji=Symbol(""),Og=Symbol("");class y_{constructor(e,n=null,s){this.fn=e,this.scheduler=n,this.active=!0,this.deps=[],this.parent=void 0,Ox(this,s)}run(){if(!this.active)return this.fn();let e=ts,n=$r;for(;e;){if(e===this)return;e=e.parent}try{return this.parent=ts,ts=this,$r=!0,zr=1<<++Nc,Nc<=xg?Mx(this):Hw(this),this.fn()}finally{Nc<=xg&&Lx(this),zr=1<<--Nc,ts=this.parent,$r=n,this.parent=void 0,this.deferStop&&this.stop()}}stop(){ts===this?this.deferStop=!0:this.active&&(Hw(this),this.onStop&&this.onStop(),this.active=!1)}}function Hw(t){const{deps:e}=t;if(e.length){for(let n=0;n<e.length;n++)e[n].delete(t);e.length=0}}let $r=!0;const TS=[];function Ba(){TS.push($r),$r=!1}function qa(){const t=TS.pop();$r=t===void 0?!0:t}function Dn(t,e,n){if($r&&ts){let s=Dg.get(t);s||Dg.set(t,s=new Map);let r=s.get(n);r||s.set(n,r=__()),SS(r)}}function SS(t,e){let n=!1;Nc<=xg?ES(t)||(t.n|=zr,n=!IS(t)):n=!t.has(ts),n&&(t.add(ts),ts.deps.push(t))}function or(t,e,n,s,r,i){const o=Dg.get(t);if(!o)return;let a=[];if(e==="clear")a=[...o.values()];else if(n==="length"&&ee(t))o.forEach((c,l)=>{(l==="length"||l>=s)&&a.push(c)});else switch(n!==void 0&&a.push(o.get(n)),e){case"add":ee(t)?m_(n)&&a.push(o.get("length")):(a.push(o.get(ji)),ea(t)&&a.push(o.get(Og)));break;case"delete":ee(t)||(a.push(o.get(ji)),ea(t)&&a.push(o.get(Og)));break;case"set":ea(t)&&a.push(o.get(ji));break}if(a.length===1)a[0]&&Mg(a[0]);else{const c=[];for(const l of a)l&&c.push(...l);Mg(__(c))}}function Mg(t,e){const n=ee(t)?t:[...t];for(const s of n)s.computed&&Ww(s);for(const s of n)s.computed||Ww(s)}function Ww(t,e){(t!==ts||t.allowRecurse)&&(t.scheduler?t.scheduler():t.run())}const Fx=h_("__proto__,__v_isRef,__isVue"),CS=new Set(Object.getOwnPropertyNames(Symbol).filter(t=>t!=="arguments"&&t!=="caller").map(t=>Symbol[t]).filter(ll)),Ux=v_(),$x=v_(!1,!0),Vx=v_(!0),Gw=Bx();function Bx(){const t={};return["includes","indexOf","lastIndexOf"].forEach(e=>{t[e]=function(...n){const s=Se(this);for(let i=0,o=this.length;i<o;i++)Dn(s,"get",i+"");const r=s[e](...n);return r===-1||r===!1?s[e](...n.map(Se)):r}}),["push","pop","shift","unshift","splice"].forEach(e=>{t[e]=function(...n){Ba();const s=Se(this)[e].apply(this,n);return qa(),s}}),t}function v_(t=!1,e=!1){return function(s,r,i){if(r==="__v_isReactive")return!t;if(r==="__v_isReadonly")return t;if(r==="__v_isShallow")return e;if(r==="__v_raw"&&i===(t?e?sO:PS:e?NS:RS).get(s))return s;const o=ee(s);if(!t&&o&&ve(Gw,r))return Reflect.get(Gw,r,i);const a=Reflect.get(s,r,i);return(ll(r)?CS.has(r):Fx(r))||(t||Dn(s,"get",r),e)?a:lt(a)?o&&m_(r)?a:a.value:st(a)?t?DS(a):ja(a):a}}const qx=AS(),jx=AS(!0);function AS(t=!1){return function(n,s,r,i){let o=n[s];if(dl(o)&&lt(o)&&!lt(r))return!1;if(!t&&!dl(r)&&(Lg(r)||(r=Se(r),o=Se(o)),!ee(n)&&lt(o)&&!lt(r)))return o.value=r,!0;const a=ee(n)&&m_(s)?Number(s)<n.length:ve(n,s),c=Reflect.set(n,s,r,i);return n===Se(i)&&(a?ul(r,o)&&or(n,"set",s,r):or(n,"add",s,r)),c}}function Kx(t,e){const n=ve(t,e);t[e];const s=Reflect.deleteProperty(t,e);return s&&n&&or(t,"delete",e,void 0),s}function Hx(t,e){const n=Reflect.has(t,e);return(!ll(e)||!CS.has(e))&&Dn(t,"has",e),n}function Wx(t){return Dn(t,"iterate",ee(t)?"length":ji),Reflect.ownKeys(t)}const kS={get:Ux,set:qx,deleteProperty:Kx,has:Hx,ownKeys:Wx},Gx={get:Vx,set(t,e){return!0},deleteProperty(t,e){return!0}},zx=Gt({},kS,{get:$x,set:jx}),w_=t=>t,Wd=t=>Reflect.getPrototypeOf(t);function Qu(t,e,n=!1,s=!1){t=t.__v_raw;const r=Se(t),i=Se(e);n||(e!==i&&Dn(r,"get",e),Dn(r,"get",i));const{has:o}=Wd(r),a=s?w_:n?E_:fl;if(o.call(r,e))return a(t.get(e));if(o.call(r,i))return a(t.get(i));t!==r&&t.get(e)}function Yu(t,e=!1){const n=this.__v_raw,s=Se(n),r=Se(t);return e||(t!==r&&Dn(s,"has",t),Dn(s,"has",r)),t===r?n.has(t):n.has(t)||n.has(r)}function Ju(t,e=!1){return t=t.__v_raw,!e&&Dn(Se(t),"iterate",ji),Reflect.get(t,"size",t)}function zw(t){t=Se(t);const e=Se(this);return Wd(e).has.call(e,t)||(e.add(t),or(e,"add",t,t)),this}function Qw(t,e){e=Se(e);const n=Se(this),{has:s,get:r}=Wd(n);let i=s.call(n,t);i||(t=Se(t),i=s.call(n,t));const o=r.call(n,t);return n.set(t,e),i?ul(e,o)&&or(n,"set",t,e):or(n,"add",t,e),this}function Yw(t){const e=Se(this),{has:n,get:s}=Wd(e);let r=n.call(e,t);r||(t=Se(t),r=n.call(e,t)),s&&s.call(e,t);const i=e.delete(t);return r&&or(e,"delete",t,void 0),i}function Jw(){const t=Se(this),e=t.size!==0,n=t.clear();return e&&or(t,"clear",void 0,void 0),n}function Xu(t,e){return function(s,r){const i=this,o=i.__v_raw,a=Se(o),c=e?w_:t?E_:fl;return!t&&Dn(a,"iterate",ji),o.forEach((l,u)=>s.call(r,c(l),c(u),i))}}function Zu(t,e,n){return function(...s){const r=this.__v_raw,i=Se(r),o=ea(i),a=t==="entries"||t===Symbol.iterator&&o,c=t==="keys"&&o,l=r[t](...s),u=n?w_:e?E_:fl;return!e&&Dn(i,"iterate",c?Og:ji),{next(){const{value:h,done:d}=l.next();return d?{value:h,done:d}:{value:a?[u(h[0]),u(h[1])]:u(h),done:d}},[Symbol.iterator](){return this}}}}function wr(t){return function(...e){return t==="delete"?!1:this}}function Qx(){const t={get(i){return Qu(this,i)},get size(){return Ju(this)},has:Yu,add:zw,set:Qw,delete:Yw,clear:Jw,forEach:Xu(!1,!1)},e={get(i){return Qu(this,i,!1,!0)},get size(){return Ju(this)},has:Yu,add:zw,set:Qw,delete:Yw,clear:Jw,forEach:Xu(!1,!0)},n={get(i){return Qu(this,i,!0)},get size(){return Ju(this,!0)},has(i){return Yu.call(this,i,!0)},add:wr("add"),set:wr("set"),delete:wr("delete"),clear:wr("clear"),forEach:Xu(!0,!1)},s={get(i){return Qu(this,i,!0,!0)},get size(){return Ju(this,!0)},has(i){return Yu.call(this,i,!0)},add:wr("add"),set:wr("set"),delete:wr("delete"),clear:wr("clear"),forEach:Xu(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(i=>{t[i]=Zu(i,!1,!1),n[i]=Zu(i,!0,!1),e[i]=Zu(i,!1,!0),s[i]=Zu(i,!0,!0)}),[t,n,e,s]}const[Yx,Jx,Xx,Zx]=Qx();function b_(t,e){const n=e?t?Zx:Xx:t?Jx:Yx;return(s,r,i)=>r==="__v_isReactive"?!t:r==="__v_isReadonly"?t:r==="__v_raw"?s:Reflect.get(ve(n,r)&&r in s?n:s,r,i)}const eO={get:b_(!1,!1)},tO={get:b_(!1,!0)},nO={get:b_(!0,!1)},RS=new WeakMap,NS=new WeakMap,PS=new WeakMap,sO=new WeakMap;function rO(t){switch(t){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function iO(t){return t.__v_skip||!Object.isExtensible(t)?0:rO(Nx(t))}function ja(t){return dl(t)?t:I_(t,!1,kS,eO,RS)}function oO(t){return I_(t,!1,zx,tO,NS)}function DS(t){return I_(t,!0,Gx,nO,PS)}function I_(t,e,n,s,r){if(!st(t)||t.__v_raw&&!(e&&t.__v_isReactive))return t;const i=r.get(t);if(i)return i;const o=iO(t);if(o===0)return t;const a=new Proxy(t,o===2?s:n);return r.set(t,a),a}function Vr(t){return dl(t)?Vr(t.__v_raw):!!(t&&t.__v_isReactive)}function dl(t){return!!(t&&t.__v_isReadonly)}function Lg(t){return!!(t&&t.__v_isShallow)}function xS(t){return Vr(t)||dl(t)}function Se(t){const e=t&&t.__v_raw;return e?Se(e):t}function ma(t){return Mh(t,"__v_skip",!0),t}const fl=t=>st(t)?ja(t):t,E_=t=>st(t)?DS(t):t;function OS(t){$r&&ts&&(t=Se(t),SS(t.dep||(t.dep=__())))}function MS(t,e){t=Se(t),t.dep&&Mg(t.dep)}function lt(t){return!!(t&&t.__v_isRef===!0)}function T_(t){return LS(t,!1)}function aO(t){return LS(t,!0)}function LS(t,e){return lt(t)?t:new cO(t,e)}class cO{constructor(e,n){this.__v_isShallow=n,this.dep=void 0,this.__v_isRef=!0,this._rawValue=n?e:Se(e),this._value=n?e:fl(e)}get value(){return OS(this),this._value}set value(e){e=this.__v_isShallow?e:Se(e),ul(e,this._rawValue)&&(this._rawValue=e,this._value=this.__v_isShallow?e:fl(e),MS(this))}}function Uc(t){return lt(t)?t.value:t}const lO={get:(t,e,n)=>Uc(Reflect.get(t,e,n)),set:(t,e,n,s)=>{const r=t[e];return lt(r)&&!lt(n)?(r.value=n,!0):Reflect.set(t,e,n,s)}};function FS(t){return Vr(t)?t:new Proxy(t,lO)}function uO(t){const e=ee(t)?new Array(t.length):{};for(const n in t)e[n]=dO(t,n);return e}class hO{constructor(e,n,s){this._object=e,this._key=n,this._defaultValue=s,this.__v_isRef=!0}get value(){const e=this._object[this._key];return e===void 0?this._defaultValue:e}set value(e){this._object[this._key]=e}}function dO(t,e,n){const s=t[e];return lt(s)?s:new hO(t,e,n)}class fO{constructor(e,n,s,r){this._setter=n,this.dep=void 0,this.__v_isRef=!0,this._dirty=!0,this.effect=new y_(e,()=>{this._dirty||(this._dirty=!0,MS(this))}),this.effect.computed=this,this.effect.active=this._cacheable=!r,this.__v_isReadonly=s}get value(){const e=Se(this);return OS(e),(e._dirty||!e._cacheable)&&(e._dirty=!1,e._value=e.effect.run()),e._value}set value(e){this._setter(e)}}function pO(t,e,n=!1){let s,r;const i=le(t);return i?(s=t,r=as):(s=t.get,r=t.set),new fO(s,r,i||!r,n)}function Br(t,e,n,s){let r;try{r=s?t(...s):t()}catch(i){Gd(i,e,n)}return r}function Hn(t,e,n,s){if(le(t)){const i=Br(t,e,n,s);return i&&_S(i)&&i.catch(o=>{Gd(o,e,n)}),i}const r=[];for(let i=0;i<t.length;i++)r.push(Hn(t[i],e,n,s));return r}function Gd(t,e,n,s=!0){const r=e?e.vnode:null;if(e){let i=e.parent;const o=e.proxy,a=n;for(;i;){const l=i.ec;if(l){for(let u=0;u<l.length;u++)if(l[u](t,o,a)===!1)return}i=i.parent}const c=e.appContext.config.errorHandler;if(c){Br(c,null,10,[t,o,a]);return}}gO(t,n,r,s)}function gO(t,e,n,s=!0){console.error(t)}let Lh=!1,Fg=!1;const An=[];let Qs=0;const $c=[];let Pc=null,Wo=0;const Vc=[];let kr=null,Go=0;const US=Promise.resolve();let S_=null,Ug=null;function C_(t){const e=S_||US;return t?e.then(this?t.bind(this):t):e}function mO(t){let e=Qs+1,n=An.length;for(;e<n;){const s=e+n>>>1;pl(An[s])<t?e=s+1:n=s}return e}function $S(t){(!An.length||!An.includes(t,Lh&&t.allowRecurse?Qs+1:Qs))&&t!==Ug&&(t.id==null?An.push(t):An.splice(mO(t.id),0,t),VS())}function VS(){!Lh&&!Fg&&(Fg=!0,S_=US.then(jS))}function _O(t){const e=An.indexOf(t);e>Qs&&An.splice(e,1)}function BS(t,e,n,s){ee(t)?n.push(...t):(!e||!e.includes(t,t.allowRecurse?s+1:s))&&n.push(t),VS()}function yO(t){BS(t,Pc,$c,Wo)}function vO(t){BS(t,kr,Vc,Go)}function zd(t,e=null){if($c.length){for(Ug=e,Pc=[...new Set($c)],$c.length=0,Wo=0;Wo<Pc.length;Wo++)Pc[Wo]();Pc=null,Wo=0,Ug=null,zd(t,e)}}function qS(t){if(zd(),Vc.length){const e=[...new Set(Vc)];if(Vc.length=0,kr){kr.push(...e);return}for(kr=e,kr.sort((n,s)=>pl(n)-pl(s)),Go=0;Go<kr.length;Go++)kr[Go]();kr=null,Go=0}}const pl=t=>t.id==null?1/0:t.id;function jS(t){Fg=!1,Lh=!0,zd(t),An.sort((n,s)=>pl(n)-pl(s));const e=as;try{for(Qs=0;Qs<An.length;Qs++){const n=An[Qs];n&&n.active!==!1&&Br(n,null,14)}}finally{Qs=0,An.length=0,qS(),Lh=!1,S_=null,(An.length||$c.length||Vc.length)&&jS(t)}}function wO(t,e,...n){if(t.isUnmounted)return;const s=t.vnode.props||Me;let r=n;const i=e.startsWith("update:"),o=i&&e.slice(7);if(o&&o in s){const u=`${o==="modelValue"?"model":o}Modifiers`,{number:h,trim:d}=s[u]||Me;d&&(r=n.map(f=>f.trim())),h&&(r=n.map(hl))}let a,c=s[a=Ap(e)]||s[a=Ap(Os(e))];!c&&i&&(c=s[a=Ap(Eo(e))]),c&&Hn(c,t,6,r);const l=s[a+"Once"];if(l){if(!t.emitted)t.emitted={};else if(t.emitted[a])return;t.emitted[a]=!0,Hn(l,t,6,r)}}function KS(t,e,n=!1){const s=e.emitsCache,r=s.get(t);if(r!==void 0)return r;const i=t.emits;let o={},a=!1;if(!le(t)){const c=l=>{const u=KS(l,e,!0);u&&(a=!0,Gt(o,u))};!n&&e.mixins.length&&e.mixins.forEach(c),t.extends&&c(t.extends),t.mixins&&t.mixins.forEach(c)}return!i&&!a?(s.set(t,null),null):(ee(i)?i.forEach(c=>o[c]=null):Gt(o,i),s.set(t,o),o)}function Qd(t,e){return!t||!qd(e)?!1:(e=e.slice(2).replace(/Once$/,""),ve(t,e[0].toLowerCase()+e.slice(1))||ve(t,Eo(e))||ve(t,e))}let Vn=null,Yd=null;function Fh(t){const e=Vn;return Vn=t,Yd=t&&t.type.__scopeId||null,e}function A_(t){Yd=t}function k_(){Yd=null}function ss(t,e=Vn,n){if(!e||t._n)return t;const s=(...r)=>{s._d&&cb(-1);const i=Fh(e),o=t(...r);return Fh(i),s._d&&cb(1),o};return s._n=!0,s._c=!0,s._d=!0,s}function kp(t){const{type:e,vnode:n,proxy:s,withProxy:r,props:i,propsOptions:[o],slots:a,attrs:c,emit:l,render:u,renderCache:h,data:d,setupState:f,ctx:p,inheritAttrs:_}=t;let y,T;const I=Fh(t);try{if(n.shapeFlag&4){const S=r||s;y=ys(u.call(S,S,h,i,f,d,p)),T=c}else{const S=e;y=ys(S.length>1?S(i,{attrs:c,slots:a,emit:l}):S(i,null)),T=e.props?c:bO(c)}}catch(S){qc.length=0,Gd(S,t,1),y=qe(cs)}let E=y;if(T&&_!==!1){const S=Object.keys(T),{shapeFlag:$}=E;S.length&&$&7&&(o&&S.some(p_)&&(T=IO(T,o)),E=ar(E,T))}return n.dirs&&(E=ar(E),E.dirs=E.dirs?E.dirs.concat(n.dirs):n.dirs),n.transition&&(E.transition=n.transition),y=E,Fh(I),y}const bO=t=>{let e;for(const n in t)(n==="class"||n==="style"||qd(n))&&((e||(e={}))[n]=t[n]);return e},IO=(t,e)=>{const n={};for(const s in t)(!p_(s)||!(s.slice(9)in e))&&(n[s]=t[s]);return n};function EO(t,e,n){const{props:s,children:r,component:i}=t,{props:o,children:a,patchFlag:c}=e,l=i.emitsOptions;if(e.dirs||e.transition)return!0;if(n&&c>=0){if(c&1024)return!0;if(c&16)return s?Xw(s,o,l):!!o;if(c&8){const u=e.dynamicProps;for(let h=0;h<u.length;h++){const d=u[h];if(o[d]!==s[d]&&!Qd(l,d))return!0}}}else return(r||a)&&(!a||!a.$stable)?!0:s===o?!1:s?o?Xw(s,o,l):!0:!!o;return!1}function Xw(t,e,n){const s=Object.keys(e);if(s.length!==Object.keys(t).length)return!0;for(let r=0;r<s.length;r++){const i=s[r];if(e[i]!==t[i]&&!Qd(n,i))return!0}return!1}function TO({vnode:t,parent:e},n){for(;e&&e.subTree===t;)(t=e.vnode).el=n,e=e.parent}const HS=t=>t.__isSuspense;function SO(t,e){e&&e.pendingBranch?ee(t)?e.effects.push(...t):e.effects.push(t):vO(t)}function wh(t,e){if(At){let n=At.provides;const s=At.parent&&At.parent.provides;s===n&&(n=At.provides=Object.create(s)),n[t]=e}}function ks(t,e,n=!1){const s=At||Vn;if(s){const r=s.parent==null?s.vnode.appContext&&s.vnode.appContext.provides:s.parent.provides;if(r&&t in r)return r[t];if(arguments.length>1)return n&&le(e)?e.call(s.proxy):e}}const Zw={};function na(t,e,n){return WS(t,e,n)}function WS(t,e,{immediate:n,deep:s,flush:r,onTrack:i,onTrigger:o}=Me){const a=At;let c,l=!1,u=!1;if(lt(t)?(c=()=>t.value,l=Lg(t)):Vr(t)?(c=()=>t,s=!0):ee(t)?(u=!0,l=t.some(T=>Vr(T)||Lg(T)),c=()=>t.map(T=>{if(lt(T))return T.value;if(Vr(T))return Mi(T);if(le(T))return Br(T,a,2)})):le(t)?e?c=()=>Br(t,a,2):c=()=>{if(!(a&&a.isUnmounted))return h&&h(),Hn(t,a,3,[d])}:c=as,e&&s){const T=c;c=()=>Mi(T())}let h,d=T=>{h=y.onStop=()=>{Br(T,a,4)}};if(ml)return d=as,e?n&&Hn(e,a,3,[c(),u?[]:void 0,d]):c(),as;let f=u?[]:Zw;const p=()=>{if(!!y.active)if(e){const T=y.run();(s||l||(u?T.some((I,E)=>ul(I,f[E])):ul(T,f)))&&(h&&h(),Hn(e,a,3,[T,f===Zw?void 0:f,d]),f=T)}else y.run()};p.allowRecurse=!!e;let _;r==="sync"?_=p:r==="post"?_=()=>$t(p,a&&a.suspense):_=()=>yO(p);const y=new y_(c,_);return e?n?p():f=y.run():r==="post"?$t(y.run.bind(y),a&&a.suspense):y.run(),()=>{y.stop(),a&&a.scope&&g_(a.scope.effects,y)}}function CO(t,e,n){const s=this.proxy,r=yt(t)?t.includes(".")?GS(s,t):()=>s[t]:t.bind(s,s);let i;le(e)?i=e:(i=e.handler,n=e);const o=At;ya(this);const a=WS(r,i.bind(s),n);return o?ya(o):Ki(),a}function GS(t,e){const n=e.split(".");return()=>{let s=t;for(let r=0;r<n.length&&s;r++)s=s[n[r]];return s}}function Mi(t,e){if(!st(t)||t.__v_skip||(e=e||new Set,e.has(t)))return t;if(e.add(t),lt(t))Mi(t.value,e);else if(ee(t))for(let n=0;n<t.length;n++)Mi(t[n],e);else if(jd(t)||ea(t))t.forEach(n=>{Mi(n,e)});else if(vS(t))for(const n in t)Mi(t[n],e);return t}function AO(){const t={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return R_(()=>{t.isMounted=!0}),N_(()=>{t.isUnmounting=!0}),t}const Fn=[Function,Array],kO={name:"BaseTransition",props:{mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:Fn,onEnter:Fn,onAfterEnter:Fn,onEnterCancelled:Fn,onBeforeLeave:Fn,onLeave:Fn,onAfterLeave:Fn,onLeaveCancelled:Fn,onBeforeAppear:Fn,onAppear:Fn,onAfterAppear:Fn,onAppearCancelled:Fn},setup(t,{slots:e}){const n=ef(),s=AO();let r;return()=>{const i=e.default&&YS(e.default(),!0);if(!i||!i.length)return;let o=i[0];if(i.length>1){for(const _ of i)if(_.type!==cs){o=_;break}}const a=Se(t),{mode:c}=a;if(s.isLeaving)return Rp(o);const l=eb(o);if(!l)return Rp(o);const u=$g(l,a,s,n);Uh(l,u);const h=n.subTree,d=h&&eb(h);let f=!1;const{getTransitionKey:p}=l.type;if(p){const _=p();r===void 0?r=_:_!==r&&(r=_,f=!0)}if(d&&d.type!==cs&&(!ki(l,d)||f)){const _=$g(d,a,s,n);if(Uh(d,_),c==="out-in")return s.isLeaving=!0,_.afterLeave=()=>{s.isLeaving=!1,n.update()},Rp(o);c==="in-out"&&l.type!==cs&&(_.delayLeave=(y,T,I)=>{const E=QS(s,d);E[String(d.key)]=d,y._leaveCb=()=>{T(),y._leaveCb=void 0,delete u.delayedLeave},u.delayedLeave=I})}return o}}},zS=kO;function QS(t,e){const{leavingVNodes:n}=t;let s=n.get(e.type);return s||(s=Object.create(null),n.set(e.type,s)),s}function $g(t,e,n,s){const{appear:r,mode:i,persisted:o=!1,onBeforeEnter:a,onEnter:c,onAfterEnter:l,onEnterCancelled:u,onBeforeLeave:h,onLeave:d,onAfterLeave:f,onLeaveCancelled:p,onBeforeAppear:_,onAppear:y,onAfterAppear:T,onAppearCancelled:I}=e,E=String(t.key),S=QS(n,t),$=(F,ne)=>{F&&Hn(F,s,9,ne)},H=(F,ne)=>{const he=ne[1];$(F,ne),ee(F)?F.every(Ce=>Ce.length<=1)&&he():F.length<=1&&he()},K={mode:i,persisted:o,beforeEnter(F){let ne=a;if(!n.isMounted)if(r)ne=_||a;else return;F._leaveCb&&F._leaveCb(!0);const he=S[E];he&&ki(t,he)&&he.el._leaveCb&&he.el._leaveCb(),$(ne,[F])},enter(F){let ne=c,he=l,Ce=u;if(!n.isMounted)if(r)ne=y||c,he=T||l,Ce=I||u;else return;let z=!1;const Re=F._enterCb=Ze=>{z||(z=!0,Ze?$(Ce,[F]):$(he,[F]),K.delayedLeave&&K.delayedLeave(),F._enterCb=void 0)};ne?H(ne,[F,Re]):Re()},leave(F,ne){const he=String(t.key);if(F._enterCb&&F._enterCb(!0),n.isUnmounting)return ne();$(h,[F]);let Ce=!1;const z=F._leaveCb=Re=>{Ce||(Ce=!0,ne(),Re?$(p,[F]):$(f,[F]),F._leaveCb=void 0,S[he]===t&&delete S[he])};S[he]=t,d?H(d,[F,z]):z()},clone(F){return $g(F,e,n,s)}};return K}function Rp(t){if(Jd(t))return t=ar(t),t.children=null,t}function eb(t){return Jd(t)?t.children?t.children[0]:void 0:t}function Uh(t,e){t.shapeFlag&6&&t.component?Uh(t.component.subTree,e):t.shapeFlag&128?(t.ssContent.transition=e.clone(t.ssContent),t.ssFallback.transition=e.clone(t.ssFallback)):t.transition=e}function YS(t,e=!1,n){let s=[],r=0;for(let i=0;i<t.length;i++){let o=t[i];const a=n==null?o.key:String(n)+String(o.key!=null?o.key:i);o.type===es?(o.patchFlag&128&&r++,s=s.concat(YS(o.children,e,a))):(e||o.type!==cs)&&s.push(a!=null?ar(o,{key:a}):o)}if(r>1)for(let i=0;i<s.length;i++)s[i].patchFlag=-2;return s}function JS(t){return le(t)?{setup:t,name:t.name}:t}const Bc=t=>!!t.type.__asyncLoader,Jd=t=>t.type.__isKeepAlive,RO={name:"KeepAlive",__isKeepAlive:!0,props:{include:[String,RegExp,Array],exclude:[String,RegExp,Array],max:[String,Number]},setup(t,{slots:e}){const n=ef(),s=n.ctx;if(!s.renderer)return()=>{const I=e.default&&e.default();return I&&I.length===1?I[0]:I};const r=new Map,i=new Set;let o=null;const a=n.suspense,{renderer:{p:c,m:l,um:u,o:{createElement:h}}}=s,d=h("div");s.activate=(I,E,S,$,H)=>{const K=I.component;l(I,E,S,0,a),c(K.vnode,I,E,S,K,a,$,I.slotScopeIds,H),$t(()=>{K.isDeactivated=!1,K.a&&ta(K.a);const F=I.props&&I.props.onVnodeMounted;F&&Un(F,K.parent,I)},a)},s.deactivate=I=>{const E=I.component;l(I,d,null,1,a),$t(()=>{E.da&&ta(E.da);const S=I.props&&I.props.onVnodeUnmounted;S&&Un(S,E.parent,I),E.isDeactivated=!0},a)};function f(I){Np(I),u(I,n,a,!0)}function p(I){r.forEach((E,S)=>{const $=Hg(E.type);$&&(!I||!I($))&&_(S)})}function _(I){const E=r.get(I);!o||E.type!==o.type?f(E):o&&Np(o),r.delete(I),i.delete(I)}na(()=>[t.include,t.exclude],([I,E])=>{I&&p(S=>Dc(I,S)),E&&p(S=>!Dc(E,S))},{flush:"post",deep:!0});let y=null;const T=()=>{y!=null&&r.set(y,Pp(n.subTree))};return R_(T),ZS(T),N_(()=>{r.forEach(I=>{const{subTree:E,suspense:S}=n,$=Pp(E);if(I.type===$.type){Np($);const H=$.component.da;H&&$t(H,S);return}f(I)})}),()=>{if(y=null,!e.default)return null;const I=e.default(),E=I[0];if(I.length>1)return o=null,I;if(!Bh(E)||!(E.shapeFlag&4)&&!(E.shapeFlag&128))return o=null,E;let S=Pp(E);const $=S.type,H=Hg(Bc(S)?S.type.__asyncResolved||{}:$),{include:K,exclude:F,max:ne}=t;if(K&&(!H||!Dc(K,H))||F&&H&&Dc(F,H))return o=S,E;const he=S.key==null?$:S.key,Ce=r.get(he);return S.el&&(S=ar(S),E.shapeFlag&128&&(E.ssContent=S)),y=he,Ce?(S.el=Ce.el,S.component=Ce.component,S.transition&&Uh(S,S.transition),S.shapeFlag|=512,i.delete(he),i.add(he)):(i.add(he),ne&&i.size>parseInt(ne,10)&&_(i.values().next().value)),S.shapeFlag|=256,o=S,HS(E.type)?E:S}}},K9=RO;function Dc(t,e){return ee(t)?t.some(n=>Dc(n,e)):yt(t)?t.split(",").includes(e):t.test?t.test(e):!1}function NO(t,e){XS(t,"a",e)}function PO(t,e){XS(t,"da",e)}function XS(t,e,n=At){const s=t.__wdc||(t.__wdc=()=>{let r=n;for(;r;){if(r.isDeactivated)return;r=r.parent}return t()});if(Xd(e,s,n),n){let r=n.parent;for(;r&&r.parent;)Jd(r.parent.vnode)&&DO(s,e,n,r),r=r.parent}}function DO(t,e,n,s){const r=Xd(e,t,s,!0);P_(()=>{g_(s[e],r)},n)}function Np(t){let e=t.shapeFlag;e&256&&(e-=256),e&512&&(e-=512),t.shapeFlag=e}function Pp(t){return t.shapeFlag&128?t.ssContent:t}function Xd(t,e,n=At,s=!1){if(n){const r=n[t]||(n[t]=[]),i=e.__weh||(e.__weh=(...o)=>{if(n.isUnmounted)return;Ba(),ya(n);const a=Hn(e,n,t,o);return Ki(),qa(),a});return s?r.unshift(i):r.push(i),i}}const fr=t=>(e,n=At)=>(!ml||t==="sp")&&Xd(t,e,n),xO=fr("bm"),R_=fr("m"),OO=fr("bu"),ZS=fr("u"),N_=fr("bum"),P_=fr("um"),MO=fr("sp"),LO=fr("rtg"),FO=fr("rtc");function UO(t,e=At){Xd("ec",t,e)}function H9(t,e){const n=Vn;if(n===null)return t;const s=tf(n)||n.proxy,r=t.dirs||(t.dirs=[]);for(let i=0;i<e.length;i++){let[o,a,c,l=Me]=e[i];le(o)&&(o={mounted:o,updated:o}),o.deep&&Mi(a),r.push({dir:o,instance:s,value:a,oldValue:void 0,arg:c,modifiers:l})}return t}function _i(t,e,n,s){const r=t.dirs,i=e&&e.dirs;for(let o=0;o<r.length;o++){const a=r[o];i&&(a.oldValue=i[o].value);let c=a.dir[s];c&&(Ba(),Hn(c,n,8,[t.el,a,t,e]),qa())}}const e0="components";function Pr(t,e){return VO(e0,t,!0,e)||t}const $O=Symbol();function VO(t,e,n=!0,s=!1){const r=Vn||At;if(r){const i=r.type;if(t===e0){const a=Hg(i,!1);if(a&&(a===e||a===Os(e)||a===Hd(Os(e))))return i}const o=tb(r[t]||i[t],e)||tb(r.appContext[t],e);return!o&&s?i:o}}function tb(t,e){return t&&(t[e]||t[Os(e)]||t[Hd(Os(e))])}function W9(t,e,n,s){let r;const i=n&&n[s];if(ee(t)||yt(t)){r=new Array(t.length);for(let o=0,a=t.length;o<a;o++)r[o]=e(t[o],o,void 0,i&&i[o])}else if(typeof t=="number"){r=new Array(t);for(let o=0;o<t;o++)r[o]=e(o+1,o,void 0,i&&i[o])}else if(st(t))if(t[Symbol.iterator])r=Array.from(t,(o,a)=>e(o,a,void 0,i&&i[a]));else{const o=Object.keys(t);r=new Array(o.length);for(let a=0,c=o.length;a<c;a++){const l=o[a];r[a]=e(t[l],l,a,i&&i[a])}}else r=[];return n&&(n[s]=r),r}const Vg=t=>t?d0(t)?tf(t)||t.proxy:Vg(t.parent):null,$h=Gt(Object.create(null),{$:t=>t,$el:t=>t.vnode.el,$data:t=>t.data,$props:t=>t.props,$attrs:t=>t.attrs,$slots:t=>t.slots,$refs:t=>t.refs,$parent:t=>Vg(t.parent),$root:t=>Vg(t.root),$emit:t=>t.emit,$options:t=>n0(t),$forceUpdate:t=>t.f||(t.f=()=>$S(t.update)),$nextTick:t=>t.n||(t.n=C_.bind(t.proxy)),$watch:t=>CO.bind(t)}),BO={get({_:t},e){const{ctx:n,setupState:s,data:r,props:i,accessCache:o,type:a,appContext:c}=t;let l;if(e[0]!=="$"){const f=o[e];if(f!==void 0)switch(f){case 1:return s[e];case 2:return r[e];case 4:return n[e];case 3:return i[e]}else{if(s!==Me&&ve(s,e))return o[e]=1,s[e];if(r!==Me&&ve(r,e))return o[e]=2,r[e];if((l=t.propsOptions[0])&&ve(l,e))return o[e]=3,i[e];if(n!==Me&&ve(n,e))return o[e]=4,n[e];Bg&&(o[e]=0)}}const u=$h[e];let h,d;if(u)return e==="$attrs"&&Dn(t,"get",e),u(t);if((h=a.__cssModules)&&(h=h[e]))return h;if(n!==Me&&ve(n,e))return o[e]=4,n[e];if(d=c.config.globalProperties,ve(d,e))return d[e]},set({_:t},e,n){const{data:s,setupState:r,ctx:i}=t;return r!==Me&&ve(r,e)?(r[e]=n,!0):s!==Me&&ve(s,e)?(s[e]=n,!0):ve(t.props,e)||e[0]==="$"&&e.slice(1)in t?!1:(i[e]=n,!0)},has({_:{data:t,setupState:e,accessCache:n,ctx:s,appContext:r,propsOptions:i}},o){let a;return!!n[o]||t!==Me&&ve(t,o)||e!==Me&&ve(e,o)||(a=i[0])&&ve(a,o)||ve(s,o)||ve($h,o)||ve(r.config.globalProperties,o)},defineProperty(t,e,n){return n.get!=null?t._.accessCache[e]=0:ve(n,"value")&&this.set(t,e,n.value,null),Reflect.defineProperty(t,e,n)}};let Bg=!0;function qO(t){const e=n0(t),n=t.proxy,s=t.ctx;Bg=!1,e.beforeCreate&&nb(e.beforeCreate,t,"bc");const{data:r,computed:i,methods:o,watch:a,provide:c,inject:l,created:u,beforeMount:h,mounted:d,beforeUpdate:f,updated:p,activated:_,deactivated:y,beforeDestroy:T,beforeUnmount:I,destroyed:E,unmounted:S,render:$,renderTracked:H,renderTriggered:K,errorCaptured:F,serverPrefetch:ne,expose:he,inheritAttrs:Ce,components:z,directives:Re,filters:Ze}=e;if(l&&jO(l,s,null,t.appContext.config.unwrapInjectedRef),o)for(const Ue in o){const Ne=o[Ue];le(Ne)&&(s[Ue]=Ne.bind(n))}if(r){const Ue=r.call(n,n);st(Ue)&&(t.data=ja(Ue))}if(Bg=!0,i)for(const Ue in i){const Ne=i[Ue],Tn=le(Ne)?Ne.bind(n,n):le(Ne.get)?Ne.get.bind(n,n):as,Lo=!le(Ne)&&le(Ne.set)?Ne.set.bind(n):as,Hs=ns({get:Tn,set:Lo});Object.defineProperty(s,Ue,{enumerable:!0,configurable:!0,get:()=>Hs.value,set:ps=>Hs.value=ps})}if(a)for(const Ue in a)t0(a[Ue],s,n,Ue);if(c){const Ue=le(c)?c.call(n):c;Reflect.ownKeys(Ue).forEach(Ne=>{wh(Ne,Ue[Ne])})}u&&nb(u,t,"c");function tt(Ue,Ne){ee(Ne)?Ne.forEach(Tn=>Ue(Tn.bind(n))):Ne&&Ue(Ne.bind(n))}if(tt(xO,h),tt(R_,d),tt(OO,f),tt(ZS,p),tt(NO,_),tt(PO,y),tt(UO,F),tt(FO,H),tt(LO,K),tt(N_,I),tt(P_,S),tt(MO,ne),ee(he))if(he.length){const Ue=t.exposed||(t.exposed={});he.forEach(Ne=>{Object.defineProperty(Ue,Ne,{get:()=>n[Ne],set:Tn=>n[Ne]=Tn})})}else t.exposed||(t.exposed={});$&&t.render===as&&(t.render=$),Ce!=null&&(t.inheritAttrs=Ce),z&&(t.components=z),Re&&(t.directives=Re)}function jO(t,e,n=as,s=!1){ee(t)&&(t=qg(t));for(const r in t){const i=t[r];let o;st(i)?"default"in i?o=ks(i.from||r,i.default,!0):o=ks(i.from||r):o=ks(i),lt(o)&&s?Object.defineProperty(e,r,{enumerable:!0,configurable:!0,get:()=>o.value,set:a=>o.value=a}):e[r]=o}}function nb(t,e,n){Hn(ee(t)?t.map(s=>s.bind(e.proxy)):t.bind(e.proxy),e,n)}function t0(t,e,n,s){const r=s.includes(".")?GS(n,s):()=>n[s];if(yt(t)){const i=e[t];le(i)&&na(r,i)}else if(le(t))na(r,t.bind(n));else if(st(t))if(ee(t))t.forEach(i=>t0(i,e,n,s));else{const i=le(t.handler)?t.handler.bind(n):e[t.handler];le(i)&&na(r,i,t)}}function n0(t){const e=t.type,{mixins:n,extends:s}=e,{mixins:r,optionsCache:i,config:{optionMergeStrategies:o}}=t.appContext,a=i.get(e);let c;return a?c=a:!r.length&&!n&&!s?c=e:(c={},r.length&&r.forEach(l=>Vh(c,l,o,!0)),Vh(c,e,o)),i.set(e,c),c}function Vh(t,e,n,s=!1){const{mixins:r,extends:i}=e;i&&Vh(t,i,n,!0),r&&r.forEach(o=>Vh(t,o,n,!0));for(const o in e)if(!(s&&o==="expose")){const a=KO[o]||n&&n[o];t[o]=a?a(t[o],e[o]):e[o]}return t}const KO={data:sb,props:Ei,emits:Ei,methods:Ei,computed:Ei,beforeCreate:nn,created:nn,beforeMount:nn,mounted:nn,beforeUpdate:nn,updated:nn,beforeDestroy:nn,beforeUnmount:nn,destroyed:nn,unmounted:nn,activated:nn,deactivated:nn,errorCaptured:nn,serverPrefetch:nn,components:Ei,directives:Ei,watch:WO,provide:sb,inject:HO};function sb(t,e){return e?t?function(){return Gt(le(t)?t.call(this,this):t,le(e)?e.call(this,this):e)}:e:t}function HO(t,e){return Ei(qg(t),qg(e))}function qg(t){if(ee(t)){const e={};for(let n=0;n<t.length;n++)e[t[n]]=t[n];return e}return t}function nn(t,e){return t?[...new Set([].concat(t,e))]:e}function Ei(t,e){return t?Gt(Gt(Object.create(null),t),e):e}function WO(t,e){if(!t)return e;if(!e)return t;const n=Gt(Object.create(null),t);for(const s in e)n[s]=nn(t[s],e[s]);return n}function GO(t,e,n,s=!1){const r={},i={};Mh(i,Zd,1),t.propsDefaults=Object.create(null),s0(t,e,r,i);for(const o in t.propsOptions[0])o in r||(r[o]=void 0);n?t.props=s?r:oO(r):t.type.props?t.props=r:t.props=i,t.attrs=i}function zO(t,e,n,s){const{props:r,attrs:i,vnode:{patchFlag:o}}=t,a=Se(r),[c]=t.propsOptions;let l=!1;if((s||o>0)&&!(o&16)){if(o&8){const u=t.vnode.dynamicProps;for(let h=0;h<u.length;h++){let d=u[h];if(Qd(t.emitsOptions,d))continue;const f=e[d];if(c)if(ve(i,d))f!==i[d]&&(i[d]=f,l=!0);else{const p=Os(d);r[p]=jg(c,a,p,f,t,!1)}else f!==i[d]&&(i[d]=f,l=!0)}}}else{s0(t,e,r,i)&&(l=!0);let u;for(const h in a)(!e||!ve(e,h)&&((u=Eo(h))===h||!ve(e,u)))&&(c?n&&(n[h]!==void 0||n[u]!==void 0)&&(r[h]=jg(c,a,h,void 0,t,!0)):delete r[h]);if(i!==a)for(const h in i)(!e||!ve(e,h)&&!0)&&(delete i[h],l=!0)}l&&or(t,"set","$attrs")}function s0(t,e,n,s){const[r,i]=t.propsOptions;let o=!1,a;if(e)for(let c in e){if(vh(c))continue;const l=e[c];let u;r&&ve(r,u=Os(c))?!i||!i.includes(u)?n[u]=l:(a||(a={}))[u]=l:Qd(t.emitsOptions,c)||(!(c in s)||l!==s[c])&&(s[c]=l,o=!0)}if(i){const c=Se(n),l=a||Me;for(let u=0;u<i.length;u++){const h=i[u];n[h]=jg(r,c,h,l[h],t,!ve(l,h))}}return o}function jg(t,e,n,s,r,i){const o=t[n];if(o!=null){const a=ve(o,"default");if(a&&s===void 0){const c=o.default;if(o.type!==Function&&le(c)){const{propsDefaults:l}=r;n in l?s=l[n]:(ya(r),s=l[n]=c.call(null,e),Ki())}else s=c}o[0]&&(i&&!a?s=!1:o[1]&&(s===""||s===Eo(n))&&(s=!0))}return s}function r0(t,e,n=!1){const s=e.propsCache,r=s.get(t);if(r)return r;const i=t.props,o={},a=[];let c=!1;if(!le(t)){const u=h=>{c=!0;const[d,f]=r0(h,e,!0);Gt(o,d),f&&a.push(...f)};!n&&e.mixins.length&&e.mixins.forEach(u),t.extends&&u(t.extends),t.mixins&&t.mixins.forEach(u)}if(!i&&!c)return s.set(t,Zo),Zo;if(ee(i))for(let u=0;u<i.length;u++){const h=Os(i[u]);rb(h)&&(o[h]=Me)}else if(i)for(const u in i){const h=Os(u);if(rb(h)){const d=i[u],f=o[h]=ee(d)||le(d)?{type:d}:d;if(f){const p=ab(Boolean,f.type),_=ab(String,f.type);f[0]=p>-1,f[1]=_<0||p<_,(p>-1||ve(f,"default"))&&a.push(h)}}}const l=[o,a];return s.set(t,l),l}function rb(t){return t[0]!=="$"}function ib(t){const e=t&&t.toString().match(/^\s*function (\w+)/);return e?e[1]:t===null?"null":""}function ob(t,e){return ib(t)===ib(e)}function ab(t,e){return ee(e)?e.findIndex(n=>ob(n,t)):le(e)&&ob(e,t)?0:-1}const i0=t=>t[0]==="_"||t==="$stable",D_=t=>ee(t)?t.map(ys):[ys(t)],QO=(t,e,n)=>{if(e._n)return e;const s=ss((...r)=>D_(e(...r)),n);return s._c=!1,s},o0=(t,e,n)=>{const s=t._ctx;for(const r in t){if(i0(r))continue;const i=t[r];if(le(i))e[r]=QO(r,i,s);else if(i!=null){const o=D_(i);e[r]=()=>o}}},a0=(t,e)=>{const n=D_(e);t.slots.default=()=>n},YO=(t,e)=>{if(t.vnode.shapeFlag&32){const n=e._;n?(t.slots=Se(e),Mh(e,"_",n)):o0(e,t.slots={})}else t.slots={},e&&a0(t,e);Mh(t.slots,Zd,1)},JO=(t,e,n)=>{const{vnode:s,slots:r}=t;let i=!0,o=Me;if(s.shapeFlag&32){const a=e._;a?n&&a===1?i=!1:(Gt(r,e),!n&&a===1&&delete r._):(i=!e.$stable,o0(e,r)),o=e}else e&&(a0(t,e),o={default:1});if(i)for(const a in r)!i0(a)&&!(a in o)&&delete r[a]};function c0(){return{app:null,config:{isNativeTag:Ax,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let XO=0;function ZO(t,e){return function(s,r=null){le(s)||(s=Object.assign({},s)),r!=null&&!st(r)&&(r=null);const i=c0(),o=new Set;let a=!1;const c=i.app={_uid:XO++,_component:s,_props:r,_container:null,_context:i,_instance:null,version:_M,get config(){return i.config},set config(l){},use(l,...u){return o.has(l)||(l&&le(l.install)?(o.add(l),l.install(c,...u)):le(l)&&(o.add(l),l(c,...u))),c},mixin(l){return i.mixins.includes(l)||i.mixins.push(l),c},component(l,u){return u?(i.components[l]=u,c):i.components[l]},directive(l,u){return u?(i.directives[l]=u,c):i.directives[l]},mount(l,u,h){if(!a){const d=qe(s,r);return d.appContext=i,u&&e?e(d,l):t(d,l,h),a=!0,c._container=l,l.__vue_app__=c,tf(d.component)||d.component.proxy}},unmount(){a&&(t(null,c._container),delete c._container.__vue_app__)},provide(l,u){return i.provides[l]=u,c}};return c}}function Kg(t,e,n,s,r=!1){if(ee(t)){t.forEach((d,f)=>Kg(d,e&&(ee(e)?e[f]:e),n,s,r));return}if(Bc(s)&&!r)return;const i=s.shapeFlag&4?tf(s.component)||s.component.proxy:s.el,o=r?null:i,{i:a,r:c}=t,l=e&&e.r,u=a.refs===Me?a.refs={}:a.refs,h=a.setupState;if(l!=null&&l!==c&&(yt(l)?(u[l]=null,ve(h,l)&&(h[l]=null)):lt(l)&&(l.value=null)),le(c))Br(c,a,12,[o,u]);else{const d=yt(c),f=lt(c);if(d||f){const p=()=>{if(t.f){const _=d?u[c]:c.value;r?ee(_)&&g_(_,i):ee(_)?_.includes(i)||_.push(i):d?(u[c]=[i],ve(h,c)&&(h[c]=u[c])):(c.value=[i],t.k&&(u[t.k]=c.value))}else d?(u[c]=o,ve(h,c)&&(h[c]=o)):f&&(c.value=o,t.k&&(u[t.k]=o))};o?(p.id=-1,$t(p,n)):p()}}}const $t=SO;function eM(t){return tM(t)}function tM(t,e){const n=xx();n.__VUE__=!0;const{insert:s,remove:r,patchProp:i,createElement:o,createText:a,createComment:c,setText:l,setElementText:u,parentNode:h,nextSibling:d,setScopeId:f=as,cloneNode:p,insertStaticContent:_}=t,y=(g,m,b,R=null,A=null,L=null,j=!1,M=null,V=!!m.dynamicChildren)=>{if(g===m)return;g&&!ki(g,m)&&(R=J(g),Ln(g,A,L,!0),g=null),m.patchFlag===-2&&(V=!1,m.dynamicChildren=null);const{type:D,ref:X,shapeFlag:Q}=m;switch(D){case x_:T(g,m,b,R);break;case cs:I(g,m,b,R);break;case bh:g==null&&E(m,b,R,j);break;case es:Re(g,m,b,R,A,L,j,M,V);break;default:Q&1?H(g,m,b,R,A,L,j,M,V):Q&6?Ze(g,m,b,R,A,L,j,M,V):(Q&64||Q&128)&&D.process(g,m,b,R,A,L,j,M,V,$e)}X!=null&&A&&Kg(X,g&&g.ref,L,m||g,!m)},T=(g,m,b,R)=>{if(g==null)s(m.el=a(m.children),b,R);else{const A=m.el=g.el;m.children!==g.children&&l(A,m.children)}},I=(g,m,b,R)=>{g==null?s(m.el=c(m.children||""),b,R):m.el=g.el},E=(g,m,b,R)=>{[g.el,g.anchor]=_(g.children,m,b,R,g.el,g.anchor)},S=({el:g,anchor:m},b,R)=>{let A;for(;g&&g!==m;)A=d(g),s(g,b,R),g=A;s(m,b,R)},$=({el:g,anchor:m})=>{let b;for(;g&&g!==m;)b=d(g),r(g),g=b;r(m)},H=(g,m,b,R,A,L,j,M,V)=>{j=j||m.type==="svg",g==null?K(m,b,R,A,L,j,M,V):he(g,m,A,L,j,M,V)},K=(g,m,b,R,A,L,j,M)=>{let V,D;const{type:X,props:Q,shapeFlag:Z,transition:ae,patchFlag:be,dirs:De}=g;if(g.el&&p!==void 0&&be===-1)V=g.el=p(g.el);else{if(V=g.el=o(g.type,L,Q&&Q.is,Q),Z&8?u(V,g.children):Z&16&&ne(g.children,V,null,R,A,L&&X!=="foreignObject",j,M),De&&_i(g,null,R,"created"),Q){for(const Ke in Q)Ke!=="value"&&!vh(Ke)&&i(V,Ke,null,Q[Ke],L,g.children,R,A,B);"value"in Q&&i(V,"value",null,Q.value),(D=Q.onVnodeBeforeMount)&&Un(D,R,g)}F(V,g,g.scopeId,j,R)}De&&_i(g,null,R,"beforeMount");const xe=(!A||A&&!A.pendingBranch)&&ae&&!ae.persisted;xe&&ae.beforeEnter(V),s(V,m,b),((D=Q&&Q.onVnodeMounted)||xe||De)&&$t(()=>{D&&Un(D,R,g),xe&&ae.enter(V),De&&_i(g,null,R,"mounted")},A)},F=(g,m,b,R,A)=>{if(b&&f(g,b),R)for(let L=0;L<R.length;L++)f(g,R[L]);if(A){let L=A.subTree;if(m===L){const j=A.vnode;F(g,j,j.scopeId,j.slotScopeIds,A.parent)}}},ne=(g,m,b,R,A,L,j,M,V=0)=>{for(let D=V;D<g.length;D++){const X=g[D]=M?Rr(g[D]):ys(g[D]);y(null,X,m,b,R,A,L,j,M)}},he=(g,m,b,R,A,L,j)=>{const M=m.el=g.el;let{patchFlag:V,dynamicChildren:D,dirs:X}=m;V|=g.patchFlag&16;const Q=g.props||Me,Z=m.props||Me;let ae;b&&yi(b,!1),(ae=Z.onVnodeBeforeUpdate)&&Un(ae,b,m,g),X&&_i(m,g,b,"beforeUpdate"),b&&yi(b,!0);const be=A&&m.type!=="foreignObject";if(D?Ce(g.dynamicChildren,D,M,b,R,be,L):j||Tn(g,m,M,null,b,R,be,L,!1),V>0){if(V&16)z(M,m,Q,Z,b,R,A);else if(V&2&&Q.class!==Z.class&&i(M,"class",null,Z.class,A),V&4&&i(M,"style",Q.style,Z.style,A),V&8){const De=m.dynamicProps;for(let xe=0;xe<De.length;xe++){const Ke=De[xe],Jn=Q[Ke],Fo=Z[Ke];(Fo!==Jn||Ke==="value")&&i(M,Ke,Jn,Fo,A,g.children,b,R,B)}}V&1&&g.children!==m.children&&u(M,m.children)}else!j&&D==null&&z(M,m,Q,Z,b,R,A);((ae=Z.onVnodeUpdated)||X)&&$t(()=>{ae&&Un(ae,b,m,g),X&&_i(m,g,b,"updated")},R)},Ce=(g,m,b,R,A,L,j)=>{for(let M=0;M<m.length;M++){const V=g[M],D=m[M],X=V.el&&(V.type===es||!ki(V,D)||V.shapeFlag&70)?h(V.el):b;y(V,D,X,null,R,A,L,j,!0)}},z=(g,m,b,R,A,L,j)=>{if(b!==R){for(const M in R){if(vh(M))continue;const V=R[M],D=b[M];V!==D&&M!=="value"&&i(g,M,D,V,j,m.children,A,L,B)}if(b!==Me)for(const M in b)!vh(M)&&!(M in R)&&i(g,M,b[M],null,j,m.children,A,L,B);"value"in R&&i(g,"value",b.value,R.value)}},Re=(g,m,b,R,A,L,j,M,V)=>{const D=m.el=g?g.el:a(""),X=m.anchor=g?g.anchor:a("");let{patchFlag:Q,dynamicChildren:Z,slotScopeIds:ae}=m;ae&&(M=M?M.concat(ae):ae),g==null?(s(D,b,R),s(X,b,R),ne(m.children,b,X,A,L,j,M,V)):Q>0&&Q&64&&Z&&g.dynamicChildren?(Ce(g.dynamicChildren,Z,b,A,L,j,M),(m.key!=null||A&&m===A.subTree)&&l0(g,m,!0)):Tn(g,m,b,X,A,L,j,M,V)},Ze=(g,m,b,R,A,L,j,M,V)=>{m.slotScopeIds=M,g==null?m.shapeFlag&512?A.ctx.activate(m,b,R,j,V):et(m,b,R,A,L,j,V):tt(g,m,V)},et=(g,m,b,R,A,L,j)=>{const M=g.component=hM(g,R,A);if(Jd(g)&&(M.ctx.renderer=$e),dM(M),M.asyncDep){if(A&&A.registerDep(M,Ue),!g.el){const V=M.subTree=qe(cs);I(null,V,m,b)}return}Ue(M,g,m,b,A,L,j)},tt=(g,m,b)=>{const R=m.component=g.component;if(EO(g,m,b))if(R.asyncDep&&!R.asyncResolved){Ne(R,m,b);return}else R.next=m,_O(R.update),R.update();else m.el=g.el,R.vnode=m},Ue=(g,m,b,R,A,L,j)=>{const M=()=>{if(g.isMounted){let{next:X,bu:Q,u:Z,parent:ae,vnode:be}=g,De=X,xe;yi(g,!1),X?(X.el=be.el,Ne(g,X,j)):X=be,Q&&ta(Q),(xe=X.props&&X.props.onVnodeBeforeUpdate)&&Un(xe,ae,X,be),yi(g,!0);const Ke=kp(g),Jn=g.subTree;g.subTree=Ke,y(Jn,Ke,h(Jn.el),J(Jn),g,A,L),X.el=Ke.el,De===null&&TO(g,Ke.el),Z&&$t(Z,A),(xe=X.props&&X.props.onVnodeUpdated)&&$t(()=>Un(xe,ae,X,be),A)}else{let X;const{el:Q,props:Z}=m,{bm:ae,m:be,parent:De}=g,xe=Bc(m);if(yi(g,!1),ae&&ta(ae),!xe&&(X=Z&&Z.onVnodeBeforeMount)&&Un(X,De,m),yi(g,!0),Q&&de){const Ke=()=>{g.subTree=kp(g),de(Q,g.subTree,g,A,null)};xe?m.type.__asyncLoader().then(()=>!g.isUnmounted&&Ke()):Ke()}else{const Ke=g.subTree=kp(g);y(null,Ke,b,R,g,A,L),m.el=Ke.el}if(be&&$t(be,A),!xe&&(X=Z&&Z.onVnodeMounted)){const Ke=m;$t(()=>Un(X,De,Ke),A)}(m.shapeFlag&256||De&&Bc(De.vnode)&&De.vnode.shapeFlag&256)&&g.a&&$t(g.a,A),g.isMounted=!0,m=b=R=null}},V=g.effect=new y_(M,()=>$S(D),g.scope),D=g.update=()=>V.run();D.id=g.uid,yi(g,!0),D()},Ne=(g,m,b)=>{m.component=g;const R=g.vnode.props;g.vnode=m,g.next=null,zO(g,m.props,R,b),JO(g,m.children,b),Ba(),zd(void 0,g.update),qa()},Tn=(g,m,b,R,A,L,j,M,V=!1)=>{const D=g&&g.children,X=g?g.shapeFlag:0,Q=m.children,{patchFlag:Z,shapeFlag:ae}=m;if(Z>0){if(Z&128){Hs(D,Q,b,R,A,L,j,M,V);return}else if(Z&256){Lo(D,Q,b,R,A,L,j,M,V);return}}ae&8?(X&16&&B(D,A,L),Q!==D&&u(b,Q)):X&16?ae&16?Hs(D,Q,b,R,A,L,j,M,V):B(D,A,L,!0):(X&8&&u(b,""),ae&16&&ne(Q,b,R,A,L,j,M,V))},Lo=(g,m,b,R,A,L,j,M,V)=>{g=g||Zo,m=m||Zo;const D=g.length,X=m.length,Q=Math.min(D,X);let Z;for(Z=0;Z<Q;Z++){const ae=m[Z]=V?Rr(m[Z]):ys(m[Z]);y(g[Z],ae,b,null,A,L,j,M,V)}D>X?B(g,A,L,!0,!1,Q):ne(m,b,R,A,L,j,M,V,Q)},Hs=(g,m,b,R,A,L,j,M,V)=>{let D=0;const X=m.length;let Q=g.length-1,Z=X-1;for(;D<=Q&&D<=Z;){const ae=g[D],be=m[D]=V?Rr(m[D]):ys(m[D]);if(ki(ae,be))y(ae,be,b,null,A,L,j,M,V);else break;D++}for(;D<=Q&&D<=Z;){const ae=g[Q],be=m[Z]=V?Rr(m[Z]):ys(m[Z]);if(ki(ae,be))y(ae,be,b,null,A,L,j,M,V);else break;Q--,Z--}if(D>Q){if(D<=Z){const ae=Z+1,be=ae<X?m[ae].el:R;for(;D<=Z;)y(null,m[D]=V?Rr(m[D]):ys(m[D]),b,be,A,L,j,M,V),D++}}else if(D>Z)for(;D<=Q;)Ln(g[D],A,L,!0),D++;else{const ae=D,be=D,De=new Map;for(D=be;D<=Z;D++){const Sn=m[D]=V?Rr(m[D]):ys(m[D]);Sn.key!=null&&De.set(Sn.key,D)}let xe,Ke=0;const Jn=Z-be+1;let Fo=!1,Vw=0;const dc=new Array(Jn);for(D=0;D<Jn;D++)dc[D]=0;for(D=ae;D<=Q;D++){const Sn=g[D];if(Ke>=Jn){Ln(Sn,A,L,!0);continue}let gs;if(Sn.key!=null)gs=De.get(Sn.key);else for(xe=be;xe<=Z;xe++)if(dc[xe-be]===0&&ki(Sn,m[xe])){gs=xe;break}gs===void 0?Ln(Sn,A,L,!0):(dc[gs-be]=D+1,gs>=Vw?Vw=gs:Fo=!0,y(Sn,m[gs],b,null,A,L,j,M,V),Ke++)}const Bw=Fo?nM(dc):Zo;for(xe=Bw.length-1,D=Jn-1;D>=0;D--){const Sn=be+D,gs=m[Sn],qw=Sn+1<X?m[Sn+1].el:R;dc[D]===0?y(null,gs,b,qw,A,L,j,M,V):Fo&&(xe<0||D!==Bw[xe]?ps(gs,b,qw,2):xe--)}}},ps=(g,m,b,R,A=null)=>{const{el:L,type:j,transition:M,children:V,shapeFlag:D}=g;if(D&6){ps(g.component.subTree,m,b,R);return}if(D&128){g.suspense.move(m,b,R);return}if(D&64){j.move(g,m,b,$e);return}if(j===es){s(L,m,b);for(let Q=0;Q<V.length;Q++)ps(V[Q],m,b,R);s(g.anchor,m,b);return}if(j===bh){S(g,m,b);return}if(R!==2&&D&1&&M)if(R===0)M.beforeEnter(L),s(L,m,b),$t(()=>M.enter(L),A);else{const{leave:Q,delayLeave:Z,afterLeave:ae}=M,be=()=>s(L,m,b),De=()=>{Q(L,()=>{be(),ae&&ae()})};Z?Z(L,be,De):De()}else s(L,m,b)},Ln=(g,m,b,R=!1,A=!1)=>{const{type:L,props:j,ref:M,children:V,dynamicChildren:D,shapeFlag:X,patchFlag:Q,dirs:Z}=g;if(M!=null&&Kg(M,null,b,g,!0),X&256){m.ctx.deactivate(g);return}const ae=X&1&&Z,be=!Bc(g);let De;if(be&&(De=j&&j.onVnodeBeforeUnmount)&&Un(De,m,g),X&6)Y(g.component,b,R);else{if(X&128){g.suspense.unmount(b,R);return}ae&&_i(g,null,m,"beforeUnmount"),X&64?g.type.remove(g,m,b,A,$e,R):D&&(L!==es||Q>0&&Q&64)?B(D,m,b,!1,!0):(L===es&&Q&384||!A&&X&16)&&B(V,m,b),R&&Cp(g)}(be&&(De=j&&j.onVnodeUnmounted)||ae)&&$t(()=>{De&&Un(De,m,g),ae&&_i(g,null,m,"unmounted")},b)},Cp=g=>{const{type:m,el:b,anchor:R,transition:A}=g;if(m===es){C(b,R);return}if(m===bh){$(g);return}const L=()=>{r(b),A&&!A.persisted&&A.afterLeave&&A.afterLeave()};if(g.shapeFlag&1&&A&&!A.persisted){const{leave:j,delayLeave:M}=A,V=()=>j(b,L);M?M(g.el,L,V):V()}else L()},C=(g,m)=>{let b;for(;g!==m;)b=d(g),r(g),g=b;r(m)},Y=(g,m,b)=>{const{bum:R,scope:A,update:L,subTree:j,um:M}=g;R&&ta(R),A.stop(),L&&(L.active=!1,Ln(j,g,m,b)),M&&$t(M,m),$t(()=>{g.isUnmounted=!0},m),m&&m.pendingBranch&&!m.isUnmounted&&g.asyncDep&&!g.asyncResolved&&g.suspenseId===m.pendingId&&(m.deps--,m.deps===0&&m.resolve())},B=(g,m,b,R=!1,A=!1,L=0)=>{for(let j=L;j<g.length;j++)Ln(g[j],m,b,R,A)},J=g=>g.shapeFlag&6?J(g.component.subTree):g.shapeFlag&128?g.suspense.next():d(g.anchor||g.el),Pe=(g,m,b)=>{g==null?m._vnode&&Ln(m._vnode,null,null,!0):y(m._vnode||null,g,m,null,null,null,b),qS(),m._vnode=g},$e={p:y,um:Ln,m:ps,r:Cp,mt:et,mc:ne,pc:Tn,pbc:Ce,n:J,o:t};let _e,de;return e&&([_e,de]=e($e)),{render:Pe,hydrate:_e,createApp:ZO(Pe,_e)}}function yi({effect:t,update:e},n){t.allowRecurse=e.allowRecurse=n}function l0(t,e,n=!1){const s=t.children,r=e.children;if(ee(s)&&ee(r))for(let i=0;i<s.length;i++){const o=s[i];let a=r[i];a.shapeFlag&1&&!a.dynamicChildren&&((a.patchFlag<=0||a.patchFlag===32)&&(a=r[i]=Rr(r[i]),a.el=o.el),n||l0(o,a))}}function nM(t){const e=t.slice(),n=[0];let s,r,i,o,a;const c=t.length;for(s=0;s<c;s++){const l=t[s];if(l!==0){if(r=n[n.length-1],t[r]<l){e[s]=r,n.push(s);continue}for(i=0,o=n.length-1;i<o;)a=i+o>>1,t[n[a]]<l?i=a+1:o=a;l<t[n[i]]&&(i>0&&(e[s]=n[i-1]),n[i]=s)}}for(i=n.length,o=n[i-1];i-- >0;)n[i]=o,o=e[o];return n}const sM=t=>t.__isTeleport,es=Symbol(void 0),x_=Symbol(void 0),cs=Symbol(void 0),bh=Symbol(void 0),qc=[];let rs=null;function Ts(t=!1){qc.push(rs=t?null:[])}function rM(){qc.pop(),rs=qc[qc.length-1]||null}let gl=1;function cb(t){gl+=t}function u0(t){return t.dynamicChildren=gl>0?rs||Zo:null,rM(),gl>0&&rs&&rs.push(t),t}function _a(t,e,n,s,r,i){return u0(Ye(t,e,n,s,r,i,!0))}function Ih(t,e,n,s,r){return u0(qe(t,e,n,s,r,!0))}function Bh(t){return t?t.__v_isVNode===!0:!1}function ki(t,e){return t.type===e.type&&t.key===e.key}const Zd="__vInternal",h0=({key:t})=>t!=null?t:null,Eh=({ref:t,ref_key:e,ref_for:n})=>t!=null?yt(t)||lt(t)||le(t)?{i:Vn,r:t,k:e,f:!!n}:t:null;function Ye(t,e=null,n=null,s=0,r=null,i=t===es?0:1,o=!1,a=!1){const c={__v_isVNode:!0,__v_skip:!0,type:t,props:e,key:e&&h0(e),ref:e&&Eh(e),scopeId:Yd,slotScopeIds:null,children:n,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:i,patchFlag:s,dynamicProps:r,dynamicChildren:null,appContext:null};return a?(O_(c,n),i&128&&t.normalize(c)):n&&(c.shapeFlag|=yt(n)?8:16),gl>0&&!o&&rs&&(c.patchFlag>0||i&6)&&c.patchFlag!==32&&rs.push(c),c}const qe=iM;function iM(t,e=null,n=null,s=0,r=null,i=!1){if((!t||t===$O)&&(t=cs),Bh(t)){const a=ar(t,e,!0);return n&&O_(a,n),gl>0&&!i&&rs&&(a.shapeFlag&6?rs[rs.indexOf(t)]=a:rs.push(a)),a.patchFlag|=-2,a}if(mM(t)&&(t=t.__vccOpts),e){e=oM(e);let{class:a,style:c}=e;a&&!yt(a)&&(e.class=f_(a)),st(c)&&(xS(c)&&!ee(c)&&(c=Gt({},c)),e.style=d_(c))}const o=yt(t)?1:HS(t)?128:sM(t)?64:st(t)?4:le(t)?2:0;return Ye(t,e,n,s,r,o,i,!0)}function oM(t){return t?xS(t)||Zd in t?Gt({},t):t:null}function ar(t,e,n=!1){const{props:s,ref:r,patchFlag:i,children:o}=t,a=e?cM(s||{},e):s;return{__v_isVNode:!0,__v_skip:!0,type:t.type,props:a,key:a&&h0(a),ref:e&&e.ref?n&&r?ee(r)?r.concat(Eh(e)):[r,Eh(e)]:Eh(e):r,scopeId:t.scopeId,slotScopeIds:t.slotScopeIds,children:o,target:t.target,targetAnchor:t.targetAnchor,staticCount:t.staticCount,shapeFlag:t.shapeFlag,patchFlag:e&&t.type!==es?i===-1?16:i|16:i,dynamicProps:t.dynamicProps,dynamicChildren:t.dynamicChildren,appContext:t.appContext,dirs:t.dirs,transition:t.transition,component:t.component,suspense:t.suspense,ssContent:t.ssContent&&ar(t.ssContent),ssFallback:t.ssFallback&&ar(t.ssFallback),el:t.el,anchor:t.anchor}}function qs(t=" ",e=0){return qe(x_,null,t,e)}function aM(t,e){const n=qe(bh,null,t);return n.staticCount=e,n}function jc(t="",e=!1){return e?(Ts(),Ih(cs,null,t)):qe(cs,null,t)}function ys(t){return t==null||typeof t=="boolean"?qe(cs):ee(t)?qe(es,null,t.slice()):typeof t=="object"?Rr(t):qe(x_,null,String(t))}function Rr(t){return t.el===null||t.memo?t:ar(t)}function O_(t,e){let n=0;const{shapeFlag:s}=t;if(e==null)e=null;else if(ee(e))n=16;else if(typeof e=="object")if(s&65){const r=e.default;r&&(r._c&&(r._d=!1),O_(t,r()),r._c&&(r._d=!0));return}else{n=32;const r=e._;!r&&!(Zd in e)?e._ctx=Vn:r===3&&Vn&&(Vn.slots._===1?e._=1:(e._=2,t.patchFlag|=1024))}else le(e)?(e={default:e,_ctx:Vn},n=32):(e=String(e),s&64?(n=16,e=[qs(e)]):n=8);t.children=e,t.shapeFlag|=n}function cM(...t){const e={};for(let n=0;n<t.length;n++){const s=t[n];for(const r in s)if(r==="class")e.class!==s.class&&(e.class=f_([e.class,s.class]));else if(r==="style")e.style=d_([e.style,s.style]);else if(qd(r)){const i=e[r],o=s[r];o&&i!==o&&!(ee(i)&&i.includes(o))&&(e[r]=i?[].concat(i,o):o)}else r!==""&&(e[r]=s[r])}return e}function Un(t,e,n,s=null){Hn(t,e,7,[n,s])}const lM=c0();let uM=0;function hM(t,e,n){const s=t.type,r=(e?e.appContext:t.appContext)||lM,i={uid:uM++,vnode:t,type:s,parent:e,appContext:r,root:null,next:null,subTree:null,effect:null,update:null,scope:new wS(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:e?e.provides:Object.create(r.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:r0(s,r),emitsOptions:KS(s,r),emit:null,emitted:null,propsDefaults:Me,inheritAttrs:s.inheritAttrs,ctx:Me,data:Me,props:Me,attrs:Me,slots:Me,refs:Me,setupState:Me,setupContext:null,suspense:n,suspenseId:n?n.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return i.ctx={_:i},i.root=e?e.root:i,i.emit=wO.bind(null,i),t.ce&&t.ce(i),i}let At=null;const ef=()=>At||Vn,ya=t=>{At=t,t.scope.on()},Ki=()=>{At&&At.scope.off(),At=null};function d0(t){return t.vnode.shapeFlag&4}let ml=!1;function dM(t,e=!1){ml=e;const{props:n,children:s}=t.vnode,r=d0(t);GO(t,n,r,e),YO(t,s);const i=r?fM(t,e):void 0;return ml=!1,i}function fM(t,e){const n=t.type;t.accessCache=Object.create(null),t.proxy=ma(new Proxy(t.ctx,BO));const{setup:s}=n;if(s){const r=t.setupContext=s.length>1?gM(t):null;ya(t),Ba();const i=Br(s,t,0,[t.props,r]);if(qa(),Ki(),_S(i)){if(i.then(Ki,Ki),e)return i.then(o=>{lb(t,o,e)}).catch(o=>{Gd(o,t,0)});t.asyncDep=i}else lb(t,i,e)}else f0(t,e)}function lb(t,e,n){le(e)?t.type.__ssrInlineRender?t.ssrRender=e:t.render=e:st(e)&&(t.setupState=FS(e)),f0(t,n)}let ub;function f0(t,e,n){const s=t.type;if(!t.render){if(!e&&ub&&!s.render){const r=s.template;if(r){const{isCustomElement:i,compilerOptions:o}=t.appContext.config,{delimiters:a,compilerOptions:c}=s,l=Gt(Gt({isCustomElement:i,delimiters:a},o),c);s.render=ub(r,l)}}t.render=s.render||as}ya(t),Ba(),qO(t),qa(),Ki()}function pM(t){return new Proxy(t.attrs,{get(e,n){return Dn(t,"get","$attrs"),e[n]}})}function gM(t){const e=s=>{t.exposed=s||{}};let n;return{get attrs(){return n||(n=pM(t))},slots:t.slots,emit:t.emit,expose:e}}function tf(t){if(t.exposed)return t.exposeProxy||(t.exposeProxy=new Proxy(FS(ma(t.exposed)),{get(e,n){if(n in e)return e[n];if(n in $h)return $h[n](t)}}))}function Hg(t,e=!0){return le(t)?t.displayName||t.name:t.name||e&&t.__name}function mM(t){return le(t)&&"__vccOpts"in t}const ns=(t,e)=>pO(t,e,ml);function M_(t,e,n){const s=arguments.length;return s===2?st(e)&&!ee(e)?Bh(e)?qe(t,null,[e]):qe(t,e):qe(t,null,e):(s>3?n=Array.prototype.slice.call(arguments,2):s===3&&Bh(n)&&(n=[n]),qe(t,e,n))}const _M="3.2.37",yM="http://www.w3.org/2000/svg",Ri=typeof document!="undefined"?document:null,hb=Ri&&Ri.createElement("template"),vM={insert:(t,e,n)=>{e.insertBefore(t,n||null)},remove:t=>{const e=t.parentNode;e&&e.removeChild(t)},createElement:(t,e,n,s)=>{const r=e?Ri.createElementNS(yM,t):Ri.createElement(t,n?{is:n}:void 0);return t==="select"&&s&&s.multiple!=null&&r.setAttribute("multiple",s.multiple),r},createText:t=>Ri.createTextNode(t),createComment:t=>Ri.createComment(t),setText:(t,e)=>{t.nodeValue=e},setElementText:(t,e)=>{t.textContent=e},parentNode:t=>t.parentNode,nextSibling:t=>t.nextSibling,querySelector:t=>Ri.querySelector(t),setScopeId(t,e){t.setAttribute(e,"")},cloneNode(t){const e=t.cloneNode(!0);return"_value"in t&&(e._value=t._value),e},insertStaticContent(t,e,n,s,r,i){const o=n?n.previousSibling:e.lastChild;if(r&&(r===i||r.nextSibling))for(;e.insertBefore(r.cloneNode(!0),n),!(r===i||!(r=r.nextSibling)););else{hb.innerHTML=s?`<svg>${t}</svg>`:t;const a=hb.content;if(s){const c=a.firstChild;for(;c.firstChild;)a.appendChild(c.firstChild);a.removeChild(c)}e.insertBefore(a,n)}return[o?o.nextSibling:e.firstChild,n?n.previousSibling:e.lastChild]}};function wM(t,e,n){const s=t._vtc;s&&(e=(e?[e,...s]:[...s]).join(" ")),e==null?t.removeAttribute("class"):n?t.setAttribute("class",e):t.className=e}function bM(t,e,n){const s=t.style,r=yt(n);if(n&&!r){for(const i in n)Wg(s,i,n[i]);if(e&&!yt(e))for(const i in e)n[i]==null&&Wg(s,i,"")}else{const i=s.display;r?e!==n&&(s.cssText=n):e&&t.removeAttribute("style"),"_vod"in t&&(s.display=i)}}const db=/\s*!important$/;function Wg(t,e,n){if(ee(n))n.forEach(s=>Wg(t,e,s));else if(n==null&&(n=""),e.startsWith("--"))t.setProperty(e,n);else{const s=IM(t,e);db.test(n)?t.setProperty(Eo(s),n.replace(db,""),"important"):t[s]=n}}const fb=["Webkit","Moz","ms"],Dp={};function IM(t,e){const n=Dp[e];if(n)return n;let s=Os(e);if(s!=="filter"&&s in t)return Dp[e]=s;s=Hd(s);for(let r=0;r<fb.length;r++){const i=fb[r]+s;if(i in t)return Dp[e]=i}return e}const pb="http://www.w3.org/1999/xlink";function EM(t,e,n,s,r){if(s&&e.startsWith("xlink:"))n==null?t.removeAttributeNS(pb,e.slice(6,e.length)):t.setAttributeNS(pb,e,n);else{const i=bx(e);n==null||i&&!gS(n)?t.removeAttribute(e):t.setAttribute(e,i?"":n)}}function TM(t,e,n,s,r,i,o){if(e==="innerHTML"||e==="textContent"){s&&o(s,r,i),t[e]=n==null?"":n;return}if(e==="value"&&t.tagName!=="PROGRESS"&&!t.tagName.includes("-")){t._value=n;const c=n==null?"":n;(t.value!==c||t.tagName==="OPTION")&&(t.value=c),n==null&&t.removeAttribute(e);return}let a=!1;if(n===""||n==null){const c=typeof t[e];c==="boolean"?n=gS(n):n==null&&c==="string"?(n="",a=!0):c==="number"&&(n=0,a=!0)}try{t[e]=n}catch{}a&&t.removeAttribute(e)}const[p0,SM]=(()=>{let t=Date.now,e=!1;if(typeof window!="undefined"){Date.now()>document.createEvent("Event").timeStamp&&(t=performance.now.bind(performance));const n=navigator.userAgent.match(/firefox\/(\d+)/i);e=!!(n&&Number(n[1])<=53)}return[t,e]})();let Gg=0;const CM=Promise.resolve(),AM=()=>{Gg=0},kM=()=>Gg||(CM.then(AM),Gg=p0());function Dr(t,e,n,s){t.addEventListener(e,n,s)}function RM(t,e,n,s){t.removeEventListener(e,n,s)}function NM(t,e,n,s,r=null){const i=t._vei||(t._vei={}),o=i[e];if(s&&o)o.value=s;else{const[a,c]=PM(e);if(s){const l=i[e]=DM(s,r);Dr(t,a,l,c)}else o&&(RM(t,a,o,c),i[e]=void 0)}}const gb=/(?:Once|Passive|Capture)$/;function PM(t){let e;if(gb.test(t)){e={};let n;for(;n=t.match(gb);)t=t.slice(0,t.length-n[0].length),e[n[0].toLowerCase()]=!0}return[Eo(t.slice(2)),e]}function DM(t,e){const n=s=>{const r=s.timeStamp||p0();(SM||r>=n.attached-1)&&Hn(xM(s,n.value),e,5,[s])};return n.value=t,n.attached=kM(),n}function xM(t,e){if(ee(e)){const n=t.stopImmediatePropagation;return t.stopImmediatePropagation=()=>{n.call(t),t._stopped=!0},e.map(s=>r=>!r._stopped&&s&&s(r))}else return e}const mb=/^on[a-z]/,OM=(t,e,n,s,r=!1,i,o,a,c)=>{e==="class"?wM(t,s,r):e==="style"?bM(t,n,s):qd(e)?p_(e)||NM(t,e,n,s,o):(e[0]==="."?(e=e.slice(1),!0):e[0]==="^"?(e=e.slice(1),!1):MM(t,e,s,r))?TM(t,e,s,i,o,a,c):(e==="true-value"?t._trueValue=s:e==="false-value"&&(t._falseValue=s),EM(t,e,s,r))};function MM(t,e,n,s){return s?!!(e==="innerHTML"||e==="textContent"||e in t&&mb.test(e)&&le(n)):e==="spellcheck"||e==="draggable"||e==="translate"||e==="form"||e==="list"&&t.tagName==="INPUT"||e==="type"&&t.tagName==="TEXTAREA"||mb.test(e)&&yt(n)?!1:e in t}const br="transition",fc="animation",L_=(t,{slots:e})=>M_(zS,LM(t),e);L_.displayName="Transition";const g0={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String};L_.props=Gt({},zS.props,g0);const vi=(t,e=[])=>{ee(t)?t.forEach(n=>n(...e)):t&&t(...e)},_b=t=>t?ee(t)?t.some(e=>e.length>1):t.length>1:!1;function LM(t){const e={};for(const z in t)z in g0||(e[z]=t[z]);if(t.css===!1)return e;const{name:n="v",type:s,duration:r,enterFromClass:i=`${n}-enter-from`,enterActiveClass:o=`${n}-enter-active`,enterToClass:a=`${n}-enter-to`,appearFromClass:c=i,appearActiveClass:l=o,appearToClass:u=a,leaveFromClass:h=`${n}-leave-from`,leaveActiveClass:d=`${n}-leave-active`,leaveToClass:f=`${n}-leave-to`}=t,p=FM(r),_=p&&p[0],y=p&&p[1],{onBeforeEnter:T,onEnter:I,onEnterCancelled:E,onLeave:S,onLeaveCancelled:$,onBeforeAppear:H=T,onAppear:K=I,onAppearCancelled:F=E}=e,ne=(z,Re,Ze)=>{wi(z,Re?u:a),wi(z,Re?l:o),Ze&&Ze()},he=(z,Re)=>{z._isLeaving=!1,wi(z,h),wi(z,f),wi(z,d),Re&&Re()},Ce=z=>(Re,Ze)=>{const et=z?K:I,tt=()=>ne(Re,z,Ze);vi(et,[Re,tt]),yb(()=>{wi(Re,z?c:i),Ir(Re,z?u:a),_b(et)||vb(Re,s,_,tt)})};return Gt(e,{onBeforeEnter(z){vi(T,[z]),Ir(z,i),Ir(z,o)},onBeforeAppear(z){vi(H,[z]),Ir(z,c),Ir(z,l)},onEnter:Ce(!1),onAppear:Ce(!0),onLeave(z,Re){z._isLeaving=!0;const Ze=()=>he(z,Re);Ir(z,h),VM(),Ir(z,d),yb(()=>{!z._isLeaving||(wi(z,h),Ir(z,f),_b(S)||vb(z,s,y,Ze))}),vi(S,[z,Ze])},onEnterCancelled(z){ne(z,!1),vi(E,[z])},onAppearCancelled(z){ne(z,!0),vi(F,[z])},onLeaveCancelled(z){he(z),vi($,[z])}})}function FM(t){if(t==null)return null;if(st(t))return[xp(t.enter),xp(t.leave)];{const e=xp(t);return[e,e]}}function xp(t){return hl(t)}function Ir(t,e){e.split(/\s+/).forEach(n=>n&&t.classList.add(n)),(t._vtc||(t._vtc=new Set)).add(e)}function wi(t,e){e.split(/\s+/).forEach(s=>s&&t.classList.remove(s));const{_vtc:n}=t;n&&(n.delete(e),n.size||(t._vtc=void 0))}function yb(t){requestAnimationFrame(()=>{requestAnimationFrame(t)})}let UM=0;function vb(t,e,n,s){const r=t._endId=++UM,i=()=>{r===t._endId&&s()};if(n)return setTimeout(i,n);const{type:o,timeout:a,propCount:c}=$M(t,e);if(!o)return s();const l=o+"end";let u=0;const h=()=>{t.removeEventListener(l,d),i()},d=f=>{f.target===t&&++u>=c&&h()};setTimeout(()=>{u<c&&h()},a+1),t.addEventListener(l,d)}function $M(t,e){const n=window.getComputedStyle(t),s=p=>(n[p]||"").split(", "),r=s(br+"Delay"),i=s(br+"Duration"),o=wb(r,i),a=s(fc+"Delay"),c=s(fc+"Duration"),l=wb(a,c);let u=null,h=0,d=0;e===br?o>0&&(u=br,h=o,d=i.length):e===fc?l>0&&(u=fc,h=l,d=c.length):(h=Math.max(o,l),u=h>0?o>l?br:fc:null,d=u?u===br?i.length:c.length:0);const f=u===br&&/\b(transform|all)(,|$)/.test(n[br+"Property"]);return{type:u,timeout:h,propCount:d,hasTransform:f}}function wb(t,e){for(;t.length<e.length;)t=t.concat(t);return Math.max(...e.map((n,s)=>bb(n)+bb(t[s])))}function bb(t){return Number(t.slice(0,-1).replace(",","."))*1e3}function VM(){return document.body.offsetHeight}const va=t=>{const e=t.props["onUpdate:modelValue"]||!1;return ee(e)?n=>ta(e,n):e};function BM(t){t.target.composing=!0}function Ib(t){const e=t.target;e.composing&&(e.composing=!1,e.dispatchEvent(new Event("input")))}const G9={created(t,{modifiers:{lazy:e,trim:n,number:s}},r){t._assign=va(r);const i=s||r.props&&r.props.type==="number";Dr(t,e?"change":"input",o=>{if(o.target.composing)return;let a=t.value;n&&(a=a.trim()),i&&(a=hl(a)),t._assign(a)}),n&&Dr(t,"change",()=>{t.value=t.value.trim()}),e||(Dr(t,"compositionstart",BM),Dr(t,"compositionend",Ib),Dr(t,"change",Ib))},mounted(t,{value:e}){t.value=e==null?"":e},beforeUpdate(t,{value:e,modifiers:{lazy:n,trim:s,number:r}},i){if(t._assign=va(i),t.composing||document.activeElement===t&&t.type!=="range"&&(n||s&&t.value.trim()===e||(r||t.type==="number")&&hl(t.value)===e))return;const o=e==null?"":e;t.value!==o&&(t.value=o)}},z9={created(t,{value:e},n){t.checked=ga(e,n.props.value),t._assign=va(n),Dr(t,"change",()=>{t._assign(_l(t))})},beforeUpdate(t,{value:e,oldValue:n},s){t._assign=va(s),e!==n&&(t.checked=ga(e,s.props.value))}},Q9={deep:!0,created(t,{value:e,modifiers:{number:n}},s){const r=jd(e);Dr(t,"change",()=>{const i=Array.prototype.filter.call(t.options,o=>o.selected).map(o=>n?hl(_l(o)):_l(o));t._assign(t.multiple?r?new Set(i):i:i[0])}),t._assign=va(s)},mounted(t,{value:e}){Eb(t,e)},beforeUpdate(t,e,n){t._assign=va(n)},updated(t,{value:e}){Eb(t,e)}};function Eb(t,e){const n=t.multiple;if(!(n&&!ee(e)&&!jd(e))){for(let s=0,r=t.options.length;s<r;s++){const i=t.options[s],o=_l(i);if(n)ee(e)?i.selected=Cx(e,o)>-1:i.selected=e.has(o);else if(ga(_l(i),e)){t.selectedIndex!==s&&(t.selectedIndex=s);return}}!n&&t.selectedIndex!==-1&&(t.selectedIndex=-1)}}function _l(t){return"_value"in t?t._value:t.value}const qM={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},Y9=(t,e)=>n=>{if(!("key"in n))return;const s=Eo(n.key);if(e.some(r=>r===s||qM[r]===s))return t(n)},jM=Gt({patchProp:OM},vM);let Tb;function KM(){return Tb||(Tb=eM(jM))}const HM=(...t)=>{const e=KM().createApp(...t),{mount:n}=e;return e.mount=s=>{const r=WM(s);if(!r)return;const i=e._component;!le(i)&&!i.render&&!i.template&&(i.template=r.innerHTML),r.innerHTML="";const o=n(r,!1,r instanceof SVGElement);return r instanceof Element&&(r.removeAttribute("v-cloak"),r.setAttribute("data-v-app","")),o},e};function WM(t){return yt(t)?document.querySelector(t):t}const GM="modulepreload",Sb={},zM="/Educatia/",ms=function(e,n){return!n||n.length===0?e():Promise.all(n.map(s=>{if(s=`${zM}${s}`,s in Sb)return;Sb[s]=!0;const r=s.endsWith(".css"),i=r?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${s}"]${i}`))return;const o=document.createElement("link");if(o.rel=r?"stylesheet":GM,r||(o.as="script",o.crossOrigin=""),o.href=s,document.head.appendChild(o),r)return new Promise((a,c)=>{o.addEventListener("load",a),o.addEventListener("error",()=>c(new Error(`Unable to preload CSS for ${s}`)))})})).then(()=>e())};/*!
  * vue-router v4.0.13
  * (c) 2022 Eduardo San Martin Morote
  * @license MIT
  */const m0=typeof Symbol=="function"&&typeof Symbol.toStringTag=="symbol",Ka=t=>m0?Symbol(t):"_vr_"+t,QM=Ka("rvlm"),Cb=Ka("rvd"),nf=Ka("r"),_0=Ka("rl"),zg=Ka("rvl"),zo=typeof window!="undefined";function YM(t){return t.__esModule||m0&&t[Symbol.toStringTag]==="Module"}const Oe=Object.assign;function Op(t,e){const n={};for(const s in e){const r=e[s];n[s]=Array.isArray(r)?r.map(t):t(r)}return n}const Kc=()=>{},JM=/\/$/,XM=t=>t.replace(JM,"");function Mp(t,e,n="/"){let s,r={},i="",o="";const a=e.indexOf("?"),c=e.indexOf("#",a>-1?a:0);return a>-1&&(s=e.slice(0,a),i=e.slice(a+1,c>-1?c:e.length),r=t(i)),c>-1&&(s=s||e.slice(0,c),o=e.slice(c,e.length)),s=n1(s!=null?s:e,n),{fullPath:s+(i&&"?")+i+o,path:s,query:r,hash:o}}function ZM(t,e){const n=e.query?t(e.query):"";return e.path+(n&&"?")+n+(e.hash||"")}function Ab(t,e){return!e||!t.toLowerCase().startsWith(e.toLowerCase())?t:t.slice(e.length)||"/"}function e1(t,e,n){const s=e.matched.length-1,r=n.matched.length-1;return s>-1&&s===r&&wa(e.matched[s],n.matched[r])&&y0(e.params,n.params)&&t(e.query)===t(n.query)&&e.hash===n.hash}function wa(t,e){return(t.aliasOf||t)===(e.aliasOf||e)}function y0(t,e){if(Object.keys(t).length!==Object.keys(e).length)return!1;for(const n in t)if(!t1(t[n],e[n]))return!1;return!0}function t1(t,e){return Array.isArray(t)?kb(t,e):Array.isArray(e)?kb(e,t):t===e}function kb(t,e){return Array.isArray(e)?t.length===e.length&&t.every((n,s)=>n===e[s]):t.length===1&&t[0]===e}function n1(t,e){if(t.startsWith("/"))return t;if(!t)return e;const n=e.split("/"),s=t.split("/");let r=n.length-1,i,o;for(i=0;i<s.length;i++)if(o=s[i],!(r===1||o==="."))if(o==="..")r--;else break;return n.slice(0,r).join("/")+"/"+s.slice(i-(i===s.length?1:0)).join("/")}var yl;(function(t){t.pop="pop",t.push="push"})(yl||(yl={}));var Hc;(function(t){t.back="back",t.forward="forward",t.unknown=""})(Hc||(Hc={}));function s1(t){if(!t)if(zo){const e=document.querySelector("base");t=e&&e.getAttribute("href")||"/",t=t.replace(/^\w+:\/\/[^\/]+/,"")}else t="/";return t[0]!=="/"&&t[0]!=="#"&&(t="/"+t),XM(t)}const r1=/^[^#]+#/;function i1(t,e){return t.replace(r1,"#")+e}function o1(t,e){const n=document.documentElement.getBoundingClientRect(),s=t.getBoundingClientRect();return{behavior:e.behavior,left:s.left-n.left-(e.left||0),top:s.top-n.top-(e.top||0)}}const sf=()=>({left:window.pageXOffset,top:window.pageYOffset});function a1(t){let e;if("el"in t){const n=t.el,s=typeof n=="string"&&n.startsWith("#"),r=typeof n=="string"?s?document.getElementById(n.slice(1)):document.querySelector(n):n;if(!r)return;e=o1(r,t)}else e=t;"scrollBehavior"in document.documentElement.style?window.scrollTo(e):window.scrollTo(e.left!=null?e.left:window.pageXOffset,e.top!=null?e.top:window.pageYOffset)}function Rb(t,e){return(history.state?history.state.position-e:-1)+t}const Qg=new Map;function c1(t,e){Qg.set(t,e)}function l1(t){const e=Qg.get(t);return Qg.delete(t),e}let u1=()=>location.protocol+"//"+location.host;function v0(t,e){const{pathname:n,search:s,hash:r}=e,i=t.indexOf("#");if(i>-1){let a=r.includes(t.slice(i))?t.slice(i).length:1,c=r.slice(a);return c[0]!=="/"&&(c="/"+c),Ab(c,"")}return Ab(n,t)+s+r}function h1(t,e,n,s){let r=[],i=[],o=null;const a=({state:d})=>{const f=v0(t,location),p=n.value,_=e.value;let y=0;if(d){if(n.value=f,e.value=d,o&&o===p){o=null;return}y=_?d.position-_.position:0}else s(f);r.forEach(T=>{T(n.value,p,{delta:y,type:yl.pop,direction:y?y>0?Hc.forward:Hc.back:Hc.unknown})})};function c(){o=n.value}function l(d){r.push(d);const f=()=>{const p=r.indexOf(d);p>-1&&r.splice(p,1)};return i.push(f),f}function u(){const{history:d}=window;!d.state||d.replaceState(Oe({},d.state,{scroll:sf()}),"")}function h(){for(const d of i)d();i=[],window.removeEventListener("popstate",a),window.removeEventListener("beforeunload",u)}return window.addEventListener("popstate",a),window.addEventListener("beforeunload",u),{pauseListeners:c,listen:l,destroy:h}}function Nb(t,e,n,s=!1,r=!1){return{back:t,current:e,forward:n,replaced:s,position:window.history.length,scroll:r?sf():null}}function d1(t){const{history:e,location:n}=window,s={value:v0(t,n)},r={value:e.state};r.value||i(s.value,{back:null,current:s.value,forward:null,position:e.length-1,replaced:!0,scroll:null},!0);function i(c,l,u){const h=t.indexOf("#"),d=h>-1?(n.host&&document.querySelector("base")?t:t.slice(h))+c:u1()+t+c;try{e[u?"replaceState":"pushState"](l,"",d),r.value=l}catch(f){console.error(f),n[u?"replace":"assign"](d)}}function o(c,l){const u=Oe({},e.state,Nb(r.value.back,c,r.value.forward,!0),l,{position:r.value.position});i(c,u,!0),s.value=c}function a(c,l){const u=Oe({},r.value,e.state,{forward:c,scroll:sf()});i(u.current,u,!0);const h=Oe({},Nb(s.value,c,null),{position:u.position+1},l);i(c,h,!1),s.value=c}return{location:s,state:r,push:a,replace:o}}function f1(t){t=s1(t);const e=d1(t),n=h1(t,e.state,e.location,e.replace);function s(i,o=!0){o||n.pauseListeners(),history.go(i)}const r=Oe({location:"",base:t,go:s,createHref:i1.bind(null,t)},e,n);return Object.defineProperty(r,"location",{enumerable:!0,get:()=>e.location.value}),Object.defineProperty(r,"state",{enumerable:!0,get:()=>e.state.value}),r}function p1(t){return t=location.host?t||location.pathname+location.search:"",t.includes("#")||(t+="#"),f1(t)}function g1(t){return typeof t=="string"||t&&typeof t=="object"}function w0(t){return typeof t=="string"||typeof t=="symbol"}const Er={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0},b0=Ka("nf");var Pb;(function(t){t[t.aborted=4]="aborted",t[t.cancelled=8]="cancelled",t[t.duplicated=16]="duplicated"})(Pb||(Pb={}));function ba(t,e){return Oe(new Error,{type:t,[b0]:!0},e)}function Tr(t,e){return t instanceof Error&&b0 in t&&(e==null||!!(t.type&e))}const Db="[^/]+?",m1={sensitive:!1,strict:!1,start:!0,end:!0},_1=/[.+*?^${}()[\]/\\]/g;function y1(t,e){const n=Oe({},m1,e),s=[];let r=n.start?"^":"";const i=[];for(const l of t){const u=l.length?[]:[90];n.strict&&!l.length&&(r+="/");for(let h=0;h<l.length;h++){const d=l[h];let f=40+(n.sensitive?.25:0);if(d.type===0)h||(r+="/"),r+=d.value.replace(_1,"\\$&"),f+=40;else if(d.type===1){const{value:p,repeatable:_,optional:y,regexp:T}=d;i.push({name:p,repeatable:_,optional:y});const I=T||Db;if(I!==Db){f+=10;try{new RegExp(`(${I})`)}catch(S){throw new Error(`Invalid custom RegExp for param "${p}" (${I}): `+S.message)}}let E=_?`((?:${I})(?:/(?:${I}))*)`:`(${I})`;h||(E=y&&l.length<2?`(?:/${E})`:"/"+E),y&&(E+="?"),r+=E,f+=20,y&&(f+=-8),_&&(f+=-20),I===".*"&&(f+=-50)}u.push(f)}s.push(u)}if(n.strict&&n.end){const l=s.length-1;s[l][s[l].length-1]+=.7000000000000001}n.strict||(r+="/?"),n.end?r+="$":n.strict&&(r+="(?:/|$)");const o=new RegExp(r,n.sensitive?"":"i");function a(l){const u=l.match(o),h={};if(!u)return null;for(let d=1;d<u.length;d++){const f=u[d]||"",p=i[d-1];h[p.name]=f&&p.repeatable?f.split("/"):f}return h}function c(l){let u="",h=!1;for(const d of t){(!h||!u.endsWith("/"))&&(u+="/"),h=!1;for(const f of d)if(f.type===0)u+=f.value;else if(f.type===1){const{value:p,repeatable:_,optional:y}=f,T=p in l?l[p]:"";if(Array.isArray(T)&&!_)throw new Error(`Provided param "${p}" is an array but it is not repeatable (* or + modifiers)`);const I=Array.isArray(T)?T.join("/"):T;if(!I)if(y)d.length<2&&(u.endsWith("/")?u=u.slice(0,-1):h=!0);else throw new Error(`Missing required param "${p}"`);u+=I}}return u}return{re:o,score:s,keys:i,parse:a,stringify:c}}function v1(t,e){let n=0;for(;n<t.length&&n<e.length;){const s=e[n]-t[n];if(s)return s;n++}return t.length<e.length?t.length===1&&t[0]===40+40?-1:1:t.length>e.length?e.length===1&&e[0]===40+40?1:-1:0}function w1(t,e){let n=0;const s=t.score,r=e.score;for(;n<s.length&&n<r.length;){const i=v1(s[n],r[n]);if(i)return i;n++}return r.length-s.length}const b1={type:0,value:""},I1=/[a-zA-Z0-9_]/;function E1(t){if(!t)return[[]];if(t==="/")return[[b1]];if(!t.startsWith("/"))throw new Error(`Invalid path "${t}"`);function e(f){throw new Error(`ERR (${n})/"${l}": ${f}`)}let n=0,s=n;const r=[];let i;function o(){i&&r.push(i),i=[]}let a=0,c,l="",u="";function h(){!l||(n===0?i.push({type:0,value:l}):n===1||n===2||n===3?(i.length>1&&(c==="*"||c==="+")&&e(`A repeatable param (${l}) must be alone in its segment. eg: '/:ids+.`),i.push({type:1,value:l,regexp:u,repeatable:c==="*"||c==="+",optional:c==="*"||c==="?"})):e("Invalid state to consume buffer"),l="")}function d(){l+=c}for(;a<t.length;){if(c=t[a++],c==="\\"&&n!==2){s=n,n=4;continue}switch(n){case 0:c==="/"?(l&&h(),o()):c===":"?(h(),n=1):d();break;case 4:d(),n=s;break;case 1:c==="("?n=2:I1.test(c)?d():(h(),n=0,c!=="*"&&c!=="?"&&c!=="+"&&a--);break;case 2:c===")"?u[u.length-1]=="\\"?u=u.slice(0,-1)+c:n=3:u+=c;break;case 3:h(),n=0,c!=="*"&&c!=="?"&&c!=="+"&&a--,u="";break;default:e("Unknown state");break}}return n===2&&e(`Unfinished custom RegExp for param "${l}"`),h(),o(),r}function T1(t,e,n){const s=y1(E1(t.path),n),r=Oe(s,{record:t,parent:e,children:[],alias:[]});return e&&!r.record.aliasOf==!e.record.aliasOf&&e.children.push(r),r}function S1(t,e){const n=[],s=new Map;e=Ob({strict:!1,end:!0,sensitive:!1},e);function r(u){return s.get(u)}function i(u,h,d){const f=!d,p=A1(u);p.aliasOf=d&&d.record;const _=Ob(e,u),y=[p];if("alias"in u){const E=typeof u.alias=="string"?[u.alias]:u.alias;for(const S of E)y.push(Oe({},p,{components:d?d.record.components:p.components,path:S,aliasOf:d?d.record:p}))}let T,I;for(const E of y){const{path:S}=E;if(h&&S[0]!=="/"){const $=h.record.path,H=$[$.length-1]==="/"?"":"/";E.path=h.record.path+(S&&H+S)}if(T=T1(E,h,_),d?d.alias.push(T):(I=I||T,I!==T&&I.alias.push(T),f&&u.name&&!xb(T)&&o(u.name)),"children"in p){const $=p.children;for(let H=0;H<$.length;H++)i($[H],T,d&&d.children[H])}d=d||T,c(T)}return I?()=>{o(I)}:Kc}function o(u){if(w0(u)){const h=s.get(u);h&&(s.delete(u),n.splice(n.indexOf(h),1),h.children.forEach(o),h.alias.forEach(o))}else{const h=n.indexOf(u);h>-1&&(n.splice(h,1),u.record.name&&s.delete(u.record.name),u.children.forEach(o),u.alias.forEach(o))}}function a(){return n}function c(u){let h=0;for(;h<n.length&&w1(u,n[h])>=0&&(u.record.path!==n[h].record.path||!I0(u,n[h]));)h++;n.splice(h,0,u),u.record.name&&!xb(u)&&s.set(u.record.name,u)}function l(u,h){let d,f={},p,_;if("name"in u&&u.name){if(d=s.get(u.name),!d)throw ba(1,{location:u});_=d.record.name,f=Oe(C1(h.params,d.keys.filter(I=>!I.optional).map(I=>I.name)),u.params),p=d.stringify(f)}else if("path"in u)p=u.path,d=n.find(I=>I.re.test(p)),d&&(f=d.parse(p),_=d.record.name);else{if(d=h.name?s.get(h.name):n.find(I=>I.re.test(h.path)),!d)throw ba(1,{location:u,currentLocation:h});_=d.record.name,f=Oe({},h.params,u.params),p=d.stringify(f)}const y=[];let T=d;for(;T;)y.unshift(T.record),T=T.parent;return{name:_,path:p,params:f,matched:y,meta:R1(y)}}return t.forEach(u=>i(u)),{addRoute:i,resolve:l,removeRoute:o,getRoutes:a,getRecordMatcher:r}}function C1(t,e){const n={};for(const s of e)s in t&&(n[s]=t[s]);return n}function A1(t){return{path:t.path,redirect:t.redirect,name:t.name,meta:t.meta||{},aliasOf:void 0,beforeEnter:t.beforeEnter,props:k1(t),children:t.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in t?t.components||{}:{default:t.component}}}function k1(t){const e={},n=t.props||!1;if("component"in t)e.default=n;else for(const s in t.components)e[s]=typeof n=="boolean"?n:n[s];return e}function xb(t){for(;t;){if(t.record.aliasOf)return!0;t=t.parent}return!1}function R1(t){return t.reduce((e,n)=>Oe(e,n.meta),{})}function Ob(t,e){const n={};for(const s in t)n[s]=s in e?e[s]:t[s];return n}function I0(t,e){return e.children.some(n=>n===t||I0(t,n))}const E0=/#/g,N1=/&/g,P1=/\//g,D1=/=/g,x1=/\?/g,T0=/\+/g,O1=/%5B/g,M1=/%5D/g,S0=/%5E/g,L1=/%60/g,C0=/%7B/g,F1=/%7C/g,A0=/%7D/g,U1=/%20/g;function F_(t){return encodeURI(""+t).replace(F1,"|").replace(O1,"[").replace(M1,"]")}function $1(t){return F_(t).replace(C0,"{").replace(A0,"}").replace(S0,"^")}function Yg(t){return F_(t).replace(T0,"%2B").replace(U1,"+").replace(E0,"%23").replace(N1,"%26").replace(L1,"`").replace(C0,"{").replace(A0,"}").replace(S0,"^")}function V1(t){return Yg(t).replace(D1,"%3D")}function B1(t){return F_(t).replace(E0,"%23").replace(x1,"%3F")}function q1(t){return t==null?"":B1(t).replace(P1,"%2F")}function qh(t){try{return decodeURIComponent(""+t)}catch{}return""+t}function j1(t){const e={};if(t===""||t==="?")return e;const s=(t[0]==="?"?t.slice(1):t).split("&");for(let r=0;r<s.length;++r){const i=s[r].replace(T0," "),o=i.indexOf("="),a=qh(o<0?i:i.slice(0,o)),c=o<0?null:qh(i.slice(o+1));if(a in e){let l=e[a];Array.isArray(l)||(l=e[a]=[l]),l.push(c)}else e[a]=c}return e}function Mb(t){let e="";for(let n in t){const s=t[n];if(n=V1(n),s==null){s!==void 0&&(e+=(e.length?"&":"")+n);continue}(Array.isArray(s)?s.map(i=>i&&Yg(i)):[s&&Yg(s)]).forEach(i=>{i!==void 0&&(e+=(e.length?"&":"")+n,i!=null&&(e+="="+i))})}return e}function K1(t){const e={};for(const n in t){const s=t[n];s!==void 0&&(e[n]=Array.isArray(s)?s.map(r=>r==null?null:""+r):s==null?s:""+s)}return e}function pc(){let t=[];function e(s){return t.push(s),()=>{const r=t.indexOf(s);r>-1&&t.splice(r,1)}}function n(){t=[]}return{add:e,list:()=>t,reset:n}}function Nr(t,e,n,s,r){const i=s&&(s.enterCallbacks[r]=s.enterCallbacks[r]||[]);return()=>new Promise((o,a)=>{const c=h=>{h===!1?a(ba(4,{from:n,to:e})):h instanceof Error?a(h):g1(h)?a(ba(2,{from:e,to:h})):(i&&s.enterCallbacks[r]===i&&typeof h=="function"&&i.push(h),o())},l=t.call(s&&s.instances[r],e,n,c);let u=Promise.resolve(l);t.length<3&&(u=u.then(c)),u.catch(h=>a(h))})}function Lp(t,e,n,s){const r=[];for(const i of t)for(const o in i.components){let a=i.components[o];if(!(e!=="beforeRouteEnter"&&!i.instances[o]))if(H1(a)){const l=(a.__vccOpts||a)[e];l&&r.push(Nr(l,n,s,i,o))}else{let c=a();r.push(()=>c.then(l=>{if(!l)return Promise.reject(new Error(`Couldn't resolve component "${o}" at "${i.path}"`));const u=YM(l)?l.default:l;i.components[o]=u;const d=(u.__vccOpts||u)[e];return d&&Nr(d,n,s,i,o)()}))}}return r}function H1(t){return typeof t=="object"||"displayName"in t||"props"in t||"__vccOpts"in t}function Lb(t){const e=ks(nf),n=ks(_0),s=ns(()=>e.resolve(Uc(t.to))),r=ns(()=>{const{matched:c}=s.value,{length:l}=c,u=c[l-1],h=n.matched;if(!u||!h.length)return-1;const d=h.findIndex(wa.bind(null,u));if(d>-1)return d;const f=Fb(c[l-2]);return l>1&&Fb(u)===f&&h[h.length-1].path!==f?h.findIndex(wa.bind(null,c[l-2])):d}),i=ns(()=>r.value>-1&&Q1(n.params,s.value.params)),o=ns(()=>r.value>-1&&r.value===n.matched.length-1&&y0(n.params,s.value.params));function a(c={}){return z1(c)?e[Uc(t.replace)?"replace":"push"](Uc(t.to)).catch(Kc):Promise.resolve()}return{route:s,href:ns(()=>s.value.href),isActive:i,isExactActive:o,navigate:a}}const W1=JS({name:"RouterLink",props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"}},useLink:Lb,setup(t,{slots:e}){const n=ja(Lb(t)),{options:s}=ks(nf),r=ns(()=>({[Ub(t.activeClass,s.linkActiveClass,"router-link-active")]:n.isActive,[Ub(t.exactActiveClass,s.linkExactActiveClass,"router-link-exact-active")]:n.isExactActive}));return()=>{const i=e.default&&e.default(n);return t.custom?i:M_("a",{"aria-current":n.isExactActive?t.ariaCurrentValue:null,href:n.href,onClick:n.navigate,class:r.value},i)}}}),G1=W1;function z1(t){if(!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)&&!t.defaultPrevented&&!(t.button!==void 0&&t.button!==0)){if(t.currentTarget&&t.currentTarget.getAttribute){const e=t.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(e))return}return t.preventDefault&&t.preventDefault(),!0}}function Q1(t,e){for(const n in e){const s=e[n],r=t[n];if(typeof s=="string"){if(s!==r)return!1}else if(!Array.isArray(r)||r.length!==s.length||s.some((i,o)=>i!==r[o]))return!1}return!0}function Fb(t){return t?t.aliasOf?t.aliasOf.path:t.path:""}const Ub=(t,e,n)=>t!=null?t:e!=null?e:n,Y1=JS({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},setup(t,{attrs:e,slots:n}){const s=ks(zg),r=ns(()=>t.route||s.value),i=ks(Cb,0),o=ns(()=>r.value.matched[i]);wh(Cb,i+1),wh(QM,o),wh(zg,r);const a=T_();return na(()=>[a.value,o.value,t.name],([c,l,u],[h,d,f])=>{l&&(l.instances[u]=c,d&&d!==l&&c&&c===h&&(l.leaveGuards.size||(l.leaveGuards=d.leaveGuards),l.updateGuards.size||(l.updateGuards=d.updateGuards))),c&&l&&(!d||!wa(l,d)||!h)&&(l.enterCallbacks[u]||[]).forEach(p=>p(c))},{flush:"post"}),()=>{const c=r.value,l=o.value,u=l&&l.components[t.name],h=t.name;if(!u)return $b(n.default,{Component:u,route:c});const d=l.props[t.name],f=d?d===!0?c.params:typeof d=="function"?d(c):d:null,_=M_(u,Oe({},f,e,{onVnodeUnmounted:y=>{y.component.isUnmounted&&(l.instances[h]=null)},ref:a}));return $b(n.default,{Component:_,route:c})||_}}});function $b(t,e){if(!t)return null;const n=t(e);return n.length===1?n[0]:n}const J1=Y1;function X1(t){const e=S1(t.routes,t),n=t.parseQuery||j1,s=t.stringifyQuery||Mb,r=t.history,i=pc(),o=pc(),a=pc(),c=aO(Er);let l=Er;zo&&t.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const u=Op.bind(null,C=>""+C),h=Op.bind(null,q1),d=Op.bind(null,qh);function f(C,Y){let B,J;return w0(C)?(B=e.getRecordMatcher(C),J=Y):J=C,e.addRoute(J,B)}function p(C){const Y=e.getRecordMatcher(C);Y&&e.removeRoute(Y)}function _(){return e.getRoutes().map(C=>C.record)}function y(C){return!!e.getRecordMatcher(C)}function T(C,Y){if(Y=Oe({},Y||c.value),typeof C=="string"){const de=Mp(n,C,Y.path),g=e.resolve({path:de.path},Y),m=r.createHref(de.fullPath);return Oe(de,g,{params:d(g.params),hash:qh(de.hash),redirectedFrom:void 0,href:m})}let B;if("path"in C)B=Oe({},C,{path:Mp(n,C.path,Y.path).path});else{const de=Oe({},C.params);for(const g in de)de[g]==null&&delete de[g];B=Oe({},C,{params:h(C.params)}),Y.params=h(Y.params)}const J=e.resolve(B,Y),Pe=C.hash||"";J.params=u(d(J.params));const $e=ZM(s,Oe({},C,{hash:$1(Pe),path:J.path})),_e=r.createHref($e);return Oe({fullPath:$e,hash:Pe,query:s===Mb?K1(C.query):C.query||{}},J,{redirectedFrom:void 0,href:_e})}function I(C){return typeof C=="string"?Mp(n,C,c.value.path):Oe({},C)}function E(C,Y){if(l!==C)return ba(8,{from:Y,to:C})}function S(C){return K(C)}function $(C){return S(Oe(I(C),{replace:!0}))}function H(C){const Y=C.matched[C.matched.length-1];if(Y&&Y.redirect){const{redirect:B}=Y;let J=typeof B=="function"?B(C):B;return typeof J=="string"&&(J=J.includes("?")||J.includes("#")?J=I(J):{path:J},J.params={}),Oe({query:C.query,hash:C.hash,params:C.params},J)}}function K(C,Y){const B=l=T(C),J=c.value,Pe=C.state,$e=C.force,_e=C.replace===!0,de=H(B);if(de)return K(Oe(I(de),{state:Pe,force:$e,replace:_e}),Y||B);const g=B;g.redirectedFrom=Y;let m;return!$e&&e1(s,J,B)&&(m=ba(16,{to:g,from:J}),Lo(J,J,!0,!1)),(m?Promise.resolve(m):ne(g,J)).catch(b=>Tr(b)?Tr(b,2)?b:Tn(b):Ue(b,g,J)).then(b=>{if(b){if(Tr(b,2))return K(Oe(I(b.to),{state:Pe,force:$e,replace:_e}),Y||g)}else b=Ce(g,J,!0,_e,Pe);return he(g,J,b),b})}function F(C,Y){const B=E(C,Y);return B?Promise.reject(B):Promise.resolve()}function ne(C,Y){let B;const[J,Pe,$e]=Z1(C,Y);B=Lp(J.reverse(),"beforeRouteLeave",C,Y);for(const de of J)de.leaveGuards.forEach(g=>{B.push(Nr(g,C,Y))});const _e=F.bind(null,C,Y);return B.push(_e),Uo(B).then(()=>{B=[];for(const de of i.list())B.push(Nr(de,C,Y));return B.push(_e),Uo(B)}).then(()=>{B=Lp(Pe,"beforeRouteUpdate",C,Y);for(const de of Pe)de.updateGuards.forEach(g=>{B.push(Nr(g,C,Y))});return B.push(_e),Uo(B)}).then(()=>{B=[];for(const de of C.matched)if(de.beforeEnter&&!Y.matched.includes(de))if(Array.isArray(de.beforeEnter))for(const g of de.beforeEnter)B.push(Nr(g,C,Y));else B.push(Nr(de.beforeEnter,C,Y));return B.push(_e),Uo(B)}).then(()=>(C.matched.forEach(de=>de.enterCallbacks={}),B=Lp($e,"beforeRouteEnter",C,Y),B.push(_e),Uo(B))).then(()=>{B=[];for(const de of o.list())B.push(Nr(de,C,Y));return B.push(_e),Uo(B)}).catch(de=>Tr(de,8)?de:Promise.reject(de))}function he(C,Y,B){for(const J of a.list())J(C,Y,B)}function Ce(C,Y,B,J,Pe){const $e=E(C,Y);if($e)return $e;const _e=Y===Er,de=zo?history.state:{};B&&(J||_e?r.replace(C.fullPath,Oe({scroll:_e&&de&&de.scroll},Pe)):r.push(C.fullPath,Pe)),c.value=C,Lo(C,Y,B,_e),Tn()}let z;function Re(){z=r.listen((C,Y,B)=>{const J=T(C),Pe=H(J);if(Pe){K(Oe(Pe,{replace:!0}),J).catch(Kc);return}l=J;const $e=c.value;zo&&c1(Rb($e.fullPath,B.delta),sf()),ne(J,$e).catch(_e=>Tr(_e,12)?_e:Tr(_e,2)?(K(_e.to,J).then(de=>{Tr(de,20)&&!B.delta&&B.type===yl.pop&&r.go(-1,!1)}).catch(Kc),Promise.reject()):(B.delta&&r.go(-B.delta,!1),Ue(_e,J,$e))).then(_e=>{_e=_e||Ce(J,$e,!1),_e&&(B.delta?r.go(-B.delta,!1):B.type===yl.pop&&Tr(_e,20)&&r.go(-1,!1)),he(J,$e,_e)}).catch(Kc)})}let Ze=pc(),et=pc(),tt;function Ue(C,Y,B){Tn(C);const J=et.list();return J.length?J.forEach(Pe=>Pe(C,Y,B)):console.error(C),Promise.reject(C)}function Ne(){return tt&&c.value!==Er?Promise.resolve():new Promise((C,Y)=>{Ze.add([C,Y])})}function Tn(C){return tt||(tt=!C,Re(),Ze.list().forEach(([Y,B])=>C?B(C):Y()),Ze.reset()),C}function Lo(C,Y,B,J){const{scrollBehavior:Pe}=t;if(!zo||!Pe)return Promise.resolve();const $e=!B&&l1(Rb(C.fullPath,0))||(J||!B)&&history.state&&history.state.scroll||null;return C_().then(()=>Pe(C,Y,$e)).then(_e=>_e&&a1(_e)).catch(_e=>Ue(_e,C,Y))}const Hs=C=>r.go(C);let ps;const Ln=new Set;return{currentRoute:c,addRoute:f,removeRoute:p,hasRoute:y,getRoutes:_,resolve:T,options:t,push:S,replace:$,go:Hs,back:()=>Hs(-1),forward:()=>Hs(1),beforeEach:i.add,beforeResolve:o.add,afterEach:a.add,onError:et.add,isReady:Ne,install(C){const Y=this;C.component("RouterLink",G1),C.component("RouterView",J1),C.config.globalProperties.$router=Y,Object.defineProperty(C.config.globalProperties,"$route",{enumerable:!0,get:()=>Uc(c)}),zo&&!ps&&c.value===Er&&(ps=!0,S(r.location).catch(Pe=>{}));const B={};for(const Pe in Er)B[Pe]=ns(()=>c.value[Pe]);C.provide(nf,Y),C.provide(_0,ja(B)),C.provide(zg,c);const J=C.unmount;Ln.add(C),C.unmount=function(){Ln.delete(C),Ln.size<1&&(l=Er,z&&z(),c.value=Er,ps=!1,tt=!1),J()}}}}function Uo(t){return t.reduce((e,n)=>e.then(()=>n()),Promise.resolve())}function Z1(t,e){const n=[],s=[],r=[],i=Math.max(e.matched.length,t.matched.length);for(let o=0;o<i;o++){const a=e.matched[o];a&&(t.matched.find(l=>wa(l,a))?s.push(a):n.push(a));const c=t.matched[o];c&&(e.matched.find(l=>wa(l,c))||r.push(c))}return[n,s,r]}function J9(){return ks(nf)}const eL=[{name:"Home",component:()=>ms(()=>import("./Home.004af04d.js"),["assets/Home.004af04d.js","assets/Home.f405ed79.css","assets/notes.aa3aa818.js"]),path:"/"},{name:"Add",component:()=>ms(()=>import("./Add.2cf2e35d.js"),["assets/Add.2cf2e35d.js","assets/Add.734cd8a9.css","assets/level.19f89a9b.js","assets/types.7d33b1ee.js","assets/loader.b0fd34bb.js","assets/loader.31e39e24.css"]),path:"/add"},{name:"Admin",component:()=>ms(()=>import("./admin.446203e4.js"),["assets/admin.446203e4.js","assets/admin.1da9aa51.css","assets/loader.b0fd34bb.js","assets/loader.31e39e24.css"]),path:"/admin"},{name:"Univercities",component:()=>ms(()=>import("./Uni.63c22b1f.js"),["assets/Uni.63c22b1f.js","assets/Uni.4065d4dd.css","assets/loader.b0fd34bb.js","assets/loader.31e39e24.css","assets/types.7d33b1ee.js"]),path:"/Univercities"},{name:"details",component:()=>ms(()=>import("./details.a51c83e7.js"),["assets/details.a51c83e7.js","assets/details.14721ffb.css","assets/loader.b0fd34bb.js","assets/loader.31e39e24.css"]),path:"/University/:name"},{name:"Dashboard",component:()=>ms(()=>import("./Dashboard.8ee300e9.js"),["assets/Dashboard.8ee300e9.js","assets/Dashboard.10ebd7a2.css","assets/loader.b0fd34bb.js","assets/loader.31e39e24.css"]),path:"/admin/dashboard"},{name:"Edit",component:()=>ms(()=>import("./Edit.1b0f159c.js"),["assets/Edit.1b0f159c.js","assets/Edit.bc9eb3d1.css","assets/loader.b0fd34bb.js","assets/loader.31e39e24.css","assets/level.19f89a9b.js","assets/types.7d33b1ee.js"]),path:"/admin/dashboard/edit/:name"},{name:"Testing",component:()=>ms(()=>import("./teting.e74cf420.js"),["assets/teting.e74cf420.js","assets/types.7d33b1ee.js"]),path:"/Testing"},{name:"Note",component:()=>ms(()=>import("./WebViewer.2e82d469.js"),["assets/WebViewer.2e82d469.js","assets/WebViewer.2b8dcf1a.css"]),path:"/note/:fileName"},{name:"Notes",component:()=>ms(()=>import("./notes.d9d578d4.js"),["assets/notes.d9d578d4.js","assets/notes.13953828.css","assets/notes.aa3aa818.js"]),path:"/notes"}],tL=X1({history:p1(),routes:eL});var lu=(t,e)=>{const n=t.__vccOpts||t;for(const[s,r]of e)n[s]=r;return n};const nL={},k0=t=>(A_("data-v-e6c8e518"),t=t(),k_(),t),sL={class:"container"},rL={class:"flex center between",id:"main-nav"},iL=k0(()=>Ye("div",{class:"flex center"},[Ye("div",{class:"logo"},[Ye("h1",null,"EDUCATIA")])],-1)),oL={class:"li"},aL=qs("Home"),cL=qs("Universities"),lL=qs("Notes"),uL=k0(()=>Ye("div",{class:"nav-button"},[Ye("a",{href:"#contact-form"},[Ye("button",{class:"btn btn-primary"},"Conatact")])],-1));function hL(t,e,n,s,r,i){const o=Pr("router-link");return Ts(),_a("header",null,[Ye("div",sL,[Ye("nav",rL,[iL,Ye("div",oL,[qe(o,{to:"/"},{default:ss(()=>[aL]),_:1}),qe(o,{to:"/Univercities"},{default:ss(()=>[cL]),_:1}),qe(o,{to:{name:"Notes"}},{default:ss(()=>[lL]),_:1})]),uL])])])}var dL=lu(nL,[["render",hL],["__scopeId","data-v-e6c8e518"]]),fL="/Educatia/icons8-hamburger-64.png",pL="/Educatia/icons8-multiply-40.png";const gL={name:"mobileNav",data(){return{isNav:!1}}},mL=t=>(A_("data-v-9a07ef5c"),t=t(),k_(),t),_L={class:"wrapper"},yL={class:"icon"},vL={key:0,class:"main-nav",ref:"nav"},wL=mL(()=>Ye("img",{src:pL,alt:""},null,-1)),bL=[wL],IL={class:"links"},EL=qs("Home"),TL=qs("Universities"),SL=qs("Notes");function CL(t,e,n,s,r,i){const o=Pr("router-link");return Ts(),_a("div",_L,[Ye("div",yL,[Ye("img",{ref:"ham",onClick:e[0]||(e[0]=a=>r.isNav=!0),src:fL,alt:""},null,512)]),qe(L_,null,{default:ss(()=>[r.isNav==!0?(Ts(),_a("div",vL,[Ye("div",{class:"cross",onClick:e[1]||(e[1]=a=>r.isNav=!1)},bL),Ye("div",IL,[qe(o,{to:"/",onClick:e[2]||(e[2]=a=>r.isNav=!1)},{default:ss(()=>[EL]),_:1}),qe(o,{to:"/Univercities",onClick:e[3]||(e[3]=a=>r.isNav=!1)},{default:ss(()=>[TL]),_:1}),qe(o,{to:"/Notes",onClick:e[4]||(e[4]=a=>r.isNav=!1)},{default:ss(()=>[SL]),_:1})])],512)):jc("",!0)]),_:1})])}var AL=lu(gL,[["render",CL],["__scopeId","data-v-9a07ef5c"]]);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const R0={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const O=function(t,e){if(!t)throw Ha(e)},Ha=function(t){return new Error("Firebase Database ("+R0.SDK_VERSION+") INTERNAL ASSERT FAILED: "+t)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const N0=function(t){const e=[];let n=0;for(let s=0;s<t.length;s++){let r=t.charCodeAt(s);r<128?e[n++]=r:r<2048?(e[n++]=r>>6|192,e[n++]=r&63|128):(r&64512)===55296&&s+1<t.length&&(t.charCodeAt(s+1)&64512)===56320?(r=65536+((r&1023)<<10)+(t.charCodeAt(++s)&1023),e[n++]=r>>18|240,e[n++]=r>>12&63|128,e[n++]=r>>6&63|128,e[n++]=r&63|128):(e[n++]=r>>12|224,e[n++]=r>>6&63|128,e[n++]=r&63|128)}return e},kL=function(t){const e=[];let n=0,s=0;for(;n<t.length;){const r=t[n++];if(r<128)e[s++]=String.fromCharCode(r);else if(r>191&&r<224){const i=t[n++];e[s++]=String.fromCharCode((r&31)<<6|i&63)}else if(r>239&&r<365){const i=t[n++],o=t[n++],a=t[n++],c=((r&7)<<18|(i&63)<<12|(o&63)<<6|a&63)-65536;e[s++]=String.fromCharCode(55296+(c>>10)),e[s++]=String.fromCharCode(56320+(c&1023))}else{const i=t[n++],o=t[n++];e[s++]=String.fromCharCode((r&15)<<12|(i&63)<<6|o&63)}}return e.join("")},rf={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,s=[];for(let r=0;r<t.length;r+=3){const i=t[r],o=r+1<t.length,a=o?t[r+1]:0,c=r+2<t.length,l=c?t[r+2]:0,u=i>>2,h=(i&3)<<4|a>>4;let d=(a&15)<<2|l>>6,f=l&63;c||(f=64,o||(d=64)),s.push(n[u],n[h],n[d],n[f])}return s.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(N0(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):kL(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,s=[];for(let r=0;r<t.length;){const i=n[t.charAt(r++)],a=r<t.length?n[t.charAt(r)]:0;++r;const l=r<t.length?n[t.charAt(r)]:64;++r;const h=r<t.length?n[t.charAt(r)]:64;if(++r,i==null||a==null||l==null||h==null)throw Error();const d=i<<2|a>>4;if(s.push(d),l!==64){const f=a<<4&240|l>>2;if(s.push(f),h!==64){const p=l<<6&192|h;s.push(p)}}}return s},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}},P0=function(t){const e=N0(t);return rf.encodeByteArray(e,!0)},jh=function(t){return P0(t).replace(/\./g,"")},Jg=function(t){try{return rf.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function RL(t){return vl(void 0,t)}function vl(t,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:const n=e;return new Date(n.getTime());case Object:t===void 0&&(t={});break;case Array:t=[];break;default:return e}for(const n in e)!e.hasOwnProperty(n)||!NL(n)||(t[n]=vl(t[n],e[n]));return t}function NL(t){return t!=="__proto__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mt{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,s)=>{n?this.reject(n):this.resolve(s),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,s))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function U_(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},s=e||"demo-project",r=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${s}`,aud:s,iat:r,exp:r+3600,auth_time:r,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},t),a="";return[jh(JSON.stringify(n)),jh(JSON.stringify(o)),a].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function We(){return typeof navigator!="undefined"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function of(){return typeof window!="undefined"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(We())}function $_(){try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function PL(){return typeof self=="object"&&self.self===self}function uu(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function hu(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function DL(){return We().indexOf("Electron/")>=0}function V_(){const t=We();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function xL(){return We().indexOf("MSAppHost/")>=0}function D0(){return R0.NODE_ADMIN===!0}function OL(){return!$_()&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function In(){return typeof indexedDB=="object"}function du(){return new Promise((t,e)=>{try{let n=!0;const s="validate-browser-context-for-indexeddb-analytics-module",r=self.indexedDB.open(s);r.onsuccess=()=>{r.result.close(),n||self.indexedDB.deleteDatabase(s),t(!0)},r.onupgradeneeded=()=>{n=!1},r.onerror=()=>{var i;e(((i=r.error)===null||i===void 0?void 0:i.message)||"")}}catch(n){e(n)}})}function af(){return!(typeof navigator=="undefined"||!navigator.cookieEnabled)}function ML(){if(typeof self!="undefined")return self;if(typeof window!="undefined")return window;if(typeof global!="undefined")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LL="FirebaseError";class ut extends Error{constructor(e,n,s){super(n),this.code=e,this.customData=s,this.name=LL,Object.setPrototypeOf(this,ut.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,pn.prototype.create)}}class pn{constructor(e,n,s){this.service=e,this.serviceName=n,this.errors=s}create(e,...n){const s=n[0]||{},r=`${this.service}/${e}`,i=this.errors[e],o=i?FL(i,s):"Error",a=`${this.serviceName}: ${o} (${r}).`;return new ut(r,a,s)}}function FL(t,e){return t.replace(UL,(n,s)=>{const r=e[s];return r!=null?String(r):`<${s}?>`})}const UL=/\{\$([^}]+)}/g;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wl(t){return JSON.parse(t)}function _t(t){return JSON.stringify(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const B_=function(t){let e={},n={},s={},r="";try{const i=t.split(".");e=wl(Jg(i[0])||""),n=wl(Jg(i[1])||""),r=i[2],s=n.d||{},delete n.d}catch{}return{header:e,claims:n,data:s,signature:r}},$L=function(t){const e=B_(t).claims;return typeof e=="object"&&e.hasOwnProperty("iat")?e.iat:null},VL=function(t){const e=B_(t),n=e.claims;return!!n&&typeof n=="object"&&n.hasOwnProperty("iat")},BL=function(t){const e=B_(t).claims;return typeof e=="object"&&e.admin===!0};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xn(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function Yi(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]}function Kh(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Hh(t,e,n){const s={};for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&(s[r]=e.call(n,t[r],r,t));return s}function Xg(t,e){if(t===e)return!0;const n=Object.keys(t),s=Object.keys(e);for(const r of n){if(!s.includes(r))return!1;const i=t[r],o=e[r];if(Vb(i)&&Vb(o)){if(!Xg(i,o))return!1}else if(i!==o)return!1}for(const r of s)if(!n.includes(r))return!1;return!0}function Vb(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function To(t){const e=[];for(const[n,s]of Object.entries(t))Array.isArray(s)?s.forEach(r=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(r))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(s));return e.length?"&"+e.join("&"):""}function Yo(t){const e={};return t.replace(/^\?/,"").split("&").forEach(s=>{if(s){const[r,i]=s.split("=");e[decodeURIComponent(r)]=decodeURIComponent(i)}}),e}function xc(t){const e=t.indexOf("?");if(!e)return"";const n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qL{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=512/8,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(e,n){n||(n=0);const s=this.W_;if(typeof e=="string")for(let h=0;h<16;h++)s[h]=e.charCodeAt(n)<<24|e.charCodeAt(n+1)<<16|e.charCodeAt(n+2)<<8|e.charCodeAt(n+3),n+=4;else for(let h=0;h<16;h++)s[h]=e[n]<<24|e[n+1]<<16|e[n+2]<<8|e[n+3],n+=4;for(let h=16;h<80;h++){const d=s[h-3]^s[h-8]^s[h-14]^s[h-16];s[h]=(d<<1|d>>>31)&4294967295}let r=this.chain_[0],i=this.chain_[1],o=this.chain_[2],a=this.chain_[3],c=this.chain_[4],l,u;for(let h=0;h<80;h++){h<40?h<20?(l=a^i&(o^a),u=1518500249):(l=i^o^a,u=1859775393):h<60?(l=i&o|a&(i|o),u=2400959708):(l=i^o^a,u=3395469782);const d=(r<<5|r>>>27)+l+c+u+s[h]&4294967295;c=a,a=o,o=(i<<30|i>>>2)&4294967295,i=r,r=d}this.chain_[0]=this.chain_[0]+r&4294967295,this.chain_[1]=this.chain_[1]+i&4294967295,this.chain_[2]=this.chain_[2]+o&4294967295,this.chain_[3]=this.chain_[3]+a&4294967295,this.chain_[4]=this.chain_[4]+c&4294967295}update(e,n){if(e==null)return;n===void 0&&(n=e.length);const s=n-this.blockSize;let r=0;const i=this.buf_;let o=this.inbuf_;for(;r<n;){if(o===0)for(;r<=s;)this.compress_(e,r),r+=this.blockSize;if(typeof e=="string"){for(;r<n;)if(i[o]=e.charCodeAt(r),++o,++r,o===this.blockSize){this.compress_(i),o=0;break}}else for(;r<n;)if(i[o]=e[r],++o,++r,o===this.blockSize){this.compress_(i),o=0;break}}this.inbuf_=o,this.total_+=n}digest(){const e=[];let n=this.total_*8;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let r=this.blockSize-1;r>=56;r--)this.buf_[r]=n&255,n/=256;this.compress_(this.buf_);let s=0;for(let r=0;r<5;r++)for(let i=24;i>=0;i-=8)e[s]=this.chain_[r]>>i&255,++s;return e}}function x0(t,e){const n=new jL(t,e);return n.subscribe.bind(n)}class jL{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(s=>{this.error(s)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,s){let r;if(e===void 0&&n===void 0&&s===void 0)throw new Error("Missing Observer.");KL(e,["next","error","complete"])?r=e:r={next:e,error:n,complete:s},r.next===void 0&&(r.next=Fp),r.error===void 0&&(r.error=Fp),r.complete===void 0&&(r.complete=Fp);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch{}}),this.observers.push(r),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(s){typeof console!="undefined"&&console.error&&console.error(s)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function KL(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function Fp(){}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const se=function(t,e,n,s){let r;if(s<e?r="at least "+e:s>n&&(r=n===0?"none":"no more than "+n),r){const i=t+" failed: Was called with "+s+(s===1?" argument.":" arguments.")+" Expects "+r+".";throw new Error(i)}};function bn(t,e){return`${t} failed: ${e} argument `}function Et(t,e,n,s){if(!(s&&!n)&&typeof n!="function")throw new Error(bn(t,e)+"must be a valid function.")}function Bb(t,e,n,s){if(!(s&&!n)&&(typeof n!="object"||n===null))throw new Error(bn(t,e)+"must be a valid context object.")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HL=function(t){const e=[];let n=0;for(let s=0;s<t.length;s++){let r=t.charCodeAt(s);if(r>=55296&&r<=56319){const i=r-55296;s++,O(s<t.length,"Surrogate pair missing trail surrogate.");const o=t.charCodeAt(s)-56320;r=65536+(i<<10)+o}r<128?e[n++]=r:r<2048?(e[n++]=r>>6|192,e[n++]=r&63|128):r<65536?(e[n++]=r>>12|224,e[n++]=r>>6&63|128,e[n++]=r&63|128):(e[n++]=r>>18|240,e[n++]=r>>12&63|128,e[n++]=r>>6&63|128,e[n++]=r&63|128)}return e},cf=function(t){let e=0;for(let n=0;n<t.length;n++){const s=t.charCodeAt(n);s<128?e++:s<2048?e+=2:s>=55296&&s<=56319?(e+=4,n++):e+=3}return e};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WL=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,t=>{const e=Math.random()*16|0;return(t==="x"?e:e&3|8).toString(16)})};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GL=1e3,zL=2,QL=4*60*60*1e3,YL=.5;function Wh(t,e=GL,n=zL){const s=e*Math.pow(n,t),r=Math.round(YL*s*(Math.random()-.5)*2);return Math.min(QL,s+r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function N(t){return t&&t._delegate?t._delegate:t}class Ee{constructor(e,n,s){this.name=e,this.instanceFactory=n,this.type=s,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ti="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O0{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const s=new mt;if(this.instancesDeferred.set(n,s),this.isInitialized(n)||this.shouldAutoInitialize())try{const r=this.getOrInitializeService({instanceIdentifier:n});r&&s.resolve(r)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;const s=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),r=(n=e==null?void 0:e.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(s)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:s})}catch(i){if(r)return null;throw i}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(XL(e))try{this.getOrInitializeService({instanceIdentifier:Ti})}catch{}for(const[n,s]of this.instancesDeferred.entries()){const r=this.normalizeInstanceIdentifier(n);try{const i=this.getOrInitializeService({instanceIdentifier:r});s.resolve(i)}catch{}}}}clearInstance(e=Ti){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Ti){return this.instances.has(e)}getOptions(e=Ti){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,s=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(s))throw Error(`${this.name}(${s}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const r=this.getOrInitializeService({instanceIdentifier:s,options:n});for(const[i,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(i);s===a&&o.resolve(r)}return r}onInit(e,n){var s;const r=this.normalizeInstanceIdentifier(n),i=(s=this.onInitCallbacks.get(r))!==null&&s!==void 0?s:new Set;i.add(e),this.onInitCallbacks.set(r,i);const o=this.instances.get(r);return o&&e(o,r),()=>{i.delete(e)}}invokeOnInitCallbacks(e,n){const s=this.onInitCallbacks.get(n);if(!!s)for(const r of s)try{r(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let s=this.instances.get(e);if(!s&&this.component&&(s=this.component.instanceFactory(this.container,{instanceIdentifier:JL(e),options:n}),this.instances.set(e,s),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(s,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,s)}catch{}return s||null}normalizeInstanceIdentifier(e=Ti){return this.component?this.component.multipleInstances?e:Ti:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function JL(t){return t===Ti?void 0:t}function XL(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M0{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new O0(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const q_=[];var fe;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(fe||(fe={}));const L0={debug:fe.DEBUG,verbose:fe.VERBOSE,info:fe.INFO,warn:fe.WARN,error:fe.ERROR,silent:fe.SILENT},ZL=fe.INFO,eF={[fe.DEBUG]:"log",[fe.VERBOSE]:"log",[fe.INFO]:"info",[fe.WARN]:"warn",[fe.ERROR]:"error"},tF=(t,e,...n)=>{if(e<t.logLevel)return;const s=new Date().toISOString(),r=eF[e];if(r)console[r](`[${s}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class js{constructor(e){this.name=e,this._logLevel=ZL,this._logHandler=tF,this._userLogHandler=null,q_.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in fe))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?L0[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,fe.DEBUG,...e),this._logHandler(this,fe.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,fe.VERBOSE,...e),this._logHandler(this,fe.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,fe.INFO,...e),this._logHandler(this,fe.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,fe.WARN,...e),this._logHandler(this,fe.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,fe.ERROR,...e),this._logHandler(this,fe.ERROR,...e)}}function nF(t){q_.forEach(e=>{e.setLogLevel(t)})}function sF(t,e){for(const n of q_){let s=null;e&&e.level&&(s=L0[e.level]),t===null?n.userLogHandler=null:n.userLogHandler=(r,i,...o)=>{const a=o.map(c=>{if(c==null)return null;if(typeof c=="string")return c;if(typeof c=="number"||typeof c=="boolean")return c.toString();if(c instanceof Error)return c.message;try{return JSON.stringify(c)}catch{return null}}).filter(c=>c).join(" ");i>=(s!=null?s:r.logLevel)&&t({level:fe[i].toLowerCase(),message:a,args:o,type:r.name})}}}const rF=(t,e)=>e.some(n=>t instanceof n);let qb,jb;function iF(){return qb||(qb=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function oF(){return jb||(jb=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const F0=new WeakMap,Zg=new WeakMap,U0=new WeakMap,Up=new WeakMap,j_=new WeakMap;function aF(t){const e=new Promise((n,s)=>{const r=()=>{t.removeEventListener("success",i),t.removeEventListener("error",o)},i=()=>{n(tr(t.result)),r()},o=()=>{s(t.error),r()};t.addEventListener("success",i),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&F0.set(n,t)}).catch(()=>{}),j_.set(e,t),e}function cF(t){if(Zg.has(t))return;const e=new Promise((n,s)=>{const r=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",o),t.removeEventListener("abort",o)},i=()=>{n(),r()},o=()=>{s(t.error||new DOMException("AbortError","AbortError")),r()};t.addEventListener("complete",i),t.addEventListener("error",o),t.addEventListener("abort",o)});Zg.set(t,e)}let em={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return Zg.get(t);if(e==="objectStoreNames")return t.objectStoreNames||U0.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return tr(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function lF(t){em=t(em)}function uF(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const s=t.call($p(this),e,...n);return U0.set(s,e.sort?e.sort():[e]),tr(s)}:oF().includes(t)?function(...e){return t.apply($p(this),e),tr(F0.get(this))}:function(...e){return tr(t.apply($p(this),e))}}function hF(t){return typeof t=="function"?uF(t):(t instanceof IDBTransaction&&cF(t),rF(t,iF())?new Proxy(t,em):t)}function tr(t){if(t instanceof IDBRequest)return aF(t);if(Up.has(t))return Up.get(t);const e=hF(t);return e!==t&&(Up.set(t,e),j_.set(e,t)),e}const $p=t=>j_.get(t);function Wa(t,e,{blocked:n,upgrade:s,blocking:r,terminated:i}={}){const o=indexedDB.open(t,e),a=tr(o);return s&&o.addEventListener("upgradeneeded",c=>{s(tr(o.result),c.oldVersion,c.newVersion,tr(o.transaction))}),n&&o.addEventListener("blocked",()=>n()),a.then(c=>{i&&c.addEventListener("close",()=>i()),r&&c.addEventListener("versionchange",()=>r())}).catch(()=>{}),a}function sa(t,{blocked:e}={}){const n=indexedDB.deleteDatabase(t);return e&&n.addEventListener("blocked",()=>e()),tr(n).then(()=>{})}const dF=["get","getKey","getAll","getAllKeys","count"],fF=["put","add","delete","clear"],Vp=new Map;function Kb(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(Vp.get(e))return Vp.get(e);const n=e.replace(/FromIndex$/,""),s=e!==n,r=fF.includes(n);if(!(n in(s?IDBIndex:IDBObjectStore).prototype)||!(r||dF.includes(n)))return;const i=async function(o,...a){const c=this.transaction(o,r?"readwrite":"readonly");let l=c.store;return s&&(l=l.index(a.shift())),(await Promise.all([l[n](...a),r&&c.done]))[0]};return Vp.set(e,i),i}lF(t=>({...t,get:(e,n,s)=>Kb(e,n)||t.get(e,n,s),has:(e,n)=>!!Kb(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pF{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(gF(n)){const s=n.getImmediate();return`${s.library}/${s.version}`}else return null}).filter(n=>n).join(" ")}}function gF(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const tm="@firebase/app",Hb="0.7.28";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const K_=new js("@firebase/app"),mF="@firebase/app-compat",_F="@firebase/analytics-compat",yF="@firebase/analytics",vF="@firebase/app-check-compat",wF="@firebase/app-check",bF="@firebase/auth",IF="@firebase/auth-compat",EF="@firebase/database",TF="@firebase/database-compat",SF="@firebase/functions",CF="@firebase/functions-compat",AF="@firebase/installations",kF="@firebase/installations-compat",RF="@firebase/messaging",NF="@firebase/messaging-compat",PF="@firebase/performance",DF="@firebase/performance-compat",xF="@firebase/remote-config",OF="@firebase/remote-config-compat",MF="@firebase/storage",LF="@firebase/storage-compat",FF="@firebase/firestore",UF="@firebase/firestore-compat",$F="firebase",VF="9.9.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ji="[DEFAULT]",BF={[tm]:"fire-core",[mF]:"fire-core-compat",[yF]:"fire-analytics",[_F]:"fire-analytics-compat",[wF]:"fire-app-check",[vF]:"fire-app-check-compat",[bF]:"fire-auth",[IF]:"fire-auth-compat",[EF]:"fire-rtdb",[TF]:"fire-rtdb-compat",[SF]:"fire-fn",[CF]:"fire-fn-compat",[AF]:"fire-iid",[kF]:"fire-iid-compat",[RF]:"fire-fcm",[NF]:"fire-fcm-compat",[PF]:"fire-perf",[DF]:"fire-perf-compat",[xF]:"fire-rc",[OF]:"fire-rc-compat",[MF]:"fire-gcs",[LF]:"fire-gcs-compat",[FF]:"fire-fst",[UF]:"fire-fst-compat","fire-js":"fire-js",[$F]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qr=new Map,bl=new Map;function Gh(t,e){try{t.container.addComponent(e)}catch(n){K_.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function $0(t,e){t.container.addOrOverwriteComponent(e)}function rt(t){const e=t.name;if(bl.has(e))return K_.debug(`There were multiple attempts to register component ${e}.`),!1;bl.set(e,t);for(const n of Qr.values())Gh(n,t);return!0}function So(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function qF(t,e,n=Ji){So(t,e).clearInstance(n)}function jF(){bl.clear()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KF={["no-app"]:"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()",["bad-app-name"]:"Illegal App name: '{$appName}",["duplicate-app"]:"Firebase App named '{$appName}' already exists with different options or config",["app-deleted"]:"Firebase App named '{$appName}' already deleted",["invalid-app-argument"]:"firebase.{$appName}() takes either no argument or a Firebase App instance.",["invalid-log-argument"]:"First argument to `onLog` must be null or a function.",["storage-open"]:"Error thrown when opening storage. Original error: {$originalErrorMessage}.",["storage-get"]:"Error thrown when reading from storage. Original error: {$originalErrorMessage}.",["storage-set"]:"Error thrown when writing to storage. Original error: {$originalErrorMessage}.",["storage-delete"]:"Error thrown when deleting from storage. Original error: {$originalErrorMessage}."},Yr=new pn("app","Firebase",KF);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HF{constructor(e,n,s){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=s,this.container.addComponent(new Ee("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Yr.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ks=VF;function V0(t,e={}){typeof e!="object"&&(e={name:e});const n=Object.assign({name:Ji,automaticDataCollectionEnabled:!1},e),s=n.name;if(typeof s!="string"||!s)throw Yr.create("bad-app-name",{appName:String(s)});const r=Qr.get(s);if(r){if(Xg(t,r.options)&&Xg(n,r.config))return r;throw Yr.create("duplicate-app",{appName:s})}const i=new M0(s);for(const a of bl.values())i.addComponent(a);const o=new HF(t,n,i);return Qr.set(s,o),o}function B0(t=Ji){const e=Qr.get(t);if(!e)throw Yr.create("no-app",{appName:t});return e}function WF(){return Array.from(Qr.values())}async function q0(t){const e=t.name;Qr.has(e)&&(Qr.delete(e),await Promise.all(t.container.getProviders().map(n=>n.delete())),t.isDeleted=!0)}function Fe(t,e,n){var s;let r=(s=BF[t])!==null&&s!==void 0?s:t;n&&(r+=`-${n}`);const i=r.match(/\s|\//),o=e.match(/\s|\//);if(i||o){const a=[`Unable to register library "${r}" with version "${e}":`];i&&a.push(`library name "${r}" contains illegal characters (whitespace or "/")`),i&&o&&a.push("and"),o&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),K_.warn(a.join(" "));return}rt(new Ee(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}function j0(t,e){if(t!==null&&typeof t!="function")throw Yr.create("invalid-log-argument");sF(t,e)}function K0(t){nF(t)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GF="firebase-heartbeat-database",zF=1,Il="firebase-heartbeat-store";let Bp=null;function H0(){return Bp||(Bp=Wa(GF,zF,{upgrade:(t,e)=>{switch(e){case 0:t.createObjectStore(Il)}}}).catch(t=>{throw Yr.create("storage-open",{originalErrorMessage:t.message})})),Bp}async function QF(t){var e;try{return(await H0()).transaction(Il).objectStore(Il).get(W0(t))}catch(n){throw Yr.create("storage-get",{originalErrorMessage:(e=n)===null||e===void 0?void 0:e.message})}}async function Wb(t,e){var n;try{const r=(await H0()).transaction(Il,"readwrite");return await r.objectStore(Il).put(e,W0(t)),r.done}catch(s){throw Yr.create("storage-set",{originalErrorMessage:(n=s)===null||n===void 0?void 0:n.message})}}function W0(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YF=1024,JF=30*24*60*60*1e3;class XF{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new eU(n),this._heartbeatsCachePromise=this._storage.read().then(s=>(this._heartbeatsCache=s,s))}async triggerHeartbeat(){const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=Gb();if(this._heartbeatsCache===null&&(this._heartbeatsCache=await this._heartbeatsCachePromise),!(this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(r=>r.date===s)))return this._heartbeatsCache.heartbeats.push({date:s,agent:n}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(r=>{const i=new Date(r.date).valueOf();return Date.now()-i<=JF}),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache===null||this._heartbeatsCache.heartbeats.length===0)return"";const e=Gb(),{heartbeatsToSend:n,unsentEntries:s}=ZF(this._heartbeatsCache.heartbeats),r=jh(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=e,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),r}}function Gb(){return new Date().toISOString().substring(0,10)}function ZF(t,e=YF){const n=[];let s=t.slice();for(const r of t){const i=n.find(o=>o.agent===r.agent);if(i){if(i.dates.push(r.date),zb(n)>e){i.dates.pop();break}}else if(n.push({agent:r.agent,dates:[r.date]}),zb(n)>e){n.pop();break}s=s.slice(1)}return{heartbeatsToSend:n,unsentEntries:s}}class eU{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return In()?du().then(()=>!0).catch(()=>!1):!1}async read(){return await this._canUseIndexedDBPromise?await QF(this.app)||{heartbeats:[]}:{heartbeats:[]}}async overwrite(e){var n;if(await this._canUseIndexedDBPromise){const r=await this.read();return Wb(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var n;if(await this._canUseIndexedDBPromise){const r=await this.read();return Wb(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function zb(t){return jh(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tU(t){rt(new Ee("platform-logger",e=>new pF(e),"PRIVATE")),rt(new Ee("heartbeat",e=>new XF(e),"PRIVATE")),Fe(tm,Hb,t),Fe(tm,Hb,"esm2017"),Fe("fire-js","")}tU("");var nU=Object.freeze(Object.defineProperty({__proto__:null,SDK_VERSION:Ks,_DEFAULT_ENTRY_NAME:Ji,_addComponent:Gh,_addOrOverwriteComponent:$0,_apps:Qr,_clearComponents:jF,_components:bl,_getProvider:So,_registerComponent:rt,_removeServiceInstance:qF,deleteApp:q0,getApp:B0,getApps:WF,initializeApp:V0,onLog:j0,registerVersion:Fe,setLogLevel:K0,FirebaseError:ut},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sU{constructor(e,n){this._delegate=e,this.firebase=n,Gh(e,new Ee("app-compat",()=>this,"PUBLIC")),this.container=e.container}get automaticDataCollectionEnabled(){return this._delegate.automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this._delegate.automaticDataCollectionEnabled=e}get name(){return this._delegate.name}get options(){return this._delegate.options}delete(){return new Promise(e=>{this._delegate.checkDestroyed(),e()}).then(()=>(this.firebase.INTERNAL.removeApp(this.name),q0(this._delegate)))}_getService(e,n=Ji){var s;this._delegate.checkDestroyed();const r=this._delegate.container.getProvider(e);return!r.isInitialized()&&((s=r.getComponent())===null||s===void 0?void 0:s.instantiationMode)==="EXPLICIT"&&r.initialize(),r.getImmediate({identifier:n})}_removeServiceInstance(e,n=Ji){this._delegate.container.getProvider(e).clearInstance(n)}_addComponent(e){Gh(this._delegate,e)}_addOrOverwriteComponent(e){$0(this._delegate,e)}toJSON(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rU={["no-app"]:"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()",["invalid-app-argument"]:"firebase.{$appName}() takes either no argument or a Firebase App instance."},Qb=new pn("app-compat","Firebase",rU);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iU(t){const e={},n={__esModule:!0,initializeApp:i,app:r,registerVersion:Fe,setLogLevel:K0,onLog:j0,apps:null,SDK_VERSION:Ks,INTERNAL:{registerComponent:a,removeApp:s,useAsService:c,modularAPIs:nU}};n.default=n,Object.defineProperty(n,"apps",{get:o});function s(l){delete e[l]}function r(l){if(l=l||Ji,!xn(e,l))throw Qb.create("no-app",{appName:l});return e[l]}r.App=t;function i(l,u={}){const h=V0(l,u);if(xn(e,h.name))return e[h.name];const d=new t(h,n);return e[h.name]=d,d}function o(){return Object.keys(e).map(l=>e[l])}function a(l){const u=l.name,h=u.replace("-compat","");if(rt(l)&&l.type==="PUBLIC"){const d=(f=r())=>{if(typeof f[h]!="function")throw Qb.create("invalid-app-argument",{appName:u});return f[h]()};l.serviceProps!==void 0&&vl(d,l.serviceProps),n[h]=d,t.prototype[h]=function(...f){return this._getService.bind(this,u).apply(this,l.multipleInstances?f:[])}}return l.type==="PUBLIC"?n[h]:null}function c(l,u){return u==="serverAuth"?null:u}return n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function G0(){const t=iU(sU);t.INTERNAL=Object.assign(Object.assign({},t.INTERNAL),{createFirebaseNamespace:G0,extendNamespace:e,createSubscribe:x0,ErrorFactory:pn,deepExtend:vl});function e(n){vl(t,n)}return t}const oU=G0();/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yb=new js("@firebase/app-compat"),aU="@firebase/app-compat",cU="0.1.29";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lU(t){Fe(aU,cU,t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */if(PL()&&self.firebase!==void 0){Yb.warn(`
    Warning: Firebase is already defined in the global scope. Please make sure
    Firebase library is only loaded once.
  `);const t=self.firebase.SDK_VERSION;t&&t.indexOf("LITE")>=0&&Yb.warn(`
    Warning: You are trying to load Firebase while using Firebase Performance standalone script.
    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.
    `)}const ht=oU;lU();const z0="@firebase/installations",H_="0.5.12";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Q0=1e4,Y0=`w:${H_}`,J0="FIS_v2",uU="https://firebaseinstallations.googleapis.com/v1",hU=60*60*1e3,dU="installations",fU="Installations";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pU={["missing-app-config-values"]:'Missing App configuration value: "{$valueName}"',["not-registered"]:"Firebase Installation is not registered.",["installation-not-found"]:"Firebase Installation not found.",["request-failed"]:'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',["app-offline"]:"Could not process request. Application offline.",["delete-pending-registration"]:"Can't delete installation while there is a pending registration request."},Xi=new pn(dU,fU,pU);function X0(t){return t instanceof ut&&t.code.includes("request-failed")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Z0({projectId:t}){return`${uU}/projects/${t}/installations`}function eC(t){return{token:t.token,requestStatus:2,expiresIn:mU(t.expiresIn),creationTime:Date.now()}}async function tC(t,e){const s=(await e.json()).error;return Xi.create("request-failed",{requestName:t,serverCode:s.code,serverMessage:s.message,serverStatus:s.status})}function nC({apiKey:t}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t})}function gU(t,{refreshToken:e}){const n=nC(t);return n.append("Authorization",_U(e)),n}async function sC(t){const e=await t();return e.status>=500&&e.status<600?t():e}function mU(t){return Number(t.replace("s","000"))}function _U(t){return`${J0} ${t}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function yU({appConfig:t,heartbeatServiceProvider:e},{fid:n}){const s=Z0(t),r=nC(t),i=e.getImmediate({optional:!0});if(i){const l=await i.getHeartbeatsHeader();l&&r.append("x-firebase-client",l)}const o={fid:n,authVersion:J0,appId:t.appId,sdkVersion:Y0},a={method:"POST",headers:r,body:JSON.stringify(o)},c=await sC(()=>fetch(s,a));if(c.ok){const l=await c.json();return{fid:l.fid||n,registrationStatus:2,refreshToken:l.refreshToken,authToken:eC(l.authToken)}}else throw await tC("Create Installation",c)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rC(t){return new Promise(e=>{setTimeout(e,t)})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vU(t){return btoa(String.fromCharCode(...t)).replace(/\+/g,"-").replace(/\//g,"_")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wU=/^[cdef][\w-]{21}$/,nm="";function bU(){try{const t=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(t),t[0]=112+t[0]%16;const n=IU(t);return wU.test(n)?n:nm}catch{return nm}}function IU(t){return vU(t).substr(0,22)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lf(t){return`${t.appName}!${t.appId}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iC=new Map;function oC(t,e){const n=lf(t);aC(n,e),EU(n,e)}function aC(t,e){const n=iC.get(t);if(!!n)for(const s of n)s(e)}function EU(t,e){const n=TU();n&&n.postMessage({key:t,fid:e}),SU()}let Li=null;function TU(){return!Li&&"BroadcastChannel"in self&&(Li=new BroadcastChannel("[Firebase] FID Change"),Li.onmessage=t=>{aC(t.data.key,t.data.fid)}),Li}function SU(){iC.size===0&&Li&&(Li.close(),Li=null)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CU="firebase-installations-database",AU=1,Zi="firebase-installations-store";let qp=null;function W_(){return qp||(qp=Wa(CU,AU,{upgrade:(t,e)=>{switch(e){case 0:t.createObjectStore(Zi)}}})),qp}async function zh(t,e){const n=lf(t),r=(await W_()).transaction(Zi,"readwrite"),i=r.objectStore(Zi),o=await i.get(n);return await i.put(e,n),await r.done,(!o||o.fid!==e.fid)&&oC(t,e.fid),e}async function cC(t){const e=lf(t),s=(await W_()).transaction(Zi,"readwrite");await s.objectStore(Zi).delete(e),await s.done}async function uf(t,e){const n=lf(t),r=(await W_()).transaction(Zi,"readwrite"),i=r.objectStore(Zi),o=await i.get(n),a=e(o);return a===void 0?await i.delete(n):await i.put(a,n),await r.done,a&&(!o||o.fid!==a.fid)&&oC(t,a.fid),a}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function G_(t){let e;const n=await uf(t.appConfig,s=>{const r=kU(s),i=RU(t,r);return e=i.registrationPromise,i.installationEntry});return n.fid===nm?{installationEntry:await e}:{installationEntry:n,registrationPromise:e}}function kU(t){const e=t||{fid:bU(),registrationStatus:0};return lC(e)}function RU(t,e){if(e.registrationStatus===0){if(!navigator.onLine){const r=Promise.reject(Xi.create("app-offline"));return{installationEntry:e,registrationPromise:r}}const n={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},s=NU(t,n);return{installationEntry:n,registrationPromise:s}}else return e.registrationStatus===1?{installationEntry:e,registrationPromise:PU(t)}:{installationEntry:e}}async function NU(t,e){try{const n=await yU(t,e);return zh(t.appConfig,n)}catch(n){throw X0(n)&&n.customData.serverCode===409?await cC(t.appConfig):await zh(t.appConfig,{fid:e.fid,registrationStatus:0}),n}}async function PU(t){let e=await Jb(t.appConfig);for(;e.registrationStatus===1;)await rC(100),e=await Jb(t.appConfig);if(e.registrationStatus===0){const{installationEntry:n,registrationPromise:s}=await G_(t);return s||n}return e}function Jb(t){return uf(t,e=>{if(!e)throw Xi.create("installation-not-found");return lC(e)})}function lC(t){return DU(t)?{fid:t.fid,registrationStatus:0}:t}function DU(t){return t.registrationStatus===1&&t.registrationTime+Q0<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function xU({appConfig:t,heartbeatServiceProvider:e},n){const s=OU(t,n),r=gU(t,n),i=e.getImmediate({optional:!0});if(i){const l=await i.getHeartbeatsHeader();l&&r.append("x-firebase-client",l)}const o={installation:{sdkVersion:Y0,appId:t.appId}},a={method:"POST",headers:r,body:JSON.stringify(o)},c=await sC(()=>fetch(s,a));if(c.ok){const l=await c.json();return eC(l)}else throw await tC("Generate Auth Token",c)}function OU(t,{fid:e}){return`${Z0(t)}/${e}/authTokens:generate`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function z_(t,e=!1){let n;const s=await uf(t.appConfig,i=>{if(!uC(i))throw Xi.create("not-registered");const o=i.authToken;if(!e&&FU(o))return i;if(o.requestStatus===1)return n=MU(t,e),i;{if(!navigator.onLine)throw Xi.create("app-offline");const a=$U(i);return n=LU(t,a),a}});return n?await n:s.authToken}async function MU(t,e){let n=await Xb(t.appConfig);for(;n.authToken.requestStatus===1;)await rC(100),n=await Xb(t.appConfig);const s=n.authToken;return s.requestStatus===0?z_(t,e):s}function Xb(t){return uf(t,e=>{if(!uC(e))throw Xi.create("not-registered");const n=e.authToken;return VU(n)?Object.assign(Object.assign({},e),{authToken:{requestStatus:0}}):e})}async function LU(t,e){try{const n=await xU(t,e),s=Object.assign(Object.assign({},e),{authToken:n});return await zh(t.appConfig,s),n}catch(n){if(X0(n)&&(n.customData.serverCode===401||n.customData.serverCode===404))await cC(t.appConfig);else{const s=Object.assign(Object.assign({},e),{authToken:{requestStatus:0}});await zh(t.appConfig,s)}throw n}}function uC(t){return t!==void 0&&t.registrationStatus===2}function FU(t){return t.requestStatus===2&&!UU(t)}function UU(t){const e=Date.now();return e<t.creationTime||t.creationTime+t.expiresIn<e+hU}function $U(t){const e={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},t),{authToken:e})}function VU(t){return t.requestStatus===1&&t.requestTime+Q0<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function BU(t){const e=t,{installationEntry:n,registrationPromise:s}=await G_(e);return s?s.catch(console.error):z_(e).catch(console.error),n.fid}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function qU(t,e=!1){const n=t;return await jU(n),(await z_(n,e)).token}async function jU(t){const{registrationPromise:e}=await G_(t);e&&await e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function KU(t){if(!t||!t.options)throw jp("App Configuration");if(!t.name)throw jp("App Name");const e=["projectId","apiKey","appId"];for(const n of e)if(!t.options[n])throw jp(n);return{appName:t.name,projectId:t.options.projectId,apiKey:t.options.apiKey,appId:t.options.appId}}function jp(t){return Xi.create("missing-app-config-values",{valueName:t})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hC="installations",HU="installations-internal",WU=t=>{const e=t.getProvider("app").getImmediate(),n=KU(e),s=So(e,"heartbeat");return{app:e,appConfig:n,heartbeatServiceProvider:s,_delete:()=>Promise.resolve()}},GU=t=>{const e=t.getProvider("app").getImmediate(),n=So(e,hC).getImmediate();return{getId:()=>BU(n),getToken:r=>qU(n,r)}};function zU(){rt(new Ee(hC,WU,"PUBLIC")),rt(new Ee(HU,GU,"PRIVATE"))}zU();Fe(z0,H_);Fe(z0,H_,"esm2017");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zb="analytics",QU="firebase_id",YU="origin",JU=60*1e3,XU="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",dC="https://www.googletagmanager.com/gtag/js";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jt=new js("@firebase/analytics");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fC(t){return Promise.all(t.map(e=>e.catch(n=>n)))}function ZU(t,e){const n=document.createElement("script");n.src=`${dC}?l=${t}&id=${e}`,n.async=!0,document.head.appendChild(n)}function e$(t){let e=[];return Array.isArray(window[t])?e=window[t]:window[t]=e,e}async function t$(t,e,n,s,r,i){const o=s[r];try{if(o)await e[o];else{const c=(await fC(n)).find(l=>l.measurementId===r);c&&await e[c.appId]}}catch(a){jt.error(a)}t("config",r,i)}async function n$(t,e,n,s,r){try{let i=[];if(r&&r.send_to){let o=r.send_to;Array.isArray(o)||(o=[o]);const a=await fC(n);for(const c of o){const l=a.find(h=>h.measurementId===c),u=l&&e[l.appId];if(u)i.push(u);else{i=[];break}}}i.length===0&&(i=Object.values(e)),await Promise.all(i),t("event",s,r||{})}catch(i){jt.error(i)}}function s$(t,e,n,s){async function r(i,o,a){try{i==="event"?await n$(t,e,n,o,a):i==="config"?await t$(t,e,n,s,o,a):i==="consent"?t("consent","update",a):t("set",o)}catch(c){jt.error(c)}}return r}function r$(t,e,n,s,r){let i=function(...o){window[s].push(arguments)};return window[r]&&typeof window[r]=="function"&&(i=window[r]),window[r]=s$(i,t,e,n),{gtagCore:i,wrappedGtag:window[r]}}function i$(){const t=window.document.getElementsByTagName("script");for(const e of Object.values(t))if(e.src&&e.src.includes(dC))return e;return null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const o$={["already-exists"]:"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.",["already-initialized"]:"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-intialized instance.",["already-initialized-settings"]:"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.",["interop-component-reg-failed"]:"Firebase Analytics Interop Component failed to instantiate: {$reason}",["invalid-analytics-context"]:"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}",["indexeddb-unavailable"]:"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}",["fetch-throttle"]:"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.",["config-fetch-failed"]:"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}",["no-api-key"]:'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',["no-app-id"]:'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.'},Wn=new pn("analytics","Analytics",o$);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const a$=30,c$=1e3;class l${constructor(e={},n=c$){this.throttleMetadata=e,this.intervalMillis=n}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,n){this.throttleMetadata[e]=n}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}}const pC=new l$;function u$(t){return new Headers({Accept:"application/json","x-goog-api-key":t})}async function h$(t){var e;const{appId:n,apiKey:s}=t,r={method:"GET",headers:u$(s)},i=XU.replace("{app-id}",n),o=await fetch(i,r);if(o.status!==200&&o.status!==304){let a="";try{const c=await o.json();!((e=c.error)===null||e===void 0)&&e.message&&(a=c.error.message)}catch{}throw Wn.create("config-fetch-failed",{httpStatus:o.status,responseMessage:a})}return o.json()}async function d$(t,e=pC,n){const{appId:s,apiKey:r,measurementId:i}=t.options;if(!s)throw Wn.create("no-app-id");if(!r){if(i)return{measurementId:i,appId:s};throw Wn.create("no-api-key")}const o=e.getThrottleMetadata(s)||{backoffCount:0,throttleEndTimeMillis:Date.now()},a=new g$;return setTimeout(async()=>{a.abort()},n!==void 0?n:JU),gC({appId:s,apiKey:r,measurementId:i},o,a,e)}async function gC(t,{throttleEndTimeMillis:e,backoffCount:n},s,r=pC){var i,o;const{appId:a,measurementId:c}=t;try{await f$(s,e)}catch(l){if(c)return jt.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${c} provided in the "measurementId" field in the local Firebase config. [${(i=l)===null||i===void 0?void 0:i.message}]`),{appId:a,measurementId:c};throw l}try{const l=await h$(t);return r.deleteThrottleMetadata(a),l}catch(l){const u=l;if(!p$(u)){if(r.deleteThrottleMetadata(a),c)return jt.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${c} provided in the "measurementId" field in the local Firebase config. [${u==null?void 0:u.message}]`),{appId:a,measurementId:c};throw l}const h=Number((o=u==null?void 0:u.customData)===null||o===void 0?void 0:o.httpStatus)===503?Wh(n,r.intervalMillis,a$):Wh(n,r.intervalMillis),d={throttleEndTimeMillis:Date.now()+h,backoffCount:n+1};return r.setThrottleMetadata(a,d),jt.debug(`Calling attemptFetch again in ${h} millis`),gC(t,d,s,r)}}function f$(t,e){return new Promise((n,s)=>{const r=Math.max(e-Date.now(),0),i=setTimeout(n,r);t.addEventListener(()=>{clearTimeout(i),s(Wn.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}function p$(t){if(!(t instanceof ut)||!t.customData)return!1;const e=Number(t.customData.httpStatus);return e===429||e===500||e===503||e===504}class g${constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach(e=>e())}}async function m$(t,e,n,s,r){if(r&&r.global){t("event",n,s);return}else{const i=await e,o=Object.assign(Object.assign({},s),{send_to:i});t("event",n,o)}}async function _$(t,e,n,s){if(s&&s.global)return t("set",{screen_name:n}),Promise.resolve();{const r=await e;t("config",r,{update:!0,screen_name:n})}}async function y$(t,e,n,s){if(s&&s.global)return t("set",{user_id:n}),Promise.resolve();{const r=await e;t("config",r,{update:!0,user_id:n})}}async function v$(t,e,n,s){if(s&&s.global){const r={};for(const i of Object.keys(n))r[`user_properties.${i}`]=n[i];return t("set",r),Promise.resolve()}else{const r=await e;t("config",r,{update:!0,user_properties:n})}}async function w$(t,e){const n=await t;window[`ga-disable-${n}`]=!e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function b$(){var t;if(In())try{await du()}catch(e){return jt.warn(Wn.create("indexeddb-unavailable",{errorInfo:(t=e)===null||t===void 0?void 0:t.toString()}).message),!1}else return jt.warn(Wn.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;return!0}async function I$(t,e,n,s,r,i,o){var a;const c=d$(t);c.then(f=>{n[f.measurementId]=f.appId,t.options.measurementId&&f.measurementId!==t.options.measurementId&&jt.warn(`The measurement ID in the local Firebase config (${t.options.measurementId}) does not match the measurement ID fetched from the server (${f.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(f=>jt.error(f)),e.push(c);const l=b$().then(f=>{if(f)return s.getId()}),[u,h]=await Promise.all([c,l]);i$()||ZU(i,u.measurementId),r("js",new Date);const d=(a=o==null?void 0:o.config)!==null&&a!==void 0?a:{};return d[YU]="firebase",d.update=!0,h!=null&&(d[QU]=h),r("config",u.measurementId,d),u.measurementId}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class E${constructor(e){this.app=e}_delete(){return delete nr[this.app.options.appId],Promise.resolve()}}let nr={},eI=[];const tI={};let Th="dataLayer",mC="gtag",nI,fu,sm=!1;function T$(t){if(sm)throw Wn.create("already-initialized");t.dataLayerName&&(Th=t.dataLayerName),t.gtagName&&(mC=t.gtagName)}function S$(){const t=[];if(uu()&&t.push("This is a browser extension environment."),af()||t.push("Cookies are not available."),t.length>0){const e=t.map((s,r)=>`(${r+1}) ${s}`).join(" "),n=Wn.create("invalid-analytics-context",{errorInfo:e});jt.warn(n.message)}}function C$(t,e,n){S$();const s=t.options.appId;if(!s)throw Wn.create("no-app-id");if(!t.options.apiKey)if(t.options.measurementId)jt.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${t.options.measurementId} provided in the "measurementId" field in the local Firebase config.`);else throw Wn.create("no-api-key");if(nr[s]!=null)throw Wn.create("already-exists",{id:s});if(!sm){e$(Th);const{wrappedGtag:i,gtagCore:o}=r$(nr,eI,tI,Th,mC);fu=i,nI=o,sm=!0}return nr[s]=I$(t,eI,tI,e,nI,Th,n),new E$(t)}async function A$(){if(uu()||!af()||!In())return!1;try{return await du()}catch{return!1}}function k$(t,e,n){t=N(t),_$(fu,nr[t.app.options.appId],e,n).catch(s=>jt.error(s))}function R$(t,e,n){t=N(t),y$(fu,nr[t.app.options.appId],e,n).catch(s=>jt.error(s))}function N$(t,e,n){t=N(t),v$(fu,nr[t.app.options.appId],e,n).catch(s=>jt.error(s))}function P$(t,e){t=N(t),w$(nr[t.app.options.appId],e).catch(n=>jt.error(n))}function _C(t,e,n,s){t=N(t),m$(fu,nr[t.app.options.appId],e,n,s).catch(r=>jt.error(r))}const sI="@firebase/analytics",rI="0.8.0";function D$(){rt(new Ee(Zb,(e,{options:n})=>{const s=e.getProvider("app").getImmediate(),r=e.getProvider("installations-internal").getImmediate();return C$(s,r,n)},"PUBLIC")),rt(new Ee("analytics-internal",t,"PRIVATE")),Fe(sI,rI),Fe(sI,rI,"esm2017");function t(e){try{const n=e.getProvider(Zb).getImmediate();return{logEvent:(s,r,i)=>_C(n,s,r,i)}}catch(n){throw Wn.create("interop-component-reg-failed",{reason:n})}}}D$();const x$="@firebase/analytics-compat",O$="0.1.13";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yC{constructor(e,n){this.app=e,this._delegate=n}logEvent(e,n,s){_C(this._delegate,e,n,s)}setCurrentScreen(e,n){k$(this._delegate,e,n)}setUserId(e,n){R$(this._delegate,e,n)}setUserProperties(e,n){N$(this._delegate,e,n)}setAnalyticsCollectionEnabled(e){P$(this._delegate,e)}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var rm;(function(t){t.ADD_SHIPPING_INFO="add_shipping_info",t.ADD_PAYMENT_INFO="add_payment_info",t.ADD_TO_CART="add_to_cart",t.ADD_TO_WISHLIST="add_to_wishlist",t.BEGIN_CHECKOUT="begin_checkout",t.CHECKOUT_PROGRESS="checkout_progress",t.EXCEPTION="exception",t.GENERATE_LEAD="generate_lead",t.LOGIN="login",t.PAGE_VIEW="page_view",t.PURCHASE="purchase",t.REFUND="refund",t.REMOVE_FROM_CART="remove_from_cart",t.SCREEN_VIEW="screen_view",t.SEARCH="search",t.SELECT_CONTENT="select_content",t.SELECT_ITEM="select_item",t.SELECT_PROMOTION="select_promotion",t.SET_CHECKOUT_OPTION="set_checkout_option",t.SHARE="share",t.SIGN_UP="sign_up",t.TIMING_COMPLETE="timing_complete",t.VIEW_CART="view_cart",t.VIEW_ITEM="view_item",t.VIEW_ITEM_LIST="view_item_list",t.VIEW_PROMOTION="view_promotion",t.VIEW_SEARCH_RESULTS="view_search_results"})(rm||(rm={}));/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const M$=t=>{const e=t.getProvider("app-compat").getImmediate(),n=t.getProvider("analytics").getImmediate();return new yC(e,n)};function L$(){const t={Analytics:yC,settings:T$,isSupported:A$,EventName:rm};ht.INTERNAL.registerComponent(new Ee("analytics-compat",M$,"PUBLIC").setServiceProps(t).setMultipleInstances(!0))}L$();ht.registerVersion(x$,O$);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vC=new Map,F$={activated:!1,tokenObservers:[]},U$={initialized:!1,enabled:!1};function Pt(t){return vC.get(t)||F$}function hs(t,e){vC.set(t,e)}function hf(){return U$}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Q_="https://content-firebaseappcheck.googleapis.com/v1",$$="exchangeRecaptchaV3Token",V$="exchangeRecaptchaEnterpriseToken",B$="exchangeDebugToken",iI={OFFSET_DURATION:5*60*1e3,RETRIAL_MIN_WAIT:30*1e3,RETRIAL_MAX_WAIT:16*60*1e3},q$=24*60*60*1e3;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j${constructor(e,n,s,r,i){if(this.operation=e,this.retryPolicy=n,this.getWaitDuration=s,this.lowerBound=r,this.upperBound=i,this.pending=null,this.nextErrorWaitInterval=r,r>i)throw new Error("Proactive refresh lower bound greater than upper bound!")}start(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch(()=>{})}stop(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)}isRunning(){return!!this.pending}async process(e){this.stop();try{this.pending=new mt,await K$(this.getNextRun(e)),this.pending.resolve(),await this.pending.promise,this.pending=new mt,await this.operation(),this.pending.resolve(),await this.pending.promise,this.process(!0).catch(()=>{})}catch(n){this.retryPolicy(n)?this.process(!1).catch(()=>{}):this.stop()}}getNextRun(e){if(e)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();{const n=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),n}}}function K$(t){return new Promise(e=>{setTimeout(e,t)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const H$={["already-initialized"]:"You have already called initializeAppCheck() for FirebaseApp {$appName} with different options. To avoid this error, call initializeAppCheck() with the same options as when it was originally called. This will return the already initialized instance.",["use-before-activation"]:"App Check is being used before initializeAppCheck() is called for FirebaseApp {$appName}. Call initializeAppCheck() before instantiating other Firebase services.",["fetch-network-error"]:"Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.",["fetch-parse-error"]:"Fetch client could not parse response. Original error: {$originalErrorMessage}.",["fetch-status-error"]:"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.",["storage-open"]:"Error thrown when opening storage. Original error: {$originalErrorMessage}.",["storage-get"]:"Error thrown when reading from storage. Original error: {$originalErrorMessage}.",["storage-set"]:"Error thrown when writing to storage. Original error: {$originalErrorMessage}.",["recaptcha-error"]:"ReCAPTCHA error.",throttled:"Requests throttled due to {$httpStatus} error. Attempts allowed again after {$time}"},ln=new pn("appCheck","AppCheck",H$);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qh(t=!1){var e;return t?(e=self.grecaptcha)===null||e===void 0?void 0:e.enterprise:self.grecaptcha}function wC(t){if(!Pt(t).activated)throw ln.create("use-before-activation",{appName:t.name})}function Y_(t){const e=Math.round(t/1e3),n=Math.floor(e/(3600*24)),s=Math.floor((e-n*3600*24)/3600),r=Math.floor((e-n*3600*24-s*3600)/60),i=e-n*3600*24-s*3600-r*60;let o="";return n&&(o+=eh(n)+"d:"),s&&(o+=eh(s)+"h:"),o+=eh(r)+"m:"+eh(i)+"s",o}function eh(t){return t===0?"00":t>=10?t.toString():"0"+t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function J_({url:t,body:e},n){var s,r;const i={"Content-Type":"application/json"},o=n.getImmediate({optional:!0});if(o){const f=await o.getHeartbeatsHeader();f&&(i["X-Firebase-Client"]=f)}const a={method:"POST",body:JSON.stringify(e),headers:i};let c;try{c=await fetch(t,a)}catch(f){throw ln.create("fetch-network-error",{originalErrorMessage:(s=f)===null||s===void 0?void 0:s.message})}if(c.status!==200)throw ln.create("fetch-status-error",{httpStatus:c.status});let l;try{l=await c.json()}catch(f){throw ln.create("fetch-parse-error",{originalErrorMessage:(r=f)===null||r===void 0?void 0:r.message})}const u=l.ttl.match(/^([\d.]+)(s)$/);if(!u||!u[2]||isNaN(Number(u[1])))throw ln.create("fetch-parse-error",{originalErrorMessage:`ttl field (timeToLive) is not in standard Protobuf Duration format: ${l.ttl}`});const h=Number(u[1])*1e3,d=Date.now();return{token:l.token,expireTimeMillis:d+h,issuedAtTimeMillis:d}}function W$(t,e){const{projectId:n,appId:s,apiKey:r}=t.options;return{url:`${Q_}/projects/${n}/apps/${s}:${$$}?key=${r}`,body:{recaptcha_v3_token:e}}}function G$(t,e){const{projectId:n,appId:s,apiKey:r}=t.options;return{url:`${Q_}/projects/${n}/apps/${s}:${V$}?key=${r}`,body:{recaptcha_enterprise_token:e}}}function z$(t,e){const{projectId:n,appId:s,apiKey:r}=t.options;return{url:`${Q_}/projects/${n}/apps/${s}:${B$}?key=${r}`,body:{debug_token:e}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Q$="firebase-app-check-database",Y$=1,El="firebase-app-check-store",bC="debug-token";let th=null;function IC(){return th||(th=new Promise((t,e)=>{var n;try{const s=indexedDB.open(Q$,Y$);s.onsuccess=r=>{t(r.target.result)},s.onerror=r=>{var i;e(ln.create("storage-open",{originalErrorMessage:(i=r.target.error)===null||i===void 0?void 0:i.message}))},s.onupgradeneeded=r=>{const i=r.target.result;switch(r.oldVersion){case 0:i.createObjectStore(El,{keyPath:"compositeKey"})}}}catch(s){e(ln.create("storage-open",{originalErrorMessage:(n=s)===null||n===void 0?void 0:n.message}))}}),th)}function J$(t){return TC(SC(t))}function X$(t,e){return EC(SC(t),e)}function Z$(t){return EC(bC,t)}function eV(){return TC(bC)}async function EC(t,e){const s=(await IC()).transaction(El,"readwrite"),i=s.objectStore(El).put({compositeKey:t,value:e});return new Promise((o,a)=>{i.onsuccess=c=>{o()},s.onerror=c=>{var l;a(ln.create("storage-set",{originalErrorMessage:(l=c.target.error)===null||l===void 0?void 0:l.message}))}})}async function TC(t){const n=(await IC()).transaction(El,"readonly"),r=n.objectStore(El).get(t);return new Promise((i,o)=>{r.onsuccess=a=>{const c=a.target.result;i(c?c.value:void 0)},n.onerror=a=>{var c;o(ln.create("storage-get",{originalErrorMessage:(c=a.target.error)===null||c===void 0?void 0:c.message}))}})}function SC(t){return`${t.options.appId}-${t.name}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Tl=new js("@firebase/app-check");/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function tV(t){if(In()){let e;try{e=await J$(t)}catch(n){Tl.warn(`Failed to read token from IndexedDB. Error: ${n}`)}return e}}function oI(t,e){return In()?X$(t,e).catch(n=>{Tl.warn(`Failed to write token to IndexedDB. Error: ${n}`)}):Promise.resolve()}async function nV(){let t;try{t=await eV()}catch{}if(t)return t;{const e=WL();return Z$(e).catch(n=>Tl.warn(`Failed to persist debug token to IndexedDB. Error: ${n}`)),e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function CC(){return hf().enabled}async function AC(){const t=hf();if(t.enabled&&t.token)return t.token.promise;throw Error(`
            Can't get debug token in production mode.
        `)}function sV(){const t=ML(),e=hf();if(e.initialized=!0,typeof t.FIREBASE_APPCHECK_DEBUG_TOKEN!="string"&&t.FIREBASE_APPCHECK_DEBUG_TOKEN!==!0)return;e.enabled=!0;const n=new mt;e.token=n,typeof t.FIREBASE_APPCHECK_DEBUG_TOKEN=="string"?n.resolve(t.FIREBASE_APPCHECK_DEBUG_TOKEN):n.resolve(nV())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rV={error:"UNKNOWN_ERROR"};function iV(t){return rf.encodeString(JSON.stringify(t),!1)}async function Yh(t,e=!1){const n=t.app;wC(n);const s=Pt(n);let r=s.token,i;if(!r){const c=await s.cachedTokenPromise;c&&Jh(c)&&(r=c)}if(!e&&r&&Jh(r))return{token:r.token};let o=!1;if(CC()){s.exchangeTokenPromise||(s.exchangeTokenPromise=J_(z$(n,await AC()),t.heartbeatServiceProvider).then(l=>(s.exchangeTokenPromise=void 0,l)),o=!0);const c=await s.exchangeTokenPromise;return await oI(n,c),hs(n,Object.assign(Object.assign({},s),{token:c})),{token:c.token}}try{s.exchangeTokenPromise||(s.exchangeTokenPromise=s.provider.getToken().then(c=>(s.exchangeTokenPromise=void 0,c)),o=!0),r=await s.exchangeTokenPromise}catch(c){c.code==="appCheck/throttled"?Tl.warn(c.message):Tl.error(c),i=c}let a;return r?(a={token:r.token},hs(n,Object.assign(Object.assign({},s),{token:r})),await oI(n,r)):a=aV(i),o&&kC(n,a),a}function X_(t,e,n,s){const{app:r}=t,i=Pt(r),o={next:n,error:s,type:e};if(hs(r,Object.assign(Object.assign({},i),{tokenObservers:[...i.tokenObservers,o]})),i.token&&Jh(i.token)){const a=i.token;Promise.resolve().then(()=>{n({token:a.token}),aI(t)}).catch(()=>{})}i.cachedTokenPromise.then(()=>aI(t))}function Z_(t,e){const n=Pt(t),s=n.tokenObservers.filter(r=>r.next!==e);s.length===0&&n.tokenRefresher&&n.tokenRefresher.isRunning()&&n.tokenRefresher.stop(),hs(t,Object.assign(Object.assign({},n),{tokenObservers:s}))}function aI(t){const{app:e}=t,n=Pt(e);let s=n.tokenRefresher;s||(s=oV(t),hs(e,Object.assign(Object.assign({},n),{tokenRefresher:s}))),!s.isRunning()&&n.isTokenAutoRefreshEnabled&&s.start()}function oV(t){const{app:e}=t;return new j$(async()=>{const n=Pt(e);let s;if(n.token?s=await Yh(t,!0):s=await Yh(t),s.error)throw s.error},()=>!0,()=>{const n=Pt(e);if(n.token){let s=n.token.issuedAtTimeMillis+(n.token.expireTimeMillis-n.token.issuedAtTimeMillis)*.5+3e5;const r=n.token.expireTimeMillis-5*60*1e3;return s=Math.min(s,r),Math.max(0,s-Date.now())}else return 0},iI.RETRIAL_MIN_WAIT,iI.RETRIAL_MAX_WAIT)}function kC(t,e){const n=Pt(t).tokenObservers;for(const s of n)try{s.type==="EXTERNAL"&&e.error!=null?s.error(e.error):s.next(e)}catch{}}function Jh(t){return t.expireTimeMillis-Date.now()>0}function aV(t){return{token:iV(rV),error:t}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cV{constructor(e,n){this.app=e,this.heartbeatServiceProvider=n}_delete(){const{tokenObservers:e}=Pt(this.app);for(const n of e)Z_(this.app,n.next);return Promise.resolve()}}function lV(t,e){return new cV(t,e)}function uV(t){return{getToken:e=>Yh(t,e),addTokenListener:e=>X_(t,"INTERNAL",e),removeTokenListener:e=>Z_(t.app,e)}}const hV="@firebase/app-check",dV="0.5.11";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fV="https://www.google.com/recaptcha/api.js",pV="https://www.google.com/recaptcha/enterprise.js";function gV(t,e){const n=Pt(t),s=new mt;hs(t,Object.assign(Object.assign({},n),{reCAPTCHAState:{initialized:s}}));const r=RC(t),i=Qh(!1);return i?Xh(t,e,i,r,s):yV(()=>{const o=Qh(!1);if(!o)throw new Error("no recaptcha");Xh(t,e,o,r,s)}),s.promise}function mV(t,e){const n=Pt(t),s=new mt;hs(t,Object.assign(Object.assign({},n),{reCAPTCHAState:{initialized:s}}));const r=RC(t),i=Qh(!0);return i?Xh(t,e,i,r,s):vV(()=>{const o=Qh(!0);if(!o)throw new Error("no recaptcha");Xh(t,e,o,r,s)}),s.promise}function Xh(t,e,n,s,r){n.ready(()=>{_V(t,e,n,s),r.resolve(n)})}function RC(t){const e=`fire_app_check_${t.name}`,n=document.createElement("div");return n.id=e,n.style.display="none",document.body.appendChild(n),e}async function NC(t){wC(t);const n=await Pt(t).reCAPTCHAState.initialized.promise;return new Promise((s,r)=>{const i=Pt(t).reCAPTCHAState;n.ready(()=>{s(n.execute(i.widgetId,{action:"fire_app_check"}))})})}function _V(t,e,n,s){const r=n.render(s,{sitekey:e,size:"invisible"}),i=Pt(t);hs(t,Object.assign(Object.assign({},i),{reCAPTCHAState:Object.assign(Object.assign({},i.reCAPTCHAState),{widgetId:r})}))}function yV(t){const e=document.createElement("script");e.src=fV,e.onload=t,document.head.appendChild(e)}function vV(t){const e=document.createElement("script");e.src=pV,e.onload=t,document.head.appendChild(e)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sl{constructor(e){this._siteKey=e,this._throttleData=null}async getToken(){var e;DC(this._throttleData);const n=await NC(this._app).catch(r=>{throw ln.create("recaptcha-error")});let s;try{s=await J_(W$(this._app,n),this._heartbeatServiceProvider)}catch(r){throw r.code==="fetch-status-error"?(this._throttleData=PC(Number((e=r.customData)===null||e===void 0?void 0:e.httpStatus),this._throttleData),ln.create("throttled",{time:Y_(this._throttleData.allowRequestsAfter-Date.now()),httpStatus:this._throttleData.httpStatus})):r}return this._throttleData=null,s}initialize(e){this._app=e,this._heartbeatServiceProvider=So(e,"heartbeat"),gV(e,this._siteKey).catch(()=>{})}isEqual(e){return e instanceof Sl?this._siteKey===e._siteKey:!1}}class df{constructor(e){this._siteKey=e,this._throttleData=null}async getToken(){var e;DC(this._throttleData);const n=await NC(this._app).catch(r=>{throw ln.create("recaptcha-error")});let s;try{s=await J_(G$(this._app,n),this._heartbeatServiceProvider)}catch(r){throw r.code==="fetch-status-error"?(this._throttleData=PC(Number((e=r.customData)===null||e===void 0?void 0:e.httpStatus),this._throttleData),ln.create("throttled",{time:Y_(this._throttleData.allowRequestsAfter-Date.now()),httpStatus:this._throttleData.httpStatus})):r}return this._throttleData=null,s}initialize(e){this._app=e,this._heartbeatServiceProvider=So(e,"heartbeat"),mV(e,this._siteKey).catch(()=>{})}isEqual(e){return e instanceof df?this._siteKey===e._siteKey:!1}}class Cl{constructor(e){this._customProviderOptions=e}async getToken(){const e=await this._customProviderOptions.getToken(),n=$L(e.token),s=n!==null&&n<Date.now()&&n>0?n*1e3:Date.now();return Object.assign(Object.assign({},e),{issuedAtTimeMillis:s})}initialize(e){this._app=e}isEqual(e){return e instanceof Cl?this._customProviderOptions.getToken.toString()===e._customProviderOptions.getToken.toString():!1}}function PC(t,e){if(t===404||t===403)return{backoffCount:1,allowRequestsAfter:Date.now()+q$,httpStatus:t};{const n=e?e.backoffCount:0,s=Wh(n,1e3,2);return{backoffCount:n+1,allowRequestsAfter:Date.now()+s,httpStatus:t}}}function DC(t){if(t&&Date.now()-t.allowRequestsAfter<=0)throw ln.create("throttled",{time:Y_(t.allowRequestsAfter-Date.now()),httpStatus:t.httpStatus})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wV(t=B0(),e){t=N(t);const n=So(t,"app-check");if(hf().initialized||sV(),CC()&&AC().then(r=>console.log(`App Check debug token: ${r}. You will need to add it to your app's App Check settings in the Firebase console for it to work.`)),n.isInitialized()){const r=n.getImmediate(),i=n.getOptions();if(i.isTokenAutoRefreshEnabled===e.isTokenAutoRefreshEnabled&&i.provider.isEqual(e.provider))return r;throw ln.create("already-initialized",{appName:t.name})}const s=n.initialize({options:e});return bV(t,e.provider,e.isTokenAutoRefreshEnabled),Pt(t).isTokenAutoRefreshEnabled&&X_(s,"INTERNAL",()=>{}),s}function bV(t,e,n){const s=Pt(t),r=Object.assign(Object.assign({},s),{activated:!0});r.provider=e,r.cachedTokenPromise=tV(t).then(i=>(i&&Jh(i)&&(hs(t,Object.assign(Object.assign({},Pt(t)),{token:i})),kC(t,{token:i.token})),i)),r.isTokenAutoRefreshEnabled=n===void 0?t.automaticDataCollectionEnabled:n,hs(t,r),r.provider.initialize(t)}function IV(t,e){const n=t.app,s=Pt(n);s.tokenRefresher&&(e===!0?s.tokenRefresher.start():s.tokenRefresher.stop()),hs(n,Object.assign(Object.assign({},s),{isTokenAutoRefreshEnabled:e}))}async function EV(t,e){const n=await Yh(t,e);if(n.error)throw n.error;return{token:n.token}}function TV(t,e,n,s){let r=()=>{},i=()=>{};return e.next!=null?r=e.next.bind(e):r=e,e.error!=null?i=e.error.bind(e):n&&(i=n),X_(t,"EXTERNAL",r,i),()=>Z_(t.app,r)}const SV="app-check",cI="app-check-internal";function CV(){rt(new Ee(SV,t=>{const e=t.getProvider("app").getImmediate(),n=t.getProvider("heartbeat");return lV(e,n)},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((t,e,n)=>{t.getProvider(cI).initialize()})),rt(new Ee(cI,t=>{const e=t.getProvider("app-check").getImmediate();return uV(e)},"PUBLIC").setInstantiationMode("EXPLICIT")),Fe(hV,dV)}CV();const AV="@firebase/app-check-compat",kV="0.2.11";/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RV={["use-before-activation"]:"App Check is being used before activate() is called for FirebaseApp {$appName}. Call activate() before instantiating other Firebase services."},Kp=new pn("appCheck","AppCheck",RV);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NV{constructor(e){this.app=e}activate(e,n){let s;typeof e=="string"?s=new Sl(e):e instanceof df||e instanceof Sl||e instanceof Cl?s=e:s=new Cl({getToken:e.getToken}),this._delegate=wV(this.app,{provider:s,isTokenAutoRefreshEnabled:n})}setTokenAutoRefreshEnabled(e){if(!this._delegate)throw Kp.create("use-before-activation",{appName:this.app.name});IV(this._delegate,e)}getToken(e){if(!this._delegate)throw Kp.create("use-before-activation",{appName:this.app.name});return EV(this._delegate,e)}onTokenChanged(e,n,s){if(!this._delegate)throw Kp.create("use-before-activation",{appName:this.app.name});return TV(this._delegate,e,n)}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PV=t=>{const e=t.getProvider("app-compat").getImmediate();return new NV(e)};function DV(){ht.INTERNAL.registerComponent(new Ee("appCheck-compat",PV,"PUBLIC").setServiceProps({ReCaptchaEnterpriseProvider:df,ReCaptchaV3Provider:Sl,CustomProvider:Cl}))}DV();ht.registerVersion(AV,kV);function ey(t,e){var n={};for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&e.indexOf(s)<0&&(n[s]=t[s]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,s=Object.getOwnPropertySymbols(t);r<s.length;r++)e.indexOf(s[r])<0&&Object.prototype.propertyIsEnumerable.call(t,s[r])&&(n[s[r]]=t[s[r]]);return n}const gc={FACEBOOK:"facebook.com",GITHUB:"github.com",GOOGLE:"google.com",PASSWORD:"password",PHONE:"phone",TWITTER:"twitter.com"},$o={EMAIL_SIGNIN:"EMAIL_SIGNIN",PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:"REVERT_SECOND_FACTOR_ADDITION",VERIFY_AND_CHANGE_EMAIL:"VERIFY_AND_CHANGE_EMAIL",VERIFY_EMAIL:"VERIFY_EMAIL"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xV(){return{["admin-restricted-operation"]:"This operation is restricted to administrators only.",["argument-error"]:"",["app-not-authorized"]:"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.",["app-not-installed"]:"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.",["captcha-check-failed"]:"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.",["code-expired"]:"The SMS code has expired. Please re-send the verification code to try again.",["cordova-not-ready"]:"Cordova framework is not ready.",["cors-unsupported"]:"This browser is not supported.",["credential-already-in-use"]:"This credential is already associated with a different user account.",["custom-token-mismatch"]:"The custom token corresponds to a different audience.",["requires-recent-login"]:"This operation is sensitive and requires recent authentication. Log in again before retrying this request.",["dependent-sdk-initialized-before-auth"]:"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK.",["dynamic-link-not-activated"]:"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.",["email-change-needs-verification"]:"Multi-factor users must always have a verified email.",["email-already-in-use"]:"The email address is already in use by another account.",["emulator-config-failed"]:'Auth instance has already been used to make a network call. Auth can no longer be configured to use the emulator. Try calling "connectAuthEmulator()" sooner.',["expired-action-code"]:"The action code has expired.",["cancelled-popup-request"]:"This operation has been cancelled due to another conflicting popup being opened.",["internal-error"]:"An internal AuthError has occurred.",["invalid-app-credential"]:"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.",["invalid-app-id"]:"The mobile app identifier is not registed for the current project.",["invalid-user-token"]:"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.",["invalid-auth-event"]:"An internal AuthError has occurred.",["invalid-verification-code"]:"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure to use the verification code provided by the user.",["invalid-continue-uri"]:"The continue URL provided in the request is invalid.",["invalid-cordova-configuration"]:"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.",["invalid-custom-token"]:"The custom token format is incorrect. Please check the documentation.",["invalid-dynamic-link-domain"]:"The provided dynamic link domain is not configured or authorized for the current project.",["invalid-email"]:"The email address is badly formatted.",["invalid-emulator-scheme"]:"Emulator URL must start with a valid scheme (http:// or https://).",["invalid-api-key"]:"Your API key is invalid, please check you have copied it correctly.",["invalid-cert-hash"]:"The SHA-1 certificate hash provided is invalid.",["invalid-credential"]:"The supplied auth credential is malformed or has expired.",["invalid-message-payload"]:"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.",["invalid-multi-factor-session"]:"The request does not contain a valid proof of first factor successful sign-in.",["invalid-oauth-provider"]:"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.",["invalid-oauth-client-id"]:"The OAuth client ID provided is either invalid or does not match the specified API key.",["unauthorized-domain"]:"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.",["invalid-action-code"]:"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.",["wrong-password"]:"The password is invalid or the user does not have a password.",["invalid-persistence-type"]:"The specified persistence type is invalid. It can only be local, session or none.",["invalid-phone-number"]:"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].",["invalid-provider-id"]:"The specified provider ID is invalid.",["invalid-recipient-email"]:"The email corresponding to this action failed to send as the provided recipient email address is invalid.",["invalid-sender"]:"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.",["invalid-verification-id"]:"The verification ID used to create the phone auth credential is invalid.",["invalid-tenant-id"]:"The Auth instance's tenant ID is invalid.",["login-blocked"]:"Login blocked by user-provided method: {$originalMessage}",["missing-android-pkg-name"]:"An Android Package Name must be provided if the Android App is required to be installed.",["auth-domain-config-required"]:"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.",["missing-app-credential"]:"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.",["missing-verification-code"]:"The phone auth credential was created with an empty SMS verification code.",["missing-continue-uri"]:"A continue URL must be provided in the request.",["missing-iframe-start"]:"An internal AuthError has occurred.",["missing-ios-bundle-id"]:"An iOS Bundle ID must be provided if an App Store ID is provided.",["missing-or-invalid-nonce"]:"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.",["missing-multi-factor-info"]:"No second factor identifier is provided.",["missing-multi-factor-session"]:"The request is missing proof of first factor successful sign-in.",["missing-phone-number"]:"To send verification codes, provide a phone number for the recipient.",["missing-verification-id"]:"The phone auth credential was created with an empty verification ID.",["app-deleted"]:"This instance of FirebaseApp has been deleted.",["multi-factor-info-not-found"]:"The user does not have a second factor matching the identifier provided.",["multi-factor-auth-required"]:"Proof of ownership of a second factor is required to complete sign-in.",["account-exists-with-different-credential"]:"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.",["network-request-failed"]:"A network AuthError (such as timeout, interrupted connection or unreachable host) has occurred.",["no-auth-event"]:"An internal AuthError has occurred.",["no-such-provider"]:"User was not linked to an account with the given provider.",["null-user"]:"A null user object was provided as the argument for an operation which requires a non-null user object.",["operation-not-allowed"]:"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.",["operation-not-supported-in-this-environment"]:'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',["popup-blocked"]:"Unable to establish a connection with the popup. It may have been blocked by the browser.",["popup-closed-by-user"]:"The popup has been closed by the user before finalizing the operation.",["provider-already-linked"]:"User can only be linked to one identity for the given provider.",["quota-exceeded"]:"The project's quota for this operation has been exceeded.",["redirect-cancelled-by-user"]:"The redirect operation has been cancelled by the user before finalizing.",["redirect-operation-pending"]:"A redirect sign-in operation is already pending.",["rejected-credential"]:"The request contains malformed or mismatching credentials.",["second-factor-already-in-use"]:"The second factor is already enrolled on this account.",["maximum-second-factor-count-exceeded"]:"The maximum allowed number of second factors on a user has been exceeded.",["tenant-id-mismatch"]:"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.",["user-token-expired"]:"The user's credential is no longer valid. The user must sign in again.",["too-many-requests"]:"We have blocked all requests from this device due to unusual activity. Try again later.",["unauthorized-continue-uri"]:"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.",["unsupported-first-factor"]:"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.",["unsupported-persistence-type"]:"The current environment does not support the specified persistence type.",["unsupported-tenant-operation"]:"This operation is not supported in a multi-tenant context.",["unverified-email"]:"The operation requires a verified email.",["user-cancelled"]:"The user did not grant your application the permissions it requested.",["user-not-found"]:"There is no user record corresponding to this identifier. The user may have been deleted.",["user-disabled"]:"The user account has been disabled by an administrator.",["user-mismatch"]:"The supplied credentials do not correspond to the previously signed in user.",["user-signed-out"]:"",["weak-password"]:"The password must be 6 characters long or more.",["web-storage-unsupported"]:"This browser is not supported or 3rd party cookies and data may be disabled.",["already-initialized"]:"initializeAuth() has already been called with different options. To avoid this error, call initializeAuth() with the same options as when it was originally called, or call getAuth() to return the already initialized instance."}}function xC(){return{["dependent-sdk-initialized-before-auth"]:"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const OV=xV,MV=xC,OC=new pn("auth","Firebase",xC());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lI=new js("@firebase/auth");function Sh(t,...e){lI.logLevel<=fe.ERROR&&lI.error(`Auth (${Ks}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zt(t,...e){throw ty(t,...e)}function Kt(t,...e){return ty(t,...e)}function MC(t,e,n){const s=Object.assign(Object.assign({},MV()),{[e]:n});return new pn("auth","Firebase",s).create(e,{appName:t.name})}function Ga(t,e,n){const s=n;if(!(e instanceof s))throw s.name!==e.constructor.name&&zt(t,"argument-error"),MC(t,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function ty(t,...e){if(typeof t!="string"){const n=e[0],s=[...e.slice(1)];return s[0]&&(s[0].appName=t.name),t._errorFactory.create(n,...s)}return OC.create(t,...e)}function x(t,e,...n){if(!t)throw ty(e,...n)}function Ss(t){const e="INTERNAL ASSERTION FAILED: "+t;throw Sh(e),new Error(e)}function ds(t,e){t||Ss(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uI=new Map;function Rn(t){ds(t instanceof Function,"Expected a class definition");let e=uI.get(t);return e?(ds(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,uI.set(t,e),e)}function LV(t,e){const n=(e==null?void 0:e.persistence)||[],s=(Array.isArray(n)?n:[n]).map(Rn);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(s,e==null?void 0:e.popupRedirectResolver)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Al(){var t;return typeof self!="undefined"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function ny(){return hI()==="http:"||hI()==="https:"}function hI(){var t;return typeof self!="undefined"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function FV(){return typeof navigator!="undefined"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(ny()||uu()||"connection"in navigator)?navigator.onLine:!0}function UV(){if(typeof navigator=="undefined")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pu{constructor(e,n){this.shortDelay=e,this.longDelay=n,ds(n>e,"Short delay should be less than long delay!"),this.isMobile=of()||hu()}get(){return FV()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sy(t,e){ds(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LC{static initialize(e,n,s){this.fetchImpl=e,n&&(this.headersImpl=n),s&&(this.responseImpl=s)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self!="undefined"&&"fetch"in self)return self.fetch;Ss("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self!="undefined"&&"Headers"in self)return self.Headers;Ss("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self!="undefined"&&"Response"in self)return self.Response;Ss("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $V={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"internal-error",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VV=new pu(3e4,6e4);function wt(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function Mt(t,e,n,s,r={}){return FC(t,r,async()=>{let i={},o={};s&&(e==="GET"?o=s:i={body:JSON.stringify(s)});const a=To(Object.assign({key:t.config.apiKey},o)).slice(1),c=await t._getAdditionalHeaders();return c["Content-Type"]="application/json",t.languageCode&&(c["X-Firebase-Locale"]=t.languageCode),LC.fetch()(UC(t,t.config.apiHost,n,a),Object.assign({method:e,headers:c,referrerPolicy:"no-referrer"},i))})}async function FC(t,e,n){t._canInitEmulator=!1;const s=Object.assign(Object.assign({},$V),e);try{const r=new BV(t),i=await Promise.race([n(),r.promise]);r.clearNetworkTimeout();const o=await i.json();if("needConfirmation"in o)throw Oc(t,"account-exists-with-different-credential",o);if(i.ok&&!("errorMessage"in o))return o;{const a=i.ok?o.errorMessage:o.error.message,[c,l]=a.split(" : ");if(c==="FEDERATED_USER_ID_ALREADY_LINKED")throw Oc(t,"credential-already-in-use",o);if(c==="EMAIL_EXISTS")throw Oc(t,"email-already-in-use",o);if(c==="USER_DISABLED")throw Oc(t,"user-disabled",o);const u=s[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(l)throw MC(t,u,l);zt(t,u)}}catch(r){if(r instanceof ut)throw r;zt(t,"network-request-failed")}}async function pr(t,e,n,s,r={}){const i=await Mt(t,e,n,s,r);return"mfaPendingCredential"in i&&zt(t,"multi-factor-auth-required",{_serverResponse:i}),i}function UC(t,e,n,s){const r=`${e}${n}?${s}`;return t.config.emulator?sy(t.config,r):`${t.config.apiScheme}://${r}`}class BV{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,s)=>{this.timer=setTimeout(()=>s(Kt(this.auth,"network-request-failed")),VV.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function Oc(t,e,n){const s={appName:t.name};n.email&&(s.email=n.email),n.phoneNumber&&(s.phoneNumber=n.phoneNumber);const r=Kt(t,e,s);return r.customData._tokenResponse=n,r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function qV(t,e){return Mt(t,"POST","/v1/accounts:delete",e)}async function jV(t,e){return Mt(t,"POST","/v1/accounts:update",e)}async function KV(t,e){return Mt(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wc(t){if(!!t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function HV(t,e=!1){const n=N(t),s=await n.getIdToken(e),r=ff(s);x(r&&r.exp&&r.auth_time&&r.iat,n.auth,"internal-error");const i=typeof r.firebase=="object"?r.firebase:void 0,o=i==null?void 0:i.sign_in_provider;return{claims:r,token:s,authTime:Wc(Hp(r.auth_time)),issuedAtTime:Wc(Hp(r.iat)),expirationTime:Wc(Hp(r.exp)),signInProvider:o||null,signInSecondFactor:(i==null?void 0:i.sign_in_second_factor)||null}}function Hp(t){return Number(t)*1e3}function ff(t){var e;const[n,s,r]=t.split(".");if(n===void 0||s===void 0||r===void 0)return Sh("JWT malformed, contained fewer than 3 sections"),null;try{const i=Jg(s);return i?JSON.parse(i):(Sh("Failed to decode base64 JWT payload"),null)}catch(i){return Sh("Caught error parsing JWT payload as JSON",(e=i)===null||e===void 0?void 0:e.toString()),null}}function WV(t){const e=ff(t);return x(e,"internal-error"),x(typeof e.exp!="undefined","internal-error"),x(typeof e.iat!="undefined","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function cr(t,e,n=!1){if(n)return e;try{return await e}catch(s){throw s instanceof ut&&GV(s)&&t.auth.currentUser===t&&await t.auth.signOut(),s}}function GV({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zV{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){!this.isRunning||(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var n;if(e){const s=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),s}else{this.errorBackoff=3e4;const r=((n=this.user.stsTokenManager.expirationTime)!==null&&n!==void 0?n:0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){var e;try{await this.user.getIdToken(!0)}catch(n){((e=n)===null||e===void 0?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $C{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=Wc(this.lastLoginAt),this.creationTime=Wc(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function kl(t){var e;const n=t.auth,s=await t.getIdToken(),r=await cr(t,KV(n,{idToken:s}));x(r==null?void 0:r.users.length,n,"internal-error");const i=r.users[0];t._notifyReloadListener(i);const o=!((e=i.providerUserInfo)===null||e===void 0)&&e.length?JV(i.providerUserInfo):[],a=YV(t.providerData,o),c=t.isAnonymous,l=!(t.email&&i.passwordHash)&&!(a!=null&&a.length),u=c?l:!1,h={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:a,metadata:new $C(i.createdAt,i.lastLoginAt),isAnonymous:u};Object.assign(t,h)}async function QV(t){const e=N(t);await kl(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function YV(t,e){return[...t.filter(s=>!e.some(r=>r.providerId===s.providerId)),...e]}function JV(t){return t.map(e=>{var{providerId:n}=e,s=ey(e,["providerId"]);return{providerId:n,uid:s.rawId||"",displayName:s.displayName||null,email:s.email||null,phoneNumber:s.phoneNumber||null,photoURL:s.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function XV(t,e){const n=await FC(t,{},async()=>{const s=To({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:r,apiKey:i}=t.config,o=UC(t,r,"/v1/token",`key=${i}`),a=await t._getAdditionalHeaders();return a["Content-Type"]="application/x-www-form-urlencoded",LC.fetch()(o,{method:"POST",headers:a,body:s})});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rl{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){x(e.idToken,"internal-error"),x(typeof e.idToken!="undefined","internal-error"),x(typeof e.refreshToken!="undefined","internal-error");const n="expiresIn"in e&&typeof e.expiresIn!="undefined"?Number(e.expiresIn):WV(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}async getToken(e,n=!1){return x(!this.accessToken||this.refreshToken,e,"user-token-expired"),!n&&this.accessToken&&!this.isExpired?this.accessToken:this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:s,refreshToken:r,expiresIn:i}=await XV(e,n);this.updateTokensAndExpiration(s,r,Number(i))}updateTokensAndExpiration(e,n,s){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+s*1e3}static fromJSON(e,n){const{refreshToken:s,accessToken:r,expirationTime:i}=n,o=new Rl;return s&&(x(typeof s=="string","internal-error",{appName:e}),o.refreshToken=s),r&&(x(typeof r=="string","internal-error",{appName:e}),o.accessToken=r),i&&(x(typeof i=="number","internal-error",{appName:e}),o.expirationTime=i),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Rl,this.toJSON())}_performRefresh(){return Ss("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sr(t,e){x(typeof t=="string"||typeof t=="undefined","internal-error",{appName:e})}class Hi{constructor(e){var{uid:n,auth:s,stsTokenManager:r}=e,i=ey(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new zV(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=n,this.auth=s,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new $C(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const n=await cr(this,this.stsTokenManager.getToken(this.auth,e));return x(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return HV(this,e)}reload(){return QV(this)}_assign(e){this!==e&&(x(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>Object.assign({},n)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){return new Hi(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}))}_onReload(e){x(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let s=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),s=!0),n&&await kl(this),await this.auth._persistUserIfCurrent(this),s&&this.auth._notifyListenersIfCurrent(this)}async delete(){const e=await this.getIdToken();return await cr(this,qV(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){var s,r,i,o,a,c,l,u;const h=(s=n.displayName)!==null&&s!==void 0?s:void 0,d=(r=n.email)!==null&&r!==void 0?r:void 0,f=(i=n.phoneNumber)!==null&&i!==void 0?i:void 0,p=(o=n.photoURL)!==null&&o!==void 0?o:void 0,_=(a=n.tenantId)!==null&&a!==void 0?a:void 0,y=(c=n._redirectEventId)!==null&&c!==void 0?c:void 0,T=(l=n.createdAt)!==null&&l!==void 0?l:void 0,I=(u=n.lastLoginAt)!==null&&u!==void 0?u:void 0,{uid:E,emailVerified:S,isAnonymous:$,providerData:H,stsTokenManager:K}=n;x(E&&K,e,"internal-error");const F=Rl.fromJSON(this.name,K);x(typeof E=="string",e,"internal-error"),Sr(h,e.name),Sr(d,e.name),x(typeof S=="boolean",e,"internal-error"),x(typeof $=="boolean",e,"internal-error"),Sr(f,e.name),Sr(p,e.name),Sr(_,e.name),Sr(y,e.name),Sr(T,e.name),Sr(I,e.name);const ne=new Hi({uid:E,auth:e,email:d,emailVerified:S,displayName:h,isAnonymous:$,photoURL:p,phoneNumber:f,tenantId:_,stsTokenManager:F,createdAt:T,lastLoginAt:I});return H&&Array.isArray(H)&&(ne.providerData=H.map(he=>Object.assign({},he))),y&&(ne._redirectEventId=y),ne}static async _fromIdTokenResponse(e,n,s=!1){const r=new Rl;r.updateFromServerResponse(n);const i=new Hi({uid:n.localId,auth:e,stsTokenManager:r,isAnonymous:s});return await kl(i),i}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VC{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}VC.type="NONE";const Ia=VC;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wi(t,e,n){return`firebase:${t}:${e}:${n}`}class ra{constructor(e,n,s){this.persistence=e,this.auth=n,this.userKey=s;const{config:r,name:i}=this.auth;this.fullUserKey=Wi(this.userKey,r.apiKey,i),this.fullPersistenceKey=Wi("persistence",r.apiKey,i),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?Hi._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,s="authUser"){if(!n.length)return new ra(Rn(Ia),e,s);const r=(await Promise.all(n.map(async l=>{if(await l._isAvailable())return l}))).filter(l=>l);let i=r[0]||Rn(Ia);const o=Wi(s,e.config.apiKey,e.name);let a=null;for(const l of n)try{const u=await l._get(o);if(u){const h=Hi._fromJSON(e,u);l!==i&&(a=h),i=l;break}}catch{}const c=r.filter(l=>l._shouldAllowMigration);return!i._shouldAllowMigration||!c.length?new ra(i,e,s):(i=c[0],a&&await i._set(o,a.toJSON()),await Promise.all(n.map(async l=>{if(l!==i)try{await l._remove(o)}catch{}})),new ra(i,e,s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dI(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(jC(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(BC(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(KC(e))return"Blackberry";if(HC(e))return"Webos";if(ry(e))return"Safari";if((e.includes("chrome/")||qC(e))&&!e.includes("edge/"))return"Chrome";if(gu(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,s=t.match(n);if((s==null?void 0:s.length)===2)return s[1]}return"Other"}function BC(t=We()){return/firefox\//i.test(t)}function ry(t=We()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function qC(t=We()){return/crios\//i.test(t)}function jC(t=We()){return/iemobile/i.test(t)}function gu(t=We()){return/android/i.test(t)}function KC(t=We()){return/blackberry/i.test(t)}function HC(t=We()){return/webos/i.test(t)}function za(t=We()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function ZV(t=We()){return/(iPad|iPhone|iPod).*OS 7_\d/i.test(t)||/(iPad|iPhone|iPod).*OS 8_\d/i.test(t)}function eB(t=We()){var e;return za(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function tB(){return V_()&&document.documentMode===10}function WC(t=We()){return za(t)||gu(t)||HC(t)||KC(t)||/windows phone/i.test(t)||jC(t)}function nB(){try{return!!(window&&window!==window.top)}catch{return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GC(t,e=[]){let n;switch(t){case"Browser":n=dI(We());break;case"Worker":n=`${dI(We())}-${t}`;break;default:n=t}const s=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${Ks}/${s}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sB{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const s=i=>new Promise((o,a)=>{try{const c=e(i);o(c)}catch(c){a(c)}});s.onAbort=n,this.queue.push(s);const r=this.queue.length-1;return()=>{this.queue[r]=()=>Promise.resolve()}}async runMiddleware(e){var n;if(this.auth.currentUser===e)return;const s=[];try{for(const r of this.queue)await r(e),r.onAbort&&s.push(r.onAbort)}catch(r){s.reverse();for(const i of s)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:(n=r)===null||n===void 0?void 0:n.message})}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rB{constructor(e,n,s){this.app=e,this.heartbeatServiceProvider=n,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new fI(this),this.idTokenSubscription=new fI(this),this.beforeStateQueue=new sB(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=OC,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=Rn(n)),this._initializationPromise=this.queue(async()=>{var s,r;if(!this._deleted&&(this.persistenceManager=await ra.create(this,e),!this._deleted)){if(!((s=this._popupRedirectResolver)===null||s===void 0)&&s._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((r=this.currentUser)===null||r===void 0?void 0:r.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUser(e){var n;const s=await this.assertedPersistence.getCurrentUser();let r=s,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId,a=r==null?void 0:r._redirectEventId,c=await this.tryRedirectSignIn(e);(!o||o===a)&&(c==null?void 0:c.user)&&(r=c.user,i=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(r)}catch(o){r=s,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return x(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){var n;try{await kl(e)}catch(s){if(((n=s)===null||n===void 0?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=UV()}async _delete(){this._deleted=!0}async updateCurrentUser(e){const n=e?N(e):null;return n&&x(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&x(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0)}setPersistence(e){return this.queue(async()=>{await this.assertedPersistence.setPersistence(Rn(e))})}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new pn("auth","Firebase",e())}onAuthStateChanged(e,n,s){return this.registerStateListener(this.authStateSubscription,e,n,s)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,s){return this.registerStateListener(this.idTokenSubscription,e,n,s)}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,n){const s=await this.getOrInitRedirectPersistenceManager(n);return e===null?s.removeCurrentUser():s.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&Rn(e)||this._popupRedirectResolver;x(n,this,"argument-error"),this.redirectPersistenceManager=await ra.create(this,[Rn(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,s;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)===null||n===void 0?void 0:n._redirectEventId)===e?this._currentUser:((s=this.redirectUser)===null||s===void 0?void 0:s._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const s=(n=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&n!==void 0?n:null;this.lastNotifiedUid!==s&&(this.lastNotifiedUid=s,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,s,r){if(this._deleted)return()=>{};const i=typeof n=="function"?n:n.next.bind(n),o=this._isInitialized?Promise.resolve():this._initializationPromise;return x(o,this,"internal-error"),o.then(()=>i(this.currentUser)),typeof n=="function"?e.addObserver(n,s,r):e.addObserver(n)}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&(this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh()),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return x(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=GC(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const n={["X-Client-Version"]:this.clientVersion};this.app.options.appId&&(n["X-Firebase-gmpid"]=this.app.options.appId);const s=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());return s&&(n["X-Firebase-Client"]=s),n}}function Dt(t){return N(t)}class fI{constructor(e){this.auth=e,this.observer=null,this.addObserver=x0(n=>this.observer=n)}get next(){return x(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}function iB(t,e,n){const s=Dt(t);x(s._canInitEmulator,s,"emulator-config-failed"),x(/^https?:\/\//.test(e),s,"invalid-emulator-scheme");const r=!!(n!=null&&n.disableWarnings),i=zC(e),{host:o,port:a}=oB(e),c=a===null?"":`:${a}`;s.config.emulator={url:`${i}//${o}${c}/`},s.settings.appVerificationDisabledForTesting=!0,s.emulatorConfig=Object.freeze({host:o,port:a,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:r})}),r||aB()}function zC(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function oB(t){const e=zC(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const s=n[2].split("@").pop()||"",r=/^(\[[^\]]+\])(:|$)/.exec(s);if(r){const i=r[1];return{host:i,port:pI(s.substr(i.length+1))}}else{const[i,o]=s.split(":");return{host:i,port:pI(o)}}}function pI(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function aB(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console!="undefined"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window!="undefined"&&typeof document!="undefined"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qa{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return Ss("not implemented")}_getIdTokenResponse(e){return Ss("not implemented")}_linkToIdToken(e,n){return Ss("not implemented")}_getReauthenticationResolver(e){return Ss("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function QC(t,e){return Mt(t,"POST","/v1/accounts:resetPassword",wt(t,e))}async function YC(t,e){return Mt(t,"POST","/v1/accounts:update",e)}async function cB(t,e){return Mt(t,"POST","/v1/accounts:update",wt(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function lB(t,e){return pr(t,"POST","/v1/accounts:signInWithPassword",wt(t,e))}async function pf(t,e){return Mt(t,"POST","/v1/accounts:sendOobCode",wt(t,e))}async function uB(t,e){return pf(t,e)}async function hB(t,e){return pf(t,e)}async function dB(t,e){return pf(t,e)}async function fB(t,e){return pf(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function pB(t,e){return pr(t,"POST","/v1/accounts:signInWithEmailLink",wt(t,e))}async function gB(t,e){return pr(t,"POST","/v1/accounts:signInWithEmailLink",wt(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nl extends Qa{constructor(e,n,s,r=null){super("password",s),this._email=e,this._password=n,this._tenantId=r}static _fromEmailAndPassword(e,n){return new Nl(e,n,"password")}static _fromEmailAndCode(e,n,s=null){return new Nl(e,n,"emailLink",s)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;if((n==null?void 0:n.email)&&(n==null?void 0:n.password)){if(n.signInMethod==="password")return this._fromEmailAndPassword(n.email,n.password);if(n.signInMethod==="emailLink")return this._fromEmailAndCode(n.email,n.password,n.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":return lB(e,{returnSecureToken:!0,email:this._email,password:this._password});case"emailLink":return pB(e,{email:this._email,oobCode:this._password});default:zt(e,"internal-error")}}async _linkToIdToken(e,n){switch(this.signInMethod){case"password":return YC(e,{idToken:n,returnSecureToken:!0,email:this._email,password:this._password});case"emailLink":return gB(e,{idToken:n,email:this._email,oobCode:this._password});default:zt(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function sr(t,e){return pr(t,"POST","/v1/accounts:signInWithIdp",wt(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mB="http://localhost";class Ms extends Qa{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new Ms(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):zt("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:s,signInMethod:r}=n,i=ey(n,["providerId","signInMethod"]);if(!s||!r)return null;const o=new Ms(s,r);return o.idToken=i.idToken||void 0,o.accessToken=i.accessToken||void 0,o.secret=i.secret,o.nonce=i.nonce,o.pendingToken=i.pendingToken||null,o}_getIdTokenResponse(e){const n=this.buildRequest();return sr(e,n)}_linkToIdToken(e,n){const s=this.buildRequest();return s.idToken=n,sr(e,s)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,sr(e,n)}buildRequest(){const e={requestUri:mB,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=To(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _B(t,e){return Mt(t,"POST","/v1/accounts:sendVerificationCode",wt(t,e))}async function yB(t,e){return pr(t,"POST","/v1/accounts:signInWithPhoneNumber",wt(t,e))}async function vB(t,e){const n=await pr(t,"POST","/v1/accounts:signInWithPhoneNumber",wt(t,e));if(n.temporaryProof)throw Oc(t,"account-exists-with-different-credential",n);return n}const wB={USER_NOT_FOUND:"user-not-found"};async function bB(t,e){const n=Object.assign(Object.assign({},e),{operation:"REAUTH"});return pr(t,"POST","/v1/accounts:signInWithPhoneNumber",wt(t,n),wB)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gi extends Qa{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,n){return new Gi({verificationId:e,verificationCode:n})}static _fromTokenResponse(e,n){return new Gi({phoneNumber:e,temporaryProof:n})}_getIdTokenResponse(e){return yB(e,this._makeVerificationRequest())}_linkToIdToken(e,n){return vB(e,Object.assign({idToken:n},this._makeVerificationRequest()))}_getReauthenticationResolver(e){return bB(e,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:e,phoneNumber:n,verificationId:s,verificationCode:r}=this.params;return e&&n?{temporaryProof:e,phoneNumber:n}:{sessionInfo:s,code:r}}toJSON(){const e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){typeof e=="string"&&(e=JSON.parse(e));const{verificationId:n,verificationCode:s,phoneNumber:r,temporaryProof:i}=e;return!s&&!n&&!r&&!i?null:new Gi({verificationId:n,verificationCode:s,phoneNumber:r,temporaryProof:i})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function IB(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function EB(t){const e=Yo(xc(t)).link,n=e?Yo(xc(e)).deep_link_id:null,s=Yo(xc(t)).deep_link_id;return(s?Yo(xc(s)).link:null)||s||n||e||t}class gf{constructor(e){var n,s,r,i,o,a;const c=Yo(xc(e)),l=(n=c.apiKey)!==null&&n!==void 0?n:null,u=(s=c.oobCode)!==null&&s!==void 0?s:null,h=IB((r=c.mode)!==null&&r!==void 0?r:null);x(l&&u&&h,"argument-error"),this.apiKey=l,this.operation=h,this.code=u,this.continueUrl=(i=c.continueUrl)!==null&&i!==void 0?i:null,this.languageCode=(o=c.languageCode)!==null&&o!==void 0?o:null,this.tenantId=(a=c.tenantId)!==null&&a!==void 0?a:null}static parseLink(e){const n=EB(e);try{return new gf(n)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ci{constructor(){this.providerId=ci.PROVIDER_ID}static credential(e,n){return Nl._fromEmailAndPassword(e,n)}static credentialWithLink(e,n){const s=gf.parseLink(n);return x(s,"argument-error"),Nl._fromEmailAndCode(e,s.code,s.tenantId)}}ci.PROVIDER_ID="password";ci.EMAIL_PASSWORD_SIGN_IN_METHOD="password";ci.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gr{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ya extends gr{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class ia extends Ya{static credentialFromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;return x("providerId"in n&&"signInMethod"in n,"argument-error"),Ms._fromParams(n)}credential(e){return this._credential(Object.assign(Object.assign({},e),{nonce:e.rawNonce}))}_credential(e){return x(e.idToken||e.accessToken,"argument-error"),Ms._fromParams(Object.assign(Object.assign({},e),{providerId:this.providerId,signInMethod:this.providerId}))}static credentialFromResult(e){return ia.oauthCredentialFromTaggedObject(e)}static credentialFromError(e){return ia.oauthCredentialFromTaggedObject(e.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:s,oauthTokenSecret:r,pendingToken:i,nonce:o,providerId:a}=e;if(!s&&!r&&!n&&!i||!a)return null;try{return new ia(a)._credential({idToken:n,accessToken:s,nonce:o,pendingToken:i})}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vs extends Ya{constructor(){super("facebook.com")}static credential(e){return Ms._fromParams({providerId:vs.PROVIDER_ID,signInMethod:vs.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return vs.credentialFromTaggedObject(e)}static credentialFromError(e){return vs.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return vs.credential(e.oauthAccessToken)}catch{return null}}}vs.FACEBOOK_SIGN_IN_METHOD="facebook.com";vs.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ws extends Ya{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return Ms._fromParams({providerId:ws.PROVIDER_ID,signInMethod:ws.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return ws.credentialFromTaggedObject(e)}static credentialFromError(e){return ws.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:s}=e;if(!n&&!s)return null;try{return ws.credential(n,s)}catch{return null}}}ws.GOOGLE_SIGN_IN_METHOD="google.com";ws.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bs extends Ya{constructor(){super("github.com")}static credential(e){return Ms._fromParams({providerId:bs.PROVIDER_ID,signInMethod:bs.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return bs.credentialFromTaggedObject(e)}static credentialFromError(e){return bs.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return bs.credential(e.oauthAccessToken)}catch{return null}}}bs.GITHUB_SIGN_IN_METHOD="github.com";bs.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TB="http://localhost";class Ea extends Qa{constructor(e,n){super(e,e),this.pendingToken=n}_getIdTokenResponse(e){const n=this.buildRequest();return sr(e,n)}_linkToIdToken(e,n){const s=this.buildRequest();return s.idToken=n,sr(e,s)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,sr(e,n)}toJSON(){return{signInMethod:this.signInMethod,providerId:this.providerId,pendingToken:this.pendingToken}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:s,signInMethod:r,pendingToken:i}=n;return!s||!r||!i||s!==r?null:new Ea(s,i)}static _create(e,n){return new Ea(e,n)}buildRequest(){return{requestUri:TB,returnSecureToken:!0,pendingToken:this.pendingToken}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SB="saml.";class Zh extends gr{constructor(e){x(e.startsWith(SB),"argument-error"),super(e)}static credentialFromResult(e){return Zh.samlCredentialFromTaggedObject(e)}static credentialFromError(e){return Zh.samlCredentialFromTaggedObject(e.customData||{})}static credentialFromJSON(e){const n=Ea.fromJSON(e);return x(n,"argument-error"),n}static samlCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{pendingToken:n,providerId:s}=e;if(!n||!s)return null;try{return Ea._create(s,n)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Is extends Ya{constructor(){super("twitter.com")}static credential(e,n){return Ms._fromParams({providerId:Is.PROVIDER_ID,signInMethod:Is.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return Is.credentialFromTaggedObject(e)}static credentialFromError(e){return Is.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:s}=e;if(!n||!s)return null;try{return Is.credential(n,s)}catch{return null}}}Is.TWITTER_SIGN_IN_METHOD="twitter.com";Is.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function JC(t,e){return pr(t,"POST","/v1/accounts:signUp",wt(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gn{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,s,r=!1){const i=await Hi._fromIdTokenResponse(e,s,r),o=gI(s);return new Gn({user:i,providerId:o,_tokenResponse:s,operationType:n})}static async _forOperation(e,n,s){await e._updateTokensIfNecessary(s,!0);const r=gI(s);return new Gn({user:e,providerId:r,_tokenResponse:s,operationType:n})}}function gI(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function CB(t){var e;const n=Dt(t);if(await n._initializationPromise,!((e=n.currentUser)===null||e===void 0)&&e.isAnonymous)return new Gn({user:n.currentUser,providerId:null,operationType:"signIn"});const s=await JC(n,{returnSecureToken:!0}),r=await Gn._fromIdTokenResponse(n,"signIn",s,!0);return await n._updateCurrentUser(r.user),r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ed extends ut{constructor(e,n,s,r){var i;super(n.code,n.message),this.operationType=s,this.user=r,Object.setPrototypeOf(this,ed.prototype),this.customData={appName:e.name,tenantId:(i=e.tenantId)!==null&&i!==void 0?i:void 0,_serverResponse:n.customData._serverResponse,operationType:s}}static _fromErrorAndOperation(e,n,s,r){return new ed(e,n,s,r)}}function XC(t,e,n,s){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?ed._fromErrorAndOperation(t,i,e,s):i})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ZC(t){return new Set(t.map(({providerId:e})=>e).filter(e=>!!e))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function AB(t,e){const n=N(t);await mf(!0,n,e);const{providerUserInfo:s}=await jV(n.auth,{idToken:await n.getIdToken(),deleteProvider:[e]}),r=ZC(s||[]);return n.providerData=n.providerData.filter(i=>r.has(i.providerId)),r.has("phone")||(n.phoneNumber=null),await n.auth._persistUserIfCurrent(n),n}async function iy(t,e,n=!1){const s=await cr(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return Gn._forOperation(t,"link",s)}async function mf(t,e,n){await kl(e);const s=ZC(e.providerData),r=t===!1?"provider-already-linked":"no-such-provider";x(s.has(n)===t,e.auth,r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function eA(t,e,n=!1){var s;const{auth:r}=t,i="reauthenticate";try{const o=await cr(t,XC(r,i,e,t),n);x(o.idToken,r,"internal-error");const a=ff(o.idToken);x(a,r,"internal-error");const{sub:c}=a;return x(t.uid===c,r,"user-mismatch"),Gn._forOperation(t,i,o)}catch(o){throw((s=o)===null||s===void 0?void 0:s.code)==="auth/user-not-found"&&zt(r,"user-mismatch"),o}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function tA(t,e,n=!1){const s="signIn",r=await XC(t,s,e),i=await Gn._fromIdTokenResponse(t,s,r);return n||await t._updateCurrentUser(i.user),i}async function _f(t,e){return tA(Dt(t),e)}async function nA(t,e){const n=N(t);return await mf(!1,n,e.providerId),iy(n,e)}async function sA(t,e){return eA(N(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function kB(t,e){return pr(t,"POST","/v1/accounts:signInWithCustomToken",wt(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function RB(t,e){const n=Dt(t),s=await kB(n,{token:e,returnSecureToken:!0}),r=await Gn._fromIdTokenResponse(n,"signIn",s);return await n._updateCurrentUser(r.user),r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yf{constructor(e,n){this.factorId=e,this.uid=n.mfaEnrollmentId,this.enrollmentTime=new Date(n.enrolledAt).toUTCString(),this.displayName=n.displayName}static _fromServerResponse(e,n){return"phoneInfo"in n?oy._fromServerResponse(e,n):zt(e,"internal-error")}}class oy extends yf{constructor(e){super("phone",e),this.phoneNumber=e.phoneInfo}static _fromServerResponse(e,n){return new oy(n)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vf(t,e,n){var s;x(((s=n.url)===null||s===void 0?void 0:s.length)>0,t,"invalid-continue-uri"),x(typeof n.dynamicLinkDomain=="undefined"||n.dynamicLinkDomain.length>0,t,"invalid-dynamic-link-domain"),e.continueUrl=n.url,e.dynamicLinkDomain=n.dynamicLinkDomain,e.canHandleCodeInApp=n.handleCodeInApp,n.iOS&&(x(n.iOS.bundleId.length>0,t,"missing-ios-bundle-id"),e.iOSBundleId=n.iOS.bundleId),n.android&&(x(n.android.packageName.length>0,t,"missing-android-pkg-name"),e.androidInstallApp=n.android.installApp,e.androidMinimumVersionCode=n.android.minimumVersion,e.androidPackageName=n.android.packageName)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function NB(t,e,n){const s=N(t),r={requestType:"PASSWORD_RESET",email:e};n&&vf(s,r,n),await hB(s,r)}async function PB(t,e,n){await QC(N(t),{oobCode:e,newPassword:n})}async function DB(t,e){await cB(N(t),{oobCode:e})}async function rA(t,e){const n=N(t),s=await QC(n,{oobCode:e}),r=s.requestType;switch(x(r,n,"internal-error"),r){case"EMAIL_SIGNIN":break;case"VERIFY_AND_CHANGE_EMAIL":x(s.newEmail,n,"internal-error");break;case"REVERT_SECOND_FACTOR_ADDITION":x(s.mfaInfo,n,"internal-error");default:x(s.email,n,"internal-error")}let i=null;return s.mfaInfo&&(i=yf._fromServerResponse(Dt(n),s.mfaInfo)),{data:{email:(s.requestType==="VERIFY_AND_CHANGE_EMAIL"?s.newEmail:s.email)||null,previousEmail:(s.requestType==="VERIFY_AND_CHANGE_EMAIL"?s.email:s.newEmail)||null,multiFactorInfo:i},operation:r}}async function xB(t,e){const{data:n}=await rA(N(t),e);return n.email}async function OB(t,e,n){const s=Dt(t),r=await JC(s,{returnSecureToken:!0,email:e,password:n}),i=await Gn._fromIdTokenResponse(s,"signIn",r);return await s._updateCurrentUser(i.user),i}function MB(t,e,n){return _f(N(t),ci.credential(e,n))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function LB(t,e,n){const s=N(t),r={requestType:"EMAIL_SIGNIN",email:e};x(n.handleCodeInApp,s,"argument-error"),n&&vf(s,r,n),await dB(s,r)}function FB(t,e){const n=gf.parseLink(e);return(n==null?void 0:n.operation)==="EMAIL_SIGNIN"}async function UB(t,e,n){const s=N(t),r=ci.credentialWithLink(e,n||Al());return x(r._tenantId===(s.tenantId||null),s,"tenant-id-mismatch"),_f(s,r)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function $B(t,e){return Mt(t,"POST","/v1/accounts:createAuthUri",wt(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function VB(t,e){const n=ny()?Al():"http://localhost",s={identifier:e,continueUri:n},{signinMethods:r}=await $B(N(t),s);return r||[]}async function BB(t,e){const n=N(t),s=await t.getIdToken(),r={requestType:"VERIFY_EMAIL",idToken:s};e&&vf(n.auth,r,e);const{email:i}=await uB(n.auth,r);i!==t.email&&await t.reload()}async function qB(t,e,n){const s=N(t),r=await t.getIdToken(),i={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:r,newEmail:e};n&&vf(s.auth,i,n);const{email:o}=await fB(s.auth,i);o!==t.email&&await t.reload()}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function jB(t,e){return Mt(t,"POST","/v1/accounts:update",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function KB(t,{displayName:e,photoURL:n}){if(e===void 0&&n===void 0)return;const s=N(t),i={idToken:await s.getIdToken(),displayName:e,photoUrl:n,returnSecureToken:!0},o=await cr(s,jB(s.auth,i));s.displayName=o.displayName||null,s.photoURL=o.photoUrl||null;const a=s.providerData.find(({providerId:c})=>c==="password");a&&(a.displayName=s.displayName,a.photoURL=s.photoURL),await s._updateTokensIfNecessary(o)}function HB(t,e){return iA(N(t),e,null)}function WB(t,e){return iA(N(t),null,e)}async function iA(t,e,n){const{auth:s}=t,i={idToken:await t.getIdToken(),returnSecureToken:!0};e&&(i.email=e),n&&(i.password=n);const o=await cr(t,YC(s,i));await t._updateTokensIfNecessary(o,!0)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GB(t){var e,n;if(!t)return null;const{providerId:s}=t,r=t.rawUserInfo?JSON.parse(t.rawUserInfo):{},i=t.isNewUser||t.kind==="identitytoolkit#SignupNewUserResponse";if(!s&&(t==null?void 0:t.idToken)){const o=(n=(e=ff(t.idToken))===null||e===void 0?void 0:e.firebase)===null||n===void 0?void 0:n.sign_in_provider;if(o){const a=o!=="anonymous"&&o!=="custom"?o:null;return new oa(i,a)}}if(!s)return null;switch(s){case"facebook.com":return new zB(i,r);case"github.com":return new QB(i,r);case"google.com":return new YB(i,r);case"twitter.com":return new JB(i,r,t.screenName||null);case"custom":case"anonymous":return new oa(i,null);default:return new oa(i,s,r)}}class oa{constructor(e,n,s={}){this.isNewUser=e,this.providerId=n,this.profile=s}}class oA extends oa{constructor(e,n,s,r){super(e,n,s),this.username=r}}class zB extends oa{constructor(e,n){super(e,"facebook.com",n)}}class QB extends oA{constructor(e,n){super(e,"github.com",n,typeof(n==null?void 0:n.login)=="string"?n==null?void 0:n.login:null)}}class YB extends oa{constructor(e,n){super(e,"google.com",n)}}class JB extends oA{constructor(e,n,s){super(e,"twitter.com",n,s)}}function XB(t){const{user:e,_tokenResponse:n}=t;return e.isAnonymous&&!n?{providerId:null,isNewUser:!1,profile:null}:GB(n)}class Fi{constructor(e,n){this.type=e,this.credential=n}static _fromIdtoken(e){return new Fi("enroll",e)}static _fromMfaPendingCredential(e){return new Fi("signin",e)}toJSON(){return{multiFactorSession:{[this.type==="enroll"?"idToken":"pendingCredential"]:this.credential}}}static fromJSON(e){var n,s;if(e!=null&&e.multiFactorSession){if(!((n=e.multiFactorSession)===null||n===void 0)&&n.pendingCredential)return Fi._fromMfaPendingCredential(e.multiFactorSession.pendingCredential);if(!((s=e.multiFactorSession)===null||s===void 0)&&s.idToken)return Fi._fromIdtoken(e.multiFactorSession.idToken)}return null}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ay{constructor(e,n,s){this.session=e,this.hints=n,this.signInResolver=s}static _fromError(e,n){const s=Dt(e),r=n.customData._serverResponse,i=(r.mfaInfo||[]).map(a=>yf._fromServerResponse(s,a));x(r.mfaPendingCredential,s,"internal-error");const o=Fi._fromMfaPendingCredential(r.mfaPendingCredential);return new ay(o,i,async a=>{const c=await a._process(s,o);delete r.mfaInfo,delete r.mfaPendingCredential;const l=Object.assign(Object.assign({},r),{idToken:c.idToken,refreshToken:c.refreshToken});switch(n.operationType){case"signIn":const u=await Gn._fromIdTokenResponse(s,n.operationType,l);return await s._updateCurrentUser(u.user),u;case"reauthenticate":return x(n.user,s,"internal-error"),Gn._forOperation(n.user,n.operationType,l);default:zt(s,"internal-error")}})}async resolveSignIn(e){const n=e;return this.signInResolver(n)}}function ZB(t,e){var n;const s=N(t),r=e;return x(e.customData.operationType,s,"argument-error"),x((n=r.customData._serverResponse)===null||n===void 0?void 0:n.mfaPendingCredential,s,"argument-error"),ay._fromError(s,r)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eq(t,e){return Mt(t,"POST","/v2/accounts/mfaEnrollment:start",wt(t,e))}function tq(t,e){return Mt(t,"POST","/v2/accounts/mfaEnrollment:finalize",wt(t,e))}function nq(t,e){return Mt(t,"POST","/v2/accounts/mfaEnrollment:withdraw",wt(t,e))}class cy{constructor(e){this.user=e,this.enrolledFactors=[],e._onReload(n=>{n.mfaInfo&&(this.enrolledFactors=n.mfaInfo.map(s=>yf._fromServerResponse(e.auth,s)))})}static _fromUser(e){return new cy(e)}async getSession(){return Fi._fromIdtoken(await this.user.getIdToken())}async enroll(e,n){const s=e,r=await this.getSession(),i=await cr(this.user,s._process(this.user.auth,r,n));return await this.user._updateTokensIfNecessary(i),this.user.reload()}async unenroll(e){var n;const s=typeof e=="string"?e:e.uid,r=await this.user.getIdToken(),i=await cr(this.user,nq(this.user.auth,{idToken:r,mfaEnrollmentId:s}));this.enrolledFactors=this.enrolledFactors.filter(({uid:o})=>o!==s),await this.user._updateTokensIfNecessary(i);try{await this.user.reload()}catch(o){if(((n=o)===null||n===void 0?void 0:n.code)!=="auth/user-token-expired")throw o}}}const Wp=new WeakMap;function sq(t){const e=N(t);return Wp.has(e)||Wp.set(e,cy._fromUser(e)),Wp.get(e)}const td="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aA{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(td,"1"),this.storage.removeItem(td),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rq(){const t=We();return ry(t)||za(t)}const iq=1e3,oq=10;class cA extends aA{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=rq()&&nB(),this.fallbackToPolling=WC(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const s=this.storage.getItem(n),r=this.localCache[n];s!==r&&e(n,r,s)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((o,a,c)=>{this.notifyListeners(o,c)});return}const s=e.key;if(n?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const o=this.storage.getItem(s);if(e.newValue!==o)e.newValue!==null?this.storage.setItem(s,e.newValue):this.storage.removeItem(s);else if(this.localCache[s]===e.newValue&&!n)return}const r=()=>{const o=this.storage.getItem(s);!n&&this.localCache[s]===o||this.notifyListeners(s,o)},i=this.storage.getItem(s);tB()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(r,oq):r()}notifyListeners(e,n){this.localCache[e]=n;const s=this.listeners[e];if(s)for(const r of Array.from(s))r(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,s)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:s}),!0)})},iq)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}cA.type="LOCAL";const ly=cA;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lA extends aA{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}lA.type="SESSION";const eo=lA;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aq(t){return Promise.all(t.map(async e=>{try{const n=await e;return{fulfilled:!0,value:n}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wf{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(r=>r.isListeningto(e));if(n)return n;const s=new wf(e);return this.receivers.push(s),s}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:s,eventType:r,data:i}=n.data,o=this.handlersMap[r];if(!(o!=null&&o.size))return;n.ports[0].postMessage({status:"ack",eventId:s,eventType:r});const a=Array.from(o).map(async l=>l(n.origin,i)),c=await aq(a);n.ports[0].postMessage({status:"done",eventId:s,eventType:r,response:c})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}wf.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mu(t="",e=10){let n="";for(let s=0;s<e;s++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cq{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,s=50){const r=typeof MessageChannel!="undefined"?new MessageChannel:null;if(!r)throw new Error("connection_unavailable");let i,o;return new Promise((a,c)=>{const l=mu("",20);r.port1.start();const u=setTimeout(()=>{c(new Error("unsupported_event"))},s);o={messageChannel:r,onMessage(h){const d=h;if(d.data.eventId===l)switch(d.data.status){case"ack":clearTimeout(u),i=setTimeout(()=>{c(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),a(d.data.response);break;default:clearTimeout(u),clearTimeout(i),c(new Error("invalid_response"));break}}},this.handlers.add(o),r.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:l,data:n},[r.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gt(){return window}function lq(t){gt().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uy(){return typeof gt().WorkerGlobalScope!="undefined"&&typeof gt().importScripts=="function"}async function uq(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function hq(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function dq(){return uy()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uA="firebaseLocalStorageDb",fq=1,nd="firebaseLocalStorage",hA="fbase_key";class _u{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function bf(t,e){return t.transaction([nd],e?"readwrite":"readonly").objectStore(nd)}function pq(){const t=indexedDB.deleteDatabase(uA);return new _u(t).toPromise()}function im(){const t=indexedDB.open(uA,fq);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const s=t.result;try{s.createObjectStore(nd,{keyPath:hA})}catch(r){n(r)}}),t.addEventListener("success",async()=>{const s=t.result;s.objectStoreNames.contains(nd)?e(s):(s.close(),await pq(),e(await im()))})})}async function mI(t,e,n){const s=bf(t,!0).put({[hA]:e,value:n});return new _u(s).toPromise()}async function gq(t,e){const n=bf(t,!1).get(e),s=await new _u(n).toPromise();return s===void 0?null:s.value}function _I(t,e){const n=bf(t,!0).delete(e);return new _u(n).toPromise()}const mq=800,_q=3;class dA{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await im(),this.db)}async _withRetries(e){let n=0;for(;;)try{const s=await this._openDb();return await e(s)}catch(s){if(n++>_q)throw s;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return uy()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=wf._getInstance(dq()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var e,n;if(this.activeServiceWorker=await uq(),!this.activeServiceWorker)return;this.sender=new cq(this.activeServiceWorker);const s=await this.sender._send("ping",{},800);!s||((e=s[0])===null||e===void 0?void 0:e.fulfilled)&&((n=s[0])===null||n===void 0?void 0:n.value.includes("keyChanged"))&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||hq()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await im();return await mI(e,td,"1"),await _I(e,td),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(s=>mI(s,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(s=>gq(s,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>_I(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(r=>{const i=bf(r,!1).getAll();return new _u(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],s=new Set;for(const{fbase_key:r,value:i}of e)s.add(r),JSON.stringify(this.localCache[r])!==JSON.stringify(i)&&(this.notifyListeners(r,i),n.push(r));for(const r of Object.keys(this.localCache))this.localCache[r]&&!s.has(r)&&(this.notifyListeners(r,null),n.push(r));return n}notifyListeners(e,n){this.localCache[e]=n;const s=this.listeners[e];if(s)for(const r of Array.from(s))r(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),mq)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}dA.type="LOCAL";const Pl=dA;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yq(t,e){return Mt(t,"POST","/v2/accounts/mfaSignIn:start",wt(t,e))}function vq(t,e){return Mt(t,"POST","/v2/accounts/mfaSignIn:finalize",wt(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function wq(t){return(await Mt(t,"GET","/v1/recaptchaParams")).recaptchaSiteKey||""}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bq(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}function fA(t){return new Promise((e,n)=>{const s=document.createElement("script");s.setAttribute("src",t),s.onload=e,s.onerror=r=>{const i=Kt("internal-error");i.customData=r,n(i)},s.type="text/javascript",s.charset="UTF-8",bq().appendChild(s)})}function pA(t){return`__${t}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Iq=500,Eq=6e4,nh=1e12;class Tq{constructor(e){this.auth=e,this.counter=nh,this._widgets=new Map}render(e,n){const s=this.counter;return this._widgets.set(s,new Sq(e,this.auth.name,n||{})),this.counter++,s}reset(e){var n;const s=e||nh;(n=this._widgets.get(s))===null||n===void 0||n.delete(),this._widgets.delete(s)}getResponse(e){var n;const s=e||nh;return((n=this._widgets.get(s))===null||n===void 0?void 0:n.getResponse())||""}async execute(e){var n;const s=e||nh;return(n=this._widgets.get(s))===null||n===void 0||n.execute(),""}}class Sq{constructor(e,n,s){this.params=s,this.timerId=null,this.deleted=!1,this.responseToken=null,this.clickHandler=()=>{this.execute()};const r=typeof e=="string"?document.getElementById(e):e;x(r,"argument-error",{appName:n}),this.container=r,this.isVisible=this.params.size!=="invisible",this.isVisible?this.execute():this.container.addEventListener("click",this.clickHandler)}getResponse(){return this.checkIfDeleted(),this.responseToken}delete(){this.checkIfDeleted(),this.deleted=!0,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.container.removeEventListener("click",this.clickHandler)}execute(){this.checkIfDeleted(),!this.timerId&&(this.timerId=window.setTimeout(()=>{this.responseToken=Cq(50);const{callback:e,"expired-callback":n}=this.params;if(e)try{e(this.responseToken)}catch{}this.timerId=window.setTimeout(()=>{if(this.timerId=null,this.responseToken=null,n)try{n()}catch{}this.isVisible&&this.execute()},Eq)},Iq))}checkIfDeleted(){if(this.deleted)throw new Error("reCAPTCHA mock was already deleted!")}}function Cq(t){const e=[],n="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let s=0;s<t;s++)e.push(n.charAt(Math.floor(Math.random()*n.length)));return e.join("")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gp=pA("rcb"),Aq=new pu(3e4,6e4),kq="https://www.google.com/recaptcha/api.js?";class Rq{constructor(){var e;this.hostLanguage="",this.counter=0,this.librarySeparatelyLoaded=!!(!((e=gt().grecaptcha)===null||e===void 0)&&e.render)}load(e,n=""){return x(Nq(n),e,"argument-error"),this.shouldResolveImmediately(n)?Promise.resolve(gt().grecaptcha):new Promise((s,r)=>{const i=gt().setTimeout(()=>{r(Kt(e,"network-request-failed"))},Aq.get());gt()[Gp]=()=>{gt().clearTimeout(i),delete gt()[Gp];const a=gt().grecaptcha;if(!a){r(Kt(e,"internal-error"));return}const c=a.render;a.render=(l,u)=>{const h=c(l,u);return this.counter++,h},this.hostLanguage=n,s(a)};const o=`${kq}?${To({onload:Gp,render:"explicit",hl:n})}`;fA(o).catch(()=>{clearTimeout(i),r(Kt(e,"internal-error"))})})}clearedOneInstance(){this.counter--}shouldResolveImmediately(e){var n;return!!(!((n=gt().grecaptcha)===null||n===void 0)&&n.render)&&(e===this.hostLanguage||this.counter>0||this.librarySeparatelyLoaded)}}function Nq(t){return t.length<=6&&/^\s*[a-zA-Z0-9\-]*\s*$/.test(t)}class Pq{async load(e){return new Tq(e)}clearedOneInstance(){}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gA="recaptcha",Dq={theme:"light",type:"image"};class xq{constructor(e,n=Object.assign({},Dq),s){this.parameters=n,this.type=gA,this.destroyed=!1,this.widgetId=null,this.tokenChangeListeners=new Set,this.renderPromise=null,this.recaptcha=null,this.auth=Dt(s),this.isInvisible=this.parameters.size==="invisible",x(typeof document!="undefined",this.auth,"operation-not-supported-in-this-environment");const r=typeof e=="string"?document.getElementById(e):e;x(r,this.auth,"argument-error"),this.container=r,this.parameters.callback=this.makeTokenCallback(this.parameters.callback),this._recaptchaLoader=this.auth.settings.appVerificationDisabledForTesting?new Pq:new Rq,this.validateStartingState()}async verify(){this.assertNotDestroyed();const e=await this.render(),n=this.getAssertedRecaptcha(),s=n.getResponse(e);return s||new Promise(r=>{const i=o=>{!o||(this.tokenChangeListeners.delete(i),r(o))};this.tokenChangeListeners.add(i),this.isInvisible&&n.execute(e)})}render(){try{this.assertNotDestroyed()}catch(e){return Promise.reject(e)}return this.renderPromise?this.renderPromise:(this.renderPromise=this.makeRenderPromise().catch(e=>{throw this.renderPromise=null,e}),this.renderPromise)}_reset(){this.assertNotDestroyed(),this.widgetId!==null&&this.getAssertedRecaptcha().reset(this.widgetId)}clear(){this.assertNotDestroyed(),this.destroyed=!0,this._recaptchaLoader.clearedOneInstance(),this.isInvisible||this.container.childNodes.forEach(e=>{this.container.removeChild(e)})}validateStartingState(){x(!this.parameters.sitekey,this.auth,"argument-error"),x(this.isInvisible||!this.container.hasChildNodes(),this.auth,"argument-error"),x(typeof document!="undefined",this.auth,"operation-not-supported-in-this-environment")}makeTokenCallback(e){return n=>{if(this.tokenChangeListeners.forEach(s=>s(n)),typeof e=="function")e(n);else if(typeof e=="string"){const s=gt()[e];typeof s=="function"&&s(n)}}}assertNotDestroyed(){x(!this.destroyed,this.auth,"internal-error")}async makeRenderPromise(){if(await this.init(),!this.widgetId){let e=this.container;if(!this.isInvisible){const n=document.createElement("div");e.appendChild(n),e=n}this.widgetId=this.getAssertedRecaptcha().render(e,this.parameters)}return this.widgetId}async init(){x(ny()&&!uy(),this.auth,"internal-error"),await Oq(),this.recaptcha=await this._recaptchaLoader.load(this.auth,this.auth.languageCode||void 0);const e=await wq(this.auth);x(e,this.auth,"internal-error"),this.parameters.sitekey=e}getAssertedRecaptcha(){return x(this.recaptcha,this.auth,"internal-error"),this.recaptcha}}function Oq(){let t=null;return new Promise(e=>{if(document.readyState==="complete"){e();return}t=()=>e(),window.addEventListener("load",t)}).catch(e=>{throw t&&window.removeEventListener("load",t),e})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hy{constructor(e,n){this.verificationId=e,this.onConfirmation=n}confirm(e){const n=Gi._fromVerification(this.verificationId,e);return this.onConfirmation(n)}}async function Mq(t,e,n){const s=Dt(t),r=await If(s,e,N(n));return new hy(r,i=>_f(s,i))}async function Lq(t,e,n){const s=N(t);await mf(!1,s,"phone");const r=await If(s.auth,e,N(n));return new hy(r,i=>nA(s,i))}async function Fq(t,e,n){const s=N(t),r=await If(s.auth,e,N(n));return new hy(r,i=>sA(s,i))}async function If(t,e,n){var s;const r=await n.verify();try{x(typeof r=="string",t,"argument-error"),x(n.type===gA,t,"argument-error");let i;if(typeof e=="string"?i={phoneNumber:e}:i=e,"session"in i){const o=i.session;if("phoneNumber"in i)return x(o.type==="enroll",t,"internal-error"),(await eq(t,{idToken:o.credential,phoneEnrollmentInfo:{phoneNumber:i.phoneNumber,recaptchaToken:r}})).phoneSessionInfo.sessionInfo;{x(o.type==="signin",t,"internal-error");const a=((s=i.multiFactorHint)===null||s===void 0?void 0:s.uid)||i.multiFactorUid;return x(a,t,"missing-multi-factor-info"),(await yq(t,{mfaPendingCredential:o.credential,mfaEnrollmentId:a,phoneSignInInfo:{recaptchaToken:r}})).phoneResponseInfo.sessionInfo}}else{const{sessionInfo:o}=await _B(t,{phoneNumber:i.phoneNumber,recaptchaToken:r});return o}}finally{n._reset()}}async function Uq(t,e){await iy(N(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ls{constructor(e){this.providerId=ls.PROVIDER_ID,this.auth=Dt(e)}verifyPhoneNumber(e,n){return If(this.auth,e,N(n))}static credential(e,n){return Gi._fromVerification(e,n)}static credentialFromResult(e){const n=e;return ls.credentialFromTaggedObject(n)}static credentialFromError(e){return ls.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{phoneNumber:n,temporaryProof:s}=e;return n&&s?Gi._fromTokenResponse(n,s):null}}ls.PROVIDER_ID="phone";ls.PHONE_SIGN_IN_METHOD="phone";/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Co(t,e){return e?Rn(e):(x(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dy extends Qa{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return sr(e,this._buildIdpRequest())}_linkToIdToken(e,n){return sr(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return sr(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function $q(t){return tA(t.auth,new dy(t),t.bypassAuthState)}function Vq(t){const{auth:e,user:n}=t;return x(n,e,"internal-error"),eA(n,new dy(t),t.bypassAuthState)}async function Bq(t){const{auth:e,user:n}=t;return x(n,e,"internal-error"),iy(n,new dy(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mA{constructor(e,n,s,r,i=!1){this.auth=e,this.resolver=s,this.user=r,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(s){this.reject(s)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:s,postBody:r,tenantId:i,error:o,type:a}=e;if(o){this.reject(o);return}const c={auth:this.auth,requestUri:n,sessionId:s,tenantId:i||void 0,postBody:r||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(c))}catch(l){this.reject(l)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return $q;case"linkViaPopup":case"linkViaRedirect":return Bq;case"reauthViaPopup":case"reauthViaRedirect":return Vq;default:zt(this.auth,"internal-error")}}resolve(e){ds(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){ds(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qq=new pu(2e3,1e4);async function jq(t,e,n){const s=Dt(t);Ga(t,e,gr);const r=Co(s,n);return new Js(s,"signInViaPopup",e,r).executeNotNull()}async function Kq(t,e,n){const s=N(t);Ga(s.auth,e,gr);const r=Co(s.auth,n);return new Js(s.auth,"reauthViaPopup",e,r,s).executeNotNull()}async function Hq(t,e,n){const s=N(t);Ga(s.auth,e,gr);const r=Co(s.auth,n);return new Js(s.auth,"linkViaPopup",e,r,s).executeNotNull()}class Js extends mA{constructor(e,n,s,r,i){super(e,n,r,i),this.provider=s,this.authWindow=null,this.pollId=null,Js.currentPopupAction&&Js.currentPopupAction.cancel(),Js.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return x(e,this.auth,"internal-error"),e}async onExecution(){ds(this.filter.length===1,"Popup operations only handle one event");const e=mu();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(Kt(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(Kt(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Js.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,s;if(!((s=(n=this.authWindow)===null||n===void 0?void 0:n.window)===null||s===void 0)&&s.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Kt(this.auth,"popup-closed-by-user"))},2e3);return}this.pollId=window.setTimeout(e,qq.get())};e()}}Js.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wq="pendingRedirect",Gc=new Map;class Gq extends mA{constructor(e,n,s=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,s),this.eventId=null}async execute(){let e=Gc.get(this.auth._key());if(!e){try{const s=await zq(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(s)}catch(n){e=()=>Promise.reject(n)}Gc.set(this.auth._key(),e)}return this.bypassAuthState||Gc.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function zq(t,e){const n=yA(e),s=_A(t);if(!await s._isAvailable())return!1;const r=await s._get(n)==="true";return await s._remove(n),r}async function fy(t,e){return _A(t)._set(yA(e),"true")}function Qq(){Gc.clear()}function py(t,e){Gc.set(t._key(),e)}function _A(t){return Rn(t._redirectPersistence)}function yA(t){return Wi(Wq,t.config.apiKey,t.name)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yq(t,e,n){return Jq(t,e,n)}async function Jq(t,e,n){const s=Dt(t);Ga(t,e,gr);const r=Co(s,n);return await fy(r,s),r._openRedirect(s,e,"signInViaRedirect")}function Xq(t,e,n){return Zq(t,e,n)}async function Zq(t,e,n){const s=N(t);Ga(s.auth,e,gr);const r=Co(s.auth,n);await fy(r,s.auth);const i=await vA(s);return r._openRedirect(s.auth,e,"reauthViaRedirect",i)}function ej(t,e,n){return tj(t,e,n)}async function tj(t,e,n){const s=N(t);Ga(s.auth,e,gr);const r=Co(s.auth,n);await mf(!1,s,e.providerId),await fy(r,s.auth);const i=await vA(s);return r._openRedirect(s.auth,e,"linkViaRedirect",i)}async function nj(t,e){return await Dt(t)._initializationPromise,Ef(t,e,!1)}async function Ef(t,e,n=!1){const s=Dt(t),r=Co(s,e),o=await new Gq(s,r,n).execute();return o&&!n&&(delete o.user._redirectEventId,await s._persistUserIfCurrent(o.user),await s._setRedirectUser(null,e)),o}async function vA(t){const e=mu(`${t.uid}:::`);return t._redirectEventId=e,await t.auth._setRedirectUser(t),await t.auth._persistUserIfCurrent(t),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sj=10*60*1e3;class wA{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(s=>{this.isEventForConsumer(e,s)&&(n=!0,this.sendToConsumer(e,s),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!rj(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var s;if(e.error&&!bA(e)){const r=((s=e.error.code)===null||s===void 0?void 0:s.split("auth/")[1])||"internal-error";n.onError(Kt(this.auth,r))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const s=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&s}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=sj&&this.cachedEventUids.clear(),this.cachedEventUids.has(yI(e))}saveEventToCache(e){this.cachedEventUids.add(yI(e)),this.lastProcessedEventTime=Date.now()}}function yI(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function bA({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function rj(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return bA(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function IA(t,e={}){return Mt(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ij=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,oj=/^https?/;async function aj(t){if(t.config.emulator)return;const{authorizedDomains:e}=await IA(t);for(const n of e)try{if(cj(n))return}catch{}zt(t,"unauthorized-domain")}function cj(t){const e=Al(),{protocol:n,hostname:s}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&s===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&o.hostname===s}if(!oj.test(n))return!1;if(ij.test(t))return s===t;const r=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+r+"|"+r+")$","i").test(s)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lj=new pu(3e4,6e4);function vI(){const t=gt().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function uj(t){return new Promise((e,n)=>{var s,r,i;function o(){vI(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{vI(),n(Kt(t,"network-request-failed"))},timeout:lj.get()})}if(!((r=(s=gt().gapi)===null||s===void 0?void 0:s.iframes)===null||r===void 0)&&r.Iframe)e(gapi.iframes.getContext());else if(!((i=gt().gapi)===null||i===void 0)&&i.load)o();else{const a=pA("iframefcb");return gt()[a]=()=>{gapi.load?o():n(Kt(t,"network-request-failed"))},fA(`https://apis.google.com/js/api.js?onload=${a}`).catch(c=>n(c))}}).catch(e=>{throw Ch=null,e})}let Ch=null;function hj(t){return Ch=Ch||uj(t),Ch}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dj=new pu(5e3,15e3),fj="__/auth/iframe",pj="emulator/auth/iframe",gj={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},mj=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function _j(t){const e=t.config;x(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?sy(e,pj):`https://${t.config.authDomain}/${fj}`,s={apiKey:e.apiKey,appName:t.name,v:Ks},r=mj.get(t.config.apiHost);r&&(s.eid=r);const i=t._getFrameworks();return i.length&&(s.fw=i.join(",")),`${n}?${To(s).slice(1)}`}async function yj(t){const e=await hj(t),n=gt().gapi;return x(n,t,"internal-error"),e.open({where:document.body,url:_j(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:gj,dontclear:!0},s=>new Promise(async(r,i)=>{await s.restyle({setHideOnLeave:!1});const o=Kt(t,"network-request-failed"),a=gt().setTimeout(()=>{i(o)},dj.get());function c(){gt().clearTimeout(a),r(s)}s.ping(c).then(c,()=>{i(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vj={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},wj=500,bj=600,Ij="_blank",Ej="http://localhost";class wI{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function Tj(t,e,n,s=wj,r=bj){const i=Math.max((window.screen.availHeight-r)/2,0).toString(),o=Math.max((window.screen.availWidth-s)/2,0).toString();let a="";const c=Object.assign(Object.assign({},vj),{width:s.toString(),height:r.toString(),top:i,left:o}),l=We().toLowerCase();n&&(a=qC(l)?Ij:n),BC(l)&&(e=e||Ej,c.scrollbars="yes");const u=Object.entries(c).reduce((d,[f,p])=>`${d}${f}=${p},`,"");if(eB(l)&&a!=="_self")return Sj(e||"",a),new wI(null);const h=window.open(e||"",a,u);x(h,t,"popup-blocked");try{h.focus()}catch{}return new wI(h)}function Sj(t,e){const n=document.createElement("a");n.href=t,n.target=e;const s=document.createEvent("MouseEvent");s.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(s)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cj="__/auth/handler",Aj="emulator/auth/handler";function om(t,e,n,s,r,i){x(t.config.authDomain,t,"auth-domain-config-required"),x(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:s,v:Ks,eventId:r};if(e instanceof gr){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",Kh(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[c,l]of Object.entries(i||{}))o[c]=l}if(e instanceof Ya){const c=e.getScopes().filter(l=>l!=="");c.length>0&&(o.scopes=c.join(","))}t.tenantId&&(o.tid=t.tenantId);const a=o;for(const c of Object.keys(a))a[c]===void 0&&delete a[c];return`${kj(t)}?${To(a).slice(1)}`}function kj({config:t}){return t.emulator?sy(t,Aj):`https://${t.authDomain}/${Cj}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zp="webStorageSupport";class Rj{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=eo,this._completeRedirectFn=Ef,this._overrideRedirectResult=py}async _openPopup(e,n,s,r){var i;ds((i=this.eventManagers[e._key()])===null||i===void 0?void 0:i.manager,"_initialize() not called before _openPopup()");const o=om(e,n,s,Al(),r);return Tj(e,o,mu())}async _openRedirect(e,n,s,r){return await this._originValidation(e),lq(om(e,n,s,Al(),r)),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:r,promise:i}=this.eventManagers[n];return r?Promise.resolve(r):(ds(i,"If manager is not set, promise should be"),i)}const s=this.initAndGetManager(e);return this.eventManagers[n]={promise:s},s.catch(()=>{delete this.eventManagers[n]}),s}async initAndGetManager(e){const n=await yj(e),s=new wA(e);return n.register("authEvent",r=>(x(r==null?void 0:r.authEvent,e,"invalid-auth-event"),{status:s.onEvent(r.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:s},this.iframes[e._key()]=n,s}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(zp,{type:zp},r=>{var i;const o=(i=r==null?void 0:r[0])===null||i===void 0?void 0:i[zp];o!==void 0&&n(!!o),zt(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=aj(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return WC()||ry()||za()}}const Nj=Rj;class Pj{constructor(e){this.factorId=e}_process(e,n,s){switch(n.type){case"enroll":return this._finalizeEnroll(e,n.credential,s);case"signin":return this._finalizeSignIn(e,n.credential);default:return Ss("unexpected MultiFactorSessionType")}}}class gy extends Pj{constructor(e){super("phone"),this.credential=e}static _fromCredential(e){return new gy(e)}_finalizeEnroll(e,n,s){return tq(e,{idToken:n,displayName:s,phoneVerificationInfo:this.credential._makeVerificationRequest()})}_finalizeSignIn(e,n){return vq(e,{mfaPendingCredential:n,phoneVerificationInfo:this.credential._makeVerificationRequest()})}}class EA{constructor(){}static assertion(e){return gy._fromCredential(e)}}EA.FACTOR_ID="phone";var bI="@firebase/auth",II="0.20.5";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dj{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(s=>{var r;e(((r=s)===null||r===void 0?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);!n||(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){x(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xj(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";default:return}}function Oj(t){rt(new Ee("auth",(e,{options:n})=>{const s=e.getProvider("app").getImmediate(),r=e.getProvider("heartbeat"),{apiKey:i,authDomain:o}=s.options;return((a,c)=>{x(i&&!i.includes(":"),"invalid-api-key",{appName:a.name}),x(!(o!=null&&o.includes(":")),"argument-error",{appName:a.name});const l={apiKey:i,authDomain:o,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:GC(t)},u=new rB(a,c,l);return LV(u,n),u})(s,r)},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,s)=>{e.getProvider("auth-internal").initialize()})),rt(new Ee("auth-internal",e=>{const n=Dt(e.getProvider("auth").getImmediate());return(s=>new Dj(s))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),Fe(bI,II,xj(t)),Fe(bI,II,"esm2017")}Oj("Browser");/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function to(){return window}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mj=2e3;async function Lj(t,e,n){var s;const{BuildInfo:r}=to();ds(e.sessionId,"AuthEvent did not contain a session ID");const i=await Bj(e.sessionId),o={};return za()?o.ibi=r.packageName:gu()?o.apn=r.packageName:zt(t,"operation-not-supported-in-this-environment"),r.displayName&&(o.appDisplayName=r.displayName),o.sessionId=i,om(t,n,e.type,void 0,(s=e.eventId)!==null&&s!==void 0?s:void 0,o)}async function Fj(t){const{BuildInfo:e}=to(),n={};za()?n.iosBundleId=e.packageName:gu()?n.androidPackageName=e.packageName:zt(t,"operation-not-supported-in-this-environment"),await IA(t,n)}function Uj(t){const{cordova:e}=to();return new Promise(n=>{e.plugins.browsertab.isAvailable(s=>{let r=null;s?e.plugins.browsertab.openUrl(t):r=e.InAppBrowser.open(t,ZV()?"_blank":"_system","location=yes"),n(r)})})}async function $j(t,e,n){const{cordova:s}=to();let r=()=>{};try{await new Promise((i,o)=>{let a=null;function c(){var h;i();const d=(h=s.plugins.browsertab)===null||h===void 0?void 0:h.close;typeof d=="function"&&d(),typeof(n==null?void 0:n.close)=="function"&&n.close()}function l(){a||(a=window.setTimeout(()=>{o(Kt(t,"redirect-cancelled-by-user"))},Mj))}function u(){(document==null?void 0:document.visibilityState)==="visible"&&l()}e.addPassiveListener(c),document.addEventListener("resume",l,!1),gu()&&document.addEventListener("visibilitychange",u,!1),r=()=>{e.removePassiveListener(c),document.removeEventListener("resume",l,!1),document.removeEventListener("visibilitychange",u,!1),a&&window.clearTimeout(a)}})}finally{r()}}function Vj(t){var e,n,s,r,i,o,a,c,l,u;const h=to();x(typeof((e=h==null?void 0:h.universalLinks)===null||e===void 0?void 0:e.subscribe)=="function",t,"invalid-cordova-configuration",{missingPlugin:"cordova-universal-links-plugin-fix"}),x(typeof((n=h==null?void 0:h.BuildInfo)===null||n===void 0?void 0:n.packageName)!="undefined",t,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-buildInfo"}),x(typeof((i=(r=(s=h==null?void 0:h.cordova)===null||s===void 0?void 0:s.plugins)===null||r===void 0?void 0:r.browsertab)===null||i===void 0?void 0:i.openUrl)=="function",t,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),x(typeof((c=(a=(o=h==null?void 0:h.cordova)===null||o===void 0?void 0:o.plugins)===null||a===void 0?void 0:a.browsertab)===null||c===void 0?void 0:c.isAvailable)=="function",t,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),x(typeof((u=(l=h==null?void 0:h.cordova)===null||l===void 0?void 0:l.InAppBrowser)===null||u===void 0?void 0:u.open)=="function",t,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-inappbrowser"})}async function Bj(t){const e=qj(t),n=await crypto.subtle.digest("SHA-256",e);return Array.from(new Uint8Array(n)).map(r=>r.toString(16).padStart(2,"0")).join("")}function qj(t){if(ds(/[0-9a-zA-Z]+/.test(t),"Can only convert alpha-numeric strings"),typeof TextEncoder!="undefined")return new TextEncoder().encode(t);const e=new ArrayBuffer(t.length),n=new Uint8Array(e);for(let s=0;s<t.length;s++)n[s]=t.charCodeAt(s);return n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jj=20;class Kj extends wA{constructor(){super(...arguments),this.passiveListeners=new Set,this.initPromise=new Promise(e=>{this.resolveInialized=e})}addPassiveListener(e){this.passiveListeners.add(e)}removePassiveListener(e){this.passiveListeners.delete(e)}resetRedirect(){this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1}onEvent(e){return this.resolveInialized(),this.passiveListeners.forEach(n=>n(e)),super.onEvent(e)}async initialized(){await this.initPromise}}function Hj(t,e,n=null){return{type:e,eventId:n,urlResponse:null,sessionId:zj(),postBody:null,tenantId:t.tenantId,error:Kt(t,"no-auth-event")}}function Wj(t,e){return am()._set(cm(t),e)}async function EI(t){const e=await am()._get(cm(t));return e&&await am()._remove(cm(t)),e}function Gj(t,e){var n,s;const r=Yj(e);if(r.includes("/__/auth/callback")){const i=Ah(r),o=i.firebaseError?Qj(decodeURIComponent(i.firebaseError)):null,a=(s=(n=o==null?void 0:o.code)===null||n===void 0?void 0:n.split("auth/"))===null||s===void 0?void 0:s[1],c=a?Kt(a):null;return c?{type:t.type,eventId:t.eventId,tenantId:t.tenantId,error:c,urlResponse:null,sessionId:null,postBody:null}:{type:t.type,eventId:t.eventId,tenantId:t.tenantId,sessionId:t.sessionId,urlResponse:r,postBody:null}}return null}function zj(){const t=[],e="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let n=0;n<jj;n++){const s=Math.floor(Math.random()*e.length);t.push(e.charAt(s))}return t.join("")}function am(){return Rn(ly)}function cm(t){return Wi("authEvent",t.config.apiKey,t.name)}function Qj(t){try{return JSON.parse(t)}catch{return null}}function Yj(t){const e=Ah(t),n=e.link?decodeURIComponent(e.link):void 0,s=Ah(n).link,r=e.deep_link_id?decodeURIComponent(e.deep_link_id):void 0;return Ah(r).link||r||s||n||t}function Ah(t){if(!(t!=null&&t.includes("?")))return{};const[e,...n]=t.split("?");return Yo(n.join("?"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jj=500;class Xj{constructor(){this._redirectPersistence=eo,this._shouldInitProactively=!0,this.eventManagers=new Map,this.originValidationPromises={},this._completeRedirectFn=Ef,this._overrideRedirectResult=py}async _initialize(e){const n=e._key();let s=this.eventManagers.get(n);return s||(s=new Kj(e),this.eventManagers.set(n,s),this.attachCallbackListeners(e,s)),s}_openPopup(e){zt(e,"operation-not-supported-in-this-environment")}async _openRedirect(e,n,s,r){Vj(e);const i=await this._initialize(e);await i.initialized(),i.resetRedirect(),Qq(),await this._originValidation(e);const o=Hj(e,s,r);await Wj(e,o);const a=await Lj(e,o,n),c=await Uj(a);return $j(e,i,c)}_isIframeWebStorageSupported(e,n){throw new Error("Method not implemented.")}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=Fj(e)),this.originValidationPromises[n]}attachCallbackListeners(e,n){const{universalLinks:s,handleOpenURL:r,BuildInfo:i}=to(),o=setTimeout(async()=>{await EI(e),n.onEvent(TI())},Jj),a=async u=>{clearTimeout(o);const h=await EI(e);let d=null;h&&(u==null?void 0:u.url)&&(d=Gj(h,u.url)),n.onEvent(d||TI())};typeof s!="undefined"&&typeof s.subscribe=="function"&&s.subscribe(null,a);const c=r,l=`${i.packageName.toLowerCase()}://`;to().handleOpenURL=async u=>{if(u.toLowerCase().startsWith(l)&&a({url:u}),typeof c=="function")try{c(u)}catch(h){console.error(h)}}}}const Zj=Xj;function TI(){return{type:"unknown",eventId:null,sessionId:null,urlResponse:null,postBody:null,tenantId:null,error:Kt("no-auth-event")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eK(t,e){Dt(t)._logFramework(e)}var tK="@firebase/auth-compat",nK="0.2.18";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sK=1e3;function zc(){var t;return((t=self==null?void 0:self.location)===null||t===void 0?void 0:t.protocol)||null}function rK(){return zc()==="http:"||zc()==="https:"}function TA(t=We()){return!!((zc()==="file:"||zc()==="ionic:"||zc()==="capacitor:")&&t.toLowerCase().match(/iphone|ipad|ipod|android/))}function iK(){return hu()||$_()}function oK(){return V_()&&(document==null?void 0:document.documentMode)===11}function aK(t=We()){return/Edge\/\d+/.test(t)}function cK(t=We()){return oK()||aK(t)}function SA(){try{const t=self.localStorage,e=mu();if(t)return t.setItem(e,"1"),t.removeItem(e),cK()?In():!0}catch{return my()&&In()}return!1}function my(){return typeof global!="undefined"&&"WorkerGlobalScope"in global&&"importScripts"in global}function Qp(){return(rK()||uu()||TA())&&!iK()&&SA()&&!my()}function CA(){return TA()&&typeof document!="undefined"}async function lK(){return CA()?new Promise(t=>{const e=setTimeout(()=>{t(!1)},sK);document.addEventListener("deviceready",()=>{clearTimeout(e),t(!0)})}):!1}function uK(){return typeof window!="undefined"?window:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cn={LOCAL:"local",NONE:"none",SESSION:"session"},mc=x,AA="persistence";function hK(t,e){if(mc(Object.values(Cn).includes(e),t,"invalid-persistence-type"),hu()){mc(e!==Cn.SESSION,t,"unsupported-persistence-type");return}if($_()){mc(e===Cn.NONE,t,"unsupported-persistence-type");return}if(my()){mc(e===Cn.NONE||e===Cn.LOCAL&&In(),t,"unsupported-persistence-type");return}mc(e===Cn.NONE||SA(),t,"unsupported-persistence-type")}async function lm(t){await t._initializationPromise;const e=kA(),n=Wi(AA,t.config.apiKey,t.name);e&&e.setItem(n,t._getPersistence())}function dK(t,e){const n=kA();if(!n)return[];const s=Wi(AA,t,e);switch(n.getItem(s)){case Cn.NONE:return[Ia];case Cn.LOCAL:return[Pl,eo];case Cn.SESSION:return[eo];default:return[]}}function kA(){var t;try{return((t=uK())===null||t===void 0?void 0:t.sessionStorage)||null}catch{return null}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fK=x;class Mr{constructor(){this.browserResolver=Rn(Nj),this.cordovaResolver=Rn(Zj),this.underlyingResolver=null,this._redirectPersistence=eo,this._completeRedirectFn=Ef,this._overrideRedirectResult=py}async _initialize(e){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._initialize(e)}async _openPopup(e,n,s,r){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._openPopup(e,n,s,r)}async _openRedirect(e,n,s,r){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._openRedirect(e,n,s,r)}_isIframeWebStorageSupported(e,n){this.assertedUnderlyingResolver._isIframeWebStorageSupported(e,n)}_originValidation(e){return this.assertedUnderlyingResolver._originValidation(e)}get _shouldInitProactively(){return CA()||this.browserResolver._shouldInitProactively}get assertedUnderlyingResolver(){return fK(this.underlyingResolver,"internal-error"),this.underlyingResolver}async selectUnderlyingResolver(){if(this.underlyingResolver)return;const e=await lK();this.underlyingResolver=e?this.cordovaResolver:this.browserResolver}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function RA(t){return t.unwrap()}function pK(t){return t.wrapped()}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gK(t){return NA(t)}function mK(t,e){var n,s;const r=(n=e.customData)===null||n===void 0?void 0:n._tokenResponse;if(((s=e)===null||s===void 0?void 0:s.code)==="auth/multi-factor-auth-required"){const i=e;i.resolver=new _K(t,ZB(t,e))}else if(r){const i=NA(e),o=e;i&&(o.credential=i,o.tenantId=r.tenantId||void 0,o.email=r.email||void 0,o.phoneNumber=r.phoneNumber||void 0)}}function NA(t){const{_tokenResponse:e}=t instanceof ut?t.customData:t;if(!e)return null;if(!(t instanceof ut)&&"temporaryProof"in e&&"phoneNumber"in e)return ls.credentialFromResult(t);const n=e.providerId;if(!n||n===gc.PASSWORD)return null;let s;switch(n){case gc.GOOGLE:s=ws;break;case gc.FACEBOOK:s=vs;break;case gc.GITHUB:s=bs;break;case gc.TWITTER:s=Is;break;default:const{oauthIdToken:r,oauthAccessToken:i,oauthTokenSecret:o,pendingToken:a,nonce:c}=e;return!i&&!o&&!r&&!a?null:a?n.startsWith("saml.")?Ea._create(n,a):Ms._fromParams({providerId:n,signInMethod:n,pendingToken:a,idToken:r,accessToken:i}):new ia(n).credential({idToken:r,accessToken:i,rawNonce:c})}return t instanceof ut?s.credentialFromError(t):s.credentialFromResult(t)}function gn(t,e){return e.catch(n=>{throw n instanceof ut&&mK(t,n),n}).then(n=>{const s=n.operationType,r=n.user;return{operationType:s,credential:gK(n),additionalUserInfo:XB(n),user:Xs.getOrCreate(r)}})}async function um(t,e){const n=await e;return{verificationId:n.verificationId,confirm:s=>gn(t,n.confirm(s))}}class _K{constructor(e,n){this.resolver=n,this.auth=pK(e)}get session(){return this.resolver.session}get hints(){return this.resolver.hints}resolveSignIn(e){return gn(RA(this.auth),this.resolver.resolveSignIn(e))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xs{constructor(e){this._delegate=e,this.multiFactor=sq(e)}static getOrCreate(e){return Xs.USER_MAP.has(e)||Xs.USER_MAP.set(e,new Xs(e)),Xs.USER_MAP.get(e)}delete(){return this._delegate.delete()}reload(){return this._delegate.reload()}toJSON(){return this._delegate.toJSON()}getIdTokenResult(e){return this._delegate.getIdTokenResult(e)}getIdToken(e){return this._delegate.getIdToken(e)}linkAndRetrieveDataWithCredential(e){return this.linkWithCredential(e)}async linkWithCredential(e){return gn(this.auth,nA(this._delegate,e))}async linkWithPhoneNumber(e,n){return um(this.auth,Lq(this._delegate,e,n))}async linkWithPopup(e){return gn(this.auth,Hq(this._delegate,e,Mr))}async linkWithRedirect(e){return await lm(Dt(this.auth)),ej(this._delegate,e,Mr)}reauthenticateAndRetrieveDataWithCredential(e){return this.reauthenticateWithCredential(e)}async reauthenticateWithCredential(e){return gn(this.auth,sA(this._delegate,e))}reauthenticateWithPhoneNumber(e,n){return um(this.auth,Fq(this._delegate,e,n))}reauthenticateWithPopup(e){return gn(this.auth,Kq(this._delegate,e,Mr))}async reauthenticateWithRedirect(e){return await lm(Dt(this.auth)),Xq(this._delegate,e,Mr)}sendEmailVerification(e){return BB(this._delegate,e)}async unlink(e){return await AB(this._delegate,e),this}updateEmail(e){return HB(this._delegate,e)}updatePassword(e){return WB(this._delegate,e)}updatePhoneNumber(e){return Uq(this._delegate,e)}updateProfile(e){return KB(this._delegate,e)}verifyBeforeUpdateEmail(e,n){return qB(this._delegate,e,n)}get emailVerified(){return this._delegate.emailVerified}get isAnonymous(){return this._delegate.isAnonymous}get metadata(){return this._delegate.metadata}get phoneNumber(){return this._delegate.phoneNumber}get providerData(){return this._delegate.providerData}get refreshToken(){return this._delegate.refreshToken}get tenantId(){return this._delegate.tenantId}get displayName(){return this._delegate.displayName}get email(){return this._delegate.email}get photoURL(){return this._delegate.photoURL}get providerId(){return this._delegate.providerId}get uid(){return this._delegate.uid}get auth(){return this._delegate.auth}}Xs.USER_MAP=new WeakMap;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _c=x;class hm{constructor(e,n){if(this.app=e,n.isInitialized()){this._delegate=n.getImmediate(),this.linkUnderlyingAuth();return}const{apiKey:s}=e.options;_c(s,"invalid-api-key",{appName:e.name}),_c(s,"invalid-api-key",{appName:e.name});const r=typeof window!="undefined"?Mr:void 0;this._delegate=n.initialize({options:{persistence:yK(s,e.name),popupRedirectResolver:r}}),this._delegate._updateErrorMap(OV),this.linkUnderlyingAuth()}get emulatorConfig(){return this._delegate.emulatorConfig}get currentUser(){return this._delegate.currentUser?Xs.getOrCreate(this._delegate.currentUser):null}get languageCode(){return this._delegate.languageCode}set languageCode(e){this._delegate.languageCode=e}get settings(){return this._delegate.settings}get tenantId(){return this._delegate.tenantId}set tenantId(e){this._delegate.tenantId=e}useDeviceLanguage(){this._delegate.useDeviceLanguage()}signOut(){return this._delegate.signOut()}useEmulator(e,n){iB(this._delegate,e,n)}applyActionCode(e){return DB(this._delegate,e)}checkActionCode(e){return rA(this._delegate,e)}confirmPasswordReset(e,n){return PB(this._delegate,e,n)}async createUserWithEmailAndPassword(e,n){return gn(this._delegate,OB(this._delegate,e,n))}fetchProvidersForEmail(e){return this.fetchSignInMethodsForEmail(e)}fetchSignInMethodsForEmail(e){return VB(this._delegate,e)}isSignInWithEmailLink(e){return FB(this._delegate,e)}async getRedirectResult(){_c(Qp(),this._delegate,"operation-not-supported-in-this-environment");const e=await nj(this._delegate,Mr);return e?gn(this._delegate,Promise.resolve(e)):{credential:null,user:null}}addFrameworkForLogging(e){eK(this._delegate,e)}onAuthStateChanged(e,n,s){const{next:r,error:i,complete:o}=SI(e,n,s);return this._delegate.onAuthStateChanged(r,i,o)}onIdTokenChanged(e,n,s){const{next:r,error:i,complete:o}=SI(e,n,s);return this._delegate.onIdTokenChanged(r,i,o)}sendSignInLinkToEmail(e,n){return LB(this._delegate,e,n)}sendPasswordResetEmail(e,n){return NB(this._delegate,e,n||void 0)}async setPersistence(e){hK(this._delegate,e);let n;switch(e){case Cn.SESSION:n=eo;break;case Cn.LOCAL:n=await Rn(Pl)._isAvailable()?Pl:ly;break;case Cn.NONE:n=Ia;break;default:return zt("argument-error",{appName:this._delegate.name})}return this._delegate.setPersistence(n)}signInAndRetrieveDataWithCredential(e){return this.signInWithCredential(e)}signInAnonymously(){return gn(this._delegate,CB(this._delegate))}signInWithCredential(e){return gn(this._delegate,_f(this._delegate,e))}signInWithCustomToken(e){return gn(this._delegate,RB(this._delegate,e))}signInWithEmailAndPassword(e,n){return gn(this._delegate,MB(this._delegate,e,n))}signInWithEmailLink(e,n){return gn(this._delegate,UB(this._delegate,e,n))}signInWithPhoneNumber(e,n){return um(this._delegate,Mq(this._delegate,e,n))}async signInWithPopup(e){return _c(Qp(),this._delegate,"operation-not-supported-in-this-environment"),gn(this._delegate,jq(this._delegate,e,Mr))}async signInWithRedirect(e){return _c(Qp(),this._delegate,"operation-not-supported-in-this-environment"),await lm(this._delegate),Yq(this._delegate,e,Mr)}updateCurrentUser(e){return this._delegate.updateCurrentUser(e)}verifyPasswordResetCode(e){return xB(this._delegate,e)}unwrap(){return this._delegate}_delete(){return this._delegate._delete()}linkUnderlyingAuth(){this._delegate.wrapped=()=>this}}hm.Persistence=Cn;function SI(t,e,n){let s=t;typeof t!="function"&&({next:s,error:e,complete:n}=t);const r=s;return{next:o=>r(o&&Xs.getOrCreate(o)),error:e,complete:n}}function yK(t,e){const n=dK(t,e);if(typeof self!="undefined"&&!n.includes(Pl)&&n.push(Pl),typeof window!="undefined")for(const s of[ly,eo])n.includes(s)||n.push(s);return n.includes(Ia)||n.push(Ia),n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _y{constructor(){this.providerId="phone",this._delegate=new ls(RA(ht.auth()))}static credential(e,n){return ls.credential(e,n)}verifyPhoneNumber(e,n){return this._delegate.verifyPhoneNumber(e,n)}unwrap(){return this._delegate}}_y.PHONE_SIGN_IN_METHOD=ls.PHONE_SIGN_IN_METHOD;_y.PROVIDER_ID=ls.PROVIDER_ID;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vK=x;class wK{constructor(e,n,s=ht.app()){var r;vK((r=s.options)===null||r===void 0?void 0:r.apiKey,"invalid-api-key",{appName:s.name}),this._delegate=new xq(e,n,s.auth()),this.type=this._delegate.type}clear(){this._delegate.clear()}render(){return this._delegate.render()}verify(){return this._delegate.verify()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bK="auth-compat";function IK(t){t.INTERNAL.registerComponent(new Ee(bK,e=>{const n=e.getProvider("app-compat").getImmediate(),s=e.getProvider("auth");return new hm(n,s)},"PUBLIC").setServiceProps({ActionCodeInfo:{Operation:{EMAIL_SIGNIN:$o.EMAIL_SIGNIN,PASSWORD_RESET:$o.PASSWORD_RESET,RECOVER_EMAIL:$o.RECOVER_EMAIL,REVERT_SECOND_FACTOR_ADDITION:$o.REVERT_SECOND_FACTOR_ADDITION,VERIFY_AND_CHANGE_EMAIL:$o.VERIFY_AND_CHANGE_EMAIL,VERIFY_EMAIL:$o.VERIFY_EMAIL}},EmailAuthProvider:ci,FacebookAuthProvider:vs,GithubAuthProvider:bs,GoogleAuthProvider:ws,OAuthProvider:ia,SAMLAuthProvider:Zh,PhoneAuthProvider:_y,PhoneMultiFactorGenerator:EA,RecaptchaVerifier:wK,TwitterAuthProvider:Is,Auth:hm,AuthCredential:Qa,Error:ut}).setInstantiationMode("LAZY").setMultipleInstances(!1)),t.registerVersion(tK,nK)}IK(ht);const CI="@firebase/database",AI="0.13.3";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let PA="";function DA(t){PA=t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EK{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,n){n==null?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),_t(n))}get(e){const n=this.domStorage_.getItem(this.prefixedName_(e));return n==null?null:wl(n)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TK{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,n){n==null?delete this.cache_[e]:this.cache_[e]=n}get(e){return xn(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xA=function(t){try{if(typeof window!="undefined"&&typeof window[t]!="undefined"){const e=window[t];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new EK(e)}}catch{}return new TK},Ui=xA("localStorage"),dm=xA("sessionStorage");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aa=new js("@firebase/database"),OA=function(){let t=1;return function(){return t++}}(),MA=function(t){const e=HL(t),n=new qL;n.update(e);const s=n.digest();return rf.encodeByteArray(s)},yu=function(...t){let e="";for(let n=0;n<t.length;n++){const s=t[n];Array.isArray(s)||s&&typeof s=="object"&&typeof s.length=="number"?e+=yu.apply(null,s):typeof s=="object"?e+=_t(s):e+=s,e+=" "}return e};let zi=null,kI=!0;const LA=function(t,e){O(!e||t===!0||t===!1,"Can't turn on custom loggers persistently."),t===!0?(aa.logLevel=fe.VERBOSE,zi=aa.log.bind(aa),e&&dm.set("logging_enabled",!0)):typeof t=="function"?zi=t:(zi=null,dm.remove("logging_enabled"))},Ct=function(...t){if(kI===!0&&(kI=!1,zi===null&&dm.get("logging_enabled")===!0&&LA(!0)),zi){const e=yu.apply(null,t);zi(e)}},vu=function(t){return function(...e){Ct(t,...e)}},fm=function(...t){const e="FIREBASE INTERNAL ERROR: "+yu(...t);aa.error(e)},Ls=function(...t){const e=`FIREBASE FATAL ERROR: ${yu(...t)}`;throw aa.error(e),new Error(e)},Xt=function(...t){const e="FIREBASE WARNING: "+yu(...t);aa.warn(e)},SK=function(){typeof window!="undefined"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&Xt("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},Tf=function(t){return typeof t=="number"&&(t!==t||t===Number.POSITIVE_INFINITY||t===Number.NEGATIVE_INFINITY)},CK=function(t){if(document.readyState==="complete")t();else{let e=!1;const n=function(){if(!document.body){setTimeout(n,Math.floor(10));return}e||(e=!0,t())};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&n()}),window.attachEvent("onload",n))}},lr="[MIN_NAME]",Fs="[MAX_NAME]",Ao=function(t,e){if(t===e)return 0;if(t===lr||e===Fs)return-1;if(e===lr||t===Fs)return 1;{const n=sd(t),s=sd(e);return n!==null?s!==null?n-s===0?t.length-e.length:n-s:-1:s!==null?1:t<e?-1:1}},AK=function(t,e){return t===e?0:t<e?-1:1},yc=function(t,e){if(e&&t in e)return e[t];throw new Error("Missing required key ("+t+") in object: "+_t(e))},yy=function(t){if(typeof t!="object"||t===null)return _t(t);const e=[];for(const s in t)e.push(s);e.sort();let n="{";for(let s=0;s<e.length;s++)s!==0&&(n+=","),n+=_t(e[s]),n+=":",n+=yy(t[e[s]]);return n+="}",n},FA=function(t,e){const n=t.length;if(n<=e)return[t];const s=[];for(let r=0;r<n;r+=e)r+e>n?s.push(t.substring(r,n)):s.push(t.substring(r,r+e));return s};function xt(t,e){for(const n in t)t.hasOwnProperty(n)&&e(n,t[n])}const UA=function(t){O(!Tf(t),"Invalid JSON number");const e=11,n=52,s=(1<<e-1)-1;let r,i,o,a,c;t===0?(i=0,o=0,r=1/t===-1/0?1:0):(r=t<0,t=Math.abs(t),t>=Math.pow(2,1-s)?(a=Math.min(Math.floor(Math.log(t)/Math.LN2),s),i=a+s,o=Math.round(t*Math.pow(2,n-a)-Math.pow(2,n))):(i=0,o=Math.round(t/Math.pow(2,1-s-n))));const l=[];for(c=n;c;c-=1)l.push(o%2?1:0),o=Math.floor(o/2);for(c=e;c;c-=1)l.push(i%2?1:0),i=Math.floor(i/2);l.push(r?1:0),l.reverse();const u=l.join("");let h="";for(c=0;c<64;c+=8){let d=parseInt(u.substr(c,8),2).toString(16);d.length===1&&(d="0"+d),h=h+d}return h.toLowerCase()},kK=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},RK=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};function NK(t,e){let n="Unknown Error";t==="too_big"?n="The data requested exceeds the maximum size that can be accessed with a single request.":t==="permission_denied"?n="Client doesn't have permission to access the desired data.":t==="unavailable"&&(n="The service is unavailable");const s=new Error(t+" at "+e._path.toString()+": "+n);return s.code=t.toUpperCase(),s}const PK=new RegExp("^-?(0*)\\d{1,10}$"),$A=-2147483648,vy=2147483647,sd=function(t){if(PK.test(t)){const e=Number(t);if(e>=$A&&e<=vy)return e}return null},Ja=function(t){try{t()}catch(e){setTimeout(()=>{const n=e.stack||"";throw Xt("Exception was thrown by user callback.",n),e},Math.floor(0))}},DK=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},Qc=function(t,e){const n=setTimeout(t,e);return typeof n=="object"&&n.unref&&n.unref(),n};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xK{constructor(e,n){this.appName_=e,this.appCheckProvider=n,this.appCheck=n==null?void 0:n.getImmediate({optional:!0}),this.appCheck||n==null||n.get().then(s=>this.appCheck=s)}getToken(e){return this.appCheck?this.appCheck.getToken(e):new Promise((n,s)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(n,s):n(null)},0)})}addTokenChangeListener(e){var n;(n=this.appCheckProvider)===null||n===void 0||n.get().then(s=>s.addTokenListener(e))}notifyForInvalidToken(){Xt(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OK{constructor(e,n,s){this.appName_=e,this.firebaseOptions_=n,this.authProvider_=s,this.auth_=null,this.auth_=s.getImmediate({optional:!0}),this.auth_||s.onInit(r=>this.auth_=r)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(n=>n&&n.code==="auth/token-not-initialized"?(Ct("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(n)):new Promise((n,s)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(n,s):n(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(n=>n.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(n=>n.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',Xt(e)}}class ca{constructor(e){this.accessToken=e}getToken(e){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(e){e(this.accessToken)}removeTokenChangeListener(e){}notifyForInvalidToken(){}}ca.OWNER="owner";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wy="5",VA="v",BA="s",qA="r",jA="f",KA=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,HA="ls",WA="p",pm="ac",GA="websocket",zA="long_polling";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QA{constructor(e,n,s,r,i=!1,o="",a=!1){this.secure=n,this.namespace=s,this.webSocketOnly=r,this.nodeAdmin=i,this.persistenceKey=o,this.includeNamespaceInQueryParams=a,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=Ui.get("host:"+e)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&Ui.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){const e=this.secure?"https://":"http://",n=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${n}`}}function MK(t){return t.host!==t.internalHost||t.isCustomHost()||t.includeNamespaceInQueryParams}function YA(t,e,n){O(typeof e=="string","typeof type must == string"),O(typeof n=="object","typeof params must == object");let s;if(e===GA)s=(t.secure?"wss://":"ws://")+t.internalHost+"/.ws?";else if(e===zA)s=(t.secure?"https://":"http://")+t.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+e);MK(t)&&(n.ns=t.namespace);const r=[];return xt(n,(i,o)=>{r.push(i+"="+o)}),s+r.join("&")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LK{constructor(){this.counters_={}}incrementCounter(e,n=1){xn(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=n}get(){return RL(this.counters_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yp={},Jp={};function by(t){const e=t.toString();return Yp[e]||(Yp[e]=new LK),Yp[e]}function FK(t,e){const n=t.toString();return Jp[n]||(Jp[n]=e()),Jp[n]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UK{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,n){this.closeAfterResponse=e,this.onClose=n,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,n){for(this.pendingResponses[e]=n;this.pendingResponses[this.currentResponseNum];){const s=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let r=0;r<s.length;++r)s[r]&&Ja(()=>{this.onMessage_(s[r])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RI="start",$K="close",VK="pLPCommand",BK="pRTLPCB",JA="id",XA="pw",ZA="ser",qK="cb",jK="seg",KK="ts",HK="d",WK="dframe",ek=1870,tk=30,GK=ek-tk,zK=25e3,QK=3e4;class Lr{constructor(e,n,s,r,i,o,a){this.connId=e,this.repoInfo=n,this.applicationId=s,this.appCheckToken=r,this.authToken=i,this.transportSessionId=o,this.lastSessionId=a,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=vu(e),this.stats_=by(n),this.urlFn=c=>(this.appCheckToken&&(c[pm]=this.appCheckToken),YA(n,zA,c))}open(e,n){this.curSegmentNum=0,this.onDisconnect_=n,this.myPacketOrderer=new UK(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(QK)),CK(()=>{if(this.isClosed_)return;this.scriptTagHolder=new Iy((...i)=>{const[o,a,c,l,u]=i;if(this.incrementIncomingBytes_(i),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,o===RI)this.id=a,this.password=c;else if(o===$K)a?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(a,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+o)},(...i)=>{const[o,a]=i;this.incrementIncomingBytes_(i),this.myPacketOrderer.handleResponse(o,a)},()=>{this.onClosed_()},this.urlFn);const s={};s[RI]="t",s[ZA]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(s[qK]=this.scriptTagHolder.uniqueCallbackIdentifier),s[VA]=wy,this.transportSessionId&&(s[BA]=this.transportSessionId),this.lastSessionId&&(s[HA]=this.lastSessionId),this.applicationId&&(s[WA]=this.applicationId),this.appCheckToken&&(s[pm]=this.appCheckToken),typeof location!="undefined"&&location.hostname&&KA.test(location.hostname)&&(s[qA]=jA);const r=this.urlFn(s);this.log_("Connecting via long-poll to "+r),this.scriptTagHolder.addTag(r,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){Lr.forceAllow_=!0}static forceDisallow(){Lr.forceDisallow_=!0}static isAvailable(){return Lr.forceAllow_?!0:!Lr.forceDisallow_&&typeof document!="undefined"&&document.createElement!=null&&!kK()&&!RK()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){const n=_t(e);this.bytesSent+=n.length,this.stats_.incrementCounter("bytes_sent",n.length);const s=P0(n),r=FA(s,GK);for(let i=0;i<r.length;i++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,r.length,r[i]),this.curSegmentNum++}addDisconnectPingFrame(e,n){this.myDisconnFrame=document.createElement("iframe");const s={};s[WK]="t",s[JA]=e,s[XA]=n,this.myDisconnFrame.src=this.urlFn(s),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){const n=_t(e).length;this.bytesReceived+=n,this.stats_.incrementCounter("bytes_received",n)}}class Iy{constructor(e,n,s,r){this.onDisconnect=s,this.urlFn=r,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0;{this.uniqueCallbackIdentifier=OA(),window[VK+this.uniqueCallbackIdentifier]=e,window[BK+this.uniqueCallbackIdentifier]=n,this.myIFrame=Iy.createIFrame_();let i="";if(this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"){const a=document.domain;i='<script>document.domain="'+a+'";<\/script>'}const o="<html><body>"+i+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(o),this.myIFrame.doc.close()}catch(a){Ct("frame writing exception"),a.stack&&Ct(a.stack),Ct(a)}}}static createIFrame_(){const e=document.createElement("iframe");if(e.style.display="none",document.body){document.body.appendChild(e);try{e.contentWindow.document||Ct("No IE domain setting required")}catch{const s=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+s+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.innerHTML="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));const e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,n){for(this.myID=e,this.myPW=n,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const e={};e[JA]=this.myID,e[XA]=this.myPW,e[ZA]=this.currentSerial;let n=this.urlFn(e),s="",r=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+tk+s.length<=ek;){const o=this.pendingSegs.shift();s=s+"&"+jK+r+"="+o.seg+"&"+KK+r+"="+o.ts+"&"+HK+r+"="+o.d,r++}return n=n+s,this.addLongPollTag_(n,this.currentSerial),!0}else return!1}enqueueSegment(e,n,s){this.pendingSegs.push({seg:e,ts:n,d:s}),this.alive&&this.newRequest_()}addLongPollTag_(e,n){this.outstandingRequests.add(n);const s=()=>{this.outstandingRequests.delete(n),this.newRequest_()},r=setTimeout(s,Math.floor(zK)),i=()=>{clearTimeout(r),s()};this.addTag(e,i)}addTag(e,n){setTimeout(()=>{try{if(!this.sendNewPolls)return;const s=this.myIFrame.doc.createElement("script");s.type="text/javascript",s.async=!0,s.src=e,s.onload=s.onreadystatechange=function(){const r=s.readyState;(!r||r==="loaded"||r==="complete")&&(s.onload=s.onreadystatechange=null,s.parentNode&&s.parentNode.removeChild(s),n())},s.onerror=()=>{Ct("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(s)}catch{}},Math.floor(1))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YK=16384,JK=45e3;let rd=null;typeof MozWebSocket!="undefined"?rd=MozWebSocket:typeof WebSocket!="undefined"&&(rd=WebSocket);class $n{constructor(e,n,s,r,i,o,a){this.connId=e,this.applicationId=s,this.appCheckToken=r,this.authToken=i,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=vu(this.connId),this.stats_=by(n),this.connURL=$n.connectionURL_(n,o,a,r,s),this.nodeAdmin=n.nodeAdmin}static connectionURL_(e,n,s,r,i){const o={};return o[VA]=wy,typeof location!="undefined"&&location.hostname&&KA.test(location.hostname)&&(o[qA]=jA),n&&(o[BA]=n),s&&(o[HA]=s),r&&(o[pm]=r),i&&(o[WA]=i),YA(e,GA,o)}open(e,n){this.onDisconnect=n,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,Ui.set("previous_websocket_failure",!0);try{let s;D0(),this.mySock=new rd(this.connURL,[],s)}catch(s){this.log_("Error instantiating WebSocket.");const r=s.message||s.data;r&&this.log_(r),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=s=>{this.handleIncomingFrame(s)},this.mySock.onerror=s=>{this.log_("WebSocket error.  Closing connection.");const r=s.message||s.data;r&&this.log_(r),this.onClosed_()}}start(){}static forceDisallow(){$n.forceDisallow_=!0}static isAvailable(){let e=!1;if(typeof navigator!="undefined"&&navigator.userAgent){const n=/Android ([0-9]{0,}\.[0-9]{0,})/,s=navigator.userAgent.match(n);s&&s.length>1&&parseFloat(s[1])<4.4&&(e=!0)}return!e&&rd!==null&&!$n.forceDisallow_}static previouslyFailed(){return Ui.isInMemoryStorage||Ui.get("previous_websocket_failure")===!0}markConnectionHealthy(){Ui.remove("previous_websocket_failure")}appendFrame_(e){if(this.frames.push(e),this.frames.length===this.totalFrames){const n=this.frames.join("");this.frames=null;const s=wl(n);this.onMessage(s)}}handleNewFrameCount_(e){this.totalFrames=e,this.frames=[]}extractFrameCount_(e){if(O(this.frames===null,"We already have a frame buffer"),e.length<=6){const n=Number(e);if(!isNaN(n))return this.handleNewFrameCount_(n),null}return this.handleNewFrameCount_(1),e}handleIncomingFrame(e){if(this.mySock===null)return;const n=e.data;if(this.bytesReceived+=n.length,this.stats_.incrementCounter("bytes_received",n.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(n);else{const s=this.extractFrameCount_(n);s!==null&&this.appendFrame_(s)}}send(e){this.resetKeepAlive();const n=_t(e);this.bytesSent+=n.length,this.stats_.incrementCounter("bytes_sent",n.length);const s=FA(n,YK);s.length>1&&this.sendString_(String(s.length));for(let r=0;r<s.length;r++)this.sendString_(s[r])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(JK))}sendString_(e){try{this.mySock.send(e)}catch(n){this.log_("Exception thrown from WebSocket.send():",n.message||n.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}$n.responsesRequiredToBeHealthy=2;$n.healthyTimeout=3e4;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ta{constructor(e){this.initTransports_(e)}static get ALL_TRANSPORTS(){return[Lr,$n]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(e){const n=$n&&$n.isAvailable();let s=n&&!$n.previouslyFailed();if(e.webSocketOnly&&(n||Xt("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),s=!0),s)this.transports_=[$n];else{const r=this.transports_=[];for(const i of Ta.ALL_TRANSPORTS)i&&i.isAvailable()&&r.push(i);Ta.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}Ta.globalTransportInitialized_=!1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XK=6e4,ZK=5e3,eH=10*1024,tH=100*1024,Xp="t",NI="d",nH="s",PI="r",sH="e",DI="o",xI="a",OI="n",MI="p",rH="h";class iH{constructor(e,n,s,r,i,o,a,c,l,u){this.id=e,this.repoInfo_=n,this.applicationId_=s,this.appCheckToken_=r,this.authToken_=i,this.onMessage_=o,this.onReady_=a,this.onDisconnect_=c,this.onKill_=l,this.lastSessionId=u,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=vu("c:"+this.id+":"),this.transportManager_=new Ta(n),this.log_("Connection created"),this.start_()}start_(){const e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const n=this.connReceiver_(this.conn_),s=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(n,s)},Math.floor(0));const r=e.healthyTimeout||0;r>0&&(this.healthyTimeout_=Qc(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>tH?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>eH?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(r)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return n=>{e===this.conn_?this.onConnectionLost_(n):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return n=>{this.state_!==2&&(e===this.rx_?this.onPrimaryMessageReceived_(n):e===this.secondaryConn_?this.onSecondaryMessageReceived_(n):this.log_("message on old connection"))}}sendRequest(e){const n={t:"d",d:e};this.sendData_(n)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if(Xp in e){const n=e[Xp];n===xI?this.upgradeIfSecondaryHealthy_():n===PI?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):n===DI&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){const n=yc("t",e),s=yc("d",e);if(n==="c")this.onSecondaryControl_(s);else if(n==="d")this.pendingDataMessages.push(s);else throw new Error("Unknown protocol layer: "+n)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:MI,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:xI,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:OI,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){const n=yc("t",e),s=yc("d",e);n==="c"?this.onControl_(s):n==="d"&&this.onDataMessage_(s)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){const n=yc(Xp,e);if(NI in e){const s=e[NI];if(n===rH)this.onHandshake_(s);else if(n===OI){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let r=0;r<this.pendingDataMessages.length;++r)this.onDataMessage_(this.pendingDataMessages[r]);this.pendingDataMessages=[],this.tryCleanupConnection()}else n===nH?this.onConnectionShutdown_(s):n===PI?this.onReset_(s):n===sH?fm("Server Error: "+s):n===DI?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):fm("Unknown control packet command: "+n)}}onHandshake_(e){const n=e.ts,s=e.v,r=e.h;this.sessionId=e.s,this.repoInfo_.host=r,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,n),wy!==s&&Xt("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const n=this.connReceiver_(this.secondaryConn_),s=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(n,s),Qc(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(XK))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,n){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(n,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):Qc(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(ZK))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:MI,d:{}}}))}onSecondaryConnectionLost_(){const e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,!e&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(Ui.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(e)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nk{put(e,n,s,r){}merge(e,n,s,r){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,n,s){}onDisconnectMerge(e,n,s){}onDisconnectCancel(e,n){}reportStats(e){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sk{constructor(e){this.allowedEvents_=e,this.listeners_={},O(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...n){if(Array.isArray(this.listeners_[e])){const s=[...this.listeners_[e]];for(let r=0;r<s.length;r++)s[r].callback.apply(s[r].context,n)}}on(e,n,s){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:n,context:s});const r=this.getInitialEvent(e);r&&n.apply(s,r)}off(e,n,s){this.validateEventType_(e);const r=this.listeners_[e]||[];for(let i=0;i<r.length;i++)if(r[i].callback===n&&(!s||s===r[i].context)){r.splice(i,1);return}}validateEventType_(e){O(this.allowedEvents_.find(n=>n===e),"Unknown event: "+e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class id extends sk{constructor(){super(["online"]),this.online_=!0,typeof window!="undefined"&&typeof window.addEventListener!="undefined"&&!of()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}static getInstance(){return new id}getInitialEvent(e){return O(e==="online","Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LI=32,FI=768;class Ae{constructor(e,n){if(n===void 0){this.pieces_=e.split("/");let s=0;for(let r=0;r<this.pieces_.length;r++)this.pieces_[r].length>0&&(this.pieces_[s]=this.pieces_[r],s++);this.pieces_.length=s,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=n}toString(){let e="";for(let n=this.pieceNum_;n<this.pieces_.length;n++)this.pieces_[n]!==""&&(e+="/"+this.pieces_[n]);return e||"/"}}function Te(){return new Ae("")}function pe(t){return t.pieceNum_>=t.pieces_.length?null:t.pieces_[t.pieceNum_]}function Jr(t){return t.pieces_.length-t.pieceNum_}function Le(t){let e=t.pieceNum_;return e<t.pieces_.length&&e++,new Ae(t.pieces_,e)}function Ey(t){return t.pieceNum_<t.pieces_.length?t.pieces_[t.pieces_.length-1]:null}function oH(t){let e="";for(let n=t.pieceNum_;n<t.pieces_.length;n++)t.pieces_[n]!==""&&(e+="/"+encodeURIComponent(String(t.pieces_[n])));return e||"/"}function Dl(t,e=0){return t.pieces_.slice(t.pieceNum_+e)}function rk(t){if(t.pieceNum_>=t.pieces_.length)return null;const e=[];for(let n=t.pieceNum_;n<t.pieces_.length-1;n++)e.push(t.pieces_[n]);return new Ae(e,0)}function ze(t,e){const n=[];for(let s=t.pieceNum_;s<t.pieces_.length;s++)n.push(t.pieces_[s]);if(e instanceof Ae)for(let s=e.pieceNum_;s<e.pieces_.length;s++)n.push(e.pieces_[s]);else{const s=e.split("/");for(let r=0;r<s.length;r++)s[r].length>0&&n.push(s[r])}return new Ae(n,0)}function ge(t){return t.pieceNum_>=t.pieces_.length}function un(t,e){const n=pe(t),s=pe(e);if(n===null)return e;if(n===s)return un(Le(t),Le(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+t+")")}function aH(t,e){const n=Dl(t,0),s=Dl(e,0);for(let r=0;r<n.length&&r<s.length;r++){const i=Ao(n[r],s[r]);if(i!==0)return i}return n.length===s.length?0:n.length<s.length?-1:1}function Ty(t,e){if(Jr(t)!==Jr(e))return!1;for(let n=t.pieceNum_,s=e.pieceNum_;n<=t.pieces_.length;n++,s++)if(t.pieces_[n]!==e.pieces_[s])return!1;return!0}function Bn(t,e){let n=t.pieceNum_,s=e.pieceNum_;if(Jr(t)>Jr(e))return!1;for(;n<t.pieces_.length;){if(t.pieces_[n]!==e.pieces_[s])return!1;++n,++s}return!0}class cH{constructor(e,n){this.errorPrefix_=n,this.parts_=Dl(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let s=0;s<this.parts_.length;s++)this.byteLength_+=cf(this.parts_[s]);ik(this)}}function lH(t,e){t.parts_.length>0&&(t.byteLength_+=1),t.parts_.push(e),t.byteLength_+=cf(e),ik(t)}function uH(t){const e=t.parts_.pop();t.byteLength_-=cf(e),t.parts_.length>0&&(t.byteLength_-=1)}function ik(t){if(t.byteLength_>FI)throw new Error(t.errorPrefix_+"has a key path longer than "+FI+" bytes ("+t.byteLength_+").");if(t.parts_.length>LI)throw new Error(t.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+LI+") or object contains a cycle "+Si(t))}function Si(t){return t.parts_.length===0?"":"in property '"+t.parts_.join(".")+"'"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sy extends sk{constructor(){super(["visible"]);let e,n;typeof document!="undefined"&&typeof document.addEventListener!="undefined"&&(typeof document.hidden!="undefined"?(n="visibilitychange",e="hidden"):typeof document.mozHidden!="undefined"?(n="mozvisibilitychange",e="mozHidden"):typeof document.msHidden!="undefined"?(n="msvisibilitychange",e="msHidden"):typeof document.webkitHidden!="undefined"&&(n="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,n&&document.addEventListener(n,()=>{const s=!document[e];s!==this.visible_&&(this.visible_=s,this.trigger("visible",s))},!1)}static getInstance(){return new Sy}getInitialEvent(e){return O(e==="visible","Unknown event type: "+e),[this.visible_]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vc=1e3,hH=60*5*1e3,UI=30*1e3,dH=1.3,fH=3e4,pH="server_kill",$I=3;class rr extends nk{constructor(e,n,s,r,i,o,a,c){if(super(),this.repoInfo_=e,this.applicationId_=n,this.onDataUpdate_=s,this.onConnectStatus_=r,this.onServerInfoUpdate_=i,this.authTokenProvider_=o,this.appCheckTokenProvider_=a,this.authOverride_=c,this.id=rr.nextPersistentConnectionId_++,this.log_=vu("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=vc,this.maxReconnectDelay_=hH,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,c&&!D0())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");Sy.getInstance().on("visible",this.onVisible_,this),e.host.indexOf("fblocal")===-1&&id.getInstance().on("online",this.onOnline_,this)}sendRequest(e,n,s){const r=++this.requestNumber_,i={r,a:e,b:n};this.log_(_t(i)),O(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(i),s&&(this.requestCBHash_[r]=s)}get(e){this.initConnection_();const n=new mt,s={p:e._path.toString(),q:e._queryObject},r={action:"g",request:s,onComplete:o=>{const a=o.d;o.s==="ok"?n.resolve(a):n.reject(a)}};this.outstandingGets_.push(r),this.outstandingGetCount_++;const i=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(i),n.promise}listen(e,n,s,r){this.initConnection_();const i=e._queryIdentifier,o=e._path.toString();this.log_("Listen called for "+o+" "+i),this.listens.has(o)||this.listens.set(o,new Map),O(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"listen() called for non-default but complete query"),O(!this.listens.get(o).has(i),"listen() called twice for same path/queryId.");const a={onComplete:r,hashFn:n,query:e,tag:s};this.listens.get(o).set(i,a),this.connected_&&this.sendListen_(a)}sendGet_(e){const n=this.outstandingGets_[e];this.sendRequest("g",n.request,s=>{delete this.outstandingGets_[e],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),n.onComplete&&n.onComplete(s)})}sendListen_(e){const n=e.query,s=n._path.toString(),r=n._queryIdentifier;this.log_("Listen on "+s+" for "+r);const i={p:s},o="q";e.tag&&(i.q=n._queryObject,i.t=e.tag),i.h=e.hashFn(),this.sendRequest(o,i,a=>{const c=a.d,l=a.s;rr.warnOnListenWarnings_(c,n),(this.listens.get(s)&&this.listens.get(s).get(r))===e&&(this.log_("listen response",a),l!=="ok"&&this.removeListen_(s,r),e.onComplete&&e.onComplete(l,c))})}static warnOnListenWarnings_(e,n){if(e&&typeof e=="object"&&xn(e,"w")){const s=Yi(e,"w");if(Array.isArray(s)&&~s.indexOf("no_index")){const r='".indexOn": "'+n._queryParams.getIndex().toString()+'"',i=n._path.toString();Xt(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${r} at ${i} to your security rules for better performance.`)}}}refreshAuthToken(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(e)}reduceReconnectDelayIfAdminCredential_(e){(e&&e.length===40||BL(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=UI)}refreshAppCheckToken(e){this.appCheckToken_=e,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){const e=this.authToken_,n=VL(e)?"auth":"gauth",s={cred:e};this.authOverride_===null?s.noauth=!0:typeof this.authOverride_=="object"&&(s.authvar=this.authOverride_),this.sendRequest(n,s,r=>{const i=r.s,o=r.d||"error";this.authToken_===e&&(i==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(i,o))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},e=>{const n=e.s,s=e.d||"error";n==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(n,s)})}unlisten(e,n){const s=e._path.toString(),r=e._queryIdentifier;this.log_("Unlisten called for "+s+" "+r),O(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(s,r)&&this.connected_&&this.sendUnlisten_(s,r,e._queryObject,n)}sendUnlisten_(e,n,s,r){this.log_("Unlisten on "+e+" for "+n);const i={p:e},o="n";r&&(i.q=s,i.t=r),this.sendRequest(o,i)}onDisconnectPut(e,n,s){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",e,n,s):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:n,onComplete:s})}onDisconnectMerge(e,n,s){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",e,n,s):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:n,onComplete:s})}onDisconnectCancel(e,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",e,null,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:n})}sendOnDisconnect_(e,n,s,r){const i={p:n,d:s};this.log_("onDisconnect "+e,i),this.sendRequest(e,i,o=>{r&&setTimeout(()=>{r(o.s,o.d)},Math.floor(0))})}put(e,n,s,r){this.putInternal("p",e,n,s,r)}merge(e,n,s,r){this.putInternal("m",e,n,s,r)}putInternal(e,n,s,r,i){this.initConnection_();const o={p:n,d:s};i!==void 0&&(o.h=i),this.outstandingPuts_.push({action:e,request:o,onComplete:r}),this.outstandingPutCount_++;const a=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(a):this.log_("Buffering put: "+n)}sendPut_(e){const n=this.outstandingPuts_[e].action,s=this.outstandingPuts_[e].request,r=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(n,s,i=>{this.log_(n+" response",i),delete this.outstandingPuts_[e],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),r&&r(i.s,i.d)})}reportStats(e){if(this.connected_){const n={c:e};this.log_("reportStats",n),this.sendRequest("s",n,s=>{if(s.s!=="ok"){const i=s.d;this.log_("reportStats","Error sending stats: "+i)}})}}onDataMessage_(e){if("r"in e){this.log_("from server: "+_t(e));const n=e.r,s=this.requestCBHash_[n];s&&(delete this.requestCBHash_[n],s(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}}onDataPush_(e,n){this.log_("handleServerMessage",e,n),e==="d"?this.onDataUpdate_(n.p,n.d,!1,n.t):e==="m"?this.onDataUpdate_(n.p,n.d,!0,n.t):e==="c"?this.onListenRevoked_(n.p,n.q):e==="ac"?this.onAuthRevoked_(n.s,n.d):e==="apc"?this.onAppCheckRevoked_(n.s,n.d):e==="sd"?this.onSecurityDebugPacket_(n):fm("Unrecognized action received from server: "+_t(e)+`
Are you using the latest client?`)}onReady_(e,n){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(e),this.lastSessionId=n,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(e){O(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(e))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=vc,this.realtime_||this.scheduleConnect_(0)),this.visible_=e}onOnline_(e){e?(this.log_("Browser went online."),this.reconnectDelay_=vc,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>fH&&(this.reconnectDelay_=vc),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());const e=new Date().getTime()-this.lastConnectionAttemptTime_;let n=Math.max(0,this.reconnectDelay_-e);n=Math.random()*n,this.log_("Trying to reconnect in "+n+"ms"),this.scheduleConnect_(n),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*dH)}this.onConnectStatus_(!1)}async establishConnection_(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;const e=this.onDataMessage_.bind(this),n=this.onReady_.bind(this),s=this.onRealtimeDisconnect_.bind(this),r=this.id+":"+rr.nextConnectionId_++,i=this.lastSessionId;let o=!1,a=null;const c=function(){a?a.close():(o=!0,s())},l=function(h){O(a,"sendRequest call when we're not connected not allowed."),a.sendRequest(h)};this.realtime_={close:c,sendRequest:l};const u=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{const[h,d]=await Promise.all([this.authTokenProvider_.getToken(u),this.appCheckTokenProvider_.getToken(u)]);o?Ct("getToken() completed but was canceled"):(Ct("getToken() completed. Creating connection."),this.authToken_=h&&h.accessToken,this.appCheckToken_=d&&d.token,a=new iH(r,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,e,n,s,f=>{Xt(f+" ("+this.repoInfo_.toString()+")"),this.interrupt(pH)},i))}catch(h){this.log_("Failed to get token: "+h),o||(this.repoInfo_.nodeAdmin&&Xt(h),c())}}}interrupt(e){Ct("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(e){Ct("Resuming connection for reason: "+e),delete this.interruptReasons_[e],Kh(this.interruptReasons_)&&(this.reconnectDelay_=vc,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(e){const n=e-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:n})}cancelSentTransactions_(){for(let e=0;e<this.outstandingPuts_.length;e++){const n=this.outstandingPuts_[e];n&&"h"in n.request&&n.queued&&(n.onComplete&&n.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(e,n){let s;n?s=n.map(i=>yy(i)).join("$"):s="default";const r=this.removeListen_(e,s);r&&r.onComplete&&r.onComplete("permission_denied")}removeListen_(e,n){const s=new Ae(e).toString();let r;if(this.listens.has(s)){const i=this.listens.get(s);r=i.get(n),i.delete(n),i.size===0&&this.listens.delete(s)}else r=void 0;return r}onAuthRevoked_(e,n){Ct("Auth token revoked: "+e+"/"+n),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(e==="invalid_token"||e==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=$I&&(this.reconnectDelay_=UI,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(e,n){Ct("App check token revoked: "+e+"/"+n),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(e==="invalid_token"||e==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=$I&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const e of this.listens.values())for(const n of e.values())this.sendListen_(n);for(let e=0;e<this.outstandingPuts_.length;e++)this.outstandingPuts_[e]&&this.sendPut_(e);for(;this.onDisconnectRequestQueue_.length;){const e=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(e.action,e.pathString,e.data,e.onComplete)}for(let e=0;e<this.outstandingGets_.length;e++)this.outstandingGets_[e]&&this.sendGet_(e)}sendConnectStats_(){const e={};let n="js";e["sdk."+n+"."+PA.replace(/\./g,"-")]=1,of()?e["framework.cordova"]=1:hu()&&(e["framework.reactnative"]=1),this.reportStats(e)}shouldReconnect_(){const e=id.getInstance().currentlyOnline();return Kh(this.interruptReasons_)&&e}}rr.nextPersistentConnectionId_=0;rr.nextConnectionId_=0;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class me{constructor(e,n){this.name=e,this.node=n}static Wrap(e,n){return new me(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sf{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,n){const s=new me(lr,e),r=new me(lr,n);return this.compare(s,r)!==0}minPost(){return me.MIN}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let sh;class ok extends Sf{static get __EMPTY_NODE(){return sh}static set __EMPTY_NODE(e){sh=e}compare(e,n){return Ao(e.name,n.name)}isDefinedOn(e){throw Ha("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,n){return!1}minPost(){return me.MIN}maxPost(){return new me(Fs,sh)}makePost(e,n){return O(typeof e=="string","KeyIndex indexValue must always be a string."),new me(e,sh)}toString(){return".key"}}const Rs=new ok;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rh{constructor(e,n,s,r,i=null){this.isReverse_=r,this.resultGenerator_=i,this.nodeStack_=[];let o=1;for(;!e.isEmpty();)if(e=e,o=n?s(e.key,n):1,r&&(o*=-1),o<0)this.isReverse_?e=e.left:e=e.right;else if(o===0){this.nodeStack_.push(e);break}else this.nodeStack_.push(e),this.isReverse_?e=e.right:e=e.left}getNext(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_.pop(),n;if(this.resultGenerator_?n=this.resultGenerator_(e.key,e.value):n={key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return n}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;const e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}}class Tt{constructor(e,n,s,r,i){this.key=e,this.value=n,this.color=s!=null?s:Tt.RED,this.left=r!=null?r:yn.EMPTY_NODE,this.right=i!=null?i:yn.EMPTY_NODE}copy(e,n,s,r,i){return new Tt(e!=null?e:this.key,n!=null?n:this.value,s!=null?s:this.color,r!=null?r:this.left,i!=null?i:this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,s){let r=this;const i=s(e,r.key);return i<0?r=r.copy(null,null,null,r.left.insert(e,n,s),null):i===0?r=r.copy(null,n,null,null,null):r=r.copy(null,null,null,null,r.right.insert(e,n,s)),r.fixUp_()}removeMin_(){if(this.left.isEmpty())return yn.EMPTY_NODE;let e=this;return!e.left.isRed_()&&!e.left.left.isRed_()&&(e=e.moveRedLeft_()),e=e.copy(null,null,null,e.left.removeMin_(),null),e.fixUp_()}remove(e,n){let s,r;if(s=this,n(e,s.key)<0)!s.left.isEmpty()&&!s.left.isRed_()&&!s.left.left.isRed_()&&(s=s.moveRedLeft_()),s=s.copy(null,null,null,s.left.remove(e,n),null);else{if(s.left.isRed_()&&(s=s.rotateRight_()),!s.right.isEmpty()&&!s.right.isRed_()&&!s.right.left.isRed_()&&(s=s.moveRedRight_()),n(e,s.key)===0){if(s.right.isEmpty())return yn.EMPTY_NODE;r=s.right.min_(),s=s.copy(r.key,r.value,null,null,s.right.removeMin_())}s=s.copy(null,null,null,null,s.right.remove(e,n))}return s.fixUp_()}isRed_(){return this.color}fixUp_(){let e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e}moveRedLeft_(){let e=this.colorFlip_();return e.right.left.isRed_()&&(e=e.copy(null,null,null,null,e.right.rotateRight_()),e=e.rotateLeft_(),e=e.colorFlip_()),e}moveRedRight_(){let e=this.colorFlip_();return e.left.left.isRed_()&&(e=e.rotateRight_(),e=e.colorFlip_()),e}rotateLeft_(){const e=this.copy(null,null,Tt.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight_(){const e=this.copy(null,null,Tt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip_(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth_(){const e=this.check_();return Math.pow(2,e)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)}}Tt.RED=!0;Tt.BLACK=!1;class gH{copy(e,n,s,r,i){return this}insert(e,n,s){return new Tt(e,n,null)}remove(e,n){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}}class yn{constructor(e,n=yn.EMPTY_NODE){this.comparator_=e,this.root_=n}insert(e,n){return new yn(this.comparator_,this.root_.insert(e,n,this.comparator_).copy(null,null,Tt.BLACK,null,null))}remove(e){return new yn(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,Tt.BLACK,null,null))}get(e){let n,s=this.root_;for(;!s.isEmpty();){if(n=this.comparator_(e,s.key),n===0)return s.value;n<0?s=s.left:n>0&&(s=s.right)}return null}getPredecessorKey(e){let n,s=this.root_,r=null;for(;!s.isEmpty();)if(n=this.comparator_(e,s.key),n===0){if(s.left.isEmpty())return r?r.key:null;for(s=s.left;!s.right.isEmpty();)s=s.right;return s.key}else n<0?s=s.left:n>0&&(r=s,s=s.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new rh(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,n){return new rh(this.root_,e,this.comparator_,!1,n)}getReverseIteratorFrom(e,n){return new rh(this.root_,e,this.comparator_,!0,n)}getReverseIterator(e){return new rh(this.root_,null,this.comparator_,!0,e)}}yn.EMPTY_NODE=new gH;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mH(t,e){return Ao(t.name,e.name)}function Cy(t,e){return Ao(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let gm;function _H(t){gm=t}const ak=function(t){return typeof t=="number"?"number:"+UA(t):"string:"+t},ck=function(t){if(t.isLeafNode()){const e=t.val();O(typeof e=="string"||typeof e=="number"||typeof e=="object"&&xn(e,".sv"),"Priority must be a string or number.")}else O(t===gm||t.isEmpty(),"priority of unexpected type.");O(t===gm||t.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let VI;class bt{constructor(e,n=bt.__childrenNodeConstructor.EMPTY_NODE){this.value_=e,this.priorityNode_=n,this.lazyHash_=null,O(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),ck(this.priorityNode_)}static set __childrenNodeConstructor(e){VI=e}static get __childrenNodeConstructor(){return VI}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(e){return new bt(this.value_,e)}getImmediateChild(e){return e===".priority"?this.priorityNode_:bt.__childrenNodeConstructor.EMPTY_NODE}getChild(e){return ge(e)?this:pe(e)===".priority"?this.priorityNode_:bt.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(e,n){return null}updateImmediateChild(e,n){return e===".priority"?this.updatePriority(n):n.isEmpty()&&e!==".priority"?this:bt.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,n).updatePriority(this.priorityNode_)}updateChild(e,n){const s=pe(e);return s===null?n:n.isEmpty()&&s!==".priority"?this:(O(s!==".priority"||Jr(e)===1,".priority must be the last token in a path"),this.updateImmediateChild(s,bt.__childrenNodeConstructor.EMPTY_NODE.updateChild(Le(e),n)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(e,n){return!1}val(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let e="";this.priorityNode_.isEmpty()||(e+="priority:"+ak(this.priorityNode_.val())+":");const n=typeof this.value_;e+=n+":",n==="number"?e+=UA(this.value_):e+=this.value_,this.lazyHash_=MA(e)}return this.lazyHash_}getValue(){return this.value_}compareTo(e){return e===bt.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof bt.__childrenNodeConstructor?-1:(O(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))}compareToLeafNode_(e){const n=typeof e.value_,s=typeof this.value_,r=bt.VALUE_TYPE_ORDER.indexOf(n),i=bt.VALUE_TYPE_ORDER.indexOf(s);return O(r>=0,"Unknown leaf type: "+n),O(i>=0,"Unknown leaf type: "+s),r===i?s==="object"?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:i-r}withIndex(){return this}isIndexed(){return!0}equals(e){if(e===this)return!0;if(e.isLeafNode()){const n=e;return this.value_===n.value_&&this.priorityNode_.equals(n.priorityNode_)}else return!1}}bt.VALUE_TYPE_ORDER=["object","boolean","number","string"];/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let lk,uk;function yH(t){lk=t}function vH(t){uk=t}class wH extends Sf{compare(e,n){const s=e.node.getPriority(),r=n.node.getPriority(),i=s.compareTo(r);return i===0?Ao(e.name,n.name):i}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,n){return!e.getPriority().equals(n.getPriority())}minPost(){return me.MIN}maxPost(){return new me(Fs,new bt("[PRIORITY-POST]",uk))}makePost(e,n){const s=lk(e);return new me(n,new bt("[PRIORITY-POST]",s))}toString(){return".priority"}}const je=new wH;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bH=Math.log(2);class IH{constructor(e){const n=i=>parseInt(Math.log(i)/bH,10),s=i=>parseInt(Array(i+1).join("1"),2);this.count=n(e+1),this.current_=this.count-1;const r=s(this.count);this.bits_=e+1&r}nextBitIsOne(){const e=!(this.bits_&1<<this.current_);return this.current_--,e}}const od=function(t,e,n,s){t.sort(e);const r=function(c,l){const u=l-c;let h,d;if(u===0)return null;if(u===1)return h=t[c],d=n?n(h):h,new Tt(d,h.node,Tt.BLACK,null,null);{const f=parseInt(u/2,10)+c,p=r(c,f),_=r(f+1,l);return h=t[f],d=n?n(h):h,new Tt(d,h.node,Tt.BLACK,p,_)}},i=function(c){let l=null,u=null,h=t.length;const d=function(p,_){const y=h-p,T=h;h-=p;const I=r(y+1,T),E=t[y],S=n?n(E):E;f(new Tt(S,E.node,_,null,I))},f=function(p){l?(l.left=p,l=p):(u=p,l=p)};for(let p=0;p<c.count;++p){const _=c.nextBitIsOne(),y=Math.pow(2,c.count-(p+1));_?d(y,Tt.BLACK):(d(y,Tt.BLACK),d(y,Tt.RED))}return u},o=new IH(t.length),a=i(o);return new yn(s||e,a)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Zp;const Vo={};class Zs{constructor(e,n){this.indexes_=e,this.indexSet_=n}static get Default(){return O(Vo&&je,"ChildrenNode.ts has not been loaded"),Zp=Zp||new Zs({".priority":Vo},{".priority":je}),Zp}get(e){const n=Yi(this.indexes_,e);if(!n)throw new Error("No index defined for "+e);return n instanceof yn?n:null}hasIndex(e){return xn(this.indexSet_,e.toString())}addIndex(e,n){O(e!==Rs,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const s=[];let r=!1;const i=n.getIterator(me.Wrap);let o=i.getNext();for(;o;)r=r||e.isDefinedOn(o.node),s.push(o),o=i.getNext();let a;r?a=od(s,e.getCompare()):a=Vo;const c=e.toString(),l=Object.assign({},this.indexSet_);l[c]=e;const u=Object.assign({},this.indexes_);return u[c]=a,new Zs(u,l)}addToIndexes(e,n){const s=Hh(this.indexes_,(r,i)=>{const o=Yi(this.indexSet_,i);if(O(o,"Missing index implementation for "+i),r===Vo)if(o.isDefinedOn(e.node)){const a=[],c=n.getIterator(me.Wrap);let l=c.getNext();for(;l;)l.name!==e.name&&a.push(l),l=c.getNext();return a.push(e),od(a,o.getCompare())}else return Vo;else{const a=n.get(e.name);let c=r;return a&&(c=c.remove(new me(e.name,a))),c.insert(e,e.node)}});return new Zs(s,this.indexSet_)}removeFromIndexes(e,n){const s=Hh(this.indexes_,r=>{if(r===Vo)return r;{const i=n.get(e.name);return i?r.remove(new me(e.name,i)):r}});return new Zs(s,this.indexSet_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let wc;class te{constructor(e,n,s){this.children_=e,this.priorityNode_=n,this.indexMap_=s,this.lazyHash_=null,this.priorityNode_&&ck(this.priorityNode_),this.children_.isEmpty()&&O(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return wc||(wc=new te(new yn(Cy),null,Zs.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||wc}updatePriority(e){return this.children_.isEmpty()?this:new te(this.children_,e,this.indexMap_)}getImmediateChild(e){if(e===".priority")return this.getPriority();{const n=this.children_.get(e);return n===null?wc:n}}getChild(e){const n=pe(e);return n===null?this:this.getImmediateChild(n).getChild(Le(e))}hasChild(e){return this.children_.get(e)!==null}updateImmediateChild(e,n){if(O(n,"We should always be passing snapshot nodes"),e===".priority")return this.updatePriority(n);{const s=new me(e,n);let r,i;n.isEmpty()?(r=this.children_.remove(e),i=this.indexMap_.removeFromIndexes(s,this.children_)):(r=this.children_.insert(e,n),i=this.indexMap_.addToIndexes(s,this.children_));const o=r.isEmpty()?wc:this.priorityNode_;return new te(r,o,i)}}updateChild(e,n){const s=pe(e);if(s===null)return n;{O(pe(e)!==".priority"||Jr(e)===1,".priority must be the last token in a path");const r=this.getImmediateChild(s).updateChild(Le(e),n);return this.updateImmediateChild(s,r)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(e){if(this.isEmpty())return null;const n={};let s=0,r=0,i=!0;if(this.forEachChild(je,(o,a)=>{n[o]=a.val(e),s++,i&&te.INTEGER_REGEXP_.test(o)?r=Math.max(r,Number(o)):i=!1}),!e&&i&&r<2*s){const o=[];for(const a in n)o[a]=n[a];return o}else return e&&!this.getPriority().isEmpty()&&(n[".priority"]=this.getPriority().val()),n}hash(){if(this.lazyHash_===null){let e="";this.getPriority().isEmpty()||(e+="priority:"+ak(this.getPriority().val())+":"),this.forEachChild(je,(n,s)=>{const r=s.hash();r!==""&&(e+=":"+n+":"+r)}),this.lazyHash_=e===""?"":MA(e)}return this.lazyHash_}getPredecessorChildName(e,n,s){const r=this.resolveIndex_(s);if(r){const i=r.getPredecessorKey(new me(e,n));return i?i.name:null}else return this.children_.getPredecessorKey(e)}getFirstChildName(e){const n=this.resolveIndex_(e);if(n){const s=n.minKey();return s&&s.name}else return this.children_.minKey()}getFirstChild(e){const n=this.getFirstChildName(e);return n?new me(n,this.children_.get(n)):null}getLastChildName(e){const n=this.resolveIndex_(e);if(n){const s=n.maxKey();return s&&s.name}else return this.children_.maxKey()}getLastChild(e){const n=this.getLastChildName(e);return n?new me(n,this.children_.get(n)):null}forEachChild(e,n){const s=this.resolveIndex_(e);return s?s.inorderTraversal(r=>n(r.name,r.node)):this.children_.inorderTraversal(n)}getIterator(e){return this.getIteratorFrom(e.minPost(),e)}getIteratorFrom(e,n){const s=this.resolveIndex_(n);if(s)return s.getIteratorFrom(e,r=>r);{const r=this.children_.getIteratorFrom(e.name,me.Wrap);let i=r.peek();for(;i!=null&&n.compare(i,e)<0;)r.getNext(),i=r.peek();return r}}getReverseIterator(e){return this.getReverseIteratorFrom(e.maxPost(),e)}getReverseIteratorFrom(e,n){const s=this.resolveIndex_(n);if(s)return s.getReverseIteratorFrom(e,r=>r);{const r=this.children_.getReverseIteratorFrom(e.name,me.Wrap);let i=r.peek();for(;i!=null&&n.compare(i,e)>0;)r.getNext(),i=r.peek();return r}}compareTo(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===wu?-1:0}withIndex(e){if(e===Rs||this.indexMap_.hasIndex(e))return this;{const n=this.indexMap_.addIndex(e,this.children_);return new te(this.children_,this.priorityNode_,n)}}isIndexed(e){return e===Rs||this.indexMap_.hasIndex(e)}equals(e){if(e===this)return!0;if(e.isLeafNode())return!1;{const n=e;if(this.getPriority().equals(n.getPriority()))if(this.children_.count()===n.children_.count()){const s=this.getIterator(je),r=n.getIterator(je);let i=s.getNext(),o=r.getNext();for(;i&&o;){if(i.name!==o.name||!i.node.equals(o.node))return!1;i=s.getNext(),o=r.getNext()}return i===null&&o===null}else return!1;else return!1}}resolveIndex_(e){return e===Rs?null:this.indexMap_.get(e.toString())}}te.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;class EH extends te{constructor(){super(new yn(Cy),te.EMPTY_NODE,Zs.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return te.EMPTY_NODE}isEmpty(){return!1}}const wu=new EH;Object.defineProperties(me,{MIN:{value:new me(lr,te.EMPTY_NODE)},MAX:{value:new me(Fs,wu)}});ok.__EMPTY_NODE=te.EMPTY_NODE;bt.__childrenNodeConstructor=te;_H(wu);vH(wu);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TH=!0;function Je(t,e=null){if(t===null)return te.EMPTY_NODE;if(typeof t=="object"&&".priority"in t&&(e=t[".priority"]),O(e===null||typeof e=="string"||typeof e=="number"||typeof e=="object"&&".sv"in e,"Invalid priority type found: "+typeof e),typeof t=="object"&&".value"in t&&t[".value"]!==null&&(t=t[".value"]),typeof t!="object"||".sv"in t){const n=t;return new bt(n,Je(e))}if(!(t instanceof Array)&&TH){const n=[];let s=!1;if(xt(t,(o,a)=>{if(o.substring(0,1)!=="."){const c=Je(a);c.isEmpty()||(s=s||!c.getPriority().isEmpty(),n.push(new me(o,c)))}}),n.length===0)return te.EMPTY_NODE;const i=od(n,mH,o=>o.name,Cy);if(s){const o=od(n,je.getCompare());return new te(i,Je(e),new Zs({".priority":o},{".priority":je}))}else return new te(i,Je(e),Zs.Default)}else{let n=te.EMPTY_NODE;return xt(t,(s,r)=>{if(xn(t,s)&&s.substring(0,1)!=="."){const i=Je(r);(i.isLeafNode()||!i.isEmpty())&&(n=n.updateImmediateChild(s,i))}}),n.updatePriority(Je(e))}}yH(Je);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ay extends Sf{constructor(e){super(),this.indexPath_=e,O(!ge(e)&&pe(e)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,n){const s=this.extractChild(e.node),r=this.extractChild(n.node),i=s.compareTo(r);return i===0?Ao(e.name,n.name):i}makePost(e,n){const s=Je(e),r=te.EMPTY_NODE.updateChild(this.indexPath_,s);return new me(n,r)}maxPost(){const e=te.EMPTY_NODE.updateChild(this.indexPath_,wu);return new me(Fs,e)}toString(){return Dl(this.indexPath_,0).join("/")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SH extends Sf{compare(e,n){const s=e.node.compareTo(n.node);return s===0?Ao(e.name,n.name):s}isDefinedOn(e){return!0}indexedValueChanged(e,n){return!e.equals(n)}minPost(){return me.MIN}maxPost(){return me.MAX}makePost(e,n){const s=Je(e);return new me(n,s)}toString(){return".value"}}const ky=new SH;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sa="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",mm="-",hk="z",dk=786,CH=function(){let t=0;const e=[];return function(n){const s=n===t;t=n;let r;const i=new Array(8);for(r=7;r>=0;r--)i[r]=Sa.charAt(n%64),n=Math.floor(n/64);O(n===0,"Cannot push at time == 0");let o=i.join("");if(s){for(r=11;r>=0&&e[r]===63;r--)e[r]=0;e[r]++}else for(r=0;r<12;r++)e[r]=Math.floor(Math.random()*64);for(r=0;r<12;r++)o+=Sa.charAt(e[r]);return O(o.length===20,"nextPushId: Length should be 20."),o}}(),BI=function(t){if(t===""+vy)return mm;const e=sd(t);if(e!=null)return""+(e+1);const n=new Array(t.length);for(let o=0;o<n.length;o++)n[o]=t.charAt(o);if(n.length<dk)return n.push(mm),n.join("");let s=n.length-1;for(;s>=0&&n[s]===hk;)s--;if(s===-1)return Fs;const r=n[s],i=Sa.charAt(Sa.indexOf(r)+1);return n[s]=i,n.slice(0,s+1).join("")},qI=function(t){if(t===""+$A)return lr;const e=sd(t);if(e!=null)return""+(e-1);const n=new Array(t.length);for(let s=0;s<n.length;s++)n[s]=t.charAt(s);return n[n.length-1]===mm?n.length===1?""+vy:(delete n[n.length-1],n.join("")):(n[n.length-1]=Sa.charAt(Sa.indexOf(n[n.length-1])-1),n.join("")+hk.repeat(dk-n.length))};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fk(t){return{type:"value",snapshotNode:t}}function Ca(t,e){return{type:"child_added",snapshotNode:e,childName:t}}function xl(t,e){return{type:"child_removed",snapshotNode:e,childName:t}}function Ol(t,e,n){return{type:"child_changed",snapshotNode:e,childName:t,oldSnap:n}}function AH(t,e){return{type:"child_moved",snapshotNode:e,childName:t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ry{constructor(e){this.index_=e}updateChild(e,n,s,r,i,o){O(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");const a=e.getImmediateChild(n);return a.getChild(r).equals(s.getChild(r))&&a.isEmpty()===s.isEmpty()||(o!=null&&(s.isEmpty()?e.hasChild(n)?o.trackChildChange(xl(n,a)):O(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):a.isEmpty()?o.trackChildChange(Ca(n,s)):o.trackChildChange(Ol(n,s,a))),e.isLeafNode()&&s.isEmpty())?e:e.updateImmediateChild(n,s).withIndex(this.index_)}updateFullNode(e,n,s){return s!=null&&(e.isLeafNode()||e.forEachChild(je,(r,i)=>{n.hasChild(r)||s.trackChildChange(xl(r,i))}),n.isLeafNode()||n.forEachChild(je,(r,i)=>{if(e.hasChild(r)){const o=e.getImmediateChild(r);o.equals(i)||s.trackChildChange(Ol(r,i,o))}else s.trackChildChange(Ca(r,i))})),n.withIndex(this.index_)}updatePriority(e,n){return e.isEmpty()?te.EMPTY_NODE:e.updatePriority(n)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ml{constructor(e){this.indexedFilter_=new Ry(e.getIndex()),this.index_=e.getIndex(),this.startPost_=Ml.getStartPost_(e),this.endPost_=Ml.getEndPost_(e)}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){return this.index_.compare(this.getStartPost(),e)<=0&&this.index_.compare(e,this.getEndPost())<=0}updateChild(e,n,s,r,i,o){return this.matches(new me(n,s))||(s=te.EMPTY_NODE),this.indexedFilter_.updateChild(e,n,s,r,i,o)}updateFullNode(e,n,s){n.isLeafNode()&&(n=te.EMPTY_NODE);let r=n.withIndex(this.index_);r=r.updatePriority(te.EMPTY_NODE);const i=this;return n.forEachChild(je,(o,a)=>{i.matches(new me(o,a))||(r=r.updateImmediateChild(o,te.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,r,s)}updatePriority(e,n){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){const n=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),n)}else return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){const n=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),n)}else return e.getIndex().maxPost()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kH{constructor(e){this.rangedFilter_=new Ml(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft()}updateChild(e,n,s,r,i,o){return this.rangedFilter_.matches(new me(n,s))||(s=te.EMPTY_NODE),e.getImmediateChild(n).equals(s)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,n,s,r,i,o):this.fullLimitUpdateChild_(e,n,s,i,o)}updateFullNode(e,n,s){let r;if(n.isLeafNode()||n.isEmpty())r=te.EMPTY_NODE.withIndex(this.index_);else if(this.limit_*2<n.numChildren()&&n.isIndexed(this.index_)){r=te.EMPTY_NODE.withIndex(this.index_);let i;this.reverse_?i=n.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):i=n.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let o=0;for(;i.hasNext()&&o<this.limit_;){const a=i.getNext();let c;if(this.reverse_?c=this.index_.compare(this.rangedFilter_.getStartPost(),a)<=0:c=this.index_.compare(a,this.rangedFilter_.getEndPost())<=0,c)r=r.updateImmediateChild(a.name,a.node),o++;else break}}else{r=n.withIndex(this.index_),r=r.updatePriority(te.EMPTY_NODE);let i,o,a,c;if(this.reverse_){c=r.getReverseIterator(this.index_),i=this.rangedFilter_.getEndPost(),o=this.rangedFilter_.getStartPost();const h=this.index_.getCompare();a=(d,f)=>h(f,d)}else c=r.getIterator(this.index_),i=this.rangedFilter_.getStartPost(),o=this.rangedFilter_.getEndPost(),a=this.index_.getCompare();let l=0,u=!1;for(;c.hasNext();){const h=c.getNext();!u&&a(i,h)<=0&&(u=!0),u&&l<this.limit_&&a(h,o)<=0?l++:r=r.updateImmediateChild(h.name,te.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,r,s)}updatePriority(e,n){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,n,s,r,i){let o;if(this.reverse_){const h=this.index_.getCompare();o=(d,f)=>h(f,d)}else o=this.index_.getCompare();const a=e;O(a.numChildren()===this.limit_,"");const c=new me(n,s),l=this.reverse_?a.getFirstChild(this.index_):a.getLastChild(this.index_),u=this.rangedFilter_.matches(c);if(a.hasChild(n)){const h=a.getImmediateChild(n);let d=r.getChildAfterChild(this.index_,l,this.reverse_);for(;d!=null&&(d.name===n||a.hasChild(d.name));)d=r.getChildAfterChild(this.index_,d,this.reverse_);const f=d==null?1:o(d,c);if(u&&!s.isEmpty()&&f>=0)return i!=null&&i.trackChildChange(Ol(n,s,h)),a.updateImmediateChild(n,s);{i!=null&&i.trackChildChange(xl(n,h));const _=a.updateImmediateChild(n,te.EMPTY_NODE);return d!=null&&this.rangedFilter_.matches(d)?(i!=null&&i.trackChildChange(Ca(d.name,d.node)),_.updateImmediateChild(d.name,d.node)):_}}else return s.isEmpty()?e:u&&o(l,c)>=0?(i!=null&&(i.trackChildChange(xl(l.name,l.node)),i.trackChildChange(Ca(n,s))),a.updateImmediateChild(n,s).updateImmediateChild(l.name,te.EMPTY_NODE)):e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cf{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=je}hasStart(){return this.startSet_}hasStartAfter(){return this.startAfterSet_}hasEndBefore(){return this.endBeforeSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return O(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return O(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:lr}hasEnd(){return this.endSet_}getIndexEndValue(){return O(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return O(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:Fs}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return O(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===je}copy(){const e=new Cf;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}}function RH(t){return t.loadsAllData()?new Ry(t.getIndex()):t.hasLimit()?new kH(t):new Ml(t)}function NH(t,e){const n=t.copy();return n.limitSet_=!0,n.limit_=e,n.viewFrom_="l",n}function PH(t,e){const n=t.copy();return n.limitSet_=!0,n.limit_=e,n.viewFrom_="r",n}function _m(t,e,n){const s=t.copy();return s.startSet_=!0,e===void 0&&(e=null),s.indexStartValue_=e,n!=null?(s.startNameSet_=!0,s.indexStartName_=n):(s.startNameSet_=!1,s.indexStartName_=""),s}function DH(t,e,n){let s;if(t.index_===Rs)typeof e=="string"&&(e=BI(e)),s=_m(t,e,n);else{let r;n==null?r=Fs:r=BI(n),s=_m(t,e,r)}return s.startAfterSet_=!0,s}function ym(t,e,n){const s=t.copy();return s.endSet_=!0,e===void 0&&(e=null),s.indexEndValue_=e,n!==void 0?(s.endNameSet_=!0,s.indexEndName_=n):(s.endNameSet_=!1,s.indexEndName_=""),s}function xH(t,e,n){let s,r;return t.index_===Rs?(typeof e=="string"&&(e=qI(e)),r=ym(t,e,n)):(n==null?s=lr:s=qI(n),r=ym(t,e,s)),r.endBeforeSet_=!0,r}function Af(t,e){const n=t.copy();return n.index_=e,n}function jI(t){const e={};if(t.isDefault())return e;let n;return t.index_===je?n="$priority":t.index_===ky?n="$value":t.index_===Rs?n="$key":(O(t.index_ instanceof Ay,"Unrecognized index type!"),n=t.index_.toString()),e.orderBy=_t(n),t.startSet_&&(e.startAt=_t(t.indexStartValue_),t.startNameSet_&&(e.startAt+=","+_t(t.indexStartName_))),t.endSet_&&(e.endAt=_t(t.indexEndValue_),t.endNameSet_&&(e.endAt+=","+_t(t.indexEndName_))),t.limitSet_&&(t.isViewFromLeft()?e.limitToFirst=t.limit_:e.limitToLast=t.limit_),e}function KI(t){const e={};if(t.startSet_&&(e.sp=t.indexStartValue_,t.startNameSet_&&(e.sn=t.indexStartName_)),t.endSet_&&(e.ep=t.indexEndValue_,t.endNameSet_&&(e.en=t.indexEndName_)),t.limitSet_){e.l=t.limit_;let n=t.viewFrom_;n===""&&(t.isViewFromLeft()?n="l":n="r"),e.vf=n}return t.index_!==je&&(e.i=t.index_.toString()),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ad extends nk{constructor(e,n,s,r){super(),this.repoInfo_=e,this.onDataUpdate_=n,this.authTokenProvider_=s,this.appCheckTokenProvider_=r,this.log_=vu("p:rest:"),this.listens_={}}reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,n){return n!==void 0?"tag$"+n:(O(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}listen(e,n,s,r){const i=e._path.toString();this.log_("Listen called for "+i+" "+e._queryIdentifier);const o=ad.getListenId_(e,s),a={};this.listens_[o]=a;const c=jI(e._queryParams);this.restRequest_(i+".json",c,(l,u)=>{let h=u;if(l===404&&(h=null,l=null),l===null&&this.onDataUpdate_(i,h,!1,s),Yi(this.listens_,o)===a){let d;l?l===401?d="permission_denied":d="rest_error:"+l:d="ok",r(d,null)}})}unlisten(e,n){const s=ad.getListenId_(e,n);delete this.listens_[s]}get(e){const n=jI(e._queryParams),s=e._path.toString(),r=new mt;return this.restRequest_(s+".json",n,(i,o)=>{let a=o;i===404&&(a=null,i=null),i===null?(this.onDataUpdate_(s,a,!1,null),r.resolve(a)):r.reject(new Error(a))}),r.promise}refreshAuthToken(e){}restRequest_(e,n={},s){return n.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([r,i])=>{r&&r.accessToken&&(n.auth=r.accessToken),i&&i.token&&(n.ac=i.token);const o=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+To(n);this.log_("Sending REST request for "+o);const a=new XMLHttpRequest;a.onreadystatechange=()=>{if(s&&a.readyState===4){this.log_("REST Response for "+o+" received. status:",a.status,"response:",a.responseText);let c=null;if(a.status>=200&&a.status<300){try{c=wl(a.responseText)}catch{Xt("Failed to parse JSON response for "+o+": "+a.responseText)}s(null,c)}else a.status!==401&&a.status!==404&&Xt("Got unsuccessful REST response for "+o+" Status: "+a.status),s(a.status);s=null}},a.open("GET",o,!0),a.send()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OH{constructor(){this.rootNode_=te.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,n){this.rootNode_=this.rootNode_.updateChild(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cd(){return{value:null,children:new Map}}function Xa(t,e,n){if(ge(e))t.value=n,t.children.clear();else if(t.value!==null)t.value=t.value.updateChild(e,n);else{const s=pe(e);t.children.has(s)||t.children.set(s,cd());const r=t.children.get(s);e=Le(e),Xa(r,e,n)}}function vm(t,e){if(ge(e))return t.value=null,t.children.clear(),!0;if(t.value!==null){if(t.value.isLeafNode())return!1;{const n=t.value;return t.value=null,n.forEachChild(je,(s,r)=>{Xa(t,new Ae(s),r)}),vm(t,e)}}else if(t.children.size>0){const n=pe(e);return e=Le(e),t.children.has(n)&&vm(t.children.get(n),e)&&t.children.delete(n),t.children.size===0}else return!0}function wm(t,e,n){t.value!==null?n(e,t.value):MH(t,(s,r)=>{const i=new Ae(e.toString()+"/"+s);wm(r,i,n)})}function MH(t,e){t.children.forEach((n,s)=>{e(s,n)})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LH{constructor(e){this.collection_=e,this.last_=null}get(){const e=this.collection_.get(),n=Object.assign({},e);return this.last_&&xt(this.last_,(s,r)=>{n[s]=n[s]-r}),this.last_=e,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HI=10*1e3,FH=30*1e3,UH=5*60*1e3;class $H{constructor(e,n){this.server_=n,this.statsToReport_={},this.statsListener_=new LH(e);const s=HI+(FH-HI)*Math.random();Qc(this.reportStats_.bind(this),Math.floor(s))}reportStats_(){const e=this.statsListener_.get(),n={};let s=!1;xt(e,(r,i)=>{i>0&&xn(this.statsToReport_,r)&&(n[r]=i,s=!0)}),s&&this.server_.reportStats(n),Qc(this.reportStats_.bind(this),Math.floor(Math.random()*2*UH))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var is;(function(t){t[t.OVERWRITE=0]="OVERWRITE",t[t.MERGE=1]="MERGE",t[t.ACK_USER_WRITE=2]="ACK_USER_WRITE",t[t.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"})(is||(is={}));function Ny(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function Py(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function Dy(t){return{fromUser:!1,fromServer:!0,queryId:t,tagged:!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ld{constructor(e,n,s){this.path=e,this.affectedTree=n,this.revert=s,this.type=is.ACK_USER_WRITE,this.source=Ny()}operationForChild(e){if(ge(this.path)){if(this.affectedTree.value!=null)return O(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const n=this.affectedTree.subtree(new Ae(e));return new ld(Te(),n,this.revert)}}else return O(pe(this.path)===e,"operationForChild called for unrelated child."),new ld(Le(this.path),this.affectedTree,this.revert)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ll{constructor(e,n){this.source=e,this.path=n,this.type=is.LISTEN_COMPLETE}operationForChild(e){return ge(this.path)?new Ll(this.source,Te()):new Ll(this.source,Le(this.path))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class no{constructor(e,n,s){this.source=e,this.path=n,this.snap=s,this.type=is.OVERWRITE}operationForChild(e){return ge(this.path)?new no(this.source,Te(),this.snap.getImmediateChild(e)):new no(this.source,Le(this.path),this.snap)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Aa{constructor(e,n,s){this.source=e,this.path=n,this.children=s,this.type=is.MERGE}operationForChild(e){if(ge(this.path)){const n=this.children.subtree(new Ae(e));return n.isEmpty()?null:n.value?new no(this.source,Te(),n.value):new Aa(this.source,Te(),n)}else return O(pe(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new Aa(this.source,Le(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xr{constructor(e,n,s){this.node_=e,this.fullyInitialized_=n,this.filtered_=s}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(ge(e))return this.isFullyInitialized()&&!this.filtered_;const n=pe(e);return this.isCompleteForChild(n)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VH{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}}function BH(t,e,n,s){const r=[],i=[];return e.forEach(o=>{o.type==="child_changed"&&t.index_.indexedValueChanged(o.oldSnap,o.snapshotNode)&&i.push(AH(o.childName,o.snapshotNode))}),bc(t,r,"child_removed",e,s,n),bc(t,r,"child_added",e,s,n),bc(t,r,"child_moved",i,s,n),bc(t,r,"child_changed",e,s,n),bc(t,r,"value",e,s,n),r}function bc(t,e,n,s,r,i){const o=s.filter(a=>a.type===n);o.sort((a,c)=>jH(t,a,c)),o.forEach(a=>{const c=qH(t,a,i);r.forEach(l=>{l.respondsTo(a.type)&&e.push(l.createEvent(c,t.query_))})})}function qH(t,e,n){return e.type==="value"||e.type==="child_removed"||(e.prevName=n.getPredecessorChildName(e.childName,e.snapshotNode,t.index_)),e}function jH(t,e,n){if(e.childName==null||n.childName==null)throw Ha("Should only compare child_ events.");const s=new me(e.childName,e.snapshotNode),r=new me(n.childName,n.snapshotNode);return t.index_.compare(s,r)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kf(t,e){return{eventCache:t,serverCache:e}}function Yc(t,e,n,s){return kf(new Xr(e,n,s),t.serverCache)}function pk(t,e,n,s){return kf(t.eventCache,new Xr(e,n,s))}function ud(t){return t.eventCache.isFullyInitialized()?t.eventCache.getNode():null}function so(t){return t.serverCache.isFullyInitialized()?t.serverCache.getNode():null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let eg;const KH=()=>(eg||(eg=new yn(AK)),eg);class Ve{constructor(e,n=KH()){this.value=e,this.children=n}static fromObject(e){let n=new Ve(null);return xt(e,(s,r)=>{n=n.set(new Ae(s),r)}),n}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,n){if(this.value!=null&&n(this.value))return{path:Te(),value:this.value};if(ge(e))return null;{const s=pe(e),r=this.children.get(s);if(r!==null){const i=r.findRootMostMatchingPathAndValue(Le(e),n);return i!=null?{path:ze(new Ae(s),i.path),value:i.value}:null}else return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(ge(e))return this;{const n=pe(e),s=this.children.get(n);return s!==null?s.subtree(Le(e)):new Ve(null)}}set(e,n){if(ge(e))return new Ve(n,this.children);{const s=pe(e),i=(this.children.get(s)||new Ve(null)).set(Le(e),n),o=this.children.insert(s,i);return new Ve(this.value,o)}}remove(e){if(ge(e))return this.children.isEmpty()?new Ve(null):new Ve(null,this.children);{const n=pe(e),s=this.children.get(n);if(s){const r=s.remove(Le(e));let i;return r.isEmpty()?i=this.children.remove(n):i=this.children.insert(n,r),this.value===null&&i.isEmpty()?new Ve(null):new Ve(this.value,i)}else return this}}get(e){if(ge(e))return this.value;{const n=pe(e),s=this.children.get(n);return s?s.get(Le(e)):null}}setTree(e,n){if(ge(e))return n;{const s=pe(e),i=(this.children.get(s)||new Ve(null)).setTree(Le(e),n);let o;return i.isEmpty()?o=this.children.remove(s):o=this.children.insert(s,i),new Ve(this.value,o)}}fold(e){return this.fold_(Te(),e)}fold_(e,n){const s={};return this.children.inorderTraversal((r,i)=>{s[r]=i.fold_(ze(e,r),n)}),n(e,this.value,s)}findOnPath(e,n){return this.findOnPath_(e,Te(),n)}findOnPath_(e,n,s){const r=this.value?s(n,this.value):!1;if(r)return r;if(ge(e))return null;{const i=pe(e),o=this.children.get(i);return o?o.findOnPath_(Le(e),ze(n,i),s):null}}foreachOnPath(e,n){return this.foreachOnPath_(e,Te(),n)}foreachOnPath_(e,n,s){if(ge(e))return this;{this.value&&s(n,this.value);const r=pe(e),i=this.children.get(r);return i?i.foreachOnPath_(Le(e),ze(n,r),s):new Ve(null)}}foreach(e){this.foreach_(Te(),e)}foreach_(e,n){this.children.inorderTraversal((s,r)=>{r.foreach_(ze(e,s),n)}),this.value&&n(e,this.value)}foreachChild(e){this.children.inorderTraversal((n,s)=>{s.value&&e(n,s.value)})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class us{constructor(e){this.writeTree_=e}static empty(){return new us(new Ve(null))}}function Jc(t,e,n){if(ge(e))return new us(new Ve(n));{const s=t.writeTree_.findRootMostValueAndPath(e);if(s!=null){const r=s.path;let i=s.value;const o=un(r,e);return i=i.updateChild(o,n),new us(t.writeTree_.set(r,i))}else{const r=new Ve(n),i=t.writeTree_.setTree(e,r);return new us(i)}}}function bm(t,e,n){let s=t;return xt(n,(r,i)=>{s=Jc(s,ze(e,r),i)}),s}function WI(t,e){if(ge(e))return us.empty();{const n=t.writeTree_.setTree(e,new Ve(null));return new us(n)}}function Im(t,e){return ko(t,e)!=null}function ko(t,e){const n=t.writeTree_.findRootMostValueAndPath(e);return n!=null?t.writeTree_.get(n.path).getChild(un(n.path,e)):null}function GI(t){const e=[],n=t.writeTree_.value;return n!=null?n.isLeafNode()||n.forEachChild(je,(s,r)=>{e.push(new me(s,r))}):t.writeTree_.children.inorderTraversal((s,r)=>{r.value!=null&&e.push(new me(s,r.value))}),e}function qr(t,e){if(ge(e))return t;{const n=ko(t,e);return n!=null?new us(new Ve(n)):new us(t.writeTree_.subtree(e))}}function Em(t){return t.writeTree_.isEmpty()}function ka(t,e){return gk(Te(),t.writeTree_,e)}function gk(t,e,n){if(e.value!=null)return n.updateChild(t,e.value);{let s=null;return e.children.inorderTraversal((r,i)=>{r===".priority"?(O(i.value!==null,"Priority writes must always be leaf nodes"),s=i.value):n=gk(ze(t,r),i,n)}),!n.getChild(t).isEmpty()&&s!==null&&(n=n.updateChild(ze(t,".priority"),s)),n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rf(t,e){return vk(e,t)}function HH(t,e,n,s,r){O(s>t.lastWriteId,"Stacking an older write on top of newer ones"),r===void 0&&(r=!0),t.allWrites.push({path:e,snap:n,writeId:s,visible:r}),r&&(t.visibleWrites=Jc(t.visibleWrites,e,n)),t.lastWriteId=s}function WH(t,e,n,s){O(s>t.lastWriteId,"Stacking an older merge on top of newer ones"),t.allWrites.push({path:e,children:n,writeId:s,visible:!0}),t.visibleWrites=bm(t.visibleWrites,e,n),t.lastWriteId=s}function GH(t,e){for(let n=0;n<t.allWrites.length;n++){const s=t.allWrites[n];if(s.writeId===e)return s}return null}function zH(t,e){const n=t.allWrites.findIndex(a=>a.writeId===e);O(n>=0,"removeWrite called with nonexistent writeId.");const s=t.allWrites[n];t.allWrites.splice(n,1);let r=s.visible,i=!1,o=t.allWrites.length-1;for(;r&&o>=0;){const a=t.allWrites[o];a.visible&&(o>=n&&QH(a,s.path)?r=!1:Bn(s.path,a.path)&&(i=!0)),o--}if(r){if(i)return YH(t),!0;if(s.snap)t.visibleWrites=WI(t.visibleWrites,s.path);else{const a=s.children;xt(a,c=>{t.visibleWrites=WI(t.visibleWrites,ze(s.path,c))})}return!0}else return!1}function QH(t,e){if(t.snap)return Bn(t.path,e);for(const n in t.children)if(t.children.hasOwnProperty(n)&&Bn(ze(t.path,n),e))return!0;return!1}function YH(t){t.visibleWrites=mk(t.allWrites,JH,Te()),t.allWrites.length>0?t.lastWriteId=t.allWrites[t.allWrites.length-1].writeId:t.lastWriteId=-1}function JH(t){return t.visible}function mk(t,e,n){let s=us.empty();for(let r=0;r<t.length;++r){const i=t[r];if(e(i)){const o=i.path;let a;if(i.snap)Bn(n,o)?(a=un(n,o),s=Jc(s,a,i.snap)):Bn(o,n)&&(a=un(o,n),s=Jc(s,Te(),i.snap.getChild(a)));else if(i.children){if(Bn(n,o))a=un(n,o),s=bm(s,a,i.children);else if(Bn(o,n))if(a=un(o,n),ge(a))s=bm(s,Te(),i.children);else{const c=Yi(i.children,pe(a));if(c){const l=c.getChild(Le(a));s=Jc(s,Te(),l)}}}else throw Ha("WriteRecord should have .snap or .children")}}return s}function _k(t,e,n,s,r){if(!s&&!r){const i=ko(t.visibleWrites,e);if(i!=null)return i;{const o=qr(t.visibleWrites,e);if(Em(o))return n;if(n==null&&!Im(o,Te()))return null;{const a=n||te.EMPTY_NODE;return ka(o,a)}}}else{const i=qr(t.visibleWrites,e);if(!r&&Em(i))return n;if(!r&&n==null&&!Im(i,Te()))return null;{const o=function(l){return(l.visible||r)&&(!s||!~s.indexOf(l.writeId))&&(Bn(l.path,e)||Bn(e,l.path))},a=mk(t.allWrites,o,e),c=n||te.EMPTY_NODE;return ka(a,c)}}}function XH(t,e,n){let s=te.EMPTY_NODE;const r=ko(t.visibleWrites,e);if(r)return r.isLeafNode()||r.forEachChild(je,(i,o)=>{s=s.updateImmediateChild(i,o)}),s;if(n){const i=qr(t.visibleWrites,e);return n.forEachChild(je,(o,a)=>{const c=ka(qr(i,new Ae(o)),a);s=s.updateImmediateChild(o,c)}),GI(i).forEach(o=>{s=s.updateImmediateChild(o.name,o.node)}),s}else{const i=qr(t.visibleWrites,e);return GI(i).forEach(o=>{s=s.updateImmediateChild(o.name,o.node)}),s}}function ZH(t,e,n,s,r){O(s||r,"Either existingEventSnap or existingServerSnap must exist");const i=ze(e,n);if(Im(t.visibleWrites,i))return null;{const o=qr(t.visibleWrites,i);return Em(o)?r.getChild(n):ka(o,r.getChild(n))}}function eW(t,e,n,s){const r=ze(e,n),i=ko(t.visibleWrites,r);if(i!=null)return i;if(s.isCompleteForChild(n)){const o=qr(t.visibleWrites,r);return ka(o,s.getNode().getImmediateChild(n))}else return null}function tW(t,e){return ko(t.visibleWrites,e)}function nW(t,e,n,s,r,i,o){let a;const c=qr(t.visibleWrites,e),l=ko(c,Te());if(l!=null)a=l;else if(n!=null)a=ka(c,n);else return[];if(a=a.withIndex(o),!a.isEmpty()&&!a.isLeafNode()){const u=[],h=o.getCompare(),d=i?a.getReverseIteratorFrom(s,o):a.getIteratorFrom(s,o);let f=d.getNext();for(;f&&u.length<r;)h(f,s)!==0&&u.push(f),f=d.getNext();return u}else return[]}function sW(){return{visibleWrites:us.empty(),allWrites:[],lastWriteId:-1}}function hd(t,e,n,s){return _k(t.writeTree,t.treePath,e,n,s)}function xy(t,e){return XH(t.writeTree,t.treePath,e)}function zI(t,e,n,s){return ZH(t.writeTree,t.treePath,e,n,s)}function dd(t,e){return tW(t.writeTree,ze(t.treePath,e))}function rW(t,e,n,s,r,i){return nW(t.writeTree,t.treePath,e,n,s,r,i)}function Oy(t,e,n){return eW(t.writeTree,t.treePath,e,n)}function yk(t,e){return vk(ze(t.treePath,e),t.writeTree)}function vk(t,e){return{treePath:t,writeTree:e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iW{constructor(){this.changeMap=new Map}trackChildChange(e){const n=e.type,s=e.childName;O(n==="child_added"||n==="child_changed"||n==="child_removed","Only child changes supported for tracking"),O(s!==".priority","Only non-priority child changes can be tracked.");const r=this.changeMap.get(s);if(r){const i=r.type;if(n==="child_added"&&i==="child_removed")this.changeMap.set(s,Ol(s,e.snapshotNode,r.snapshotNode));else if(n==="child_removed"&&i==="child_added")this.changeMap.delete(s);else if(n==="child_removed"&&i==="child_changed")this.changeMap.set(s,xl(s,r.oldSnap));else if(n==="child_changed"&&i==="child_added")this.changeMap.set(s,Ca(s,e.snapshotNode));else if(n==="child_changed"&&i==="child_changed")this.changeMap.set(s,Ol(s,e.snapshotNode,r.oldSnap));else throw Ha("Illegal combination of changes: "+e+" occurred after "+r)}else this.changeMap.set(s,e)}getChanges(){return Array.from(this.changeMap.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oW{getCompleteChild(e){return null}getChildAfterChild(e,n,s){return null}}const wk=new oW;class My{constructor(e,n,s=null){this.writes_=e,this.viewCache_=n,this.optCompleteServerCache_=s}getCompleteChild(e){const n=this.viewCache_.eventCache;if(n.isCompleteForChild(e))return n.getNode().getImmediateChild(e);{const s=this.optCompleteServerCache_!=null?new Xr(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return Oy(this.writes_,e,s)}}getChildAfterChild(e,n,s){const r=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:so(this.viewCache_),i=rW(this.writes_,r,n,1,s,e);return i.length===0?null:i[0]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aW(t){return{filter:t}}function cW(t,e){O(e.eventCache.getNode().isIndexed(t.filter.getIndex()),"Event snap not indexed"),O(e.serverCache.getNode().isIndexed(t.filter.getIndex()),"Server snap not indexed")}function lW(t,e,n,s,r){const i=new iW;let o,a;if(n.type===is.OVERWRITE){const l=n;l.source.fromUser?o=Tm(t,e,l.path,l.snap,s,r,i):(O(l.source.fromServer,"Unknown source."),a=l.source.tagged||e.serverCache.isFiltered()&&!ge(l.path),o=fd(t,e,l.path,l.snap,s,r,a,i))}else if(n.type===is.MERGE){const l=n;l.source.fromUser?o=hW(t,e,l.path,l.children,s,r,i):(O(l.source.fromServer,"Unknown source."),a=l.source.tagged||e.serverCache.isFiltered(),o=Sm(t,e,l.path,l.children,s,r,a,i))}else if(n.type===is.ACK_USER_WRITE){const l=n;l.revert?o=pW(t,e,l.path,s,r,i):o=dW(t,e,l.path,l.affectedTree,s,r,i)}else if(n.type===is.LISTEN_COMPLETE)o=fW(t,e,n.path,s,i);else throw Ha("Unknown operation type: "+n.type);const c=i.getChanges();return uW(e,o,c),{viewCache:o,changes:c}}function uW(t,e,n){const s=e.eventCache;if(s.isFullyInitialized()){const r=s.getNode().isLeafNode()||s.getNode().isEmpty(),i=ud(t);(n.length>0||!t.eventCache.isFullyInitialized()||r&&!s.getNode().equals(i)||!s.getNode().getPriority().equals(i.getPriority()))&&n.push(fk(ud(e)))}}function bk(t,e,n,s,r,i){const o=e.eventCache;if(dd(s,n)!=null)return e;{let a,c;if(ge(n))if(O(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){const l=so(e),u=l instanceof te?l:te.EMPTY_NODE,h=xy(s,u);a=t.filter.updateFullNode(e.eventCache.getNode(),h,i)}else{const l=hd(s,so(e));a=t.filter.updateFullNode(e.eventCache.getNode(),l,i)}else{const l=pe(n);if(l===".priority"){O(Jr(n)===1,"Can't have a priority with additional path components");const u=o.getNode();c=e.serverCache.getNode();const h=zI(s,n,u,c);h!=null?a=t.filter.updatePriority(u,h):a=o.getNode()}else{const u=Le(n);let h;if(o.isCompleteForChild(l)){c=e.serverCache.getNode();const d=zI(s,n,o.getNode(),c);d!=null?h=o.getNode().getImmediateChild(l).updateChild(u,d):h=o.getNode().getImmediateChild(l)}else h=Oy(s,l,e.serverCache);h!=null?a=t.filter.updateChild(o.getNode(),l,h,u,r,i):a=o.getNode()}}return Yc(e,a,o.isFullyInitialized()||ge(n),t.filter.filtersNodes())}}function fd(t,e,n,s,r,i,o,a){const c=e.serverCache;let l;const u=o?t.filter:t.filter.getIndexedFilter();if(ge(n))l=u.updateFullNode(c.getNode(),s,null);else if(u.filtersNodes()&&!c.isFiltered()){const f=c.getNode().updateChild(n,s);l=u.updateFullNode(c.getNode(),f,null)}else{const f=pe(n);if(!c.isCompleteForPath(n)&&Jr(n)>1)return e;const p=Le(n),y=c.getNode().getImmediateChild(f).updateChild(p,s);f===".priority"?l=u.updatePriority(c.getNode(),y):l=u.updateChild(c.getNode(),f,y,p,wk,null)}const h=pk(e,l,c.isFullyInitialized()||ge(n),u.filtersNodes()),d=new My(r,h,i);return bk(t,h,n,r,d,a)}function Tm(t,e,n,s,r,i,o){const a=e.eventCache;let c,l;const u=new My(r,e,i);if(ge(n))l=t.filter.updateFullNode(e.eventCache.getNode(),s,o),c=Yc(e,l,!0,t.filter.filtersNodes());else{const h=pe(n);if(h===".priority")l=t.filter.updatePriority(e.eventCache.getNode(),s),c=Yc(e,l,a.isFullyInitialized(),a.isFiltered());else{const d=Le(n),f=a.getNode().getImmediateChild(h);let p;if(ge(d))p=s;else{const _=u.getCompleteChild(h);_!=null?Ey(d)===".priority"&&_.getChild(rk(d)).isEmpty()?p=_:p=_.updateChild(d,s):p=te.EMPTY_NODE}if(f.equals(p))c=e;else{const _=t.filter.updateChild(a.getNode(),h,p,d,u,o);c=Yc(e,_,a.isFullyInitialized(),t.filter.filtersNodes())}}}return c}function QI(t,e){return t.eventCache.isCompleteForChild(e)}function hW(t,e,n,s,r,i,o){let a=e;return s.foreach((c,l)=>{const u=ze(n,c);QI(e,pe(u))&&(a=Tm(t,a,u,l,r,i,o))}),s.foreach((c,l)=>{const u=ze(n,c);QI(e,pe(u))||(a=Tm(t,a,u,l,r,i,o))}),a}function YI(t,e,n){return n.foreach((s,r)=>{e=e.updateChild(s,r)}),e}function Sm(t,e,n,s,r,i,o,a){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let c=e,l;ge(n)?l=s:l=new Ve(null).setTree(n,s);const u=e.serverCache.getNode();return l.children.inorderTraversal((h,d)=>{if(u.hasChild(h)){const f=e.serverCache.getNode().getImmediateChild(h),p=YI(t,f,d);c=fd(t,c,new Ae(h),p,r,i,o,a)}}),l.children.inorderTraversal((h,d)=>{const f=!e.serverCache.isCompleteForChild(h)&&d.value===void 0;if(!u.hasChild(h)&&!f){const p=e.serverCache.getNode().getImmediateChild(h),_=YI(t,p,d);c=fd(t,c,new Ae(h),_,r,i,o,a)}}),c}function dW(t,e,n,s,r,i,o){if(dd(r,n)!=null)return e;const a=e.serverCache.isFiltered(),c=e.serverCache;if(s.value!=null){if(ge(n)&&c.isFullyInitialized()||c.isCompleteForPath(n))return fd(t,e,n,c.getNode().getChild(n),r,i,a,o);if(ge(n)){let l=new Ve(null);return c.getNode().forEachChild(Rs,(u,h)=>{l=l.set(new Ae(u),h)}),Sm(t,e,n,l,r,i,a,o)}else return e}else{let l=new Ve(null);return s.foreach((u,h)=>{const d=ze(n,u);c.isCompleteForPath(d)&&(l=l.set(u,c.getNode().getChild(d)))}),Sm(t,e,n,l,r,i,a,o)}}function fW(t,e,n,s,r){const i=e.serverCache,o=pk(e,i.getNode(),i.isFullyInitialized()||ge(n),i.isFiltered());return bk(t,o,n,s,wk,r)}function pW(t,e,n,s,r,i){let o;if(dd(s,n)!=null)return e;{const a=new My(s,e,r),c=e.eventCache.getNode();let l;if(ge(n)||pe(n)===".priority"){let u;if(e.serverCache.isFullyInitialized())u=hd(s,so(e));else{const h=e.serverCache.getNode();O(h instanceof te,"serverChildren would be complete if leaf node"),u=xy(s,h)}u=u,l=t.filter.updateFullNode(c,u,i)}else{const u=pe(n);let h=Oy(s,u,e.serverCache);h==null&&e.serverCache.isCompleteForChild(u)&&(h=c.getImmediateChild(u)),h!=null?l=t.filter.updateChild(c,u,h,Le(n),a,i):e.eventCache.getNode().hasChild(u)?l=t.filter.updateChild(c,u,te.EMPTY_NODE,Le(n),a,i):l=c,l.isEmpty()&&e.serverCache.isFullyInitialized()&&(o=hd(s,so(e)),o.isLeafNode()&&(l=t.filter.updateFullNode(l,o,i)))}return o=e.serverCache.isFullyInitialized()||dd(s,Te())!=null,Yc(e,l,o,t.filter.filtersNodes())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gW{constructor(e,n){this.query_=e,this.eventRegistrations_=[];const s=this.query_._queryParams,r=new Ry(s.getIndex()),i=RH(s);this.processor_=aW(i);const o=n.serverCache,a=n.eventCache,c=r.updateFullNode(te.EMPTY_NODE,o.getNode(),null),l=i.updateFullNode(te.EMPTY_NODE,a.getNode(),null),u=new Xr(c,o.isFullyInitialized(),r.filtersNodes()),h=new Xr(l,a.isFullyInitialized(),i.filtersNodes());this.viewCache_=kf(h,u),this.eventGenerator_=new VH(this.query_)}get query(){return this.query_}}function mW(t){return t.viewCache_.serverCache.getNode()}function _W(t){return ud(t.viewCache_)}function yW(t,e){const n=so(t.viewCache_);return n&&(t.query._queryParams.loadsAllData()||!ge(e)&&!n.getImmediateChild(pe(e)).isEmpty())?n.getChild(e):null}function JI(t){return t.eventRegistrations_.length===0}function vW(t,e){t.eventRegistrations_.push(e)}function XI(t,e,n){const s=[];if(n){O(e==null,"A cancel should cancel all event registrations.");const r=t.query._path;t.eventRegistrations_.forEach(i=>{const o=i.createCancelEvent(n,r);o&&s.push(o)})}if(e){let r=[];for(let i=0;i<t.eventRegistrations_.length;++i){const o=t.eventRegistrations_[i];if(!o.matches(e))r.push(o);else if(e.hasAnyCallback()){r=r.concat(t.eventRegistrations_.slice(i+1));break}}t.eventRegistrations_=r}else t.eventRegistrations_=[];return s}function ZI(t,e,n,s){e.type===is.MERGE&&e.source.queryId!==null&&(O(so(t.viewCache_),"We should always have a full cache before handling merges"),O(ud(t.viewCache_),"Missing event cache, even though we have a server cache"));const r=t.viewCache_,i=lW(t.processor_,r,e,n,s);return cW(t.processor_,i.viewCache),O(i.viewCache.serverCache.isFullyInitialized()||!r.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),t.viewCache_=i.viewCache,Ik(t,i.changes,i.viewCache.eventCache.getNode(),null)}function wW(t,e){const n=t.viewCache_.eventCache,s=[];return n.getNode().isLeafNode()||n.getNode().forEachChild(je,(i,o)=>{s.push(Ca(i,o))}),n.isFullyInitialized()&&s.push(fk(n.getNode())),Ik(t,s,n.getNode(),e)}function Ik(t,e,n,s){const r=s?[s]:t.eventRegistrations_;return BH(t.eventGenerator_,e,n,r)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let pd;class Ek{constructor(){this.views=new Map}}function bW(t){O(!pd,"__referenceConstructor has already been defined"),pd=t}function IW(){return O(pd,"Reference.ts has not been loaded"),pd}function EW(t){return t.views.size===0}function Ly(t,e,n,s){const r=e.source.queryId;if(r!==null){const i=t.views.get(r);return O(i!=null,"SyncTree gave us an op for an invalid query."),ZI(i,e,n,s)}else{let i=[];for(const o of t.views.values())i=i.concat(ZI(o,e,n,s));return i}}function Fy(t,e,n,s,r){const i=e._queryIdentifier,o=t.views.get(i);if(!o){let a=hd(n,r?s:null),c=!1;a?c=!0:s instanceof te?(a=xy(n,s),c=!1):(a=te.EMPTY_NODE,c=!1);const l=kf(new Xr(a,c,!1),new Xr(s,r,!1));return new gW(e,l)}return o}function TW(t,e,n,s,r,i){const o=Fy(t,e,s,r,i);return t.views.has(e._queryIdentifier)||t.views.set(e._queryIdentifier,o),vW(o,n),wW(o,n)}function SW(t,e,n,s){const r=e._queryIdentifier,i=[];let o=[];const a=Zr(t);if(r==="default")for(const[c,l]of t.views.entries())o=o.concat(XI(l,n,s)),JI(l)&&(t.views.delete(c),l.query._queryParams.loadsAllData()||i.push(l.query));else{const c=t.views.get(r);c&&(o=o.concat(XI(c,n,s)),JI(c)&&(t.views.delete(r),c.query._queryParams.loadsAllData()||i.push(c.query)))}return a&&!Zr(t)&&i.push(new(IW())(e._repo,e._path)),{removed:i,events:o}}function Tk(t){const e=[];for(const n of t.views.values())n.query._queryParams.loadsAllData()||e.push(n);return e}function jr(t,e){let n=null;for(const s of t.views.values())n=n||yW(s,e);return n}function Sk(t,e){if(e._queryParams.loadsAllData())return Nf(t);{const s=e._queryIdentifier;return t.views.get(s)}}function Ck(t,e){return Sk(t,e)!=null}function Zr(t){return Nf(t)!=null}function Nf(t){for(const e of t.views.values())if(e.query._queryParams.loadsAllData())return e;return null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let gd;function CW(t){O(!gd,"__referenceConstructor has already been defined"),gd=t}function AW(){return O(gd,"Reference.ts has not been loaded"),gd}let kW=1;class eE{constructor(e){this.listenProvider_=e,this.syncPointTree_=new Ve(null),this.pendingWriteTree_=sW(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function Uy(t,e,n,s,r){return HH(t.pendingWriteTree_,e,n,s,r),r?Za(t,new no(Ny(),e,n)):[]}function RW(t,e,n,s){WH(t.pendingWriteTree_,e,n,s);const r=Ve.fromObject(n);return Za(t,new Aa(Ny(),e,r))}function Fr(t,e,n=!1){const s=GH(t.pendingWriteTree_,e);if(zH(t.pendingWriteTree_,e)){let i=new Ve(null);return s.snap!=null?i=i.set(Te(),!0):xt(s.children,o=>{i=i.set(new Ae(o),!0)}),Za(t,new ld(s.path,i,n))}else return[]}function bu(t,e,n){return Za(t,new no(Py(),e,n))}function NW(t,e,n){const s=Ve.fromObject(n);return Za(t,new Aa(Py(),e,s))}function PW(t,e){return Za(t,new Ll(Py(),e))}function DW(t,e,n){const s=$y(t,n);if(s){const r=Vy(s),i=r.path,o=r.queryId,a=un(i,e),c=new Ll(Dy(o),a);return By(t,i,c)}else return[]}function md(t,e,n,s){const r=e._path,i=t.syncPointTree_.get(r);let o=[];if(i&&(e._queryIdentifier==="default"||Ck(i,e))){const a=SW(i,e,n,s);EW(i)&&(t.syncPointTree_=t.syncPointTree_.remove(r));const c=a.removed;o=a.events;const l=c.findIndex(h=>h._queryParams.loadsAllData())!==-1,u=t.syncPointTree_.findOnPath(r,(h,d)=>Zr(d));if(l&&!u){const h=t.syncPointTree_.subtree(r);if(!h.isEmpty()){const d=LW(h);for(let f=0;f<d.length;++f){const p=d[f],_=p.query,y=Pk(t,p);t.listenProvider_.startListening(Xc(_),Fl(t,_),y.hashFn,y.onComplete)}}}!u&&c.length>0&&!s&&(l?t.listenProvider_.stopListening(Xc(e),null):c.forEach(h=>{const d=t.queryToTagMap.get(Df(h));t.listenProvider_.stopListening(Xc(h),d)})),FW(t,c)}return o}function xW(t,e){const{syncPoint:n,serverCache:s,writesCache:r,serverCacheComplete:i}=kk(e,t),o=Fy(n,e,r,s,i);return n.views.has(e._queryIdentifier)||n.views.set(e._queryIdentifier,o),e._queryParams.loadsAllData()?null:Fl(t,e)}function Ak(t,e,n,s){const r=$y(t,s);if(r!=null){const i=Vy(r),o=i.path,a=i.queryId,c=un(o,e),l=new no(Dy(a),c,n);return By(t,o,l)}else return[]}function OW(t,e,n,s){const r=$y(t,s);if(r){const i=Vy(r),o=i.path,a=i.queryId,c=un(o,e),l=Ve.fromObject(n),u=new Aa(Dy(a),c,l);return By(t,o,u)}else return[]}function kk(t,e){const n=t._path;let s=null,r=!1;e.syncPointTree_.foreachOnPath(n,(l,u)=>{const h=un(l,n);s=s||jr(u,h),r=r||Zr(u)});let i=e.syncPointTree_.get(n);i?(r=r||Zr(i),s=s||jr(i,Te())):(i=new Ek,e.syncPointTree_=e.syncPointTree_.set(n,i));let o;s!=null?o=!0:(o=!1,s=te.EMPTY_NODE,e.syncPointTree_.subtree(n).foreachChild((u,h)=>{const d=jr(h,Te());d&&(s=s.updateImmediateChild(u,d))}));const a=Ck(i,t);if(!a&&!t._queryParams.loadsAllData()){const l=Df(t);O(!e.queryToTagMap.has(l),"View does not exist, but we have a tag");const u=UW();e.queryToTagMap.set(l,u),e.tagToQueryMap.set(u,l)}const c=Rf(e.pendingWriteTree_,n);return{syncPoint:i,writesCache:c,serverCache:s,serverCacheComplete:o,foundAncestorDefaultView:r,viewAlreadyExists:a}}function tE(t,e,n){const{syncPoint:s,serverCache:r,writesCache:i,serverCacheComplete:o,viewAlreadyExists:a,foundAncestorDefaultView:c}=kk(e,t);let l=TW(s,e,n,i,r,o);if(!a&&!c){const u=Sk(s,e);l=l.concat($W(t,e,u))}return l}function Pf(t,e,n){const r=t.pendingWriteTree_,i=t.syncPointTree_.findOnPath(e,(o,a)=>{const c=un(o,e),l=jr(a,c);if(l)return l});return _k(r,e,i,n,!0)}function MW(t,e){const n=e._path;let s=null;t.syncPointTree_.foreachOnPath(n,(l,u)=>{const h=un(l,n);s=s||jr(u,h)});let r=t.syncPointTree_.get(n);r?s=s||jr(r,Te()):(r=new Ek,t.syncPointTree_=t.syncPointTree_.set(n,r));const i=s!=null,o=i?new Xr(s,!0,!1):null,a=Rf(t.pendingWriteTree_,e._path),c=Fy(r,e,a,i?o.getNode():te.EMPTY_NODE,i);return _W(c)}function Za(t,e){return Rk(e,t.syncPointTree_,null,Rf(t.pendingWriteTree_,Te()))}function Rk(t,e,n,s){if(ge(t.path))return Nk(t,e,n,s);{const r=e.get(Te());n==null&&r!=null&&(n=jr(r,Te()));let i=[];const o=pe(t.path),a=t.operationForChild(o),c=e.children.get(o);if(c&&a){const l=n?n.getImmediateChild(o):null,u=yk(s,o);i=i.concat(Rk(a,c,l,u))}return r&&(i=i.concat(Ly(r,t,s,n))),i}}function Nk(t,e,n,s){const r=e.get(Te());n==null&&r!=null&&(n=jr(r,Te()));let i=[];return e.children.inorderTraversal((o,a)=>{const c=n?n.getImmediateChild(o):null,l=yk(s,o),u=t.operationForChild(o);u&&(i=i.concat(Nk(u,a,c,l)))}),r&&(i=i.concat(Ly(r,t,s,n))),i}function Pk(t,e){const n=e.query,s=Fl(t,n);return{hashFn:()=>(mW(e)||te.EMPTY_NODE).hash(),onComplete:r=>{if(r==="ok")return s?DW(t,n._path,s):PW(t,n._path);{const i=NK(r,n);return md(t,n,null,i)}}}}function Fl(t,e){const n=Df(e);return t.queryToTagMap.get(n)}function Df(t){return t._path.toString()+"$"+t._queryIdentifier}function $y(t,e){return t.tagToQueryMap.get(e)}function Vy(t){const e=t.indexOf("$");return O(e!==-1&&e<t.length-1,"Bad queryKey."),{queryId:t.substr(e+1),path:new Ae(t.substr(0,e))}}function By(t,e,n){const s=t.syncPointTree_.get(e);O(s,"Missing sync point for query tag that we're tracking");const r=Rf(t.pendingWriteTree_,e);return Ly(s,n,r,null)}function LW(t){return t.fold((e,n,s)=>{if(n&&Zr(n))return[Nf(n)];{let r=[];return n&&(r=Tk(n)),xt(s,(i,o)=>{r=r.concat(o)}),r}})}function Xc(t){return t._queryParams.loadsAllData()&&!t._queryParams.isDefault()?new(AW())(t._repo,t._path):t}function FW(t,e){for(let n=0;n<e.length;++n){const s=e[n];if(!s._queryParams.loadsAllData()){const r=Df(s),i=t.queryToTagMap.get(r);t.queryToTagMap.delete(r),t.tagToQueryMap.delete(i)}}}function UW(){return kW++}function $W(t,e,n){const s=e._path,r=Fl(t,e),i=Pk(t,n),o=t.listenProvider_.startListening(Xc(e),r,i.hashFn,i.onComplete),a=t.syncPointTree_.subtree(s);if(r)O(!Zr(a.value),"If we're adding a query, it shouldn't be shadowed");else{const c=a.fold((l,u,h)=>{if(!ge(l)&&u&&Zr(u))return[Nf(u).query];{let d=[];return u&&(d=d.concat(Tk(u).map(f=>f.query))),xt(h,(f,p)=>{d=d.concat(p)}),d}});for(let l=0;l<c.length;++l){const u=c[l];t.listenProvider_.stopListening(Xc(u),Fl(t,u))}}return o}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qy{constructor(e){this.node_=e}getImmediateChild(e){const n=this.node_.getImmediateChild(e);return new qy(n)}node(){return this.node_}}class jy{constructor(e,n){this.syncTree_=e,this.path_=n}getImmediateChild(e){const n=ze(this.path_,e);return new jy(this.syncTree_,n)}node(){return Pf(this.syncTree_,this.path_)}}const VW=function(t){return t=t||{},t.timestamp=t.timestamp||new Date().getTime(),t},nE=function(t,e,n){if(!t||typeof t!="object")return t;if(O(".sv"in t,"Unexpected leaf node or priority contents"),typeof t[".sv"]=="string")return BW(t[".sv"],e,n);if(typeof t[".sv"]=="object")return qW(t[".sv"],e);O(!1,"Unexpected server value: "+JSON.stringify(t,null,2))},BW=function(t,e,n){switch(t){case"timestamp":return n.timestamp;default:O(!1,"Unexpected server value: "+t)}},qW=function(t,e,n){t.hasOwnProperty("increment")||O(!1,"Unexpected server value: "+JSON.stringify(t,null,2));const s=t.increment;typeof s!="number"&&O(!1,"Unexpected increment value: "+s);const r=e.node();if(O(r!==null&&typeof r!="undefined","Expected ChildrenNode.EMPTY_NODE for nulls"),!r.isLeafNode())return s;const o=r.getValue();return typeof o!="number"?s:o+s},Dk=function(t,e,n,s){return Hy(e,new jy(n,t),s)},Ky=function(t,e,n){return Hy(t,new qy(e),n)};function Hy(t,e,n){const s=t.getPriority().val(),r=nE(s,e.getImmediateChild(".priority"),n);let i;if(t.isLeafNode()){const o=t,a=nE(o.getValue(),e,n);return a!==o.getValue()||r!==o.getPriority().val()?new bt(a,Je(r)):t}else{const o=t;return i=o,r!==o.getPriority().val()&&(i=i.updatePriority(new bt(r))),o.forEachChild(je,(a,c)=>{const l=Hy(c,e.getImmediateChild(a),n);l!==c&&(i=i.updateImmediateChild(a,l))}),i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wy{constructor(e="",n=null,s={children:{},childCount:0}){this.name=e,this.parent=n,this.node=s}}function xf(t,e){let n=e instanceof Ae?e:new Ae(e),s=t,r=pe(n);for(;r!==null;){const i=Yi(s.node.children,r)||{children:{},childCount:0};s=new Wy(r,s,i),n=Le(n),r=pe(n)}return s}function Ro(t){return t.node.value}function Gy(t,e){t.node.value=e,Cm(t)}function xk(t){return t.node.childCount>0}function jW(t){return Ro(t)===void 0&&!xk(t)}function Of(t,e){xt(t.node.children,(n,s)=>{e(new Wy(n,t,s))})}function Ok(t,e,n,s){n&&!s&&e(t),Of(t,r=>{Ok(r,e,!0,s)}),n&&s&&e(t)}function KW(t,e,n){let s=n?t:t.parent;for(;s!==null;){if(e(s))return!0;s=s.parent}return!1}function Iu(t){return new Ae(t.parent===null?t.name:Iu(t.parent)+"/"+t.name)}function Cm(t){t.parent!==null&&HW(t.parent,t.name,t)}function HW(t,e,n){const s=jW(n),r=xn(t.node.children,e);s&&r?(delete t.node.children[e],t.node.childCount--,Cm(t)):!s&&!r&&(t.node.children[e]=n.node,t.node.childCount++,Cm(t))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WW=/[\[\].#$\/\u0000-\u001F\u007F]/,GW=/[\[\].#$\u0000-\u001F\u007F]/,tg=10*1024*1024,Mf=function(t){return typeof t=="string"&&t.length!==0&&!WW.test(t)},Mk=function(t){return typeof t=="string"&&t.length!==0&&!GW.test(t)},zW=function(t){return t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),Mk(t)},Ul=function(t){return t===null||typeof t=="string"||typeof t=="number"&&!Tf(t)||t&&typeof t=="object"&&xn(t,".sv")},Us=function(t,e,n,s){s&&e===void 0||Eu(bn(t,"value"),e,n)},Eu=function(t,e,n){const s=n instanceof Ae?new cH(n,t):n;if(e===void 0)throw new Error(t+"contains undefined "+Si(s));if(typeof e=="function")throw new Error(t+"contains a function "+Si(s)+" with contents = "+e.toString());if(Tf(e))throw new Error(t+"contains "+e.toString()+" "+Si(s));if(typeof e=="string"&&e.length>tg/3&&cf(e)>tg)throw new Error(t+"contains a string greater than "+tg+" utf8 bytes "+Si(s)+" ('"+e.substring(0,50)+"...')");if(e&&typeof e=="object"){let r=!1,i=!1;if(xt(e,(o,a)=>{if(o===".value")r=!0;else if(o!==".priority"&&o!==".sv"&&(i=!0,!Mf(o)))throw new Error(t+" contains an invalid key ("+o+") "+Si(s)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);lH(s,o),Eu(t,a,s),uH(s)}),r&&i)throw new Error(t+' contains ".value" child '+Si(s)+" in addition to actual children.")}},QW=function(t,e){let n,s;for(n=0;n<e.length;n++){s=e[n];const i=Dl(s);for(let o=0;o<i.length;o++)if(!(i[o]===".priority"&&o===i.length-1)){if(!Mf(i[o]))throw new Error(t+"contains an invalid key ("+i[o]+") in path "+s.toString()+`. Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`)}}e.sort(aH);let r=null;for(n=0;n<e.length;n++){if(s=e[n],r!==null&&Bn(r,s))throw new Error(t+"contains a path "+r.toString()+" that is ancestor of another path "+s.toString());r=s}},Lk=function(t,e,n,s){if(s&&e===void 0)return;const r=bn(t,"values");if(!(e&&typeof e=="object")||Array.isArray(e))throw new Error(r+" must be an object containing the children to replace.");const i=[];xt(e,(o,a)=>{const c=new Ae(o);if(Eu(r,a,ze(n,c)),Ey(c)===".priority"&&!Ul(a))throw new Error(r+"contains an invalid value for '"+c.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");i.push(c)}),QW(r,i)},zy=function(t,e,n){if(!(n&&e===void 0)){if(Tf(e))throw new Error(bn(t,"priority")+"is "+e.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!Ul(e))throw new Error(bn(t,"priority")+"must be a valid Firebase priority (a string, finite number, server value, or null).")}},Tu=function(t,e,n,s){if(!(s&&n===void 0)&&!Mf(n))throw new Error(bn(t,e)+'was an invalid key = "'+n+`".  Firebase keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]").`)},$l=function(t,e,n,s){if(!(s&&n===void 0)&&!Mk(n))throw new Error(bn(t,e)+'was an invalid path = "'+n+`". Paths must be non-empty strings and can't contain ".", "#", "$", "[", or "]"`)},YW=function(t,e,n,s){n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),$l(t,e,n,s)},qn=function(t,e){if(pe(e)===".info")throw new Error(t+" failed = Can't modify data under /.info/")},Fk=function(t,e){const n=e.path.toString();if(typeof e.repoInfo.host!="string"||e.repoInfo.host.length===0||!Mf(e.repoInfo.namespace)&&e.repoInfo.host.split(":")[0]!=="localhost"||n.length!==0&&!zW(n))throw new Error(bn(t,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JW{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function Lf(t,e){let n=null;for(let s=0;s<e.length;s++){const r=e[s],i=r.getPath();n!==null&&!Ty(i,n.path)&&(t.eventLists_.push(n),n=null),n===null&&(n={events:[],path:i}),n.events.push(r)}n&&t.eventLists_.push(n)}function Uk(t,e,n){Lf(t,n),$k(t,s=>Ty(s,e))}function zn(t,e,n){Lf(t,n),$k(t,s=>Bn(s,e)||Bn(e,s))}function $k(t,e){t.recursionDepth_++;let n=!0;for(let s=0;s<t.eventLists_.length;s++){const r=t.eventLists_[s];if(r){const i=r.path;e(i)?(XW(t.eventLists_[s]),t.eventLists_[s]=null):n=!1}}n&&(t.eventLists_=[]),t.recursionDepth_--}function XW(t){for(let e=0;e<t.events.length;e++){const n=t.events[e];if(n!==null){t.events[e]=null;const s=n.getEventRunner();zi&&Ct("event: "+n.toString()),Ja(s)}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vk="repo_interrupt",ZW=25;class eG{constructor(e,n,s,r){this.repoInfo_=e,this.forceRestClient_=n,this.authTokenProvider_=s,this.appCheckProvider_=r,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new JW,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=cd(),this.transactionQueueTree_=new Wy,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function tG(t,e,n){if(t.stats_=by(t.repoInfo_),t.forceRestClient_||DK())t.server_=new ad(t.repoInfo_,(s,r,i,o)=>{sE(t,s,r,i,o)},t.authTokenProvider_,t.appCheckProvider_),setTimeout(()=>rE(t,!0),0);else{if(typeof n!="undefined"&&n!==null){if(typeof n!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{_t(n)}catch(s){throw new Error("Invalid authOverride provided: "+s)}}t.persistentConnection_=new rr(t.repoInfo_,e,(s,r,i,o)=>{sE(t,s,r,i,o)},s=>{rE(t,s)},s=>{nG(t,s)},t.authTokenProvider_,t.appCheckProvider_,n),t.server_=t.persistentConnection_}t.authTokenProvider_.addTokenChangeListener(s=>{t.server_.refreshAuthToken(s)}),t.appCheckProvider_.addTokenChangeListener(s=>{t.server_.refreshAppCheckToken(s.token)}),t.statsReporter_=FK(t.repoInfo_,()=>new $H(t.stats_,t.server_)),t.infoData_=new OH,t.infoSyncTree_=new eE({startListening:(s,r,i,o)=>{let a=[];const c=t.infoData_.getNode(s._path);return c.isEmpty()||(a=bu(t.infoSyncTree_,s._path,c),setTimeout(()=>{o("ok")},0)),a},stopListening:()=>{}}),Qy(t,"connected",!1),t.serverSyncTree_=new eE({startListening:(s,r,i,o)=>(t.server_.listen(s,i,r,(a,c)=>{const l=o(a,c);zn(t.eventQueue_,s._path,l)}),[]),stopListening:(s,r)=>{t.server_.unlisten(s,r)}})}function Bk(t){const n=t.infoData_.getNode(new Ae(".info/serverTimeOffset")).val()||0;return new Date().getTime()+n}function Su(t){return VW({timestamp:Bk(t)})}function sE(t,e,n,s,r){t.dataUpdateCount++;const i=new Ae(e);n=t.interceptServerDataCallback_?t.interceptServerDataCallback_(e,n):n;let o=[];if(r)if(s){const c=Hh(n,l=>Je(l));o=OW(t.serverSyncTree_,i,c,r)}else{const c=Je(n);o=Ak(t.serverSyncTree_,i,c,r)}else if(s){const c=Hh(n,l=>Je(l));o=NW(t.serverSyncTree_,i,c)}else{const c=Je(n);o=bu(t.serverSyncTree_,i,c)}let a=i;o.length>0&&(a=Ra(t,i)),zn(t.eventQueue_,a,o)}function rE(t,e){Qy(t,"connected",e),e===!1&&iG(t)}function nG(t,e){xt(e,(n,s)=>{Qy(t,n,s)})}function Qy(t,e,n){const s=new Ae("/.info/"+e),r=Je(n);t.infoData_.updateSnapshot(s,r);const i=bu(t.infoSyncTree_,s,r);zn(t.eventQueue_,s,i)}function Ff(t){return t.nextWriteId_++}function sG(t,e){const n=MW(t.serverSyncTree_,e);return n!=null?Promise.resolve(n):t.server_.get(e).then(s=>{const r=Je(s).withIndex(e._queryParams.getIndex());if(e._queryParams.loadsAllData())bu(t.serverSyncTree_,e._path,r);else{const o=xW(t.serverSyncTree_,e);Ak(t.serverSyncTree_,e._path,r,o)}return md(t.serverSyncTree_,e,null).length>0&&ro(t,"unexpected cancel events in repoGetValue"),r},s=>(ro(t,"get for query "+_t(e)+" failed: "+s),Promise.reject(new Error(s))))}function Yy(t,e,n,s,r){ro(t,"set",{path:e.toString(),value:n,priority:s});const i=Su(t),o=Je(n,s),a=Pf(t.serverSyncTree_,e),c=Ky(o,a,i),l=Ff(t),u=Uy(t.serverSyncTree_,e,c,l,!0);Lf(t.eventQueue_,u),t.server_.put(e.toString(),o.val(!0),(d,f)=>{const p=d==="ok";p||Xt("set at "+e+" failed: "+d);const _=Fr(t.serverSyncTree_,l,!p);zn(t.eventQueue_,e,_),ei(t,r,d,f)});const h=Xy(t,e);Ra(t,h),zn(t.eventQueue_,h,[])}function rG(t,e,n,s){ro(t,"update",{path:e.toString(),value:n});let r=!0;const i=Su(t),o={};if(xt(n,(a,c)=>{r=!1,o[a]=Dk(ze(e,a),Je(c),t.serverSyncTree_,i)}),r)Ct("update() called with empty data.  Don't do anything."),ei(t,s,"ok",void 0);else{const a=Ff(t),c=RW(t.serverSyncTree_,e,o,a);Lf(t.eventQueue_,c),t.server_.merge(e.toString(),n,(l,u)=>{const h=l==="ok";h||Xt("update at "+e+" failed: "+l);const d=Fr(t.serverSyncTree_,a,!h),f=d.length>0?Ra(t,e):e;zn(t.eventQueue_,f,d),ei(t,s,l,u)}),xt(n,l=>{const u=Xy(t,ze(e,l));Ra(t,u)}),zn(t.eventQueue_,e,[])}}function iG(t){ro(t,"onDisconnectEvents");const e=Su(t),n=cd();wm(t.onDisconnect_,Te(),(r,i)=>{const o=Dk(r,i,t.serverSyncTree_,e);Xa(n,r,o)});let s=[];wm(n,Te(),(r,i)=>{s=s.concat(bu(t.serverSyncTree_,r,i));const o=Xy(t,r);Ra(t,o)}),t.onDisconnect_=cd(),zn(t.eventQueue_,Te(),s)}function oG(t,e,n){t.server_.onDisconnectCancel(e.toString(),(s,r)=>{s==="ok"&&vm(t.onDisconnect_,e),ei(t,n,s,r)})}function iE(t,e,n,s){const r=Je(n);t.server_.onDisconnectPut(e.toString(),r.val(!0),(i,o)=>{i==="ok"&&Xa(t.onDisconnect_,e,r),ei(t,s,i,o)})}function aG(t,e,n,s,r){const i=Je(n,s);t.server_.onDisconnectPut(e.toString(),i.val(!0),(o,a)=>{o==="ok"&&Xa(t.onDisconnect_,e,i),ei(t,r,o,a)})}function cG(t,e,n,s){if(Kh(n)){Ct("onDisconnect().update() called with empty data.  Don't do anything."),ei(t,s,"ok",void 0);return}t.server_.onDisconnectMerge(e.toString(),n,(r,i)=>{r==="ok"&&xt(n,(o,a)=>{const c=Je(a);Xa(t.onDisconnect_,ze(e,o),c)}),ei(t,s,r,i)})}function lG(t,e,n){let s;pe(e._path)===".info"?s=tE(t.infoSyncTree_,e,n):s=tE(t.serverSyncTree_,e,n),Uk(t.eventQueue_,e._path,s)}function Am(t,e,n){let s;pe(e._path)===".info"?s=md(t.infoSyncTree_,e,n):s=md(t.serverSyncTree_,e,n),Uk(t.eventQueue_,e._path,s)}function qk(t){t.persistentConnection_&&t.persistentConnection_.interrupt(Vk)}function uG(t){t.persistentConnection_&&t.persistentConnection_.resume(Vk)}function ro(t,...e){let n="";t.persistentConnection_&&(n=t.persistentConnection_.id+":"),Ct(n,...e)}function ei(t,e,n,s){e&&Ja(()=>{if(n==="ok")e(null);else{const r=(n||"error").toUpperCase();let i=r;s&&(i+=": "+s);const o=new Error(i);o.code=r,e(o)}})}function hG(t,e,n,s,r,i){ro(t,"transaction on "+e);const o={path:e,update:n,onComplete:s,status:null,order:OA(),applyLocally:i,retryCount:0,unwatcher:r,abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},a=Jy(t,e,void 0);o.currentInputSnapshot=a;const c=o.update(a.val());if(c===void 0)o.unwatcher(),o.currentOutputSnapshotRaw=null,o.currentOutputSnapshotResolved=null,o.onComplete&&o.onComplete(null,!1,o.currentInputSnapshot);else{Eu("transaction failed: Data returned ",c,o.path),o.status=0;const l=xf(t.transactionQueueTree_,e),u=Ro(l)||[];u.push(o),Gy(l,u);let h;typeof c=="object"&&c!==null&&xn(c,".priority")?(h=Yi(c,".priority"),O(Ul(h),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.")):h=(Pf(t.serverSyncTree_,e)||te.EMPTY_NODE).getPriority().val();const d=Su(t),f=Je(c,h),p=Ky(f,a,d);o.currentOutputSnapshotRaw=f,o.currentOutputSnapshotResolved=p,o.currentWriteId=Ff(t);const _=Uy(t.serverSyncTree_,e,p,o.currentWriteId,o.applyLocally);zn(t.eventQueue_,e,_),Uf(t,t.transactionQueueTree_)}}function Jy(t,e,n){return Pf(t.serverSyncTree_,e,n)||te.EMPTY_NODE}function Uf(t,e=t.transactionQueueTree_){if(e||$f(t,e),Ro(e)){const n=Kk(t,e);O(n.length>0,"Sending zero length transaction queue"),n.every(r=>r.status===0)&&dG(t,Iu(e),n)}else xk(e)&&Of(e,n=>{Uf(t,n)})}function dG(t,e,n){const s=n.map(l=>l.currentWriteId),r=Jy(t,e,s);let i=r;const o=r.hash();for(let l=0;l<n.length;l++){const u=n[l];O(u.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),u.status=1,u.retryCount++;const h=un(e,u.path);i=i.updateChild(h,u.currentOutputSnapshotRaw)}const a=i.val(!0),c=e;t.server_.put(c.toString(),a,l=>{ro(t,"transaction put response",{path:c.toString(),status:l});let u=[];if(l==="ok"){const h=[];for(let d=0;d<n.length;d++)n[d].status=2,u=u.concat(Fr(t.serverSyncTree_,n[d].currentWriteId)),n[d].onComplete&&h.push(()=>n[d].onComplete(null,!0,n[d].currentOutputSnapshotResolved)),n[d].unwatcher();$f(t,xf(t.transactionQueueTree_,e)),Uf(t,t.transactionQueueTree_),zn(t.eventQueue_,e,u);for(let d=0;d<h.length;d++)Ja(h[d])}else{if(l==="datastale")for(let h=0;h<n.length;h++)n[h].status===3?n[h].status=4:n[h].status=0;else{Xt("transaction at "+c.toString()+" failed: "+l);for(let h=0;h<n.length;h++)n[h].status=4,n[h].abortReason=l}Ra(t,e)}},o)}function Ra(t,e){const n=jk(t,e),s=Iu(n),r=Kk(t,n);return fG(t,r,s),s}function fG(t,e,n){if(e.length===0)return;const s=[];let r=[];const o=e.filter(a=>a.status===0).map(a=>a.currentWriteId);for(let a=0;a<e.length;a++){const c=e[a],l=un(n,c.path);let u=!1,h;if(O(l!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),c.status===4)u=!0,h=c.abortReason,r=r.concat(Fr(t.serverSyncTree_,c.currentWriteId,!0));else if(c.status===0)if(c.retryCount>=ZW)u=!0,h="maxretry",r=r.concat(Fr(t.serverSyncTree_,c.currentWriteId,!0));else{const d=Jy(t,c.path,o);c.currentInputSnapshot=d;const f=e[a].update(d.val());if(f!==void 0){Eu("transaction failed: Data returned ",f,c.path);let p=Je(f);typeof f=="object"&&f!=null&&xn(f,".priority")||(p=p.updatePriority(d.getPriority()));const y=c.currentWriteId,T=Su(t),I=Ky(p,d,T);c.currentOutputSnapshotRaw=p,c.currentOutputSnapshotResolved=I,c.currentWriteId=Ff(t),o.splice(o.indexOf(y),1),r=r.concat(Uy(t.serverSyncTree_,c.path,I,c.currentWriteId,c.applyLocally)),r=r.concat(Fr(t.serverSyncTree_,y,!0))}else u=!0,h="nodata",r=r.concat(Fr(t.serverSyncTree_,c.currentWriteId,!0))}zn(t.eventQueue_,n,r),r=[],u&&(e[a].status=2,function(d){setTimeout(d,Math.floor(0))}(e[a].unwatcher),e[a].onComplete&&(h==="nodata"?s.push(()=>e[a].onComplete(null,!1,e[a].currentInputSnapshot)):s.push(()=>e[a].onComplete(new Error(h),!1,null))))}$f(t,t.transactionQueueTree_);for(let a=0;a<s.length;a++)Ja(s[a]);Uf(t,t.transactionQueueTree_)}function jk(t,e){let n,s=t.transactionQueueTree_;for(n=pe(e);n!==null&&Ro(s)===void 0;)s=xf(s,n),e=Le(e),n=pe(e);return s}function Kk(t,e){const n=[];return Hk(t,e,n),n.sort((s,r)=>s.order-r.order),n}function Hk(t,e,n){const s=Ro(e);if(s)for(let r=0;r<s.length;r++)n.push(s[r]);Of(e,r=>{Hk(t,r,n)})}function $f(t,e){const n=Ro(e);if(n){let s=0;for(let r=0;r<n.length;r++)n[r].status!==2&&(n[s]=n[r],s++);n.length=s,Gy(e,n.length>0?n:void 0)}Of(e,s=>{$f(t,s)})}function Xy(t,e){const n=Iu(jk(t,e)),s=xf(t.transactionQueueTree_,e);return KW(s,r=>{ng(t,r)}),ng(t,s),Ok(s,r=>{ng(t,r)}),n}function ng(t,e){const n=Ro(e);if(n){const s=[];let r=[],i=-1;for(let o=0;o<n.length;o++)n[o].status===3||(n[o].status===1?(O(i===o-1,"All SENT items should be at beginning of queue."),i=o,n[o].status=3,n[o].abortReason="set"):(O(n[o].status===0,"Unexpected transaction status in abort"),n[o].unwatcher(),r=r.concat(Fr(t.serverSyncTree_,n[o].currentWriteId,!0)),n[o].onComplete&&s.push(n[o].onComplete.bind(null,new Error("set"),!1,null))));i===-1?Gy(e,void 0):n.length=i+1,zn(t.eventQueue_,Iu(e),r);for(let o=0;o<s.length;o++)Ja(s[o])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pG(t){let e="";const n=t.split("/");for(let s=0;s<n.length;s++)if(n[s].length>0){let r=n[s];try{r=decodeURIComponent(r.replace(/\+/g," "))}catch{}e+="/"+r}return e}function gG(t){const e={};t.charAt(0)==="?"&&(t=t.substring(1));for(const n of t.split("&")){if(n.length===0)continue;const s=n.split("=");s.length===2?e[decodeURIComponent(s[0])]=decodeURIComponent(s[1]):Xt(`Invalid query segment '${n}' in query '${t}'`)}return e}const km=function(t,e){const n=mG(t),s=n.namespace;n.domain==="firebase.com"&&Ls(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!s||s==="undefined")&&n.domain!=="localhost"&&Ls("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||SK();const r=n.scheme==="ws"||n.scheme==="wss";return{repoInfo:new QA(n.host,n.secure,s,r,e,"",s!==n.subdomain),path:new Ae(n.pathString)}},mG=function(t){let e="",n="",s="",r="",i="",o=!0,a="https",c=443;if(typeof t=="string"){let l=t.indexOf("//");l>=0&&(a=t.substring(0,l-1),t=t.substring(l+2));let u=t.indexOf("/");u===-1&&(u=t.length);let h=t.indexOf("?");h===-1&&(h=t.length),e=t.substring(0,Math.min(u,h)),u<h&&(r=pG(t.substring(u,h)));const d=gG(t.substring(Math.min(t.length,h)));l=e.indexOf(":"),l>=0?(o=a==="https"||a==="wss",c=parseInt(e.substring(l+1),10)):l=e.length;const f=e.slice(0,l);if(f.toLowerCase()==="localhost")n="localhost";else if(f.split(".").length<=2)n=f;else{const p=e.indexOf(".");s=e.substring(0,p).toLowerCase(),n=e.substring(p+1),i=s}"ns"in d&&(i=d.ns)}return{host:e,port:c,domain:n,subdomain:s,secure:o,scheme:a,pathString:r,namespace:i}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wk{constructor(e,n,s,r){this.eventType=e,this.eventRegistration=n,this.snapshot=s,this.prevName=r}getPath(){const e=this.snapshot.ref;return this.eventType==="value"?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+_t(this.snapshot.exportVal())}}class Gk{constructor(e,n,s){this.eventRegistration=e,this.error=n,this.path=s}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zk{constructor(e,n){this.snapshotCallback=e,this.cancelCallback=n}onValue(e,n){this.snapshotCallback.call(null,e,n)}onCancel(e){return O(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||this.snapshotCallback.userCallback!==void 0&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _G{constructor(e,n){this._repo=e,this._path=n}cancel(){const e=new mt;return oG(this._repo,this._path,e.wrapCallback(()=>{})),e.promise}remove(){qn("OnDisconnect.remove",this._path);const e=new mt;return iE(this._repo,this._path,null,e.wrapCallback(()=>{})),e.promise}set(e){qn("OnDisconnect.set",this._path),Us("OnDisconnect.set",e,this._path,!1);const n=new mt;return iE(this._repo,this._path,e,n.wrapCallback(()=>{})),n.promise}setWithPriority(e,n){qn("OnDisconnect.setWithPriority",this._path),Us("OnDisconnect.setWithPriority",e,this._path,!1),zy("OnDisconnect.setWithPriority",n,!1);const s=new mt;return aG(this._repo,this._path,e,n,s.wrapCallback(()=>{})),s.promise}update(e){qn("OnDisconnect.update",this._path),Lk("OnDisconnect.update",e,this._path,!1);const n=new mt;return cG(this._repo,this._path,e,n.wrapCallback(()=>{})),n.promise}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class En{constructor(e,n,s,r){this._repo=e,this._path=n,this._queryParams=s,this._orderByCalled=r}get key(){return ge(this._path)?null:Ey(this._path)}get ref(){return new Yn(this._repo,this._path)}get _queryIdentifier(){const e=KI(this._queryParams),n=yy(e);return n==="{}"?"default":n}get _queryObject(){return KI(this._queryParams)}isEqual(e){if(e=N(e),!(e instanceof En))return!1;const n=this._repo===e._repo,s=Ty(this._path,e._path),r=this._queryIdentifier===e._queryIdentifier;return n&&s&&r}toJSON(){return this.toString()}toString(){return this._repo.toString()+oH(this._path)}}function Vf(t,e){if(t._orderByCalled===!0)throw new Error(e+": You can't combine multiple orderBy calls.")}function li(t){let e=null,n=null;if(t.hasStart()&&(e=t.getIndexStartValue()),t.hasEnd()&&(n=t.getIndexEndValue()),t.getIndex()===Rs){const s="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",r="Query: When ordering by key, the argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() must be a string.";if(t.hasStart()){if(t.getIndexStartName()!==lr)throw new Error(s);if(typeof e!="string")throw new Error(r)}if(t.hasEnd()){if(t.getIndexEndName()!==Fs)throw new Error(s);if(typeof n!="string")throw new Error(r)}}else if(t.getIndex()===je){if(e!=null&&!Ul(e)||n!=null&&!Ul(n))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), startAfter() endAt(), endBefore(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if(O(t.getIndex()instanceof Ay||t.getIndex()===ky,"unknown index type."),e!=null&&typeof e=="object"||n!=null&&typeof n=="object")throw new Error("Query: First argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() cannot be an object.")}function Bf(t){if(t.hasStart()&&t.hasEnd()&&t.hasLimit()&&!t.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), startAfter(), endAt(), endBefore(), and limit(). Use limitToFirst() or limitToLast() instead.")}class Yn extends En{constructor(e,n){super(e,n,new Cf,!1)}get parent(){const e=rk(this._path);return e===null?null:new Yn(this._repo,e)}get root(){let e=this;for(;e.parent!==null;)e=e.parent;return e}}class io{constructor(e,n,s){this._node=e,this.ref=n,this._index=s}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){const n=new Ae(e),s=oo(this.ref,e);return new io(this._node.getChild(n),s,je)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return this._node.isLeafNode()?!1:!!this._node.forEachChild(this._index,(s,r)=>e(new io(r,oo(this.ref,s),je)))}hasChild(e){const n=new Ae(e);return!this._node.getChild(n).isEmpty()}hasChildren(){return this._node.isLeafNode()?!1:!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}}function Qk(t,e){return t=N(t),t._checkNotDeleted("ref"),e!==void 0?oo(t._root,e):t._root}function oE(t,e){t=N(t),t._checkNotDeleted("refFromURL");const n=km(e,t._repo.repoInfo_.nodeAdmin);Fk("refFromURL",n);const s=n.repoInfo;return!t._repo.repoInfo_.isCustomHost()&&s.host!==t._repo.repoInfo_.host&&Ls("refFromURL: Host name does not match the current database: (found "+s.host+" but expected "+t._repo.repoInfo_.host+")"),Qk(t,n.path.toString())}function oo(t,e){return t=N(t),pe(t._path)===null?YW("child","path",e,!1):$l("child","path",e,!1),new Yn(t._repo,ze(t._path,e))}function yG(t,e){t=N(t),qn("push",t._path),Us("push",e,t._path,!0);const n=Bk(t._repo),s=CH(n),r=oo(t,s),i=oo(t,s);let o;return e!=null?o=Zy(i,e).then(()=>i):o=Promise.resolve(i),r.then=o.then.bind(o),r.catch=o.then.bind(o,void 0),r}function vG(t){return qn("remove",t._path),Zy(t,null)}function Zy(t,e){t=N(t),qn("set",t._path),Us("set",e,t._path,!1);const n=new mt;return Yy(t._repo,t._path,e,null,n.wrapCallback(()=>{})),n.promise}function wG(t,e){t=N(t),qn("setPriority",t._path),zy("setPriority",e,!1);const n=new mt;return Yy(t._repo,ze(t._path,".priority"),e,null,n.wrapCallback(()=>{})),n.promise}function bG(t,e,n){if(qn("setWithPriority",t._path),Us("setWithPriority",e,t._path,!1),zy("setWithPriority",n,!1),t.key===".length"||t.key===".keys")throw"setWithPriority failed: "+t.key+" is a read-only object.";const s=new mt;return Yy(t._repo,t._path,e,n,s.wrapCallback(()=>{})),s.promise}function IG(t,e){Lk("update",e,t._path,!1);const n=new mt;return rG(t._repo,t._path,e,n.wrapCallback(()=>{})),n.promise}function EG(t){return t=N(t),sG(t._repo,t).then(e=>new io(e,new Yn(t._repo,t._path),t._queryParams.getIndex()))}class qf{constructor(e){this.callbackContext=e}respondsTo(e){return e==="value"}createEvent(e,n){const s=n._queryParams.getIndex();return new Wk("value",this,new io(e.snapshotNode,new Yn(n._repo,n._path),s))}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,n){return this.callbackContext.hasCancelCallback?new Gk(this,e,n):null}matches(e){return e instanceof qf?!e.callbackContext||!this.callbackContext?!0:e.callbackContext.matches(this.callbackContext):!1}hasAnyCallback(){return this.callbackContext!==null}}class jf{constructor(e,n){this.eventType=e,this.callbackContext=n}respondsTo(e){let n=e==="children_added"?"child_added":e;return n=n==="children_removed"?"child_removed":n,this.eventType===n}createCancelEvent(e,n){return this.callbackContext.hasCancelCallback?new Gk(this,e,n):null}createEvent(e,n){O(e.childName!=null,"Child events should have a childName.");const s=oo(new Yn(n._repo,n._path),e.childName),r=n._queryParams.getIndex();return new Wk(e.type,this,new io(e.snapshotNode,s,r),e.prevName)}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,e.prevName)}matches(e){return e instanceof jf?this.eventType===e.eventType&&(!this.callbackContext||!e.callbackContext||this.callbackContext.matches(e.callbackContext)):!1}hasAnyCallback(){return!!this.callbackContext}}function Cu(t,e,n,s,r){let i;if(typeof s=="object"&&(i=void 0,r=s),typeof s=="function"&&(i=s),r&&r.onlyOnce){const c=n,l=(u,h)=>{Am(t._repo,t,a),c(u,h)};l.userCallback=n.userCallback,l.context=n.context,n=l}const o=new zk(n,i||void 0),a=e==="value"?new qf(o):new jf(e,o);return lG(t._repo,t,a),()=>Am(t._repo,t,a)}function Rm(t,e,n,s){return Cu(t,"value",e,n,s)}function aE(t,e,n,s){return Cu(t,"child_added",e,n,s)}function cE(t,e,n,s){return Cu(t,"child_changed",e,n,s)}function lE(t,e,n,s){return Cu(t,"child_moved",e,n,s)}function uE(t,e,n,s){return Cu(t,"child_removed",e,n,s)}function hE(t,e,n){let s=null;const r=n?new zk(n):null;e==="value"?s=new qf(r):e&&(s=new jf(e,r)),Am(t._repo,t,s)}class fs{}class Yk extends fs{constructor(e,n){super(),this._value=e,this._key=n}_apply(e){Us("endAt",this._value,e._path,!0);const n=ym(e._queryParams,this._value,this._key);if(Bf(n),li(n),e._queryParams.hasEnd())throw new Error("endAt: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new En(e._repo,e._path,n,e._orderByCalled)}}function TG(t,e){return Tu("endAt","key",e,!0),new Yk(t,e)}class SG extends fs{constructor(e,n){super(),this._value=e,this._key=n}_apply(e){Us("endBefore",this._value,e._path,!1);const n=xH(e._queryParams,this._value,this._key);if(Bf(n),li(n),e._queryParams.hasEnd())throw new Error("endBefore: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new En(e._repo,e._path,n,e._orderByCalled)}}function CG(t,e){return Tu("endBefore","key",e,!0),new SG(t,e)}class Jk extends fs{constructor(e,n){super(),this._value=e,this._key=n}_apply(e){Us("startAt",this._value,e._path,!0);const n=_m(e._queryParams,this._value,this._key);if(Bf(n),li(n),e._queryParams.hasStart())throw new Error("startAt: Starting point was already set (by another call to startAt, startBefore or equalTo).");return new En(e._repo,e._path,n,e._orderByCalled)}}function AG(t=null,e){return Tu("startAt","key",e,!0),new Jk(t,e)}class kG extends fs{constructor(e,n){super(),this._value=e,this._key=n}_apply(e){Us("startAfter",this._value,e._path,!1);const n=DH(e._queryParams,this._value,this._key);if(Bf(n),li(n),e._queryParams.hasStart())throw new Error("startAfter: Starting point was already set (by another call to startAt, startAfter, or equalTo).");return new En(e._repo,e._path,n,e._orderByCalled)}}function RG(t,e){return Tu("startAfter","key",e,!0),new kG(t,e)}class NG extends fs{constructor(e){super(),this._limit=e}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToFirst: Limit was already set (by another call to limitToFirst or limitToLast).");return new En(e._repo,e._path,NH(e._queryParams,this._limit),e._orderByCalled)}}function PG(t){if(typeof t!="number"||Math.floor(t)!==t||t<=0)throw new Error("limitToFirst: First argument must be a positive integer.");return new NG(t)}class DG extends fs{constructor(e){super(),this._limit=e}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToLast: Limit was already set (by another call to limitToFirst or limitToLast).");return new En(e._repo,e._path,PH(e._queryParams,this._limit),e._orderByCalled)}}function xG(t){if(typeof t!="number"||Math.floor(t)!==t||t<=0)throw new Error("limitToLast: First argument must be a positive integer.");return new DG(t)}class OG extends fs{constructor(e){super(),this._path=e}_apply(e){Vf(e,"orderByChild");const n=new Ae(this._path);if(ge(n))throw new Error("orderByChild: cannot pass in empty path. Use orderByValue() instead.");const s=new Ay(n),r=Af(e._queryParams,s);return li(r),new En(e._repo,e._path,r,!0)}}function MG(t){if(t==="$key")throw new Error('orderByChild: "$key" is invalid.  Use orderByKey() instead.');if(t==="$priority")throw new Error('orderByChild: "$priority" is invalid.  Use orderByPriority() instead.');if(t==="$value")throw new Error('orderByChild: "$value" is invalid.  Use orderByValue() instead.');return $l("orderByChild","path",t,!1),new OG(t)}class LG extends fs{_apply(e){Vf(e,"orderByKey");const n=Af(e._queryParams,Rs);return li(n),new En(e._repo,e._path,n,!0)}}function FG(){return new LG}class UG extends fs{_apply(e){Vf(e,"orderByPriority");const n=Af(e._queryParams,je);return li(n),new En(e._repo,e._path,n,!0)}}function $G(){return new UG}class VG extends fs{_apply(e){Vf(e,"orderByValue");const n=Af(e._queryParams,ky);return li(n),new En(e._repo,e._path,n,!0)}}function BG(){return new VG}class qG extends fs{constructor(e,n){super(),this._value=e,this._key=n}_apply(e){if(Us("equalTo",this._value,e._path,!1),e._queryParams.hasStart())throw new Error("equalTo: Starting point was already set (by another call to startAt/startAfter or equalTo).");if(e._queryParams.hasEnd())throw new Error("equalTo: Ending point was already set (by another call to endAt/endBefore or equalTo).");return new Yk(this._value,this._key)._apply(new Jk(this._value,this._key)._apply(e))}}function jG(t,e){return Tu("equalTo","key",e,!0),new qG(t,e)}function Xn(t,...e){let n=N(t);for(const s of e)n=s._apply(n);return n}bW(Yn);CW(Yn);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KG="FIREBASE_DATABASE_EMULATOR_HOST",Nm={};let HG=!1;function WG(t,e,n,s){t.repoInfo_=new QA(`${e}:${n}`,!1,t.repoInfo_.namespace,t.repoInfo_.webSocketOnly,t.repoInfo_.nodeAdmin,t.repoInfo_.persistenceKey,t.repoInfo_.includeNamespaceInQueryParams),s&&(t.authTokenProvider_=s)}function Xk(t,e,n,s,r){let i=s||t.options.databaseURL;i===void 0&&(t.options.projectId||Ls("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),Ct("Using default host for project ",t.options.projectId),i=`${t.options.projectId}-default-rtdb.firebaseio.com`);let o=km(i,r),a=o.repoInfo,c,l;typeof process!="undefined"&&process.env&&(l=process.env[KG]),l?(c=!0,i=`http://${l}?ns=${a.namespace}`,o=km(i,r),a=o.repoInfo):c=!o.repoInfo.secure;const u=r&&c?new ca(ca.OWNER):new OK(t.name,t.options,e);Fk("Invalid Firebase Database URL",o),ge(o.path)||Ls("Database URL must point to the root of a Firebase Database (not including a child path).");const h=zG(a,t,u,new xK(t.name,n));return new QG(h,t)}function GG(t,e){const n=Nm[e];(!n||n[t.key]!==t)&&Ls(`Database ${e}(${t.repoInfo_}) has already been deleted.`),qk(t),delete n[t.key]}function zG(t,e,n,s){let r=Nm[e.name];r||(r={},Nm[e.name]=r);let i=r[t.toURLString()];return i&&Ls("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),i=new eG(t,HG,n,s),r[t.toURLString()]=i,i}class QG{constructor(e,n){this._repoInternal=e,this.app=n,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(tG(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new Yn(this._repo,Te())),this._rootInternal}_delete(){return this._rootInternal!==null&&(GG(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){this._rootInternal===null&&Ls("Cannot call "+e+" on a deleted database.")}}function Zk(){Ta.IS_TRANSPORT_INITIALIZED&&Xt("Transport has already been initialized. Please call this function before calling ref or setting up a listener")}function YG(){Zk(),Lr.forceDisallow()}function JG(){Zk(),$n.forceDisallow(),Lr.forceAllow()}function XG(t,e,n,s={}){t=N(t),t._checkNotDeleted("useEmulator"),t._instanceStarted&&Ls("Cannot call useEmulator() after instance has already been initialized.");const r=t._repoInternal;let i;if(r.repoInfo_.nodeAdmin)s.mockUserToken&&Ls('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),i=new ca(ca.OWNER);else if(s.mockUserToken){const o=typeof s.mockUserToken=="string"?s.mockUserToken:U_(s.mockUserToken,t.app.options.projectId);i=new ca(o)}WG(r,e,n,i)}function ZG(t){t=N(t),t._checkNotDeleted("goOffline"),qk(t._repo)}function ez(t){t=N(t),t._checkNotDeleted("goOnline"),uG(t._repo)}function tz(t,e){LA(t,e)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nz(t){DA(Ks),rt(new Ee("database",(e,{instanceIdentifier:n})=>{const s=e.getProvider("app").getImmediate(),r=e.getProvider("auth-internal"),i=e.getProvider("app-check-internal");return Xk(s,r,i,n)},"PUBLIC").setMultipleInstances(!0)),Fe(CI,AI,t),Fe(CI,AI,"esm2017")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sz={".sv":"timestamp"};function rz(){return sz}function iz(t){return{".sv":{increment:t}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oz{constructor(e,n){this.committed=e,this.snapshot=n}toJSON(){return{committed:this.committed,snapshot:this.snapshot.toJSON()}}}function az(t,e,n){var s;if(t=N(t),qn("Reference.transaction",t._path),t.key===".length"||t.key===".keys")throw"Reference.transaction failed: "+t.key+" is a read-only object.";const r=(s=n==null?void 0:n.applyLocally)!==null&&s!==void 0?s:!0,i=new mt,o=(c,l,u)=>{let h=null;c?i.reject(c):(h=new io(u,new Yn(t._repo,t._path),je),i.resolve(new oz(l,h)))},a=Rm(t,()=>{});return hG(t._repo,t._path,e,o,a,r),i.promise}rr.prototype.simpleListen=function(t,e){this.sendRequest("q",{p:t},e)};rr.prototype.echo=function(t,e){this.sendRequest("echo",{d:t},e)};nz();const cz="@firebase/database-compat",lz="0.2.3";/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uz=new js("@firebase/database-compat"),eR=function(t){const e="FIREBASE WARNING: "+t;uz.warn(e)};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hz=function(t,e,n,s){if(!(s&&n===void 0)&&typeof n!="boolean")throw new Error(bn(t,e)+"must be a boolean.")},dz=function(t,e,n){if(!(n&&e===void 0))switch(e){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:throw new Error(bn(t,"eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fz{constructor(e){this._delegate=e}cancel(e){se("OnDisconnect.cancel",0,1,arguments.length),Et("OnDisconnect.cancel","onComplete",e,!0);const n=this._delegate.cancel();return e&&n.then(()=>e(null),s=>e(s)),n}remove(e){se("OnDisconnect.remove",0,1,arguments.length),Et("OnDisconnect.remove","onComplete",e,!0);const n=this._delegate.remove();return e&&n.then(()=>e(null),s=>e(s)),n}set(e,n){se("OnDisconnect.set",1,2,arguments.length),Et("OnDisconnect.set","onComplete",n,!0);const s=this._delegate.set(e);return n&&s.then(()=>n(null),r=>n(r)),s}setWithPriority(e,n,s){se("OnDisconnect.setWithPriority",2,3,arguments.length),Et("OnDisconnect.setWithPriority","onComplete",s,!0);const r=this._delegate.setWithPriority(e,n);return s&&r.then(()=>s(null),i=>s(i)),r}update(e,n){if(se("OnDisconnect.update",1,2,arguments.length),Array.isArray(e)){const r={};for(let i=0;i<e.length;++i)r[""+i]=e[i];e=r,eR("Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}Et("OnDisconnect.update","onComplete",n,!0);const s=this._delegate.update(e);return n&&s.then(()=>n(null),r=>n(r)),s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pz{constructor(e,n){this.committed=e,this.snapshot=n}toJSON(){return se("TransactionResult.toJSON",0,1,arguments.length),{committed:this.committed,snapshot:this.snapshot.toJSON()}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kr{constructor(e,n){this._database=e,this._delegate=n}val(){return se("DataSnapshot.val",0,0,arguments.length),this._delegate.val()}exportVal(){return se("DataSnapshot.exportVal",0,0,arguments.length),this._delegate.exportVal()}toJSON(){return se("DataSnapshot.toJSON",0,1,arguments.length),this._delegate.toJSON()}exists(){return se("DataSnapshot.exists",0,0,arguments.length),this._delegate.exists()}child(e){return se("DataSnapshot.child",0,1,arguments.length),e=String(e),$l("DataSnapshot.child","path",e,!1),new Kr(this._database,this._delegate.child(e))}hasChild(e){return se("DataSnapshot.hasChild",1,1,arguments.length),$l("DataSnapshot.hasChild","path",e,!1),this._delegate.hasChild(e)}getPriority(){return se("DataSnapshot.getPriority",0,0,arguments.length),this._delegate.priority}forEach(e){return se("DataSnapshot.forEach",1,1,arguments.length),Et("DataSnapshot.forEach","action",e,!1),this._delegate.forEach(n=>e(new Kr(this._database,n)))}hasChildren(){return se("DataSnapshot.hasChildren",0,0,arguments.length),this._delegate.hasChildren()}get key(){return this._delegate.key}numChildren(){return se("DataSnapshot.numChildren",0,0,arguments.length),this._delegate.size}getRef(){return se("DataSnapshot.ref",0,0,arguments.length),new kn(this._database,this._delegate.ref)}get ref(){return this.getRef()}}class Ut{constructor(e,n){this.database=e,this._delegate=n}on(e,n,s,r){var i;se("Query.on",2,4,arguments.length),Et("Query.on","callback",n,!1);const o=Ut.getCancelAndContextArgs_("Query.on",s,r),a=(l,u)=>{n.call(o.context,new Kr(this.database,l),u)};a.userCallback=n,a.context=o.context;const c=(i=o.cancel)===null||i===void 0?void 0:i.bind(o.context);switch(e){case"value":return Rm(this._delegate,a,c),n;case"child_added":return aE(this._delegate,a,c),n;case"child_removed":return uE(this._delegate,a,c),n;case"child_changed":return cE(this._delegate,a,c),n;case"child_moved":return lE(this._delegate,a,c),n;default:throw new Error(bn("Query.on","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}}off(e,n,s){if(se("Query.off",0,3,arguments.length),dz("Query.off",e,!0),Et("Query.off","callback",n,!0),Bb("Query.off","context",s,!0),n){const r=()=>{};r.userCallback=n,r.context=s,hE(this._delegate,e,r)}else hE(this._delegate,e)}get(){return EG(this._delegate).then(e=>new Kr(this.database,e))}once(e,n,s,r){se("Query.once",1,4,arguments.length),Et("Query.once","callback",n,!0);const i=Ut.getCancelAndContextArgs_("Query.once",s,r),o=new mt,a=(l,u)=>{const h=new Kr(this.database,l);n&&n.call(i.context,h,u),o.resolve(h)};a.userCallback=n,a.context=i.context;const c=l=>{i.cancel&&i.cancel.call(i.context,l),o.reject(l)};switch(e){case"value":Rm(this._delegate,a,c,{onlyOnce:!0});break;case"child_added":aE(this._delegate,a,c,{onlyOnce:!0});break;case"child_removed":uE(this._delegate,a,c,{onlyOnce:!0});break;case"child_changed":cE(this._delegate,a,c,{onlyOnce:!0});break;case"child_moved":lE(this._delegate,a,c,{onlyOnce:!0});break;default:throw new Error(bn("Query.once","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}return o.promise}limitToFirst(e){return se("Query.limitToFirst",1,1,arguments.length),new Ut(this.database,Xn(this._delegate,PG(e)))}limitToLast(e){return se("Query.limitToLast",1,1,arguments.length),new Ut(this.database,Xn(this._delegate,xG(e)))}orderByChild(e){return se("Query.orderByChild",1,1,arguments.length),new Ut(this.database,Xn(this._delegate,MG(e)))}orderByKey(){return se("Query.orderByKey",0,0,arguments.length),new Ut(this.database,Xn(this._delegate,FG()))}orderByPriority(){return se("Query.orderByPriority",0,0,arguments.length),new Ut(this.database,Xn(this._delegate,$G()))}orderByValue(){return se("Query.orderByValue",0,0,arguments.length),new Ut(this.database,Xn(this._delegate,BG()))}startAt(e=null,n){return se("Query.startAt",0,2,arguments.length),new Ut(this.database,Xn(this._delegate,AG(e,n)))}startAfter(e=null,n){return se("Query.startAfter",0,2,arguments.length),new Ut(this.database,Xn(this._delegate,RG(e,n)))}endAt(e=null,n){return se("Query.endAt",0,2,arguments.length),new Ut(this.database,Xn(this._delegate,TG(e,n)))}endBefore(e=null,n){return se("Query.endBefore",0,2,arguments.length),new Ut(this.database,Xn(this._delegate,CG(e,n)))}equalTo(e,n){return se("Query.equalTo",1,2,arguments.length),new Ut(this.database,Xn(this._delegate,jG(e,n)))}toString(){return se("Query.toString",0,0,arguments.length),this._delegate.toString()}toJSON(){return se("Query.toJSON",0,1,arguments.length),this._delegate.toJSON()}isEqual(e){if(se("Query.isEqual",1,1,arguments.length),!(e instanceof Ut)){const n="Query.isEqual failed: First argument must be an instance of firebase.database.Query.";throw new Error(n)}return this._delegate.isEqual(e._delegate)}static getCancelAndContextArgs_(e,n,s){const r={cancel:void 0,context:void 0};if(n&&s)r.cancel=n,Et(e,"cancel",r.cancel,!0),r.context=s,Bb(e,"context",r.context,!0);else if(n)if(typeof n=="object"&&n!==null)r.context=n;else if(typeof n=="function")r.cancel=n;else throw new Error(bn(e,"cancelOrContext")+" must either be a cancel callback or a context object.");return r}get ref(){return new kn(this.database,new Yn(this._delegate._repo,this._delegate._path))}}class kn extends Ut{constructor(e,n){super(e,new En(n._repo,n._path,new Cf,!1)),this.database=e,this._delegate=n}getKey(){return se("Reference.key",0,0,arguments.length),this._delegate.key}child(e){return se("Reference.child",1,1,arguments.length),typeof e=="number"&&(e=String(e)),new kn(this.database,oo(this._delegate,e))}getParent(){se("Reference.parent",0,0,arguments.length);const e=this._delegate.parent;return e?new kn(this.database,e):null}getRoot(){return se("Reference.root",0,0,arguments.length),new kn(this.database,this._delegate.root)}set(e,n){se("Reference.set",1,2,arguments.length),Et("Reference.set","onComplete",n,!0);const s=Zy(this._delegate,e);return n&&s.then(()=>n(null),r=>n(r)),s}update(e,n){if(se("Reference.update",1,2,arguments.length),Array.isArray(e)){const r={};for(let i=0;i<e.length;++i)r[""+i]=e[i];e=r,eR("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}qn("Reference.update",this._delegate._path),Et("Reference.update","onComplete",n,!0);const s=IG(this._delegate,e);return n&&s.then(()=>n(null),r=>n(r)),s}setWithPriority(e,n,s){se("Reference.setWithPriority",2,3,arguments.length),Et("Reference.setWithPriority","onComplete",s,!0);const r=bG(this._delegate,e,n);return s&&r.then(()=>s(null),i=>s(i)),r}remove(e){se("Reference.remove",0,1,arguments.length),Et("Reference.remove","onComplete",e,!0);const n=vG(this._delegate);return e&&n.then(()=>e(null),s=>e(s)),n}transaction(e,n,s){se("Reference.transaction",1,3,arguments.length),Et("Reference.transaction","transactionUpdate",e,!1),Et("Reference.transaction","onComplete",n,!0),hz("Reference.transaction","applyLocally",s,!0);const r=az(this._delegate,e,{applyLocally:s}).then(i=>new pz(i.committed,new Kr(this.database,i.snapshot)));return n&&r.then(i=>n(null,i.committed,i.snapshot),i=>n(i,!1,null)),r}setPriority(e,n){se("Reference.setPriority",1,2,arguments.length),Et("Reference.setPriority","onComplete",n,!0);const s=wG(this._delegate,e);return n&&s.then(()=>n(null),r=>n(r)),s}push(e,n){se("Reference.push",0,2,arguments.length),Et("Reference.push","onComplete",n,!0);const s=yG(this._delegate,e),r=s.then(o=>new kn(this.database,o));n&&r.then(()=>n(null),o=>n(o));const i=new kn(this.database,s);return i.then=r.then.bind(r),i.catch=r.catch.bind(r,void 0),i}onDisconnect(){return qn("Reference.onDisconnect",this._delegate._path),new fz(new _G(this._delegate._repo,this._delegate._path))}get key(){return this.getKey()}get parent(){return this.getParent()}get root(){return this.getRoot()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vl{constructor(e,n){this._delegate=e,this.app=n,this.INTERNAL={delete:()=>this._delegate._delete(),forceWebSockets:YG,forceLongPolling:JG}}useEmulator(e,n,s={}){XG(this._delegate,e,n,s)}ref(e){if(se("database.ref",0,1,arguments.length),e instanceof kn){const n=oE(this._delegate,e.toString());return new kn(this,n)}else{const n=Qk(this._delegate,e);return new kn(this,n)}}refFromURL(e){se("database.refFromURL",1,1,arguments.length);const s=oE(this._delegate,e);return new kn(this,s)}goOffline(){return se("database.goOffline",0,0,arguments.length),ZG(this._delegate)}goOnline(){return se("database.goOnline",0,0,arguments.length),ez(this._delegate)}}Vl.ServerValue={TIMESTAMP:rz(),increment:t=>iz(t)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gz({app:t,url:e,version:n,customAuthImpl:s,namespace:r,nodeAdmin:i=!1}){DA(n);const o=new O0("auth-internal",new M0("database-standalone"));return o.setComponent(new Ee("auth-internal",()=>s,"PRIVATE")),{instance:new Vl(Xk(t,o,void 0,e,i),t),namespace:r}}var mz=Object.freeze({__proto__:null,initStandalone:gz});/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _z=Vl.ServerValue;function yz(t){t.INTERNAL.registerComponent(new Ee("database-compat",(e,{instanceIdentifier:n})=>{const s=e.getProvider("app-compat").getImmediate(),r=e.getProvider("database").getImmediate({identifier:n});return new Vl(r,s)},"PUBLIC").setServiceProps({Reference:kn,Query:Ut,Database:Vl,DataSnapshot:Kr,enableLogging:tz,INTERNAL:mz,ServerValue:_z}).setMultipleInstances(!0)),t.registerVersion(cz,lz)}yz(ht);var vz=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{},W,ev=ev||{},oe=vz||self;function _d(){}function Pm(t){var e=typeof t;return e=e!="object"?e:t?Array.isArray(t)?"array":e:"null",e=="array"||e=="object"&&typeof t.length=="number"}function Au(t){var e=typeof t;return e=="object"&&t!=null||e=="function"}function wz(t){return Object.prototype.hasOwnProperty.call(t,sg)&&t[sg]||(t[sg]=++bz)}var sg="closure_uid_"+(1e9*Math.random()>>>0),bz=0;function Iz(t,e,n){return t.call.apply(t.bind,arguments)}function Ez(t,e,n){if(!t)throw Error();if(2<arguments.length){var s=Array.prototype.slice.call(arguments,2);return function(){var r=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(r,s),t.apply(e,r)}}return function(){return t.apply(e,arguments)}}function Ht(t,e,n){return Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?Ht=Iz:Ht=Ez,Ht.apply(null,arguments)}function ih(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var s=n.slice();return s.push.apply(s,arguments),t.apply(this,s)}}function Qt(t,e){function n(){}n.prototype=e.prototype,t.Z=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.Vb=function(s,r,i){for(var o=Array(arguments.length-2),a=2;a<arguments.length;a++)o[a-2]=arguments[a];return e.prototype[r].apply(s,o)}}function ui(){this.s=this.s,this.o=this.o}var Tz=0;ui.prototype.s=!1;ui.prototype.na=function(){!this.s&&(this.s=!0,this.M(),Tz!=0)&&wz(this)};ui.prototype.M=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const tR=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if(typeof t=="string")return typeof e!="string"||e.length!=1?-1:t.indexOf(e,0);for(let n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},nR=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){const s=t.length,r=typeof t=="string"?t.split(""):t;for(let i=0;i<s;i++)i in r&&e.call(n,r[i],i,t)};function Sz(t){e:{var e=m2;const n=t.length,s=typeof t=="string"?t.split(""):t;for(let r=0;r<n;r++)if(r in s&&e.call(void 0,s[r],r,t)){e=r;break e}e=-1}return 0>e?null:typeof t=="string"?t.charAt(e):t[e]}function dE(t){return Array.prototype.concat.apply([],arguments)}function tv(t){const e=t.length;if(0<e){const n=Array(e);for(let s=0;s<e;s++)n[s]=t[s];return n}return[]}function yd(t){return/^[\s\xa0]*$/.test(t)}var fE=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function an(t,e){return t.indexOf(e)!=-1}function rg(t,e){return t<e?-1:t>e?1:0}var cn;e:{var pE=oe.navigator;if(pE){var gE=pE.userAgent;if(gE){cn=gE;break e}}cn=""}function nv(t,e,n){for(const s in t)e.call(n,t[s],s,t)}function sR(t){const e={};for(const n in t)e[n]=t[n];return e}var mE="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function rR(t,e){let n,s;for(let r=1;r<arguments.length;r++){s=arguments[r];for(n in s)t[n]=s[n];for(let i=0;i<mE.length;i++)n=mE[i],Object.prototype.hasOwnProperty.call(s,n)&&(t[n]=s[n])}}function sv(t){return sv[" "](t),t}sv[" "]=_d;function Cz(t){var e=Rz;return Object.prototype.hasOwnProperty.call(e,9)?e[9]:e[9]=t(9)}var Az=an(cn,"Opera"),Na=an(cn,"Trident")||an(cn,"MSIE"),iR=an(cn,"Edge"),Dm=iR||Na,oR=an(cn,"Gecko")&&!(an(cn.toLowerCase(),"webkit")&&!an(cn,"Edge"))&&!(an(cn,"Trident")||an(cn,"MSIE"))&&!an(cn,"Edge"),kz=an(cn.toLowerCase(),"webkit")&&!an(cn,"Edge");function aR(){var t=oe.document;return t?t.documentMode:void 0}var vd;e:{var ig="",og=function(){var t=cn;if(oR)return/rv:([^\);]+)(\)|;)/.exec(t);if(iR)return/Edge\/([\d\.]+)/.exec(t);if(Na)return/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(t);if(kz)return/WebKit\/(\S+)/.exec(t);if(Az)return/(?:Version)[ \/]?(\S+)/.exec(t)}();if(og&&(ig=og?og[1]:""),Na){var ag=aR();if(ag!=null&&ag>parseFloat(ig)){vd=String(ag);break e}}vd=ig}var Rz={};function Nz(){return Cz(function(){let t=0;const e=fE(String(vd)).split("."),n=fE("9").split("."),s=Math.max(e.length,n.length);for(let o=0;t==0&&o<s;o++){var r=e[o]||"",i=n[o]||"";do{if(r=/(\d*)(\D*)(.*)/.exec(r)||["","","",""],i=/(\d*)(\D*)(.*)/.exec(i)||["","","",""],r[0].length==0&&i[0].length==0)break;t=rg(r[1].length==0?0:parseInt(r[1],10),i[1].length==0?0:parseInt(i[1],10))||rg(r[2].length==0,i[2].length==0)||rg(r[2],i[2]),r=r[3],i=i[3]}while(t==0)}return 0<=t})}var xm;if(oe.document&&Na){var _E=aR();xm=_E||parseInt(vd,10)||void 0}else xm=void 0;var Pz=xm,Dz=function(){if(!oe.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{oe.addEventListener("test",_d,e),oe.removeEventListener("test",_d,e)}catch{}return t}();function Zt(t,e){this.type=t,this.g=this.target=e,this.defaultPrevented=!1}Zt.prototype.h=function(){this.defaultPrevented=!0};function Bl(t,e){if(Zt.call(this,t?t.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,t){var n=this.type=t.type,s=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.g=e,e=t.relatedTarget){if(oR){e:{try{sv(e.nodeName);var r=!0;break e}catch{}r=!1}r||(e=null)}}else n=="mouseover"?e=t.fromElement:n=="mouseout"&&(e=t.toElement);this.relatedTarget=e,s?(this.clientX=s.clientX!==void 0?s.clientX:s.pageX,this.clientY=s.clientY!==void 0?s.clientY:s.pageY,this.screenX=s.screenX||0,this.screenY=s.screenY||0):(this.clientX=t.clientX!==void 0?t.clientX:t.pageX,this.clientY=t.clientY!==void 0?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType=typeof t.pointerType=="string"?t.pointerType:xz[t.pointerType]||"",this.state=t.state,this.i=t,t.defaultPrevented&&Bl.Z.h.call(this)}}Qt(Bl,Zt);var xz={2:"touch",3:"pen",4:"mouse"};Bl.prototype.h=function(){Bl.Z.h.call(this);var t=this.i;t.preventDefault?t.preventDefault():t.returnValue=!1};var ku="closure_listenable_"+(1e6*Math.random()|0),Oz=0;function Mz(t,e,n,s,r){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!s,this.ia=r,this.key=++Oz,this.ca=this.fa=!1}function Kf(t){t.ca=!0,t.listener=null,t.proxy=null,t.src=null,t.ia=null}function Hf(t){this.src=t,this.g={},this.h=0}Hf.prototype.add=function(t,e,n,s,r){var i=t.toString();t=this.g[i],t||(t=this.g[i]=[],this.h++);var o=Mm(t,e,s,r);return-1<o?(e=t[o],n||(e.fa=!1)):(e=new Mz(e,this.src,i,!!s,r),e.fa=n,t.push(e)),e};function Om(t,e){var n=e.type;if(n in t.g){var s=t.g[n],r=tR(s,e),i;(i=0<=r)&&Array.prototype.splice.call(s,r,1),i&&(Kf(e),t.g[n].length==0&&(delete t.g[n],t.h--))}}function Mm(t,e,n,s){for(var r=0;r<t.length;++r){var i=t[r];if(!i.ca&&i.listener==e&&i.capture==!!n&&i.ia==s)return r}return-1}var rv="closure_lm_"+(1e6*Math.random()|0),cg={};function cR(t,e,n,s,r){if(s&&s.once)return uR(t,e,n,s,r);if(Array.isArray(e)){for(var i=0;i<e.length;i++)cR(t,e[i],n,s,r);return null}return n=av(n),t&&t[ku]?t.N(e,n,Au(s)?!!s.capture:!!s,r):lR(t,e,n,!1,s,r)}function lR(t,e,n,s,r,i){if(!e)throw Error("Invalid event type");var o=Au(r)?!!r.capture:!!r,a=ov(t);if(a||(t[rv]=a=new Hf(t)),n=a.add(e,n,s,o,i),n.proxy)return n;if(s=Lz(),n.proxy=s,s.src=t,s.listener=n,t.addEventListener)Dz||(r=o),r===void 0&&(r=!1),t.addEventListener(e.toString(),s,r);else if(t.attachEvent)t.attachEvent(dR(e.toString()),s);else if(t.addListener&&t.removeListener)t.addListener(s);else throw Error("addEventListener and attachEvent are unavailable.");return n}function Lz(){function t(n){return e.call(t.src,t.listener,n)}var e=Fz;return t}function uR(t,e,n,s,r){if(Array.isArray(e)){for(var i=0;i<e.length;i++)uR(t,e[i],n,s,r);return null}return n=av(n),t&&t[ku]?t.O(e,n,Au(s)?!!s.capture:!!s,r):lR(t,e,n,!0,s,r)}function hR(t,e,n,s,r){if(Array.isArray(e))for(var i=0;i<e.length;i++)hR(t,e[i],n,s,r);else s=Au(s)?!!s.capture:!!s,n=av(n),t&&t[ku]?(t=t.i,e=String(e).toString(),e in t.g&&(i=t.g[e],n=Mm(i,n,s,r),-1<n&&(Kf(i[n]),Array.prototype.splice.call(i,n,1),i.length==0&&(delete t.g[e],t.h--)))):t&&(t=ov(t))&&(e=t.g[e.toString()],t=-1,e&&(t=Mm(e,n,s,r)),(n=-1<t?e[t]:null)&&iv(n))}function iv(t){if(typeof t!="number"&&t&&!t.ca){var e=t.src;if(e&&e[ku])Om(e.i,t);else{var n=t.type,s=t.proxy;e.removeEventListener?e.removeEventListener(n,s,t.capture):e.detachEvent?e.detachEvent(dR(n),s):e.addListener&&e.removeListener&&e.removeListener(s),(n=ov(e))?(Om(n,t),n.h==0&&(n.src=null,e[rv]=null)):Kf(t)}}}function dR(t){return t in cg?cg[t]:cg[t]="on"+t}function Fz(t,e){if(t.ca)t=!0;else{e=new Bl(e,this);var n=t.listener,s=t.ia||t.src;t.fa&&iv(t),t=n.call(s,e)}return t}function ov(t){return t=t[rv],t instanceof Hf?t:null}var lg="__closure_events_fn_"+(1e9*Math.random()>>>0);function av(t){return typeof t=="function"?t:(t[lg]||(t[lg]=function(e){return t.handleEvent(e)}),t[lg])}function Ot(){ui.call(this),this.i=new Hf(this),this.P=this,this.I=null}Qt(Ot,ui);Ot.prototype[ku]=!0;Ot.prototype.removeEventListener=function(t,e,n,s){hR(this,t,e,n,s)};function Wt(t,e){var n,s=t.I;if(s)for(n=[];s;s=s.I)n.push(s);if(t=t.P,s=e.type||e,typeof e=="string")e=new Zt(e,t);else if(e instanceof Zt)e.target=e.target||t;else{var r=e;e=new Zt(s,t),rR(e,r)}if(r=!0,n)for(var i=n.length-1;0<=i;i--){var o=e.g=n[i];r=oh(o,s,!0,e)&&r}if(o=e.g=t,r=oh(o,s,!0,e)&&r,r=oh(o,s,!1,e)&&r,n)for(i=0;i<n.length;i++)o=e.g=n[i],r=oh(o,s,!1,e)&&r}Ot.prototype.M=function(){if(Ot.Z.M.call(this),this.i){var t=this.i,e;for(e in t.g){for(var n=t.g[e],s=0;s<n.length;s++)Kf(n[s]);delete t.g[e],t.h--}}this.I=null};Ot.prototype.N=function(t,e,n,s){return this.i.add(String(t),e,!1,n,s)};Ot.prototype.O=function(t,e,n,s){return this.i.add(String(t),e,!0,n,s)};function oh(t,e,n,s){if(e=t.i.g[String(e)],!e)return!0;e=e.concat();for(var r=!0,i=0;i<e.length;++i){var o=e[i];if(o&&!o.ca&&o.capture==n){var a=o.listener,c=o.ia||o.src;o.fa&&Om(t.i,o),r=a.call(c,s)!==!1&&r}}return r&&!s.defaultPrevented}var cv=oe.JSON.stringify;function Uz(){var t=pR;let e=null;return t.g&&(e=t.g,t.g=t.g.next,t.g||(t.h=null),e.next=null),e}class $z{constructor(){this.h=this.g=null}add(e,n){const s=fR.get();s.set(e,n),this.h?this.h.next=s:this.g=s,this.h=s}}var fR=new class{constructor(t,e){this.i=t,this.j=e,this.h=0,this.g=null}get(){let t;return 0<this.h?(this.h--,t=this.g,this.g=t.next,t.next=null):t=this.i(),t}}(()=>new Vz,t=>t.reset());class Vz{constructor(){this.next=this.g=this.h=null}set(e,n){this.h=e,this.g=n,this.next=null}reset(){this.next=this.g=this.h=null}}function Bz(t){oe.setTimeout(()=>{throw t},0)}function lv(t,e){Lm||qz(),Fm||(Lm(),Fm=!0),pR.add(t,e)}var Lm;function qz(){var t=oe.Promise.resolve(void 0);Lm=function(){t.then(jz)}}var Fm=!1,pR=new $z;function jz(){for(var t;t=Uz();){try{t.h.call(t.g)}catch(n){Bz(n)}var e=fR;e.j(t),100>e.h&&(e.h++,t.next=e.g,e.g=t)}Fm=!1}function Wf(t,e){Ot.call(this),this.h=t||1,this.g=e||oe,this.j=Ht(this.kb,this),this.l=Date.now()}Qt(Wf,Ot);W=Wf.prototype;W.da=!1;W.S=null;W.kb=function(){if(this.da){var t=Date.now()-this.l;0<t&&t<.8*this.h?this.S=this.g.setTimeout(this.j,this.h-t):(this.S&&(this.g.clearTimeout(this.S),this.S=null),Wt(this,"tick"),this.da&&(uv(this),this.start()))}};W.start=function(){this.da=!0,this.S||(this.S=this.g.setTimeout(this.j,this.h),this.l=Date.now())};function uv(t){t.da=!1,t.S&&(t.g.clearTimeout(t.S),t.S=null)}W.M=function(){Wf.Z.M.call(this),uv(this),delete this.g};function hv(t,e,n){if(typeof t=="function")n&&(t=Ht(t,n));else if(t&&typeof t.handleEvent=="function")t=Ht(t.handleEvent,t);else throw Error("Invalid listener argument");return 2147483647<Number(e)?-1:oe.setTimeout(t,e||0)}function gR(t){t.g=hv(()=>{t.g=null,t.i&&(t.i=!1,gR(t))},t.j);const e=t.h;t.h=null,t.m.apply(null,e)}class Kz extends ui{constructor(e,n){super(),this.m=e,this.j=n,this.h=null,this.i=!1,this.g=null}l(e){this.h=arguments,this.g?this.i=!0:gR(this)}M(){super.M(),this.g&&(oe.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function ql(t){ui.call(this),this.h=t,this.g={}}Qt(ql,ui);var yE=[];function mR(t,e,n,s){Array.isArray(n)||(n&&(yE[0]=n.toString()),n=yE);for(var r=0;r<n.length;r++){var i=cR(e,n[r],s||t.handleEvent,!1,t.h||t);if(!i)break;t.g[i.key]=i}}function _R(t){nv(t.g,function(e,n){this.g.hasOwnProperty(n)&&iv(e)},t),t.g={}}ql.prototype.M=function(){ql.Z.M.call(this),_R(this)};ql.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};function Gf(){this.g=!0}Gf.prototype.Aa=function(){this.g=!1};function Hz(t,e,n,s,r,i){t.info(function(){if(t.g)if(i)for(var o="",a=i.split("&"),c=0;c<a.length;c++){var l=a[c].split("=");if(1<l.length){var u=l[0];l=l[1];var h=u.split("_");o=2<=h.length&&h[1]=="type"?o+(u+"="+l+"&"):o+(u+"=redacted&")}}else o=null;else o=i;return"XMLHTTP REQ ("+s+") [attempt "+r+"]: "+e+`
`+n+`
`+o})}function Wz(t,e,n,s,r,i,o){t.info(function(){return"XMLHTTP RESP ("+s+") [ attempt "+r+"]: "+e+`
`+n+`
`+i+" "+o})}function Jo(t,e,n,s){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+zz(t,n)+(s?" "+s:"")})}function Gz(t,e){t.info(function(){return"TIMEOUT: "+e})}Gf.prototype.info=function(){};function zz(t,e){if(!t.g)return e;if(!e)return null;try{var n=JSON.parse(e);if(n){for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var s=n[t];if(!(2>s.length)){var r=s[1];if(Array.isArray(r)&&!(1>r.length)){var i=r[0];if(i!="noop"&&i!="stop"&&i!="close")for(var o=1;o<r.length;o++)r[o]=""}}}}return cv(n)}catch{return e}}var No={},vE=null;function zf(){return vE=vE||new Ot}No.Ma="serverreachability";function yR(t){Zt.call(this,No.Ma,t)}Qt(yR,Zt);function jl(t){const e=zf();Wt(e,new yR(e))}No.STAT_EVENT="statevent";function vR(t,e){Zt.call(this,No.STAT_EVENT,t),this.stat=e}Qt(vR,Zt);function hn(t){const e=zf();Wt(e,new vR(e,t))}No.Na="timingevent";function wR(t,e){Zt.call(this,No.Na,t),this.size=e}Qt(wR,Zt);function Ru(t,e){if(typeof t!="function")throw Error("Fn must not be null and must be a function");return oe.setTimeout(function(){t()},e)}var Qf={NO_ERROR:0,lb:1,yb:2,xb:3,sb:4,wb:5,zb:6,Ja:7,TIMEOUT:8,Cb:9},bR={qb:"complete",Mb:"success",Ka:"error",Ja:"abort",Eb:"ready",Fb:"readystatechange",TIMEOUT:"timeout",Ab:"incrementaldata",Db:"progress",tb:"downloadprogress",Ub:"uploadprogress"};function dv(){}dv.prototype.h=null;function wE(t){return t.h||(t.h=t.i())}function IR(){}var Nu={OPEN:"a",pb:"b",Ka:"c",Bb:"d"};function fv(){Zt.call(this,"d")}Qt(fv,Zt);function pv(){Zt.call(this,"c")}Qt(pv,Zt);var Um;function Yf(){}Qt(Yf,dv);Yf.prototype.g=function(){return new XMLHttpRequest};Yf.prototype.i=function(){return{}};Um=new Yf;function Pu(t,e,n,s){this.l=t,this.j=e,this.m=n,this.X=s||1,this.V=new ql(this),this.P=Qz,t=Dm?125:void 0,this.W=new Wf(t),this.H=null,this.i=!1,this.s=this.A=this.v=this.K=this.F=this.Y=this.B=null,this.D=[],this.g=null,this.C=0,this.o=this.u=null,this.N=-1,this.I=!1,this.O=0,this.L=null,this.aa=this.J=this.$=this.U=!1,this.h=new ER}function ER(){this.i=null,this.g="",this.h=!1}var Qz=45e3,$m={},wd={};W=Pu.prototype;W.setTimeout=function(t){this.P=t};function Vm(t,e,n){t.K=1,t.v=Xf(ur(e)),t.s=n,t.U=!0,TR(t,null)}function TR(t,e){t.F=Date.now(),Du(t),t.A=ur(t.v);var n=t.A,s=t.X;Array.isArray(s)||(s=[String(s)]),PR(n.h,"t",s),t.C=0,n=t.l.H,t.h=new ER,t.g=JR(t.l,n?e:null,!t.s),0<t.O&&(t.L=new Kz(Ht(t.Ia,t,t.g),t.O)),mR(t.V,t.g,"readystatechange",t.gb),e=t.H?sR(t.H):{},t.s?(t.u||(t.u="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.g.ea(t.A,t.u,t.s,e)):(t.u="GET",t.g.ea(t.A,t.u,null,e)),jl(),Hz(t.j,t.u,t.A,t.m,t.X,t.s)}W.gb=function(t){t=t.target;const e=this.L;e&&er(t)==3?e.l():this.Ia(t)};W.Ia=function(t){try{if(t==this.g)e:{const u=er(this.g);var e=this.g.Da();const h=this.g.ba();if(!(3>u)&&(u!=3||Dm||this.g&&(this.h.h||this.g.ga()||TE(this.g)))){this.I||u!=4||e==7||(e==8||0>=h?jl(3):jl(2)),Jf(this);var n=this.g.ba();this.N=n;t:if(SR(this)){var s=TE(this.g);t="";var r=s.length,i=er(this.g)==4;if(!this.h.i){if(typeof TextDecoder=="undefined"){$i(this),Zc(this);var o="";break t}this.h.i=new oe.TextDecoder}for(e=0;e<r;e++)this.h.h=!0,t+=this.h.i.decode(s[e],{stream:i&&e==r-1});s.splice(0,r),this.h.g+=t,this.C=0,o=this.h.g}else o=this.g.ga();if(this.i=n==200,Wz(this.j,this.u,this.A,this.m,this.X,u,n),this.i){if(this.$&&!this.J){t:{if(this.g){var a,c=this.g;if((a=c.g?c.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!yd(a)){var l=a;break t}}l=null}if(n=l)Jo(this.j,this.m,n,"Initial handshake response via X-HTTP-Initial-Response"),this.J=!0,Bm(this,n);else{this.i=!1,this.o=3,hn(12),$i(this),Zc(this);break e}}this.U?(CR(this,u,o),Dm&&this.i&&u==3&&(mR(this.V,this.W,"tick",this.fb),this.W.start())):(Jo(this.j,this.m,o,null),Bm(this,o)),u==4&&$i(this),this.i&&!this.I&&(u==4?GR(this.l,this):(this.i=!1,Du(this)))}else n==400&&0<o.indexOf("Unknown SID")?(this.o=3,hn(12)):(this.o=0,hn(13)),$i(this),Zc(this)}}}catch{}finally{}};function SR(t){return t.g?t.u=="GET"&&t.K!=2&&t.l.Ba:!1}function CR(t,e,n){let s=!0,r;for(;!t.I&&t.C<n.length;)if(r=Yz(t,n),r==wd){e==4&&(t.o=4,hn(14),s=!1),Jo(t.j,t.m,null,"[Incomplete Response]");break}else if(r==$m){t.o=4,hn(15),Jo(t.j,t.m,n,"[Invalid Chunk]"),s=!1;break}else Jo(t.j,t.m,r,null),Bm(t,r);SR(t)&&r!=wd&&r!=$m&&(t.h.g="",t.C=0),e!=4||n.length!=0||t.h.h||(t.o=1,hn(16),s=!1),t.i=t.i&&s,s?0<n.length&&!t.aa&&(t.aa=!0,e=t.l,e.g==t&&e.$&&!e.L&&(e.h.info("Great, no buffering proxy detected. Bytes received: "+n.length),Ev(e),e.L=!0,hn(11))):(Jo(t.j,t.m,n,"[Invalid Chunked Response]"),$i(t),Zc(t))}W.fb=function(){if(this.g){var t=er(this.g),e=this.g.ga();this.C<e.length&&(Jf(this),CR(this,t,e),this.i&&t!=4&&Du(this))}};function Yz(t,e){var n=t.C,s=e.indexOf(`
`,n);return s==-1?wd:(n=Number(e.substring(n,s)),isNaN(n)?$m:(s+=1,s+n>e.length?wd:(e=e.substr(s,n),t.C=s+n,e)))}W.cancel=function(){this.I=!0,$i(this)};function Du(t){t.Y=Date.now()+t.P,AR(t,t.P)}function AR(t,e){if(t.B!=null)throw Error("WatchDog timer not null");t.B=Ru(Ht(t.eb,t),e)}function Jf(t){t.B&&(oe.clearTimeout(t.B),t.B=null)}W.eb=function(){this.B=null;const t=Date.now();0<=t-this.Y?(Gz(this.j,this.A),this.K!=2&&(jl(),hn(17)),$i(this),this.o=2,Zc(this)):AR(this,this.Y-t)};function Zc(t){t.l.G==0||t.I||GR(t.l,t)}function $i(t){Jf(t);var e=t.L;e&&typeof e.na=="function"&&e.na(),t.L=null,uv(t.W),_R(t.V),t.g&&(e=t.g,t.g=null,e.abort(),e.na())}function Bm(t,e){try{var n=t.l;if(n.G!=0&&(n.g==t||qm(n.i,t))){if(n.I=t.N,!t.J&&qm(n.i,t)&&n.G==3){try{var s=n.Ca.g.parse(e)}catch{s=null}if(Array.isArray(s)&&s.length==3){var r=s;if(r[0]==0){e:if(!n.u){if(n.g)if(n.g.F+3e3<t.F)Td(n),tp(n);else break e;Iv(n),hn(18)}}else n.ta=r[1],0<n.ta-n.U&&37500>r[2]&&n.N&&n.A==0&&!n.v&&(n.v=Ru(Ht(n.ab,n),6e3));if(1>=OR(n.i)&&n.ka){try{n.ka()}catch{}n.ka=void 0}}else Vi(n,11)}else if((t.J||n.g==t)&&Td(n),!yd(e))for(r=n.Ca.g.parse(e),e=0;e<r.length;e++){let l=r[e];if(n.U=l[0],l=l[1],n.G==2)if(l[0]=="c"){n.J=l[1],n.la=l[2];const u=l[3];u!=null&&(n.ma=u,n.h.info("VER="+n.ma));const h=l[4];h!=null&&(n.za=h,n.h.info("SVER="+n.za));const d=l[5];d!=null&&typeof d=="number"&&0<d&&(s=1.5*d,n.K=s,n.h.info("backChannelRequestTimeoutMs_="+s)),s=n;const f=t.g;if(f){const p=f.g?f.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(p){var i=s.i;!i.g&&(an(p,"spdy")||an(p,"quic")||an(p,"h2"))&&(i.j=i.l,i.g=new Set,i.h&&(_v(i,i.h),i.h=null))}if(s.D){const _=f.g?f.g.getResponseHeader("X-HTTP-Session-Id"):null;_&&(s.sa=_,Ge(s.F,s.D,_))}}n.G=3,n.j&&n.j.xa(),n.$&&(n.O=Date.now()-t.F,n.h.info("Handshake RTT: "+n.O+"ms")),s=n;var o=t;if(s.oa=YR(s,s.H?s.la:null,s.W),o.J){MR(s.i,o);var a=o,c=s.K;c&&a.setTimeout(c),a.B&&(Jf(a),Du(a)),s.g=o}else HR(s);0<n.l.length&&np(n)}else l[0]!="stop"&&l[0]!="close"||Vi(n,7);else n.G==3&&(l[0]=="stop"||l[0]=="close"?l[0]=="stop"?Vi(n,7):bv(n):l[0]!="noop"&&n.j&&n.j.wa(l),n.A=0)}}jl(4)}catch{}}function Jz(t){if(t.R&&typeof t.R=="function")return t.R();if(typeof t=="string")return t.split("");if(Pm(t)){for(var e=[],n=t.length,s=0;s<n;s++)e.push(t[s]);return e}e=[],n=0;for(s in t)e[n++]=t[s];return e}function gv(t,e){if(t.forEach&&typeof t.forEach=="function")t.forEach(e,void 0);else if(Pm(t)||typeof t=="string")nR(t,e,void 0);else{if(t.T&&typeof t.T=="function")var n=t.T();else if(t.R&&typeof t.R=="function")n=void 0;else if(Pm(t)||typeof t=="string"){n=[];for(var s=t.length,r=0;r<s;r++)n.push(r)}else for(r in n=[],s=0,t)n[s++]=r;s=Jz(t),r=s.length;for(var i=0;i<r;i++)e.call(void 0,s[i],n&&n[i],t)}}function ec(t,e){this.h={},this.g=[],this.i=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var s=0;s<n;s+=2)this.set(arguments[s],arguments[s+1])}else if(t)if(t instanceof ec)for(n=t.T(),s=0;s<n.length;s++)this.set(n[s],t.get(n[s]));else for(s in t)this.set(s,t[s])}W=ec.prototype;W.R=function(){mv(this);for(var t=[],e=0;e<this.g.length;e++)t.push(this.h[this.g[e]]);return t};W.T=function(){return mv(this),this.g.concat()};function mv(t){if(t.i!=t.g.length){for(var e=0,n=0;e<t.g.length;){var s=t.g[e];ao(t.h,s)&&(t.g[n++]=s),e++}t.g.length=n}if(t.i!=t.g.length){var r={};for(n=e=0;e<t.g.length;)s=t.g[e],ao(r,s)||(t.g[n++]=s,r[s]=1),e++;t.g.length=n}}W.get=function(t,e){return ao(this.h,t)?this.h[t]:e};W.set=function(t,e){ao(this.h,t)||(this.i++,this.g.push(t)),this.h[t]=e};W.forEach=function(t,e){for(var n=this.T(),s=0;s<n.length;s++){var r=n[s],i=this.get(r);t.call(e,i,r,this)}};function ao(t,e){return Object.prototype.hasOwnProperty.call(t,e)}var kR=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Xz(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var s=t[n].indexOf("="),r=null;if(0<=s){var i=t[n].substring(0,s);r=t[n].substring(s+1)}else i=t[n];e(i,r?decodeURIComponent(r.replace(/\+/g," ")):"")}}}function co(t,e){if(this.i=this.s=this.j="",this.m=null,this.o=this.l="",this.g=!1,t instanceof co){this.g=e!==void 0?e:t.g,bd(this,t.j),this.s=t.s,Id(this,t.i),Ed(this,t.m),this.l=t.l,e=t.h;var n=new Kl;n.i=e.i,e.g&&(n.g=new ec(e.g),n.h=e.h),bE(this,n),this.o=t.o}else t&&(n=String(t).match(kR))?(this.g=!!e,bd(this,n[1]||"",!0),this.s=el(n[2]||""),Id(this,n[3]||"",!0),Ed(this,n[4]),this.l=el(n[5]||"",!0),bE(this,n[6]||"",!0),this.o=el(n[7]||"")):(this.g=!!e,this.h=new Kl(null,this.g))}co.prototype.toString=function(){var t=[],e=this.j;e&&t.push(Mc(e,IE,!0),":");var n=this.i;return(n||e=="file")&&(t.push("//"),(e=this.s)&&t.push(Mc(e,IE,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),n=this.m,n!=null&&t.push(":",String(n))),(n=this.l)&&(this.i&&n.charAt(0)!="/"&&t.push("/"),t.push(Mc(n,n.charAt(0)=="/"?s2:n2,!0))),(n=this.h.toString())&&t.push("?",n),(n=this.o)&&t.push("#",Mc(n,i2)),t.join("")};function ur(t){return new co(t)}function bd(t,e,n){t.j=n?el(e,!0):e,t.j&&(t.j=t.j.replace(/:$/,""))}function Id(t,e,n){t.i=n?el(e,!0):e}function Ed(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.m=e}else t.m=null}function bE(t,e,n){e instanceof Kl?(t.h=e,o2(t.h,t.g)):(n||(e=Mc(e,r2)),t.h=new Kl(e,t.g))}function Ge(t,e,n){t.h.set(e,n)}function Xf(t){return Ge(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),t}function Zz(t){return t instanceof co?ur(t):new co(t,void 0)}function e2(t,e,n,s){var r=new co(null,void 0);return t&&bd(r,t),e&&Id(r,e),n&&Ed(r,n),s&&(r.l=s),r}function el(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function Mc(t,e,n){return typeof t=="string"?(t=encodeURI(t).replace(e,t2),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function t2(t){return t=t.charCodeAt(0),"%"+(t>>4&15).toString(16)+(t&15).toString(16)}var IE=/[#\/\?@]/g,n2=/[#\?:]/g,s2=/[#\?]/g,r2=/[#\?@]/g,i2=/#/g;function Kl(t,e){this.h=this.g=null,this.i=t||null,this.j=!!e}function hi(t){t.g||(t.g=new ec,t.h=0,t.i&&Xz(t.i,function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)}))}W=Kl.prototype;W.add=function(t,e){hi(this),this.i=null,t=tc(this,t);var n=this.g.get(t);return n||this.g.set(t,n=[]),n.push(e),this.h+=1,this};function RR(t,e){hi(t),e=tc(t,e),ao(t.g.h,e)&&(t.i=null,t.h-=t.g.get(e).length,t=t.g,ao(t.h,e)&&(delete t.h[e],t.i--,t.g.length>2*t.i&&mv(t)))}function NR(t,e){return hi(t),e=tc(t,e),ao(t.g.h,e)}W.forEach=function(t,e){hi(this),this.g.forEach(function(n,s){nR(n,function(r){t.call(e,r,s,this)},this)},this)};W.T=function(){hi(this);for(var t=this.g.R(),e=this.g.T(),n=[],s=0;s<e.length;s++)for(var r=t[s],i=0;i<r.length;i++)n.push(e[s]);return n};W.R=function(t){hi(this);var e=[];if(typeof t=="string")NR(this,t)&&(e=dE(e,this.g.get(tc(this,t))));else{t=this.g.R();for(var n=0;n<t.length;n++)e=dE(e,t[n])}return e};W.set=function(t,e){return hi(this),this.i=null,t=tc(this,t),NR(this,t)&&(this.h-=this.g.get(t).length),this.g.set(t,[e]),this.h+=1,this};W.get=function(t,e){return t?(t=this.R(t),0<t.length?String(t[0]):e):e};function PR(t,e,n){RR(t,e),0<n.length&&(t.i=null,t.g.set(tc(t,e),tv(n)),t.h+=n.length)}W.toString=function(){if(this.i)return this.i;if(!this.g)return"";for(var t=[],e=this.g.T(),n=0;n<e.length;n++){var s=e[n],r=encodeURIComponent(String(s));s=this.R(s);for(var i=0;i<s.length;i++){var o=r;s[i]!==""&&(o+="="+encodeURIComponent(String(s[i]))),t.push(o)}}return this.i=t.join("&")};function tc(t,e){return e=String(e),t.j&&(e=e.toLowerCase()),e}function o2(t,e){e&&!t.j&&(hi(t),t.i=null,t.g.forEach(function(n,s){var r=s.toLowerCase();s!=r&&(RR(this,s),PR(this,r,n))},t)),t.j=e}var a2=class{constructor(t,e){this.h=t,this.g=e}};function DR(t){this.l=t||c2,oe.PerformanceNavigationTiming?(t=oe.performance.getEntriesByType("navigation"),t=0<t.length&&(t[0].nextHopProtocol=="hq"||t[0].nextHopProtocol=="h2")):t=!!(oe.g&&oe.g.Ea&&oe.g.Ea()&&oe.g.Ea().Zb),this.j=t?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var c2=10;function xR(t){return t.h?!0:t.g?t.g.size>=t.j:!1}function OR(t){return t.h?1:t.g?t.g.size:0}function qm(t,e){return t.h?t.h==e:t.g?t.g.has(e):!1}function _v(t,e){t.g?t.g.add(e):t.h=e}function MR(t,e){t.h&&t.h==e?t.h=null:t.g&&t.g.has(e)&&t.g.delete(e)}DR.prototype.cancel=function(){if(this.i=LR(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const t of this.g.values())t.cancel();this.g.clear()}};function LR(t){if(t.h!=null)return t.i.concat(t.h.D);if(t.g!=null&&t.g.size!==0){let e=t.i;for(const n of t.g.values())e=e.concat(n.D);return e}return tv(t.i)}function yv(){}yv.prototype.stringify=function(t){return oe.JSON.stringify(t,void 0)};yv.prototype.parse=function(t){return oe.JSON.parse(t,void 0)};function l2(){this.g=new yv}function u2(t,e,n){const s=n||"";try{gv(t,function(r,i){let o=r;Au(r)&&(o=cv(r)),e.push(s+i+"="+encodeURIComponent(o))})}catch(r){throw e.push(s+"type="+encodeURIComponent("_badmap")),r}}function h2(t,e){const n=new Gf;if(oe.Image){const s=new Image;s.onload=ih(ah,n,s,"TestLoadImage: loaded",!0,e),s.onerror=ih(ah,n,s,"TestLoadImage: error",!1,e),s.onabort=ih(ah,n,s,"TestLoadImage: abort",!1,e),s.ontimeout=ih(ah,n,s,"TestLoadImage: timeout",!1,e),oe.setTimeout(function(){s.ontimeout&&s.ontimeout()},1e4),s.src=t}else e(!1)}function ah(t,e,n,s,r){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,r(s)}catch{}}function xu(t){this.l=t.$b||null,this.j=t.ib||!1}Qt(xu,dv);xu.prototype.g=function(){return new Zf(this.l,this.j)};xu.prototype.i=function(t){return function(){return t}}({});function Zf(t,e){Ot.call(this),this.D=t,this.u=e,this.m=void 0,this.readyState=vv,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}Qt(Zf,Ot);var vv=0;W=Zf.prototype;W.open=function(t,e){if(this.readyState!=vv)throw this.abort(),Error("Error reopening a connection");this.C=t,this.B=e,this.readyState=1,Hl(this)};W.send=function(t){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};t&&(e.body=t),(this.D||oe).fetch(new Request(this.B,e)).then(this.Va.bind(this),this.ha.bind(this))};W.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted."),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Ou(this)),this.readyState=vv};W.Va=function(t){if(this.g&&(this.l=t,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=t.headers,this.readyState=2,Hl(this)),this.g&&(this.readyState=3,Hl(this),this.g)))if(this.responseType==="arraybuffer")t.arrayBuffer().then(this.Ta.bind(this),this.ha.bind(this));else if(typeof oe.ReadableStream!="undefined"&&"body"in t){if(this.j=t.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;FR(this)}else t.text().then(this.Ua.bind(this),this.ha.bind(this))};function FR(t){t.j.read().then(t.Sa.bind(t)).catch(t.ha.bind(t))}W.Sa=function(t){if(this.g){if(this.u&&t.value)this.response.push(t.value);else if(!this.u){var e=t.value?t.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!t.done}))&&(this.response=this.responseText+=e)}t.done?Ou(this):Hl(this),this.readyState==3&&FR(this)}};W.Ua=function(t){this.g&&(this.response=this.responseText=t,Ou(this))};W.Ta=function(t){this.g&&(this.response=t,Ou(this))};W.ha=function(){this.g&&Ou(this)};function Ou(t){t.readyState=4,t.l=null,t.j=null,t.A=null,Hl(t)}W.setRequestHeader=function(t,e){this.v.append(t,e)};W.getResponseHeader=function(t){return this.h&&this.h.get(t.toLowerCase())||""};W.getAllResponseHeaders=function(){if(!this.h)return"";const t=[],e=this.h.entries();for(var n=e.next();!n.done;)n=n.value,t.push(n[0]+": "+n[1]),n=e.next();return t.join(`\r
`)};function Hl(t){t.onreadystatechange&&t.onreadystatechange.call(t)}Object.defineProperty(Zf.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(t){this.m=t?"include":"same-origin"}});var d2=oe.JSON.parse;function pt(t){Ot.call(this),this.headers=new ec,this.u=t||null,this.h=!1,this.C=this.g=null,this.H="",this.m=0,this.j="",this.l=this.F=this.v=this.D=!1,this.B=0,this.A=null,this.J=UR,this.K=this.L=!1}Qt(pt,Ot);var UR="",f2=/^https?$/i,p2=["POST","PUT"];W=pt.prototype;W.ea=function(t,e,n,s){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.H+"; newUri="+t);e=e?e.toUpperCase():"GET",this.H=t,this.j="",this.m=0,this.D=!1,this.h=!0,this.g=this.u?this.u.g():Um.g(),this.C=this.u?wE(this.u):wE(Um),this.g.onreadystatechange=Ht(this.Fa,this);try{this.F=!0,this.g.open(e,String(t),!0),this.F=!1}catch(i){EE(this,i);return}t=n||"";const r=new ec(this.headers);s&&gv(s,function(i,o){r.set(o,i)}),s=Sz(r.T()),n=oe.FormData&&t instanceof oe.FormData,!(0<=tR(p2,e))||s||n||r.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),r.forEach(function(i,o){this.g.setRequestHeader(o,i)},this),this.J&&(this.g.responseType=this.J),"withCredentials"in this.g&&this.g.withCredentials!==this.L&&(this.g.withCredentials=this.L);try{BR(this),0<this.B&&((this.K=g2(this.g))?(this.g.timeout=this.B,this.g.ontimeout=Ht(this.pa,this)):this.A=hv(this.pa,this.B,this)),this.v=!0,this.g.send(t),this.v=!1}catch(i){EE(this,i)}};function g2(t){return Na&&Nz()&&typeof t.timeout=="number"&&t.ontimeout!==void 0}function m2(t){return t.toLowerCase()=="content-type"}W.pa=function(){typeof ev!="undefined"&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,Wt(this,"timeout"),this.abort(8))};function EE(t,e){t.h=!1,t.g&&(t.l=!0,t.g.abort(),t.l=!1),t.j=e,t.m=5,$R(t),ep(t)}function $R(t){t.D||(t.D=!0,Wt(t,"complete"),Wt(t,"error"))}W.abort=function(t){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=t||7,Wt(this,"complete"),Wt(this,"abort"),ep(this))};W.M=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),ep(this,!0)),pt.Z.M.call(this)};W.Fa=function(){this.s||(this.F||this.v||this.l?VR(this):this.cb())};W.cb=function(){VR(this)};function VR(t){if(t.h&&typeof ev!="undefined"&&(!t.C[1]||er(t)!=4||t.ba()!=2)){if(t.v&&er(t)==4)hv(t.Fa,0,t);else if(Wt(t,"readystatechange"),er(t)==4){t.h=!1;try{const a=t.ba();e:switch(a){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break e;default:e=!1}var n;if(!(n=e)){var s;if(s=a===0){var r=String(t.H).match(kR)[1]||null;if(!r&&oe.self&&oe.self.location){var i=oe.self.location.protocol;r=i.substr(0,i.length-1)}s=!f2.test(r?r.toLowerCase():"")}n=s}if(n)Wt(t,"complete"),Wt(t,"success");else{t.m=6;try{var o=2<er(t)?t.g.statusText:""}catch{o=""}t.j=o+" ["+t.ba()+"]",$R(t)}}finally{ep(t)}}}}function ep(t,e){if(t.g){BR(t);const n=t.g,s=t.C[0]?_d:null;t.g=null,t.C=null,e||Wt(t,"ready");try{n.onreadystatechange=s}catch{}}}function BR(t){t.g&&t.K&&(t.g.ontimeout=null),t.A&&(oe.clearTimeout(t.A),t.A=null)}function er(t){return t.g?t.g.readyState:0}W.ba=function(){try{return 2<er(this)?this.g.status:-1}catch{return-1}};W.ga=function(){try{return this.g?this.g.responseText:""}catch{return""}};W.Qa=function(t){if(this.g){var e=this.g.responseText;return t&&e.indexOf(t)==0&&(e=e.substring(t.length)),d2(e)}};function TE(t){try{if(!t.g)return null;if("response"in t.g)return t.g.response;switch(t.J){case UR:case"text":return t.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in t.g)return t.g.mozResponseArrayBuffer}return null}catch{return null}}W.Da=function(){return this.m};W.La=function(){return typeof this.j=="string"?this.j:String(this.j)};function _2(t){let e="";return nv(t,function(n,s){e+=s,e+=":",e+=n,e+=`\r
`}),e}function wv(t,e,n){e:{for(s in n){var s=!1;break e}s=!0}s||(n=_2(n),typeof t=="string"?n!=null&&encodeURIComponent(String(n)):Ge(t,e,n))}function Ic(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function qR(t){this.za=0,this.l=[],this.h=new Gf,this.la=this.oa=this.F=this.W=this.g=this.sa=this.D=this.aa=this.o=this.P=this.s=null,this.Za=this.V=0,this.Xa=Ic("failFast",!1,t),this.N=this.v=this.u=this.m=this.j=null,this.X=!0,this.I=this.ta=this.U=-1,this.Y=this.A=this.C=0,this.Pa=Ic("baseRetryDelayMs",5e3,t),this.$a=Ic("retryDelaySeedMs",1e4,t),this.Ya=Ic("forwardChannelMaxRetries",2,t),this.ra=Ic("forwardChannelRequestTimeoutMs",2e4,t),this.qa=t&&t.xmlHttpFactory||void 0,this.Ba=t&&t.Yb||!1,this.K=void 0,this.H=t&&t.supportsCrossDomainXhr||!1,this.J="",this.i=new DR(t&&t.concurrentRequestLimit),this.Ca=new l2,this.ja=t&&t.fastHandshake||!1,this.Ra=t&&t.Wb||!1,t&&t.Aa&&this.h.Aa(),t&&t.forceLongPolling&&(this.X=!1),this.$=!this.ja&&this.X&&t&&t.detectBufferingProxy||!1,this.ka=void 0,this.O=0,this.L=!1,this.B=null,this.Wa=!t||t.Xb!==!1}W=qR.prototype;W.ma=8;W.G=1;function bv(t){if(jR(t),t.G==3){var e=t.V++,n=ur(t.F);Ge(n,"SID",t.J),Ge(n,"RID",e),Ge(n,"TYPE","terminate"),Mu(t,n),e=new Pu(t,t.h,e,void 0),e.K=2,e.v=Xf(ur(n)),n=!1,oe.navigator&&oe.navigator.sendBeacon&&(n=oe.navigator.sendBeacon(e.v.toString(),"")),!n&&oe.Image&&(new Image().src=e.v,n=!0),n||(e.g=JR(e.l,null),e.g.ea(e.v)),e.F=Date.now(),Du(e)}QR(t)}W.hb=function(t){try{this.h.info("Origin Trials invoked: "+t)}catch{}};function tp(t){t.g&&(Ev(t),t.g.cancel(),t.g=null)}function jR(t){tp(t),t.u&&(oe.clearTimeout(t.u),t.u=null),Td(t),t.i.cancel(),t.m&&(typeof t.m=="number"&&oe.clearTimeout(t.m),t.m=null)}function ug(t,e){t.l.push(new a2(t.Za++,e)),t.G==3&&np(t)}function np(t){xR(t.i)||t.m||(t.m=!0,lv(t.Ha,t),t.C=0)}function y2(t,e){return OR(t.i)>=t.i.j-(t.m?1:0)?!1:t.m?(t.l=e.D.concat(t.l),!0):t.G==1||t.G==2||t.C>=(t.Xa?0:t.Ya)?!1:(t.m=Ru(Ht(t.Ha,t,e),zR(t,t.C)),t.C++,!0)}W.Ha=function(t){if(this.m)if(this.m=null,this.G==1){if(!t){this.V=Math.floor(1e5*Math.random()),t=this.V++;const r=new Pu(this,this.h,t,void 0);let i=this.s;if(this.P&&(i?(i=sR(i),rR(i,this.P)):i=this.P),this.o===null&&(r.H=i),this.ja)e:{for(var e=0,n=0;n<this.l.length;n++){t:{var s=this.l[n];if("__data__"in s.g&&(s=s.g.__data__,typeof s=="string")){s=s.length;break t}s=void 0}if(s===void 0)break;if(e+=s,4096<e){e=n;break e}if(e===4096||n===this.l.length-1){e=n+1;break e}}e=1e3}else e=1e3;e=KR(this,r,e),n=ur(this.F),Ge(n,"RID",t),Ge(n,"CVER",22),this.D&&Ge(n,"X-HTTP-Session-Id",this.D),Mu(this,n),this.o&&i&&wv(n,this.o,i),_v(this.i,r),this.Ra&&Ge(n,"TYPE","init"),this.ja?(Ge(n,"$req",e),Ge(n,"SID","null"),r.$=!0,Vm(r,n,null)):Vm(r,n,e),this.G=2}}else this.G==3&&(t?SE(this,t):this.l.length==0||xR(this.i)||SE(this))};function SE(t,e){var n;e?n=e.m:n=t.V++;const s=ur(t.F);Ge(s,"SID",t.J),Ge(s,"RID",n),Ge(s,"AID",t.U),Mu(t,s),t.o&&t.s&&wv(s,t.o,t.s),n=new Pu(t,t.h,n,t.C+1),t.o===null&&(n.H=t.s),e&&(t.l=e.D.concat(t.l)),e=KR(t,n,1e3),n.setTimeout(Math.round(.5*t.ra)+Math.round(.5*t.ra*Math.random())),_v(t.i,n),Vm(n,s,e)}function Mu(t,e){t.j&&gv({},function(n,s){Ge(e,s,n)})}function KR(t,e,n){n=Math.min(t.l.length,n);var s=t.j?Ht(t.j.Oa,t.j,t):null;e:{var r=t.l;let i=-1;for(;;){const o=["count="+n];i==-1?0<n?(i=r[0].h,o.push("ofs="+i)):i=0:o.push("ofs="+i);let a=!0;for(let c=0;c<n;c++){let l=r[c].h;const u=r[c].g;if(l-=i,0>l)i=Math.max(0,r[c].h-100),a=!1;else try{u2(u,o,"req"+l+"_")}catch{s&&s(u)}}if(a){s=o.join("&");break e}}}return t=t.l.splice(0,n),e.D=t,s}function HR(t){t.g||t.u||(t.Y=1,lv(t.Ga,t),t.A=0)}function Iv(t){return t.g||t.u||3<=t.A?!1:(t.Y++,t.u=Ru(Ht(t.Ga,t),zR(t,t.A)),t.A++,!0)}W.Ga=function(){if(this.u=null,WR(this),this.$&&!(this.L||this.g==null||0>=this.O)){var t=2*this.O;this.h.info("BP detection timer enabled: "+t),this.B=Ru(Ht(this.bb,this),t)}};W.bb=function(){this.B&&(this.B=null,this.h.info("BP detection timeout reached."),this.h.info("Buffering proxy detected and switch to long-polling!"),this.N=!1,this.L=!0,hn(10),tp(this),WR(this))};function Ev(t){t.B!=null&&(oe.clearTimeout(t.B),t.B=null)}function WR(t){t.g=new Pu(t,t.h,"rpc",t.Y),t.o===null&&(t.g.H=t.s),t.g.O=0;var e=ur(t.oa);Ge(e,"RID","rpc"),Ge(e,"SID",t.J),Ge(e,"CI",t.N?"0":"1"),Ge(e,"AID",t.U),Mu(t,e),Ge(e,"TYPE","xmlhttp"),t.o&&t.s&&wv(e,t.o,t.s),t.K&&t.g.setTimeout(t.K);var n=t.g;t=t.la,n.K=1,n.v=Xf(ur(e)),n.s=null,n.U=!0,TR(n,t)}W.ab=function(){this.v!=null&&(this.v=null,tp(this),Iv(this),hn(19))};function Td(t){t.v!=null&&(oe.clearTimeout(t.v),t.v=null)}function GR(t,e){var n=null;if(t.g==e){Td(t),Ev(t),t.g=null;var s=2}else if(qm(t.i,e))n=e.D,MR(t.i,e),s=1;else return;if(t.I=e.N,t.G!=0){if(e.i)if(s==1){n=e.s?e.s.length:0,e=Date.now()-e.F;var r=t.C;s=zf(),Wt(s,new wR(s,n)),np(t)}else HR(t);else if(r=e.o,r==3||r==0&&0<t.I||!(s==1&&y2(t,e)||s==2&&Iv(t)))switch(n&&0<n.length&&(e=t.i,e.i=e.i.concat(n)),r){case 1:Vi(t,5);break;case 4:Vi(t,10);break;case 3:Vi(t,6);break;default:Vi(t,2)}}}function zR(t,e){let n=t.Pa+Math.floor(Math.random()*t.$a);return t.j||(n*=2),n*e}function Vi(t,e){if(t.h.info("Error code "+e),e==2){var n=null;t.j&&(n=null);var s=Ht(t.jb,t);n||(n=new co("//www.google.com/images/cleardot.gif"),oe.location&&oe.location.protocol=="http"||bd(n,"https"),Xf(n)),h2(n.toString(),s)}else hn(2);t.G=0,t.j&&t.j.va(e),QR(t),jR(t)}W.jb=function(t){t?(this.h.info("Successfully pinged google.com"),hn(2)):(this.h.info("Failed to ping google.com"),hn(1))};function QR(t){t.G=0,t.I=-1,t.j&&((LR(t.i).length!=0||t.l.length!=0)&&(t.i.i.length=0,tv(t.l),t.l.length=0),t.j.ua())}function YR(t,e,n){let s=Zz(n);if(s.i!="")e&&Id(s,e+"."+s.i),Ed(s,s.m);else{const r=oe.location;s=e2(r.protocol,e?e+"."+r.hostname:r.hostname,+r.port,n)}return t.aa&&nv(t.aa,function(r,i){Ge(s,i,r)}),e=t.D,n=t.sa,e&&n&&Ge(s,e,n),Ge(s,"VER",t.ma),Mu(t,s),s}function JR(t,e,n){if(e&&!t.H)throw Error("Can't create secondary domain capable XhrIo object.");return e=n&&t.Ba&&!t.qa?new pt(new xu({ib:!0})):new pt(t.qa),e.L=t.H,e}function XR(){}W=XR.prototype;W.xa=function(){};W.wa=function(){};W.va=function(){};W.ua=function(){};W.Oa=function(){};function Sd(){if(Na&&!(10<=Number(Pz)))throw Error("Environmental error: no available transport.")}Sd.prototype.g=function(t,e){return new On(t,e)};function On(t,e){Ot.call(this),this.g=new qR(e),this.l=t,this.h=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.g.s=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.ya&&(t?t["X-WebChannel-Client-Profile"]=e.ya:t={"X-WebChannel-Client-Profile":e.ya}),this.g.P=t,(t=e&&e.httpHeadersOverwriteParam)&&!yd(t)&&(this.g.o=t),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!yd(e)&&(this.g.D=e,t=this.h,t!==null&&e in t&&(t=this.h,e in t&&delete t[e])),this.j=new nc(this)}Qt(On,Ot);On.prototype.m=function(){this.g.j=this.j,this.A&&(this.g.H=!0);var t=this.g,e=this.l,n=this.h||void 0;t.Wa&&(t.h.info("Origin Trials enabled."),lv(Ht(t.hb,t,e))),hn(0),t.W=e,t.aa=n||{},t.N=t.X,t.F=YR(t,null,t.W),np(t)};On.prototype.close=function(){bv(this.g)};On.prototype.u=function(t){if(typeof t=="string"){var e={};e.__data__=t,ug(this.g,e)}else this.v?(e={},e.__data__=cv(t),ug(this.g,e)):ug(this.g,t)};On.prototype.M=function(){this.g.j=null,delete this.j,bv(this.g),delete this.g,On.Z.M.call(this)};function ZR(t){fv.call(this);var e=t.__sm__;if(e){e:{for(const n in e){t=n;break e}t=void 0}(this.i=t)&&(t=this.i,e=e!==null&&t in e?e[t]:void 0),this.data=e}else this.data=t}Qt(ZR,fv);function eN(){pv.call(this),this.status=1}Qt(eN,pv);function nc(t){this.g=t}Qt(nc,XR);nc.prototype.xa=function(){Wt(this.g,"a")};nc.prototype.wa=function(t){Wt(this.g,new ZR(t))};nc.prototype.va=function(t){Wt(this.g,new eN)};nc.prototype.ua=function(){Wt(this.g,"b")};Sd.prototype.createWebChannel=Sd.prototype.g;On.prototype.send=On.prototype.u;On.prototype.open=On.prototype.m;On.prototype.close=On.prototype.close;Qf.NO_ERROR=0;Qf.TIMEOUT=8;Qf.HTTP_ERROR=6;bR.COMPLETE="complete";IR.EventType=Nu;Nu.OPEN="a";Nu.CLOSE="b";Nu.ERROR="c";Nu.MESSAGE="d";Ot.prototype.listen=Ot.prototype.N;pt.prototype.listenOnce=pt.prototype.O;pt.prototype.getLastError=pt.prototype.La;pt.prototype.getLastErrorCode=pt.prototype.Da;pt.prototype.getStatus=pt.prototype.ba;pt.prototype.getResponseJson=pt.prototype.Qa;pt.prototype.getResponseText=pt.prototype.ga;pt.prototype.send=pt.prototype.ea;var v2=function(){return new Sd},w2=function(){return zf()},hg=Qf,b2=bR,I2=No,CE={rb:0,ub:1,vb:2,Ob:3,Tb:4,Qb:5,Rb:6,Pb:7,Nb:8,Sb:9,PROXY:10,NOPROXY:11,Lb:12,Hb:13,Ib:14,Gb:15,Jb:16,Kb:17,nb:18,mb:19,ob:20},E2=xu,ch=IR,T2=pt;const AE="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class St{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}St.UNAUTHENTICATED=new St(null),St.GOOGLE_CREDENTIALS=new St("google-credentials-uid"),St.FIRST_PARTY=new St("first-party-uid"),St.MOCK_USER=new St("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let sc="9.9.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ti=new js("@firebase/firestore");function jm(){return ti.logLevel}function S2(t){ti.setLogLevel(t)}function P(t,...e){if(ti.logLevel<=fe.DEBUG){const n=e.map(Tv);ti.debug(`Firestore (${sc}): ${t}`,...n)}}function ft(t,...e){if(ti.logLevel<=fe.ERROR){const n=e.map(Tv);ti.error(`Firestore (${sc}): ${t}`,...n)}}function Wl(t,...e){if(ti.logLevel<=fe.WARN){const n=e.map(Tv);ti.warn(`Firestore (${sc}): ${t}`,...n)}}function Tv(t){if(typeof t=="string")return t;try{return e=t,JSON.stringify(e)}catch{return t}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/var e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function G(t="Unexpected state"){const e=`FIRESTORE (${sc}) INTERNAL ASSERTION FAILED: `+t;throw ft(e),new Error(e)}function ie(t,e){t||G()}function C2(t,e){t||G()}function q(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const w={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class k extends ut{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kt{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tN{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class A2{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(St.UNAUTHENTICATED))}shutdown(){}}class k2{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class R2{constructor(e){this.t=e,this.currentUser=St.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){let s=this.i;const r=c=>this.i!==s?(s=this.i,n(c)):Promise.resolve();let i=new kt;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new kt,e.enqueueRetryable(()=>r(this.currentUser))};const o=()=>{const c=i;e.enqueueRetryable(async()=>{await c.promise,await r(this.currentUser)})},a=c=>{P("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.auth.addAuthTokenListener(this.o),o()};this.t.onInit(c=>a(c)),setTimeout(()=>{if(!this.auth){const c=this.t.getImmediate({optional:!0});c?a(c):(P("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new kt)}},0),o()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(s=>this.i!==e?(P("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):s?(ie(typeof s.accessToken=="string"),new tN(s.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const e=this.auth&&this.auth.getUid();return ie(e===null||typeof e=="string"),new St(e)}}class N2{constructor(e,n,s){this.type="FirstParty",this.user=St.FIRST_PARTY,this.headers=new Map,this.headers.set("X-Goog-AuthUser",n);const r=e.auth.getAuthHeaderValueForFirstParty([]);r&&this.headers.set("Authorization",r),s&&this.headers.set("X-Goog-Iam-Authorization-Token",s)}}class P2{constructor(e,n,s){this.h=e,this.l=n,this.m=s}getToken(){return Promise.resolve(new N2(this.h,this.l,this.m))}start(e,n){e.enqueueRetryable(()=>n(St.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class D2{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class x2{constructor(e){this.g=e,this.forceRefresh=!1,this.appCheck=null,this.p=null}start(e,n){const s=i=>{i.error!=null&&P("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const o=i.token!==this.p;return this.p=i.token,P("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>s(i))};const r=i=>{P("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.appCheck.addTokenListener(this.o)};this.g.onInit(i=>r(i)),setTimeout(()=>{if(!this.appCheck){const i=this.g.getImmediate({optional:!0});i?r(i):P("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(ie(typeof n.token=="string"),this.p=n.token,new D2(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function O2(t){const e=typeof self!="undefined"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let s=0;s<t;s++)n[s]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nN{static I(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=Math.floor(256/e.length)*e.length;let s="";for(;s.length<20;){const r=O2(40);for(let i=0;i<r.length;++i)s.length<20&&r[i]<n&&(s+=e.charAt(r[i]%e.length))}return s}}function ce(t,e){return t<e?-1:t>e?1:0}function Pa(t,e,n){return t.length===e.length&&t.every((s,r)=>n(s,e[r]))}function sN(t){return t+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qe{constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new k(w.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new k(w.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<-62135596800)throw new k(w.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new k(w.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return Qe.fromMillis(Date.now())}static fromDate(e){return Qe.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),s=Math.floor(1e6*(e-1e3*n));return new Qe(n,s)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?ce(this.nanoseconds,e.nanoseconds):ce(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class re{constructor(e){this.timestamp=e}static fromTimestamp(e){return new re(e)}static min(){return new re(new Qe(0,0))}static max(){return new re(new Qe(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gl{constructor(e,n,s){n===void 0?n=0:n>e.length&&G(),s===void 0?s=e.length-n:s>e.length-n&&G(),this.segments=e,this.offset=n,this.len=s}get length(){return this.len}isEqual(e){return Gl.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof Gl?e.forEach(s=>{n.push(s)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,s=this.limit();n<s;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const s=Math.min(e.length,n.length);for(let r=0;r<s;r++){const i=e.get(r),o=n.get(r);if(i<o)return-1;if(i>o)return 1}return e.length<n.length?-1:e.length>n.length?1:0}}class we extends Gl{construct(e,n,s){return new we(e,n,s)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...e){const n=[];for(const s of e){if(s.indexOf("//")>=0)throw new k(w.INVALID_ARGUMENT,`Invalid segment (${s}). Paths must not contain // in them.`);n.push(...s.split("/").filter(r=>r.length>0))}return new we(n)}static emptyPath(){return new we([])}}const M2=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class ct extends Gl{construct(e,n,s){return new ct(e,n,s)}static isValidIdentifier(e){return M2.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),ct.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new ct(["__name__"])}static fromServerFormat(e){const n=[];let s="",r=0;const i=()=>{if(s.length===0)throw new k(w.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(s),s=""};let o=!1;for(;r<e.length;){const a=e[r];if(a==="\\"){if(r+1===e.length)throw new k(w.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const c=e[r+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new k(w.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);s+=c,r+=2}else a==="`"?(o=!o,r++):a!=="."||o?(s+=a,r++):(i(),r++)}if(i(),o)throw new k(w.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new ct(n)}static emptyPath(){return new ct([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U{constructor(e){this.path=e}static fromPath(e){return new U(we.fromString(e))}static fromName(e){return new U(we.fromString(e).popFirst(5))}static empty(){return new U(we.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&we.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return we.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new U(new we(e.slice()))}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rN{constructor(e,n,s,r){this.indexId=e,this.collectionGroup=n,this.fields=s,this.indexState=r}}function Km(t){return t.fields.find(e=>e.kind===2)}function Ci(t){return t.fields.filter(e=>e.kind!==2)}rN.UNKNOWN_ID=-1;class L2{constructor(e,n){this.fieldPath=e,this.kind=n}}class Cd{constructor(e,n){this.sequenceNumber=e,this.offset=n}static empty(){return new Cd(0,Mn.min())}}function iN(t,e){const n=t.toTimestamp().seconds,s=t.toTimestamp().nanoseconds+1,r=re.fromTimestamp(s===1e9?new Qe(n+1,0):new Qe(n,s));return new Mn(r,U.empty(),e)}function oN(t){return new Mn(t.readTime,t.key,-1)}class Mn{constructor(e,n,s){this.readTime=e,this.documentKey=n,this.largestBatchId=s}static min(){return new Mn(re.min(),U.empty(),-1)}static max(){return new Mn(re.max(),U.empty(),-1)}}function Sv(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=U.comparator(t.documentKey,e.documentKey),n!==0?n:ce(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aN="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class cN{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function di(t){if(t.code!==w.FAILED_PRECONDITION||t.message!==aN)throw t;P("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class v{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&G(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new v((s,r)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(s,r)},this.catchCallback=i=>{this.wrapFailure(n,i).next(s,r)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof v?n:v.resolve(n)}catch(n){return v.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):v.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):v.reject(n)}static resolve(e){return new v((n,s)=>{n(e)})}static reject(e){return new v((n,s)=>{s(e)})}static waitFor(e){return new v((n,s)=>{let r=0,i=0,o=!1;e.forEach(a=>{++r,a.next(()=>{++i,o&&i===r&&n()},c=>s(c))}),o=!0,i===r&&n()})}static or(e){let n=v.resolve(!1);for(const s of e)n=n.next(r=>r?v.resolve(r):s());return n}static forEach(e,n){const s=[];return e.forEach((r,i)=>{s.push(n.call(this,r,i))}),this.waitFor(s)}static mapArray(e,n){return new v((s,r)=>{const i=e.length,o=new Array(i);let a=0;for(let c=0;c<i;c++){const l=c;n(e[l]).next(u=>{o[l]=u,++a,a===i&&s(o)},u=>r(u))}})}static doWhile(e,n){return new v((s,r)=>{const i=()=>{e()===!0?n().next(()=>{i()},r):s()};i()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sp{constructor(e,n){this.action=e,this.transaction=n,this.aborted=!1,this.T=new kt,this.transaction.oncomplete=()=>{this.T.resolve()},this.transaction.onabort=()=>{n.error?this.T.reject(new tl(e,n.error)):this.T.resolve()},this.transaction.onerror=s=>{const r=Cv(s.target.error);this.T.reject(new tl(e,r))}}static open(e,n,s,r){try{return new sp(n,e.transaction(r,s))}catch(i){throw new tl(n,i)}}get A(){return this.T.promise}abort(e){e&&this.T.reject(e),this.aborted||(P("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}R(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const n=this.transaction.objectStore(e);return new U2(n)}}class os{constructor(e,n,s){this.name=e,this.version=n,this.P=s,os.v(We())===12.2&&ft("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return P("SimpleDb","Removing database:",e),Ni(window.indexedDB.deleteDatabase(e)).toPromise()}static V(){if(!In())return!1;if(os.S())return!0;const e=We(),n=os.v(e),s=0<n&&n<10,r=os.D(e),i=0<r&&r<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||s||i)}static S(){var e;return typeof process!="undefined"&&((e=process.env)===null||e===void 0?void 0:e.C)==="YES"}static N(e,n){return e.store(n)}static v(e){const n=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),s=n?n[1].split("_").slice(0,2).join("."):"-1";return Number(s)}static D(e){const n=e.match(/Android ([\d.]+)/i),s=n?n[1].split(".").slice(0,2).join("."):"-1";return Number(s)}async k(e){return this.db||(P("SimpleDb","Opening database:",this.name),this.db=await new Promise((n,s)=>{const r=indexedDB.open(this.name,this.version);r.onsuccess=i=>{const o=i.target.result;n(o)},r.onblocked=()=>{s(new tl(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},r.onerror=i=>{const o=i.target.error;o.name==="VersionError"?s(new k(w.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?s(new k(w.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):s(new tl(e,o))},r.onupgradeneeded=i=>{P("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',i.oldVersion);const o=i.target.result;this.P.O(o,r.transaction,i.oldVersion,this.version).next(()=>{P("SimpleDb","Database upgrade to version "+this.version+" complete")})}})),this.M&&(this.db.onversionchange=n=>this.M(n)),this.db}F(e){this.M=e,this.db&&(this.db.onversionchange=n=>e(n))}async runTransaction(e,n,s,r){const i=n==="readonly";let o=0;for(;;){++o;try{this.db=await this.k(e);const a=sp.open(this.db,e,i?"readonly":"readwrite",s),c=r(a).next(l=>(a.R(),l)).catch(l=>(a.abort(l),v.reject(l))).toPromise();return c.catch(()=>{}),await a.A,c}catch(a){const c=a,l=c.name!=="FirebaseError"&&o<3;if(P("SimpleDb","Transaction failed with error:",c.message,"Retrying:",l),this.close(),!l)return Promise.reject(c)}}}close(){this.db&&this.db.close(),this.db=void 0}}class F2{constructor(e){this.$=e,this.B=!1,this.L=null}get isDone(){return this.B}get U(){return this.L}set cursor(e){this.$=e}done(){this.B=!0}q(e){this.L=e}delete(){return Ni(this.$.delete())}}class tl extends k{constructor(e,n){super(w.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${n}`),this.name="IndexedDbTransactionError"}}function fi(t){return t.name==="IndexedDbTransactionError"}class U2{constructor(e){this.store=e}put(e,n){let s;return n!==void 0?(P("SimpleDb","PUT",this.store.name,e,n),s=this.store.put(n,e)):(P("SimpleDb","PUT",this.store.name,"<auto-key>",e),s=this.store.put(e)),Ni(s)}add(e){return P("SimpleDb","ADD",this.store.name,e,e),Ni(this.store.add(e))}get(e){return Ni(this.store.get(e)).next(n=>(n===void 0&&(n=null),P("SimpleDb","GET",this.store.name,e,n),n))}delete(e){return P("SimpleDb","DELETE",this.store.name,e),Ni(this.store.delete(e))}count(){return P("SimpleDb","COUNT",this.store.name),Ni(this.store.count())}K(e,n){const s=this.options(e,n);if(s.index||typeof this.store.getAll!="function"){const r=this.cursor(s),i=[];return this.G(r,(o,a)=>{i.push(a)}).next(()=>i)}{const r=this.store.getAll(s.range);return new v((i,o)=>{r.onerror=a=>{o(a.target.error)},r.onsuccess=a=>{i(a.target.result)}})}}j(e,n){const s=this.store.getAll(e,n===null?void 0:n);return new v((r,i)=>{s.onerror=o=>{i(o.target.error)},s.onsuccess=o=>{r(o.target.result)}})}W(e,n){P("SimpleDb","DELETE ALL",this.store.name);const s=this.options(e,n);s.H=!1;const r=this.cursor(s);return this.G(r,(i,o,a)=>a.delete())}J(e,n){let s;n?s=e:(s={},n=e);const r=this.cursor(s);return this.G(r,n)}Y(e){const n=this.cursor({});return new v((s,r)=>{n.onerror=i=>{const o=Cv(i.target.error);r(o)},n.onsuccess=i=>{const o=i.target.result;o?e(o.primaryKey,o.value).next(a=>{a?o.continue():s()}):s()}})}G(e,n){const s=[];return new v((r,i)=>{e.onerror=o=>{i(o.target.error)},e.onsuccess=o=>{const a=o.target.result;if(!a)return void r();const c=new F2(a),l=n(a.primaryKey,a.value,c);if(l instanceof v){const u=l.catch(h=>(c.done(),v.reject(h)));s.push(u)}c.isDone?r():c.U===null?a.continue():a.continue(c.U)}}).next(()=>v.waitFor(s))}options(e,n){let s;return e!==void 0&&(typeof e=="string"?s=e:n=e),{index:s,range:n}}cursor(e){let n="next";if(e.reverse&&(n="prev"),e.index){const s=this.store.index(e.index);return e.H?s.openKeyCursor(e.range,n):s.openCursor(e.range,n)}return this.store.openCursor(e.range,n)}}function Ni(t){return new v((e,n)=>{t.onsuccess=s=>{const r=s.target.result;e(r)},t.onerror=s=>{const r=Cv(s.target.error);n(r)}})}let kE=!1;function Cv(t){const e=os.v(We());if(e>=12.2&&e<13){const n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){const s=new k("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${n}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return kE||(kE=!0,setTimeout(()=>{throw s},0)),s}}return t}class $2{constructor(e,n){this.asyncQueue=e,this.X=n,this.task=null}start(){}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}Z(e){P("IndexBackiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{P("IndexBackiller",`Documents written: ${await this.X.tt()}`)}catch(n){fi(n)?P("IndexBackiller","Ignoring IndexedDB error during index backfill: ",n):await di(n)}await this.Z(1)})}}class V2{constructor(e,n){this.localStore=e,this.persistence=n}async tt(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",n=>this.et(n,e))}et(e,n){const s=new Set;let r=n,i=!0;return v.doWhile(()=>i===!0&&r>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(o!==null&&!s.has(o))return P("IndexBackiller",`Processing collection: ${o}`),this.nt(e,o,r).next(a=>{r-=a,s.add(o)});i=!1})).next(()=>n-r)}nt(e,n,s){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,n).next(r=>this.localStore.localDocuments.getNextDocuments(e,n,r,s).next(i=>{const o=i.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this.st(r,i)).next(a=>(P("IndexBackiller",`Updating offset: ${a}`),this.localStore.indexManager.updateCollectionGroup(e,n,a))).next(()=>o.size)}))}st(e,n){let s=e;return n.changes.forEach((r,i)=>{const o=oN(i);Sv(o,s)>0&&(s=o)}),new Mn(s.readTime,s.documentKey,Math.max(n.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vn{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=s=>this.it(s),this.rt=s=>n.writeSequenceNumber(s))}it(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.rt&&this.rt(e),e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function RE(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Po(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function lN(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */vn.ot=-1;class it{constructor(e,n){this.comparator=e,this.root=n||Vt.EMPTY}insert(e,n){return new it(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,Vt.BLACK,null,null))}remove(e){return new it(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Vt.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const s=this.comparator(e,n.key);if(s===0)return n.value;s<0?n=n.left:s>0&&(n=n.right)}return null}indexOf(e){let n=0,s=this.root;for(;!s.isEmpty();){const r=this.comparator(e,s.key);if(r===0)return n+s.left.size;r<0?s=s.left:(n+=s.left.size+1,s=s.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,s)=>(e(n,s),!1))}toString(){const e=[];return this.inorderTraversal((n,s)=>(e.push(`${n}:${s}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new lh(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new lh(this.root,e,this.comparator,!1)}getReverseIterator(){return new lh(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new lh(this.root,e,this.comparator,!0)}}class lh{constructor(e,n,s,r){this.isReverse=r,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=n?s(e.key,n):1,n&&r&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Vt{constructor(e,n,s,r,i){this.key=e,this.value=n,this.color=s!=null?s:Vt.RED,this.left=r!=null?r:Vt.EMPTY,this.right=i!=null?i:Vt.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,s,r,i){return new Vt(e!=null?e:this.key,n!=null?n:this.value,s!=null?s:this.color,r!=null?r:this.left,i!=null?i:this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,s){let r=this;const i=s(e,r.key);return r=i<0?r.copy(null,null,null,r.left.insert(e,n,s),null):i===0?r.copy(null,n,null,null,null):r.copy(null,null,null,null,r.right.insert(e,n,s)),r.fixUp()}removeMin(){if(this.left.isEmpty())return Vt.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let s,r=this;if(n(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,n),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),n(e,r.key)===0){if(r.right.isEmpty())return Vt.EMPTY;s=r.right.min(),r=r.copy(s.key,s.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,n))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Vt.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Vt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw G();const e=this.left.check();if(e!==this.right.check())throw G();return e+(this.isRed()?0:1)}}Vt.EMPTY=null,Vt.RED=!0,Vt.BLACK=!1;Vt.EMPTY=new class{constructor(){this.size=0}get key(){throw G()}get value(){throw G()}get color(){throw G()}get left(){throw G()}get right(){throw G()}copy(t,e,n,s,r){return this}insert(t,e,n){return new Vt(t,e)}remove(t,e){return this}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ke{constructor(e){this.comparator=e,this.data=new it(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,s)=>(e(n),!1))}forEachInRange(e,n){const s=this.data.getIteratorFrom(e[0]);for(;s.hasNext();){const r=s.getNext();if(this.comparator(r.key,e[1])>=0)return;n(r.key)}}forEachWhile(e,n){let s;for(s=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();s.hasNext();)if(!e(s.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new NE(this.data.getIterator())}getIteratorFrom(e){return new NE(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(s=>{n=n.add(s)}),n}isEqual(e){if(!(e instanceof ke)||this.size!==e.size)return!1;const n=this.data.getIterator(),s=e.data.getIterator();for(;n.hasNext();){const r=n.getNext().key,i=s.getNext().key;if(this.comparator(r,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new ke(this.comparator);return n.data=e,n}}class NE{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function Bo(t){return t.hasNext()?t.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pn{constructor(e){this.fields=e,e.sort(ct.comparator)}static empty(){return new Pn([])}unionWith(e){let n=new ke(ct.comparator);for(const s of this.fields)n=n.add(s);for(const s of e)n=n.add(s);return new Pn(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return Pa(this.fields,e.fields,(n,s)=>n.isEqual(s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function B2(){return typeof atob!="undefined"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vt{constructor(e){this.binaryString=e}static fromBase64String(e){const n=atob(e);return new vt(n)}static fromUint8Array(e){const n=function(s){let r="";for(let i=0;i<s.length;++i)r+=String.fromCharCode(s[i]);return r}(e);return new vt(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return e=this.binaryString,btoa(e);var e}toUint8Array(){return function(e){const n=new Uint8Array(e.length);for(let s=0;s<e.length;s++)n[s]=e.charCodeAt(s);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return ce(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}vt.EMPTY_BYTE_STRING=new vt("");const q2=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function ni(t){if(ie(!!t),typeof t=="string"){let e=0;const n=q2.exec(t);if(ie(!!n),n[1]){let r=n[1];r=(r+"000000000").substr(0,9),e=Number(r)}const s=new Date(t);return{seconds:Math.floor(s.getTime()/1e3),nanos:e}}return{seconds:nt(t.seconds),nanos:nt(t.nanos)}}function nt(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function lo(t){return typeof t=="string"?vt.fromBase64String(t):vt.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Av(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="server_timestamp"}function uN(t){const e=t.mapValue.fields.__previous_value__;return Av(e)?uN(e):e}function zl(t){const e=ni(t.mapValue.fields.__local_write_time__.timestampValue);return new Qe(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j2{constructor(e,n,s,r,i,o,a,c){this.databaseId=e,this.appId=n,this.persistenceKey=s,this.host=r,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.useFetchStreams=c}}class hr{constructor(e,n){this.projectId=e,this.database=n||"(default)"}static empty(){return new hr("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof hr&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lu(t){return t==null}function Ql(t){return t===0&&1/t==-1/0}function hN(t){return typeof t=="number"&&Number.isInteger(t)&&!Ql(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ur={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},kh={nullValue:"NULL_VALUE"};function uo(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Av(t)?4:dN(t)?9007199254740991:10:G()}function $s(t,e){if(t===e)return!0;const n=uo(t);if(n!==uo(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return zl(t).isEqual(zl(e));case 3:return function(s,r){if(typeof s.timestampValue=="string"&&typeof r.timestampValue=="string"&&s.timestampValue.length===r.timestampValue.length)return s.timestampValue===r.timestampValue;const i=ni(s.timestampValue),o=ni(r.timestampValue);return i.seconds===o.seconds&&i.nanos===o.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(s,r){return lo(s.bytesValue).isEqual(lo(r.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(s,r){return nt(s.geoPointValue.latitude)===nt(r.geoPointValue.latitude)&&nt(s.geoPointValue.longitude)===nt(r.geoPointValue.longitude)}(t,e);case 2:return function(s,r){if("integerValue"in s&&"integerValue"in r)return nt(s.integerValue)===nt(r.integerValue);if("doubleValue"in s&&"doubleValue"in r){const i=nt(s.doubleValue),o=nt(r.doubleValue);return i===o?Ql(i)===Ql(o):isNaN(i)&&isNaN(o)}return!1}(t,e);case 9:return Pa(t.arrayValue.values||[],e.arrayValue.values||[],$s);case 10:return function(s,r){const i=s.mapValue.fields||{},o=r.mapValue.fields||{};if(RE(i)!==RE(o))return!1;for(const a in i)if(i.hasOwnProperty(a)&&(o[a]===void 0||!$s(i[a],o[a])))return!1;return!0}(t,e);default:return G()}}function Yl(t,e){return(t.values||[]).find(n=>$s(n,e))!==void 0}function si(t,e){if(t===e)return 0;const n=uo(t),s=uo(e);if(n!==s)return ce(n,s);switch(n){case 0:case 9007199254740991:return 0;case 1:return ce(t.booleanValue,e.booleanValue);case 2:return function(r,i){const o=nt(r.integerValue||r.doubleValue),a=nt(i.integerValue||i.doubleValue);return o<a?-1:o>a?1:o===a?0:isNaN(o)?isNaN(a)?0:-1:1}(t,e);case 3:return PE(t.timestampValue,e.timestampValue);case 4:return PE(zl(t),zl(e));case 5:return ce(t.stringValue,e.stringValue);case 6:return function(r,i){const o=lo(r),a=lo(i);return o.compareTo(a)}(t.bytesValue,e.bytesValue);case 7:return function(r,i){const o=r.split("/"),a=i.split("/");for(let c=0;c<o.length&&c<a.length;c++){const l=ce(o[c],a[c]);if(l!==0)return l}return ce(o.length,a.length)}(t.referenceValue,e.referenceValue);case 8:return function(r,i){const o=ce(nt(r.latitude),nt(i.latitude));return o!==0?o:ce(nt(r.longitude),nt(i.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(r,i){const o=r.values||[],a=i.values||[];for(let c=0;c<o.length&&c<a.length;++c){const l=si(o[c],a[c]);if(l)return l}return ce(o.length,a.length)}(t.arrayValue,e.arrayValue);case 10:return function(r,i){if(r===Ur.mapValue&&i===Ur.mapValue)return 0;if(r===Ur.mapValue)return 1;if(i===Ur.mapValue)return-1;const o=r.fields||{},a=Object.keys(o),c=i.fields||{},l=Object.keys(c);a.sort(),l.sort();for(let u=0;u<a.length&&u<l.length;++u){const h=ce(a[u],l[u]);if(h!==0)return h;const d=si(o[a[u]],c[l[u]]);if(d!==0)return d}return ce(a.length,l.length)}(t.mapValue,e.mapValue);default:throw G()}}function PE(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return ce(t,e);const n=ni(t),s=ni(e),r=ce(n.seconds,s.seconds);return r!==0?r:ce(n.nanos,s.nanos)}function la(t){return Hm(t)}function Hm(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(s){const r=ni(s);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?lo(t.bytesValue).toBase64():"referenceValue"in t?(n=t.referenceValue,U.fromName(n).toString()):"geoPointValue"in t?`geo(${(e=t.geoPointValue).latitude},${e.longitude})`:"arrayValue"in t?function(s){let r="[",i=!0;for(const o of s.values||[])i?i=!1:r+=",",r+=Hm(o);return r+"]"}(t.arrayValue):"mapValue"in t?function(s){const r=Object.keys(s.fields||{}).sort();let i="{",o=!0;for(const a of r)o?o=!1:i+=",",i+=`${a}:${Hm(s.fields[a])}`;return i+"}"}(t.mapValue):G();var e,n}function ho(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function Wm(t){return!!t&&"integerValue"in t}function Jl(t){return!!t&&"arrayValue"in t}function DE(t){return!!t&&"nullValue"in t}function xE(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Rh(t){return!!t&&"mapValue"in t}function nl(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return Po(t.mapValue.fields,(n,s)=>e.mapValue.fields[n]=nl(s)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=nl(t.arrayValue.values[n]);return e}return Object.assign({},t)}function dN(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}function K2(t){return"nullValue"in t?kh:"booleanValue"in t?{booleanValue:!1}:"integerValue"in t||"doubleValue"in t?{doubleValue:NaN}:"timestampValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in t?{stringValue:""}:"bytesValue"in t?{bytesValue:""}:"referenceValue"in t?ho(hr.empty(),U.empty()):"geoPointValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in t?{arrayValue:{}}:"mapValue"in t?{mapValue:{}}:G()}function H2(t){return"nullValue"in t?{booleanValue:!1}:"booleanValue"in t?{doubleValue:NaN}:"integerValue"in t||"doubleValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in t?{stringValue:""}:"stringValue"in t?{bytesValue:""}:"bytesValue"in t?ho(hr.empty(),U.empty()):"referenceValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in t?{arrayValue:{}}:"arrayValue"in t?{mapValue:{}}:"mapValue"in t?Ur:G()}function OE(t,e){const n=si(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?-1:!t.inclusive&&e.inclusive?1:0}function ME(t,e){const n=si(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?1:!t.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bt{constructor(e){this.value=e}static empty(){return new Bt({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let s=0;s<e.length-1;++s)if(n=(n.mapValue.fields||{})[e.get(s)],!Rh(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=nl(n)}setAll(e){let n=ct.emptyPath(),s={},r=[];e.forEach((o,a)=>{if(!n.isImmediateParentOf(a)){const c=this.getFieldsMap(n);this.applyChanges(c,s,r),s={},r=[],n=a.popLast()}o?s[a.lastSegment()]=nl(o):r.push(a.lastSegment())});const i=this.getFieldsMap(n);this.applyChanges(i,s,r)}delete(e){const n=this.field(e.popLast());Rh(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return $s(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let s=0;s<e.length;++s){let r=n.mapValue.fields[e.get(s)];Rh(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},n.mapValue.fields[e.get(s)]=r),n=r}return n.mapValue.fields}applyChanges(e,n,s){Po(n,(r,i)=>e[r]=i);for(const r of s)delete e[r]}clone(){return new Bt(nl(this.value))}}function fN(t){const e=[];return Po(t.fields,(n,s)=>{const r=new ct([n]);if(Rh(s)){const i=fN(s.mapValue).fields;if(i.length===0)e.push(r);else for(const o of i)e.push(r.child(o))}else e.push(r)}),new Pn(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Be{constructor(e,n,s,r,i,o){this.key=e,this.documentType=n,this.version=s,this.readTime=r,this.data=i,this.documentState=o}static newInvalidDocument(e){return new Be(e,0,re.min(),re.min(),Bt.empty(),0)}static newFoundDocument(e,n,s){return new Be(e,1,n,re.min(),s,0)}static newNoDocument(e,n){return new Be(e,2,n,re.min(),Bt.empty(),0)}static newUnknownDocument(e,n){return new Be(e,3,n,re.min(),Bt.empty(),2)}convertToFoundDocument(e,n){return this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Bt.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Bt.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=re.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Be&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Be(this.key,this.documentType,this.version,this.readTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W2{constructor(e,n=null,s=[],r=[],i=null,o=null,a=null){this.path=e,this.collectionGroup=n,this.orderBy=s,this.filters=r,this.limit=i,this.startAt=o,this.endAt=a,this.ut=null}}function LE(t,e=null,n=[],s=[],r=null,i=null,o=null){return new W2(t,e,n,s,r,i,o)}function fo(t){const e=q(t);if(e.ut===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(s=>{return(r=s).field.canonicalString()+r.op.toString()+la(r.value);var r}).join(","),n+="|ob:",n+=e.orderBy.map(s=>function(r){return r.field.canonicalString()+r.dir}(s)).join(","),Lu(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(s=>la(s)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(s=>la(s)).join(",")),e.ut=n}return e.ut}function G2(t){let e=t.path.canonicalString();return t.collectionGroup!==null&&(e+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(e+=`, filters: [${t.filters.map(n=>{return`${(s=n).field.canonicalString()} ${s.op} ${la(s.value)}`;var s}).join(", ")}]`),Lu(t.limit)||(e+=", limit: "+t.limit),t.orderBy.length>0&&(e+=`, orderBy: [${t.orderBy.map(n=>function(s){return`${s.field.canonicalString()} (${s.dir})`}(n)).join(", ")}]`),t.startAt&&(e+=", startAt: ",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map(n=>la(n)).join(",")),t.endAt&&(e+=", endAt: ",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map(n=>la(n)).join(",")),`Target(${e})`}function Fu(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let r=0;r<t.orderBy.length;r++)if(!t4(t.orderBy[r],e.orderBy[r]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let r=0;r<t.filters.length;r++)if(n=t.filters[r],s=e.filters[r],n.op!==s.op||!n.field.isEqual(s.field)||!$s(n.value,s.value))return!1;var n,s;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!VE(t.startAt,e.startAt)&&VE(t.endAt,e.endAt)}function Ad(t){return U.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}function kd(t,e){return t.filters.filter(n=>n instanceof qt&&n.field.isEqual(e))}function FE(t,e,n){let s=kh,r=!0;for(const i of kd(t,e)){let o=kh,a=!0;switch(i.op){case"<":case"<=":o=K2(i.value);break;case"==":case"in":case">=":o=i.value;break;case">":o=i.value,a=!1;break;case"!=":case"not-in":o=kh}OE({value:s,inclusive:r},{value:o,inclusive:a})<0&&(s=o,r=a)}if(n!==null){for(let i=0;i<t.orderBy.length;++i)if(t.orderBy[i].field.isEqual(e)){const o=n.position[i];OE({value:s,inclusive:r},{value:o,inclusive:n.inclusive})<0&&(s=o,r=n.inclusive);break}}return{value:s,inclusive:r}}function UE(t,e,n){let s=Ur,r=!0;for(const i of kd(t,e)){let o=Ur,a=!0;switch(i.op){case">=":case">":o=H2(i.value),a=!1;break;case"==":case"in":case"<=":o=i.value;break;case"<":o=i.value,a=!1;break;case"!=":case"not-in":o=Ur}ME({value:s,inclusive:r},{value:o,inclusive:a})>0&&(s=o,r=a)}if(n!==null){for(let i=0;i<t.orderBy.length;++i)if(t.orderBy[i].field.isEqual(e)){const o=n.position[i];ME({value:s,inclusive:r},{value:o,inclusive:n.inclusive})>0&&(s=o,r=n.inclusive);break}}return{value:s,inclusive:r}}class qt extends class{}{constructor(e,n,s){super(),this.field=e,this.op=n,this.value=s}static create(e,n,s){return e.isKeyField()?n==="in"||n==="not-in"?this.ct(e,n,s):new z2(e,n,s):n==="array-contains"?new J2(e,s):n==="in"?new X2(e,s):n==="not-in"?new Z2(e,s):n==="array-contains-any"?new e4(e,s):new qt(e,n,s)}static ct(e,n,s){return n==="in"?new Q2(e,s):new Y2(e,s)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&this.at(si(n,this.value)):n!==null&&uo(this.value)===uo(n)&&this.at(si(n,this.value))}at(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return G()}}ht(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}}class z2 extends qt{constructor(e,n,s){super(e,n,s),this.key=U.fromName(s.referenceValue)}matches(e){const n=U.comparator(e.key,this.key);return this.at(n)}}class Q2 extends qt{constructor(e,n){super(e,"in",n),this.keys=pN("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class Y2 extends qt{constructor(e,n){super(e,"not-in",n),this.keys=pN("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function pN(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(s=>U.fromName(s.referenceValue))}class J2 extends qt{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return Jl(n)&&Yl(n.arrayValue,this.value)}}class X2 extends qt{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&Yl(this.value.arrayValue,n)}}class Z2 extends qt{constructor(e,n){super(e,"not-in",n)}matches(e){if(Yl(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&!Yl(this.value.arrayValue,n)}}class e4 extends qt{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!Jl(n)||!n.arrayValue.values)&&n.arrayValue.values.some(s=>Yl(this.value.arrayValue,s))}}class ri{constructor(e,n){this.position=e,this.inclusive=n}}class ua{constructor(e,n="asc"){this.field=e,this.dir=n}}function t4(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}function $E(t,e,n){let s=0;for(let r=0;r<t.position.length;r++){const i=e[r],o=t.position[r];if(i.field.isKeyField()?s=U.comparator(U.fromName(o.referenceValue),n.key):s=si(o,n.data.field(i.field)),i.dir==="desc"&&(s*=-1),s!==0)break}return s}function VE(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!$s(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mr{constructor(e,n=null,s=[],r=[],i=null,o="F",a=null,c=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=s,this.filters=r,this.limit=i,this.limitType=o,this.startAt=a,this.endAt=c,this.lt=null,this.ft=null,this.startAt,this.endAt}}function gN(t,e,n,s,r,i,o,a){return new mr(t,e,n,s,r,i,o,a)}function rc(t){return new mr(t)}function n4(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function kv(t){return t.explicitOrderBy.length>0?t.explicitOrderBy[0].field:null}function Rv(t){for(const e of t.filters)if(e.ht())return e.field;return null}function Nv(t){return t.collectionGroup!==null}function Da(t){const e=q(t);if(e.lt===null){e.lt=[];const n=Rv(e),s=kv(e);if(n!==null&&s===null)n.isKeyField()||e.lt.push(new ua(n)),e.lt.push(new ua(ct.keyField(),"asc"));else{let r=!1;for(const i of e.explicitOrderBy)e.lt.push(i),i.field.isKeyField()&&(r=!0);if(!r){const i=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";e.lt.push(new ua(ct.keyField(),i))}}}return e.lt}function Qn(t){const e=q(t);if(!e.ft)if(e.limitType==="F")e.ft=LE(e.path,e.collectionGroup,Da(e),e.filters,e.limit,e.startAt,e.endAt);else{const n=[];for(const i of Da(e)){const o=i.dir==="desc"?"asc":"desc";n.push(new ua(i.field,o))}const s=e.endAt?new ri(e.endAt.position,e.endAt.inclusive):null,r=e.startAt?new ri(e.startAt.position,e.startAt.inclusive):null;e.ft=LE(e.path,e.collectionGroup,n,e.filters,e.limit,s,r)}return e.ft}function mN(t,e,n){return new mr(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Uu(t,e){return Fu(Qn(t),Qn(e))&&t.limitType===e.limitType}function _N(t){return`${fo(Qn(t))}|lt:${t.limitType}`}function Gm(t){return`Query(target=${G2(Qn(t))}; limitType=${t.limitType})`}function Pv(t,e){return e.isFoundDocument()&&function(n,s){const r=s.key.path;return n.collectionGroup!==null?s.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(r):U.isDocumentKey(n.path)?n.path.isEqual(r):n.path.isImmediateParentOf(r)}(t,e)&&function(n,s){for(const r of n.explicitOrderBy)if(!r.field.isKeyField()&&s.data.field(r.field)===null)return!1;return!0}(t,e)&&function(n,s){for(const r of n.filters)if(!r.matches(s))return!1;return!0}(t,e)&&function(n,s){return!(n.startAt&&!function(r,i,o){const a=$E(r,i,o);return r.inclusive?a<=0:a<0}(n.startAt,Da(n),s)||n.endAt&&!function(r,i,o){const a=$E(r,i,o);return r.inclusive?a>=0:a>0}(n.endAt,Da(n),s))}(t,e)}function yN(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function vN(t){return(e,n)=>{let s=!1;for(const r of Da(t)){const i=s4(r,e,n);if(i!==0)return i;s=s||r.field.isKeyField()}return 0}}function s4(t,e,n){const s=t.field.isKeyField()?U.comparator(e.key,n.key):function(r,i,o){const a=i.data.field(r),c=o.data.field(r);return a!==null&&c!==null?si(a,c):G()}(t.field,e,n);switch(t.dir){case"asc":return s;case"desc":return-1*s;default:return G()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wN(t,e){if(t.dt){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Ql(e)?"-0":e}}function bN(t){return{integerValue:""+t}}function IN(t,e){return hN(e)?bN(e):wN(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rp{constructor(){this._=void 0}}function r4(t,e,n){return t instanceof xa?function(s,r){const i={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return r&&(i.fields.__previous_value__=r),{mapValue:i}}(n,e):t instanceof po?TN(t,e):t instanceof go?SN(t,e):function(s,r){const i=EN(s,r),o=BE(i)+BE(s._t);return Wm(i)&&Wm(s._t)?bN(o):wN(s.wt,o)}(t,e)}function i4(t,e,n){return t instanceof po?TN(t,e):t instanceof go?SN(t,e):n}function EN(t,e){return t instanceof Oa?Wm(n=e)||function(s){return!!s&&"doubleValue"in s}(n)?e:{integerValue:0}:null;var n}class xa extends rp{}class po extends rp{constructor(e){super(),this.elements=e}}function TN(t,e){const n=CN(e);for(const s of t.elements)n.some(r=>$s(r,s))||n.push(s);return{arrayValue:{values:n}}}class go extends rp{constructor(e){super(),this.elements=e}}function SN(t,e){let n=CN(e);for(const s of t.elements)n=n.filter(r=>!$s(r,s));return{arrayValue:{values:n}}}class Oa extends rp{constructor(e,n){super(),this.wt=e,this._t=n}}function BE(t){return nt(t.integerValue||t.doubleValue)}function CN(t){return Jl(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $u{constructor(e,n){this.field=e,this.transform=n}}function o4(t,e){return t.field.isEqual(e.field)&&function(n,s){return n instanceof po&&s instanceof po||n instanceof go&&s instanceof go?Pa(n.elements,s.elements,$s):n instanceof Oa&&s instanceof Oa?$s(n._t,s._t):n instanceof xa&&s instanceof xa}(t.transform,e.transform)}class a4{constructor(e,n){this.version=e,this.transformResults=n}}class Xe{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new Xe}static exists(e){return new Xe(void 0,e)}static updateTime(e){return new Xe(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Nh(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class ip{}function AN(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new oc(t.key,Xe.none()):new ic(t.key,t.data,Xe.none());{const n=t.data,s=Bt.empty();let r=new ke(ct.comparator);for(let i of e.fields)if(!r.has(i)){let o=n.field(i);o===null&&i.length>1&&(i=i.popLast(),o=n.field(i)),o===null?s.delete(i):s.set(i,o),r=r.add(i)}return new _r(t.key,s,new Pn(r.toArray()),Xe.none())}}function c4(t,e,n){t instanceof ic?function(s,r,i){const o=s.value.clone(),a=jE(s.fieldTransforms,r,i.transformResults);o.setAll(a),r.convertToFoundDocument(i.version,o).setHasCommittedMutations()}(t,e,n):t instanceof _r?function(s,r,i){if(!Nh(s.precondition,r))return void r.convertToUnknownDocument(i.version);const o=jE(s.fieldTransforms,r,i.transformResults),a=r.data;a.setAll(kN(s)),a.setAll(o),r.convertToFoundDocument(i.version,a).setHasCommittedMutations()}(t,e,n):function(s,r,i){r.convertToNoDocument(i.version).setHasCommittedMutations()}(0,e,n)}function sl(t,e,n,s){return t instanceof ic?function(r,i,o,a){if(!Nh(r.precondition,i))return o;const c=r.value.clone(),l=KE(r.fieldTransforms,a,i);return c.setAll(l),i.convertToFoundDocument(i.version,c).setHasLocalMutations(),null}(t,e,n,s):t instanceof _r?function(r,i,o,a){if(!Nh(r.precondition,i))return o;const c=KE(r.fieldTransforms,a,i),l=i.data;return l.setAll(kN(r)),l.setAll(c),i.convertToFoundDocument(i.version,l).setHasLocalMutations(),o===null?null:o.unionWith(r.fieldMask.fields).unionWith(r.fieldTransforms.map(u=>u.field))}(t,e,n,s):function(r,i,o){return Nh(r.precondition,i)?(i.convertToNoDocument(i.version).setHasLocalMutations(),null):o}(t,e,n)}function l4(t,e){let n=null;for(const s of t.fieldTransforms){const r=e.data.field(s.field),i=EN(s.transform,r||null);i!=null&&(n===null&&(n=Bt.empty()),n.set(s.field,i))}return n||null}function qE(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(n,s){return n===void 0&&s===void 0||!(!n||!s)&&Pa(n,s,(r,i)=>o4(r,i))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class ic extends ip{constructor(e,n,s,r=[]){super(),this.key=e,this.value=n,this.precondition=s,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class _r extends ip{constructor(e,n,s,r,i=[]){super(),this.key=e,this.data=n,this.fieldMask=s,this.precondition=r,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function kN(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const s=t.data.field(n);e.set(n,s)}}),e}function jE(t,e,n){const s=new Map;ie(t.length===n.length);for(let r=0;r<n.length;r++){const i=t[r],o=i.transform,a=e.data.field(i.field);s.set(i.field,i4(o,a,n[r]))}return s}function KE(t,e,n){const s=new Map;for(const r of t){const i=r.transform,o=n.data.field(r.field);s.set(r.field,r4(i,o,e))}return s}class oc extends ip{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Dv extends ip{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u4{constructor(e){this.count=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var dt,ye;function RN(t){switch(t){default:return G();case w.CANCELLED:case w.UNKNOWN:case w.DEADLINE_EXCEEDED:case w.RESOURCE_EXHAUSTED:case w.INTERNAL:case w.UNAVAILABLE:case w.UNAUTHENTICATED:return!1;case w.INVALID_ARGUMENT:case w.NOT_FOUND:case w.ALREADY_EXISTS:case w.PERMISSION_DENIED:case w.FAILED_PRECONDITION:case w.ABORTED:case w.OUT_OF_RANGE:case w.UNIMPLEMENTED:case w.DATA_LOSS:return!0}}function NN(t){if(t===void 0)return ft("GRPC error has no .code"),w.UNKNOWN;switch(t){case dt.OK:return w.OK;case dt.CANCELLED:return w.CANCELLED;case dt.UNKNOWN:return w.UNKNOWN;case dt.DEADLINE_EXCEEDED:return w.DEADLINE_EXCEEDED;case dt.RESOURCE_EXHAUSTED:return w.RESOURCE_EXHAUSTED;case dt.INTERNAL:return w.INTERNAL;case dt.UNAVAILABLE:return w.UNAVAILABLE;case dt.UNAUTHENTICATED:return w.UNAUTHENTICATED;case dt.INVALID_ARGUMENT:return w.INVALID_ARGUMENT;case dt.NOT_FOUND:return w.NOT_FOUND;case dt.ALREADY_EXISTS:return w.ALREADY_EXISTS;case dt.PERMISSION_DENIED:return w.PERMISSION_DENIED;case dt.FAILED_PRECONDITION:return w.FAILED_PRECONDITION;case dt.ABORTED:return w.ABORTED;case dt.OUT_OF_RANGE:return w.OUT_OF_RANGE;case dt.UNIMPLEMENTED:return w.UNIMPLEMENTED;case dt.DATA_LOSS:return w.DATA_LOSS;default:return G()}}(ye=dt||(dt={}))[ye.OK=0]="OK",ye[ye.CANCELLED=1]="CANCELLED",ye[ye.UNKNOWN=2]="UNKNOWN",ye[ye.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",ye[ye.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",ye[ye.NOT_FOUND=5]="NOT_FOUND",ye[ye.ALREADY_EXISTS=6]="ALREADY_EXISTS",ye[ye.PERMISSION_DENIED=7]="PERMISSION_DENIED",ye[ye.UNAUTHENTICATED=16]="UNAUTHENTICATED",ye[ye.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",ye[ye.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",ye[ye.ABORTED=10]="ABORTED",ye[ye.OUT_OF_RANGE=11]="OUT_OF_RANGE",ye[ye.UNIMPLEMENTED=12]="UNIMPLEMENTED",ye[ye.INTERNAL=13]="INTERNAL",ye[ye.UNAVAILABLE=14]="UNAVAILABLE",ye[ye.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pi{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),s=this.inner[n];if(s!==void 0){for(const[r,i]of s)if(this.equalsFn(r,e))return i}}has(e){return this.get(e)!==void 0}set(e,n){const s=this.mapKeyFn(e),r=this.inner[s];if(r===void 0)return this.inner[s]=[[e,n]],void this.innerSize++;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return void(r[i]=[e,n]);r.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),s=this.inner[n];if(s===void 0)return!1;for(let r=0;r<s.length;r++)if(this.equalsFn(s[r][0],e))return s.length===1?delete this.inner[n]:s.splice(r,1),this.innerSize--,!0;return!1}forEach(e){Po(this.inner,(n,s)=>{for(const[r,i]of s)e(r,i)})}isEmpty(){return lN(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const h4=new it(U.comparator);function wn(){return h4}const PN=new it(U.comparator);function Lc(...t){let e=PN;for(const n of t)e=e.insert(n.key,n);return e}function DN(t){let e=PN;return t.forEach((n,s)=>e=e.insert(n,s.overlayedDocument)),e}function Cs(){return rl()}function xN(){return rl()}function rl(){return new pi(t=>t.toString(),(t,e)=>t.isEqual(e))}const d4=new it(U.comparator),f4=new ke(U.comparator);function ue(...t){let e=f4;for(const n of t)e=e.add(n);return e}const p4=new ke(ce);function op(){return p4}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vu{constructor(e,n,s,r,i){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=s,this.documentUpdates=r,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,n){const s=new Map;return s.set(e,Bu.createSynthesizedTargetChangeForCurrentChange(e,n)),new Vu(re.min(),s,op(),wn(),ue())}}class Bu{constructor(e,n,s,r,i){this.resumeToken=e,this.current=n,this.addedDocuments=s,this.modifiedDocuments=r,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,n){return new Bu(vt.EMPTY_BYTE_STRING,n,ue(),ue(),ue())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ph{constructor(e,n,s,r){this.gt=e,this.removedTargetIds=n,this.key=s,this.yt=r}}class ON{constructor(e,n){this.targetId=e,this.It=n}}class MN{constructor(e,n,s=vt.EMPTY_BYTE_STRING,r=null){this.state=e,this.targetIds=n,this.resumeToken=s,this.cause=r}}class HE{constructor(){this.Tt=0,this.Et=GE(),this.At=vt.EMPTY_BYTE_STRING,this.Rt=!1,this.bt=!0}get current(){return this.Rt}get resumeToken(){return this.At}get Pt(){return this.Tt!==0}get vt(){return this.bt}Vt(e){e.approximateByteSize()>0&&(this.bt=!0,this.At=e)}St(){let e=ue(),n=ue(),s=ue();return this.Et.forEach((r,i)=>{switch(i){case 0:e=e.add(r);break;case 2:n=n.add(r);break;case 1:s=s.add(r);break;default:G()}}),new Bu(this.At,this.Rt,e,n,s)}Dt(){this.bt=!1,this.Et=GE()}Ct(e,n){this.bt=!0,this.Et=this.Et.insert(e,n)}xt(e){this.bt=!0,this.Et=this.Et.remove(e)}Nt(){this.Tt+=1}kt(){this.Tt-=1}Ot(){this.bt=!0,this.Rt=!0}}class g4{constructor(e){this.Mt=e,this.Ft=new Map,this.$t=wn(),this.Bt=WE(),this.Lt=new ke(ce)}Ut(e){for(const n of e.gt)e.yt&&e.yt.isFoundDocument()?this.qt(n,e.yt):this.Kt(n,e.key,e.yt);for(const n of e.removedTargetIds)this.Kt(n,e.key,e.yt)}Gt(e){this.forEachTarget(e,n=>{const s=this.Qt(n);switch(e.state){case 0:this.jt(n)&&s.Vt(e.resumeToken);break;case 1:s.kt(),s.Pt||s.Dt(),s.Vt(e.resumeToken);break;case 2:s.kt(),s.Pt||this.removeTarget(n);break;case 3:this.jt(n)&&(s.Ot(),s.Vt(e.resumeToken));break;case 4:this.jt(n)&&(this.Wt(n),s.Vt(e.resumeToken));break;default:G()}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.Ft.forEach((s,r)=>{this.jt(r)&&n(r)})}zt(e){const n=e.targetId,s=e.It.count,r=this.Ht(n);if(r){const i=r.target;if(Ad(i))if(s===0){const o=new U(i.path);this.Kt(n,o,Be.newNoDocument(o,re.min()))}else ie(s===1);else this.Jt(n)!==s&&(this.Wt(n),this.Lt=this.Lt.add(n))}}Yt(e){const n=new Map;this.Ft.forEach((i,o)=>{const a=this.Ht(o);if(a){if(i.current&&Ad(a.target)){const c=new U(a.target.path);this.$t.get(c)!==null||this.Xt(o,c)||this.Kt(o,c,Be.newNoDocument(c,e))}i.vt&&(n.set(o,i.St()),i.Dt())}});let s=ue();this.Bt.forEach((i,o)=>{let a=!0;o.forEachWhile(c=>{const l=this.Ht(c);return!l||l.purpose===2||(a=!1,!1)}),a&&(s=s.add(i))}),this.$t.forEach((i,o)=>o.setReadTime(e));const r=new Vu(e,n,this.Lt,this.$t,s);return this.$t=wn(),this.Bt=WE(),this.Lt=new ke(ce),r}qt(e,n){if(!this.jt(e))return;const s=this.Xt(e,n.key)?2:0;this.Qt(e).Ct(n.key,s),this.$t=this.$t.insert(n.key,n),this.Bt=this.Bt.insert(n.key,this.Zt(n.key).add(e))}Kt(e,n,s){if(!this.jt(e))return;const r=this.Qt(e);this.Xt(e,n)?r.Ct(n,1):r.xt(n),this.Bt=this.Bt.insert(n,this.Zt(n).delete(e)),s&&(this.$t=this.$t.insert(n,s))}removeTarget(e){this.Ft.delete(e)}Jt(e){const n=this.Qt(e).St();return this.Mt.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}Nt(e){this.Qt(e).Nt()}Qt(e){let n=this.Ft.get(e);return n||(n=new HE,this.Ft.set(e,n)),n}Zt(e){let n=this.Bt.get(e);return n||(n=new ke(ce),this.Bt=this.Bt.insert(e,n)),n}jt(e){const n=this.Ht(e)!==null;return n||P("WatchChangeAggregator","Detected inactive target",e),n}Ht(e){const n=this.Ft.get(e);return n&&n.Pt?null:this.Mt.te(e)}Wt(e){this.Ft.set(e,new HE),this.Mt.getRemoteKeysForTarget(e).forEach(n=>{this.Kt(e,n,null)})}Xt(e,n){return this.Mt.getRemoteKeysForTarget(e).has(n)}}function WE(){return new it(U.comparator)}function GE(){return new it(U.comparator)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const m4=(()=>({asc:"ASCENDING",desc:"DESCENDING"}))(),_4=(()=>({"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"}))();class y4{constructor(e,n){this.databaseId=e,this.dt=n}}function Xl(t,e){return t.dt?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function LN(t,e){return t.dt?e.toBase64():e.toUint8Array()}function v4(t,e){return Xl(t,e.toTimestamp())}function Rt(t){return ie(!!t),re.fromTimestamp(function(e){const n=ni(e);return new Qe(n.seconds,n.nanos)}(t))}function xv(t,e){return function(n){return new we(["projects",n.projectId,"databases",n.database])}(t).child("documents").child(e).canonicalString()}function FN(t){const e=we.fromString(t);return ie(HN(e)),e}function Zl(t,e){return xv(t.databaseId,e.path)}function Ns(t,e){const n=FN(e);if(n.get(1)!==t.databaseId.projectId)throw new k(w.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new k(w.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new U($N(n))}function zm(t,e){return xv(t.databaseId,e)}function UN(t){const e=FN(t);return e.length===4?we.emptyPath():$N(e)}function eu(t){return new we(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function $N(t){return ie(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function zE(t,e,n){return{name:Zl(t,e),fields:n.value.mapValue.fields}}function VN(t,e,n){const s=Ns(t,e.name),r=Rt(e.updateTime),i=new Bt({mapValue:{fields:e.fields}}),o=Be.newFoundDocument(s,r,i);return n&&o.setHasCommittedMutations(),n?o.setHasCommittedMutations():o}function w4(t,e){return"found"in e?function(n,s){ie(!!s.found),s.found.name,s.found.updateTime;const r=Ns(n,s.found.name),i=Rt(s.found.updateTime),o=new Bt({mapValue:{fields:s.found.fields}});return Be.newFoundDocument(r,i,o)}(t,e):"missing"in e?function(n,s){ie(!!s.missing),ie(!!s.readTime);const r=Ns(n,s.missing),i=Rt(s.readTime);return Be.newNoDocument(r,i)}(t,e):G()}function b4(t,e){let n;if("targetChange"in e){e.targetChange;const s=function(c){return c==="NO_CHANGE"?0:c==="ADD"?1:c==="REMOVE"?2:c==="CURRENT"?3:c==="RESET"?4:G()}(e.targetChange.targetChangeType||"NO_CHANGE"),r=e.targetChange.targetIds||[],i=function(c,l){return c.dt?(ie(l===void 0||typeof l=="string"),vt.fromBase64String(l||"")):(ie(l===void 0||l instanceof Uint8Array),vt.fromUint8Array(l||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(c){const l=c.code===void 0?w.UNKNOWN:NN(c.code);return new k(l,c.message||"")}(o);n=new MN(s,r,i,a||null)}else if("documentChange"in e){e.documentChange;const s=e.documentChange;s.document,s.document.name,s.document.updateTime;const r=Ns(t,s.document.name),i=Rt(s.document.updateTime),o=new Bt({mapValue:{fields:s.document.fields}}),a=Be.newFoundDocument(r,i,o),c=s.targetIds||[],l=s.removedTargetIds||[];n=new Ph(c,l,a.key,a)}else if("documentDelete"in e){e.documentDelete;const s=e.documentDelete;s.document;const r=Ns(t,s.document),i=s.readTime?Rt(s.readTime):re.min(),o=Be.newNoDocument(r,i),a=s.removedTargetIds||[];n=new Ph([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const s=e.documentRemove;s.document;const r=Ns(t,s.document),i=s.removedTargetIds||[];n=new Ph([],i,r,null)}else{if(!("filter"in e))return G();{e.filter;const s=e.filter;s.targetId;const r=s.count||0,i=new u4(r),o=s.targetId;n=new ON(o,i)}}return n}function tu(t,e){let n;if(e instanceof ic)n={update:zE(t,e.key,e.value)};else if(e instanceof oc)n={delete:Zl(t,e.key)};else if(e instanceof _r)n={update:zE(t,e.key,e.data),updateMask:k4(e.fieldMask)};else{if(!(e instanceof Dv))return G();n={verify:Zl(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(s=>function(r,i){const o=i.transform;if(o instanceof xa)return{fieldPath:i.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(o instanceof po)return{fieldPath:i.field.canonicalString(),appendMissingElements:{values:o.elements}};if(o instanceof go)return{fieldPath:i.field.canonicalString(),removeAllFromArray:{values:o.elements}};if(o instanceof Oa)return{fieldPath:i.field.canonicalString(),increment:o._t};throw G()}(0,s))),e.precondition.isNone||(n.currentDocument=function(s,r){return r.updateTime!==void 0?{updateTime:v4(s,r.updateTime)}:r.exists!==void 0?{exists:r.exists}:G()}(t,e.precondition)),n}function Qm(t,e){const n=e.currentDocument?function(r){return r.updateTime!==void 0?Xe.updateTime(Rt(r.updateTime)):r.exists!==void 0?Xe.exists(r.exists):Xe.none()}(e.currentDocument):Xe.none(),s=e.updateTransforms?e.updateTransforms.map(r=>function(i,o){let a=null;if("setToServerValue"in o)ie(o.setToServerValue==="REQUEST_TIME"),a=new xa;else if("appendMissingElements"in o){const l=o.appendMissingElements.values||[];a=new po(l)}else if("removeAllFromArray"in o){const l=o.removeAllFromArray.values||[];a=new go(l)}else"increment"in o?a=new Oa(i,o.increment):G();const c=ct.fromServerFormat(o.fieldPath);return new $u(c,a)}(t,r)):[];if(e.update){e.update.name;const r=Ns(t,e.update.name),i=new Bt({mapValue:{fields:e.update.fields}});if(e.updateMask){const o=function(a){const c=a.fieldPaths||[];return new Pn(c.map(l=>ct.fromServerFormat(l)))}(e.updateMask);return new _r(r,i,o,n,s)}return new ic(r,i,n,s)}if(e.delete){const r=Ns(t,e.delete);return new oc(r,n)}if(e.verify){const r=Ns(t,e.verify);return new Dv(r,n)}return G()}function I4(t,e){return t&&t.length>0?(ie(e!==void 0),t.map(n=>function(s,r){let i=s.updateTime?Rt(s.updateTime):Rt(r);return i.isEqual(re.min())&&(i=Rt(r)),new a4(i,s.transformResults||[])}(n,e))):[]}function BN(t,e){return{documents:[zm(t,e.path)]}}function qN(t,e){const n={structuredQuery:{}},s=e.path;e.collectionGroup!==null?(n.parent=zm(t,s),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=zm(t,s.popLast()),n.structuredQuery.from=[{collectionId:s.lastSegment()}]);const r=function(c){if(c.length===0)return;const l=c.map(u=>function(h){if(h.op==="=="){if(xE(h.value))return{unaryFilter:{field:qo(h.field),op:"IS_NAN"}};if(DE(h.value))return{unaryFilter:{field:qo(h.field),op:"IS_NULL"}}}else if(h.op==="!="){if(xE(h.value))return{unaryFilter:{field:qo(h.field),op:"IS_NOT_NAN"}};if(DE(h.value))return{unaryFilter:{field:qo(h.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:qo(h.field),op:S4(h.op),value:h.value}}}(u));return l.length===1?l[0]:{compositeFilter:{op:"AND",filters:l}}}(e.filters);r&&(n.structuredQuery.where=r);const i=function(c){if(c.length!==0)return c.map(l=>function(u){return{field:qo(u.field),direction:T4(u.dir)}}(l))}(e.orderBy);i&&(n.structuredQuery.orderBy=i);const o=function(c,l){return c.dt||Lu(l)?l:{value:l}}(t,e.limit);var a;return o!==null&&(n.structuredQuery.limit=o),e.startAt&&(n.structuredQuery.startAt={before:(a=e.startAt).inclusive,values:a.position}),e.endAt&&(n.structuredQuery.endAt=function(c){return{before:!c.inclusive,values:c.position}}(e.endAt)),n}function jN(t){let e=UN(t.parent);const n=t.structuredQuery,s=n.from?n.from.length:0;let r=null;if(s>0){ie(s===1);const u=n.from[0];u.allDescendants?r=u.collectionId:e=e.child(u.collectionId)}let i=[];n.where&&(i=KN(n.where));let o=[];n.orderBy&&(o=n.orderBy.map(u=>function(h){return new ua(Xo(h.field),function(d){switch(d){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(h.direction))}(u)));let a=null;n.limit&&(a=function(u){let h;return h=typeof u=="object"?u.value:u,Lu(h)?null:h}(n.limit));let c=null;n.startAt&&(c=function(u){const h=!!u.before,d=u.values||[];return new ri(d,h)}(n.startAt));let l=null;return n.endAt&&(l=function(u){const h=!u.before,d=u.values||[];return new ri(d,h)}(n.endAt)),gN(e,r,o,i,a,"F",c,l)}function E4(t,e){const n=function(s,r){switch(r){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return G()}}(0,e.purpose);return n==null?null:{"goog-listen-tags":n}}function KN(t){return t?t.unaryFilter!==void 0?[A4(t)]:t.fieldFilter!==void 0?[C4(t)]:t.compositeFilter!==void 0?t.compositeFilter.filters.map(e=>KN(e)).reduce((e,n)=>e.concat(n)):G():[]}function T4(t){return m4[t]}function S4(t){return _4[t]}function qo(t){return{fieldPath:t.canonicalString()}}function Xo(t){return ct.fromServerFormat(t.fieldPath)}function C4(t){return qt.create(Xo(t.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return G()}}(t.fieldFilter.op),t.fieldFilter.value)}function A4(t){switch(t.unaryFilter.op){case"IS_NAN":const e=Xo(t.unaryFilter.field);return qt.create(e,"==",{doubleValue:NaN});case"IS_NULL":const n=Xo(t.unaryFilter.field);return qt.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=Xo(t.unaryFilter.field);return qt.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const r=Xo(t.unaryFilter.field);return qt.create(r,"!=",{nullValue:"NULL_VALUE"});default:return G()}}function k4(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function HN(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dn(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=QE(e)),e=R4(t.get(n),e);return QE(e)}function R4(t,e){let n=e;const s=t.length;for(let r=0;r<s;r++){const i=t.charAt(r);switch(i){case"\0":n+="";break;case"":n+="";break;default:n+=i}}return n}function QE(t){return t+""}function As(t){const e=t.length;if(ie(e>=2),e===2)return ie(t.charAt(0)===""&&t.charAt(1)===""),we.emptyPath();const n=e-2,s=[];let r="";for(let i=0;i<e;){const o=t.indexOf("",i);switch((o<0||o>n)&&G(),t.charAt(o+1)){case"":const a=t.substring(i,o);let c;r.length===0?c=a:(r+=a,c=r,r=""),s.push(c);break;case"":r+=t.substring(i,o),r+="\0";break;case"":r+=t.substring(i,o+1);break;default:G()}i=o+2}return new we(s)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YE=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dh(t,e){return[t,dn(e)]}function WN(t,e,n){return[t,dn(e),n]}const N4={},P4=["prefixPath","collectionGroup","readTime","documentId"],D4=["prefixPath","collectionGroup","documentId"],x4=["collectionGroup","readTime","prefixPath","documentId"],O4=["canonicalId","targetId"],M4=["targetId","path"],L4=["path","targetId"],F4=["collectionId","parent"],U4=["indexId","uid"],$4=["uid","sequenceNumber"],V4=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],B4=["indexId","uid","orderedDocumentKey"],q4=["userId","collectionPath","documentId"],j4=["userId","collectionPath","largestBatchId"],K4=["userId","collectionGroup","largestBatchId"],GN=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],H4=[...GN,"documentOverlays"],zN=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],QN=zN,W4=[...QN,"indexConfiguration","indexState","indexEntries"];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ym extends cN{constructor(e,n){super(),this.ee=e,this.currentSequenceNumber=n}}function Lt(t,e){const n=q(t);return os.N(n.ee,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ov{constructor(e,n,s,r){this.batchId=e,this.localWriteTime=n,this.baseMutations=s,this.mutations=r}applyToRemoteDocument(e,n){const s=n.mutationResults;for(let r=0;r<this.mutations.length;r++){const i=this.mutations[r];i.key.isEqual(e.key)&&c4(i,e,s[r])}}applyToLocalView(e,n){for(const s of this.baseMutations)s.key.isEqual(e.key)&&(n=sl(s,e,n,this.localWriteTime));for(const s of this.mutations)s.key.isEqual(e.key)&&(n=sl(s,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const s=xN();return this.mutations.forEach(r=>{const i=e.get(r.key),o=i.overlayedDocument;let a=this.applyToLocalView(o,i.mutatedFields);a=n.has(r.key)?null:a;const c=AN(o,a);c!==null&&s.set(r.key,c),o.isValidDocument()||o.convertToNoDocument(re.min())}),s}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),ue())}isEqual(e){return this.batchId===e.batchId&&Pa(this.mutations,e.mutations,(n,s)=>qE(n,s))&&Pa(this.baseMutations,e.baseMutations,(n,s)=>qE(n,s))}}class Mv{constructor(e,n,s,r){this.batch=e,this.commitVersion=n,this.mutationResults=s,this.docVersions=r}static from(e,n,s){ie(e.mutations.length===s.length);let r=d4;const i=e.mutations;for(let o=0;o<i.length;o++)r=r.insert(i[o].key,s[o].version);return new Mv(e,n,s,r)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lv{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hr{constructor(e,n,s,r,i=re.min(),o=re.min(),a=vt.EMPTY_BYTE_STRING){this.target=e,this.targetId=n,this.purpose=s,this.sequenceNumber=r,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a}withSequenceNumber(e){return new Hr(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)}withResumeToken(e,n){return new Hr(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e)}withLastLimboFreeSnapshotVersion(e){return new Hr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YN{constructor(e){this.ne=e}}function G4(t,e){let n;if(e.document)n=VN(t.ne,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const s=U.fromSegments(e.noDocument.path),r=_o(e.noDocument.readTime);n=Be.newNoDocument(s,r),e.hasCommittedMutations&&n.setHasCommittedMutations()}else{if(!e.unknownDocument)return G();{const s=U.fromSegments(e.unknownDocument.path),r=_o(e.unknownDocument.version);n=Be.newUnknownDocument(s,r)}}return e.readTime&&n.setReadTime(function(s){const r=new Qe(s[0],s[1]);return re.fromTimestamp(r)}(e.readTime)),n}function JE(t,e){const n=e.key,s={prefixPath:n.getCollectionPath().popLast().toArray(),collectionGroup:n.collectionGroup,documentId:n.path.lastSegment(),readTime:Rd(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())s.document=function(r,i){return{name:Zl(r,i.key),fields:i.data.value.mapValue.fields,updateTime:Xl(r,i.version.toTimestamp())}}(t.ne,e);else if(e.isNoDocument())s.noDocument={path:n.path.toArray(),readTime:mo(e.version)};else{if(!e.isUnknownDocument())return G();s.unknownDocument={path:n.path.toArray(),version:mo(e.version)}}return s}function Rd(t){const e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function mo(t){const e=t.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function _o(t){const e=new Qe(t.seconds,t.nanoseconds);return re.fromTimestamp(e)}function Pi(t,e){const n=(e.baseMutations||[]).map(i=>Qm(t.ne,i));for(let i=0;i<e.mutations.length-1;++i){const o=e.mutations[i];if(i+1<e.mutations.length&&e.mutations[i+1].transform!==void 0){const a=e.mutations[i+1];o.updateTransforms=a.transform.fieldTransforms,e.mutations.splice(i+1,1),++i}}const s=e.mutations.map(i=>Qm(t.ne,i)),r=Qe.fromMillis(e.localWriteTimeMs);return new Ov(e.batchId,r,n,s)}function Fc(t){const e=_o(t.readTime),n=t.lastLimboFreeSnapshotVersion!==void 0?_o(t.lastLimboFreeSnapshotVersion):re.min();let s;var r;return t.query.documents!==void 0?(ie((r=t.query).documents.length===1),s=Qn(rc(UN(r.documents[0])))):s=function(i){return Qn(jN(i))}(t.query),new Hr(s,t.targetId,0,t.lastListenSequenceNumber,e,n,vt.fromBase64String(t.resumeToken))}function JN(t,e){const n=mo(e.snapshotVersion),s=mo(e.lastLimboFreeSnapshotVersion);let r;r=Ad(e.target)?BN(t.ne,e.target):qN(t.ne,e.target);const i=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:fo(e.target),readTime:n,resumeToken:i,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:s,query:r}}function Fv(t){const e=jN({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?mN(e,e.limit,"L"):e}function dg(t,e){return new Lv(e.largestBatchId,Qm(t.ne,e.overlayMutation))}function XE(t,e){const n=e.path.lastSegment();return[t,dn(e.path.popLast()),n]}function ZE(t,e,n,s){return{indexId:t,uid:e.uid||"",sequenceNumber:n,readTime:mo(s.readTime),documentKey:dn(s.documentKey.path),largestBatchId:s.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z4{getBundleMetadata(e,n){return eT(e).get(n).next(s=>{if(s)return{id:(r=s).bundleId,createTime:_o(r.createTime),version:r.version};var r})}saveBundleMetadata(e,n){return eT(e).put({bundleId:(s=n).id,createTime:mo(Rt(s.createTime)),version:s.version});var s}getNamedQuery(e,n){return tT(e).get(n).next(s=>{if(s)return{name:(r=s).name,query:Fv(r.bundledQuery),readTime:_o(r.readTime)};var r})}saveNamedQuery(e,n){return tT(e).put(function(s){return{name:s.name,readTime:mo(Rt(s.readTime)),bundledQuery:s.bundledQuery}}(n))}}function eT(t){return Lt(t,"bundles")}function tT(t){return Lt(t,"namedQueries")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ap{constructor(e,n){this.wt=e,this.userId=n}static se(e,n){const s=n.uid||"";return new ap(e,s)}getOverlay(e,n){return Ec(e).get(XE(this.userId,n)).next(s=>s?dg(this.wt,s):null)}getOverlays(e,n){const s=Cs();return v.forEach(n,r=>this.getOverlay(e,r).next(i=>{i!==null&&s.set(r,i)})).next(()=>s)}saveOverlays(e,n,s){const r=[];return s.forEach((i,o)=>{const a=new Lv(n,o);r.push(this.ie(e,a))}),v.waitFor(r)}removeOverlaysForBatchId(e,n,s){const r=new Set;n.forEach(o=>r.add(dn(o.getCollectionPath())));const i=[];return r.forEach(o=>{const a=IDBKeyRange.bound([this.userId,o,s],[this.userId,o,s+1],!1,!0);i.push(Ec(e).W("collectionPathOverlayIndex",a))}),v.waitFor(i)}getOverlaysForCollection(e,n,s){const r=Cs(),i=dn(n),o=IDBKeyRange.bound([this.userId,i,s],[this.userId,i,Number.POSITIVE_INFINITY],!0);return Ec(e).K("collectionPathOverlayIndex",o).next(a=>{for(const c of a){const l=dg(this.wt,c);r.set(l.getKey(),l)}return r})}getOverlaysForCollectionGroup(e,n,s,r){const i=Cs();let o;const a=IDBKeyRange.bound([this.userId,n,s],[this.userId,n,Number.POSITIVE_INFINITY],!0);return Ec(e).J({index:"collectionGroupOverlayIndex",range:a},(c,l,u)=>{const h=dg(this.wt,l);i.size()<r||h.largestBatchId===o?(i.set(h.getKey(),h),o=h.largestBatchId):u.done()}).next(()=>i)}ie(e,n){return Ec(e).put(function(s,r,i){const[o,a,c]=XE(r,i.mutation.key);return{userId:r,collectionPath:a,documentId:c,collectionGroup:i.mutation.key.getCollectionGroup(),largestBatchId:i.largestBatchId,overlayMutation:tu(s.ne,i.mutation)}}(this.wt,this.userId,n))}}function Ec(t){return Lt(t,"documentOverlays")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Di{constructor(){}re(e,n){this.oe(e,n),n.ue()}oe(e,n){if("nullValue"in e)this.ce(n,5);else if("booleanValue"in e)this.ce(n,10),n.ae(e.booleanValue?1:0);else if("integerValue"in e)this.ce(n,15),n.ae(nt(e.integerValue));else if("doubleValue"in e){const s=nt(e.doubleValue);isNaN(s)?this.ce(n,13):(this.ce(n,15),Ql(s)?n.ae(0):n.ae(s))}else if("timestampValue"in e){const s=e.timestampValue;this.ce(n,20),typeof s=="string"?n.he(s):(n.he(`${s.seconds||""}`),n.ae(s.nanos||0))}else if("stringValue"in e)this.le(e.stringValue,n),this.fe(n);else if("bytesValue"in e)this.ce(n,30),n.de(lo(e.bytesValue)),this.fe(n);else if("referenceValue"in e)this._e(e.referenceValue,n);else if("geoPointValue"in e){const s=e.geoPointValue;this.ce(n,45),n.ae(s.latitude||0),n.ae(s.longitude||0)}else"mapValue"in e?dN(e)?this.ce(n,Number.MAX_SAFE_INTEGER):(this.we(e.mapValue,n),this.fe(n)):"arrayValue"in e?(this.me(e.arrayValue,n),this.fe(n)):G()}le(e,n){this.ce(n,25),this.ge(e,n)}ge(e,n){n.he(e)}we(e,n){const s=e.fields||{};this.ce(n,55);for(const r of Object.keys(s))this.le(r,n),this.oe(s[r],n)}me(e,n){const s=e.values||[];this.ce(n,50);for(const r of s)this.oe(r,n)}_e(e,n){this.ce(n,37),U.fromName(e).path.forEach(s=>{this.ce(n,60),this.ge(s,n)})}ce(e,n){e.ae(n)}fe(e){e.ae(2)}}Di.ye=new Di;function Q4(t){if(t===0)return 8;let e=0;return t>>4==0&&(e+=4,t<<=4),t>>6==0&&(e+=2,t<<=2),t>>7==0&&(e+=1),e}function nT(t){const e=64-function(n){let s=0;for(let r=0;r<8;++r){const i=Q4(255&n[r]);if(s+=i,i!==8)break}return s}(t);return Math.ceil(e/8)}class Y4{constructor(){this.buffer=new Uint8Array(1024),this.position=0}pe(e){const n=e[Symbol.iterator]();let s=n.next();for(;!s.done;)this.Ie(s.value),s=n.next();this.Te()}Ee(e){const n=e[Symbol.iterator]();let s=n.next();for(;!s.done;)this.Ae(s.value),s=n.next();this.Re()}be(e){for(const n of e){const s=n.charCodeAt(0);if(s<128)this.Ie(s);else if(s<2048)this.Ie(960|s>>>6),this.Ie(128|63&s);else if(n<"\uD800"||"\uDBFF"<n)this.Ie(480|s>>>12),this.Ie(128|63&s>>>6),this.Ie(128|63&s);else{const r=n.codePointAt(0);this.Ie(240|r>>>18),this.Ie(128|63&r>>>12),this.Ie(128|63&r>>>6),this.Ie(128|63&r)}}this.Te()}Pe(e){for(const n of e){const s=n.charCodeAt(0);if(s<128)this.Ae(s);else if(s<2048)this.Ae(960|s>>>6),this.Ae(128|63&s);else if(n<"\uD800"||"\uDBFF"<n)this.Ae(480|s>>>12),this.Ae(128|63&s>>>6),this.Ae(128|63&s);else{const r=n.codePointAt(0);this.Ae(240|r>>>18),this.Ae(128|63&r>>>12),this.Ae(128|63&r>>>6),this.Ae(128|63&r)}}this.Re()}ve(e){const n=this.Ve(e),s=nT(n);this.Se(1+s),this.buffer[this.position++]=255&s;for(let r=n.length-s;r<n.length;++r)this.buffer[this.position++]=255&n[r]}De(e){const n=this.Ve(e),s=nT(n);this.Se(1+s),this.buffer[this.position++]=~(255&s);for(let r=n.length-s;r<n.length;++r)this.buffer[this.position++]=~(255&n[r])}Ce(){this.xe(255),this.xe(255)}Ne(){this.ke(255),this.ke(255)}reset(){this.position=0}seed(e){this.Se(e.length),this.buffer.set(e,this.position),this.position+=e.length}Oe(){return this.buffer.slice(0,this.position)}Ve(e){const n=function(r){const i=new DataView(new ArrayBuffer(8));return i.setFloat64(0,r,!1),new Uint8Array(i.buffer)}(e),s=(128&n[0])!=0;n[0]^=s?255:128;for(let r=1;r<n.length;++r)n[r]^=s?255:0;return n}Ie(e){const n=255&e;n===0?(this.xe(0),this.xe(255)):n===255?(this.xe(255),this.xe(0)):this.xe(n)}Ae(e){const n=255&e;n===0?(this.ke(0),this.ke(255)):n===255?(this.ke(255),this.ke(0)):this.ke(e)}Te(){this.xe(0),this.xe(1)}Re(){this.ke(0),this.ke(1)}xe(e){this.Se(1),this.buffer[this.position++]=e}ke(e){this.Se(1),this.buffer[this.position++]=~e}Se(e){const n=e+this.position;if(n<=this.buffer.length)return;let s=2*this.buffer.length;s<n&&(s=n);const r=new Uint8Array(s);r.set(this.buffer),this.buffer=r}}class J4{constructor(e){this.Me=e}de(e){this.Me.pe(e)}he(e){this.Me.be(e)}ae(e){this.Me.ve(e)}ue(){this.Me.Ce()}}class X4{constructor(e){this.Me=e}de(e){this.Me.Ee(e)}he(e){this.Me.Pe(e)}ae(e){this.Me.De(e)}ue(){this.Me.Ne()}}class Tc{constructor(){this.Me=new Y4,this.Fe=new J4(this.Me),this.$e=new X4(this.Me)}seed(e){this.Me.seed(e)}Be(e){return e===0?this.Fe:this.$e}Oe(){return this.Me.Oe()}reset(){this.Me.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xi{constructor(e,n,s,r){this.indexId=e,this.documentKey=n,this.arrayValue=s,this.directionalValue=r}Le(){const e=this.directionalValue.length,n=e===0||this.directionalValue[e-1]===255?e+1:e,s=new Uint8Array(n);return s.set(this.directionalValue,0),n!==e?s.set([0],this.directionalValue.length):++s[s.length-1],new xi(this.indexId,this.documentKey,this.arrayValue,s)}}function bi(t,e){let n=t.indexId-e.indexId;return n!==0?n:(n=sT(t.arrayValue,e.arrayValue),n!==0?n:(n=sT(t.directionalValue,e.directionalValue),n!==0?n:U.comparator(t.documentKey,e.documentKey)))}function sT(t,e){for(let n=0;n<t.length&&n<e.length;++n){const s=t[n]-e[n];if(s!==0)return s}return t.length-e.length}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z4{constructor(e){this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.Ue=e.orderBy,this.qe=[];for(const n of e.filters){const s=n;s.ht()?this.Ke=s:this.qe.push(s)}}Ge(e){const n=Km(e);if(n!==void 0&&!this.Qe(n))return!1;const s=Ci(e);let r=0,i=0;for(;r<s.length&&this.Qe(s[r]);++r);if(r===s.length)return!0;if(this.Ke!==void 0){const o=s[r];if(!this.je(this.Ke,o)||!this.We(this.Ue[i++],o))return!1;++r}for(;r<s.length;++r){const o=s[r];if(i>=this.Ue.length||!this.We(this.Ue[i++],o))return!1}return!0}Qe(e){for(const n of this.qe)if(this.je(n,e))return!0;return!1}je(e,n){if(e===void 0||!e.field.isEqual(n.fieldPath))return!1;const s=e.op==="array-contains"||e.op==="array-contains-any";return n.kind===2===s}We(e,n){return!!e.field.isEqual(n.fieldPath)&&(n.kind===0&&e.dir==="asc"||n.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e6{constructor(){this.ze=new Uv}addToCollectionParentIndex(e,n){return this.ze.add(n),v.resolve()}getCollectionParents(e,n){return v.resolve(this.ze.getEntries(n))}addFieldIndex(e,n){return v.resolve()}deleteFieldIndex(e,n){return v.resolve()}getDocumentsMatchingTarget(e,n){return v.resolve(null)}getIndexType(e,n){return v.resolve(0)}getFieldIndexes(e,n){return v.resolve([])}getNextCollectionGroupToUpdate(e){return v.resolve(null)}getMinOffset(e,n){return v.resolve(Mn.min())}getMinOffsetFromCollectionGroup(e,n){return v.resolve(Mn.min())}updateCollectionGroup(e,n,s){return v.resolve()}updateIndexEntries(e,n){return v.resolve()}}class Uv{constructor(){this.index={}}add(e){const n=e.lastSegment(),s=e.popLast(),r=this.index[n]||new ke(we.comparator),i=!r.has(s);return this.index[n]=r.add(s),i}has(e){const n=e.lastSegment(),s=e.popLast(),r=this.index[n];return r&&r.has(s)}getEntries(e){return(this.index[e]||new ke(we.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uh=new Uint8Array(0);class t6{constructor(e,n){this.user=e,this.databaseId=n,this.He=new Uv,this.Je=new pi(s=>fo(s),(s,r)=>Fu(s,r)),this.uid=e.uid||""}addToCollectionParentIndex(e,n){if(!this.He.has(n)){const s=n.lastSegment(),r=n.popLast();e.addOnCommittedListener(()=>{this.He.add(n)});const i={collectionId:s,parent:dn(r)};return rT(e).put(i)}return v.resolve()}getCollectionParents(e,n){const s=[],r=IDBKeyRange.bound([n,""],[sN(n),""],!1,!0);return rT(e).K(r).next(i=>{for(const o of i){if(o.collectionId!==n)break;s.push(As(o.parent))}return s})}addFieldIndex(e,n){const s=hh(e),r=function(o){return{indexId:o.indexId,collectionGroup:o.collectionGroup,fields:o.fields.map(a=>[a.fieldPath.canonicalString(),a.kind])}}(n);delete r.indexId;const i=s.add(r);if(n.indexState){const o=Cc(e);return i.next(a=>{o.put(ZE(a,this.user,n.indexState.sequenceNumber,n.indexState.offset))})}return i.next()}deleteFieldIndex(e,n){const s=hh(e),r=Cc(e),i=Sc(e);return s.delete(n.indexId).next(()=>r.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0))).next(()=>i.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0)))}getDocumentsMatchingTarget(e,n){const s=Sc(e);let r=!0;const i=new Map;return v.forEach(this.Ye(n),o=>this.Xe(e,o).next(a=>{r&&(r=!!a),i.set(o,a)})).next(()=>{if(r){let o=ue();const a=[];return v.forEach(i,(c,l)=>{var u;P("IndexedDbIndexManager",`Using index ${u=c,`id=${u.indexId}|cg=${u.collectionGroup}|f=${u.fields.map(E=>`${E.fieldPath}:${E.kind}`).join(",")}`} to execute ${fo(n)}`);const h=function(E,S){const $=Km(S);if($===void 0)return null;for(const H of kd(E,$.fieldPath))switch(H.op){case"array-contains-any":return H.value.arrayValue.values||[];case"array-contains":return[H.value]}return null}(l,c),d=function(E,S){const $=new Map;for(const H of Ci(S))for(const K of kd(E,H.fieldPath))switch(K.op){case"==":case"in":$.set(H.fieldPath.canonicalString(),K.value);break;case"not-in":case"!=":return $.set(H.fieldPath.canonicalString(),K.value),Array.from($.values())}return null}(l,c),f=function(E,S){const $=[];let H=!0;for(const K of Ci(S)){const F=K.kind===0?FE(E,K.fieldPath,E.startAt):UE(E,K.fieldPath,E.startAt);$.push(F.value),H&&(H=F.inclusive)}return new ri($,H)}(l,c),p=function(E,S){const $=[];let H=!0;for(const K of Ci(S)){const F=K.kind===0?UE(E,K.fieldPath,E.endAt):FE(E,K.fieldPath,E.endAt);$.push(F.value),H&&(H=F.inclusive)}return new ri($,H)}(l,c),_=this.Ze(c,l,f),y=this.Ze(c,l,p),T=this.tn(c,l,d),I=this.en(c.indexId,h,_,f.inclusive,y,p.inclusive,T);return v.forEach(I,E=>s.j(E,n.limit).next(S=>{S.forEach($=>{const H=U.fromSegments($.documentKey);o.has(H)||(o=o.add(H),a.push(H))})}))}).next(()=>a)}return v.resolve(null)})}Ye(e){let n=this.Je.get(e);return n||(n=[e],this.Je.set(e,n),n)}en(e,n,s,r,i,o,a){const c=(n!=null?n.length:1)*Math.max(s.length,i.length),l=c/(n!=null?n.length:1),u=[];for(let h=0;h<c;++h){const d=n?this.nn(n[h/l]):uh,f=this.sn(e,d,s[h%l],r),p=this.rn(e,d,i[h%l],o),_=a.map(y=>this.sn(e,d,y,!0));u.push(...this.createRange(f,p,_))}return u}sn(e,n,s,r){const i=new xi(e,U.empty(),n,s);return r?i:i.Le()}rn(e,n,s,r){const i=new xi(e,U.empty(),n,s);return r?i.Le():i}Xe(e,n){const s=new Z4(n),r=n.collectionGroup!=null?n.collectionGroup:n.path.lastSegment();return this.getFieldIndexes(e,r).next(i=>{let o=null;for(const a of i)s.Ge(a)&&(!o||a.fields.length>o.fields.length)&&(o=a);return o})}getIndexType(e,n){let s=2;return v.forEach(this.Ye(n),r=>this.Xe(e,r).next(i=>{i?s!==0&&i.fields.length<function(o){let a=new ke(ct.comparator),c=!1;for(const l of o.filters){const u=l;u.field.isKeyField()||(u.op==="array-contains"||u.op==="array-contains-any"?c=!0:a=a.add(u.field))}for(const l of o.orderBy)l.field.isKeyField()||(a=a.add(l.field));return a.size+(c?1:0)}(r)&&(s=1):s=0})).next(()=>s)}on(e,n){const s=new Tc;for(const r of Ci(e)){const i=n.data.field(r.fieldPath);if(i==null)return null;const o=s.Be(r.kind);Di.ye.re(i,o)}return s.Oe()}nn(e){const n=new Tc;return Di.ye.re(e,n.Be(0)),n.Oe()}un(e,n){const s=new Tc;return Di.ye.re(ho(this.databaseId,n),s.Be(function(r){const i=Ci(r);return i.length===0?0:i[i.length-1].kind}(e))),s.Oe()}tn(e,n,s){if(s===null)return[];let r=[];r.push(new Tc);let i=0;for(const o of Ci(e)){const a=s[i++];for(const c of r)if(this.cn(n,o.fieldPath)&&Jl(a))r=this.an(r,o,a);else{const l=c.Be(o.kind);Di.ye.re(a,l)}}return this.hn(r)}Ze(e,n,s){return this.tn(e,n,s.position)}hn(e){const n=[];for(let s=0;s<e.length;++s)n[s]=e[s].Oe();return n}an(e,n,s){const r=[...e],i=[];for(const o of s.arrayValue.values||[])for(const a of r){const c=new Tc;c.seed(a.Oe()),Di.ye.re(o,c.Be(n.kind)),i.push(c)}return i}cn(e,n){return!!e.filters.find(s=>s instanceof qt&&s.field.isEqual(n)&&(s.op==="in"||s.op==="not-in"))}getFieldIndexes(e,n){const s=hh(e),r=Cc(e);return(n?s.K("collectionGroupIndex",IDBKeyRange.bound(n,n)):s.K()).next(i=>{const o=[];return v.forEach(i,a=>r.get([a.indexId,this.uid]).next(c=>{o.push(function(l,u){const h=u?new Cd(u.sequenceNumber,new Mn(_o(u.readTime),new U(As(u.documentKey)),u.largestBatchId)):Cd.empty(),d=l.fields.map(([f,p])=>new L2(ct.fromServerFormat(f),p));return new rN(l.indexId,l.collectionGroup,d,h)}(a,c))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(n=>n.length===0?null:(n.sort((s,r)=>{const i=s.indexState.sequenceNumber-r.indexState.sequenceNumber;return i!==0?i:ce(s.collectionGroup,r.collectionGroup)}),n[0].collectionGroup))}updateCollectionGroup(e,n,s){const r=hh(e),i=Cc(e);return this.ln(e).next(o=>r.K("collectionGroupIndex",IDBKeyRange.bound(n,n)).next(a=>v.forEach(a,c=>i.put(ZE(c.indexId,this.user,o,s)))))}updateIndexEntries(e,n){const s=new Map;return v.forEach(n,(r,i)=>{const o=s.get(r.collectionGroup);return(o?v.resolve(o):this.getFieldIndexes(e,r.collectionGroup)).next(a=>(s.set(r.collectionGroup,a),v.forEach(a,c=>this.fn(e,r,c).next(l=>{const u=this.dn(i,c);return l.isEqual(u)?v.resolve():this._n(e,i,c,l,u)}))))})}wn(e,n,s,r){return Sc(e).put({indexId:r.indexId,uid:this.uid,arrayValue:r.arrayValue,directionalValue:r.directionalValue,orderedDocumentKey:this.un(s,n.key),documentKey:n.key.path.toArray()})}mn(e,n,s,r){return Sc(e).delete([r.indexId,this.uid,r.arrayValue,r.directionalValue,this.un(s,n.key),n.key.path.toArray()])}fn(e,n,s){const r=Sc(e);let i=new ke(bi);return r.J({index:"documentKeyIndex",range:IDBKeyRange.only([s.indexId,this.uid,this.un(s,n)])},(o,a)=>{i=i.add(new xi(s.indexId,n,a.arrayValue,a.directionalValue))}).next(()=>i)}dn(e,n){let s=new ke(bi);const r=this.on(n,e);if(r==null)return s;const i=Km(n);if(i!=null){const o=e.data.field(i.fieldPath);if(Jl(o))for(const a of o.arrayValue.values||[])s=s.add(new xi(n.indexId,e.key,this.nn(a),r))}else s=s.add(new xi(n.indexId,e.key,uh,r));return s}_n(e,n,s,r,i){P("IndexedDbIndexManager","Updating index entries for document '%s'",n.key);const o=[];return function(a,c,l,u,h){const d=a.getIterator(),f=c.getIterator();let p=Bo(d),_=Bo(f);for(;p||_;){let y=!1,T=!1;if(p&&_){const I=l(p,_);I<0?T=!0:I>0&&(y=!0)}else p!=null?T=!0:y=!0;y?(u(_),_=Bo(f)):T?(h(p),p=Bo(d)):(p=Bo(d),_=Bo(f))}}(r,i,bi,a=>{o.push(this.wn(e,n,s,a))},a=>{o.push(this.mn(e,n,s,a))}),v.waitFor(o)}ln(e){let n=1;return Cc(e).J({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(s,r,i)=>{i.done(),n=r.sequenceNumber+1}).next(()=>n)}createRange(e,n,s){s=s.sort((o,a)=>bi(o,a)).filter((o,a,c)=>!a||bi(o,c[a-1])!==0);const r=[];r.push(e);for(const o of s){const a=bi(o,e),c=bi(o,n);if(a===0)r[0]=e.Le();else if(a>0&&c<0)r.push(o),r.push(o.Le());else if(c>0)break}r.push(n);const i=[];for(let o=0;o<r.length;o+=2)i.push(IDBKeyRange.bound([r[o].indexId,this.uid,r[o].arrayValue,r[o].directionalValue,uh,[]],[r[o+1].indexId,this.uid,r[o+1].arrayValue,r[o+1].directionalValue,uh,[]]));return i}getMinOffsetFromCollectionGroup(e,n){return this.getFieldIndexes(e,n).next(iT)}getMinOffset(e,n){return v.mapArray(this.Ye(n),s=>this.Xe(e,s).next(r=>r||G())).next(iT)}}function rT(t){return Lt(t,"collectionParents")}function Sc(t){return Lt(t,"indexEntries")}function hh(t){return Lt(t,"indexConfiguration")}function Cc(t){return Lt(t,"indexState")}function iT(t){ie(t.length!==0);let e=t[0].indexState.offset,n=e.largestBatchId;for(let s=1;s<t.length;s++){const r=t[s].indexState.offset;Sv(r,e)<0&&(e=r),n<r.largestBatchId&&(n=r.largestBatchId)}return new Mn(e.readTime,e.documentKey,n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oT={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class mn{constructor(e,n,s){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=s}static withCacheSize(e){return new mn(e,mn.DEFAULT_COLLECTION_PERCENTILE,mn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function XN(t,e,n){const s=t.store("mutations"),r=t.store("documentMutations"),i=[],o=IDBKeyRange.only(n.batchId);let a=0;const c=s.J({range:o},(u,h,d)=>(a++,d.delete()));i.push(c.next(()=>{ie(a===1)}));const l=[];for(const u of n.mutations){const h=WN(e,u.key.path,n.batchId);i.push(r.delete(h)),l.push(u.key)}return v.waitFor(i).next(()=>l)}function Nd(t){if(!t)return 0;let e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw G();e=t.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */mn.DEFAULT_COLLECTION_PERCENTILE=10,mn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,mn.DEFAULT=new mn(41943040,mn.DEFAULT_COLLECTION_PERCENTILE,mn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),mn.DISABLED=new mn(-1,0,0);class cp{constructor(e,n,s,r){this.userId=e,this.wt=n,this.indexManager=s,this.referenceDelegate=r,this.gn={}}static se(e,n,s,r){ie(e.uid!=="");const i=e.isAuthenticated()?e.uid:"";return new cp(i,n,s,r)}checkEmpty(e){let n=!0;const s=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Cr(e).J({index:"userMutationsIndex",range:s},(r,i,o)=>{n=!1,o.done()}).next(()=>n)}addMutationBatch(e,n,s,r){const i=Qo(e),o=Cr(e);return o.add({}).next(a=>{ie(typeof a=="number");const c=new Ov(a,n,s,r),l=function(d,f,p){const _=p.baseMutations.map(T=>tu(d.ne,T)),y=p.mutations.map(T=>tu(d.ne,T));return{userId:f,batchId:p.batchId,localWriteTimeMs:p.localWriteTime.toMillis(),baseMutations:_,mutations:y}}(this.wt,this.userId,c),u=[];let h=new ke((d,f)=>ce(d.canonicalString(),f.canonicalString()));for(const d of r){const f=WN(this.userId,d.key.path,a);h=h.add(d.key.path.popLast()),u.push(o.put(l)),u.push(i.put(f,N4))}return h.forEach(d=>{u.push(this.indexManager.addToCollectionParentIndex(e,d))}),e.addOnCommittedListener(()=>{this.gn[a]=c.keys()}),v.waitFor(u).next(()=>c)})}lookupMutationBatch(e,n){return Cr(e).get(n).next(s=>s?(ie(s.userId===this.userId),Pi(this.wt,s)):null)}yn(e,n){return this.gn[n]?v.resolve(this.gn[n]):this.lookupMutationBatch(e,n).next(s=>{if(s){const r=s.keys();return this.gn[n]=r,r}return null})}getNextMutationBatchAfterBatchId(e,n){const s=n+1,r=IDBKeyRange.lowerBound([this.userId,s]);let i=null;return Cr(e).J({index:"userMutationsIndex",range:r},(o,a,c)=>{a.userId===this.userId&&(ie(a.batchId>=s),i=Pi(this.wt,a)),c.done()}).next(()=>i)}getHighestUnacknowledgedBatchId(e){const n=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let s=-1;return Cr(e).J({index:"userMutationsIndex",range:n,reverse:!0},(r,i,o)=>{s=i.batchId,o.done()}).next(()=>s)}getAllMutationBatches(e){const n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Cr(e).K("userMutationsIndex",n).next(s=>s.map(r=>Pi(this.wt,r)))}getAllMutationBatchesAffectingDocumentKey(e,n){const s=Dh(this.userId,n.path),r=IDBKeyRange.lowerBound(s),i=[];return Qo(e).J({range:r},(o,a,c)=>{const[l,u,h]=o,d=As(u);if(l===this.userId&&n.path.isEqual(d))return Cr(e).get(h).next(f=>{if(!f)throw G();ie(f.userId===this.userId),i.push(Pi(this.wt,f))});c.done()}).next(()=>i)}getAllMutationBatchesAffectingDocumentKeys(e,n){let s=new ke(ce);const r=[];return n.forEach(i=>{const o=Dh(this.userId,i.path),a=IDBKeyRange.lowerBound(o),c=Qo(e).J({range:a},(l,u,h)=>{const[d,f,p]=l,_=As(f);d===this.userId&&i.path.isEqual(_)?s=s.add(p):h.done()});r.push(c)}),v.waitFor(r).next(()=>this.pn(e,s))}getAllMutationBatchesAffectingQuery(e,n){const s=n.path,r=s.length+1,i=Dh(this.userId,s),o=IDBKeyRange.lowerBound(i);let a=new ke(ce);return Qo(e).J({range:o},(c,l,u)=>{const[h,d,f]=c,p=As(d);h===this.userId&&s.isPrefixOf(p)?p.length===r&&(a=a.add(f)):u.done()}).next(()=>this.pn(e,a))}pn(e,n){const s=[],r=[];return n.forEach(i=>{r.push(Cr(e).get(i).next(o=>{if(o===null)throw G();ie(o.userId===this.userId),s.push(Pi(this.wt,o))}))}),v.waitFor(r).next(()=>s)}removeMutationBatch(e,n){return XN(e.ee,this.userId,n).next(s=>(e.addOnCommittedListener(()=>{this.In(n.batchId)}),v.forEach(s,r=>this.referenceDelegate.markPotentiallyOrphaned(e,r))))}In(e){delete this.gn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(n=>{if(!n)return v.resolve();const s=IDBKeyRange.lowerBound([this.userId]),r=[];return Qo(e).J({range:s},(i,o,a)=>{if(i[0]===this.userId){const c=As(i[1]);r.push(c)}else a.done()}).next(()=>{ie(r.length===0)})})}containsKey(e,n){return ZN(e,this.userId,n)}Tn(e){return eP(e).get(this.userId).next(n=>n||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}}function ZN(t,e,n){const s=Dh(e,n.path),r=s[1],i=IDBKeyRange.lowerBound(s);let o=!1;return Qo(t).J({range:i,H:!0},(a,c,l)=>{const[u,h,d]=a;u===e&&h===r&&(o=!0),l.done()}).next(()=>o)}function Cr(t){return Lt(t,"mutations")}function Qo(t){return Lt(t,"documentMutations")}function eP(t){return Lt(t,"mutationQueues")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yo{constructor(e){this.En=e}next(){return this.En+=2,this.En}static An(){return new yo(0)}static Rn(){return new yo(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class n6{constructor(e,n){this.referenceDelegate=e,this.wt=n}allocateTargetId(e){return this.bn(e).next(n=>{const s=new yo(n.highestTargetId);return n.highestTargetId=s.next(),this.Pn(e,n).next(()=>n.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.bn(e).next(n=>re.fromTimestamp(new Qe(n.lastRemoteSnapshotVersion.seconds,n.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.bn(e).next(n=>n.highestListenSequenceNumber)}setTargetsMetadata(e,n,s){return this.bn(e).next(r=>(r.highestListenSequenceNumber=n,s&&(r.lastRemoteSnapshotVersion=s.toTimestamp()),n>r.highestListenSequenceNumber&&(r.highestListenSequenceNumber=n),this.Pn(e,r)))}addTargetData(e,n){return this.vn(e,n).next(()=>this.bn(e).next(s=>(s.targetCount+=1,this.Vn(n,s),this.Pn(e,s))))}updateTargetData(e,n){return this.vn(e,n)}removeTargetData(e,n){return this.removeMatchingKeysForTargetId(e,n.targetId).next(()=>jo(e).delete(n.targetId)).next(()=>this.bn(e)).next(s=>(ie(s.targetCount>0),s.targetCount-=1,this.Pn(e,s)))}removeTargets(e,n,s){let r=0;const i=[];return jo(e).J((o,a)=>{const c=Fc(a);c.sequenceNumber<=n&&s.get(c.targetId)===null&&(r++,i.push(this.removeTargetData(e,c)))}).next(()=>v.waitFor(i)).next(()=>r)}forEachTarget(e,n){return jo(e).J((s,r)=>{const i=Fc(r);n(i)})}bn(e){return aT(e).get("targetGlobalKey").next(n=>(ie(n!==null),n))}Pn(e,n){return aT(e).put("targetGlobalKey",n)}vn(e,n){return jo(e).put(JN(this.wt,n))}Vn(e,n){let s=!1;return e.targetId>n.highestTargetId&&(n.highestTargetId=e.targetId,s=!0),e.sequenceNumber>n.highestListenSequenceNumber&&(n.highestListenSequenceNumber=e.sequenceNumber,s=!0),s}getTargetCount(e){return this.bn(e).next(n=>n.targetCount)}getTargetData(e,n){const s=fo(n),r=IDBKeyRange.bound([s,Number.NEGATIVE_INFINITY],[s,Number.POSITIVE_INFINITY]);let i=null;return jo(e).J({range:r,index:"queryTargetsIndex"},(o,a,c)=>{const l=Fc(a);Fu(n,l.target)&&(i=l,c.done())}).next(()=>i)}addMatchingKeys(e,n,s){const r=[],i=xr(e);return n.forEach(o=>{const a=dn(o.path);r.push(i.put({targetId:s,path:a})),r.push(this.referenceDelegate.addReference(e,s,o))}),v.waitFor(r)}removeMatchingKeys(e,n,s){const r=xr(e);return v.forEach(n,i=>{const o=dn(i.path);return v.waitFor([r.delete([s,o]),this.referenceDelegate.removeReference(e,s,i)])})}removeMatchingKeysForTargetId(e,n){const s=xr(e),r=IDBKeyRange.bound([n],[n+1],!1,!0);return s.delete(r)}getMatchingKeysForTargetId(e,n){const s=IDBKeyRange.bound([n],[n+1],!1,!0),r=xr(e);let i=ue();return r.J({range:s,H:!0},(o,a,c)=>{const l=As(o[1]),u=new U(l);i=i.add(u)}).next(()=>i)}containsKey(e,n){const s=dn(n.path),r=IDBKeyRange.bound([s],[sN(s)],!1,!0);let i=0;return xr(e).J({index:"documentTargetsIndex",H:!0,range:r},([o,a],c,l)=>{o!==0&&(i++,l.done())}).next(()=>i>0)}te(e,n){return jo(e).get(n).next(s=>s?Fc(s):null)}}function jo(t){return Lt(t,"targets")}function aT(t){return Lt(t,"targetGlobal")}function xr(t){return Lt(t,"targetDocuments")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cT([t,e],[n,s]){const r=ce(t,n);return r===0?ce(e,s):r}class s6{constructor(e){this.Sn=e,this.buffer=new ke(cT),this.Dn=0}Cn(){return++this.Dn}xn(e){const n=[e,this.Cn()];if(this.buffer.size<this.Sn)this.buffer=this.buffer.add(n);else{const s=this.buffer.last();cT(n,s)<0&&(this.buffer=this.buffer.delete(s).add(n))}}get maxValue(){return this.buffer.last()[0]}}class r6{constructor(e,n,s){this.garbageCollector=e,this.asyncQueue=n,this.localStore=s,this.Nn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.kn(6e4)}stop(){this.Nn&&(this.Nn.cancel(),this.Nn=null)}get started(){return this.Nn!==null}kn(e){P("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.Nn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Nn=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){fi(n)?P("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",n):await di(n)}await this.kn(3e5)})}}class i6{constructor(e,n){this.On=e,this.params=n}calculateTargetCount(e,n){return this.On.Mn(e).next(s=>Math.floor(n/100*s))}nthSequenceNumber(e,n){if(n===0)return v.resolve(vn.ot);const s=new s6(n);return this.On.forEachTarget(e,r=>s.xn(r.sequenceNumber)).next(()=>this.On.Fn(e,r=>s.xn(r))).next(()=>s.maxValue)}removeTargets(e,n,s){return this.On.removeTargets(e,n,s)}removeOrphanedDocuments(e,n){return this.On.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(P("LruGarbageCollector","Garbage collection skipped; disabled"),v.resolve(oT)):this.getCacheSize(e).next(s=>s<this.params.cacheSizeCollectionThreshold?(P("LruGarbageCollector",`Garbage collection skipped; Cache size ${s} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),oT):this.$n(e,n))}getCacheSize(e){return this.On.getCacheSize(e)}$n(e,n){let s,r,i,o,a,c,l;const u=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(h=>(h>this.params.maximumSequenceNumbersToCollect?(P("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${h}`),r=this.params.maximumSequenceNumbersToCollect):r=h,o=Date.now(),this.nthSequenceNumber(e,r))).next(h=>(s=h,a=Date.now(),this.removeTargets(e,s,n))).next(h=>(i=h,c=Date.now(),this.removeOrphanedDocuments(e,s))).next(h=>(l=Date.now(),jm()<=fe.DEBUG&&P("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-u}ms
	Determined least recently used ${r} in `+(a-o)+`ms
	Removed ${i} targets in `+(c-a)+`ms
	Removed ${h} documents in `+(l-c)+`ms
Total Duration: ${l-u}ms`),v.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:i,documentsRemoved:h})))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class o6{constructor(e,n){this.db=e,this.garbageCollector=function(s,r){return new i6(s,r)}(this,n)}Mn(e){const n=this.Bn(e);return this.db.getTargetCache().getTargetCount(e).next(s=>n.next(r=>s+r))}Bn(e){let n=0;return this.Fn(e,s=>{n++}).next(()=>n)}forEachTarget(e,n){return this.db.getTargetCache().forEachTarget(e,n)}Fn(e,n){return this.Ln(e,(s,r)=>n(r))}addReference(e,n,s){return dh(e,s)}removeReference(e,n,s){return dh(e,s)}removeTargets(e,n,s){return this.db.getTargetCache().removeTargets(e,n,s)}markPotentiallyOrphaned(e,n){return dh(e,n)}Un(e,n){return function(s,r){let i=!1;return eP(s).Y(o=>ZN(s,o,r).next(a=>(a&&(i=!0),v.resolve(!a)))).next(()=>i)}(e,n)}removeOrphanedDocuments(e,n){const s=this.db.getRemoteDocumentCache().newChangeBuffer(),r=[];let i=0;return this.Ln(e,(o,a)=>{if(a<=n){const c=this.Un(e,o).next(l=>{if(!l)return i++,s.getEntry(e,o).next(()=>(s.removeEntry(o,re.min()),xr(e).delete([0,dn(o.path)])))});r.push(c)}}).next(()=>v.waitFor(r)).next(()=>s.apply(e)).next(()=>i)}removeTarget(e,n){const s=n.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,s)}updateLimboDocument(e,n){return dh(e,n)}Ln(e,n){const s=xr(e);let r,i=vn.ot;return s.J({index:"documentTargetsIndex"},([o,a],{path:c,sequenceNumber:l})=>{o===0?(i!==vn.ot&&n(new U(As(r)),i),i=l,r=c):i=vn.ot}).next(()=>{i!==vn.ot&&n(new U(As(r)),i)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function dh(t,e){return xr(t).put(function(n,s){return{targetId:0,path:dn(n.path),sequenceNumber:s}}(e,t.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tP{constructor(){this.changes=new pi(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,Be.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const s=this.changes.get(n);return s!==void 0?v.resolve(s):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class a6{constructor(e){this.wt=e}setIndexManager(e){this.indexManager=e}addEntry(e,n,s){return Ii(e).put(s)}removeEntry(e,n,s){return Ii(e).delete(function(r,i){const o=r.path.toArray();return[o.slice(0,o.length-2),o[o.length-2],Rd(i),o[o.length-1]]}(n,s))}updateMetadata(e,n){return this.getMetadata(e).next(s=>(s.byteSize+=n,this.qn(e,s)))}getEntry(e,n){let s=Be.newInvalidDocument(n);return Ii(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(Ac(n))},(r,i)=>{s=this.Kn(n,i)}).next(()=>s)}Gn(e,n){let s={size:0,document:Be.newInvalidDocument(n)};return Ii(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(Ac(n))},(r,i)=>{s={document:this.Kn(n,i),size:Nd(i)}}).next(()=>s)}getEntries(e,n){let s=wn();return this.Qn(e,n,(r,i)=>{const o=this.Kn(r,i);s=s.insert(r,o)}).next(()=>s)}jn(e,n){let s=wn(),r=new it(U.comparator);return this.Qn(e,n,(i,o)=>{const a=this.Kn(i,o);s=s.insert(i,a),r=r.insert(i,Nd(o))}).next(()=>({documents:s,Wn:r}))}Qn(e,n,s){if(n.isEmpty())return v.resolve();let r=new ke(hT);n.forEach(c=>r=r.add(c));const i=IDBKeyRange.bound(Ac(r.first()),Ac(r.last())),o=r.getIterator();let a=o.getNext();return Ii(e).J({index:"documentKeyIndex",range:i},(c,l,u)=>{const h=U.fromSegments([...l.prefixPath,l.collectionGroup,l.documentId]);for(;a&&hT(a,h)<0;)s(a,null),a=o.getNext();a&&a.isEqual(h)&&(s(a,l),a=o.hasNext()?o.getNext():null),a?u.q(Ac(a)):u.done()}).next(()=>{for(;a;)s(a,null),a=o.hasNext()?o.getNext():null})}getAllFromCollection(e,n,s){const r=[n.popLast().toArray(),n.lastSegment(),Rd(s.readTime),s.documentKey.path.isEmpty()?"":s.documentKey.path.lastSegment()],i=[n.popLast().toArray(),n.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Ii(e).K(IDBKeyRange.bound(r,i,!0)).next(o=>{let a=wn();for(const c of o){const l=this.Kn(U.fromSegments(c.prefixPath.concat(c.collectionGroup,c.documentId)),c);a=a.insert(l.key,l)}return a})}getAllFromCollectionGroup(e,n,s,r){let i=wn();const o=uT(n,s),a=uT(n,Mn.max());return Ii(e).J({index:"collectionGroupIndex",range:IDBKeyRange.bound(o,a,!0)},(c,l,u)=>{const h=this.Kn(U.fromSegments(l.prefixPath.concat(l.collectionGroup,l.documentId)),l);i=i.insert(h.key,h),i.size===r&&u.done()}).next(()=>i)}newChangeBuffer(e){return new c6(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(n=>n.byteSize)}getMetadata(e){return lT(e).get("remoteDocumentGlobalKey").next(n=>(ie(!!n),n))}qn(e,n){return lT(e).put("remoteDocumentGlobalKey",n)}Kn(e,n){if(n){const s=G4(this.wt,n);if(!(s.isNoDocument()&&s.version.isEqual(re.min())))return s}return Be.newInvalidDocument(e)}}function nP(t){return new a6(t)}class c6 extends tP{constructor(e,n){super(),this.zn=e,this.trackRemovals=n,this.Hn=new pi(s=>s.toString(),(s,r)=>s.isEqual(r))}applyChanges(e){const n=[];let s=0,r=new ke((i,o)=>ce(i.canonicalString(),o.canonicalString()));return this.changes.forEach((i,o)=>{const a=this.Hn.get(i);if(n.push(this.zn.removeEntry(e,i,a.readTime)),o.isValidDocument()){const c=JE(this.zn.wt,o);r=r.add(i.path.popLast()),s+=Nd(c)-a.size,n.push(this.zn.addEntry(e,i,c))}else if(s-=a.size,this.trackRemovals){const c=JE(this.zn.wt,o.convertToNoDocument(re.min()));n.push(this.zn.addEntry(e,i,c))}}),r.forEach(i=>{n.push(this.zn.indexManager.addToCollectionParentIndex(e,i))}),n.push(this.zn.updateMetadata(e,s)),v.waitFor(n)}getFromCache(e,n){return this.zn.Gn(e,n).next(s=>(this.Hn.set(n,{size:s.size,readTime:s.document.readTime}),s.document))}getAllFromCache(e,n){return this.zn.jn(e,n).next(({documents:s,Wn:r})=>(r.forEach((i,o)=>{this.Hn.set(i,{size:o,readTime:s.get(i).readTime})}),s))}}function lT(t){return Lt(t,"remoteDocumentGlobal")}function Ii(t){return Lt(t,"remoteDocumentsV14")}function Ac(t){const e=t.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function uT(t,e){const n=e.documentKey.path.toArray();return[t,Rd(e.readTime),n.slice(0,n.length-2),n.length>0?n[n.length-1]:""]}function hT(t,e){const n=t.path.toArray(),s=e.path.toArray();let r=0;for(let i=0;i<n.length-2&&i<s.length-2;++i)if(r=ce(n[i],s[i]),r)return r;return r=ce(n.length,s.length),r||(r=ce(n[n.length-2],s[s.length-2]),r||ce(n[n.length-1],s[s.length-1]))}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l6{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sP{constructor(e,n,s,r){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=s,this.indexManager=r}getDocument(e,n){let s=null;return this.documentOverlayCache.getOverlay(e,n).next(r=>(s=r,this.getBaseDocument(e,n,s))).next(r=>(s!==null&&sl(s.mutation,r,Pn.empty(),Qe.now()),r))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(s=>this.getLocalViewOfDocuments(e,s,ue()).next(()=>s))}getLocalViewOfDocuments(e,n,s=ue()){const r=Cs();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,s).next(i=>{let o=Lc();return i.forEach((a,c)=>{o=o.insert(a,c.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){const s=Cs();return this.populateOverlays(e,s,n).next(()=>this.computeViews(e,n,s,ue()))}populateOverlays(e,n,s){const r=[];return s.forEach(i=>{n.has(i)||r.push(i)}),this.documentOverlayCache.getOverlays(e,r).next(i=>{i.forEach((o,a)=>{n.set(o,a)})})}computeViews(e,n,s,r){let i=wn();const o=rl(),a=rl();return n.forEach((c,l)=>{const u=s.get(l.key);r.has(l.key)&&(u===void 0||u.mutation instanceof _r)?i=i.insert(l.key,l):u!==void 0&&(o.set(l.key,u.mutation.getFieldMask()),sl(u.mutation,l,u.mutation.getFieldMask(),Qe.now()))}),this.recalculateAndSaveOverlays(e,i).next(c=>(c.forEach((l,u)=>o.set(l,u)),n.forEach((l,u)=>{var h;return a.set(l,new l6(u,(h=o.get(l))!==null&&h!==void 0?h:null))}),a))}recalculateAndSaveOverlays(e,n){const s=rl();let r=new it((o,a)=>o-a),i=ue();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(const a of o)a.keys().forEach(c=>{const l=n.get(c);if(l===null)return;let u=s.get(c)||Pn.empty();u=a.applyToLocalView(l,u),s.set(c,u);const h=(r.get(a.batchId)||ue()).add(c);r=r.insert(a.batchId,h)})}).next(()=>{const o=[],a=r.getReverseIterator();for(;a.hasNext();){const c=a.getNext(),l=c.key,u=c.value,h=xN();u.forEach(d=>{if(!i.has(d)){const f=AN(n.get(d),s.get(d));f!==null&&h.set(d,f),i=i.add(d)}}),o.push(this.documentOverlayCache.saveOverlays(e,l,h))}return v.waitFor(o)}).next(()=>s)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(s=>this.recalculateAndSaveOverlays(e,s))}getDocumentsMatchingQuery(e,n,s){return function(r){return U.isDocumentKey(r.path)&&r.collectionGroup===null&&r.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):Nv(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,s):this.getDocumentsMatchingCollectionQuery(e,n,s)}getNextDocuments(e,n,s,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,s,r).next(i=>{const o=r-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,s.largestBatchId,r-i.size):v.resolve(Cs());let a=-1,c=i;return o.next(l=>v.forEach(l,(u,h)=>(a<h.largestBatchId&&(a=h.largestBatchId),i.get(u)?v.resolve():this.getBaseDocument(e,u,h).next(d=>{c=c.insert(u,d)}))).next(()=>this.populateOverlays(e,l,i)).next(()=>this.computeViews(e,c,l,ue())).next(u=>({batchId:a,changes:DN(u)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new U(n)).next(s=>{let r=Lc();return s.isFoundDocument()&&(r=r.insert(s.key,s)),r})}getDocumentsMatchingCollectionGroupQuery(e,n,s){const r=n.collectionGroup;let i=Lc();return this.indexManager.getCollectionParents(e,r).next(o=>v.forEach(o,a=>{const c=function(l,u){return new mr(u,null,l.explicitOrderBy.slice(),l.filters.slice(),l.limit,l.limitType,l.startAt,l.endAt)}(n,a.child(r));return this.getDocumentsMatchingCollectionQuery(e,c,s).next(l=>{l.forEach((u,h)=>{i=i.insert(u,h)})})}).next(()=>i))}getDocumentsMatchingCollectionQuery(e,n,s){let r;return this.remoteDocumentCache.getAllFromCollection(e,n.path,s).next(i=>(r=i,this.documentOverlayCache.getOverlaysForCollection(e,n.path,s.largestBatchId))).next(i=>{i.forEach((a,c)=>{const l=c.getKey();r.get(l)===null&&(r=r.insert(l,Be.newInvalidDocument(l)))});let o=Lc();return r.forEach((a,c)=>{const l=i.get(a);l!==void 0&&sl(l.mutation,c,Pn.empty(),Qe.now()),Pv(n,c)&&(o=o.insert(a,c))}),o})}getBaseDocument(e,n,s){return s===null||s.mutation.type===1?this.remoteDocumentCache.getEntry(e,n):v.resolve(Be.newInvalidDocument(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u6{constructor(e){this.wt=e,this.Jn=new Map,this.Yn=new Map}getBundleMetadata(e,n){return v.resolve(this.Jn.get(n))}saveBundleMetadata(e,n){var s;return this.Jn.set(n.id,{id:(s=n).id,version:s.version,createTime:Rt(s.createTime)}),v.resolve()}getNamedQuery(e,n){return v.resolve(this.Yn.get(n))}saveNamedQuery(e,n){return this.Yn.set(n.name,function(s){return{name:s.name,query:Fv(s.bundledQuery),readTime:Rt(s.readTime)}}(n)),v.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h6{constructor(){this.overlays=new it(U.comparator),this.Xn=new Map}getOverlay(e,n){return v.resolve(this.overlays.get(n))}getOverlays(e,n){const s=Cs();return v.forEach(n,r=>this.getOverlay(e,r).next(i=>{i!==null&&s.set(r,i)})).next(()=>s)}saveOverlays(e,n,s){return s.forEach((r,i)=>{this.ie(e,n,i)}),v.resolve()}removeOverlaysForBatchId(e,n,s){const r=this.Xn.get(s);return r!==void 0&&(r.forEach(i=>this.overlays=this.overlays.remove(i)),this.Xn.delete(s)),v.resolve()}getOverlaysForCollection(e,n,s){const r=Cs(),i=n.length+1,o=new U(n.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const c=a.getNext().value,l=c.getKey();if(!n.isPrefixOf(l.path))break;l.path.length===i&&c.largestBatchId>s&&r.set(c.getKey(),c)}return v.resolve(r)}getOverlaysForCollectionGroup(e,n,s,r){let i=new it((l,u)=>l-u);const o=this.overlays.getIterator();for(;o.hasNext();){const l=o.getNext().value;if(l.getKey().getCollectionGroup()===n&&l.largestBatchId>s){let u=i.get(l.largestBatchId);u===null&&(u=Cs(),i=i.insert(l.largestBatchId,u)),u.set(l.getKey(),l)}}const a=Cs(),c=i.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((l,u)=>a.set(l,u)),!(a.size()>=r)););return v.resolve(a)}ie(e,n,s){const r=this.overlays.get(s.key);if(r!==null){const o=this.Xn.get(r.largestBatchId).delete(s.key);this.Xn.set(r.largestBatchId,o)}this.overlays=this.overlays.insert(s.key,new Lv(n,s));let i=this.Xn.get(n);i===void 0&&(i=ue(),this.Xn.set(n,i)),this.Xn.set(n,i.add(s.key))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $v{constructor(){this.Zn=new ke(It.ts),this.es=new ke(It.ns)}isEmpty(){return this.Zn.isEmpty()}addReference(e,n){const s=new It(e,n);this.Zn=this.Zn.add(s),this.es=this.es.add(s)}ss(e,n){e.forEach(s=>this.addReference(s,n))}removeReference(e,n){this.rs(new It(e,n))}os(e,n){e.forEach(s=>this.removeReference(s,n))}us(e){const n=new U(new we([])),s=new It(n,e),r=new It(n,e+1),i=[];return this.es.forEachInRange([s,r],o=>{this.rs(o),i.push(o.key)}),i}cs(){this.Zn.forEach(e=>this.rs(e))}rs(e){this.Zn=this.Zn.delete(e),this.es=this.es.delete(e)}hs(e){const n=new U(new we([])),s=new It(n,e),r=new It(n,e+1);let i=ue();return this.es.forEachInRange([s,r],o=>{i=i.add(o.key)}),i}containsKey(e){const n=new It(e,0),s=this.Zn.firstAfterOrEqual(n);return s!==null&&e.isEqual(s.key)}}class It{constructor(e,n){this.key=e,this.ls=n}static ts(e,n){return U.comparator(e.key,n.key)||ce(e.ls,n.ls)}static ns(e,n){return ce(e.ls,n.ls)||U.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d6{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.fs=1,this.ds=new ke(It.ts)}checkEmpty(e){return v.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,s,r){const i=this.fs;this.fs++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new Ov(i,n,s,r);this.mutationQueue.push(o);for(const a of r)this.ds=this.ds.add(new It(a.key,i)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return v.resolve(o)}lookupMutationBatch(e,n){return v.resolve(this._s(n))}getNextMutationBatchAfterBatchId(e,n){const s=n+1,r=this.ws(s),i=r<0?0:r;return v.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return v.resolve(this.mutationQueue.length===0?-1:this.fs-1)}getAllMutationBatches(e){return v.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const s=new It(n,0),r=new It(n,Number.POSITIVE_INFINITY),i=[];return this.ds.forEachInRange([s,r],o=>{const a=this._s(o.ls);i.push(a)}),v.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,n){let s=new ke(ce);return n.forEach(r=>{const i=new It(r,0),o=new It(r,Number.POSITIVE_INFINITY);this.ds.forEachInRange([i,o],a=>{s=s.add(a.ls)})}),v.resolve(this.gs(s))}getAllMutationBatchesAffectingQuery(e,n){const s=n.path,r=s.length+1;let i=s;U.isDocumentKey(i)||(i=i.child(""));const o=new It(new U(i),0);let a=new ke(ce);return this.ds.forEachWhile(c=>{const l=c.key.path;return!!s.isPrefixOf(l)&&(l.length===r&&(a=a.add(c.ls)),!0)},o),v.resolve(this.gs(a))}gs(e){const n=[];return e.forEach(s=>{const r=this._s(s);r!==null&&n.push(r)}),n}removeMutationBatch(e,n){ie(this.ys(n.batchId,"removed")===0),this.mutationQueue.shift();let s=this.ds;return v.forEach(n.mutations,r=>{const i=new It(r.key,n.batchId);return s=s.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)}).next(()=>{this.ds=s})}In(e){}containsKey(e,n){const s=new It(n,0),r=this.ds.firstAfterOrEqual(s);return v.resolve(n.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,v.resolve()}ys(e,n){return this.ws(e)}ws(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}_s(e){const n=this.ws(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class f6{constructor(e){this.ps=e,this.docs=new it(U.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const s=n.key,r=this.docs.get(s),i=r?r.size:0,o=this.ps(n);return this.docs=this.docs.insert(s,{document:n.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(e,s.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const s=this.docs.get(n);return v.resolve(s?s.document.mutableCopy():Be.newInvalidDocument(n))}getEntries(e,n){let s=wn();return n.forEach(r=>{const i=this.docs.get(r);s=s.insert(r,i?i.document.mutableCopy():Be.newInvalidDocument(r))}),v.resolve(s)}getAllFromCollection(e,n,s){let r=wn();const i=new U(n.child("")),o=this.docs.getIteratorFrom(i);for(;o.hasNext();){const{key:a,value:{document:c}}=o.getNext();if(!n.isPrefixOf(a.path))break;a.path.length>n.length+1||Sv(oN(c),s)<=0||(r=r.insert(c.key,c.mutableCopy()))}return v.resolve(r)}getAllFromCollectionGroup(e,n,s,r){G()}Is(e,n){return v.forEach(this.docs,s=>n(s))}newChangeBuffer(e){return new p6(this)}getSize(e){return v.resolve(this.size)}}class p6 extends tP{constructor(e){super(),this.zn=e}applyChanges(e){const n=[];return this.changes.forEach((s,r)=>{r.isValidDocument()?n.push(this.zn.addEntry(e,r)):this.zn.removeEntry(s)}),v.waitFor(n)}getFromCache(e,n){return this.zn.getEntry(e,n)}getAllFromCache(e,n){return this.zn.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g6{constructor(e){this.persistence=e,this.Ts=new pi(n=>fo(n),Fu),this.lastRemoteSnapshotVersion=re.min(),this.highestTargetId=0,this.Es=0,this.As=new $v,this.targetCount=0,this.Rs=yo.An()}forEachTarget(e,n){return this.Ts.forEach((s,r)=>n(r)),v.resolve()}getLastRemoteSnapshotVersion(e){return v.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return v.resolve(this.Es)}allocateTargetId(e){return this.highestTargetId=this.Rs.next(),v.resolve(this.highestTargetId)}setTargetsMetadata(e,n,s){return s&&(this.lastRemoteSnapshotVersion=s),n>this.Es&&(this.Es=n),v.resolve()}vn(e){this.Ts.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.Rs=new yo(n),this.highestTargetId=n),e.sequenceNumber>this.Es&&(this.Es=e.sequenceNumber)}addTargetData(e,n){return this.vn(n),this.targetCount+=1,v.resolve()}updateTargetData(e,n){return this.vn(n),v.resolve()}removeTargetData(e,n){return this.Ts.delete(n.target),this.As.us(n.targetId),this.targetCount-=1,v.resolve()}removeTargets(e,n,s){let r=0;const i=[];return this.Ts.forEach((o,a)=>{a.sequenceNumber<=n&&s.get(a.targetId)===null&&(this.Ts.delete(o),i.push(this.removeMatchingKeysForTargetId(e,a.targetId)),r++)}),v.waitFor(i).next(()=>r)}getTargetCount(e){return v.resolve(this.targetCount)}getTargetData(e,n){const s=this.Ts.get(n)||null;return v.resolve(s)}addMatchingKeys(e,n,s){return this.As.ss(n,s),v.resolve()}removeMatchingKeys(e,n,s){this.As.os(n,s);const r=this.persistence.referenceDelegate,i=[];return r&&n.forEach(o=>{i.push(r.markPotentiallyOrphaned(e,o))}),v.waitFor(i)}removeMatchingKeysForTargetId(e,n){return this.As.us(n),v.resolve()}getMatchingKeysForTargetId(e,n){const s=this.As.hs(n);return v.resolve(s)}containsKey(e,n){return v.resolve(this.As.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rP{constructor(e,n){this.bs={},this.overlays={},this.Ps=new vn(0),this.vs=!1,this.vs=!0,this.referenceDelegate=e(this),this.Vs=new g6(this),this.indexManager=new e6,this.remoteDocumentCache=function(s){return new f6(s)}(s=>this.referenceDelegate.Ss(s)),this.wt=new YN(n),this.Ds=new u6(this.wt)}start(){return Promise.resolve()}shutdown(){return this.vs=!1,Promise.resolve()}get started(){return this.vs}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new h6,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let s=this.bs[e.toKey()];return s||(s=new d6(n,this.referenceDelegate),this.bs[e.toKey()]=s),s}getTargetCache(){return this.Vs}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ds}runTransaction(e,n,s){P("MemoryPersistence","Starting transaction:",e);const r=new m6(this.Ps.next());return this.referenceDelegate.Cs(),s(r).next(i=>this.referenceDelegate.xs(r).next(()=>i)).toPromise().then(i=>(r.raiseOnCommittedEvent(),i))}Ns(e,n){return v.or(Object.values(this.bs).map(s=>()=>s.containsKey(e,n)))}}class m6 extends cN{constructor(e){super(),this.currentSequenceNumber=e}}class lp{constructor(e){this.persistence=e,this.ks=new $v,this.Os=null}static Ms(e){return new lp(e)}get Fs(){if(this.Os)return this.Os;throw G()}addReference(e,n,s){return this.ks.addReference(s,n),this.Fs.delete(s.toString()),v.resolve()}removeReference(e,n,s){return this.ks.removeReference(s,n),this.Fs.add(s.toString()),v.resolve()}markPotentiallyOrphaned(e,n){return this.Fs.add(n.toString()),v.resolve()}removeTarget(e,n){this.ks.us(n.targetId).forEach(r=>this.Fs.add(r.toString()));const s=this.persistence.getTargetCache();return s.getMatchingKeysForTargetId(e,n.targetId).next(r=>{r.forEach(i=>this.Fs.add(i.toString()))}).next(()=>s.removeTargetData(e,n))}Cs(){this.Os=new Set}xs(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return v.forEach(this.Fs,s=>{const r=U.fromPath(s);return this.$s(e,r).next(i=>{i||n.removeEntry(r,re.min())})}).next(()=>(this.Os=null,n.apply(e)))}updateLimboDocument(e,n){return this.$s(e,n).next(s=>{s?this.Fs.delete(n.toString()):this.Fs.add(n.toString())})}Ss(e){return 0}$s(e,n){return v.or([()=>v.resolve(this.ks.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Ns(e,n)])}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _6{constructor(e){this.wt=e}O(e,n,s,r){const i=new sp("createOrUpgrade",n);s<1&&r>=1&&(function(a){a.createObjectStore("owner")}(e),function(a){a.createObjectStore("mutationQueues",{keyPath:"userId"}),a.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",YE,{unique:!0}),a.createObjectStore("documentMutations")}(e),dT(e),function(a){a.createObjectStore("remoteDocuments")}(e));let o=v.resolve();return s<3&&r>=3&&(s!==0&&(function(a){a.deleteObjectStore("targetDocuments"),a.deleteObjectStore("targets"),a.deleteObjectStore("targetGlobal")}(e),dT(e)),o=o.next(()=>function(a){const c=a.store("targetGlobal"),l={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:re.min().toTimestamp(),targetCount:0};return c.put("targetGlobalKey",l)}(i))),s<4&&r>=4&&(s!==0&&(o=o.next(()=>function(a,c){return c.store("mutations").K().next(l=>{a.deleteObjectStore("mutations"),a.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",YE,{unique:!0});const u=c.store("mutations"),h=l.map(d=>u.put(d));return v.waitFor(h)})}(e,i))),o=o.next(()=>{(function(a){a.createObjectStore("clientMetadata",{keyPath:"clientId"})})(e)})),s<5&&r>=5&&(o=o.next(()=>this.Bs(i))),s<6&&r>=6&&(o=o.next(()=>(function(a){a.createObjectStore("remoteDocumentGlobal")}(e),this.Ls(i)))),s<7&&r>=7&&(o=o.next(()=>this.Us(i))),s<8&&r>=8&&(o=o.next(()=>this.qs(e,i))),s<9&&r>=9&&(o=o.next(()=>{(function(a){a.objectStoreNames.contains("remoteDocumentChanges")&&a.deleteObjectStore("remoteDocumentChanges")})(e)})),s<10&&r>=10&&(o=o.next(()=>this.Ks(i))),s<11&&r>=11&&(o=o.next(()=>{(function(a){a.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(a){a.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),s<12&&r>=12&&(o=o.next(()=>{(function(a){const c=a.createObjectStore("documentOverlays",{keyPath:q4});c.createIndex("collectionPathOverlayIndex",j4,{unique:!1}),c.createIndex("collectionGroupOverlayIndex",K4,{unique:!1})})(e)})),s<13&&r>=13&&(o=o.next(()=>function(a){const c=a.createObjectStore("remoteDocumentsV14",{keyPath:P4});c.createIndex("documentKeyIndex",D4),c.createIndex("collectionGroupIndex",x4)}(e)).next(()=>this.Gs(e,i)).next(()=>e.deleteObjectStore("remoteDocuments"))),s<14&&r>=14&&(o=o.next(()=>this.Qs(e,i))),s<15&&r>=15&&(o=o.next(()=>function(a){a.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),a.createObjectStore("indexState",{keyPath:U4}).createIndex("sequenceNumberIndex",$4,{unique:!1}),a.createObjectStore("indexEntries",{keyPath:V4}).createIndex("documentKeyIndex",B4,{unique:!1})}(e))),o}Ls(e){let n=0;return e.store("remoteDocuments").J((s,r)=>{n+=Nd(r)}).next(()=>{const s={byteSize:n};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",s)})}Bs(e){const n=e.store("mutationQueues"),s=e.store("mutations");return n.K().next(r=>v.forEach(r,i=>{const o=IDBKeyRange.bound([i.userId,-1],[i.userId,i.lastAcknowledgedBatchId]);return s.K("userMutationsIndex",o).next(a=>v.forEach(a,c=>{ie(c.userId===i.userId);const l=Pi(this.wt,c);return XN(e,i.userId,l).next(()=>{})}))}))}Us(e){const n=e.store("targetDocuments"),s=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(r=>{const i=[];return s.J((o,a)=>{const c=new we(o),l=function(u){return[0,dn(u)]}(c);i.push(n.get(l).next(u=>u?v.resolve():(h=>n.put({targetId:0,path:dn(h),sequenceNumber:r.highestListenSequenceNumber}))(c)))}).next(()=>v.waitFor(i))})}qs(e,n){e.createObjectStore("collectionParents",{keyPath:F4});const s=n.store("collectionParents"),r=new Uv,i=o=>{if(r.add(o)){const a=o.lastSegment(),c=o.popLast();return s.put({collectionId:a,parent:dn(c)})}};return n.store("remoteDocuments").J({H:!0},(o,a)=>{const c=new we(o);return i(c.popLast())}).next(()=>n.store("documentMutations").J({H:!0},([o,a,c],l)=>{const u=As(a);return i(u.popLast())}))}Ks(e){const n=e.store("targets");return n.J((s,r)=>{const i=Fc(r),o=JN(this.wt,i);return n.put(o)})}Gs(e,n){const s=n.store("remoteDocuments"),r=[];return s.J((i,o)=>{const a=n.store("remoteDocumentsV14"),c=(l=o,l.document?new U(we.fromString(l.document.name).popFirst(5)):l.noDocument?U.fromSegments(l.noDocument.path):l.unknownDocument?U.fromSegments(l.unknownDocument.path):G()).path.toArray();var l;/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const u={prefixPath:c.slice(0,c.length-2),collectionGroup:c[c.length-2],documentId:c[c.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};r.push(a.put(u))}).next(()=>v.waitFor(r))}Qs(e,n){const s=n.store("mutations"),r=nP(this.wt),i=new rP(lp.Ms,this.wt.ne);return s.K().next(o=>{const a=new Map;return o.forEach(c=>{var l;let u=(l=a.get(c.userId))!==null&&l!==void 0?l:ue();Pi(this.wt,c).keys().forEach(h=>u=u.add(h)),a.set(c.userId,u)}),v.forEach(a,(c,l)=>{const u=new St(l),h=ap.se(this.wt,u),d=i.getIndexManager(u),f=cp.se(u,this.wt,d,i.referenceDelegate);return new sP(r,f,h,d).recalculateAndSaveOverlaysForDocumentKeys(new Ym(n,vn.ot),c).next()})})}}function dT(t){t.createObjectStore("targetDocuments",{keyPath:M4}).createIndex("documentTargetsIndex",L4,{unique:!0}),t.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",O4,{unique:!0}),t.createObjectStore("targetGlobal")}const fg="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class Vv{constructor(e,n,s,r,i,o,a,c,l,u,h=14){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=s,this.js=i,this.window=o,this.document=a,this.Ws=l,this.zs=u,this.Hs=h,this.Ps=null,this.vs=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Js=null,this.inForeground=!1,this.Ys=null,this.Xs=null,this.Zs=Number.NEGATIVE_INFINITY,this.ti=d=>Promise.resolve(),!Vv.V())throw new k(w.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new o6(this,r),this.ei=n+"main",this.wt=new YN(c),this.ni=new os(this.ei,this.Hs,new _6(this.wt)),this.Vs=new n6(this.referenceDelegate,this.wt),this.remoteDocumentCache=nP(this.wt),this.Ds=new z4,this.window&&this.window.localStorage?this.si=this.window.localStorage:(this.si=null,u===!1&&ft("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.ii().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new k(w.FAILED_PRECONDITION,fg);return this.ri(),this.oi(),this.ui(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Vs.getHighestSequenceNumber(e))}).then(e=>{this.Ps=new vn(e,this.Ws)}).then(()=>{this.vs=!0}).catch(e=>(this.ni&&this.ni.close(),Promise.reject(e)))}ci(e){return this.ti=async n=>{if(this.started)return e(n)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.ni.F(async n=>{n.newVersion===null&&await e()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.js.enqueueAndForget(async()=>{this.started&&await this.ii()}))}ii(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>fh(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.ai(e).next(n=>{n||(this.isPrimary=!1,this.js.enqueueRetryable(()=>this.ti(!1)))})}).next(()=>this.hi(e)).next(n=>this.isPrimary&&!n?this.li(e).next(()=>!1):!!n&&this.fi(e).next(()=>!0))).catch(e=>{if(fi(e))return P("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return P("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.js.enqueueRetryable(()=>this.ti(e)),this.isPrimary=e})}ai(e){return kc(e).get("owner").next(n=>v.resolve(this.di(n)))}_i(e){return fh(e).delete(this.clientId)}async wi(){if(this.isPrimary&&!this.mi(this.Zs,18e5)){this.Zs=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",n=>{const s=Lt(n,"clientMetadata");return s.K().next(r=>{const i=this.gi(r,18e5),o=r.filter(a=>i.indexOf(a)===-1);return v.forEach(o,a=>s.delete(a.clientId)).next(()=>o)})}).catch(()=>[]);if(this.si)for(const n of e)this.si.removeItem(this.yi(n.clientId))}}ui(){this.Xs=this.js.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.ii().then(()=>this.wi()).then(()=>this.ui()))}di(e){return!!e&&e.ownerId===this.clientId}hi(e){return this.zs?v.resolve(!0):kc(e).get("owner").next(n=>{if(n!==null&&this.mi(n.leaseTimestampMs,5e3)&&!this.pi(n.ownerId)){if(this.di(n)&&this.networkEnabled)return!0;if(!this.di(n)){if(!n.allowTabSynchronization)throw new k(w.FAILED_PRECONDITION,fg);return!1}}return!(!this.networkEnabled||!this.inForeground)||fh(e).K().next(s=>this.gi(s,5e3).find(r=>{if(this.clientId!==r.clientId){const i=!this.networkEnabled&&r.networkEnabled,o=!this.inForeground&&r.inForeground,a=this.networkEnabled===r.networkEnabled;if(i||o&&a)return!0}return!1})===void 0)}).next(n=>(this.isPrimary!==n&&P("IndexedDbPersistence",`Client ${n?"is":"is not"} eligible for a primary lease.`),n))}async shutdown(){this.vs=!1,this.Ii(),this.Xs&&(this.Xs.cancel(),this.Xs=null),this.Ti(),this.Ei(),await this.ni.runTransaction("shutdown","readwrite",["owner","clientMetadata"],e=>{const n=new Ym(e,vn.ot);return this.li(n).next(()=>this._i(n))}),this.ni.close(),this.Ai()}gi(e,n){return e.filter(s=>this.mi(s.updateTimeMs,n)&&!this.pi(s.clientId))}Ri(){return this.runTransaction("getActiveClients","readonly",e=>fh(e).K().next(n=>this.gi(n,18e5).map(s=>s.clientId)))}get started(){return this.vs}getMutationQueue(e,n){return cp.se(e,this.wt,n,this.referenceDelegate)}getTargetCache(){return this.Vs}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new t6(e,this.wt.ne.databaseId)}getDocumentOverlayCache(e){return ap.se(this.wt,e)}getBundleCache(){return this.Ds}runTransaction(e,n,s){P("IndexedDbPersistence","Starting transaction:",e);const r=n==="readonly"?"readonly":"readwrite",i=(o=this.Hs)===15?W4:o===14?QN:o===13?zN:o===12?H4:o===11?GN:void G();var o;let a;return this.ni.runTransaction(e,r,i,c=>(a=new Ym(c,this.Ps?this.Ps.next():vn.ot),n==="readwrite-primary"?this.ai(a).next(l=>!!l||this.hi(a)).next(l=>{if(!l)throw ft(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.js.enqueueRetryable(()=>this.ti(!1)),new k(w.FAILED_PRECONDITION,aN);return s(a)}).next(l=>this.fi(a).next(()=>l)):this.bi(a).next(()=>s(a)))).then(c=>(a.raiseOnCommittedEvent(),c))}bi(e){return kc(e).get("owner").next(n=>{if(n!==null&&this.mi(n.leaseTimestampMs,5e3)&&!this.pi(n.ownerId)&&!this.di(n)&&!(this.zs||this.allowTabSynchronization&&n.allowTabSynchronization))throw new k(w.FAILED_PRECONDITION,fg)})}fi(e){const n={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return kc(e).put("owner",n)}static V(){return os.V()}li(e){const n=kc(e);return n.get("owner").next(s=>this.di(s)?(P("IndexedDbPersistence","Releasing primary lease."),n.delete("owner")):v.resolve())}mi(e,n){const s=Date.now();return!(e<s-n)&&(!(e>s)||(ft(`Detected an update time that is in the future: ${e} > ${s}`),!1))}ri(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Ys=()=>{this.js.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.ii()))},this.document.addEventListener("visibilitychange",this.Ys),this.inForeground=this.document.visibilityState==="visible")}Ti(){this.Ys&&(this.document.removeEventListener("visibilitychange",this.Ys),this.Ys=null)}oi(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.Js=()=>{this.Ii(),OL()&&navigator.appVersion.match(/Version\/1[45]/)&&this.js.enterRestrictedMode(!0),this.js.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Js))}Ei(){this.Js&&(this.window.removeEventListener("pagehide",this.Js),this.Js=null)}pi(e){var n;try{const s=((n=this.si)===null||n===void 0?void 0:n.getItem(this.yi(e)))!==null;return P("IndexedDbPersistence",`Client '${e}' ${s?"is":"is not"} zombied in LocalStorage`),s}catch(s){return ft("IndexedDbPersistence","Failed to get zombied client id.",s),!1}}Ii(){if(this.si)try{this.si.setItem(this.yi(this.clientId),String(Date.now()))}catch(e){ft("Failed to set zombie client id.",e)}}Ai(){if(this.si)try{this.si.removeItem(this.yi(this.clientId))}catch{}}yi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function kc(t){return Lt(t,"owner")}function fh(t){return Lt(t,"clientMetadata")}function Bv(t,e){let n=t.projectId;return t.isDefaultDatabase||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qv{constructor(e,n,s,r){this.targetId=e,this.fromCache=n,this.Pi=s,this.vi=r}static Vi(e,n){let s=ue(),r=ue();for(const i of n.docChanges)switch(i.type){case 0:s=s.add(i.doc.key);break;case 1:r=r.add(i.doc.key)}return new qv(e,n.fromCache,s,r)}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iP{constructor(){this.Si=!1}initialize(e,n){this.Di=e,this.indexManager=n,this.Si=!0}getDocumentsMatchingQuery(e,n,s,r){return this.Ci(e,n).next(i=>i||this.xi(e,n,r,s)).next(i=>i||this.Ni(e,n))}Ci(e,n){return v.resolve(null)}xi(e,n,s,r){return n4(n)||r.isEqual(re.min())?this.Ni(e,n):this.Di.getDocuments(e,s).next(i=>{const o=this.ki(n,i);return this.Oi(n,o,s,r)?this.Ni(e,n):(jm()<=fe.DEBUG&&P("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),Gm(n)),this.Mi(e,o,n,iN(r,-1)))})}ki(e,n){let s=new ke(vN(e));return n.forEach((r,i)=>{Pv(e,i)&&(s=s.add(i))}),s}Oi(e,n,s,r){if(e.limit===null)return!1;if(s.size!==n.size)return!0;const i=e.limitType==="F"?n.last():n.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)}Ni(e,n){return jm()<=fe.DEBUG&&P("QueryEngine","Using full collection scan to execute query:",Gm(n)),this.Di.getDocumentsMatchingQuery(e,n,Mn.min())}Mi(e,n,s,r){return this.Di.getDocumentsMatchingQuery(e,s,r).next(i=>(n.forEach(o=>{i=i.insert(o.key,o)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y6{constructor(e,n,s,r){this.persistence=e,this.Fi=n,this.wt=r,this.$i=new it(ce),this.Bi=new pi(i=>fo(i),Fu),this.Li=new Map,this.Ui=e.getRemoteDocumentCache(),this.Vs=e.getTargetCache(),this.Ds=e.getBundleCache(),this.qi(s)}qi(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new sP(this.Ui,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ui.setIndexManager(this.indexManager),this.Fi.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.$i))}}function oP(t,e,n,s){return new y6(t,e,n,s)}async function aP(t,e){const n=q(t);return await n.persistence.runTransaction("Handle user change","readonly",s=>{let r;return n.mutationQueue.getAllMutationBatches(s).next(i=>(r=i,n.qi(e),n.mutationQueue.getAllMutationBatches(s))).next(i=>{const o=[],a=[];let c=ue();for(const l of r){o.push(l.batchId);for(const u of l.mutations)c=c.add(u.key)}for(const l of i){a.push(l.batchId);for(const u of l.mutations)c=c.add(u.key)}return n.localDocuments.getDocuments(s,c).next(l=>({Ki:l,removedBatchIds:o,addedBatchIds:a}))})})}function v6(t,e){const n=q(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",s=>{const r=e.batch.keys(),i=n.Ui.newChangeBuffer({trackRemovals:!0});return function(o,a,c,l){const u=c.batch,h=u.keys();let d=v.resolve();return h.forEach(f=>{d=d.next(()=>l.getEntry(a,f)).next(p=>{const _=c.docVersions.get(f);ie(_!==null),p.version.compareTo(_)<0&&(u.applyToRemoteDocument(p,c),p.isValidDocument()&&(p.setReadTime(c.commitVersion),l.addEntry(p)))})}),d.next(()=>o.mutationQueue.removeMutationBatch(a,u))}(n,s,e,i).next(()=>i.apply(s)).next(()=>n.mutationQueue.performConsistencyCheck(s)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(s,r,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(s,function(o){let a=ue();for(let c=0;c<o.mutationResults.length;++c)o.mutationResults[c].transformResults.length>0&&(a=a.add(o.batch.mutations[c].key));return a}(e))).next(()=>n.localDocuments.getDocuments(s,r))})}function cP(t){const e=q(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Vs.getLastRemoteSnapshotVersion(n))}function w6(t,e){const n=q(t),s=e.snapshotVersion;let r=n.$i;return n.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const o=n.Ui.newChangeBuffer({trackRemovals:!0});r=n.$i;const a=[];e.targetChanges.forEach((u,h)=>{const d=r.get(h);if(!d)return;a.push(n.Vs.removeMatchingKeys(i,u.removedDocuments,h).next(()=>n.Vs.addMatchingKeys(i,u.addedDocuments,h)));let f=d.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.has(h)?f=f.withResumeToken(vt.EMPTY_BYTE_STRING,re.min()).withLastLimboFreeSnapshotVersion(re.min()):u.resumeToken.approximateByteSize()>0&&(f=f.withResumeToken(u.resumeToken,s)),r=r.insert(h,f),function(p,_,y){return p.resumeToken.approximateByteSize()===0||_.snapshotVersion.toMicroseconds()-p.snapshotVersion.toMicroseconds()>=3e8?!0:y.addedDocuments.size+y.modifiedDocuments.size+y.removedDocuments.size>0}(d,f,u)&&a.push(n.Vs.updateTargetData(i,f))});let c=wn(),l=ue();if(e.documentUpdates.forEach(u=>{e.resolvedLimboDocuments.has(u)&&a.push(n.persistence.referenceDelegate.updateLimboDocument(i,u))}),a.push(lP(i,o,e.documentUpdates).next(u=>{c=u.Gi,l=u.Qi})),!s.isEqual(re.min())){const u=n.Vs.getLastRemoteSnapshotVersion(i).next(h=>n.Vs.setTargetsMetadata(i,i.currentSequenceNumber,s));a.push(u)}return v.waitFor(a).next(()=>o.apply(i)).next(()=>n.localDocuments.getLocalViewOfDocuments(i,c,l)).next(()=>c)}).then(i=>(n.$i=r,i))}function lP(t,e,n){let s=ue(),r=ue();return n.forEach(i=>s=s.add(i)),e.getEntries(t,s).next(i=>{let o=wn();return n.forEach((a,c)=>{const l=i.get(a);c.isFoundDocument()!==l.isFoundDocument()&&(r=r.add(a)),c.isNoDocument()&&c.version.isEqual(re.min())?(e.removeEntry(a,c.readTime),o=o.insert(a,c)):!l.isValidDocument()||c.version.compareTo(l.version)>0||c.version.compareTo(l.version)===0&&l.hasPendingWrites?(e.addEntry(c),o=o.insert(a,c)):P("LocalStore","Ignoring outdated watch update for ",a,". Current version:",l.version," Watch version:",c.version)}),{Gi:o,Qi:r}})}function b6(t,e){const n=q(t);return n.persistence.runTransaction("Get next mutation batch","readonly",s=>(e===void 0&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(s,e)))}function Ma(t,e){const n=q(t);return n.persistence.runTransaction("Allocate target","readwrite",s=>{let r;return n.Vs.getTargetData(s,e).next(i=>i?(r=i,v.resolve(r)):n.Vs.allocateTargetId(s).next(o=>(r=new Hr(e,o,0,s.currentSequenceNumber),n.Vs.addTargetData(s,r).next(()=>r))))}).then(s=>{const r=n.$i.get(s.targetId);return(r===null||s.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.$i=n.$i.insert(s.targetId,s),n.Bi.set(e,s.targetId)),s})}async function La(t,e,n){const s=q(t),r=s.$i.get(e),i=n?"readwrite":"readwrite-primary";try{n||await s.persistence.runTransaction("Release target",i,o=>s.persistence.referenceDelegate.removeTarget(o,r))}catch(o){if(!fi(o))throw o;P("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}s.$i=s.$i.remove(e),s.Bi.delete(r.target)}function Pd(t,e,n){const s=q(t);let r=re.min(),i=ue();return s.persistence.runTransaction("Execute query","readonly",o=>function(a,c,l){const u=q(a),h=u.Bi.get(l);return h!==void 0?v.resolve(u.$i.get(h)):u.Vs.getTargetData(c,l)}(s,o,Qn(e)).next(a=>{if(a)return r=a.lastLimboFreeSnapshotVersion,s.Vs.getMatchingKeysForTargetId(o,a.targetId).next(c=>{i=c})}).next(()=>s.Fi.getDocumentsMatchingQuery(o,e,n?r:re.min(),n?i:ue())).next(a=>(dP(s,yN(e),a),{documents:a,ji:i})))}function uP(t,e){const n=q(t),s=q(n.Vs),r=n.$i.get(e);return r?Promise.resolve(r.target):n.persistence.runTransaction("Get target data","readonly",i=>s.te(i,e).next(o=>o?o.target:null))}function hP(t,e){const n=q(t),s=n.Li.get(e)||re.min();return n.persistence.runTransaction("Get new document changes","readonly",r=>n.Ui.getAllFromCollectionGroup(r,e,iN(s,-1),Number.MAX_SAFE_INTEGER)).then(r=>(dP(n,e,r),r))}function dP(t,e,n){let s=re.min();n.forEach((r,i)=>{i.readTime.compareTo(s)>0&&(s=i.readTime)}),t.Li.set(e,s)}async function I6(t,e,n,s){const r=q(t);let i=ue(),o=wn();for(const l of n){const u=e.Wi(l.metadata.name);l.document&&(i=i.add(u));const h=e.zi(l);h.setReadTime(e.Hi(l.metadata.readTime)),o=o.insert(u,h)}const a=r.Ui.newChangeBuffer({trackRemovals:!0}),c=await Ma(r,function(l){return Qn(rc(we.fromString(`__bundle__/docs/${l}`)))}(s));return r.persistence.runTransaction("Apply bundle documents","readwrite",l=>lP(l,a,o).next(u=>(a.apply(l),u)).next(u=>r.Vs.removeMatchingKeysForTargetId(l,c.targetId).next(()=>r.Vs.addMatchingKeys(l,i,c.targetId)).next(()=>r.localDocuments.getLocalViewOfDocuments(l,u.Gi,u.Qi)).next(()=>u.Gi)))}async function E6(t,e,n=ue()){const s=await Ma(t,Qn(Fv(e.bundledQuery))),r=q(t);return r.persistence.runTransaction("Save named query","readwrite",i=>{const o=Rt(e.readTime);if(s.snapshotVersion.compareTo(o)>=0)return r.Ds.saveNamedQuery(i,e);const a=s.withResumeToken(vt.EMPTY_BYTE_STRING,o);return r.$i=r.$i.insert(a.targetId,a),r.Vs.updateTargetData(i,a).next(()=>r.Vs.removeMatchingKeysForTargetId(i,s.targetId)).next(()=>r.Vs.addMatchingKeys(i,n,s.targetId)).next(()=>r.Ds.saveNamedQuery(i,e))})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fT(t,e){return`firestore_clients_${t}_${e}`}function pT(t,e,n){let s=`firestore_mutations_${t}_${n}`;return e.isAuthenticated()&&(s+=`_${e.uid}`),s}function pg(t,e){return`firestore_targets_${t}_${e}`}class Dd{constructor(e,n,s,r){this.user=e,this.batchId=n,this.state=s,this.error=r}static Ji(e,n,s){const r=JSON.parse(s);let i,o=typeof r=="object"&&["pending","acknowledged","rejected"].indexOf(r.state)!==-1&&(r.error===void 0||typeof r.error=="object");return o&&r.error&&(o=typeof r.error.message=="string"&&typeof r.error.code=="string",o&&(i=new k(r.error.code,r.error.message))),o?new Dd(e,n,r.state,i):(ft("SharedClientState",`Failed to parse mutation state for ID '${n}': ${s}`),null)}Yi(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class il{constructor(e,n,s){this.targetId=e,this.state=n,this.error=s}static Ji(e,n){const s=JSON.parse(n);let r,i=typeof s=="object"&&["not-current","current","rejected"].indexOf(s.state)!==-1&&(s.error===void 0||typeof s.error=="object");return i&&s.error&&(i=typeof s.error.message=="string"&&typeof s.error.code=="string",i&&(r=new k(s.error.code,s.error.message))),i?new il(e,s.state,r):(ft("SharedClientState",`Failed to parse target state for ID '${e}': ${n}`),null)}Yi(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class xd{constructor(e,n){this.clientId=e,this.activeTargetIds=n}static Ji(e,n){const s=JSON.parse(n);let r=typeof s=="object"&&s.activeTargetIds instanceof Array,i=op();for(let o=0;r&&o<s.activeTargetIds.length;++o)r=hN(s.activeTargetIds[o]),i=i.add(s.activeTargetIds[o]);return r?new xd(e,i):(ft("SharedClientState",`Failed to parse client data for instance '${e}': ${n}`),null)}}class jv{constructor(e,n){this.clientId=e,this.onlineState=n}static Ji(e){const n=JSON.parse(e);return typeof n=="object"&&["Unknown","Online","Offline"].indexOf(n.onlineState)!==-1&&typeof n.clientId=="string"?new jv(n.clientId,n.onlineState):(ft("SharedClientState",`Failed to parse online state: ${e}`),null)}}class Jm{constructor(){this.activeTargetIds=op()}Xi(e){this.activeTargetIds=this.activeTargetIds.add(e)}Zi(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Yi(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class gg{constructor(e,n,s,r,i){this.window=e,this.js=n,this.persistenceKey=s,this.tr=r,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.er=this.nr.bind(this),this.sr=new it(ce),this.started=!1,this.ir=[];const o=s.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.rr=fT(this.persistenceKey,this.tr),this.ur=function(a){return`firestore_sequence_number_${a}`}(this.persistenceKey),this.sr=this.sr.insert(this.tr,new Jm),this.cr=new RegExp(`^firestore_clients_${o}_([^_]*)$`),this.ar=new RegExp(`^firestore_mutations_${o}_(\\d+)(?:_(.*))?$`),this.hr=new RegExp(`^firestore_targets_${o}_(\\d+)$`),this.lr=function(a){return`firestore_online_state_${a}`}(this.persistenceKey),this.dr=function(a){return`firestore_bundle_loaded_v2_${a}`}(this.persistenceKey),this.window.addEventListener("storage",this.er)}static V(e){return!(!e||!e.localStorage)}async start(){const e=await this.syncEngine.Ri();for(const s of e){if(s===this.tr)continue;const r=this.getItem(fT(this.persistenceKey,s));if(r){const i=xd.Ji(s,r);i&&(this.sr=this.sr.insert(i.clientId,i))}}this._r();const n=this.storage.getItem(this.lr);if(n){const s=this.wr(n);s&&this.mr(s)}for(const s of this.ir)this.nr(s);this.ir=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0}writeSequenceNumber(e){this.setItem(this.ur,JSON.stringify(e))}getAllActiveQueryTargets(){return this.gr(this.sr)}isActiveQueryTarget(e){let n=!1;return this.sr.forEach((s,r)=>{r.activeTargetIds.has(e)&&(n=!0)}),n}addPendingMutation(e){this.yr(e,"pending")}updateMutationState(e,n,s){this.yr(e,n,s),this.pr(e)}addLocalQueryTarget(e){let n="not-current";if(this.isActiveQueryTarget(e)){const s=this.storage.getItem(pg(this.persistenceKey,e));if(s){const r=il.Ji(e,s);r&&(n=r.state)}}return this.Ir.Xi(e),this._r(),n}removeLocalQueryTarget(e){this.Ir.Zi(e),this._r()}isLocalQueryTarget(e){return this.Ir.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(pg(this.persistenceKey,e))}updateQueryState(e,n,s){this.Tr(e,n,s)}handleUserChange(e,n,s){n.forEach(r=>{this.pr(r)}),this.currentUser=e,s.forEach(r=>{this.addPendingMutation(r)})}setOnlineState(e){this.Er(e)}notifyBundleLoaded(e){this.Ar(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.er),this.removeItem(this.rr),this.started=!1)}getItem(e){const n=this.storage.getItem(e);return P("SharedClientState","READ",e,n),n}setItem(e,n){P("SharedClientState","SET",e,n),this.storage.setItem(e,n)}removeItem(e){P("SharedClientState","REMOVE",e),this.storage.removeItem(e)}nr(e){const n=e;if(n.storageArea===this.storage){if(P("SharedClientState","EVENT",n.key,n.newValue),n.key===this.rr)return void ft("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.js.enqueueRetryable(async()=>{if(this.started){if(n.key!==null){if(this.cr.test(n.key)){if(n.newValue==null){const s=this.Rr(n.key);return this.br(s,null)}{const s=this.Pr(n.key,n.newValue);if(s)return this.br(s.clientId,s)}}else if(this.ar.test(n.key)){if(n.newValue!==null){const s=this.vr(n.key,n.newValue);if(s)return this.Vr(s)}}else if(this.hr.test(n.key)){if(n.newValue!==null){const s=this.Sr(n.key,n.newValue);if(s)return this.Dr(s)}}else if(n.key===this.lr){if(n.newValue!==null){const s=this.wr(n.newValue);if(s)return this.mr(s)}}else if(n.key===this.ur){const s=function(r){let i=vn.ot;if(r!=null)try{const o=JSON.parse(r);ie(typeof o=="number"),i=o}catch(o){ft("SharedClientState","Failed to read sequence number from WebStorage",o)}return i}(n.newValue);s!==vn.ot&&this.sequenceNumberHandler(s)}else if(n.key===this.dr){const s=this.Cr(n.newValue);await Promise.all(s.map(r=>this.syncEngine.Nr(r)))}}}else this.ir.push(n)})}}get Ir(){return this.sr.get(this.tr)}_r(){this.setItem(this.rr,this.Ir.Yi())}yr(e,n,s){const r=new Dd(this.currentUser,e,n,s),i=pT(this.persistenceKey,this.currentUser,e);this.setItem(i,r.Yi())}pr(e){const n=pT(this.persistenceKey,this.currentUser,e);this.removeItem(n)}Er(e){const n={clientId:this.tr,onlineState:e};this.storage.setItem(this.lr,JSON.stringify(n))}Tr(e,n,s){const r=pg(this.persistenceKey,e),i=new il(e,n,s);this.setItem(r,i.Yi())}Ar(e){const n=JSON.stringify(Array.from(e));this.setItem(this.dr,n)}Rr(e){const n=this.cr.exec(e);return n?n[1]:null}Pr(e,n){const s=this.Rr(e);return xd.Ji(s,n)}vr(e,n){const s=this.ar.exec(e),r=Number(s[1]),i=s[2]!==void 0?s[2]:null;return Dd.Ji(new St(i),r,n)}Sr(e,n){const s=this.hr.exec(e),r=Number(s[1]);return il.Ji(r,n)}wr(e){return jv.Ji(e)}Cr(e){return JSON.parse(e)}async Vr(e){if(e.user.uid===this.currentUser.uid)return this.syncEngine.kr(e.batchId,e.state,e.error);P("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)}Dr(e){return this.syncEngine.Or(e.targetId,e.state,e.error)}br(e,n){const s=n?this.sr.insert(e,n):this.sr.remove(e),r=this.gr(this.sr),i=this.gr(s),o=[],a=[];return i.forEach(c=>{r.has(c)||o.push(c)}),r.forEach(c=>{i.has(c)||a.push(c)}),this.syncEngine.Mr(o,a).then(()=>{this.sr=s})}mr(e){this.sr.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}gr(e){let n=op();return e.forEach((s,r)=>{n=n.unionWith(r.activeTargetIds)}),n}}class fP{constructor(){this.Fr=new Jm,this.$r={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,s){}addLocalQueryTarget(e){return this.Fr.Xi(e),this.$r[e]||"not-current"}updateQueryState(e,n,s){this.$r[e]=n}removeLocalQueryTarget(e){this.Fr.Zi(e)}isLocalQueryTarget(e){return this.Fr.activeTargetIds.has(e)}clearQueryState(e){delete this.$r[e]}getAllActiveQueryTargets(){return this.Fr.activeTargetIds}isActiveQueryTarget(e){return this.Fr.activeTargetIds.has(e)}start(){return this.Fr=new Jm,Promise.resolve()}handleUserChange(e,n,s){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T6{Br(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gT{constructor(){this.Lr=()=>this.Ur(),this.qr=()=>this.Kr(),this.Gr=[],this.Qr()}Br(e){this.Gr.push(e)}shutdown(){window.removeEventListener("online",this.Lr),window.removeEventListener("offline",this.qr)}Qr(){window.addEventListener("online",this.Lr),window.addEventListener("offline",this.qr)}Ur(){P("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.Gr)e(0)}Kr(){P("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.Gr)e(1)}static V(){return typeof window!="undefined"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const S6={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C6{constructor(e){this.jr=e.jr,this.Wr=e.Wr}zr(e){this.Hr=e}Jr(e){this.Yr=e}onMessage(e){this.Xr=e}close(){this.Wr()}send(e){this.jr(e)}Zr(){this.Hr()}eo(e){this.Yr(e)}no(e){this.Xr(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A6 extends class{constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const n=e.ssl?"https":"http";this.so=n+"://"+e.host,this.io="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}ro(e,n,s,r,i){const o=this.oo(e,n);P("RestConnection","Sending: ",o,s);const a={};return this.uo(a,r,i),this.co(e,o,a,s).then(c=>(P("RestConnection","Received: ",c),c),c=>{throw Wl("RestConnection",`${e} failed with error: `,c,"url: ",o,"request:",s),c})}ao(e,n,s,r,i,o){return this.ro(e,n,s,r,i)}uo(e,n,s){e["X-Goog-Api-Client"]="gl-js/ fire/"+sc,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((r,i)=>e[i]=r),s&&s.headers.forEach((r,i)=>e[i]=r)}oo(e,n){const s=S6[e];return`${this.so}/v1/${n}:${s}`}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams}co(e,n,s,r){return new Promise((i,o)=>{const a=new T2;a.listenOnce(b2.COMPLETE,()=>{try{switch(a.getLastErrorCode()){case hg.NO_ERROR:const l=a.getResponseJson();P("Connection","XHR received:",JSON.stringify(l)),i(l);break;case hg.TIMEOUT:P("Connection",'RPC "'+e+'" timed out'),o(new k(w.DEADLINE_EXCEEDED,"Request time out"));break;case hg.HTTP_ERROR:const u=a.getStatus();if(P("Connection",'RPC "'+e+'" failed with status:',u,"response text:",a.getResponseText()),u>0){const h=a.getResponseJson().error;if(h&&h.status&&h.message){const d=function(f){const p=f.toLowerCase().replace(/_/g,"-");return Object.values(w).indexOf(p)>=0?p:w.UNKNOWN}(h.status);o(new k(d,h.message))}else o(new k(w.UNKNOWN,"Server responded with status "+a.getStatus()))}else o(new k(w.UNAVAILABLE,"Connection failed."));break;default:G()}}finally{P("Connection",'RPC "'+e+'" completed.')}});const c=JSON.stringify(r);a.send(n,"POST",c,s,15)})}ho(e,n,s){const r=[this.so,"/","google.firestore.v1.Firestore","/",e,"/channel"],i=v2(),o=w2(),a={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.useFetchStreams&&(a.xmlHttpFactory=new E2({})),this.uo(a.initMessageHeaders,n,s),of()||hu()||DL()||V_()||xL()||uu()||(a.httpHeadersOverwriteParam="$httpHeaders");const c=r.join("");P("Connection","Creating WebChannel: "+c,a);const l=i.createWebChannel(c,a);let u=!1,h=!1;const d=new C6({jr:p=>{h?P("Connection","Not sending because WebChannel is closed:",p):(u||(P("Connection","Opening WebChannel transport."),l.open(),u=!0),P("Connection","WebChannel sending:",p),l.send(p))},Wr:()=>l.close()}),f=(p,_,y)=>{p.listen(_,T=>{try{y(T)}catch(I){setTimeout(()=>{throw I},0)}})};return f(l,ch.EventType.OPEN,()=>{h||P("Connection","WebChannel transport opened.")}),f(l,ch.EventType.CLOSE,()=>{h||(h=!0,P("Connection","WebChannel transport closed"),d.eo())}),f(l,ch.EventType.ERROR,p=>{h||(h=!0,Wl("Connection","WebChannel transport errored:",p),d.eo(new k(w.UNAVAILABLE,"The operation could not be completed")))}),f(l,ch.EventType.MESSAGE,p=>{var _;if(!h){const y=p.data[0];ie(!!y);const T=y,I=T.error||((_=T[0])===null||_===void 0?void 0:_.error);if(I){P("Connection","WebChannel received error:",I);const E=I.status;let S=function(H){const K=dt[H];if(K!==void 0)return NN(K)}(E),$=I.message;S===void 0&&(S=w.INTERNAL,$="Unknown error status: "+E+" with message "+I.message),h=!0,d.eo(new k(S,$)),l.close()}else P("Connection","WebChannel received:",y),d.no(y)}}),f(o,I2.STAT_EVENT,p=>{p.stat===CE.PROXY?P("Connection","Detected buffering proxy"):p.stat===CE.NOPROXY&&P("Connection","Detected no buffering proxy")}),setTimeout(()=>{d.Zr()},0),d}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pP(){return typeof window!="undefined"?window:null}function xh(){return typeof document!="undefined"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qu(t){return new y4(t,!0)}class Kv{constructor(e,n,s=1e3,r=1.5,i=6e4){this.js=e,this.timerId=n,this.lo=s,this.fo=r,this._o=i,this.wo=0,this.mo=null,this.yo=Date.now(),this.reset()}reset(){this.wo=0}po(){this.wo=this._o}Io(e){this.cancel();const n=Math.floor(this.wo+this.To()),s=Math.max(0,Date.now()-this.yo),r=Math.max(0,n-s);r>0&&P("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.wo} ms, delay with jitter: ${n} ms, last attempt: ${s} ms ago)`),this.mo=this.js.enqueueAfterDelay(this.timerId,r,()=>(this.yo=Date.now(),e())),this.wo*=this.fo,this.wo<this.lo&&(this.wo=this.lo),this.wo>this._o&&(this.wo=this._o)}Eo(){this.mo!==null&&(this.mo.skipDelay(),this.mo=null)}cancel(){this.mo!==null&&(this.mo.cancel(),this.mo=null)}To(){return(Math.random()-.5)*this.wo}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gP{constructor(e,n,s,r,i,o,a,c){this.js=e,this.Ao=s,this.Ro=r,this.bo=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=c,this.state=0,this.Po=0,this.vo=null,this.Vo=null,this.stream=null,this.So=new Kv(e,n)}Do(){return this.state===1||this.state===5||this.Co()}Co(){return this.state===2||this.state===3}start(){this.state!==4?this.auth():this.xo()}async stop(){this.Do()&&await this.close(0)}No(){this.state=0,this.So.reset()}ko(){this.Co()&&this.vo===null&&(this.vo=this.js.enqueueAfterDelay(this.Ao,6e4,()=>this.Oo()))}Mo(e){this.Fo(),this.stream.send(e)}async Oo(){if(this.Co())return this.close(0)}Fo(){this.vo&&(this.vo.cancel(),this.vo=null)}$o(){this.Vo&&(this.Vo.cancel(),this.Vo=null)}async close(e,n){this.Fo(),this.$o(),this.So.cancel(),this.Po++,e!==4?this.So.reset():n&&n.code===w.RESOURCE_EXHAUSTED?(ft(n.toString()),ft("Using maximum backoff delay to prevent overloading the backend."),this.So.po()):n&&n.code===w.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.Bo(),this.stream.close(),this.stream=null),this.state=e,await this.listener.Jr(n)}Bo(){}auth(){this.state=1;const e=this.Lo(this.Po),n=this.Po;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([s,r])=>{this.Po===n&&this.Uo(s,r)},s=>{e(()=>{const r=new k(w.UNKNOWN,"Fetching auth token failed: "+s.message);return this.qo(r)})})}Uo(e,n){const s=this.Lo(this.Po);this.stream=this.Ko(e,n),this.stream.zr(()=>{s(()=>(this.state=2,this.Vo=this.js.enqueueAfterDelay(this.Ro,1e4,()=>(this.Co()&&(this.state=3),Promise.resolve())),this.listener.zr()))}),this.stream.Jr(r=>{s(()=>this.qo(r))}),this.stream.onMessage(r=>{s(()=>this.onMessage(r))})}xo(){this.state=5,this.So.Io(async()=>{this.state=0,this.start()})}qo(e){return P("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}Lo(e){return n=>{this.js.enqueueAndForget(()=>this.Po===e?n():(P("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class k6 extends gP{constructor(e,n,s,r,i,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,s,r,o),this.wt=i}Ko(e,n){return this.bo.ho("Listen",e,n)}onMessage(e){this.So.reset();const n=b4(this.wt,e),s=function(r){if(!("targetChange"in r))return re.min();const i=r.targetChange;return i.targetIds&&i.targetIds.length?re.min():i.readTime?Rt(i.readTime):re.min()}(e);return this.listener.Go(n,s)}Qo(e){const n={};n.database=eu(this.wt),n.addTarget=function(r,i){let o;const a=i.target;return o=Ad(a)?{documents:BN(r,a)}:{query:qN(r,a)},o.targetId=i.targetId,i.resumeToken.approximateByteSize()>0?o.resumeToken=LN(r,i.resumeToken):i.snapshotVersion.compareTo(re.min())>0&&(o.readTime=Xl(r,i.snapshotVersion.toTimestamp())),o}(this.wt,e);const s=E4(this.wt,e);s&&(n.labels=s),this.Mo(n)}jo(e){const n={};n.database=eu(this.wt),n.removeTarget=e,this.Mo(n)}}class R6 extends gP{constructor(e,n,s,r,i,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,s,r,o),this.wt=i,this.Wo=!1}get zo(){return this.Wo}start(){this.Wo=!1,this.lastStreamToken=void 0,super.start()}Bo(){this.Wo&&this.Ho([])}Ko(e,n){return this.bo.ho("Write",e,n)}onMessage(e){if(ie(!!e.streamToken),this.lastStreamToken=e.streamToken,this.Wo){this.So.reset();const n=I4(e.writeResults,e.commitTime),s=Rt(e.commitTime);return this.listener.Jo(s,n)}return ie(!e.writeResults||e.writeResults.length===0),this.Wo=!0,this.listener.Yo()}Xo(){const e={};e.database=eu(this.wt),this.Mo(e)}Ho(e){const n={streamToken:this.lastStreamToken,writes:e.map(s=>tu(this.wt,s))};this.Mo(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N6 extends class{}{constructor(e,n,s,r){super(),this.authCredentials=e,this.appCheckCredentials=n,this.bo=s,this.wt=r,this.Zo=!1}tu(){if(this.Zo)throw new k(w.FAILED_PRECONDITION,"The client has already been terminated.")}ro(e,n,s){return this.tu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([r,i])=>this.bo.ro(e,n,s,r,i)).catch(r=>{throw r.name==="FirebaseError"?(r.code===w.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),r):new k(w.UNKNOWN,r.toString())})}ao(e,n,s,r){return this.tu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.bo.ao(e,n,s,i,o,r)).catch(i=>{throw i.name==="FirebaseError"?(i.code===w.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new k(w.UNKNOWN,i.toString())})}terminate(){this.Zo=!0}}class P6{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.eu=0,this.nu=null,this.su=!0}iu(){this.eu===0&&(this.ru("Unknown"),this.nu=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.nu=null,this.ou("Backend didn't respond within 10 seconds."),this.ru("Offline"),Promise.resolve())))}uu(e){this.state==="Online"?this.ru("Unknown"):(this.eu++,this.eu>=1&&(this.cu(),this.ou(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ru("Offline")))}set(e){this.cu(),this.eu=0,e==="Online"&&(this.su=!1),this.ru(e)}ru(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}ou(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.su?(ft(n),this.su=!1):P("OnlineStateTracker",n)}cu(){this.nu!==null&&(this.nu.cancel(),this.nu=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class D6{constructor(e,n,s,r,i){this.localStore=e,this.datastore=n,this.asyncQueue=s,this.remoteSyncer={},this.au=[],this.hu=new Map,this.lu=new Set,this.fu=[],this.du=i,this.du.Br(o=>{s.enqueueAndForget(async()=>{gi(this)&&(P("RemoteStore","Restarting streams for network reachability change."),await async function(a){const c=q(a);c.lu.add(4),await ac(c),c._u.set("Unknown"),c.lu.delete(4),await ju(c)}(this))})}),this._u=new P6(s,r)}}async function ju(t){if(gi(t))for(const e of t.fu)await e(!0)}async function ac(t){for(const e of t.fu)await e(!1)}function up(t,e){const n=q(t);n.hu.has(e.targetId)||(n.hu.set(e.targetId,e),Gv(n)?Wv(n):lc(n).Co()&&Hv(n,e))}function nu(t,e){const n=q(t),s=lc(n);n.hu.delete(e),s.Co()&&mP(n,e),n.hu.size===0&&(s.Co()?s.ko():gi(n)&&n._u.set("Unknown"))}function Hv(t,e){t.wu.Nt(e.targetId),lc(t).Qo(e)}function mP(t,e){t.wu.Nt(e),lc(t).jo(e)}function Wv(t){t.wu=new g4({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),te:e=>t.hu.get(e)||null}),lc(t).start(),t._u.iu()}function Gv(t){return gi(t)&&!lc(t).Do()&&t.hu.size>0}function gi(t){return q(t).lu.size===0}function _P(t){t.wu=void 0}async function x6(t){t.hu.forEach((e,n)=>{Hv(t,e)})}async function O6(t,e){_P(t),Gv(t)?(t._u.uu(e),Wv(t)):t._u.set("Unknown")}async function M6(t,e,n){if(t._u.set("Online"),e instanceof MN&&e.state===2&&e.cause)try{await async function(s,r){const i=r.cause;for(const o of r.targetIds)s.hu.has(o)&&(await s.remoteSyncer.rejectListen(o,i),s.hu.delete(o),s.wu.removeTarget(o))}(t,e)}catch(s){P("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),s),await Od(t,s)}else if(e instanceof Ph?t.wu.Ut(e):e instanceof ON?t.wu.zt(e):t.wu.Gt(e),!n.isEqual(re.min()))try{const s=await cP(t.localStore);n.compareTo(s)>=0&&await function(r,i){const o=r.wu.Yt(i);return o.targetChanges.forEach((a,c)=>{if(a.resumeToken.approximateByteSize()>0){const l=r.hu.get(c);l&&r.hu.set(c,l.withResumeToken(a.resumeToken,i))}}),o.targetMismatches.forEach(a=>{const c=r.hu.get(a);if(!c)return;r.hu.set(a,c.withResumeToken(vt.EMPTY_BYTE_STRING,c.snapshotVersion)),mP(r,a);const l=new Hr(c.target,a,1,c.sequenceNumber);Hv(r,l)}),r.remoteSyncer.applyRemoteEvent(o)}(t,n)}catch(s){P("RemoteStore","Failed to raise snapshot:",s),await Od(t,s)}}async function Od(t,e,n){if(!fi(e))throw e;t.lu.add(1),await ac(t),t._u.set("Offline"),n||(n=()=>cP(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{P("RemoteStore","Retrying IndexedDB access"),await n(),t.lu.delete(1),await ju(t)})}function yP(t,e){return e().catch(n=>Od(t,n,e))}async function cc(t){const e=q(t),n=ii(e);let s=e.au.length>0?e.au[e.au.length-1].batchId:-1;for(;L6(e);)try{const r=await b6(e.localStore,s);if(r===null){e.au.length===0&&n.ko();break}s=r.batchId,F6(e,r)}catch(r){await Od(e,r)}vP(e)&&wP(e)}function L6(t){return gi(t)&&t.au.length<10}function F6(t,e){t.au.push(e);const n=ii(t);n.Co()&&n.zo&&n.Ho(e.mutations)}function vP(t){return gi(t)&&!ii(t).Do()&&t.au.length>0}function wP(t){ii(t).start()}async function U6(t){ii(t).Xo()}async function $6(t){const e=ii(t);for(const n of t.au)e.Ho(n.mutations)}async function V6(t,e,n){const s=t.au.shift(),r=Mv.from(s,e,n);await yP(t,()=>t.remoteSyncer.applySuccessfulWrite(r)),await cc(t)}async function B6(t,e){e&&ii(t).zo&&await async function(n,s){if(r=s.code,RN(r)&&r!==w.ABORTED){const i=n.au.shift();ii(n).No(),await yP(n,()=>n.remoteSyncer.rejectFailedWrite(i.batchId,s)),await cc(n)}var r}(t,e),vP(t)&&wP(t)}async function mT(t,e){const n=q(t);n.asyncQueue.verifyOperationInProgress(),P("RemoteStore","RemoteStore received new credentials");const s=gi(n);n.lu.add(3),await ac(n),s&&n._u.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.lu.delete(3),await ju(n)}async function Xm(t,e){const n=q(t);e?(n.lu.delete(2),await ju(n)):e||(n.lu.add(2),await ac(n),n._u.set("Unknown"))}function lc(t){return t.mu||(t.mu=function(e,n,s){const r=q(e);return r.tu(),new k6(n,r.bo,r.authCredentials,r.appCheckCredentials,r.wt,s)}(t.datastore,t.asyncQueue,{zr:x6.bind(null,t),Jr:O6.bind(null,t),Go:M6.bind(null,t)}),t.fu.push(async e=>{e?(t.mu.No(),Gv(t)?Wv(t):t._u.set("Unknown")):(await t.mu.stop(),_P(t))})),t.mu}function ii(t){return t.gu||(t.gu=function(e,n,s){const r=q(e);return r.tu(),new R6(n,r.bo,r.authCredentials,r.appCheckCredentials,r.wt,s)}(t.datastore,t.asyncQueue,{zr:U6.bind(null,t),Jr:B6.bind(null,t),Yo:$6.bind(null,t),Jo:V6.bind(null,t)}),t.fu.push(async e=>{e?(t.gu.No(),await cc(t)):(await t.gu.stop(),t.au.length>0&&(P("RemoteStore",`Stopping write stream with ${t.au.length} pending writes`),t.au=[]))})),t.gu}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zv{constructor(e,n,s,r,i){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=s,this.op=r,this.removalCallback=i,this.deferred=new kt,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}static createAndSchedule(e,n,s,r,i){const o=Date.now()+s,a=new zv(e,n,o,r,i);return a.start(s),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new k(w.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function uc(t,e){if(ft("AsyncQueue",`${e}: ${t}`),fi(t))return new k(w.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ha{constructor(e){this.comparator=e?(n,s)=>e(n,s)||U.comparator(n.key,s.key):(n,s)=>U.comparator(n.key,s.key),this.keyedMap=Lc(),this.sortedSet=new it(this.comparator)}static emptySet(e){return new ha(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,s)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof ha)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),s=e.sortedSet.getIterator();for(;n.hasNext();){const r=n.getNext().key,i=s.getNext().key;if(!r.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const s=new ha;return s.comparator=this.comparator,s.keyedMap=e,s.sortedSet=n,s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _T{constructor(){this.yu=new it(U.comparator)}track(e){const n=e.doc.key,s=this.yu.get(n);s?e.type!==0&&s.type===3?this.yu=this.yu.insert(n,e):e.type===3&&s.type!==1?this.yu=this.yu.insert(n,{type:s.type,doc:e.doc}):e.type===2&&s.type===2?this.yu=this.yu.insert(n,{type:2,doc:e.doc}):e.type===2&&s.type===0?this.yu=this.yu.insert(n,{type:0,doc:e.doc}):e.type===1&&s.type===0?this.yu=this.yu.remove(n):e.type===1&&s.type===2?this.yu=this.yu.insert(n,{type:1,doc:s.doc}):e.type===0&&s.type===1?this.yu=this.yu.insert(n,{type:2,doc:e.doc}):G():this.yu=this.yu.insert(n,e)}pu(){const e=[];return this.yu.inorderTraversal((n,s)=>{e.push(s)}),e}}class Fa{constructor(e,n,s,r,i,o,a,c){this.query=e,this.docs=n,this.oldDocs=s,this.docChanges=r,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=c}static fromInitialDocuments(e,n,s,r){const i=[];return n.forEach(o=>{i.push({type:0,doc:o})}),new Fa(e,n,ha.emptySet(n),i,s,r,!0,!1)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Uu(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,s=e.docChanges;if(n.length!==s.length)return!1;for(let r=0;r<n.length;r++)if(n[r].type!==s[r].type||!n[r].doc.isEqual(s[r].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q6{constructor(){this.Iu=void 0,this.listeners=[]}}class j6{constructor(){this.queries=new pi(e=>_N(e),Uu),this.onlineState="Unknown",this.Tu=new Set}}async function Qv(t,e){const n=q(t),s=e.query;let r=!1,i=n.queries.get(s);if(i||(r=!0,i=new q6),r)try{i.Iu=await n.onListen(s)}catch(o){const a=uc(o,`Initialization of query '${Gm(e.query)}' failed`);return void e.onError(a)}n.queries.set(s,i),i.listeners.push(e),e.Eu(n.onlineState),i.Iu&&e.Au(i.Iu)&&Jv(n)}async function Yv(t,e){const n=q(t),s=e.query;let r=!1;const i=n.queries.get(s);if(i){const o=i.listeners.indexOf(e);o>=0&&(i.listeners.splice(o,1),r=i.listeners.length===0)}if(r)return n.queries.delete(s),n.onUnlisten(s)}function K6(t,e){const n=q(t);let s=!1;for(const r of e){const i=r.query,o=n.queries.get(i);if(o){for(const a of o.listeners)a.Au(r)&&(s=!0);o.Iu=r}}s&&Jv(n)}function H6(t,e,n){const s=q(t),r=s.queries.get(e);if(r)for(const i of r.listeners)i.onError(n);s.queries.delete(e)}function Jv(t){t.Tu.forEach(e=>{e.next()})}class Xv{constructor(e,n,s){this.query=e,this.Ru=n,this.bu=!1,this.Pu=null,this.onlineState="Unknown",this.options=s||{}}Au(e){if(!this.options.includeMetadataChanges){const s=[];for(const r of e.docChanges)r.type!==3&&s.push(r);e=new Fa(e.query,e.docs,e.oldDocs,s,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0)}let n=!1;return this.bu?this.vu(e)&&(this.Ru.next(e),n=!0):this.Vu(e,this.onlineState)&&(this.Su(e),n=!0),this.Pu=e,n}onError(e){this.Ru.error(e)}Eu(e){this.onlineState=e;let n=!1;return this.Pu&&!this.bu&&this.Vu(this.Pu,e)&&(this.Su(this.Pu),n=!0),n}Vu(e,n){if(!e.fromCache)return!0;const s=n!=="Offline";return(!this.options.Du||!s)&&(!e.docs.isEmpty()||n==="Offline")}vu(e){if(e.docChanges.length>0)return!0;const n=this.Pu&&this.Pu.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}Su(e){e=Fa.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache),this.bu=!0,this.Ru.next(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W6{constructor(e,n){this.payload=e,this.byteLength=n}Cu(){return"metadata"in this.payload}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yT{constructor(e){this.wt=e}Wi(e){return Ns(this.wt,e)}zi(e){return e.metadata.exists?VN(this.wt,e.document,!1):Be.newNoDocument(this.Wi(e.metadata.name),this.Hi(e.metadata.readTime))}Hi(e){return Rt(e)}}class G6{constructor(e,n,s){this.xu=e,this.localStore=n,this.wt=s,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=bP(e)}Nu(e){this.progress.bytesLoaded+=e.byteLength;let n=this.progress.documentsLoaded;if(e.payload.namedQuery)this.queries.push(e.payload.namedQuery);else if(e.payload.documentMetadata){this.documents.push({metadata:e.payload.documentMetadata}),e.payload.documentMetadata.exists||++n;const s=we.fromString(e.payload.documentMetadata.name);this.collectionGroups.add(s.get(s.length-2))}else e.payload.document&&(this.documents[this.documents.length-1].document=e.payload.document,++n);return n!==this.progress.documentsLoaded?(this.progress.documentsLoaded=n,Object.assign({},this.progress)):null}ku(e){const n=new Map,s=new yT(this.wt);for(const r of e)if(r.metadata.queries){const i=s.Wi(r.metadata.name);for(const o of r.metadata.queries){const a=(n.get(o)||ue()).add(i);n.set(o,a)}}return n}async complete(){const e=await I6(this.localStore,new yT(this.wt),this.documents,this.xu.id),n=this.ku(this.documents);for(const s of this.queries)await E6(this.localStore,s,n.get(s.name));return this.progress.taskState="Success",{progress:this.progress,Ou:this.collectionGroups,Mu:e}}}function bP(t){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:t.totalDocuments,totalBytes:t.totalBytes}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IP{constructor(e){this.key=e}}class EP{constructor(e){this.key=e}}class TP{constructor(e,n){this.query=e,this.Fu=n,this.$u=null,this.current=!1,this.Bu=ue(),this.mutatedKeys=ue(),this.Lu=vN(e),this.Uu=new ha(this.Lu)}get qu(){return this.Fu}Ku(e,n){const s=n?n.Gu:new _T,r=n?n.Uu:this.Uu;let i=n?n.mutatedKeys:this.mutatedKeys,o=r,a=!1;const c=this.query.limitType==="F"&&r.size===this.query.limit?r.last():null,l=this.query.limitType==="L"&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal((u,h)=>{const d=r.get(u),f=Pv(this.query,h)?h:null,p=!!d&&this.mutatedKeys.has(d.key),_=!!f&&(f.hasLocalMutations||this.mutatedKeys.has(f.key)&&f.hasCommittedMutations);let y=!1;d&&f?d.data.isEqual(f.data)?p!==_&&(s.track({type:3,doc:f}),y=!0):this.Qu(d,f)||(s.track({type:2,doc:f}),y=!0,(c&&this.Lu(f,c)>0||l&&this.Lu(f,l)<0)&&(a=!0)):!d&&f?(s.track({type:0,doc:f}),y=!0):d&&!f&&(s.track({type:1,doc:d}),y=!0,(c||l)&&(a=!0)),y&&(f?(o=o.add(f),i=_?i.add(u):i.delete(u)):(o=o.delete(u),i=i.delete(u)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const u=this.query.limitType==="F"?o.last():o.first();o=o.delete(u.key),i=i.delete(u.key),s.track({type:1,doc:u})}return{Uu:o,Gu:s,Oi:a,mutatedKeys:i}}Qu(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,s){const r=this.Uu;this.Uu=e.Uu,this.mutatedKeys=e.mutatedKeys;const i=e.Gu.pu();i.sort((l,u)=>function(h,d){const f=p=>{switch(p){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return G()}};return f(h)-f(d)}(l.type,u.type)||this.Lu(l.doc,u.doc)),this.ju(s);const o=n?this.Wu():[],a=this.Bu.size===0&&this.current?1:0,c=a!==this.$u;return this.$u=a,i.length!==0||c?{snapshot:new Fa(this.query,e.Uu,r,i,e.mutatedKeys,a===0,c,!1),zu:o}:{zu:o}}Eu(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Uu:this.Uu,Gu:new _T,mutatedKeys:this.mutatedKeys,Oi:!1},!1)):{zu:[]}}Hu(e){return!this.Fu.has(e)&&!!this.Uu.has(e)&&!this.Uu.get(e).hasLocalMutations}ju(e){e&&(e.addedDocuments.forEach(n=>this.Fu=this.Fu.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Fu=this.Fu.delete(n)),this.current=e.current)}Wu(){if(!this.current)return[];const e=this.Bu;this.Bu=ue(),this.Uu.forEach(s=>{this.Hu(s.key)&&(this.Bu=this.Bu.add(s.key))});const n=[];return e.forEach(s=>{this.Bu.has(s)||n.push(new EP(s))}),this.Bu.forEach(s=>{e.has(s)||n.push(new IP(s))}),n}Ju(e){this.Fu=e.ji,this.Bu=ue();const n=this.Ku(e.documents);return this.applyChanges(n,!0)}Yu(){return Fa.fromInitialDocuments(this.query,this.Uu,this.mutatedKeys,this.$u===0)}}class z6{constructor(e,n,s){this.query=e,this.targetId=n,this.view=s}}class Q6{constructor(e){this.key=e,this.Xu=!1}}class Y6{constructor(e,n,s,r,i,o){this.localStore=e,this.remoteStore=n,this.eventManager=s,this.sharedClientState=r,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.Zu={},this.tc=new pi(a=>_N(a),Uu),this.ec=new Map,this.nc=new Set,this.sc=new it(U.comparator),this.ic=new Map,this.rc=new $v,this.oc={},this.uc=new Map,this.cc=yo.Rn(),this.onlineState="Unknown",this.ac=void 0}get isPrimaryClient(){return this.ac===!0}}async function J6(t,e){const n=sw(t);let s,r;const i=n.tc.get(e);if(i)s=i.targetId,n.sharedClientState.addLocalQueryTarget(s),r=i.view.Yu();else{const o=await Ma(n.localStore,Qn(e));n.isPrimaryClient&&up(n.remoteStore,o);const a=n.sharedClientState.addLocalQueryTarget(o.targetId);s=o.targetId,r=await Zv(n,e,s,a==="current")}return r}async function Zv(t,e,n,s){t.hc=(u,h,d)=>async function(f,p,_,y){let T=p.view.Ku(_);T.Oi&&(T=await Pd(f.localStore,p.query,!1).then(({documents:S})=>p.view.Ku(S,T)));const I=y&&y.targetChanges.get(p.targetId),E=p.view.applyChanges(T,f.isPrimaryClient,I);return Zm(f,p.targetId,E.zu),E.snapshot}(t,u,h,d);const r=await Pd(t.localStore,e,!0),i=new TP(e,r.ji),o=i.Ku(r.documents),a=Bu.createSynthesizedTargetChangeForCurrentChange(n,s&&t.onlineState!=="Offline"),c=i.applyChanges(o,t.isPrimaryClient,a);Zm(t,n,c.zu);const l=new z6(e,n,i);return t.tc.set(e,l),t.ec.has(n)?t.ec.get(n).push(e):t.ec.set(n,[e]),c.snapshot}async function X6(t,e){const n=q(t),s=n.tc.get(e),r=n.ec.get(s.targetId);if(r.length>1)return n.ec.set(s.targetId,r.filter(i=>!Uu(i,e))),void n.tc.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(s.targetId),n.sharedClientState.isActiveQueryTarget(s.targetId)||await La(n.localStore,s.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(s.targetId),nu(n.remoteStore,s.targetId),Ua(n,s.targetId)}).catch(di)):(Ua(n,s.targetId),await La(n.localStore,s.targetId,!0))}async function Z6(t,e,n){const s=rw(t);try{const r=await function(i,o){const a=q(i),c=Qe.now(),l=o.reduce((d,f)=>d.add(f.key),ue());let u,h;return a.persistence.runTransaction("Locally write mutations","readwrite",d=>{let f=wn(),p=ue();return a.Ui.getEntries(d,l).next(_=>{f=_,f.forEach((y,T)=>{T.isValidDocument()||(p=p.add(y))})}).next(()=>a.localDocuments.getOverlayedDocuments(d,f)).next(_=>{u=_;const y=[];for(const T of o){const I=l4(T,u.get(T.key).overlayedDocument);I!=null&&y.push(new _r(T.key,I,fN(I.value.mapValue),Xe.exists(!0)))}return a.mutationQueue.addMutationBatch(d,c,y,o)}).next(_=>{h=_;const y=_.applyToLocalDocumentSet(u,p);return a.documentOverlayCache.saveOverlays(d,_.batchId,y)})}).then(()=>({batchId:h.batchId,changes:DN(u)}))}(s.localStore,e);s.sharedClientState.addPendingMutation(r.batchId),function(i,o,a){let c=i.oc[i.currentUser.toKey()];c||(c=new it(ce)),c=c.insert(o,a),i.oc[i.currentUser.toKey()]=c}(s,r.batchId,n),await yr(s,r.changes),await cc(s.remoteStore)}catch(r){const i=uc(r,"Failed to persist write");n.reject(i)}}async function SP(t,e){const n=q(t);try{const s=await w6(n.localStore,e);e.targetChanges.forEach((r,i)=>{const o=n.ic.get(i);o&&(ie(r.addedDocuments.size+r.modifiedDocuments.size+r.removedDocuments.size<=1),r.addedDocuments.size>0?o.Xu=!0:r.modifiedDocuments.size>0?ie(o.Xu):r.removedDocuments.size>0&&(ie(o.Xu),o.Xu=!1))}),await yr(n,s,e)}catch(s){await di(s)}}function vT(t,e,n){const s=q(t);if(s.isPrimaryClient&&n===0||!s.isPrimaryClient&&n===1){const r=[];s.tc.forEach((i,o)=>{const a=o.view.Eu(e);a.snapshot&&r.push(a.snapshot)}),function(i,o){const a=q(i);a.onlineState=o;let c=!1;a.queries.forEach((l,u)=>{for(const h of u.listeners)h.Eu(o)&&(c=!0)}),c&&Jv(a)}(s.eventManager,e),r.length&&s.Zu.Go(r),s.onlineState=e,s.isPrimaryClient&&s.sharedClientState.setOnlineState(e)}}async function eQ(t,e,n){const s=q(t);s.sharedClientState.updateQueryState(e,"rejected",n);const r=s.ic.get(e),i=r&&r.key;if(i){let o=new it(U.comparator);o=o.insert(i,Be.newNoDocument(i,re.min()));const a=ue().add(i),c=new Vu(re.min(),new Map,new ke(ce),o,a);await SP(s,c),s.sc=s.sc.remove(i),s.ic.delete(e),nw(s)}else await La(s.localStore,e,!1).then(()=>Ua(s,e,n)).catch(di)}async function tQ(t,e){const n=q(t),s=e.batch.batchId;try{const r=await v6(n.localStore,e);tw(n,s,null),ew(n,s),n.sharedClientState.updateMutationState(s,"acknowledged"),await yr(n,r)}catch(r){await di(r)}}async function nQ(t,e,n){const s=q(t);try{const r=await function(i,o){const a=q(i);return a.persistence.runTransaction("Reject batch","readwrite-primary",c=>{let l;return a.mutationQueue.lookupMutationBatch(c,o).next(u=>(ie(u!==null),l=u.keys(),a.mutationQueue.removeMutationBatch(c,u))).next(()=>a.mutationQueue.performConsistencyCheck(c)).next(()=>a.documentOverlayCache.removeOverlaysForBatchId(c,l,o)).next(()=>a.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(c,l)).next(()=>a.localDocuments.getDocuments(c,l))})}(s.localStore,e);tw(s,e,n),ew(s,e),s.sharedClientState.updateMutationState(e,"rejected",n),await yr(s,r)}catch(r){await di(r)}}async function sQ(t,e){const n=q(t);gi(n.remoteStore)||P("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{const s=await function(i){const o=q(i);return o.persistence.runTransaction("Get highest unacknowledged batch id","readonly",a=>o.mutationQueue.getHighestUnacknowledgedBatchId(a))}(n.localStore);if(s===-1)return void e.resolve();const r=n.uc.get(s)||[];r.push(e),n.uc.set(s,r)}catch(s){const r=uc(s,"Initialization of waitForPendingWrites() operation failed");e.reject(r)}}function ew(t,e){(t.uc.get(e)||[]).forEach(n=>{n.resolve()}),t.uc.delete(e)}function tw(t,e,n){const s=q(t);let r=s.oc[s.currentUser.toKey()];if(r){const i=r.get(e);i&&(n?i.reject(n):i.resolve(),r=r.remove(e)),s.oc[s.currentUser.toKey()]=r}}function Ua(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const s of t.ec.get(e))t.tc.delete(s),n&&t.Zu.lc(s,n);t.ec.delete(e),t.isPrimaryClient&&t.rc.us(e).forEach(s=>{t.rc.containsKey(s)||CP(t,s)})}function CP(t,e){t.nc.delete(e.path.canonicalString());const n=t.sc.get(e);n!==null&&(nu(t.remoteStore,n),t.sc=t.sc.remove(e),t.ic.delete(n),nw(t))}function Zm(t,e,n){for(const s of n)s instanceof IP?(t.rc.addReference(s.key,e),rQ(t,s)):s instanceof EP?(P("SyncEngine","Document no longer in limbo: "+s.key),t.rc.removeReference(s.key,e),t.rc.containsKey(s.key)||CP(t,s.key)):G()}function rQ(t,e){const n=e.key,s=n.path.canonicalString();t.sc.get(n)||t.nc.has(s)||(P("SyncEngine","New document in limbo: "+n),t.nc.add(s),nw(t))}function nw(t){for(;t.nc.size>0&&t.sc.size<t.maxConcurrentLimboResolutions;){const e=t.nc.values().next().value;t.nc.delete(e);const n=new U(we.fromString(e)),s=t.cc.next();t.ic.set(s,new Q6(n)),t.sc=t.sc.insert(n,s),up(t.remoteStore,new Hr(Qn(rc(n.path)),s,2,vn.ot))}}async function yr(t,e,n){const s=q(t),r=[],i=[],o=[];s.tc.isEmpty()||(s.tc.forEach((a,c)=>{o.push(s.hc(c,e,n).then(l=>{if(l){s.isPrimaryClient&&s.sharedClientState.updateQueryState(c.targetId,l.fromCache?"not-current":"current"),r.push(l);const u=qv.Vi(c.targetId,l);i.push(u)}}))}),await Promise.all(o),s.Zu.Go(r),await async function(a,c){const l=q(a);try{await l.persistence.runTransaction("notifyLocalViewChanges","readwrite",u=>v.forEach(c,h=>v.forEach(h.Pi,d=>l.persistence.referenceDelegate.addReference(u,h.targetId,d)).next(()=>v.forEach(h.vi,d=>l.persistence.referenceDelegate.removeReference(u,h.targetId,d)))))}catch(u){if(!fi(u))throw u;P("LocalStore","Failed to update sequence numbers: "+u)}for(const u of c){const h=u.targetId;if(!u.fromCache){const d=l.$i.get(h),f=d.snapshotVersion,p=d.withLastLimboFreeSnapshotVersion(f);l.$i=l.$i.insert(h,p)}}}(s.localStore,i))}async function iQ(t,e){const n=q(t);if(!n.currentUser.isEqual(e)){P("SyncEngine","User change. New user:",e.toKey());const s=await aP(n.localStore,e);n.currentUser=e,function(r,i){r.uc.forEach(o=>{o.forEach(a=>{a.reject(new k(w.CANCELLED,i))})}),r.uc.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,s.removedBatchIds,s.addedBatchIds),await yr(n,s.Ki)}}function oQ(t,e){const n=q(t),s=n.ic.get(e);if(s&&s.Xu)return ue().add(s.key);{let r=ue();const i=n.ec.get(e);if(!i)return r;for(const o of i){const a=n.tc.get(o);r=r.unionWith(a.view.qu)}return r}}async function aQ(t,e){const n=q(t),s=await Pd(n.localStore,e.query,!0),r=e.view.Ju(s);return n.isPrimaryClient&&Zm(n,e.targetId,r.zu),r}async function cQ(t,e){const n=q(t);return hP(n.localStore,e).then(s=>yr(n,s))}async function lQ(t,e,n,s){const r=q(t),i=await function(o,a){const c=q(o),l=q(c.mutationQueue);return c.persistence.runTransaction("Lookup mutation documents","readonly",u=>l.yn(u,a).next(h=>h?c.localDocuments.getDocuments(u,h):v.resolve(null)))}(r.localStore,e);i!==null?(n==="pending"?await cc(r.remoteStore):n==="acknowledged"||n==="rejected"?(tw(r,e,s||null),ew(r,e),function(o,a){q(q(o).mutationQueue).In(a)}(r.localStore,e)):G(),await yr(r,i)):P("SyncEngine","Cannot apply mutation batch with id: "+e)}async function uQ(t,e){const n=q(t);if(sw(n),rw(n),e===!0&&n.ac!==!0){const s=n.sharedClientState.getAllActiveQueryTargets(),r=await wT(n,s.toArray());n.ac=!0,await Xm(n.remoteStore,!0);for(const i of r)up(n.remoteStore,i)}else if(e===!1&&n.ac!==!1){const s=[];let r=Promise.resolve();n.ec.forEach((i,o)=>{n.sharedClientState.isLocalQueryTarget(o)?s.push(o):r=r.then(()=>(Ua(n,o),La(n.localStore,o,!0))),nu(n.remoteStore,o)}),await r,await wT(n,s),function(i){const o=q(i);o.ic.forEach((a,c)=>{nu(o.remoteStore,c)}),o.rc.cs(),o.ic=new Map,o.sc=new it(U.comparator)}(n),n.ac=!1,await Xm(n.remoteStore,!1)}}async function wT(t,e,n){const s=q(t),r=[],i=[];for(const o of e){let a;const c=s.ec.get(o);if(c&&c.length!==0){a=await Ma(s.localStore,Qn(c[0]));for(const l of c){const u=s.tc.get(l),h=await aQ(s,u);h.snapshot&&i.push(h.snapshot)}}else{const l=await uP(s.localStore,o);a=await Ma(s.localStore,l),await Zv(s,AP(l),o,!1)}r.push(a)}return s.Zu.Go(i),r}function AP(t){return gN(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function hQ(t){const e=q(t);return q(q(e.localStore).persistence).Ri()}async function dQ(t,e,n,s){const r=q(t);if(r.ac)return void P("SyncEngine","Ignoring unexpected query state notification.");const i=r.ec.get(e);if(i&&i.length>0)switch(n){case"current":case"not-current":{const o=await hP(r.localStore,yN(i[0])),a=Vu.createSynthesizedRemoteEventForCurrentChange(e,n==="current");await yr(r,o,a);break}case"rejected":await La(r.localStore,e,!0),Ua(r,e,s);break;default:G()}}async function fQ(t,e,n){const s=sw(t);if(s.ac){for(const r of e){if(s.ec.has(r)){P("SyncEngine","Adding an already active target "+r);continue}const i=await uP(s.localStore,r),o=await Ma(s.localStore,i);await Zv(s,AP(i),o.targetId,!1),up(s.remoteStore,o)}for(const r of n)s.ec.has(r)&&await La(s.localStore,r,!1).then(()=>{nu(s.remoteStore,r),Ua(s,r)}).catch(di)}}function sw(t){const e=q(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=SP.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=oQ.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=eQ.bind(null,e),e.Zu.Go=K6.bind(null,e.eventManager),e.Zu.lc=H6.bind(null,e.eventManager),e}function rw(t){const e=q(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=tQ.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=nQ.bind(null,e),e}function pQ(t,e,n){const s=q(t);(async function(r,i,o){try{const a=await i.getMetadata();if(await function(h,d){const f=q(h),p=Rt(d.createTime);return f.persistence.runTransaction("hasNewerBundle","readonly",_=>f.Ds.getBundleMetadata(_,d.id)).then(_=>!!_&&_.createTime.compareTo(p)>=0)}(r.localStore,a))return await i.close(),o._completeWith(function(h){return{taskState:"Success",documentsLoaded:h.totalDocuments,bytesLoaded:h.totalBytes,totalDocuments:h.totalDocuments,totalBytes:h.totalBytes}}(a)),Promise.resolve(new Set);o._updateProgress(bP(a));const c=new G6(a,r.localStore,i.wt);let l=await i.fc();for(;l;){const h=await c.Nu(l);h&&o._updateProgress(h),l=await i.fc()}const u=await c.complete();return await yr(r,u.Mu,void 0),await function(h,d){const f=q(h);return f.persistence.runTransaction("Save bundle","readwrite",p=>f.Ds.saveBundleMetadata(p,d))}(r.localStore,a),o._completeWith(u.progress),Promise.resolve(u.Ou)}catch(a){return Wl("SyncEngine",`Loading bundle failed with ${a}`),o._failWith(a),Promise.resolve(new Set)}})(s,e,n).then(r=>{s.sharedClientState.notifyBundleLoaded(r)})}class kP{constructor(){this.synchronizeTabs=!1}async initialize(e){this.wt=qu(e.databaseInfo.databaseId),this.sharedClientState=this.dc(e),this.persistence=this._c(e),await this.persistence.start(),this.localStore=this.wc(e),this.gcScheduler=this.mc(e,this.localStore),this.indexBackfillerScheduler=this.gc(e,this.localStore)}mc(e,n){return null}gc(e,n){return null}wc(e){return oP(this.persistence,new iP,e.initialUser,this.wt)}_c(e){return new rP(lp.Ms,this.wt)}dc(e){return new fP}async terminate(){this.gcScheduler&&this.gcScheduler.stop(),await this.sharedClientState.shutdown(),await this.persistence.shutdown()}}class RP extends kP{constructor(e,n,s){super(),this.yc=e,this.cacheSizeBytes=n,this.forceOwnership=s,this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.yc.initialize(this,e),await rw(this.yc.syncEngine),await cc(this.yc.remoteStore),await this.persistence.ci(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}wc(e){return oP(this.persistence,new iP,e.initialUser,this.wt)}mc(e,n){const s=this.persistence.referenceDelegate.garbageCollector;return new r6(s,e.asyncQueue,n)}gc(e,n){const s=new V2(n,this.persistence);return new $2(e.asyncQueue,s)}_c(e){const n=Bv(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),s=this.cacheSizeBytes!==void 0?mn.withCacheSize(this.cacheSizeBytes):mn.DEFAULT;return new Vv(this.synchronizeTabs,n,e.clientId,s,e.asyncQueue,pP(),xh(),this.wt,this.sharedClientState,!!this.forceOwnership)}dc(e){return new fP}}class gQ extends RP{constructor(e,n){super(e,n,!1),this.yc=e,this.cacheSizeBytes=n,this.synchronizeTabs=!0}async initialize(e){await super.initialize(e);const n=this.yc.syncEngine;this.sharedClientState instanceof gg&&(this.sharedClientState.syncEngine={kr:lQ.bind(null,n),Or:dQ.bind(null,n),Mr:fQ.bind(null,n),Ri:hQ.bind(null,n),Nr:cQ.bind(null,n)},await this.sharedClientState.start()),await this.persistence.ci(async s=>{await uQ(this.yc.syncEngine,s),this.gcScheduler&&(s&&!this.gcScheduler.started?this.gcScheduler.start():s||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(s&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():s||this.indexBackfillerScheduler.stop())})}dc(e){const n=pP();if(!gg.V(n))throw new k(w.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const s=Bv(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new gg(n,e.asyncQueue,s,e.clientId,e.initialUser)}}class iw{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=s=>vT(this.syncEngine,s,1),this.remoteStore.remoteSyncer.handleCredentialChange=iQ.bind(null,this.syncEngine),await Xm(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return new j6}createDatastore(e){const n=qu(e.databaseInfo.databaseId),s=(r=e.databaseInfo,new A6(r));var r;return function(i,o,a,c){return new N6(i,o,a,c)}(e.authCredentials,e.appCheckCredentials,s,n)}createRemoteStore(e){return n=this.localStore,s=this.datastore,r=e.asyncQueue,i=a=>vT(this.syncEngine,a,0),o=gT.V()?new gT:new T6,new D6(n,s,r,i,o);var n,s,r,i,o}createSyncEngine(e,n){return function(s,r,i,o,a,c,l){const u=new Y6(s,r,i,o,a,c);return l&&(u.ac=!0),u}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}terminate(){return async function(e){const n=q(e);P("RemoteStore","RemoteStore shutting down."),n.lu.add(5),await ac(n),n.du.shutdown(),n._u.set("Unknown")}(this.remoteStore)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bT(t,e=10240){let n=0;return{async read(){if(n<t.byteLength){const s={value:t.slice(n,n+e),done:!1};return n+=e,s}return{done:!0}},async cancel(){},releaseLock(){},closed:Promise.reject("unimplemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hp{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Ic(this.observer.next,e)}error(e){this.observer.error?this.Ic(this.observer.error,e):console.error("Uncaught Error in snapshot listener:",e)}Tc(){this.muted=!0}Ic(e,n){this.muted||setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mQ{constructor(e,n){this.Ec=e,this.wt=n,this.metadata=new kt,this.buffer=new Uint8Array,this.Ac=new TextDecoder("utf-8"),this.Rc().then(s=>{s&&s.Cu()?this.metadata.resolve(s.payload.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(s==null?void 0:s.payload)}`))},s=>this.metadata.reject(s))}close(){return this.Ec.cancel()}async getMetadata(){return this.metadata.promise}async fc(){return await this.getMetadata(),this.Rc()}async Rc(){const e=await this.bc();if(e===null)return null;const n=this.Ac.decode(e),s=Number(n);isNaN(s)&&this.Pc(`length string (${n}) is not valid number`);const r=await this.vc(s);return new W6(JSON.parse(r),e.length+s)}Vc(){return this.buffer.findIndex(e=>e==="{".charCodeAt(0))}async bc(){for(;this.Vc()<0&&!await this.Sc(););if(this.buffer.length===0)return null;const e=this.Vc();e<0&&this.Pc("Reached the end of bundle when a length string is expected.");const n=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),n}async vc(e){for(;this.buffer.length<e;)await this.Sc()&&this.Pc("Reached the end of bundle when more is expected.");const n=this.Ac.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),n}Pc(e){throw this.Ec.cancel(),new Error(`Invalid bundle format: ${e}`)}async Sc(){const e=await this.Ec.read();if(!e.done){const n=new Uint8Array(this.buffer.length+e.value.length);n.set(this.buffer),n.set(e.value,this.buffer.length),this.buffer=n}return e.done}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _Q{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastWriteError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw new k(w.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");const n=await async function(s,r){const i=q(s),o=eu(i.wt)+"/documents",a={documents:r.map(h=>Zl(i.wt,h))},c=await i.ao("BatchGetDocuments",o,a,r.length),l=new Map;c.forEach(h=>{const d=w4(i.wt,h);l.set(d.key.toString(),d)});const u=[];return r.forEach(h=>{const d=l.get(h.toString());ie(!!d),u.push(d)}),u}(this.datastore,e);return n.forEach(s=>this.recordVersion(s)),n}set(e,n){this.write(n.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,n){try{this.write(n.toMutation(e,this.preconditionForUpdate(e)))}catch(s){this.lastWriteError=s}this.writtenDocs.add(e.toString())}delete(e){this.write(new oc(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastWriteError)throw this.lastWriteError;const e=this.readVersions;this.mutations.forEach(n=>{e.delete(n.key.toString())}),e.forEach((n,s)=>{const r=U.fromPath(s);this.mutations.push(new Dv(r,this.precondition(r)))}),await async function(n,s){const r=q(n),i=eu(r.wt)+"/documents",o={writes:s.map(a=>tu(r.wt,a))};await r.ro("Commit",i,o)}(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let n;if(e.isFoundDocument())n=e.version;else{if(!e.isNoDocument())throw G();n=re.min()}const s=this.readVersions.get(e.key.toString());if(s){if(!n.isEqual(s))throw new k(w.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),n)}precondition(e){const n=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&n?Xe.updateTime(n):Xe.none()}preconditionForUpdate(e){const n=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&n){if(n.isEqual(re.min()))throw new k(w.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Xe.updateTime(n)}return Xe.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yQ{constructor(e,n,s,r,i){this.asyncQueue=e,this.datastore=n,this.options=s,this.updateFunction=r,this.deferred=i,this.Dc=s.maxAttempts,this.So=new Kv(this.asyncQueue,"transaction_retry")}run(){this.Dc-=1,this.Cc()}Cc(){this.So.Io(async()=>{const e=new _Q(this.datastore),n=this.xc(e);n&&n.then(s=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(s)}).catch(r=>{this.Nc(r)}))}).catch(s=>{this.Nc(s)})})}xc(e){try{const n=this.updateFunction(e);return!Lu(n)&&n.catch&&n.then?n:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(n){return this.deferred.reject(n),null}}Nc(e){this.Dc>0&&this.kc(e)?(this.Dc-=1,this.asyncQueue.enqueueAndForget(()=>(this.Cc(),Promise.resolve()))):this.deferred.reject(e)}kc(e){if(e.name==="FirebaseError"){const n=e.code;return n==="aborted"||n==="failed-precondition"||!RN(n)}return!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vQ{constructor(e,n,s,r){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=s,this.databaseInfo=r,this.user=St.UNAUTHENTICATED,this.clientId=nN.I(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(s,async i=>{P("FirestoreClient","Received user=",i.uid),await this.authCredentialListener(i),this.user=i}),this.appCheckCredentials.start(s,i=>(P("FirestoreClient","Received new app check token=",i),this.appCheckCredentialListener(i,this.user)))}async getConfiguration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new k(w.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();const e=new kt;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this.onlineComponents&&await this.onlineComponents.terminate(),this.offlineComponents&&await this.offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const s=uc(n,"Failed to shutdown persistence");e.reject(s)}}),e.promise}}async function NP(t,e){t.asyncQueue.verifyOperationInProgress(),P("FirestoreClient","Initializing OfflineComponentProvider");const n=await t.getConfiguration();await e.initialize(n);let s=n.initialUser;t.setCredentialChangeListener(async r=>{s.isEqual(r)||(await aP(e.localStore,r),s=r)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t.offlineComponents=e}async function PP(t,e){t.asyncQueue.verifyOperationInProgress();const n=await ow(t);P("FirestoreClient","Initializing OnlineComponentProvider");const s=await t.getConfiguration();await e.initialize(n,s),t.setCredentialChangeListener(r=>mT(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,i)=>mT(e.remoteStore,i)),t.onlineComponents=e}async function ow(t){return t.offlineComponents||(P("FirestoreClient","Using default OfflineComponentProvider"),await NP(t,new kP)),t.offlineComponents}async function dp(t){return t.onlineComponents||(P("FirestoreClient","Using default OnlineComponentProvider"),await PP(t,new iw)),t.onlineComponents}function DP(t){return ow(t).then(e=>e.persistence)}function aw(t){return ow(t).then(e=>e.localStore)}function xP(t){return dp(t).then(e=>e.remoteStore)}function cw(t){return dp(t).then(e=>e.syncEngine)}async function $a(t){const e=await dp(t),n=e.eventManager;return n.onListen=J6.bind(null,e.syncEngine),n.onUnlisten=X6.bind(null,e.syncEngine),n}function wQ(t){return t.asyncQueue.enqueue(async()=>{const e=await DP(t),n=await xP(t);return e.setNetworkEnabled(!0),function(s){const r=q(s);return r.lu.delete(0),ju(r)}(n)})}function bQ(t){return t.asyncQueue.enqueue(async()=>{const e=await DP(t),n=await xP(t);return e.setNetworkEnabled(!1),async function(s){const r=q(s);r.lu.add(0),await ac(r),r._u.set("Offline")}(n)})}function IQ(t,e){const n=new kt;return t.asyncQueue.enqueueAndForget(async()=>async function(s,r,i){try{const o=await function(a,c){const l=q(a);return l.persistence.runTransaction("read document","readonly",u=>l.localDocuments.getDocument(u,c))}(s,r);o.isFoundDocument()?i.resolve(o):o.isNoDocument()?i.resolve(null):i.reject(new k(w.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(o){const a=uc(o,`Failed to get document '${r} from cache`);i.reject(a)}}(await aw(t),e,n)),n.promise}function OP(t,e,n={}){const s=new kt;return t.asyncQueue.enqueueAndForget(async()=>function(r,i,o,a,c){const l=new hp({next:h=>{i.enqueueAndForget(()=>Yv(r,u));const d=h.docs.has(o);!d&&h.fromCache?c.reject(new k(w.UNAVAILABLE,"Failed to get document because the client is offline.")):d&&h.fromCache&&a&&a.source==="server"?c.reject(new k(w.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):c.resolve(h)},error:h=>c.reject(h)}),u=new Xv(rc(o.path),l,{includeMetadataChanges:!0,Du:!0});return Qv(r,u)}(await $a(t),t.asyncQueue,e,n,s)),s.promise}function EQ(t,e){const n=new kt;return t.asyncQueue.enqueueAndForget(async()=>async function(s,r,i){try{const o=await Pd(s,r,!0),a=new TP(r,o.ji),c=a.Ku(o.documents),l=a.applyChanges(c,!1);i.resolve(l.snapshot)}catch(o){const a=uc(o,`Failed to execute query '${r} against cache`);i.reject(a)}}(await aw(t),e,n)),n.promise}function MP(t,e,n={}){const s=new kt;return t.asyncQueue.enqueueAndForget(async()=>function(r,i,o,a,c){const l=new hp({next:h=>{i.enqueueAndForget(()=>Yv(r,u)),h.fromCache&&a.source==="server"?c.reject(new k(w.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):c.resolve(h)},error:h=>c.reject(h)}),u=new Xv(o,l,{includeMetadataChanges:!0,Du:!0});return Qv(r,u)}(await $a(t),t.asyncQueue,e,n,s)),s.promise}function TQ(t,e){const n=new hp(e);return t.asyncQueue.enqueueAndForget(async()=>function(s,r){q(s).Tu.add(r),r.next()}(await $a(t),n)),()=>{n.Tc(),t.asyncQueue.enqueueAndForget(async()=>function(s,r){q(s).Tu.delete(r)}(await $a(t),n))}}function SQ(t,e,n){const s=new kt;return t.asyncQueue.enqueueAndForget(async()=>{const r=await function(i){return dp(i).then(o=>o.datastore)}(t);new yQ(t.asyncQueue,r,n,e,s).run()}),s.promise}function CQ(t,e,n,s){const r=function(i,o){let a;return a=typeof i=="string"?new TextEncoder().encode(i):i,function(c,l){return new mQ(c,l)}(function(c,l){if(c instanceof Uint8Array)return bT(c,l);if(c instanceof ArrayBuffer)return bT(new Uint8Array(c),l);if(c instanceof ReadableStream)return c.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(a),o)}(n,qu(e));t.asyncQueue.enqueueAndForget(async()=>{pQ(await cw(t),r,s)})}function AQ(t,e){return t.asyncQueue.enqueue(async()=>function(n,s){const r=q(n);return r.persistence.runTransaction("Get named query","readonly",i=>r.Ds.getNamedQuery(i,s))}(await aw(t),e))}const IT=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lw(t,e,n){if(!n)throw new k(w.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function LP(t,e,n,s){if(e===!0&&s===!0)throw new k(w.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function ET(t){if(!U.isDocumentKey(t))throw new k(w.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function TT(t){if(U.isDocumentKey(t))throw new k(w.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function fp(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(n){return n.constructor?n.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":G()}function Ie(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new k(w.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=fp(t);throw new k(w.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}function FP(t,e){if(e<=0)throw new k(w.INVALID_ARGUMENT,`Function ${t}() requires a positive number, but it was: ${e}.`)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ST{constructor(e){var n;if(e.host===void 0){if(e.ssl!==void 0)throw new k(w.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(n=e.ssl)===null||n===void 0||n;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new k(w.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.useFetchStreams=!!e.useFetchStreams,LP("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling)}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ku{constructor(e,n,s){this._authCredentials=n,this._appCheckCredentials=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new ST({}),this._settingsFrozen=!1,e instanceof hr?this._databaseId=e:(this._app=e,this._databaseId=function(r){if(!Object.prototype.hasOwnProperty.apply(r.options,["projectId"]))throw new k(w.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new hr(r.options.projectId)}(e))}get app(){if(!this._app)throw new k(w.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!==void 0}_setSettings(e){if(this._settingsFrozen)throw new k(w.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new ST(e),e.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new A2;switch(n.type){case"gapi":const s=n.client;return ie(!(typeof s!="object"||s===null||!s.auth||!s.auth.getAuthHeaderValueForFirstParty)),new P2(s,n.sessionIndex||"0",n.iamToken||null);case"provider":return n.client;default:throw new k(w.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const n=IT.get(e);n&&(P("ComponentProvider","Removing Datastore"),IT.delete(e),n.terminate())}(this),Promise.resolve()}}function kQ(t,e,n,s={}){var r;const i=(t=Ie(t,Ku))._getSettings();if(i.host!=="firestore.googleapis.com"&&i.host!==e&&Wl("Host has been set in both settings() and useEmulator(), emulator host will be used"),t._setSettings(Object.assign(Object.assign({},i),{host:`${e}:${n}`,ssl:!1})),s.mockUserToken){let o,a;if(typeof s.mockUserToken=="string")o=s.mockUserToken,a=St.MOCK_USER;else{o=U_(s.mockUserToken,(r=t._app)===null||r===void 0?void 0:r.options.projectId);const c=s.mockUserToken.sub||s.mockUserToken.user_id;if(!c)throw new k(w.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");a=new St(c)}t._authCredentials=new k2(new tN(o,a))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class He{constructor(e,n,s){this.converter=n,this._key=s,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Ps(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new He(this.firestore,e,this._key)}}class en{constructor(e,n,s){this.converter=n,this._query=s,this.type="query",this.firestore=e}withConverter(e){return new en(this.firestore,e,this._query)}}class Ps extends en{constructor(e,n,s){super(e,n,rc(s)),this._path=s,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new He(this.firestore,null,new U(e))}withConverter(e){return new Ps(this.firestore,e,this._path)}}function UP(t,e,...n){if(t=N(t),lw("collection","path",e),t instanceof Ku){const s=we.fromString(e,...n);return TT(s),new Ps(t,null,s)}{if(!(t instanceof He||t instanceof Ps))throw new k(w.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const s=t._path.child(we.fromString(e,...n));return TT(s),new Ps(t.firestore,null,s)}}function RQ(t,e){if(t=Ie(t,Ku),lw("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new k(w.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new en(t,null,function(n){return new mr(we.emptyPath(),n)}(e))}function Md(t,e,...n){if(t=N(t),arguments.length===1&&(e=nN.I()),lw("doc","path",e),t instanceof Ku){const s=we.fromString(e,...n);return ET(s),new He(t,null,new U(s))}{if(!(t instanceof He||t instanceof Ps))throw new k(w.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const s=t._path.child(we.fromString(e,...n));return ET(s),new He(t.firestore,t instanceof Ps?t.converter:null,new U(s))}}function $P(t,e){return t=N(t),e=N(e),(t instanceof He||t instanceof Ps)&&(e instanceof He||e instanceof Ps)&&t.firestore===e.firestore&&t.path===e.path&&t.converter===e.converter}function VP(t,e){return t=N(t),e=N(e),t instanceof en&&e instanceof en&&t.firestore===e.firestore&&Uu(t._query,e._query)&&t.converter===e.converter}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NQ{constructor(){this.Oc=Promise.resolve(),this.Mc=[],this.Fc=!1,this.$c=[],this.Bc=null,this.Lc=!1,this.Uc=!1,this.qc=[],this.So=new Kv(this,"async_queue_retry"),this.Kc=()=>{const n=xh();n&&P("AsyncQueue","Visibility state changed to "+n.visibilityState),this.So.Eo()};const e=xh();e&&typeof e.addEventListener=="function"&&e.addEventListener("visibilitychange",this.Kc)}get isShuttingDown(){return this.Fc}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.Gc(),this.Qc(e)}enterRestrictedMode(e){if(!this.Fc){this.Fc=!0,this.Uc=e||!1;const n=xh();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.Kc)}}enqueue(e){if(this.Gc(),this.Fc)return new Promise(()=>{});const n=new kt;return this.Qc(()=>this.Fc&&this.Uc?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Mc.push(e),this.jc()))}async jc(){if(this.Mc.length!==0){try{await this.Mc[0](),this.Mc.shift(),this.So.reset()}catch(e){if(!fi(e))throw e;P("AsyncQueue","Operation failed with retryable error: "+e)}this.Mc.length>0&&this.So.Io(()=>this.jc())}}Qc(e){const n=this.Oc.then(()=>(this.Lc=!0,e().catch(s=>{this.Bc=s,this.Lc=!1;const r=function(i){let o=i.message||"";return i.stack&&(o=i.stack.includes(i.message)?i.stack:i.message+`
`+i.stack),o}(s);throw ft("INTERNAL UNHANDLED ERROR: ",r),s}).then(s=>(this.Lc=!1,s))));return this.Oc=n,n}enqueueAfterDelay(e,n,s){this.Gc(),this.qc.indexOf(e)>-1&&(n=0);const r=zv.createAndSchedule(this,e,n,s,i=>this.Wc(i));return this.$c.push(r),r}Gc(){this.Bc&&G()}verifyOperationInProgress(){}async zc(){let e;do e=this.Oc,await e;while(e!==this.Oc)}Hc(e){for(const n of this.$c)if(n.timerId===e)return!0;return!1}Jc(e){return this.zc().then(()=>{this.$c.sort((n,s)=>n.targetTimeMs-s.targetTimeMs);for(const n of this.$c)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.zc()})}Yc(e){this.qc.push(e)}Wc(e){const n=this.$c.indexOf(e);this.$c.splice(n,1)}}function e_(t){return function(e,n){if(typeof e!="object"||e===null)return!1;const s=e;for(const r of n)if(r in s&&typeof s[r]=="function")return!0;return!1}(t,["next","error","complete"])}class PQ{constructor(){this._progressObserver={},this._taskCompletionResolver=new kt,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,n,s){this._progressObserver={next:e,error:n,complete:s}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,n){return this._taskCompletionResolver.promise.then(e,n)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DQ=-1;class ot extends Ku{constructor(e,n,s){super(e,n,s),this.type="firestore",this._queue=new NQ,this._persistenceKey="name"in e?e.name:"[DEFAULT]"}_terminate(){return this._firestoreClient||BP(this),this._firestoreClient.terminate()}}function Ft(t){return t._firestoreClient||BP(t),t._firestoreClient.verifyNotTerminated(),t._firestoreClient}function BP(t){var e;const n=t._freezeSettings(),s=function(r,i,o,a){return new j2(r,i,o,a.host,a.ssl,a.experimentalForceLongPolling,a.experimentalAutoDetectLongPolling,a.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,n);t._firestoreClient=new vQ(t._authCredentials,t._appCheckCredentials,t._queue,s)}function xQ(t,e){jP(t=Ie(t,ot));const n=Ft(t),s=t._freezeSettings(),r=new iw;return qP(n,r,new RP(r,s.cacheSizeBytes,e==null?void 0:e.forceOwnership))}function OQ(t){jP(t=Ie(t,ot));const e=Ft(t),n=t._freezeSettings(),s=new iw;return qP(e,s,new gQ(s,n.cacheSizeBytes))}function qP(t,e,n){const s=new kt;return t.asyncQueue.enqueue(async()=>{try{await NP(t,n),await PP(t,e),s.resolve()}catch(r){const i=r;if(!function(o){return o.name==="FirebaseError"?o.code===w.FAILED_PRECONDITION||o.code===w.UNIMPLEMENTED:typeof DOMException!="undefined"&&o instanceof DOMException?o.code===22||o.code===20||o.code===11:!0}(i))throw i;console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+i),s.reject(i)}}).then(()=>s.promise)}function MQ(t){if(t._initialized&&!t._terminated)throw new k(w.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");const e=new kt;return t._queue.enqueueAndForgetEvenWhileRestricted(async()=>{try{await async function(n){if(!os.V())return Promise.resolve();const s=n+"main";await os.delete(s)}(Bv(t._databaseId,t._persistenceKey)),e.resolve()}catch(n){e.reject(n)}}),e.promise}function LQ(t){return function(e){const n=new kt;return e.asyncQueue.enqueueAndForget(async()=>sQ(await cw(e),n)),n.promise}(Ft(t=Ie(t,ot)))}function FQ(t){return wQ(Ft(t=Ie(t,ot)))}function UQ(t){return bQ(Ft(t=Ie(t,ot)))}function $Q(t,e){const n=Ft(t=Ie(t,ot)),s=new PQ;return CQ(n,t._databaseId,e,s),s}function VQ(t,e){return AQ(Ft(t=Ie(t,ot)),e).then(n=>n?new en(t,null,n.query):null)}function jP(t){if(t._initialized||t._terminated)throw new k(w.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oi{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new k(w.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new ct(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vs{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Vs(vt.fromBase64String(e))}catch(n){throw new k(w.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new Vs(vt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Do{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pp{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new k(w.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new k(w.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return ce(this._lat,e._lat)||ce(this._long,e._long)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BQ=/^__.*__$/;class qQ{constructor(e,n,s){this.data=e,this.fieldMask=n,this.fieldTransforms=s}toMutation(e,n){return this.fieldMask!==null?new _r(e,this.data,this.fieldMask,n,this.fieldTransforms):new ic(e,this.data,n,this.fieldTransforms)}}class KP{constructor(e,n,s){this.data=e,this.fieldMask=n,this.fieldTransforms=s}toMutation(e,n){return new _r(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function HP(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw G()}}class gp{constructor(e,n,s,r,i,o){this.settings=e,this.databaseId=n,this.wt=s,this.ignoreUndefinedProperties=r,i===void 0&&this.Xc(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Zc(){return this.settings.Zc}ta(e){return new gp(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.wt,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}ea(e){var n;const s=(n=this.path)===null||n===void 0?void 0:n.child(e),r=this.ta({path:s,na:!1});return r.sa(e),r}ia(e){var n;const s=(n=this.path)===null||n===void 0?void 0:n.child(e),r=this.ta({path:s,na:!1});return r.Xc(),r}ra(e){return this.ta({path:void 0,na:!0})}oa(e){return Ld(e,this.settings.methodName,this.settings.ua||!1,this.path,this.settings.ca)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}Xc(){if(this.path)for(let e=0;e<this.path.length;e++)this.sa(this.path.get(e))}sa(e){if(e.length===0)throw this.oa("Document fields must not be empty");if(HP(this.Zc)&&BQ.test(e))throw this.oa('Document fields cannot begin and end with "__"')}}class jQ{constructor(e,n,s){this.databaseId=e,this.ignoreUndefinedProperties=n,this.wt=s||qu(e)}aa(e,n,s,r=!1){return new gp({Zc:e,methodName:n,ca:s,path:ct.emptyPath(),na:!1,ua:r},this.databaseId,this.wt,this.ignoreUndefinedProperties)}}function xo(t){const e=t._freezeSettings(),n=qu(t._databaseId);return new jQ(t._databaseId,!!e.ignoreUndefinedProperties,n)}function mp(t,e,n,s,r,i={}){const o=t.aa(i.merge||i.mergeFields?2:0,e,n,r);fw("Data must be an object, but it was:",o,s);const a=zP(s,o);let c,l;if(i.merge)c=new Pn(o.fieldMask),l=o.fieldTransforms;else if(i.mergeFields){const u=[];for(const h of i.mergeFields){const d=t_(e,h,n);if(!o.contains(d))throw new k(w.INVALID_ARGUMENT,`Field '${d}' is specified in your field mask but missing from your input data.`);YP(u,d)||u.push(d)}c=new Pn(u),l=o.fieldTransforms.filter(h=>c.covers(h.field))}else c=null,l=o.fieldTransforms;return new qQ(new Bt(a),c,l)}class Hu extends Do{_toFieldTransform(e){if(e.Zc!==2)throw e.Zc===1?e.oa(`${this._methodName}() can only appear at the top level of your update data`):e.oa(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Hu}}function WP(t,e,n){return new gp({Zc:3,ca:e.settings.ca,methodName:t._methodName,na:n},e.databaseId,e.wt,e.ignoreUndefinedProperties)}class uw extends Do{_toFieldTransform(e){return new $u(e.path,new xa)}isEqual(e){return e instanceof uw}}class KQ extends Do{constructor(e,n){super(e),this.ha=n}_toFieldTransform(e){const n=WP(this,e,!0),s=this.ha.map(i=>Oo(i,n)),r=new po(s);return new $u(e.path,r)}isEqual(e){return this===e}}class HQ extends Do{constructor(e,n){super(e),this.ha=n}_toFieldTransform(e){const n=WP(this,e,!0),s=this.ha.map(i=>Oo(i,n)),r=new go(s);return new $u(e.path,r)}isEqual(e){return this===e}}class WQ extends Do{constructor(e,n){super(e),this.la=n}_toFieldTransform(e){const n=new Oa(e.wt,IN(e.wt,this.la));return new $u(e.path,n)}isEqual(e){return this===e}}function hw(t,e,n,s){const r=t.aa(1,e,n);fw("Data must be an object, but it was:",r,s);const i=[],o=Bt.empty();Po(s,(c,l)=>{const u=pw(e,c,n);l=N(l);const h=r.ia(u);if(l instanceof Hu)i.push(u);else{const d=Oo(l,h);d!=null&&(i.push(u),o.set(u,d))}});const a=new Pn(i);return new KP(o,a,r.fieldTransforms)}function dw(t,e,n,s,r,i){const o=t.aa(1,e,n),a=[t_(e,s,n)],c=[r];if(i.length%2!=0)throw new k(w.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let d=0;d<i.length;d+=2)a.push(t_(e,i[d])),c.push(i[d+1]);const l=[],u=Bt.empty();for(let d=a.length-1;d>=0;--d)if(!YP(l,a[d])){const f=a[d];let p=c[d];p=N(p);const _=o.ia(f);if(p instanceof Hu)l.push(f);else{const y=Oo(p,_);y!=null&&(l.push(f),u.set(f,y))}}const h=new Pn(l);return new KP(u,h,o.fieldTransforms)}function GP(t,e,n,s=!1){return Oo(n,t.aa(s?4:3,e))}function Oo(t,e){if(QP(t=N(t)))return fw("Unsupported field value:",e,t),zP(t,e);if(t instanceof Do)return function(n,s){if(!HP(s.Zc))throw s.oa(`${n._methodName}() can only be used with update() and set()`);if(!s.path)throw s.oa(`${n._methodName}() is not currently supported inside arrays`);const r=n._toFieldTransform(s);r&&s.fieldTransforms.push(r)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.na&&e.Zc!==4)throw e.oa("Nested arrays are not supported");return function(n,s){const r=[];let i=0;for(const o of n){let a=Oo(o,s.ra(i));a==null&&(a={nullValue:"NULL_VALUE"}),r.push(a),i++}return{arrayValue:{values:r}}}(t,e)}return function(n,s){if((n=N(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return IN(s.wt,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const r=Qe.fromDate(n);return{timestampValue:Xl(s.wt,r)}}if(n instanceof Qe){const r=new Qe(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:Xl(s.wt,r)}}if(n instanceof pp)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof Vs)return{bytesValue:LN(s.wt,n._byteString)};if(n instanceof He){const r=s.databaseId,i=n.firestore._databaseId;if(!i.isEqual(r))throw s.oa(`Document reference is for database ${i.projectId}/${i.database} but should be for database ${r.projectId}/${r.database}`);return{referenceValue:xv(n.firestore._databaseId||s.databaseId,n._key.path)}}throw s.oa(`Unsupported field value: ${fp(n)}`)}(t,e)}function zP(t,e){const n={};return lN(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Po(t,(s,r)=>{const i=Oo(r,e.ea(s));i!=null&&(n[s]=i)}),{mapValue:{fields:n}}}function QP(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof Qe||t instanceof pp||t instanceof Vs||t instanceof He||t instanceof Do)}function fw(t,e,n){if(!QP(n)||!function(s){return typeof s=="object"&&s!==null&&(Object.getPrototypeOf(s)===Object.prototype||Object.getPrototypeOf(s)===null)}(n)){const s=fp(n);throw s==="an object"?e.oa(t+" a custom object"):e.oa(t+" "+s)}}function t_(t,e,n){if((e=N(e))instanceof oi)return e._internalPath;if(typeof e=="string")return pw(t,e);throw Ld("Field path arguments must be of type string or ",t,!1,void 0,n)}const GQ=new RegExp("[~\\*/\\[\\]]");function pw(t,e,n){if(e.search(GQ)>=0)throw Ld(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new oi(...e.split("."))._internalPath}catch{throw Ld(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function Ld(t,e,n,s,r){const i=s&&!s.isEmpty(),o=r!==void 0;let a=`Function ${e}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(i||o)&&(c+=" (found",i&&(c+=` in field ${s}`),o&&(c+=` in document ${r}`),c+=")"),new k(w.INVALID_ARGUMENT,a+t+c)}function YP(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class su{constructor(e,n,s,r,i){this._firestore=e,this._userDataWriter=n,this._key=s,this._document=r,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new He(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new zQ(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(_p("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class zQ extends su{data(){return super.data()}}function _p(t,e){return typeof e=="string"?pw(t,e):e instanceof oi?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bi{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class dr extends su{constructor(e,n,s,r,i,o){super(e,n,s,r,o),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new ol(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const s=this._document.data.field(_p("DocumentSnapshot.get",e));if(s!==null)return this._userDataWriter.convertValue(s,n.serverTimestamps)}}}class ol extends dr{data(e={}){return super.data(e)}}class ai{constructor(e,n,s,r){this._firestore=e,this._userDataWriter=n,this._snapshot=r,this.metadata=new Bi(r.hasPendingWrites,r.fromCache),this.query=s}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(s=>{e.call(n,new ol(this._firestore,this._userDataWriter,s.key,s,new Bi(this._snapshot.mutatedKeys.has(s.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new k(w.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(s,r){if(s._snapshot.oldDocs.isEmpty()){let i=0;return s._snapshot.docChanges.map(o=>({type:"added",doc:new ol(s._firestore,s._userDataWriter,o.doc.key,o.doc,new Bi(s._snapshot.mutatedKeys.has(o.doc.key),s._snapshot.fromCache),s.query.converter),oldIndex:-1,newIndex:i++}))}{let i=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(o=>r||o.type!==3).map(o=>{const a=new ol(s._firestore,s._userDataWriter,o.doc.key,o.doc,new Bi(s._snapshot.mutatedKeys.has(o.doc.key),s._snapshot.fromCache),s.query.converter);let c=-1,l=-1;return o.type!==0&&(c=i.indexOf(o.doc.key),i=i.delete(o.doc.key)),o.type!==1&&(i=i.add(o.doc),l=i.indexOf(o.doc.key)),{type:QQ(o.type),doc:a,oldIndex:c,newIndex:l}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}}function QQ(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return G()}}function JP(t,e){return t instanceof dr&&e instanceof dr?t._firestore===e._firestore&&t._key.isEqual(e._key)&&(t._document===null?e._document===null:t._document.isEqual(e._document))&&t._converter===e._converter:t instanceof ai&&e instanceof ai&&t._firestore===e._firestore&&VP(t.query,e.query)&&t.metadata.isEqual(e.metadata)&&t._snapshot.isEqual(e._snapshot)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function XP(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new k(w.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Wu{}function Ar(t,...e){for(const n of e)t=n._apply(t);return t}class YQ extends Wu{constructor(e,n,s){super(),this.fa=e,this.da=n,this._a=s,this.type="where"}_apply(e){const n=xo(e.firestore),s=function(r,i,o,a,c,l,u){let h;if(c.isKeyField()){if(l==="array-contains"||l==="array-contains-any")throw new k(w.INVALID_ARGUMENT,`Invalid Query. You can't perform '${l}' queries on documentId().`);if(l==="in"||l==="not-in"){AT(u,l);const f=[];for(const p of u)f.push(CT(a,r,p));h={arrayValue:{values:f}}}else h=CT(a,r,u)}else l!=="in"&&l!=="not-in"&&l!=="array-contains-any"||AT(u,l),h=GP(o,i,u,l==="in"||l==="not-in");const d=qt.create(c,l,h);return function(f,p){if(p.ht()){const y=Rv(f);if(y!==null&&!y.isEqual(p.field))throw new k(w.INVALID_ARGUMENT,`Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '${y.toString()}' and '${p.field.toString()}'`);const T=kv(f);T!==null&&sD(f,p.field,T)}const _=function(y,T){for(const I of y.filters)if(T.indexOf(I.op)>=0)return I.op;return null}(f,function(y){switch(y){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}(p.op));if(_!==null)throw _===p.op?new k(w.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${p.op.toString()}' filter.`):new k(w.INVALID_ARGUMENT,`Invalid query. You cannot use '${p.op.toString()}' filters with '${_.toString()}' filters.`)}(r,d),d}(e._query,"where",n,e.firestore._databaseId,this.fa,this.da,this._a);return new en(e.firestore,e.converter,function(r,i){const o=r.filters.concat([i]);return new mr(r.path,r.collectionGroup,r.explicitOrderBy.slice(),o,r.limit,r.limitType,r.startAt,r.endAt)}(e._query,s))}}function JQ(t,e,n){const s=e,r=_p("where",t);return new YQ(r,s,n)}class XQ extends Wu{constructor(e,n){super(),this.fa=e,this.wa=n,this.type="orderBy"}_apply(e){const n=function(s,r,i){if(s.startAt!==null)throw new k(w.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(s.endAt!==null)throw new k(w.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");const o=new ua(r,i);return function(a,c){if(kv(a)===null){const l=Rv(a);l!==null&&sD(a,l,c.field)}}(s,o),o}(e._query,this.fa,this.wa);return new en(e.firestore,e.converter,function(s,r){const i=s.explicitOrderBy.concat([r]);return new mr(s.path,s.collectionGroup,i,s.filters.slice(),s.limit,s.limitType,s.startAt,s.endAt)}(e._query,n))}}function ZQ(t,e="asc"){const n=e,s=_p("orderBy",t);return new XQ(s,n)}class ZP extends Wu{constructor(e,n,s){super(),this.type=e,this.ma=n,this.ga=s}_apply(e){return new en(e.firestore,e.converter,mN(e._query,this.ma,this.ga))}}function e3(t){return FP("limit",t),new ZP("limit",t,"F")}function t3(t){return FP("limitToLast",t),new ZP("limitToLast",t,"L")}class eD extends Wu{constructor(e,n,s){super(),this.type=e,this.ya=n,this.pa=s}_apply(e){const n=nD(e,this.type,this.ya,this.pa);return new en(e.firestore,e.converter,function(s,r){return new mr(s.path,s.collectionGroup,s.explicitOrderBy.slice(),s.filters.slice(),s.limit,s.limitType,r,s.endAt)}(e._query,n))}}function n3(...t){return new eD("startAt",t,!0)}function s3(...t){return new eD("startAfter",t,!1)}class tD extends Wu{constructor(e,n,s){super(),this.type=e,this.ya=n,this.pa=s}_apply(e){const n=nD(e,this.type,this.ya,this.pa);return new en(e.firestore,e.converter,function(s,r){return new mr(s.path,s.collectionGroup,s.explicitOrderBy.slice(),s.filters.slice(),s.limit,s.limitType,s.startAt,r)}(e._query,n))}}function r3(...t){return new tD("endBefore",t,!1)}function i3(...t){return new tD("endAt",t,!0)}function nD(t,e,n,s){if(n[0]=N(n[0]),n[0]instanceof su)return function(r,i,o,a,c){if(!a)throw new k(w.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${o}().`);const l=[];for(const u of Da(r))if(u.field.isKeyField())l.push(ho(i,a.key));else{const h=a.data.field(u.field);if(Av(h))throw new k(w.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+u.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(h===null){const d=u.field.canonicalString();throw new k(w.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${d}' (used as the orderBy) does not exist.`)}l.push(h)}return new ri(l,c)}(t._query,t.firestore._databaseId,e,n[0]._document,s);{const r=xo(t.firestore);return function(i,o,a,c,l,u){const h=i.explicitOrderBy;if(l.length>h.length)throw new k(w.INVALID_ARGUMENT,`Too many arguments provided to ${c}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const d=[];for(let f=0;f<l.length;f++){const p=l[f];if(h[f].field.isKeyField()){if(typeof p!="string")throw new k(w.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${c}(), but got a ${typeof p}`);if(!Nv(i)&&p.indexOf("/")!==-1)throw new k(w.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${c}() must be a plain document ID, but '${p}' contains a slash.`);const _=i.path.child(we.fromString(p));if(!U.isDocumentKey(_))throw new k(w.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${c}() must result in a valid document path, but '${_}' is not because it contains an odd number of segments.`);const y=new U(_);d.push(ho(o,y))}else{const _=GP(a,c,p);d.push(_)}}return new ri(d,u)}(t._query,t.firestore._databaseId,r,e,n,s)}}function CT(t,e,n){if(typeof(n=N(n))=="string"){if(n==="")throw new k(w.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Nv(e)&&n.indexOf("/")!==-1)throw new k(w.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const s=e.path.child(we.fromString(n));if(!U.isDocumentKey(s))throw new k(w.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${s}' is not because it has an odd number of segments (${s.length}).`);return ho(t,new U(s))}if(n instanceof He)return ho(t,n._key);throw new k(w.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${fp(n)}.`)}function AT(t,e){if(!Array.isArray(t)||t.length===0)throw new k(w.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`);if(t.length>10)throw new k(w.INVALID_ARGUMENT,`Invalid Query. '${e.toString()}' filters support a maximum of 10 elements in the value array.`)}function sD(t,e,n){if(!n.isEqual(e))throw new k(w.INVALID_ARGUMENT,`Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '${e.toString()}' and so you must also use '${e.toString()}' as your first argument to orderBy(), but your first orderBy() is on field '${n.toString()}' instead.`)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const o3={maxAttempts:5};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gw{convertValue(e,n="none"){switch(uo(e)){case 0:return null;case 1:return e.booleanValue;case 2:return nt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(lo(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 10:return this.convertObject(e.mapValue,n);default:throw G()}}convertObject(e,n){const s={};return Po(e.fields,(r,i)=>{s[r]=this.convertValue(i,n)}),s}convertGeoPoint(e){return new pp(nt(e.latitude),nt(e.longitude))}convertArray(e,n){return(e.values||[]).map(s=>this.convertValue(s,n))}convertServerTimestamp(e,n){switch(n){case"previous":const s=uN(e);return s==null?null:this.convertValue(s,n);case"estimate":return this.convertTimestamp(zl(e));default:return null}}convertTimestamp(e){const n=ni(e);return new Qe(n.seconds,n.nanos)}convertDocumentKey(e,n){const s=we.fromString(e);ie(HN(s));const r=new hr(s.get(1),s.get(3)),i=new U(s.popFirst(5));return r.isEqual(n)||ft(`Document ${i} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yp(t,e,n){let s;return s=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,s}class a3 extends gw{constructor(e){super(),this.firestore=e}convertBytes(e){return new Vs(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new He(this.firestore,null,n)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c3{constructor(e,n){this._firestore=e,this._commitHandler=n,this._mutations=[],this._committed=!1,this._dataReader=xo(e)}set(e,n,s){this._verifyNotCommitted();const r=Or(e,this._firestore),i=yp(r.converter,n,s),o=mp(this._dataReader,"WriteBatch.set",r._key,i,r.converter!==null,s);return this._mutations.push(o.toMutation(r._key,Xe.none())),this}update(e,n,s,...r){this._verifyNotCommitted();const i=Or(e,this._firestore);let o;return o=typeof(n=N(n))=="string"||n instanceof oi?dw(this._dataReader,"WriteBatch.update",i._key,n,s,r):hw(this._dataReader,"WriteBatch.update",i._key,n),this._mutations.push(o.toMutation(i._key,Xe.exists(!0))),this}delete(e){this._verifyNotCommitted();const n=Or(e,this._firestore);return this._mutations=this._mutations.concat(new oc(n._key,Xe.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new k(w.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function Or(t,e){if((t=N(t)).firestore!==e)throw new k(w.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function l3(t){t=Ie(t,He);const e=Ie(t.firestore,ot);return OP(Ft(e),t._key).then(n=>mw(e,t,n))}class Mo extends gw{constructor(e){super(),this.firestore=e}convertBytes(e){return new Vs(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new He(this.firestore,null,n)}}function u3(t){t=Ie(t,He);const e=Ie(t.firestore,ot),n=Ft(e),s=new Mo(e);return IQ(n,t._key).then(r=>new dr(e,s,t._key,r,new Bi(r!==null&&r.hasLocalMutations,!0),t.converter))}function h3(t){t=Ie(t,He);const e=Ie(t.firestore,ot);return OP(Ft(e),t._key,{source:"server"}).then(n=>mw(e,t,n))}function d3(t){t=Ie(t,en);const e=Ie(t.firestore,ot),n=Ft(e),s=new Mo(e);return XP(t._query),MP(n,t._query).then(r=>new ai(e,s,t,r))}function f3(t){t=Ie(t,en);const e=Ie(t.firestore,ot),n=Ft(e),s=new Mo(e);return EQ(n,t._query).then(r=>new ai(e,s,t,r))}function p3(t){t=Ie(t,en);const e=Ie(t.firestore,ot),n=Ft(e),s=new Mo(e);return MP(n,t._query,{source:"server"}).then(r=>new ai(e,s,t,r))}function kT(t,e,n){t=Ie(t,He);const s=Ie(t.firestore,ot),r=yp(t.converter,e,n);return Gu(s,[mp(xo(s),"setDoc",t._key,r,t.converter!==null,n).toMutation(t._key,Xe.none())])}function RT(t,e,n,...s){t=Ie(t,He);const r=Ie(t.firestore,ot),i=xo(r);let o;return o=typeof(e=N(e))=="string"||e instanceof oi?dw(i,"updateDoc",t._key,e,n,s):hw(i,"updateDoc",t._key,e),Gu(r,[o.toMutation(t._key,Xe.exists(!0))])}function g3(t){return Gu(Ie(t.firestore,ot),[new oc(t._key,Xe.none())])}function m3(t,e){const n=Ie(t.firestore,ot),s=Md(t),r=yp(t.converter,e);return Gu(n,[mp(xo(t.firestore),"addDoc",s._key,r,t.converter!==null,{}).toMutation(s._key,Xe.exists(!1))]).then(()=>s)}function rD(t,...e){var n,s,r;t=N(t);let i={includeMetadataChanges:!1},o=0;typeof e[o]!="object"||e_(e[o])||(i=e[o],o++);const a={includeMetadataChanges:i.includeMetadataChanges};if(e_(e[o])){const h=e[o];e[o]=(n=h.next)===null||n===void 0?void 0:n.bind(h),e[o+1]=(s=h.error)===null||s===void 0?void 0:s.bind(h),e[o+2]=(r=h.complete)===null||r===void 0?void 0:r.bind(h)}let c,l,u;if(t instanceof He)l=Ie(t.firestore,ot),u=rc(t._key.path),c={next:h=>{e[o]&&e[o](mw(l,t,h))},error:e[o+1],complete:e[o+2]};else{const h=Ie(t,en);l=Ie(h.firestore,ot),u=h._query;const d=new Mo(l);c={next:f=>{e[o]&&e[o](new ai(l,d,h,f))},error:e[o+1],complete:e[o+2]},XP(t._query)}return function(h,d,f,p){const _=new hp(p),y=new Xv(d,_,f);return h.asyncQueue.enqueueAndForget(async()=>Qv(await $a(h),y)),()=>{_.Tc(),h.asyncQueue.enqueueAndForget(async()=>Yv(await $a(h),y))}}(Ft(l),u,a,c)}function _3(t,e){return TQ(Ft(t=Ie(t,ot)),e_(e)?e:{next:e})}function Gu(t,e){return function(n,s){const r=new kt;return n.asyncQueue.enqueueAndForget(async()=>Z6(await cw(n),s,r)),r.promise}(Ft(t),e)}function mw(t,e,n){const s=n.docs.get(e._key),r=new Mo(t);return new dr(t,r,e._key,s,new Bi(n.hasPendingWrites,n.fromCache),e.converter)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y3 extends class{constructor(e,n){this._firestore=e,this._transaction=n,this._dataReader=xo(e)}get(e){const n=Or(e,this._firestore),s=new a3(this._firestore);return this._transaction.lookup([n._key]).then(r=>{if(!r||r.length!==1)return G();const i=r[0];if(i.isFoundDocument())return new su(this._firestore,s,i.key,i,n.converter);if(i.isNoDocument())return new su(this._firestore,s,n._key,null,n.converter);throw G()})}set(e,n,s){const r=Or(e,this._firestore),i=yp(r.converter,n,s),o=mp(this._dataReader,"Transaction.set",r._key,i,r.converter!==null,s);return this._transaction.set(r._key,o),this}update(e,n,s,...r){const i=Or(e,this._firestore);let o;return o=typeof(n=N(n))=="string"||n instanceof oi?dw(this._dataReader,"Transaction.update",i._key,n,s,r):hw(this._dataReader,"Transaction.update",i._key,n),this._transaction.update(i._key,o),this}delete(e){const n=Or(e,this._firestore);return this._transaction.delete(n._key),this}}{constructor(e,n){super(e,n),this._firestore=e}get(e){const n=Or(e,this._firestore),s=new Mo(this._firestore);return super.get(e).then(r=>new dr(this._firestore,s,n._key,r._document,new Bi(!1,!1),n.converter))}}function v3(t,e,n){t=Ie(t,ot);const s=Object.assign(Object.assign({},o3),n);return function(r){if(r.maxAttempts<1)throw new k(w.INVALID_ARGUMENT,"Max attempts must be at least 1")}(s),SQ(Ft(t),r=>e(new y3(t,r)),s)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function w3(){return new Hu("deleteField")}function b3(){return new uw("serverTimestamp")}function I3(...t){return new KQ("arrayUnion",t)}function E3(...t){return new HQ("arrayRemove",t)}function T3(t){return new WQ("increment",t)}(function(t,e=!0){(function(n){sc=n})(Ks),rt(new Ee("firestore",(n,{options:s})=>{const r=n.getProvider("app").getImmediate(),i=new ot(r,new R2(n.getProvider("auth-internal")),new x2(n.getProvider("app-check-internal")));return s=Object.assign({useFetchStreams:e},s),i._setSettings(s),i},"PUBLIC")),Fe(AE,"3.4.12",t),Fe(AE,"3.4.12","esm2017")})();const S3="@firebase/firestore-compat",C3="0.1.21";/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _w(t,e){if(e===void 0)return{merge:!1};if(e.mergeFields!==void 0&&e.merge!==void 0)throw new k("invalid-argument",`Invalid options passed to function ${t}(): You cannot specify both "merge" and "mergeFields".`);return e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NT(){if(typeof Uint8Array=="undefined")throw new k("unimplemented","Uint8Arrays are not available in this environment.")}function PT(){if(!B2())throw new k("unimplemented","Blobs are unavailable in Firestore in this environment.")}class ru{constructor(e){this._delegate=e}static fromBase64String(e){return PT(),new ru(Vs.fromBase64String(e))}static fromUint8Array(e){return NT(),new ru(Vs.fromUint8Array(e))}toBase64(){return PT(),this._delegate.toBase64()}toUint8Array(){return NT(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function n_(t){return A3(t,["next","error","complete"])}function A3(t,e){if(typeof t!="object"||t===null)return!1;const n=t;for(const s of e)if(s in n&&typeof n[s]=="function")return!0;return!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k3{enableIndexedDbPersistence(e,n){return xQ(e._delegate,{forceOwnership:n})}enableMultiTabIndexedDbPersistence(e){return OQ(e._delegate)}clearIndexedDbPersistence(e){return MQ(e._delegate)}}class iD{constructor(e,n,s){this._delegate=n,this._persistenceProvider=s,this.INTERNAL={delete:()=>this.terminate()},e instanceof hr||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){const n=this._delegate._getSettings();!e.merge&&n.host!==e.host&&Wl("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&(e=Object.assign(Object.assign({},n),e),delete e.merge),this._delegate._setSettings(e)}useEmulator(e,n,s={}){kQ(this._delegate,e,n,s)}enableNetwork(){return FQ(this._delegate)}disableNetwork(){return UQ(this._delegate)}enablePersistence(e){let n=!1,s=!1;return e&&(n=!!e.synchronizeTabs,s=!!e.experimentalForceOwningTab,LP("synchronizeTabs",n,"experimentalForceOwningTab",s)),n?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,s)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return LQ(this._delegate)}onSnapshotsInSync(e){return _3(this._delegate,e)}get app(){if(!this._appCompat)throw new k("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new Va(this,UP(this._delegate,e))}catch(n){throw rn(n,"collection()","Firestore.collection()")}}doc(e){try{return new jn(this,Md(this._delegate,e))}catch(n){throw rn(n,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new sn(this,RQ(this._delegate,e))}catch(n){throw rn(n,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return v3(this._delegate,n=>e(new oD(this,n)))}batch(){return Ft(this._delegate),new aD(new c3(this._delegate,e=>Gu(this._delegate,e)))}loadBundle(e){return $Q(this._delegate,e)}namedQuery(e){return VQ(this._delegate,e).then(n=>n?new sn(this,n):null)}}class vp extends gw{constructor(e){super(),this.firestore=e}convertBytes(e){return new ru(new Vs(e))}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return jn.forKey(n,this.firestore,null)}}function R3(t){S2(t)}class oD{constructor(e,n){this._firestore=e,this._delegate=n,this._userDataWriter=new vp(e)}get(e){const n=qi(e);return this._delegate.get(n).then(s=>new iu(this._firestore,new dr(this._firestore._delegate,this._userDataWriter,s._key,s._document,s.metadata,n.converter)))}set(e,n,s){const r=qi(e);return s?(_w("Transaction.set",s),this._delegate.set(r,n,s)):this._delegate.set(r,n),this}update(e,n,s,...r){const i=qi(e);return arguments.length===2?this._delegate.update(i,n):this._delegate.update(i,n,s,...r),this}delete(e){const n=qi(e);return this._delegate.delete(n),this}}class aD{constructor(e){this._delegate=e}set(e,n,s){const r=qi(e);return s?(_w("WriteBatch.set",s),this._delegate.set(r,n,s)):this._delegate.set(r,n),this}update(e,n,s,...r){const i=qi(e);return arguments.length===2?this._delegate.update(i,n):this._delegate.update(i,n,s,...r),this}delete(e){const n=qi(e);return this._delegate.delete(n),this}commit(){return this._delegate.commit()}}class vo{constructor(e,n,s){this._firestore=e,this._userDataWriter=n,this._delegate=s}fromFirestore(e,n){const s=new ol(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new ou(this._firestore,s),n!=null?n:{})}toFirestore(e,n){return n?this._delegate.toFirestore(e,n):this._delegate.toFirestore(e)}static getInstance(e,n){const s=vo.INSTANCES;let r=s.get(e);r||(r=new WeakMap,s.set(e,r));let i=r.get(n);return i||(i=new vo(e,new vp(e),n),r.set(n,i)),i}}vo.INSTANCES=new WeakMap;class jn{constructor(e,n){this.firestore=e,this._delegate=n,this._userDataWriter=new vp(e)}static forPath(e,n,s){if(e.length%2!==0)throw new k("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new jn(n,new He(n._delegate,s,new U(e)))}static forKey(e,n,s){return new jn(n,new He(n._delegate,s,e))}get id(){return this._delegate.id}get parent(){return new Va(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new Va(this.firestore,UP(this._delegate,e))}catch(n){throw rn(n,"collection()","DocumentReference.collection()")}}isEqual(e){return e=N(e),e instanceof He?$P(this._delegate,e):!1}set(e,n){n=_w("DocumentReference.set",n);try{return n?kT(this._delegate,e,n):kT(this._delegate,e)}catch(s){throw rn(s,"setDoc()","DocumentReference.set()")}}update(e,n,...s){try{return arguments.length===1?RT(this._delegate,e):RT(this._delegate,e,n,...s)}catch(r){throw rn(r,"updateDoc()","DocumentReference.update()")}}delete(){return g3(this._delegate)}onSnapshot(...e){const n=cD(e),s=lD(e,r=>new iu(this.firestore,new dr(this.firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,this._delegate.converter)));return rD(this._delegate,n,s)}get(e){let n;return(e==null?void 0:e.source)==="cache"?n=u3(this._delegate):(e==null?void 0:e.source)==="server"?n=h3(this._delegate):n=l3(this._delegate),n.then(s=>new iu(this.firestore,new dr(this.firestore._delegate,this._userDataWriter,s._key,s._document,s.metadata,this._delegate.converter)))}withConverter(e){return new jn(this.firestore,e?this._delegate.withConverter(vo.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}function rn(t,e,n){return t.message=t.message.replace(e,n),t}function cD(t){for(const e of t)if(typeof e=="object"&&!n_(e))return e;return{}}function lD(t,e){var n,s;let r;return n_(t[0])?r=t[0]:n_(t[1])?r=t[1]:typeof t[0]=="function"?r={next:t[0],error:t[1],complete:t[2]}:r={next:t[1],error:t[2],complete:t[3]},{next:i=>{r.next&&r.next(e(i))},error:(n=r.error)===null||n===void 0?void 0:n.bind(r),complete:(s=r.complete)===null||s===void 0?void 0:s.bind(r)}}class iu{constructor(e,n){this._firestore=e,this._delegate=n}get ref(){return new jn(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,n){return this._delegate.get(e,n)}isEqual(e){return JP(this._delegate,e._delegate)}}class ou extends iu{data(e){const n=this._delegate.data(e);return C2(n!==void 0),n}}class sn{constructor(e,n){this.firestore=e,this._delegate=n,this._userDataWriter=new vp(e)}where(e,n,s){try{return new sn(this.firestore,Ar(this._delegate,JQ(e,n,s)))}catch(r){throw rn(r,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,n){try{return new sn(this.firestore,Ar(this._delegate,ZQ(e,n)))}catch(s){throw rn(s,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new sn(this.firestore,Ar(this._delegate,e3(e)))}catch(n){throw rn(n,"limit()","Query.limit()")}}limitToLast(e){try{return new sn(this.firestore,Ar(this._delegate,t3(e)))}catch(n){throw rn(n,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new sn(this.firestore,Ar(this._delegate,n3(...e)))}catch(n){throw rn(n,"startAt()","Query.startAt()")}}startAfter(...e){try{return new sn(this.firestore,Ar(this._delegate,s3(...e)))}catch(n){throw rn(n,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new sn(this.firestore,Ar(this._delegate,r3(...e)))}catch(n){throw rn(n,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new sn(this.firestore,Ar(this._delegate,i3(...e)))}catch(n){throw rn(n,"endAt()","Query.endAt()")}}isEqual(e){return VP(this._delegate,e._delegate)}get(e){let n;return(e==null?void 0:e.source)==="cache"?n=f3(this._delegate):(e==null?void 0:e.source)==="server"?n=p3(this._delegate):n=d3(this._delegate),n.then(s=>new s_(this.firestore,new ai(this.firestore._delegate,this._userDataWriter,this._delegate,s._snapshot)))}onSnapshot(...e){const n=cD(e),s=lD(e,r=>new s_(this.firestore,new ai(this.firestore._delegate,this._userDataWriter,this._delegate,r._snapshot)));return rD(this._delegate,n,s)}withConverter(e){return new sn(this.firestore,e?this._delegate.withConverter(vo.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}class N3{constructor(e,n){this._firestore=e,this._delegate=n}get type(){return this._delegate.type}get doc(){return new ou(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}}class s_{constructor(e,n){this._firestore=e,this._delegate=n}get query(){return new sn(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(e=>new ou(this._firestore,e))}docChanges(e){return this._delegate.docChanges(e).map(n=>new N3(this._firestore,n))}forEach(e,n){this._delegate.forEach(s=>{e.call(n,new ou(this._firestore,s))})}isEqual(e){return JP(this._delegate,e._delegate)}}class Va extends sn{constructor(e,n){super(e,n),this.firestore=e,this._delegate=n}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){const e=this._delegate.parent;return e?new jn(this.firestore,e):null}doc(e){try{return e===void 0?new jn(this.firestore,Md(this._delegate)):new jn(this.firestore,Md(this._delegate,e))}catch(n){throw rn(n,"doc()","CollectionReference.doc()")}}add(e){return m3(this._delegate,e).then(n=>new jn(this.firestore,n))}isEqual(e){return $P(this._delegate,e._delegate)}withConverter(e){return new Va(this.firestore,e?this._delegate.withConverter(vo.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}function qi(t){return Ie(t,He)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yw{constructor(...e){this._delegate=new oi(...e)}static documentId(){return new yw(ct.keyField().canonicalString())}isEqual(e){return e=N(e),e instanceof oi?this._delegate._internalPath.isEqual(e._internalPath):!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oi{constructor(e){this._delegate=e}static serverTimestamp(){const e=b3();return e._methodName="FieldValue.serverTimestamp",new Oi(e)}static delete(){const e=w3();return e._methodName="FieldValue.delete",new Oi(e)}static arrayUnion(...e){const n=I3(...e);return n._methodName="FieldValue.arrayUnion",new Oi(n)}static arrayRemove(...e){const n=E3(...e);return n._methodName="FieldValue.arrayRemove",new Oi(n)}static increment(e){const n=T3(e);return n._methodName="FieldValue.increment",new Oi(n)}isEqual(e){return this._delegate.isEqual(e._delegate)}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const P3={Firestore:iD,GeoPoint:pp,Timestamp:Qe,Blob:ru,Transaction:oD,WriteBatch:aD,DocumentReference:jn,DocumentSnapshot:iu,Query:sn,QueryDocumentSnapshot:ou,QuerySnapshot:s_,CollectionReference:Va,FieldPath:yw,FieldValue:Oi,setLogLevel:R3,CACHE_SIZE_UNLIMITED:DQ};function D3(t,e){t.INTERNAL.registerComponent(new Ee("firestore-compat",n=>{const s=n.getProvider("app-compat").getImmediate(),r=n.getProvider("firestore").getImmediate();return e(s,r)},"PUBLIC").setServiceProps(Object.assign({},P3)))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function x3(t){D3(t,(e,n)=>new iD(e,n,new k3)),t.registerVersion(S3,C3)}x3(ht);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const O3="type.googleapis.com/google.protobuf.Int64Value",M3="type.googleapis.com/google.protobuf.UInt64Value";function uD(t,e){const n={};for(const s in t)t.hasOwnProperty(s)&&(n[s]=e(t[s]));return n}function r_(t){if(t==null)return null;if(t instanceof Number&&(t=t.valueOf()),typeof t=="number"&&isFinite(t)||t===!0||t===!1||Object.prototype.toString.call(t)==="[object String]")return t;if(t instanceof Date)return t.toISOString();if(Array.isArray(t))return t.map(e=>r_(e));if(typeof t=="function"||typeof t=="object")return uD(t,e=>r_(e));throw new Error("Data cannot be encoded in JSON: "+t)}function Fd(t){if(t==null)return t;if(t["@type"])switch(t["@type"]){case O3:case M3:{const e=Number(t.value);if(isNaN(e))throw new Error("Data cannot be decoded from JSON: "+t);return e}default:throw new Error("Data cannot be decoded from JSON: "+t)}return Array.isArray(t)?t.map(e=>Fd(e)):typeof t=="function"||typeof t=="object"?uD(t,e=>Fd(e)):t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hD="functions";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DT={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class da extends ut{constructor(e,n,s){super(`${hD}/${e}`,n||""),this.details=s}}function L3(t){if(t>=200&&t<300)return"ok";switch(t){case 0:return"internal";case 400:return"invalid-argument";case 401:return"unauthenticated";case 403:return"permission-denied";case 404:return"not-found";case 409:return"aborted";case 429:return"resource-exhausted";case 499:return"cancelled";case 500:return"internal";case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline-exceeded"}return"unknown"}function F3(t,e){let n=L3(t),s=n,r;try{const i=e&&e.error;if(i){const o=i.status;if(typeof o=="string"){if(!DT[o])return new da("internal","internal");n=DT[o],s=o}const a=i.message;typeof a=="string"&&(s=a),r=i.details,r!==void 0&&(r=Fd(r))}}catch{}return n==="ok"?null:new da(n,s,r)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U3{constructor(e,n,s){this.auth=null,this.messaging=null,this.appCheck=null,this.auth=e.getImmediate({optional:!0}),this.messaging=n.getImmediate({optional:!0}),this.auth||e.get().then(r=>this.auth=r,()=>{}),this.messaging||n.get().then(r=>this.messaging=r,()=>{}),this.appCheck||s.get().then(r=>this.appCheck=r,()=>{})}async getAuthToken(){if(!!this.auth)try{const e=await this.auth.getToken();return e==null?void 0:e.accessToken}catch{return}}async getMessagingToken(){if(!(!this.messaging||!("Notification"in self)||Notification.permission!=="granted"))try{return await this.messaging.getToken()}catch{return}}async getAppCheckToken(){if(this.appCheck){const e=await this.appCheck.getToken();return e.error?null:e.token}return null}async getContext(){const e=await this.getAuthToken(),n=await this.getMessagingToken(),s=await this.getAppCheckToken();return{authToken:e,messagingToken:n,appCheckToken:s}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xT="us-central1";function $3(t){let e=null;return{promise:new Promise((n,s)=>{e=setTimeout(()=>{s(new da("deadline-exceeded","deadline-exceeded"))},t)}),cancel:()=>{e&&clearTimeout(e)}}}class V3{constructor(e,n,s,r,i=xT,o){this.app=e,this.fetchImpl=o,this.emulatorOrigin=null,this.contextProvider=new U3(n,s,r),this.cancelAllRequests=new Promise(a=>{this.deleteService=()=>Promise.resolve(a())});try{const a=new URL(i);this.customDomain=a.origin,this.region=xT}catch{this.customDomain=null,this.region=i}}_delete(){return this.deleteService()}_url(e){const n=this.app.options.projectId;return this.emulatorOrigin!==null?`${this.emulatorOrigin}/${n}/${this.region}/${e}`:this.customDomain!==null?`${this.customDomain}/${e}`:`https://${this.region}-${n}.cloudfunctions.net/${e}`}}function B3(t,e,n){t.emulatorOrigin=`http://${e}:${n}`}function q3(t,e,n){return s=>H3(t,e,s,n||{})}function j3(t,e,n){return s=>dD(t,e,s,n||{})}async function K3(t,e,n,s){n["Content-Type"]="application/json";let r;try{r=await s(t,{method:"POST",body:JSON.stringify(e),headers:n})}catch{return{status:0,json:null}}let i=null;try{i=await r.json()}catch{}return{status:r.status,json:i}}function H3(t,e,n,s){const r=t._url(e);return dD(t,r,n,s)}async function dD(t,e,n,s){n=r_(n);const r={data:n},i={},o=await t.contextProvider.getContext();o.authToken&&(i.Authorization="Bearer "+o.authToken),o.messagingToken&&(i["Firebase-Instance-ID-Token"]=o.messagingToken),o.appCheckToken!==null&&(i["X-Firebase-AppCheck"]=o.appCheckToken);const a=s.timeout||7e4,c=$3(a),l=await Promise.race([K3(e,r,i,t.fetchImpl),c.promise,t.cancelAllRequests]);if(c.cancel(),!l)throw new da("cancelled","Firebase Functions instance was deleted.");const u=F3(l.status,l.json);if(u)throw u;if(!l.json)throw new da("internal","Response is not valid JSON object.");let h=l.json.data;if(typeof h=="undefined"&&(h=l.json.result),typeof h=="undefined")throw new da("internal","Response is missing data field.");return{data:Fd(h)}}const OT="@firebase/functions",MT="0.8.4";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const W3="auth-internal",G3="app-check-internal",z3="messaging-internal";function Q3(t,e){const n=(s,{instanceIdentifier:r})=>{const i=s.getProvider("app").getImmediate(),o=s.getProvider(W3),a=s.getProvider(z3),c=s.getProvider(G3);return new V3(i,o,a,c,r,t)};rt(new Ee(hD,n,"PUBLIC").setMultipleInstances(!0)),Fe(OT,MT,e),Fe(OT,MT,"esm2017")}function LT(t,e,n){B3(N(t),e,n)}function Y3(t,e,n){return q3(N(t),e,n)}function J3(t,e,n){return j3(N(t),e,n)}Q3(fetch.bind(self));const X3="@firebase/functions-compat",Z3="0.2.4";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fD{constructor(e,n){this.app=e,this._delegate=n,this._region=this._delegate.region,this._customDomain=this._delegate.customDomain}httpsCallable(e,n){return Y3(this._delegate,e,n)}httpsCallableFromURL(e,n){return J3(this._delegate,e,n)}useFunctionsEmulator(e){const n=e.match("[a-zA-Z]+://([a-zA-Z0-9.-]+)(?::([0-9]+))?");if(n==null)throw new ut("functions","No origin provided to useFunctionsEmulator()");if(n[2]==null)throw new ut("functions","Port missing in origin provided to useFunctionsEmulator()");return LT(this._delegate,n[1],Number(n[2]))}useEmulator(e,n){return LT(this._delegate,e,n)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eY="us-central1",tY=(t,{instanceIdentifier:e})=>{const n=t.getProvider("app-compat").getImmediate(),s=t.getProvider("functions").getImmediate({identifier:e!=null?e:eY});return new fD(n,s)};function nY(){const t={Functions:fD};ht.INTERNAL.registerComponent(new Ee("functions-compat",tY,"PUBLIC").setServiceProps(t).setMultipleInstances(!0))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */nY();ht.registerVersion(X3,Z3);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sY="/firebase-messaging-sw.js",rY="/firebase-cloud-messaging-push-scope",pD="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",iY="https://fcmregistrations.googleapis.com/v1",gD="google.c.a.c_id",oY="google.c.a.c_l",aY="google.c.a.ts",cY="google.c.a.e";var FT;(function(t){t[t.DATA_MESSAGE=1]="DATA_MESSAGE",t[t.DISPLAY_NOTIFICATION=3]="DISPLAY_NOTIFICATION"})(FT||(FT={}));/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License"); you may not use this file except
 * in compliance with the License. You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software distributed under the License
 * is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express
 * or implied. See the License for the specific language governing permissions and limitations under
 * the License.
 */var au;(function(t){t.PUSH_RECEIVED="push-received",t.NOTIFICATION_CLICKED="notification-clicked"})(au||(au={}));/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ws(t){const e=new Uint8Array(t);return btoa(String.fromCharCode(...e)).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function lY(t){const e="=".repeat((4-t.length%4)%4),n=(t+e).replace(/\-/g,"+").replace(/_/g,"/"),s=atob(n),r=new Uint8Array(s.length);for(let i=0;i<s.length;++i)r[i]=s.charCodeAt(i);return r}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mg="fcm_token_details_db",uY=5,UT="fcm_token_object_Store";async function hY(t){if("databases"in indexedDB&&!(await indexedDB.databases()).map(i=>i.name).includes(mg))return null;let e=null;return(await Wa(mg,uY,{upgrade:async(s,r,i,o)=>{var a;if(r<2||!s.objectStoreNames.contains(UT))return;const c=o.objectStore(UT),l=await c.index("fcmSenderId").get(t);if(await c.clear(),!!l){if(r===2){const u=l;if(!u.auth||!u.p256dh||!u.endpoint)return;e={token:u.fcmToken,createTime:(a=u.createTime)!==null&&a!==void 0?a:Date.now(),subscriptionOptions:{auth:u.auth,p256dh:u.p256dh,endpoint:u.endpoint,swScope:u.swScope,vapidKey:typeof u.vapidKey=="string"?u.vapidKey:Ws(u.vapidKey)}}}else if(r===3){const u=l;e={token:u.fcmToken,createTime:u.createTime,subscriptionOptions:{auth:Ws(u.auth),p256dh:Ws(u.p256dh),endpoint:u.endpoint,swScope:u.swScope,vapidKey:Ws(u.vapidKey)}}}else if(r===4){const u=l;e={token:u.fcmToken,createTime:u.createTime,subscriptionOptions:{auth:Ws(u.auth),p256dh:Ws(u.p256dh),endpoint:u.endpoint,swScope:u.swScope,vapidKey:Ws(u.vapidKey)}}}}}})).close(),await sa(mg),await sa("fcm_vapid_details_db"),await sa("undefined"),dY(e)?e:null}function dY(t){if(!t||!t.subscriptionOptions)return!1;const{subscriptionOptions:e}=t;return typeof t.createTime=="number"&&t.createTime>0&&typeof t.token=="string"&&t.token.length>0&&typeof e.auth=="string"&&e.auth.length>0&&typeof e.p256dh=="string"&&e.p256dh.length>0&&typeof e.endpoint=="string"&&e.endpoint.length>0&&typeof e.swScope=="string"&&e.swScope.length>0&&typeof e.vapidKey=="string"&&e.vapidKey.length>0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fY="firebase-messaging-database",pY=1,wo="firebase-messaging-store";let _g=null;function vw(){return _g||(_g=Wa(fY,pY,{upgrade:(t,e)=>{switch(e){case 0:t.createObjectStore(wo)}}})),_g}async function mD(t){const e=bw(t),s=await(await vw()).transaction(wo).objectStore(wo).get(e);if(s)return s;{const r=await hY(t.appConfig.senderId);if(r)return await ww(t,r),r}}async function ww(t,e){const n=bw(t),r=(await vw()).transaction(wo,"readwrite");return await r.objectStore(wo).put(e,n),await r.done,e}async function gY(t){const e=bw(t),s=(await vw()).transaction(wo,"readwrite");await s.objectStore(wo).delete(e),await s.done}function bw({appConfig:t}){return t.appId}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mY={["missing-app-config-values"]:'Missing App configuration value: "{$valueName}"',["only-available-in-window"]:"This method is available in a Window context.",["only-available-in-sw"]:"This method is available in a service worker context.",["permission-default"]:"The notification permission was not granted and dismissed instead.",["permission-blocked"]:"The notification permission was not granted and blocked instead.",["unsupported-browser"]:"This browser doesn't support the API's required to use the Firebase SDK.",["indexed-db-unsupported"]:"This browser doesn't support indexedDb.open() (ex. Safari iFrame, Firefox Private Browsing, etc)",["failed-service-worker-registration"]:"We are unable to register the default service worker. {$browserErrorMessage}",["token-subscribe-failed"]:"A problem occurred while subscribing the user to FCM: {$errorInfo}",["token-subscribe-no-token"]:"FCM returned no token when subscribing the user to push.",["token-unsubscribe-failed"]:"A problem occurred while unsubscribing the user from FCM: {$errorInfo}",["token-update-failed"]:"A problem occurred while updating the user from FCM: {$errorInfo}",["token-update-no-token"]:"FCM returned no token when updating the user to push.",["use-sw-after-get-token"]:"The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.",["invalid-sw-registration"]:"The input to useServiceWorker() must be a ServiceWorkerRegistration.",["invalid-bg-handler"]:"The input to setBackgroundMessageHandler() must be a function.",["invalid-vapid-key"]:"The public VAPID key must be a string.",["use-vapid-key-after-get-token"]:"The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used."},fn=new pn("messaging","Messaging",mY);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _Y(t,e){var n;const s=await Ew(t),r=yD(e),i={method:"POST",headers:s,body:JSON.stringify(r)};let o;try{o=await(await fetch(Iw(t.appConfig),i)).json()}catch(a){throw fn.create("token-subscribe-failed",{errorInfo:(n=a)===null||n===void 0?void 0:n.toString()})}if(o.error){const a=o.error.message;throw fn.create("token-subscribe-failed",{errorInfo:a})}if(!o.token)throw fn.create("token-subscribe-no-token");return o.token}async function yY(t,e){var n;const s=await Ew(t),r=yD(e.subscriptionOptions),i={method:"PATCH",headers:s,body:JSON.stringify(r)};let o;try{o=await(await fetch(`${Iw(t.appConfig)}/${e.token}`,i)).json()}catch(a){throw fn.create("token-update-failed",{errorInfo:(n=a)===null||n===void 0?void 0:n.toString()})}if(o.error){const a=o.error.message;throw fn.create("token-update-failed",{errorInfo:a})}if(!o.token)throw fn.create("token-update-no-token");return o.token}async function _D(t,e){var n;const s=await Ew(t),r={method:"DELETE",headers:s};try{const o=await(await fetch(`${Iw(t.appConfig)}/${e}`,r)).json();if(o.error){const a=o.error.message;throw fn.create("token-unsubscribe-failed",{errorInfo:a})}}catch(i){throw fn.create("token-unsubscribe-failed",{errorInfo:(n=i)===null||n===void 0?void 0:n.toString()})}}function Iw({projectId:t}){return`${iY}/projects/${t}/registrations`}async function Ew({appConfig:t,installations:e}){const n=await e.getToken();return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t.apiKey,"x-goog-firebase-installations-auth":`FIS ${n}`})}function yD({p256dh:t,auth:e,endpoint:n,vapidKey:s}){const r={web:{endpoint:n,auth:e,p256dh:t}};return s!==pD&&(r.web.applicationPubKey=s),r}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vY=7*24*60*60*1e3;async function wY(t){const e=await IY(t.swRegistration,t.vapidKey),n={vapidKey:t.vapidKey,swScope:t.swRegistration.scope,endpoint:e.endpoint,auth:Ws(e.getKey("auth")),p256dh:Ws(e.getKey("p256dh"))},s=await mD(t.firebaseDependencies);if(s){if(EY(s.subscriptionOptions,n))return Date.now()>=s.createTime+vY?bY(t,{token:s.token,createTime:Date.now(),subscriptionOptions:n}):s.token;try{await _D(t.firebaseDependencies,s.token)}catch(r){console.warn(r)}return $T(t.firebaseDependencies,n)}else return $T(t.firebaseDependencies,n)}async function vD(t){const e=await mD(t.firebaseDependencies);e&&(await _D(t.firebaseDependencies,e.token),await gY(t.firebaseDependencies));const n=await t.swRegistration.pushManager.getSubscription();return n?n.unsubscribe():!0}async function bY(t,e){try{const n=await yY(t.firebaseDependencies,e),s=Object.assign(Object.assign({},e),{token:n,createTime:Date.now()});return await ww(t.firebaseDependencies,s),n}catch(n){throw await vD(t),n}}async function $T(t,e){const s={token:await _Y(t,e),createTime:Date.now(),subscriptionOptions:e};return await ww(t,s),s.token}async function IY(t,e){const n=await t.pushManager.getSubscription();return n||t.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:lY(e)})}function EY(t,e){const n=e.vapidKey===t.vapidKey,s=e.endpoint===t.endpoint,r=e.auth===t.auth,i=e.p256dh===t.p256dh;return n&&s&&r&&i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VT(t){const e={from:t.from,collapseKey:t.collapse_key,messageId:t.fcmMessageId};return TY(e,t),SY(e,t),CY(e,t),e}function TY(t,e){if(!e.notification)return;t.notification={};const n=e.notification.title;n&&(t.notification.title=n);const s=e.notification.body;s&&(t.notification.body=s);const r=e.notification.image;r&&(t.notification.image=r)}function SY(t,e){!e.data||(t.data=e.data)}function CY(t,e){var n,s,r,i,o;if(!e.fcmOptions&&!(!((n=e.notification)===null||n===void 0)&&n.click_action))return;t.fcmOptions={};const a=(r=(s=e.fcmOptions)===null||s===void 0?void 0:s.link)!==null&&r!==void 0?r:(i=e.notification)===null||i===void 0?void 0:i.click_action;a&&(t.fcmOptions.link=a);const c=(o=e.fcmOptions)===null||o===void 0?void 0:o.analytics_label;c&&(t.fcmOptions.analyticsLabel=c)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function AY(t){return typeof t=="object"&&!!t&&gD in t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */wD("hts/frbslgigp.ogepscmv/ieo/eaylg","tp:/ieaeogn-agolai.o/1frlglgc/o");wD("AzSCbw63g1R0nCw85jG8","Iaya3yLKwmgvh7cF0q4");function wD(t,e){const n=[];for(let s=0;s<t.length;s++)n.push(t.charAt(s)),s<e.length&&n.push(e.charAt(s));return n.join("")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kY(t){if(!t||!t.options)throw yg("App Configuration Object");if(!t.name)throw yg("App Name");const e=["projectId","apiKey","appId","messagingSenderId"],{options:n}=t;for(const s of e)if(!n[s])throw yg(s);return{appName:t.name,projectId:n.projectId,apiKey:n.apiKey,appId:n.appId,senderId:n.messagingSenderId}}function yg(t){return fn.create("missing-app-config-values",{valueName:t})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RY{constructor(e,n,s){this.deliveryMetricsExportedToBigQueryEnabled=!1,this.onBackgroundMessageHandler=null,this.onMessageHandler=null,this.logEvents=[],this.isLogServiceStarted=!1;const r=kY(e);this.firebaseDependencies={app:e,appConfig:r,installations:n,analyticsProvider:s}}_delete(){return Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function bD(t){var e;try{t.swRegistration=await navigator.serviceWorker.register(sY,{scope:rY}),t.swRegistration.update().catch(()=>{})}catch(n){throw fn.create("failed-service-worker-registration",{browserErrorMessage:(e=n)===null||e===void 0?void 0:e.message})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function NY(t,e){if(!e&&!t.swRegistration&&await bD(t),!(!e&&!!t.swRegistration)){if(!(e instanceof ServiceWorkerRegistration))throw fn.create("invalid-sw-registration");t.swRegistration=e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function PY(t,e){e?t.vapidKey=e:t.vapidKey||(t.vapidKey=pD)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ID(t,e){if(!navigator)throw fn.create("only-available-in-window");if(Notification.permission==="default"&&await Notification.requestPermission(),Notification.permission!=="granted")throw fn.create("permission-blocked");return await PY(t,e==null?void 0:e.vapidKey),await NY(t,e==null?void 0:e.serviceWorkerRegistration),wY(t)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function DY(t,e,n){const s=xY(e);(await t.firebaseDependencies.analyticsProvider.get()).logEvent(s,{message_id:n[gD],message_name:n[oY],message_time:n[aY],message_device_time:Math.floor(Date.now()/1e3)})}function xY(t){switch(t){case au.NOTIFICATION_CLICKED:return"notification_open";case au.PUSH_RECEIVED:return"notification_foreground";default:throw new Error}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function OY(t,e){const n=e.data;if(!n.isFirebaseMessaging)return;t.onMessageHandler&&n.messageType===au.PUSH_RECEIVED&&(typeof t.onMessageHandler=="function"?t.onMessageHandler(VT(n)):t.onMessageHandler.next(VT(n)));const s=n.data;AY(s)&&s[cY]==="1"&&await DY(t,n.messageType,s)}const BT="@firebase/messaging",qT="0.9.16";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MY=t=>{const e=new RY(t.getProvider("app").getImmediate(),t.getProvider("installations-internal").getImmediate(),t.getProvider("analytics-internal"));return navigator.serviceWorker.addEventListener("message",n=>OY(e,n)),e},LY=t=>{const e=t.getProvider("messaging").getImmediate();return{getToken:s=>ID(e,s)}};function FY(){rt(new Ee("messaging",MY,"PUBLIC")),rt(new Ee("messaging-internal",LY,"PRIVATE")),Fe(BT,qT),Fe(BT,qT,"esm2017")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function UY(t){if(!navigator)throw fn.create("only-available-in-window");return t.swRegistration||await bD(t),vD(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $Y(t,e){if(!navigator)throw fn.create("only-available-in-window");return t.onMessageHandler=e,()=>{t.onMessageHandler=null}}async function VY(t,e){return t=N(t),ID(t,e)}function BY(t){return t=N(t),UY(t)}function qY(t,e){return t=N(t),$Y(t,e)}FY();/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ED="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",jY="https://fcmregistrations.googleapis.com/v1",TD="FCM_MSG",KY="google.c.a.c_id",HY=3,WY=1;var Ud;(function(t){t[t.DATA_MESSAGE=1]="DATA_MESSAGE",t[t.DISPLAY_NOTIFICATION=3]="DISPLAY_NOTIFICATION"})(Ud||(Ud={}));/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License"); you may not use this file except
 * in compliance with the License. You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software distributed under the License
 * is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express
 * or implied. See the License for the specific language governing permissions and limitations under
 * the License.
 */var $d;(function(t){t.PUSH_RECEIVED="push-received",t.NOTIFICATION_CLICKED="notification-clicked"})($d||($d={}));/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gs(t){const e=new Uint8Array(t);return btoa(String.fromCharCode(...e)).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function GY(t){const e="=".repeat((4-t.length%4)%4),n=(t+e).replace(/\-/g,"+").replace(/_/g,"/"),s=atob(n),r=new Uint8Array(s.length);for(let i=0;i<s.length;++i)r[i]=s.charCodeAt(i);return r}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vg="fcm_token_details_db",zY=5,jT="fcm_token_object_Store";async function QY(t){if("databases"in indexedDB&&!(await indexedDB.databases()).map(i=>i.name).includes(vg))return null;let e=null;return(await Wa(vg,zY,{upgrade:async(s,r,i,o)=>{var a;if(r<2||!s.objectStoreNames.contains(jT))return;const c=o.objectStore(jT),l=await c.index("fcmSenderId").get(t);if(await c.clear(),!!l){if(r===2){const u=l;if(!u.auth||!u.p256dh||!u.endpoint)return;e={token:u.fcmToken,createTime:(a=u.createTime)!==null&&a!==void 0?a:Date.now(),subscriptionOptions:{auth:u.auth,p256dh:u.p256dh,endpoint:u.endpoint,swScope:u.swScope,vapidKey:typeof u.vapidKey=="string"?u.vapidKey:Gs(u.vapidKey)}}}else if(r===3){const u=l;e={token:u.fcmToken,createTime:u.createTime,subscriptionOptions:{auth:Gs(u.auth),p256dh:Gs(u.p256dh),endpoint:u.endpoint,swScope:u.swScope,vapidKey:Gs(u.vapidKey)}}}else if(r===4){const u=l;e={token:u.fcmToken,createTime:u.createTime,subscriptionOptions:{auth:Gs(u.auth),p256dh:Gs(u.p256dh),endpoint:u.endpoint,swScope:u.swScope,vapidKey:Gs(u.vapidKey)}}}}}})).close(),await sa(vg),await sa("fcm_vapid_details_db"),await sa("undefined"),YY(e)?e:null}function YY(t){if(!t||!t.subscriptionOptions)return!1;const{subscriptionOptions:e}=t;return typeof t.createTime=="number"&&t.createTime>0&&typeof t.token=="string"&&t.token.length>0&&typeof e.auth=="string"&&e.auth.length>0&&typeof e.p256dh=="string"&&e.p256dh.length>0&&typeof e.endpoint=="string"&&e.endpoint.length>0&&typeof e.swScope=="string"&&e.swScope.length>0&&typeof e.vapidKey=="string"&&e.vapidKey.length>0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JY="firebase-messaging-database",XY=1,bo="firebase-messaging-store";let wg=null;function Tw(){return wg||(wg=Wa(JY,XY,{upgrade:(t,e)=>{switch(e){case 0:t.createObjectStore(bo)}}})),wg}async function Sw(t){const e=Aw(t),s=await(await Tw()).transaction(bo).objectStore(bo).get(e);if(s)return s;{const r=await QY(t.appConfig.senderId);if(r)return await Cw(t,r),r}}async function Cw(t,e){const n=Aw(t),r=(await Tw()).transaction(bo,"readwrite");return await r.objectStore(bo).put(e,n),await r.done,e}async function ZY(t){const e=Aw(t),s=(await Tw()).transaction(bo,"readwrite");await s.objectStore(bo).delete(e),await s.done}function Aw({appConfig:t}){return t.appId}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const e5={["missing-app-config-values"]:'Missing App configuration value: "{$valueName}"',["only-available-in-window"]:"This method is available in a Window context.",["only-available-in-sw"]:"This method is available in a service worker context.",["permission-default"]:"The notification permission was not granted and dismissed instead.",["permission-blocked"]:"The notification permission was not granted and blocked instead.",["unsupported-browser"]:"This browser doesn't support the API's required to use the Firebase SDK.",["indexed-db-unsupported"]:"This browser doesn't support indexedDb.open() (ex. Safari iFrame, Firefox Private Browsing, etc)",["failed-service-worker-registration"]:"We are unable to register the default service worker. {$browserErrorMessage}",["token-subscribe-failed"]:"A problem occurred while subscribing the user to FCM: {$errorInfo}",["token-subscribe-no-token"]:"FCM returned no token when subscribing the user to push.",["token-unsubscribe-failed"]:"A problem occurred while unsubscribing the user from FCM: {$errorInfo}",["token-update-failed"]:"A problem occurred while updating the user from FCM: {$errorInfo}",["token-update-no-token"]:"FCM returned no token when updating the user to push.",["use-sw-after-get-token"]:"The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.",["invalid-sw-registration"]:"The input to useServiceWorker() must be a ServiceWorkerRegistration.",["invalid-bg-handler"]:"The input to setBackgroundMessageHandler() must be a function.",["invalid-vapid-key"]:"The public VAPID key must be a string.",["use-vapid-key-after-get-token"]:"The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used."},Ds=new pn("messaging","Messaging",e5);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function t5(t,e){var n;const s=await Rw(t),r=CD(e),i={method:"POST",headers:s,body:JSON.stringify(r)};let o;try{o=await(await fetch(kw(t.appConfig),i)).json()}catch(a){throw Ds.create("token-subscribe-failed",{errorInfo:(n=a)===null||n===void 0?void 0:n.toString()})}if(o.error){const a=o.error.message;throw Ds.create("token-subscribe-failed",{errorInfo:a})}if(!o.token)throw Ds.create("token-subscribe-no-token");return o.token}async function n5(t,e){var n;const s=await Rw(t),r=CD(e.subscriptionOptions),i={method:"PATCH",headers:s,body:JSON.stringify(r)};let o;try{o=await(await fetch(`${kw(t.appConfig)}/${e.token}`,i)).json()}catch(a){throw Ds.create("token-update-failed",{errorInfo:(n=a)===null||n===void 0?void 0:n.toString()})}if(o.error){const a=o.error.message;throw Ds.create("token-update-failed",{errorInfo:a})}if(!o.token)throw Ds.create("token-update-no-token");return o.token}async function SD(t,e){var n;const s=await Rw(t),r={method:"DELETE",headers:s};try{const o=await(await fetch(`${kw(t.appConfig)}/${e}`,r)).json();if(o.error){const a=o.error.message;throw Ds.create("token-unsubscribe-failed",{errorInfo:a})}}catch(i){throw Ds.create("token-unsubscribe-failed",{errorInfo:(n=i)===null||n===void 0?void 0:n.toString()})}}function kw({projectId:t}){return`${jY}/projects/${t}/registrations`}async function Rw({appConfig:t,installations:e}){const n=await e.getToken();return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t.apiKey,"x-goog-firebase-installations-auth":`FIS ${n}`})}function CD({p256dh:t,auth:e,endpoint:n,vapidKey:s}){const r={web:{endpoint:n,auth:e,p256dh:t}};return s!==ED&&(r.web.applicationPubKey=s),r}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const s5=7*24*60*60*1e3;async function r5(t){const e=await o5(t.swRegistration,t.vapidKey),n={vapidKey:t.vapidKey,swScope:t.swRegistration.scope,endpoint:e.endpoint,auth:Gs(e.getKey("auth")),p256dh:Gs(e.getKey("p256dh"))},s=await Sw(t.firebaseDependencies);if(s){if(a5(s.subscriptionOptions,n))return Date.now()>=s.createTime+s5?i5(t,{token:s.token,createTime:Date.now(),subscriptionOptions:n}):s.token;try{await SD(t.firebaseDependencies,s.token)}catch(r){console.warn(r)}return KT(t.firebaseDependencies,n)}else return KT(t.firebaseDependencies,n)}async function i_(t){const e=await Sw(t.firebaseDependencies);e&&(await SD(t.firebaseDependencies,e.token),await ZY(t.firebaseDependencies));const n=await t.swRegistration.pushManager.getSubscription();return n?n.unsubscribe():!0}async function i5(t,e){try{const n=await n5(t.firebaseDependencies,e),s=Object.assign(Object.assign({},e),{token:n,createTime:Date.now()});return await Cw(t.firebaseDependencies,s),n}catch(n){throw await i_(t),n}}async function KT(t,e){const s={token:await t5(t,e),createTime:Date.now(),subscriptionOptions:e};return await Cw(t,s),s.token}async function o5(t,e){const n=await t.pushManager.getSubscription();return n||t.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:GY(e)})}function a5(t,e){const n=e.vapidKey===t.vapidKey,s=e.endpoint===t.endpoint,r=e.auth===t.auth,i=e.p256dh===t.p256dh;return n&&s&&r&&i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function c5(t){const e={from:t.from,collapseKey:t.collapse_key,messageId:t.fcmMessageId};return l5(e,t),u5(e,t),h5(e,t),e}function l5(t,e){if(!e.notification)return;t.notification={};const n=e.notification.title;n&&(t.notification.title=n);const s=e.notification.body;s&&(t.notification.body=s);const r=e.notification.image;r&&(t.notification.image=r)}function u5(t,e){!e.data||(t.data=e.data)}function h5(t,e){var n,s,r,i,o;if(!e.fcmOptions&&!(!((n=e.notification)===null||n===void 0)&&n.click_action))return;t.fcmOptions={};const a=(r=(s=e.fcmOptions)===null||s===void 0?void 0:s.link)!==null&&r!==void 0?r:(i=e.notification)===null||i===void 0?void 0:i.click_action;a&&(t.fcmOptions.link=a);const c=(o=e.fcmOptions)===null||o===void 0?void 0:o.analytics_label;c&&(t.fcmOptions.analyticsLabel=c)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function d5(t){return typeof t=="object"&&!!t&&KY in t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function f5(t){return new Promise(e=>{setTimeout(e,t)})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */AD("hts/frbslgigp.ogepscmv/ieo/eaylg","tp:/ieaeogn-agolai.o/1frlglgc/o");AD("AzSCbw63g1R0nCw85jG8","Iaya3yLKwmgvh7cF0q4");async function p5(t,e){const n=g5(e,await t.firebaseDependencies.installations.getId());m5(t,n)}function g5(t,e){var n,s;const r={};return t.from&&(r.project_number=t.from),t.fcmMessageId&&(r.message_id=t.fcmMessageId),r.instance_id=e,t.notification?r.message_type=Ud.DISPLAY_NOTIFICATION.toString():r.message_type=Ud.DATA_MESSAGE.toString(),r.sdk_platform=HY.toString(),r.package_name=self.origin.replace(/(^\w+:|^)\/\//,""),t.collapse_key&&(r.collapse_key=t.collapse_key),r.event=WY.toString(),!((n=t.fcmOptions)===null||n===void 0)&&n.analytics_label&&(r.analytics_label=(s=t.fcmOptions)===null||s===void 0?void 0:s.analytics_label),r}function m5(t,e){const n={};n.event_time_ms=Math.floor(Date.now()).toString(),n.source_extension_json_proto3=JSON.stringify(e),t.logEvents.push(n)}function AD(t,e){const n=[];for(let s=0;s<t.length;s++)n.push(t.charAt(s)),s<e.length&&n.push(e.charAt(s));return n.join("")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _5(t,e){var n,s;const{newSubscription:r}=t;if(!r){await i_(e);return}const i=await Sw(e.firebaseDependencies);await i_(e),e.vapidKey=(s=(n=i==null?void 0:i.subscriptionOptions)===null||n===void 0?void 0:n.vapidKey)!==null&&s!==void 0?s:ED,await r5(e)}async function y5(t,e){const n=b5(t);if(!n)return;e.deliveryMetricsExportedToBigQueryEnabled&&await p5(e,n);const s=await kD();if(E5(s))return T5(s,n);if(n.notification&&await S5(w5(n)),!!e&&e.onBackgroundMessageHandler){const r=c5(n);typeof e.onBackgroundMessageHandler=="function"?await e.onBackgroundMessageHandler(r):e.onBackgroundMessageHandler.next(r)}}async function v5(t){var e,n;const s=(n=(e=t.notification)===null||e===void 0?void 0:e.data)===null||n===void 0?void 0:n[TD];if(s){if(t.action)return}else return;t.stopImmediatePropagation(),t.notification.close();const r=C5(s);if(!r)return;const i=new URL(r,self.location.href),o=new URL(self.location.origin);if(i.host!==o.host)return;let a=await I5(i);if(a?a=await a.focus():(a=await self.clients.openWindow(r),await f5(3e3)),!!a)return s.messageType=$d.NOTIFICATION_CLICKED,s.isFirebaseMessaging=!0,a.postMessage(s)}function w5(t){const e=Object.assign({},t.notification);return e.data={[TD]:t},e}function b5({data:t}){if(!t)return null;try{return t.json()}catch{return null}}async function I5(t){const e=await kD();for(const n of e){const s=new URL(n.url,self.location.href);if(t.host===s.host)return n}return null}function E5(t){return t.some(e=>e.visibilityState==="visible"&&!e.url.startsWith("chrome-extension://"))}function T5(t,e){e.isFirebaseMessaging=!0,e.messageType=$d.PUSH_RECEIVED;for(const n of t)n.postMessage(e)}function kD(){return self.clients.matchAll({type:"window",includeUncontrolled:!0})}function S5(t){var e;const{actions:n}=t,{maxActions:s}=Notification;return n&&s&&n.length>s&&console.warn(`This browser only supports ${s} actions. The remaining actions will not be displayed.`),self.registration.showNotification((e=t.title)!==null&&e!==void 0?e:"",t)}function C5(t){var e,n,s;const r=(n=(e=t.fcmOptions)===null||e===void 0?void 0:e.link)!==null&&n!==void 0?n:(s=t.notification)===null||s===void 0?void 0:s.click_action;return r||(d5(t.data)?self.location.origin:null)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function A5(t){if(!t||!t.options)throw bg("App Configuration Object");if(!t.name)throw bg("App Name");const e=["projectId","apiKey","appId","messagingSenderId"],{options:n}=t;for(const s of e)if(!n[s])throw bg(s);return{appName:t.name,projectId:n.projectId,apiKey:n.apiKey,appId:n.appId,senderId:n.messagingSenderId}}function bg(t){return Ds.create("missing-app-config-values",{valueName:t})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k5{constructor(e,n,s){this.deliveryMetricsExportedToBigQueryEnabled=!1,this.onBackgroundMessageHandler=null,this.onMessageHandler=null,this.logEvents=[],this.isLogServiceStarted=!1;const r=A5(e);this.firebaseDependencies={app:e,appConfig:r,installations:n,analyticsProvider:s}}_delete(){return Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const R5=t=>{const e=new k5(t.getProvider("app").getImmediate(),t.getProvider("installations-internal").getImmediate(),t.getProvider("analytics-internal"));return self.addEventListener("push",n=>{n.waitUntil(y5(n,e))}),self.addEventListener("pushsubscriptionchange",n=>{n.waitUntil(_5(n,e))}),self.addEventListener("notificationclick",n=>{n.waitUntil(v5(n))}),e};function N5(){rt(new Ee("messaging-sw",R5,"PUBLIC"))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function P5(t,e){if(self.document!==void 0)throw Ds.create("only-available-in-sw");return t.onBackgroundMessageHandler=e,()=>{t.onBackgroundMessageHandler=null}}function D5(t,e){return t=N(t),P5(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */N5();const x5="@firebase/messaging-compat",O5="0.1.16";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function M5(){return self&&"ServiceWorkerGlobalScope"in self?F5():L5()}function L5(){return typeof window!="undefined"&&In()&&af()&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")}function F5(){return In()&&"PushManager"in self&&"Notification"in self&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")}class HT{constructor(e,n){this.app=e,this._delegate=n,this.app=e,this._delegate=n}async getToken(e){return VY(this._delegate,e)}async deleteToken(){return BY(this._delegate)}onMessage(e){return qY(this._delegate,e)}onBackgroundMessage(e){return D5(this._delegate,e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const U5=t=>self&&"ServiceWorkerGlobalScope"in self?new HT(t.getProvider("app-compat").getImmediate(),t.getProvider("messaging-sw").getImmediate()):new HT(t.getProvider("app-compat").getImmediate(),t.getProvider("messaging").getImmediate()),$5={isSupported:M5};function V5(){ht.INTERNAL.registerComponent(new Ee("messaging-compat",U5,"PUBLIC").setServiceProps($5))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */V5();ht.registerVersion(x5,O5);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RD="firebasestorage.googleapis.com",ND="storageBucket",B5=2*60*1e3,q5=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class at extends ut{constructor(e,n){super(Ig(e),`Firebase Storage: ${n} (${Ig(e)})`),this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,at.prototype)}_codeEquals(e){return Ig(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}function Ig(t){return"storage/"+t}function Nw(){const t="An unknown error occurred, please check the error payload for server response.";return new at("unknown",t)}function j5(t){return new at("object-not-found","Object '"+t+"' does not exist.")}function K5(t){return new at("quota-exceeded","Quota for bucket '"+t+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function H5(){const t="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new at("unauthenticated",t)}function W5(){return new at("unauthorized-app","This app does not have permission to access Firebase Storage on this project.")}function G5(t){return new at("unauthorized","User does not have permission to access '"+t+"'.")}function z5(){return new at("retry-limit-exceeded","Max retry time for operation exceeded, please try again.")}function PD(){return new at("canceled","User canceled the upload/download.")}function Q5(t){return new at("invalid-url","Invalid URL '"+t+"'.")}function Y5(t){return new at("invalid-default-bucket","Invalid default bucket '"+t+"'.")}function J5(){return new at("no-default-bucket","No default bucket found. Did you set the '"+ND+"' property when initializing the app?")}function DD(){return new at("cannot-slice-blob","Cannot slice blob for upload. Please retry the upload.")}function X5(){return new at("server-file-wrong-size","Server recorded incorrect upload file size, please retry the upload.")}function Z5(){return new at("no-download-url","The given file does not have any download URLs.")}function fa(t){return new at("invalid-argument",t)}function xD(){return new at("app-deleted","The Firebase app was deleted.")}function OD(t){return new at("invalid-root-operation","The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function al(t,e){return new at("invalid-format","String does not match format '"+t+"': "+e)}function Rc(t){throw new at("internal-error","Internal error: "+t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jt{constructor(e,n){this.bucket=e,this.path_=n}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,n){let s;try{s=Jt.makeFromUrl(e,n)}catch{return new Jt(e,"")}if(s.path==="")return s;throw Y5(e)}static makeFromUrl(e,n){let s=null;const r="([A-Za-z0-9.\\-_]+)";function i(S){S.path.charAt(S.path.length-1)==="/"&&(S.path_=S.path_.slice(0,-1))}const o="(/(.*))?$",a=new RegExp("^gs://"+r+o,"i"),c={bucket:1,path:3};function l(S){S.path_=decodeURIComponent(S.path)}const u="v[A-Za-z0-9_]+",h=n.replace(/[.]/g,"\\."),d="(/([^?#]*).*)?$",f=new RegExp(`^https?://${h}/${u}/b/${r}/o${d}`,"i"),p={bucket:1,path:3},_=n===RD?"(?:storage.googleapis.com|storage.cloud.google.com)":n,y="([^?#]*)",T=new RegExp(`^https?://${_}/${r}/${y}`,"i"),E=[{regex:a,indices:c,postModify:i},{regex:f,indices:p,postModify:l},{regex:T,indices:{bucket:1,path:2},postModify:l}];for(let S=0;S<E.length;S++){const $=E[S],H=$.regex.exec(e);if(H){const K=H[$.indices.bucket];let F=H[$.indices.path];F||(F=""),s=new Jt(K,F),$.postModify(s);break}}if(s==null)throw Q5(e);return s}}class eJ{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tJ(t,e,n){let s=1,r=null,i=null,o=!1,a=0;function c(){return a===2}let l=!1;function u(...y){l||(l=!0,e.apply(null,y))}function h(y){r=setTimeout(()=>{r=null,t(f,c())},y)}function d(){i&&clearTimeout(i)}function f(y,...T){if(l){d();return}if(y){d(),u.call(null,y,...T);return}if(c()||o){d(),u.call(null,y,...T);return}s<64&&(s*=2);let E;a===1?(a=2,E=0):E=(s+Math.random())*1e3,h(E)}let p=!1;function _(y){p||(p=!0,d(),!l&&(r!==null?(y||(a=2),clearTimeout(r),h(0)):y||(a=1)))}return h(0),i=setTimeout(()=>{o=!0,_(!0)},n),_}function nJ(t){t(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sJ(t){return t!==void 0}function rJ(t){return typeof t=="function"}function iJ(t){return typeof t=="object"&&!Array.isArray(t)}function wp(t){return typeof t=="string"||t instanceof String}function WT(t){return Pw()&&t instanceof Blob}function Pw(){return typeof Blob!="undefined"}function o_(t,e,n,s){if(s<e)throw fa(`Invalid value for '${t}'. Expected ${e} or greater.`);if(s>n)throw fa(`Invalid value for '${t}'. Expected ${n} or less.`)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mi(t,e,n){let s=e;return n==null&&(s=`https://${e}`),`${n}://${s}/v0${t}`}function MD(t){const e=encodeURIComponent;let n="?";for(const s in t)if(t.hasOwnProperty(s)){const r=e(s)+"="+e(t[s]);n=n+r+"&"}return n=n.slice(0,-1),n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Qi;(function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"})(Qi||(Qi={}));/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oJ{constructor(e,n,s,r,i,o,a,c,l,u,h){this.url_=e,this.method_=n,this.headers_=s,this.body_=r,this.successCodes_=i,this.additionalRetryCodes_=o,this.callback_=a,this.errorCallback_=c,this.timeout_=l,this.progressCallback_=u,this.connectionFactory_=h,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((d,f)=>{this.resolve_=d,this.reject_=f,this.start_()})}start_(){const e=(s,r)=>{if(r){s(!1,new ph(!1,null,!0));return}const i=this.connectionFactory_();this.pendingConnection_=i;const o=a=>{const c=a.loaded,l=a.lengthComputable?a.total:-1;this.progressCallback_!==null&&this.progressCallback_(c,l)};this.progressCallback_!==null&&i.addUploadProgressListener(o),i.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&i.removeUploadProgressListener(o),this.pendingConnection_=null;const a=i.getErrorCode()===Qi.NO_ERROR,c=i.getStatus();if(!a||this.isRetryStatusCode_(c)){const u=i.getErrorCode()===Qi.ABORT;s(!1,new ph(!1,null,u));return}const l=this.successCodes_.indexOf(c)!==-1;s(!0,new ph(l,i))})},n=(s,r)=>{const i=this.resolve_,o=this.reject_,a=r.connection;if(r.wasSuccessCode)try{const c=this.callback_(a,a.getResponse());sJ(c)?i(c):i()}catch(c){o(c)}else if(a!==null){const c=Nw();c.serverResponse=a.getErrorText(),this.errorCallback_?o(this.errorCallback_(a,c)):o(c)}else if(r.canceled){const c=this.appDelete_?xD():PD();o(c)}else{const c=z5();o(c)}};this.canceled_?n(!1,new ph(!1,null,!0)):this.backoffId_=tJ(e,n,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&nJ(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}isRetryStatusCode_(e){const n=e>=500&&e<600,r=[408,429].indexOf(e)!==-1,i=this.additionalRetryCodes_.indexOf(e)!==-1;return n||r||i}}class ph{constructor(e,n,s){this.wasSuccessCode=e,this.connection=n,this.canceled=!!s}}function aJ(t,e){e!==null&&e.length>0&&(t.Authorization="Firebase "+e)}function cJ(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(e!=null?e:"AppManager")}function lJ(t,e){e&&(t["X-Firebase-GMPID"]=e)}function uJ(t,e){e!==null&&(t["X-Firebase-AppCheck"]=e)}function hJ(t,e,n,s,r,i){const o=MD(t.urlParams),a=t.url+o,c=Object.assign({},t.headers);return lJ(c,e),aJ(c,n),cJ(c,i),uJ(c,s),new oJ(a,t.method,c,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,r)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dJ(){return typeof BlobBuilder!="undefined"?BlobBuilder:typeof WebKitBlobBuilder!="undefined"?WebKitBlobBuilder:void 0}function fJ(...t){const e=dJ();if(e!==void 0){const n=new e;for(let s=0;s<t.length;s++)n.append(t[s]);return n.getBlob()}else{if(Pw())return new Blob(t);throw new at("unsupported-environment","This browser doesn't seem to support creating Blobs")}}function pJ(t,e,n){return t.webkitSlice?t.webkitSlice(e,n):t.mozSlice?t.mozSlice(e,n):t.slice?t.slice(e,n):null}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gJ(t){return atob(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kn={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class Eg{constructor(e,n){this.data=e,this.contentType=n||null}}function LD(t,e){switch(t){case Kn.RAW:return new Eg(FD(e));case Kn.BASE64:case Kn.BASE64URL:return new Eg(UD(t,e));case Kn.DATA_URL:return new Eg(_J(e),yJ(e))}throw Nw()}function FD(t){const e=[];for(let n=0;n<t.length;n++){let s=t.charCodeAt(n);if(s<=127)e.push(s);else if(s<=2047)e.push(192|s>>6,128|s&63);else if((s&64512)===55296)if(!(n<t.length-1&&(t.charCodeAt(n+1)&64512)===56320))e.push(239,191,189);else{const i=s,o=t.charCodeAt(++n);s=65536|(i&1023)<<10|o&1023,e.push(240|s>>18,128|s>>12&63,128|s>>6&63,128|s&63)}else(s&64512)===56320?e.push(239,191,189):e.push(224|s>>12,128|s>>6&63,128|s&63)}return new Uint8Array(e)}function mJ(t){let e;try{e=decodeURIComponent(t)}catch{throw al(Kn.DATA_URL,"Malformed data URL.")}return FD(e)}function UD(t,e){switch(t){case Kn.BASE64:{const r=e.indexOf("-")!==-1,i=e.indexOf("_")!==-1;if(r||i)throw al(t,"Invalid character '"+(r?"-":"_")+"' found: is it base64url encoded?");break}case Kn.BASE64URL:{const r=e.indexOf("+")!==-1,i=e.indexOf("/")!==-1;if(r||i)throw al(t,"Invalid character '"+(r?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let n;try{n=gJ(e)}catch{throw al(t,"Invalid character found")}const s=new Uint8Array(n.length);for(let r=0;r<n.length;r++)s[r]=n.charCodeAt(r);return s}class $D{constructor(e){this.base64=!1,this.contentType=null;const n=e.match(/^data:([^,]+)?,/);if(n===null)throw al(Kn.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const s=n[1]||null;s!=null&&(this.base64=vJ(s,";base64"),this.contentType=this.base64?s.substring(0,s.length-7):s),this.rest=e.substring(e.indexOf(",")+1)}}function _J(t){const e=new $D(t);return e.base64?UD(Kn.BASE64,e.rest):mJ(e.rest)}function yJ(t){return new $D(t).contentType}function vJ(t,e){return t.length>=e.length?t.substring(t.length-e.length)===e:!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ys{constructor(e,n){let s=0,r="";WT(e)?(this.data_=e,s=e.size,r=e.type):e instanceof ArrayBuffer?(n?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),s=this.data_.length):e instanceof Uint8Array&&(n?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),s=e.length),this.size_=s,this.type_=r}size(){return this.size_}type(){return this.type_}slice(e,n){if(WT(this.data_)){const s=this.data_,r=pJ(s,e,n);return r===null?null:new Ys(r)}else{const s=new Uint8Array(this.data_.buffer,e,n-e);return new Ys(s,!0)}}static getBlob(...e){if(Pw()){const n=e.map(s=>s instanceof Ys?s.data_:s);return new Ys(fJ.apply(null,n))}else{const n=e.map(o=>wp(o)?LD(Kn.RAW,o).data:o.data_);let s=0;n.forEach(o=>{s+=o.byteLength});const r=new Uint8Array(s);let i=0;return n.forEach(o=>{for(let a=0;a<o.length;a++)r[i++]=o[a]}),new Ys(r,!0)}}uploadData(){return this.data_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dw(t){let e;try{e=JSON.parse(t)}catch{return null}return iJ(e)?e:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wJ(t){if(t.length===0)return null;const e=t.lastIndexOf("/");return e===-1?"":t.slice(0,e)}function bJ(t,e){const n=e.split("/").filter(s=>s.length>0).join("/");return t.length===0?n:t+"/"+n}function VD(t){const e=t.lastIndexOf("/",t.length-2);return e===-1?t:t.slice(e+1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function IJ(t,e){return e}class tn{constructor(e,n,s,r){this.server=e,this.local=n||e,this.writable=!!s,this.xform=r||IJ}}let gh=null;function EJ(t){return!wp(t)||t.length<2?t:VD(t)}function bp(){if(gh)return gh;const t=[];t.push(new tn("bucket")),t.push(new tn("generation")),t.push(new tn("metageneration")),t.push(new tn("name","fullPath",!0));function e(i,o){return EJ(o)}const n=new tn("name");n.xform=e,t.push(n);function s(i,o){return o!==void 0?Number(o):o}const r=new tn("size");return r.xform=s,t.push(r),t.push(new tn("timeCreated")),t.push(new tn("updated")),t.push(new tn("md5Hash",null,!0)),t.push(new tn("cacheControl",null,!0)),t.push(new tn("contentDisposition",null,!0)),t.push(new tn("contentEncoding",null,!0)),t.push(new tn("contentLanguage",null,!0)),t.push(new tn("contentType",null,!0)),t.push(new tn("metadata","customMetadata",!0)),gh=t,gh}function TJ(t,e){function n(){const s=t.bucket,r=t.fullPath,i=new Jt(s,r);return e._makeStorageReference(i)}Object.defineProperty(t,"ref",{get:n})}function SJ(t,e,n){const s={};s.type="file";const r=n.length;for(let i=0;i<r;i++){const o=n[i];s[o.local]=o.xform(s,e[o.server])}return TJ(s,t),s}function BD(t,e,n){const s=Dw(e);return s===null?null:SJ(t,s,n)}function CJ(t,e,n,s){const r=Dw(e);if(r===null||!wp(r.downloadTokens))return null;const i=r.downloadTokens;if(i.length===0)return null;const o=encodeURIComponent;return i.split(",").map(l=>{const u=t.bucket,h=t.fullPath,d="/b/"+o(u)+"/o/"+o(h),f=mi(d,n,s),p=MD({alt:"media",token:l});return f+p})[0]}function xw(t,e){const n={},s=e.length;for(let r=0;r<s;r++){const i=e[r];i.writable&&(n[i.server]=t[i.local])}return JSON.stringify(n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GT="prefixes",zT="items";function AJ(t,e,n){const s={prefixes:[],items:[],nextPageToken:n.nextPageToken};if(n[GT])for(const r of n[GT]){const i=r.replace(/\/$/,""),o=t._makeStorageReference(new Jt(e,i));s.prefixes.push(o)}if(n[zT])for(const r of n[zT]){const i=t._makeStorageReference(new Jt(e,r.name));s.items.push(i)}return s}function kJ(t,e,n){const s=Dw(n);return s===null?null:AJ(t,e,s)}class vr{constructor(e,n,s,r){this.url=e,this.method=n,this.handler=s,this.timeout=r,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xs(t){if(!t)throw Nw()}function Ip(t,e){function n(s,r){const i=BD(t,r,e);return xs(i!==null),i}return n}function RJ(t,e){function n(s,r){const i=kJ(t,e,r);return xs(i!==null),i}return n}function NJ(t,e){function n(s,r){const i=BD(t,r,e);return xs(i!==null),CJ(i,r,t.host,t._protocol)}return n}function hc(t){function e(n,s){let r;return n.getStatus()===401?n.getErrorText().includes("Firebase App Check token is invalid")?r=W5():r=H5():n.getStatus()===402?r=K5(t.bucket):n.getStatus()===403?r=G5(t.path):r=s,r.serverResponse=s.serverResponse,r}return e}function Ep(t){const e=hc(t);function n(s,r){let i=e(s,r);return s.getStatus()===404&&(i=j5(t.path)),i.serverResponse=r.serverResponse,i}return n}function qD(t,e,n){const s=e.fullServerUrl(),r=mi(s,t.host,t._protocol),i="GET",o=t.maxOperationRetryTime,a=new vr(r,i,Ip(t,n),o);return a.errorHandler=Ep(e),a}function PJ(t,e,n,s,r){const i={};e.isRoot?i.prefix="":i.prefix=e.path+"/",n&&n.length>0&&(i.delimiter=n),s&&(i.pageToken=s),r&&(i.maxResults=r);const o=e.bucketOnlyServerUrl(),a=mi(o,t.host,t._protocol),c="GET",l=t.maxOperationRetryTime,u=new vr(a,c,RJ(t,e.bucket),l);return u.urlParams=i,u.errorHandler=hc(e),u}function DJ(t,e,n){const s=e.fullServerUrl(),r=mi(s,t.host,t._protocol),i="GET",o=t.maxOperationRetryTime,a=new vr(r,i,NJ(t,n),o);return a.errorHandler=Ep(e),a}function xJ(t,e,n,s){const r=e.fullServerUrl(),i=mi(r,t.host,t._protocol),o="PATCH",a=xw(n,s),c={"Content-Type":"application/json; charset=utf-8"},l=t.maxOperationRetryTime,u=new vr(i,o,Ip(t,s),l);return u.headers=c,u.body=a,u.errorHandler=Ep(e),u}function OJ(t,e){const n=e.fullServerUrl(),s=mi(n,t.host,t._protocol),r="DELETE",i=t.maxOperationRetryTime;function o(c,l){}const a=new vr(s,r,o,i);return a.successCodes=[200,204],a.errorHandler=Ep(e),a}function MJ(t,e){return t&&t.contentType||e&&e.type()||"application/octet-stream"}function jD(t,e,n){const s=Object.assign({},n);return s.fullPath=t.path,s.size=e.size(),s.contentType||(s.contentType=MJ(null,e)),s}function LJ(t,e,n,s,r){const i=e.bucketOnlyServerUrl(),o={"X-Goog-Upload-Protocol":"multipart"};function a(){let E="";for(let S=0;S<2;S++)E=E+Math.random().toString().slice(2);return E}const c=a();o["Content-Type"]="multipart/related; boundary="+c;const l=jD(e,s,r),u=xw(l,n),h="--"+c+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+u+`\r
--`+c+`\r
Content-Type: `+l.contentType+`\r
\r
`,d=`\r
--`+c+"--",f=Ys.getBlob(h,s,d);if(f===null)throw DD();const p={name:l.fullPath},_=mi(i,t.host,t._protocol),y="POST",T=t.maxUploadRetryTime,I=new vr(_,y,Ip(t,n),T);return I.urlParams=p,I.headers=o,I.body=f.uploadData(),I.errorHandler=hc(e),I}class Vd{constructor(e,n,s,r){this.current=e,this.total=n,this.finalized=!!s,this.metadata=r||null}}function Ow(t,e){let n=null;try{n=t.getResponseHeader("X-Goog-Upload-Status")}catch{xs(!1)}return xs(!!n&&(e||["active"]).indexOf(n)!==-1),n}function FJ(t,e,n,s,r){const i=e.bucketOnlyServerUrl(),o=jD(e,s,r),a={name:o.fullPath},c=mi(i,t.host,t._protocol),l="POST",u={"X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${s.size()}`,"X-Goog-Upload-Header-Content-Type":o.contentType,"Content-Type":"application/json; charset=utf-8"},h=xw(o,n),d=t.maxUploadRetryTime;function f(_){Ow(_);let y;try{y=_.getResponseHeader("X-Goog-Upload-URL")}catch{xs(!1)}return xs(wp(y)),y}const p=new vr(c,l,f,d);return p.urlParams=a,p.headers=u,p.body=h,p.errorHandler=hc(e),p}function UJ(t,e,n,s){const r={"X-Goog-Upload-Command":"query"};function i(l){const u=Ow(l,["active","final"]);let h=null;try{h=l.getResponseHeader("X-Goog-Upload-Size-Received")}catch{xs(!1)}h||xs(!1);const d=Number(h);return xs(!isNaN(d)),new Vd(d,s.size(),u==="final")}const o="POST",a=t.maxUploadRetryTime,c=new vr(n,o,i,a);return c.headers=r,c.errorHandler=hc(e),c}const QT=256*1024;function $J(t,e,n,s,r,i,o,a){const c=new Vd(0,0);if(o?(c.current=o.current,c.total=o.total):(c.current=0,c.total=s.size()),s.size()!==c.total)throw X5();const l=c.total-c.current;let u=l;r>0&&(u=Math.min(u,r));const h=c.current,d=h+u,p={"X-Goog-Upload-Command":u===l?"upload, finalize":"upload","X-Goog-Upload-Offset":`${c.current}`},_=s.slice(h,d);if(_===null)throw DD();function y(S,$){const H=Ow(S,["active","final"]),K=c.current+u,F=s.size();let ne;return H==="final"?ne=Ip(e,i)(S,$):ne=null,new Vd(K,F,H==="final",ne)}const T="POST",I=e.maxUploadRetryTime,E=new vr(n,T,y,I);return E.headers=p,E.body=_.uploadData(),E.progressCallback=a||null,E.errorHandler=hc(t),E}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VJ={STATE_CHANGED:"state_changed"},on={RUNNING:"running",PAUSED:"paused",SUCCESS:"success",CANCELED:"canceled",ERROR:"error"};function Tg(t){switch(t){case"running":case"pausing":case"canceling":return on.RUNNING;case"paused":return on.PAUSED;case"success":return on.SUCCESS;case"canceled":return on.CANCELED;case"error":return on.ERROR;default:return on.ERROR}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BJ{constructor(e,n,s){if(rJ(e)||n!=null||s!=null)this.next=e,this.error=n!=null?n:void 0,this.complete=s!=null?s:void 0;else{const i=e;this.next=i.next,this.error=i.error,this.complete=i.complete}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ko(t){return(...e)=>{Promise.resolve().then(()=>t(...e))}}class qJ{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=Qi.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=Qi.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=Qi.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,n,s,r){if(this.sent_)throw Rc("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(n,e,!0),r!==void 0)for(const i in r)r.hasOwnProperty(i)&&this.xhr_.setRequestHeader(i,r[i].toString());return s!==void 0?this.xhr_.send(s):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw Rc("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw Rc("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw Rc("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw Rc("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class jJ extends qJ{initXhr(){this.xhr_.responseType="text"}}function Es(){return new jJ}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KD{constructor(e,n,s=null){this._transferred=0,this._needToFetchStatus=!1,this._needToFetchMetadata=!1,this._observers=[],this._error=void 0,this._uploadUrl=void 0,this._request=void 0,this._chunkMultiplier=1,this._resolve=void 0,this._reject=void 0,this._ref=e,this._blob=n,this._metadata=s,this._mappings=bp(),this._resumable=this._shouldDoResumable(this._blob),this._state="running",this._errorHandler=r=>{this._request=void 0,this._chunkMultiplier=1,r._codeEquals("canceled")?(this._needToFetchStatus=!0,this.completeTransitions_()):(this._error=r,this._transition("error"))},this._metadataErrorHandler=r=>{this._request=void 0,r._codeEquals("canceled")?this.completeTransitions_():(this._error=r,this._transition("error"))},this._promise=new Promise((r,i)=>{this._resolve=r,this._reject=i,this._start()}),this._promise.then(null,()=>{})}_makeProgressCallback(){const e=this._transferred;return n=>this._updateProgress(e+n)}_shouldDoResumable(e){return e.size()>256*1024}_start(){this._state==="running"&&this._request===void 0&&(this._resumable?this._uploadUrl===void 0?this._createResumable():this._needToFetchStatus?this._fetchStatus():this._needToFetchMetadata?this._fetchMetadata():this._continueUpload():this._oneShotUpload())}_resolveToken(e){Promise.all([this._ref.storage._getAuthToken(),this._ref.storage._getAppCheckToken()]).then(([n,s])=>{switch(this._state){case"running":e(n,s);break;case"canceling":this._transition("canceled");break;case"pausing":this._transition("paused");break}})}_createResumable(){this._resolveToken((e,n)=>{const s=FJ(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),r=this._ref.storage._makeRequest(s,Es,e,n);this._request=r,r.getPromise().then(i=>{this._request=void 0,this._uploadUrl=i,this._needToFetchStatus=!1,this.completeTransitions_()},this._errorHandler)})}_fetchStatus(){const e=this._uploadUrl;this._resolveToken((n,s)=>{const r=UJ(this._ref.storage,this._ref._location,e,this._blob),i=this._ref.storage._makeRequest(r,Es,n,s);this._request=i,i.getPromise().then(o=>{o=o,this._request=void 0,this._updateProgress(o.current),this._needToFetchStatus=!1,o.finalized&&(this._needToFetchMetadata=!0),this.completeTransitions_()},this._errorHandler)})}_continueUpload(){const e=QT*this._chunkMultiplier,n=new Vd(this._transferred,this._blob.size()),s=this._uploadUrl;this._resolveToken((r,i)=>{let o;try{o=$J(this._ref._location,this._ref.storage,s,this._blob,e,this._mappings,n,this._makeProgressCallback())}catch(c){this._error=c,this._transition("error");return}const a=this._ref.storage._makeRequest(o,Es,r,i);this._request=a,a.getPromise().then(c=>{this._increaseMultiplier(),this._request=void 0,this._updateProgress(c.current),c.finalized?(this._metadata=c.metadata,this._transition("success")):this.completeTransitions_()},this._errorHandler)})}_increaseMultiplier(){QT*this._chunkMultiplier<32*1024*1024&&(this._chunkMultiplier*=2)}_fetchMetadata(){this._resolveToken((e,n)=>{const s=qD(this._ref.storage,this._ref._location,this._mappings),r=this._ref.storage._makeRequest(s,Es,e,n);this._request=r,r.getPromise().then(i=>{this._request=void 0,this._metadata=i,this._transition("success")},this._metadataErrorHandler)})}_oneShotUpload(){this._resolveToken((e,n)=>{const s=LJ(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),r=this._ref.storage._makeRequest(s,Es,e,n);this._request=r,r.getPromise().then(i=>{this._request=void 0,this._metadata=i,this._updateProgress(this._blob.size()),this._transition("success")},this._errorHandler)})}_updateProgress(e){const n=this._transferred;this._transferred=e,this._transferred!==n&&this._notifyObservers()}_transition(e){if(this._state!==e)switch(e){case"canceling":this._state=e,this._request!==void 0&&this._request.cancel();break;case"pausing":this._state=e,this._request!==void 0&&this._request.cancel();break;case"running":const n=this._state==="paused";this._state=e,n&&(this._notifyObservers(),this._start());break;case"paused":this._state=e,this._notifyObservers();break;case"canceled":this._error=PD(),this._state=e,this._notifyObservers();break;case"error":this._state=e,this._notifyObservers();break;case"success":this._state=e,this._notifyObservers();break}}completeTransitions_(){switch(this._state){case"pausing":this._transition("paused");break;case"canceling":this._transition("canceled");break;case"running":this._start();break}}get snapshot(){const e=Tg(this._state);return{bytesTransferred:this._transferred,totalBytes:this._blob.size(),state:e,metadata:this._metadata,task:this,ref:this._ref}}on(e,n,s,r){const i=new BJ(n||void 0,s||void 0,r||void 0);return this._addObserver(i),()=>{this._removeObserver(i)}}then(e,n){return this._promise.then(e,n)}catch(e){return this.then(null,e)}_addObserver(e){this._observers.push(e),this._notifyObserver(e)}_removeObserver(e){const n=this._observers.indexOf(e);n!==-1&&this._observers.splice(n,1)}_notifyObservers(){this._finishPromise(),this._observers.slice().forEach(n=>{this._notifyObserver(n)})}_finishPromise(){if(this._resolve!==void 0){let e=!0;switch(Tg(this._state)){case on.SUCCESS:Ko(this._resolve.bind(null,this.snapshot))();break;case on.CANCELED:case on.ERROR:const n=this._reject;Ko(n.bind(null,this._error))();break;default:e=!1;break}e&&(this._resolve=void 0,this._reject=void 0)}}_notifyObserver(e){switch(Tg(this._state)){case on.RUNNING:case on.PAUSED:e.next&&Ko(e.next.bind(e,this.snapshot))();break;case on.SUCCESS:e.complete&&Ko(e.complete.bind(e))();break;case on.CANCELED:case on.ERROR:e.error&&Ko(e.error.bind(e,this._error))();break;default:e.error&&Ko(e.error.bind(e,this._error))()}}resume(){const e=this._state==="paused"||this._state==="pausing";return e&&this._transition("running"),e}pause(){const e=this._state==="running";return e&&this._transition("pausing"),e}cancel(){const e=this._state==="running"||this._state==="pausing";return e&&this._transition("canceling"),e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Io{constructor(e,n){this._service=e,n instanceof Jt?this._location=n:this._location=Jt.makeFromUrl(n,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,n){return new Io(e,n)}get root(){const e=new Jt(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return VD(this._location.path)}get storage(){return this._service}get parent(){const e=wJ(this._location.path);if(e===null)return null;const n=new Jt(this._location.bucket,e);return new Io(this._service,n)}_throwIfRoot(e){if(this._location.path==="")throw OD(e)}}function KJ(t,e,n){return t._throwIfRoot("uploadBytesResumable"),new KD(t,new Ys(e),n)}function HJ(t){const e={prefixes:[],items:[]};return HD(t,e).then(()=>e)}async function HD(t,e,n){const r=await WD(t,{pageToken:n});e.prefixes.push(...r.prefixes),e.items.push(...r.items),r.nextPageToken!=null&&await HD(t,e,r.nextPageToken)}function WD(t,e){e!=null&&typeof e.maxResults=="number"&&o_("options.maxResults",1,1e3,e.maxResults);const n=e||{},s=PJ(t.storage,t._location,"/",n.pageToken,n.maxResults);return t.storage.makeRequestWithTokens(s,Es)}function WJ(t){t._throwIfRoot("getMetadata");const e=qD(t.storage,t._location,bp());return t.storage.makeRequestWithTokens(e,Es)}function GJ(t,e){t._throwIfRoot("updateMetadata");const n=xJ(t.storage,t._location,e,bp());return t.storage.makeRequestWithTokens(n,Es)}function zJ(t){t._throwIfRoot("getDownloadURL");const e=DJ(t.storage,t._location,bp());return t.storage.makeRequestWithTokens(e,Es).then(n=>{if(n===null)throw Z5();return n})}function QJ(t){t._throwIfRoot("deleteObject");const e=OJ(t.storage,t._location);return t.storage.makeRequestWithTokens(e,Es)}function GD(t,e){const n=bJ(t._location.path,e),s=new Jt(t._location.bucket,n);return new Io(t.storage,s)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function YJ(t){return/^[A-Za-z]+:\/\//.test(t)}function JJ(t,e){return new Io(t,e)}function zD(t,e){if(t instanceof Mw){const n=t;if(n._bucket==null)throw J5();const s=new Io(n,n._bucket);return e!=null?zD(s,e):s}else return e!==void 0?GD(t,e):t}function XJ(t,e){if(e&&YJ(e)){if(t instanceof Mw)return JJ(t,e);throw fa("To use ref(service, url), the first argument must be a Storage instance.")}else return zD(t,e)}function YT(t,e){const n=e==null?void 0:e[ND];return n==null?null:Jt.makeFromBucketSpec(n,t)}function ZJ(t,e,n,s={}){t.host=`${e}:${n}`,t._protocol="http";const{mockUserToken:r}=s;r&&(t._overrideAuthToken=typeof r=="string"?r:U_(r,t.app.options.projectId))}class Mw{constructor(e,n,s,r,i){this.app=e,this._authProvider=n,this._appCheckProvider=s,this._url=r,this._firebaseVersion=i,this._bucket=null,this._host=RD,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=B5,this._maxUploadRetryTime=q5,this._requests=new Set,r!=null?this._bucket=Jt.makeFromBucketSpec(r,this._host):this._bucket=YT(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=Jt.makeFromBucketSpec(this._url,e):this._bucket=YT(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){o_("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){o_("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const n=await e.getToken();if(n!==null)return n.accessToken}return null}async _getAppCheckToken(){const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Io(this,e)}_makeRequest(e,n,s,r){if(this._deleted)return new eJ(xD());{const i=hJ(e,this._appId,s,r,n,this._firebaseVersion);return this._requests.add(i),i.getPromise().then(()=>this._requests.delete(i),()=>this._requests.delete(i)),i}}async makeRequestWithTokens(e,n){const[s,r]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,n,s,r).getPromise()}}const JT="@firebase/storage",XT="0.9.9";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eX="storage";function tX(t,e,n){return t=N(t),KJ(t,e,n)}function nX(t){return t=N(t),WJ(t)}function sX(t,e){return t=N(t),GJ(t,e)}function rX(t,e){return t=N(t),WD(t,e)}function iX(t){return t=N(t),HJ(t)}function oX(t){return t=N(t),zJ(t)}function aX(t){return t=N(t),QJ(t)}function ZT(t,e){return t=N(t),XJ(t,e)}function cX(t,e){return GD(t,e)}function lX(t,e,n,s={}){ZJ(t,e,n,s)}function uX(t,{instanceIdentifier:e}){const n=t.getProvider("app").getImmediate(),s=t.getProvider("auth-internal"),r=t.getProvider("app-check-internal");return new Mw(n,s,r,e,Ks)}function hX(){rt(new Ee(eX,uX,"PUBLIC").setMultipleInstances(!0)),Fe(JT,XT,""),Fe(JT,XT,"esm2017")}hX();/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mh{constructor(e,n,s){this._delegate=e,this.task=n,this.ref=s}get bytesTransferred(){return this._delegate.bytesTransferred}get metadata(){return this._delegate.metadata}get state(){return this._delegate.state}get totalBytes(){return this._delegate.totalBytes}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eS{constructor(e,n){this._delegate=e,this._ref=n,this.cancel=this._delegate.cancel.bind(this._delegate),this.catch=this._delegate.catch.bind(this._delegate),this.pause=this._delegate.pause.bind(this._delegate),this.resume=this._delegate.resume.bind(this._delegate)}get snapshot(){return new mh(this._delegate.snapshot,this,this._ref)}then(e,n){return this._delegate.then(s=>{if(e)return e(new mh(s,this,this._ref))},n)}on(e,n,s,r){let i;return n&&(typeof n=="function"?i=o=>n(new mh(o,this,this._ref)):i={next:n.next?o=>n.next(new mh(o,this,this._ref)):void 0,complete:n.complete||void 0,error:n.error||void 0}),this._delegate.on(e,i,s||void 0,r||void 0)}}class tS{constructor(e,n){this._delegate=e,this._service=n}get prefixes(){return this._delegate.prefixes.map(e=>new ir(e,this._service))}get items(){return this._delegate.items.map(e=>new ir(e,this._service))}get nextPageToken(){return this._delegate.nextPageToken||null}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *  http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ir{constructor(e,n){this._delegate=e,this.storage=n}get name(){return this._delegate.name}get bucket(){return this._delegate.bucket}get fullPath(){return this._delegate.fullPath}toString(){return this._delegate.toString()}child(e){const n=cX(this._delegate,e);return new ir(n,this.storage)}get root(){return new ir(this._delegate.root,this.storage)}get parent(){const e=this._delegate.parent;return e==null?null:new ir(e,this.storage)}put(e,n){return this._throwIfRoot("put"),new eS(tX(this._delegate,e,n),this)}putString(e,n=Kn.RAW,s){this._throwIfRoot("putString");const r=LD(n,e),i=Object.assign({},s);return i.contentType==null&&r.contentType!=null&&(i.contentType=r.contentType),new eS(new KD(this._delegate,new Ys(r.data,!0),i),this)}listAll(){return iX(this._delegate).then(e=>new tS(e,this.storage))}list(e){return rX(this._delegate,e||void 0).then(n=>new tS(n,this.storage))}getMetadata(){return nX(this._delegate)}updateMetadata(e){return sX(this._delegate,e)}getDownloadURL(){return oX(this._delegate)}delete(){return this._throwIfRoot("delete"),aX(this._delegate)}_throwIfRoot(e){if(this._delegate._location.path==="")throw OD(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QD{constructor(e,n){this.app=e,this._delegate=n}get maxOperationRetryTime(){return this._delegate.maxOperationRetryTime}get maxUploadRetryTime(){return this._delegate.maxUploadRetryTime}ref(e){if(nS(e))throw fa("ref() expected a child path but got a URL, use refFromURL instead.");return new ir(ZT(this._delegate,e),this)}refFromURL(e){if(!nS(e))throw fa("refFromURL() expected a full URL but got a child path, use ref() instead.");try{Jt.makeFromUrl(e,this._delegate.host)}catch{throw fa("refFromUrl() expected a valid full URL but got an invalid one.")}return new ir(ZT(this._delegate,e),this)}setMaxUploadRetryTime(e){this._delegate.maxUploadRetryTime=e}setMaxOperationRetryTime(e){this._delegate.maxOperationRetryTime=e}useEmulator(e,n,s={}){lX(this._delegate,e,n,s)}}function nS(t){return/^[A-Za-z]+:\/\//.test(t)}const dX="@firebase/storage-compat",fX="0.1.17";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pX="storage-compat";function gX(t,{instanceIdentifier:e}){const n=t.getProvider("app-compat").getImmediate(),s=t.getProvider("storage").getImmediate({identifier:e});return new QD(n,s)}function mX(t){const e={TaskState:on,TaskEvent:VJ,StringFormat:Kn,Storage:QD,Reference:ir};t.INTERNAL.registerComponent(new Ee(pX,gX,"PUBLIC").setServiceProps(e).setMultipleInstances(!0)),t.registerVersion(dX,fX)}mX(ht);const sS="@firebase/performance",a_="0.5.12";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YD=a_,_X="FB-PERF-TRACE-START",yX="FB-PERF-TRACE-STOP",c_="FB-PERF-TRACE-MEASURE",JD="_wt_",XD="_fp",ZD="_fcp",ex="_fid",tx="@firebase/performance/config",nx="@firebase/performance/configexpire",vX="performance",sx="Performance";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wX={["trace started"]:"Trace {$traceName} was started before.",["trace stopped"]:"Trace {$traceName} is not running.",["nonpositive trace startTime"]:"Trace {$traceName} startTime should be positive.",["nonpositive trace duration"]:"Trace {$traceName} duration should be positive.",["no window"]:"Window is not available.",["no app id"]:"App id is not available.",["no project id"]:"Project id is not available.",["no api key"]:"Api key is not available.",["invalid cc log"]:"Attempted to queue invalid cc event",["FB not default"]:"Performance can only start when Firebase app instance is the default one.",["RC response not ok"]:"RC response is not ok",["invalid attribute name"]:"Attribute name {$attributeName} is invalid.",["invalid attribute value"]:"Attribute value {$attributeValue} is invalid.",["invalid custom metric name"]:"Custom metric name {$customMetricName} is invalid",["invalid String merger input"]:"Input for String merger is invalid, contact support team to resolve.",["already initialized"]:"initializePerformance() has already been called with different options. To avoid this error, call initializePerformance() with the same options as when it was originally called, or call getPerformance() to return the already initialized instance."},Yt=new pn(vX,sx,wX);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bs=new js(sx);Bs.logLevel=fe.INFO;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Sg,rx;class Nt{constructor(e){if(this.window=e,!e)throw Yt.create("no window");this.performance=e.performance,this.PerformanceObserver=e.PerformanceObserver,this.windowLocation=e.location,this.navigator=e.navigator,this.document=e.document,this.navigator&&this.navigator.cookieEnabled&&(this.localStorage=e.localStorage),e.perfMetrics&&e.perfMetrics.onFirstInputDelay&&(this.onFirstInputDelay=e.perfMetrics.onFirstInputDelay)}getUrl(){return this.windowLocation.href.split("?")[0]}mark(e){!this.performance||!this.performance.mark||this.performance.mark(e)}measure(e,n,s){!this.performance||!this.performance.measure||this.performance.measure(e,n,s)}getEntriesByType(e){return!this.performance||!this.performance.getEntriesByType?[]:this.performance.getEntriesByType(e)}getEntriesByName(e){return!this.performance||!this.performance.getEntriesByName?[]:this.performance.getEntriesByName(e)}getTimeOrigin(){return this.performance&&(this.performance.timeOrigin||this.performance.timing.navigationStart)}requiredApisAvailable(){return!fetch||!Promise||!af()?(Bs.info("Firebase Performance cannot start if browser does not support fetch and Promise or cookie is disabled."),!1):In()?!0:(Bs.info("IndexedDB is not supported by current browswer"),!1)}setupObserver(e,n){if(!this.PerformanceObserver)return;new this.PerformanceObserver(r=>{for(const i of r.getEntries())n(i)}).observe({entryTypes:[e]})}static getInstance(){return Sg===void 0&&(Sg=new Nt(rx)),Sg}}function bX(t){rx=t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ix;function IX(t){const e=t.getId();return e.then(n=>{ix=n}),e}function Lw(){return ix}function EX(t){const e=t.getToken();return e.then(n=>{}),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rS(t,e){const n=t.length-e.length;if(n<0||n>1)throw Yt.create("invalid String merger input");const s=[];for(let r=0;r<t.length;r++)s.push(t.charAt(r)),e.length>r&&s.push(e.charAt(r));return s.join("")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Cg;class Nn{constructor(){this.instrumentationEnabled=!0,this.dataCollectionEnabled=!0,this.loggingEnabled=!1,this.tracesSamplingRate=1,this.networkRequestsSamplingRate=1,this.logEndPointUrl="https://firebaselogging.googleapis.com/v0cc/log?format=json_proto",this.flTransportEndpointUrl=rS("hts/frbslgigp.ogepscmv/ieo/eaylg","tp:/ieaeogn-agolai.o/1frlglgc/o"),this.transportKey=rS("AzSC8r6ReiGqFMyfvgow","Iayx0u-XT3vksVM-pIV"),this.logSource=462,this.logTraceAfterSampling=!1,this.logNetworkAfterSampling=!1,this.configTimeToLive=12}getFlTransportFullUrl(){return this.flTransportEndpointUrl.concat("?key=",this.transportKey)}static getInstance(){return Cg===void 0&&(Cg=new Nn),Cg}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var pa;(function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.VISIBLE=1]="VISIBLE",t[t.HIDDEN=2]="HIDDEN"})(pa||(pa={}));const TX=["firebase_","google_","ga_"],SX=new RegExp("^[a-zA-Z]\\w*$"),CX=40,AX=100;function kX(){const t=Nt.getInstance().navigator;return"serviceWorker"in t?t.serviceWorker.controller?2:3:1}function ox(){switch(Nt.getInstance().document.visibilityState){case"visible":return pa.VISIBLE;case"hidden":return pa.HIDDEN;default:return pa.UNKNOWN}}function RX(){const e=Nt.getInstance().navigator.connection;switch(e&&e.effectiveType){case"slow-2g":return 1;case"2g":return 2;case"3g":return 3;case"4g":return 4;default:return 0}}function NX(t){return t.length===0||t.length>CX?!1:!TX.some(n=>t.startsWith(n))&&!!t.match(SX)}function PX(t){return t.length!==0&&t.length<=AX}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ax(t){var e;const n=(e=t.options)===null||e===void 0?void 0:e.appId;if(!n)throw Yt.create("no app id");return n}function DX(t){var e;const n=(e=t.options)===null||e===void 0?void 0:e.projectId;if(!n)throw Yt.create("no project id");return n}function xX(t){var e;const n=(e=t.options)===null||e===void 0?void 0:e.apiKey;if(!n)throw Yt.create("no api key");return n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OX="0.0.1",Zn={loggingEnabled:!0},MX="FIREBASE_INSTALLATIONS_AUTH";function LX(t,e){const n=FX();return n?(iS(n),Promise.resolve()):VX(t,e).then(iS).then(s=>UX(s),()=>{})}function FX(){const t=Nt.getInstance().localStorage;if(!t)return;const e=t.getItem(nx);if(!e||!BX(e))return;const n=t.getItem(tx);if(!!n)try{return JSON.parse(n)}catch{return}}function UX(t){const e=Nt.getInstance().localStorage;!t||!e||(e.setItem(tx,JSON.stringify(t)),e.setItem(nx,String(Date.now()+Nn.getInstance().configTimeToLive*60*60*1e3)))}const $X="Could not fetch config, will use default configs";function VX(t,e){return EX(t.installations).then(n=>{const s=DX(t.app),r=xX(t.app),i=`https://firebaseremoteconfig.googleapis.com/v1/projects/${s}/namespaces/fireperf:fetch?key=${r}`,o=new Request(i,{method:"POST",headers:{Authorization:`${MX} ${n}`},body:JSON.stringify({app_instance_id:e,app_instance_id_token:n,app_id:ax(t.app),app_version:YD,sdk_version:OX})});return fetch(o).then(a=>{if(a.ok)return a.json();throw Yt.create("RC response not ok")})}).catch(()=>{Bs.info($X)})}function iS(t){if(!t)return t;const e=Nn.getInstance(),n=t.entries||{};return n.fpr_enabled!==void 0?e.loggingEnabled=String(n.fpr_enabled)==="true":e.loggingEnabled=Zn.loggingEnabled,n.fpr_log_source?e.logSource=Number(n.fpr_log_source):Zn.logSource&&(e.logSource=Zn.logSource),n.fpr_log_endpoint_url?e.logEndPointUrl=n.fpr_log_endpoint_url:Zn.logEndPointUrl&&(e.logEndPointUrl=Zn.logEndPointUrl),n.fpr_log_transport_key?e.transportKey=n.fpr_log_transport_key:Zn.transportKey&&(e.transportKey=Zn.transportKey),n.fpr_vc_network_request_sampling_rate!==void 0?e.networkRequestsSamplingRate=Number(n.fpr_vc_network_request_sampling_rate):Zn.networkRequestsSamplingRate!==void 0&&(e.networkRequestsSamplingRate=Zn.networkRequestsSamplingRate),n.fpr_vc_trace_sampling_rate!==void 0?e.tracesSamplingRate=Number(n.fpr_vc_trace_sampling_rate):Zn.tracesSamplingRate!==void 0&&(e.tracesSamplingRate=Zn.tracesSamplingRate),e.logTraceAfterSampling=oS(e.tracesSamplingRate),e.logNetworkAfterSampling=oS(e.networkRequestsSamplingRate),t}function BX(t){return Number(t)>Date.now()}function oS(t){return Math.random()<=t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Fw=1,Ag;function cx(t){return Fw=2,Ag=Ag||jX(t),Ag}function qX(){return Fw===3}function jX(t){return KX().then(()=>IX(t.installations)).then(e=>LX(t,e)).then(()=>aS(),()=>aS())}function KX(){const t=Nt.getInstance().document;return new Promise(e=>{if(t&&t.readyState!=="complete"){const n=()=>{t.readyState==="complete"&&(t.removeEventListener("readystatechange",n),e())};t.addEventListener("readystatechange",n)}else e()})}function aS(){Fw=3}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Uw=10*1e3,HX=5.5*1e3,lx=3,WX=1e3;let Bd=lx,Wr=[],cS=!1;function GX(){cS||(Tp(HX),cS=!0)}function Tp(t){setTimeout(()=>{if(Bd!==0){if(!Wr.length)return Tp(Uw);zX()}},t)}function zX(){const t=Wr.splice(0,WX),e=t.map(s=>({source_extension_json_proto3:s.message,event_time_ms:String(s.eventTime)})),n={request_time_ms:String(Date.now()),client_info:{client_type:1,js_client_info:{}},log_source:Nn.getInstance().logSource,log_event:e};QX(n,t).catch(()=>{Wr=[...t,...Wr],Bd--,Bs.info(`Tries left: ${Bd}.`),Tp(Uw)})}function QX(t,e){return YX(t).then(n=>(n.ok||Bs.info("Call to Firebase backend failed."),n.json())).then(n=>{const s=Number(n.nextRequestWaitMillis);let r=Uw;isNaN(s)||(r=Math.max(s,r));const i=n.logResponseDetails;Array.isArray(i)&&i.length>0&&i[0].responseAction==="RETRY_REQUEST_LATER"&&(Wr=[...e,...Wr],Bs.info("Retry transport request later.")),Bd=lx,Tp(r)})}function YX(t){const e=Nn.getInstance().getFlTransportFullUrl();return fetch(e,{method:"POST",body:JSON.stringify(t)})}function JX(t){if(!t.eventTime||!t.message)throw Yt.create("invalid cc log");Wr=[...Wr,t]}function XX(t){return(...e)=>{const n=t(...e);JX({message:n,eventTime:Date.now()})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let kg;function ux(t,e){kg||(kg=XX(e8)),kg(t,e)}function _h(t){const e=Nn.getInstance();!e.instrumentationEnabled&&t.isAuto||!e.dataCollectionEnabled&&!t.isAuto||!Nt.getInstance().requiredApisAvailable()||t.isAuto&&ox()!==pa.VISIBLE||(qX()?Rg(t):cx(t.performanceController).then(()=>Rg(t),()=>Rg(t)))}function Rg(t){if(!Lw())return;const e=Nn.getInstance();!e.loggingEnabled||!e.logTraceAfterSampling||setTimeout(()=>ux(t,1),0)}function ZX(t){const e=Nn.getInstance();if(!e.instrumentationEnabled)return;const n=t.url,s=e.logEndPointUrl.split("?")[0],r=e.flTransportEndpointUrl.split("?")[0];n===s||n===r||!e.loggingEnabled||!e.logNetworkAfterSampling||setTimeout(()=>ux(t,0),0)}function e8(t,e){return e===0?t8(t):n8(t)}function t8(t){const e={url:t.url,http_method:t.httpMethod||0,http_response_code:200,response_payload_bytes:t.responsePayloadBytes,client_start_time_us:t.startTimeUs,time_to_response_initiated_us:t.timeToResponseInitiatedUs,time_to_response_completed_us:t.timeToResponseCompletedUs},n={application_info:hx(t.performanceController.app),network_request_metric:e};return JSON.stringify(n)}function n8(t){const e={name:t.name,is_auto:t.isAuto,client_start_time_us:t.startTimeUs,duration_us:t.durationUs};Object.keys(t.counters).length!==0&&(e.counters=t.counters);const n=t.getAttributes();Object.keys(n).length!==0&&(e.custom_attributes=n);const s={application_info:hx(t.performanceController.app),trace_metric:e};return JSON.stringify(s)}function hx(t){return{google_app_id:ax(t),app_instance_id:Lw(),web_app_info:{sdk_version:YD,page_url:Nt.getInstance().getUrl(),service_worker_status:kX(),visibility_state:ox(),effective_connection_type:RX()},application_process_state:0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const s8=100,r8="_",i8=[XD,ZD,ex];function o8(t,e){return t.length===0||t.length>s8?!1:e&&e.startsWith(JD)&&i8.indexOf(t)>-1||!t.startsWith(r8)}function a8(t){const e=Math.floor(t);return e<t&&Bs.info(`Metric value should be an Integer, setting the value as : ${e}.`),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gr{constructor(e,n,s=!1,r){this.performanceController=e,this.name=n,this.isAuto=s,this.state=1,this.customAttributes={},this.counters={},this.api=Nt.getInstance(),this.randomId=Math.floor(Math.random()*1e6),this.isAuto||(this.traceStartMark=`${_X}-${this.randomId}-${this.name}`,this.traceStopMark=`${yX}-${this.randomId}-${this.name}`,this.traceMeasure=r||`${c_}-${this.randomId}-${this.name}`,r&&this.calculateTraceMetrics())}start(){if(this.state!==1)throw Yt.create("trace started",{traceName:this.name});this.api.mark(this.traceStartMark),this.state=2}stop(){if(this.state!==2)throw Yt.create("trace stopped",{traceName:this.name});this.state=3,this.api.mark(this.traceStopMark),this.api.measure(this.traceMeasure,this.traceStartMark,this.traceStopMark),this.calculateTraceMetrics(),_h(this)}record(e,n,s){if(e<=0)throw Yt.create("nonpositive trace startTime",{traceName:this.name});if(n<=0)throw Yt.create("nonpositive trace duration",{traceName:this.name});if(this.durationUs=Math.floor(n*1e3),this.startTimeUs=Math.floor(e*1e3),s&&s.attributes&&(this.customAttributes=Object.assign({},s.attributes)),s&&s.metrics)for(const r of Object.keys(s.metrics))isNaN(Number(s.metrics[r]))||(this.counters[r]=Math.floor(Number(s.metrics[r])));_h(this)}incrementMetric(e,n=1){this.counters[e]===void 0?this.putMetric(e,n):this.putMetric(e,this.counters[e]+n)}putMetric(e,n){if(o8(e,this.name))this.counters[e]=a8(n!=null?n:0);else throw Yt.create("invalid custom metric name",{customMetricName:e})}getMetric(e){return this.counters[e]||0}putAttribute(e,n){const s=NX(e),r=PX(n);if(s&&r){this.customAttributes[e]=n;return}if(!s)throw Yt.create("invalid attribute name",{attributeName:e});if(!r)throw Yt.create("invalid attribute value",{attributeValue:n})}getAttribute(e){return this.customAttributes[e]}removeAttribute(e){this.customAttributes[e]!==void 0&&delete this.customAttributes[e]}getAttributes(){return Object.assign({},this.customAttributes)}setStartTime(e){this.startTimeUs=e}setDuration(e){this.durationUs=e}calculateTraceMetrics(){const e=this.api.getEntriesByName(this.traceMeasure),n=e&&e[0];n&&(this.durationUs=Math.floor(n.duration*1e3),this.startTimeUs=Math.floor((n.startTime+this.api.getTimeOrigin())*1e3))}static createOobTrace(e,n,s,r){const i=Nt.getInstance().getUrl();if(!i)return;const o=new Gr(e,JD+i,!0),a=Math.floor(Nt.getInstance().getTimeOrigin()*1e3);o.setStartTime(a),n&&n[0]&&(o.setDuration(Math.floor(n[0].duration*1e3)),o.putMetric("domInteractive",Math.floor(n[0].domInteractive*1e3)),o.putMetric("domContentLoadedEventEnd",Math.floor(n[0].domContentLoadedEventEnd*1e3)),o.putMetric("loadEventEnd",Math.floor(n[0].loadEventEnd*1e3)));const c="first-paint",l="first-contentful-paint";if(s){const u=s.find(d=>d.name===c);u&&u.startTime&&o.putMetric(XD,Math.floor(u.startTime*1e3));const h=s.find(d=>d.name===l);h&&h.startTime&&o.putMetric(ZD,Math.floor(h.startTime*1e3)),r&&o.putMetric(ex,Math.floor(r*1e3))}_h(o)}static createUserTimingTrace(e,n){const s=new Gr(e,n,!1,n);_h(s)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lS(t,e){const n=e;if(!n||n.responseStart===void 0)return;const s=Nt.getInstance().getTimeOrigin(),r=Math.floor((n.startTime+s)*1e3),i=n.responseStart?Math.floor((n.responseStart-n.startTime)*1e3):void 0,o=Math.floor((n.responseEnd-n.startTime)*1e3),a=n.name&&n.name.split("?")[0],c={performanceController:t,url:a,responsePayloadBytes:n.transferSize,startTimeUs:r,timeToResponseInitiatedUs:i,timeToResponseCompletedUs:o};ZX(c)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const c8=5e3;function uS(t){!Lw()||(setTimeout(()=>u8(t),0),setTimeout(()=>l8(t),0),setTimeout(()=>h8(t),0))}function l8(t){const e=Nt.getInstance(),n=e.getEntriesByType("resource");for(const s of n)lS(t,s);e.setupObserver("resource",s=>lS(t,s))}function u8(t){const e=Nt.getInstance(),n=e.getEntriesByType("navigation"),s=e.getEntriesByType("paint");if(e.onFirstInputDelay){let r=setTimeout(()=>{Gr.createOobTrace(t,n,s),r=void 0},c8);e.onFirstInputDelay(i=>{r&&(clearTimeout(r),Gr.createOobTrace(t,n,s,i))})}else Gr.createOobTrace(t,n,s)}function h8(t){const e=Nt.getInstance(),n=e.getEntriesByType("measure");for(const s of n)hS(t,s);e.setupObserver("measure",s=>hS(t,s))}function hS(t,e){const n=e.name;n.substring(0,c_.length)!==c_&&Gr.createUserTimingTrace(t,n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d8{constructor(e,n){this.app=e,this.installations=n,this.initialized=!1}_init(e){this.initialized||((e==null?void 0:e.dataCollectionEnabled)!==void 0&&(this.dataCollectionEnabled=e.dataCollectionEnabled),(e==null?void 0:e.instrumentationEnabled)!==void 0&&(this.instrumentationEnabled=e.instrumentationEnabled),Nt.getInstance().requiredApisAvailable()?du().then(n=>{n&&(GX(),cx(this).then(()=>uS(this),()=>uS(this)),this.initialized=!0)}).catch(n=>{Bs.info(`Environment doesn't support IndexedDB: ${n}`)}):Bs.info('Firebase Performance cannot start if the browser does not support "Fetch" and "Promise", or cookies are disabled.'))}set instrumentationEnabled(e){Nn.getInstance().instrumentationEnabled=e}get instrumentationEnabled(){return Nn.getInstance().instrumentationEnabled}set dataCollectionEnabled(e){Nn.getInstance().dataCollectionEnabled=e}get dataCollectionEnabled(){return Nn.getInstance().dataCollectionEnabled}}const f8="[DEFAULT]";function p8(t,e){return t=N(t),new Gr(t,e)}const g8=(t,{options:e})=>{const n=t.getProvider("app").getImmediate(),s=t.getProvider("installations-internal").getImmediate();if(n.name!==f8)throw Yt.create("FB not default");if(typeof window=="undefined")throw Yt.create("no window");bX(window);const r=new d8(n,s);return r._init(e),r};function m8(){rt(new Ee("performance",g8,"PUBLIC")),Fe(sS,a_),Fe(sS,a_,"esm2017")}m8();/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _8{constructor(e,n){this.app=e,this._delegate=n}get instrumentationEnabled(){return this._delegate.instrumentationEnabled}set instrumentationEnabled(e){this._delegate.instrumentationEnabled=e}get dataCollectionEnabled(){return this._delegate.dataCollectionEnabled}set dataCollectionEnabled(e){this._delegate.dataCollectionEnabled=e}trace(e){return p8(this._delegate,e)}}const y8="@firebase/performance-compat",v8="0.1.12";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function w8(t){t.INTERNAL.registerComponent(new Ee("performance-compat",b8,"PUBLIC")),t.registerVersion(y8,v8)}function b8(t){const e=t.getProvider("app-compat").getImmediate(),n=t.getProvider("performance").getImmediate();return new _8(e,n)}w8(ht);const Ng="@firebase/remote-config",dS="0.3.11";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class I8{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const E8="remote-config";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const T8={["registration-window"]:"Undefined window object. This SDK only supports usage in a browser environment.",["registration-project-id"]:"Undefined project identifier. Check Firebase app initialization.",["registration-api-key"]:"Undefined API key. Check Firebase app initialization.",["registration-app-id"]:"Undefined app identifier. Check Firebase app initialization.",["storage-open"]:"Error thrown when opening storage. Original error: {$originalErrorMessage}.",["storage-get"]:"Error thrown when reading from storage. Original error: {$originalErrorMessage}.",["storage-set"]:"Error thrown when writing to storage. Original error: {$originalErrorMessage}.",["storage-delete"]:"Error thrown when deleting from storage. Original error: {$originalErrorMessage}.",["fetch-client-network"]:"Fetch client failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.",["fetch-timeout"]:'The config fetch request timed out.  Configure timeout using "fetchTimeoutMillis" SDK setting.',["fetch-throttle"]:'The config fetch request timed out while in an exponential backoff state. Configure timeout using "fetchTimeoutMillis" SDK setting. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.',["fetch-client-parse"]:"Fetch client could not parse response. Original error: {$originalErrorMessage}.",["fetch-status"]:"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.",["indexed-db-unavailable"]:"Indexed DB is not supported by current browser"},_n=new pn("remoteconfig","Remote Config",T8);function S8(t,e){return t instanceof ut&&t.code.indexOf(e)!==-1}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const C8=!1,A8="",fS=0,k8=["1","true","t","yes","y","on"];class Pg{constructor(e,n=A8){this._source=e,this._value=n}asString(){return this._value}asBoolean(){return this._source==="static"?C8:k8.indexOf(this._value.toLowerCase())>=0}asNumber(){if(this._source==="static")return fS;let e=Number(this._value);return isNaN(e)&&(e=fS),e}getSource(){return this._source}}async function dx(t){const e=N(t),[n,s]=await Promise.all([e._storage.getLastSuccessfulFetchResponse(),e._storage.getActiveConfigEtag()]);return!n||!n.config||!n.eTag||n.eTag===s?!1:(await Promise.all([e._storageCache.setActiveConfig(n.config),e._storage.setActiveConfigEtag(n.eTag)]),!0)}function fx(t){const e=N(t);return e._initializePromise||(e._initializePromise=e._storageCache.loadFromStorage().then(()=>{e._isInitializationComplete=!0})),e._initializePromise}async function px(t){const e=N(t),n=new I8;setTimeout(async()=>{n.abort()},e.settings.fetchTimeoutMillis);try{await e._client.fetch({cacheMaxAgeMillis:e.settings.minimumFetchIntervalMillis,signal:n}),await e._storageCache.setLastFetchStatus("success")}catch(s){const r=S8(s,"fetch-throttle")?"throttle":"failure";throw await e._storageCache.setLastFetchStatus(r),s}}function R8(t){const e=N(t);return O8(e._storageCache.getActiveConfig(),e.defaultConfig).reduce((n,s)=>(n[s]=zu(t,s),n),{})}function N8(t,e){return zu(N(t),e).asBoolean()}function P8(t,e){return zu(N(t),e).asNumber()}function D8(t,e){return zu(N(t),e).asString()}function zu(t,e){const n=N(t);n._isInitializationComplete||n._logger.debug(`A value was requested for key "${e}" before SDK initialization completed. Await on ensureInitialized if the intent was to get a previously activated value.`);const s=n._storageCache.getActiveConfig();return s&&s[e]!==void 0?new Pg("remote",s[e]):n.defaultConfig&&n.defaultConfig[e]!==void 0?new Pg("default",String(n.defaultConfig[e])):(n._logger.debug(`Returning static value for key "${e}". Define a default or remote value if this is unintentional.`),new Pg("static"))}function x8(t,e){const n=N(t);switch(e){case"debug":n._logger.logLevel=fe.DEBUG;break;case"silent":n._logger.logLevel=fe.SILENT;break;default:n._logger.logLevel=fe.ERROR}}function O8(t={},e={}){return Object.keys(Object.assign(Object.assign({},t),e))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M8{constructor(e,n,s,r){this.client=e,this.storage=n,this.storageCache=s,this.logger=r}isCachedDataFresh(e,n){if(!n)return this.logger.debug("Config fetch cache check. Cache unpopulated."),!1;const s=Date.now()-n,r=s<=e;return this.logger.debug(`Config fetch cache check. Cache age millis: ${s}. Cache max age millis (minimumFetchIntervalMillis setting): ${e}. Is cache hit: ${r}.`),r}async fetch(e){const[n,s]=await Promise.all([this.storage.getLastSuccessfulFetchTimestampMillis(),this.storage.getLastSuccessfulFetchResponse()]);if(s&&this.isCachedDataFresh(e.cacheMaxAgeMillis,n))return s;e.eTag=s&&s.eTag;const r=await this.client.fetch(e),i=[this.storageCache.setLastSuccessfulFetchTimestampMillis(Date.now())];return r.status===200&&i.push(this.storage.setLastSuccessfulFetchResponse(r)),await Promise.all(i),r}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function L8(t=navigator){return t.languages&&t.languages[0]||t.language}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F8{constructor(e,n,s,r,i,o){this.firebaseInstallations=e,this.sdkVersion=n,this.namespace=s,this.projectId=r,this.apiKey=i,this.appId=o}async fetch(e){var n,s,r;const[i,o]=await Promise.all([this.firebaseInstallations.getId(),this.firebaseInstallations.getToken()]),c=`${window.FIREBASE_REMOTE_CONFIG_URL_BASE||"https://firebaseremoteconfig.googleapis.com"}/v1/projects/${this.projectId}/namespaces/${this.namespace}:fetch?key=${this.apiKey}`,l={"Content-Type":"application/json","Content-Encoding":"gzip","If-None-Match":e.eTag||"*"},u={sdk_version:this.sdkVersion,app_instance_id:i,app_instance_id_token:o,app_id:this.appId,language_code:L8()},h={method:"POST",headers:l,body:JSON.stringify(u)},d=fetch(c,h),f=new Promise((E,S)=>{e.signal.addEventListener(()=>{const $=new Error("The operation was aborted.");$.name="AbortError",S($)})});let p;try{await Promise.race([d,f]),p=await d}catch(E){let S="fetch-client-network";throw((n=E)===null||n===void 0?void 0:n.name)==="AbortError"&&(S="fetch-timeout"),_n.create(S,{originalErrorMessage:(s=E)===null||s===void 0?void 0:s.message})}let _=p.status;const y=p.headers.get("ETag")||void 0;let T,I;if(p.status===200){let E;try{E=await p.json()}catch(S){throw _n.create("fetch-client-parse",{originalErrorMessage:(r=S)===null||r===void 0?void 0:r.message})}T=E.entries,I=E.state}if(I==="INSTANCE_STATE_UNSPECIFIED"?_=500:I==="NO_CHANGE"?_=304:(I==="NO_TEMPLATE"||I==="EMPTY_CONFIG")&&(T={}),_!==304&&_!==200)throw _n.create("fetch-status",{httpStatus:_});return{status:_,eTag:y,config:T}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function U8(t,e){return new Promise((n,s)=>{const r=Math.max(e-Date.now(),0),i=setTimeout(n,r);t.addEventListener(()=>{clearTimeout(i),s(_n.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}function $8(t){if(!(t instanceof ut)||!t.customData)return!1;const e=Number(t.customData.httpStatus);return e===429||e===500||e===503||e===504}class V8{constructor(e,n){this.client=e,this.storage=n}async fetch(e){const n=await this.storage.getThrottleMetadata()||{backoffCount:0,throttleEndTimeMillis:Date.now()};return this.attemptFetch(e,n)}async attemptFetch(e,{throttleEndTimeMillis:n,backoffCount:s}){await U8(e.signal,n);try{const r=await this.client.fetch(e);return await this.storage.deleteThrottleMetadata(),r}catch(r){if(!$8(r))throw r;const i={throttleEndTimeMillis:Date.now()+Wh(s),backoffCount:s+1};return await this.storage.setThrottleMetadata(i),this.attemptFetch(e,i)}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const B8=60*1e3,q8=12*60*60*1e3;class j8{constructor(e,n,s,r,i){this.app=e,this._client=n,this._storageCache=s,this._storage=r,this._logger=i,this._isInitializationComplete=!1,this.settings={fetchTimeoutMillis:B8,minimumFetchIntervalMillis:q8},this.defaultConfig={}}get fetchTimeMillis(){return this._storageCache.getLastSuccessfulFetchTimestampMillis()||-1}get lastFetchStatus(){return this._storageCache.getLastFetchStatus()||"no-fetch-yet"}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Oh(t,e){var n;const s=t.target.error||void 0;return _n.create(e,{originalErrorMessage:s&&((n=s)===null||n===void 0?void 0:n.message)})}const Ai="app_namespace_store",K8="firebase_remote_config",H8=1;function W8(){return new Promise((t,e)=>{var n;try{const s=indexedDB.open(K8,H8);s.onerror=r=>{e(Oh(r,"storage-open"))},s.onsuccess=r=>{t(r.target.result)},s.onupgradeneeded=r=>{const i=r.target.result;switch(r.oldVersion){case 0:i.createObjectStore(Ai,{keyPath:"compositeKey"})}}}catch(s){e(_n.create("storage-open",{originalErrorMessage:(n=s)===null||n===void 0?void 0:n.message}))}})}class G8{constructor(e,n,s,r=W8()){this.appId=e,this.appName=n,this.namespace=s,this.openDbPromise=r}getLastFetchStatus(){return this.get("last_fetch_status")}setLastFetchStatus(e){return this.set("last_fetch_status",e)}getLastSuccessfulFetchTimestampMillis(){return this.get("last_successful_fetch_timestamp_millis")}setLastSuccessfulFetchTimestampMillis(e){return this.set("last_successful_fetch_timestamp_millis",e)}getLastSuccessfulFetchResponse(){return this.get("last_successful_fetch_response")}setLastSuccessfulFetchResponse(e){return this.set("last_successful_fetch_response",e)}getActiveConfig(){return this.get("active_config")}setActiveConfig(e){return this.set("active_config",e)}getActiveConfigEtag(){return this.get("active_config_etag")}setActiveConfigEtag(e){return this.set("active_config_etag",e)}getThrottleMetadata(){return this.get("throttle_metadata")}setThrottleMetadata(e){return this.set("throttle_metadata",e)}deleteThrottleMetadata(){return this.delete("throttle_metadata")}async get(e){const n=await this.openDbPromise;return new Promise((s,r)=>{var i;const a=n.transaction([Ai],"readonly").objectStore(Ai),c=this.createCompositeKey(e);try{const l=a.get(c);l.onerror=u=>{r(Oh(u,"storage-get"))},l.onsuccess=u=>{const h=u.target.result;s(h?h.value:void 0)}}catch(l){r(_n.create("storage-get",{originalErrorMessage:(i=l)===null||i===void 0?void 0:i.message}))}})}async set(e,n){const s=await this.openDbPromise;return new Promise((r,i)=>{var o;const c=s.transaction([Ai],"readwrite").objectStore(Ai),l=this.createCompositeKey(e);try{const u=c.put({compositeKey:l,value:n});u.onerror=h=>{i(Oh(h,"storage-set"))},u.onsuccess=()=>{r()}}catch(u){i(_n.create("storage-set",{originalErrorMessage:(o=u)===null||o===void 0?void 0:o.message}))}})}async delete(e){const n=await this.openDbPromise;return new Promise((s,r)=>{var i;const a=n.transaction([Ai],"readwrite").objectStore(Ai),c=this.createCompositeKey(e);try{const l=a.delete(c);l.onerror=u=>{r(Oh(u,"storage-delete"))},l.onsuccess=()=>{s()}}catch(l){r(_n.create("storage-delete",{originalErrorMessage:(i=l)===null||i===void 0?void 0:i.message}))}})}createCompositeKey(e){return[this.appId,this.appName,this.namespace,e].join()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z8{constructor(e){this.storage=e}getLastFetchStatus(){return this.lastFetchStatus}getLastSuccessfulFetchTimestampMillis(){return this.lastSuccessfulFetchTimestampMillis}getActiveConfig(){return this.activeConfig}async loadFromStorage(){const e=this.storage.getLastFetchStatus(),n=this.storage.getLastSuccessfulFetchTimestampMillis(),s=this.storage.getActiveConfig(),r=await e;r&&(this.lastFetchStatus=r);const i=await n;i&&(this.lastSuccessfulFetchTimestampMillis=i);const o=await s;o&&(this.activeConfig=o)}setLastFetchStatus(e){return this.lastFetchStatus=e,this.storage.setLastFetchStatus(e)}setLastSuccessfulFetchTimestampMillis(e){return this.lastSuccessfulFetchTimestampMillis=e,this.storage.setLastSuccessfulFetchTimestampMillis(e)}setActiveConfig(e){return this.activeConfig=e,this.storage.setActiveConfig(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Q8(){rt(new Ee(E8,t,"PUBLIC").setMultipleInstances(!0)),Fe(Ng,dS),Fe(Ng,dS,"esm2017");function t(e,{instanceIdentifier:n}){const s=e.getProvider("app").getImmediate(),r=e.getProvider("installations-internal").getImmediate();if(typeof window=="undefined")throw _n.create("registration-window");if(!In())throw _n.create("indexed-db-unavailable");const{projectId:i,apiKey:o,appId:a}=s.options;if(!i)throw _n.create("registration-project-id");if(!o)throw _n.create("registration-api-key");if(!a)throw _n.create("registration-app-id");n=n||"firebase";const c=new G8(a,s.name,n),l=new z8(c),u=new js(Ng);u.logLevel=fe.ERROR;const h=new F8(r,Ks,n,i,o,a),d=new V8(h,c),f=new M8(d,c,l,u),p=new j8(s,f,l,c,u);return fx(p),p}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Y8(t){return t=N(t),await px(t),dx(t)}async function J8(){if(!In())return!1;try{return await du()}catch{return!1}}Q8();/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X8{constructor(e,n){this.app=e,this._delegate=n}get defaultConfig(){return this._delegate.defaultConfig}set defaultConfig(e){this._delegate.defaultConfig=e}get fetchTimeMillis(){return this._delegate.fetchTimeMillis}get lastFetchStatus(){return this._delegate.lastFetchStatus}get settings(){return this._delegate.settings}set settings(e){this._delegate.settings=e}activate(){return dx(this._delegate)}ensureInitialized(){return fx(this._delegate)}fetch(){return px(this._delegate)}fetchAndActivate(){return Y8(this._delegate)}getAll(){return R8(this._delegate)}getBoolean(e){return N8(this._delegate,e)}getNumber(e){return P8(this._delegate,e)}getString(e){return D8(this._delegate,e)}getValue(e){return zu(this._delegate,e)}setLogLevel(e){x8(this._delegate,e)}}const Z8="@firebase/remote-config-compat",e9="0.1.12";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function t9(t){t.INTERNAL.registerComponent(new Ee("remoteConfig-compat",n9,"PUBLIC").setMultipleInstances(!0).setServiceProps({isSupported:J8})),t.registerVersion(Z8,e9)}function n9(t,{instanceIdentifier:e}){const n=t.getProvider("app-compat").getImmediate(),s=t.getProvider("remote-config").getImmediate({identifier:e});return new X8(n,s)}t9(ht);var s9="firebase",r9="9.9.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ht.registerVersion(s9,r9,"app-compat");var i9="firebase",o9="9.9.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */console.warn(`
It looks like you're using the development build of the Firebase JS SDK.
When deploying Firebase apps to production, it is advisable to only import
the individual SDK components you intend to use.

For the module builds, these are available in the following manner
(replace <PACKAGE> with the name of a component - i.e. auth, database, etc):

CommonJS Modules:
const firebase = require('firebase/app');
require('firebase/<PACKAGE>');

ES Modules:
import firebase from 'firebase/app';
import 'firebase/<PACKAGE>';

Typescript:
import firebase from 'firebase/app';
import 'firebase/<PACKAGE>';
`);ht.registerVersion(i9,o9,"compat");var a9=!1;/*!
  * pinia v2.0.16
  * (c) 2022 Eduardo San Martin Morote
  * @license MIT
  */let gx;const Sp=t=>gx=t,mx=Symbol();function l_(t){return t&&typeof t=="object"&&Object.prototype.toString.call(t)==="[object Object]"&&typeof t.toJSON!="function"}var cl;(function(t){t.direct="direct",t.patchObject="patch object",t.patchFunction="patch function"})(cl||(cl={}));function c9(){const t=bS(!0),e=t.run(()=>T_({}));let n=[],s=[];const r=ma({install(i){Sp(r),r._a=i,i.provide(mx,r),i.config.globalProperties.$pinia=r,s.forEach(o=>n.push(o)),s=[]},use(i){return!this._a&&!a9?s.push(i):n.push(i),this},_p:n,_a:null,_e:t,_s:new Map,state:e});return r}const _x=()=>{};function pS(t,e,n,s=_x){t.push(e);const r=()=>{const i=t.indexOf(e);i>-1&&(t.splice(i,1),s())};return!n&&ef()&&P_(r),r}function Ho(t,...e){t.slice().forEach(n=>{n(...e)})}function u_(t,e){for(const n in e){if(!e.hasOwnProperty(n))continue;const s=e[n],r=t[n];l_(r)&&l_(s)&&t.hasOwnProperty(n)&&!lt(s)&&!Vr(s)?t[n]=u_(r,s):t[n]=s}return t}const l9=Symbol();function u9(t){return!l_(t)||!t.hasOwnProperty(l9)}const{assign:zs}=Object;function h9(t){return!!(lt(t)&&t.effect)}function d9(t,e,n,s){const{state:r,actions:i,getters:o}=e,a=n.state.value[t];let c;function l(){a||(n.state.value[t]=r?r():{});const u=uO(n.state.value[t]);return zs(u,i,Object.keys(o||{}).reduce((h,d)=>(h[d]=ma(ns(()=>{Sp(n);const f=n._s.get(t);return o[d].call(f,f)})),h),{}))}return c=yx(t,l,e,n,s,!0),c.$reset=function(){const h=r?r():{};this.$patch(d=>{zs(d,h)})},c}function yx(t,e,n={},s,r,i){let o;const a=zs({actions:{}},n),c={deep:!0};let l,u,h=ma([]),d=ma([]),f;const p=s.state.value[t];!i&&!p&&(s.state.value[t]={}),T_({});let _;function y(K){let F;l=u=!1,typeof K=="function"?(K(s.state.value[t]),F={type:cl.patchFunction,storeId:t,events:f}):(u_(s.state.value[t],K),F={type:cl.patchObject,payload:K,storeId:t,events:f});const ne=_=Symbol();C_().then(()=>{_===ne&&(l=!0)}),u=!0,Ho(h,F,s.state.value[t])}const T=_x;function I(){o.stop(),h=[],d=[],s._s.delete(t)}function E(K,F){return function(){Sp(s);const ne=Array.from(arguments),he=[],Ce=[];function z(et){he.push(et)}function Re(et){Ce.push(et)}Ho(d,{args:ne,name:K,store:$,after:z,onError:Re});let Ze;try{Ze=F.apply(this&&this.$id===t?this:$,ne)}catch(et){throw Ho(Ce,et),et}return Ze instanceof Promise?Ze.then(et=>(Ho(he,et),et)).catch(et=>(Ho(Ce,et),Promise.reject(et))):(Ho(he,Ze),Ze)}}const S={_p:s,$id:t,$onAction:pS.bind(null,d),$patch:y,$reset:T,$subscribe(K,F={}){const ne=pS(h,K,F.detached,()=>he()),he=o.run(()=>na(()=>s.state.value[t],Ce=>{(F.flush==="sync"?u:l)&&K({storeId:t,type:cl.direct,events:f},Ce)},zs({},c,F)));return ne},$dispose:I},$=ja(zs({},S));s._s.set(t,$);const H=s._e.run(()=>(o=bS(),o.run(()=>e())));for(const K in H){const F=H[K];if(lt(F)&&!h9(F)||Vr(F))i||(p&&u9(F)&&(lt(F)?F.value=p[K]:u_(F,p[K])),s.state.value[t][K]=F);else if(typeof F=="function"){const ne=E(K,F);H[K]=ne,a.actions[K]=F}}return zs($,H),zs(Se($),H),Object.defineProperty($,"$state",{get:()=>s.state.value[t],set:K=>{y(F=>{zs(F,K)})}}),s._p.forEach(K=>{zs($,o.run(()=>K({store:$,app:s._a,pinia:s,options:a})))}),p&&i&&n.hydrate&&n.hydrate($.$state,p),l=!0,u=!0,$}function f9(t,e,n){let s,r;const i=typeof e=="function";typeof t=="string"?(s=t,r=i?n:e):(r=t,s=t.id);function o(a,c){const l=ef();return a=a||l&&ks(mx),a&&Sp(a),a=gx,a._s.has(s)||(i?yx(s,e,r,a):d9(s,r,a)),a._s.get(s)}return o.$id=s,o}const yh=f9({id:"university",state:()=>({univercities:[],key:[],loading:!1}),actions:{getData(){this.loading=!0,this.removeAll(this.univercities,this.univercities.length),ht.firestore().collection("Univercities").orderBy("name").get().then(e=>{e.forEach(s=>{const r=s.data();this.univercities.push(r),this.loading=!1});let n=Object.keys(this.univercities[0]);this.key=n})},removeAll(t,e){t.splice(0,e),this.univercities=t}}});const p9={name:"ticker",data(){return{tickerData:[{headlines:"Admission open in Comsatas",link:"https://comstas.com"},{headlines:"Today Entry Test in BZU",link:"https://bzu.com"}],ticker:!0}},methods:{isTicker(){this.$route.name=="details"?this.ticker=!1:this.ticker=!0}}},g9=t=>(A_("data-v-3bcc35ae"),t=t(),k_(),t),m9={key:0},_9={class:"ticker-wrapper"},y9=g9(()=>Ye("div",{class:"big-heading"},"News",-1)),v9={class:"text-update"},w9=qs("Today Is the Last Date of Admission In Government College University Faisalabad "),b9=qs("Today Is Entry Test In Comstats University Islamabad"),I9=qs("Admission Open In Ripah Internation University");function E9(t,e,n,s,r,i){const o=Pr("router-link");return r.ticker?(Ts(),_a("section",m9,[Ye("div",_9,[y9,Ye("div",v9,[Ye("ul",null,[Ye("li",null,[qe(o,{to:{name:"details",params:{name:"Government-College-University-Faisalabad"}}},{default:ss(()=>[w9]),_:1})]),Ye("li",null,[qe(o,{to:{name:"details",params:{name:"COMSATS-University-Islamabad"}}},{default:ss(()=>[b9]),_:1})]),Ye("li",null,[qe(o,{to:{name:"details",params:{name:"Riphah-International-University"}}},{default:ss(()=>[I9]),_:1})])])])])])):jc("",!0)}var T9=lu(p9,[["render",E9],["__scopeId","data-v-3bcc35ae"]]),S9="/Educatia/footer-social/fb.svg",C9="/Educatia/footer-social/vk.svg",A9="/Educatia/footer-social/twitter.svg",k9="/Educatia/footer-social/git.svg",R9="/Educatia/footer-social/yt.svg",N9="/Educatia/footer-social/instaa.svg";const P9={name:"Footer"},D9=aM('<h1 data-v-5c7cdad4>EDUCATIA</h1><div class="footer-social" data-v-5c7cdad4><a href="https://facebook.com/Dar.Ahmed0" target="_blank" data-v-5c7cdad4><img src="'+S9+'" alt="Facebook" data-v-5c7cdad4></a><a href="https://vk.com/id548454513" target="_blank" data-v-5c7cdad4><img src="'+C9+'" alt="VK" data-v-5c7cdad4></a><a href="https://twitter.com/AmmarAhmed961" target="_blank" data-v-5c7cdad4><img src="'+A9+'" alt="Twitter" data-v-5c7cdad4></a><a href="https://github.com/AA961" target="_blank" data-v-5c7cdad4><img src="'+k9+'" alt="Github" data-v-5c7cdad4></a><a href="https://www.youtube.com/channel/UCKZnPw6nQ9iag2uqB7vg-Yw" target="_blank" data-v-5c7cdad4><img src="'+R9+'" alt="Youtube" data-v-5c7cdad4></a><a href="https://Instagram.com/aa961019" target="_blank" data-v-5c7cdad4><img src="'+N9+'" alt="Youtube" data-v-5c7cdad4></a></div><div class="copyright" data-v-5c7cdad4> Copyright 2022 \xA9 Educatia.Com . All Right <br data-v-5c7cdad4> Reserved. </div>',3),x9=[D9];function O9(t,e,n,s,r,i){return Ts(),_a("footer",null,x9)}var M9=lu(P9,[["render",O9],["__scopeId","data-v-5c7cdad4"]]);const L9={components:{NavVue:dL,tickerVue:T9,mobileNav:AL,footerVue:M9},data(){return{mainNav:!0,ticker:!0}},methods:{removeAll(){const t=yh();t.removeAll(t.univercities,t.univercities.length)},getDataFromBase(){const t=yh();t.univercities.length<1&&(this.removeAll(),t.getData())},checkingScreenSize(){window.innerWidth<760?this.mainNav=!1:this.mainNav=!0}},beforeMount(){this.checkingScreenSize()},mounted(){window.addEventListener("resize",()=>{this.checkingScreenSize()}),yh().getData()},created(){const t=yh(),e=setInterval(this.getDataFromBase,7e3);t.univercities.length>1&&clearInterval(e)}};function F9(t,e,n,s,r,i){const o=Pr("tickerVue"),a=Pr("NavVue"),c=Pr("mobileNav"),l=Pr("router-view"),u=Pr("footerVue");return Ts(),_a(es,null,[r.ticker?(Ts(),Ih(o,{key:0})):jc("",!0),r.mainNav?(Ts(),Ih(a,{key:1})):jc("",!0),r.mainNav?jc("",!0):(Ts(),Ih(c,{key:2})),qe(l),qe(u)],64)}var U9=lu(L9,[["render",F9]]),$9="firebase",V9="9.9.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ht.registerVersion($9,V9,"app-compat");const B9={apiKey:"AIzaSyD2b62AFYQbjcAHQKD_sndun59ZC72lb8E",authDomain:"educatia-170f3.firebaseapp.com",projectId:"educatia-170f3",storageBucket:"educatia-170f3.appspot.com",messagingSenderId:"111445876419",appId:"1:111445876419:web:8c6ca1e04409a7ddf6cc76",measurementId:"G-5KM7Z5KJ8R"};ht.initializeApp(B9);const $w=HM(U9),q9=c9();$w.use(q9);$w.use(tL);$w.mount("#app");export{es as F,K9 as K,L_ as T,lu as _,k_ as a,Ye as b,_a as c,jc as d,Q9 as e,qe as f,Ih as g,W9 as h,ss as i,qs as j,ht as k,J9 as l,z9 as m,Y9 as n,Ts as o,A_ as p,aM as q,Pr as r,j9 as t,yh as u,G9 as v,H9 as w};
